[{"tags": ["excel", "vba", "textbox", "userform"], "comments": [{"owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "edited": false, "score": 1, "creation_date": 1542895128, "post_id": 53422113, "comment_id": 93738839, "body": "Store your initial value in the .Tag property of the TextBox,  (or in a custom property in your class)  it&#39;s easier to compare it with the actual value. The Change-Event is triggered every-time you type in your TextBox, so the Afterupdate or Exit-event are better used (but cannot be used by WithEvents."}, {"owner": {"reputation": 170, "user_id": 9121235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e481ddd5d81db5e202bde36a65652d21?s=128&d=identicon&r=PG&f=1", "display_name": "smartini", "link": "https://stackoverflow.com/users/9121235/smartini"}, "reply_to_user": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "edited": false, "score": 0, "creation_date": 1542895285, "post_id": 53422113, "comment_id": 93738925, "body": "so simple, so good! the .Tag property is a very good idea! thank you"}], "answers": [{"comments": [{"owner": {"reputation": 170, "user_id": 9121235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e481ddd5d81db5e202bde36a65652d21?s=128&d=identicon&r=PG&f=1", "display_name": "smartini", "link": "https://stackoverflow.com/users/9121235/smartini"}, "edited": false, "score": 0, "creation_date": 1542868244, "post_id": 53422582, "comment_id": 93724282, "body": "thx. i didn&#39;t get the first part but the second one i might understand. but what happens if let&#39;s say 4 values are collected and i change txtbox2 value to something else but this equals a value in the collection, from let&#39;s say txtbox4, then the class would recognize it as &#39;no change&#39; right?"}, {"owner": {"reputation": 170, "user_id": 9121235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e481ddd5d81db5e202bde36a65652d21?s=128&d=identicon&r=PG&f=1", "display_name": "smartini", "link": "https://stackoverflow.com/users/9121235/smartini"}, "edited": false, "score": 0, "creation_date": 1542876786, "post_id": 53422582, "comment_id": 93728244, "body": "Ok, thanks. But realized it via the KeyUp Event and detecting whether &quot;Tab Key&quot; was pressed and immediately delcare the public textbox value and also a MouseDown Event in case the user focused the Textbox via left-mouse click and declaring the same as above."}, {"owner": {"reputation": 3, "user_id": 10686521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad87101b959eecfa5eaf3b2ec6e0895?s=128&d=identicon&r=PG&f=1", "display_name": "Just Schornagel", "link": "https://stackoverflow.com/users/10686521/just-schornagel"}, "reply_to_user": {"reputation": 170, "user_id": 9121235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e481ddd5d81db5e202bde36a65652d21?s=128&d=identicon&r=PG&f=1", "display_name": "smartini", "link": "https://stackoverflow.com/users/9121235/smartini"}, "edited": false, "score": 0, "creation_date": 1542926168, "post_id": 53422582, "comment_id": 93751030, "body": "Try to add the sub mTextBox_Change() like in the example. Does this work?"}], "tags": [], "owner": {"reputation": 3, "user_id": 10686521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad87101b959eecfa5eaf3b2ec6e0895?s=128&d=identicon&r=PG&f=1", "display_name": "Just Schornagel", "link": "https://stackoverflow.com/users/10686521/just-schornagel"}, "is_accepted": false, "score": 0, "last_activity_date": 1542889775, "last_edit_date": 1542889775, "creation_date": 1542848938, "answer_id": 53422582, "question_id": 53422113, "link": "https://stackoverflow.com/questions/53422113/textbox-classmodule-change-backgroundcolor-only-on-a-real-value-change/53422582#53422582", "title": "TextBox ClassModule - Change backgroundcolor only on a real value change", "body": "<p>You could use collections to hold your textboxes.\nAfter option explicit, declare these collections\n    <code>Private ColTxtBox As New Collection</code></p>\n\n<p>Then when dynamically creating textboxes, here is one example:</p>\n\n<pre><code>`'Create Unit size; textbox\nSet TxtBox = New DynamicTxtbox\nTxtBox.Row = FormRows\nTxtBox.Column = A_Deliv.F_UnitSize\nCall TxtBox.InitText(frm_delivery.Frame1, \"txtbox\" &amp; TxtBox.Row) 'this is the \nconstructor\nColTxtBox.Add TxtBox`\n</code></pre>\n\n<p>However, if you already created all textboxes on your form and they are fixed, it is sufficient to run through all controls and add these to your collection (if it's a textbox!). Then in your textbox class, you can easily loop through all your texboxes - and access their current values with something like</p>\n\n<pre><code>`Private Sub mTextBoxs_Change()\n    For Each TxtBox In ColTxtBox\n      If InStr(Me.Value,TxtBox.Value) &gt; 0 Then\n        Reset_BackColor\n      Else \n        mTextBoxs.BackColor = RGB(255, 255, 153)\n      End If\n    Next TxtBox\n EndS Sub`\n</code></pre>\n"}], "owner": {"reputation": 170, "user_id": 9121235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e481ddd5d81db5e202bde36a65652d21?s=128&d=identicon&r=PG&f=1", "display_name": "smartini", "link": "https://stackoverflow.com/users/9121235/smartini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 179, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1583476836, "creation_date": 1542844753, "last_edit_date": 1583476836, "question_id": 53422113, "link": "https://stackoverflow.com/questions/53422113/textbox-classmodule-change-backgroundcolor-only-on-a-real-value-change", "title": "TextBox ClassModule - Change backgroundcolor only on a real value change", "body": "<p>I have a Userform with multiple Controls (Textbox). Those Textboxes will be populated by selecting a ListBox item.\nWhen initializing the UserForm those TextBoxes will be assigned to a specific Class which handles them.</p>\n\n<p>I want VBA to change the background color of those textboxes only when a real change of the value was performed. What I have is that the BackgroundColor is always changed as soon as a change was performed, but that's not what I want.</p>\n\n<p>Example #1:\n<strong>Textbox value before change:</strong> \"test\"\n<strong>Textbox value after change:</strong> \"test2\"\n--> BackgroundColor should be changed</p>\n\n<p>Example #2:\n<strong>Textbox value before change:</strong> \"test\"\n<strong>Textbox value after change:</strong> \"test bla\" but then I am typing \"test\" again.\n--> BackgroundColor should not be changed, because initial Value is in the TextBox again.</p>\n\n<p>What I have so far:</p>\n\n<pre><code>' **************************************************************\n'  Module:  clsTextbox  Typ = Class Module\n' **************************************************************\n\nPublic WithEvents mTextBoxs As MSForms.TextBox\n\nPrivate Sub mTextBoxs_Change()\n\nIf mTextBoxs.Text = strInitialVal Then\nReset_BackColor\nElse\n    mTextBoxs.BackColor = RGB(255, 255, 153)\nEnd If\nEnd Sub\n\nPublic Sub Reset_BackColor()\n    mTextBoxs.BackColor = RGB(255, 255, 255)\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>' **************************************************************\n'  Module:  frmEmployee  Type = Userform\n' **************************************************************\nDim arrLabels() As New clsLabel, UBoundarrLabels As Integer\nDim arrTextBoxs() As New clsTextbox, UBoundarrTextBoxs As Integer\n\nPrivate Sub UserForm_Initialize()\n    Dim Ctrl As Control, obLabel As MSForms.Label, obTextbox As MSForms.TextBox\n    tblName = \"tblMitarbeiter\"\n    Set wb = ThisWorkbook\n    Set ws = wb.Sheets(\"Mitarbeiter\")\n\n    i = 0\n    For Each Ctrl In Me.Controls\n        If Left(Ctrl.Name, 7) = \"TextBox\" Then\n            i = i + 1\n            ReDim Preserve arrTextBoxs(i)\n            Set obTextbox = Me.Controls(\"TextBox\" &amp; i)\n            Set arrTextBoxs(i).mTextBoxs = obTextbox\n        End If\n    Next Ctrl\n\n    ' Fill Listbox1 with values (Vorname &amp; Nachname) from Table [tblMitarbeiter]\n    Dim lngLastRow As Long: lngLastRow = getListLastRow(ws, tblName)\n    Dim vArrListBox1() As Variant\n    ReDim vArrListBox1(0 To lngLastRow - 1, 0 To 2)\n    For j = 1 To lngLastRow\n        vArrListBox1(j - 1, 0) = ws.ListObjects(\"tblMitarbeiter\").DataBodyRange(j, 1).Value\n        vArrListBox1(j - 1, 1) = ws.ListObjects(\"tblMitarbeiter\").DataBodyRange(j, 2).Value\n        vArrListBox1(j - 1, 2) = ws.ListObjects(\"tblMitarbeiter\").DataBodyRange(j, 3).Value\n    Next j\n\n    For t = 1 To 4\n        Me.Controls(\"TextBox\" &amp; t) = vArrEmployee(t - 1)\n    Next t\n\n    strInitialVal = Me.Controls(\"TextBox2\")\n\nEnd Sub\n</code></pre>\n\n<p><strong>My thoughts are:</strong>\nAs you can see I tried to declare a public variable (strInitialVal) in a Module which gets the initial value of a textbox (e.g. TextBox2) and when performing the mTextBoxs_Change() Event it checks whether the  strInitialVal is the same as the value in the Textbox and so on.\n--> this works, but only for a 1:1 relation of the variable and a textbox.</p>\n\n<p>How can I manage to load all textbox values into an Array? and Check the values in the TextBox Class afterwards.</p>\n\n<p>If you need more information please let me know. I hope I did not violate any SO-rules.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 9498191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1e0c565348298f3d3a04dad3e531f47?s=128&d=identicon&r=PG&f=1", "display_name": "M.J", "link": "https://stackoverflow.com/users/9498191/m-j"}, "edited": false, "score": 0, "creation_date": 1542848024, "post_id": 53422224, "comment_id": 93719459, "body": "Yes, that is what I want to do so it has more than five sheets. But now I noticed that when a document with the same name as these worksheets is open, then it gives this error, otherwise it works ok."}, {"owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "reply_to_user": {"reputation": 5, "user_id": 9498191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1e0c565348298f3d3a04dad3e531f47?s=128&d=identicon&r=PG&f=1", "display_name": "M.J", "link": "https://stackoverflow.com/users/9498191/m-j"}, "edited": false, "score": 0, "creation_date": 1542848079, "post_id": 53422224, "comment_id": 93719468, "body": "You cannot have two documents with the same name opened at the same time."}], "tags": [], "owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "is_accepted": false, "score": 0, "last_activity_date": 1542845812, "creation_date": 1542845812, "answer_id": 53422224, "question_id": 53422048, "link": "https://stackoverflow.com/questions/53422048/copy-columns-in-a-new-workbook-run-time-error/53422224#53422224", "title": "Copy columns in a new workbook; Run-time error", "body": "<p>You are telling VBA to copy columns A and C from the 5th worksheet of the opened workbook.  Seems like it doesn't have five or more sheets.</p>\n"}], "owner": {"reputation": 5, "user_id": 9498191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1e0c565348298f3d3a04dad3e531f47?s=128&d=identicon&r=PG&f=1", "display_name": "M.J", "link": "https://stackoverflow.com/users/9498191/m-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1583476848, "creation_date": 1542844220, "last_edit_date": 1583476848, "question_id": 53422048, "link": "https://stackoverflow.com/questions/53422048/copy-columns-in-a-new-workbook-run-time-error", "title": "Copy columns in a new workbook; Run-time error", "body": "<p>At \"New folder\" I have the excel workbooks which will be opened by the loop; I want to copy 2 columns in each of these workbooks and paste it in another workbook called \"new\"</p>\n\n<p>When I run the code I get the <strong>Run-time error '91': Object variable or With block variable not set</strong></p>\n\n<p>at line <strong>With wb.Worksheets(5)</strong> and only data of the first workbook are copied.</p>\n\n<p>How can I fix it?</p>\n\n<pre><code>Option Explicit\n\nSub ProcessFiles()\n\nDim Filename, Pathname As String\nDim wb As Workbook\nDim wbMain As Workbook\nDim i As Integer\n\nSet wbMain = Workbooks.Open(\"C:\\Users\\A\\Desktop\\VBA\\new.xlsx\")\nPathname = \"C:\\Users\\A\\Desktop\\VBA\\New folder\\\"\n\nFilename = Dir(Pathname)\ni = 1\n\nDo While Filename &lt;&gt; \"\"\n    Set wb = Workbooks.Open(Pathname &amp; Filename)\n    Enter_Formulas wb, wbMain, i\n\n    wb.Close SaveChanges:=True\n    Filename = Dir()\n    i = i + 2\nLoop   \nEnd Sub\n\n\nSub Enter_Formulas(wb As Workbook, wbMain As Workbook, i)\nWith wb.Worksheets(5)\n    .Columns(1).Copy Destination:=wbMain.Worksheets(2).Columns(i)\n    .Columns(3).Copy Destination:=wbMain.Worksheets(2).Columns(i + 1)\nEnd With   \nEnd Sub\n</code></pre>\n"}, {"tags": ["database", "ms-access", "vba"], "comments": [{"owner": {"reputation": 187, "user_id": 9444774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00405226a766d5fc699ef3ca2f5cd5b4?s=128&d=identicon&r=PG&f=1", "display_name": "mecnism", "link": "https://stackoverflow.com/users/9444774/mecnism"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1542839479, "post_id": 53420967, "comment_id": 93717106, "body": "sorry, i&#39;ve edited it"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1542840141, "post_id": 53420967, "comment_id": 93717307, "body": "Why isn&#39;t the back-end already linked in front-end? Usually, a user should not have to regularly search and connect the data source. Also, your last question is something you should tell us. What does code currently do? Undesired results? Error?"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 1, "creation_date": 1542843779, "post_id": 53420967, "comment_id": 93718451, "body": "Need to loop through TableDefs collection. Review <a href=\"https://www.microsoft.com/en-us/microsoft-365/blog/2012/08/03/automatically-relink-microsoft-access-tables/\" rel=\"nofollow noreferrer\">microsoft.com/en-us/microsoft-365/blog/2012/08/03/&hellip;</a>."}], "answers": [{"tags": [], "owner": {"reputation": 187, "user_id": 9444774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00405226a766d5fc699ef3ca2f5cd5b4?s=128&d=identicon&r=PG&f=1", "display_name": "mecnism", "link": "https://stackoverflow.com/users/9444774/mecnism"}, "is_accepted": false, "score": 0, "last_activity_date": 1542905387, "creation_date": 1542905387, "answer_id": 53435358, "question_id": 53420967, "link": "https://stackoverflow.com/questions/53420967/relink-back-end-mdb-from-front-end-access-form-using-vba/53435358#53435358", "title": "Relink back-end mdb from front-end Access form using VBA", "body": "<p>I've figure it out in the end, here is the full code: </p>\n\n<pre><code>Private Sub browseBtn_Click()\nDim objDialog As Object\n\n Set objDialog = Application.FileDialog(3)\n\n With objDialog\n   .title = \"Please select the backend file\"\n   .AllowMultiSelect = False\n   .Show\n   If .SelectedItems.Count = 1 Then\n    Me.textField = .SelectedItems(1)\n   End If\n End With\nEnd Sub\n\nPrivate Sub linkBtn_Click()\n  RefreshLinks (Me.textField)\nEnd Sub\n\n\nPublic Function RefreshLinks(strFilename As String)\n   Dim dbs As dao.Database\n   Dim tdf As TableDef\n\n   Set dbs = CurrentDb\n\n    For Each tdf In dbs.TableDefs\n         If Len(tdf.Connect) &gt; 0 Then\n             tdf.Connect = \";DATABASE=\" &amp; strFilename\n             Err = 0\n            On Error Resume Next\n            tdf.refreshlink\n             If Err &lt;&gt; 0 Then\n                RefreshLinks = False\n                 Exit Function\n             End If\n         End If\n    Next tdf\n    RefreshLinks = True\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 187, "user_id": 9444774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00405226a766d5fc699ef3ca2f5cd5b4?s=128&d=identicon&r=PG&f=1", "display_name": "mecnism", "link": "https://stackoverflow.com/users/9444774/mecnism"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 491, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542905387, "creation_date": 1542837130, "last_edit_date": 1542840018, "question_id": 53420967, "link": "https://stackoverflow.com/questions/53420967/relink-back-end-mdb-from-front-end-access-form-using-vba", "title": "Relink back-end mdb from front-end Access form using VBA", "body": "<p>My Access database is split into back and front-end. \nI have created an Access form in the front-end that contains a textBox, a <em>Browser</em> button and a <em>Relink</em> button.</p>\n\n<p>When I click <em>Browse</em>, file manager pops up to choose my .mdb file. After the file is choosen, the path to the file is displayed into the textBox.</p>\n\n<p>What I want is when I press <em>Relink</em> button, it should take the path from textBox and link my back-end file to my front end. </p>\n\n<p>Here is my code so far:</p>\n\n<pre><code>'browse button\n Private Sub browseBtn_Click()\n   Dim objDialog As Object\n   set objDialog = Application.FileDialog(3)\n   With objDialog\n        .show\n        .AllowMultiSelect = False\n        If .SelectedItems.Count = 1 Then\n            'textFiled displays the path\n             Me.textField = .SelectedItems(1) \n        End If\n    End With\n End Sub\n\n'relink button\nPrivate Sub linkBtn_Click()\n    Dim newConnection As String\n    Dim currentPath As String\n    currentPath = Me.textField\n    Dim tblDef As TableDef\n        tblDef.Connect = newConnection\n        tblDef.RefreshLink\nEnd Sub\n</code></pre>\n\n<p>What is wrong with this?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 48202, "user_id": 549372, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cc12ae5f4b59645f0fbfde098c306756?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Zeitler", "link": "https://stackoverflow.com/users/549372/martin-zeitler"}, "edited": false, "score": 0, "creation_date": 1547888972, "post_id": 53420352, "comment_id": 95354802, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/19372319/vba-folder-picker-set-where-to-start\">VBA - Folder Picker - set where to start</a>"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 10279527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e4ee093e215853182627d188d40bccf?s=128&d=identicon&r=PG&f=1", "display_name": "M1rz&#196;", "link": "https://stackoverflow.com/users/10279527/m1rz%c3%84"}, "edited": false, "score": 0, "creation_date": 1542836971, "post_id": 53420394, "comment_id": 93716259, "body": "Well, it didnt work well...I mean it asks for path but then makes error in my line already,  *** Folder with systems to define (path) ***  HostFolder = &quot;Q:\\Objekt\\Kundenerkl&#228;rung\\OSRAM\\Converter&quot;  Is there posibility to completely change those locations on &quot;input method&quot;? So to ask from which path/folder should take files for convert and where to save after ? ...unfortunately I am not good in Macros/Vba stuff...."}, {"owner": {"reputation": 494, "user_id": 10581807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebae5a589919e09b87559b0a6f19ef2b?s=128&d=identicon&r=PG&f=1", "display_name": "extensionhelp", "link": "https://stackoverflow.com/users/10581807/extensionhelp"}, "reply_to_user": {"reputation": 25, "user_id": 10279527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e4ee093e215853182627d188d40bccf?s=128&d=identicon&r=PG&f=1", "display_name": "M1rz&#196;", "link": "https://stackoverflow.com/users/10279527/m1rz%c3%84"}, "edited": false, "score": 0, "creation_date": 1542837038, "post_id": 53420394, "comment_id": 93716285, "body": "You put in this value, and it generates an error?: Q:\\Objekt\\Kundenerkl&#228;rung\\OSRAM\\Converter\\"}, {"owner": {"reputation": 494, "user_id": 10581807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebae5a589919e09b87559b0a6f19ef2b?s=128&d=identicon&r=PG&f=1", "display_name": "extensionhelp", "link": "https://stackoverflow.com/users/10581807/extensionhelp"}, "reply_to_user": {"reputation": 25, "user_id": 10279527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e4ee093e215853182627d188d40bccf?s=128&d=identicon&r=PG&f=1", "display_name": "M1rz&#196;", "link": "https://stackoverflow.com/users/10279527/m1rz%c3%84"}, "edited": false, "score": 0, "creation_date": 1542837299, "post_id": 53420394, "comment_id": 93716381, "body": "I don&#39;t know why you have variables HostFolder AND strFolderPath. Aren&#39;t they always the same value?"}, {"owner": {"reputation": 25, "user_id": 10279527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e4ee093e215853182627d188d40bccf?s=128&d=identicon&r=PG&f=1", "display_name": "M1rz&#196;", "link": "https://stackoverflow.com/users/10279527/m1rz%c3%84"}, "edited": false, "score": 0, "creation_date": 1542839072, "post_id": 53420394, "comment_id": 93716971, "body": "I did lit ong ago-cant even remember, it was ment to be always in the same directory, without changing anything, but nowadays I have to change it, to make it simpler. BUt I tried to delete that line, gives me errors, they have to be both, otherwise cant open anything."}, {"owner": {"reputation": 494, "user_id": 10581807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebae5a589919e09b87559b0a6f19ef2b?s=128&d=identicon&r=PG&f=1", "display_name": "extensionhelp", "link": "https://stackoverflow.com/users/10581807/extensionhelp"}, "reply_to_user": {"reputation": 25, "user_id": 10279527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e4ee093e215853182627d188d40bccf?s=128&d=identicon&r=PG&f=1", "display_name": "M1rz&#196;", "link": "https://stackoverflow.com/users/10279527/m1rz%c3%84"}, "edited": false, "score": 0, "creation_date": 1542839216, "post_id": 53420394, "comment_id": 93717016, "body": "What is this code meant to do? Just tell you whether a folder has subfolders or not? And if it does, tell you how many?"}, {"owner": {"reputation": 25, "user_id": 10279527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e4ee093e215853182627d188d40bccf?s=128&d=identicon&r=PG&f=1", "display_name": "M1rz&#196;", "link": "https://stackoverflow.com/users/10279527/m1rz%c3%84"}, "edited": false, "score": 0, "creation_date": 1542839658, "post_id": 53420394, "comment_id": 93717160, "body": "Okay, code has to do lots of same operations, converting lots of files (.dif file) to .txt file and reducing some columns. So its always the same. Input files we are getting in more folders, which are in one folder before using macro - so It HAS subfolders. Code tells for info how many subs are inside and when I click OK, Macro is doing converting then...   My question was only to skip defining Locations when someone wanna use it, or third person if wanna use it,  path of input and output files has to be changed manually in code - I wanna be able to define it immediately jsut before Macro..."}], "tags": [], "owner": {"reputation": 494, "user_id": 10581807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebae5a589919e09b87559b0a6f19ef2b?s=128&d=identicon&r=PG&f=1", "display_name": "extensionhelp", "link": "https://stackoverflow.com/users/10581807/extensionhelp"}, "is_accepted": true, "score": 1, "last_activity_date": 1542833941, "creation_date": 1542833941, "answer_id": 53420394, "question_id": 53420352, "link": "https://stackoverflow.com/questions/53420352/specify-path-in-excel-vba-when-running-macro/53420394#53420394", "title": "Specify Path in Excel VBA when running Macro", "body": "<p>Yes, you can ask for an input value as such:</p>\n\n<pre><code>strFolderPath = InputBox(\"What folder would you like to use?\")\n</code></pre>\n\n<p>A more user-friendly solution would be to use a <a href=\"https://stackoverflow.com/questions/19372319/vba-folder-picker-set-where-to-start\">file dialog box</a>, though it's somewhat more involved.</p>\n"}], "owner": {"reputation": 25, "user_id": 10279527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e4ee093e215853182627d188d40bccf?s=128&d=identicon&r=PG&f=1", "display_name": "M1rz&#196;", "link": "https://stackoverflow.com/users/10279527/m1rz%c3%84"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "accepted_answer_id": 53420394, "answer_count": 1, "score": 0, "last_activity_date": 1542833941, "creation_date": 1542833736, "last_edit_date": 1542833837, "question_id": 53420352, "link": "https://stackoverflow.com/questions/53420352/specify-path-in-excel-vba-when-running-macro", "title": "Specify Path in Excel VBA when running Macro", "body": "<p>I am having and using this code for (part of it) for some transformations/filtering from certain files to certain files, plus some filtering on sheets and so on... Everything works good for me, but the colleagues from the work wanna also use this code on their PC*s, and there is a problem at start, it has to be edited in the code (path, location) so that someone else can use it - and I dont wanna that anyone from outside have an access to the code easily (ok theyre not skilled but still), so that can mess it up and make it crap what is possible.</p>\n\n<p>Question, is there any line of code that gives like popup message simply asking to define from where you wanna take certain files to where? to avoid going into code and change from there? I hope I was clear enough... </p>\n\n<pre><code>Dim FileSystem As Object\nDim HostFolder As String\n\n' *** Folder with systems to define (path) ***\n HostFolder = \"Q:\\Objekt\\Kundenerkl\u00e4rung\\OSRAM\\Converter\"\n\n' *** If folder is empty/full message ***``\nDim fs, strFolderPath, oFolder\nSet fs = CreateObject(\"Scripting.FileSystemObject\")\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\n\nstrFolderPath = \"Q:\\Objekt\\Kundenerkl\u00e4rung\\OSRAM\\Converter\\\" ' *** This is \nyour folder to define ***\nSet oFolder = fs.GetFolder(strFolderPath)\n If (oFolder.SubFolders.Count = 0) Then\n ' * Folder is Empty *\n   MsgBox \"Folder is empty!\"\n Else\n ' * Folder isn't empty *\n   MsgBox \"Folder not empty. Subfolders count: \" &amp; oFolder.SubFolders.Count\n End If\n\n Set fs = Nothing\n\n Set FileSystem = CreateObject(\"Scripting.FileSystemObject\")\n DoFolder FileSystem.GetFolder(HostFolder)\n\n Application.ScreenUpdating = True\n Application.Calculation = xlCalculationAutomatic\n</code></pre>\n"}, {"tags": ["vba", "outlook", "cdo.message"], "comments": [{"owner": {"reputation": 11, "user_id": 9308240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6043b660531422abc236b4d81550db8e?s=128&d=identicon&r=PG&f=1", "display_name": "user9308240", "link": "https://stackoverflow.com/users/9308240/user9308240"}, "edited": false, "score": 0, "creation_date": 1542833954, "post_id": 53420337, "comment_id": 93715047, "body": "The following lines in the code are what I thought would work, but do not.  objAttachments = myEmail.Attachments   and then SMTPMail.AddAttachment objAttachments    It only attaches an empty BIN file (file extension is BIN)."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1542834152, "post_id": 53420337, "comment_id": 93715136, "body": "See <a href=\"https://stackoverflow.com/questions/29232075/set-binary-base64-data-as-attachment-in-vb-script-cdo-message\">this answer</a> (it&#39;s ASP, but should give the gist) for an idea of how to add an attachment that isn&#39;t from a file.  Note that you&#39;ll need to find a Base64 encoder (or write one - it isn&#39;t hard)."}, {"owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "edited": false, "score": 0, "creation_date": 1542841346, "post_id": 53420337, "comment_id": 93717683, "body": "@user9308240 I don&#39;t see <code>objAttachments</code> declared anywhere. If it should be an object reference, you might need to 1. <code>Dim</code> it as an object and 2. you might need to change <code>objAttachments = myEmail.Attachments</code> to <code>Set objAttachments = myEmail.Attachments</code>. To avoid these kinds of errors, putting <code>Option Explicit</code> at the top of the module/before your code can help."}, {"owner": {"reputation": 11, "user_id": 9308240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6043b660531422abc236b4d81550db8e?s=128&d=identicon&r=PG&f=1", "display_name": "user9308240", "link": "https://stackoverflow.com/users/9308240/user9308240"}, "edited": false, "score": 0, "creation_date": 1543242246, "post_id": 53420337, "comment_id": 93836044, "body": "Thanks for the information.  I will do some testing this evening and post an update by tomorrow morning.  If it matters, the attachments could be anything such as a ODF, DOCX, JPEG, etc.  I have worked with VBA very little and definitely not with Outlook , so it is new territory for me."}, {"owner": {"reputation": 11, "user_id": 9308240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6043b660531422abc236b4d81550db8e?s=128&d=identicon&r=PG&f=1", "display_name": "user9308240", "link": "https://stackoverflow.com/users/9308240/user9308240"}, "edited": false, "score": 0, "creation_date": 1543772503, "post_id": 53420337, "comment_id": 94029119, "body": "I found it easiest to save the file(s) locally and then reattach them to the SMTP message."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 9308240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6043b660531422abc236b4d81550db8e?s=128&d=identicon&r=PG&f=1", "display_name": "user9308240", "link": "https://stackoverflow.com/users/9308240/user9308240"}, "is_accepted": false, "score": 0, "last_activity_date": 1543775222, "last_edit_date": 1543775222, "creation_date": 1543774921, "answer_id": 53583245, "question_id": 53420337, "link": "https://stackoverflow.com/questions/53420337/using-outlook-2016-vba-retain-attachment-when-sending-using-smtp-cdo/53583245#53583245", "title": "Using Outlook 2016 VBA, Retain Attachment When Sending using SMTP/CDO", "body": "<p>Here is my solution.  It works for my situation.</p>\n\n<pre><code>Sub ForwardEmail(myEmail As Outlook.MailItem) 'subroutine called from Outlook rule, when new incoming email message arrives\n\nOn Error GoTo Resetvar\nSet objSMTPMail = CreateObject(\"CDO.Message\") 'needed to send SMTP mail\nSet objConf = CreateObject(\"CDO.Configuration\") 'needed for SMTP configuration\n\nSet objFlds = objConf.Fields 'used for SMTP configuration\n\n'Set various parameters and properties of CDO object\n\nobjFlds.Item(\"http://schemas.microsoft.com/cdo/configuration/sendusing\") = 2 'cdoSendUsingPort\nobjFlds.Item(\"http://schemas.microsoft.com/cdo/configuration/smtpserver\") = \"smtpout.test.com\" 'define SMTP server\nobjFlds.Item(\"http://schemas.microsoft.com/cdo/configuration/smtpserverport\") = 25 'default port for email\n\nobjFlds.Update\n\nobjSMTPMail.Configuration = objConf\n\n'EX value is an Exchange mailbox locally\nIf myEmail.SenderEmailType = \"EX\" Then\n    objSMTPMail.From = myEmail.Sender.GetExchangeUser.PrimarySmtpAddress\nElse\n    objSMTPMail.From = myEmail.SenderEmailAddress 'takes email address from the original email and uses it in the new SMTP email\nEnd If\nDim i As Integer\ni = -1\nDim arrAtmt() As String\nDim FileName As String\nFor Each Atmt In myEmail.Attachments\n    FileName = \"C:\\temp\\\" &amp; myEmail.EntryID &amp; \".\" &amp; Atmt.FileName\n    Atmt.SaveAsFile FileName\n    i = i + 1\n    ReDim Preserve arrAtmt(i)\n    arrAtmt(i) = FileName\nNext Atmt\n\n    objSMTPMail.Subject = myEmail.Subject 'use the subject from the original email message for the SMTP message\n    objSMTPMail.HTMLBody = myEmail.HTMLBody 'myEmail.HTMLBody is necessary to retain Electronic Inquiry Form formatting\n    objSMTPMail.To = \"mary@test.com\"\n\n    If i &gt; -1 Then\n        For counter = 0 To i\n            objSMTPMail.AddAttachment arrAtmt(counter)\n        Next\n    End If\n    objSMTPMail.Send\n\nErase arrAtmt\n\nResetvar:\n\nSet objFlds = Nothing\nSet objConf = Nothing\nSet objSMTPMail = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9308240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6043b660531422abc236b4d81550db8e?s=128&d=identicon&r=PG&f=1", "display_name": "user9308240", "link": "https://stackoverflow.com/users/9308240/user9308240"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 106, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1543775222, "creation_date": 1542833683, "last_edit_date": 1542887881, "question_id": 53420337, "link": "https://stackoverflow.com/questions/53420337/using-outlook-2016-vba-retain-attachment-when-sending-using-smtp-cdo", "title": "Using Outlook 2016 VBA, Retain Attachment When Sending using SMTP/CDO", "body": "<p>I would like to avoid saving the attachment from the original Outlook message to a local drive and then reattach it to the SMTP message.  The message body is recreated for the SMTP message, which works fine.</p>\n\n<pre><code>Sub ForwardEmail(myEmail As Outlook.MailItem) 'subroutine called from Outlook rule, when new incoming email message arrives\nConst PR_SMTP_ADDRESS As String = \"http://schemas.microsoft.com/mapi/proptag/0x0076001E\"\nSet objSMTPMail = CreateObject(\"CDO.Message\") 'needed to send SMTP mail\nSet objConf = CreateObject(\"CDO.Configuration\") 'needed for SMTP configuration\n\nSet objFlds = objConf.Fields 'used for SMTP configuration\n\n'Set various parameters and properties of CDO object\n\nobjFlds.Item(\"http://schemas.microsoft.com/cdo/configuration/sendusing\") = 2     \nobjFlds.Item(\"http://schemas.microsoft.com/cdo/configuration/smtpserver\") = \"smtpout.test.com\" 'define SMTP server\nobjFlds.Item(\"http://schemas.microsoft.com/cdo/configuration/smtpserverport\") = 25 'default port for email\n\nobjFlds.Update\n\nobjSMTPMail.Configuration = objConf\n\nIf myEmail.SenderEmailType = \"EX\" Then\n  objSMTPMail.From = myEmail.Sender.GetExchangeUser.PrimarySmtpAddress\nElse\n  objSMTPMail.From = myEmail.SenderEmailAddress 'takes email address from   the original email and uses it in the new SMTP email\n objAttachments = myEmail.Attachments  ' I believe this is how to get the attachments\n\nEnd If\n\nobjSMTPMail.Subject = myEmail.Subject 'use the subject from the original email message for the SMTP message\nobjSMTPMail.HTMLBody = myEmail.HTMLBody 'myEmail.HTMLBody is necessary to retain Electronic Inquiry Form formatting\nobjSMTPMail.To = \"nobody@test.com\"\nobjSMTPMail.AddAttachment objAttachments ' tried to add attachment\n'send the SMTP message via the SMTP server\nobjSMTPMail.Send\n\n\n\n\n'Set all objects to nothing after sending the email\n\nSet objFlds = Nothing\nSet objConf = Nothing\nSet objSMTPMail = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1542833461, "post_id": 53420236, "comment_id": 93714820, "body": "Can you edit the question to include more of the code? The 2 lines included aren&#39;t enough to give more than the most general suggestions."}, {"owner": {"reputation": 663, "user_id": 7131122, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VRUK1MTcgY4/AAAAAAAAAAI/AAAAAAAAA_8/VlNsZARthCY/photo.jpg?sz=128", "display_name": "Christofer Weber", "link": "https://stackoverflow.com/users/7131122/christofer-weber"}, "edited": false, "score": 0, "creation_date": 1542834456, "post_id": 53420236, "comment_id": 93715263, "body": "Do you want to assign the name of a sheet to each shape? Like changing the name of the shape to the name of the sheet?  And if so, what you you mean by &quot;passing the values from the Loop to the Sheet Names&quot;. Are you changing the sheet names?"}, {"owner": {"reputation": 21, "user_id": 10687891, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Y9YloKkrrCk/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-ie2Y8ffICwWAaGZAfuvTUTUeippQ/mo/photo.jpg?sz=128", "display_name": "Tom Coker", "link": "https://stackoverflow.com/users/10687891/tom-coker"}, "edited": false, "score": 1, "creation_date": 1542837623, "post_id": 53420236, "comment_id": 93716488, "body": "Thanks for the questions. I edited my post to add a little clarity, but definitely let me know if I&#39;m still not being clear enough."}, {"owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "edited": false, "score": 0, "creation_date": 1542842591, "post_id": 53420236, "comment_id": 93718089, "body": "You need some way of dynamically determining how many splices are on your <code>Splice_Diagram</code> worksheet (might be as simple as just reading the values in the relevant range). Once you know that, you can loop over each solice -- and stick the code that you use to create each shape (plus text) inside that loop. You might need to change parts of the loop to refer to the current iteration/splice being looped over."}, {"owner": {"reputation": 663, "user_id": 7131122, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VRUK1MTcgY4/AAAAAAAAAAI/AAAAAAAAA_8/VlNsZARthCY/photo.jpg?sz=128", "display_name": "Christofer Weber", "link": "https://stackoverflow.com/users/7131122/christofer-weber"}, "edited": false, "score": 0, "creation_date": 1542905462, "post_id": 53420236, "comment_id": 93744429, "body": "Do you want the shape text to be the value from &quot;A3&quot; from the corresponding sheet? If you wouldn&#39;t mind, an image with an example would be helpful."}], "owner": {"reputation": 21, "user_id": 10687891, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Y9YloKkrrCk/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-ie2Y8ffICwWAaGZAfuvTUTUeippQ/mo/photo.jpg?sz=128", "display_name": "Tom Coker", "link": "https://stackoverflow.com/users/10687891/tom-coker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 171, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1542837271, "creation_date": 1542833245, "last_edit_date": 1542837271, "question_id": 53420236, "link": "https://stackoverflow.com/questions/53420236/using-for-each-loop-to-programmatically-generate-shapes-and-add-macros", "title": "Using For Each Loop to Programmatically Generate Shapes and Add Macros", "body": "<p>Okay, I'm in a bit over my head with this one, but I'm hoping that the answer is much simpler than it seems from my limited perspective. </p>\n\n<p>I have an Excel workbook that I'm trying to set up as a Macro-enabled Template, and so I need all of my code and formulas to be extremely flexible, since they'll need to adapt dynamically to the project they're being used for in each instance.</p>\n\n<p>Sheet 1 will be the Splice_Diagram sheet, and I have a named range on this sheet with the following reference:</p>\n\n<p><code>=Splice_Diagram!$R$3:INDEX(Splice_Diagram!$R:$R,MATCH(\"\",Splice_Diagram!$R:$R,-1))</code></p>\n\n<p>The number of sheets named in this range will be variable based on the number of splices the project requires.</p>\n\n<p>I need to create a macro to iterate through this list, create a shape for each, and assign the following to each shape:</p>\n\n<pre><code>Sheets(\"[Name of Sheet indicated in List]\").Select\nRange(\"A3\").Select\n</code></pre>\n\n<p>The individual phases of this, I'm more or less able to muddle through, but I'm having trouble passing the names of the sheets iterated through in the Loop to the Macro Sheets.Select command.</p>\n\n<p>For instance, if there are three Splices, then the list on the Splice_Diagram page will be Splice_01, Splice_02, and Splice_03. This should result in three shapes with Text that says Splice_01, Splice_02, and Splice_03 respectively. These shapes should run: </p>\n\n<p>Splice_01:  </p>\n\n<pre><code>Sheets(\"Splice_01\").Select\nRange(\"A3\").Select\n</code></pre>\n\n<p>Splice_02:  </p>\n\n<pre><code>Sheets(\"Splice_02\").Select\nRange(\"A3\").Select\n</code></pre>\n\n<p>Splice_03:  </p>\n\n<pre><code>Sheets(\"Splice_03\").Select\nRange(\"A3\").Select\n</code></pre>\n\n<p>The sheets will always be labeled with the Prefix \"Splice_\" and an incrementing number, if that helps. However, the number of Splices will always be different.</p>\n\n<p>The locations of the shapes don't matter at all, even if they're all stacked on top of each other, because I'll need to move them around to simulate the network anyway.</p>\n\n<p>For the creation of the shapes themselves, I'm just using this little piece currently:</p>\n\n<pre><code>SpliceGuide.Shapes.AddShape msoShapeRectangle, 50, 50, 100, 200\n</code></pre>\n\n<p>I hope this was clear, please let me know if there's something incredibly obvious that I'm missing.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 865, "user_id": 10361731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8873db235bacaa9d53de9c31a0b8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Jchang43", "link": "https://stackoverflow.com/users/10361731/jchang43"}, "edited": false, "score": 1, "creation_date": 1542830487, "post_id": 53419648, "comment_id": 93713587, "body": "Try adding a <code>.</code> to <code>Rows(Cell.Row).EntireRow.Delete</code>"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1542830509, "post_id": 53419648, "comment_id": 93713599, "body": "2 things. If you&#39;re deleting rows, you need to go backwards through the collection. Also, you need to fully qualify <code>Rows(Cell.Row).EntireRow.Delete</code>."}, {"owner": {"reputation": 33, "user_id": 6484977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc6619b48d3a7fdf55e3ddda9a03df6f?s=128&d=identicon&r=PG&f=1", "display_name": "El Asado", "link": "https://stackoverflow.com/users/6484977/el-asado"}, "edited": false, "score": 0, "creation_date": 1542830816, "post_id": 53419648, "comment_id": 93713719, "body": "I&#39;m very sorry, but can you explain what qualify means?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1542830821, "post_id": 53419648, "comment_id": 93713720, "body": "<code>Cell.EntireRow.Delete</code> would be more direct"}, {"owner": {"reputation": 865, "user_id": 10361731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8873db235bacaa9d53de9c31a0b8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Jchang43", "link": "https://stackoverflow.com/users/10361731/jchang43"}, "edited": false, "score": 0, "creation_date": 1542830840, "post_id": 53419648, "comment_id": 93713729, "body": "<a href=\"https://stackoverflow.com/questions/24358183/reverse-order-of-for-each-loop\">this might be of use</a>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1542831018, "post_id": 53419648, "comment_id": 93713806, "body": "Also: <a href=\"https://stackoverflow.com/questions/28439376/what-is-the-default-scope-of-worksheets-and-cells-and-range/28439984#28439984\" title=\"what is the default scope of worksheets and cells and range\">stackoverflow.com/questions/28439376/&hellip;</a>"}, {"owner": {"reputation": 33, "user_id": 6484977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc6619b48d3a7fdf55e3ddda9a03df6f?s=128&d=identicon&r=PG&f=1", "display_name": "El Asado", "link": "https://stackoverflow.com/users/6484977/el-asado"}, "edited": false, "score": 0, "creation_date": 1542831266, "post_id": 53419648, "comment_id": 93713899, "body": "I&#39;m reading through the posts and working on figuring it out, but thank you all so much for your help!  This goes a long way!"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 6484977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc6619b48d3a7fdf55e3ddda9a03df6f?s=128&d=identicon&r=PG&f=1", "display_name": "El Asado", "link": "https://stackoverflow.com/users/6484977/el-asado"}, "edited": false, "score": 0, "creation_date": 1542832495, "post_id": 53419866, "comment_id": 93714413, "body": "THANK YOU SO MUCH!  Yes, I&#39;ll research more into the inbuilt functions to get better, but both of these codes worked perfectly, thank you."}, {"owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "reply_to_user": {"reputation": 33, "user_id": 6484977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc6619b48d3a7fdf55e3ddda9a03df6f?s=128&d=identicon&r=PG&f=1", "display_name": "El Asado", "link": "https://stackoverflow.com/users/6484977/el-asado"}, "edited": false, "score": 0, "creation_date": 1542833316, "post_id": 53419866, "comment_id": 93714768, "body": "@ElAsado, just a heads up. You might need to change <code>&quot;=110&quot;</code> to <code>&quot;&lt;&gt;110&quot;</code> here, as your title and original post suggests you want to delete the rows where column D does not equal 110. But other than that, you&#39;re good I think."}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1542870515, "post_id": 53419866, "comment_id": 93725224, "body": "@Reafidy: You probably haven&#39;t noticed, the first solution deletes row 1 regardless of the content. Know how to fix it?"}], "tags": [], "owner": {"reputation": 7898, "user_id": 795231, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b849439b7749c507eaaa94e50759a623?s=128&d=identicon&r=PG", "display_name": "Reafidy", "link": "https://stackoverflow.com/users/795231/reafidy"}, "is_accepted": true, "score": 3, "last_activity_date": 1543263852, "last_edit_date": 1543263852, "creation_date": 1542831410, "answer_id": 53419866, "question_id": 53419648, "link": "https://stackoverflow.com/questions/53419648/excel-vba-delete-rows-if-value-not-equal-to-a-value/53419866#53419866", "title": "Excel VBA: Delete rows if value not equal to a value?", "body": "<p>Instead of looping, make use of excels inbuilt functions, its cleaner and more concise.</p>\n\n<pre><code>With Sheets(1).UsedRange\n    .AutoFilter Field:=4, Criteria1:=\"&lt;&gt;110\"\n    .Offset(1).SpecialCells(xlCellTypeVisible).EntireRow.Delete\n    .AutoFilter\nEnd With\n</code></pre>\n\n<p>if you insist on looping then use the following code:</p>\n\n<pre><code>With Sheets(1).UsedRange\n    For lrow = .Rows.Count To 2 Step -1\n        If .Cells(lrow, 4).Value &lt;&gt; 110 Then .Rows(lrow).Delete\n    Next lrow\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "is_accepted": false, "score": 1, "last_activity_date": 1542832009, "creation_date": 1542832009, "answer_id": 53419991, "question_id": 53419648, "link": "https://stackoverflow.com/questions/53419648/excel-vba-delete-rows-if-value-not-equal-to-a-value/53419991#53419991", "title": "Excel VBA: Delete rows if value not equal to a value?", "body": "<p>Untested, but maybe something like:</p>\n\n<pre><code>Option explicit\n\nSub DeleteRows()\n\nWith thisworkbook.worksheets(1)\n    ' loop column D until last cell with value (not entire column)\n\nDim lastRow as long\nlastRow = .Cells(.Rows.Count, \"D\").End(xlUp).Row\n\nDim rowIndex as long\nFor rowIndex = lastRow to 2 step -1\n\nIf .cells(rowIndex, \"D\").value2 &lt;&gt; 110 then\n.cells(rowIndex, \"D\").entirerow.delete\nEnd if\n\nNext rowIndex\n\nEnd With\n\nEnd sub\n</code></pre>\n\n<p>If you have a lot of rows, you could use <code>union</code> to build a range consisting of all rows to be deleted, then delete them in one go.</p>\n"}], "owner": {"reputation": 33, "user_id": 6484977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc6619b48d3a7fdf55e3ddda9a03df6f?s=128&d=identicon&r=PG&f=1", "display_name": "El Asado", "link": "https://stackoverflow.com/users/6484977/el-asado"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3517, "favorite_count": 0, "accepted_answer_id": 53419866, "answer_count": 2, "score": 0, "last_activity_date": 1583476725, "creation_date": 1542830306, "last_edit_date": 1583476725, "question_id": 53419648, "link": "https://stackoverflow.com/questions/53419648/excel-vba-delete-rows-if-value-not-equal-to-a-value", "title": "Excel VBA: Delete rows if value not equal to a value?", "body": "<p>So I've been searching hard to find why my code hasn't been working, but every time I try, I get a result where nothing is changed.  Can someone please tell me what I'm missing?  Sorry, I'm a total novice but I'm trying.</p>\n\n<pre><code>   Dim Cell As Range\n\nWith Sheets(1)\n    ' loop column D until last cell with value (not entire column)\n    For Each Cell In .Range(\"D2:D\" &amp; .Cells(.Rows.Count, \"D\").End(xlUp).Row)\n        If Cell.Value &lt;&gt; 110 Then\n            Rows(Cell.Row).EntireRow.Delete\n        End If\n    Next Cell\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 333, "user_id": 4110580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/xZmSR.png?s=128&g=1", "display_name": "LazyBear", "link": "https://stackoverflow.com/users/4110580/lazybear"}, "edited": false, "score": 0, "creation_date": 1542829140, "post_id": 53419331, "comment_id": 93712994, "body": "Works like a charm!  Thank You."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 333, "user_id": 4110580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/xZmSR.png?s=128&g=1", "display_name": "LazyBear", "link": "https://stackoverflow.com/users/4110580/lazybear"}, "edited": false, "score": 2, "creation_date": 1542830948, "post_id": 53419331, "comment_id": 93713771, "body": "My pleasure. Looks like the only thing you didn&#39;t try!"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 5, "last_activity_date": 1542828779, "creation_date": 1542828779, "answer_id": 53419331, "question_id": 53419291, "link": "https://stackoverflow.com/questions/53419291/how-to-disable-cell-formula-suggestions/53419331#53419331", "title": "How to Disable Cell Formula Suggestions?", "body": "<p>Try this. You can turn off Formula Autocompletion via Excel Options (under Formula) or in code</p>\n\n<pre><code>Application.DisplayFormulaAutoComplete=False\n</code></pre>\n"}], "owner": {"reputation": 333, "user_id": 4110580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/xZmSR.png?s=128&g=1", "display_name": "LazyBear", "link": "https://stackoverflow.com/users/4110580/lazybear"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 53419331, "answer_count": 1, "score": 4, "last_activity_date": 1583476736, "creation_date": 1542828604, "last_edit_date": 1583476736, "question_id": 53419291, "link": "https://stackoverflow.com/questions/53419291/how-to-disable-cell-formula-suggestions", "title": "How to Disable Cell Formula Suggestions?", "body": "<p>I am designing an ID scanner, and I do not want any kind of autocorrection or cell suggestions so the barcode can scan properly and cleanly.  I am trying to diable any such pop-up or drop-down.  Right now, I can't seem to find the appropriate call to disable the Formula suggestion dropdown.  I have attempted the following lines to disable all versions of autocorrecting:</p>\n\n<pre><code>Private Sub Workbook_Activate()\n    Application.CellDragAndDrop = False\n    Application.EnableAutoComplete = False\n    Application.AutoCorrect.AutoFillFormulasInLists = False\n    Application.AutoCorrect.DisplayAutoCorrectOptions = False\nEnd Sub\n</code></pre>\n\n<p>What else can I try?</p>\n\n<p>This is what I'm talking about:\n<a href=\"https://i.stack.imgur.com/RJeQx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RJeQx.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["html", "excel", "vba", "web-scraping"], "comments": [{"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 0, "creation_date": 1542827376, "post_id": 53418971, "comment_id": 93712182, "body": "Your problem statement is not specific enough.  Tell us the exact error you&#39;re getting, and on which line of code you are getting it."}, {"owner": {"reputation": 13, "user_id": 6690719, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e62e8abd2cd4dd3fa385c741270d2fae?s=128&d=identicon&r=PG&f=1", "display_name": "Car", "link": "https://stackoverflow.com/users/6690719/car"}, "reply_to_user": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 0, "creation_date": 1542828060, "post_id": 53418971, "comment_id": 93712467, "body": "Hi Robert, with the first code i have access denied in enterprise network but is because the .get line gives the error. The second works, only sometimes but with no errors."}, {"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 0, "creation_date": 1542829456, "post_id": 53418971, "comment_id": 93713129, "body": "OK, well the &quot;Access Denied&quot; error is an IT problem.  You&#39;re getting it because the folks running the enterprise network haven&#39;t given you those rights."}, {"owner": {"reputation": 13, "user_id": 6690719, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e62e8abd2cd4dd3fa385c741270d2fae?s=128&d=identicon&r=PG&f=1", "display_name": "Car", "link": "https://stackoverflow.com/users/6690719/car"}, "reply_to_user": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 0, "creation_date": 1542829819, "post_id": 53418971, "comment_id": 93713282, "body": "Thanks again Robert. That i know! and i managed to get the other code working, but the issue is that sometimes opens the ie page but dont pass data to sheet."}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1542953058, "last_edit_date": 1542953058, "creation_date": 1542831423, "answer_id": 53419869, "question_id": 53418971, "link": "https://stackoverflow.com/questions/53418971/excel-vba-get-data-from-webpage-in-enterprise-network/53419869#53419869", "title": "Excel VBA get data from webpage in enterprise network", "body": "<p>This is based on you saying IE can generally access the page (also ensure the site is whitelisted.)</p>\n\n<p>Whole table:</p>\n\n<pre><code>Option Explicit\nPublic Sub GetTable()\n    Dim IE As New InternetExplorer, hTable As HTMLTable\n    Dim ws As Worksheet, t As Date\n    Const MAX_WAIT_SEC As Long = 5\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n\n    With IE\n        .Visible = True\n        .navigate \"https://www.accuweather.com/en/pt/lisbon/274087/november-weather/274087?monyr=11/1/2018&amp;view=table\"\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n        With .document\n            t = Timer\n            Do\n                DoEvents\n                On Error Resume Next\n                Set hTable = .querySelector(\".calendar-list\")\n\n                On Error GoTo 0\n                If Timer - t &gt; MAX_WAIT_SEC Then Exit Do\n            Loop While hTable Is Nothing\n\n            If Not hTable Is Nothing Then\n                Dim clipboard As Object\n                Set clipboard = GetObject(\"New:{1C3B4210-F441-11CE-B9EA-00AA006B1A69}\")\n                clipboard.SetText hTable.outerHTML\n                clipboard.PutInClipboard\n                ws.Cells(1, 1).PasteSpecial\n            End If\n        End With\n        .Quit\n    End With\nEnd Sub\n</code></pre>\n\n<p>Just the two columns you mention in comments:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub GetTable()\n    Dim IE As New InternetExplorer, hTable As HTMLTable\n    Dim ws As Worksheet, t As Date, r As Long, c As Long, i As Long, j As Long\n    Const MAX_WAIT_SEC As Long = 5\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n\n    With IE\n        .Visible = True\n        .navigate \"https://www.accuweather.com/en/pt/lisbon/274087/november-weather/274087?monyr=11/1/2018&amp;view=table\"\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n        With .document\n            t = Timer\n            Do\n                DoEvents\n                On Error Resume Next\n                Set hTable = .querySelector(\".calendar-list\")\n\n                On Error GoTo 0\n                If Timer - t &gt; MAX_WAIT_SEC Then Exit Do\n            Loop While hTable Is Nothing\n\n            If Not hTable Is Nothing Then\n                For i = 1 To hTable.getElementsByTagName(\"tr\").Length - 1\n                    r = r + 1\n                    ws.Cells(r, 1) = hTable.getElementsByTagName(\"th\")(i).innerText\n                    ws.Cells(r, 2) = hTable.getElementsByTagName(\"tr\")(i).getElementsByTagName(\"td\")(0).innerText\n                Next\n            End If\n        End With\n        .Quit\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>References (VBE > Tools > References):</strong></p>\n\n<ol>\n<li>Microsoft Internet Controls</li>\n<li>Microsoft HTML Object Library</li>\n</ol>\n"}], "owner": {"reputation": 13, "user_id": 6690719, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e62e8abd2cd4dd3fa385c741270d2fae?s=128&d=identicon&r=PG&f=1", "display_name": "Car", "link": "https://stackoverflow.com/users/6690719/car"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 53419869, "answer_count": 1, "score": 0, "last_activity_date": 1583476750, "creation_date": 1542827209, "last_edit_date": 1583476750, "question_id": 53418971, "link": "https://stackoverflow.com/questions/53418971/excel-vba-get-data-from-webpage-in-enterprise-network", "title": "Excel VBA get data from webpage in enterprise network", "body": "<p>I'am an entusiast with vba.\nIn my company we conect to internet throught a proxy .pac file.\nI need to get the weather from accuweather.</p>\n\n<p>With the help of what i read in web i managed to do something that works but outside the company, for example in my home.\nThis is the code that is called by a form where the user selects the city, month and year.</p>\n\n<pre><code>    Option Explicit\n\nSub GetExchangeRates(city As String, FromCurrency As String, Amount As String)\n\nDim XMLPage As New MSXML2.XMLHTTP60\nDim htmldoc As New MSHTML.HTMLDocument\nDim URL As String\nDim cn As String\n\nDim m As Long\nDim y As Date\nDim dfr As String\n\nDim d_until As Date\nDim MonthNm As String\n\nMonthNm = FromCurrency\nm = Application.Evaluate(\"=MONTH(1&amp;\" &amp; Chr(34) &amp; MonthNm &amp; Chr(34) &amp; \")\")\ny = Amount\ndfr = Format(DateSerial(y, m, 1), \"m/d/yyyy\")\n\nIf city = \"leiria\" Then cn = \"273891\"\nIf city = \"lisbon\" Then cn = \"274087\"\nIf city = \"porto\" Then cn = \"275317\"\nIf city = \"faro\" Then cn = \"273190\"\nIf city = \"coimbra\" Then cn = \"272818\"\n\nOn Error GoTo Error_Handler\n\nURL = \"https://www.accuweather.com/pt/pt/\" &amp; city &amp; \"/\" &amp; cn &amp; \"/\" &amp; \nFromCurrency &amp; \"-weather/\" &amp; cn &amp; \"?monyr=\" &amp; dfr &amp; \"&amp;view=table\"\n\nXMLPage.Open \"GET\", URL, False\nXMLPage.send\n\nhtmldoc.body.innerHTML = XMLPage.responseText\n\nProcessHTMLPage htmldoc\n\nRange(\"C1\").Value = city\nRange(\"D1\").Value = Amount\nRange(\"G2\").Value = \"Data\"\n\nApplication.Run \"FillRow\"\n\nError_Handler_Exit:\nOn Error Resume Next\nExit Sub\n\nError_Handler:\nMsgBox \"Ocorreu um erro de rede.\" &amp; vbCrLf &amp; vbCrLf &amp; _\n       \"Error Number: \" &amp; Err.Number &amp; vbCrLf &amp; _\n       \"Error Source: getOperatingSystem\" &amp; vbCrLf &amp; _\n       \"Error Description: \" &amp; Err.Description, _\n       vbCritical, \"Internet access error!\"\nResume Error_Handler_Exit\n\nEnd Sub\n\nPrivate Sub OpenRatesForm()\nRatesForm.Show\n\nEnd Sub\n\n\nSub ProcessHTMLPage(HTMLPage As MSHTML.HTMLDocument)\nDim HTMLTable As MSHTML.IHTMLElement\nDim HTMLTAbles As MSHTML.IHTMLElementCollection\nDim HTMLRow As MSHTML.IHTMLElement\nDim HTMLCell As New MSHTML.HTMLDocument\nDim RowNum As Long, ColNum As Integer\n\nSet HTMLTAbles = HTMLPage.getElementsByTagName(\"table\")\n\nFor Each HTMLTable In HTMLTAbles\nDebug.Print HTMLTable.className\n\nWorksheets.Add\nRange(\"A1\").Value = HTMLTable.className\nRange(\"B1\").Value = Now\n\nRowNum = 2\nFor Each HTMLRow In HTMLTable.getElementsByTagName(\"tr\")\n    'Debug.Print vbTab &amp; HTMLRow.innerText\n\n    ColNum = 1\n    For Each HTMLCell In HTMLRow.Children\n        Cells(RowNum, ColNum) = HTMLCell.innerText\n        ColNum = ColNum + 1\n    Next HTMLCell\n\n ''''   For Each HTMLCell In HTMLTable.getElementsByTagName(\"td\")\n\n RowNum = RowNum + 1\n\n Next HTMLRow\n\nNext HTMLTable\n\nSet HTMLTAbles = Nothing\nEnd Sub\n</code></pre>\n\n<p>If run this in company i get errors from access denied e others.\nSo I read more and find that doing this with ie could work.\nIt bypasses the issue with acessing to internet, but the issue is that i cant get do make to work with the form and sometimes the ie opens with the accuweather page but does not displays data in excel.</p>\n\n<pre><code>    Sub Grabaccuwther()\n\nDim objIE As InternetExplorer\nDim ele As Object\nDim y As Integer\nDim url As String\n\n'start a new browser instance\nSet objIE = CreateObject(\"InternetExplorer.Application\")\n'make browser visible\nobjIE.Visible = True\n\n url = \"https://www.accuweather.com/en/pt/lisbon/274087/november-weather/274087?monyr=11/1/2018&amp;view=table\"\n\n'navigate to page with needed data\nobjIE.navigate url\n\n'wait for page to load\n Application.StatusBar = \"Loading Web page \u2026\"\n' wait until the page loads before doing anything\n\nDo While objIE.Busy = True Or objIE.readyState &lt;&gt; 4: DoEvents: Loop\n\n'we will output data to excel, starting on row 1\ny = 1\n\nFor Each ele In objIE.Document.getElementsByTagName(\"tr\")\n\n    'each 'tr' (table row) element contains 4 children ('td') elements\n    'put text of 1st 'td' in col A\n    Sheets(\"Sheet1\").Range(\"A\" &amp; y).Value = ele.Children(0).textContent\n    'put text of 2nd 'td' in col B\n    Sheets(\"Sheet1\").Range(\"B\" &amp; y).Value = ele.Children(1).textContent\n    'put text of 3rd 'td' in col C\n    Sheets(\"Sheet1\").Range(\"B\" &amp; y).Value = ele.Children(2).textContent\n    'put text of 4th 'td' in col D\n    Sheets(\"Sheet1\").Range(\"D\" &amp; y).Value = ele.Children(3).textContent\n    'increment row counter by 1\n    y = y + 1\nNext\n\nApplication.StatusBar = \"Web page Loaded!\"\nobjIE.Quit\n\nEnd Sub\n</code></pre>\n\n<p>I'm trying about a month do do this and I have changed some thinks but can't get this to work.\nI aprreciate help to acomplish this.\nThanks.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 4, "creation_date": 1542827855, "post_id": 53418976, "comment_id": 93712372, "body": "This still won&#39;t compile though if <code>&quot;T:\\Restricted - Department\\GLA_Shortcuts\\Reagent and Column           Validation\\&quot;</code> is on multiple lines."}, {"owner": {"reputation": 15, "user_id": 10642148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8bcd3375d137865751bdbda607a94a?s=128&d=identicon&r=PG&f=1", "display_name": "Steve L", "link": "https://stackoverflow.com/users/10642148/steve-l"}, "edited": false, "score": 0, "creation_date": 1542830588, "post_id": 53418976, "comment_id": 93713637, "body": "Now getting a &quot;Run-time error &#39;424&#39;: Object required."}, {"owner": {"reputation": 15, "user_id": 10642148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8bcd3375d137865751bdbda607a94a?s=128&d=identicon&r=PG&f=1", "display_name": "Steve L", "link": "https://stackoverflow.com/users/10642148/steve-l"}, "edited": false, "score": 0, "creation_date": 1542831853, "post_id": 53418976, "comment_id": 93714159, "body": "It is flagging the object required on the (AciveWorkbook.SaveAs Filename:=filepath, FileFormat:=xlOpenXMLWorkbookMacroEnabled, CreateBackup:=False)"}, {"owner": {"reputation": 494, "user_id": 10581807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebae5a589919e09b87559b0a6f19ef2b?s=128&d=identicon&r=PG&f=1", "display_name": "extensionhelp", "link": "https://stackoverflow.com/users/10581807/extensionhelp"}, "edited": false, "score": 0, "creation_date": 1542831952, "post_id": 53418976, "comment_id": 93714205, "body": "In your comment above, you have AciveWorkbook (missing a T in Active). I&#39;m assuming that problem isn&#39;t in your code?"}, {"owner": {"reputation": 15, "user_id": 10642148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8bcd3375d137865751bdbda607a94a?s=128&d=identicon&r=PG&f=1", "display_name": "Steve L", "link": "https://stackoverflow.com/users/10642148/steve-l"}, "edited": false, "score": 0, "creation_date": 1542832210, "post_id": 53418976, "comment_id": 93714293, "body": "Well it isn&#39;t anymore :D... Now getting Run-time error &#39;1004&#39;: Method &#39;SaveAs&#39; of object&#39;_Workbook&#39; failed"}, {"owner": {"reputation": 494, "user_id": 10581807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebae5a589919e09b87559b0a6f19ef2b?s=128&d=identicon&r=PG&f=1", "display_name": "extensionhelp", "link": "https://stackoverflow.com/users/10581807/extensionhelp"}, "edited": false, "score": 0, "creation_date": 1542832812, "post_id": 53418976, "comment_id": 93714560, "body": "Okay. Can you step through it (by hitting F8), and just after the &#39;filepath = &#39; line, see what the value is?"}, {"owner": {"reputation": 15, "user_id": 10642148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8bcd3375d137865751bdbda607a94a?s=128&d=identicon&r=PG&f=1", "display_name": "Steve L", "link": "https://stackoverflow.com/users/10642148/steve-l"}, "edited": false, "score": 0, "creation_date": 1542833682, "post_id": 53418976, "comment_id": 93714917, "body": "Sorry not sure what you mean by see what the value is? Thanks for all the help by the way!!!!"}, {"owner": {"reputation": 494, "user_id": 10581807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebae5a589919e09b87559b0a6f19ef2b?s=128&d=identicon&r=PG&f=1", "display_name": "extensionhelp", "link": "https://stackoverflow.com/users/10581807/extensionhelp"}, "edited": false, "score": 0, "creation_date": 1542833748, "post_id": 53418976, "comment_id": 93714949, "body": "If you&#39;re stepping through the code with F8, you&#39;ll see each line highlighted. Just after the filepath = line, put your mouseover &quot;filepath&quot; and see what it says. It should display the current value, and that might give you a clue to the issue."}, {"owner": {"reputation": 15, "user_id": 10642148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8bcd3375d137865751bdbda607a94a?s=128&d=identicon&r=PG&f=1", "display_name": "Steve L", "link": "https://stackoverflow.com/users/10642148/steve-l"}, "edited": false, "score": 0, "creation_date": 1542833987, "post_id": 53418976, "comment_id": 93715063, "body": "says filepath = empty. could it be that I need to clarify Range B6 as activeworkbook or active sheet?"}, {"owner": {"reputation": 494, "user_id": 10581807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebae5a589919e09b87559b0a6f19ef2b?s=128&d=identicon&r=PG&f=1", "display_name": "extensionhelp", "link": "https://stackoverflow.com/users/10581807/extensionhelp"}, "edited": false, "score": 0, "creation_date": 1542834123, "post_id": 53418976, "comment_id": 93715119, "body": "That probably isn&#39;t the issue. It will default to the sheet that you&#39;re running the macro from. Can you repost all of your code, along with the current error message, in the initial question?"}, {"owner": {"reputation": 15, "user_id": 10642148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8bcd3375d137865751bdbda607a94a?s=128&d=identicon&r=PG&f=1", "display_name": "Steve L", "link": "https://stackoverflow.com/users/10642148/steve-l"}, "edited": false, "score": 0, "creation_date": 1542834440, "post_id": 53418976, "comment_id": 93715257, "body": "Done, sorry tried moving this to chat but my rep is too low."}, {"owner": {"reputation": 494, "user_id": 10581807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebae5a589919e09b87559b0a6f19ef2b?s=128&d=identicon&r=PG&f=1", "display_name": "extensionhelp", "link": "https://stackoverflow.com/users/10581807/extensionhelp"}, "edited": false, "score": 0, "creation_date": 1542834701, "post_id": 53418976, "comment_id": 93715374, "body": "Same. Let&#39;s try it now with just one &quot; on each side instead of &quot;&quot;&quot;"}, {"owner": {"reputation": 494, "user_id": 10581807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebae5a589919e09b87559b0a6f19ef2b?s=128&d=identicon&r=PG&f=1", "display_name": "extensionhelp", "link": "https://stackoverflow.com/users/10581807/extensionhelp"}, "edited": false, "score": 0, "creation_date": 1542834865, "post_id": 53418976, "comment_id": 93715446, "body": "Also, remove the underscore in Reagant and Column Validation. That&#39;s a relic of when it was placed on two lines."}, {"owner": {"reputation": 15, "user_id": 10642148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8bcd3375d137865751bdbda607a94a?s=128&d=identicon&r=PG&f=1", "display_name": "Steve L", "link": "https://stackoverflow.com/users/10642148/steve-l"}, "edited": false, "score": 0, "creation_date": 1542834942, "post_id": 53418976, "comment_id": 93715472, "body": "It&#39;s not there in the code. just put that in to try to illustrate it is one line of code. There is a picture attached at the bottom of my original post."}, {"owner": {"reputation": 494, "user_id": 10581807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebae5a589919e09b87559b0a6f19ef2b?s=128&d=identicon&r=PG&f=1", "display_name": "extensionhelp", "link": "https://stackoverflow.com/users/10581807/extensionhelp"}, "edited": false, "score": 0, "creation_date": 1542834984, "post_id": 53418976, "comment_id": 93715491, "body": "Alright. Did you try again with just one doublequote on each end?"}, {"owner": {"reputation": 15, "user_id": 10642148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8bcd3375d137865751bdbda607a94a?s=128&d=identicon&r=PG&f=1", "display_name": "Steve L", "link": "https://stackoverflow.com/users/10642148/steve-l"}, "edited": false, "score": 0, "creation_date": 1542835174, "post_id": 53418976, "comment_id": 93715574, "body": "Yep no change?."}, {"owner": {"reputation": 494, "user_id": 10581807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebae5a589919e09b87559b0a6f19ef2b?s=128&d=identicon&r=PG&f=1", "display_name": "extensionhelp", "link": "https://stackoverflow.com/users/10581807/extensionhelp"}, "edited": false, "score": 0, "creation_date": 1542835245, "post_id": 53418976, "comment_id": 93715601, "body": "Alright. Try F8 again to view the value of filepath. Make sure you go one line PAST the filepath line and then hover over filepath."}, {"owner": {"reputation": 15, "user_id": 10642148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8bcd3375d137865751bdbda607a94a?s=128&d=identicon&r=PG&f=1", "display_name": "Steve L", "link": "https://stackoverflow.com/users/10642148/steve-l"}, "edited": false, "score": 0, "creation_date": 1542835533, "post_id": 53418976, "comment_id": 93715712, "body": "So if the AciveWorkbook line is highlighted then it has part of the filepath displayed. However it doesn&#39;t display the whole line because it is too long. Isn&#39;t there a way to type it into the &quot;immediate&quot; box to get it to read out the path?"}, {"owner": {"reputation": 494, "user_id": 10581807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebae5a589919e09b87559b0a6f19ef2b?s=128&d=identicon&r=PG&f=1", "display_name": "extensionhelp", "link": "https://stackoverflow.com/users/10581807/extensionhelp"}, "edited": false, "score": 0, "creation_date": 1542835934, "post_id": 53418976, "comment_id": 93715878, "body": "Definitely. Just type &quot;?filepath&quot; in the immediate window."}, {"owner": {"reputation": 15, "user_id": 10642148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8bcd3375d137865751bdbda607a94a?s=128&d=identicon&r=PG&f=1", "display_name": "Steve L", "link": "https://stackoverflow.com/users/10642148/steve-l"}, "edited": false, "score": 0, "creation_date": 1542836073, "post_id": 53418976, "comment_id": 93715929, "body": "&quot;T:\\Restricted - Department\\GLA_Shortcuts\\Reagent and Column Validation_4000_12\\MPC RL# C-13500 Lot 123456.csv&quot;..................... That looks right, Think the underscores are causing the issues in the _4000_12 part?"}, {"owner": {"reputation": 494, "user_id": 10581807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebae5a589919e09b87559b0a6f19ef2b?s=128&d=identicon&r=PG&f=1", "display_name": "extensionhelp", "link": "https://stackoverflow.com/users/10581807/extensionhelp"}, "edited": false, "score": 0, "creation_date": 1542836130, "post_id": 53418976, "comment_id": 93715944, "body": "Look at Reagant and Column _ Validation...that&#39;s not correct, is it? the underscore, I mean."}, {"owner": {"reputation": 15, "user_id": 10642148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8bcd3375d137865751bdbda607a94a?s=128&d=identicon&r=PG&f=1", "display_name": "Steve L", "link": "https://stackoverflow.com/users/10642148/steve-l"}, "edited": false, "score": 0, "creation_date": 1542836329, "post_id": 53418976, "comment_id": 93716027, "body": "yeah that was wrong but I fixed it and no change. and for some reason the comment above isn&#39;t showing one of the &quot;\\&quot; it should be it is in the code though"}, {"owner": {"reputation": 15, "user_id": 10642148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8bcd3375d137865751bdbda607a94a?s=128&d=identicon&r=PG&f=1", "display_name": "Steve L", "link": "https://stackoverflow.com/users/10642148/steve-l"}, "edited": false, "score": 0, "creation_date": 1542836679, "post_id": 53418976, "comment_id": 93716161, "body": "Ok just noticed something it is saving the file with the correct name and when I go into the File menu it looks like the right pathway. But it isn&#39;t there. and when I click open folder it doesn&#39;t do anything."}, {"owner": {"reputation": 15, "user_id": 10642148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8bcd3375d137865751bdbda607a94a?s=128&d=identicon&r=PG&f=1", "display_name": "Steve L", "link": "https://stackoverflow.com/users/10642148/steve-l"}, "edited": false, "score": 0, "creation_date": 1542837474, "post_id": 53418976, "comment_id": 93716434, "body": "Got it!!!! Thanks for all your help. I went back and checked the file pathways and there was a one of them was reagent validations compared to reagent validation..."}], "tags": [], "owner": {"reputation": 494, "user_id": 10581807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebae5a589919e09b87559b0a6f19ef2b?s=128&d=identicon&r=PG&f=1", "display_name": "extensionhelp", "link": "https://stackoverflow.com/users/10581807/extensionhelp"}, "is_accepted": true, "score": 0, "last_activity_date": 1542832109, "last_edit_date": 1542832109, "creation_date": 1542827242, "answer_id": 53418976, "question_id": 53418935, "link": "https://stackoverflow.com/questions/53418935/designate-a-file-location-based-on-a-value-in-certain-cell/53418976#53418976", "title": "Designate a file location based on a value in certain cell", "body": "<p>It looks like the error is in switching between strings and variables. Strings are surrounded by double quotes, variables aren't. And when switching between the two, use an '&amp;'.</p>\n\n<pre><code>Sub SaveForValidation()\n'\n' SaveforValidation Macro\n'\n\n' File Name Formula Found in T26 in white text.\n    ActiveWorkbook.SaveAs Filename:= _\n        \"T:\\Restricted - Department\\GLA_Shortcuts\\Reagent and Column \n         Validation\\\" &amp; Range(\"B6\") &amp; \"\\\" &amp; Range(\"T26\") &amp; \".csv\" _\n         , FileFormat:=xlOpenXMLWorkbookMacroEnabled, CreateBackup:=False\n\nEnd Sub\n</code></pre>\n\n<p>It might make sense to build the filename in a variable to make testing easier, such as:</p>\n\n<pre><code>Sub SaveForValidation()\nDim filepath\nfilepath = \"T:\\Restricted - Department\\GLA_Shortcuts\\Reagent and Column Validation\\\" &amp; Range(\"B6\") &amp; \"\\\" &amp; Range(\"T26\") &amp; \".csv\"\n\nActiveWorkbook.SaveAs Filename:=filepath, FileFormat:=xlOpenXMLWorkbookMacroEnabled, CreateBackup:=False\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "is_accepted": false, "score": 0, "last_activity_date": 1542836070, "creation_date": 1542836070, "answer_id": 53420781, "question_id": 53418935, "link": "https://stackoverflow.com/questions/53418935/designate-a-file-location-based-on-a-value-in-certain-cell/53420781#53420781", "title": "Designate a file location based on a value in certain cell", "body": "<p>The above code you have the file name to be saved as .csv but you want it to be a macro-enabled workbook...</p>\n\n<pre><code>Sub SaveForValidation()\n\n    Dim filepath As String\n    filepath = \"T:\\Restricted - Department\\GLA_Shortcuts\\Reagent and Column Validation\\\" &amp; Range(\"B6\") &amp; \"\\\" &amp; Range(\"T26\") &amp; \".xlsm\"\n\n    ActiveWorkbook.SaveAs Filename:=filepath, FileFormat:=52, CreateBackup:=False\n\nEnd Sub\n</code></pre>\n\n<p>I personally use file format # instead of words. 52 = .xlsm</p>\n\n<p>For other types, see below\n51 = xlOpenXMLWorkbook (without macro\u2019s in 2007, .xlsx)</p>\n\n<p>52 = xlOpenXMLWorkbookMacroEnabled (with or without macro\u2019s in 2007, .xlsm)</p>\n\n<p>50 = xlExcel12 (Excel Binary Workbook in 2007 with or without macro\u2019s, .xlsb)</p>\n\n<p>56 = xlExcel8 (97-2003 format in Excel 2007, .xls)</p>\n"}], "owner": {"reputation": 15, "user_id": 10642148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8bcd3375d137865751bdbda607a94a?s=128&d=identicon&r=PG&f=1", "display_name": "Steve L", "link": "https://stackoverflow.com/users/10642148/steve-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 53418976, "answer_count": 2, "score": 0, "last_activity_date": 1545404345, "creation_date": 1542826992, "last_edit_date": 1545404345, "question_id": 53418935, "link": "https://stackoverflow.com/questions/53418935/designate-a-file-location-based-on-a-value-in-certain-cell", "title": "Designate a file location based on a value in certain cell", "body": "<p>I can change the filename based on a certain cell value. I am trying to change the file location based off the value in a certain cell.</p>\n\n<p>There is a drop down in \"B6\" and a folder for each option available.</p>\n\n<p>Here is my current code:</p>\n\n<pre><code>Sub SFVTEST()\n\nDim filepath\n\nfilepath = \"\"\"T:\\Restricted - Department\\GLA_Shortcuts\\Reagent and Column _ Validation\\\" &amp; Range(\"B6\") &amp; \"\\\" &amp; Range(\"T26\") &amp; \".csv\"\"\"\n\nActiveWorkbook.SaveAs Filename:=filepath,_ FileFormat:=xlOpenXMLWorkbookMacroEnabled, CreateBackup:=False\n\nEnd Sub\n</code></pre>\n\n<p>Getting a </p>\n\n<blockquote>\n  <p>\"Run-time error '1004': Method 'SaveAs' of object'_Workbook' failed\" </p>\n</blockquote>\n\n<p>Line of Code with error<br>\n<a href=\"https://i.stack.imgur.com/yNErw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yNErw.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 865, "user_id": 10361731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8873db235bacaa9d53de9c31a0b8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Jchang43", "link": "https://stackoverflow.com/users/10361731/jchang43"}, "edited": false, "score": 0, "creation_date": 1542827638, "post_id": 53418863, "comment_id": 93712284, "body": "are you looking at the percentage of numerical values or just any cells that arent &quot;null&quot;"}, {"owner": {"reputation": 1130, "user_id": 4699016, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/itgis.png?s=128&g=1", "display_name": "Uchiha Itachi", "link": "https://stackoverflow.com/users/4699016/uchiha-itachi"}, "reply_to_user": {"reputation": 865, "user_id": 10361731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8873db235bacaa9d53de9c31a0b8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Jchang43", "link": "https://stackoverflow.com/users/10361731/jchang43"}, "edited": false, "score": 0, "creation_date": 1542827939, "post_id": 53418863, "comment_id": 93712410, "body": "@Brotato - some of the cells simply don&#39;t have any value in them, but some also have a string value of &quot;null&quot;.  I want to count both."}, {"owner": {"reputation": 299, "user_id": 6850479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7403e272dbfeb0588a3184d1a9fb4df2?s=128&d=identicon&r=PG&f=1", "display_name": "Basher", "link": "https://stackoverflow.com/users/6850479/basher"}, "edited": false, "score": 2, "creation_date": 1542828628, "post_id": 53418863, "comment_id": 93712744, "body": "From what I&#39;ve seen, people here want you to have a code to begin with, and if you&#39;re having issues with your code, they can fix it for you. So in your case, without any code at all, people think you just want others to make the code for you.."}, {"owner": {"reputation": 299, "user_id": 6850479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7403e272dbfeb0588a3184d1a9fb4df2?s=128&d=identicon&r=PG&f=1", "display_name": "Basher", "link": "https://stackoverflow.com/users/6850479/basher"}, "edited": false, "score": 0, "creation_date": 1542828925, "post_id": 53418863, "comment_id": 93712894, "body": "Since you don&#39;t know where to start, let&#39;s go and make one. First, we need to find the percentage that is populated. Does this mean you want to find the last row of any columns, and use that as a basis? Ex: Column A has 100,000 rows, whereas Column B has 200,000 rows. By using Column B as the &quot;last row&quot;, would Column A&#39;s percentage be considered 50% filled?"}, {"owner": {"reputation": 1130, "user_id": 4699016, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/itgis.png?s=128&g=1", "display_name": "Uchiha Itachi", "link": "https://stackoverflow.com/users/4699016/uchiha-itachi"}, "reply_to_user": {"reputation": 299, "user_id": 6850479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7403e272dbfeb0588a3184d1a9fb4df2?s=128&d=identicon&r=PG&f=1", "display_name": "Basher", "link": "https://stackoverflow.com/users/6850479/basher"}, "edited": false, "score": 0, "creation_date": 1542829146, "post_id": 53418863, "comment_id": 93712996, "body": "@Basher I don&#39;t have code to start with because I don&#39;t know VBA...  As to your second comment: No - I need to figure this out on a column-by-column basis.  So if Column A has 100k rows, I need percentage from the 100k; same for Column B with 235K rows and so on."}, {"owner": {"reputation": 1130, "user_id": 4699016, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/itgis.png?s=128&g=1", "display_name": "Uchiha Itachi", "link": "https://stackoverflow.com/users/4699016/uchiha-itachi"}, "reply_to_user": {"reputation": 865, "user_id": 10361731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8873db235bacaa9d53de9c31a0b8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Jchang43", "link": "https://stackoverflow.com/users/10361731/jchang43"}, "edited": false, "score": 0, "creation_date": 1542829557, "post_id": 53418863, "comment_id": 93713170, "body": "Thanks @Brotato - that&#39;s helpful for finding/setting Range for each column!!"}, {"owner": {"reputation": 865, "user_id": 10361731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8873db235bacaa9d53de9c31a0b8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Jchang43", "link": "https://stackoverflow.com/users/10361731/jchang43"}, "edited": false, "score": 0, "creation_date": 1542829622, "post_id": 53418863, "comment_id": 93713195, "body": "Thought I&#39;d throw part of it in my answer instead, but for those curious <a href=\"https://stackoverflow.com/a/11169920/10361731\">this was the link</a>"}, {"owner": {"reputation": 299, "user_id": 6850479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7403e272dbfeb0588a3184d1a9fb4df2?s=128&d=identicon&r=PG&f=1", "display_name": "Basher", "link": "https://stackoverflow.com/users/6850479/basher"}, "edited": false, "score": 0, "creation_date": 1542831270, "post_id": 53418863, "comment_id": 93713903, "body": "Brotato is too fast for me, didn&#39;t get to post my answer :P - Anyway, if running his code is slow as you have thousands of colums and rows, try adding this and add the line &quot;OptimizeVBA True&quot; at the very beginning of his code, and &quot;OptimizeVBA False&quot; at the end: <a href=\"https://analystcave.com/excel-improve-vba-performance/\" rel=\"nofollow noreferrer\">link</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1130, "user_id": 4699016, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/itgis.png?s=128&g=1", "display_name": "Uchiha Itachi", "link": "https://stackoverflow.com/users/4699016/uchiha-itachi"}, "edited": false, "score": 0, "creation_date": 1542828379, "post_id": 53419199, "comment_id": 93712632, "body": "Thanks, but this would require me to create that counter column over 1500 times.  Doesn&#39;t really expedite the process for me..."}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "reply_to_user": {"reputation": 1130, "user_id": 4699016, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/itgis.png?s=128&g=1", "display_name": "Uchiha Itachi", "link": "https://stackoverflow.com/users/4699016/uchiha-itachi"}, "edited": false, "score": 1, "creation_date": 1542828684, "post_id": 53419199, "comment_id": 93712777, "body": "<a href=\"https://superuser.com/questions/1373214/how-to-fill-a-large-series-over-10-000-rows-in-microsoft-excel-without-draggin/1373218#1373218\">really?</a>"}, {"owner": {"reputation": 1130, "user_id": 4699016, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/itgis.png?s=128&g=1", "display_name": "Uchiha Itachi", "link": "https://stackoverflow.com/users/4699016/uchiha-itachi"}, "edited": false, "score": 0, "creation_date": 1542828986, "post_id": 53419199, "comment_id": 93712921, "body": "*Barely expedites the process for me..."}], "tags": [], "owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "is_accepted": false, "score": 3, "last_activity_date": 1542828187, "creation_date": 1542828187, "answer_id": 53419199, "question_id": 53418863, "link": "https://stackoverflow.com/questions/53418863/excel-vba-how-to-remove-columns-where-less-than-x-of-rows-have-value/53419199#53419199", "title": "Excel VBA - How to remove columns where less than X% of rows have value", "body": "<p>use a helper column with the following formula:</p>\n\n<pre><code>=COUNTA(A2:D2)-COUNTIF(A2:D2,\"null\")\n</code></pre>\n\n<p>This will tell you how many cells have content that is not <code>\"null\"</code> in any given row</p>\n\n<p>You can then filter on that column</p>\n\n<p>Note: my example assumes data in columns <code>A</code> to <code>D</code>, you will need to adjust for your data.</p>\n"}, {"comments": [{"owner": {"reputation": 1130, "user_id": 4699016, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/itgis.png?s=128&g=1", "display_name": "Uchiha Itachi", "link": "https://stackoverflow.com/users/4699016/uchiha-itachi"}, "edited": false, "score": 0, "creation_date": 1542830057, "post_id": 53419485, "comment_id": 93713401, "body": "Again, since I don&#39;t know VBA - forgive me...  What is the Option Explicit for/ what does it do?"}, {"owner": {"reputation": 865, "user_id": 10361731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8873db235bacaa9d53de9c31a0b8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Jchang43", "link": "https://stackoverflow.com/users/10361731/jchang43"}, "reply_to_user": {"reputation": 1130, "user_id": 4699016, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/itgis.png?s=128&g=1", "display_name": "Uchiha Itachi", "link": "https://stackoverflow.com/users/4699016/uchiha-itachi"}, "edited": false, "score": 0, "creation_date": 1542830162, "post_id": 53419485, "comment_id": 93713446, "body": "Option explicit forces the developer to explicitly declare all of the variables before using them. It helps to check for misspelled variable names in the middle of the code."}, {"owner": {"reputation": 1130, "user_id": 4699016, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/itgis.png?s=128&g=1", "display_name": "Uchiha Itachi", "link": "https://stackoverflow.com/users/4699016/uchiha-itachi"}, "edited": false, "score": 0, "creation_date": 1542830243, "post_id": 53419485, "comment_id": 93713473, "body": "Thank you!!  You have been tremendously helpful."}], "tags": [], "owner": {"reputation": 865, "user_id": 10361731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8873db235bacaa9d53de9c31a0b8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Jchang43", "link": "https://stackoverflow.com/users/10361731/jchang43"}, "is_accepted": true, "score": 1, "last_activity_date": 1542830234, "last_edit_date": 1542830234, "creation_date": 1542829544, "answer_id": 53419485, "question_id": 53418863, "link": "https://stackoverflow.com/questions/53418863/excel-vba-how-to-remove-columns-where-less-than-x-of-rows-have-value/53419485#53419485", "title": "Excel VBA - How to remove columns where less than X% of rows have value", "body": "<p>The code considers a valid range to be from row 1 to the lowest, non-empty, cell in the column. Fair warning it is currently untested, so try it on a dummy version with known results first. You have to change the constant <code>TargetPercent</code> to match whatever X% you want. This could also be pretty slow since it's using worksheet functions, but I'd assume it would still be faster than by hand. I believe that this will also delete any blank columns</p>\n\n<p>It's also worth noting that in the for loop it is important to go from the right to the left so that you don't accidentally mess up the indices when you're deleting the columns.</p>\n\n<pre><code>Option Explicit\n\nSub test()\nConst TargetPercent = 0.5\nDim nullcells As Long\nDim blankcells As Long\nDim i As Long\nDim lastrow As Long\nDim lastcol\n\nlastcol = ActiveSheet.Cells.Find(\"*\", searchorder:=xlByColumns, searchdirection:=xlPrevious).Column\nFor i = lastcol To 1 Step -1\n    lastrow = ActiveSheet.Cells(ActiveSheet.Rows.Count, i).End(xlUp).row\n    nullcells = Application.CountIf(ActiveSheet.Columns(i), \"null\")\n    blankcells = Application.CountBlank(ActiveSheet.Range(Cells(1, i), Cells(lastrow, i)))\n    If (lastrow - nullcells - blankcells) / lastrow &lt; TargetPercent Then\n        Columns(i).Delete (xlShiftToLeft)\n    End If\nNext i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1130, "user_id": 4699016, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/itgis.png?s=128&g=1", "display_name": "Uchiha Itachi", "link": "https://stackoverflow.com/users/4699016/uchiha-itachi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "closed_date": 1542829916, "accepted_answer_id": 53419485, "answer_count": 2, "score": -6, "last_activity_date": 1583476759, "creation_date": 1542826658, "last_edit_date": 1583476759, "question_id": 53418863, "link": "https://stackoverflow.com/questions/53418863/excel-vba-how-to-remove-columns-where-less-than-x-of-rows-have-value", "closed_reason": "Needs more focus", "title": "Excel VBA - How to remove columns where less than X% of rows have value", "body": "<p>I know how to write formulas in Excel and I have written only a couple basic macros in Excel for formatting cell data.  I just completed a rather large data export in to Excel, but I know only some of it is relevant, so I want to write a macro that will look through every column (1500+), and for each column, check to see if at least X% of the rows (100k+) have a value (and one that is not a string that equals <em>\"null\"</em>.</p>\n\n<p>I honestly don't even know where to start.  Any HELP is appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1542826340, "post_id": 53418742, "comment_id": 93711638, "body": "<code>Target.Activate</code> maybe?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1542827523, "post_id": 53418742, "comment_id": 93712243, "body": "Inside a sheet code module, <code>Me</code> refers to the sheet itself, so you can use that in place of <code>ThisWorkbook.Sheets(&quot;Log&quot;)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9254253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db4d01ae3c819f6ee933a6d049d90dd1?s=128&d=identicon&r=PG&f=1", "display_name": "KC0904", "link": "https://stackoverflow.com/users/9254253/kc0904"}, "edited": false, "score": 0, "creation_date": 1542832258, "post_id": 53418896, "comment_id": 93714311, "body": "Where do I added it? After the End if?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 13, "user_id": 9254253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db4d01ae3c819f6ee933a6d049d90dd1?s=128&d=identicon&r=PG&f=1", "display_name": "KC0904", "link": "https://stackoverflow.com/users/9254253/kc0904"}, "edited": false, "score": 0, "creation_date": 1542832292, "post_id": 53418896, "comment_id": 93714328, "body": "I assume you want before - activate after sorting."}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": false, "score": 1, "last_activity_date": 1542826796, "creation_date": 1542826796, "answer_id": 53418896, "question_id": 53418742, "link": "https://stackoverflow.com/questions/53418742/auto-sort-stop-going-back-to-the-top-of-the-table/53418896#53418896", "title": "Auto Sort - Stop going back to the top of the table", "body": "<p>Maybe as simple as adding a final <code>Target.Activate</code>.</p>\n"}], "owner": {"reputation": 13, "user_id": 9254253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db4d01ae3c819f6ee933a6d049d90dd1?s=128&d=identicon&r=PG&f=1", "display_name": "KC0904", "link": "https://stackoverflow.com/users/9254253/kc0904"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1585959220, "creation_date": 1542826138, "last_edit_date": 1585959220, "question_id": 53418742, "link": "https://stackoverflow.com/questions/53418742/auto-sort-stop-going-back-to-the-top-of-the-table", "title": "Auto Sort - Stop going back to the top of the table", "body": "<p>I am using the below code where once I select someone in the \"Associate\" column the table automatically sorts the data.</p>\n\n<p>It takes me back to the top of the table.</p>\n\n<p>I have to scroll back down.</p>\n\n<p>I would like to stay on the row I just completed.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nThisWorkbook.Sheets(\"Log\").ListObjects(\"Table1\").Sort.SortFields.Clear\nThisWorkbook.Sheets(\"Log\").ListObjects(\"Table1\").Sort.SortFields. _\n    Add Key:=Range(\"Table1[[#ALL],[Date]]\"), SortOn:=xlSortOnValues, Order _\n    :=xlAscending, DataOption:=xlSortNormal\nThisWorkbook.Sheets(\"Log\").ListObjects(\"Table1\").Sort.SortFields. _\n    Add Key:=Range(\"Table1[[#All],[Time]]\"), SortOn:=xlSortOnValues, Order _\n    :=xlAscending, DataOption:=xlSortNormal\nIf Not Intersect(Target, Range(\"Table1[[#All],[Associate]]\")) Is Nothing Then\n    With ThisWorkbook.Sheets(\"Log\").ListObjects(\"Table1\").Sort\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "sumifs"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10687450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0d8ab124fb69b62241d49eda614f93e?s=128&d=identicon&r=PG&f=1", "display_name": "J. Khost", "link": "https://stackoverflow.com/users/10687450/j-khost"}, "edited": false, "score": 1, "creation_date": 1542826467, "post_id": 53418699, "comment_id": 93711716, "body": "Thank you so much, I&#39;m not sure why my code wasn&#39;t working. It just wanted me to ask the question to start work. I probably had a typo in my original code but either way. Thank you very much."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1542826008, "creation_date": 1542826008, "answer_id": 53418699, "question_id": 53418585, "link": "https://stackoverflow.com/questions/53418585/how-to-add-multiple-sumifs-in-excel-vbas-worksheet-function/53418699#53418699", "title": "How to add multiple SUMIFS in Excel VBAs Worksheet function", "body": "<p>This works for me. I've only posted as an answer to show the formatting, including the line break (not required but makes code easier to read)</p>\n\n<pre><code>MsgBox Application.WorksheetFunction.SumIfs(Range(\"U:U\"), Range(\"O:O\"), \"TEXT\", Range(\"Q:Q\"), \"TEXT1\") _\n    + Application.WorksheetFunction.SumIfs(Range(\"U:U\"), Range(\"O:O\"), \"TEXT\", Range(\"Q:Q\"), \"TEXT2\")\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10687450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0d8ab124fb69b62241d49eda614f93e?s=128&d=identicon&r=PG&f=1", "display_name": "J. Khost", "link": "https://stackoverflow.com/users/10687450/j-khost"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 53418699, "answer_count": 1, "score": 1, "last_activity_date": 1583476770, "creation_date": 1542825511, "last_edit_date": 1583476770, "question_id": 53418585, "link": "https://stackoverflow.com/questions/53418585/how-to-add-multiple-sumifs-in-excel-vbas-worksheet-function", "title": "How to add multiple SUMIFS in Excel VBAs Worksheet function", "body": "<p>I'm trying to create a formala that inside VBA worksheet functions that is the same or similar to the following inside of excel. </p>\n\n<pre><code>\"=sumifs(U:U,O:O,\"TEXT\",Q:Q,\"TEXT1\")+sumifs(U:U,O:O,\"TEXT\",Q:Q,\"TEXT2\")\"\n</code></pre>\n\n<p>I currently have</p>\n\n<pre><code>myanswer = Application.WorksheetFunction.SumIfs(Range(\"U:U\"), Range(\"O:O\"), \"TEXT\", Range(\"Q:Q\"), \"TEXT1\")\n</code></pre>\n\n<p>if I add more to it such as </p>\n\n<pre><code>Application.WorksheetFunction.SumIfs(Range(\"U:U\"), Range(\"O:O\"), \"TEXT\", Range(\"Q:Q\"), \"TEXT1\")+***Application.WorksheetFunction.SumIfs(Range(\"U:U\"), Range(\"O:O\"), \"TEXT\", Range(\"Q:Q\"), \"TEXT2\"***)\n</code></pre>\n\n<p>It gives an error (I have highlighted between *** the part of the code that stops working. I'm sure there is a simple \"and\" or \"or\" function but my brain is frazzled right now. Please let me know if you need any clarification (also if there are any typos I had to translate the code over as it's on another computer.)</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1542824571, "post_id": 53418302, "comment_id": 93710872, "body": "Untested, but maybe see <a href=\"https://stackoverflow.com/questions/27998731/how-to-run-a-macro-while-clicking-on-a-value-in-slicer-in-excel-vba\">how to run a macro while clicking on a value in slicer</a>"}], "owner": {"reputation": 11, "user_id": 10687366, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CchMSUlwwUU/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-j6cgj0bS7hSeMuJnx9JM8EYIaOuw/mo/photo.jpg?sz=128", "display_name": "MariaE", "link": "https://stackoverflow.com/users/10687366/mariae"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1472, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1542824310, "creation_date": 1542824310, "question_id": 53418302, "link": "https://stackoverflow.com/questions/53418302/run-macro-when-slicer-change", "title": "Run macro when slicer change", "body": "<p>I can't get the macro to automatically run when an item in a slicer (from a chart) is selected. I tried by adding the code under a private sub or even public function but still can't get the click/selection of an item in the slicer to trigger the macro. I tested the sub Slicer_Opt and it works when I have an item selected and I run it manually, but as I said, I can't get it to automatically trigger when I select an item in the slicer. Until now I have the following:</p>\n\n<pre><code>Public Function ClickedSlicerItem(ByRef SlicerOpt1)\nCall Slicer_Opt\nEnd Function\n\nSub Slicer_Opt()\n\nDim LastMonth As String\nDim MiddleMonth As String\nDim FirstMonth As String\nDim Date1 As Date\nDim MonthMax As String\nDim MinMonth As Date\nDim SlicerMthCache As SlicerCache\nDim SlicerOpt1 As SlicerItem\n\nDate1 = WorksheetFunction.Max(Sheets(\"Activity Log\").Range(\"H:H\"))\nMinMonth = WorksheetFunction.Min(Sheets(\"Activity Log\").Range(\"H:H\"))\nMonthMax = Month(Date1)\nLastMonth = MonthName(MonthMax, True)\nMiddleMonth = MonthName(MonthMax - 1, True)\nFirstMonth = MonthName(MonthMax - 2, True)\n\nIf SlicerOpt1.ActiveItem Is Not Null Then \n    Application.ScreenUpdating = False\nIf ActiveWorkbook.SlicerCaches(\"Slicer_Last_Log_in\").SlicerItems(LastMonth).Selected = True Then\n        ActiveSheet.ChartObjects(\"Chart 2\").Activate\n        ActiveChart.ChartType = xlBarClustered\n    ElseIf ActiveWorkbook.SlicerCaches(\"Slicer_Last_Log_in\").SlicerItems(MiddleMonth).Selected = True Then\n        ActiveSheet.ChartObjects(\"Chart 2\").Activate\n        ActiveChart.ChartType = xlBarClustered\n    ElseIf ActiveWorkbook.SlicerCaches(\"Slicer_Last_Log_in\").SlicerItems(FirstMonth).Selected = True Then\n        ActiveSheet.ChartObjects(\"Chart 2\").Activate\n        ActiveChart.ChartType = xlBarClustered\n    End If\n    Application.ScreenUpdating = True\nElse: ActiveChart.ChartType = xlBarStacked100\nEnd If\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-2010"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1542825513, "post_id": 53418260, "comment_id": 93711250, "body": "In the text you mention &quot;collection&quot; but your code uses Dictionaries and arrays. Is <code>reportData</code> the same as <code>master</code>  ?"}, {"owner": {"reputation": 355, "user_id": 9841207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc5da3d361f6c331926b8f161bb67d9c?s=128&d=identicon&r=PG&f=1", "display_name": "User", "link": "https://stackoverflow.com/users/9841207/user"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1542825918, "post_id": 53418260, "comment_id": 93711433, "body": "No reportData is master.key(i)"}, {"owner": {"reputation": 355, "user_id": 9841207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc5da3d361f6c331926b8f161bb67d9c?s=128&d=identicon&r=PG&f=1", "display_name": "User", "link": "https://stackoverflow.com/users/9841207/user"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1542826009, "post_id": 53418260, "comment_id": 93711476, "body": "The dictionary reportData contains an Array of collections"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1542826464, "post_id": 53418260, "comment_id": 93711714, "body": "Sorry I totally missed the comment about the array contents being a collection.  You can&#39;t access an array element using <code>Item()</code> though - you&#39;d need <code>yourArrayHere(0)</code> to access the first item so something like <code>reportData(key)(0).Item(1)</code>"}, {"owner": {"reputation": 355, "user_id": 9841207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc5da3d361f6c331926b8f161bb67d9c?s=128&d=identicon&r=PG&f=1", "display_name": "User", "link": "https://stackoverflow.com/users/9841207/user"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1542827403, "post_id": 53418260, "comment_id": 93712193, "body": "Debug.Print &quot;Comment is: &quot; &amp; reportData(key)(counter).Item(1) Gives me an invalid procedure call error"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1542831749, "post_id": 53418260, "comment_id": 93714118, "body": "This is <i>really</i> begging for an object oriented solution."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1542828088, "creation_date": 1542828088, "answer_id": 53419181, "question_id": 53418260, "link": "https://stackoverflow.com/questions/53418260/vba-accessing-data-structure/53419181#53419181", "title": "VBA Accessing data structure", "body": "<p>Seems like this is close to what you want:</p>\n\n<pre><code>Sub Tester()\n\n    Dim Master As New Dictionary\n    Dim child As New Dictionary, km, kc\n    Dim col1 As New Collection, col2 As New Collection\n\n    col1.Add \"Hello\"\n    col1.Add \"World\"\n    col2.Add \"Blue\"\n    col2.Add \"Green\"\n\n    child.Add \"ID01\", Array(col1, col2)\n\n    Master.Add \"Key01\", child\n\n    For Each km In Master.Keys\n        Debug.Print \"Master key:\", km          '&gt;&gt; Key01\n        For Each kc In Master(km)\n            Debug.Print \"    Child key:\", kc   '&gt;&gt; ID01\n            Debug.Print , Master(km)(kc)(0)(1) '&gt;&gt; Hello\n            Debug.Print , Master(km)(kc)(0)(2) '&gt;&gt; World\n            Debug.Print , Master(km)(kc)(1)(1) '&gt;&gt; Blue\n            Debug.Print , Master(km)(kc)(1)(2) '&gt;&gt; Green\n        Next kc\n    Next km\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 355, "user_id": 9841207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc5da3d361f6c331926b8f161bb67d9c?s=128&d=identicon&r=PG&f=1", "display_name": "User", "link": "https://stackoverflow.com/users/9841207/user"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542828088, "creation_date": 1542824123, "last_edit_date": 1542824701, "question_id": 53418260, "link": "https://stackoverflow.com/questions/53418260/vba-accessing-data-structure", "title": "VBA Accessing data structure", "body": "<p>I have this really complicated data structure which I am trying to access. The reason I set it up like this is because I want to have a structure of each report containing all the questions for that report with all the data for each question. Please see the code below to understand what I am doing.</p>\n\n<pre><code>Dim master As New Dictionary      \nDim child As New Dictionary\n</code></pre>\n\n<p>this happens for each question in a report. Note in the end coll1-coll6 is what I want to print out</p>\n\n<pre><code>'coll# is a collection \nchild.Add ID, Array(coll1, coll2, coll3, coll4, coll5, coll6)\n</code></pre>\n\n<p>this happens for each report in a list of reports to be created</p>\n\n<pre><code>master.Add reportNumber, child\n</code></pre>\n\n<p>Now I pass in each report one by one by doing this</p>\n\n<pre><code>master.key(i)\n</code></pre>\n\n<p>Given a report from the master.key(i) I want to be able to access the Array in child which contains all the collections</p>\n\n<pre><code>For Each key In reportData.Keys\n     Debug.Print reportData(key).Item(1).Item(1)\nNext key\n</code></pre>\n\n<p>The above piece of code is me trying to print out the data from inside a report inside a question inside a collection for one of the questions</p>\n\n<p>PS. I know this may seem convoluted but I saw it as the best solution to store a list of reports with all there data to make automatic reports.</p>\n\n<p>In summary my question is how do I access my data which is inside a collection in a array.</p>\n\n<p>Suggestions are welcome as to a better way to do what I am trying to accomplish. Which is essentially a frame work where I can automatically create reports.</p>\n\n<p>I have changed the Array(coll1, ... , coll6) to a string to see if I can access it and it printed out correctly. So it looks like I am having troubles accessing the Array(coll1, ... , coll6)</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 10687337, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-eM6fL53mbo0/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iSWDQLidsJr9bZAe8j9UqWB_oveQ/mo/photo.jpg?sz=128", "display_name": "austinmb", "link": "https://stackoverflow.com/users/10687337/austinmb"}, "edited": false, "score": 0, "creation_date": 1542825291, "post_id": 53418461, "comment_id": 93711157, "body": "Are you saying to put this before the set of commands that I have?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 67, "user_id": 10687337, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-eM6fL53mbo0/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iSWDQLidsJr9bZAe8j9UqWB_oveQ/mo/photo.jpg?sz=128", "display_name": "austinmb", "link": "https://stackoverflow.com/users/10687337/austinmb"}, "edited": false, "score": 0, "creation_date": 1542825369, "post_id": 53418461, "comment_id": 93711189, "body": "No - this should be it. The <code>For</code> loop does what you want."}, {"owner": {"reputation": 67, "user_id": 10687337, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-eM6fL53mbo0/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iSWDQLidsJr9bZAe8j9UqWB_oveQ/mo/photo.jpg?sz=128", "display_name": "austinmb", "link": "https://stackoverflow.com/users/10687337/austinmb"}, "edited": false, "score": 0, "creation_date": 1542827106, "post_id": 53418461, "comment_id": 93712053, "body": "Can you point me to somewhere where I can learn about the syntax?\u2014 for ex: what\u2019s \u201cas long\u201d and what\u2019s .end(xlup).row? Finally \u201cFor... next\u201d thanks!"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 67, "user_id": 10687337, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-eM6fL53mbo0/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iSWDQLidsJr9bZAe8j9UqWB_oveQ/mo/photo.jpg?sz=128", "display_name": "austinmb", "link": "https://stackoverflow.com/users/10687337/austinmb"}, "edited": false, "score": 0, "creation_date": 1542827220, "post_id": 53418461, "comment_id": 93712115, "body": "Maybe <a href=\"https://docs.microsoft.com/en-us/office/vba/excel/concepts/cells-and-ranges/looping-through-a-range-of-cells\" rel=\"nofollow noreferrer\">here</a>"}, {"owner": {"reputation": 67, "user_id": 10687337, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-eM6fL53mbo0/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iSWDQLidsJr9bZAe8j9UqWB_oveQ/mo/photo.jpg?sz=128", "display_name": "austinmb", "link": "https://stackoverflow.com/users/10687337/austinmb"}, "edited": false, "score": 0, "creation_date": 1543937336, "post_id": 53418461, "comment_id": 94093183, "body": "Thanks! This was super helpful. One thing... Sometimes goal seek cannot find a solution and I will have to go back and do those manually. How can I tell Excel &quot;if you can&#39;t find a solution that sets the cell equal to the target value (&quot;0&quot;) get as close as you can? I&#39;m thinking of adding a second sub that has excel go back and relook at the cells that gave it trouble the first time??"}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": false, "score": 1, "last_activity_date": 1542825078, "creation_date": 1542825078, "answer_id": 53418461, "question_id": 53418253, "link": "https://stackoverflow.com/questions/53418253/how-to-use-vba-to-loop-goal-seek-down-columns/53418461#53418461", "title": "How to Use VBA to Loop goal seek down columns", "body": "<p>Maybe something like:</p>\n\n<pre><code>Sub Goal_Seek()\n    Dim lastRow As Long, i As Long\n\n    With ActiveSheet\n        lastRow = .Cells(.Rows.Count, \"F\").End(xlUp).Row\n\n        For i = 7 To lastRow\n            .Range(\"F\" &amp; i).GoalSeek Goal:=0, ChangingCell:=.Range(\"I\" &amp; i)\n        Next i\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 10687337, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-eM6fL53mbo0/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iSWDQLidsJr9bZAe8j9UqWB_oveQ/mo/photo.jpg?sz=128", "display_name": "austinmb", "link": "https://stackoverflow.com/users/10687337/austinmb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5410, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1542825078, "creation_date": 1542824097, "last_edit_date": 1542824474, "question_id": 53418253, "link": "https://stackoverflow.com/questions/53418253/how-to-use-vba-to-loop-goal-seek-down-columns", "title": "How to Use VBA to Loop goal seek down columns", "body": "<p>I am new to this site and brand new to VBA. I have a question related to goal seek.</p>\n\n<p>I need to use Goal seek in VBA several times. Here is a sample of my Excel Sheet:</p>\n\n<p><img src=\"https://i.stack.imgur.com/w8LIF.png\" alt=\"Excel sheet\"></p>\n\n<p>I need to set the cells in F(which is a formula linked to another sheet) to 0, by changing the cells in I (hardcoded). I have the basic code to do this, but I want to figure out how to tell Excel \"hey, loop this action for every cell in the column\". I don't want to have to manually put this command in VBA hundreds of times. Here is what I actually have in VBA.</p>\n\n<pre><code>Sub Goal_Seek()\n'\n' Goal_Seek Macro\n\n    Range(\"F7\").Select\n    Range(\"F7\").GoalSeek Goal:=0, ChangingCell:=Range(\"I7\")\n    Range(\"F8\").Select\n    Range(\"F8\").GoalSeek Goal:=0, ChangingCell:=Range(\"I8\")\n     Range(\"F9\").Select\n    Range(\"F9\").GoalSeek Goal:=0, ChangingCell:=Range(\"I9\")\n     Range(\"F10\").Select\n    Range(\"F10\").GoalSeek Goal:=0, ChangingCell:=Range(\"I10\")\n     Range(\"F11\").Select\n    Range(\"F11\").GoalSeek Goal:=0, ChangingCell:=Range(\"I11\")\nEnd Sub\n</code></pre>\n\n<p>Any help is appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1542823895, "post_id": 53418038, "comment_id": 93710584, "body": "Even if the cell is not locked, you&#39;ll get a RTE 1004 if you don&#39;t allow for formatting of cells when you protect the sheet. Protecting the sheet with <code>UserOnlyInterface:= True</code> might be what you&#39;re looking for. See <a href=\"http://www.cpearson.com/excel/Protection.aspx\" rel=\"nofollow noreferrer\">here</a> for more detail."}], "answers": [{"tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 0, "last_activity_date": 1542823834, "creation_date": 1542823834, "answer_id": 53418184, "question_id": 53418038, "link": "https://stackoverflow.com/questions/53418038/run-time-error-1004-unable-to-set-the-numberformat-property-of-range-class/53418184#53418184", "title": "Run-time error &#39;1004&#39; Unable to set the NumberFormat property of Range Class", "body": "<p>Formatting a sheet may be considered a worksheet change. You can format the value though.</p>\n\n<pre><code>With Selection\n    .Value = Format(Now, \"h:mm AM/PM\")\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": true, "score": 4, "last_activity_date": 1543137475, "last_edit_date": 1543137475, "creation_date": 1542824001, "answer_id": 53418225, "question_id": 53418038, "link": "https://stackoverflow.com/questions/53418038/run-time-error-1004-unable-to-set-the-numberformat-property-of-range-class/53418225#53418225", "title": "Run-time error &#39;1004&#39; Unable to set the NumberFormat property of Range Class", "body": "<h1>AllowFormattingCells</h1>\n\n<p>You have to allow Formatting of cells.</p>\n\n<p><a href=\"https://i.stack.imgur.com/jZAEb.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jZAEb.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>or in VBA</p>\n\n<pre><code>ActiveSheet.Protect AllowFormattingCells:=True\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 10686696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07876c4563e4bee7c2e30298223740cc?s=128&d=identicon&r=PG&f=1", "display_name": "mdavis0510", "link": "https://stackoverflow.com/users/10686696/mdavis0510"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4401, "favorite_count": 0, "accepted_answer_id": 53418225, "answer_count": 2, "score": 2, "last_activity_date": 1579714110, "creation_date": 1542823154, "last_edit_date": 1579714110, "question_id": 53418038, "link": "https://stackoverflow.com/questions/53418038/run-time-error-1004-unable-to-set-the-numberformat-property-of-range-class", "title": "Run-time error &#39;1004&#39; Unable to set the NumberFormat property of Range Class", "body": "<p>I installed a very simple command button to timestamp a selected cell. The command button works completely fine until I protect the sheet, then it throws the error mentioned in the title. I have already checked that the cells' format is not selected to 'locked'.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim ts As Date\n\nWith Selection\n\n.Value = Now\n\n.NumberFormat = \"h:mm AM/PM\"\n\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["html", "excel", "vba", "web-scraping"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 3, "creation_date": 1542823043, "post_id": 53417990, "comment_id": 93710215, "body": "Can you be more specific about what &quot;doesn&#39;t work&quot;? Error message, for example?"}, {"owner": {"reputation": 73, "user_id": 10448315, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gzdV2m4f6GE/AAAAAAAAAAI/AAAAAAAAAZ8/zKlDIBRKK4Y/photo.jpg?sz=128", "display_name": "Cumhur Ay", "link": "https://stackoverflow.com/users/10448315/cumhur-ay"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1542823169, "post_id": 53417990, "comment_id": 93710292, "body": "gives error 91 in line."}, {"owner": {"reputation": 73, "user_id": 10448315, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gzdV2m4f6GE/AAAAAAAAAAI/AAAAAAAAAZ8/zKlDIBRKK4Y/photo.jpg?sz=128", "display_name": "Cumhur Ay", "link": "https://stackoverflow.com/users/10448315/cumhur-ay"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1542823191, "post_id": 53417990, "comment_id": 93710309, "body": "Set tRows = hTable.getElementsByTagName(&quot;tr&quot;)"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1542869411, "post_id": 53417990, "comment_id": 93724760, "body": "Can you give an example of one full URL created by  url = BASE_URL &amp; &quot;id=weekId&amp;value=&quot; &amp; hafta(Hsay)   .... does it produce valid URLs?"}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 10448315, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gzdV2m4f6GE/AAAAAAAAAAI/AAAAAAAAAZ8/zKlDIBRKK4Y/photo.jpg?sz=128", "display_name": "Cumhur Ay", "link": "https://stackoverflow.com/users/10448315/cumhur-ay"}, "edited": false, "score": 0, "creation_date": 1542915154, "post_id": 53430106, "comment_id": 93747986, "body": "Dear Mr. @QHarr, thank you very much for your effort. However, the macro returns a &quot;User-defined type not defined&quot; error in the WebDriver object. Is there a reference to open?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 73, "user_id": 10448315, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gzdV2m4f6GE/AAAAAAAAAAI/AAAAAAAAAZ8/zKlDIBRKK4Y/photo.jpg?sz=128", "display_name": "Cumhur Ay", "link": "https://stackoverflow.com/users/10448315/cumhur-ay"}, "edited": false, "score": 1, "creation_date": 1542915254, "post_id": 53430106, "comment_id": 93748028, "body": "This is selenium basic which requires installation of <a href=\"https://github.com/florentbr/SeleniumBasic/releases/tag/v2.0.9.0\" rel=\"nofollow noreferrer\">selenium basic</a> and VBE &gt;  tools &gt; references &gt; <i>selenium type library</i> . I may write something for IE over next few days."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 73, "user_id": 10448315, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gzdV2m4f6GE/AAAAAAAAAAI/AAAAAAAAAZ8/zKlDIBRKK4Y/photo.jpg?sz=128", "display_name": "Cumhur Ay", "link": "https://stackoverflow.com/users/10448315/cumhur-ay"}, "edited": false, "score": 1, "creation_date": 1542915322, "post_id": 53430106, "comment_id": 93748049, "body": "Do you have a value for BASE_URL &amp; &quot;id=weekId&amp;value=&quot; &amp; hafta(Hsay) that works when pasted in the browser?"}, {"owner": {"reputation": 73, "user_id": 10448315, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gzdV2m4f6GE/AAAAAAAAAAI/AAAAAAAAAZ8/zKlDIBRKK4Y/photo.jpg?sz=128", "display_name": "Cumhur Ay", "link": "https://stackoverflow.com/users/10448315/cumhur-ay"}, "edited": false, "score": 0, "creation_date": 1542919574, "post_id": 53430106, "comment_id": 93749286, "body": "I don&#39;t know if the base url is correct. Hsay sample values \u200b\u200bfor base url; 18084 18085 18086 18087 18088 18089 18090 18091"}, {"owner": {"reputation": 73, "user_id": 10448315, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gzdV2m4f6GE/AAAAAAAAAAI/AAAAAAAAAZ8/zKlDIBRKK4Y/photo.jpg?sz=128", "display_name": "Cumhur Ay", "link": "https://stackoverflow.com/users/10448315/cumhur-ay"}, "edited": false, "score": 0, "creation_date": 1542920064, "post_id": 53430106, "comment_id": 93749421, "body": "&lt;script type=&quot;text/javascript&quot;&gt;     var noww = new Date();     var day = &quot;0&quot; + noww.getDate();     var month = &quot;0&quot; + (noww.getMonth()+1);     Mackolik.Program.sport = 1;     Mackolik.Program.type = Mackolik.Program.sport == 1 ? 6 : 1;     Mackolik.Program.sort = &quot;-1&quot;;     Mackolik.Program.sortDir = &quot;-1&quot;;     Mackolik.Program.sortValue = &quot;DATE&quot;;     Mackolik.Program.groupId = &quot;-1&quot;;"}, {"owner": {"reputation": 73, "user_id": 10448315, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gzdV2m4f6GE/AAAAAAAAAAI/AAAAAAAAAZ8/zKlDIBRKK4Y/photo.jpg?sz=128", "display_name": "Cumhur Ay", "link": "https://stackoverflow.com/users/10448315/cumhur-ay"}, "edited": false, "score": 0, "creation_date": 1542920071, "post_id": 53430106, "comment_id": 93749423, "body": "Mackolik.Program.day = day.substr(day.length - 2, 2) + &quot;.&quot; + month.substr(month.length - 2, 2) + &quot;.&quot; + noww.getFullYear();     Mackolik.Program.currentWeek = &quot;18091&quot;;     Mackolik.Program.week = &quot;18091&quot;;     Mackolik.Program.notPlayed = &quot;1&quot;;     Mackolik.Program.Large.getProgram();"}, {"owner": {"reputation": 73, "user_id": 10448315, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gzdV2m4f6GE/AAAAAAAAAAI/AAAAAAAAAZ8/zKlDIBRKK4Y/photo.jpg?sz=128", "display_name": "Cumhur Ay", "link": "https://stackoverflow.com/users/10448315/cumhur-ay"}, "edited": false, "score": 0, "creation_date": 1543222851, "post_id": 53430106, "comment_id": 93825258, "body": "Dear @QHarr I get a run-time error 33 error in the &quot;.Start&quot; Chrome &quot;&quot; line of code. What is the reason?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 73, "user_id": 10448315, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gzdV2m4f6GE/AAAAAAAAAAI/AAAAAAAAAZ8/zKlDIBRKK4Y/photo.jpg?sz=128", "display_name": "Cumhur Ay", "link": "https://stackoverflow.com/users/10448315/cumhur-ay"}, "edited": false, "score": 1, "creation_date": 1543223110, "post_id": 53430106, "comment_id": 93825392, "body": "Likely you you either aren&#39;t using the latest chrome browser/chromedriver or chromedriver is not in the same folder as your selenium install. If you open the folder location of your selenium install and place your chromedriver.exe in there."}, {"owner": {"reputation": 73, "user_id": 10448315, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gzdV2m4f6GE/AAAAAAAAAAI/AAAAAAAAAZ8/zKlDIBRKK4Y/photo.jpg?sz=128", "display_name": "Cumhur Ay", "link": "https://stackoverflow.com/users/10448315/cumhur-ay"}, "edited": false, "score": 2, "creation_date": 1543231440, "post_id": 53430106, "comment_id": 93829831, "body": "I did what you said and the code worked fine. Thanks."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 2, "last_activity_date": 1542890886, "last_edit_date": 1542890886, "creation_date": 1542886540, "answer_id": 53430106, "question_id": 53417990, "link": "https://stackoverflow.com/questions/53417990/i-want-to-draw-data-from-the-web-with-excel-macro/53430106#53430106", "title": "I want to draw data from the web with Excel macro", "body": "<p>I cannot successfully reproduce the ajax requests that are used to update the page. I get Access Denied which makes me think there must be some protocol/authentication I am missing beyond the simple query string part.</p>\n\n<p>Below is an example using selenium basic. It is slow as I am copying all the formatting across as the layout is a little finicky.</p>\n\n<p>I have written something without using the clipboard which I may add later if I am happy with. It is a lot faster.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub GetInfo()\n    Dim d As WebDriver, clipboard As Object\n    Dim ele As Object, ws As Worksheet, t As Date, weeks As Object, i As Long\n    Const MAX_WAIT_SEC As Long = 15\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n    Set clipboard = GetObject(\"New:{1C3B4210-F441-11CE-B9EA-00AA006B1A69}\")\n    Set d = New ChromeDriver\n    Const URL = \"http://arsiv.sahadan.com/genis_ekran_iddaa_programi/\"\n\n    With d\n        .Start \"Chrome\"\n        .get URL, timeout:=90000\n\n        Set weeks = .FindElementsByCss(\"#weekId option\")\n        .FindElementByCss(\"[value='-1']\").Click\n        For i = 1 To weeks.Count\n            If i &gt; 1 Then\n                .FindElementsByCss(\"#weekId option\")(i).Click\n            End If\n            Dim html As HTMLDocument\n            Set html = New HTMLDocument\n            t = Timer\n            Do\n                DoEvents\n                On Error Resume Next\n                Set ele = .FindElementByCss(\"#dvLarge #resultsList\")\n                On Error GoTo 0\n                If Timer - t &gt; MAX_WAIT_SEC Then Exit Do\n            Loop While ele Is Nothing\n\n            If Not ele Is Nothing Then\n                clipboard.SetText ele.Attribute(\"outerHTML\")\n                clipboard.PutInClipboard\n                ws.Cells.UnMerge\n                Application.Wait Now + TimeSerial(0, 0, 1)\n                ws.Cells(GetLastRow(ws, 1) + 1, 1).PasteSpecial\n                Application.Wait Now + TimeSerial(0, 0, 3)\n            End If\n\n            Set ele = Nothing\n        Next\n        .Quit\n    End With\n\nEnd Sub\n\nPublic Function GetLastRow(ByVal ws As Worksheet, Optional ByVal columnNumber As Long = 1) As Long\n    With ws\n        GetLastRow = .Cells(.Rows.Count, columnNumber).End(xlUp).Row\n    End With\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 10448315, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gzdV2m4f6GE/AAAAAAAAAAI/AAAAAAAAAZ8/zKlDIBRKK4Y/photo.jpg?sz=128", "display_name": "Cumhur Ay", "link": "https://stackoverflow.com/users/10448315/cumhur-ay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 53430106, "answer_count": 1, "score": -1, "last_activity_date": 1543241358, "creation_date": 1542822972, "last_edit_date": 1543241358, "question_id": 53417990, "link": "https://stackoverflow.com/questions/53417990/i-want-to-draw-data-from-the-web-with-excel-macro", "title": "I want to draw data from the web with Excel macro", "body": "<p>I want to take old programs from <a href=\"http://arsiv.sahadan.com/genis_ekran_iddaa_programi/\" rel=\"nofollow noreferrer\">http://arsiv.sahadan.com/genis_ekran_iddaa_programi/</a>. For this I modified the macro with the module called @QHarr, but I couldn't handle the tables. Macro doesn't work.</p>\n\n<pre><code>    Public Sub Deneme()\n    Application.ScreenUpdating = False\n    Sheets(\"X\").Select\n    Cells.Delete Shift:=xlUp\n    Range(\"A1\").Select\n    Dim url As String, ws As Worksheet, html As HTMLDocument, http As clsHTTP, hTable As HTMLTable\n    Dim headerRow As Boolean, trow As Object, tRows As Object, tCell As Object, tCells As Object\n    Dim iRow As Long, R As Long, C As Long, Hsay As Long, numberOfRequests As Long\n    Dim hafta(), results(), headers()\n    headers = Array(\"Hsay\", \"Saat\", \"Lig\", \"Kod\", \"MBS\", \"Ev Sahibi\", \"Misafir\", \"IY\", \"MS\", \"MS1\", \"MSX\", \"MS2\", \"IY1\", \"IYX\", \"IY2\", \"he\", \"H1\", \"HX\", \"H2\", \"hm\", \"KGV\", \"GVY\", \"CS1/X\", \"CS1/2\", \"X/2\", \"IY1,5A\", \"IY1,5U\", \"1,5A\", \"1,5U\", \"2,5A\", \"2,5U\", \"3,5A\", \"3,5U\", \"TG01\", \"TG23\", \"TG46\", \"7+\")\n    Set http = New clsHTTP\n    Set ws = ThisWorkbook.Worksheets(\"X\")\n    Set html = New HTMLDocument\n    hafta = Application.Transpose(Sheets(\"Y\").Range(\"A1:A\" &amp; Sheets(\"Y\").Range(\"A1048576\").End(xlUp).Row).Value)\n    Const numTableRows As Long = 500\n    Const numTableColumns As Long = 37\n    Const BASE_URL As String = \"http://arsiv.sahadan.com/LargeProgram.aspx?\"\n    numberOfRequests = UBound(hafta)\n    ReDim results(1 To numTableRows * numberOfRequests, 1 To numTableColumns)\n    For Hsay = 1 To numberOfRequests\n        headerRow = True\n        url = BASE_URL &amp; \"id=weekId&amp;value=\" &amp; hafta(Hsay)\n        html.body.innerHTML = http.GetString(url)\n        Set hTable = html.querySelector(\"dvLargeHead\")\n        Set tRows = hTable.getElementsByTagName(\"tr\")\n        For Each trow In tRows\n            If Not headerRow Then\n                C = 2: R = R + 1\n                results(R, 1) = hafta(Hsay)\n                Set tCells = trow.getElementsByTagName(\"td\")\n                For Each tCell In tCells\n                    results(R, C) = tCell.innerText\n                    C = C + 1\n                Next\n            End If\n            headerRow = False\n        Next\n    Next\n    With ws\n        .Cells(1, 1).Resize(1, UBound(headers) + 1) = headers\n        .Cells(2, 1).Resize(UBound(results, 1), UBound(results, 2)) = results\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "worksheet"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1542823000, "post_id": 53417935, "comment_id": 93710200, "body": "See <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba/28700020#28700020\">how to avoid using Select in Excel VBA</a>. It should help you avoid using <code>Select</code> and <code>Activate</code>, as well as <code>Cells</code> references that don&#39;t qualify the <code>Worksheet</code> they are on - for example, in <code>Set FindResult = Cells.Find</code>."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1542825053, "post_id": 53417935, "comment_id": 93711068, "body": "What @BigBen says. Presumably you actually want to do something rather than select the found cell? You could add a sheet parameter to your second sub."}, {"owner": {"reputation": 1, "user_id": 10683915, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-KAAh7eU3fNM/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iJf1O_HirCF17OFNGGKIdsDImuIg/mo/photo.jpg?sz=128", "display_name": "Brian Watrous", "link": "https://stackoverflow.com/users/10683915/brian-watrous"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1542843637, "post_id": 53417935, "comment_id": 93718401, "body": "@BigBen Thanks for the pointer to the excellent thread. Switching away from Select/Activate did the trick."}, {"owner": {"reputation": 1, "user_id": 10683915, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-KAAh7eU3fNM/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iJf1O_HirCF17OFNGGKIdsDImuIg/mo/photo.jpg?sz=128", "display_name": "Brian Watrous", "link": "https://stackoverflow.com/users/10683915/brian-watrous"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1542843771, "post_id": 53417935, "comment_id": 93718446, "body": "@SJR That (i.e. adding a worksheet parameter) is exactly what I was planning on doing. I left that out of my example to simplify it. But now I&#39;ve added the worksheet parameter, and it&#39;s quite flexible now. :-)"}], "owner": {"reputation": 1, "user_id": 10683915, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-KAAh7eU3fNM/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iJf1O_HirCF17OFNGGKIdsDImuIg/mo/photo.jpg?sz=128", "display_name": "Brian Watrous", "link": "https://stackoverflow.com/users/10683915/brian-watrous"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1583476881, "creation_date": 1542822755, "last_edit_date": 1583476881, "question_id": 53417935, "link": "https://stackoverflow.com/questions/53417935/finding-text-in-one-worksheet-from-code-on-another-sheet", "title": "Finding text in one worksheet from code on another sheet", "body": "<p>I'm attempting to find a cell containing text. I am able to do so if I perform the search in the same worksheet where the code is defined. But if I perform the search in another worksheet, the search fails.</p>\n\n<p>NOTE: I expect that the issue here is that I don't fully understand how to handle traversing between different worksheets/modules/objects.</p>\n\n<p>My workbook has two worksheets. The first is called 'Alpha':\n<img src=\"https://i.stack.imgur.com/I2R0g.png\" alt=\"IMG1\"></p>\n\n<p>The second worksheet is called 'Beta':\n<img src=\"https://i.stack.imgur.com/QWiR6.png\" alt=\"IMG2\"></p>\n\n<p>And here is the code which I have <strong><em>defined on the Alpha worksheet</em></strong>.</p>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\nDim Country As String\nDim Element As String\nDim BetaWorksheet As Worksheet\nDim MyRange As Range\n\n    ' A friendly message to let us know that we've entered BeforeDoubleClick\n    MsgBox (\"You double clicked: \" &amp; Selection.Value)\n\n    ' The following code works as expected.\n    Country = \"Bosnia and Herzegovina\"\n    MsgBox (\"That's nice, but let's find Bosnia and Herzegovina\" &amp; \".\")\n    FindSomething (Country)\n    MsgBox (\"Notice that \" &amp; Country &amp; \" is selected in the 'Alpha' worksheet.\")\n\n    ' The next lines of code do not work as expected.\n    Element = \"Californium\"\n    MsgBox (\"Now let's look for the element \" &amp; Element &amp; \" in the 'Beta' worksheet.\")\n    MsgBox (\"We start by selecting cell A1 in the 'Beta' worksheet.\")\n    Set BetaWorksheet = ThisWorkbook.Worksheets(\"Beta\")\n    BetaWorksheet.Activate\n    Set MyRange = BetaWorksheet.Range(\"A1\")\n    MyRange.Select\n    MsgBox (\"Now that we've selected A1, let's find \" &amp; Element &amp; \".\")\n    FindSomething (Element)\nEnd Sub\n\nPrivate Sub FindSomething(TheThing As String)\nDim FindResult As Range\n\n    MsgBox (\"Current worksheet: \" &amp; ActiveSheet.Name)\n    MsgBox (\"Searching for: \" &amp; TheThing)\n\n    Set FindResult = Cells.Find(What:=TheThing, After:=ActiveCell, LookIn:=xlFormulas, _\n        LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n        MatchCase:=True, SearchFormat:=False)\n\n    If (FindResult Is Nothing) Then\n        MsgBox (\"Found nothing\")\n    Else\n        FindResult.Activate\n    End If\nEnd Sub\n</code></pre>\n\n<p>To use this problem-reproducing example, go to the Alpha workbook and double click a country. This just kicks off my code.</p>\n\n<p>The first part of the example code attempts to find (and succeeds) a hard-coded country (i.e. Bosnia and Herzegovina).</p>\n\n<p>The second part of the example code attempts to find (but fails) a hard-coded element (i.e. Californium). It seems to me that the problem is that the Cells.Find method is still looking in the Alpha worksheet instead of the Beta worksheet.</p>\n\n<p>Any insights would be greatly appreciated.</p>\n\n<p>BTW... My question is similar to the issue discussed in <a href=\"https://stackoverflow.com/questions/43382407/finding-cell-in-another-sheet\">Finding Cell in another sheet</a>. In that case, the code is defined in a standard module. The difference in my case is that my code is defined on a specific worksheet.</p>\n"}, {"tags": ["sql", "vba", "odbc", "adodb"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1542822083, "post_id": 53417743, "comment_id": 93709761, "body": "&quot;any time I add code here&quot; - like what code?  It doesn&#39;t matter if the password is encrypted (+/- salt) - whatever value the dB returns should be in the recordset."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1542822973, "post_id": 53417743, "comment_id": 93710191, "body": "What is <code>Params</code>?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1542823607, "post_id": 53417743, "comment_id": 93710496, "body": "What is <code>gDataRecord</code> (and if that <code>g</code> means &quot;global&quot;, why on earth are you bothering with encryption if the plain-text password is right there in global scope)? ...the whole approach looks like security theater to me. Why aren&#39;t the passwords <i>hashed</i> and why would credentials even need to be anywhere in the VBA execution context?"}, {"owner": {"reputation": 1, "user_id": 10061259, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209569635716331/picture?type=large", "display_name": "Zac", "link": "https://stackoverflow.com/users/10061259/zac"}, "edited": false, "score": 0, "creation_date": 1542910495, "post_id": 53417743, "comment_id": 93746484, "body": "Gdatarecord is a datastation for BWS. And I&#39;m using this for building automations rather than macros."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 10061259, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209569635716331/picture?type=large", "display_name": "Zac", "link": "https://stackoverflow.com/users/10061259/zac"}, "is_accepted": false, "score": 0, "last_activity_date": 1543245819, "creation_date": 1543245819, "answer_id": 53484267, "question_id": 53417743, "link": "https://stackoverflow.com/questions/53417743/stored-procedure-having-issue-populating-record-set/53484267#53484267", "title": "Stored procedure having issue populating record set", "body": "<p>I figured out the issue. Password was defined as a NVARCHAR(MAX), when I changed it to (255). The recordset held the variable. Thanks everyone who took a look at this.</p>\n"}], "owner": {"reputation": 1, "user_id": 10061259, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209569635716331/picture?type=large", "display_name": "Zac", "link": "https://stackoverflow.com/users/10061259/zac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1543245819, "creation_date": 1542821905, "last_edit_date": 1542823105, "question_id": 53417743, "link": "https://stackoverflow.com/questions/53417743/stored-procedure-having-issue-populating-record-set", "title": "Stored procedure having issue populating record set", "body": "<p>I'm having some issues with an ADODB.Recordset. I call a stored procedure that returns a password and login from the database. Once the usp is executed both the password and login are loaded into the record set. If any line of code is placed before setting the password to a string the password value reverts to Null. This doesn't with the login, only the password. Any thoughts on what I can do to fix this?</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim objConn     As ADODB.Connection\nDim rstResult   As ADODB.recordset\nDim objCmd      As New ADODB.Command\nDim Param       As cSQLParam\nDim ParamValue  As Variant\nDim lngNumRec   As Long\n\n\n\nSet objConn = New ADODB.Connection\nobjConn.Open \"DSN=\" &amp; GetProfileString(gRootFolder &amp; \"InputFolder\\\" &amp; \"ODBC.bds\", \"General\", \"DSN\")\n\n\nSet objCmd = New ADODB.Command\n\nWith objCmd\n    .ActiveConnection = objConn\n    .CommandText = \"[dbo].[usp_Credentials_GetUserCredentials]\"\n    .CommandType = adCmdStoredProc\n    .CommandTimeout = 0\n    For Each Param In Params\n        .Parameters.Append .CreateParameter(Param.Name, Param.DataType, Param.Direction, Param.Size, IIf(Param.Value = \"\", Null, Param.Value))\n    Next\n\nEnd With\n\n\n\nSet rstResult = objCmd.Execute\n\n'any time I add code here the password shows up as Null, If no code is here the \n'correct password is displayed. Could this have to do with the password being \n'encrypted with a Salt on the server?\n\n\n'Capture the password\ngDataRecord.Password = rstResult(\"Password\")\n\n'Capture the Login\ngDataRecord.Login = rstResult(\"LoginName\")\n\n\n\nrstResult.Close\nobjConn.Close\n</code></pre>\n"}, {"tags": ["excel", "vba", "pivot-table"], "owner": {"reputation": 57, "user_id": 6950706, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154572720073718/picture?type=large", "display_name": "DarrenMcGettigan", "link": "https://stackoverflow.com/users/6950706/darrenmcgettigan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1336, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1583480815, "creation_date": 1542821398, "last_edit_date": 1583476893, "question_id": 53417637, "link": "https://stackoverflow.com/questions/53417637/filter-a-pivot-table-based-on-cell", "title": "Filter a Pivot Table Based on Cell", "body": "<p>I have used <a href=\"https://www.mrexcel.com/forum/excel-questions/950078-filtering-pivot-table-based-cell-value.html\" rel=\"nofollow noreferrer\">https://www.mrexcel.com/forum/excel-questions/950078-filtering-pivot-table-based-cell-value.html</a> to create the code below but I am getting an error on </p>\n\n<p><code>Set Field = pt.PivotFields(\"EmployeeName\")</code> </p>\n\n<p>It is saying </p>\n\n<p><code>Unable to get the PivotFields property of the PivotTable class</code></p>\n\n<p>Even though <code>EmployeeName</code> is a field in my pivot table.  Now I do have 2 databases in the Data Model that both have <code>EmployeeName</code> as a field and they are linked via a relationship.  Do I need to specify which database I want to use and how would I do that?  My script is below for reference.</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n\n'This line stops the worksheet updating on every change, it only updates when cell\n'H6 or H7 is touched\nIf Intersect(Target, Range(\"H6:H7\")) Is Nothing Then Exit Sub\n\n'Set the Variables to be used\nDim pt As PivotTable\nDim Field As PivotField\nDim NewCat As String\n\n'Here you amend to suit your data\nSet pt = Worksheets(\"2018IndSales\").PivotTables(\"PivotTable4\")\nSet Field = pt.PivotFields(\"EmployeeName\")\nNewCat = Worksheets(\"2018IndSales\").Range(\"H6\").Value\n\n'This updates and refreshes the PIVOT table\nWith Worksheets(\"2018IndSales\").PivotTables(\"PivotTable4\").PivotFields(\"EmployeeName\")\n    .ClearAllFilters\n    .PivotFilters.Add Type:=xlCaptionEquals, Value1:=Worksheets(\"2018IndSales\").Range(\"H6\").Value\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "pdf"], "comments": [{"owner": {"reputation": 352, "user_id": 3092495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/T4wqV.jpg?s=128&g=1", "display_name": "Rey Juna", "link": "https://stackoverflow.com/users/3092495/rey-juna"}, "edited": false, "score": 1, "creation_date": 1542821943, "post_id": 53417296, "comment_id": 93709700, "body": "This may not be an Excel issue, but the PDF print driver.  Try printing a Word document to a PDF and see if you get something similar.  You may have a Freeware software driver and they often append some type of header/footer to printouts until you make the purchase."}, {"owner": {"reputation": 1, "user_id": 10687031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e8a55d92a7df417d2eb034d9bb822d6?s=128&d=identicon&r=PG&f=1", "display_name": "Terry B", "link": "https://stackoverflow.com/users/10687031/terry-b"}, "reply_to_user": {"reputation": 352, "user_id": 3092495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/T4wqV.jpg?s=128&g=1", "display_name": "Rey Juna", "link": "https://stackoverflow.com/users/3092495/rey-juna"}, "edited": false, "score": 0, "creation_date": 1542830144, "post_id": 53417296, "comment_id": 93713439, "body": "Thanks I&#39;ll check that out. This is a corporate computer and office suite, with no special addon that I am aware of. The Network has a driver for CutePDF that I sometimes use from Word, or Excel and have never had this issue. I&#39;m using the xlTypePDF from in the VBA. I&#39;m not sure how to call the CutePDF driver from VBA or if I can. I have gone through the Print settings that I know about and there are no headers/footers or odd margins that I can find."}, {"owner": {"reputation": 352, "user_id": 3092495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/T4wqV.jpg?s=128&g=1", "display_name": "Rey Juna", "link": "https://stackoverflow.com/users/3092495/rey-juna"}, "edited": false, "score": 0, "creation_date": 1542831783, "post_id": 53417296, "comment_id": 93714136, "body": "Recommend recording a macro of your manual Excel print job. See answer below."}], "answers": [{"tags": [], "owner": {"reputation": 352, "user_id": 3092495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/T4wqV.jpg?s=128&g=1", "display_name": "Rey Juna", "link": "https://stackoverflow.com/users/3092495/rey-juna"}, "is_accepted": false, "score": 0, "last_activity_date": 1542834684, "last_edit_date": 1542834684, "creation_date": 1542831719, "answer_id": 53419933, "question_id": 53417296, "link": "https://stackoverflow.com/questions/53417296/delete-header-sample-excel-file-saved-as-pdf/53419933#53419933", "title": "Delete header Sample Excel file saved as PDF", "body": "<p>Recommend you use the same driver here that you use to print manually, since there you have no issues.  I recorded a macro for my system below and then added the <code>PrToFileName</code> parameter.  Recommend you do the same and integrate it into your code.</p>\n\n<pre><code>Sub TestPrinting()\n' TestPrinting Macro\n\n    Application.ActivePrinter = \"Microsoft Print to PDF on xx01:\"\n    ActiveWindow.SelectedSheets.PrintOut Copies:=1, ActivePrinter:= _\n        \"Microsoft Print to PDF on xx01:\", Collate:=True, IgnorePrintAreas:=False, _\n        PrToFileName:=\"C:\\Users\\juna\\Desktop\\TestPDFPrint.pdf\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10687031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e8a55d92a7df417d2eb034d9bb822d6?s=128&d=identicon&r=PG&f=1", "display_name": "Terry B", "link": "https://stackoverflow.com/users/10687031/terry-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 157, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542834684, "creation_date": 1542820210, "last_edit_date": 1542821152, "question_id": 53417296, "link": "https://stackoverflow.com/questions/53417296/delete-header-sample-excel-file-saved-as-pdf", "title": "Delete header Sample Excel file saved as PDF", "body": "<p>I am working on a Excel report that takes data from another Excel Workbook, imports the data and does statistical analysis. This is moved to a worksheet and graphs are generated from the data. All of this is formatted for printing. In the Macros that are written to do this is a sub macro that takes this Report and saves it to a network drive for uploading and also shows the PDF so you can print it.\nThe problem: when it creates the PDF it adds a line to the top of the PDF that states \"Sample Excel file Saved as PDF\". This is also on the saved PDF that will be uploaded as part of file in our HIS. \nHow do I not get this on the PDF. It is not part of, and should not be on the PDF.</p>\n\n<p>Below is the code I use to setup the PDF save and Print it.</p>\n\n<pre><code>Sub Save_PDF()\n\n     Dim Path1 As String\n     Dim Path2 As String\n     Path1 = \"c:Test Result\\...\\\"\n\n'Range where spefic file name is placed for this occurance\n\n     Path2 = Range(\"A79\")\n\n    With ActiveSheet.PageSetup\n        .Orientation = xlPortrait\n        .PrintArea = \"$A$1:$AE$75\"\n        .Zoom = False\n        .FitToPagesTall = 1\n        .FitToPagesWide = 1\n    End With\n\n'Setup saves as report and place in drive for upload to HIS\n\n    ActiveSheet.ExportAsFixedFormat _\n        Type:=xlTypePDF, _\n        filename:=Path1 &amp; Path2, _\n        Quality:=xlQualityStandard, _\n        IncludeDocProperties:=False, _\n        IgnorePrintAreas:=False\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 186, "user_id": 1621800, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/48b85efa4cec9b08b041b22925b2c347?s=128&d=identicon&r=PG", "display_name": "pascal sautot", "link": "https://stackoverflow.com/users/1621800/pascal-sautot"}, "edited": false, "score": 0, "creation_date": 1542900849, "post_id": 53421545, "comment_id": 93742113, "body": "the problem does not concern how to set the validation for the date which on french system does not use the anglo saxon convention : when typing a date like 03/23/2018 surprisingly the validation will throw an error not  matter how the value is rendered. <b>The problem</b> is about the inconsistency on how a date is represented internally and how it is rendered to the user when applying a format using VBA. I would expect that applying a format manually would give the same result as applying it via VBA"}, {"owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "reply_to_user": {"reputation": 186, "user_id": 1621800, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/48b85efa4cec9b08b041b22925b2c347?s=128&d=identicon&r=PG", "display_name": "pascal sautot", "link": "https://stackoverflow.com/users/1621800/pascal-sautot"}, "edited": false, "score": 0, "creation_date": 1542901498, "post_id": 53421545, "comment_id": 93742453, "body": "No, as mentioned VBA always uses US-dateformat, did you try the above code?"}, {"owner": {"reputation": 186, "user_id": 1621800, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/48b85efa4cec9b08b041b22925b2c347?s=128&d=identicon&r=PG", "display_name": "pascal sautot", "link": "https://stackoverflow.com/users/1621800/pascal-sautot"}, "edited": false, "score": 0, "creation_date": 1542902087, "post_id": 53421545, "comment_id": 93742744, "body": "the validation is <b>not</b> the problem but the change of value while formatting. A macro copy the value then format a range of dates then as a result month and day are swapped (the value and how it is displayed are consistent afterwards). This is not the user input processing which occurs the problem only its display (formatting) afterwards. The application is a client server. Say the input happens a day and isplayed properly and the value is loaded from the data base and displayed another day following the process described above."}, {"owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "reply_to_user": {"reputation": 186, "user_id": 1621800, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/48b85efa4cec9b08b041b22925b2c347?s=128&d=identicon&r=PG", "display_name": "pascal sautot", "link": "https://stackoverflow.com/users/1621800/pascal-sautot"}, "edited": false, "score": 0, "creation_date": 1542903687, "post_id": 53421545, "comment_id": 93743556, "body": ".Value = DateValue(&quot;04/05/2018&quot;)"}], "tags": [], "owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "is_accepted": false, "score": 0, "last_activity_date": 1542840679, "creation_date": 1542840679, "answer_id": 53421545, "question_id": 53417268, "link": "https://stackoverflow.com/questions/53417268/excel-date-format-and-value-inconsistency/53421545#53421545", "title": "Excel date format and value inconsistency", "body": "<p>VBA uses (always) US date formatting, does the help of DateValue (see below) work for you?</p>\n\n<pre><code>Sub SetValidation(ByVal dataRange as Range)\n\nWith dataRange\n    With .Validation\n    On Error GoTo ErrorHandler\n        .Delete\n        .Add Type:=xlValidateDate, AlertStyle:=xlValidAlertStop, _\n            Operator:=xlGreater, Formula1:=DateValue(\"04/05/2018\")\n        .InCellDropdown = True\n        .IgnoreBlank = True\n        .ErrorTitle = \"\"\n        .ErrorMessage = \"\"\n        .ShowInput = False\n        .ShowError = True\n    End With '.Validation\nEnd With 'dataRange\nErrorExit:\nExit Sub\n    ' process error\n    GoTo ErrorExit\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 186, "user_id": 1621800, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/48b85efa4cec9b08b041b22925b2c347?s=128&d=identicon&r=PG", "display_name": "pascal sautot", "link": "https://stackoverflow.com/users/1621800/pascal-sautot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 124, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542901427, "creation_date": 1542820110, "last_edit_date": 1542901427, "question_id": 53417268, "link": "https://stackoverflow.com/questions/53417268/excel-date-format-and-value-inconsistency", "title": "Excel date format and value inconsistency", "body": "<p>I am trying to understand how Excel works with date formats and date values.</p>\n\n<p><strong>context of the problem:</strong></p>\n\n<p>My application has the following architecture </p>\n\n<ul>\n<li>An Excel VBA client: 2016 French with windows 7 French</li>\n<li>An SQL server data base</li>\n</ul>\n\n<p>In the Excel workbook a sheet has a <code>Change</code> event handler used to capture data (for the simplicity of the explanation let's suppose there are all dates) and save the input value into the database. Values are captured and saved as strings and loaded as text and formatted as dates once in the sheet.</p>\n\n<p>In the sheet the <code>Change</code> event handler processes the input which is traced with the following code  (event handler is disabled when loading the data from the database).</p>\n\n<pre><code>With Target \n    Dim mydate As Date\n    mydate = CDate(.Value)\n    Debug.Print \" day = \" &amp; Day(mydate) &amp; \", month = \" &amp; Month(mydate)\nEnd with\n</code></pre>\n\n<p>When a format is set manually (right click in a cell > format cell > date > select or define the format you wish) months and days are interpreted as expected.</p>\n\n<p>Having set a validation on the input if I try to input a date such as 10/23/2018 Excel throws an error (I have a French operating system and a French Excel version). In this example  the first item in a date is day (10) followed by month (23, not valid for this example) and finally year (2018). </p>\n\n<pre><code>Sub SetValidation(ByVal dataRange as Range)\n\nWith dataRange\n    With .Validation\n    On Error GoTo ErrorHandler\n        .Delete\n        .Add Type:=xlValidateDate, AlertStyle:=xlValidAlertStop, _\n            Operator:=xlGreater, Formula1:=\"1/1/1900\"\n        .InCellDropdown = True\n        .IgnoreBlank = True\n        .ErrorTitle = \"\"\n        .ErrorMessage = \"\"\n        .ShowInput = False\n        .ShowError = True\n    End With '.Validation\nEnd With 'dataRange\nErrorExit:\nExit Sub\n    ' process error\n    GoTo ErrorExit\nEnd Sub\n</code></pre>\n\n<p>When I type 23/10/2018 the input is accepted and saved as typed (as a string).</p>\n\n<p>Now when the input is 04/05/2018, for instance, the date is potentially ambiguous depending on whether the environment of the user reading it is French or Anglo-Saxon. </p>\n\n<p>So I want to make it clear what was typed using an explicit format with the month displayed as a string. </p>\n\n<p>If I set a format as \"dd mmm yyyy\" the value is displayed as 04 mai 2018 (day =04, month= may) and the trace in the <code>Change</code> event handler outputs the following </p>\n\n<p><strong>day = 4, month = 5</strong> which is consistent with what is displayed.</p>\n\n<p>Now when the exact same format is applied using VBA code it does not provide the same output - day and month are swapped. </p>\n\n<pre><code>With dataRange\n    .NumberFormat = \"dd mmm yyyy\"\n    .Value = .Value 'force format to update \nend With \n</code></pre>\n\n<p>To make it clear:</p>\n\n<ul>\n<li>VBA loads a date string as \"04/05/2018\"</li>\n<li>VBA  applies the format \"dd mmm yyyy\" and the date is formatted as \"5 apr 2018\"</li>\n<li>A user types in \"04/05/2018\" in a blank cell with the same format and the date is formatted as \"4 may 2018\"</li>\n</ul>\n\n<p>The problem does not concern how to set a validation for a date which on a french system does not use the anglo saxon convention: when typing a date like 03/23/2018 surprisingly the validation throws an error no matter how the value is rendered. </p>\n\n<p><strong>The problem</strong> is about the inconsistency on how a date is represented internally and how it is rendered to the user when applying a format using VBA. I would expect that applying a format manually would give the same result as applying it via VBA. </p>\n\n<p>when the <strong>date 04/05/2018 is input it is validated</strong> but <strong>applying the format in VBA the value becomes 05/04/2018</strong>.</p>\n\n<p>In both cases the format instruction is exactly the same.</p>\n\n<p>I'd like to understand why the VBA code and the Excel user interface have different behavior and if a fix would be available.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "is_accepted": false, "score": 0, "last_activity_date": 1542842455, "creation_date": 1542842455, "answer_id": 53421815, "question_id": 53416999, "link": "https://stackoverflow.com/questions/53416999/vba-code-to-remove-a-range-of-cells-in-a-row-if-a-cells-condition-criteria-is-m/53421815#53421815", "title": "VBA code to remove a range of cells in a row if a cell&#39;s condition criteria is met", "body": "<p>Your explanation of what you want to do seems to be quite different to your actual (non-working code).  If you simply wish to clear range A4:M4 if A4 is blank you could use:</p>\n\n<pre><code>Sub cleaner()\n\n    If Range(\"A4\").Value = \"\" Then\n        Range(\"A4:M4\").Clear\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10686996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03000511e922e98ecaea2ce9eeac350f?s=128&d=identicon&r=PG&f=1", "display_name": "Tbryan", "link": "https://stackoverflow.com/users/10686996/tbryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542842455, "creation_date": 1542819213, "last_edit_date": 1542820507, "question_id": 53416999, "link": "https://stackoverflow.com/questions/53416999/vba-code-to-remove-a-range-of-cells-in-a-row-if-a-cells-condition-criteria-is-m", "title": "VBA code to remove a range of cells in a row if a cell&#39;s condition criteria is met", "body": "<p>First post on here, so apologies if I'm off on anything.  This site has been extremely useful for me so wanted to toss out a relatively simple question I can't seem to find a direct answer for anywhere.</p>\n\n<p>I'm trying to run a cleanup macro to delete a range of cells in a row based on the condition of Cell <code>A4</code> being blank.  I do not want to delete the entire row as there is separate data a few columns over from the range indicated below.</p>\n\n<p>The range of cells I want to delete is from Cell <code>A4:M4</code> based on <code>A4</code> being blank, as the values in Range A4:D4 are imported static values that vary with each import, and the values in Range E4:M4 are formulaic index cells that respond to the value in cell <code>A4</code>. </p>\n\n<p>Any help is appreciated.  Existing code is below:</p>\n\n<pre><code>Sub Cleaner()\n  Dim rng As Range\n  On Error Resume Next\n  Set rng = Range(\"A4:M549\").SpecialCells(xlCellTypeBlanks)\n  On Error GoTo 0\n  rng.Rows.Delete Shift:=xlShiftUp\nExit Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1542818228, "post_id": 53416575, "comment_id": 93707735, "body": "Works for me. Do you definitely have a column headed &quot;Associate&quot;?"}, {"owner": {"reputation": 2239, "user_id": 1473412, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7ac8599add0ace676200f6d50d6d2ff1?s=128&d=identicon&r=PG", "display_name": "Gravitate", "link": "https://stackoverflow.com/users/1473412/gravitate"}, "edited": false, "score": 1, "creation_date": 1542818395, "post_id": 53416575, "comment_id": 93707825, "body": "I&#39;d fully qualify the <code>Range(&quot;Table1[[#All],[Associate]]&quot;)</code>. Thisworkbook.sheets(&quot;Log&quot;)? I&#39;d also suggest you use ThisWorkBook instead of ActiveWorkBook. ActiveWorkbook can cause unexpected errors if you swap to another workbook while the macro is running."}, {"owner": {"reputation": 13, "user_id": 9254253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db4d01ae3c819f6ee933a6d049d90dd1?s=128&d=identicon&r=PG&f=1", "display_name": "KC0904", "link": "https://stackoverflow.com/users/9254253/kc0904"}, "edited": false, "score": 0, "creation_date": 1542818516, "post_id": 53416575, "comment_id": 93707894, "body": "SJR - Yes I have a column header titled Associate."}, {"owner": {"reputation": 13, "user_id": 9254253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db4d01ae3c819f6ee933a6d049d90dd1?s=128&d=identicon&r=PG&f=1", "display_name": "KC0904", "link": "https://stackoverflow.com/users/9254253/kc0904"}, "edited": false, "score": 0, "creation_date": 1542818821, "post_id": 53416575, "comment_id": 93708084, "body": "Thanks Gravitate. After further review my column header had a space at the end of it. Once I removed it the code worked. I also made your recommendations regarding the ThisWorkBook. Thank you for your help."}, {"owner": {"reputation": 13, "user_id": 9254253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db4d01ae3c819f6ee933a6d049d90dd1?s=128&d=identicon&r=PG&f=1", "display_name": "KC0904", "link": "https://stackoverflow.com/users/9254253/kc0904"}, "edited": false, "score": 0, "creation_date": 1542823233, "post_id": 53416575, "comment_id": 93710320, "body": "The above code works like a charm (human error). However once the code has finished it takes me back to the top of the table. Is there a way to keep the focus on the last row completed?"}], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 9254253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db4d01ae3c819f6ee933a6d049d90dd1?s=128&d=identicon&r=PG&f=1", "display_name": "KC0904", "link": "https://stackoverflow.com/users/9254253/kc0904"}, "is_accepted": false, "score": 0, "last_activity_date": 1542819438, "creation_date": 1542819438, "answer_id": 53417075, "question_id": 53416575, "link": "https://stackoverflow.com/questions/53416575/excel-vba-auto-sort-once-row-has-been-completed/53417075#53417075", "title": "Excel VBA Auto Sort Once Row Has been completed", "body": "<p>After reviewing the comments by SJR &amp; Gravitate I rechecked my header column. It appears that there was an extra space at the end which once I removed it the code worked as intended. </p>\n"}], "owner": {"reputation": 13, "user_id": 9254253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db4d01ae3c819f6ee933a6d049d90dd1?s=128&d=identicon&r=PG&f=1", "display_name": "KC0904", "link": "https://stackoverflow.com/users/9254253/kc0904"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1583491578, "creation_date": 1542817865, "last_edit_date": 1583491578, "question_id": 53416575, "link": "https://stackoverflow.com/questions/53416575/excel-vba-auto-sort-once-row-has-been-completed", "title": "Excel VBA Auto Sort Once Row Has been completed", "body": "<p>I have the following code but I am getting the following error:\nRun-time error '1004': \nMethod 'Range' of object '_Worksheet' failed</p>\n\n<p>I can't seem to figure this out. The error appears on the If Not Intersect row. Any help would be greatly appreciated. </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nActiveWorkbook.Worksheets(\"Log\").ListObjects(\"Table1\").Sort.SortFields.Clear\nActiveWorkbook.Worksheets(\"Log\").ListObjects(\"Table1\").Sort.SortFields. _\n    Add Key:=Range(\"Table1[[#ALL],[Date]]\"), SortOn:=xlSortOnValues, Order _\n    :=xlAscending, DataOption:=xlSortNormal\nActiveWorkbook.Worksheets(\"Log\").ListObjects(\"Table1\").Sort.SortFields. _\n    Add Key:=Range(\"Table1[[#All],[Time]]\"), SortOn:=xlSortOnValues, Order _\n    :=xlAscending, DataOption:=xlSortNormal\nIf Not Intersect(Target, Range(\"Table1[[#All],[Associate]]\")) Is Nothing Then\n    With ActiveWorkbook.Worksheets(\"Log\").ListObjects(\"Table1\").Sort\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\nEnd If\nEnd Sub\n</code></pre>\n\n<p>The above code works like a charm (human error). However once the code has finished it takes me back to the top of the table. Is there a way to keep the focus on the last row completed? </p>\n"}, {"tags": ["excel", "vba", "import"], "comments": [{"owner": {"reputation": 1854, "user_id": 6071871, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IfFKy.jpg?s=128&g=1", "display_name": "ArcherBird", "link": "https://stackoverflow.com/users/6071871/archerbird"}, "edited": false, "score": 0, "creation_date": 1542818972, "post_id": 53416555, "comment_id": 93708177, "body": "When you say &quot;it fails&quot; are you getting an error? Which line of code is producing an error? Or is it simply not doing what it is supposed to do?"}, {"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 0, "creation_date": 1542819343, "post_id": 53416555, "comment_id": 93708405, "body": "Welcome to SO. Could not understand question clearly. Tried your code with minor modification for unique worksheet name like <code>newName &amp; i</code> and it is importing all the sheets from the selected files. However if you mean to avoid importing empty sheet may use the <a href=\"https://www.extendoffice.com/documents/excel/4649-excel-check-if-a-sheet-is-empty.html\" rel=\"nofollow noreferrer\">link</a> to detect empty sheets."}], "answers": [{"tags": [], "owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "is_accepted": false, "score": 0, "last_activity_date": 1542839305, "creation_date": 1542839305, "answer_id": 53421325, "question_id": 53416555, "link": "https://stackoverflow.com/questions/53416555/excel-import-sheet-from-other-workbook/53421325#53421325", "title": "Excel - Import sheet from other workbook", "body": "<p>How do I change the code so it's only imports a specific named sheet?</p>\n\n<p>Your code is not testing for sheet names, it just copies all sheets from the <code>sourcewb</code> workbook to the destination one.  If you want to copy only sheets with a specified name, you have to check if it exists:</p>\n\n<pre><code>For i = 1 To sourcewb.Sheets.Count\n    If sourcewb.Worksheets(i).Name = \"This is it\" Then\n        sourcewb.Worksheets(i).Copy After:=.Sheets(.Sheets.Count)\n        .Worksheets(.Sheets.Count).Name = newName\n        sourcewb.Close\n        Exit Sub\n    End If\n    x = x + 1\nNext\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10686912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddb3cbe7d318cd383c5e819ae9e92fd0?s=128&d=identicon&r=PG&f=1", "display_name": "and", "link": "https://stackoverflow.com/users/10686912/and"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 143, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542839305, "creation_date": 1542817815, "question_id": 53416555, "link": "https://stackoverflow.com/questions/53416555/excel-import-sheet-from-other-workbook", "title": "Excel - Import sheet from other workbook", "body": "<p>I'm stalled, and need some help.\nThe function i need is to open workbooks through a dialogbox and import a specific sheet into the active workbook.\nThe below macro work if there is only one sheet, but someone got the idea to add another sheet and then it fails...</p>\n\n<p>How do I change the code so it's only imports a specific named sheet?</p>\n\n<pre><code>&lt;pre&gt;\n&lt;code&gt;\nSub Files()\nDim openfiles\nDim wb As Workbook\nDim sourcewb As Workbook\nDim newName As String\nDim x As Integer\n\nSet wb = Application.ActiveWorkbook\n\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\n\nopenfiles = Application.GetOpenFilename(FileFilter:=\"Microsoft Excel Files \n(*.xls;*.xlsx),*.xls;*.xlsx\", MultiSelect:=True, Title:=\"Select file(s) for \nimport!\")\n\nIf TypeName(openfiles) = \"Boolean\" Then\nMsgBox \"You have to choose a file\"\nGoTo ExitHandler\nEnd If\n\n\nWith wb\nx = 1\nWhile x &lt;= UBound(openfiles)\n    Set sourcewb = Workbooks.Open(Filename:=openfiles(x))\n    newName = sourcewb.Name\n\nFor i = 1 To sourcewb.Sheets.Count\n    sourcewb.Worksheets(i).Copy After:=.Sheets(.Sheets.Count)\n    .Worksheets(.Sheets.Count).Name = newName\n    Next\n    sourcewb.Close\n    x = x + 1\nWend\nEnd With\n\n'There is a lot of other code below this\n\nApplication.DisplayAlerts = True\nApplication.ScreenUpdating = True\n\nEnd Sub\n\n&lt;/code&gt;\n&lt;/pre&gt;\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 505, "user_id": 9204831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KwPAL.png?s=128&g=1", "display_name": "Lodi", "link": "https://stackoverflow.com/users/9204831/lodi"}, "edited": false, "score": 0, "creation_date": 1542817081, "post_id": 53416223, "comment_id": 93706992, "body": "Using <code>If Dir(filepath)</code>, you could keep appending Copy to the end of the file until there&#39;s no file named <code>filepath</code> found."}, {"owner": {"reputation": 505, "user_id": 9204831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KwPAL.png?s=128&g=1", "display_name": "Lodi", "link": "https://stackoverflow.com/users/9204831/lodi"}, "edited": false, "score": 0, "creation_date": 1542817271, "post_id": 53416223, "comment_id": 93707093, "body": "Or even sum + 1 at a index sufix on the pathfile."}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 1, "creation_date": 1542817478, "post_id": 53416223, "comment_id": 93707238, "body": "You don&#39;t need the .add. Just be aware that each time you save the document the document name is updated to match the filename you have just used for saving so if you want to retain your original filename, save the .name in a variable and then do a final .saveas2 using .name to restore your original filename (although the file will be the final edited version)"}, {"owner": {"reputation": 87, "user_id": 4746657, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fcc3db2e9a8206813d5ff622e5d8c7c1?s=128&d=identicon&r=PG&f=1", "display_name": "Miguel Ortiz", "link": "https://stackoverflow.com/users/4746657/miguel-ortiz"}, "edited": false, "score": 0, "creation_date": 1542817488, "post_id": 53416223, "comment_id": 93707250, "body": "I\u2019m sorry Lodi, but I\u2019m not sure I understand this quite yet. Would it be possible for you to clarify how this would save a new file without closing the active document?"}, {"owner": {"reputation": 87, "user_id": 4746657, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fcc3db2e9a8206813d5ff622e5d8c7c1?s=128&d=identicon&r=PG&f=1", "display_name": "Miguel Ortiz", "link": "https://stackoverflow.com/users/4746657/miguel-ortiz"}, "edited": false, "score": 0, "creation_date": 1542817706, "post_id": 53416223, "comment_id": 93707391, "body": "I edited my question seeing that the old question wasn\u2019t conveying my problem effectively."}], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 4746657, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fcc3db2e9a8206813d5ff622e5d8c7c1?s=128&d=identicon&r=PG&f=1", "display_name": "Miguel Ortiz", "link": "https://stackoverflow.com/users/4746657/miguel-ortiz"}, "edited": false, "score": 0, "creation_date": 1542821693, "post_id": 53417493, "comment_id": 93709569, "body": "After the first my_doc.SaveAs2, the vba code stops running, and Word hangs when executing the second my_doc.SaveAs2. This appears to be doing the same thing as my code + Word hanging up."}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "reply_to_user": {"reputation": 87, "user_id": 4746657, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fcc3db2e9a8206813d5ff622e5d8c7c1?s=128&d=identicon&r=PG&f=1", "display_name": "Miguel Ortiz", "link": "https://stackoverflow.com/users/4746657/miguel-ortiz"}, "edited": false, "score": 0, "creation_date": 1542823445, "post_id": 53417493, "comment_id": 93710422, "body": "Works fine on my pc. You WILL need to edit the file path to one that actually exists on your PC."}, {"owner": {"reputation": 87, "user_id": 4746657, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fcc3db2e9a8206813d5ff622e5d8c7c1?s=128&d=identicon&r=PG&f=1", "display_name": "Miguel Ortiz", "link": "https://stackoverflow.com/users/4746657/miguel-ortiz"}, "edited": false, "score": 0, "creation_date": 1542845790, "post_id": 53417493, "comment_id": 93718999, "body": "Thanks @Freeflow I really appreciate your help. My error was elsewhere that was causing the file to be stuck in an infinite loop, but your code does the trick to save files like I wanted."}], "tags": [], "owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "is_accepted": true, "score": 1, "last_activity_date": 1542820837, "creation_date": 1542820837, "answer_id": 53417493, "question_id": 53416223, "link": "https://stackoverflow.com/questions/53416223/word-vba-save-multiple-files/53417493#53417493", "title": "Word VBA - Save Multiple Files", "body": "<p>The code below demonstrates what you need to know.</p>\n\n<pre><code>Sub test()\n\nDim my_doc                      As Word.Document\nDim my_index                    As Long\nDim my_initial_name             As String\n\n    Set my_doc = ActiveDocument\n\n    my_initial_name = my_doc.FullName\n\n    For my_index = 1 To 10\n        '&lt;OTHER ACTIONS BEFORE SAVING&gt;\n        my_doc.SaveAs2 FileName:=\"C:\\Users\\XXX\\Downloads\\Baby Shower Table Games_Updated_\" &amp; CStr(my_index) &amp; \".docm\"\n    Next\n\n    my_doc.SaveAs2 FileName:=my_initial_name\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 45, "user_id": 2923934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41e3ed9f35f423009b1fffda70f87235?s=128&d=identicon&r=PG&f=1", "display_name": "deku", "link": "https://stackoverflow.com/users/2923934/deku"}, "is_accepted": false, "score": 0, "last_activity_date": 1543520925, "creation_date": 1543520925, "answer_id": 53546512, "question_id": 53416223, "link": "https://stackoverflow.com/questions/53416223/word-vba-save-multiple-files/53546512#53546512", "title": "Word VBA - Save Multiple Files", "body": "<p>Maybe you shoud use <code>FileCopy</code> instead <code>.SaveAs</code>.</p>\n"}], "owner": {"reputation": 87, "user_id": 4746657, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fcc3db2e9a8206813d5ff622e5d8c7c1?s=128&d=identicon&r=PG&f=1", "display_name": "Miguel Ortiz", "link": "https://stackoverflow.com/users/4746657/miguel-ortiz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 411, "favorite_count": 0, "accepted_answer_id": 53417493, "answer_count": 2, "score": 0, "last_activity_date": 1583030475, "creation_date": 1542816794, "last_edit_date": 1583030475, "question_id": 53416223, "link": "https://stackoverflow.com/questions/53416223/word-vba-save-multiple-files", "title": "Word VBA - Save Multiple Files", "body": "<p>Hi I have a word file that makes a change to a table using VBA. After every change, I would like to save a new file with these changes. This way I have 10 copies with 10 different tables. </p>\n\n<p>But currently, when I perform the code below, it exits the original, and thereby exiting the loop. Excel has a method SaveCopyAs, which Word doesn't have. Are there any ways to workaround this?</p>\n\n<blockquote>\n  <p>Documents.Add.SaveAs2 FileName:=(\"C:\\Users\\XXX\\Downloads\\Baby\n  Shower Table Games_Updated_\" &amp; x &amp; \".docm\")</p>\n</blockquote>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1542816897, "post_id": 53416193, "comment_id": 93706860, "body": "ThisWorkbook (the one containing the code) doesn&#39;t have a &quot;Sheet1&quot;?"}, {"owner": {"reputation": 13, "user_id": 10686855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffa48887abe185151d2e4b861fbc714b?s=128&d=identicon&r=PG&f=1", "display_name": "Alessandro", "link": "https://stackoverflow.com/users/10686855/alessandro"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1542817182, "post_id": 53416193, "comment_id": 93707050, "body": "Yes it does have a Sheet1 also called Master Log, I tried both solutions still nothing unfortunately :("}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1542817220, "post_id": 53416193, "comment_id": 93707070, "body": "If it&#39;s called &quot;Master Log&quot; it&#39;s not called &quot;Sheet1&quot;! <code>Set ssheet = ThisWorkbook.Sheets(&quot;Master Log&quot;)</code> The sheet code name is different from the tab name."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10686855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffa48887abe185151d2e4b861fbc714b?s=128&d=identicon&r=PG&f=1", "display_name": "Alessandro", "link": "https://stackoverflow.com/users/10686855/alessandro"}, "edited": false, "score": 0, "creation_date": 1542817300, "post_id": 53416357, "comment_id": 93707108, "body": "Thank you, I changed the name of my Master Log (Sheet1) into Sheet1. now the debugger says that the error is in the following line:  nr = ssheet.Cells(Rows.Count, 1).End(x1Up).Row + 1"}, {"owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1542817420, "post_id": 53416357, "comment_id": 93707196, "body": "@SJR nice catch"}, {"owner": {"reputation": 13, "user_id": 10686855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffa48887abe185151d2e4b861fbc714b?s=128&d=identicon&r=PG&f=1", "display_name": "Alessandro", "link": "https://stackoverflow.com/users/10686855/alessandro"}, "edited": false, "score": 1, "creation_date": 1542817862, "post_id": 53416357, "comment_id": 93707498, "body": "solved with the xlup and not x1up sorry guys so stupid! thank you so much for your help!!!!"}], "tags": [], "owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "is_accepted": true, "score": 1, "last_activity_date": 1542817409, "last_edit_date": 1542817409, "creation_date": 1542817194, "answer_id": 53416357, "question_id": 53416193, "link": "https://stackoverflow.com/questions/53416193/thisworkbook-sheetssheet1-generates-run-time-error-9-subscript-out-of-rang/53416357#53416357", "title": "ThisWorkbook.Sheets(&quot;Sheet1&quot;) generates Run-Time error &#39;9&#39; Subscript out of range", "body": "<p>When using the line:</p>\n\n<pre><code>Set ssheet = ThisWorkbook.Sheets(\"Sheet1\")\n</code></pre>\n\n<p>Make sure <code>\"Sheet1\"</code> is actually the name of your sheet on your Workbook</p>\n\n<p>Per your comment you can use:</p>\n\n<p><code>Set ssheet = ThisWorkbook.Sheets(1)</code> or <code>Set ssheet = ThisWorkbook.Sheets(\"Master Log\")</code></p>\n\n<p>And for the following line:</p>\n\n<pre><code>nr = ssheet.Cells(ssheet.Rows.Count, 1).End(xlUp).Row + 1\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10686855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffa48887abe185151d2e4b861fbc714b?s=128&d=identicon&r=PG&f=1", "display_name": "Alessandro", "link": "https://stackoverflow.com/users/10686855/alessandro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "accepted_answer_id": 53416357, "answer_count": 1, "score": 1, "last_activity_date": 1565332686, "creation_date": 1542816728, "last_edit_date": 1565332686, "question_id": 53416193, "link": "https://stackoverflow.com/questions/53416193/thisworkbook-sheetssheet1-generates-run-time-error-9-subscript-out-of-rang", "title": "ThisWorkbook.Sheets(&quot;Sheet1&quot;) generates Run-Time error &#39;9&#39; Subscript out of range", "body": "<p>I am trying to build a userform to input a new row (first row after headers).</p>\n\n<p>The userform contains 6 fields of which 4 are combobox (lists) and 2 text box.</p>\n\n<p>When I run the code it gets stuck at: <code>Set ssheet = ThisWorkbook.Sheets(\"Sheet1\")</code>     </p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim ssheet As Worksheet\n\n    Set ssheet = ThisWorkbook.Sheets(\"Sheet1\")\n\n    nr = ssheet.Cells(Rows.Count, 1).End(x1Up).Row + 1\n\n    ssheet.Cells(nr, 1) = Me.tbNAME\n    ssheet.Cells(nr, 2) = Me.cmbStatus\n    ssheet.Cells(nr, 3) = Me.cmbFunds\n    ssheet.Cells(nr, 4) = Me.cmbDD\n    ssheet.Cells(nr, 7) = Me.cmbDistributor\n    ssheet.Cells(nr, 8) = Me.tbComments\n\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\n    Me.tbDate = Date\n\n    For Each blah In [StatusList]\n        Me.cmbStatus.AddItem blah\n    Next blah\n\n    For Each blah In [FundsList]\n        Me.cmbFunds.AddItem blah\n    Next blah\n\n    For Each blah In [DDList]\n        Me.cmbDD.AddItem blah\n    Next blah\n\n    For Each blah In [DistributorList]\n        Me.cmbDistributor.AddItem blah\n    Next blah\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 1, "creation_date": 1542817015, "post_id": 53415950, "comment_id": 93706948, "body": "Why do you need the <code>&lt;=</code> check in those <code>ElseIf</code> statement?  (Unless you want to handle 5.495 as a special case?)"}, {"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 1, "creation_date": 1542817806, "post_id": 53415950, "comment_id": 93707459, "body": "since the conversion table  shows there is no liner relation, my opinion is to proceed with current approach only for accurate conversion."}, {"owner": {"reputation": 6009, "user_id": 3313438, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/Ks9C6.jpg?s=128&g=1", "display_name": "Ziezi", "link": "https://stackoverflow.com/users/3313438/ziezi"}, "reply_to_user": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1542818286, "post_id": 53415950, "comment_id": 93707775, "body": "@Chronocidal oh, yes! You are right, it should just be <code>&lt; 5.50</code>, instead of <code>&lt;=5.49</code>, right?"}, {"owner": {"reputation": 6009, "user_id": 3313438, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/Ks9C6.jpg?s=128&g=1", "display_name": "Ziezi", "link": "https://stackoverflow.com/users/3313438/ziezi"}, "reply_to_user": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 0, "creation_date": 1542818345, "post_id": 53415950, "comment_id": 93707806, "body": "@AhmedAU Exactly, the last interval&#39;s length is <code>1</code>. Thanks!"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1542818407, "post_id": 53415950, "comment_id": 93707831, "body": "@Ziezi You&#39;ve already eliminated anything <code>&gt;=5.0</code> in the previous <code>If</code>, so just <code>ElseIf input &gt;= 4.5 Then</code> is fine"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 2, "creation_date": 1542818778, "post_id": 53415950, "comment_id": 93708055, "body": "(Also - this gives <i>really</i> sharp grading changes at the boundaries - from 3.2 input to 3.3 input is an output change of 1.84, from 3.3 input to 3.4 input is an output change of 1.84, from 3.4 input to 3.5 input  is an output change of <b>2.65</b>, from 3.5 input to 3.6 input is an output change of 1.92, from 3.6 input to 3.7 input is an output change of 1.92...  You would get a smoother approximation from a cubic equation such as <code>y = 0.0015x^3 - 0.1115x^2 + 4.545x - 5.5277</code>)"}, {"owner": {"reputation": 6009, "user_id": 3313438, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/Ks9C6.jpg?s=128&g=1", "display_name": "Ziezi", "link": "https://stackoverflow.com/users/3313438/ziezi"}, "reply_to_user": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1542825448, "post_id": 53415950, "comment_id": 93711221, "body": "@Chronocidal please, formulate it as an answer and the least that I will do is upvote it."}], "answers": [{"comments": [{"owner": {"reputation": 6009, "user_id": 3313438, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/Ks9C6.jpg?s=128&g=1", "display_name": "Ziezi", "link": "https://stackoverflow.com/users/3313438/ziezi"}, "edited": false, "score": 0, "creation_date": 1542949754, "post_id": 53429589, "comment_id": 93754877, "body": "That is an interesting observation - the largest bump is at the fail/pass point, 3.00, i.e. the pass threshold of the scale in the second column is 3.00.  Having that in mind, should the scale Curve be smooth or should it reflect the characteristics of the grading system?"}], "tags": [], "owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "is_accepted": true, "score": 1, "last_activity_date": 1542884805, "creation_date": 1542884805, "answer_id": 53429589, "question_id": 53415950, "link": "https://stackoverflow.com/questions/53415950/rescalling-a-range-of-numbers-depending-on-the-interval-they-belong-to/53429589#53429589", "title": "Rescalling a range of numbers depending on the interval they belong to", "body": "<p>This is a bit of a Frame Challenge:</p>\n\n<p>At the moment, this grading system gives a <em>really</em> sharp change in the grading structure at the boundaries.  For example, take a look at the following conversions:<br>\n<a href=\"https://i.stack.imgur.com/ATsXC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ATsXC.png\" alt=\"from 3.2 input to 3.3 input is an output change of 1.84, from 3.3 input to 3.4 input is an output change of 1.84, from 3.4 input to 3.5 input is an output change of 2.65, from 3.5 input to 3.6 input is an output change of 1.92, from 3.6 input to 3.7 input is an output change of 1.92\"></a></p>\n\n<p>A Grading <strong>Curve</strong> is generally called that for a reason - to give a smooth distribution and transition.  If you were to drop a cubic trendline on your graph, you can <em>almost</em> (but not quite) get there with <code>y = 0.0015x^3 - 0.1115x^2 + 4.545x - 5.5277</code>:<br>\n<a href=\"https://i.stack.imgur.com/vLR5B.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vLR5B.png\" alt=\"Graph showing trendline and converted values\"></a><br>\n(I have circled the sharp transitions, and the fact that the equation given currently goes negative at <code>x=2</code>)</p>\n"}], "owner": {"reputation": 6009, "user_id": 3313438, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/Ks9C6.jpg?s=128&g=1", "display_name": "Ziezi", "link": "https://stackoverflow.com/users/3313438/ziezi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 53429589, "answer_count": 1, "score": 0, "last_activity_date": 1542884805, "creation_date": 1542815951, "last_edit_date": 1542816562, "question_id": 53415950, "link": "https://stackoverflow.com/questions/53415950/rescalling-a-range-of-numbers-depending-on-the-interval-they-belong-to", "title": "Rescalling a range of numbers depending on the interval they belong to", "body": "<p>I have the following conversion table:</p>\n\n<p><a href=\"https://i.stack.imgur.com/XtTEm.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XtTEm.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>and I need to convert the values of the second column to the values in the first column, as continuous variables.</p>\n\n<p>Currently, I am trying to write a function that accepts a value from the second column, check its validity and then uses the following conversion formula for the data transformation:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ZgKKW.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZgKKW.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>The code currently looks like this:</p>\n\n<pre><code>Public Function ReScale (input As Double)\n\n  'Max and Min values of the old scale.\n   Dim MinOld As Double: MinOld = 2\n   Dim MaxOld As Double: MaxOld = 6\n\n  'Test input value validity.\n   If input &gt; MaxOld Or input &lt; MinOld Then\n     ReScale = CVErr(xlErrNA)\n   End\n\n   Dim MinNew As Double\n   Dim MaxNew As Double\n\n   'Find in which interval the input value belongs.\n   If input &gt;= 5.5 Then\n     MinOld = 5.5\n     MaxOld = 6.0\n     MinNew = 85\n     MaxNew = 100\n   ElseIf input &gt;= 4.50 And input &lt;= 5.49 Then\n     MinOld = 4.50\n     MaxOld = 5.49\n     MinNew = 65\n     MaxNew = 84\n   ...` &lt;--------------------- Question?\n\n  'Transform the old data to the new scale.\n   ReScale = ( (MaxNew - MinNew) / (MaxOld - MinOld) ) * (input - MaxOld) + MaxNew\n\nEnd Function\n</code></pre>\n\n<p>My question is:</p>\n\n<p>Should I search for <code>MaxNew</code>, <code>MinNew</code>, <code>MaxOld</code> and <code>MinOld</code> depending on the variable value or should I use the absolute minimum and maximum?</p>\n\n<p>Is there an easier way of doing this?</p>\n\n<hr>\n"}, {"tags": ["sql-server", "excel", "vba", "odbc"], "comments": [{"owner": {"reputation": 1854, "user_id": 6071871, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IfFKy.jpg?s=128&g=1", "display_name": "ArcherBird", "link": "https://stackoverflow.com/users/6071871/archerbird"}, "edited": false, "score": 2, "creation_date": 1542816757, "post_id": 53415874, "comment_id": 93706768, "body": "<code>Microsoft ActiveX Data Object 6.1</code> is fine to use for early binding ADODB objects. If this connection was working before - it is not likely causing the issue. You said you started getting errors when you added more controls. What code is running behind these &quot;problem&quot; controls?"}, {"owner": {"reputation": 21, "user_id": 10686586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f0ff743391dec4303b7b130967bfb30?s=128&d=identicon&r=PG&f=1", "display_name": "Teodorico Maziviala", "link": "https://stackoverflow.com/users/10686586/teodorico-maziviala"}, "reply_to_user": {"reputation": 1854, "user_id": 6071871, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IfFKy.jpg?s=128&g=1", "display_name": "ArcherBird", "link": "https://stackoverflow.com/users/6071871/archerbird"}, "edited": false, "score": 0, "creation_date": 1542900595, "post_id": 53415874, "comment_id": 93741964, "body": "&quot;You said you started getting errors when you added more controls. What code is running behind these &quot;problem&quot; controls?&quot;  Well, that is the problem, I have not yet used any code on! this is all happening with the designer userform!"}], "owner": {"reputation": 21, "user_id": 10686586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f0ff743391dec4303b7b130967bfb30?s=128&d=identicon&r=PG&f=1", "display_name": "Teodorico Maziviala", "link": "https://stackoverflow.com/users/10686586/teodorico-maziviala"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2598, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1542818088, "creation_date": 1542815702, "last_edit_date": 1542818088, "question_id": 53415874, "link": "https://stackoverflow.com/questions/53415874/connecting-excel-vba-to-sql-server-using-odbc-connections-and-objects", "title": "Connecting Excel VBA to sql server using ODBC Connections and Objects", "body": "<p>I am new to coding, i am recently working on a Stock Control Program using Excel and VBA, at first i can run and get results on my designer, but the more buttons and labels that i add on it becomes a problem to run!</p>\n\n<ul>\n<li>Error 1\nI Keep getting an automation error.</li>\n<li><p>I understood that the error was related to database connection, so i proceeded to connecting to the database. using the code bellow: </p>\n\n<pre><code>Sub DbConnection()\nDim cn As ADODB.Connection\nSet cn = New ADODB.Connection\nDim rs As ADODB.Recordset\n\nDim strConn As String\nstrConn = \"Driver={SQL Server}; Server=servername; Database=Dbname; VID=username; PWD=password\"\n\ncn.Open strConn\ncn.Close\nSet cn = Nothing\nMsgBox \"Connected\"\nEnd Sub\n</code></pre></li>\n<li><p>I used the Microsoft ActiveX Data Object 6.1 library.\nbut i realized that it is not working and was recommended to use ODBC Connection, and now i am stuck, Can anyone help me on this?</p></li>\n<li><p>How do i use this connection for my ODBC Connection?</p></li>\n<li><p>Anything I am doing Wrong? Which Reference Object do i have to use?\nPS: I am using Ms Excel 2016 and SSMS 2017. Thanks </p></li>\n</ul>\n"}, {"tags": ["vba", "while-loop"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1542815515, "post_id": 53415680, "comment_id": 93705996, "body": "No need for a loop - you could just use an <code>If&#47;ElseIf</code> to check them all - if any of them fail, it will prompt your user."}], "answers": [{"tags": [], "owner": {"reputation": 505, "user_id": 9204831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KwPAL.png?s=128&g=1", "display_name": "Lodi", "link": "https://stackoverflow.com/users/9204831/lodi"}, "is_accepted": false, "score": 0, "last_activity_date": 1542815976, "last_edit_date": 1542815976, "creation_date": 1542815614, "answer_id": 53415845, "question_id": 53415680, "link": "https://stackoverflow.com/questions/53415680/writing-a-while-loop-with-row-column-variables/53415845#53415845", "title": "Writing a While loop with row/column variables?", "body": "<p>Welcome to StackOverflow.</p>\n\n<p>You could use a <code>While loop</code>, sure, but the best approach here is to use a <code>For loop</code></p>\n\n<p>Let's say that your cells are in row 2, in the columns 5, 6, 7 and 8.\nSo, what you gotta do is:</p>\n\n<pre><code>For i = 5 To 8\n    If Cells(2, i).Value = \"\" Then\n        MsgBox \"Operator Name Required\", vbInformation, \"ALERT: Missing Information\"\n        Cancel = True\n    End If\nNext\n</code></pre>\n\n<p>Let me explain what is going on here:</p>\n\n<p>We created a variable <code>i</code> that is changing it's value from 5 to 8 each time the inner code repeats.\nSo we use that variable <code>i</code> to set our column index value, interating between each one of the desired columns.</p>\n\n<p>Of course, the prompt will always show \"Operator Name Required\", and that probably isn't what you need.</p>\n\n<p>In this case, you gotta create multiple <code>If-End If</code> statements, catching each one of the desired cells, like:</p>\n\n<pre><code>If Cells(2, 5).Value = \"\" Then\n    MsgBox \"Operator Name Required\", vbInformation, \"ALERT: Missing Information\"\n    Cancel = True\nEnd If\n\nIf Cells(2, 6).Value = \"\" Then\n    MsgBox \"Operator Id Required\", vbInformation, \"ALERT: Missing Information\"\n    Cancel = True\nEnd If\n\nIf Cells(2, 7).Value = \"\" Then\n    MsgBox \"Operator Date of Birth Required\", vbInformation, \"ALERT: Missing Information\"\n    Cancel = True\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "is_accepted": false, "score": 0, "last_activity_date": 1542817540, "last_edit_date": 1542817540, "creation_date": 1542816032, "answer_id": 53415976, "question_id": 53415680, "link": "https://stackoverflow.com/questions/53415680/writing-a-while-loop-with-row-column-variables/53415976#53415976", "title": "Writing a While loop with row/column variables?", "body": "<p>I'm not a big fan of <code>while</code> loops, I'd rather know exactly for how long a loop will run, so my suggestion will be a slightly different loop.</p>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\n\n    Dim firstCol As Long, lastCol As Long\n    firstCol = 5\n    lastCol = 10\n\n    Dim C As Long   'Your variable to loop through columns\n\n    Dim sht As Worksheet\n    Set sht = ActiveWorkbook.Sheets(\"Your Sheet Name To Check\")   'Without declaring and using this, if the user is _\n                                                                    on a different sheet than the one intended for this macro, _\n                                                                    the macro will fire up even if the user already completed\n\n    For C = firstCol To lastCol\n        If sht.Cells(2, C).Value = \"\" Then\n            MsgBox \"Operator \" &amp; sht.Cells(1, C).Value &amp; \" Required\", vbInformation, \"ALERT: Missing Information\"\n            Cancel = True\n        End If\n    Next C\n\nEnd Sub\n</code></pre>\n\n<p>You can assign your <strong>lastCol</strong> variable more dynamically if you think in the future the number of columns will change, see this for further help on getting last row/column: <a href=\"https://www.thespreadsheetguru.com/blog/2014/7/7/5-different-ways-to-find-the-last-row-or-last-column-using-vba\" rel=\"nofollow noreferrer\">https://www.thespreadsheetguru.com/blog/2014/7/7/5-different-ways-to-find-the-last-row-or-last-column-using-vba</a></p>\n\n<p>PS: @Lodi has already answered similarly, but was in the middle of writing this, so here are my 2 cents anyway.</p>\n"}], "owner": {"reputation": 59, "user_id": 10686696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07876c4563e4bee7c2e30298223740cc?s=128&d=identicon&r=PG&f=1", "display_name": "mdavis0510", "link": "https://stackoverflow.com/users/10686696/mdavis0510"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 256, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1542817540, "creation_date": 1542815056, "last_edit_date": 1542815285, "question_id": 53415680, "link": "https://stackoverflow.com/questions/53415680/writing-a-while-loop-with-row-column-variables", "title": "Writing a While loop with row/column variables?", "body": "<p>I am very new to VBA and still trying to learn everything. I wrote this simple code to bring a prompt up for a cell missing input. I would like to apply this to other cells, i.e. Date, Shift and so on, but I am unsure of how to write the while loop. All the cells are in row 2. </p>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\nIf Cells(2, 5).Value = \"\" Then\n    MsgBox \"Operator Name Required\", vbInformation, \"ALERT: Missing Information\"\n    Cancel = True\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1542815879, "post_id": 53415508, "comment_id": 93706247, "body": "Kudos for <code>Option Explicit</code>!"}], "answers": [{"tags": [], "owner": {"reputation": 2465, "user_id": 2570277, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0483cce5f2ea53671a36477fed79898b?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/2570277/nick"}, "is_accepted": false, "score": 2, "last_activity_date": 1542814656, "creation_date": 1542814656, "answer_id": 53415551, "question_id": 53415508, "link": "https://stackoverflow.com/questions/53415508/set-variable-range-in-vba/53415551#53415551", "title": "Set variable range in VBA", "body": "<p>Type the following just below <code>Private Sub Worksheet_Change(ByVal Target As Range)</code></p>\n\n<pre><code>Dim i as long\n</code></pre>\n\n<p>You need to define what i is before you can use it.</p>\n"}, {"comments": [{"owner": {"reputation": 101, "user_id": 5332472, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cda89068afad94d949f2b901adad3bbb?s=128&d=identicon&r=PG&f=1", "display_name": "NormX", "link": "https://stackoverflow.com/users/5332472/normx"}, "edited": false, "score": 0, "creation_date": 1542816251, "post_id": 53415637, "comment_id": 93706471, "body": "thank you so much i apprecite it. i knew i had to decalre &quot;i&quot; but i couldnt figure out the type to declare it as since i wanted a range kinda. thanks again!"}, {"owner": {"reputation": 101, "user_id": 5332472, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cda89068afad94d949f2b901adad3bbb?s=128&d=identicon&r=PG&f=1", "display_name": "NormX", "link": "https://stackoverflow.com/users/5332472/normx"}, "edited": false, "score": 0, "creation_date": 1542816502, "post_id": 53415637, "comment_id": 93706624, "body": "what if i want to clear two rows? in the second one. How would you clear them?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 101, "user_id": 5332472, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cda89068afad94d949f2b901adad3bbb?s=128&d=identicon&r=PG&f=1", "display_name": "NormX", "link": "https://stackoverflow.com/users/5332472/normx"}, "edited": false, "score": 0, "creation_date": 1542816743, "post_id": 53415637, "comment_id": 93706761, "body": "What do you mean by 2 rows? which 2? The <code>i</code> and the one below <code>i+1</code>? This could be done with <code>Target.Offset(ColumnOffset:=1).Resize(RowSize:=2).ClearConte&zwnj;&#8203;nts</code>"}, {"owner": {"reputation": 101, "user_id": 5332472, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cda89068afad94d949f2b901adad3bbb?s=128&d=identicon&r=PG&f=1", "display_name": "NormX", "link": "https://stackoverflow.com/users/5332472/normx"}, "edited": false, "score": 0, "creation_date": 1542816952, "post_id": 53415637, "comment_id": 93706897, "body": "im sorry i said rows instead of columns. but i just figured it out"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 101, "user_id": 5332472, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cda89068afad94d949f2b901adad3bbb?s=128&d=identicon&r=PG&f=1", "display_name": "NormX", "link": "https://stackoverflow.com/users/5332472/normx"}, "edited": false, "score": 0, "creation_date": 1542817012, "post_id": 53415637, "comment_id": 93706945, "body": "Two columns would work like <code>Target.Offset(ColumnOffset:=1).Resize(ColumnSize:=2).ClearCo&zwnj;&#8203;ntents</code> for column E + F"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 3, "last_activity_date": 1542815274, "last_edit_date": 1542815274, "creation_date": 1542814926, "answer_id": 53415637, "question_id": 53415508, "link": "https://stackoverflow.com/questions/53415508/set-variable-range-in-vba/53415637#53415637", "title": "Set variable range in VBA", "body": "<p>This error means you need to declare your variable <code>i</code> and specify a type before you can use it. You do this by <code>Dim i As Long</code>. </p>\n\n<p>Additionally you will need a <code>Next i</code> to tell where the loop ends.</p>\n\n<p>Also test <code>If Target.Cells.Count &gt; 1 Then Exit Sub</code> this only once (outside the loop).</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Cells.Count &gt; 1 Then Exit Sub\n\n    Dim i As Long\n    For i = 17 To 1015\n        If Not Intersect(Target, Range(\"D\" &amp; i)) Is Nothing Then\n            Range(\"E\" &amp; i).ClearContents\n        End If\n    Next i\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Didn't test it but this should give the same result:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Cells.Count &gt; 1 Then Exit Sub\n\n    If Not Intersect(Target, Range(\"D17:D1015\")) Is Nothing Then\n        Target.Offset(ColumnOffset:=1).ClearContents\n    End If\nEnd Sub\n</code></pre>\n\n<p>This should be faster because it doesn't need to loop.</p>\n"}], "owner": {"reputation": 101, "user_id": 5332472, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cda89068afad94d949f2b901adad3bbb?s=128&d=identicon&r=PG&f=1", "display_name": "NormX", "link": "https://stackoverflow.com/users/5332472/normx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 53415637, "answer_count": 2, "score": 0, "last_activity_date": 1583476780, "creation_date": 1542814500, "last_edit_date": 1583476780, "question_id": 53415508, "link": "https://stackoverflow.com/questions/53415508/set-variable-range-in-vba", "title": "Set variable range in VBA", "body": "<p>I have a function i am trying to create that basically clears the dropdown chose if dropdown in the previous cell is changed. I need to repeat this for many rows. currently it says my variable is not defined</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nFor i = 17 To 1015\nIf Target.Cells.Count &gt; 1 Then Exit Sub\n\nIf Not Intersect(Target, Range(\"D\" &amp; i)) Is Nothing Then\n    Range(\"E\" &amp; i).ClearContents\nEnd If\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "string", "performance", "ms-word"], "comments": [{"owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "edited": false, "score": 0, "creation_date": 1542814183, "post_id": 53415283, "comment_id": 93705161, "body": "Where are you getting the strings originally from?"}, {"owner": {"reputation": 81, "user_id": 9435663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65ba553ef4f64c17445912eec0de6e01?s=128&d=identicon&r=PG&f=1", "display_name": "T. P. ", "link": "https://stackoverflow.com/users/9435663/t-p"}, "reply_to_user": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "edited": false, "score": 0, "creation_date": 1542814419, "post_id": 53415283, "comment_id": 93705307, "body": "I get it from websites"}], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 0, "last_activity_date": 1542817486, "creation_date": 1542817486, "answer_id": 53416435, "question_id": 53415283, "link": "https://stackoverflow.com/questions/53415283/code-performance-writing-into-word-document-using-vba/53416435#53416435", "title": "Code performance, writing into Word document using VBA", "body": "<p>I see a few ways to help things along, just glancing at the code:</p>\n\n<ol>\n<li>It appears content should be added at the end of the document? Instead of using <code>.Paragraphs(.Paragraphs.Count).Range</code> - which will cause a performance hit for each <code>.</code> - create a <code>Range</code> object and work with that.</li>\n</ol>\n\n<p>For example:</p>\n\n<pre><code>Dim rngEndOfDoc as Word.Range\nSet rngEndOfDoc = ActiveDocument.Content\nrngEndOfDoc.Collapse wdCollapseEnd\n'Add new content here\nrngEndOfDoc.Text = \"something\"\n'Collapse it each time new content should be added with different formatting\nrngEndOfDoc.Collapse wdCollapseEnd\n</code></pre>\n\n<ol start=\"2\">\n<li>For all text with the same formatting don't use <code>Paragraphs.Add</code> to add a new paragraph. Instead, concatenate the new paragraph into the string using <code>vbCr</code>.</li>\n</ol>\n\n<p>For example:</p>\n\n<pre><code>arrDatenGefiltert(RowIndex, 1) &amp; vbCr &amp; arrDatenGefiltert(RowIndex, 2)\n</code></pre>\n\n<ol start=\"3\">\n<li>This isn't so much performance as correct usage: Don't use <code>ThisDocument</code> unless you explicitly intend to refer only to the document that contains the macro code. Instead, use <code>ActiveDocument</code> or, even better, declare and instantiate a <code>Document</code> object (and using that <em>will</em> be faster).</li>\n</ol>\n\n<p>Example:</p>\n\n<pre><code>Dim doc as Word.Document\nSet doc = ActiveDocument\n\nWith doc\n</code></pre>\n\n<ol start=\"4\">\n<li>Instead of repeatedly applying multiple actions of direct formatting, use <em>Styles</em> that contain the formatting commands, already. If the code uses a template (rather than creating a new default document) define the styles in the template so new documents created from it inherit the styles. Otherwise, define the styles with the code - applying styles will be faster <em>AND</em> it will avoid possible error messages when Word runs out of memory from storing so many individual formatting commands (for possible Undo actions).</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 81, "user_id": 9435663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65ba553ef4f64c17445912eec0de6e01?s=128&d=identicon&r=PG&f=1", "display_name": "T. P. ", "link": "https://stackoverflow.com/users/9435663/t-p"}, "is_accepted": false, "score": 0, "last_activity_date": 1542830581, "creation_date": 1542830581, "answer_id": 53419703, "question_id": 53415283, "link": "https://stackoverflow.com/questions/53415283/code-performance-writing-into-word-document-using-vba/53419703#53419703", "title": "Code performance, writing into Word document using VBA", "body": "<p>Here is my adjusted code with the suggestions Cindy Meister gave. I went one step further and wrote the whole text in a string, including the paragraph-\"signs\" and wrote it from there in the Word document. Formatting I did afterwards:</p>\n\n<pre><code>        '''Write the whole content from the strings in the array arrDatenGefiltert in the string strContent\n        'For each \"row\" of the array\n        For RowIndex = 0 To lngRowIndex_arrDatenGefiltert\n            'If the first \"column\" of the array is not empty\n            If Not arrDatenGefiltert(lngRowIndex_arrDatenGefiltert, 0) = \"\" Then\n                'Write the first \"column\" of the actual \"row\" of the array in the string; before, add some unique characters\n                strContent = strContent &amp; \"%$!First!\" &amp; arrDatenGefiltert(RowIndex, 0) &amp; vbCr\n                'If the second \"column\" of the actual \"row\" of the array is not empty\n                If Not arrDatenGefiltert(RowIndex, 1) = \"\" Then\n                    'Write the second \"column\" of the actual \"row\" of the array in the string; before, add also some unique characters\n                    strContent = strContent &amp; \"%$!Second!\" &amp; arrDatenGefiltert(RowIndex, 1) &amp; vbCr\n                End If\n                'Write the third \"column\" of the actual \"row\" of the array in the string; before, add also some unique characters\n                strContent = strContent &amp; \"%$!Thrid!\" &amp; arrDatenGefiltert(RowIndex, 2) &amp; vbCr\n                ''Write an additional line\n                strContent = strContent &amp; \"*****************\" &amp; vbCr\n            End If\n        Next RowIndex\n\n        '''Write the value of the string strContent in the Word document\n        ActiveDocument.Range(0, 0).Text = strContent\n</code></pre>\n\n<p>Here is an example for defining a style; I defined three of them. The other two are pretty similar to this one:</p>\n\n<pre><code>    Sub DefineStyleFirst()\n\n        WordBasic.FormatStyle Name:=\"StyleFirst\", NewName:=\"\", BasedOn:=\"\", NextStyle:=\"\", Type:=0, FileName:=\"\", link:=\"\"\n        WordBasic.FormatStyle Name:=\"StyleFirst\", NewName:=\"\", BasedOn:=\"\", NextStyle:=\"\", Type:=0, FileName:=\"\", link:=\"\"\n\n        With ActiveDocument.Styles(\"StyleFirst\").Font\n            .Name = \"Calibri\"\n            .Size = 11\n            .Bold = False\n            .Italic = False\n            .Underline = wdUnderlineNone\n            .UnderlineColor = wdColorAutomatic\n            .StrikeThrough = False\n            .DoubleStrikeThrough = False\n            .Outline = False\n            .Emboss = False\n            .Shadow = False\n            .Hidden = False\n            .SmallCaps = False\n            .AllCaps = False\n            .Color = wdColorAutomatic\n            .Engrave = False\n            .Superscript = False\n            .Subscript = False\n            .Scaling = 100\n            .Kerning = 0\n            .Animation = wdAnimationNone\n        End With\n\n        With ActiveDocument.Styles(\"StyleFirst\").ParagraphFormat\n            .LeftIndent = CentimetersToPoints(0)\n            .RightIndent = CentimetersToPoints(0)\n            .SpaceBefore = 0\n            .SpaceBeforeAuto = False\n            .SpaceAfter = 10\n            .SpaceAfterAuto = False\n            .LineSpacingRule = wdLineSpaceMultiple\n            .LineSpacing = LinesToPoints(1.15)\n            .Alignment = wdAlignParagraphLeft\n            .WidowControl = True\n            .KeepWithNext = False\n            .KeepTogether = False\n            .PageBreakBefore = False\n            .NoLineNumber = False\n            .Hyphenation = True\n            .FirstLineIndent = CentimetersToPoints(0)\n            .OutlineLevel = wdOutlineLevelBodyText\n            .CharacterUnitLeftIndent = 0\n            .CharacterUnitRightIndent = 0\n            .CharacterUnitFirstLineIndent = 0\n            .LineUnitBefore = 0\n            .LineUnitAfter = 0\n            .MirrorIndents = False\n            .TextboxTightWrap = wdTightNone\n        End With\n\n        ActiveDocument.Styles(\"StyleFirst\").NoSpaceBetweenParagraphsOfSameStyle = False\n        ActiveDocument.Styles(\"StyleFirst\").ParagraphFormat.TabStops.ClearAll\n\n        With ActiveDocument.Styles(\"StyleFirst\").ParagraphFormat\n\n            With .Shading\n                .Texture = wdTextureNone\n                .ForegroundPatternColor = wdColorAutomatic\n                .BackgroundPatternColor = wdColorAutomatic\n            End With\n\n            .Borders(wdBorderLeft).LineStyle = wdLineStyleNone\n            .Borders(wdBorderRight).LineStyle = wdLineStyleNone\n            .Borders(wdBorderTop).LineStyle = wdLineStyleNone\n            .Borders(wdBorderBottom).LineStyle = wdLineStyleNone\n\n            With .Borders\n                .DistanceFromTop = 1\n                .DistanceFromLeft = 4\n                .DistanceFromBottom = 1\n                .DistanceFromRight = 4\n                .Shadow = False\n            End With\n        End With\n\n        ActiveDocument.Styles(\"StyleFirst\").NoProofing = False\n        ActiveDocument.Styles(\"StyleFirst\").Frame.Delete\n\n    End Sub\n</code></pre>\n\n<p>Just called in the code like this; right behind the filling of the string strContent:</p>\n\n<pre><code>        DefineStyleFirst\n        DefineStyleSecond\n        DefineStyleThird\n</code></pre>\n\n<p>After all these steps, finally the formatting of the text takes place:</p>\n\n<pre><code>        'For each element of the collection \"Paragraphs\" \n        For Each Element In ActiveDocument.Paragraphs\n            'If the first characters of the paragraph are \"%$!First!\"\n            If Left(Element.Range.Text, 9) = \"%$!First!\" Then\n                'The Style of the paragraph is set to \"StyleFirst\"\n                Element.Style = \"StyleFirst\"\n                'Delete the first characters of the paragraph\n                Element.Range.Text = Right(Element.Range.Text, Len(Element.Range.Text) - 9)\n            End If\n            'If the first characters of the paragraph are \"%$!Second!\"\n            If Left(Element.Range.Text, 10) = \"%$!Second!\" Then\n                'The Style of the paragraph is set to \"StyleSecond\"\n                Element.Style = \"StyleSecond\"\n                'Delete the first characters of the paragraph\n                Element.Range.Text = Right(Element.Range.Text, Len(Element.Range.Text) - 10)\n            End If\n            'If the first characters of the paragraph are \"%$!Third!\"\n            If Left(Element.Range.Text, 9) = \"%$!Third!\" Then\n                'The Style of the paragraph is set to \"StyleThird\"\n                Element.Style = \"StyleThird\"\n                'Delete the first characters of the paragraph\n                Element.Range.Text = Right(Element.Range.Text, Len(Element.Range.Text) - 9)\n            End If\n            'If the first characters of the paragraph are \"*****************\"\n            If Left(Element.Range.Text, 17) = \"*****************\" Then\n                'The Style of the paragraph is set to \"StyleThird\"\n                Element.Style = \"StyleThird\"\n            End If\n        Next Element\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 9435663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65ba553ef4f64c17445912eec0de6e01?s=128&d=identicon&r=PG&f=1", "display_name": "T. P. ", "link": "https://stackoverflow.com/users/9435663/t-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 200, "favorite_count": 0, "accepted_answer_id": 53416435, "answer_count": 2, "score": 0, "last_activity_date": 1542830581, "creation_date": 1542813889, "last_edit_date": 1542817676, "question_id": 53415283, "link": "https://stackoverflow.com/questions/53415283/code-performance-writing-into-word-document-using-vba", "title": "Code performance, writing into Word document using VBA", "body": "<p>I have an array of strings (15000,2) (approx.) and with the piece of code below I write the strings into a Word document. The code becomes slower and slower the more \"rows\" of the array I have written to the document. For an array of (1000,2) approx. 4 minutes are needed, for an array of (2000,2) approx. 20 minutes are needed. My problem is that I don\u00b4t know how to make the code faster.</p>\n\n<p>Screen updating is turned off.</p>\n\n<pre><code>'Go through every \"row\" of the array arrDatenGefiltert\nFor RowIndex = 0 To lngRowIndex_arrDatenGefiltert\n    'If the value of the array at the actual \"row\" and first \"column\" is not empty...\n    If Not arrDatenGefiltert(lngRowIndex_arrDatenGefiltert, 0) = \"\" Then\n        'Write the content of the actual \"row\" of the array in the document\n        With ThisDocument\n            'Write the content of the actual \"row\" and the first \"column\" in the document\n            With .Paragraphs(.Paragraphs.Count).Range\n                .Text = arrDatenGefiltert(RowIndex, 0)\n                ''Some formatting\n                .Font.Size = 11\n                .Font.Bold = False\n            End With\n            'New Paragraph at the end of the document\n            .Paragraphs.Add\n            'If the second \"column\" entry is not empty\n            If Not arrDatenGefiltert(RowIndex, 1) = \"\" Then\n                'Write the content of the actual \"row\" and the second \"column\" in the document\n                With .Paragraphs(.Paragraphs.Count).Range\n                    .Text = arrDatenGefiltert(RowIndex, 1)\n                    'Some formatting\n                    .Font.Size = 12\n                    .Font.Bold = True\n                End With\n                'New Paragraph at the end of the document\n                .Paragraphs.Add\n            End If\n            ''Write the content of the actual \"row\" and the thrid \"column\" in the document\n            With .Paragraphs(.Paragraphs.Count).Range\n                .Text = arrDatenGefiltert(RowIndex, 2)\n                'Some formatting\n                .Font.Size = 12\n                .Font.Bold = False\n            End With\n            'New paragraph at the end of the document\n            .Paragraphs.Add\n            'Write an additional line at the end of the document (which is the same for every \"row\" of the array)\n            With .Paragraphs(.Paragraphs.Count).Range\n                .Text = \"*****************\"\n                'Some formatting\n                .Font.Size = 12\n                .Font.Bold = False\n            End With\n            'New paragraph at the end of the document\n            .Paragraphs.Add\n        End With\n    End If\nNext RowIndex\n'Some formatting for the whole document\nThisDocument.Range(0, 0).Select\nSelection.WholeStory\nWith Selection\n    .Font.Color = wdColorBlack\n    .Font.Italic = False\n    .Font.Name = \"Calibri\"\n    .Font.Underline = wdUnderlineNone\n    .ParagraphFormat.Alignment = wdAlignParagraphLeft\nEnd With\n</code></pre>\n"}, {"tags": ["ms-access", "outlook", "vba"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10686281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df34b0abd6c25059210a4519b42cbb45?s=128&d=identicon&r=PG&f=1", "display_name": "TroyL", "link": "https://stackoverflow.com/users/10686281/troyl"}, "edited": false, "score": 0, "creation_date": 1543196308, "post_id": 53463512, "comment_id": 93817902, "body": "Thanks for your suggestion. I have tried everything but the resolve piece. Strange the error now is the same as before  &quot;cannot find recipient&quot; but it is happening on .Send as if it is resolved. There seems to be something related to the MAPI folder and pointing to OlTasks folder."}, {"owner": {"reputation": 10875, "user_id": 2392157, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QEWAU.png?s=128&g=1", "display_name": "miroxlav", "link": "https://stackoverflow.com/users/2392157/miroxlav"}, "reply_to_user": {"reputation": 13, "user_id": 10686281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df34b0abd6c25059210a4519b42cbb45?s=128&d=identicon&r=PG&f=1", "display_name": "TroyL", "link": "https://stackoverflow.com/users/10686281/troyl"}, "edited": false, "score": 0, "creation_date": 1543219922, "post_id": 53463512, "comment_id": 93823948, "body": "@TroyL \u2013 maybe you can update your question with the new code visible for others to help you"}, {"owner": {"reputation": 13, "user_id": 10686281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df34b0abd6c25059210a4519b42cbb45?s=128&d=identicon&r=PG&f=1", "display_name": "TroyL", "link": "https://stackoverflow.com/users/10686281/troyl"}, "edited": false, "score": 0, "creation_date": 1543242663, "post_id": 53463512, "comment_id": 93836275, "body": "Hello Again, When editing my post, I noticed I had not changed MyItem to OlTask. Made that change and it works. Thanks for your solution."}, {"owner": {"reputation": 10875, "user_id": 2392157, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QEWAU.png?s=128&g=1", "display_name": "miroxlav", "link": "https://stackoverflow.com/users/2392157/miroxlav"}, "reply_to_user": {"reputation": 13, "user_id": 10686281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df34b0abd6c25059210a4519b42cbb45?s=128&d=identicon&r=PG&f=1", "display_name": "TroyL", "link": "https://stackoverflow.com/users/10686281/troyl"}, "edited": false, "score": 0, "creation_date": 1543246588, "post_id": 53463512, "comment_id": 93838504, "body": "@TroyL \u2013 I have fixed the code, too. Good to see that the culprit with missing Recipients and resolving was found. If the above was the actual answer, maybe you can consider marking it as accepted as shown in the <a href=\"https://stackoverflow.com/tour\">tour</a>."}], "tags": [], "owner": {"reputation": 10875, "user_id": 2392157, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QEWAU.png?s=128&g=1", "display_name": "miroxlav", "link": "https://stackoverflow.com/users/2392157/miroxlav"}, "is_accepted": true, "score": 0, "last_activity_date": 1543246245, "last_edit_date": 1543246245, "creation_date": 1543104229, "answer_id": 53463512, "question_id": 53415230, "link": "https://stackoverflow.com/questions/53415230/vba-access-outlook-cannot-find-name-assigning-a-task-through-access/53463512#53463512", "title": "VBA Access - Outlook cannot find name assigning a task through Access", "body": " \n\n<p>You seem to be submitting delegated task without sufficient preparation of its internal structures because <code>Assign()</code> is immediately followed by <code>Send()</code>:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>If Me.Alias = \"Troy\" Then\n    .Save\nElse\n    .Assign\n    .Send   ' problem\nEnd If\n</code></pre>\n\n<p>In this case, recipients need to be resolved. See resolving of a task delegate's name visible in the working <a href=\"https://docs.microsoft.com/en-us/office/vba/api/outlook.taskitem.assign\" rel=\"nofollow noreferrer\">example</a>. I adopted it without testing here:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>If Me.Alias = \"Troy\" Then\n    .Save\nElse\n    .Assign\n    Dim myDelegate As Outlook.Recipient             'added\n    Set myDelegate = OlTask.Recipients.Add(TName)   'added\n    myDelegate.Resolve                              'added\n    If myDelegate.Resolved Then                     'added\n        .Send\n    Else                                            'added\n        'report error here                          'added\n    End If                                          'added\nEnd If\n</code></pre>\n\n<p>The <code>Resolve()</code> call can be earlier in your code, this was just an illustration taken from the example.</p>\n"}], "owner": {"reputation": 13, "user_id": 10686281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df34b0abd6c25059210a4519b42cbb45?s=128&d=identicon&r=PG&f=1", "display_name": "TroyL", "link": "https://stackoverflow.com/users/10686281/troyl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 53463512, "answer_count": 1, "score": 1, "last_activity_date": 1594626111, "creation_date": 1542813686, "last_edit_date": 1594626111, "question_id": 53415230, "link": "https://stackoverflow.com/questions/53415230/vba-access-outlook-cannot-find-name-assigning-a-task-through-access", "title": "VBA Access - Outlook cannot find name assigning a task through Access", "body": "<p>I have successfully written code to create a task in Outlook. I used the code below in Private Sub OutlookTask_Click() define the recipient and it worked fine as well. However, I needed to add some custom field in my Outlook Task form. I changed the code to what is listed in Private Sub test1_Click(). It works fine assigning the task to myself using .save. When I am assigning to someone else I get the error outlook cannot find the name. The answer posted worked fine, Just needed to change MyItem to OlTask.</p>\n\n<pre><code>Private Sub OutlookTask_Click()\nDim OlApp As Outlook.Application\nDim OlTask As Outlook.TaskItem\nDim OlTaskProp As Outlook.UserProperty\nDim OlLocation As Object\nDim OlDelegate As Outlook.Recipient\nDim TName As String\n\n\nSet OlApp = CreateObject(\"Outlook.Application\")\nSet OlTask = OlApp.CreateItem(olTaskItem)\nSet OlTaskProp = OlLocation.UserProperties.Find(\"Mlocation\")\nTName = Me.Alias\n'Set OlDelegate = OlTask.Recipients.Add(TName)\n\nWith OLTask\n    .Subject = Me.Item\n    .StartDate = Me.Start_Date\n    .DueDate = Me.Due_Date\n    .Status = TStatus\n    .Importance = TPriority\n    .ReminderSet = True\n    .ReminderTime = Me.Due_Date - 3 &amp; \" 8:00AM\"\n    .Body = Me.Description\n    .UserProperties(\"MLocation\") = Me.Location\n\n\nIf Me.Alias = \"Troy\" Then\n          .Save\n        Else\n         .Assign\n         Dim myDelegate As Outlook.Recipient\n         Set myDelegate = OlTask.Recipients.Add(TName)\n         myDelegate.Resolve\n    End If\n\n    If myDelegate.Resolved Then\n        .Send\n    Else\n        MsgBox \"Name not Found\"\n\n    End If\nMsgBox \"Task Successful\"\nEnd Sub\n\n\n\nPrivate Sub test1_Click()\n\nDim OlApp As Outlook.Application\nDim objFolder As MAPIFolder\nDim OLTask As Outlook.TaskItem\nDim OlItems As Outlook.Items\nDim OlDelegate As Outlook.Recipient\nDim TName As String\nDim TStatus As Integer\nDim TPriority As Integer\n\nSet OlApp = CreateObject(\"Outlook.Application\")\nSet objFolder = OlApp.GetNamespace(\"MAPI\").GetDefaultFolder(olFolderTasks)\nSet OlItems = objFolder.Items\nSet OLTask = OlItems.Add(\"IPM.Task.TroyTask\")\nTName = Me.Alias\nSet OlDelegate = OLTask.Recipients.Add(TName)\n\n\nWith OLTask\n    .Subject = Me.Item\n    .StartDate = Me.Start_Date\n    .DueDate = Me.Due_Date\n    .Status = TStatus\n    .Importance = TPriority\n    .ReminderSet = True\n    .ReminderTime = Me.Due_Date - 3 &amp; \" 8:00AM\"\n    .Body = Me.Description\n    .UserProperties(\"MLocation\") = Me.Location\n\n\nIf Me.Alias = \"Troy\" Then\n    .Save\n    Else\n        .Assign\n        .Send\n    End If\nEnd With\nMsgBox \"Task Successful\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"reputation": 1854, "user_id": 6071871, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IfFKy.jpg?s=128&g=1", "display_name": "ArcherBird", "link": "https://stackoverflow.com/users/6071871/archerbird"}, "edited": false, "score": 4, "creation_date": 1542813183, "post_id": 53414968, "comment_id": 93704574, "body": "this is a fun relic of excel where the FormulaArray property setter will only take a string of 255 characters or less - even though the property itself can hold much more than 255 characters"}, {"owner": {"reputation": 1854, "user_id": 6071871, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IfFKy.jpg?s=128&g=1", "display_name": "ArcherBird", "link": "https://stackoverflow.com/users/6071871/archerbird"}, "edited": false, "score": 2, "creation_date": 1542813384, "post_id": 53414968, "comment_id": 93704701, "body": "take a look at this workaround which uses the string replace function to get long formulas past the 255 character limit: <a href=\"http://dailydoseofexcel.com/archives/2005/01/10/entering-long-array-formulas-in-vba/\" rel=\"nofollow noreferrer\">link</a>"}, {"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 0, "creation_date": 1542815113, "post_id": 53414968, "comment_id": 93705735, "body": "in some cases Excel could be fooled about 255 limitation by simply putting properly formulated string as string as the value of the cell. In this case.  it seems to be working. <code>Dim Str as string</code> then <code>Str =&quot;=IF(IF(AND(OR.........</code> and finally <code>Selection.value=str</code> may be doing the trick. However check the formula after being put into the cell."}, {"owner": {"reputation": 23, "user_id": 10331892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a0779e052e445a292b8ee7b5779948f?s=128&d=identicon&r=PG&f=1", "display_name": "Serg", "link": "https://stackoverflow.com/users/10331892/serg"}, "reply_to_user": {"reputation": 1854, "user_id": 6071871, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IfFKy.jpg?s=128&g=1", "display_name": "ArcherBird", "link": "https://stackoverflow.com/users/6071871/archerbird"}, "edited": false, "score": 0, "creation_date": 1542815119, "post_id": 53414968, "comment_id": 93705738, "body": "@ArcherBird Wow thanks! I&#39;ll have to try this then it looks perfect. I&#39;ll just take a look at where I can cutoff the formula and take it from there."}, {"owner": {"reputation": 23, "user_id": 10331892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a0779e052e445a292b8ee7b5779948f?s=128&d=identicon&r=PG&f=1", "display_name": "Serg", "link": "https://stackoverflow.com/users/10331892/serg"}, "reply_to_user": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 0, "creation_date": 1542815182, "post_id": 53414968, "comment_id": 93705777, "body": "@AhmedAU Thanks! I&#39;ll be sure to try this, if this works it&#39;ll be even less to deal with. Edit 1: It seems to not pick up as an array however. I&#39;ll try Archer&#39;s split string solution"}, {"owner": {"reputation": 1854, "user_id": 6071871, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IfFKy.jpg?s=128&g=1", "display_name": "ArcherBird", "link": "https://stackoverflow.com/users/6071871/archerbird"}, "edited": false, "score": 0, "creation_date": 1542815993, "post_id": 53414968, "comment_id": 93706315, "body": "@Serg - the tricky bit is that you cannot arbitrarily split your formula. You have to put the formula into the FormulaArray property in chunks that represent a valid formula; otherwise, you&#39;ll get more errors. I&#39;ve created a solution for you below. Hope it helps :-)"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 10331892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a0779e052e445a292b8ee7b5779948f?s=128&d=identicon&r=PG&f=1", "display_name": "Serg", "link": "https://stackoverflow.com/users/10331892/serg"}, "edited": false, "score": 0, "creation_date": 1542816933, "post_id": 53415881, "comment_id": 93706886, "body": "WOW THANKS! That really helped! I was trying to work out a way to split up the formula, but you really went the extra step thank you so much!"}, {"owner": {"reputation": 1854, "user_id": 6071871, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IfFKy.jpg?s=128&g=1", "display_name": "ArcherBird", "link": "https://stackoverflow.com/users/6071871/archerbird"}, "reply_to_user": {"reputation": 23, "user_id": 10331892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a0779e052e445a292b8ee7b5779948f?s=128&d=identicon&r=PG&f=1", "display_name": "Serg", "link": "https://stackoverflow.com/users/10331892/serg"}, "edited": false, "score": 0, "creation_date": 1542816997, "post_id": 53415881, "comment_id": 93706935, "body": "@Serg NP! It&#39;s a very slow pre-Thanksgiving Day at work and I&#39;m bored. Happy to help :-)"}, {"owner": {"reputation": 23, "user_id": 10331892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a0779e052e445a292b8ee7b5779948f?s=128&d=identicon&r=PG&f=1", "display_name": "Serg", "link": "https://stackoverflow.com/users/10331892/serg"}, "edited": false, "score": 1, "creation_date": 1542817383, "post_id": 53415881, "comment_id": 93707161, "body": "Also I agree with that definitive range rather than select is better, I just kept it as selection to show exactly how it was recorded in the macro. Usually I record the formula through a macro and change the coding up from there. Less to write in you know."}], "tags": [], "owner": {"reputation": 1854, "user_id": 6071871, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IfFKy.jpg?s=128&g=1", "display_name": "ArcherBird", "link": "https://stackoverflow.com/users/6071871/archerbird"}, "is_accepted": true, "score": 1, "last_activity_date": 1542816221, "last_edit_date": 1542816221, "creation_date": 1542815724, "answer_id": 53415881, "question_id": 53414968, "link": "https://stackoverflow.com/questions/53414968/getting-run-time-error-1004-is-my-formula-perhaps-too-long-or-can-i-fix-the-co/53415881#53415881", "title": "Getting Run-Time error &#39;1004&#39; Is my formula perhaps too long or can I fix the coding?", "body": "<p>I went ahead and built a custom solution just for you. Here, you'll see I broke up your formula into smaller parts and substitute them back together (just like the good 'ol days back in algebra class). </p>\n\n<p>Also note, that I don't use the <code>Selection</code> object as you do in your question. I recommend working with Ranges directly rather than using <code>.Select</code>, <code>Selection.</code> or <code>.Activate</code> and so on. So In my example below I assume the range you have \"Selected\" is A1 on the first worksheet.</p>\n\n<pre><code>strFormula = \"=IF(IF(AND(OR(C2&lt;&gt;C1,B2&lt;&gt;B1),Pay_Periods!$J$2&lt;&gt;0),MAX(W_W),MAX(X_X))=0,\"\"\"\",\" &amp; _\n             \"IF(AND(OR(C2&lt;&gt;C1,B2&lt;&gt;B1),Pay_Periods!$J$2&lt;&gt;0),MAX(Y_Y),MAX(Z_Z)))\"\nstrFormulaW_W = \"IF(Pay_Periods!$C$2:$C$250&gt;=Pay_Periods!$J$1+(14*Pay_Periods!$J$3),\" &amp; _\n                \"IF(Pay_Periods!$B$2:$B$250&lt;=Pay_Periods!$J$1+(14*Pay_Periods!$J$3),Pay_Periods!$C$2:$C$250))\"\nstrFormulaX_X = \"IF((Pay_Periods!$C$2:$C$250&gt;=Sheet1!G2)*(IF(AND(Sheet1!C2=Sheet1!C1,Sheet1!G1&lt;Sheet1!G2+14),\" &amp; _\n                \"Pay_Periods!$C$2:$C$250&lt;(G2+14),IF(AND(C2=C1,B2=B1),Pay_Periods!$C$2:$C$250&lt;G1,1))),Pay_Periods!$C$2:$C$250,\"\"\"\")\"\nstrFormulaY_Y = \"IF(Pay_Periods!$C$2:$C$250&gt;=Pay_Periods!$J$1+(14*Pay_Periods!$J$3),IF(Pay_Periods!$B$2:$B$250&lt;=\" &amp; _\n                \"Pay_Periods!$J$1+(14*Pay_Periods!$J$3),Pay_Periods!$C$2:$C$250))\"\nstrFormulaZ_Z = \"IF((Pay_Periods!$C$2:$C$250&gt;=Sheet1!G2)*(IF(AND(Sheet1!C2=Sheet1!C1,Sheet1!B2=Sheet1!B1,\" &amp; _\n                \"Sheet1!G1&lt;Sheet1!G2+14),Pay_Periods!$C$2:$C$250&lt;(G2+14),IF(AND(C2=C1,B2=B1),Pay_Periods!$C$2:$C$250&lt;G1,1))),Pay_Periods!$C$2:$C$250,\"\"\"\")\"\n\nWith ThisWorkbook.Worksheets(1).Range(\"A1\")\n    .FormulaArray = strFormula\n    .Replace \"W_W\", strFormulaW_W\n    .Replace \"X_X\", strFormulaX_X\n    .Replace \"Y_Y\", strFormulaY_Y\n    .Replace \"Z_Z\", strFormulaZ_Z\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 10331892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a0779e052e445a292b8ee7b5779948f?s=128&d=identicon&r=PG&f=1", "display_name": "Serg", "link": "https://stackoverflow.com/users/10331892/serg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 53415881, "answer_count": 1, "score": 1, "last_activity_date": 1579624287, "creation_date": 1542812865, "last_edit_date": 1579624287, "question_id": 53414968, "link": "https://stackoverflow.com/questions/53414968/getting-run-time-error-1004-is-my-formula-perhaps-too-long-or-can-i-fix-the-co", "title": "Getting Run-Time error &#39;1004&#39; Is my formula perhaps too long or can I fix the coding?", "body": "<p>So I wrote up an Array formula which works fine on my excel, but when converting it to VBA I'm getting an error: Unable to set the FormulaArray property of the Range class. I'm not sure why I'm getting this issue. Please see the code here: </p>\n\n<pre><code>Selection.FormulaArray = _\n    \"=IF(IF(AND(OR(RC[-14]&lt;&gt;R[-1]C[-14],RC[-15]&lt;&gt;R[-1]C[-15]),Pay_Periods!R2C10&lt;&gt;0),MAX(IF(Pay_Periods!R2C3:R250C3&gt;=Pay_Periods!R1C10+(14*Pay_Periods!R3C10),IF(Pay_Periods!R2C2:R250C2&lt;=Pay_Periods!R1C10+(14*Pay_Periods!R3C10),Pay_Periods!R2C3:R250C3))),MAX(IF((Pay_Periods!R2C3:R250C3&gt;=Sheet1!RC[-10])*(IF(AND(Sheet1!RC[-14]=Sheet1!R[-1]C[-14],Sheet1!R[-1]C[-10]&lt;Sheet1!RC[\" &amp; _\n    \"-10]+14),Pay_Periods!R2C3:R250C3&lt;(RC[-10]+14),IF(AND(RC[-14]=R[-1]C[-14],RC[-15]=R[-1]C[-15]),Pay_Periods!R2C3:R250C3&lt;R[-1]C[-10],1))),Pay_Periods!R2C3:R250C3,\"\"\"\")))=0,\"\"\"\",IF(AND(OR(RC[-14]&lt;&gt;R[-1]C[-14],RC[-15]&lt;&gt;R[-1]C[-15]),Pay_Periods!R2C10&lt;&gt;0),MAX(IF(Pay_Periods!R2C3:R250C3&gt;=Pay_Periods!R1C10+(14*Pay_Periods!R3C10),IF(Pay_Periods!R2C2:R250C2&lt;=Pay_Periods!R1C10+\" &amp; _\n    \"(14*Pay_Periods!R3C10),Pay_Periods!R2C3:R250C3))),MAX(IF((Pay_Periods!R2C3:R250C3&gt;=Sheet1!RC[-10])*(IF(AND(Sheet1!RC[-14]=Sheet1!R[-1]C[-14],Sheet1!RC[-15]=Sheet1!R[-1]C[-15],Sheet1!R[-1]C[-10]&lt;Sheet1!RC[-10]+14),Pay_Periods!R2C3:R250C3&lt;(RC[-10]+14),IF(AND(RC[-14]=R[-1]C[-14],RC[-15]=R[-1]C[-15]),Pay_Periods!R2C3:R250C3&lt;R[-1]C[-10],1))),Pay_Periods!R2C3:R250C3,\"\"\"\")\" &amp; _\n    \")))\" &amp; _\n    \"\"\n</code></pre>\n\n<p>By the way I copied it exactly how the macro itself recorded it so you may notice some spaces. I'm thinking it could just be too long, but it seems weird that writing it in the cell gets it fine, but not in the vba form. If anyone can help it would be much appreciated! I'm attempting to have this formula self insert by code and copy paste values so the excel doesn't have to keep loading in information.  </p>\n\n<p>Here is how the formula looks normally:</p>\n\n<pre><code>=IF(IF(AND(OR(C2&lt;&gt;C1,B2&lt;&gt;B1),Pay_Periods!$J$2&lt;&gt;0),MAX(IF(Pay_Periods!$C$2:$C$250&gt;=Pay_Periods!$J$1+(14*Pay_Periods!$J$3),IF(Pay_Periods!$B$2:$B$250&lt;=Pay_Periods!$J$1+(14*Pay_Periods!$J$3),Pay_Periods!$C$2:$C$250))),MAX(IF((Pay_Periods!$C$2:$C$250&gt;=Sheet1!G2)*(IF(AND(Sheet1!C2=Sheet1!C1,Sheet1!G1&lt;Sheet1!G2+14),Pay_Periods!$C$2:$C$250&lt;(G2+14),IF(AND(C2=C1,B2=B1),Pay_Periods!$C$2:$C$250&lt;G1,1))),Pay_Periods!$C$2:$C$250,\"\")))=0,\"\",IF(AND(OR(C2&lt;&gt;C1,B2&lt;&gt;B1),Pay_Periods!$J$2&lt;&gt;0),MAX(IF(Pay_Periods!$C$2:$C$250&gt;=Pay_Periods!$J$1+(14*Pay_Periods!$J$3),IF(Pay_Periods!$B$2:$B$250&lt;=Pay_Periods!$J$1+(14*Pay_Periods!$J$3),Pay_Periods!$C$2:$C$250))),MAX(IF((Pay_Periods!$C$2:$C$250&gt;=Sheet1!G2)*(IF(AND(Sheet1!C2=Sheet1!C1,Sheet1!B2=Sheet1!B1,Sheet1!G1&lt;Sheet1!G2+14),Pay_Periods!$C$2:$C$250&lt;(G2+14),IF(AND(C2=C1,B2=B1),Pay_Periods!$C$2:$C$250&lt;G1,1))),Pay_Periods!$C$2:$C$250,\"\"))))\n</code></pre>\n\n<p>Then ctrl+shift+enter naturally </p>\n"}, {"tags": ["excel", "vba", "url", "web"], "comments": [{"owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "edited": false, "score": 0, "creation_date": 1542812482, "post_id": 53414690, "comment_id": 93704116, "body": "what is the problem with your code?"}, {"owner": {"reputation": 15, "user_id": 10686391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8b92cca3a4c0694c636a644b5535504?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/10686391/jason"}, "reply_to_user": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "edited": false, "score": 0, "creation_date": 1542812977, "post_id": 53414690, "comment_id": 93704440, "body": "It doesn&#39;t recognize the links in the rows (that&#39;s where I get the problem when debugging)"}], "answers": [{"tags": [], "owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "is_accepted": true, "score": 0, "last_activity_date": 1542818807, "last_edit_date": 1542818807, "creation_date": 1542813516, "answer_id": 53415188, "question_id": 53414690, "link": "https://stackoverflow.com/questions/53414690/loop-through-list-of-urls-29-xls-files-to-open-and-paste-data-into-1-single-s/53415188#53415188", "title": "Loop through list of URLs (29 .xls files) to open and paste data into 1 single sheet", "body": "<p>This could work for your situation. Haven't tested it though so please save your workbook before trying.</p>\n\n<pre><code>Sub Import_Baskets()\n\n    Dim lastRow As Long, link As String\n    Dim targetSheet As Worksheet\n    Dim webBook As Workbook\n    Dim webSheet As Worksheet\n    Dim shName As String\n    Dim stRow As Long\n\n    With ThisWorkbook.Worksheets(\"Admin\")\n\n        lastRow = .Cells(.Rows.Count, \"B\").End(xlUp).Row\n\n        ' set your start and last row\n        For row = 2 To lastRow\n\n            link = Trim(CStr(.Range(\"B\" &amp; row).Value))\n            shName = Trim(CStr(.Range(\"C\" &amp; row).Value))\n            stRow = .Range(\"D\" &amp; row).Value\n\n            ' open web wb\n            Set webBook = Workbooks.Open(link)\n\n            ' set web ws\n            Set webSheet = webBook.Worksheets(\"enter desired sheet name\")\n\n            ' copy &amp; paste\n            On Error GoTo CreateSheet\n            Set targetSheet = ThisWorkbook.Worksheets(shName)\n            On Error GoTo 0\n            webSheet.UsedRange.Copy destination:=targetSheet.Range(\"A\" &amp; stRow)\n\n            ' close web wb        \n            webBook.Close\n            .Activate\n        Next\n    End With\n    Exit Sub\n\n' if sheet doesn't exist, insert it\nCreateSheet:\n    With ThisWorkbook\n        .Sheets.Add(After:=.Sheets(.Sheets.Count)).Name = shName \n    End With\n    Resume Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 10686391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8b92cca3a4c0694c636a644b5535504?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/10686391/jason"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 388, "favorite_count": 0, "accepted_answer_id": 53415188, "answer_count": 1, "score": 1, "last_activity_date": 1583476797, "creation_date": 1542811939, "last_edit_date": 1583476797, "question_id": 53414690, "link": "https://stackoverflow.com/questions/53414690/loop-through-list-of-urls-29-xls-files-to-open-and-paste-data-into-1-single-s", "title": "Loop through list of URLs (29 .xls files) to open and paste data into 1 single sheet", "body": "<p>I have a sheet with 3 columns: URL - Target Sheet - Row</p>\n\n<p>The URLs direct you to a .XLS file download automatically (example below):</p>\n\n<p><a href=\"http://www.eurexrepo.com/blob/157370/ccb5c831da64925cfc15aff4c5e4be85/data/euro_gjpbasket.xls\" rel=\"nofollow noreferrer\">http://www.eurexrepo.com/blob/157370/ccb5c831da64925cfc15aff4c5e4be85/data/euro_gjpbasket.xls</a></p>\n\n<p>What I would like to do is to have a VBA code that loops through the rows (B2:B30) that contain the 29 links (please see image) and copy/pastes the data into a unique target sheet (specified in the second column C2:C30) in a predefined row number of the target sheet (specified in 3rd column: D2:D30). </p>\n\n<p><a href=\"https://i.stack.imgur.com/EvMWy.png\" rel=\"nofollow noreferrer\">List of URLs in cells</a></p>\n\n<p>This is the code that I am trying to use:</p>\n\n<pre><code>Sub Import_Baskets()\n\nDim Rows As Long, links As Variant, link As Variant\nRows = Sheets(\"Admin\").Cells(Sheets(\"Admin\").Rows.Count, \"B\").End(xlUp).Row\nlinks = Sheets(\"Admin\").Range(\"B1:B\" &amp; Rows)\n\n    For Each link In links\n\n        Dim wkbMyWorkbook As Workbook\n        Dim wkbWebWorkbook As Workbook\n        Dim wksWebWorkSheet As Worksheet\n\n        Set wkbMyWorkbook = ActiveWorkbook\n\n        ' *************************************************\n        ' Open The Web Workbook\n        ' *************************************************\n\n        ' *************************************************\n        ' Set the Web Workbook and Worksheet Variables\n        ' *************************************************\n        Set wkbWebWorkbook = ActiveWorkbook\n        Set wksWebWorkSheet = ActiveSheet\n\n        ' *************************************************\n        ' Copy The Web Worksheet To My Workbook and Rename\n        ' *************************************************\n        wksWebWorkSheet.Copy After:=wkbMyWorkbook.Sheets(Sheets.Count)\n        wkbMyWorkbook.Sheets(ActiveSheet.Name).Name = \"GC\"\n\n        '.Range(\"$A$\" + row_number)\n        ' *************************************************\n        ' Close the Web Workbook\n        ' *************************************************\n        wkbMyWorkbook.Activate\n        wkbWebWorkbook.Close\n\n\n    Next link\n\n    'Next\n\n\nEnd Sub\n</code></pre>\n\n<p>Any help will be much appreciated! :)</p>\n"}, {"tags": ["excel", "vba", "listbox"], "comments": [{"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1542813834, "post_id": 53414565, "comment_id": 93704979, "body": "Can i suggest to do a <code>Debug.Print &quot;tblFoilInfoHelper!A1:&quot; &amp; Col_Letter(TotalColumnsCount(&quot;Foil Purchases.xlsm&quot;, &quot;List_Box&quot;)) &amp; TotalRowsCount(&quot;Foil Purchases.xlsm&quot;, &quot;List_Box&quot;, &quot;tblFoilInfoHelper&quot;)</code> and see that your range gets generated properly? Do this before or instead of the problem line of course."}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "reply_to_user": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1542814533, "post_id": 53414565, "comment_id": 93705392, "body": "@DarXyde I got <code>tblFoilInfoHelper!A1:K4</code> as the output i&#39;m not sure if I did the <code>RowSource</code> method correctly but I believe it is"}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 1, "creation_date": 1542815287, "post_id": 53414565, "comment_id": 93705842, "body": "Try using the sheet name instead of the table name? ie: <code>lbxFoilInfoDisplay.RowSource = &quot;List_Box!A1:&quot; &amp; Col_Letter(TotalColumnsCount(&quot;Foil Purchases.xlsm&quot;, &quot;List_Box&quot;)) &amp; TotalRowsCount(&quot;Foil Purchases.xlsm&quot;, &quot;List_Box&quot;, &quot;tblFoilInfoHelper&quot;)</code>"}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "reply_to_user": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1542816105, "post_id": 53414565, "comment_id": 93706383, "body": "@DarXyde Oh yes... That works didn&#39;t realize that was the issue. I had a worksheet named <code>Table</code> in the reference workbook I was using I confused it as a table. Thanks"}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1542817216, "post_id": 53414565, "comment_id": 93707066, "body": "Glad i could help... :)"}], "answers": [{"tags": [], "owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "is_accepted": true, "score": 1, "last_activity_date": 1542817193, "creation_date": 1542817193, "answer_id": 53416356, "question_id": 53414565, "link": "https://stackoverflow.com/questions/53414565/unable-to-set-a-range-into-the-listbox-rowsource-method-or-listbox-list-method/53416356#53416356", "title": "Unable to set a range into the Listbox.RowSource method or Listbox.List method", "body": "<p>Use the sheet name instead of the table name. ie: <strong>\"List_Box!A1:\" &amp;...</strong> </p>\n\n<pre><code>lbxFoilInfoDisplay.RowSource = \"List_Box!A1:\" &amp; Col_Letter(TotalColumnsCount(\"Foil Purchases.xlsm\", \"List_Box\")) &amp; TotalRowsCount(\"Foil Purchases.xlsm\", \"List_Box\", \"tblFoilInfoHelper\")\n</code></pre>\n\n<p>Might find some use for this... or not. You can do this using the table as well, but you still need to use the Sheetname in order to get the address of the cells. ie.</p>\n\n<pre><code>ActiveSheet.ListObjects(1).Range.Cells(3, 1).Address\n</code></pre>\n\n<p>This is useful if you need to refer to specific cells in your table, and care less where the table is located. However this is only to help you build the address part - and not to replace the sheet name with the table name.</p>\n"}], "owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 53416356, "answer_count": 1, "score": 1, "last_activity_date": 1583476812, "creation_date": 1542811537, "last_edit_date": 1583476812, "question_id": 53414565, "link": "https://stackoverflow.com/questions/53414565/unable-to-set-a-range-into-the-listbox-rowsource-method-or-listbox-list-method", "title": "Unable to set a range into the Listbox.RowSource method or Listbox.List method", "body": "<p>When the line reaches <code>lbxFoilInfoDisplay.RowSource = \"tblFoilInfoHelper!A1:\" &amp; Col_Letter(TotalColumnsCount(\"Foil Purchases.xlsm\", \"List_Box\")) &amp; TotalRowsCount(\"Foil Purchases.xlsm\", \"List_Box\", \"tblFoilInfoHelper\")</code> I get the error:</p>\n\n<p><a href=\"https://i.stack.imgur.com/To6CR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/To6CR.png\" alt=\"enter image description here\"></a></p>\n\n<p>When I try to replace it with:\n<code>lbxFoilInfoDisplay.List = ThisWorkbook.Worksheets(\"List_Box\").Range(\"A1:\" &amp; Col_Letter(TotalColumnsCount(\"Foil Purchases.xlsm\", \"List_Box\")) &amp; TotalRowsCount(\"Foil Purchases.xlsm\", \"List_Box\", \"tblFoilInfoHelper\"))</code>, I get the error:</p>\n\n<p><a href=\"https://i.stack.imgur.com/TTv0N.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TTv0N.png\" alt=\"enter image description here\"></a></p>\n\n<p>I believe the name of the table is correct as shown in the image below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/hH7wg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hH7wg.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Option Explicit\nDim filterRangeFoilProfile As Range, filteredRangeFoilProfile As Range\nPrivate Sub cbxSupplier_AfterUpdate()\nDim Supplier_col As Long\n\nlbxFoilInfoDisplay.RowSource = vbNullString\nSupplier_col = ThisWorkbook.Worksheets(\"Foil Profile\").ListObjects(\"tblFoilProfile\").ListColumns(\"SUPPLIER\").Index\nfilterRangeFoilProfile.AutoFilter Field:=Supplier_col, Criteria1:=cbxSupplier.Text\nOn Error Resume Next\nSet filteredRangeFoilProfile = Intersect(filterRangeFoilProfile, filterRangeFoilProfile.Offset(1, 0)).SpecialCells(xlCellTypeVisible)\nOn Error GoTo 0\n\nIf Not filteredRangeFoilProfile Is Nothing Then\n    ThisWorkbook.Worksheets(\"Foil Profile\").ListObjects(\"tblFoilProfile\").DataBodyRange.SpecialCells(xlCellTypeVisible).Copy\n    ThisWorkbook.Worksheets(\"List_Box\").Cells(2, 1).PasteSpecial\n    lbxFoilInfoDisplay.RowSource = \"tblFoilInfoHelper!A1:\" &amp; Col_Letter(TotalColumnsCount(\"Foil Purchases.xlsm\", \"List_Box\")) &amp; TotalRowsCount(\"Foil Purchases.xlsm\", \"List_Box\", \"tblFoilInfoHelper\")\n    'lbxFoilInfoDisplay.List = ThisWorkbook.Worksheets(\"List_Box\").Range(\"A1:\" &amp; Col_Letter(TotalColumnsCount(\"Foil Purchases.xlsm\", \"List_Box\")) &amp; TotalRowsCount(\"Foil Purchases.xlsm\", \"List_Box\", \"tblFoilInfoHelper\"))\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>User-Defined Functions (to add context):</p>\n\n<p>1.)</p>\n\n<pre><code>Function Col_Letter(lngCol As Long) As String\n    Dim vArr\n    vArr = Split(Cells(1, lngCol).Address(True, False), \"$\")\n    Col_Letter = vArr(0)\nEnd Function\n</code></pre>\n\n<p>2.)</p>\n\n<pre><code>Function TotalRowsCount(WBString As String, WorksheetNameString As String, TableNameString As String) As Long\n\nDim Total_columns As Long\nDim i As Long\n\nTotal_columns = Workbooks(WBString).Worksheets(WorksheetNameString).ListObjects(TableNameString).ListColumns.Count\n\nReDim Rows_count(1 To Total_columns) As Long\nFor i = 1 To Total_columns\n    With Workbooks(WBString).Worksheets(WorksheetNameString).ListObjects(TableNameString).ListColumns(i).Range\n    Rows_count(i) = .Find(What:=\"*\", _\n        After:=.Cells(1), _\n        Lookat:=xlPart, _\n        LookIn:=xlFormulas, _\n        SearchOrder:=xlByRows, _\n        SearchDirection:=xlPrevious, _\n        MatchCase:=False).Row\n    End With\nNext i\nTotalRowsCount = WorksheetFunction.Max(Rows_count)\n\nEnd Function\n</code></pre>\n\n<p>3.)</p>\n\n<pre><code>Function TotalColumnsCount(WBString As String, WorksheetNameString As String) As Long\n\nDim lastColumn As Long\nlastColumn = Workbooks(WBString).Worksheets(WorksheetNameString).Cells(1, Columns.Count).End(xlToLeft).Column\nTotalColumnsCount = lastColumn\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1542811094, "post_id": 53414428, "comment_id": 93703254, "body": "In which line do you get the error?"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1542811191, "post_id": 53414428, "comment_id": 93703314, "body": "You need to declare <code>appxl</code>. This compiles on my end though"}, {"owner": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1542811249, "post_id": 53414428, "comment_id": 93703348, "body": "@P\u1d07\u029c very start."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1542811288, "post_id": 53414428, "comment_id": 93703379, "body": "@excelguy you can be more specific here..... which line? The very start as in <code>Sub test()</code>?"}, {"owner": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1542811850, "post_id": 53414428, "comment_id": 93703702, "body": "@urdearboy yes that line"}], "answers": [{"comments": [{"owner": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "edited": false, "score": 0, "creation_date": 1542812129, "post_id": 53414551, "comment_id": 93703884, "body": "Thanks,but now getting a new error. See edited question."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "edited": false, "score": 0, "creation_date": 1542812334, "post_id": 53414551, "comment_id": 93704020, "body": "@excelguy quit all instances of Excel (or restart your computer). And try again. Always provide <b>in which line</b> you get an error otherwise we cannot help."}, {"owner": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "edited": false, "score": 0, "creation_date": 1542812378, "post_id": 53414551, "comment_id": 93704049, "body": "its kind of just repeating that error . I believe it was at ` Set SourceWb = AppXl.Workbooks.Open(ThisWorkbook.Path &amp; &quot;\\&quot; &amp; sourceFileName)` . Going to try restarting."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "edited": false, "score": 0, "creation_date": 1542812523, "post_id": 53414551, "comment_id": 93704140, "body": "What do you mean by <i>&quot;I believe&quot;</i>? You should be sure. The code line that throws the error is highlighted in yellow."}, {"owner": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "edited": false, "score": 0, "creation_date": 1542812722, "post_id": 53414551, "comment_id": 93704263, "body": "I cant see the yellow, it doesnt show it. This error doesnt cause a debug option."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "edited": false, "score": 0, "creation_date": 1542812816, "post_id": 53414551, "comment_id": 93704319, "body": "Go through your code step by step using F8. This way you always know in which line you are."}, {"owner": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "edited": false, "score": 0, "creation_date": 1542813058, "post_id": 53414551, "comment_id": 93704483, "body": "Ok sir, yes i stepped through it. it is line , <code>Set SourceWb = AppXl.Workbooks.Open(ThisWorkbook.Path &amp; &quot;\\&quot; &amp; sourceFileName)</code> .  Now im confused more. <code>Thisworkbook</code>  is taking my active workbook where I want the data to be pasted, <code>sourcefilename</code> is the place i want to copy from. Why is it concatenating these two."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "edited": false, "score": 0, "creation_date": 1542813232, "post_id": 53414551, "comment_id": 93704614, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/184038/discussion-between-p-and-excelguy\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 2, "last_activity_date": 1542811816, "last_edit_date": 1542811816, "creation_date": 1542811507, "answer_id": 53414551, "question_id": 53414428, "link": "https://stackoverflow.com/questions/53414428/vba-compile-error-trying-to-copy-sheet-from-external-file-to-master-file/53414551#53414551", "title": "VBA Compile Error, Trying to copy sheet from external file to master file", "body": "<p>I recommend the following</p>\n\n<pre><code>Option Explicit\n\nSub test()\n    Dim AppXl As Excel.Application\n    Set AppXl = New Excel.Application\n    AppXl.Visible = False\n\n    Dim sourceFileName As String\n    sourceFileName = \"File name\"\n\n    'Open Source File.xlsx\n    Dim SourceWb As Workbook 'remember workbook in a variable so we can easily access it\n    Set SourceWb = AppXl.Workbooks.Open(ThisWorkbook.Path &amp; \"\\\" &amp; sourceFileName)\n\n    'Get first sheet data\n    Dim currentSheet As Worksheet\n    Set currentSheet = SourceWb.Sheets(12)\n\n    'Past the table in my current Excel file\n    Dim lastRow As Long 'row counting variables MUST be Long\n    lastRow = currentSheet.Range(\"A1\").End(xlDown).Row\n\n    'define the workbook here\n    ThisWorkbook.Worksheets(\"Data retrieval\").Range(\"A1:E\" &amp; lastRow).Value = currentSheet.Range(\"A1:E\" &amp; lastRow).Value\n\n    'Close Source File.xlsx\n    SourceWb.Close SaveChanges:=False 'close source without saving\n    AppXl.Quit\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 53414551, "answer_count": 1, "score": 0, "last_activity_date": 1583491590, "creation_date": 1542811027, "last_edit_date": 1583491590, "question_id": 53414428, "link": "https://stackoverflow.com/questions/53414428/vba-compile-error-trying-to-copy-sheet-from-external-file-to-master-file", "title": "VBA Compile Error, Trying to copy sheet from external file to master file", "body": "<p>I am getting a compile error on this code, I am trying to target <code>SourceFileName</code> without opening and load it into my active workbook sheet \"data retrieval\"</p>\n\n<p>I am getting <code>compile error, sub of function not defined</code>.</p>\n\n<pre><code>Sub test()\n\nSet appxl = CreateObject(\"Excel.application\")\nDim myfile As Window\nDim currentSheet As Worksheet\nDim lastRow As Double\nDim sourceFileName As String\n\u00a0\nsourceFileName = \"File name\"\n\u00a0\n'Open Source File.xlsx\nWith appxl\n\u00a0\u00a0\u00a0\u00a0.Workbooks.Open ActiveWorkbook.Path &amp; \"\\\" &amp; sourceFileName\n\u00a0\u00a0\u00a0\u00a0.Visible = False\nEnd With\n\u00a0\u00a0\n'Get first sheet data\nSet myfile = appxl.Windows(sourceFileName)\nmyfile.Activate\nSet currentSheet = appxl.Sheets(12)\n\u00a0\n'Past the table in my current Excel file\nlastRow = currentSheet.Range(\"A1\").End(xlDown).Row\nSheets(\"Data retrieval\").Range(\"A1:E\" &amp; lastRow) = currentSheet.Range(\"A1:E\" &amp; lastRow).Value\n\u00a0\n'Close Source File.xlsx\nappxl.Workbooks(sourceFileName).Close\n\nEnd Sub\n</code></pre>\n\n<p>After applying the below recommendation of <code>Option Explicit</code> and declaring <code>appxl</code> I am getting the following error:</p>\n\n<p><a href=\"https://i.stack.imgur.com/DHWDY.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DHWDY.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["sql", "excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "is_accepted": false, "score": 0, "last_activity_date": 1542808753, "creation_date": 1542808753, "answer_id": 53413725, "question_id": 53413195, "link": "https://stackoverflow.com/questions/53413195/how-to-use-vba-in-excel-to-refresh-sql-data-into-next-empty-row/53413725#53413725", "title": "How to use VBA in excel to refresh sql data into next empty row?", "body": "<p>Without more info about how your query dumps the data in your sheet, i can point out to getting last row of your data (try one of these solutions: <a href=\"https://www.thespreadsheetguru.com/blog/2014/7/7/5-different-ways-to-find-the-last-row-or-last-column-using-vba\" rel=\"nofollow noreferrer\">https://www.thespreadsheetguru.com/blog/2014/7/7/5-different-ways-to-find-the-last-row-or-last-column-using-vba</a>).</p>\n\n<p>Having the last row (assigned to a variable), should be just a matter of adding this information in your code, at the part where the data is sent to the sheet.</p>\n\n<p>For better help, please post some/all of your code.</p>\n"}], "owner": {"reputation": 1, "user_id": 10686051, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/829cdb5a9d18b438ad21e26d00021602?s=128&d=identicon&r=PG&f=1", "display_name": "user10686051", "link": "https://stackoverflow.com/users/10686051/user10686051"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542808753, "creation_date": 1542807139, "question_id": 53413195, "link": "https://stackoverflow.com/questions/53413195/how-to-use-vba-in-excel-to-refresh-sql-data-into-next-empty-row", "title": "How to use VBA in excel to refresh sql data into next empty row?", "body": "<p>I have a query in excel that brings me back a set of data. I would like to know if it would be possible using VBA that when I refresh the query rather than overwrite the existing data it instead adds this data below the existing data?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["regex", "excel", "vba"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1542806927, "post_id": 53413033, "comment_id": 93700733, "body": "Don&#39;t put the next loop in the select case; leave that particular case blank, or set i=0 and then for the other operational code, if i&lt;&gt;0 then execute, otherwise end if and moves to next loop.  This could lead to issues with overarching with statements, etc."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1542807241, "post_id": 53413033, "comment_id": 93700932, "body": "It looks like <code>RegEx</code> is local to the <code>GetPattern</code> code, which is why you get the error in the calling code."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1542811545, "post_id": 53413033, "comment_id": 93703516, "body": "More to @Rory&#39;s point, provide the whole proc that contains the <code>Do While</code> loop - there are a lot of pieces missing that will help put the puzzle together."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 10657640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/593bf5d268e22cfb41db49e9a1898ca2?s=128&d=identicon&r=PG&f=1", "display_name": "Jose Chiesa", "link": "https://stackoverflow.com/users/10657640/jose-chiesa"}, "edited": false, "score": 0, "creation_date": 1542812922, "post_id": 53413186, "comment_id": 93704397, "body": "Hi @Peh, thanks for your help, this works fine thanks you very much, but I that this could be more improved, o not?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 35, "user_id": 10657640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/593bf5d268e22cfb41db49e9a1898ca2?s=128&d=identicon&r=PG&f=1", "display_name": "Jose Chiesa", "link": "https://stackoverflow.com/users/10657640/jose-chiesa"}, "edited": false, "score": 0, "creation_date": 1542813381, "post_id": 53413186, "comment_id": 93704698, "body": "@JoseChiesa for code that works already but you think it can improved have a look at <a href=\"https://codereview.stackexchange.com\">codereview.stackexchange.com</a>"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 0, "last_activity_date": 1542807119, "creation_date": 1542807119, "answer_id": 53413186, "question_id": 53413033, "link": "https://stackoverflow.com/questions/53413033/object-variable-or-with-block-variable-not-set-using-regular-expressions/53413186#53413186", "title": "&quot;Object variable or With block variable not set&quot; using Regular expressions", "body": "<p>Your <code>Case RegEx.Test(newFileName)</code> doesn't make sense.</p>\n\n<p>It should be something like</p>\n\n<pre><code>Do While xExcelFile &lt;&gt; \"\"        \n\n    Select Case True\n        'go to next loop if the selected file and this workbook has the same name\n        Case xExcelFile = xWname\n            GoTo NextLoop\n\n        Case GetPattern(newFileName) = \"^([B]\\d{3}\\w{1,})\"\n            'file is pattern 1\n\n        Case GetPattern(newFileName) = \"^\\d*\\.\\d{4}\\w*\"\n            'file is pattern 2\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 10657640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/593bf5d268e22cfb41db49e9a1898ca2?s=128&d=identicon&r=PG&f=1", "display_name": "Jose Chiesa", "link": "https://stackoverflow.com/users/10657640/jose-chiesa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 1, "accepted_answer_id": 53413186, "answer_count": 1, "score": 1, "last_activity_date": 1583491601, "creation_date": 1542806659, "last_edit_date": 1583491601, "question_id": 53413033, "link": "https://stackoverflow.com/questions/53413033/object-variable-or-with-block-variable-not-set-using-regular-expressions", "title": "&quot;Object variable or With block variable not set&quot; using Regular expressions", "body": "<p>I'm getting the error </p>\n\n<blockquote>\n  <p>\"Object variable or With block variable not set\" </p>\n</blockquote>\n\n<p>setting the function to the RegEx object, so the thing is that I need to validate a File name with those patterns.</p>\n\n<p>I'm thinking that the <code>Select case</code> it's wrong too. I don't know how to solve it.</p>\n\n<pre><code>Do While xExcelFile &lt;&gt; \"\"        \n    strPattern = GetPattern(newFileName)\n\n    With RegEx\n        .Pattern = strPattern 'error occurs here\n    End With\n\n\n    Select Case True\n        'go to next loop if the selected file and this workbook has the same name\n        Case xExcelFile = xWname\n            GoTo NextLoop\n\n        'filter by name pattern\n        Case RegEx.Test(newFileName)\n            Workbooks.Open fileName:=xSPath &amp; xExcelFile 'open file\n\n        Case RegEx.Test(newFileName)\n            Workbooks.Open fileName:=xSPath &amp; xExcelFile 'open file`\n\nmore operational code below\n</code></pre>\n\n<p>This is the function that searches the desired pattern, and I think its work properly</p>\n\n<pre><code>Function GetPattern(ByVal newFileName As String) As String\nDim strPattern As String\nStatic RegEx As Object\n\nstrPattern1 = \"^([B]\\d{3}\\w{1,})\"\nstrPattern2 = \"^\\d*\\.\\d{4}\\w*\"\n\nIf RegEx Is Nothing Then\n   ' To speed the code up set the static RegEx object only once\n   Set RegEx = CreateObject(\"VBScript.RegExp\")\nEnd If\n\nWith RegEx\n    .Pattern = strPattern1\n    If RegEx.Test(newFileName) Then\n        strPattern = strPattern1\n    End If\n\n    .Pattern = strPattern2\n    If RegEx.Test(newFileName) Then\n        strPattern = strPattern2\n\n    End If\nEnd With\n\nGetPattern = strPattern\n\nEnd Function\n</code></pre>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1542805963, "post_id": 53412802, "comment_id": 93700180, "body": "Did you ask this yesterday?"}, {"owner": {"reputation": 1, "user_id": 10680433, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-dpVU0GlHiqY/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gJJxlzZ2gCm1CNsI_rUuE8SRbNMw/mo/photo.jpg?sz=128", "display_name": "nick irvin", "link": "https://stackoverflow.com/users/10680433/nick-irvin"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1542806136, "post_id": 53412802, "comment_id": 93700271, "body": "yes, this was asked yesterday but made some changes to my question and code for more clarification."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1542806214, "post_id": 53412802, "comment_id": 93700312, "body": "And what is the error message and which line raises it? And include the resulting <code>strDrySQL_New</code>, please."}, {"owner": {"reputation": 1, "user_id": 10680433, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-dpVU0GlHiqY/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gJJxlzZ2gCm1CNsI_rUuE8SRbNMw/mo/photo.jpg?sz=128", "display_name": "nick irvin", "link": "https://stackoverflow.com/users/10680433/nick-irvin"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1542806656, "post_id": 53412802, "comment_id": 93700568, "body": "@Gustav I have added more information on the error message and where it questions the line, thanks."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1542807287, "post_id": 53412802, "comment_id": 93700960, "body": "Possibly the <code>vbCrLf</code> in your SQL?  SQL doesn&#39;t need carriage returns - it&#39;s just one long string.  We only split it into multiple lines to make it easier to read."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1542812645, "post_id": 53412802, "comment_id": 93704224, "body": "@nickirvin So why not use any of the methods you were shown to debug?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10680433, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-dpVU0GlHiqY/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gJJxlzZ2gCm1CNsI_rUuE8SRbNMw/mo/photo.jpg?sz=128", "display_name": "nick irvin", "link": "https://stackoverflow.com/users/10680433/nick-irvin"}, "edited": false, "score": 0, "creation_date": 1542816750, "post_id": 53413539, "comment_id": 93706766, "body": "great solution, Gustav. works like a charm now. Thank you"}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1542808130, "creation_date": 1542808130, "answer_id": 53413539, "question_id": 53412802, "link": "https://stackoverflow.com/questions/53412802/ms-access-union-query-syntax-error-within-vba-code/53413539#53413539", "title": "MS-Access union query syntax error within VBA code", "body": "<p>At least here, you have an extra closing parenthesis:</p>\n\n<pre><code>.. And [CurrentLevelOfCompletion]=1073741829),1,0)) \n</code></pre>\n\n<p>Should be:</p>\n\n<pre><code>.. And [CurrentLevelOfCompletion]=1073741829,1,0)) \n</code></pre>\n\n<p>Insert a line:</p>\n\n<pre><code>Debug.Print strDrySQL_New\n</code></pre>\n\n<p>and study the print.</p>\n"}], "owner": {"reputation": 1, "user_id": 10680433, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-dpVU0GlHiqY/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gJJxlzZ2gCm1CNsI_rUuE8SRbNMw/mo/photo.jpg?sz=128", "display_name": "nick irvin", "link": "https://stackoverflow.com/users/10680433/nick-irvin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 200, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542808130, "creation_date": 1542805827, "last_edit_date": 1542806518, "question_id": 53412802, "link": "https://stackoverflow.com/questions/53412802/ms-access-union-query-syntax-error-within-vba-code", "title": "MS-Access union query syntax error within VBA code", "body": "<p>I have made a SQL statement that calculates the sum of the chosen fields I've gathered. I have the queries working within MS Access, but when I translate it to VBA coding within my database it spits out a compile error 3319: Syntax error. Below I have attached my working query as well as my query with the syntax.</p>\n\n<p>Query within MS Access is below that works properly:</p>\n\n<pre><code>SELECT 1,'Passed - Depot' AS QRY, Sum(IIf(([PreStressStackDate]&gt;=[StartDate] And [PreStressStackDate]&lt;=[EndDate]) And (([CurrentLevelOfCompletion]&gt;=5 And [CurrentLevelOfCompletion]&lt;1073741829) Or [CurrentLevelOfCompletion]&gt;1073741829),1,0)) AS [PreStress Stackup], Sum(IIf(([StackCompressionDate]&gt;=[StartDate] And [StackCompressionDate]&lt;=[EndDate]) And (([CurrentLevelOfCompletion]&gt;=21 And [CurrentLevelOfCompletion]&lt;1073741845) Or [CurrentLevelOfCompletion]&gt;1073741845),1,0)) AS [Stack Compression], Sum(IIf(([TestingDate]&gt;=[StartDate] And [TestingDate]&lt;=[EndDate]) And (([CurrentLevelOfCompletion]&gt;85 And [CurrentLevelOfCompletion]&lt;1073741909) Or [CurrentLevelOfCompletion]&gt;1073741909),1,0)) AS Testing, Sum(IIf(([ShroudAssemblyDate]&gt;=[StartDate] And [ShroudAssemblyDate]&lt;=[EndDate]) And (([CurrentLevelOfCompletion]&gt;=341 And [CurrentLevelOfCompletion]&lt;1073742165) Or [CurrentLevelOfCompletion]&gt;1073742165),1,0)) AS [Shroud Assembly], Sum(IIf(([TransformerInstallDate]&gt;=[StartDate] And [TransformerInstallDate]&lt;=[EndDate]) And (([CurrentLevelOfCompletion]&gt;=1365 And [CurrentLevelOfCompletion]&lt;1073743189)),1,0)) AS [Transformer Installation]\nFROM TR343DrySide\nWHERE (([TransducerSN] Not Like \"CR*\"));\n\nUNION SELECT 2, 'Failed - Depot' AS QRY, Sum(IIf(([PreStressStackDate]&gt;=[StartDate] And [PreStressStackDate]&lt;=[EndDate]) And [CurrentLevelOfCompletion]=1073741829,1,0)) AS [PreStress Stackup], Sum(IIf(([StackCompressionDate]&gt;=[StartDate] And [StackCompressionDate]&lt;=[EndDate]) And [CurrentLevelOfCompletion]=1073741845,1,0)) AS [Stack Compression], Sum(IIf(([TestingDate]&gt;=[StartDate] And [TestingDate]&lt;=[EndDate]) And [CurrentLevelOfCompletion]=1073741909,1,0)) AS [Testing], Sum(IIf(([ShroudAssemblyDate]&gt;=[StartDate] And [ShroudAssemblyDate]&lt;=[EndDate]) And [CurrentLevelOfCompletion]=1073742165,1,0)) AS [Shroud Assembly], Sum(IIf(([TransformerInstallDate]&gt;=[StartDate] And [TransformerInstallDate]&lt;=[EndDate]) And [CurrentLevelOfCompletion]=1073743189,1,0)) AS [Transformer Installation]\nFROM TR343DrySide\nWHERE (([TransducerSN] Not Like \"CR*\"));\n</code></pre>\n\n<p>When this query is run, it tallies up the sum of the fields between the chosen dates.</p>\n\n<p>Below I have attached my VBA code that comes up with a syntax compile error 3319:</p>\n\n<pre><code>Private Sub cmdDrySideRunReport_Click()\n\n    Dim strDrySQL_New, strDrySQL_Depot       As String\n    Dim DryStartDate                         As Date\n    Dim DryEndDate                           As Date\n\n\n  '------------------------------------------------------------------------------------------------------\n  If IsNull(Me.txtDryStartDate) Or Me.txtDryStartDate = \"\" Or IsNull(Me.txtDryEndDate) Or Me.txtDryEndDate = \"\" Then\n        If IsNull(Me.txtDryStartDate) Or Me.txtDryStartDate = \"\" Then\n            MsgBox \"Please enter the Start Date\"\n            Me.txtDryStartDate.SetFocus\n        End If\n        If IsNull(Me.txtDryEndDate) Or Me.txtDryEndDate = \"\" Then\n            MsgBox \"Please enter the End Date\"\n            Me.txtDryEndDate.SetFocus\n        End If\n    Else\n        DryStartDate = Me.txtDryStartDate\n        DryEndDate = Me.txtDryEndDate + 1\n\n\n\n        '###########################################################\n        'DRYSIDE NEW\n\nstrDrySQL_New = \"Select 1, 'Passed - New' AS QRY, Sum(IIf(([PreStressStackDate]&gt;=#\" &amp; DryStartDate &amp; \"# And [PreStressStackDate]&lt;=#\" &amp; DryEndDate &amp; \"#)\" &amp; _\n                    \" And (([CurrentLevelOfCompletion]&gt;=5 And [CurrentLevelOfCompletion]&lt;1073741829) Or [CurrentLevelOfCompletion]&gt;1073741829),1,0)) AS [PreStress Stackup],\" &amp; _\n                    \" Sum(IIf(([StackCompressionDate]&gt;=#\" &amp; DryStartDate &amp; \"# And [StackCompressionDate]&lt;=#\" &amp; DryEndDate &amp; \"#) And (([CurrentLevelOfCompletion]&gt;=21\" &amp; _\n                    \" And [CurrentLevelOfCompletion]&lt;1073741845) Or [CurrentLevelOfCompletion]&gt;1073741845),1,0)) AS [Stack Compression],\" &amp; _\n                    \" Sum(IIf(([TestingDate]&gt;=#\" &amp; DryStartDate &amp; \"# And [TestingDate]&lt;=#\" &amp; DryEndDate &amp; \"#) And (([CurrentLevelOfCompletion]&gt;=85\" &amp; _\n                    vbCrLf &amp; \" And [CurrentLevelOfCompletion]&lt;1073741909) Or [CurrentLevelOfCompletion]&gt;1073741909),1,0)) AS [Testing],\" &amp; _\n                    \" Sum(IIf(([ShroudAssemblyDate]&gt;=#\" &amp; DryStartDate &amp; \"# And [ShroudAssemblyDate]&lt;=#\" &amp; DryEndDate &amp; \"#) And (([CurrentLevelOfCompletion]&gt;=341\" &amp; _\n                    \" And [CurrentLevelOfCompletion]&lt;1073742165) Or [CurrentLevelOfCompletion]&gt;1073742165),1,0)) AS [Shroud Assembly],\" &amp; _\n                    \" Sum(IIf(([TransformerInstallDate]&gt;=#\" &amp; DryStartDate &amp; \"# And [TransformerInstallDate]&lt;=#\" &amp; DryEndDate &amp; \"#) And (([CurrentLevelOfCompletion]&gt;=1365 And [CurrentLevelOfCompletion]&lt;1073743189)),1,0)) AS [Transformer Installation]\" &amp; _\n                    \" FROM TR343DrySide\" &amp; _\n                    \" WHERE (([TransducerSN] Like \"\"CR*\"\"))\" &amp; _\n                    vbCrLf &amp; \" UNION SELECT 2, 'Failed - New' AS QRY, Sum(IIf(([PreStressStackDate]&gt;=#\" &amp; DryStartDate &amp; \"# And [PreStressStackDate]&lt;=#\" &amp; DryEndDate &amp; \"#)\" &amp; _\n                    \" And [CurrentLevelOfCompletion]=1073741829),1,0)) AS [PreStress Stackup], Sum(IIf(([StackCompressionDate]&gt;=#\" &amp; DryStartDate &amp; \"#\" &amp; _\n                    \" And [StackCompressionDate]&lt;=#\" &amp; DryEndDate &amp; \"#) And [CurrentLevelOfCompletion]=1073741845,1,0)) AS [Stack Compression],\" &amp; _\n                    \" Sum(IIf(([TestingDate]&gt;=#\" &amp; DryStartDate &amp; \"# And [TestingDate]&lt;=#\" &amp; DryEndDate &amp; \"#) And [CurrentLevelOfCompletion]=1073741909,1,0)) AS [Testing],\" &amp; _\n                    \" Sum(IIf(([ShroudAssemblyDate]&gt;=#\" &amp; DryStartDate &amp; \"# And [ShroudAssemblyDate]&lt;=#\" &amp; DryEndDate &amp; \"#) And ([CurrentLevelOfCompletion]=1073742165 Or\" &amp; _\n                    \" [CurrentLevelOfCompletion]=1073742165),1,0)) AS [Shroud Assembly], Sum(IIf(([TransformerInstallDate]&gt;=#\" &amp; DryStartDate &amp; \"# And [TransformerInstallDate]&lt;=#\" &amp; DryEndDate &amp; \"#)\" &amp; _\n                    \" And [CurrentLevelOfCompletion]=1073743189,1,0)) AS [Transformer Installation]\" &amp; _\n                    \" FROM TR343Dryside\" &amp; _\n                    \" WHERE (([TransducerSN] Like \"\"CR*\"\"));\"\n\n\n\n\n\n    Me.sfrmCraneDrySidePassFailDateRange_New.Form.RecordSource = strDrySQL_New\n    Me.sfrmCraneDrySidePassFailDateRange_New.Visible = True\n\n End If\nEnd Sub\n</code></pre>\n\n<blockquote>\n  <p>The result when the query is activated is: Run-time error '3319':\n  Syntax error within union query.</p>\n</blockquote>\n\n<p>The problem is raised within the line of: \n    Me.sfrmCraneDrySidePassFailDateRange_New.Form.RecordSource = strDrySQL_New</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "edited": false, "score": 0, "creation_date": 1542807674, "post_id": 53412799, "comment_id": 93701191, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/32590616/excel-is-not-updating-cells-options-formula-workbook-calculation-set-to-aut\">Excel is not updating cells, options &gt; formula &gt; workbook calculation set to automatic</a>"}, {"owner": {"reputation": 103, "user_id": 10265592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f8420e6695c8dadf0a29bd59cde88ee?s=128&d=identicon&r=PG&f=1", "display_name": "n4pster", "link": "https://stackoverflow.com/users/10265592/n4pster"}, "reply_to_user": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "edited": false, "score": 0, "creation_date": 1542808339, "post_id": 53412799, "comment_id": 93701650, "body": "CTRL+SHIFT+ALT+F9 does not work unfortunately"}, {"owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "edited": false, "score": 0, "creation_date": 1542810948, "post_id": 53412799, "comment_id": 93703166, "body": "What about just <code>F9</code> on its own? If it works, be prepared for a long recalculation time. Alternatively, try putting <code>Application.Calculate</code> in/after the relevant line in your macro."}, {"owner": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "edited": false, "score": 0, "creation_date": 1542811311, "post_id": 53412799, "comment_id": 93703391, "body": "Yeah, was wondering about <code>F9</code>, too. If that works, there are probably some formulae referencing cells on other sheets that are themselves <code>dirty</code> but not reevaluated by <code>Shift+F9</code>. Although <code>Ctrl+Shift+Alt+F9</code> should have solved that issue... We&#39;re stabbing in the dark here."}, {"owner": {"reputation": 103, "user_id": 10265592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f8420e6695c8dadf0a29bd59cde88ee?s=128&d=identicon&r=PG&f=1", "display_name": "n4pster", "link": "https://stackoverflow.com/users/10265592/n4pster"}, "edited": false, "score": 0, "creation_date": 1542815125, "post_id": 53412799, "comment_id": 93705741, "body": "F9 doesn&#39;t work either - no idea why. Peculiarly when I open an empty new workbook, keep the manual calculating settings, and perform some simple calculations SHIFT+F9 does not work either. Only when the option is back on Automatic calculations. No idea whats going on?"}], "answers": [{"tags": [], "owner": {"reputation": 3207, "user_id": 1915920, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/6be77f4bfa373c33055ada8f3414ae09?s=128&d=identicon&r=PG", "display_name": "Andreas Covidiot", "link": "https://stackoverflow.com/users/1915920/andreas-covidiot"}, "is_accepted": false, "score": 0, "last_activity_date": 1560275758, "creation_date": 1560275758, "answer_id": 56549313, "question_id": 53412799, "link": "https://stackoverflow.com/questions/53412799/excel-with-vba-workbook-calculations-on-manual-shift-f9-does-not-work/56549313#56549313", "title": "Excel with VBA, Workbook calculations on Manual, shift-F9 does not work", "body": "<p>creating or moving some/all reference containing worksheets (out and) into your workbook may solve it.\nMore details here: <a href=\"https://stackoverflow.com/a/56549247/1915920\">https://stackoverflow.com/a/56549247/1915920</a></p>\n"}], "owner": {"reputation": 103, "user_id": 10265592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f8420e6695c8dadf0a29bd59cde88ee?s=128&d=identicon&r=PG&f=1", "display_name": "n4pster", "link": "https://stackoverflow.com/users/10265592/n4pster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 747, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1560275758, "creation_date": 1542805815, "question_id": 53412799, "link": "https://stackoverflow.com/questions/53412799/excel-with-vba-workbook-calculations-on-manual-shift-f9-does-not-work", "title": "Excel with VBA, Workbook calculations on Manual, shift-F9 does not work", "body": "<p>I have a large excel file with vba codes. When opening the file, excel automatically started calculating, hence it took minutes to even open the file. I set the workbook calculations in File/Options to Manual which solved the problem. However, when I run the macro now, it does not update the cells. Instead it puts the correct formulas in each cell without calculating to find the right value. </p>\n\n<p>Strangely, Shift F9 does not work anymore. Yet when I go to one of the cells and press F2+ENTER the correct value is displayed.</p>\n\n<p>Any idea how I can solve this issue?</p>\n"}, {"tags": ["excel", "vba", "function", "nested"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1542806111, "post_id": 53412766, "comment_id": 93700257, "body": "You are probably looking for the <code>LOOKUP</code> function then, if you want the value instead of the row number?"}], "answers": [{"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1542807737, "post_id": 53413270, "comment_id": 93701238, "body": "At least 2 double quotes <code>&quot;</code> are missing somewhere in your code."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1542821088, "post_id": 53413270, "comment_id": 93709308, "body": "@P\u1d07\u029c changed it up to be more useful and all fit within VBA, not pasting a formula."}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": 1, "last_activity_date": 1542821054, "last_edit_date": 1542821054, "creation_date": 1542807365, "answer_id": 53413270, "question_id": 53412766, "link": "https://stackoverflow.com/questions/53412766/excel-vba-extract-values-from-nested-function/53413270#53413270", "title": "Excel VBA extract values from nested function", "body": "<p>As I'm not quite following what you're saying, I'll take a guess... you want to use the match() scenario separately?</p>\n\n<pre><code>dim x as long, y as long, z as string\nx = application.match($A\" &amp; ActiveCell &amp; \",Sheet3!$A$5:$A$15,0)\"\ny = x*3 'perform some work using the row number x, knowing match of 1 = row 5 on sheet3\nz = application.index(Sheet3!$B$5:$I$15,\" &amp; y &amp; \")\"\n</code></pre>\n\n<p>Took that a step further where you can utilize said arithmetic'd match value.</p>\n\n<hr>\n\n<p>Inherently, the match only provides a row number from your array, so i don't know what the \"extract\" you are referring to would be.  If you are looking to extract a value that you're matching to, then you'll just end up with what is (from your example) in A6.</p>\n\n<hr>\n\n<p><strong>Edit:</strong> Updating code to be usable (previously just gave a concept)</p>\n\n<pre><code>dim x as long, y as long, z as string\nwith sheets(\"Sheets3\")\n    x = application.match(ActiveCell.value,.range(.cells(5,\"A\"),.cells(15,\"A\")),0)\n    y = x*1 'perform some work using the row number x, knowing match of 1 = row 5 on sheet3\n    z = application.index(.range(.cells(5,\"B\"),.cells(15,\"B\")),y)  'This index was changed to be a SINGLE COLUMN (was B5:I15)\nend with\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10685494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a80381c3ec2d9fb6a82e877b86cc2105?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/10685494/jonathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1583491623, "creation_date": 1542805716, "last_edit_date": 1583491623, "question_id": 53412766, "link": "https://stackoverflow.com/questions/53412766/excel-vba-extract-values-from-nested-function", "title": "Excel VBA extract values from nested function", "body": "<p>Is it possible to extract the resulting value of a nested sub-function in VBA?</p>\n\n<p>For example, from this INDEX-MATCH look-up function, I would like to find the value from the results from the two <code>MATCH()</code> functions:</p>\n\n<pre><code>=+INDEX(Sheet3!$B$5:$I$15;MATCH($A6;Sheet3!$A$5:$A$15;0);1)\n</code></pre>\n\n<p>I am looking for a macro that can return the value of the nested <code>MATCH()</code> function as an input in a VBA code. That is, I realize I could extract the <code>MATCH()</code> subfunction and have VBA paste it as a value. What I want is identify the value of the <code>MATCH()</code> function and calculate with it within my VBA script.</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1542805851, "post_id": 53412695, "comment_id": 93700105, "body": "just use listbox <code>on change</code> event to update the hidden textbox?"}], "answers": [{"comments": [{"owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 0, "creation_date": 1542811637, "post_id": 53412943, "comment_id": 93703572, "body": "@ Erik - I&#39;m not sure if you are suggesting setting <code>Me.Dirty = True</code> , I didn&#39;t think this was possible ? I thought you had to alter the forms data to force that change?"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 0, "creation_date": 1542812085, "post_id": 53412943, "comment_id": 93703855, "body": "@Minty Nope, you can test it if you don&#39;t take my word for it. Add an event handler to the before update event of a bound form, and run <code>Me.Dirty = True</code> and then <code>DoCmd.GoToRecord</code> (that&#39;s the next record by default). The event handler will fire, even though you haven&#39;t changed a thing. The record selector also changes to the edit pencil after executing <code>Me.Dirty = True</code>."}, {"owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 0, "creation_date": 1542813716, "post_id": 53412943, "comment_id": 93704906, "body": "@ Erik - I believe you ! I&#39;m sure I had read somewhere that it was only able to be set to False. But that doesn&#39;t make sense as it&#39;s a &quot;normal&quot; property."}, {"owner": {"reputation": 18, "user_id": 2399162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc383733d112681574a3453fd1fd7370?s=128&d=identicon&r=PG", "display_name": "Mark S.", "link": "https://stackoverflow.com/users/2399162/mark-s"}, "edited": false, "score": 0, "creation_date": 1542824587, "post_id": 53412943, "comment_id": 93710883, "body": "I&#39;m still trying to get some time today for this, but it appears the solution is to use the Listbox&#39;s on Exit event to parse the list values to the text box, the the Form&#39;s Current event to parse from textbox to listbox.  The solutions above made me stop thinking of Form events only, and consider a control event to meet my needs."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1542825007, "post_id": 53412943, "comment_id": 93711045, "body": "Note that parsing on the listbox exit event is suboptimal, closing the form while the listbox has focus can cause that event not to fire, and entering and exiting the listbox repetitively causes you to parse it each time. As said, I recommend parsing only when values are actually getting committed (so on update/insert) and dirtying as soon as a value changes."}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": false, "score": 1, "last_activity_date": 1542806292, "creation_date": 1542806292, "answer_id": 53412943, "question_id": 53412695, "link": "https://stackoverflow.com/questions/53412695/what-event-is-fired-when-access-is-leaving-one-record-and-moving-to-next/53412943#53412943", "title": "What Event is fired when Access is leaving one record and moving to next?", "body": "<p>If you want to parse a field and manually update it to a table, use the <em>Before Insert</em> and <em>Before Update</em> events. Don't do anything with navigation, because then you're likely too late.</p>\n\n<p>Also, make sure to dirty the form when the value of the list box changes (<code>Me.Dirty = True</code> in the <em>On Change</em> event), so the update fires when navigating.</p>\n\n<p>Or, like krish KM says, just make sure your text box changes every time your listbox changes.</p>\n\n<p>That's more reliable than accounting for navigation, filtering, closing the form, manually saving, etc.</p>\n"}], "owner": {"reputation": 18, "user_id": 2399162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc383733d112681574a3453fd1fd7370?s=128&d=identicon&r=PG", "display_name": "Mark S.", "link": "https://stackoverflow.com/users/2399162/mark-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1726, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542806880, "creation_date": 1542805496, "last_edit_date": 1542806880, "question_id": 53412695, "link": "https://stackoverflow.com/questions/53412695/what-event-is-fired-when-access-is-leaving-one-record-and-moving-to-next", "title": "What Event is fired when Access is leaving one record and moving to next?", "body": "<p>I am developing a MS Access 2016 application with bound controls on Forms.  Late in the process I decided I want a multi-select listbox.  </p>\n\n<p>From what I can see, you can't bind a multi-select listbox to a table.   I'm okay with parsing the listbox when about to leave that record, and putting a comma separated list of values in a bound, non-visible text box.  And then on arriving at the new record, setting the values in the listbox based on the values in that record's textbox.</p>\n\n<p>The Current event lets me know when I arrive at a new record, but is there an event that lets me know I'm leaving a record?  Before Update only works if the current record is changed, not just navigating to a new record.  I suspect I'm missing something real basic.</p>\n"}, {"tags": ["excel", "vba", "odbc", "adodb"], "comments": [{"owner": {"reputation": 1, "user_id": 4918000, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-VTl2nABC9-g/AAAAAAAAAAI/AAAAAAAAACY/SfHkh9iekns/photo.jpg?sz=128", "display_name": "Tevo Saks", "link": "https://stackoverflow.com/users/4918000/tevo-saks"}, "edited": false, "score": 0, "creation_date": 1543389173, "post_id": 53412502, "comment_id": 93896957, "body": "Not sure how stack overflow works, do I have to bump? And what does score -1 mean? I need to explain something more? Or excel can not establish odbc databse connection objects?"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 4918000, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-VTl2nABC9-g/AAAAAAAAAAI/AAAAAAAAACY/SfHkh9iekns/photo.jpg?sz=128", "display_name": "Tevo Saks", "link": "https://stackoverflow.com/users/4918000/tevo-saks"}, "is_accepted": false, "score": 0, "last_activity_date": 1545238860, "creation_date": 1545238860, "answer_id": 53855960, "question_id": 53412502, "link": "https://stackoverflow.com/questions/53412502/how-to-connect-to-odcb-database-with-excel-vbs/53855960#53855960", "title": "How to connect to odcb database with excel vbs", "body": "<p>Money solves problems :)</p>\n\n<p>I didn't use the correct database name and did not use DSN.\nAlso using a specific driver was not a good idea.\nEven the server aadress was not needed.</p>\n\n<p>Here is the solution:</p>\n\n<pre><code>Sub test_connection()\n  Dim oConn As New ADODB.Connection\n  Dim strUsername As String\n  Dim strPassword As String\n  Dim strDatabase As String\n\n  strUsername = \"Mikk\"\n  strPassword = \"****\"\n  strDatabase = \"test\"\n\n  oConn.Open \"DSN=testServer;\" &amp; _\n    \"Database=\" &amp; strDatabase &amp; \";\" &amp; _\n    \"Uid=\" &amp; strUsername &amp; \";\" &amp; _\n    \"Pwd=\" &amp; strPassword\n\n  oConn.Close\n  Set oConn = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4918000, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-VTl2nABC9-g/AAAAAAAAAAI/AAAAAAAAACY/SfHkh9iekns/photo.jpg?sz=128", "display_name": "Tevo Saks", "link": "https://stackoverflow.com/users/4918000/tevo-saks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1545238931, "creation_date": 1542804910, "last_edit_date": 1545238931, "question_id": 53412502, "link": "https://stackoverflow.com/questions/53412502/how-to-connect-to-odcb-database-with-excel-vbs", "title": "How to connect to odcb database with excel vbs", "body": "<p>thx to google I figured out a lot of weird tricks you can do to connect to simple SQL server or SAP database and such. However, no matter how hard I try I can not create odbc object.</p>\n\n<p>I can pull odbc database to excel, but this is not what I want to do.\nI want to use INSERT and DELETE SQL queries.</p>\n\n<p>The simplest line of codes I found were these:</p>\n\n<pre><code>Private Sub ConnectDB()\n    Dim oConn As ADODB.Connection\n\n    Set oConn = New ADODB.Connection\n    oConn.Open \"DRIVER={MySQL ODBC 5.1 Driver};\" &amp; \"SERVER=******.****.**;\" &amp; \"DATABASE=testServer;\" &amp; \"USER=Mikk;\" &amp; \"PASSWORD=**;\" &amp; \"Option=3\"\nEnd Sub\n</code></pre>\n\n<p>I have ticked the box for ActiveX data object 2.8 Library</p>\n\n<p>I get run-time error '-2147467259 (80004005)\nAutomation error\nUnspecified error</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 3, "creation_date": 1542805347, "post_id": 53412492, "comment_id": 93699861, "body": "Use &amp; to concatenate strings in VBA. I can run the following for example: Debug.Print &quot;text?text&quot; &amp; &quot;/#&quot; &amp; &quot;text&quot;"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1542805452, "post_id": 53412492, "comment_id": 93699915, "body": "The <code>+</code> sign makes VBA to try to calculate with <code>&quot;&#47;#&quot;</code> like it was a number and this results in a strange behavior here."}], "answers": [{"comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1542807028, "post_id": 53412807, "comment_id": 93700802, "body": "@P\u1d07\u029c  I did miss the change...................I fixed it now ............. <b>Thanks for the help</b>"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 2, "last_activity_date": 1542806978, "last_edit_date": 1542806978, "creation_date": 1542805851, "answer_id": 53412807, "question_id": 53412492, "link": "https://stackoverflow.com/questions/53412492/vba-removes-slashes/53412807#53412807", "title": "VBA removes slashes", "body": "<p>Something like:</p>\n\n<pre><code>Sub dural()\n    Dim LArray(0 To 1) As String\n    Dim adding As String, LArrayNew(0 To 1) As String\n\n    adding = \"X\"\n    LArrayNew(1) = \"New\"\n    LArray(0) = \"0\"\n    iRow = 1\n\n    Sheets(\"Output\").Cells(iRow, 1).Value = LArray(0) &amp; \"?\" &amp; adding &amp; \"/#\" &amp; LArrayNew(1)\nEnd Sub\n</code></pre>\n\n<p>will produce:</p>\n\n<p><strong>0?X/#New</strong></p>\n\n<p>Note the slash is there!</p>\n\n<p><a href=\"https://i.stack.imgur.com/qeW2p.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qeW2p.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 99, "user_id": 6835542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97b2dff7151ebbec547d967712706ded?s=128&d=identicon&r=PG&f=1", "display_name": "O.Poklev", "link": "https://stackoverflow.com/users/6835542/o-poklev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 53412807, "answer_count": 1, "score": 3, "last_activity_date": 1542806978, "creation_date": 1542804864, "question_id": 53412492, "link": "https://stackoverflow.com/questions/53412492/vba-removes-slashes", "title": "VBA removes slashes", "body": "<p>I am new to VBA in excel. So, i create a string from multiple parts and output it in a cell on some sheet like this:</p>\n\n<pre><code>Sheets(\"Output\").Cells(iRow, 1).Value = LArray(0) + \"?\" + adding + \"/#\" + LArrayNew(1)\n</code></pre>\n\n<p>I am expecting: <code>text?text/#text</code> \nBut result on excel sheet is: <code>text?text#text</code> </p>\n\n<p>Where is the \"/\"?</p>\n"}, {"tags": ["excel", "vba", "variables"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 3, "creation_date": 1542804944, "post_id": 53412341, "comment_id": 93699631, "body": "This is entirely a matter of opinion. Though in this case you almost certainly should (IMO!) use an object variable because it will make the error handling cleaner."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1542805087, "post_id": 53412341, "comment_id": 93699722, "body": "The only difference it makes may be the readability of the code. Code that is easier to read is better maintainable and leads into less errors. Sometimes it&#39;s better to keep the code short. Sometimes it&#39;s better to write a bit more for better understanding. Depends on you."}], "answers": [{"tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 2, "last_activity_date": 1542807840, "creation_date": 1542807840, "answer_id": 53413445, "question_id": 53412341, "link": "https://stackoverflow.com/questions/53412341/why-should-i-not-turn-certain-object-references-into-an-object-variable-what-ar/53413445#53413445", "title": "Why should I not turn certain object references into an object variable? What are the guidelines?", "body": "<p>You <strong><em>are</em></strong> getting a reference to a <code>Range</code> variable - it is just held by the <code>With</code> block itself.  <a href=\"https://msdn.microsoft.com/en-us/library/ee199337.aspx\" rel=\"nofollow noreferrer\">5.4.2.21</a> of the language specification explains:</p>\n\n<blockquote>\n  <p>The With block variable is classified as a variable and has the same\n  declared type as &lt;expression>.</p>\n</blockquote>\n\n<p>At runtime, this is what happens:</p>\n\n<blockquote>\n  <p>If the value type of the evaluated expression is a class, it is\n  <strong>Set</strong>-assigned to an anonymous <em>With</em> block variable. Then,\n  &lt;statement-block> is executed. After &lt;statement-block> executes,\n  <strong>Nothing</strong> is assigned to the anonymous <em>With block variable</em>.</p>\n</blockquote>\n\n<p>Functionally, this code from your example...</p>\n\n<blockquote>\n<pre><code>For Each ws In wsc\n    With ws.Cells.SpecialCells(xlCellTypeFormulas) \n        .Style = \"Currency\"\n        .Font.Bold = True\n        .Interior.Color = 4908260\n    End With\nNext ws\n</code></pre>\n</blockquote>\n\n<p>...is exactly the same as this:</p>\n\n<pre><code>For Each ws In wsc\n    Dim WithBlockVariable As Range\n    Set WithBlockVariable = ws.Cells.SpecialCells(xlCellTypeFormulas)\n    WithBlockVariable.Style = \"Currency\"\n    WithBlockVariable.Font.Bold = True\n    WithBlockVariable.Interior.Color = 4908260\n    Set WithBlockVariable = Nothing\nNext ws\n</code></pre>\n\n<hr>\n\n<p>As far as which you should use, that's pretty much a judgement call. As pointed out in the comments, the <code>With</code> block can be much more readable that a local variable. The other consideration is that since the reference is implicit, you can't accidentally use it after the <code>With</code> block exits. This can be important in your example specifically, because declared variables always have procedure scope. That means in the expanded example, you could use <code>WithBlockVariable</code> <em>outside the loop</em>. So, if you don't <em>intend</em> to use it outside the block, you might as well make it <strong><em>impossible</em></strong> to use outside the block.</p>\n\n<hr>\n\n<p>One last thing to note (and this is where people can get into performance problems) is that <code>With</code> blocks can save de-referencing operations if you find yourself repeatedly using more than one <code>.</code> in expressions. For example, if you're setting more than one of the properties on the <code>Font</code>:</p>\n\n<pre><code>With ws.Cells(1, 1)\n    .Font.Bold = True\n    .Font.Color = vbRed\n    .Font.Italic = True\nEnd With\n</code></pre>\n\n<p>In this case, there's absolutely no reason to get an explicit reference to the <code>Font</code>, but notice that you're repeatedly calling the <code>Range.Font</code> property. This is always better:</p>\n\n<pre><code>With ws.Cells(1, 1).Font\n    .Bold = True\n    .Color = vbRed\n    .Italic = True\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 283, "user_id": 10239691, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lqDop.jpg?s=128&g=1", "display_name": "GeekyFreaky", "link": "https://stackoverflow.com/users/10239691/geekyfreaky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1542807840, "creation_date": 1542804359, "last_edit_date": 1542804838, "question_id": 53412341, "link": "https://stackoverflow.com/questions/53412341/why-should-i-not-turn-certain-object-references-into-an-object-variable-what-ar", "title": "Why should I not turn certain object references into an object variable? What are the guidelines?", "body": "<p>Inside my loop (see code below), why should I NOT turn the <code>ws.Cells.SpecialCells(xlCellTypeFormulas)</code> reference into a <code>Range</code> object variable? (Based on good coding habits, are we not supposed to turn all Range, Worksheet, and Workbook object references into object variables? Regardless if they are used once or many times?)</p>\n\n<p>I did try it with success but I have this feeling I shouldn't but I don't know exactly why which leads me to ask for specific reasons. </p>\n\n<pre><code>Sub FormatAllFormulas()\n    Dim ws As Worksheet\n    Dim wsc As Sheets\n\n    Set wsc = ActiveWorkbook.Worksheets\n\n    For Each ws In wsc\n        With ws.Cells.SpecialCells(xlCellTypeFormulas) \n            .Style = \"Currency\"\n            .Font.Bold = True\n            .Interior.Color = 4908260\n        End With\n    Next ws\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "edited": false, "score": 0, "creation_date": 1542815320, "post_id": 53412322, "comment_id": 93705861, "body": "The Value of a TextBox is always a string"}], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 10446928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd86e8e0ad1277b0d470716169d9647f?s=128&d=identicon&r=PG&f=1", "display_name": "abcdefg12345", "link": "https://stackoverflow.com/users/10446928/abcdefg12345"}, "edited": false, "score": 0, "creation_date": 1542806087, "post_id": 53412401, "comment_id": 93700246, "body": "Hmm I&#39;m getting the same issue whether the public variables are declared in the module or userform or both"}, {"owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "reply_to_user": {"reputation": 77, "user_id": 10446928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd86e8e0ad1277b0d470716169d9647f?s=128&d=identicon&r=PG&f=1", "display_name": "abcdefg12345", "link": "https://stackoverflow.com/users/10446928/abcdefg12345"}, "edited": false, "score": 0, "creation_date": 1542808990, "post_id": 53412401, "comment_id": 93702043, "body": "@abcdefg12345, The public variables must be declared in the module only, then it works well."}, {"owner": {"reputation": 77, "user_id": 10446928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd86e8e0ad1277b0d470716169d9647f?s=128&d=identicon&r=PG&f=1", "display_name": "abcdefg12345", "link": "https://stackoverflow.com/users/10446928/abcdefg12345"}, "edited": false, "score": 0, "creation_date": 1542815742, "post_id": 53412401, "comment_id": 93706150, "body": "Thanks. I was getting confused because I had a couple of subs on top of the lines calling the public variables, but then I put the lines calling the public variables at the very top of the module and it ended up working."}], "tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": true, "score": 1, "last_activity_date": 1542804558, "creation_date": 1542804558, "answer_id": 53412401, "question_id": 53412322, "link": "https://stackoverflow.com/questions/53412322/vba-how-to-pass-userform-variables-to-subroutine/53412401#53412401", "title": "VBA how to pass userform variables to subroutine", "body": "<p>Do like this. Put your public variable  in the module code.</p>\n\n<pre><code>Public a As String\nPublic b As Double\nPublic c As String\n\nPublic Sub Login()\n'in module\n    UserForm1.Show\n    MsgBox (a)\n    MsgBox (b)\n    MsgBox (c)\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1063, "user_id": 8019379, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ZcQhe.png?s=128&g=1", "display_name": "Lucas Raphael Pianegonda", "link": "https://stackoverflow.com/users/8019379/lucas-raphael-pianegonda"}, "is_accepted": false, "score": 0, "last_activity_date": 1542808040, "last_edit_date": 1542808040, "creation_date": 1542807279, "answer_id": 53413242, "question_id": 53412322, "link": "https://stackoverflow.com/questions/53412322/vba-how-to-pass-userform-variables-to-subroutine/53413242#53413242", "title": "VBA how to pass userform variables to subroutine", "body": "<p>I was developing a user application with the same problems as you face now and <a href=\"https://stackoverflow.com/questions/47288496/are-there-disadvantages-in-putting-code-into-userforms-instead-of-modules\">here is the answer I got there.</a></p>\n\n<p>Please check the link above because Mat's Mugs explanations are beyond my capabilities to explain the topic. But here is an abbreviation.</p>\n\n<p>Basically what you do is the following. You have three classes: a model, a view and a presenter class. This sounds super complicated but really is not as difficult once you get the hang of it.</p>\n\n<p><strong>The Model</strong></p>\n\n<p>Is a class module where all your data is stored. So instead of declaring a bunch of public varibales you have one big class that stores all data. You can also have multiple model classes and classes as classmembers but for simplicity we only take the mentioned three integers.</p>\n\n<p>Here is an example of a <code>model</code> class: ( put all of it in a class module called <code>model</code>)</p>\n\n<pre><code>   Option Explicit\n\n    ' encapsulated data\n    Private Type TModel\n        a As Integer\n        b As Integer\n        c As Integer\n    End Type\n\n    Private this As TModel\n\n    ' property get and property let define the way you can interact with data\n    Public Property Get a() As String\n         a = this.a\n    End Property\n    Public Property Let a(ByVal value As String)\n         this.a = value\n    End Property\n\n    Public Property Get b() As String\n         b = this.b\n    End Property\n    Public Property Let b(ByVal value As String)\n         this.b = value\n    End Property\n\n    Public Property Get c() As String\n         c = this.c\n    End Property\n    Public Property Let c(ByVal value As String)\n         this.c = value\n    End Property\n</code></pre>\n\n<p><strong>The View</strong></p>\n\n<p>This is your Userform. But your UserForm is a class again so you but besides all other code you have this code in:</p>\n\n<pre><code>Private Type TView\n    M As Model\n    IsCancelled As Boolean\n    IsBack As Boolean\nEnd Type\n\nPrivate this As TView\n\nPublic Property Get Model() As Model\n    Set Model = this.M\nEnd Property\n\nPublic Property Set Model(ByVal value As UImodel)\n    Set this.M= value\n    'Validate\nEnd Property\n\n' This is responsible for not destroying all data you have when you x-out the userform\nPublic Property Get IsCancelled() As Boolean\n    IsCancelled = this.IsCancelled\nEnd Property\n\nPrivate Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)\n    If CloseMode = VbQueryClose.vbFormControlMenu Then\n        this.IsCancelled=True\n        Cancel = True\n        OnCancel\n    End If\nEnd Sub\n\nPrivate Sub OKButton_Click()\n    Model.a = TextBox1.value\n    Model.b = TextBox2.value\n    Model.c = TextBox3.value\n\n    Cells(1, 1).value = Model.a\n    Cells(2, 1).value = Model.b\n    Cells(3, 1).value = Model.c\n    'this displays the inputs properly\n    Me.Hide\nEnd Sub\n</code></pre>\n\n<p><strong>The Presenter</strong></p>\n\n<p>This is a normal module. Where you simple put your code where you use the stuff in. So for your example code like this:</p>\n\n<pre><code>Public Sub Login()\n'in module\nDim Ufrm As New UserForm1\nDim M As New Model\n\n    Set Ufrm.Model = M\n    Ufrm.Show\n    If Ufrm.IsCancelled Then Exit Sub\n    Set M = Ufrm.Model\n\n    MsgBox M.a\n    MsgBox M.b\n    MsgBox M.c\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 10446928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd86e8e0ad1277b0d470716169d9647f?s=128&d=identicon&r=PG&f=1", "display_name": "abcdefg12345", "link": "https://stackoverflow.com/users/10446928/abcdefg12345"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2412, "favorite_count": 0, "accepted_answer_id": 53412401, "answer_count": 2, "score": 2, "last_activity_date": 1583491635, "creation_date": 1542804281, "last_edit_date": 1583491635, "question_id": 53412322, "link": "https://stackoverflow.com/questions/53412322/vba-how-to-pass-userform-variables-to-subroutine", "title": "VBA how to pass userform variables to subroutine", "body": "<p>I am trying to use a subroutine call a variable from a userform input.\nBut, even though I can display the userform inputs correctly in the userform by printing it to the sheet, I can't seem to pass it as a public variable to the subroutine. When I call the variables in the subroutine, they are all empty. </p>\n\n<p>I was using this as a guide:\n<a href=\"https://stackoverflow.com/questions/20214072/passing-variable-from-form-to-module-in-vba\">Passing variable from Form to Module in VBA</a></p>\n\n<p>Here is my code: </p>\n\n<pre><code>Public a As String\nPublic b As Double\nPublic c As String\n\nPrivate Sub OKButton_Click()\n'from userform\n    a = TextBox1.Value\n    b = TextBox2.Value\n    c = TextBox3.Value\n\n    Cells(1, 1).Value = a\n    Cells(2, 1).Value = b\n    Cells(3, 1).Value = c\n    'this displays the inputs properly\n    Unload UserForm1\nEnd Sub\n</code></pre>\n\n<p>And in the module:</p>\n\n<pre><code>Public Sub Login()\n'in module\n    UserForm1.Show\n    MsgBox (a)\n    MsgBox (b)\n    MsgBox (c)\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11, "user_id": 10685714, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4u9C034U--w/AAAAAAAAAAI/AAAAAAAAACU/arOzmPdbWmU/photo.jpg?sz=128", "display_name": "Meddy_Coder", "link": "https://stackoverflow.com/users/10685714/meddy-coder"}, "edited": false, "score": 0, "creation_date": 1542804813, "post_id": 53412300, "comment_id": 93699567, "body": "I also thought it might be related to the absolute values of the date and time, so I printed them out: for the last &quot;right&quot; Patient ID, the date value is 43221.8625; for the next &quot;error&quot; Patient ID, the date value is 43224.44653. Both within the max and min values of an Integer type."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1542805667, "post_id": 53412300, "comment_id": 93700014, "body": "Note that you cannot use <code>Integer</code> for row counting variables. Excel has more rows than <code>Integer</code> can handle. Always use <code>Long</code> instead. It is recommended <a href=\"https://stackoverflow.com/a/26409520/3219613\">always to use Long instead of Integer</a> in VBA since there is no benefit in using <code>Integer</code> at all."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1542805763, "post_id": 53412300, "comment_id": 93700054, "body": "Why is <code>geburtsdat As Integer</code> and not as <code>date</code>? \u2022 And you should declare a type for your function. Eg if it returns a date use: <code>Function EINSATZ( \u2026 ) As Date</code> in the first line."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1542812095, "post_id": 53412300, "comment_id": 93703861, "body": "Probably not the cause of the error (because you never actually <i>use</i> <code>rsu_r</code> or <code>rsu_c</code>), but you should be using <code>Application.Caller</code> instead of <code>ActiveCell</code>. That said, nothing immediately jumps out (although I <i>suspect</i> it&#39;s an overflow). The best way to find your issue is to have a test <code>Sub</code> call the function with the same parameters that fail on the worksheet. That will get you into a debugger when the error is thrown."}], "owner": {"reputation": 11, "user_id": 10685714, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4u9C034U--w/AAAAAAAAAAI/AAAAAAAAACU/arOzmPdbWmU/photo.jpg?sz=128", "display_name": "Meddy_Coder", "link": "https://stackoverflow.com/users/10685714/meddy-coder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1542871254, "creation_date": 1542804201, "last_edit_date": 1542871254, "question_id": 53412300, "link": "https://stackoverflow.com/questions/53412300/value-error-in-vba-after-a-specific-date-value", "title": "#VALUE Error in VBA after a specific date value", "body": "<p>I have written some VBA functions (listed in code below)\nI am comparing records from two worksheets using functions to return the related values from one sheet to the other.</p>\n\n<p>The first function, upon which all other functions depend on, returns the Patient ID number. </p>\n\n<p><strong>Criteria to select a Patient ID:</strong> </p>\n\n<blockquote>\n  <p>The function compares date and time of patient arrival within a 30\n  minute interval (since the information recieved from one source\n  usually varies by a few minutes from the other), gender, clinic ID,\n  and birthyear. Patient ID numbers start at around 50000, and go on\n  until around 150000. I need to compare date <em>and</em> time, because from\n  time to time two patients with the same gender, birthdate and clinic\n  arrived on the same day.</p>\n</blockquote>\n\n<p><strong>The function fails after 100000's rows\nBeyond this only #VALUE! errors are returned.</strong> </p>\n\n<p><strong>Following is a complex scenario I tested, and found the Date and Time to be at fault.</strong></p>\n\n<blockquote>\n  <ul>\n  <li>Comparing only Date, with no interval, returns a normal value. </li>\n  <li>The last Patient ID to work is 98472 (not all Patient IDs have been reported yet), the Patient has an arrival date of May 1st, 2018 at\n  8:42pm. </li>\n  <li>The next Patient ID is 100471, arriving on the 4th of May, 2018 at 10:43am. * The function returns this Patient as a #VALUE! error,\n  although all parameters are there.</li>\n  </ul>\n</blockquote>\n\n<p>Here is the code (pardon any rookie mistakes, I'm no professional coder):</p>\n\n<pre><code>Function EINSATZ(aufnahmdat As Date, geburtsdat As Integer, geschlecht As Integer, klinik As Integer)\n    'DEFINING PARAMETERS\n    'rsu_r is the regional stroke unit row\n    'rsu_c is the regional stroke unit column\n    'size is the patient list size\n    'iffunction allows the function to work through the patient list\n    'converter converts letter to integer for sex\n\n    Dim rsu_r As Integer\n    Dim rsu_c As Integer\n    Dim size As Variant\n    Dim iffunction As Single\n    Dim converter As Integer\n\n    'here starts the dimension definition for rsu cells\n    rsu_r = ActiveCell.Row\n    rsu_c = ActiveCell.Column\n\n\n    'here starts the size function\n    'size is predetermined to measure and print the highest value within the first 9996 cells\n    For iffunction = 4 To 9999\n        If Application.WorksheetFunction.IsNumber(Worksheets(\"Pr\u00e4klinik\").Cells(iffunction, 5)) Then\n            size = size + 1\n        End If\n    Next iffunction\n\n    'here starts the if function\n    For iffunction = 4 To size        \n        If Worksheets(\"Pr\u00e4klinik\").Cells(iffunction, 6).Value = \"m\" Then\n            converter = 2\n        Else\n            converter = 1\n        End If\n\n        If Worksheets(\"Pr\u00e4klinik\").Cells(iffunction, 4).Value + Worksheets(\"Pr\u00e4klinik\").Cells(iffunction, 17).Value &lt; aufnahmdat + 1 / 48 _\n           And Worksheets(\"Pr\u00e4klinik\").Cells(iffunction, 4).Value + Worksheets(\"Pr\u00e4klinik\").Cells(iffunction, 17).Value &gt; aufnahmdat - 1 / 48 _\n           And Worksheets(\"Pr\u00e4klinik\").Cells(iffunction, 5).Value = geburtsdat _\n           And converter = geschlecht _\n           And Worksheets(\"Pr\u00e4klinik\").Cells(iffunction, 41).Value = klinik Then\n            EINSATZ = Worksheets(\"Pr\u00e4klinik\").Cells(iffunction, 2).Value\n            Exit For\n        End If\n    Next iffunction      \nEnd Function\n</code></pre>\n\n<p>Please help me diagnose the actual cause of error!</p>\n"}, {"tags": ["ms-access", "oracle11g", "vba", "odbc"], "comments": [{"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1542805658, "post_id": 53412247, "comment_id": 93700006, "body": "and the error is? Your <code>strSQL</code> looks invalid. If it works, it&#39;ll only adds one value to your table. No sign related to <code>importing Excel Sheet</code>"}, {"owner": {"reputation": 37, "user_id": 9600149, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-i4lLH--Wpro/AAAAAAAAAAI/AAAAAAAACWE/GHOjIXo72tI/photo.jpg?sz=128", "display_name": "Archana", "link": "https://stackoverflow.com/users/9600149/archana"}, "reply_to_user": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1542862419, "post_id": 53412247, "comment_id": 93722518, "body": "@krishKM the error says Run-time error 91. i read somewhere Insert command would insert the rows in the database."}, {"owner": {"reputation": 37, "user_id": 9600149, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-i4lLH--Wpro/AAAAAAAAAAI/AAAAAAAACWE/GHOjIXo72tI/photo.jpg?sz=128", "display_name": "Archana", "link": "https://stackoverflow.com/users/9600149/archana"}, "reply_to_user": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1542889606, "post_id": 53412247, "comment_id": 93735831, "body": "@krishKM, can you help in this case? I have a access utility that has a button, the expectation is when I hit the import button, the excel file selected in the textbox should import in the oracle database. Let me know if you can help"}, {"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1542889895, "post_id": 53412247, "comment_id": 93735982, "body": "If you are using Ms Acess, you should tag <code>ms-access</code>. In Ms Access, this is pretty much easy. You need to link your oracle table and then using import service import the excel file."}, {"owner": {"reputation": 37, "user_id": 9600149, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-i4lLH--Wpro/AAAAAAAAAAI/AAAAAAAACWE/GHOjIXo72tI/photo.jpg?sz=128", "display_name": "Archana", "link": "https://stackoverflow.com/users/9600149/archana"}, "reply_to_user": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1542890339, "post_id": 53412247, "comment_id": 93736212, "body": "I did tag accessvba, some one edited it."}], "owner": {"reputation": 37, "user_id": 9600149, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-i4lLH--Wpro/AAAAAAAAAAI/AAAAAAAACWE/GHOjIXo72tI/photo.jpg?sz=128", "display_name": "Archana", "link": "https://stackoverflow.com/users/9600149/archana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594626172, "creation_date": 1542804030, "last_edit_date": 1594626172, "question_id": 53412247, "link": "https://stackoverflow.com/questions/53412247/import-excel-file-to-oracle-database", "title": "Import excel file to Oracle database", "body": "<p>I am looking to import an Excel sheet to an Oracle database.</p>\n\n<p>The table has been created and the script needs to pick the Excel file from the textbox, establish odbc and import the file in the database with message box.</p>\n\n<p>I tried to write the script, but I know it needs a change.</p>\n\n<pre><code>Private Sub IMPORT_Click()\n    Dim cn As ADODB.Connection, rs As    ADODB.Recordset\n    Dim fileName As String\n    Me.txtfile = fileName\n    Dim pswd As String, strSQL As String\n    pswd = \"007\"\n    strSQL = \"Insert into xyz(column1) VALUES ('&amp;c2&amp;')\"\n    Set cn = New ADODB.Connection\n    cn.Open \"Driver={Microsoft ODBC for Oracle};\" &amp; _\n    \"SERVER=company.com;User Id=xx;Password=\" &amp; pswd &amp; \";\"\n    cn.Execute strSQL\n    rs.Close\n    Set rs = Nothing\n    cn.Close\n    Set cn = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "answers": [{"comments": [{"owner": {"reputation": 199, "user_id": 8193932, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/823986bc5e1ccdea67d21378d963604a?s=128&d=identicon&r=PG&f=1", "display_name": "surajitM", "link": "https://stackoverflow.com/users/8193932/surajitm"}, "edited": false, "score": 0, "creation_date": 1542804352, "post_id": 53411907, "comment_id": 93699324, "body": "It is basically formula1 / formula2 * 100. If I keep only formula1 or formula2 (including the quotes) alone, it seem to populate the desired cell with the value. However, on trying to use both the formula&#39;s together, it is giving me the error."}, {"owner": {"reputation": 199, "user_id": 8193932, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/823986bc5e1ccdea67d21378d963604a?s=128&d=identicon&r=PG&f=1", "display_name": "surajitM", "link": "https://stackoverflow.com/users/8193932/surajitm"}, "edited": false, "score": 0, "creation_date": 1542818811, "post_id": 53411907, "comment_id": 93708076, "body": "Thanks @Alexey C. Thats what I wanted. :)"}], "tags": [], "owner": {"reputation": 172, "user_id": 10627624, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-q24pnMMCBhM/AAAAAAAAAAI/AAAAAAAAAI0/9V6VmJktiDI/photo.jpg?sz=128", "display_name": "Alexey C", "link": "https://stackoverflow.com/users/10627624/alexey-c"}, "is_accepted": false, "score": 2, "last_activity_date": 1542802833, "creation_date": 1542802833, "answer_id": 53411907, "question_id": 53411534, "link": "https://stackoverflow.com/questions/53411534/vba-type-mismatch-error-with-functionaarray/53411907#53411907", "title": "VBA: type mismatch error with FunctionaArray", "body": "<p>Why u use quotes in formula text before and after \"/\" and \"*\"?</p>\n\n<p>You looking for this formula?</p>\n\n<pre><code>Range(Cells(ActiveCell.Row + 1, ActiveCell.Column), Cells(ActiveCell.Row + 1, _\n        ActiveCell.Column)).FormulaArray _\n        = \"=INDEX(R2C5:R81C10, MATCH(R4C12&amp;R4C13&amp;R3C15,R1C2:R81C2&amp;R1C3:R81C3&amp;R1C4:R81C4,0)-1,MATCH(R4C14,R1C5:R1C10,0))/INDEX(R2C5:R81C10, MATCH(R4C12&amp;R4C13&amp;R3C15,R1C2:R[72]C2&amp;R1C3:R[72]C3&amp;R1C4:R[72]C4,0)-1, 1) * 100\"\n</code></pre>\n"}], "owner": {"reputation": 199, "user_id": 8193932, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/823986bc5e1ccdea67d21378d963604a?s=128&d=identicon&r=PG&f=1", "display_name": "surajitM", "link": "https://stackoverflow.com/users/8193932/surajitm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1583491612, "creation_date": 1542801377, "last_edit_date": 1583491612, "question_id": 53411534, "link": "https://stackoverflow.com/questions/53411534/vba-type-mismatch-error-with-functionaarray", "title": "VBA: type mismatch error with FunctionaArray", "body": "<p>Getting a type mismatch(run time error 13) on this code and I am unable to solve it.</p>\n\n<pre><code>LastWeek = 10\nActiveCell.FormulaR1C1 = LastWeek + 1\nRange(Cells(ActiveCell.Row + 1, ActiveCell.Column), Cells(ActiveCell.Row + 1, _\n        ActiveCell.Column)).FormulaArray _\n        = \"=INDEX(R2C5:R81C10, MATCH(R4C12&amp;R4C13&amp;R3C15,R1C2:R81C2&amp;R1C3:R81C3&amp;R1C4:R81C4,0)-1,MATCH(R4C14,R1C5:R1C10,0))\" / \"=INDEX(R2C5:R81C10, MATCH(R4C12&amp;R4C13&amp;R3C15,R1C2:R[72]C2&amp;R1C3:R[72]C3&amp;R1C4:R[72]C4,0)-1, 1)\" * 100\n</code></pre>\n\n<p>I am stuck with this part for a long time now and out of clue to solve it. Any help will be highly appreciated.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 8752009, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/00ad86e9cced999b851bd5b300bc197b?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Hill", "link": "https://stackoverflow.com/users/8752009/mike-hill"}, "edited": false, "score": 0, "creation_date": 1546212486, "post_id": 53410995, "comment_id": 94801919, "body": "Thank you for your explanation, really helped"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 4, "last_activity_date": 1542803697, "last_edit_date": 1542803697, "creation_date": 1542799173, "answer_id": 53410995, "question_id": 53410859, "link": "https://stackoverflow.com/questions/53410859/can-someone-explain-how-this-excel-2010-or-earlier-password-protector-works/53410995#53410995", "title": "Can someone explain how this Excel 2010 or earlier password protector works", "body": "<p>This will generate multiple 12 character long passwords like <code>AAAAAAAAAAA</code> or <code>AAAAAAAAAABA</code> and so on and try if they work to unprotect the worksheet.</p>\n\n<p>The <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/chr-function\" rel=\"nofollow noreferrer\">Chr function</a> <code>Chr(65)</code> gives you the character with the ASCII code 65 which is an <code>A</code>. So actually the loops produce all permutations of <code>A</code> and <code>B</code> for the first 11 characters and the last loop has some more characters from <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/character-set-0127\" rel=\"nofollow noreferrer\">ASCII 32 to 126</a> for the 12\u1d57\u02b0 character of the password.</p>\n\n<p>Because the old Excel version uses a not secure hash function to store the password there is more than one password to produce the same hash. So that's just a cheap way to find one of the passwords that work.</p>\n\n<p>For more detailed info see: <a href=\"https://www.thespreadsheetguru.com/blog/2014/8/20/understanding-excels-password-security-methodology\" rel=\"nofollow noreferrer\">Understanding Excel's Password Security Methodology</a></p>\n"}], "owner": {"reputation": 103, "user_id": 8752009, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/00ad86e9cced999b851bd5b300bc197b?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Hill", "link": "https://stackoverflow.com/users/8752009/mike-hill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 53410995, "answer_count": 1, "score": 1, "last_activity_date": 1583491648, "creation_date": 1542798648, "last_edit_date": 1583491648, "question_id": 53410859, "link": "https://stackoverflow.com/questions/53410859/can-someone-explain-how-this-excel-2010-or-earlier-password-protector-works", "title": "Can someone explain how this Excel 2010 or earlier password protector works", "body": "<p>Can someone please explain how this works, why do i need counts of 65 to 66, where are there 12 counts and what do all the Chr(variable) give?</p>\n\n<p>I'm not trying to code this, but i did find this on the web when someone asked how to unlock their sheet after they forgot their password. I would like to understand what is actually happening</p>\n\n<pre><code>Sub PasswordBreaker()\n\n    Dim i As Integer, j As Integer, k As Integer\n    Dim l As Integer, m As Integer, n As Integer\n    Dim i1 As Integer, i2 As Integer, i3 As Integer\n    Dim i4 As Integer, i5 As Integer, i6 As Integer\n    On Error Resume Next\n    For i = 65 To 66: For j = 65 To 66: For k = 65 To 66\n    For l = 65 To 66: For m = 65 To 66: For i1 = 65 To 66\n    For i2 = 65 To 66: For i3 = 65 To 66: For i4 = 65 To 66\n    For i5 = 65 To 66: For i6 = 65 To 66: For n = 32 To 126\n    ActiveSheet.Unprotect Chr(i) &amp; Chr(j) &amp; Chr(k) &amp; _\n        Chr(l) &amp; Chr(m) &amp; Chr(i1) &amp; Chr(i2) &amp; Chr(i3) &amp; _\n        Chr(i4) &amp; Chr(i5) &amp; Chr(i6) &amp; Chr(n)\n    If ActiveSheet.ProtectContents = False Then\n        MsgBox \"One usable password is \" &amp; Chr(i) &amp; Chr(j) &amp; _\n            Chr(k) &amp; Chr(l) &amp; Chr(m) &amp; Chr(i1) &amp; Chr(i2) &amp; _\n            Chr(i3) &amp; Chr(i4) &amp; Chr(i5) &amp; Chr(i6) &amp; Chr(n)\n        Exit Sub\n    End If\n    Next: Next: Next: Next: Next: Next\n    Next: Next: Next: Next: Next: Next\nEnd Sub\n</code></pre>\n\n<p>Thank You</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1542808333, "post_id": 53410552, "comment_id": 93701644, "body": "In this case, unless you&#39;re using <code>wsc</code> for something other than the <code>For Each</code> loop, there really isn&#39;t a reason to hold it in a local variable. <code>For Each ws In ActiveWorkbook.Worksheets</code> is probably better in this specific example."}], "answers": [{"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1542798045, "post_id": 53410607, "comment_id": 93696013, "body": "Just for my interest: Do you know why? Is there a reason? Because this looks very strange to me if I ask for <code>Worksheets</code> and I actually get <code>Sheets</code>."}, {"owner": {"reputation": 283, "user_id": 10239691, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lqDop.jpg?s=128&g=1", "display_name": "GeekyFreaky", "link": "https://stackoverflow.com/users/10239691/geekyfreaky"}, "edited": false, "score": 0, "creation_date": 1542798749, "post_id": 53410607, "comment_id": 93696353, "body": "I agree, especially when ActiveWorkbook.Sheets returns Sheets. Logically, you would expect ActiveWorkbook.Worksheets to return Worksheets."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1542799068, "post_id": 53410607, "comment_id": 93696539, "body": "@P\u1d07\u029c Honestly, I don&#39;t know. I can&#39;t think of any reason for it since it only returns the Worksheets in the workbook, not any other type of sheet."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1542803348, "post_id": 53410607, "comment_id": 93698757, "body": "@Rory Well, thanks for the feedback, that&#39;s exactly what I thought. I can&#39;t imagine any reason too."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 2, "last_activity_date": 1542797825, "creation_date": 1542797825, "answer_id": 53410607, "question_id": 53410552, "link": "https://stackoverflow.com/questions/53410552/why-can-i-not-initialize-a-worksheets-object-variable-to-a-worksheets-collection/53410607#53410607", "title": "Why can I not initialize a Worksheets object variable to a Worksheets collection?", "body": "<p><code>ActiveWorkbook.Worksheets</code> returns <code>Sheets</code> not <code>Worksheets</code> so that is the type you should use.</p>\n"}], "owner": {"reputation": 283, "user_id": 10239691, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lqDop.jpg?s=128&g=1", "display_name": "GeekyFreaky", "link": "https://stackoverflow.com/users/10239691/geekyfreaky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 53410607, "answer_count": 1, "score": 2, "last_activity_date": 1551013490, "creation_date": 1542797637, "last_edit_date": 1551013490, "question_id": 53410552, "link": "https://stackoverflow.com/questions/53410552/why-can-i-not-initialize-a-worksheets-object-variable-to-a-worksheets-collection", "title": "Why can I not initialize a Worksheets object variable to a Worksheets collection?", "body": "<p>I understand that it's good coding habit to use object variables. \nI am trying to create an object variable called wsc that will be initialized with an object reference to the active workbook's worksheets collection. See code below.</p>\n\n<p>I tried setting the object variable data type to Worksheets but it did NOT work.\nIt only works when I set the object variable data type to Object. \nThis leads me to ask - is there a data type other than Object that will work in this case?</p>\n\n<pre><code>Sub FormatAllFormulas()\n\n    Dim ws As Worksheet\n    Dim wsc As Object   ' does not work if type is Worksheets - why?\n\n    Set wsc = ActiveWorkbook.Worksheets\n\n    For Each ws In wsc\n        With ws.Cells.SpecialCells(xlCellTypeFormulas)\n            .Style = \"Currency\"\n            .Font.Bold = True\n            .Interior.Color = 4908260\n        End With\n    Next ws\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1542798403, "post_id": 53410543, "comment_id": 93696187, "body": "Use Option Explicit. <code>currentRow</code> and <code>curRow</code>?? Surprised the code doesn&#39;t error but there you go."}, {"owner": {"reputation": 1458, "user_id": 9466677, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "MishD", "link": "https://stackoverflow.com/users/9466677/mishd"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1542798805, "post_id": 53410543, "comment_id": 93696384, "body": "@SJR thanks for raising the error, thanks!!"}], "answers": [{"comments": [{"owner": {"reputation": 1458, "user_id": 9466677, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "MishD", "link": "https://stackoverflow.com/users/9466677/mishd"}, "edited": false, "score": 0, "creation_date": 1542798429, "post_id": 53410733, "comment_id": 93696198, "body": "Getting error on Interset line. &quot;Sub or function is not defined&quot;"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 1458, "user_id": 9466677, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "MishD", "link": "https://stackoverflow.com/users/9466677/mishd"}, "edited": false, "score": 0, "creation_date": 1542798512, "post_id": 53410733, "comment_id": 93696244, "body": "@MonikaRai because it is <code>Intersect</code> not <code>Interset</code>. Check your typo."}, {"owner": {"reputation": 1458, "user_id": 9466677, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "MishD", "link": "https://stackoverflow.com/users/9466677/mishd"}, "edited": false, "score": 1, "creation_date": 1542798755, "post_id": 53410733, "comment_id": 93696357, "body": "@PEh it&#39;s working, though it&#39;s columns, not column. thanks!!"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1542799541, "post_id": 53410733, "comment_id": 93696785, "body": "Please see my comment above."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1542803396, "last_edit_date": 1542803396, "creation_date": 1542798244, "answer_id": 53410733, "question_id": 53410543, "link": "https://stackoverflow.com/questions/53410543/update-the-background-color-index-of-a-range-on-change-event/53410733#53410733", "title": "Update the background color index of a range on Change event", "body": "<p>Use intersect to check if the <code>Target</code> range is in your desired range eg Column A</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Excel.Range)\n    If Not Intersect(Target, Columns(\"A\")) Is Nothing Then\n        If Target.Value &lt;&gt; \"\" Then\n            curRow = Target.Row\n            Target.Parent.Range(\"A\" &amp; curRow &amp; \":AS\" &amp; curRow).Interior.ColorIndex = 15\n                'Target.Interior.ColorIndex = 15\n        End If\n    End If\nEnd Sub\n</code></pre>\n\n<p>Avoid using <code>ActiveSheet</code> use <code>Target.Parent</code> instead. ActiveSheet can be a different sheet and is not necessarily the sheet where target is in.</p>\n\n<p>Alternatively use <code>Target.Resize</code>:</p>\n\n<pre><code>Target.Resize(ColumnSize:=45).Interior.ColorIndex = 15  \n</code></pre>\n\n<p>So you end up with:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Excel.Range)\n    If Not Intersect(Target, Columns(\"A\")) Is Nothing Then\n        If Target.Value &lt;&gt; \"\" Then\n            Target.Resize(ColumnSize:=45).Interior.ColorIndex = 15\n        End If\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1458, "user_id": 9466677, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "MishD", "link": "https://stackoverflow.com/users/9466677/mishd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 53410733, "answer_count": 1, "score": 2, "last_activity_date": 1586802172, "creation_date": 1542797602, "last_edit_date": 1586802172, "question_id": 53410543, "link": "https://stackoverflow.com/questions/53410543/update-the-background-color-index-of-a-range-on-change-event", "title": "Update the background color index of a range on Change event", "body": "<p>Trying to make Excel VBA event which will fire once a value is entered in a range.</p>\n\n<p>So the range in Column A to Column AS. If I enter a value in column A2 it will update the background color index to the range (A2:AS2).</p>\n\n<p>The below code is firing for all the rows and columns.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Excel.Range)\n    If Target.Value &lt;&gt; \"\" Then\n        currentRow = Target.Row\n        ActiveSheet.Range(\"A\" &amp; curRow &amp; \":AS\" &amp; curRow).Interior.ColorIndex = 15\n            'Target.Interior.ColorIndex = 15\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "validation", "ms-access", "matching"], "comments": [{"owner": {"reputation": 1505, "user_id": 5629418, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1027a739f87fcf27a64846508280dab1?s=128&d=identicon&r=PG&f=1", "display_name": "Roland Weber", "link": "https://stackoverflow.com/users/5629418/roland-weber"}, "edited": false, "score": 2, "creation_date": 1542801689, "post_id": 53410108, "comment_id": 93697943, "body": "Please post the code you already have, and point out what exactly isn&#39;t working. Is your code not being called? Is it malfunctioning? Stack Overflow is not a code-writing service, but people here can help you to spot problems."}, {"owner": {"reputation": 25, "user_id": 10122032, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-n-EtXVYMTPc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7ppkC6GS-3wbnksofkN_RLI6KsMEg/mo/photo.jpg?sz=128", "display_name": "XenaD Aux", "link": "https://stackoverflow.com/users/10122032/xenad-aux"}, "reply_to_user": {"reputation": 1505, "user_id": 5629418, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1027a739f87fcf27a64846508280dab1?s=128&d=identicon&r=PG&f=1", "display_name": "Roland Weber", "link": "https://stackoverflow.com/users/5629418/roland-weber"}, "edited": false, "score": 0, "creation_date": 1542896970, "post_id": 53410108, "comment_id": 93739932, "body": "its not about the code itself but i want to ask as to how i can achieve  the above explained result. How can i see to it that i can apply validations in such a way with two sub forms"}, {"owner": {"reputation": 25, "user_id": 10122032, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-n-EtXVYMTPc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7ppkC6GS-3wbnksofkN_RLI6KsMEg/mo/photo.jpg?sz=128", "display_name": "XenaD Aux", "link": "https://stackoverflow.com/users/10122032/xenad-aux"}, "reply_to_user": {"reputation": 1505, "user_id": 5629418, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1027a739f87fcf27a64846508280dab1?s=128&d=identicon&r=PG&f=1", "display_name": "Roland Weber", "link": "https://stackoverflow.com/users/5629418/roland-weber"}, "edited": false, "score": 0, "creation_date": 1543247785, "post_id": 53410108, "comment_id": 93839204, "body": "DLookup(&quot;[CounType]&quot;, &quot;iL/iW Summary&quot;, (&quot;[Country] Like &#39;&quot; &amp; Me.Country &amp; &quot;&#39;&quot;) And (&quot;[DateReceived] Like &#39;&quot; &amp; Me.Date_Received &amp; &quot;&#39;&quot;) And (&quot;[Type] Like &#39;&quot; &amp; &quot;AR&quot; &amp; &quot;&#39;&quot;))"}, {"owner": {"reputation": 25, "user_id": 10122032, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-n-EtXVYMTPc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7ppkC6GS-3wbnksofkN_RLI6KsMEg/mo/photo.jpg?sz=128", "display_name": "XenaD Aux", "link": "https://stackoverflow.com/users/10122032/xenad-aux"}, "reply_to_user": {"reputation": 1505, "user_id": 5629418, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1027a739f87fcf27a64846508280dab1?s=128&d=identicon&r=PG&f=1", "display_name": "Roland Weber", "link": "https://stackoverflow.com/users/5629418/roland-weber"}, "edited": false, "score": 0, "creation_date": 1543248195, "post_id": 53410108, "comment_id": 93839447, "body": "The above VBA code is one which i want to place in the AR_Afterupdate field in my current form. where i want to lookup the value of CounType in the table iL/iW Summary. I want the current input country to match with the one in iL/iW Summary table and the date received to match as well. i tried this with error: data type mismatch."}, {"owner": {"reputation": 25, "user_id": 10122032, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-n-EtXVYMTPc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7ppkC6GS-3wbnksofkN_RLI6KsMEg/mo/photo.jpg?sz=128", "display_name": "XenaD Aux", "link": "https://stackoverflow.com/users/10122032/xenad-aux"}, "reply_to_user": {"reputation": 1505, "user_id": 5629418, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1027a739f87fcf27a64846508280dab1?s=128&d=identicon&r=PG&f=1", "display_name": "Roland Weber", "link": "https://stackoverflow.com/users/5629418/roland-weber"}, "edited": false, "score": 0, "creation_date": 1543248200, "post_id": 53410108, "comment_id": 93839449, "body": "I checked Country is string in both and datereceived as date in both the form and the table. I am trying to use this lookup to validate against the value that users fill in  the form."}], "owner": {"reputation": 25, "user_id": 10122032, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-n-EtXVYMTPc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7ppkC6GS-3wbnksofkN_RLI6KsMEg/mo/photo.jpg?sz=128", "display_name": "XenaD Aux", "link": "https://stackoverflow.com/users/10122032/xenad-aux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593954695, "creation_date": 1542796282, "last_edit_date": 1593954695, "question_id": 53410108, "link": "https://stackoverflow.com/questions/53410108/matching-records-and-iterate-through-sub-forms-in-access", "title": "Matching Records and iterate through sub forms in access", "body": "<p>I have a main form <code>MForm</code> which has a <code>subform A</code> and that <code>subform A</code> has another subform <code>subform B</code> inside.</p>\n\n<p>\"MForm\" contains IDs based on the dates. (main record set. Distinct dates)\nThe <code>subform A</code> (Linked by \"ID\" and \"DateR\"  to the main form) is the one where I have to enter countries in four different columns namely AR, IR, SR, ER. These fields are number fields and needs to be updated manually by the user.\nthe <code>subform B</code>  which is under the above mentioned <code>subform A</code> (Linked by date and country) has a queried data from which i have numbers for AR_Count, IR_Count, SR_Count and ER_Count respectively. (Queried by \"DateR\" and \"Country\" from an excel query)</p>\n\n<p>Now the purpose is i have an additional field in <code>Subform A</code> which is a field list and has two values \"Matched\" and \"Unmatched\". \nWhat i want to accomplish is when the numbers for AR,IR,SR and ER inputted by user in <code>Subform A</code> are equal to the numbers in AR_Count,IR_Count,SR_Count and ER_Count respectively in <code>Subform B</code> then the value for the field list should automatically change to \"Matched\". Now i need that to be for all records in that subform for that entry. \nSecondly, when all the records in the subform have matched in status field then the mainform \"MForm\" has a field called Status as well. with values \"Active\" and \"Closed\" . I want that once all the fields have values \"Matched\" in <code>Subform A</code> then in the MForm status should change to \"closed\" else it stays active.</p>\n\n<p>I have included a picture to show how my form looks like . The user must select a date and fill the <code>Subform A</code>. <code>Subform B</code> has values pulled from a query. </p>\n\n<p>Now i want a VBA Code and i want to ask how i can achieve these functions in my form. additionally where i can use that. I tried using <code>after update</code> or <code>before update</code> handlers for status fields with no luck.\n<a href=\"https://i.stack.imgur.com/9vP3f.jpg\" rel=\"nofollow noreferrer\">FORM LAYOUT</a></p>\n"}, {"tags": ["excel", "vba", "formula"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1542796178, "post_id": 53409926, "comment_id": 93694854, "body": "You will need VBA to achieve this. But please note that because this is no free code writing service it is necessary to show either what you have tried so far and where you got stuck or errors (by showing your code) or at least to show what you have researched and the effort you made. Otherwise it is just asking us to do all the work for you."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 10616897, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNcrc.jpg?s=128&g=1", "display_name": "SDiab", "link": "https://stackoverflow.com/users/10616897/sdiab"}, "edited": false, "score": 0, "creation_date": 1542805956, "post_id": 53411838, "comment_id": 93700178, "body": "Thank you DarXyde, for your help.while the solution you provided is to set a Formula inside the cell itself. But my question is different where each cell has a drop-down List so I don`t need to set a formula inside, I will attache an image for your reference it will describe my question more."}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "reply_to_user": {"reputation": 31, "user_id": 10616897, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNcrc.jpg?s=128&g=1", "display_name": "SDiab", "link": "https://stackoverflow.com/users/10616897/sdiab"}, "edited": false, "score": 0, "creation_date": 1542807225, "post_id": 53411838, "comment_id": 93700923, "body": "Is a bit more clear now, and yes, you will need some VBA to help you with that. As @P\u1d07\u029c pointed out, unfortunately this requires a bit of work from your side too.  All I can say, is very likely sheet events will help, and this might give you a starter on how to use those: <a href=\"https://www.excel-pratique.com/en/vba/worksheet_events.php\" rel=\"nofollow noreferrer\">excel-pratique.com/en/vba/worksheet_events.php</a>"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1542807972, "post_id": 53411838, "comment_id": 93701392, "body": "I suggest to use a button instead of events. This is what users are familiar with and it&#39;s easier to achieve."}], "tags": [], "owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "is_accepted": false, "score": 2, "last_activity_date": 1542802541, "creation_date": 1542802541, "answer_id": 53411838, "question_id": 53409926, "link": "https://stackoverflow.com/questions/53409926/how-to-set-value-in-a-cell-based-on-another-cell-value-from-another-column-using/53411838#53411838", "title": "How to set value in a cell based on another cell value from another column using formula or VBA?", "body": "<p>If that's all you want to achieve, and if you can use a formula in <strong>Sheet1</strong>, in the <strong>[Status]</strong> field, then probably all you want to do is to use the following formula:</p>\n\n<pre><code>=IF(C2 = 5, \"Delivered\", \"Pending\")\n</code></pre>\n\n<p>This is basically looking at your <strong>Version</strong> column and checks if your version number is <strong>5</strong>, then change the text to <strong>Delivered</strong>, else use <strong>Pending</strong> (or whatever you need).</p>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 10616897, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNcrc.jpg?s=128&g=1", "display_name": "SDiab", "link": "https://stackoverflow.com/users/10616897/sdiab"}, "edited": false, "score": 0, "creation_date": 1542967045, "post_id": 53443841, "comment_id": 93761650, "body": "Thank you Patrick for the format , I always face problem in customizing the code into this format . lol hhh"}], "tags": [], "owner": {"reputation": 31, "user_id": 10616897, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNcrc.jpg?s=128&g=1", "display_name": "SDiab", "link": "https://stackoverflow.com/users/10616897/sdiab"}, "is_accepted": true, "score": 0, "last_activity_date": 1542965385, "last_edit_date": 1542965385, "creation_date": 1542965193, "answer_id": 53443841, "question_id": 53409926, "link": "https://stackoverflow.com/questions/53409926/how-to-set-value-in-a-cell-based-on-another-cell-value-from-another-column-using/53443841#53443841", "title": "How to set value in a cell based on another cell value from another column using formula or VBA?", "body": "<p>I would like to thank you all for your advice , after searching for the key code to know how to return the number of rows filled in a specific table , I found the solution and now I am able to do my logic. Below is my solution for the above question.</p>\n\n<p><strong>Steps:</strong> </p>\n\n<ol>\n<li>Create Variable to hold the values</li>\n<li>The below variable will hold the inserted value need to be updated</li>\n<li>The below variable will hold the Item Version  Column number in the table</li>\n<li>The below variable will hold the value of each row under the column [Get_Version_Item_Column] to be used when comparing the values of each row</li>\n<li>The below variable will hold the Item Progress Column number in the table</li>\n<li>The below variable will hold the value of each row under the column [Get_Item_Progress_Column] to be used when comparing the values or each row</li>\n<li>The below variable used to get the total number of used rows in the table</li>\n<li>The below variable used as a counter to go throw a loop for all the rows</li>\n</ol>\n\n<p><strong>Create a Function that will do the below in Order:</strong></p>\n\n<ol start=\"9\">\n<li><p>Get Column Number from table 1 Sheet1 where header name = [Fixed in Version] </p></li>\n<li><p>Get Column Number from table 1 Sheet1 where header name = [Item Progress] </p></li>\n<li><p>Select Sheet 2 to get the value inserted in the Cell B1 </p></li>\n<li><p>Get Inserted value from the cell located inside the Sheet2 </p></li>\n<li><p>Set Counter value = 1 to start the loop from the first row after the header in table 1 Sheet 1 </p></li>\n<li><p>Open while Loop and set a condition if counter &lt;= Total number of rows do the below </p></li>\n<li><p>Start moving row by row in the table using the Cells Method : Cells(counter, Get_Version_Item_Column) ' in the cells method we set the [Row]=> counter variable which starts with value = 1 , [Column]=> Get_Version_Item_Column ' </p></li>\n<li><p>Get the value of the second column we want to put into the condition with the same way shown in Step 7 </p></li>\n<li><p>Start setting the condition usinf IF Else </p></li>\n<li><p>If Get_Fixed_In_Version_Value = Get_Version_Inserted_Value And Get_Item_Progress_Value = \"Approved\" Then 'IF CORRECT NUMBER ' DO something Example [Replace the value in this row , this column , this cell with value = \"\" ]</p></li>\n<li><p>Else ' Do something Else </p></li>\n<li><p>Add 1 to the counter </p></li>\n<li><p>Close the While Loop</p></li>\n</ol>\n\n<p><strong>Code Solution:</strong></p>\n\n<pre><code>Public Get_Version_Inserted_Value As String\nPublic Get_Version_Item_Column As Integer\nPublic Get_Fixed_In_Version_Value As String\nPublic Get_Item_Progress_Column As Integer\nPublic Get_Item_Progress_Value As String\nPublic QATotal_Items_Row As Integer\nPublic counter As Integer\n\nFunction Change_Version_Item_Progress() As String\n\nGet_Version_Inserted_Value = ThisWorkbook.Worksheets(\"Sheet2\").Range(\"B1\").Value2\n\nGet_Version_Item_Column = Application.Match(\"Fixed in Version\", Sheets(\"Sheet1\").Rows(1), 0)\n\nGet_Item_Progress_Column = Application.Match(\"Item Progress\", Sheets(\"Sheet1\").Rows(1), 0)\n\nSheets(Sheet1).Select\nQATotal_Items_Row = WorksheetFunction.CountA(Range(\"B:B\")) - 1 \ncounter = 1\n While counter &lt;= QATotal_Items_Row\n\n    Get_Fixed_In_Version_Value = ThisWorkbook.Worksheets(\"Sheet1\").Range(\"Table1\").Cells(counter, Get_Version_Item_Column).Value2\n\n    Get_Item_Progress_Value = ThisWorkbook.Worksheets(\"Sheet1\").Range(\"Table1\").Cells(counter, Get_Item_Progress_Column).Value2\n\n    If Get_Fixed_In_Version_Value = Get_Version_Inserted_Value And Get_Item_Progress_Value = \"Approved\" Then \n\n        Get_Item_Progress_Value = ThisWorkbook.Worksheets(\"Sheet1\").Range(\"Table1\").Cells(counter, Get_Item_Progress_Column).Value = \"Delivered\"\n\n    Else \n        Get_Item_Progress_Value = ThisWorkbook.Worksheets(\"Sheet1\").Range(\"Table1\").Cells(counter, Get_Item_Progress_Column).Value = Get_Item_Progress_Value\n\n    End If\n        counter = counter + 1 \n    Wend\n\nEnd Function\n</code></pre>\n\n<p>Hope it will help.</p>\n\n<p>Regards</p>\n"}], "owner": {"reputation": 31, "user_id": 10616897, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNcrc.jpg?s=128&g=1", "display_name": "SDiab", "link": "https://stackoverflow.com/users/10616897/sdiab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4000, "favorite_count": 1, "accepted_answer_id": 53443841, "answer_count": 2, "score": 0, "last_activity_date": 1542965385, "creation_date": 1542795774, "last_edit_date": 1542806243, "question_id": 53409926, "link": "https://stackoverflow.com/questions/53409926/how-to-set-value-in-a-cell-based-on-another-cell-value-from-another-column-using", "title": "How to set value in a cell based on another cell value from another column using formula or VBA?", "body": "<p>I have two sheets:<a href=\"https://i.stack.imgur.com/fyNfP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fyNfP.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Sheet 1 :</strong> consist of three columns (<strong>Status</strong>, <strong>Cost</strong>, <strong>Version</strong>)</p>\n\n<p><strong>Sheet 2 :</strong> Used as an Action Page with two columns (<strong>Formula</strong>, <strong>Version Number</strong>).</p>\n\n<p><strong>Question:</strong></p>\n\n<p>I want to set a version number in column two in sheet 2 and let the formula or the Button using VBA code to do the following:</p>\n\n<ol>\n<li>The User set <strong>value =</strong> 5 in column 2 [Version Number] sheet 2 </li>\n<li>The System takes the value from <strong>[Version Number] cell</strong></li>\n<li>The System search for all rows containing the <strong>[Version Number] value = 5</strong> ,  in sheet 1 column [Version]</li>\n<li>The System Replace each cell in column [<strong>Status</strong>] having [<strong>Version</strong>] value= 5 , with <strong>Status Value =</strong> \"Delivered\".</li>\n</ol>\n\n<p>Any help please either throw formula or using the VBA Code.</p>\n\n<p>Regards</p>\n"}, {"tags": ["excel", "vba", "trim", "spaces"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1542796474, "post_id": 53409847, "comment_id": 93695044, "body": "Please not that <i>&quot;does not work&quot;</i> is no valid error description. Tell which error you get and where. Also note that <code>Dim i, r, c, count, lastColData, LastRowData, lastRowInput, StartSearch As Long</code> only declares the last variable as <code>Long</code> but all the others as <code>Variant</code> you need to specify a type for <b>every</b> variable: <code>Dim i As Long, r As Long, c As Long, count As Long, lastColData As Long, LastRowData As Long, lastRowInput As Long, StartSearch As Long</code>"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1542796560, "post_id": 53409847, "comment_id": 93695102, "body": "Also note that <code>Trim(shtInputI.Cells(4, c)).Value</code> cannot work because <code>Trim</code> has no <code>.Value</code> the parenthesis is set in the wrong place."}, {"owner": {"reputation": 25, "user_id": 10557183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a55a2959dc38e2bcdead19b26c48976?s=128&d=identicon&r=PG&f=1", "display_name": "Daphn123", "link": "https://stackoverflow.com/users/10557183/daphn123"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1542796816, "post_id": 53409847, "comment_id": 93695268, "body": "The error I get is a 1004 Error during performance, due to the appliance or wrong defined object.This is shown as a yellow mark on the first Trim function."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1542797771, "post_id": 53409847, "comment_id": 93695834, "body": "of course because you did not define a value for <code>r</code> it is <code>r = 0</code> and row <code>0</code> does not exist. Also you should fix the issues I mentioned above and <a href=\"https://stackoverflow.com/posts/53409847/edit\">edit</a> your code in the question."}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1542801258, "post_id": 53409847, "comment_id": 93697715, "body": "There&#39;s no value for c either so the same reason as @P\u1d07\u029c mentions"}], "answers": [{"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1542804691, "post_id": 53411592, "comment_id": 93699502, "body": "Note that <code>Dim i, r, c, count, lastColData, LastRowData, lastRowInput, StartSearch As Long</code> only declares the last variable as <code>Long</code> but all the others as <code>Variant</code> you need to specify a type for every variable: <code>Dim i As Long, r As Long, c As Long, count As Long, lastColData As Long, LastRowData As Long, lastRowInput As Long, StartSearch As Long</code>"}], "tags": [], "owner": {"reputation": 23, "user_id": 10190401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff966c93a0c5e538adc9dc9dfecf9fdf?s=128&d=identicon&r=PG&f=1", "display_name": "Lucas", "link": "https://stackoverflow.com/users/10190401/lucas"}, "is_accepted": false, "score": 0, "last_activity_date": 1542804739, "last_edit_date": 1542804739, "creation_date": 1542801621, "answer_id": 53411592, "question_id": 53409847, "link": "https://stackoverflow.com/questions/53409847/trim-cell-values-in-rows-and-columns-in-different-sheets-vba/53411592#53411592", "title": "Trim cell values in rows and columns in different sheets VBA", "body": "<p>It's because you didn't make the loop. If you explain me better what you want, I can let the way you want. </p>\n\n<pre><code>Dim i, r, c, count, lastColData, LastRowData, lastRowInput, StartSearch As Long\n\n\nFor Each Worksheet In ActiveWorkbook.Worksheets\n    If Worksheet.Name = \"PQFR\" Or Worksheet.Name = \"INPUT\" Then 'please do for the sheets you want your command gonna`s be executed\n        Sheets(Worksheet.Name).Select\n        lastColData = Cells(4,Columns.count).End(xlToLeft).Column\n        LastRowData = Cells(Rows.count, 1).End(xlUp).Row\n        lastRowInput = Cells(Rows.count, 1).End(xlUp).Row\n\n        'using c=32 just for input\n        If Worksheet.Name = \"INPUT\" Then\n            'using r = 4 fosheets\n            For c = 32 To lastColData\n                For r = 1 To LastRowData\n                    Cells(r, c) = Trim(Cells(r, c).Value)\n                Next r\n            Next c\n        Else\n            'using r = 4 for all the other sheets\n            For c = 1 To lastColData\n                For r = 4 To LastRowData\n                    Cells(r, c) = Trim(Cells(r, c).Value)\n                Next r\n            Next c\n        End If\n    End If\nNext Worksheet\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 10557183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a55a2959dc38e2bcdead19b26c48976?s=128&d=identicon&r=PG&f=1", "display_name": "Daphn123", "link": "https://stackoverflow.com/users/10557183/daphn123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 224, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1583491671, "creation_date": 1542795533, "last_edit_date": 1583491671, "question_id": 53409847, "link": "https://stackoverflow.com/questions/53409847/trim-cell-values-in-rows-and-columns-in-different-sheets-vba", "title": "Trim cell values in rows and columns in different sheets VBA", "body": "<p>I would like to trim the cells that have spaces in them. But the macro I now have does not work.</p>\n\n<pre><code>Sub DoSomething()\n\n    'Declare Variables\n    Dim i, r, c, count, lastColData, LastRowData, lastRowInput, StartSearch As Long\n    Dim shtData, shtInput, shtInputI, shtInputII, shtInputIII, shtInputIV, shtInputV, shtInputVI, shtCopy As Worksheet\n    Dim Cell As Range\n    Set shtData = Sheets(\"PQFR\")\n    Set shtInput = Sheets(\"INPUT\")\n    Set shtInputI = Sheets(\"INPUTI\")\n    Set shtInputII = Sheets(\"INPUTII\")\n    Set shtInputIII = Sheets(\"INPUTIII\")\n    Set shtInputIV = Sheets(\"INPUTIV\")\n    Set shtInputV = Sheets(\"INPUTV\")\n    Set shtInputVI = Sheets(\"INPUTVI\")\n    Set shtCopy = Sheets(\"INPUTR\")\n    lastColData = shtData.Cells(4, shtData.Columns.count).End(xlToLeft).Column\n    LastRowData = shtData.Cells(shtData.Rows.count, \"A\").End(xlUp).row\n    lastRowInput = shtInputI.Cells(shtInputI.Rows.count, \"A\").End(xlUp).row\n    'lastRowData = 10\n\n\n    'Remove spaces from these sheets:\n    shtInput.Cells(r, 32).Value = Trim(shtInput.Cell(r, 32).Value)\n    shtInputI.Cells(4, c).Value = Trim(shtInputI.Cells(4, c)).Value\n    shtInputII.Cells(4, c).Value = Trim(shtInputII.Cell(4, c)).Value\n    shtInputIII.Cells(4, c).Value = Trim(shtInputIII.Cell(4, c)).Value\n    shtInputIV.Cells(4, c).Value = Trim(shtInputIV.Cells(4, c)).Value\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1542794232, "post_id": 53409193, "comment_id": 93693724, "body": "<code>wbSource.wsSource.Range(&quot;F1:F4&quot;).Copy</code> to copy and      <code>wbDestination.wsDestination.Range(&quot;A1&quot;).Insert Shift:=xlDown</code> to paste"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10684870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f88ad91e5c68fde893a3ebe4aeb1622?s=128&d=identicon&r=PG&f=1", "display_name": "MarioLourenco", "link": "https://stackoverflow.com/users/10684870/mariolourenco"}, "edited": false, "score": 0, "creation_date": 1542885895, "post_id": 53412563, "comment_id": 93733798, "body": "Hi DarXyde, thank you so much! Looks I&#39;m heading in the right direction. It is placing the cursor in the correct row, but not pasting data. This is now what I have:"}, {"owner": {"reputation": 13, "user_id": 10684870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f88ad91e5c68fde893a3ebe4aeb1622?s=128&d=identicon&r=PG&f=1", "display_name": "MarioLourenco", "link": "https://stackoverflow.com/users/10684870/mariolourenco"}, "edited": false, "score": 0, "creation_date": 1542886055, "post_id": 53412563, "comment_id": 93733885, "body": "Set rngToCopy1 = wsSource.Range(&quot;E1&quot;, wsSource.Range(&quot;E1&quot;).End(xlDown)) Set wbTarget = Workbooks.Open(&quot;C:\\Users\\MLOURENC\\Desktop\\UP_FRONT S&amp;D\\0041_PT\\2.Anual-Template\\0041_PRORATA ANNUAL CONTRACTS_UPLOAD_TEMPLATE.xls&quot;)     monthRow = wbTarget.Sheets(&quot;UAN upload&quot;).Range(&quot;J:J&quot;).Find(&quot;<i>1*MONTH</i>ANNUAL*&quot;, LookIn:=xlValues).Row month1Rows = rngToCopy1.Rows.Count wbTarget.Sheets(&quot;UAN upload&quot;).Rows(monthRow + 7 &amp; &quot;:&quot; &amp; monthRow + month1Rows + 7).EntireRow.Insert wbTarget.Sheets(&quot;UAN upload&quot;).Range(&quot;E&quot; &amp; monthRow + 7 &amp; &quot;:E&quot; &amp; monthRow + month1Rows + 7) = rngToCopy1"}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "reply_to_user": {"reputation": 13, "user_id": 10684870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f88ad91e5c68fde893a3ebe4aeb1622?s=128&d=identicon&r=PG&f=1", "display_name": "MarioLourenco", "link": "https://stackoverflow.com/users/10684870/mariolourenco"}, "edited": false, "score": 0, "creation_date": 1542889643, "post_id": 53412563, "comment_id": 93735855, "body": "Try adding <code>.value</code> to the <code>rngToCopy1</code> (ie: <code>rngToCopy1.value</code>). Also, you might need to play with the range to be inserted, i think it does insert 1 to much... <code>wbTarget.Sheets(&quot;UAN upload&quot;).Rows(monthRow + 7 &amp; &quot;:&quot; &amp; monthRow + month1Rows + 6).EntireRow.Insert</code> and  <code>wbTarget.Sheets(&quot;UAN upload&quot;).Range(&quot;E&quot; &amp; monthRow + 7 &amp; &quot;:E&quot; &amp; monthRow + month1Rows + 6) = rngToCopy1.value</code>"}, {"owner": {"reputation": 13, "user_id": 10684870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f88ad91e5c68fde893a3ebe4aeb1622?s=128&d=identicon&r=PG&f=1", "display_name": "MarioLourenco", "link": "https://stackoverflow.com/users/10684870/mariolourenco"}, "edited": false, "score": 0, "creation_date": 1542896207, "post_id": 53412563, "comment_id": 93739482, "body": "Hi DarXyde, I got it now!"}, {"owner": {"reputation": 13, "user_id": 10684870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f88ad91e5c68fde893a3ebe4aeb1622?s=128&d=identicon&r=PG&f=1", "display_name": "MarioLourenco", "link": "https://stackoverflow.com/users/10684870/mariolourenco"}, "edited": false, "score": 1, "creation_date": 1542896222, "post_id": 53412563, "comment_id": 93739498, "body": "Thank you so much for your precious help :)"}], "tags": [], "owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "is_accepted": true, "score": 0, "last_activity_date": 1542889968, "last_edit_date": 1542889968, "creation_date": 1542805099, "answer_id": 53412563, "question_id": 53409193, "link": "https://stackoverflow.com/questions/53409193/excel-vba-routine-that-finds-on-one-sheet-and-paste-on-another-moving-destinat/53412563#53412563", "title": "Excel VBA - Routine that finds on one sheet and paste on another moving destination cells down", "body": "<p>You need to layout a bit more information about your destination book, in order to point out what you can use to identify the row to copy your data to, however...</p>\n\n<p>Lets say the data in your destination workbook is formatted something like this, all in one sheet if my understanding of your question is right:</p>\n\n<pre><code>January\n    Data\n    Data\n    Data\n    Data\nFebruary\n    Data\n    Data\n    Data\n    Data\nETC ETC\n    Data\n    Data\n    Data\n    Data\n</code></pre>\n\n<p><strong>The basic steps would be:</strong></p>\n\n<p>Identify the row number where you want to add data</p>\n\n<pre><code>Dim monthRow As Long\nmonthRow = wbTarget.Sheets(1).Range(\"A:A\").Find(\"January:\", LookIn:=xlValues).Row\n</code></pre>\n\n<p>Check number of rows in your original data</p>\n\n<pre><code>Dim janRows As Long\njanRows = rngToCopy1.rows.count\n</code></pre>\n\n<p>Insert that many free rows in your target book</p>\n\n<pre><code>wbTarget.Sheets(1).Rows(monthRow + 1 &amp; \":\" &amp; monthRow + janRows).EntireRow.Insert\n</code></pre>\n\n<p>Transfer data across</p>\n\n<pre><code>wbTarget.Sheets(1).Range(\"B\" &amp; monthRow + 1 &amp; \":B\" &amp; monthRow + janRows) = rngToCopy1\n</code></pre>\n\n<p>There are various ways to do this (more than one way to skin a cat), but this would be easiest i think.</p>\n\n<p>I hope this helps, if not i`ll be happy to assist further.</p>\n"}], "owner": {"reputation": 13, "user_id": 10684870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f88ad91e5c68fde893a3ebe4aeb1622?s=128&d=identicon&r=PG&f=1", "display_name": "MarioLourenco", "link": "https://stackoverflow.com/users/10684870/mariolourenco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 53412563, "answer_count": 1, "score": 1, "last_activity_date": 1542889968, "creation_date": 1542793495, "question_id": 53409193, "link": "https://stackoverflow.com/questions/53409193/excel-vba-routine-that-finds-on-one-sheet-and-paste-on-another-moving-destinat", "title": "Excel VBA - Routine that finds on one sheet and paste on another moving destination cells down", "body": "<p>Really appreciated any help on this!</p>\n\n<p>I have 3 columns on  11 excel sheets that need to be copied to a unique destination sheet.</p>\n\n<p>The eleven sheets refer to months, and I need to find a row referring to that month on the new worbook in order to paste, moving cells down, and then search for the next month and do the same, until all 11 months are copied.</p>\n\n<p>What I have:</p>\n\n<p>Sub PopulateFileTOupload()</p>\n\n<p>' variables</p>\n\n<pre><code>Dim strFileToSave As String\n\nDim wbSource As Workbook\nDim wsSource As Worksheet\n\nDim wbTarget As Workbook\nDim wsTarget As Worksheet\n\nDim rngToCopy1 As Range, rngToCopy2 As Range, rngToCopy3 As Range\nDim dt As String, wbNam As String, wbDir As String\n\nDim FoundCell As Range, FirstAddr As String, fnd As String, i As Long\n</code></pre>\n\n<p>' ================ SOURCE ================</p>\n\n<pre><code>Set wbSource = Workbooks.Open(\"C:\\Users\\MLOURENC\\Documents\\0041_PRORATA_ANNUAL_CONTRACTS_UPLOAD.xls\")\nSet wsSource = wbSource.Worksheets(\"Month1\")\n\n' ================ COPY &amp; PASTE ================\n\n' source range1\n\nSet rngToCopy1 = wsSource.Range(\"E1\", wsSource.Range(\"E1\").End(xlDown))\nSet rngToCopy2 = wsSource.Range(\"N1\", wsSource.Range(\"N1\").End(xlDown))\nSet rngToCopy3 = wsSource.Range(\"P1\", wsSource.Range(\"P1\").End(xlDown))\n\nSet wbTarget = Workbooks.Open(\"C:\\Users\\MLOURENC\\Desktop\\UP_FRONT S&amp;D\\0041_PT\\2.Anual-Template\\0041_PRORATA ANNUAL CONTRACTS_UPLOAD_TEMPLATE.xls\")\n\n\n' Paste range1\n\n\n' DON 't know....\n\n\n\n' ================ SAVE ================\nwbNam = \"0041_PRORATA_ANNUAL_CONTRACTS_UPLOAD_READY_\"\ndt = Format(CStr(Now), \"dd_mm_yyyy_hh_mm\")\nwbTarget.SaveAs Filename:=wbNam &amp; dt\n' ================ CLOSE ================'\nApplication.DisplayAlerts = False\nwbTarget.Close\nApplication.DisplayAlerts = True\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "edited": false, "score": 0, "creation_date": 1542796276, "post_id": 53409158, "comment_id": 93694915, "body": "What do you want to happen? I don&#39;t really understand &quot;that it also can save the change of column&quot;. Do you want to log a selection change? A modification of multiple cells is not easily done by the user, except maybe for Copy+Pasting. The issue  with <code>oldValue = Target.Value</code> is that when multiple cells are selected, <code>Target.Value</code> will return an array, which you can&#39;t store in a simple string variable. Thus the type mismatch. So you need to decide what exactly you want to happen in case of a multi-cell selection? Maybe force the selection to only the first cell?"}, {"owner": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "edited": false, "score": 0, "creation_date": 1542796427, "post_id": 53409158, "comment_id": 93695015, "body": "Also think of the implications of logging multiple changes at the same time: Should a change in all cells of a column (so 1048576 changes) all be logged on their own? Your log sheet will be instantly filled up. Or do you want to somehow compress these changes into fewer lines? (How so?)"}, {"owner": {"reputation": 13, "user_id": 10436054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3b8ede4b22ec6201903ae14b7d5ed02?s=128&d=identicon&r=PG&f=1", "display_name": "Nicawong9147", "link": "https://stackoverflow.com/users/10436054/nicawong9147"}, "reply_to_user": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "edited": false, "score": 0, "creation_date": 1542849925, "post_id": 53409158, "comment_id": 93719796, "body": "sorry for late response, the thing i want to do is, for example, if i change in range(&quot;A1&quot;) formula: =C1+D1 and then selection a range such as A1-A20 and then Ctrl+D to replace the formula to whole selection.  In my mind the record should show 2 record. first one is i replace the formula in range A1 second is i replace the formula in range A2-A20  but i dun know how to display it...."}, {"owner": {"reputation": 13, "user_id": 10436054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3b8ede4b22ec6201903ae14b7d5ed02?s=128&d=identicon&r=PG&f=1", "display_name": "Nicawong9147", "link": "https://stackoverflow.com/users/10436054/nicawong9147"}, "reply_to_user": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "edited": false, "score": 0, "creation_date": 1542850534, "post_id": 53409158, "comment_id": 93719912, "body": "the first i do this vba is i want the change in all cells of a column would be logged on their own, i know that&#39;s will be fill up instantly. but my workbook file sometimes got more 2000 record. that would be a great and long process time to do it, so if possbile, 2 record will be show in it."}, {"owner": {"reputation": 13, "user_id": 10436054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3b8ede4b22ec6201903ae14b7d5ed02?s=128&d=identicon&r=PG&f=1", "display_name": "Nicawong9147", "link": "https://stackoverflow.com/users/10436054/nicawong9147"}, "reply_to_user": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "edited": false, "score": 0, "creation_date": 1542850687, "post_id": 53409158, "comment_id": 93719940, "body": "there is another problem is, when i change the formula of a cell and logged it. the logdetail only show the change of value, not change of formula.(i hope it show =A1+B1 in target . value, something like that). can it be change the display format?"}, {"owner": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "edited": false, "score": 0, "creation_date": 1542875729, "post_id": 53409158, "comment_id": 93727709, "body": "If you tell a <code>Range</code> object to give you its <code>.Value</code> it will give you just that: A value. If you want a formula instead, you need to tell it: <code>Range().Formula</code>."}, {"owner": {"reputation": 13, "user_id": 10436054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3b8ede4b22ec6201903ae14b7d5ed02?s=128&d=identicon&r=PG&f=1", "display_name": "Nicawong9147", "link": "https://stackoverflow.com/users/10436054/nicawong9147"}, "reply_to_user": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "edited": false, "score": 0, "creation_date": 1542937321, "post_id": 53409158, "comment_id": 93752922, "body": "thanks for your opinion@Inarion Now i change to &#39;Target.Formula&#39; and replace the code answer you provide. i know that it affects me when i select a range, it will force me to choose the first cell i select. but in other word, some time i need to select a range to make some changes such as copy and paste. Can it be fix even if i select a range, i still can work the function?"}, {"owner": {"reputation": 13, "user_id": 10436054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3b8ede4b22ec6201903ae14b7d5ed02?s=128&d=identicon&r=PG&f=1", "display_name": "Nicawong9147", "link": "https://stackoverflow.com/users/10436054/nicawong9147"}, "reply_to_user": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "edited": false, "score": 0, "creation_date": 1542941666, "post_id": 53409158, "comment_id": 93753558, "body": "@Inarion I have updated the vba code, Now it can select by a range. and also if i replace the formula in range A2-A20, it would show me the record, although that&#39;s not too clear for people to understand. but there are 3 problem generate, the first one, the undo function of excel cannot be used, second one, the formula change show in log sheet cannot not show properly, it will show 0 or #Value!, the third one, copy and paste a range only show the first cell changes, is it cannot be fix?"}, {"owner": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "edited": false, "score": 0, "creation_date": 1542990382, "post_id": 53409158, "comment_id": 93772791, "body": "I&#39;ve tried addressing your questions in <a href=\"https://stackoverflow.com/a/53410365/7778672\">my answer</a>. See if that is something you can follow."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10436054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3b8ede4b22ec6201903ae14b7d5ed02?s=128&d=identicon&r=PG&f=1", "display_name": "Nicawong9147", "link": "https://stackoverflow.com/users/10436054/nicawong9147"}, "edited": false, "score": 0, "creation_date": 1543204284, "post_id": 53410365, "comment_id": 93819477, "body": "Sorry for late response @Inarion, I have assignment these 2 days, really sorry for late.  i have tested your code, but when i input something in a black cell, it shows me the error. &quot;type mismatch&quot;, what&#39;s wrong with it?"}, {"owner": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "reply_to_user": {"reputation": 13, "user_id": 10436054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3b8ede4b22ec6201903ae14b7d5ed02?s=128&d=identicon&r=PG&f=1", "display_name": "Nicawong9147", "link": "https://stackoverflow.com/users/10436054/nicawong9147"}, "edited": false, "score": 0, "creation_date": 1543336756, "post_id": 53410365, "comment_id": 93877892, "body": "@Nicawong9147 I&#39;m not sure what a cell&#39;s color has to do with any of this? Can you make sure there&#39;s no other property of that cell that could be the culprit?"}, {"owner": {"reputation": 13, "user_id": 10436054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3b8ede4b22ec6201903ae14b7d5ed02?s=128&d=identicon&r=PG&f=1", "display_name": "Nicawong9147", "link": "https://stackoverflow.com/users/10436054/nicawong9147"}, "edited": false, "score": 0, "creation_date": 1543454366, "post_id": 53410365, "comment_id": 93929398, "body": "Sorry, Wrong typing, should be blank cell, not black cell.i put your code in the Thisworkbook and build the LogDetails sheet. No matter what i am input in Sheet1, Sheet2 or Sheet3, just show me the type mismatch."}, {"owner": {"reputation": 13, "user_id": 10436054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3b8ede4b22ec6201903ae14b7d5ed02?s=128&d=identicon&r=PG&f=1", "display_name": "Nicawong9147", "link": "https://stackoverflow.com/users/10436054/nicawong9147"}, "edited": false, "score": 0, "creation_date": 1543454528, "post_id": 53410365, "comment_id": 93929434, "body": "The error code show in this code: LogRange(2).Value = &quot;&#39;&quot; &amp; oldValues(idxRows, idxCols)"}], "tags": [], "owner": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "is_accepted": false, "score": 0, "last_activity_date": 1542990227, "last_edit_date": 1542990227, "creation_date": 1542797094, "answer_id": 53410365, "question_id": 53409158, "link": "https://stackoverflow.com/questions/53409158/create-log-history-for-a-cell-value-change-in-a-column/53410365#53410365", "title": "Create log history for a cell value change in a column", "body": "<p>I'm not entirely sure if that solves your problem, but try the following modification to your <code>Workbook_SheetSelectionChange</code> procedure:</p>\n\n<pre><code>Private Sub Workbook_SheetSelectionChange(ByVal Sh As Object, ByVal Target As Range)\n    If Target.Count &gt; 1 Then\n        Target(1).Select\n        Exit Sub\n    End If\n    oldValue = Target.Value\n    oldAddress = Target.Address\nEnd Sub\n</code></pre>\n\n<p>Every time the user selects more than one cell the event procedure will change that selection (which raises another change event, with a single-cell target this time) and exit without doing anything else. The criterion for when this selection change should happen can of course be refined to allow for a more specific behavior. </p>\n\n<p>This should make it much harder for the average user to intentionally or accidentally modify more than one cell at a time. </p>\n\n<hr>\n\n<p>To address questions from your comments:</p>\n\n<blockquote>\n  <p>the undo function of excel cannot be used</p>\n</blockquote>\n\n<p>This is true. Excel doesn't know how to reverse the actions your code has taken. You need to build this functionality yourself. <a href=\"https://stackoverflow.com/questions/339228/building-undo-into-an-excel-vba-macro\">See this question + accepted answer</a>.</p>\n\n<blockquote>\n  <p>the formula change show in log sheet cannot not show properly, it will show <code>0</code> or <code>#Value!</code></p>\n</blockquote>\n\n<p>Yes, that's by design. With the line</p>\n\n<pre><code>Sheets(\"LogDetails\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(0, 2).Value = Target.Formula\n</code></pre>\n\n<p>you tell Excel to set that cell's value to a formula. Which Excel then automatically tries to evaluate. (Leading to the errors you're experiencing)<br>\nTry the following:</p>\n\n<pre><code>' Prepend the formula with an apostrophe\nSheets(\"LogDetails\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(0, 2).Value = \"'\" &amp; Target.Formula\n</code></pre>\n\n<p>This will force Excel to treat the cell value as text and thus it will simply show the formula without evaluating it.</p>\n\n<blockquote>\n  <p>copy and paste a range only show the first cell changes, is it cannot be fix?</p>\n</blockquote>\n\n<p>This is due to <code>oldValues</code> being an array while you only ever access its first value. See my implementation:</p>\n\n<pre><code>Option Explicit\n\nDim oldValues As Variant\n\nPrivate Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)\n\n    Const LogSheet As String = \"LogDetails\"\n\n    If Sh.Name = LogSheet Then Exit Sub\n\n    Application.EnableEvents = False\n\n    With Worksheets(LogSheet)\n\n        Dim idxRows As Long\n        For idxRows = 1 To Target.Rows.Count\n\n            Dim idxCols As Long\n            For idxCols = 1 To Target.Columns.Count\n\n                Dim ChangedCell As Range\n                Set ChangedCell = Target.Rows(idxRows).Columns(idxCols)\n\n                Dim LogRow As Long\n                LogRow = .Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1\n                Dim LogRange As Range\n                Set LogRange = .Range(.Cells(LogRow, 1), .Cells(LogRow, 5))\n\n                LogRange(1).Value = Sh.Name &amp; \"!\" &amp; ChangedCell.Address(False, False)\n                LogRange(2).Value = \"'\" &amp; oldValues(idxRows, idxCols) ' error here when pasting a range of different size than has been selected before pasting\n                LogRange(3).Value = ChangedCell.Formula\n                LogRange(4).Value = Environ(\"username\")\n                LogRange(5).Value = Now\n\n            Next idxCols\n\n        Next idxRows\n\n        .Columns(\"A:E\").AutoFit\n\n    End With\n\n    Application.EnableEvents = True\n\nEnd Sub\n\nPrivate Sub Workbook_SheetSelectionChange(ByVal Sh As Object, ByVal Target As Range)\n    oldValues = Target.Formula\nEnd Sub\n</code></pre>\n\n<p>This has the weakness that when a user copies multiple cells and then selects a single cell and pastes, it will error out, due to mismatching indices. (It works when you copy, e.g. 3 cells in a row, then select 3 other cells in a row and paste.) Not sure how to avoid that. We'd need to capture the size of the pasted range to update <code>oldValues</code> accordingly. As Excel doesn't expose a <code>Workbook_SheetBeforePaste</code> event, that seems rather tricky.</p>\n"}], "owner": {"reputation": 13, "user_id": 10436054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3b8ede4b22ec6201903ae14b7d5ed02?s=128&d=identicon&r=PG&f=1", "display_name": "Nicawong9147", "link": "https://stackoverflow.com/users/10436054/nicawong9147"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1210, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1547043553, "creation_date": 1542793378, "last_edit_date": 1547043553, "question_id": 53409158, "link": "https://stackoverflow.com/questions/53409158/create-log-history-for-a-cell-value-change-in-a-column", "title": "Create log history for a cell value change in a column", "body": "<p>I create a log history worksheet and save the change detail of other worksheets.</p>\n\n<pre><code>Dim oldValue As Variant\n\nPrivate Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)\nDim sSheetName As String\nsSheetName = \"Data\"\nIf ActiveSheet.Name &lt;&gt; \"LogDetails\" Then\nApplication.EnableEvents = False\nSheets(\"LogDetails\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1, 0).Value = ActiveSheet.Name &amp; \"-\" &amp; Target.Address(0, 0)\nSheets(\"LogDetails\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(0, 1).Value = oldValue\nSheets(\"LogDetails\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(0, 2).Value = Target.Formula\nSheets(\"LogDetails\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(0, 3).Value = Environ(\"username\")\nSheets(\"LogDetails\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(0, 4).Value = Now\n\nSheets(\"LogDetails\").Columns(\"A:D\").AutoFit\nApplication.EnableEvents = True\nEnd If\nEnd Sub\n\nPrivate Sub Workbook_SheetSelectionChange(ByVal Sh As Object, ByVal Target As Range)\noldValue = Target.Formula\nEnd Sub\n</code></pre>\n\n<p>That works for a single cell, e.g.: </p>\n\n<p>If A1 stores \"ABC\" and changes to \"123\", Log Detail will save the Cell address, old value, new value, username and date/time.</p>\n\n<p>The big problem is when I select a whole column, such as all of column(B). It will get the error </p>\n\n<blockquote>\n  <p>\"type not match\".</p>\n</blockquote>\n\n<p>I know the problem is</p>\n\n<pre><code>oldValue = Target.Value\n</code></pre>\n\n<p>How can I save the change of a column?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 39, "user_id": 3515236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47ed7d32e35361601395ed2b91bc9fac?s=128&d=identicon&r=PG&f=1", "display_name": "user3515236", "link": "https://stackoverflow.com/users/3515236/user3515236"}, "is_accepted": false, "score": 0, "last_activity_date": 1542811986, "creation_date": 1542811986, "answer_id": 53414706, "question_id": 53408980, "link": "https://stackoverflow.com/questions/53408980/moving-data-into-destination-sheet-and-formatting-output/53414706#53414706", "title": "Moving Data into destination sheet and formatting output", "body": "<p>I managed to make this work by editing the strings in my source data then writing x number of macros to cover my scenarios then calling them one by one in a module </p>\n"}], "owner": {"reputation": 39, "user_id": 3515236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47ed7d32e35361601395ed2b91bc9fac?s=128&d=identicon&r=PG&f=1", "display_name": "user3515236", "link": "https://stackoverflow.com/users/3515236/user3515236"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542811986, "creation_date": 1542792781, "last_edit_date": 1542793203, "question_id": 53408980, "link": "https://stackoverflow.com/questions/53408980/moving-data-into-destination-sheet-and-formatting-output", "title": "Moving Data into destination sheet and formatting output", "body": "<p>I have my data in columns A:L in Sheet2 and wish to copy each block based on the starting point, as certain cell text and the end point, again as certain cell text! The data is in columns A:L and move down down block by block\n<a href=\"https://i.stack.imgur.com/dcQil.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dcQil.png\" alt=\"enter image description here\"></a></p>\n\n<p>The code I have is very nearly 100% complete, but the last part I am trying to achieve is to put each item in a specific order on the destination sheet. As we know columns are A:L I want to paste my first block into Columns A:L in the destination then the next one in M:X then the final one in Y:AJ.\nAs there are about 10 of these blocks, Tank Engine, Weatherman etc I envisage, that I will need three blocks first, then a about three rows which are gaps before it is then repeated. </p>\n\n<p>An example of this </p>\n\n<p><a href=\"https://i.stack.imgur.com/0kh7w.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0kh7w.png\" alt=\"enter image description here\"></a></p>\n\n<p>The rows are dynamic but never more than 11 in length. The code I have is </p>\n\n<pre><code>Option Explicit\n\nSub MIKE3()\n    Dim wsSrc As Worksheet 'define source\n    Set wsSrc = ThisWorkbook.Worksheets(\"Sheet1\")\n\n    Dim wsDest As Worksheet 'define destination\n    Set wsDest = ThisWorkbook.Worksheets(\"Sheet2\")\n\n    Dim FindList As Variant 'defind search words\n    FindList = Array(\"Tank Engine\")\n\n    Dim i As Long\n\n    Dim FindItm As Variant\n    For Each FindItm In FindList\n        Dim CopyRange As Range\n        Set CopyRange = FindMyRange(wsSrc.Range(\"A:L\"), FindItm, \"INFORMATION: \" &amp; FindItm)\n        If Not CopyRange Is Nothing Then\n            CopyRange.Copy wsDest.Range(\"A1\").Offset(ColumnOffset:=i) 'note that if the first column uses merged cells the ColumnOffset:=i otherwise it is ColumnOffset:=i*12\n            i = i + 1\n        End If\n    Next FindItm\nEnd Sub\nFunction FindMyRange(SearchInRange As Range, ByVal StartString As String, ByVal EndString As String) As Range\n   'find start\n    Dim FoundStart As Range\n    Set FoundStart = SearchInRange.Find(What:=StartString, LookAt:=xlWhole)\n\n    If FoundStart Is Nothing Then GoTo ERR_NOTHING_FOUND\n    find end\n    Dim FoundEnd As Range\n    Set FoundEnd = SearchInRange.Find(What:=EndString, LookAt:=xlWhole, After:=FoundStart)\n\n    If FoundEnd Is Nothing Then GoTo ERR_NOTHING_FOUND\n\n    Set FindMyRange = SearchInRange.Parent.Range(FoundStart, FoundEnd).Resize(ColumnSize:=12)\n\n    Exit Function'\n\nERR_NOTHING_FOUND:\n    FindMyRange = Nothing\nEnd Function\n</code></pre>\n\n<p>thanks to PEH for his initial help and Thank you for looking! </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10684760, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zhM_X4zXcX8/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-j_g3h6rL2syKOK5C3uQPrEA1PhFw/mo/photo.jpg?sz=128", "display_name": "KC Moses Lai", "link": "https://stackoverflow.com/users/10684760/kc-moses-lai"}, "edited": false, "score": 0, "creation_date": 1542860680, "post_id": 53412132, "comment_id": 93722040, "body": "Thank you Alex. I amended the code by reference to yours. But i still have questions, could you please take a look on the revised code and give me a hand again?"}], "tags": [], "owner": {"reputation": 172, "user_id": 10627624, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-q24pnMMCBhM/AAAAAAAAAAI/AAAAAAAAAI0/9V6VmJktiDI/photo.jpg?sz=128", "display_name": "Alexey C", "link": "https://stackoverflow.com/users/10627624/alexey-c"}, "is_accepted": false, "score": 0, "last_activity_date": 1542803608, "creation_date": 1542803608, "answer_id": 53412132, "question_id": 53408847, "link": "https://stackoverflow.com/questions/53408847/how-can-i-copy-specific-rows-from-several-worksheets-to-another-with-excel-vba/53412132#53412132", "title": "How can I copy specific rows from several worksheets to another with Excel VBA?", "body": "<p>It's easier to copy-insert Range data without any loops, like this:</p>\n\n<pre><code>Set rangeToCopy= worksheets(1).Range(Cells(1, 1), Cells(a, 100))'insert number of columns instead of 100\nrangeToCopy.Copy\nworksheets(2).Cells(1, 1).PasteSpecial Paste:=xlPasteValues' 1,1 - row, column where u want to insert your data\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10684760, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zhM_X4zXcX8/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-j_g3h6rL2syKOK5C3uQPrEA1PhFw/mo/photo.jpg?sz=128", "display_name": "KC Moses Lai", "link": "https://stackoverflow.com/users/10684760/kc-moses-lai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542860631, "creation_date": 1542792294, "last_edit_date": 1542860631, "question_id": 53408847, "link": "https://stackoverflow.com/questions/53408847/how-can-i-copy-specific-rows-from-several-worksheets-to-another-with-excel-vba", "title": "How can I copy specific rows from several worksheets to another with Excel VBA?", "body": "<p>Every month end I have to copy data (say rows 4 to the last row of some worksheets (say worksheets 2 - 7, but in fact there are numerous worksheets and rows) to worksheet 1, start the pasting from row 4 of worksheet 1.</p>\n\n<p>I do try my very best to look out the answer from stack overflow and other website. Given I am a layman of VBA Excel, I can't really customize those code to my case.</p>\n\n<p>I would be very grateful if anyone could give me a hand. Thank you.</p>\n\n<p>Below is a fail example I do by myself</p>\n\n<pre><code>Sub test1()\n    Workbooks.Open Filename:=\"file location\"\n    Worksheets(2).Activate\n    a = Cells(ActiveSheet.Rows.Count, 1).End(xlUp).Row\n\n    For a1 = 3 To a        \n        Worksheets(2).Row(a1).Copy\n        Worksheets(1).Activate\n        Worksheets(1).Rows(a).PasteSpecial\n    Next\nEnd Sub\n</code></pre>\n\n<p>Thank you alex. i amended the code by reference to yours.\n I subsequently found writing my code like below does not really efficient while there a around 100 worksheets to be copied and 7 master lists to be pasted. Below is the revised code, it seems more efficient to be written by \"do if\" function? Say once the VBA copied worksheets 2-10 rows 4 to worksheet 1, then start copying worksheets 12-21 rows 4 to worksheet 21</p>\n\n<pre><code>Sub test2()\n\n'\nWorkbooks.Open Filename:=\"file location\"\n\nWorksheets(2).Rows(\"1:3\").Copy Destination:=Worksheets(1).Rows(1)\nWorksheets(1).Range(\"A:AG\").ColumnWidth = 20\nWorksheets(1).Range(\"AD:AD\").ColumnWidth = 65\n'\n'\nWorksheets(2).Activate\na = Cells(ActiveSheet.Rows.Count, 5).End(xlUp).Row\n\nSet rangeToCopy = Worksheets(2).Range(Cells(4, 1), Cells(a, 33))\nrangeToCopy.Copy\nDim lastRow As String\nlastRow = Worksheets(1).Cells(Rows.Count, \"e\").End(xlUp).Row + 1\nWorksheets(1).Cells(lastRow, 1).PasteSpecial ' lastRow,1\n\nApplication.CutCopyMode = False\nSet rangeToCopy = Nothing\n'\n'\n'\nWorksheets(3).Activate\nb = Cells(ActiveSheet.Rows.Count, 5).End(xlUp).Row\n\nSet rangeToCopy = Worksheets(3).Range(Cells(4, 1), Cells(b, 33))\nrangeToCopy.Copy\nDim lastRow2 As String\nlastRow2 = Worksheets(1).Cells(Rows.Count, \"e\").End(xlUp).Row + 1\nWorksheets(1).Cells(lastRow2, 1).PasteSpecial ' lastRow2,1\n\nApplication.CutCopyMode = False\nSet rangeToCopy = Nothing\n\n.....to be continued\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1542790777, "post_id": 53408372, "comment_id": 93691647, "body": "You have a typo in <code>ActiveWorsheet</code> (missing <code>k</code>) \u2022 But you can just do <code>array_unsorted = ActiveWorksheet.Range(&quot;B6:B183&quot;).Value</code> to load the range into an array (2-dimensional). If you want it 1-dimensional transpose the range: <code>array_unsorted = WorksheetFunction.Transpose(ActiveWorksheet.Range(&quot;B6:B183&quot;)&zwnj;&#8203;.Value)</code>"}, {"owner": {"reputation": 33, "user_id": 4952386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecb5c73d64e2bbdd9b88d205724ef6bf?s=128&d=identicon&r=PG&f=1", "display_name": "Lomil", "link": "https://stackoverflow.com/users/4952386/lomil"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1542791551, "post_id": 53408372, "comment_id": 93692104, "body": "I&#39;m trying to write <code>Dim array_unsorted() As String ReDim array_unsorted(0 To 200) array_unsorted = ActiveWorksheet.Range(&quot;B6:B183&quot;).Value</code> but it still return empty array without data. <code>array_unsorted = WorksheetFunction.Transpose(ActiveWorksheet.Range(&quot;B6:B183&quot;)&zwnj;&#8203;.Value)</code> return the same."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1542792450, "post_id": 53408372, "comment_id": 93692653, "body": "I posted it as an answer to make it more clear."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 4952386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecb5c73d64e2bbdd9b88d205724ef6bf?s=128&d=identicon&r=PG&f=1", "display_name": "Lomil", "link": "https://stackoverflow.com/users/4952386/lomil"}, "edited": false, "score": 1, "creation_date": 1542792612, "post_id": 53408676, "comment_id": 93692736, "body": "Variant for 2-dimensional array worked, thanks. I suggest  that will be enough for this project."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1542792692, "last_edit_date": 1542792692, "creation_date": 1542791767, "answer_id": 53408676, "question_id": 53408372, "link": "https://stackoverflow.com/questions/53408372/im-trying-to-create-array-with-value-from-activesheet-vba/53408676#53408676", "title": "I`m trying to create array with value from activesheet (VBA)", "body": "<p>To easily load a range into an array (without a loop) use:</p>\n\n<pre><code>Dim array_unsorted As Variant 'must be variant!\narray_unsorted = ThisWorkbook.Worksheets(\"NameOfSheet\").Range(\"B6:B183\").Value '2-dimensional array\n</code></pre>\n\n<p>you can access the array with</p>\n\n<pre><code>Debug.Print array_unsorted(row, column) 'yes it has only 1 column but it is still there\nDebug.Print array_unsorted(1, 1) 'first value\nDebug.Print array_unsorted(2, 1) 'second value\n</code></pre>\n\n<p>or transpose it to make it 1-dimensional</p>\n\n<pre><code>array_unsorted = WorksheetFunction.Transpose(ThisWorkbook.Worksheets(\"NameOfSheet\").Range(\"B6:B183\").Value) '1-dimensional\n</code></pre>\n\n<p>and you can access the array with</p>\n\n<pre><code>Debug.Print array_unsorted(i) 'this is 1-dimensional\nDebug.Print array_unsorted(1) 'first value\nDebug.Print array_unsorted(2) 'second value\n</code></pre>\n\n<p>Note that the transpose function has a limit of 65,536 rows. If you exceed them the rest will be truncated silently.</p>\n\n<p>I recommend to avoid <code>ActiveWorksheet</code> (unless you write an add-in or the code is used for multiple worksheets). Use <code>ThisWorkbook.Worksheets(\"NameOfSheet\")</code> to reference the worksheet by its name, which is more save and Excel won't run into errors.</p>\n"}], "owner": {"reputation": 33, "user_id": 4952386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecb5c73d64e2bbdd9b88d205724ef6bf?s=128&d=identicon&r=PG&f=1", "display_name": "Lomil", "link": "https://stackoverflow.com/users/4952386/lomil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 53408676, "answer_count": 1, "score": 2, "last_activity_date": 1542792692, "creation_date": 1542790632, "last_edit_date": 1542790714, "question_id": 53408372, "link": "https://stackoverflow.com/questions/53408372/im-trying-to-create-array-with-value-from-activesheet-vba", "title": "I`m trying to create array with value from activesheet (VBA)", "body": "<p>I'm trying to create array with values from non-empty cells in range B6:B183 .  <code>array_articles = ActiveWorsheet.Range(\"B6:B183\")</code> return empty array, so I'm trying to do this:</p>\n\n<pre><code>Sub set_price()\nDim articul_price() As String\nDim articul_bill As String\nDim counter As Integer\nDim array_articles() As Variant\nDim array_unsorted() As String\nDim cell As Range\ncounter = 0\nReDim articul_price(0)\nFor Each cell In ActiveWorsheet.Range(\"B6:B183\") ' error 424 Object required\n    If IsEmpty(cell.Value) Then\n        array_unsorted(counter) = cell.Value\n        ReDim Preserve array_unsorted(counter)\n    Else\n    'do nothing\n    counter = counter + 1\n    End If\nNext\nEnd Sub\n</code></pre>\n\n<p>This code return </p>\n\n<blockquote>\n  <p>error 424 Object required</p>\n</blockquote>\n\n<p><a href=\"https://i.stack.imgur.com/mnhce.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mnhce.png\" alt=\"In Locals\"></a></p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1542796252, "post_id": 53408209, "comment_id": 93694901, "body": "All I can do is confirm what you report. To that I can add that recording a macro from the Find dialog box includes the line <code>Selection.Find.style = ActiveDocument.styles(&quot;&quot;)</code> but when I try to run this macro or use this approach I get the error 5941 &quot;The requested member of the collection does not exist&quot;. Also, the recorded macro does not include the BackgroundColor setting, although the Find dialog box is using it."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1542796392, "post_id": 53408209, "comment_id": 93694991, "body": "One other observation: The Find dialog box does not support searching shading or borders (except when they&#39;re part of a style). That might being playing a role, here. Find+VBA are allowing something (to a certain extent) that&#39;s not &quot;supported&quot; - at least, not in the UI."}, {"owner": {"reputation": 1208, "user_id": 570705, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/azkqV.jpg?s=128&g=1", "display_name": "Richard Hauer", "link": "https://stackoverflow.com/users/570705/richard-hauer"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1542840957, "post_id": 53408209, "comment_id": 93717553, "body": "@CindyMeister thanks for confirming my observations. I really don\u2019t have any way to proceed from here. I tried looking at the values in the Find object in Watch but it just crashes Word. This is probably an edge case nobody\u2019s looked at before."}], "owner": {"reputation": 1208, "user_id": 570705, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/azkqV.jpg?s=128&g=1", "display_name": "Richard Hauer", "link": "https://stackoverflow.com/users/570705/richard-hauer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1542796126, "creation_date": 1542790001, "last_edit_date": 1542796126, "question_id": 53408209, "link": "https://stackoverflow.com/questions/53408209/find-paragraph-with-backgroundpatterncolor-but-with-any-style", "title": "Find Paragraph with BackgroundPatternColor but with any style", "body": "<p>I am searching through a Word (2016) document with a VBA function looking for paragraphs that have a background color of Yellow applied.  This works well if the style of the paragraph is <code>Normal</code>...</p>\n\n<pre><code>With Selection.Find\n    .ClearFormatting\n    .ParagraphFormat.Shading.BackgroundPatternColor = wdColorYellow\n    .Wrap = wdFindContinue\n    .Text = \"\"\nEnd With\n\nWhile Selection.Find.Execute\n    ' do the thing\nWend\n</code></pre>\n\n<p>Once I run this, I can then open the Advanced Find dialog in Word and this is what shows:</p>\n\n<p><a href=\"https://i.stack.imgur.com/9RQhY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9RQhY.png\" alt=\"Search dialog showing VBA-set formatting\"></a></p>\n\n<p>There are some paragraphs with a yellow background pattern that are not <code>Style = \"Normal\"</code> and as it happens, I can use the Format -> Style dialog to remove the requirements that the Style is <code>Normal</code>...</p>\n\n<p><a href=\"https://i.stack.imgur.com/1QyMP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1QyMP.png\" alt=\"Remove the style requirement\"></a>\n<a href=\"https://i.stack.imgur.com/OgHQo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OgHQo.png\" alt=\"Now searches all styles\"></a></p>\n\n<p>If I go back to VBA now, I can use <code>Selection.Find.Execute</code> and I can locate the paragraphs that were missed before.  Interrogating the <code>Selection.Find.Style</code> property reveals the value <code>Normal</code>, which is as before, except now it works.</p>\n\n<p>There does not appear to be any way, in VBA, to remove the Style requirement?\n<strong>Does anyone know how to do this?</strong></p>\n\n<p>I tried setting the <code>Style</code> value to:</p>\n\n<ul>\n<li>Nothing</li>\n<li>\"\"</li>\n<li>\"(no style)\"</li>\n<li>9999999</li>\n</ul>\n\n<p>None of these worked.  I also tried setting <code>Find.Format = False</code> but that didn't work either.  I think it's odd that the <code>Find.Style</code> property in VBA still shows <code>Normal</code> but if I set it to <code>Normal</code> the search fails to find the paragraph.</p>\n\n<p>Open to any suggestions at this point.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 1, "creation_date": 1542789278, "post_id": 53407763, "comment_id": 93690758, "body": "Please show us what you have tried...and to get you started look at <a href=\"https://stackoverflow.com/questions/23945321/how-to-get-the-procedure-or-function-name-at-runtime\">SO: How to get the procedure or function name at runtime?</a> and <a href=\"https://stackoverflow.com/questions/5181164/progress-bar-in-vba-excel/5181347\">Progress bar in VBA Excel</a> and <a href=\"https://support.microsoft.com/en-gb/help/211736/how-to-display-a-progress-bar-with-a-user-form-in-excel\" rel=\"nofollow noreferrer\">MS KB: (J Walkenbach - How to display a progress bar with a userform in Excel</a>"}, {"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 0, "creation_date": 1542789716, "post_id": 53407763, "comment_id": 93691015, "body": "But what you want may not be possible - <a href=\"http://www.cpearson.com/excel/InsertProcedureNames.aspx\" rel=\"nofollow noreferrer\">look here (Chip Pearson)</a>"}, {"owner": {"reputation": 17, "user_id": 10678084, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MAEIxIg2vRI/AAAAAAAAAAI/AAAAAAAACZM/5JIPyC93Njg/photo.jpg?sz=128", "display_name": "Faraj", "link": "https://stackoverflow.com/users/10678084/faraj"}, "reply_to_user": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 0, "creation_date": 1542792632, "post_id": 53407763, "comment_id": 93692746, "body": "Hi @OurManinBananas! Thanks for your reply. Apologies for not including any code - I am new to VBA (4 days of experience), so I was not able to produce any working code myself that could visually explain my problem. Right now my question is mainly whether that is even possible, hypothetically, but based on the links you sent it seems extremely complicated. I will try to implement David G&#39;s suggestion and see if it works. Thank you for your help! If you wish, you can delete this question - I have saved your links."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 10678084, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MAEIxIg2vRI/AAAAAAAAAAI/AAAAAAAACZM/5JIPyC93Njg/photo.jpg?sz=128", "display_name": "Faraj", "link": "https://stackoverflow.com/users/10678084/faraj"}, "edited": false, "score": 0, "creation_date": 1542792667, "post_id": 53408329, "comment_id": 93692760, "body": "That&#39;s a good idea, I&#39;ll give it a shot. Thanks!"}], "tags": [], "owner": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "is_accepted": true, "score": -1, "last_activity_date": 1542790457, "creation_date": 1542790457, "answer_id": 53408329, "question_id": 53407763, "link": "https://stackoverflow.com/questions/53407763/vba-progress-bar-in-userform-showing-sub-names/53408329#53408329", "title": "VBA - Progress Bar in UserForm showing Sub names", "body": "<p>Create a field in your form, each sub updates that field with the desired text/number.</p>\n"}], "owner": {"reputation": 17, "user_id": 10678084, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MAEIxIg2vRI/AAAAAAAAAAI/AAAAAAAACZM/5JIPyC93Njg/photo.jpg?sz=128", "display_name": "Faraj", "link": "https://stackoverflow.com/users/10678084/faraj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "closed_date": 1542794757, "accepted_answer_id": 53408329, "answer_count": 1, "score": -2, "last_activity_date": 1542790457, "creation_date": 1542788233, "last_edit_date": 1542789460, "question_id": 53407763, "link": "https://stackoverflow.com/questions/53407763/vba-progress-bar-in-userform-showing-sub-names", "closed_reason": "Not suitable for this site", "title": "VBA - Progress Bar in UserForm showing Sub names", "body": "<p>I looked around the web for various Progress Bar tutorials, but could not find one that would help me. I am trying to create a UserForm Progress Bar that will pop up when I click \"Yes\" on a <code>MsgBox</code>.</p>\n\n<p>The progress bar itself should then display the progress of the subs. The problem is, I have a lot of subs that activate after each click of a button, around 10. Those subs themselves, respectively, have a couple of subs in them each.</p>\n\n<p>Displaying a completion % value is not important to me - instead, I would prefer that the progress bar show me names of Subs which are currently running. Would that be possible somehow? Thank you!</p>\n"}, {"tags": ["c#", ".net", "excel", "vba"], "comments": [{"owner": {"reputation": 173, "user_id": 9377382, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_WofizrM5Rs/AAAAAAAAAAI/AAAAAAAAABQ/MQlPrZRcrYw/photo.jpg?sz=128", "display_name": "Dhivakhar Venkatachalam", "link": "https://stackoverflow.com/users/9377382/dhivakhar-venkatachalam"}, "edited": false, "score": 0, "creation_date": 1542787676, "post_id": 53407582, "comment_id": 93689971, "body": "{&quot;Type mismatch. (Exception from HRESULT: 0x80020005 (DISP_E_TYPEMISMATCH))&quot;} getting this error while calling macro"}, {"owner": {"reputation": 4282, "user_id": 703163, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/cDBSH.jpg?s=128&g=1", "display_name": "Jazb", "link": "https://stackoverflow.com/users/703163/jazb"}, "edited": false, "score": 0, "creation_date": 1542787822, "post_id": 53407582, "comment_id": 93690033, "body": "does <code>Run</code> take a string as 1st argument? - just checking..."}, {"owner": {"reputation": 173, "user_id": 9377382, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_WofizrM5Rs/AAAAAAAAAAI/AAAAAAAAABQ/MQlPrZRcrYw/photo.jpg?sz=128", "display_name": "Dhivakhar Venkatachalam", "link": "https://stackoverflow.com/users/9377382/dhivakhar-venkatachalam"}, "reply_to_user": {"reputation": 4282, "user_id": 703163, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/cDBSH.jpg?s=128&g=1", "display_name": "Jazb", "link": "https://stackoverflow.com/users/703163/jazb"}, "edited": false, "score": 0, "creation_date": 1542787908, "post_id": 53407582, "comment_id": 93690065, "body": "yes, here xlApp is excel object and this codes runs fine with other datatypes except for array"}, {"owner": {"reputation": 4282, "user_id": 703163, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/cDBSH.jpg?s=128&g=1", "display_name": "Jazb", "link": "https://stackoverflow.com/users/703163/jazb"}, "edited": false, "score": 0, "creation_date": 1542787989, "post_id": 53407582, "comment_id": 93690111, "body": "but the macro defined the arr as <code>variant</code> - that could be a problem..."}, {"owner": {"reputation": 4282, "user_id": 703163, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/cDBSH.jpg?s=128&g=1", "display_name": "Jazb", "link": "https://stackoverflow.com/users/703163/jazb"}, "edited": false, "score": 1, "creation_date": 1542788028, "post_id": 53407582, "comment_id": 93690130, "body": "show code def of <code>CountryArr</code>"}, {"owner": {"reputation": 173, "user_id": 9377382, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_WofizrM5Rs/AAAAAAAAAAI/AAAAAAAAABQ/MQlPrZRcrYw/photo.jpg?sz=128", "display_name": "Dhivakhar Venkatachalam", "link": "https://stackoverflow.com/users/9377382/dhivakhar-venkatachalam"}, "reply_to_user": {"reputation": 4282, "user_id": 703163, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/cDBSH.jpg?s=128&g=1", "display_name": "Jazb", "link": "https://stackoverflow.com/users/703163/jazb"}, "edited": false, "score": 0, "creation_date": 1542788339, "post_id": 53407582, "comment_id": 93690276, "body": "Here for Country Array I am obtaining data from front end code is as follows,"}, {"owner": {"reputation": 173, "user_id": 9377382, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_WofizrM5Rs/AAAAAAAAAAI/AAAAAAAAABQ/MQlPrZRcrYw/photo.jpg?sz=128", "display_name": "Dhivakhar Venkatachalam", "link": "https://stackoverflow.com/users/9377382/dhivakhar-venkatachalam"}, "reply_to_user": {"reputation": 4282, "user_id": 703163, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/cDBSH.jpg?s=128&g=1", "display_name": "Jazb", "link": "https://stackoverflow.com/users/703163/jazb"}, "edited": false, "score": 0, "creation_date": 1542788428, "post_id": 53407582, "comment_id": 93690322, "body": "int SelectedCountryCount = liCountry.Items.Count;              string[] Countryarr = new string[SelectedCountryCount];              for (i = 0; i &lt; SelectedCountryCount; i++)             {                 Countryarr[i] = liCountry.Items[i].ToString();             }"}, {"owner": {"reputation": 4282, "user_id": 703163, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/cDBSH.jpg?s=128&g=1", "display_name": "Jazb", "link": "https://stackoverflow.com/users/703163/jazb"}, "edited": false, "score": 0, "creation_date": 1542788557, "post_id": 53407582, "comment_id": 93690383, "body": "try declaring the array to pass as type <code>object</code>"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 1, "creation_date": 1542788573, "post_id": 53407582, "comment_id": 93690389, "body": "Please, don&#39;t put code in a comment. Move it to the question."}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1542788779, "post_id": 53407582, "comment_id": 93690498, "body": "Have you tried to define the VBA-routine with <code>Sub arraydef(arr As Variant)</code>"}, {"owner": {"reputation": 173, "user_id": 9377382, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_WofizrM5Rs/AAAAAAAAAAI/AAAAAAAAABQ/MQlPrZRcrYw/photo.jpg?sz=128", "display_name": "Dhivakhar Venkatachalam", "link": "https://stackoverflow.com/users/9377382/dhivakhar-venkatachalam"}, "edited": false, "score": 1, "creation_date": 1542790973, "post_id": 53407582, "comment_id": 93691770, "body": "Hi declaring Sub arraydef(arr As Variant) instead of Sub arraydef(arr() as Variant) works, here () seems to be the problem. Syntax issue.Thanks FunThomas i have been having this issue for a long time"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1542796984, "post_id": 53407582, "comment_id": 93695368, "body": "@FunThomas As this is something of an FAQ (and I don&#39;t find an exact duplicate, only <a href=\"https://stackoverflow.com/questions/38010974/cant-pass-c-sharp-int-array-to-vba-excel-macro\" title=\"cant pass c sharp int array to vba excel macro\">stackoverflow.com/questions/38010974/&hellip;</a>) might be a good idea to write this up as an Answer. Ping me an I&#39;ll help by up-voting and I hope the OP marks it as &quot;the&quot; answer so that we have a good post to point people at..."}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1542810029, "post_id": 53407582, "comment_id": 93702679, "body": "@ Cindy Meister: Done."}], "answers": [{"tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": true, "score": 1, "last_activity_date": 1542804568, "last_edit_date": 1542804568, "creation_date": 1542800920, "answer_id": 53411397, "question_id": 53407582, "link": "https://stackoverflow.com/questions/53407582/pass-array-to-macro-function-from-c/53411397#53411397", "title": "Pass array to macro function from C#", "body": "<p>Basically, when passing an array of <em>something</em> to a subroutine in VBA, the easiest solution is to declare the parameter as <code>Variant</code>.</p>\n\n<p>Declaring the parameter as array means that the calling routine must pass exactly that array type. If a subroutine is declared to receive an array of <code>Long</code>, you have to pass an array of <code>Long</code>. Not <code>Integer</code>, not <code>Variant</code>. The same is true if the subroutine is declared to receive an array of <code>Variant</code> - you have to pass an array of <code>Variant</code>. </p>\n\n<p>Now, <code>Variant</code> is a kind of magical data type. A variant can be <em>anything</em> - even an array. When you declare a parameter as <code>Variant</code> and pass a <code>Long</code> (or a <code>String</code>, or...), the VBA Runtime Engine takes care about that a <code>Variant</code> is created, stores the content of the <code>Long</code> (or <code>String</code> or...) and keeps track about what it currently stores.</p>\n\n<p>If you pass an array to that Variant, VBA stores that array in the <code>Variant</code> (probably only a reference) and keeps track not only about the fact that it contains an array but also about the type of the array. </p>\n\n<p>However, if you declare the parameter as an array of <code>Variant</code>, the Runtime cannot do its magic. You tell the Runtime you will get a bunch of <code>Variants</code>, but then you pass a bunch of <code>Integer</code>. The Runtime would have to convert every single element of the array from <code>Integer</code> to <code>Variant</code> - and it simply does not do that. Instead, the VBA compiler complains, or, when calling via <code>Application.Run</code>, throws a <em>\"Type mismatch\"</em> runtime error.</p>\n\n<p>There are some functions that can help you get information what is (currently) stored in a Variant: <code>IsArray</code> tells you if the <code>Variant</code> contains an error, and <code>VarType</code> will give you the information about the type (for more information about <code>VarType</code>, see <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/vartype-function\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/vartype-function</a>). <code>LBound</code> and <code>Ubound</code> will give you the size of an array. The only thing you cannot get is the information about the dimensions of an array. In the rare case you don't know about the number of dimensions, <a href=\"https://stackoverflow.com/a/6902088/7599798\">https://stackoverflow.com/a/6902088/7599798</a> can give you a solution.</p>\n"}], "owner": {"reputation": 173, "user_id": 9377382, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_WofizrM5Rs/AAAAAAAAAAI/AAAAAAAAABQ/MQlPrZRcrYw/photo.jpg?sz=128", "display_name": "Dhivakhar Venkatachalam", "link": "https://stackoverflow.com/users/9377382/dhivakhar-venkatachalam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 349, "favorite_count": 0, "accepted_answer_id": 53411397, "answer_count": 1, "score": 1, "last_activity_date": 1583491687, "creation_date": 1542787389, "last_edit_date": 1583491687, "question_id": 53407582, "link": "https://stackoverflow.com/questions/53407582/pass-array-to-macro-function-from-c", "title": "Pass array to macro function from C#", "body": "<p>I am trying to pass an array variable as a parameter to a macro function but getting the error mismatch on calling this macro file,</p>\n\n<p>My code is as follows, MACRO CODE</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub arraydef(arr() As Variant)\n    MsgBox (arr(0))\nEnd Sub\n</code></pre>\n\n<p>C# Code for calling the Macro function by passing the array :</p>\n\n<pre><code>Excel.Application xlApp = new Excel.Application();\nExcel.Workbook xlWorkBook;\nxlWorkBook = xlApp.Workbooks.Open(Server.MapPath(\"\\\\MacroFile\\\\MYTEFINAL1.xlsm\"));\nxlApp.Visible = false;\nxlApp.Run(\"arraydef\", Countryarr);\n</code></pre>\n\n<p>Where Countryarr is the array that i am trying to pass</p>\n\n<p>Can someone please suggest on how to pass an array to a macro file as my functionality depends on it?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1542791793, "post_id": 53407496, "comment_id": 93692246, "body": "You should test if <code>selectedRows = Nothing</code> before Selecting. Also, is <code>Worksheets(&quot;contacts&quot;)</code> hidden by any chance? One more thought try starting with <code>Set selectedRows = Worksheets(&quot;contacts&quot;).Range(&quot;A1&quot;)</code> as you test <code>B1</code> in your loop and not sure if you can have it in your selected range twice."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1542793393, "post_id": 53407496, "comment_id": 93693227, "body": "Without too much testing the code worked for me - except that last line which should be <code>Worksheets(&quot;main&quot;).Range(&quot;A3&quot;).Copy</code>.  <b>Edit:</b> But I did have the correct sheet selected - the code given by @PawelCzyz should work."}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 7160614, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/10209565482447730/picture?type=large", "display_name": "Ashraf Misran", "link": "https://stackoverflow.com/users/7160614/ashraf-misran"}, "edited": false, "score": 0, "creation_date": 1542791023, "post_id": 53407656, "comment_id": 93691792, "body": "still not succesful"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1542793573, "post_id": 53407656, "comment_id": 93693338, "body": "<code>Copy Worksheets(&quot;main&quot;).Range(&quot;A3&quot;)</code> should be <code>Worksheets(&quot;main&quot;).Range(&quot;A3&quot;).Copy</code>"}, {"owner": {"reputation": 1629, "user_id": 5379555, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PrDxe.jpg?s=128&g=1", "display_name": "Pawel Czyz", "link": "https://stackoverflow.com/users/5379555/pawel-czyz"}, "edited": false, "score": 0, "creation_date": 1542794198, "post_id": 53407656, "comment_id": 93693700, "body": "I have edited my answer - like Darren pointed - last line of your macro is incorrect - let me know what you wanted to get done with it. I might be able to correct it as well."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1542803086, "post_id": 53407656, "comment_id": 93698621, "body": "Should it be <code>selectedRows.Copy Worksheets(&quot;main&quot;).Range(&quot;A3&quot;)</code>?"}], "tags": [], "owner": {"reputation": 1629, "user_id": 5379555, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PrDxe.jpg?s=128&g=1", "display_name": "Pawel Czyz", "link": "https://stackoverflow.com/users/5379555/pawel-czyz"}, "is_accepted": false, "score": 1, "last_activity_date": 1542798634, "last_edit_date": 1542798634, "creation_date": 1542787749, "answer_id": 53407656, "question_id": 53407496, "link": "https://stackoverflow.com/questions/53407496/failed-selection-on-union-range/53407656#53407656", "title": "Failed selection on union range", "body": "<p>You get the error msg because sheet \"contacts\" is not active. Add this line:</p>\n\n<pre><code>Worksheets(\"contacts\").Activate\n</code></pre>\n\n<p>Like this:</p>\n\n<pre><code>Sub filter()\n    'Clear prev result table\n    Worksheets(\"main\").Range(\"A3\").CurrentRegion.Delete\n\n    'Declare variable\n    Dim selectedRows As Range\n    Set selectedRows = Worksheets(\"contacts\").Range(\"A1:B1\")\n\n\n    'Get total used range in contacts database\n    numRows = Mid(Worksheets(\"contacts\").UsedRange.Address, 9)\n    For Each cell In Worksheets(\"contacts\").Range(\"B1:B\" &amp; numRows)\n        If cell.Value = Worksheets(\"main\").Range(\"B1\").Value Then\n            'If true, push into array called selectedRows\n            Set selectedRows = Application.Union(selectedRows, Worksheets(\"contacts\").Range(cell.Address))\n        End If\n    Next\n\n    Worksheets(\"contacts\").Activate\n\n    selectedRows.Select '&lt;------ fail here\n\n    'this line below is incorrect\n    'Copy Worksheets(\"main\").Range(\"A3\")\nEnd Sub\n</code></pre>\n\n<p>I recommend reading this post: <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a> - it will help you improve your code.</p>\n"}], "owner": {"reputation": 59, "user_id": 7160614, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/10209565482447730/picture?type=large", "display_name": "Ashraf Misran", "link": "https://stackoverflow.com/users/7160614/ashraf-misran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1583491719, "creation_date": 1542787064, "last_edit_date": 1583491719, "question_id": 53407496, "link": "https://stackoverflow.com/questions/53407496/failed-selection-on-union-range", "title": "Failed selection on union range", "body": "<p>I try to select the range that was union under one variable, but it fails.</p>\n\n<pre><code>Sub filter()\n    'Clear prev result table\n    Worksheets(\"main\").Range(\"A3\").CurrentRegion.Delete\n\n    'Declare variable\n    Dim selectedRows As Range\n    Set selectedRows = Worksheets(\"contacts\").Range(\"A1:B1\")\n\n\n    'Get total used range in contacts database\n    numRows = Mid(Worksheets(\"contacts\").UsedRange.Address, 9)\n    For Each cell In Worksheets(\"contacts\").Range(\"B1:B\" &amp; numRows)\n        If cell.Value = Worksheets(\"main\").Range(\"B1\").Value Then\n            'If true, push into array called selectedRows\n            Set selectedRows = Application.Union(selectedRows, Worksheets(\"contacts\").Range(cell.Address))\n        End If\n    Next\n\n    selectedRows.Select '&lt;------ fail here\n    Copy Worksheets(\"main\").Range(\"A3\")\nEnd Sub\n</code></pre>\n\n<p>The macro failed and error message said: Select method or Range class failed.\nWhat is wrong with my code?</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1542787574, "post_id": 53407436, "comment_id": 93689916, "body": "Have you tried a PivotTable?"}, {"owner": {"reputation": 43, "user_id": 10628584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Thaer J", "link": "https://stackoverflow.com/users/10628584/thaer-j"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1542788295, "post_id": 53407436, "comment_id": 93690258, "body": "I have but the people im working with cannot keep updating the tablet data source every time they add a new account that&#39;s why I&#39;m looking for a formula"}, {"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1542789629, "post_id": 53407436, "comment_id": 93690974, "body": "Have a look at countifs(), sumifs(), there are examples around on here..."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1542789887, "post_id": 53407436, "comment_id": 93691126, "body": "A formula won&#39;t work you will need VBA, but because this is no free code writing service it is necessary to show either what you have tried so far and where you got stuck or errors (by showing your code) or at least to show what you have researched and the effort you made. Otherwise it is just asking us to do all the work for you. Reading <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> might help you to improve your question."}, {"owner": {"reputation": 43, "user_id": 10628584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Thaer J", "link": "https://stackoverflow.com/users/10628584/thaer-j"}, "edited": false, "score": 0, "creation_date": 1542792509, "post_id": 53407436, "comment_id": 93692680, "body": "ive tried index with match but the formula only takes the first account number that fits the criteria and ignores the rest, I&#39;ve tired pivot tables but the people im working for would like it dynamic rather than them wanting to go and change the data source every time, so im pretty much stuck and im not that strong with VBA that&#39;s why i came here to ask"}, {"owner": {"reputation": 862, "user_id": 9211191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3abb20de4292973fd582868c407fc9e9?s=128&d=identicon&r=PG&f=1", "display_name": "Peter K.", "link": "https://stackoverflow.com/users/9211191/peter-k"}, "edited": false, "score": 0, "creation_date": 1543322105, "post_id": 53407436, "comment_id": 93868762, "body": "@ThaerJ Was your question resolved?"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 10628584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Thaer J", "link": "https://stackoverflow.com/users/10628584/thaer-j"}, "edited": false, "score": 0, "creation_date": 1542792587, "post_id": 53408419, "comment_id": 93692729, "body": "i understand but that means it will have to be done manually each time, which is why they assigned this project for me, i have to make it dynamic (to sort all results based on the criteria without manual intervention) ive tried index with match but it only takes the first result that applies to the criteria"}], "tags": [], "owner": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1542790792, "creation_date": 1542790792, "answer_id": 53408419, "question_id": 53407436, "link": "https://stackoverflow.com/questions/53407436/i-want-to-index-specific-values-in-a-specific-range/53408419#53408419", "title": "I want to index specific values in a specific range", "body": "<p>A quick solution would be to enter all your data into each column, and then sort by your criteria. Each column would contain all the data, but only display the desired fields.\nNo VBA necessary.</p>\n"}, {"tags": [], "owner": {"reputation": 862, "user_id": 9211191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3abb20de4292973fd582868c407fc9e9?s=128&d=identicon&r=PG&f=1", "display_name": "Peter K.", "link": "https://stackoverflow.com/users/9211191/peter-k"}, "is_accepted": false, "score": 1, "last_activity_date": 1542793599, "creation_date": 1542793599, "answer_id": 53409224, "question_id": 53407436, "link": "https://stackoverflow.com/questions/53407436/i-want-to-index-specific-values-in-a-specific-range/53409224#53409224", "title": "I want to index specific values in a specific range", "body": "<p>You can use this array formula (ctrl+shift+enter !!) :<br>\n<code>{=IFERROR(INDEX(A$1:A$5;SMALL(IF((B$1:B$5&gt;-1000)*($B$1:$B$5&lt;=-500);ROW(A$1:A$5)-ROW(A$1)+1);ROWS(A$1:A1)));\"\")}</code>   </p>\n\n<p>I hard coded the cut-off values, but this would be better of course with a reference to the cells above where you put the cut-off values (so you not only can copy down, but also copy right). In <code>A$1:A$5</code> are the students/accounts, and in <code>B$1:B$5</code> their scores. You can copy this formula down in each target column, ideally as far down as there are rows in your original list (just to cover the --probably unlikely-- case that all students' scores are in the same bracket...)<br>\nOf course change the <code>;</code> delimiter with <code>,</code> if needed according to your regional settings.</p>\n\n<p>Credit to this answer on SU : <a href=\"https://superuser.com/a/692580/681891\">https://superuser.com/a/692580/681891</a></p>\n"}], "owner": {"reputation": 43, "user_id": 10628584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Thaer J", "link": "https://stackoverflow.com/users/10628584/thaer-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1583491814, "creation_date": 1542786807, "last_edit_date": 1583491814, "question_id": 53407436, "link": "https://stackoverflow.com/questions/53407436/i-want-to-index-specific-values-in-a-specific-range", "title": "I want to index specific values in a specific range", "body": "<p>I have a list of students that I have the following mark criteria,</p>\n\n<ol>\n<li>from <code>0</code> to <code>-500</code></li>\n<li>from <code>-501</code> to <code>-1000</code> </li>\n<li>from <code>-1001</code> to <code>-5000</code>    </li>\n<li>from <code>-5001</code> to <code>-10000000000</code></li>\n</ol>\n\n<p>The list of students and the categorization were on sheet 1. On sheet 2 I have the criteria as headers.</p>\n\n<p>I want a formula that I can use under lets say criteria 1 \nand it automatically fills all the account numbers that met the criteria under the column that has that criteria as a header.</p>\n\n<p>Sheet 2:<br>\n<a href=\"https://i.stack.imgur.com/Zckeu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Zckeu.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1542786919, "post_id": 53407361, "comment_id": 93689635, "body": "Use explicit parent sheet references throughout and possibly add a check that Lastrow is &gt;= 9."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 7720373, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/273deb123e827947a881acdc63a1f5f5?s=128&d=identicon&r=PG&f=1", "display_name": "D.Alex", "link": "https://stackoverflow.com/users/7720373/d-alex"}, "edited": false, "score": 0, "creation_date": 1542804575, "post_id": 53407437, "comment_id": 93699444, "body": "it&#39;s working with the header but now the formula is completed with one extra row"}, {"owner": {"reputation": 1629, "user_id": 5379555, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PrDxe.jpg?s=128&g=1", "display_name": "Pawel Czyz", "link": "https://stackoverflow.com/users/5379555/pawel-czyz"}, "reply_to_user": {"reputation": 29, "user_id": 7720373, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/273deb123e827947a881acdc63a1f5f5?s=128&d=identicon&r=PG&f=1", "display_name": "D.Alex", "link": "https://stackoverflow.com/users/7720373/d-alex"}, "edited": false, "score": 0, "creation_date": 1542804796, "post_id": 53407437, "comment_id": 93699559, "body": "Edited - check now (I have corrected LastRow value)"}], "tags": [], "owner": {"reputation": 1629, "user_id": 5379555, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PrDxe.jpg?s=128&g=1", "display_name": "Pawel Czyz", "link": "https://stackoverflow.com/users/5379555/pawel-czyz"}, "is_accepted": false, "score": 1, "last_activity_date": 1542804716, "last_edit_date": 1542804716, "creation_date": 1542786808, "answer_id": 53407437, "question_id": 53407361, "link": "https://stackoverflow.com/questions/53407361/excel-header-formula-with-vba/53407437#53407437", "title": "excel header formula with VBA", "body": "<p>You should add one to last row. This way you will add your formula starting from next row (one below). Try this:</p>\n\n<pre><code>Sub actualizareformule()\n\nDim Lastrow As Long\n\nApplication.ScreenUpdating = False\n\n'Find last row and add one\nLastrow = Range(\"L\" &amp; Rows.Count).End(xlUp).Row + 1\n\nRange(\"AS9:AS\" &amp; Lastrow -1).Formula = \"=IFERROR(RC[-2]/RC[-1],\"\"0%\"\")\"\n\nActiveSheet.AutoFilterMode = False\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 7720373, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/273deb123e827947a881acdc63a1f5f5?s=128&d=identicon&r=PG&f=1", "display_name": "D.Alex", "link": "https://stackoverflow.com/users/7720373/d-alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1583491823, "creation_date": 1542786365, "last_edit_date": 1583491823, "question_id": 53407361, "link": "https://stackoverflow.com/questions/53407361/excel-header-formula-with-vba", "title": "excel header formula with VBA", "body": "<p>I'm using following subprocedure to fill some cells starting with cell AS9 \nbut somehow the subprocedure modifies also the header from AS8. I don't want to modify the header when I run the subprocedure</p>\n\n<pre><code>Sub actualizareformule()\n\n    Dim Lastrow As Long\n\n    Application.ScreenUpdating = False\n\n    Lastrow = Range(\"L\" &amp; Rows.Count).End(xlUp).Row\n    Range(\"AS9:AS\" &amp; Lastrow).Formula = _\n        \"=IFERROR(RC[-2]/RC[-1],\"\"0%\"\")\"   \n\n    ActiveSheet.AutoFilterMode = False\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 0, "creation_date": 1542786322, "post_id": 53407228, "comment_id": 93689382, "body": "Does ubound(comb(2)) not work?"}], "answers": [{"comments": [{"owner": {"reputation": 46, "user_id": 10684255, "user_type": "registered", "profile_image": "https://graph.facebook.com/2104091906279534/picture?type=large", "display_name": "c0k3b0y", "link": "https://stackoverflow.com/users/10684255/c0k3b0y"}, "edited": false, "score": 0, "creation_date": 1542789800, "post_id": 53407392, "comment_id": 93691075, "body": "Thanks for the quick reply! This is headed in the right direction, but lacks a key element.  Think of the elements in the 2nd dimension as a set. I want to filter for those sets where there occurs not a single element twice.  Assume again the dimension is 4 and I have these elements: comb(0,0)=&quot;a&quot; ;comb(0,1)=&quot;b&quot;; comb(0,2)=&quot;a&quot;; comb(0,3)=&quot;b&quot;  with your method I would get 2 matches because element 0=2 and element 1=3"}], "tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 0, "last_activity_date": 1542789489, "last_edit_date": 1542789489, "creation_date": 1542786567, "answer_id": 53407392, "question_id": 53407228, "link": "https://stackoverflow.com/questions/53407228/comparing-elements-within-a-multi-dimensional-array/53407392#53407392", "title": "Comparing Elements within a Multi-Dimensional Array", "body": "<p>You can create three loops that will check each value, but will skip over each other due to the final loop being <code>y + 1</code> from the second loop.</p>\n\n<pre><code>Dim x As Long, y As Long, z As Long, comb()\n\nFor x = LBound(comb, 1) To UBound(comb, 1)\n    For y = LBound(comb, 2) To UBound(comb, 2) - 1\n        For z = y + 1 To UBound(comb, 2)\n            If comb(x, y) = comb(x, z) Then\n                msgbox \"Match Occurred!\"\n            End If\n        Next z\n    Next y\nNext x\n</code></pre>\n\n<p>Essentially, the 2nd loop controls the left side of the equation (the <code>If comb(x, y) =</code> and the 3rd loop controls the right side (the <code>= comb(x, z)</code>).</p>\n\n<hr>\n\n<p>If desired, to prevent errors where there only may be a single value in the 2nd dimension, you could add an extra <strong>If..Then</strong> statement, like:</p>\n\n<pre><code>If Lbound(comb, 2) &lt;&gt; Ubound(comb, 2) Then ...\n</code></pre>\n\n<p>due to the nature of how the third loop adds 1 to <code>y</code>'s value, but an error would be raised if there isn't a 1 to add to <code>y</code>.</p>\n\n<hr>\n\n<h1>Visualization</h1>\n\n<p>Here is a good visualization to see how this works. This test will print each iteration to the immediate window, you can see that each number is compared with a different number:</p>\n\n<pre><code>Sub test()\n\n    Dim x As Long, y As Long, z As Long, comb(0, 0 To 4)\n\n    For x = LBound(comb, 1) To UBound(comb, 1)\n        For y = LBound(comb, 2) To UBound(comb, 2) - 1\n            For z = y + 1 To UBound(comb, 2)\n                If comb(x, y) = comb(x, z) Then\n                    Debug.Print y &amp; \"|\" &amp; z\n                End If\n            Next z\n        Next y\n    Next x\n\nEnd Sub\n</code></pre>\n\n<p>Which the immediate window prints:</p>\n\n<blockquote>\n<pre><code>0|1  \n0|2  \n0|3  \n0|4  \n1|2  \n1|3  \n1|4  \n2|3  \n2|4  \n3|4  \n</code></pre>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 46, "user_id": 10684255, "user_type": "registered", "profile_image": "https://graph.facebook.com/2104091906279534/picture?type=large", "display_name": "c0k3b0y", "link": "https://stackoverflow.com/users/10684255/c0k3b0y"}, "is_accepted": true, "score": 0, "last_activity_date": 1542791699, "creation_date": 1542791699, "answer_id": 53408657, "question_id": 53407228, "link": "https://stackoverflow.com/questions/53407228/comparing-elements-within-a-multi-dimensional-array/53408657#53408657", "title": "Comparing Elements within a Multi-Dimensional Array", "body": "<p>With K.Davis' great help I found the following solution to my problem:</p>\n\n<pre><code>For x = LBound(comb, 1) To UBound(comb, 1)\n   For y = LBound(comb, 2) To UBound(comb, 2) - 1\n      For z = y + 1 To UBound(comb, 2)\n         If comb(x, y) = comb(x, z) Then\n            noMatch = True\n         End If\n      Next z\n   Next y\n\n   If noMatch = False Then\n      MsgBox x\n   End If\n\n   noMatch = False\n\nNext x\n</code></pre>\n"}], "owner": {"reputation": 46, "user_id": 10684255, "user_type": "registered", "profile_image": "https://graph.facebook.com/2104091906279534/picture?type=large", "display_name": "c0k3b0y", "link": "https://stackoverflow.com/users/10684255/c0k3b0y"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 53408657, "answer_count": 2, "score": 2, "last_activity_date": 1542791699, "creation_date": 1542785741, "last_edit_date": 1542788240, "question_id": 53407228, "link": "https://stackoverflow.com/questions/53407228/comparing-elements-within-a-multi-dimensional-array", "title": "Comparing Elements within a Multi-Dimensional Array", "body": "<p>Assume I have an array of the dimensions <code>comb(x, y)</code>.<br>\nFor each element x I need to check if any of the elements y are identical. If so, I will proceed with the next element of x.</p>\n\n<p>If there were 4 elements stored in y for each x the code I would use would be something like this:</p>\n\n<pre><code>For i = 0 To z\n    j = 0\n    k = j + 1\n    l = j + 2\n    m = j + 3\n\n    If comb(i, j) &lt;&gt; comb(i, k) And _\n    comb(i, j) &lt;&gt; comb(i, l) And _\n    comb(i, j) &lt;&gt; comb(i, m) And _\n    comb(i, k) &lt;&gt; comb(i, l) And _\n    comb(i, k) &lt;&gt; comb(i, m) And _\n    comb(i, l) &lt;&gt; comb(i, m) Then\n\n       MsgBox \"success\"\n\n    End If\n\n Next i\n</code></pre>\n\n<p>The thing is, that the dimension of y changes depending on the user input.<br>\nIs there a way to automate it for an arbitrary number of elements in y?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1542787258, "post_id": 53406952, "comment_id": 93689755, "body": "So what is wrong with your code? Any errors? If so which and where?  What does your code vs. what did you expect from your code? Please also show the definitions of your variables, it&#39;s unclear what <code>title.Value</code> is because <code>title</code> is not declared. Also don&#39;t use <code>Date</code> as variable name it is already a reserved key word of VBA."}, {"owner": {"reputation": 55, "user_id": 7344474, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-nkxvj_4mwlc/AAAAAAAAAAI/AAAAAAAAABU/VhyQplvmBNE/photo.jpg?sz=128", "display_name": "Kelvs", "link": "https://stackoverflow.com/users/7344474/kelvs"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1542787466, "post_id": 53406952, "comment_id": 93689867, "body": "@P\u1d07\u029c There are no errors. However, I do not know how to code adding multiple names on the column &quot;Attendees&quot; from my form. title.value is a textbox from my form which is user defined. I&#39;m thinking using a listbox to gather the data for my &quot;Attendees&quot; column, however I do not know how I can transfer it while at the same time populating the other columns with the same data."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1542787803, "post_id": 53406952, "comment_id": 93690024, "body": "I don&#39;t see the problem. You fill your 5 text boxes with data and press the &quot;insert&quot; button that runs the code above. Then you change the name of the attendee and press the insert button again. This should add the another line with the same data but a different attendee. (to be continued \u2026)."}], "owner": {"reputation": 55, "user_id": 7344474, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-nkxvj_4mwlc/AAAAAAAAAAI/AAAAAAAAABU/VhyQplvmBNE/photo.jpg?sz=128", "display_name": "Kelvs", "link": "https://stackoverflow.com/users/7344474/kelvs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1583491832, "creation_date": 1542784402, "last_edit_date": 1583491832, "question_id": 53406952, "link": "https://stackoverflow.com/questions/53406952/adding-several-data-on-a-specific-column-on-a-table", "title": "Adding several data on a specific column on a table", "body": "<p>I am trying to create a table that can store a \"Training Information\" data. The code below is working (see sample result below) however, it can only add one data at a time.</p>\n\n<p><a href=\"https://i.stack.imgur.com/DLL8X.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DLL8X.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>What I would like to happen is to be able to add several data on my \"Attendees\" column only, while the other columns will contain the same data since it is the same training.</p>\n\n<p>Any ideas?</p>\n\n<pre><code>Dim ws As Worksheet\nDim lo As ListObject\nDim lr As ListRow\nSet ws = Sheets(\"Trainings\")\nws.Unprotect \"321321\"\nSet lo = ws.ListObjects(1)\nSet lr = lo.ListRows.Add\nlr.Range(1, 1).Value = UCase(title.Value)\nlr.Range(1, 2).Value = UCase(Date.Value)\nlr.Range(1, 3).Value = UCase(Venue.Value)\nlr.Range(1, 4).Value = UCase(VenueAdd.Value)\nlr.Range(1, 5).Value = UCase(Attendees.Value)\n</code></pre>\n"}, {"tags": ["excel", "vba", "oracle", "stored-procedures"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1542784658, "post_id": 53406596, "comment_id": 93688735, "body": "Not much to go on here.  Can we assume your command works when pasted into an Oracle command window in a query tool?  From the error message it sounds like there&#39;s some problem with the procedure code itself, but since we can&#39;t see it I&#39;m not sure what we can offer there.  Are you able to successfully create a small, simple SP using the VBA approach?"}, {"owner": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "edited": false, "score": 0, "creation_date": 1542787772, "post_id": 53406596, "comment_id": 93690014, "body": "Why do you try to create PL/SQL code with VBA? Consider the standard tools like sqlplus or an IDE like TOAD or SQL Developer.They should work much better."}, {"owner": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "edited": false, "score": 0, "creation_date": 1542787976, "post_id": 53406596, "comment_id": 93690105, "body": "The problem should be in your PL/SQL code. As it is rather big, created it in proper IDE which should tell you the line where the error occurs."}, {"owner": {"reputation": 33, "user_id": 8669168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d878bf203d50df50a5d03a0cbd756ad2?s=128&d=identicon&r=PG&f=1", "display_name": "Scales", "link": "https://stackoverflow.com/users/8669168/scales"}, "edited": false, "score": 0, "creation_date": 1542789857, "post_id": 53406596, "comment_id": 93691110, "body": "I am developing a tool. It need to check and create a SP if it doesn&#39;t exist across multiple environments wherever it is used.  SP code I am using is fine and it is executing well in Oracle. (It has 130+ lines).. I am looking for a possibility to refer the body of SP from excel sheet thru VBA and create it in oracle."}, {"owner": {"reputation": 33, "user_id": 8669168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d878bf203d50df50a5d03a0cbd756ad2?s=128&d=identicon&r=PG&f=1", "display_name": "Scales", "link": "https://stackoverflow.com/users/8669168/scales"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1542790057, "post_id": 53406596, "comment_id": 93691223, "body": "@Tim Williams - Yes I am able to create a SP from VBA in Oracle with few lines as SP body"}], "owner": {"reputation": 33, "user_id": 8669168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d878bf203d50df50a5d03a0cbd756ad2?s=128&d=identicon&r=PG&f=1", "display_name": "Scales", "link": "https://stackoverflow.com/users/8669168/scales"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1583491846, "creation_date": 1542782783, "last_edit_date": 1583491846, "question_id": 53406596, "link": "https://stackoverflow.com/questions/53406596/reading-sheet-contents-for-stored-procedure-body-and-creating-in-oracle", "title": "Reading sheet contents for Stored procedure body and creating in oracle", "body": "<p>My stored procedure contains 13000+ characters, I am trying to create this SP in oracle using excel VBA.</p>\n\n<p>I placed full SP body in single cell in excel sheet then I read and stored in string </p>\n\n<blockquote>\n  <p>sp_code = Worksheets(\"properties\").Cells(2, 1).Value</p>\n</blockquote>\n\n<p>Later using ADODB.Command I pushed code to oracle but it give error like below</p>\n\n<pre><code>identifier too long\n</code></pre>\n\n<p>I came across through web docs like vba won't handle more than 255 characters in a identifier, So I break the sp code and placed in each cell and declared a variant then push the code like below.</p>\n\n<pre><code>sp_code = Worksheets(\"properties\").Range(\"B2:J2\").Value\ncmd_meta.CommandText = sp_code(1, 1) &amp; sp_code(1, 2) &amp; sp_code(1, 3) &amp; sp_code(1, 4) \n</code></pre>\n\n<p>But still got same error.</p>\n\n<p>Please share your thoughts and possible ways to get solve this issue.</p>\n\n<p>Thanks in advance.</p>\n\n<p>@duplicate markers - please tag the link of duplicate before marking mine.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1542785050, "post_id": 53406179, "comment_id": 93688893, "body": "Note that <code>Dim LeaveStartDate, LeaveEndDate As Date</code> only declares the second as <code>Date</code> but the first as <code>Variant</code>. You need to declare a type for <b>every</b> variable: <code>Dim LeaveStartDate As Date, LeaveEndDate As Date</code>. \u2022 Do you get any errors? If so please include in your question where and which. It&#39;s unclear where exactly your issue is. Also have a look at the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/Excel.Worksheet.Evaluate\" rel=\"nofollow noreferrer\">Worksheet.Evaluate method</a>."}, {"owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "edited": false, "score": 0, "creation_date": 1542802136, "post_id": 53406179, "comment_id": 93698170, "body": "Is there a typo in your formula or are the quotes/apostrophes before the second <code>&#47;</code> in <code>DATEVALUE(&quot;19&#47;01&#39;&#39;&#47;2018&quot;))</code> meant to be there?"}], "owner": {"reputation": 13, "user_id": 9672533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cba4c6c5c01c4debf7598af500e0736?s=128&d=identicon&r=PG&f=1", "display_name": "user9672533", "link": "https://stackoverflow.com/users/9672533/user9672533"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1583491855, "creation_date": 1542780627, "last_edit_date": 1583491855, "question_id": 53406179, "link": "https://stackoverflow.com/questions/53406179/execute-excel-formula-stored-in-a-string-from-a-macro", "title": "Execute excel formula stored in a string from a macro", "body": "<p>Requirement:<br>\nCalculate the number of Mondays that are holidays between a date range and execute them using a macro.\nI could arrive at he formula that can give me the correct result</p>\n\n<pre><code> =SumProduct((VIC &gt;= DATEVALUE(\"1/01/2016\")) * (VIC &lt;= DATEVALUE(\"19/01''/2018\")) * (Weekday(VIC, 2) = 1))\n</code></pre>\n\n<p>Can you please help me execute the formula stored in string?</p>\n\n<pre><code>Sub TestFunction()\n    Dim LeaveStartDate, LeaveEndDate As Date\n\n    Set srcdoc = Worksheets(\"Sheet1\")\n    Dim CntSunPH  As String\n\n    LeaveStartDate = Worksheets(\"Sheet1\").Cells(1, \"B\").Value\n    LeaveEndDate = Worksheets(\"Sheet1\").Cells(2, \"B\").Value\n\n    State = \"VIC\"\n    CntSunPH = Replace((Replace(Replace((\"=SumProduct((State &gt;= DATEVALUE(\"\"LeaveStartDate\"\")) * (State &lt;= DATEVALUE(\"\"LeaveEndDate\"\")) * (Weekday(State, 2) = 1))\"), \"State\", State), \"LeaveStartDate\", LeaveStartDate)), \"LeaveEndDate\", LeaveEndDate)\n    n = 0\n    n = Application.WorksheetFunction.Execute(\"=SumProduct((VIC &gt;= DATEVALUE(\"\"1/01/2016\"\")) * (VIC &lt;= DATEVALUE(\"\"19/01/2018\"\")) * (Weekday(VIC, 2) = 1))\")\n\n    Debug.Print \"Date1 \" &amp; LeaveStartDate\n    Debug.Print \"Date2  \" &amp; LeaveEndDate\n    Debug.Print CntSunPH\n\n    Debug.Print n    \nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 1, "creation_date": 1542783750, "post_id": 53406065, "comment_id": 93688346, "body": "You ask to hide a specific workbook, but complain it does not hide the application, but also say hiding the appkication is not good as it hides other workbooks... What di you really want? You need to be clear."}, {"owner": {"reputation": 29, "user_id": 10492520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c771b8e78e9d237ac3696d88626f34a4?s=128&d=identicon&r=PG&f=1", "display_name": "Mondee", "link": "https://stackoverflow.com/users/10492520/mondee"}, "reply_to_user": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1542784955, "post_id": 53406065, "comment_id": 93688850, "body": "as the title says, hide the only specific workbook. 1st code hides all workbook, then 2nd code did not hide the excel application."}, {"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1542785208, "post_id": 53406065, "comment_id": 93688947, "body": "You state \u201cthis code is bad as it still shows the application\u201d, therefore that does not match with your title question..."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 10492520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c771b8e78e9d237ac3696d88626f34a4?s=128&d=identicon&r=PG&f=1", "display_name": "Mondee", "link": "https://stackoverflow.com/users/10492520/mondee"}, "edited": false, "score": 0, "creation_date": 1542787915, "post_id": 53407178, "comment_id": 93690071, "body": "Hi, thank you for your kind answer. I try the code, put it in Initialize event and add userform1.show in workbook_open. I open extra workbook then open my working file and did not hide any workbook on the other hand I try to open my working file first before other workbook, other workbook did not shown up."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 29, "user_id": 10492520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c771b8e78e9d237ac3696d88626f34a4?s=128&d=identicon&r=PG&f=1", "display_name": "Mondee", "link": "https://stackoverflow.com/users/10492520/mondee"}, "edited": false, "score": 0, "creation_date": 1542788977, "post_id": 53407178, "comment_id": 93690601, "body": "The code should work (I&#39;m not sure what you did wrong). Especially if we don&#39;t see how your actual code looks like. Edit your original question, add the code you use and describe exactly what you did. Comments are too short to clarify this question."}, {"owner": {"reputation": 29, "user_id": 10492520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c771b8e78e9d237ac3696d88626f34a4?s=128&d=identicon&r=PG&f=1", "display_name": "Mondee", "link": "https://stackoverflow.com/users/10492520/mondee"}, "edited": false, "score": 0, "creation_date": 1542792795, "post_id": 53407178, "comment_id": 93692838, "body": "Hi, I edit the question and show the code I used. Or should I put the code you gave to ThisWorkbook module?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 29, "user_id": 10492520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c771b8e78e9d237ac3696d88626f34a4?s=128&d=identicon&r=PG&f=1", "display_name": "Mondee", "link": "https://stackoverflow.com/users/10492520/mondee"}, "edited": false, "score": 0, "creation_date": 1542793128, "post_id": 53407178, "comment_id": 93693042, "body": "Probably the issue is that the code tries to hide the workbook before it is shown. This could be a timing issue. Maybe try to put it into the <code>UserForm_Activate</code>."}, {"owner": {"reputation": 29, "user_id": 10492520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c771b8e78e9d237ac3696d88626f34a4?s=128&d=identicon&r=PG&f=1", "display_name": "Mondee", "link": "https://stackoverflow.com/users/10492520/mondee"}, "edited": false, "score": 0, "creation_date": 1542794648, "post_id": 53407178, "comment_id": 93693980, "body": "how I will use UserForm_Activate?"}, {"owner": {"reputation": 29, "user_id": 10492520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c771b8e78e9d237ac3696d88626f34a4?s=128&d=identicon&r=PG&f=1", "display_name": "Mondee", "link": "https://stackoverflow.com/users/10492520/mondee"}, "edited": false, "score": 0, "creation_date": 1542795286, "post_id": 53407178, "comment_id": 93694327, "body": "Tried. When working file is open I cannot open other workbook, when another workbook is already open then open working file all of workbooks are stuck."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 29, "user_id": 10492520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c771b8e78e9d237ac3696d88626f34a4?s=128&d=identicon&r=PG&f=1", "display_name": "Mondee", "link": "https://stackoverflow.com/users/10492520/mondee"}, "edited": false, "score": 0, "creation_date": 1542795454, "post_id": 53407178, "comment_id": 93694421, "body": "I have no idea what you are doing. Sorry, I cannot help you. All I can say is, the code works like I said if eg used on a button."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 0, "last_activity_date": 1542785497, "creation_date": 1542785497, "answer_id": 53407178, "question_id": 53406065, "link": "https://stackoverflow.com/questions/53406065/hide-only-specific-workbook-without-affecting-other-workbook/53407178#53407178", "title": "Hide only specific workbook without affecting other workbook", "body": "<p>The correct way to hide one specific workbook is </p>\n\n<pre><code>Application.Windows(ThisWorkbook.Name).Visible = False\n</code></pre>\n\n<p>where <code>ThisWorkbook.Name</code> can be replaced with the desired workbook name like <code>\"MyWb.xlsm\"</code>.</p>\n\n<ul>\n<li>If there are more than one workbooks open at the same time this will hide the specified workbook (and its application window).</li>\n<li>If this is the only workbook that is open it will hide the specified workbook (<strong>without its application window</strong>).</li>\n</ul>\n\n<p>If you want to hide the application window you must use </p>\n\n<pre><code>Application.Visible = False\n</code></pre>\n\n<p>The trick is now to combine them</p>\n\n<pre><code>If Application.Windows.Count &gt; 1 Then 'more than one workbook open: Hide workbook only\n    Application.Windows(ThisWorkbook.Name).Visible = False\nElse 'only one workbook open: Hide application\n    Application.Visible = False\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 10492520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c771b8e78e9d237ac3696d88626f34a4?s=128&d=identicon&r=PG&f=1", "display_name": "Mondee", "link": "https://stackoverflow.com/users/10492520/mondee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 766, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1583657012, "creation_date": 1542779932, "last_edit_date": 1583657012, "question_id": 53406065, "link": "https://stackoverflow.com/questions/53406065/hide-only-specific-workbook-without-affecting-other-workbook", "title": "Hide only specific workbook without affecting other workbook", "body": "<p>Already circled the internet and has the same answer that did not work as I wanted to be.</p>\n\n<p>Q: How to hide workbook and show userform without hiding other workbook?</p>\n\n<p>This code is good but hides other workbooks.</p>\n\n<pre><code>Application.Visible = False\n</code></pre>\n\n<p>This code is bad as it still shows the excel application.</p>\n\n<pre><code>Workbooks(\"Workbook Name.xlsm\").Window(1).Visible = False\n</code></pre>\n\n<p>Also dont work.</p>\n\n<pre><code>ActiveWorkbook.Visible = False\n</code></pre>\n\n<p>Lastly, the tool method, going to tools>options>general tab>ignore other application. I dont have this option on my VBA</p>\n\n<p>This is the code I used.</p>\n\n<pre><code>Private Sub UserForm_Initialize()\nIf Application.Windows.Count &gt; 1 Then\nApplication.Windows(ThisWorkbook.Name).Visible = False\nElse\nApplication.Visible = False\nEnd If\n</code></pre>\n\n<p>and in ThisWorkbook module</p>\n\n<pre><code>Private Sub Workbook_Open()\nUserForm1.Show\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1542779884, "post_id": 53405955, "comment_id": 93686880, "body": "Could you please edit your question and add tags around the code.. Makes it easier to read and understand... or highlight the code and press ctrl + k"}, {"owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "edited": false, "score": 0, "creation_date": 1542783617, "post_id": 53405955, "comment_id": 93688285, "body": "This <a href=\"https://stackoverflow.com/questions/24153818/how-do-i-autofilter-using-an-array-for-criteria\" title=\"how do i autofilter using an array for criteria\">stackoverflow.com/questions/24153818/&hellip;</a> should answer your question."}, {"owner": {"reputation": 21, "user_id": 10683768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb1d17e2467ee555188997434394badc?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan1", "link": "https://stackoverflow.com/users/10683768/jordan1"}, "edited": false, "score": 0, "creation_date": 1542784253, "post_id": 53405955, "comment_id": 93688558, "body": "I feel that my code is doing the exact same thing as the solution in your link - can you please explain why mine doesn&#39;t work the same way?"}], "answers": [{"tags": [], "owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "is_accepted": false, "score": 0, "last_activity_date": 1542789054, "last_edit_date": 1542789054, "creation_date": 1542784111, "answer_id": 53406893, "question_id": 53405955, "link": "https://stackoverflow.com/questions/53405955/use-a-variable-excel-range-to-use-in-autofilter-vba/53406893#53406893", "title": "Use a variable Excel range to use in autofilter VBA", "body": "<p>Excel likes it's autofilter arrays as strings. So you need to convert the array to string values. Then it works.</p>\n\n<pre><code>Sub Test()\n\n    Dim Template As Workbook\n    Set Template = ThisWorkbook\n    Dim IDs, Report As Worksheet\n    Set IDs = Template.Worksheets(\"IDs\")\n    Set Report = Template.Worksheets(\"Report\")\n\n    Dim LastRowIDs As Long\n    LastRowIDs = IDs.Range(\"A\" &amp; IDs.Rows.Count).End(xlUp).Row\n\n    Dim IDsArray As Variant\n    Dim sTemp As String, i As Integer\n    IDsArray = Application.Transpose(IDs.Range(\"A2:A\" &amp; LastRowIDs))\n    For i = LBound(IDsArray) To UBound(IDsArray)\n        sTemp = \",\" &amp; IDsArray(i) &amp; sTemp\n    Next i\n    IDsArray = Split(Mid(sTemp, 2), \",\")\n\n    Dim LastRowReport As Long\n    LastRowReport = Report.Range(\"A\" &amp; Report.Rows.Count).End(xlUp).Row\n\n    Report.AutoFilterMode = False\n    Report.Range(\"A1:C\" &amp; LastRowReport).AutoFilter Field:=1, Criteria1:=IDsArray, Operator:=xlFilterValues\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 10683768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb1d17e2467ee555188997434394badc?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan1", "link": "https://stackoverflow.com/users/10683768/jordan1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 445, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1542789054, "creation_date": 1542779367, "last_edit_date": 1542780258, "question_id": 53405955, "link": "https://stackoverflow.com/questions/53405955/use-a-variable-excel-range-to-use-in-autofilter-vba", "title": "Use a variable Excel range to use in autofilter VBA", "body": "<p>I've searched a lot and tried a lot of different things, but I can't get the following to work.</p>\n\n<p>I have a range of IDs that I generate. I then want to filter a range of data to produce a filtered output of just the specified IDs. However, whatever I try, my filtered output just returns a blank range.</p>\n\n<p>Please note: my range of IDs varies in size each time I run this process. I've included a very simplistic set of data to illustrate my point - my real data is far more complex than my example.</p>\n\n<p>The code I have at the moment:</p>\n\n<pre><code>Sub Test()\n\n    Dim Template As Workbook\n    Set Template = ThisWorkbook\n    Dim IDs, Report As Worksheet\n    Set IDs = Template.Worksheets(\"IDs\")\n    Set Report = Template.Worksheets(\"Report\")\n\n    Dim LastRowIDs As Long\n    LastRowIDs = IDs.Range(\"A\" &amp; IDs.Rows.Count).End(xlUp).Row\n\n    Dim IDsArray As Variant\n\n    IDsArray = IDs.Range(\"A2:A\" &amp; LastRowIDs)\n\n    Dim LastRowReport As Long\n    LastRowReport = Report.Range(\"A\" &amp; Report.Rows.Count).End(xlUp).Row\n\n    Report.AutoFilterMode = False\n    Report.Range(\"A1:C\" &amp; LastRowReport).AutoFilter Field:=1, Criteria1:=Application.Transpose(IDsArray), Operator:=xlFilterValues\n\nEnd Sub\n</code></pre>\n\n<p>I would say I'm a moderately basic user of VBA so please explain any answers.</p>\n\n<p><a href=\"https://i.stack.imgur.com/n5pnO.png\" rel=\"nofollow noreferrer\">Range to filter on</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/MT4A8.png\" rel=\"nofollow noreferrer\">Data to be filtered</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/p3iql.png\" rel=\"nofollow noreferrer\">Desired output</a></p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1542773193, "post_id": 53405083, "comment_id": 93685214, "body": "It&#39;s unclear what you would like to do. Can you please show your starting point and desired end point?"}], "answers": [{"tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 1, "last_activity_date": 1542775030, "creation_date": 1542775030, "answer_id": 53405341, "question_id": 53405083, "link": "https://stackoverflow.com/questions/53405083/vba-codesave-the-fillter-data-to-txt-file/53405341#53405341", "title": "VBA code:Save the fillter data to txt file", "body": "<p>If you want to assign your filtered values to an array, an easy way to do that would be to use advanced filtering and filter into another area of the worksheet and assign your values there.</p>\n\n<p>But a simple approach that will get you started is to just loop your rows in your range, if the row is hidden, then move on - otherwise, print the data to your text document.</p>\n\n<pre><code>Dim rng As Range, r As Long\nSet rng = Sheet5.Range(\"B1:C\" &amp; [B100000].End(xlUp).Row)\n\nDim FPath As String\nFPath = ThisWorkbook.Path &amp; \"\\\" &amp; \"text\" &amp; \".txt\"\nApplication.CutCopyMode = False\n\nOpen FPath For Output As #1\nWith Sheet5\n    For r = rng.Row To rng.Rows.Count + rng.Row - 1\n        If Not .Rows(r).Hidden Then\n            Print #1, .Cells(r, 1) &amp; vbTab &amp; .Cells(r, 2)\n        End If\n    Next\nEnd With\n\nClose #1\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9353716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51139dddb251385930b537122b03b2cb?s=128&d=identicon&r=PG&f=1", "display_name": "Scorpio", "link": "https://stackoverflow.com/users/9353716/scorpio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1542775030, "creation_date": 1542772795, "last_edit_date": 1542773171, "question_id": 53405083, "link": "https://stackoverflow.com/questions/53405083/vba-codesave-the-fillter-data-to-txt-file", "title": "VBA code:Save the fillter data to txt file", "body": "<p>VBA code: help me with, I want to save the fillter data to txt file.</p>\n\n<pre><code>Sub Intemp()\n\nDim arr, i As Long\nDim FPath As String\n\nFPath = ThisWorkbook.Path &amp; \"\\\" &amp; \"text\" &amp; \".txt\"\nApplication.CutCopyMode = False\narr = Sheet5.Range(\"B1:C\" &amp; [B100000].End(xlUp).Row)\n\nOpen FPath For Output As #1\nFor i = 1 To UBound(arr)\n    Print #1, arr(i, 1) &amp; vbTab &amp; arr(i, 2)\nNext i\n\nClose #1\nEnd Sub\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/AVDkM.png\" alt=\"enter image description here\"></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 1, "creation_date": 1542772462, "post_id": 53404718, "comment_id": 93685052, "body": "You should <a href=\"https://stackoverflow.com/posts/53404718/edit\">edit</a> your question and update all the discrepancies between your date strings. The 3 up top are in caps and there is no <code>C</code> date. You are also missing a date letter on your shared code. If your code has typos such as these, you should add <code>Option Explicit</code> to the <b>very top</b> of your code sheet and then try to run. <code>VBA</code> will call out any typos you may have (or other undeclared variables)"}], "answers": [{"tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": true, "score": 0, "last_activity_date": 1542771893, "last_edit_date": 1542771893, "creation_date": 1542769846, "answer_id": 53404749, "question_id": 53404718, "link": "https://stackoverflow.com/questions/53404718/check-if-datetime-is-between-two-datetimes/53404749#53404749", "title": "Check if datetime is between two datetimes", "body": "<h2>VBA Solution</h2>\n\n<p>It's unclear how you are assigning dates to the variables so I will assume you already have that part complete. </p>\n\n<p>Here are two methods to check the statement: <code>DateB &gt;= DateA &gt;= DateC</code></p>\n\n<pre><code>Sub DateCompare()\n\nDim DateA As Date 'Variable Date\nDim DateB As Date 'Older Date\nDim DateC As Date 'Newer Date\n\nDateA = Some Date\nDateB = Some Date\nDateC = Some Date\n\n'Method to give Boolean Response\nMsgBox DateA &gt;= DateB And DateA &lt;= DateC\n\n'Method to do other things\nIf DateA &gt;= DateB And DateA &lt;= DateC Then\n    MsgBox \"DateA falls in-between DateB &amp; DateC\"\nElse\n    MsgBox \"DateA does not fall in-between DateB &amp; DateC\"\nEnd If\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<h2>Non-VBA Solution</h2>\n\n<p>This can be done right in Excel without the need for <code>VBA</code>...<br>\n <code>A2</code> = Variable Date<br>\n <code>B2</code> = Older Date<br>\n <code>C2</code> = Newer Date  </p>\n\n<blockquote>\n  <p>=AND(A2>=B2, A2&lt;=C2)</p>\n</blockquote>\n\n<p>The equation as is will return <code>TRUE</code> or <code>FALSE</code>. The equation can be nested inside an <code>IF</code> statement if you would like to return a non-boolean response like so </p>\n\n<blockquote>\n  <p>=IF(AND(A2>=B2, A2&lt;=C2) = TRUE, \"A is between C &amp; B\", \"A is not between C &amp; B\")</p>\n</blockquote>\n"}], "owner": {"reputation": 33, "user_id": 2906598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d359eae5c22a550cb8217e8003ba21ce?s=128&d=identicon&r=PG&f=1", "display_name": "sherrez", "link": "https://stackoverflow.com/users/2906598/sherrez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 0, "accepted_answer_id": 53404749, "answer_count": 1, "score": -2, "last_activity_date": 1583576142, "creation_date": 1542769527, "last_edit_date": 1583576142, "question_id": 53404718, "link": "https://stackoverflow.com/questions/53404718/check-if-datetime-is-between-two-datetimes", "title": "Check if datetime is between two datetimes", "body": "<p>Hi i am trying to create a macro with vba \nAn example would be</p>\n\n<pre><code>DATETIMEA  is  \"20/11/2018 11:00:00 AM\"\n\nDATETIMEB is \"20/11/2018 08:00:00 AM\"\n\nDATETIME  is \"21/11/2018 07:59:00 AM\"\n</code></pre>\n\n<p>I would like to check if the <code>datetimeA</code> falls between <code>datetimeb</code> and <code>datetimec</code> the code below doesn't work.</p>\n\n<p>The values are stored in <code>Date</code> variables.</p>\n\n<pre><code>If datetimeb &gt;=  datetime And datetimea  &lt;= datetimec\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "dlookup"], "comments": [{"owner": {"reputation": 1, "user_id": 10683361, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NTWWAlPo094/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iyMpEknWrWL6XBJwJKbMy0ZbkmtA/mo/photo.jpg?sz=128", "display_name": "ark_freight", "link": "https://stackoverflow.com/users/10683361/ark-freight"}, "reply_to_user": {"reputation": 279739, "user_id": 16076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D29fm.jpg?s=128&g=1", "display_name": "Mitch Wheat", "link": "https://stackoverflow.com/users/16076/mitch-wheat"}, "edited": false, "score": 0, "creation_date": 1542769100, "post_id": 53404660, "comment_id": 93684298, "body": "it is short text"}, {"owner": {"reputation": 1, "user_id": 10683361, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NTWWAlPo094/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iyMpEknWrWL6XBJwJKbMy0ZbkmtA/mo/photo.jpg?sz=128", "display_name": "ark_freight", "link": "https://stackoverflow.com/users/10683361/ark-freight"}, "reply_to_user": {"reputation": 279739, "user_id": 16076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D29fm.jpg?s=128&g=1", "display_name": "Mitch Wheat", "link": "https://stackoverflow.com/users/16076/mitch-wheat"}, "edited": false, "score": 0, "creation_date": 1542770333, "post_id": 53404660, "comment_id": 93684568, "body": "I have removing the bracket but the error still exist and the getID function does give me the correct output.. Does the dlookup require the recordset to be opened first?"}, {"owner": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "edited": false, "score": 0, "creation_date": 1542777954, "post_id": 53404660, "comment_id": 93686345, "body": "Your DLookup syntax is correct. My bet is that the getID function returns a problematic value, for example a value containing single quotes. Try hardcoding a value within the DLookup in order to skip getID altogether, e.g. &quot;[Employee ID] = &#39;X123&#39;&quot;."}, {"owner": {"reputation": 1, "user_id": 10683361, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NTWWAlPo094/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iyMpEknWrWL6XBJwJKbMy0ZbkmtA/mo/photo.jpg?sz=128", "display_name": "ark_freight", "link": "https://stackoverflow.com/users/10683361/ark-freight"}, "edited": false, "score": 0, "creation_date": 1542778780, "post_id": 53404660, "comment_id": 93686556, "body": "Oh you are correct... but based on the msgbox of my getID function I did not see any &#39; marks"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 10683361, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NTWWAlPo094/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iyMpEknWrWL6XBJwJKbMy0ZbkmtA/mo/photo.jpg?sz=128", "display_name": "ark_freight", "link": "https://stackoverflow.com/users/10683361/ark-freight"}, "is_accepted": false, "score": 0, "last_activity_date": 1542790520, "creation_date": 1542790520, "answer_id": 53408341, "question_id": 53404660, "link": "https://stackoverflow.com/questions/53404660/why-is-there-a-syntax-error-in-my-dlookup/53408341#53408341", "title": "Why is there a syntax error in my Dlookup", "body": "<p>Ok I got it. The getID function had some weird symbol behind it that doesn't show itself on the msgbox. getID relied on another global function that extracts the username of the login. Thanks and sorry for the false alarm</p>\n"}], "owner": {"reputation": 1, "user_id": 10683361, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NTWWAlPo094/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iyMpEknWrWL6XBJwJKbMy0ZbkmtA/mo/photo.jpg?sz=128", "display_name": "ark_freight", "link": "https://stackoverflow.com/users/10683361/ark-freight"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1542790520, "creation_date": 1542768975, "last_edit_date": 1542775502, "question_id": 53404660, "link": "https://stackoverflow.com/questions/53404660/why-is-there-a-syntax-error-in-my-dlookup", "title": "Why is there a syntax error in my Dlookup", "body": "<p>I am trying to create a function that can return me the employee name given the employee ID on a shared table but error pops out: </p>\n\n<blockquote>\n  <p>\"Runtime Error '3075': Syntax error in string in query expression '[Employee ID] = 'XXXXX' \".  </p>\n</blockquote>\n\n<p>I tried to implement the different answers I found online but I still couldn`t fix it. Below is my code in question.</p>\n\n<pre><code>Function getName() As String\n    Dim Name As String\n    getName = DLookup(\"[Employee Name]\", \"ID Table\", \"[Employee ID] = '\" &amp; getID &amp; \"'\")\n'getID is a function that returns a string and both Employee Name and Employee ID are in the ID Table\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 1, "creation_date": 1542765760, "post_id": 53404067, "comment_id": 93683595, "body": "This is a lot of code to read through. Can you explain the general steps your code aims to complete"}, {"owner": {"reputation": 529, "user_id": 10277540, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uhl4j.png?s=128&g=1", "display_name": "Display name", "link": "https://stackoverflow.com/users/10277540/display-name"}, "edited": false, "score": 1, "creation_date": 1542766899, "post_id": 53404067, "comment_id": 93683866, "body": "<code>wx.Range(&quot;B&quot; &amp; Rows.Count).End(xlDown).row</code> this looks wrong, I think you want <code>wx.Range(&quot;B&quot; &amp; wx.Rows.Count).End(xlup).row</code>, same for column &quot;C&quot;"}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "reply_to_user": {"reputation": 529, "user_id": 10277540, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uhl4j.png?s=128&g=1", "display_name": "Display name", "link": "https://stackoverflow.com/users/10277540/display-name"}, "edited": false, "score": 0, "creation_date": 1542770931, "post_id": 53404067, "comment_id": 93684694, "body": "@O.PAL: &#39;Application.Rows.Count&#39;, &#39;Rows.Count&#39; and &#39;wx.Rows.Count&#39; all return the same number. To conclude: &#39;Rows.Count&#39; is fine. You&#39;re right about &#39;xlUp&#39;, though."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1542772605, "post_id": 53404067, "comment_id": 93685088, "body": "There is not enough info here for anyone to provide a solution to a logic error. We can call out other syntax errors or possible confusion in coding like your line  <code>Dim LastRow, Rowlast, Rowlast2 As Long</code>. You are actually only declaring <code>Rowlast2</code> as long. The first two variables are not specified and are defaulting to type <code>Variant</code>"}], "answers": [{"comments": [{"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1542771193, "post_id": 53404677, "comment_id": 93684757, "body": "The new Excel versions have a little more rows. That&#39;s why &#39;&quot;E&quot; &amp; Rows.Count&#39; is used, to make the code work in all versions."}], "tags": [], "owner": {"reputation": 29, "user_id": 10492520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c771b8e78e9d237ac3696d88626f34a4?s=128&d=identicon&r=PG&f=1", "display_name": "Mondee", "link": "https://stackoverflow.com/users/10492520/mondee"}, "is_accepted": false, "score": -1, "last_activity_date": 1542769165, "creation_date": 1542769165, "answer_id": 53404677, "question_id": 53404067, "link": "https://stackoverflow.com/questions/53404067/looping-through-worksheets-in-a-workbook-and-consolidating-each-workbook-in-to-a/53404677#53404677", "title": "Looping through worksheets in a workbook and consolidating each workbook in to a worksheet in the master workbook", "body": "<p>This is a code from my consolidator maybe you can get an idea.</p>\n\n<pre><code>   Dim lRow As Long\n   Dim LastRow As Long\n   lRow = Sheets(\"Sheet1\").Cells(Rows.Count, \"E\").End(xlUp).Row\n   lRow = lRow + 100\n   LastRow = WorksheetFunction.Max(Sheets(\"Sheet1\").Cells(Rows.Count, \"E\").End(xlUp).Row, 9)\n   LastRow = LastRow + 1\n   sht1.Range(\"A10:Q\" &amp; lRow).Copy\n   sht2.Range(\"A\" &amp; LastRow).PasteSpecial\n\n   Dim rowL As Long\n   rowL = sht1.Range(\"E65536\").End(xlUp).Row\n   sht1.Range(\"B7\").Copy Destination:=sht2.Range(\"R\" &amp; LastRow)\n   sht1.Range(\"D7\").Copy Destination:=sht2.Range(\"S\" &amp; LastRow)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 6331263, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-F8zvto7v4PA/AAAAAAAAAAI/AAAAAAAAACw/h6B_5vCkaOQ/photo.jpg?sz=128", "display_name": "Ebele Maduekwe", "link": "https://stackoverflow.com/users/6331263/ebele-maduekwe"}, "edited": false, "score": 0, "creation_date": 1542873030, "post_id": 53417478, "comment_id": 93726406, "body": "You are absolutely right. Its a mess and I should have cleaned up some of the dead codes before posting it but I was afraid that I will break something after working on it the whole day and it was finally consolidating at 2am in the morning (German time) even though it wasn&#39;t working exactly as I intended. I was going to just take my &quot;half bread&quot; and run with it."}, {"owner": {"reputation": 35, "user_id": 6331263, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-F8zvto7v4PA/AAAAAAAAAAI/AAAAAAAAACw/h6B_5vCkaOQ/photo.jpg?sz=128", "display_name": "Ebele Maduekwe", "link": "https://stackoverflow.com/users/6331263/ebele-maduekwe"}, "edited": false, "score": 0, "creation_date": 1542874092, "post_id": 53417478, "comment_id": 93726897, "body": "Thank you so much for the clean up. To answer some of your questions. Q1: Yes it is open. It is the master workbook with a work sheet open in it with list of countries and list of tab names. Q2: It is surprising but sometimes the location folder names are so long, it is insane. I am in Germany after all. we use long names for things.sorry! Q 3,4 and 5: I don&#39;t remember why I did that. I think I wrote a code and modified it. Q6: That was a leftover code. At first it pasted all the headings from each sheet and I didn&#39;t want that. Thank you so much! I will let you know how it works."}], "tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": true, "score": 0, "last_activity_date": 1542820793, "creation_date": 1542820793, "answer_id": 53417478, "question_id": 53404067, "link": "https://stackoverflow.com/questions/53404067/looping-through-worksheets-in-a-workbook-and-consolidating-each-workbook-in-to-a/53417478#53417478", "title": "Looping through worksheets in a workbook and consolidating each workbook in to a worksheet in the master workbook", "body": "<h1>It's a Mess</h1>\n\n<p>This is <strong>not a solution</strong>, just a work in progress which I cannot continue due to lack of information and knowledge. It could help you to finish what you started. It would be a shame to quit after you have invested so much time in it. If you provide some answers from the questions in the code someone else might help you finish it. The questions are by no means ironic, they're serious questions that I cannot answer for sure.  </p>\n\n<p>The code should be safe, but just <strong>don't save anything</strong> not to lose data.</p>\n\n<p>I would suggest you somehow split such a code into several and ask several questions to get answers in the future.</p>\n\n<pre><code>Option Explicit\n\nSub Consolidate()\n\n  Application.EnableCancelKey = xlDisabled\n\n  ' ThisWorkbook\n  Const cStrCountry As String = \"CountryName\"\n  Const cLngRow1 As Long = 2\n  ' Tip:  To use columns either as string or as integer declare them as Variant.\n  Const cVntColCountries As Variant = \"B\"\n  Const cVntColTabs As Variant = \"C\"\n\n  Const cStrTemplate = \"Screener_User_Template-\"\n  Const cStrMaster As String = \"ebele_test.xlsm\"\n  Const cStrExt = \".xlsx\"\n\n  ' New Worksheet in Master Workbook\n  Const cStrNewHeader1 = \"Identifier\"\n  Const cStrNewHeader2 = \"Company Name\"\n  Const cStrNewHeader3 = \"Country of Incorporation\"\n\n  ' Each Worksheet in Each Workbook\n  Const cLngFirstRow As Long = 3\n  Const cLngLastRow As Long = 150000\n  ' Tip:  To use columns either as string or as integer declare them as Variant.\n  Const cVntFirstCol As Variant = \"A\"\n  Const cVntLastCol As Variant = \"M\"\n\n  ' MsgBox\n  Dim strMsg1 As String\n    strMsg1 = \"Please enter only folder path in this format as \" _\n            &amp; \"C:\\Users\\... Exclude the file name\"\n  Dim strMsg2 As String\n    strMsg2 = \"Incorrect Input. Please paste correct folder path.\"\n  Dim strMsg3 As String\n    strMsg3 = \"Sheet's name can only be up to 253 characters long. \" _\n            &amp; \"Shorten the Excel file name.\"\n\n  ' Workbooks\n'  ThisWorkbook\n  Dim ojbWbEach As Workbook     ' Workbook Looper\n  Dim objWbMaster As Workbook   ' Master Workbook\n\n  ' Worksheets\n'  ThisWorkbook.Worksheets (cStrCountry)\n  Dim objWsEach As Worksheet    ' Worksheet Looper\n  Dim objWsNew As Worksheet     ' New Worksheet\n\n  ' Arrays Pasted From Ranges\n  Dim vntCountries As Variant   ' List of Countries\n  Dim vntTabs As Variant        ' List of Tabs\n\n  ' Ranges\n  Dim objRngEmpty As Range      ' New Sheet Paste Cell\n\n  ' Rows\n  Dim lngPasteRow As Long       ' New Sheet Paste Row\n  Dim lngCountries As Long      ' Countries Counter\n  Dim lngTabs As Long           ' Tabs Counter\n\n  ' Strings\n  Dim strPath As String\n  Dim strFile As String\n  Dim strCountry As String\n\n  With ThisWorkbook.Worksheets(cStrCountry)\n\n    ' Paste list of countries from column cVntColCountries into array\n    vntCountries = .Range(.Cells(cLngRow1, cVntColCountries), _\n        .Cells(Rows.Count, cVntColCountries).End(xlUp)).Value2\n\n    ' Paste list of tabs from column cVntColTabs into array\n    vntTabs = .Range(.Cells(cLngRow1, cVntColTabs), _\n        .Cells(Rows.Count, cVntColTabs).End(xlUp)).Value2\n\n  End With\n  ' The data is in arrays instead of ranges.\n\n  ' 1. According to the following line the workbook objWbMaster is already open.\n  '    Is that true?\n  Set objWbMaster = Workbooks(cStrMaster)\n\n  For lngCountries = LBound(vntCountries) To UBound(vntCountries)\n\n    If vntCountries(lngCountries, 1) &lt;&gt; \"\" Then\n\n        strCountry = vntCountries(lngCountries, 1)\n\n        ' Determine the path to search for files in.\n        strPath = Application.InputBox(Prompt:=strMsg1, _\n          Title:=\"InputBox Method\", Type:=2) ' Type:=2 = text\n\n        ' When Cancel is clicked in Input Box ... Exit Sub\n        If strPath = \"False\" Or IsError(strPath) Then\n          MsgBox strMsg2\n          Exit Sub\n        End If\n        If Right(strPath, 1) &lt;&gt; \"\\\" Then strPath = strPath &amp; \"\\\"\n\n        Application.ScreenUpdating = False\n\n        strFile = Dir(strPath &amp; cStrTemplate &amp; strCountry &amp; \"*\" &amp; cStrExt)\n        ' VBA Help: Dir returns the first file name that matches pathname. To\n        '           get any additional file names that match pathname, call Dir\n        '           again with no arguments. When no more file names match, Dir\n        '           returns a zero-length string (\"\").\n        ' i.e. The approach is correct!\n        Do While strFile &lt;&gt; \"\"\n\n          Set ojbWbEach = Workbooks.Open(strPath &amp; strFile)\n\n          ' 2. When would this ever happen?\n          If Len(ojbWbEach.Name) &lt;= 253 Then\n            ' Add a new sheet with the file's name (remove the extension)\n            With objWbMaster\n              ' 3. Isn't the blnLastSheet always False. What should it be doing?\n              Dim blnLastSheet As Boolean\n              Dim intSheetsCounter As Integer\n              Dim intSheets As Integer\n              intSheets = .Worksheets.Count\n              ' 4. Why parentheses in ... Step (-1)?\n              For intSheetsCounter = intSheets To 1 Step -1\n                ' 5. Why parentheses in (blnLastSheet)?\n                If (blnLastSheet) = False Then\n                  ' Place sheet at the end.\n                  Set objWsNew = .Worksheets _\n                      .Add(After:=.Worksheets(intSheetsCounter))\n                  With objWsNew\n                    .Cells(1, 1) = cStrNewHeader1\n                    .Cells(1, 2) = cStrNewHeader2\n                    .Cells(1, 3) = cStrNewHeader3\n                    .Name = strCountry\n                  End With\n                End If\n              Next\n            End With\n           Else\n            MsgBox strMsg3\n            ojbWbEach.Close False\n            GoTo Exit_Loop\n          End If\n\n          ' Loop through all worksheets in ojbWbEach.\n          For Each objWsEach In ojbWbEach.Worksheets\n            With objWsEach\n\n              For lngTabs = LBound(vntTabs) To UBound(vntTabs)\n                If .Name = vntTabs(lngTabs) _\n                    And objWsNew.Name = strCountry Then\n\n                  ' Get the first empty row in the new sheet\n                  Set objRngEmpty = objWsNew.Cells.Find(What:=\"*\", _\n                      Lookat:=xlPart, LookIn:=xlFormulas, _\n                      SearchOrder:=xlByRows, SearchDirection:=xlPrevious)\n\n                  ' 6. I don't think that this is necessary because you added\n                  '    the headers to the New sheet so it will find the first\n                  '    row. Or am I missing something?\n                  If Not objRngEmpty Is Nothing Then\n                    ' If find is successful.\n                    lngPasteRow = objRngEmpty.row + 1\n                   Else\n                    ' Find was unsuccessfull &gt; new empty sheet.\n                    ' Should paste at the second row.\n                    lngPasteRow = cLngRow1\n                  End If\n\n                  ' if I'm right, delete all starting from \"Set objRngEmpty ...\"\n                  ' and delete \"Dim objRngEmpty as Range\" and use the following\n                  ' line:\n'                  lngPasteRow = objWsNew.Cells.Find(What:=\"*\", Lookat:=xlPart, _\n                      LookIn:=xlFormulas, SearchOrder:=xlByRows, _\n                      SearchDirection:=xlPrevious).row + 1\n\n                  ' Pasting a range into a same sized range is much faster than\n                  ' looping or copy/pasting.\n                  objWsNew.Range(.Cells(lngPasteRow, cVntFirstCol), _\n                      .Cells(cLngLastRow + lngPasteRow - cLngFirstRow, _\n                      cVntLastCol)) = _\n                  .Range(.Cells(cLngFirstRow, cVntFirstCol), _\n                      .Cells(cLngLastRow, cVntLastCol)).Value2\n\n                End If\n              Next\n\n              .Close False\n\n            End With\n          Next\n\nExit_Loop:\n          Set ojbWbEach = Nothing\n          strFile = Dir\n        Loop\n      End If\n    Next lngCountries\n\n  Set objWsEach = Nothing\n  Set objWsNew = Nothing\n  Set objWbEach = Nothing\n  Set objWbMaster = Nothing\n\n  Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 35, "user_id": 6331263, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-F8zvto7v4PA/AAAAAAAAAAI/AAAAAAAAACw/h6B_5vCkaOQ/photo.jpg?sz=128", "display_name": "Ebele Maduekwe", "link": "https://stackoverflow.com/users/6331263/ebele-maduekwe"}, "is_accepted": false, "score": 0, "last_activity_date": 1542893164, "creation_date": 1542893164, "answer_id": 53432021, "question_id": 53404067, "link": "https://stackoverflow.com/questions/53404067/looping-through-worksheets-in-a-workbook-and-consolidating-each-workbook-in-to-a/53432021#53432021", "title": "Looping through worksheets in a workbook and consolidating each workbook in to a worksheet in the master workbook", "body": "<p>Thank you again for the clean up. I made some modifications to your code and corrected some error but for some reason, it is only able to consolidate 7 countries after which excel crashes. See the code I am running below: Do you think you can find the issue?</p>\n\n<p>Option Explicit</p>\n\n<pre><code>Sub Consolidate()\n\n  Application.EnableCancelKey = xlDisabled\n\n  ' ThisWorkbook\n  Const cStrCountry As String = \"CountryName\"\n  Const cLngRow1 As Long = 2\n  ' Tip:  To use columns either as string or as integer declare them as Variant.\n  Const cVntColCountries As Variant = \"B\"\n  Const cVntColTabs As Variant = \"C\"\n\n  Const cStrTemplate = \"Screener_User_Template-\"\n  Const cStrMaster As String = \"ebele_test.xlsm\"\n  Const cStrExt = \".xlsx\"\n\n  ' New Worksheet in Master Workbook\n  Const cStrNewHeader1 = \"Identifier\"\n  Const cStrNewHeader2 = \"Company Name\"\n  Const cStrNewHeader3 = \"Country of Incorporation\"\n\n  ' Each Worksheet in Each Workbook\n  Const cLngFirstRow As Long = 3\n  Const cLngLastRow As Long = 150000\n  ' Tip:  To use columns either as string or as integer declare them as Variant.\n  Const cVntFirstCol As Variant = \"A\"\n  Const cVntLastCol As Variant = \"M\"\n\n  ' MsgBox\n  Dim strMsg1 As String\n    strMsg1 = \"Please enter only folder path in this format as \" _\n            &amp; \"C:\\Users\\... Exclude the file name\"\n  Dim strMsg2 As String\n    strMsg2 = \"Incorrect Input. Please paste correct folder path.\"\n  Dim strMsg3 As String\n    strMsg3 = \"Sheet's name can only be up to 253 characters long. \" _\n            &amp; \"Shorten the Excel file name.\"\n\n  ' Workbooks\n'  ThisWorkbook\n  Dim ojbWbEach As Workbook     ' Workbook Looper\n  Dim objWbMaster As Workbook   ' Master Workbook\n\n  ' Worksheets\n'  ThisWorkbook.Worksheets (cStrCountry)\n  Dim objWsEach As Worksheet    ' Worksheet Looper\n  Dim objWsNew As Worksheet     ' New Worksheet\n\n  ' Arrays Pasted From Ranges\n  Dim vntCountries As Variant   ' List of Countries\n  Dim vntTabs As Variant        ' List of Tabs\n\n  ' Ranges\n  Dim objRngEmpty As Range      ' New Sheet Paste Cell\n\n  ' Rows\n  Dim lngPasteRow As Long       ' New Sheet Paste Row\n  Dim lngCountries As Long      ' Countries Counter\n  Dim lngTabs As Long           ' Tabs Counter\n\n  ' Strings\n  Dim strPath As String\n  Dim strFile As String\n  Dim strCountry As String\n\n  With ThisWorkbook.Worksheets(cStrCountry)\n\n    ' Paste list of countries from column cVntColCountries into array\n    vntCountries = .Range(.Cells(cLngRow1, cVntColCountries), _\n        .Cells(Rows.Count, cVntColCountries).End(xlUp)).Value2\n\n    ' Paste list of tabs from column cVntColTabs into array\n    vntTabs = .Range(.Cells(cLngRow1, cVntColTabs), _\n        .Cells(Rows.Count, cVntColTabs).End(xlUp)).Value2\n\n  End With\n  ' The data is in arrays instead of ranges.\n\n  ' 1. According to the following line the workbook objWbMaster is already open.\n  '    Is that true? yeah, but I moved the strpath up because I want it to be inputed once\n  Set objWbMaster = Workbooks(cStrMaster)\n        ' Determine the path to search for files in.         \n          strPath = Application.InputBox(Prompt:=strMsg1, _\n          Title:=\"InputBox Method\", Type:=2) ' Type:=2 = text\n  '\n  For lngCountries = LBound(vntCountries) To UBound(vntCountries)\n       If vntCountries(lngCountries, 1) &lt;&gt; \"\" And strPath &lt;&gt; \"\" Then\n\n        strCountry = vntCountries(lngCountries, 1)\n\n\n        ' When Cancel is clicked in Input Box ... Exit Sub\n        If strPath = \"False\" Or IsError(strPath) Then\n          MsgBox strMsg2\n          Exit Sub\n        End If\n\n        If Right(strPath, 1) &lt;&gt; \"\\\" Then strPath = strPath &amp; \"\\\"\n\n        Application.ScreenUpdating = False\n\n        strFile = Dir(strPath &amp; cStrTemplate &amp; strCountry &amp; \"*\" &amp; cStrExt)\n        ' VBA Help: Dir returns the first file name that matches pathname. To\n        '           get any additional file names that match pathname, call Dir\n        '           again with no arguments. When no more file names match, Dir\n        '           returns a zero-length string (\"\").\n        ' i.e. The approach is correct!\n        Do While strFile &lt;&gt; \"\"\n\n          Set ojbWbEach = Workbooks.Open(strPath &amp; strFile)\n\n          ' 2. When would this ever happen?\n          If Len(ojbWbEach.Name) &lt;= 253 Then\n            ' Add a new sheet with the file's name (remove the extension)\n            With objWbMaster\n              ' 3. Isn't the blnLastSheet always False. What should it be doing?\n              Dim blnLastSheet As Boolean\n              Dim intSheetsCounter As Integer\n              Dim intSheets As Integer\n              intSheets = .Worksheets.Count\n              ' 4. Why parentheses in ... Step (-1)?\n              For intSheetsCounter = intSheets To 1 Step -1\n                ' 5. Why parentheses in (blnLastSheet)?\n                If blnLastSheet = False Then\n                  ' Place sheet at the end.\n                  Set objWsNew = .Worksheets _\n                      .Add(After:=.Worksheets(intSheetsCounter))\n                  With objWsNew\n                    .Cells(1, 1) = cStrNewHeader1\n                    .Cells(1, 2) = cStrNewHeader2\n                    .Cells(1, 3) = cStrNewHeader3\n\n                  End With\n                End If\n              Next\n            End With\n           Else\n            MsgBox strMsg3\n            ojbWbEach.Close False\n            GoTo Exit_Loop\n          End If\n\n          ' Loop through all worksheets in ojbWbEach.\n          For Each objWsEach In ojbWbEach.Worksheets\n            With objWsEach\n\n              For lngTabs = LBound(vntTabs) To UBound(vntTabs)\n                If .Name = vntTabs(lngTabs, 1) Then\n' _\n                    'And objWsNew.Name = strCountry\n'\n                  ' Get the first empty row in the new sheet\n                      lngPasteRow = objWsNew.Cells.Find(What:=\"*\", Lookat:=xlPart, _\n                      LookIn:=xlFormulas, SearchOrder:=xlByRows, _\n                      SearchDirection:=xlPrevious).row + 1\n\n                  ' Pasting a range into a same sized range is much faster than\n                  ' looping or copy/pasting.\n                  objWsNew.Range(objWsNew.Cells(lngPasteRow, cVntFirstCol), _\n                      objWsNew.Cells(cLngLastRow + lngPasteRow - cLngFirstRow, _\n                      cVntLastCol)) = _\n                  .Range(.Cells(cLngFirstRow, cVntFirstCol), _\n                      .Cells(cLngLastRow, cVntLastCol)).Value2\n                      objWsNew.Name = strCountry\n\n                End If\n              Next\n\n            End With\n\n          Next\n        ojbWbEach.Close False\nExit_Loop:\n          Set ojbWbEach = Nothing\n          strFile = Dir\n        Loop\n        End If\n    Next lngCountries\n\n  Set objWsEach = Nothing\n  Set objWsNew = Nothing\n  Set ojbWbEach = Nothing\n  Set objWbMaster = Nothing\n\n  Call Module2.clean\n  Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>What it does is that it also creates extra blank worksheets which I have to clean up with the sub clean.</p>\n"}], "owner": {"reputation": 35, "user_id": 6331263, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-F8zvto7v4PA/AAAAAAAAAAI/AAAAAAAAACw/h6B_5vCkaOQ/photo.jpg?sz=128", "display_name": "Ebele Maduekwe", "link": "https://stackoverflow.com/users/6331263/ebele-maduekwe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 0, "accepted_answer_id": 53417478, "answer_count": 3, "score": 0, "last_activity_date": 1583657031, "creation_date": 1542763780, "last_edit_date": 1583657031, "question_id": 53404067, "link": "https://stackoverflow.com/questions/53404067/looping-through-worksheets-in-a-workbook-and-consolidating-each-workbook-in-to-a", "title": "Looping through worksheets in a workbook and consolidating each workbook in to a worksheet in the master workbook", "body": "<p>I have search and search for an answer to my code issue but I cant find any. I will be very grateful if someone can take a look at my code. At the moment, I have several large workbooks for data for each country. Each workbook has more that 5 work sheets. I want to consolidate the workbooks into a master file. First, I wan to copy and paste all worksheets under one work sheet in the master workbook and name it all by the country. Right now, my code is only able to consolidate one country at a time which makes it very slow. also the loop worksheet seems to the failing. It creates only one country worksheet. If I put in multiple country names, only the last country workbook gets consolidated. Something is missing but I cant seem to figure it out. Thank you so much!!!! Below is my code:</p>\n\n<pre><code>Sub consolidate()\n\n   Application.EnableCancelKey = xlDisabled\n\n   Dim folderPath As String\n   Dim Filename As String\n   Dim wb As Workbook\n   Dim Masterwb  As Workbook\n   Dim sh As Worksheet\n   Dim NewSht As Worksheet\n   Dim FindRng As Range\n   Dim PasteRow As Long\n\n   Dim countryname As String\n   Dim LastRow, Rowlast, Rowlast2 As Long\n   Const fr As Long = 2\n   Dim i As Long\n   Dim cell As Range\n   Dim wx As Worksheet\n   Set wx = ThisWorkbook.Sheets(\"Countryname\")\n   Rowlast = wx.Range(\"B\" &amp; Rows.Count).End(xlDown).row 'selects list of country workbook I want to consolidate. e.g I could have Germany, usa, china\n   Rowlast2 = wx.Range(\"C\" &amp; Rows.Count).End(xlDown).row 'selects list of tabs for each country workbook I want to consolidate, e.g I want for every country listed above, that sheet names 1, 2, 3, 4 be consolidated and put in new worksheets in the masterfile\n\n   With wx\n      For LastRow = fr To Rowlast\n         If .Cells(LastRow, \"B\").Value &lt;&gt; \"\" Then\n            countryname = .Cells(LastRow, \"B\").Value\n            ' set master workbook\n            Set Masterwb = Workbooks(\"ebele_test.xlsm\")\n            folderPath = Application.InputBox(Prompt:= _\n                  \"Please enter only folder path in this format as C:\\Users\\...  Exclude the file name\", _\n            Title:=\"InputBox Method\", Type:=2) 'Type:=2 = text\n\n            If folderPath = \"False\" Or IsError(folderPath) Then 'If Cancel is clicked on Input Box exit sub\n\n               MsgBox \"Incorrect Input, Please paste correct folder path\"\n               Exit Sub\n               'On Error GoTo 0\n\n            End If\n            If Right(folderPath, 1) &lt;&gt; \"\\\" Then folderPath = folderPath &amp; \"\\\"\n            Application.ScreenUpdating = False\n            Dim str As String\n            str = \"Screener_User_Template-\"\n\n            Filename = Dir(folderPath &amp; str &amp; countryname &amp; \"*.xlsx\")\n            Do While Filename &lt;&gt; \"\"\n               Set wb = Workbooks.Open(folderPath &amp; Filename)\n\n               If Len(wb.Name) &gt; 253 Then\n                  MsgBox \"Sheet's name can be up to 253 characters long, shorten the Excel file name\"\n                  wb.Close False\n                  GoTo Exit_Loop\n               Else\n                  ' add a new sheet with the file's name (remove the extension)\n                  With Masterwb\n                     Dim isLastSheet As Boolean\n                     Dim ci, rows1 As Integer\n                     Dim row As Long\n                     rows1 = ThisWorkbook.Worksheets.Count\n                     For ci = rows1 To 1 Step (-1)\n                        If (isLastSheet) = False Then\n                           Set NewSht = Masterwb.Worksheets.Add(After:=Worksheets(ci)) 'Place sheet at the end.\n                           NewSht.Cells(1, 1) = \"Identifier\"\n                           NewSht.Cells(1, 2) = \"Company Name\"\n                           NewSht.Cells(1, 3) = \"Country of Incorporation\"\n                           NewSht.Name = countryname\n                        End If\n                     Next ci\n                  End With\n\n               End If\n\n               ' loop through all sheets in opened wb\n\n               For Each sh In wb.Worksheets\n                  For i = 2 To Rowlast2\n                     If sh.Name = wx.Cells(i, \"C\").Value And NewSht.Name = countryname Then\n                        ' get the first empty row in the new sheet\n\n                        Set FindRng = NewSht.Cells.Find(What:=\"*\", Lookat:=xlPart, LookIn:=xlFormulas, SearchOrder:=xlByRows, SearchDirection:=xlPrevious, MatchCase:=False)\n\n                        If Not FindRng Is Nothing Then ' If find is successful\n                           PasteRow = FindRng.row + 1\n                        Else ' find was unsuccessfull &gt; new empty sheet, should paste at the second row\n                           PasteRow = 2\n                        End If\n\n                        Dim rng As Range\n                        Set rng = sh.Range(sh.Cells(3, \"A\"), sh.Cells(150000, \"M\"))\n                        rng.Copy\n\n                        NewSht.Range(\"A\" &amp; PasteRow).PasteSpecial xlPasteValues\n\n                     End If\n                     Application.CutCopyMode = False 'Clears the clipboard\n                  Next i\n               Next sh\n               wb.Close False\nExit_Loop:\n               Set wb = Nothing\n               Filename = Dir\n            Loop\n         End If\n      Next LastRow\n   End With\n   '0:  Exit Sub\n   Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1542759236, "post_id": 53403494, "comment_id": 93682141, "body": "If <code>i</code> is an <code>Integer</code> it can overflow. It should be declared as <code>Long</code>. <code>i</code> also needs to be at least 1 when you enter the loop. This also begs the question why you&#39;re using <code>StrComp</code> instead of simply <code>While selectedRecipe &lt;&gt; dataSheet.Cells(i, 1).Value</code>. Finally, you&#39;ll run off the end of the sheet if you don&#39;t find <code>selectedRecipe</code> in column 1."}], "answers": [{"tags": [], "owner": {"reputation": 483, "user_id": 10553841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26a3593367ffd4a0a86def4051490360?s=128&d=identicon&r=PG&f=1", "display_name": "Jon Vote", "link": "https://stackoverflow.com/users/10553841/jon-vote"}, "is_accepted": false, "score": 0, "last_activity_date": 1542759957, "creation_date": 1542759957, "answer_id": 53403616, "question_id": 53403494, "link": "https://stackoverflow.com/questions/53403494/excel-vbahow-to-use-strcomp-in-a-while-statement-when-one-string-is-a-text-valu/53403616#53403616", "title": "Excel VBA:How to use StrComp in a While statement when one string is a text value contained in a cell?", "body": "<p>1) Make sure dataSheet is actually set to a valid sheet. 2) as Comintern said, you need to begin at 1 as Excel is 1 based not zero based. 3) You need to make sure you don't overflow the number of rows: </p>\n\n<pre><code> Public Sub CheckRecipe()\n\n    Dim selectedRecipe As String\n    Dim i As Long\n    selectedRecipe = \"Test\"\n    i = 1\n\n    While StrComp(selectedRecipe, ThisWorkbook.ActiveSheet.Cells(i, 1).Value) &lt;&gt; 0 _\n        And i &lt; ThisWorkbook.ActiveSheet.UsedRange.Rows.Count\n        i = i + 1\n    Wend\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 10683017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19aa4638907b5bcc5965b7bc9540c1e2?s=128&d=identicon&r=PG&f=1", "display_name": "indEng123", "link": "https://stackoverflow.com/users/10683017/indeng123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1583657046, "creation_date": 1542758982, "last_edit_date": 1583657046, "question_id": 53403494, "link": "https://stackoverflow.com/questions/53403494/excel-vbahow-to-use-strcomp-in-a-while-statement-when-one-string-is-a-text-valu", "title": "Excel VBA:How to use StrComp in a While statement when one string is a text value contained in a cell?", "body": "<p>The code returning an error is the first line of the following:</p>\n\n<pre><code>    While StrComp(selectedRecipe, dataSheet.Cells(i, 1)) &lt;&gt; 0\n             recipeRow = recipeRow + 1\n             i = i + 1\n    Wend\n</code></pre>\n\n<p>The debug I'm getting has issues with the While statement line itself. This code is contained under an OK Button click event on a userform, with selectedRecipe defined as a public string variable in the main worksheet sub. \"i\" is defined as an integer in this private sub. Basically the code is to find which row of the sheet holds the string value contained in selectedRecipe after selectedRecipe is selected from a drop-down combo box (selectedRecipe returns correctly and has no issues associated with it). I assume I need to have some sort of \"converting\" command in front of \"dataSheet.Cells(i,1)\" to reinforce the cell value as a string, but am not sure. Thanks!</p>\n"}, {"tags": ["excel", "vba", "charts", "formatting"], "comments": [{"owner": {"reputation": 865, "user_id": 10361731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8873db235bacaa9d53de9c31a0b8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Jchang43", "link": "https://stackoverflow.com/users/10361731/jchang43"}, "edited": false, "score": 1, "creation_date": 1542758765, "post_id": 53403415, "comment_id": 93682033, "body": "Try not using select and using a with statement.   <code>With Activesheet.ChartObjects(&quot;Chart 4&quot;). SeriesColection(1).Datalabels</code>"}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 9918466, "user_type": "registered", "profile_image": "https://graph.facebook.com/2486510041374681/picture?type=large", "display_name": "Dan Sutton", "link": "https://stackoverflow.com/users/9918466/dan-sutton"}, "edited": false, "score": 0, "creation_date": 1542786691, "post_id": 53403598, "comment_id": 93689537, "body": "Thanks Tim. I still get a runtime error &quot;Method &#39;ShowPercentage&#39; of object &#39;DataLabels&#39; Failed. This is being created within Excel 2007 which is likely to be why maybe?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 63, "user_id": 9918466, "user_type": "registered", "profile_image": "https://graph.facebook.com/2486510041374681/picture?type=large", "display_name": "Dan Sutton", "link": "https://stackoverflow.com/users/9918466/dan-sutton"}, "edited": false, "score": 0, "creation_date": 1542787885, "post_id": 53403598, "comment_id": 93690054, "body": "See edit above  -apparently the chart must first be activated - new one for me..."}, {"owner": {"reputation": 63, "user_id": 9918466, "user_type": "registered", "profile_image": "https://graph.facebook.com/2486510041374681/picture?type=large", "display_name": "Dan Sutton", "link": "https://stackoverflow.com/users/9918466/dan-sutton"}, "edited": false, "score": 0, "creation_date": 1542790000, "post_id": 53403598, "comment_id": 93691195, "body": "Hi Tim, Even with the charts activated I get the same error.... :/ very confusing.... any other ideas at all?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 63, "user_id": 9918466, "user_type": "registered", "profile_image": "https://graph.facebook.com/2486510041374681/picture?type=large", "display_name": "Dan Sutton", "link": "https://stackoverflow.com/users/9918466/dan-sutton"}, "edited": false, "score": 0, "creation_date": 1542816400, "post_id": 53403598, "comment_id": 93706553, "body": "Do the charts already have datalabels showing?  If not, you may need to add them first...."}, {"owner": {"reputation": 63, "user_id": 9918466, "user_type": "registered", "profile_image": "https://graph.facebook.com/2486510041374681/picture?type=large", "display_name": "Dan Sutton", "link": "https://stackoverflow.com/users/9918466/dan-sutton"}, "edited": false, "score": 0, "creation_date": 1542968669, "post_id": 53403598, "comment_id": 93762551, "body": "Hi Tim, Yes that automatically have data label showing. I thought this might be the problem so introduced the .applydatalabels, didn&#39;t work same error, then tried .hasdatalabels=true, same error. built in an if function to only run the changes to data labels if the Showpercentage and ShowValue were not equal to what I was trying to change them to.. same error."}, {"owner": {"reputation": 63, "user_id": 9918466, "user_type": "registered", "profile_image": "https://graph.facebook.com/2486510041374681/picture?type=large", "display_name": "Dan Sutton", "link": "https://stackoverflow.com/users/9918466/dan-sutton"}, "edited": false, "score": 0, "creation_date": 1543227112, "post_id": 53403598, "comment_id": 93827518, "body": "Found an answer, see above. Thanks for your help"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1542787853, "last_edit_date": 1542787853, "creation_date": 1542759800, "answer_id": 53403598, "question_id": 53403415, "link": "https://stackoverflow.com/questions/53403415/pie-chart-vba-datalabel-formatting/53403598#53403598", "title": "Pie Chart VBA DataLabel Formatting", "body": "<p>Something like this:   </p>\n\n<pre><code>Sub UpdateChartFormat()\n\n   With ActiveSheet.ChartObjects(\"Chart 4\")\n       .Activate\n       With .Chart.SeriesCollection(1).DataLabels\n           .ShowPercentage = True\n           .Separator = \"\" &amp; Chr(10) &amp; \"\"\n       End With\n   End With\n\n   With ActiveSheet.ChartObjects(\"Chart 1\")\n        .Activate\n        With .Chart.SeriesCollection(1).DataLabels\n            .ShowPercentage = True\n            .ShowValue = False\n        End With\n   End With\n\nEnd Sub\n</code></pre>\n\n<p>According to <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.datalabels.showpercentage\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/api/excel.datalabels.showpercentage</a></p>\n\n<blockquote>\n  <p>Remarks The chart must first be active before you can access the data\n  labels programmatically or a run-time error will occur.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 63, "user_id": 9918466, "user_type": "registered", "profile_image": "https://graph.facebook.com/2486510041374681/picture?type=large", "display_name": "Dan Sutton", "link": "https://stackoverflow.com/users/9918466/dan-sutton"}, "is_accepted": true, "score": 0, "last_activity_date": 1543227070, "creation_date": 1543227070, "answer_id": 53478856, "question_id": 53403415, "link": "https://stackoverflow.com/questions/53403415/pie-chart-vba-datalabel-formatting/53478856#53478856", "title": "Pie Chart VBA DataLabel Formatting", "body": "<p>Managed to create a loop using the following code that updates the DataLabels format to how I wanted it by going through each point.</p>\n\n<pre><code>Sub FormatDataLabels()\nDim intPntCount As Integer\n\nActiveSheet.ChartObjects(\"Chart 4\").Activate\nWith ActiveChart.SeriesCollection(1)\n    For intPntCount = 1 To .Points.Count\n        .Points(intPntCount).ApplyDataLabels _\n            AutoText:=False, ShowSeriesName:=False, ShowCategoryName:=False, _\n            ShowValue:=True, ShowPercentage:=True, Separator:=\"\" &amp; Chr(10) &amp; \"\"\n    Next intPntCount\nEnd With\nActiveSheet.ChartObjects(\"Chart 1\").Activate\n    With ActiveChart.SeriesCollection(1)\n    For intPntCount = 1 To .Points.Count\n        .Points(intPntCount).ApplyDataLabels _\n            AutoText:=False, ShowSeriesName:=False, ShowCategoryName:=False, _\n            ShowValue:=False, ShowPercentage:=True, Separator:=\"\" &amp; Chr(10) &amp; \"\"\n    Next intPntCount\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 9918466, "user_type": "registered", "profile_image": "https://graph.facebook.com/2486510041374681/picture?type=large", "display_name": "Dan Sutton", "link": "https://stackoverflow.com/users/9918466/dan-sutton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1482, "favorite_count": 0, "accepted_answer_id": 53478856, "answer_count": 2, "score": 0, "last_activity_date": 1543227155, "creation_date": 1542758446, "last_edit_date": 1543227155, "question_id": 53403415, "link": "https://stackoverflow.com/questions/53403415/pie-chart-vba-datalabel-formatting", "title": "Pie Chart VBA DataLabel Formatting", "body": "<p>Evening all,</p>\n\n<p>I have been stuck for a few hours trying to overcome an issue i am facing with formatting charts using VBA. </p>\n\n<p>So i recorded the following macro based on updating a chart to reflect the formats i want.. the issue is that when i then run this macro again i get \"Method 'Select' of object 'Datalabels' failed\"</p>\n\n<pre><code>Sub UpdateChartFormat()\n   ActiveSheet.ChartObjects(\"Chart 4\").Activate\n   ActiveChart.SeriesCollection(1).DataLabels.Select\n   Selection.ShowPercentage = True\n   Selection.Separator = \"\" &amp; Chr(10) &amp; \"\"\n   ActiveSheet.ChartObjects(\"Chart 1\").Activate\n   ActiveChart.SeriesCollection(1).DataLabels.Select\n   Selection.ShowPercentage = True\n   Selection.ShowValue = False\n   ActiveSheet.Range(\"D32\").Select\n   End Sub\n</code></pre>\n\n<p>I would really appreciate some help with this, have not been able to find the fix elsewhere. </p>\n\n<p>I'm thinking it might have to do with the series collection as well because the charts are dynamic and the series name changes based on user selection. </p>\n\n<p>Ideally, i would like to run this as part of another larger macro without activating the charts if that is possible.</p>\n\n<p>Thanks in advance!</p>\n\n<p>EDIT:</p>\n\n<p>So this now runs the code without any errors but doesn't actually update the formatting XD</p>\n\n<pre><code>Sub UpdateChartFormat()\n\nWith ActiveWorkbook.Sheets(\"MHFA Summary\").ChartObjects(\"Chart 4\").Activate\n   With ActiveChart.SeriesCollection(1).DataLabels _\n       .ShowPercentage = True\n   With ActiveChart.SeriesCollection(1).DataLabels _\n       .Separator = \"\" &amp; Chr(10) &amp; \"\"\n   End With\n   End With\nEnd With\nWith ActiveWorkbook.Sheets(\"MHFA Summary\").ChartObjects(\"Chart 1\").Activate\n   With ActiveChart.SeriesCollection(1).DataLabels _\n       .ShowPercentage = True\n   With ActiveChart.SeriesCollection(1).DataLabels _\n       .Separator = \"\" &amp; Chr(10) &amp; \"\"\n   End With\n   End With\nEnd With\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1542757116, "post_id": 53403180, "comment_id": 93681675, "body": "Why does this need to be an &quot;elaborate&quot; VLOOKUP?  This is literally what VLOOKUP <i>does</i>.  I.e. if your example above is A1:A7, <code>=VLOOKUP(&quot;1A-1&quot;, A1:A7, 1)</code>"}, {"owner": {"reputation": 299, "user_id": 6850479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7403e272dbfeb0588a3184d1a9fb4df2?s=128&d=identicon&r=PG&f=1", "display_name": "Basher", "link": "https://stackoverflow.com/users/6850479/basher"}, "edited": false, "score": 0, "creation_date": 1542757213, "post_id": 53403180, "comment_id": 93681694, "body": "I can understand you want to compare Cell A3 to Column D, but can you clarify further what you mean by &quot;return to the adjacent cell to 1A-1? What value are you returning?"}, {"owner": {"reputation": 39, "user_id": 10682931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a68f5f5d02530ace6bb50878795b78e?s=128&d=identicon&r=PG&f=1", "display_name": "d. Kim", "link": "https://stackoverflow.com/users/10682931/d-kim"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1542759066, "post_id": 53403180, "comment_id": 93682106, "body": "@comintern well the thing is I&#39;ve tried using Vlookup for some time... as I have the compliance document seperated by the number and the next column over has the actual compliance information...   So this is what it looks like at the moment: =VLOOKUP(A35,C:D,2,FALSE) and I get #N/A"}, {"owner": {"reputation": 39, "user_id": 10682931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a68f5f5d02530ace6bb50878795b78e?s=128&d=identicon&r=PG&f=1", "display_name": "d. Kim", "link": "https://stackoverflow.com/users/10682931/d-kim"}, "reply_to_user": {"reputation": 299, "user_id": 6850479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7403e272dbfeb0588a3184d1a9fb4df2?s=128&d=identicon&r=PG&f=1", "display_name": "Basher", "link": "https://stackoverflow.com/users/6850479/basher"}, "edited": false, "score": 0, "creation_date": 1542759281, "post_id": 53403180, "comment_id": 93682151, "body": "@Basher I meant the adjacent cell as in if &quot;1A-1&quot; lived in A2, B2 would be the adjacent cell where I&#39;ve run either VLookUp or some macro to extract information from the compliance doc info... which lives in C and D.  Does that clear up what I&#39;m asking..?"}, {"owner": {"reputation": 299, "user_id": 6850479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7403e272dbfeb0588a3184d1a9fb4df2?s=128&d=identicon&r=PG&f=1", "display_name": "Basher", "link": "https://stackoverflow.com/users/6850479/basher"}, "edited": false, "score": 0, "creation_date": 1542759803, "post_id": 53403180, "comment_id": 93682252, "body": "@d.Kim Yes, and your code seems to be working fine when I test it out, assuming that the value in A35 exists in the C column."}, {"owner": {"reputation": 39, "user_id": 10682931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a68f5f5d02530ace6bb50878795b78e?s=128&d=identicon&r=PG&f=1", "display_name": "d. Kim", "link": "https://stackoverflow.com/users/10682931/d-kim"}, "reply_to_user": {"reputation": 299, "user_id": 6850479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7403e272dbfeb0588a3184d1a9fb4df2?s=128&d=identicon&r=PG&f=1", "display_name": "Basher", "link": "https://stackoverflow.com/users/6850479/basher"}, "edited": false, "score": 0, "creation_date": 1542759910, "post_id": 53403180, "comment_id": 93682274, "body": "@Basher see that is the problem I am having as well... The compliance number DOES show... it just doesn&#39;t want to be recognized for some reason, I have no idea what is going on.. I&#39;m guessing I&#39;ve been just running around in circles when the problem has been at the basic data level, not my logics..."}, {"owner": {"reputation": 299, "user_id": 6850479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7403e272dbfeb0588a3184d1a9fb4df2?s=128&d=identicon&r=PG&f=1", "display_name": "Basher", "link": "https://stackoverflow.com/users/6850479/basher"}, "edited": false, "score": 0, "creation_date": 1542760159, "post_id": 53403180, "comment_id": 93682316, "body": "@d.Kim If it&#39;s not the formula, it&#39;s your data. It&#39;s possible that you have a space after the data. Try selecting the C column, do CTRL+F and go to the Replace tab. Put a space on &quot;Find What&quot; and click &quot;Replace all&quot; and see if that works."}, {"owner": {"reputation": 39, "user_id": 10682931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a68f5f5d02530ace6bb50878795b78e?s=128&d=identicon&r=PG&f=1", "display_name": "d. Kim", "link": "https://stackoverflow.com/users/10682931/d-kim"}, "reply_to_user": {"reputation": 299, "user_id": 6850479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7403e272dbfeb0588a3184d1a9fb4df2?s=128&d=identicon&r=PG&f=1", "display_name": "Basher", "link": "https://stackoverflow.com/users/6850479/basher"}, "edited": false, "score": 0, "creation_date": 1542760758, "post_id": 53403180, "comment_id": 93682450, "body": "@Basher I&#39;ve tried to find the cells and they show... so I&#39;m not sure what is going on... I also tried your method for one of the cells, it did replace 4 cells but the vlookup still did not work. Truly mysterious and rather annoying..."}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1542761687, "post_id": 53403180, "comment_id": 93682685, "body": "Is the typo A35 in &#39;=VLOOKUP(A35,C:D,2,FALSE)&#39; your problem? It should be &#39;=VLOOKUP(A3,C:D,2,FALSE)&#39;. BTW from VBA Help: &quot;If range_lookup is TRUE, the values in the first column of table_array must be placed in ascending order: ..., -2, -1, 0, 1, 2, ..., A-Z, FALSE, TRUE; otherwise VLOOKUP may not give the correct value. If range_lookup is FALSE, table_array does NOT need to be sorted.&quot; In short: The data doesn&#39;t have be sorted. So it seems you&#39;re doing everything right. It should work."}], "answers": [{"tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 1, "last_activity_date": 1542766266, "last_edit_date": 1542766266, "creation_date": 1542763894, "answer_id": 53404085, "question_id": 53403180, "link": "https://stackoverflow.com/questions/53403180/excel-vba-formula-to-find-a-cell-that-includes-search-term/53404085#53404085", "title": "Excel VBA/Formula to find a cell that includes search term?", "body": "<h1>VLOOKUP vs INDEX/MATCH</h1>\n\n<p><a href=\"https://i.stack.imgur.com/KxHDN.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KxHDN.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>You can do the 'lookup' two ways (that I'm aware of):</p>\n\n<p>Using <strong>VLOOKUP</strong>:</p>\n\n<p>The B3 cell contains your formula</p>\n\n<pre><code>=IF(ISERROR(VLOOKUP(A3,C:D,2,FALSE)),\"\",VLOOKUP(A3,C:D,2,FALSE))\n</code></pre>\n\n<p>where '<strong>FALSE</strong>' is indicating there has to be an exact match and the data doesn't have to be sorted.</p>\n\n<p>Using <strong>INDEX</strong> with <strong>MATCH</strong>:</p>\n\n<p>The F3 cell contains the Index/Match formula</p>\n\n<pre><code>=IF(ISERROR(MATCH(A3,C:C,0)),\"\",INDEX(D:D,MATCH(A3,C:C,0)))\n</code></pre>\n\n<p>where '<strong>0</strong>' is indicating there has to be an exact match and the data doesn't have to be sorted.</p>\n\n<h2>INDEX/MATCH preferable!?</h2>\n\n<p>The <strong>MATCH</strong> function finds the position (row number if whole column is used) of the f<strong>ound match</strong>. This way (there's another) of using the <strong>INDEX</strong> function uses exactly this <strong>found match</strong> to return a cell's value in that position (row) in <strong>ANY</strong> specified column range (column). So they are the ideal combination.</p>\n\n<p>With the <strong>VLOOKUP</strong> function you have to additionally specify the column index (range_lookup) of a range which could get complicated when the columns aren't adjacent as in this case. Most importantly, the function doesn't work if the lookup data is to the right of the match data.</p>\n\n<p><a href=\"https://i.stack.imgur.com/AL6ws.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AL6ws.jpg\" alt=\"enter image description here\">VLOOKUP NOT WORKING! INDEX/MATCH STILL WORKING!</a></p>\n"}, {"tags": [], "owner": {"reputation": 1331, "user_id": 10498111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8dd0523c4e1cb82448b30957581803a6?s=128&d=identicon&r=PG&f=1", "display_name": "usmanhaq", "link": "https://stackoverflow.com/users/10498111/usmanhaq"}, "is_accepted": false, "score": 0, "last_activity_date": 1543041186, "creation_date": 1543041186, "answer_id": 53455775, "question_id": 53403180, "link": "https://stackoverflow.com/questions/53403180/excel-vba-formula-to-find-a-cell-that-includes-search-term/53455775#53455775", "title": "Excel VBA/Formula to find a cell that includes search term?", "body": "<p>try this formula</p>\n\n<p><a href=\"https://i.stack.imgur.com/3y3ec.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3y3ec.png\" alt=\"enter image description here\"></a></p>\n\n<p>The formula in cells</p>\n\n<pre><code>B2: =INDEX(E:E,MATCH(A2,F:F,0))\nC2: =INDEX(G:G,MATCH(A2,F:F,0))\n</code></pre>\n\n<ul>\n<li>MATCH(A2,F:F,0) is finding Cell A2 in column F (0 means it will find\nexact match) and will return the first row number when it would find that</li>\n<li>INDEX(E:E,MATCH(A2,F:F,0)) will return contents of column E where row number is returned by the Match formula</li>\n</ul>\n"}], "owner": {"reputation": 39, "user_id": 10682931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a68f5f5d02530ace6bb50878795b78e?s=128&d=identicon&r=PG&f=1", "display_name": "d. Kim", "link": "https://stackoverflow.com/users/10682931/d-kim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1583657057, "creation_date": 1542756663, "last_edit_date": 1583657057, "question_id": 53403180, "link": "https://stackoverflow.com/questions/53403180/excel-vba-formula-to-find-a-cell-that-includes-search-term", "title": "Excel VBA/Formula to find a cell that includes search term?", "body": "<p>I was not sure how to really create the question...\nBut the problem I am having is this: I have a list (in rows) that relate to a regulatory document, and after trying to create some sort of for loop or elaborate VLookUp/Index formula, I'm requesting help.\nFor example:</p>\n\n<p><img src=\"https://i.stack.imgur.com/ijL6W.png\" alt=\"Excel Rows\"></p>\n\n<p>Now I want to use the rows to find the corresponding section in the document. I've already extracted and formatted the compliance document so it is in excel format.</p>\n\n<p>So what I really need is this: a formula or VBA script that can\n1. take the compliance number (for example 1A-1 which exist in Cell A3) and go find a cell (in single column D) that has JUST 1A-1, not 1A-1.1, not 1A-1.1.2, etc. and return it to the adjacent cell to 1A-1, for example.</p>\n\n<p>Many thanks ahead of time... I am so lost!! :/</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 529, "user_id": 10277540, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uhl4j.png?s=128&g=1", "display_name": "Display name", "link": "https://stackoverflow.com/users/10277540/display-name"}, "edited": false, "score": 1, "creation_date": 1542757531, "post_id": 53403017, "comment_id": 93681762, "body": "remove the array() part"}, {"owner": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "edited": false, "score": 0, "creation_date": 1542778604, "post_id": 53403017, "comment_id": 93686510, "body": "When asking a question, remember to include the exact content of error messages you encounter. In this case it was probably &quot;AutoFilter method of Range class failed&quot;."}], "owner": {"reputation": 45, "user_id": 7600660, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yBEsasJspFY/AAAAAAAAAAI/AAAAAAAAAAc/QbiQwFTZbsg/photo.jpg?sz=128", "display_name": "Martin Goni", "link": "https://stackoverflow.com/users/7600660/martin-goni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1542755561, "creation_date": 1542755561, "question_id": 53403017, "link": "https://stackoverflow.com/questions/53403017/vba-excluding-wildcard-values-in-autofilter", "title": "VBA - excluding wildcard values in autofilter?", "body": "<p>I have to make 2 excel sheets. One for all accounts of a certain customer, one without. Unfortunately, the way the customer name is laid out, I have to search for these customers using a wildcard. </p>\n\n<p>The Macro for only the customer works fine, but the macro to exclude the customer does not. </p>\n\n<p>Working Macro:</p>\n\n<pre><code>Sheets(\"AR Aging\").Range(\"A:J\").AutoFilter Field:=2, Criteria1:=Array( _\n\"*COMPANY*\"), Operator:=xlFilterValues\n\nRange(\"A:J\").Copy\nSheets.Add After:=Sheets(7)\nActiveSheet.Paste\nSheets(8).Select\nSheets(8).Name = \"XYZ\"\n\nSheets(\"AR Aging\").AutoFilterMode = False\nSheets(\"AR Aging\").Activate\nApplication.CutCopyMode = False\n</code></pre>\n\n<p>The only difference is in the non-working macro, </p>\n\n<pre><code>Criteria1:=Array( \"*COMPANY*\")\n</code></pre>\n\n<p>was changed to</p>\n\n<pre><code>Criteria1:=Array( \"&lt;&gt;*COMPANY*\")\n</code></pre>\n\n<p>and the sheet numbers were changed. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "edited": false, "score": 0, "creation_date": 1583660809, "post_id": 53402925, "comment_id": 107186119, "body": "Just loop over all workbooks and apply VLOOKUP on each."}], "answers": [{"tags": [], "owner": {"reputation": 29, "user_id": 10492520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c771b8e78e9d237ac3696d88626f34a4?s=128&d=identicon&r=PG&f=1", "display_name": "Mondee", "link": "https://stackoverflow.com/users/10492520/mondee"}, "is_accepted": false, "score": 0, "last_activity_date": 1542769772, "creation_date": 1542769772, "answer_id": 53404741, "question_id": 53402925, "link": "https://stackoverflow.com/questions/53402925/vlookup-across-multiple-workbooks/53404741#53404741", "title": "VLOOKUP across multiple workbooks", "body": "<p>Pick column that has no blank in setting last row to vlookup in entire column</p>\n\n<pre><code>LastRow = WorksheetFunction.Max(Sheets(\"Sheet1\").Cells(Rows.Count, \"E\").End(xlUp).Row, 9)\n</code></pre>\n\n<p>then for vlookup that has multiple workbook, set your workbooks</p>\n\n<pre><code>Sub VlookMultipleWorkbooks()\nDim lookFor as String\nDim srchRange as Range\nDim book1 as Workbook\nDim book2 as Workbook\n\n'Set some Workbook variables:\nSet book1 = Workbooks(\"Book 1 Name\") '&lt;edit as needed\nSet book2 = Workbooks(\"Book 2 Name\") '&lt;edit as needed\n\n'Set a string variable that we will search for:\nlookFor = book2.sheets(5).range(Cells(j, c + 1))\n\n'Define the range to be searched in Book1.Sheets(4):\nSet srchRange = book1.Sheets(4).Range(cells(row1+2,1).Address, cells(row2,col1).Address)\n\n'This assumes that the Book2 is Open and you are on the desired active worksheet:\nActiveSheet.Cells(j, c + 2).value = _\n     Application.WorksheetFunction.VLookup(lookFor, _\n     book1.Sheets(4).Range(srchRange.Address), 3, False)\n\nEnd Sub\n</code></pre>\n\n<p>refer to this link for vlookup with multiple vlookup <a href=\"https://stackoverflow.com/questions/15658334/vba-vlookup-across-workbooks\">Sub VlookupMultipleWorkbook</a></p>\n"}], "owner": {"reputation": 27, "user_id": 9608869, "user_type": "registered", "profile_image": "https://graph.facebook.com/1604398239608582/picture?type=large", "display_name": "Fabricio Martinez", "link": "https://stackoverflow.com/users/9608869/fabricio-martinez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1583660717, "creation_date": 1542755039, "last_edit_date": 1583660717, "question_id": 53402925, "link": "https://stackoverflow.com/questions/53402925/vlookup-across-multiple-workbooks", "title": "VLOOKUP across multiple workbooks", "body": "<p>I am basically creating a VBA script to clean out a report sheet. I have everything downpacked but cannot figure out how to make <code>VLOOKUP</code> work to check on multiple workbooks. I basically have to match serial numbers on the report to serial numbers located either on folder A or Folder B.</p>\n\n<p>As of right now, I have manually set the <code>Range().Value =VLOOKUP</code> for only one workbook but If I do it for a second then it might create conflicts. However, I want to know if it's possible to <code>VLOOKUP</code> an entire column from the <code>LastRow</code> up and ignore blanks while checking both workbooks. </p>\n\n<pre><code>Sub LowTonerSOC()\nDim i As Long\n\n\nFor i = Cells(Rows.Count, \"J\").End(xlUp).Row To 2 Step -1\n    If Cells(i, \"J\") &lt;&gt; \"Yes\" Then Rows(i).Delete\nNext i\n\nFor i = Cells(Rows.Count, \"K\").End(xlUp).Row To 2 Step -1\n    If Cells(i, \"K\") &lt;&gt; \"Yes\" Then Rows(i).Delete\nNext i\n\nFor i = Cells(Rows.Count, \"O\").End(xlUp).Row To 2 Step -1\n    If Cells(i, \"O\") &lt;&gt; \"Headquarters\" And Cells(i, \"O\") &lt;&gt; \"INDUSTRIAL\" And Cells(i, \"O\") &lt;&gt; \"VAUSA\" Then Rows(i).Delete\nNext i\n\nColumns(1).EntireColumn.Delete\nColumns(1).EntireColumn.Delete\nColumns(1).EntireColumn.Delete\nColumns(7).EntireColumn.Delete\nColumns(7).EntireColumn.Delete\nColumns(7).EntireColumn.Delete\nColumns(7).EntireColumn.Delete\nColumns(7).EntireColumn.Delete\nColumns(7).EntireColumn.Delete\nColumns(7).EntireColumn.Delete\n\nRange(\"C:F\" &amp; LastRow).Replace \"\", \"999\", xlWhole\n\nFor i = Cells(Rows.Count, \"A\").End(xlUp).Row To 2 Step -1\n    If Cells(i, \"C\").Value2 &gt;= 10 And Cells(i, \"D\").Value2 &gt;= 10 And Cells(i, \"E\").Value2 &gt;= 10 And Cells(i, \"F\").Value2 &gt;= 10 Then\n        Rows(i).Delete\n    End If\nNext i\n\nFor i = Cells(Rows.Count, \"C\").End(xlUp).Row To 2 Step -1\n    If Cells(i, \"C\").Value2 &lt;= 10 Then\n    Cells(i, \"C\").Interior.ColorIndex = 15\n    End If\nNext i\n\nFor i = Cells(Rows.Count, \"D\").End(xlUp).Row To 2 Step -1\n    If Cells(i, \"D\").Value2 &lt;= 10 Then\n    Cells(i, \"D\").Interior.ColorIndex = 8\n    End If\nNext i\n\nFor i = Cells(Rows.Count, \"E\").End(xlUp).Row To 2 Step -1\n    If Cells(i, \"E\").Value2 &lt;= 10 Then\n    Cells(i, \"E\").Interior.ColorIndex = 3\n    End If\nNext i\n\nFor i = Cells(Rows.Count, \"F\").End(xlUp).Row To 2 Step -1\n    If Cells(i, \"F\").Value2 &lt;= 10 Then\n    Cells(i, \"F\").Interior.ColorIndex = 6\n    End If\nNext i\n\nApplication.Calculation = xlAutomatic\nRange(\"C:F\" &amp; LastRow).Replace \"999\", \"\", xlWhole\n\nActiveSheet.Name = \"Sheet1\"\n\nRange(\"G1\").Value = \"Physical Location\"\nRange(\"G2\").Value = \"=VLOOKUP(B2,'\\\\spwsrf\\Deskside\\Desktop\\EUS\\AssestInventory\\Printers\\[Printers.xlsm]Sheet1'!$F$1:$G$230,2,0)\"\nRange(\"G3\").Value = \"=VLOOKUP(B3,'\\\\spwsrf\\Deskside\\Desktop\\EUS\\AssestInventory\\Printers\\[Printers.xlsm]Sheet1'!$F$1:$G$230,2,0)\"\nRange(\"G4\").Value = \"=VLOOKUP(B4,'\\\\spwsrf\\Deskside\\Desktop\\EUS\\AssestInventory\\Printers\\[Printers.xlsm]Sheet1'!$F$1:$G$230,2,0)\"\nRange(\"G5\").Value = \"=VLOOKUP(B5,'\\\\spwsrf\\Deskside\\Desktop\\EUS\\AssestInventory\\Printers\\[Printers.xlsm]Sheet1'!$F$1:$G$230,2,0)\"\nRange(\"G6\").Value = \"=VLOOKUP(B6,'\\\\spwsrf\\Deskside\\Desktop\\EUS\\AssestInventory\\Printers\\[Printers.xlsm]Sheet1'!$F$1:$G$230,2,0)\"\nRange(\"G7\").Value = \"=VLOOKUP(B7,'\\\\spwsrf\\Deskside\\Desktop\\EUS\\AssestInventory\\Printers\\[Printers.xlsm]Sheet1'!$F$1:$G$230,2,0)\"\nRange(\"G8\").Value = \"=VLOOKUP(B8,'\\\\spwsrf\\Deskside\\Desktop\\EUS\\AssestInventory\\Printers\\[Printers.xlsm]Sheet1'!$F$1:$G$230,2,0)\"\nRange(\"G9\").Value = \"=VLOOKUP(B9,'\\\\spwsrf\\Deskside\\Desktop\\EUS\\AssestInventory\\Printers\\[Printers.xlsm]Sheet1'!$F$1:$G$230,2,0)\"\nRange(\"G10\").Value = \"=VLOOKUP(B10,'\\\\spwsrf\\Deskside\\Desktop\\EUS\\AssestInventory\\Printers\\[Printers.xlsm]Sheet1'!$F$1:$G$230,2,0)\"\nRange(\"G11\").Value = \"=VLOOKUP(B11,'\\\\spwsrf\\Deskside\\Desktop\\EUS\\AssestInventory\\Printers\\[Printers.xlsm]Sheet1'!$F$1:$G$230,2,0)\"\nRange(\"G12\").Value = \"=VLOOKUP(B12,'\\\\spwsrf\\Deskside\\Desktop\\EUS\\AssestInventory\\Printers\\[Printers.xlsm]Sheet1'!$F$1:$G$230,2,0)\"\nRange(\"G13\").Value = \"=VLOOKUP(B13,'\\\\spwsrf\\Deskside\\Desktop\\EUS\\AssestInventory\\Printers\\[Printers.xlsm]Sheet1'!$F$1:$G$230,2,0)\"\nRange(\"G14\").Value = \"=VLOOKUP(B14,'\\\\spwsrf\\Deskside\\Desktop\\EUS\\AssestInventory\\Printers\\[Printers.xlsm]Sheet1'!$F$1:$G$230,2,0)\"\nRange(\"G15\").Value = \"=VLOOKUP(B15,'\\\\spwsrf\\Deskside\\Desktop\\EUS\\AssestInventory\\Printers\\[Printers.xlsm]Sheet1'!$F$1:$G$230,2,0)\"\nRange(\"G16\").Value = \"=VLOOKUP(B16,'\\\\spwsrf\\Deskside\\Desktop\\EUS\\AssestInventory\\Printers\\[Printers.xlsm]Sheet1'!$F$1:$G$230,2,0)\"\nRange(\"G17\").Value = \"=VLOOKUP(B17,'\\\\spwsrf\\Deskside\\Desktop\\EUS\\AssestInventory\\Printers\\[Printers.xlsm]Sheet1'!$F$1:$G$230,2,0)\"\nRange(\"G18\").Value = \"=VLOOKUP(B18,'\\\\spwsrf\\Deskside\\Desktop\\EUS\\AssestInventory\\Printers\\[Printers.xlsm]Sheet1'!$F$1:$G$230,2,0)\"\nRange(\"G19\").Value = \"=VLOOKUP(B19,'\\\\spwsrf\\Deskside\\Desktop\\EUS\\AssestInventory\\Printers\\[Printers.xlsm]Sheet1'!$F$1:$G$230,2,0)\"\nRange(\"G20\").Value = \"=VLOOKUP(B20,'\\\\spwsrf\\Deskside\\Desktop\\EUS\\AssestInventory\\Printers\\[Printers.xlsm]Sheet1'!$F$1:$G$230,2,0)\"\nRange(\"G21\").Value = \"=VLOOKUP(B21,'\\\\spwsrf\\Deskside\\Desktop\\EUS\\AssestInventory\\Printers\\[Printers.xlsm]Sheet1'!$F$1:$G$230,2,0)\"\nRange(\"G22\").Value = \"=VLOOKUP(B22,'\\\\spwsrf\\Deskside\\Desktop\\EUS\\AssestInventory\\Printers\\[Printers.xlsm]Sheet1'!$F$1:$G$230,2,0)\"\nRange(\"G23\").Value = \"=VLOOKUP(B23,'\\\\spwsrf\\Deskside\\Desktop\\EUS\\AssestInventory\\Printers\\[Printers.xlsm]Sheet1'!$F$1:$G$230,2,0)\"\nRange(\"G24\").Value = \"=VLOOKUP(B24,'\\\\spwsrf\\Deskside\\Desktop\\EUS\\AssestInventory\\Printers\\[Printers.xlsm]Sheet1'!$F$1:$G$230,2,0)\"\nRange(\"G25\").Value = \"=VLOOKUP(B25,'\\\\spwsrf\\Deskside\\Desktop\\EUS\\AssestInventory\\Printers\\[Printers.xlsm]Sheet1'!$F$1:$G$230,2,0)\"\nRange(\"G26\").Value = \"=VLOOKUP(B26,'\\\\spwsrf\\Deskside\\Desktop\\EUS\\AssestInventory\\Printers\\[Printers.xlsm]Sheet1'!$F$1:$G$230,2,0)\"\nRange(\"G27\").Value = \"=VLOOKUP(B27,'\\\\spwsrf\\Deskside\\Desktop\\EUS\\AssestInventory\\Printers\\[Printers.xlsm]Sheet1'!$F$1:$G$230,2,0)\"\nRange(\"G28\").Value = \"=VLOOKUP(B28,'\\\\spwsrf\\Deskside\\Desktop\\EUS\\AssestInventory\\Printers\\[Printers.xlsm]Sheet1'!$F$1:$G$230,2,0)\"\nRange(\"G29\").Value = \"=VLOOKUP(B29,'\\\\spwsrf\\Deskside\\Desktop\\EUS\\AssestInventory\\Printers\\[Printers.xlsm]Sheet1'!$F$1:$G$230,2,0)\"\nRange(\"G30\").Value = \"=VLOOKUP(B30,'\\\\spwsrf\\Deskside\\Desktop\\EUS\\AssestInventory\\Printers\\[Printers.xlsm]Sheet1'!$F$1:$G$230,2,0)\"\n\n\nApplication.ScreenUpdating = False\nColumns(\"A:A\").SpecialCells(xlCellTypeBlanks).EntireRow.Delete\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2007"], "comments": [{"owner": {"reputation": 453, "user_id": 2669681, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/efb225f101bbb27b11dc7b2209991c7d?s=128&d=identicon&r=PG", "display_name": "mdialogo", "link": "https://stackoverflow.com/users/2669681/mdialogo"}, "edited": false, "score": 1, "creation_date": 1542758115, "post_id": 53402669, "comment_id": 93681900, "body": "Is your table a local or link table?  I just tried it on a local table and the AutoNumber ID field automatically increments when I copy-pasted the same rows including its ID field."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 1, "creation_date": 1542765077, "post_id": 53402669, "comment_id": 93683461, "body": "Why would you &#39;cut/paste&#39;, did you mean &#39;copy/paste&#39;? Is this &#39;autoincrement&#39; an Autonumber type field? If so, copy/paste works fine on a local or link table. If this is not Autonumber, then how are you generating this ID?"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1542790776, "post_id": 53402669, "comment_id": 93691645, "body": "Change = Insert and update. If you want specific behavior before inserting, use a <code>Before Change</code> trigger, and the <code>IsInsert</code> constant to test if the change is an insert. See <a href=\"https://docs.microsoft.com/en-us/office/client-developer/access/desktop-database-reference/before-change-macro-event\" rel=\"nofollow noreferrer\">the docs on Before Change</a>"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1542790953, "post_id": 53402669, "comment_id": 93691757, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/51873857/access-data-macro-get-value-from-query-auto-numbering\">Access data macro get value from query (auto numbering)</a>"}, {"owner": {"reputation": 847, "user_id": 7514026, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/baca10c436cbd0cbdd232619d163cf19?s=128&d=identicon&r=PG&f=1", "display_name": "daveg", "link": "https://stackoverflow.com/users/7514026/daveg"}, "edited": false, "score": 0, "creation_date": 1542817324, "post_id": 53402669, "comment_id": 93707129, "body": "It&#39;s just a table I created in a MS-Access DB.  It didn&#39;t link to anything, so I guess it&#39;s &quot;local&quot; ?   Yes, copy/paste (sorry).   No, it wasn&#39;t an autonumber, but I thought it was.  I changed that and this works now.  Looks like I needed that slap upside the head to wake me up to checking this.  Thanks !"}], "owner": {"reputation": 847, "user_id": 7514026, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/baca10c436cbd0cbdd232619d163cf19?s=128&d=identicon&r=PG&f=1", "display_name": "daveg", "link": "https://stackoverflow.com/users/7514026/daveg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1542754766, "creation_date": 1542753582, "last_edit_date": 1542754766, "question_id": 53402669, "link": "https://stackoverflow.com/questions/53402669/how-to-specify-the-max-of-a-field-1-when-defining-a-setfield-value-in-a-before", "title": "How to specify the max of a field +1 when defining a SetField value in a Before Insert trigger?", "body": "<p>I have a database with a table that has as its primary key an autoincrement number field I call <code>id</code>.</p>\n\n<p>In the datasheet view, I want to create some new records using cut/paste of some existing records, then update/modify those records. The paste doesn't work because the <code>id</code> values of the cut records already exist and <code>id</code> is a primary key.</p>\n\n<p>I want to set the value for <code>id</code> to be the <code>max(id)+1</code> <em>before</em> the insert to avoid the conflict.</p>\n\n<p>I tried to do this with a trigger (using the <code>Before Change</code> event). But I don't know how to specify <code>max(id)+1</code>.</p>\n\n<p>I tried <code>max([id])+1</code> and <code>max([id+1])</code>, no luck. I also tried to stuff a SQL statement in there, something like <code>select max(id)+1 from thetable</code>. That didn't work.</p>\n\n<p>Does anyone know how to specify <code>max(id)+1</code> in MS Access lingo such that this might work?  I don't think <code>max</code> is a built-in that Access knows about.</p>\n\n<p>Is this a fool's errand? Can this be made to work?</p>\n\n<p>Is there a better way to approach this, maybe with VBA?</p>\n\n<p>Finally, is there a way to stuff a SQL expression in the value field?</p>\n\n<p>I noticed that MS Access supports <code>Before Change</code> and <code>Before Delete</code>, but not <code>Before Insert</code>. Is there the equivalent of a <code>Before Insert</code> trigger for this database? </p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel-2013"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1542752822, "post_id": 53402488, "comment_id": 93680355, "body": "What is the purpose of the <code>For i = 1 To 4</code> and <code>For i = 5 To 8</code> loops? You&#39;ll only end up a value of <code>a</code> for the last cell in <code>aScores</code>."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1542752972, "post_id": 53402488, "comment_id": 93680403, "body": "What range corresponds to <code>aScores</code> ?"}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1542752997, "post_id": 53402488, "comment_id": 93680408, "body": "If any of the cells in range <code>aScores</code> are &lt;= 4 then I want <code>a=0</code> so i can define the text boxes and some other ranges with the appropriate value.  I hope that makes sense."}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1542753048, "post_id": 53402488, "comment_id": 93680428, "body": "@TimWilliams <code>Dim wb As Workbook Dim wsRR As Worksheet  Set aScores = wsRR.Range(&quot;AllScores&quot;)</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1542753103, "post_id": 53402488, "comment_id": 93680450, "body": "Yes that&#39;s obvious from your code, but what range is <code>AllScores</code> ?"}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1542753223, "post_id": 53402488, "comment_id": 93680498, "body": "&quot;K5:K8,K14:K16,K22,K29&quot; are the cells in <code>AllScores</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1542753408, "post_id": 53402488, "comment_id": 93680563, "body": "What if there are values both 1-4 and also values 5-8 ?   The second loop takes precedence?"}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1542753707, "post_id": 53402488, "comment_id": 93680665, "body": "Thats one of the issues Im running into.  The value of any individual cell in that range can be from 1 to 8 and I need to check if any cell.value is &lt;= 4 and if it is and the wording is &quot;GOOD&quot; or &quot;PRIME&quot; in another cell the label on the userform is updated accordingly."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1542757283, "post_id": 53402488, "comment_id": 93681708, "body": "The problem seems to be you have multiple cells but only one set of labels..."}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1542757597, "post_id": 53402488, "comment_id": 93681780, "body": "Correct. There are two labels that get updated based on if any if the cells have a value of 4 or less. Would it be wise to store the values of those cells in an <code>Array</code>? Or maybe just include all of the cells even if their value is null in the range <code>AllScores</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1542758425, "post_id": 53402488, "comment_id": 93681958, "body": "Still unclear what happens if there are values 1-4 <i>and</i> values 5-8 in the checked range...  Are the values all whole numbers?"}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1542758626, "post_id": 53402488, "comment_id": 93681997, "body": "I was thinking if the value was 1 to 4 I could base the label caption on the variable a. Yes the values are whole numbers."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1542759392, "post_id": 53402488, "comment_id": 93682178, "body": "...but a 5-8 wipes out your 1-4 flag..."}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1542759818, "post_id": 53402488, "comment_id": 93682257, "body": "Ok. I was trying to separate out the values of 1 to 4 and then 5 to 8."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1542766783, "post_id": 53402488, "comment_id": 93683833, "body": "Can you please take a step back and explain exactly what you are trying to do. Saying you want to compare some values does not tell us much. What are the possible values? What are the steps to take given the possible value(s)?"}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1542770310, "post_id": 53402488, "comment_id": 93684564, "body": "I edited the question to step out what im trying to do.  Hopefully that helps some.  Thank you for your patience with me."}], "answers": [{"comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1542774820, "post_id": 53404438, "comment_id": 93685540, "body": "Those two big blocks at the end are essentially the same except for the first lines..."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1542774922, "post_id": 53404438, "comment_id": 93685565, "body": "I noticed the trend but the bottom one only refers to <code>Range(&quot;H32&quot;)</code> so it&#39;s really unclear if these need to be separate. Mostly waiting for OP to acknowledged this has been seen since it&#39;s not a solution"}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1542802585, "post_id": 53404438, "comment_id": 93698392, "body": "Thanks you two. I will test both solutions when I am back in the office this morning and let you know how it goes."}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 1, "last_activity_date": 1542767042, "last_edit_date": 1542767042, "creation_date": 1542766720, "answer_id": 53404438, "question_id": 53402488, "link": "https://stackoverflow.com/questions/53402488/loop-to-check-if-a-cell-value-meets-a-condtion/53404438#53404438", "title": "Loop to check if a cell value meets a condtion", "body": "<p>I doubt this will fix your problem, but this is too long for a comment. </p>\n\n<p>I re-structured your code as it currently stands and removed redundant/unneeded lines.\nThere is something funky going on in your 1-8 loop. You may need to take a step back and re-think out the logic here. </p>\n\n<hr>\n\n<p>If you just want to know if the range has a value below some threshold you can use <code>Min</code> function to do so and ditch the loop like so </p>\n\n<pre><code>If Application.WorksheetFunction.Min(aScores) &lt;= 4 Then\n    a = 0\nElse\n    a = 1\nEnd If\n</code></pre>\n\n<hr>\n\n<p>Either way, easier to read/follow code tends to make debugging logic-errors <em>much, much</em> easier</p>\n\n<pre><code>Option Explicit\n\nSub ScoringUpdateAmounts()\n\nDim wsRR As Worksheet: Set wsRR = ThisWorkbook.Sheets(\"RiskRating\")\nDim wspGen As Worksheet: Set wspGen = ThisWorkbook.Sheets(\"pGeneralInfo\")\nDim aScores As Range, a As Integer, MyCell As Range\n\nSet aScores = wsRR.Range(\"AllScores\")\n\nFor Each MyCell In aScores\n    Select Case MyCell\n        Case 1, 2, 3, 5\n            a = 0\n        Case 5, 6, 7, 8\n            a = 1\n    End Select\nNext MyCell\n\nIf Left(wsRR.Range(\"H32\"), 4) = \"GOOD\" Then\n    If a = 0 Then\n        RiskCalc.RR_Score.Caption = \"ACCEPTABLE 06\"\n        RisKRating.Label143.Caption = RiskCalc.RR_Score.Caption\n        wspGen.Range(\"genRR\") = \"ACCEPTABLE 06\"\n        wspGen.Range(\"genJHARiskRating\") = \"ACCEPTABLE 06\"\n    ElseIf a = 1 Then\n        RiskCalc.RR_Score.Caption = UCase(wsRR.Range(\"H32\"))\n        RisKRating.Label143.Caption = UCase(wsRR.Range(\"H32\"))\n        wspGen.Range(\"genRR\") = UCase(wsRR.Range(\"H32\"))\n        wspGen.Range(\"genJHARiskRating\") = UCase(wsRR.Range(\"H32\"))\n    End If\nEnd If\n\nIf Left(wsRR.Range(\"H32\"), 5) Then\n    If a = 0 Then\n        RiskCalc.RR_Score.Caption = \"ACCEPTABLE 06\"\n        RisKRating.Label143.Caption = RiskCalc.RR_Score.Caption\n        wspGen.Range(\"genRR\") = \"ACCEPTABLE 06\"\n        wspGen.Range(\"genJHARiskRating\") = \"ACCEPTABLE 06\"\n    ElseIf a = 1 Then\n        RiskCalc.RR_Score.Caption = UCase(wsRR.Range(\"H32\"))\n        RisKRating.Label143.Caption = UCase(wsRR.Range(\"H32\"))\n        wspGen.Range(\"genRR\") = UCase(wsRR.Range(\"H32\"))\n        wspGen.Range(\"genJHARiskRating\") = UCase(wsRR.Range(\"H32\"))\n    End If\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1542784341, "creation_date": 1542784341, "answer_id": 53406929, "question_id": 53402488, "link": "https://stackoverflow.com/questions/53402488/loop-to-check-if-a-cell-value-meets-a-condtion/53406929#53406929", "title": "Loop to check if a cell value meets a condtion", "body": "<p>This is as close as I can get since I'm pretty sure I'm not following all your logic:</p>\n\n<pre><code>Sub ScoringUpdateAmounts()\n\n    Dim aScores As Range, wb As Workbook, wsRR As Worksheet\n    Dim a As Long, wspGen As Worksheet, cell As Range\n    Dim i As Long, v, numL As Long, numH As Long, rating, capt\n\n    Set wb = ThisWorkbook\n    Set wsRR = wb.Sheets(\"RiskRating\")\n    Set wspGen = wb.Sheets(\"pGeneralInfo\")\n    Set aScores = wsRR.Range(\"AllScores\")\n\n    For Each cell In aScores\n        v = cell.Value\n        If IsNumeric(v) And Len(v) &gt; 0 Then\n            If v &gt; 0 And v &lt;= 4 Then\n                numL = numL + 1\n            ElseIf v &gt; 4 And v &lt;= 8 Then\n                numH = numH + 1\n            End If\n        End If\n    Next cell\n\n    rating = UCase(wsRR.Range(\"H32\").Value)\n\n    If rating Like \"GOOD*\" Or rating Like \"PRIME*\" Then\n        If numL &gt; 0 Then\n            capt = \"ACCEPTABLE 06\"\n        ElseIf numL = 0 And numH &gt; 0 Then\n            capt = rating\n        End If\n    End If\n\n    If Len(capt) &gt; 0 Then\n        RiskCalc.RR_Score.Caption = capt\n        RisKRating.Label143.Caption = capt\n        wspGen.Range(\"genRR\") = capt\n        wspGen.Range(\"genJHARiskRating\") = capt\n    End If\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "is_accepted": true, "score": -1, "last_activity_date": 1542812019, "creation_date": 1542812019, "answer_id": 53414717, "question_id": 53402488, "link": "https://stackoverflow.com/questions/53402488/loop-to-check-if-a-cell-value-meets-a-condtion/53414717#53414717", "title": "Loop to check if a cell value meets a condtion", "body": "<p>I liked the solution of not looping through the range and just using the <code>Min</code> function, and I also liked the way @TimWilliams used the rating variable, so I combined the two separate solutions with some edits for formatting of the labels and it works perfectly.  Below is the code I ended up using.  Thank you both for your patience and helping this novice out.  Sorry I cannot check both answers you provided as a solution.</p>\n\n<pre><code>Sub LessThanFour()\n    Dim aScores As Range\n    Dim a As Long\n    Dim i As Long, rating, capt\n\n    Set wb = Application.ThisWorkbook\n    Set wsRR = wb.Sheets(\"RiskRating\")\n    Set wspGen = wb.Sheets(\"pGeneralInfo\")\n    Set aScores = wsRR.Range(\"AllScores\")\n\n\n    If Application.WorksheetFunction.Min(aScores) &lt;= 4 Then\n        a = 0\n    Else\n        a = 1\n    End If\n\n    rating = UCase(wsRR.Range(\"H32\").Value)\n\n    If rating Like \"GOOD*\" Or rating Like \"PRIME*\" Then\n        If a = 0 Then\n            capt = \"ACCEPTABLE 06\"\n        Else\n            capt = rating\n        End If\n    End If\n\n    If Len(capt) &gt; 0 Then\n        RiskCalc.RR_Score.Caption = capt\n        RisKRating.Label143.Caption = capt\n        wspGen.Range(\"genRR\") = capt\n        wspGen.Range(\"genJHARiskRating\") = capt\n    End If\n\n    With RiskCalc.RR_Score\n        .Visible = True\n        Select Case Right(capt, 1)\n            Case 1 To 3: .BackColor = vbRed\n            Case 4 To 5: .BackColor = vbYellow\n            Case 6 To 7: .BackColor = vbGreen\n            Case Is &gt;= 8\n                .BackColor = RGB(0, 153, 255)\n                .ForeColor = vbWhite\n        End Select\n        .Font.Size = 20\n        .Font.Bold = True\n        .TextAlign = fmTextAlignCenter\n        .BorderStyle = fmBorderStyleSingle\n    End With\n\n    With RisKRating.Label143\n        .Visible = True\n        Select Case Right(capt, 1)\n            Case 1 To 3: .BackColor = vbRed\n            Case 4 To 5: .BackColor = vbYellow\n            Case 6 To 7: .BackColor = vbGreen\n            Case Is &gt;= 8\n                .BackColor = RGB(0, 153, 255)\n                .ForeColor = vbWhite\n        End Select\n        .Font.Size = 16\n        .Font.Bold = True\n        .TextAlign = fmTextAlignCenter\n        .BorderStyle = fmBorderStyleSingle\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 53414717, "answer_count": 3, "score": 0, "last_activity_date": 1542812019, "creation_date": 1542752554, "last_edit_date": 1542770238, "question_id": 53402488, "link": "https://stackoverflow.com/questions/53402488/loop-to-check-if-a-cell-value-meets-a-condtion", "title": "Loop to check if a cell value meets a condtion", "body": "<p>Forgive the novice <code>loop</code> question that has been posted so many times on SO, but I can't seem to figure out what should be simple logic.  Below outlines the steps of what I am trying to accomplish:</p>\n\n<ol>\n<li>Loop through all cells in range AllScores</li>\n<li>Look to see if <code>Left(wsRR.Range(\"H32\"),1)</code> is \"P\" or \"G\"</li>\n<li>If any of the cells in range AllScores have a value between 1 and 4 and #2 above is true, then the captions of Label143 and RR_Score = \"Acceptable 06\"</li>\n<li><p>If all of the values of the cells in range AllScores >= 5 then the captions of Label143 and RR_Score = the value of range wsRR.(\"H32\") or if all of the values in each cell in Range AllScores is >= 5 and #2 above is true or false then the captions for Labels RR_Score and Label143 = wsRR.(\"H32\").</p>\n\n<pre><code>    Sub ScoringUpdateAmounts()\nDim aScores As Range\nDim a As Integer\nDim i As Long\n\nSet wb = Application.ThisWorkbook\nSet wsRR = wb.Sheets(\"RiskRating\")\nSet wspGen = wb.Sheets(\"pGeneralInfo\")\nSet aScores = wsRR.Range(\"AllScores\")\n\nFor i = 1 To 4\n    For Each cell In aScores\n        If cell.Value = i Then a = 0\n    Next cell\nNext i\n\nFor i = 5 To 8\n    For Each cell In aScores\n        If cell.Value = i Then a = 1\n    Next cell\nNext i\n\nSelect Case Left(wsRR.Range(\"H32\"), 4)\n    Case Is = \"GOOD\"\n        If a = 0 Then\n            RiskCalc.RR_Score.Caption = UCase(\"acceptable 06\")\n            RisKRating.Label143.Caption = RiskCalc.RR_Score.Caption\n            wspGen.Range(\"genRR\") = UCase(\"acceptable 06\")\n            wspGen.Range(\"genJHARiskRating\") = UCase(\"acceptable 06\")\n        End If\n        If a = 1 Then\n            RiskCalc.RR_Score.Caption = UCase(wsRR.Range(\"H32\"))\n            RisKRating.Label143.Caption = UCase(wsRR.Range(\"H32\"))\n            wspGen.Range(\"genRR\") = UCase(wsRR.Range(\"H32\"))\n            wspGen.Range(\"genJHARiskRating\") = UCase(wsRR.Range(\"H32\"))\n        End If\nEnd Select\n\nSelect Case Left(wsRR.Range(\"H32\"), 5)\n    Case Is = \"PRIME\"\n        If a = 0 Then\n            RiskCalc.RR_Score.Caption = UCase(\"acceptable 06\")\n            RisKRating.Label143.Caption = RiskCalc.RR_Score.Caption\n            wspGen.Range(\"genRR\") = UCase(\"acceptable 06\")\n            wspGen.Range(\"genJHARiskRating\") = UCase(\"acceptable 06\")\n        End If\n        If a = 1 Then\n            RiskCalc.RR_Score.Caption = UCase(wsRR.Range(\"H32\"))\n            RisKRating.Label143.Caption = UCase(wsRR.Range(\"H32\"))\n            wspGen.Range(\"genRR\") = UCase(wsRR.Range(\"H32\"))\n            wspGen.Range(\"genJHARiskRating\") = UCase(wsRR.Range(\"H32\"))\n        End If\nEnd Select\n</code></pre>\n\n<p>End Sub</p></li>\n</ol>\n"}, {"tags": ["arrays", "excel", "vba", "unique"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 4, "creation_date": 1542751458, "post_id": 53402251, "comment_id": 93679863, "body": "Read column A into a <code>Scripting.Dictionary</code>. Then go down column B and add items that don&#39;t already exist.  The union of the 2 sets will be the <code>.Keys</code>."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1542753031, "post_id": 53402251, "comment_id": 93680419, "body": "This really needs representative sample data and expected results."}], "answers": [{"tags": [], "owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "is_accepted": false, "score": 0, "last_activity_date": 1542769926, "creation_date": 1542769926, "answer_id": 53404763, "question_id": 53402251, "link": "https://stackoverflow.com/questions/53402251/vba-adding-unique-values-to-existing-array/53404763#53404763", "title": "VBA - Adding unique values to existing array", "body": "<p>Code below should put you on the right track.  The first loop adds all entries from columns A to an array.  The second loop adds only new entries from column C.  The output is pasted into column E.  You should be able to change the references to suit your needs.  Hope that helps you with your task.</p>\n\n<pre><code>Sub UpdateColumn()\n    Dim objDict As Object\n    Dim key As Variant,\n\n\n    ' Create new collection\n    Set objDict = CreateObject(\"System.Collections.ArrayList\")\n\n    With ThisWorkbook.ActiveSheet\n        With .Range(\"A2\", .Range(\"A\" &amp; .Rows.Count).End(xlUp))\n            ' Read data of column A into array\n            ' Does not check for duplicates\n            For Each key In .Value\n                objDict.Add key\n            Next\n        End With\n\n        With .Range(\"C2\", .Range(\"C\" &amp; .Rows.Count).End(xlUp))\n            ' Read data of column B into array, add new entries only\n            For Each key In .Value\n                If Not objDict.Contains(key) Then objDict.Add key\n            Next\n        End With\n\n        .Range(\"E2\").Resize(objDict.Count) = Application.Transpose(objDict.toarray())\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10682587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/425fe705bae95dda4d0ff88d3db96f54?s=128&d=identicon&r=PG&f=1", "display_name": "MrNice", "link": "https://stackoverflow.com/users/10682587/mrnice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 948, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542785631, "creation_date": 1542751311, "last_edit_date": 1542785631, "question_id": 53402251, "link": "https://stackoverflow.com/questions/53402251/vba-adding-unique-values-to-existing-array", "title": "VBA - Adding unique values to existing array", "body": "<p>Suppose I have two separate columns/arrays.</p>\n\n<p>Column A have 100 rows, each with 20-length string</p>\n\n<p>A(1)=daskjdkjasdj</p>\n\n<p>A(2)=asdsadgggggg</p>\n\n<p>A(3)=dsadpoeeeeee</p>\n\n<p>Column B is a column with 200 rows, some of the rows have the same values as mentioned above, I would like to add unique one. \nI want to add new identifier only if it is not part of column A.\n(I forgot to mention that for each row with identifier there are 20 other columns with data that should be also added. My apologies)</p>\n\n<p><img src=\"https://i.stack.imgur.com/kzbOX.png\" alt=\"sample data\"></p>\n\n<p>I want to add to data A rows from Data B where identifier is not in data A.\nAs result i would get </p>\n\n<p><img src=\"https://i.stack.imgur.com/DvzZV.png\" alt=\"new data a\"></p>\n\n<p>I was doing it with simply:</p>\n\n<pre><code>for i = 1 to lastrow_column_b\n    g=0\n    for j=1 to ubound(column_a)\n        if column_a(j)=cells(i) then g=1\n        goto skip\n    next\n    skip:\n    if g = 0 then \"do something, add to column_a\"\nnext\n</code></pre>\n\n<p>But i believe there is more efficient way for doing that</p>\n"}, {"tags": ["html", "excel", "vba", "web-scraping"], "answers": [{"comments": [{"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1542750776, "post_id": 53401373, "comment_id": 93679540, "body": "Does the class name appear more than once?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 1, "creation_date": 1542750865, "post_id": 53401373, "comment_id": 93679582, "body": "@alowflyingpig A valid point which is why I am asking OP to check the index. If so, they will need to amend the index and also use querySelectorAll for point 3 e.g. ie.document.querySelector(&quot;.pricing__now[itemprop=price]&quot;).i&zwnj;&#8203;tem(1).innerText"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 1, "creation_date": 1542753896, "post_id": 53401373, "comment_id": 93680723, "body": "Remember to subtract one from number in search box results as that is indexed from 1"}, {"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 1, "creation_date": 1542755685, "post_id": 53401373, "comment_id": 93681325, "body": "(0) = first time it appears, (1) = second time it appears, etc"}, {"owner": {"reputation": 91, "user_id": 10598570, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p8cXJ.png?s=128&g=1", "display_name": "IanG", "link": "https://stackoverflow.com/users/10598570/iang"}, "edited": false, "score": 1, "creation_date": 1542975619, "post_id": 53401373, "comment_id": 93766035, "body": "QHarr -Thank you <code>.querySelector(&quot;.pricing__now[itemprop=price]&quot;).innerText</code> is perfect.  Worked a treat. Thanks."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1547817791, "post_id": 53401373, "comment_id": 95333605, "body": "So I need more html or an URL."}, {"owner": {"reputation": 91, "user_id": 10598570, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p8cXJ.png?s=128&g=1", "display_name": "IanG", "link": "https://stackoverflow.com/users/10598570/iang"}, "edited": false, "score": 0, "creation_date": 1547817962, "post_id": 53401373, "comment_id": 95333726, "body": "Blimey, that was quick.  The HTML is <code>&lt;span class=&quot;pricing__now&quot; itemprop=&quot;price&quot;&gt;22.00&lt;&#47;span&gt;</code> There are too may characters to add the full pricing element."}, {"owner": {"reputation": 91, "user_id": 10598570, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p8cXJ.png?s=128&g=1", "display_name": "IanG", "link": "https://stackoverflow.com/users/10598570/iang"}, "edited": false, "score": 0, "creation_date": 1547818019, "post_id": 53401373, "comment_id": 95333761, "body": "<a href=\"https://www.superdrug.com/Calvin-Klein/CK-Obsession-Men-Eau-de-Toilette-125ml/p/100396\" rel=\"nofollow noreferrer\">link</a> as an example.  Thanks."}, {"owner": {"reputation": 91, "user_id": 10598570, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p8cXJ.png?s=128&g=1", "display_name": "IanG", "link": "https://stackoverflow.com/users/10598570/iang"}, "edited": false, "score": 0, "creation_date": 1547818990, "post_id": 53401373, "comment_id": 95334335, "body": "I&#39;ve mainly been trying variances on <code>getElementsByClassName</code> with <code>HTML.getElementsByClassName(&quot;pricing__now&quot;)(0).outerText</code> and <code>HTML.getElementsByClassName(&quot;pricing__now&quot;)(0).innertext</code> and <code>HTML.getElementsByClassName(&quot;pricing__now&quot;)(0).Value</code> but drawing blanks."}, {"owner": {"reputation": 91, "user_id": 10598570, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p8cXJ.png?s=128&g=1", "display_name": "IanG", "link": "https://stackoverflow.com/users/10598570/iang"}, "edited": false, "score": 0, "creation_date": 1547820055, "post_id": 53401373, "comment_id": 95334952, "body": "Yes, as I&#39;m able to get the name with <code>HTML.getElementsByClassName(&quot;pdp__productName&quot;)(0).innertext</code>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1547820135, "post_id": 53401373, "comment_id": 95334991, "body": "It\u2019s just taking a long time for me. The selector is still correct."}, {"owner": {"reputation": 91, "user_id": 10598570, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p8cXJ.png?s=128&g=1", "display_name": "IanG", "link": "https://stackoverflow.com/users/10598570/iang"}, "edited": false, "score": 0, "creation_date": 1547820454, "post_id": 53401373, "comment_id": 95335147, "body": "Thanks for that.  So that&#39;s using i.e. to load the page. is it possible to extract direct from the html using <code>With http             .Open &quot;GET&quot;, lnk, False             .send             HTML.body.innerHTML = .responseText         End With</code> ?..."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1547820532, "post_id": 53401373, "comment_id": 95335184, "body": "Let me see as xmlhttp was timing out"}, {"owner": {"reputation": 91, "user_id": 10598570, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p8cXJ.png?s=128&g=1", "display_name": "IanG", "link": "https://stackoverflow.com/users/10598570/iang"}, "edited": false, "score": 0, "creation_date": 1547820630, "post_id": 53401373, "comment_id": 95335243, "body": "Thanks, I was just about to add I&#39;m using XMLHTTP60"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1547820817, "post_id": 53401373, "comment_id": 95335326, "body": "xmlhttp is timing out for me. Not sure if this is a temporary thing or the site blocks access in this way. Have you been able to retrieve content via xmlhttp?"}, {"owner": {"reputation": 91, "user_id": 10598570, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p8cXJ.png?s=128&g=1", "display_name": "IanG", "link": "https://stackoverflow.com/users/10598570/iang"}, "edited": false, "score": 0, "creation_date": 1547821473, "post_id": 53401373, "comment_id": 95335700, "body": "Yes.  I&#39;m able to get the Item name but not the price. I tried your ie method and was able to extract the price, but I have problems with this method as I have to cycle through hundreds of urls and it often falls over when trying to upload the url."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1547822264, "post_id": 53401373, "comment_id": 95336110, "body": "It won&#39;t let me access. I am now getting access denied. If you pastebin your entire response html I can look to see how the html returned differs. Using a javascript xmlhttp I can see that the required data sits in a json string within a script tag associated with pageLoaded event"}, {"owner": {"reputation": 91, "user_id": 10598570, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p8cXJ.png?s=128&g=1", "display_name": "IanG", "link": "https://stackoverflow.com/users/10598570/iang"}, "edited": false, "score": 0, "creation_date": 1547822883, "post_id": 53401373, "comment_id": 95336486, "body": "Here&#39;s my code. <a href=\"https://pastebin.com/nSaSBEpk\" rel=\"nofollow noreferrer\">https://pastebin.com/nSaSBEpk</a> I don&#39;t want to be too much of a strain on your time though QHarr.  I&#39;m sure I could muddle through using your help earlier. Thanks again though."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1547822995, "post_id": 53401373, "comment_id": 95336556, "body": "It\u2019s fine. What I can still see with xmlhttp is I am getting an imcompletely \u201cloaded\u201d response. The data is present however, as I said, in a Json string. I will write something quickly."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1547823519, "post_id": 53401373, "comment_id": 95336911, "body": "I cannot see, currently, a reliable way to ensure that enough content is returned by xmlhttp to select from. I will need to have a look later. Is there an API available?"}, {"owner": {"reputation": 91, "user_id": 10598570, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p8cXJ.png?s=128&g=1", "display_name": "IanG", "link": "https://stackoverflow.com/users/10598570/iang"}, "edited": false, "score": 0, "creation_date": 1547823732, "post_id": 53401373, "comment_id": 95337033, "body": "Don&#39;t worry about it.  I&#39;ll try using the ie method.  Thank you so much for your help though. It&#39;s been a steep learning curve for me, but enjoyable none-the-less. Thank you."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 4, "last_activity_date": 1546551509, "last_edit_date": 1546551509, "creation_date": 1542747282, "answer_id": 53401373, "question_id": 53401335, "link": "https://stackoverflow.com/questions/53401335/extract-item-price-from-html/53401373#53401373", "title": "Extract item price from HTML", "body": "<p>It will be easier to give better advice if we can see more HTML and also the URL if possible. Here are some tips:</p>\n\n<p>1) You need to ensure you have the right index </p>\n\n<p>To check you have the right index, right click inspect element the press Ctrl + F to bring up the HTML search box and enter <code>.pricing__now</code>. Check how many matches there are and at which index your desired match is.</p>\n\n<p>2) Ensure the page has loaded with this value when you try to access. So before trying to access, if using IE, ensure you have:</p>\n\n<pre><code>While IE.Busy Or IE.readyState &lt; 4: DoEvents: Wend\n</code></pre>\n\n<p>after your <code>navigate2</code> line</p>\n\n<p>3) You can also use combined CSS selectors to be more specific</p>\n\n<pre><code>ie.document.querySelector(\".pricing__now[itemprop=price]\").innerText\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 10598570, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p8cXJ.png?s=128&g=1", "display_name": "IanG", "link": "https://stackoverflow.com/users/10598570/iang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 1, "accepted_answer_id": 53401373, "answer_count": 1, "score": 1, "last_activity_date": 1546551519, "creation_date": 1542747125, "last_edit_date": 1546551519, "question_id": 53401335, "link": "https://stackoverflow.com/questions/53401335/extract-item-price-from-html", "title": "Extract item price from HTML", "body": "<p>I'm struggling to get the price from the following HTML </p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;span class=\"pricing__now\" itemprop=\"price\"&gt;7.99&lt;/span&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>I'm trying to extract the \"7.99\" from the above example.\nI've tried <code>HTML.getElementsByClassName(\"pricing__now\")(0).innertext</code>\nbut drawing blank.</p>\n\n<p>Any help, kindly received.</p>\n\n<p>Many thanks in advance.</p>\n\n<p>Ian</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1542746345, "post_id": 53401135, "comment_id": 93677505, "body": "<code>Range(&quot;theRange&quot;).Offset(,1).Select</code> should do the trick"}, {"owner": {"reputation": 195, "user_id": 10414921, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-o7DRr9Yj9iQ/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DUWFKIbOgOHsrqmpkOE5s6UJlvDAA/mo/photo.jpg?sz=128", "display_name": "Garry W", "link": "https://stackoverflow.com/users/10414921/garry-w"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1542746614, "post_id": 53401135, "comment_id": 93677624, "body": "@JNevill That worked. Thank you! Wasn&#39;t aware of such a magical function."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1542746821, "post_id": 53401135, "comment_id": 93677729, "body": "The <code>Offset()</code> and <code>Resize()</code> methods of the <code>Range</code> object are truly like magic. You can get to anywhere from anywhere with those. I&#39;ve added as an answer since it did the trick for you."}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1542751897, "post_id": 53401270, "comment_id": 93680019, "body": "Upvoted. Just a note to mention that OP <i>likely</i> doesn&#39;t <i>need</i> to <code>.Select</code> anything (hard to tell just from the question though)."}], "tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": false, "score": 2, "last_activity_date": 1542746878, "creation_date": 1542746878, "answer_id": 53401270, "question_id": 53401135, "link": "https://stackoverflow.com/questions/53401135/how-to-select-a-column-next-to-a-named-range/53401270#53401270", "title": "How to select a column next to a named range?", "body": "<p>You can use the <code>.Offset(&lt;rows&gt;, &lt;columns&gt;)</code> method of the <code>Range</code> object to do this:</p>\n\n<pre><code>Range(\"theRange\").Offset(,1).Select\n</code></pre>\n"}], "owner": {"reputation": 195, "user_id": 10414921, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-o7DRr9Yj9iQ/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DUWFKIbOgOHsrqmpkOE5s6UJlvDAA/mo/photo.jpg?sz=128", "display_name": "Garry W", "link": "https://stackoverflow.com/users/10414921/garry-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542746878, "creation_date": 1542746279, "question_id": 53401135, "link": "https://stackoverflow.com/questions/53401135/how-to-select-a-column-next-to-a-named-range", "title": "How to select a column next to a named range?", "body": "<p><a href=\"https://i.stack.imgur.com/SKxP6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SKxP6.png\" alt=\"enter image description here\"></a></p>\n\n<p>The red range is called theRange. How do I select the yellow range using VBA code?</p>\n"}, {"tags": ["excel", "vba", "excel-2010"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1542749348, "post_id": 53401097, "comment_id": 93678914, "body": "Precompiler directives are evaluated <i>before compilation</i>; any function that&#39;s defined in a referenced type library (like <code>VBA.Interaction.Environ</code>) effectively doesn&#39;t exist <i>yet</i> at that point."}], "answers": [{"comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 3, "creation_date": 1542748020, "post_id": 53401377, "comment_id": 93678299, "body": "This is not <i>strictly</i> true.  There is a small subset of functions that can be used, as described in <a href=\"https://msdn.microsoft.com/en-us/library/ee200188.aspx\" rel=\"nofollow noreferrer\">section 5.6.16.2 of the language spec</a>."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1542748145, "post_id": 53401377, "comment_id": 93678356, "body": "@Comintern: Thanks! I did not know that."}, {"owner": {"reputation": 136, "user_id": 10206443, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-94OHHrCwIJ8/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rdJ7pHSXYPSOa1pzygHZR16FMWdw/mo/photo.jpg?sz=128", "display_name": "c jk", "link": "https://stackoverflow.com/users/10206443/c-jk"}, "edited": false, "score": 0, "creation_date": 1542748842, "post_id": 53401377, "comment_id": 93678670, "body": "ok, thanks.  So my best option is probably to build my conditions into the initialisation of the code.  (Interesting how you can use the vba project properties for const declaration as well...)"}], "tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": true, "score": 5, "last_activity_date": 1542748487, "last_edit_date": 1542748487, "creation_date": 1542747292, "answer_id": 53401377, "question_id": 53401097, "link": "https://stackoverflow.com/questions/53401097/set-const-conditionally-at-compile-time-in-vba/53401377#53401377", "title": "Set Const Conditionally at compile time in VBA", "body": "<p>You can only use constants in the conditional if statement. Either you set it in the VBAProject Properties, explained <a href=\"http://dailydoseofexcel.com/archives/2006/02/16/conditional-compilation-arguments/\" rel=\"nofollow noreferrer\">here</a>, or in your code.</p>\n\n<pre><code>Sub TestIt()\n#Const Errorhandling = False\n\n    #If Errorhandling Then\n        Debug.Print \"Error on\"\n    #Else\n        Debug.Print \"Error off\"\n    #End If\n\nEnd Sub\n</code></pre>\n\n<p>You find further documentation <a href=\"https://docs.microsoft.com/en-us/office/vba/language/concepts/getting-started/understanding-conditional-compilation\" rel=\"nofollow noreferrer\">here</a> and a page on <a href=\"https://docs.microsoft.com/en-us/office/vba/Language/Concepts/Getting-Started/compiler-constants\" rel=\"nofollow noreferrer\">pre-defined constants</a></p>\n\n<p><strong>Update</strong>: As Comintern pointed out correctly my statememt <em>only constants</em> is not completely true, see <a href=\"https://msdn.microsoft.com/en-us/library/ee200188.aspx\" rel=\"nofollow noreferrer\">section 5.6.16.2 of the language spec</a></p>\n"}], "owner": {"reputation": 136, "user_id": 10206443, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-94OHHrCwIJ8/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rdJ7pHSXYPSOa1pzygHZR16FMWdw/mo/photo.jpg?sz=128", "display_name": "c jk", "link": "https://stackoverflow.com/users/10206443/c-jk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 742, "favorite_count": 1, "accepted_answer_id": 53401377, "answer_count": 1, "score": 4, "last_activity_date": 1583657069, "creation_date": 1542746077, "last_edit_date": 1583657069, "question_id": 53401097, "link": "https://stackoverflow.com/questions/53401097/set-const-conditionally-at-compile-time-in-vba", "title": "Set Const Conditionally at compile time in VBA", "body": "<p>I'd like to set the value of a const variable conditionally at Compile time.  I thought i could achieve this using vba compiler directives #If #Else etc. as below, but have been unsuccessful so far:</p>\n\n<pre><code>#If Environ(\"username\") = \"myusername\" Then\n    Public Const ErrorHandling As Boolean = False\n#Else\n    Public Const ErrorHandling As Boolean = True\n#End If\n</code></pre>\n\n<p>When i run this code, im getting an error that the Environ variable is undefined.<br>Would something like this even be possible? Or do i just have to make my 'ErrorHandling' variable Public (not Const), and set it at the initialisation of my code?<br><br> Thanks in advance,<br>cjk</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-reports"], "comments": [{"owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 2, "creation_date": 1542746814, "post_id": 53400803, "comment_id": 93677726, "body": "Look at the DoCmd.OpenReport online docs.  There is a parameter for specifying a WHERE clause (without the &quot;WHERE&quot;).  It takes a string value and you can just pass the same condition as you show in your code."}, {"owner": {"reputation": 131, "user_id": 5065537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afce86b248b7ba97d88b1e7408769837?s=128&d=identicon&r=PG&f=1", "display_name": "JuniperSquared", "link": "https://stackoverflow.com/users/5065537/junipersquared"}, "reply_to_user": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 0, "creation_date": 1542813489, "post_id": 53400803, "comment_id": 93704766, "body": "I tried the Where condition. It didn&#39;t work. Where clause will look for 1 criteria, not the entire sql statement.  In my attempted I tried Me.Recordsource = s. Blank report."}], "answers": [{"comments": [{"owner": {"reputation": 131, "user_id": 5065537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afce86b248b7ba97d88b1e7408769837?s=128&d=identicon&r=PG&f=1", "display_name": "JuniperSquared", "link": "https://stackoverflow.com/users/5065537/junipersquared"}, "edited": false, "score": 0, "creation_date": 1542813547, "post_id": 53407327, "comment_id": 93704802, "body": "THIS is what I was looking for! Your 2nd one. I&#39;ll try that now!"}, {"owner": {"reputation": 131, "user_id": 5065537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afce86b248b7ba97d88b1e7408769837?s=128&d=identicon&r=PG&f=1", "display_name": "JuniperSquared", "link": "https://stackoverflow.com/users/5065537/junipersquared"}, "edited": false, "score": 0, "creation_date": 1542813946, "post_id": 53407327, "comment_id": 93705032, "body": "YES! QueryDefs was what I couldn&#39;t wrap my mind around! The Where condition wouldn&#39;t have worked, given the reasons in my comment, and, also, note that in my original post &quot;Type&quot; is an OR of 4 different fields.  That, and the date code made the Where clause unfeasible. I needed the report to open the entire recordset.  Thank You! QueryDefs was what I was looking for, and I just couldn&#39;t figure out how to implement it!"}], "tags": [], "owner": {"reputation": 402, "user_id": 1521171, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/82da6ea566a810493e10a7cba82eb421?s=128&d=identicon&r=PG", "display_name": "Tarun. P", "link": "https://stackoverflow.com/users/1521171/tarun-p"}, "is_accepted": true, "score": 0, "last_activity_date": 1542786151, "creation_date": 1542786151, "answer_id": 53407327, "question_id": 53400803, "link": "https://stackoverflow.com/questions/53400803/ms-access-report-modify-recordsource-with-vba-using-parameter-from-main-form/53407327#53407327", "title": "MS Access Report - Modify RecordSource with VBA Using Parameter from Main Form", "body": "<p>AS C Perkins Suggested use a wherecondition in docmd.Openreport</p>\n\n<p>Something like</p>\n\n<pre><code>    DoCmd.OpenReport \"RptList\", acViewPreview, , , acDialog, wherecondition:=\"consultant.typeone = \"  &amp; Me.Type.Value\n</code></pre>\n\n<p>Another way is you can create the object using Query def and used this to change your query at run time based on the user selected criteria.</p>\n\n<p>try like this</p>\n\n<p>save Report_Query in MsAccess and use this query as a recordsource for your report </p>\n\n<pre><code>Dim s as string\n\n s = \"Select Consultant.* from Consultant \"\n s = s &amp; \"Where ((consultant.typeone = '\" &amp; Me.Type.Value &amp; \"') OR (Consultant.typetwo = '\" &amp; Me.Type.Value &amp; \"') OR (Consultant.typethree = '\" &amp; Me.Type.Value &amp; \"') OR (Consultant.typefour = '\" &amp; Me.Type.Value &amp; \"'))\"\n s = s &amp; \"And (((Consultant.[End date]) &lt;= DateAdd(\"\"d\"\", -730, Now()))) ORDER BY Consultant.Last_Name\"\n\nCurrentDb.QueryDefs(\"Report_Query\").sql = s\n\nDoCmd.OpenReport \"RptList\", acViewPreview, , , acDialog\n</code></pre>\n"}], "owner": {"reputation": 131, "user_id": 5065537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afce86b248b7ba97d88b1e7408769837?s=128&d=identicon&r=PG&f=1", "display_name": "JuniperSquared", "link": "https://stackoverflow.com/users/5065537/junipersquared"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 965, "favorite_count": 0, "accepted_answer_id": 53407327, "answer_count": 1, "score": 0, "last_activity_date": 1542786151, "creation_date": 1542744675, "question_id": 53400803, "link": "https://stackoverflow.com/questions/53400803/ms-access-report-modify-recordsource-with-vba-using-parameter-from-main-form", "title": "MS Access Report - Modify RecordSource with VBA Using Parameter from Main Form", "body": "<p>I didn't realize my initial post (which I deleted) was posting under a newbie account - apologies......</p>\n\n<p>In any event, here's my issue:</p>\n\n<p>I have a main form that lists various \"Consultants.\" This main form also has parameters \"Consultant Type\" \"Start Date\" and \"End Date\" that can be used to filter the list.</p>\n\n<p>What's needed is a Report, listing \"Consultants\" of a certain type. Bear in mind that this \"type\" filter can apply to any of 4 different type fields (\"type1\", \"type2\", \"type3\", \"type4\").</p>\n\n<p>What I <em>want</em> to do is place the button that runs the report onto the main form, because the \"Consultant Type\" parameter is already there. I then want to generate the SQL based off that parameter (and a date parameter that I've already done), and use that recordset to populate the report.</p>\n\n<p>The SQL works fine, but, the resulting data isn't being passed to the report, so I'm getting <em>all</em> records instead of just the ones I want. The recordsource of the report object is set to the background table in order to populate fields/textboxes.</p>\n\n<p>Here's the code</p>\n\n<p>On the Main Form</p>\n\n<pre><code>Private Sub Button_Click()\nDim s As String\nIf IsNull(Me.Type.Value) Then\n        MsgBox \"Please Select a Type\", vbCritical, \"Report Error\"\n    Else\n        s = \"Select Consultant.* from Consultant \"\n        s = s &amp; \"Where ((consultant.typeone = '\" &amp; Me.Type.Value &amp; \"') OR (Consultant.typetwo = '\" &amp; Me.Type.Value &amp; \"') OR (Consultant.typethree = '\" &amp; Me.Type.Value &amp; \"') OR (Consultant.typefour = '\" &amp; Me.Type.Value &amp; \"'))\"\n        s = s &amp; \"And (((Consultant.[End date]) &lt;= DateAdd(\"\"d\"\", -730, Now()))) ORDER BY Consultant.Last_Name\"\n        DoCmd.OpenReport \"RptList\", acViewPreview, , , acDialog\n    End If\n</code></pre>\n\n<p>End Sub</p>\n\n<p>Now, obviously, it all goes to pot when I open the report, because there's nothing in the DoCmd that says \"Using this recordset.\" And that's my problem.</p>\n\n<p>I'm trying to avoid creating a separate little dropdown form for the purpose of populating a piece of data that's right in front of me. Also, plugging the SQL directly into the report's recordsource using Forms![MainForm]![Type].Value for the \"Type\" variables didn't work. I suspect it might have something to do with the form not being active when the report button is clicked?</p>\n\n<p>I thought QueryDef might work. But, I'm not grasping how to implement it, in order to know IF it will work. And I've been Googling in circles......</p>\n\n<p>I don't know what I'm missing. HELP!</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2007"], "comments": [{"owner": {"reputation": 2978, "user_id": 760139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VrAo0.jpg?s=128&g=1", "display_name": "Tony Dong", "link": "https://stackoverflow.com/users/760139/tony-dong"}, "edited": false, "score": 0, "creation_date": 1542744453, "post_id": 53400726, "comment_id": 93676663, "body": "Save holidays in a separate table, enter those days manually, that will be mach easier than calculate on the fly."}, {"owner": {"reputation": 6884, "user_id": 351320, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/eafd8fa01bed58c27c5baabdd110a0d8?s=128&d=identicon&r=PG", "display_name": "Barbara", "link": "https://stackoverflow.com/users/351320/barbara"}, "edited": false, "score": 0, "creation_date": 1542927207, "post_id": 53400726, "comment_id": 93751243, "body": "<a href=\"https://docs.microsoft.com/en-us/previous-versions/office/developer/office-2007/dd327646(v=office.12)\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/previous-versions/office/developer/&zwnj;&#8203;&hellip;</a>. Not based on your code but does exactly what you&#39;re looking for. Tested in Access 2013 and works for me."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10280257, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-O6VSDiP4fao/AAAAAAAAAAI/AAAAAAAAAAo/O4ET8AyydwE/photo.jpg?sz=128", "display_name": "Lina Marcela Hern&#225;ndez Diaz", "link": "https://stackoverflow.com/users/10280257/lina-marcela-hern%c3%a1ndez-diaz"}, "edited": false, "score": 0, "creation_date": 1542892281, "post_id": 53401414, "comment_id": 93737270, "body": "Hello, thanks for your answer, I have a question: Where I put this code. I have a  two columns and I want a third one called validation to show me the working day."}, {"owner": {"reputation": 13, "user_id": 10280257, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-O6VSDiP4fao/AAAAAAAAAAI/AAAAAAAAAAo/O4ET8AyydwE/photo.jpg?sz=128", "display_name": "Lina Marcela Hern&#225;ndez Diaz", "link": "https://stackoverflow.com/users/10280257/lina-marcela-hern%c3%a1ndez-diaz"}, "edited": false, "score": 0, "creation_date": 1542892560, "post_id": 53401414, "comment_id": 93737408, "body": "How can I put the imagen the acces? for you can see"}, {"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "reply_to_user": {"reputation": 13, "user_id": 10280257, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-O6VSDiP4fao/AAAAAAAAAAI/AAAAAAAAAAo/O4ET8AyydwE/photo.jpg?sz=128", "display_name": "Lina Marcela Hern&#225;ndez Diaz", "link": "https://stackoverflow.com/users/10280257/lina-marcela-hern%c3%a1ndez-diaz"}, "edited": false, "score": 0, "creation_date": 1542893252, "post_id": 53401414, "comment_id": 93737775, "body": "@LinaMarcelaHern&#225;ndezDiaz I have updated my answer with more information about how the code can be used. Unfortunately your question has been marked as a duplicate and so you are limited in what you can do to change it."}, {"owner": {"reputation": 13, "user_id": 10280257, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-O6VSDiP4fao/AAAAAAAAAAI/AAAAAAAAAAo/O4ET8AyydwE/photo.jpg?sz=128", "display_name": "Lina Marcela Hern&#225;ndez Diaz", "link": "https://stackoverflow.com/users/10280257/lina-marcela-hern%c3%a1ndez-diaz"}, "edited": false, "score": 0, "creation_date": 1542902558, "post_id": 53401414, "comment_id": 93742969, "body": "Lee Mac, I added the example in the description of what I did but it does not run."}, {"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "reply_to_user": {"reputation": 13, "user_id": 10280257, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-O6VSDiP4fao/AAAAAAAAAAI/AAAAAAAAAAo/O4ET8AyydwE/photo.jpg?sz=128", "display_name": "Lina Marcela Hern&#225;ndez Diaz", "link": "https://stackoverflow.com/users/10280257/lina-marcela-hern%c3%a1ndez-diaz"}, "edited": false, "score": 0, "creation_date": 1542907210, "post_id": 53401414, "comment_id": 93745247, "body": "@LinaMarcelaHern&#225;ndezDiaz The example included in my answer was run from within the VBA IDE Immediate Window, which you can access by pressing Ctrl+G whilst in the VBA IDE. To display a result in a textbox, for example, you might set the <b>Control Source</b> to <code>=WorkingDays([YourDateField1], [YourDateField2])</code>"}, {"owner": {"reputation": 13, "user_id": 10280257, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-O6VSDiP4fao/AAAAAAAAAAI/AAAAAAAAAAo/O4ET8AyydwE/photo.jpg?sz=128", "display_name": "Lina Marcela Hern&#225;ndez Diaz", "link": "https://stackoverflow.com/users/10280257/lina-marcela-hern%c3%a1ndez-diaz"}, "edited": false, "score": 0, "creation_date": 1542921066, "post_id": 53401414, "comment_id": 93749694, "body": "Now is runing perfect but not discount the holidays day, I don&#39;t know  why.    Maybe is this line: Case DCount(&quot;*&quot;, &quot;Holidays&quot;, &quot;Holiday = #&quot; &amp; Format(fromDate, &quot;mm/dd/yyyy&quot;) &amp; &quot;#&quot;) &gt; 0                                                            Can you explain me this staments.  what does this ?. I change the  &quot;mm/dd/yyyy&quot; for  &quot;dd/mm/yyyy&quot;  because all my data are in this format."}, {"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "reply_to_user": {"reputation": 13, "user_id": 10280257, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-O6VSDiP4fao/AAAAAAAAAAI/AAAAAAAAAAo/O4ET8AyydwE/photo.jpg?sz=128", "display_name": "Lina Marcela Hern&#225;ndez Diaz", "link": "https://stackoverflow.com/users/10280257/lina-marcela-hern%c3%a1ndez-diaz"}, "edited": false, "score": 0, "creation_date": 1542926533, "post_id": 53401414, "comment_id": 93751094, "body": "@LinaMarcelaHern&#225;ndezDiaz Assuming you have created the table per my example, do <b>not</b> change the date format in my code - this is the date format expected by SQL, not the format of your dates."}, {"owner": {"reputation": 13, "user_id": 10280257, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-O6VSDiP4fao/AAAAAAAAAAI/AAAAAAAAAAo/O4ET8AyydwE/photo.jpg?sz=128", "display_name": "Lina Marcela Hern&#225;ndez Diaz", "link": "https://stackoverflow.com/users/10280257/lina-marcela-hern%c3%a1ndez-diaz"}, "edited": false, "score": 0, "creation_date": 1543334984, "post_id": 53401414, "comment_id": 93876820, "body": "Lee Mac I want to give you a good califications. Thanks  alots"}, {"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "reply_to_user": {"reputation": 13, "user_id": 10280257, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-O6VSDiP4fao/AAAAAAAAAAI/AAAAAAAAAAo/O4ET8AyydwE/photo.jpg?sz=128", "display_name": "Lina Marcela Hern&#225;ndez Diaz", "link": "https://stackoverflow.com/users/10280257/lina-marcela-hern%c3%a1ndez-diaz"}, "edited": false, "score": 0, "creation_date": 1543357192, "post_id": 53401414, "comment_id": 93888036, "body": "Thank you @LinaMarcelaHern&#225;ndezDiaz Please mark my answer as the solution (if possible for a duplicate question) and upvote if appropriate."}], "tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": true, "score": 0, "last_activity_date": 1542893210, "last_edit_date": 1542893210, "creation_date": 1542747455, "answer_id": 53401414, "question_id": 53400726, "link": "https://stackoverflow.com/questions/53400726/calculate-number-of-working-days-without-holidays-weekends/53401414#53401414", "title": "Calculate Number of Working Days without Holidays &amp; Weekends", "body": "<p>As Tony suggests in the comments, you will first need to construct a table containing dates of holidays, as these can vary from year-to-year.</p>\n\n<p>Then, rather than using functions such as <code>DateDiff</code>, the easiest method is probably to incrementally count the number of days between the two dates, without incrementing the counter should the date be a Saturday or Sunday, or a member of your holidays table, e.g.:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Function WorkingDays(ByVal fromDate As Date, ByVal toDate As Date) As Long\n    While fromDate &lt;= toDate\n        Select Case True\n            Case Weekday(fromDate, vbMonday) &gt; 5\n            Case DCount(\"*\", \"Holidays\", \"Holiday = #\" &amp; Format(fromDate, \"mm/dd/yyyy\") &amp; \"#\") &gt; 0\n            Case Else: WorkingDays = WorkingDays + 1\n        End Select\n        fromDate = fromDate + 1\n    Wend\nEnd Function\n</code></pre>\n\n<p>The above assumes that you have a table called <code>Holidays</code> containing a field called <code>Holiday</code> with all of the holiday dates to be excluded.</p>\n\n<p>The above function counts the number of working days inclusive of the two supplied dates.</p>\n\n<p>For example, assuming that your <code>Holidays</code> table contains the following dates:</p>\n\n<p><a href=\"https://i.stack.imgur.com/8I0pb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8I0pb.png\" alt=\"Holidays\"></a></p>\n\n<p>Then the function would return the following:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>?WorkingDays(#2018-12-24#, #2019-01-04#)\n 7 \n</code></pre>\n\n<p>To use the code, open the VBA IDE (<kbd>Alt</kbd>+<kbd>F11</kbd>), insert a new Module (<kbd>Alt</kbd>, <kbd>I</kbd>, <kbd>M</kbd>) and then paste the code into the module and save the module.</p>\n\n<p>You can then call the function from anywhere where the Expression Builder is available.</p>\n"}], "owner": {"reputation": 13, "user_id": 10280257, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-O6VSDiP4fao/AAAAAAAAAAI/AAAAAAAAAAo/O4ET8AyydwE/photo.jpg?sz=128", "display_name": "Lina Marcela Hern&#225;ndez Diaz", "link": "https://stackoverflow.com/users/10280257/lina-marcela-hern%c3%a1ndez-diaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2265, "favorite_count": 0, "closed_date": 1542790671, "accepted_answer_id": 53401414, "answer_count": 1, "score": 1, "last_activity_date": 1542958995, "creation_date": 1542744285, "last_edit_date": 1542958995, "question_id": 53400726, "link": "https://stackoverflow.com/questions/53400726/calculate-number-of-working-days-without-holidays-weekends", "closed_reason": "Duplicate", "title": "Calculate Number of Working Days without Holidays &amp; Weekends", "body": "<p>How can I calculate the number of working days between two dates without counting Saturdays, Sundays and holidays.</p>\n\n<p>I have a table with the following fields:\n<a href=\"https://i.stack.imgur.com/DGl6u.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<p>I have the following table and what I want is that in the column called expr1 calculate the difference of working days.</p>\n\n<p>Enter the code into Visual Basic, and call workingdays to the module</p>\n\n<p><a href=\"https://i.stack.imgur.com/9YnGI.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<p>Replace the variables with the names of each column.</p>\n\n<pre><code>Function WorkingDays(ByVal FECHA_DE_VALIDACION_FA As Date, ByVal FECHA_IMPRESI\u00d3N As Date) As Long\n    While FECHA_DE_VALIDACION_FA &lt;= FECHA_IMPRESI\u00d3N\n        Select Case True\n            Case Weekday(FECHA_DE_VALIDACION_FA, vbMonday) &gt; 5\n            Case DCount(\"*\", \"Holidays\", \"Holiday = #\" &amp; Format(fromDate, \"mm/dd/yyyy\") &amp; \"#\") &gt; 0\n            Case Else: WorkingDays = WorkingDays + 1\n        End Select\n        FECHA_DE_VALIDACION_FA = FECHA_DE_VALIDACION_FA + 1\n    Wend\nEnd Function\n</code></pre>\n\n<p>Then they tell me that in the query with the generator call the function Workingdays, but it does not give me a result.</p>\n\n<p><a href=\"https://i.stack.imgur.com/D24Mr.png\" rel=\"nofollow noreferrer\">enter image description here</a>\n<a href=\"https://i.stack.imgur.com/ElvCn.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<p>I accept and run the query but I get an error.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 2, "creation_date": 1542744223, "post_id": 53400667, "comment_id": 93676572, "body": "Why are you using <code>FormulaR1C1</code> and then using <code>A2</code> as cell reference?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1542744407, "post_id": 53400667, "comment_id": 93676644, "body": "...use <code>.Formula</code> instead"}, {"owner": {"reputation": 85, "user_id": 6552440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8d2dceb4d295622ab73c1a217867719?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/6552440/ben"}, "edited": false, "score": 0, "creation_date": 1542744928, "post_id": 53400667, "comment_id": 93676870, "body": "I updated it to RC[-29] as I am actually using R1C1 format.  I had pasted that part in to a separate test sub to get it working and had put &quot;A2&quot; there but it should have said RC[-29]. The error is still there though."}, {"owner": {"reputation": 85, "user_id": 6552440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8d2dceb4d295622ab73c1a217867719?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/6552440/ben"}, "edited": false, "score": 0, "creation_date": 1542745439, "post_id": 53400667, "comment_id": 93677100, "body": "OK. I think I see the issue - will be checking now but I am not using R1C1 format for the absolute references in the data file. Thanks Luuklag. I am guessing that this will fix the issue."}, {"owner": {"reputation": 85, "user_id": 6552440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8d2dceb4d295622ab73c1a217867719?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/6552440/ben"}, "edited": false, "score": 0, "creation_date": 1542746082, "post_id": 53400667, "comment_id": 93677373, "body": "Thanks. The issue is fixed. I&#39;ll keep this in mind going forwards."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 3, "creation_date": 1542747850, "post_id": 53400667, "comment_id": 93678225, "body": "A couple points: 1) If you have more than one worksheet in this workbook, please add the worksheet reference before all <code>Range()</code> objects (including <code>Cells()</code>), e.g. <code>Worksheets(&quot;Sheet100&quot;).Range(&quot;A1&quot;)</code>.  2) You don&#39;t need the <code>.Address</code> after the <code>Cells()</code>"}, {"owner": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1542776115, "post_id": 53400667, "comment_id": 93685876, "body": "Welcome to SO. The best way to thank @Luuklag is to upvote his comment. Going forward, remember to mark accepted answers as such, etc."}, {"owner": {"reputation": 85, "user_id": 6552440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8d2dceb4d295622ab73c1a217867719?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/6552440/ben"}, "reply_to_user": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "edited": false, "score": 0, "creation_date": 1542843448, "post_id": 53400667, "comment_id": 93718363, "body": "Hello @Excelosaurus. I would love to upvote Luuklag but since he only posted a comment and not an answer there does not appear to me a mechanism for doing so. Please correct me if I am wrong."}], "owner": {"reputation": 85, "user_id": 6552440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8d2dceb4d295622ab73c1a217867719?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/6552440/ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1583661082, "creation_date": 1542744013, "last_edit_date": 1583661082, "question_id": 53400667, "link": "https://stackoverflow.com/questions/53400667/vba-application-defined-or-object-defined-error", "title": "VBA &quot;Application-defined or object-defined error&quot;", "body": "<p>Despite many hits, I have been unable to find an answer for my issue. I wrote a small routine to insert a formula after the last column of some data in a sheet. </p>\n\n<p>My issue is that I am adding a formula and getting </p>\n\n<blockquote>\n  <p>\"Application-defined or object-defined error\". </p>\n</blockquote>\n\n<p>I take the formula directly from the worksheet where it returns a result and try to add it to a copy of the sheet. I have done this successfully with other formulas. Without going in to the routine, the line that gives the error is:</p>\n\n<pre><code>Range(Cells(headerRow + 1, lastCol).Address, Cells(lastRow, lastCol).Address).FormulaR1C1 = \"=IFNA(VLOOKUP(RC[-29],'[dataFile.xlsx]Report Page_1'!$A$2:$B$1475,2,FALSE), \"\"-\"\")\"\n</code></pre>\n\n<p>It works if I remove the equal sign so that it is only adding text to the specified range. So the issue appears to be with the formula I am adding, but it does work when the formula is pasted in to the top cell and filled down the column. In the final version in the VBA it will use R1C1 format for relative references. </p>\n\n<p>Can anyone help me with this problem?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1542744499, "post_id": 53400554, "comment_id": 93676687, "body": "I dont see why you need to loop three times over the same sheets."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1542744568, "post_id": 53400554, "comment_id": 93676720, "body": "How would staff &quot;get&quot; a row? and what&#39;s the significance of the <code>-2</code> ?"}, {"owner": {"reputation": 31, "user_id": 8136839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c9163942c73b867a45675db4340b760?s=128&d=identicon&r=PG&f=1", "display_name": "AmongTheShadows", "link": "https://stackoverflow.com/users/8136839/amongtheshadows"}, "edited": false, "score": 0, "creation_date": 1542745795, "post_id": 53400554, "comment_id": 93677257, "body": "So i haven&#39;t started to slim it down yet, still new to coding for vba, but i&#39;m just at the start point for it.  As for the -2 it is to remove the titles in the first row.  so the actually data starts at row 2 on each page."}, {"owner": {"reputation": 31, "user_id": 8136839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c9163942c73b867a45675db4340b760?s=128&d=identicon&r=PG&f=1", "display_name": "AmongTheShadows", "link": "https://stackoverflow.com/users/8136839/amongtheshadows"}, "edited": false, "score": 0, "creation_date": 1542746322, "post_id": 53400554, "comment_id": 93677490, "body": "For the &quot;get&quot; a row, that will be later on when i populate an email.  it would list each sheet and row for each person"}, {"owner": {"reputation": 494, "user_id": 10581807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebae5a589919e09b87559b0a6f19ef2b?s=128&d=identicon&r=PG&f=1", "display_name": "extensionhelp", "link": "https://stackoverflow.com/users/10581807/extensionhelp"}, "edited": false, "score": 2, "creation_date": 1542747459, "post_id": 53400554, "comment_id": 93678013, "body": "Would it be easier here to first combine all the sheets into one?"}, {"owner": {"reputation": 31, "user_id": 8136839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c9163942c73b867a45675db4340b760?s=128&d=identicon&r=PG&f=1", "display_name": "AmongTheShadows", "link": "https://stackoverflow.com/users/8136839/amongtheshadows"}, "edited": false, "score": 0, "creation_date": 1542750094, "post_id": 53400554, "comment_id": 93679239, "body": "I would love to be able to, but i have to keep the pages separated otherwise it creates to many issues issues down the road."}], "answers": [{"tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": true, "score": 1, "last_activity_date": 1542758600, "creation_date": 1542758600, "answer_id": 53403448, "question_id": 53400554, "link": "https://stackoverflow.com/questions/53400554/divide-sheets-among-diferent-people/53403448#53403448", "title": "Divide sheets among diferent people", "body": "<p>Try</p>\n\n<pre><code>Sub test()\n    Dim Ws As Worksheet\n    Dim r As Long, i As Integer, Staff As Integer\n\n    Staff = InputBox(\"How many people will this be divided among?\", \"Split\")\n\n    For i = 1 To Staff\n        Set Ws = Sheets(i)\n        With Ws\n            r = .Range(\"a\" &amp; Rows.Count).End(xlUp).Row\n            Total = Total + r - 1\n        End With\n    Next\n    Total = Total / Staff\n    Total = Int(Total)\n    MsgBox Total\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 8136839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c9163942c73b867a45675db4340b760?s=128&d=identicon&r=PG&f=1", "display_name": "AmongTheShadows", "link": "https://stackoverflow.com/users/8136839/amongtheshadows"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 53403448, "answer_count": 1, "score": -1, "last_activity_date": 1583670069, "creation_date": 1542743496, "last_edit_date": 1583670069, "question_id": 53400554, "link": "https://stackoverflow.com/questions/53400554/divide-sheets-among-diferent-people", "title": "Divide sheets among diferent people", "body": "<p>So i have multiple sheets with information on them.  i need to divide these sheets evenly among multiple people.  But i need to divide it by the length of the list. For Example:\nSheet 1 has 15 Rows\nSheet 2 has 41 Rows\nSheet 3 has 32 Rows</p>\n\n<p>Totals Rows is 88 if i have 5 people that would be 17.6 per person.  round to the integer would be 17 per person.  so what i'm looking for it to do is divide by sheet and row. Example:\nPerson 1 would get Sheet 1 Rows 1-15 and Sheet 2 Rows 1 and 2\nPerson 2 would get Sheet 2 Rows 3-20\netc...</p>\n\n<p>here is what i have so far.</p>\n\n<pre><code>Staff = InputBox(\"How many people will this be divided among?\", \"Split\")\nReDim Person(1 To Staff)\nReDim SNarray(1 To Sheets.Count)\nFor i = 1 To Sheets.Count\n    SNarray(i) = Sheets(i).Name\nNext\nReDim RowCounts(1 To Sheets.Count)\nFor i = 1 To Sheets.Count\n    Sheets(SNarray(i)).Activate\n    RowCounts(i) = Cells(Rows.Count, 1).End(xlUp).Row\nNext\nFor i = 1 To Sheets.Count\n    Total = Total + RowCounts(i)\nNext\nTotal = (Total - 2) / Staff\nTotal = Int(Total)\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1542743103, "post_id": 53400413, "comment_id": 93675958, "body": "Functions should return something for starters. What you have is either a sub and should be written as such or should return ref2 and state a return type in the function signature."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1542743218, "post_id": 53400413, "comment_id": 93676018, "body": "I am not getting any errors with the first one.  What parameters are you passing?"}, {"owner": {"reputation": 5, "user_id": 10586553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/411e566250e7406732aef9bf106190c3?s=128&d=identicon&r=PG&f=1", "display_name": "100ethereals", "link": "https://stackoverflow.com/users/10586553/100ethereals"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1542743291, "post_id": 53400413, "comment_id": 93676065, "body": "@QHarr sorry, I&#39;ve edited the code a little as I was posting, it should be &#39;refraction = &#39; of course. Edited now."}, {"owner": {"reputation": 5, "user_id": 10586553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/411e566250e7406732aef9bf106190c3?s=128&d=identicon&r=PG&f=1", "display_name": "100ethereals", "link": "https://stackoverflow.com/users/10586553/100ethereals"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1542743437, "post_id": 53400413, "comment_id": 93676133, "body": "@ScottCraner literally any set of parameters just isn&#39;t working. It&#39;s just #REF error, never a correct value, never a message box."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1542743487, "post_id": 53400413, "comment_id": 93676167, "body": "Again, I cannot get it to do that, no matter what I put.  So please give an example input."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1542743546, "post_id": 53400413, "comment_id": 93676205, "body": "For &quot;a more straightforward approach&quot;, that drifts pretty heavily to the right..."}, {"owner": {"reputation": 5, "user_id": 10586553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/411e566250e7406732aef9bf106190c3?s=128&d=identicon&r=PG&f=1", "display_name": "100ethereals", "link": "https://stackoverflow.com/users/10586553/100ethereals"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1542743690, "post_id": 53400413, "comment_id": 93676303, "body": "@ScottCraner literally anything, 10 10 10; 24 -2; 25; hello, precious, world"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1542743828, "post_id": 53400413, "comment_id": 93676374, "body": "If I use <code>=refraction(10,10,10)</code> on the worksheet I get <code>0.970588235</code> as the answer.  So <code>HOW are you calling it</code>"}, {"owner": {"reputation": 5, "user_id": 10586553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/411e566250e7406732aef9bf106190c3?s=128&d=identicon&r=PG&f=1", "display_name": "100ethereals", "link": "https://stackoverflow.com/users/10586553/100ethereals"}, "edited": false, "score": 0, "creation_date": 1542744069, "post_id": 53400413, "comment_id": 93676492, "body": "I&#39;ve literally just done the same thing and faced #REF again. I&#39;m as clueless as you and see 0 reason for this to be happening."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1542744214, "post_id": 53400413, "comment_id": 93676569, "body": "should you be using <code>;</code> instead of <code>,</code> on the worksheet call?"}, {"owner": {"reputation": 5, "user_id": 10586553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/411e566250e7406732aef9bf106190c3?s=128&d=identicon&r=PG&f=1", "display_name": "100ethereals", "link": "https://stackoverflow.com/users/10586553/100ethereals"}, "edited": false, "score": 0, "creation_date": 1542744429, "post_id": 53400413, "comment_id": 93676654, "body": "Of course, that&#39;s what I&#39;m using."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 10586553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/411e566250e7406732aef9bf106190c3?s=128&d=identicon&r=PG&f=1", "display_name": "100ethereals", "link": "https://stackoverflow.com/users/10586553/100ethereals"}, "edited": false, "score": 0, "creation_date": 1542744004, "post_id": 53400557, "comment_id": 93676459, "body": "I&#39;ve copied your code over, getting rid of the unneeded parts such as byval, debug and such and it worked. As I said before, the &quot;ref2&quot; should have been just &quot;refraction&quot;, in accordance with the function name, but I still have no clue why did my variant not work."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 5, "user_id": 10586553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/411e566250e7406732aef9bf106190c3?s=128&d=identicon&r=PG&f=1", "display_name": "100ethereals", "link": "https://stackoverflow.com/users/10586553/100ethereals"}, "edited": false, "score": 1, "creation_date": 1542745029, "post_id": 53400557, "comment_id": 93676918, "body": "@100ethereals <code>ByVal</code> isn&#39;t unneeded. Read up on <code>ByRef</code> vs <code>ByVal</code>, and you&#39;ll find that the default (implicit <code>ByRef</code>) isn&#39;t appropriate 99% of the time."}, {"owner": {"reputation": 5, "user_id": 10586553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/411e566250e7406732aef9bf106190c3?s=128&d=identicon&r=PG&f=1", "display_name": "100ethereals", "link": "https://stackoverflow.com/users/10586553/100ethereals"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1542745550, "post_id": 53400557, "comment_id": 93677151, "body": "@MathieuGuindon I&#39;m not planning to go into the depths of VBA programming tbh. This is all a part of my homework, so as to say and I&#39;m pretty confident ByRef is sufficient for things we are doing."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1542745739, "post_id": 53400557, "comment_id": 93677233, "body": "Until it bites you in the rear end because you didn&#39;t bother understanding it. FWIW the concept of passing arguments by value or by reference is just as valid in C# and other languages, understanding it properly in VBA isn&#39;t wasted energy. Especially if you&#39;re any kind of serious about whatever it is that you&#39;re studying that makes you write code."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 5, "user_id": 10586553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/411e566250e7406732aef9bf106190c3?s=128&d=identicon&r=PG&f=1", "display_name": "100ethereals", "link": "https://stackoverflow.com/users/10586553/100ethereals"}, "edited": false, "score": 2, "creation_date": 1542746333, "post_id": 53400557, "comment_id": 93677497, "body": "&quot;I don&#39;t really need to understand it&quot; is a poor attitude for a student, @100ethereals, whether you&#39;re paying for the education or your parents are."}, {"owner": {"reputation": 5, "user_id": 10586553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/411e566250e7406732aef9bf106190c3?s=128&d=identicon&r=PG&f=1", "display_name": "100ethereals", "link": "https://stackoverflow.com/users/10586553/100ethereals"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1542746970, "post_id": 53400557, "comment_id": 93677783, "body": "@FreeMan thankfully I&#39;m smart enough to study for free. I study with dedication, but since programming isn&#39;t anywhere near my major, I only learn what I&#39;ve been told to learn on the lectures. My free time is not endless and I&#39;d rather spend it on learning advanced stuff for my major. Hope you understand."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 3, "last_activity_date": 1543641271, "last_edit_date": 1543641271, "creation_date": 1542743513, "answer_id": 53400557, "question_id": 53400413, "link": "https://stackoverflow.com/questions/53400413/using-and-instead-of-branching-causes-ref-error/53400557#53400557", "title": "Using And instead of branching causes #REF error", "body": "<p>At the very least you need to <code>Exit Function</code> if all numbers and all greater than 0. In example below I am returning a <code>Variant</code>. You don't need the other <code>Exit Functions</code>. You can let the program run to the end and return what ever value you feel appropriate. You could also consider enforcing type in the function signature and then adding in error handling.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub test()\n\n    Debug.Print refraction(12, -4, 3)\n\nEnd Sub\nPublic Function refraction(ByVal a As Variant, ByVal b As Variant, ByVal c As Variant) As Variant\n    Dim ref2  As Long\n    If IsNumeric(a) And IsNumeric(b) And IsNumeric(c) Then\n        If (a &gt; 0) And (b &gt; 0) And (c &gt; 0) Then\n            ref2 = (a ^ 2 - 1) * b / c / (a ^ 2 + 2)\n            refraction = ref2\n            Exit Function\n        Else\n            MsgBox \"Range!\"\n        End If\n    Else\n        MsgBox \"Number!\"\n    End If\n    refraction = \"Invalid values passed\"\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 10586553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/411e566250e7406732aef9bf106190c3?s=128&d=identicon&r=PG&f=1", "display_name": "100ethereals", "link": "https://stackoverflow.com/users/10586553/100ethereals"}, "edited": false, "score": 0, "creation_date": 1542747571, "post_id": 53401086, "comment_id": 93678080, "body": "Thanks, this one worked like a charm, too. But I still have no idea why didn&#39;t my variant work :("}], "tags": [], "owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "is_accepted": false, "score": 2, "last_activity_date": 1542746041, "creation_date": 1542746041, "answer_id": 53401086, "question_id": 53400413, "link": "https://stackoverflow.com/questions/53400413/using-and-instead-of-branching-causes-ref-error/53401086#53401086", "title": "Using And instead of branching causes #REF error", "body": "<p>Setting the result as the fail value as the first step of the function means you will always return a valid value. Reversing logic to end the function early can make for much more readable code.</p>\n\n<pre><code>Function refraction(ByVal a As Double, ByVal b As Double, ByVal c As Double) As Variant\n\n    refraction = vbEmpty\n\n    If Not (IsNumeric(a) And IsNumeric(b) And IsNumeric(c)) Then\n        MsgBox \"A parameter was not numeric\"\n        Exit Function\n    End If\n\n    If Not ((a &gt; 0) And (b &gt; 0) And (c &gt; 0)) Then\n        MsgBox \"A parameter was negative\"\n        Exit Function\n    End If\n\n    refraction = (a ^ 2 - 1) * b / c / (a ^ 2 + 2)\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 10586553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/411e566250e7406732aef9bf106190c3?s=128&d=identicon&r=PG&f=1", "display_name": "100ethereals", "link": "https://stackoverflow.com/users/10586553/100ethereals"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1543641271, "creation_date": 1542742926, "last_edit_date": 1542743308, "question_id": 53400413, "link": "https://stackoverflow.com/questions/53400413/using-and-instead-of-branching-causes-ref-error", "title": "Using And instead of branching causes #REF error", "body": "<p>I've written a pretty simple function in VBA, which uses 3 parameters to calculate a certain value with a single expression. The problem is, the function also has to bring up specific message boxes if one of the parameters is not a number or is less or equal to 0.</p>\n\n<p>So for my first try I've come up with this code</p>\n\n<pre><code>Function refraction(a, b, c)\n\nIf IsNumeric(a) And IsNumeric(b) And IsNumeric(c) Then\n    If (a &gt; 0) And (b &gt; 0) And (c &gt; 0) Then\n        refraction = (a ^ 2 - 1) * b / c / (a ^ 2 + 2)\n    Else\n    MsgBox \"Range!\"\n    Exit Function\n    End If\nElse\nMsgBox \"Number!\"\nExit Function\nEnd If\n\nEnd Function\n</code></pre>\n\n<p>Which returns a #REF error whatever the parameters are, even if they are all numeric and positive.</p>\n\n<p>So I tried a more straightforward approach</p>\n\n<pre><code>Function refrakcja(a, b, c)\n\nIf IsNumeric(a) Then\n    If IsNumeric(b) Then\n        If IsNumeric(c) Then\n            If a &gt; 0 Then\n                If b &gt; 0 Then\n                    If c &gt; 0 Then\n                        refrakcja = (a ^ 2 - 1) * b / c / (a ^ 2 + 2)\n                    Else\n                    MsgBox \"Range!\"\n                    Exit Function\n                    End If\n                Else\n                MsgBox \"Range!\"\n                Exit Function\n                End If\n            Else\n            MsgBox \"Range!\"\n            Exit Function\n            End If\n        Else\n        MsgBox \"Number!\"\n        Exit Function\n        End If\n    Else\n    MsgBox \"Number\"\n    Exit Function\n    End If\nElse\nMsgBox \"Number!\"\nExit Function\nEnd If\n\nEnd Function\n</code></pre>\n\n<p>Which worked like a charm. So what am I doing wrong?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1542738783, "post_id": 53399325, "comment_id": 93673883, "body": "You may want to read about <a href=\"https://docs.microsoft.com/en-us/office/vba/api/Excel.WorksheetFunction\" rel=\"nofollow noreferrer\">worksheet functions</a>"}], "answers": [{"tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": false, "score": 1, "last_activity_date": 1542739031, "creation_date": 1542739031, "answer_id": 53399416, "question_id": 53399325, "link": "https://stackoverflow.com/questions/53399325/converting-from-excel-formula-to-vba-code/53399416#53399416", "title": "Converting from Excel formula to VBA code", "body": "<p>You can either use Range().Find or <a href=\"https://analystcave.com/excel-vba-evaluate-tips-and-tricks-to-use-application-evaluate/\" rel=\"nofollow noreferrer\">Evaluate()</a> your Match, if the sheet is the ActiveSheet.</p>\n"}, {"comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1542739873, "post_id": 53399436, "comment_id": 93674385, "body": "Might be an improvment to use the <code>Worksheet.Evaluate</code> method, rather than the <code>Application</code> version?  Otherwise, the result will vary according to which sheet is active."}, {"owner": {"reputation": 195, "user_id": 10414921, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-o7DRr9Yj9iQ/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DUWFKIbOgOHsrqmpkOE5s6UJlvDAA/mo/photo.jpg?sz=128", "display_name": "Garry W", "link": "https://stackoverflow.com/users/10414921/garry-w"}, "edited": false, "score": 0, "creation_date": 1542808996, "post_id": 53399436, "comment_id": 93702050, "body": "I used Evaluate(&quot;Match(&#39;Sheet1&#39;!A1,Range_Name,0)&quot;) and that also worked. :)"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 195, "user_id": 10414921, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-o7DRr9Yj9iQ/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DUWFKIbOgOHsrqmpkOE5s6UJlvDAA/mo/photo.jpg?sz=128", "display_name": "Garry W", "link": "https://stackoverflow.com/users/10414921/garry-w"}, "edited": false, "score": 0, "creation_date": 1542809661, "post_id": 53399436, "comment_id": 93702454, "body": "@GarryWang  See my <b>EDIT#1</b>"}, {"owner": {"reputation": 195, "user_id": 10414921, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-o7DRr9Yj9iQ/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DUWFKIbOgOHsrqmpkOE5s6UJlvDAA/mo/photo.jpg?sz=128", "display_name": "Garry W", "link": "https://stackoverflow.com/users/10414921/garry-w"}, "edited": false, "score": 0, "creation_date": 1542824620, "post_id": 53399436, "comment_id": 93710903, "body": "@Gary&#39;sStudent I surely feel like the student here. Thank you for the help!"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 1, "last_activity_date": 1542809635, "last_edit_date": 1542809635, "creation_date": 1542739145, "answer_id": 53399436, "question_id": 53399325, "link": "https://stackoverflow.com/questions/53399325/converting-from-excel-formula-to-vba-code/53399436#53399436", "title": "Converting from Excel formula to VBA code", "body": "<p>In both a worksheet cell and VBA:</p>\n\n<pre><code>Sub dural()\n    MsgBox Evaluate(\"Match(A1,Range_Name,0)\")\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/eZtAl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eZtAl.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>EDIT#1:</strong></p>\n\n<p>Based on the Comments, a better alternative:</p>\n\n<pre><code>Sub dural()\n    Dim r1 As Range, r2 As Range, v As Variant, wf As WorksheetFunction\n\n    Set r1 = Sheets(\"Sheet1\").Range(\"A1\")\n    Set r2 = Range(\"Range_Name\")\n    Set wf = Application.WorksheetFunction\n\n    v = wf.Match(r1, r2, 0)\n    MsgBox v\nEnd Sub\n</code></pre>\n\n<p>and to use <code>Find()</code>:</p>\n\n<pre><code>Sub larud()\n    Dim r1 As Range, r2 As Range, v As Variant\n\n    Set r1 = Sheets(\"Sheet1\").Range(\"A1\")\n    Set r2 = Range(\"Range_Name\")\n\n    v = r2.Find(What:=r1.Value, After:=r2(1)).Row\n\n    MsgBox v\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 4, "last_activity_date": 1542740038, "creation_date": 1542740038, "answer_id": 53399698, "question_id": 53399325, "link": "https://stackoverflow.com/questions/53399325/converting-from-excel-formula-to-vba-code/53399698#53399698", "title": "Converting from Excel formula to VBA code", "body": "<p>To add one more:</p>\n\n<pre><code>Dim r\nWith Activesheet\n    r = Application.Match(.Range(\"A1\").Value, Range(\"Ranged_Name\"), 0)\nEnd with\n\nIf Not IsError(r) Then\n    'got a match\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 195, "user_id": 10414921, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-o7DRr9Yj9iQ/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DUWFKIbOgOHsrqmpkOE5s6UJlvDAA/mo/photo.jpg?sz=128", "display_name": "Garry W", "link": "https://stackoverflow.com/users/10414921/garry-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 660, "favorite_count": 0, "accepted_answer_id": 53399436, "answer_count": 3, "score": 0, "last_activity_date": 1542809635, "creation_date": 1542738617, "last_edit_date": 1542738719, "question_id": 53399325, "link": "https://stackoverflow.com/questions/53399325/converting-from-excel-formula-to-vba-code", "title": "Converting from Excel formula to VBA code", "body": "<p>What's the equivalent of the following Excel code in VBA?</p>\n\n<pre><code>=MATCH(A1,Ranged_Name,0)\n</code></pre>\n\n<p>where Ranged_Name is a ranged name on the workbook level.</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1542737640, "post_id": 53399055, "comment_id": 93673316, "body": "<a href=\"https://stackoverflow.com/questions/26392482/vba-excel-to-prompt-user-response-to-select-folder-and-return-the-path-as-string\">This should help</a>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1542737746, "post_id": 53399055, "comment_id": 93673389, "body": "Do you want the user to pick a folder, or one or more individual files?  If files then <code>Application.GetOpenFilename</code> is what you need to look at."}], "answers": [{"tags": [], "owner": {"reputation": 1629, "user_id": 5379555, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PrDxe.jpg?s=128&g=1", "display_name": "Pawel Czyz", "link": "https://stackoverflow.com/users/5379555/pawel-czyz"}, "is_accepted": false, "score": 1, "last_activity_date": 1542739720, "creation_date": 1542739720, "answer_id": 53399606, "question_id": 53399055, "link": "https://stackoverflow.com/questions/53399055/how-to-open-a-folder-to-choose-which-files-to-attach-to-email-using-excel-vba/53399606#53399606", "title": "How to open a folder to choose which files to attach to email using Excel VBA?", "body": "<p>You can try this out:</p>\n\n<pre><code>Sub sendAttachment()\n\n    Dim olApp As Outlook.Application\n    Dim diaFolder As FileDialog\n    Set diaFolder = Application.FileDialog(msoFileDialogFolderPicker)\n    Set olApp = CreateObject(\"Outlook.Application\")\n    Dim olMail As Outlook.MailItem\n    Set olMail = olApp.CreateItem(olMailItem)\n    Dim lngCount As Long\n\n    olMail.To = \"email@email.com\"\n    olMail.Subject = \"Subject Line\"\n    olMail.Body = \"Body of the Email\"\n\n\n    ' Open the file dialog\n    With Application.FileDialog(msoFileDialogOpen)\n        .AllowMultiSelect = True\n        .Show\n\n        ' Display paths of each file selected\n        For lngCount = 1 To .SelectedItems.Count\n            attFilePath = Application.FileDialog(msoFileDialogOpen).SelectedItems(lngCount)\n            olMail.Attachments.Add (attFilePath)\n        Next lngCount\n\n    End With\n\n    olMail.Display\n    'olMail.Send\n\nEnd Sub\n</code></pre>\n\n<p>I hope this will help you.</p>\n"}], "owner": {"reputation": 53, "user_id": 825722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbd2996766342607b0b104ccccc7babb?s=128&d=identicon&r=PG", "display_name": "punktilend", "link": "https://stackoverflow.com/users/825722/punktilend"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1288, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1592725013, "creation_date": 1542737526, "last_edit_date": 1592725013, "question_id": 53399055, "link": "https://stackoverflow.com/questions/53399055/how-to-open-a-folder-to-choose-which-files-to-attach-to-email-using-excel-vba", "title": "How to open a folder to choose which files to attach to email using Excel VBA?", "body": "<p>Having an issue figuring out how to prompt to choose the files I want to email.</p>\n\n<pre><code>Dim olApp As Outlook.Application\nDim diaFolder As FileDialog\nSet diaFolder = Application.FileDialog(msoFileDialogFolderPicker)\nSet olApp = CreateObject(\"Outlook.Application\")\nDim olMail As Outlook.MailItem\nSet olMail = olApp.CreateItem(olMailItem)\n\nolMail.To = \"email@email.com\"\nolMail.Subject = \"Subject Line\"\nolMail.Body = \"Body of the Email\"\n\ndiaFolder.AllowMultiSelect = True\ndiaFolder.Show\n\nMsgBox diaFolder.SelectedItems\n\nSet diaFolder = Nothing\n\nolMail.Send\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1629, "user_id": 5379555, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PrDxe.jpg?s=128&g=1", "display_name": "Pawel Czyz", "link": "https://stackoverflow.com/users/5379555/pawel-czyz"}, "edited": false, "score": 1, "creation_date": 1542740495, "post_id": 53398795, "comment_id": 93674684, "body": "Try debugging using F8 key. Step line by line and check where is the problem."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1542740951, "post_id": 53398795, "comment_id": 93674896, "body": "So if they press yes what should happen exactly? Presumably you need to write something to <code>sourcerng</code>."}, {"owner": {"reputation": 199, "user_id": 6625232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0c73ea7fdce6867dddac6e36ed0e5cf?s=128&d=identicon&r=PG&f=1", "display_name": "MEC", "link": "https://stackoverflow.com/users/6625232/mec"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1542742766, "post_id": 53398795, "comment_id": 93675798, "body": "@SJR I would execute a bunch of these values .Cells(13, lCol).Value = ws1.Range(&quot;D14&quot;).Value"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1542743644, "post_id": 53398795, "comment_id": 93676281, "body": "Not sure I follow. Is it a case of using <code>.Cells(13, sourcerng.column).Value =...</code> instead?"}, {"owner": {"reputation": 199, "user_id": 6625232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0c73ea7fdce6867dddac6e36ed0e5cf?s=128&d=identicon&r=PG&f=1", "display_name": "MEC", "link": "https://stackoverflow.com/users/6625232/mec"}, "edited": false, "score": 0, "creation_date": 1542745943, "post_id": 53398795, "comment_id": 93677309, "body": "That was the part I didn&#39;t know how to do it         .Cells(5, sourceRng.Column).Value = ws1.Range(&quot;F5&quot;).Value &#39;Borrower Name"}], "owner": {"reputation": 199, "user_id": 6625232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0c73ea7fdce6867dddac6e36ed0e5cf?s=128&d=identicon&r=PG&f=1", "display_name": "MEC", "link": "https://stackoverflow.com/users/6625232/mec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1542763227, "creation_date": 1542736441, "last_edit_date": 1542763227, "question_id": 53398795, "link": "https://stackoverflow.com/questions/53398795/need-help-to-search-for-a-string-and-overwrite-data-to-same-location", "title": "Need help to search for a string and overwrite data to same location", "body": "<p>I have this code that writes data to the next empty column and it works perfectly when the record does not exist. However, I added code to search for the record (MyVal) and if found to ask if we should overwrite. When it asks the question if the user says no it exits the sub (this is correct behavior) but if the record exists I want it to write the data to the same location. I am pretty sure I have the \"Else\" in the wrong location and I don't know what code to write to tell it to write the data to the same location as the record found.</p>\n\n<pre><code>Sub Copy_To_Borrower_DBase()\nDim ws1 As Worksheet, ws2 As Worksheet\nDim myVal As String\nDim sourceRng As Range\nDim lCol As Long\nMyNote = Sheets(\"Main\").Range(\"F5\").Value &amp; _\n         \" already exists, do you want to overwrite?\"\nmyVal = Sheets(\"Main\").Range(\"F5\").Value ' dropdown list\n\nSet sourceRng = Worksheets(\"Borrower Database\").Range(\"5:5\").Find( _\n       What:=myVal, LookAt:=xlWhole) 'locate column where to copy from\n\nSet ws1 = ThisWorkbook.Sheets(\"Main\")\nSet ws2 = ThisWorkbook.Sheets(\"Borrower Database\")\n\nIf Not sourceRng Is Nothing Then\n    Answer = MsgBox(MyNote, vbCritical + vbYesNo, \"Overwrite??\")\n    If Answer = vbNo Then\n        Exit Sub\n    Else\n    End If\nElse\nWith ws2\nApplication.EnableEvents = False\nlCol = .Cells(5, .Columns.Count).End(xlToLeft).Offset(, 1).Column\n    .Cells(5, lCol).Value = ws1.Range(\"F5\").Value 'Borrower Name\n    .Range(.Cells(6, lCol), .Cells(8, lCol)).Value = \nws1.Range(\"G6:G8\").Value 'Income, Credit Pmt and Car Pmt\n    .Range(.Cells(9, lCol), .Cells(10, lCol)).Value = \nws1.Range(\"G11:G12\").Value 'Borrower Name\n    .Cells(11, lCol).Value = ws1.Range(\"G15\").Value 'Reserves\n    .Cells(12, lCol).Value = ws1.Range(\"D15\").Value 'Credit Score\n    .Cells(13, lCol).Value = ws1.Range(\"D14\").Value 'Rate\n    .Cells(14, lCol).Value = ws1.Range(\"C14\").Value 'Discount Point\nApplication.EnableEvents = True\nEnd With\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1542736277, "post_id": 53398726, "comment_id": 93672674, "body": "Please fix your code formatting"}, {"owner": {"reputation": 27, "user_id": 10681655, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8SVqyHuyMg0/AAAAAAAAAAI/AAAAAAAAAAA/BJlT-ZWNNUo/photo.jpg?sz=128", "display_name": "Guillaume", "link": "https://stackoverflow.com/users/10681655/guillaume"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1542736826, "post_id": 53398726, "comment_id": 93672917, "body": "Hi Tim, thank you, I just tried to reedits it and place the 4 space as mentioned into the instructions - apologize, it is my first post and this means I spent hours on this problem turning it around that I came at the point I need an expert eyes to help me out ;) Thanks in advance."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1542737040, "post_id": 53398726, "comment_id": 93673029, "body": "I made a start for you - all you need to do now is fix the indenting..."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1542737266, "post_id": 53398726, "comment_id": 93673130, "body": "You maybe need to respond to the <code>Calculate</code> event if the changes are not being made directly in the cells you&#39;re monitoring"}, {"owner": {"reputation": 27, "user_id": 10681655, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8SVqyHuyMg0/AAAAAAAAAAI/AAAAAAAAAAA/BJlT-ZWNNUo/photo.jpg?sz=128", "display_name": "Guillaume", "link": "https://stackoverflow.com/users/10681655/guillaume"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1542737671, "post_id": 53398726, "comment_id": 93673343, "body": "How would you do that please?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1542738057, "post_id": 53398726, "comment_id": 93673538, "body": "I tried <a href=\"http://rubberduckvba.com/indentation\" rel=\"nofollow noreferrer\">indenting</a> your code, but it looks like blocks and their ending tokens are intertwined, so the indenter doesn&#39;t produce the intended output. Does your code even compile? Alt+D,ENTER (Debug &gt; Compile VBAProject) - looks like the first <code>End With</code> should be before the second <code>End If</code>, and another <code>End If</code> seems to be missing before that."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 10681655, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8SVqyHuyMg0/AAAAAAAAAAI/AAAAAAAAAAA/BJlT-ZWNNUo/photo.jpg?sz=128", "display_name": "Guillaume", "link": "https://stackoverflow.com/users/10681655/guillaume"}, "edited": false, "score": 0, "creation_date": 1542737660, "post_id": 53398949, "comment_id": 93673334, "body": "Thank you Roman  - would you know how to place this volatile function into my macro above or do I really need a new module for it and if yes, how to call back to the $K$16 cell - the range is from K:16 - W:16 with each of them a dedicated shape for the formatting. Thank you"}, {"owner": {"reputation": 5, "user_id": 10677582, "user_type": "registered", "profile_image": "https://graph.facebook.com/2335056523203267/picture?type=large", "display_name": "Roman  Voronov", "link": "https://stackoverflow.com/users/10677582/roman-voronov"}, "reply_to_user": {"reputation": 27, "user_id": 10681655, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8SVqyHuyMg0/AAAAAAAAAAI/AAAAAAAAAAA/BJlT-ZWNNUo/photo.jpg?sz=128", "display_name": "Guillaume", "link": "https://stackoverflow.com/users/10681655/guillaume"}, "edited": false, "score": 0, "creation_date": 1542737852, "post_id": 53398949, "comment_id": 93673443, "body": "What exact formula do you have inside $K$16 cell? New UDF will be copying it&#39;s calculations and repeat your SUB code."}, {"owner": {"reputation": 27, "user_id": 10681655, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8SVqyHuyMg0/AAAAAAAAAAI/AAAAAAAAAAA/BJlT-ZWNNUo/photo.jpg?sz=128", "display_name": "Guillaume", "link": "https://stackoverflow.com/users/10681655/guillaume"}, "edited": false, "score": 0, "creation_date": 1542739330, "post_id": 53398949, "comment_id": 93674136, "body": "it refers to a calculation  on another worksheets =IFERROR(&#39;Graph Data&#39;!C303,&quot;&quot;)  and the C303 is having the following formulas : =IF(&#39;GM Track&#39;!E3=&quot;Act&quot;,&#39;GM Track&#39;!E56/&#39;GM Track&#39;!E58,NA())"}], "tags": [], "owner": {"reputation": 5, "user_id": 10677582, "user_type": "registered", "profile_image": "https://graph.facebook.com/2335056523203267/picture?type=large", "display_name": "Roman  Voronov", "link": "https://stackoverflow.com/users/10677582/roman-voronov"}, "is_accepted": false, "score": 0, "last_activity_date": 1542737105, "creation_date": 1542737105, "answer_id": 53398949, "question_id": 53398726, "link": "https://stackoverflow.com/questions/53398726/excel-vba-i-cannot-refresh-a-shape-conditional-formatting-linked-to-a-formul/53398949#53398949", "title": "excel - VBA - I cannot refresh a shape conditional formatting linked to a formulas after a cell refresh", "body": "<p><strong>Worksheet_Change</strong> will be launched if any of cells will be changed manually by user. It will not be triggered if any of your formulas like <strong>RANDBETWEEN</strong> will bring new value.</p>\n\n<p>You might be interested in reforging your routine to a VBA formula of a <a href=\"https://www.excel-easy.com/vba/examples/volatile-functions.html\" rel=\"nofollow noreferrer\">VOLATILE</a> type. Click the link to follow some of the instructions. Long story short - you can place a special command into your User Defined Function so it will run each time something changes in your workbook. And that formula you could place into <strong>$K$16</strong> cell.</p>\n\n<p>Hope that helps.</p>\n"}, {"comments": [{"owner": {"reputation": 27, "user_id": 10681655, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8SVqyHuyMg0/AAAAAAAAAAI/AAAAAAAAAAA/BJlT-ZWNNUo/photo.jpg?sz=128", "display_name": "Guillaume", "link": "https://stackoverflow.com/users/10681655/guillaume"}, "edited": false, "score": 0, "creation_date": 1542740589, "post_id": 53399341, "comment_id": 93674726, "body": "It worked out many thanks :) one more question if I might Tim - how would you make it than in case K16 is filled but L16 is empty, only Oval1 is refreshed and Oval2 would go white as ex. - just an embellishment if it could work."}, {"owner": {"reputation": 27, "user_id": 10681655, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8SVqyHuyMg0/AAAAAAAAAAI/AAAAAAAAAAA/BJlT-ZWNNUo/photo.jpg?sz=128", "display_name": "Guillaume", "link": "https://stackoverflow.com/users/10681655/guillaume"}, "edited": false, "score": 0, "creation_date": 1542742867, "post_id": 53399341, "comment_id": 93675848, "body": "I cannot thank you enough - it work very well, thank you so much for that"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1542740834, "last_edit_date": 1542740834, "creation_date": 1542738667, "answer_id": 53399341, "question_id": 53398726, "link": "https://stackoverflow.com/questions/53398726/excel-vba-i-cannot-refresh-a-shape-conditional-formatting-linked-to-a-formul/53399341#53399341", "title": "excel - VBA - I cannot refresh a shape conditional formatting linked to a formulas after a cell refresh", "body": "<p>Try this:</p>\n\n<pre><code>Private Sub Worksheet_Calculate()\n\n    CheckFormat Me.Range(\"K16\"), \"Oval 1\"\n    CheckFormat Me.Range(\"L16\"), \"Oval 2\"\n\nEnd Sub\n\nSub CheckFormat(valueRange As Range, shapeName As String)\n    Dim v, clr As Long\n    v = valueRange.Value \n\n    If Len(v) = 0 Then\n        clr = RGB(255, 255, 255) '&lt;&lt; EDIT: use white if no value\n    Else\n        If v &lt; 0.95 Then\n            clr = RGB(255, 0, 0)\n        ElseIf v &gt; 0.99 Then\n            clr = RGB(0, 255, 0)\n        Else\n            clr = RGB(255, 153, 0)\n        End If\n    End If\n    Me.Shapes(shapeName).Fill.ForeColor.RGB = clr\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 10681655, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8SVqyHuyMg0/AAAAAAAAAAI/AAAAAAAAAAA/BJlT-ZWNNUo/photo.jpg?sz=128", "display_name": "Guillaume", "link": "https://stackoverflow.com/users/10681655/guillaume"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 173, "favorite_count": 0, "accepted_answer_id": 53399341, "answer_count": 2, "score": 0, "last_activity_date": 1542740834, "creation_date": 1542736191, "last_edit_date": 1542737013, "question_id": 53398726, "link": "https://stackoverflow.com/questions/53398726/excel-vba-i-cannot-refresh-a-shape-conditional-formatting-linked-to-a-formul", "title": "excel - VBA - I cannot refresh a shape conditional formatting linked to a formulas after a cell refresh", "body": "<p>I need your help. \ncontext: I have a VBA to change colors (Green, Orange, Red) to several shapes linked to a % value. The values will change based on a list box. However if the % change, the formatting do not follow.</p>\n\n<p>The macro is as the following - would you know how to \"force\" the refresh so that the Shape formatting follow any cell changes? below attempt to force it failed.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    EnableFormatConditionsCalculation = True    \n    If Target.Address = \"$K$16\" Then \n    With Sheets(\"Resources\").Shapes(\"Oval 1\")    \n    If Sheets(\"Resources\").Cells(16, 11).Value &lt; 0.95 Then \n    .Fill.ForeColor.RGB = RGB(255, 0, 0)    \n    Else If \n    Sheets(\"Resources\").Cells(16, 11).Value &gt; 0.99 Then \n    .Fill.ForeColor.RGB = RGB(0, 255, 0)    \n    Else \n    .Fill.ForeColor.RGB = RGB(255, 153, 0)    \n    End If    \n    End If    \n    End With    \n    ElseIf Target.Address = \"$L$16\" Then \n    With Sheets(\"Resources\").Shapes(\"Oval 2\")    \n    If Sheets(\"Resources\").Cells(16, 12).Value &lt; 0.95    Then \n    .Fill.ForeColor.RGB = RGB(255, 0, 0)    \n    Else If Sheets(\"Resources\").Cells(16, 12).Value &gt; 0.99    Then \n    .Fill.ForeColor.RGB = RGB(0, 255, 0)    \n    Else \n    .Fill.ForeColor.RGB = RGB(255, 153, 0)     \n    End If    \n    End If    \n    End With \n    Range(\"K16:W16\").Calculate    \n    End If    \n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "button", "user-input", "userform"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1542735028, "post_id": 53398060, "comment_id": 93672005, "body": "Welcome to Stack Overflow! Next time, when adding a code snippet, highlight all of your code and press Ctrl + K on your keyboard to properly format it. Cheers!"}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1542736341, "post_id": 53398298, "comment_id": 93672707, "body": "What is it that makes <code>IsDate</code> flaky?"}, {"owner": {"reputation": 1, "user_id": 10681456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53da8a82527beaa4994dd8cc12061064?s=128&d=identicon&r=PG&f=1", "display_name": "IREVEL", "link": "https://stackoverflow.com/users/10681456/irevel"}, "edited": false, "score": 0, "creation_date": 1542737216, "post_id": 53398298, "comment_id": 93673111, "body": "@NeepNeepNeep would this bypass the need for the UserForm completely? Or would this be the code tied to the UserForm?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 1, "user_id": 10681456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53da8a82527beaa4994dd8cc12061064?s=128&d=identicon&r=PG&f=1", "display_name": "IREVEL", "link": "https://stackoverflow.com/users/10681456/irevel"}, "edited": false, "score": 0, "creation_date": 1542737706, "post_id": 53398298, "comment_id": 93673362, "body": "@IREVEL type <code>InputBox &quot;test&quot;</code> + ENTER in the immediate pane (Ctrl+G), you&#39;ll answer that question fast enough. (spoiler: the fully-qualified name is <code>VBA.Interaction.InputBox</code>, i.e. same module as the <code>MsgBox</code> function - yes, it replaces your userform entirely.... although a UserForm has other advantages, like, you could embed the validation and actively <i>prevent</i> the user from okaying the modal dialog with invalid input)"}, {"owner": {"reputation": 1, "user_id": 10681456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53da8a82527beaa4994dd8cc12061064?s=128&d=identicon&r=PG&f=1", "display_name": "IREVEL", "link": "https://stackoverflow.com/users/10681456/irevel"}, "edited": false, "score": 0, "creation_date": 1542750146, "post_id": 53398298, "comment_id": 93679265, "body": "Thank you both for your help. I ended up incorporating the &#39;InputBox&#39; before running any of the auto filtering/sorting. Had it populate into a specific cell in a hidden sheet, and then referenced that cell as the date to sort in the Main Sub. Worked wonderfully. Thanks again!"}, {"owner": {"reputation": 823, "user_id": 4786843, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AwVWr.jpg?s=128&g=1", "display_name": "NeepNeepNeep", "link": "https://stackoverflow.com/users/4786843/neepneepneep"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1542797521, "post_id": 53398298, "comment_id": 93695696, "body": "@MathieuGuindon IsDate is notoriously permissive and will allow pretty much any format that comes along, whatever your regional settings, i.e. &quot;31/12/2018&quot;, &quot;12/31/2018&quot; and so on.  That said, it is useful as a final arbiter for valid leap year dates"}, {"owner": {"reputation": 823, "user_id": 4786843, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AwVWr.jpg?s=128&g=1", "display_name": "NeepNeepNeep", "link": "https://stackoverflow.com/users/4786843/neepneepneep"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1542797660, "post_id": 53398298, "comment_id": 93695773, "body": "@MathieuGuindon yes, it precludes the need for a UserForm &amp; yes, you could employ a UF and include extra code for a more robust user experience"}], "tags": [], "owner": {"reputation": 823, "user_id": 4786843, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AwVWr.jpg?s=128&g=1", "display_name": "NeepNeepNeep", "link": "https://stackoverflow.com/users/4786843/neepneepneep"}, "is_accepted": false, "score": 1, "last_activity_date": 1542734522, "creation_date": 1542734522, "answer_id": 53398298, "question_id": 53398060, "link": "https://stackoverflow.com/questions/53398060/running-autofilter-vba-macro-that-has-a-pop-up-to-enter-date/53398298#53398298", "title": "Running autofilter VBA macro that has a pop up to enter date", "body": "<p>Initially I'd recommend an input box and check that the input is valid:</p>\n\n<pre><code>Dim myDate as String\n\nmyDate = InputBox(\"Please enter a date (dd/mm/yyyy)\", \"Date filter\", Format(Now() - 7, \"dd/mm/yyyy\"))\n\nIf IsDate(myDate) Then\n   ' Continue with logic\nElse\n    MsgBox \"Invalid date\"\nEnd If\n</code></pre>\n\n<p>Be warned that IsDate is a pretty flaky function, but you can go on to make this code fancier, if you see fit.</p>\n"}], "owner": {"reputation": 1, "user_id": 10681456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53da8a82527beaa4994dd8cc12061064?s=128&d=identicon&r=PG&f=1", "display_name": "IREVEL", "link": "https://stackoverflow.com/users/10681456/irevel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 513, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542737065, "creation_date": 1542733686, "last_edit_date": 1542737065, "question_id": 53398060, "link": "https://stackoverflow.com/questions/53398060/running-autofilter-vba-macro-that-has-a-pop-up-to-enter-date", "title": "Running autofilter VBA macro that has a pop up to enter date", "body": "<p>I am a bit new to this whole VBA/Excel Macros thing so I am trying my best to find the solutions I need, so far I've done well - but finally hit a dead-end.</p>\n\n<p>I have a code that is AutoFiltering my data table, and then Sorting base off specific columns (see below). </p>\n\n<pre><code>Sub FGReport()\n    ActiveWorkbook.Worksheets(\"Sorted Report FG\").ListObjects(\"Table25\").Range.AutoFilter Field:=2, Criteria1:= \"1085\"\n    ActiveWorkbook.Worksheets(\"Sorted Report FG\").ListObjects(\"Table25\").Range.AutoFilter Field:=4, Criteria1:= \"&lt;&gt;$0\"\n    ActiveWorkbook.Worksheets(\"Sorted Report FG\").ListObjects(\"Table25\").Range.AutoFilter Field:=6, Criteria1:= \"&lt;1/1/2018\", Operator:=xlAnd\n    'ActiveWorkbook.Worksheets(\"Sorted Report FG\").Range(\"Table25[[#Headers],[LastSoldDate]]\").Select\n    ActiveWorkbook.Worksheets(\"Sorted Report FG\").ListObjects(\"Table25\").Sort. SortFields.Clear\n    ActiveWorkbook.Worksheets(\"Sorted Report FG\").ListObjects(\"Table25\").Sort. SortFields.Add2 Key:=Range(\"Table25[LastSoldDate]\"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal\n    ActiveWorkbook.Worksheets(\"Sorted Report FG\").ListObjects(\"Table25\").Sort. SortFields.Add2 Key:=Range(\"Table25[TotalInventoryValue]\"), SortOn:= xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal\n    With ActiveWorkbook.Worksheets(\"Sorted Report FG\").ListObjects(\"Table25\").Sort\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n</code></pre>\n\n<p>Where the code is auto filtering the date (Line 4). I would like it to prompt the user to enter the date manually. I figured doing this with a UserForm would be the most appropriate (picture below) </p>\n\n<p><a href=\"https://i.stack.imgur.com/8rsqe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8rsqe.png\" alt=\"img1\"></a></p>\n\n<p>I just have no clue how to prompt the UserForm to appear during that line of the code, and have it function by entering the date, clicking Enter, and then continue running the original FGReport() macro.</p>\n\n<p>Let me know if more information is needed! Thanks!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 2, "creation_date": 1542734976, "post_id": 53398044, "comment_id": 93671972, "body": "What worksheet is ws?"}, {"owner": {"reputation": 11, "user_id": 10457463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf5aee4184cc7631f4a53a10ff09783a?s=128&d=identicon&r=PG&f=1", "display_name": "kh999459", "link": "https://stackoverflow.com/users/10457463/kh999459"}, "reply_to_user": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1542735127, "post_id": 53398044, "comment_id": 93672056, "body": "@GMalc ws it&#39;s another worksheet but it&#39;s on the same workbook with &quot;Copy Graph&quot;"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1542735577, "post_id": 53398044, "comment_id": 93672321, "body": "Well in the context of your question, <code>ws.Paste</code> looks like it would throw run-time error 91 for not being <code>Set</code> to anything. Please read <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 11, "user_id": 10457463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf5aee4184cc7631f4a53a10ff09783a?s=128&d=identicon&r=PG&f=1", "display_name": "kh999459", "link": "https://stackoverflow.com/users/10457463/kh999459"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1542739111, "post_id": 53398044, "comment_id": 93674045, "body": "@MathieuGuindon I edited the question. Thank you for your comment."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1583759551, "post_id": 53398044, "comment_id": 107213280, "body": "Actually I tested your code and it perfectly worked without throwing any error. I cannot reproduce it. Actually you don&#39;t need to <code>.Activate</code> the chart instead you can dircetly copy it using <code>ChartObjects(&quot;Chart 1&quot;).CopyPicture</code>. Make sure the worksheet <code>Worksheets(&quot;Copy Graph&quot;)</code> is the active sheet when copying the chart."}], "owner": {"reputation": 11, "user_id": 10457463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf5aee4184cc7631f4a53a10ff09783a?s=128&d=identicon&r=PG&f=1", "display_name": "kh999459", "link": "https://stackoverflow.com/users/10457463/kh999459"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 321, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1583759014, "creation_date": 1542733649, "last_edit_date": 1583759014, "question_id": 53398044, "link": "https://stackoverflow.com/questions/53398044/method-paste-of-object-worksheet-failed-when-pasting-graph", "title": "Method &#39;Paste&#39; of object &#39;_Worksheet&#39; failed when pasting graph", "body": "<p>I would like to copy a graph from a worksheet(\"Copy Graph\") and then paste it to another worksheet(\"Paste Graph\") as a picture. Here is what I have:</p>\n\n<pre><code>Dim ws as worksheet\nSet ws = Worksheets(\"Paste Graph\") \n\nWorksheets(\"Copy Graph\").ChartObjects(\"Chart 1\").Activate\nActiveChart.Parent.CopyPicture\nws.Paste Destination:=ws.Range(\"E16\")\n</code></pre>\n\n<p>It works on my computer but when I ran it on another computer, I got the error: \" Method 'Paste' of object '_Worksheet' failed\"</p>\n\n<p>I guess it is because of the use of \"activate\". Should I activate the destination range before pasting?</p>\n\n<p>Also is there a way to improve the codes? I feel it's quite easy to crash. </p>\n\n<p>Thank you!!!</p>\n"}]