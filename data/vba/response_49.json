[{"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1149, "user_id": 5168028, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh4.googleusercontent.com/-nT_-2fs9ykY/AAAAAAAAAAI/AAAAAAAAABI/n9DanYw3AEk/photo.jpg?sz=128", "display_name": "Jonah Fleming", "link": "https://stackoverflow.com/users/5168028/jonah-fleming"}, "edited": false, "score": 0, "creation_date": 1450301628, "post_id": 34322290, "comment_id": 56386752, "body": "Hello and welcome to Stack Oberflow. Before posting, please take the time to read our <a href=\"http://stackoverflow.com/help/mcve\">mcve</a> section of our help."}, {"owner": {"reputation": 47, "user_id": 5634862, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/09e86112ada5e62afea5eda8e45f8f37?s=128&d=identicon&r=PG&f=1", "display_name": "Franco Fransis", "link": "https://stackoverflow.com/users/5634862/franco-fransis"}, "reply_to_user": {"reputation": 1149, "user_id": 5168028, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh4.googleusercontent.com/-nT_-2fs9ykY/AAAAAAAAAAI/AAAAAAAAABI/n9DanYw3AEk/photo.jpg?sz=128", "display_name": "Jonah Fleming", "link": "https://stackoverflow.com/users/5168028/jonah-fleming"}, "edited": false, "score": 0, "creation_date": 1450302555, "post_id": 34322290, "comment_id": 56387244, "body": "Thanks for your comment. As obvious this is my first question. Can you please point out what is the problem with the question. I&#39;ve gone through the help section but I&#39;m unable to figure out."}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1450304786, "post_id": 34322290, "comment_id": 56388365, "body": "There is no actual question being asked. What errors are you reporting in the script that you are using?"}, {"owner": {"reputation": 47, "user_id": 5634862, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/09e86112ada5e62afea5eda8e45f8f37?s=128&d=identicon&r=PG&f=1", "display_name": "Franco Fransis", "link": "https://stackoverflow.com/users/5634862/franco-fransis"}, "reply_to_user": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1450344208, "post_id": 34322290, "comment_id": 56403122, "body": "@nbayly This code is for looping through all the directories and files. I am unable to edit it so that it give only the sub-directories with a single pattern and the sub-directories of that folder with a single pattern and then it&#39;s sub-directories with another single pattern and then only the .edf files in that folder. I could do the .edf files thing though in this code."}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 5634862, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/09e86112ada5e62afea5eda8e45f8f37?s=128&d=identicon&r=PG&f=1", "display_name": "Franco Fransis", "link": "https://stackoverflow.com/users/5634862/franco-fransis"}, "edited": false, "score": 0, "creation_date": 1450350678, "post_id": 34331576, "comment_id": 56407506, "body": "Thanks for your answer. This seems great. But My compiler is giving user defined type not defined error at dFNs As New Scripting.Dictionary. I&#39;m new to vba. I&#39;d be greatfull if you could tell me how to solve this."}, {"owner": {"reputation": 47, "user_id": 5634862, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/09e86112ada5e62afea5eda8e45f8f37?s=128&d=identicon&r=PG&f=1", "display_name": "Franco Fransis", "link": "https://stackoverflow.com/users/5634862/franco-fransis"}, "edited": false, "score": 0, "creation_date": 1450351596, "post_id": 34331576, "comment_id": 56408067, "body": "I&#39;m really sorry for the stupid questions but I&#39;m out of time. It is giving runtime error at fp = Dir(vFMs(d), iFLDR). The variable vFMs(d) is giving two paths concatenated in a very unusual way. I think that&#39;s the issue but but I don&#39;t know how to resolve it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 47, "user_id": 5634862, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/09e86112ada5e62afea5eda8e45f8f37?s=128&d=identicon&r=PG&f=1", "display_name": "Franco Fransis", "link": "https://stackoverflow.com/users/5634862/franco-fransis"}, "edited": false, "score": 0, "creation_date": 1450352801, "post_id": 34331576, "comment_id": 56408798, "body": "I&#39;m afraid I could not reproduce that and it is unlikely that I could without testing it on an exact copy of your directory tree. You could try using conventional backslashes in the string assignment of the original file mask but beyond that, I am not sure what is going on. Obviously, you&#39;ve changed things from the original as I was working out of my temp folder and you are working out of C:"}, {"owner": {"reputation": 47, "user_id": 5634862, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/09e86112ada5e62afea5eda8e45f8f37?s=128&d=identicon&r=PG&f=1", "display_name": "Franco Fransis", "link": "https://stackoverflow.com/users/5634862/franco-fransis"}, "edited": false, "score": 0, "creation_date": 1450353804, "post_id": 34331576, "comment_id": 56409459, "body": "I didn&#39;t change anything. Just Replaced the link according to the template in your code. However Thanks for your help so for. I&#39;ll try to figure out myself from here."}, {"owner": {"reputation": 47, "user_id": 5634862, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/09e86112ada5e62afea5eda8e45f8f37?s=128&d=identicon&r=PG&f=1", "display_name": "Franco Fransis", "link": "https://stackoverflow.com/users/5634862/franco-fransis"}, "edited": false, "score": 0, "creation_date": 1450354880, "post_id": 34331576, "comment_id": 56410134, "body": "Could you do this if I send you the original folder if you have enough time? I&#39;d really appreciate the help."}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1568368532, "post_id": 34331576, "comment_id": 102260411, "body": "clever idea. it did not work for me, probably because I have some \\*\\ in sFM"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 3, "last_activity_date": 1450346239, "creation_date": 1450346239, "answer_id": 34331576, "question_id": 34322290, "link": "https://stackoverflow.com/questions/34322290/loop-through-all-the-directories-and-sub-directories-with-intermediate-wildcard/34331576#34331576", "title": "Loop through all the directories and sub-directories with intermediate wildcard patterns", "body": "<p>I took a different route with a Scripting.Dictionary object. After creating a directory structure with multiple folders at the ABC and XYZ levels (both matching and non-matching, I populated the final folders with both *.txt and *.edf files.</p>\n\n<blockquote>\n  <p><sup>The following procedure loads the Scripting.Dictionary object with <strong>Early Binding</strong>. This requires that <strong>Microsoft Scripting Runtime</strong> be added to the project with the VBE's Tools \u25ba References. For more universality, <strong>Late Binding</strong> can be used by initially dimming the <strong>dFNs</strong> variable as an object and using the <a href=\"https://msdn.microsoft.com/en-us/library/office/aa220083%28v=office.11%29.aspx\" rel=\"nofollow\">CreateObject method</a>.</sup></p>\n</blockquote>\n\n<pre><code>Sub main()\n    Dim fm As Long, sFM As String, vFMs As Variant, sMASK As String\n    Dim fn As Variant, dFNs As New Scripting.Dictionary\n\n    sFM = Environ(\"TMP\") &amp; \"\\Main Directory\\ABC*\\Y\\XYZ*\\*.edf\"\n    If UBound(Split(sFM, Chr(42))) &lt; 2 Then Exit Sub  '&lt;~~possibly adjust this safety\n    sFM = Replace(sFM, \"/\", \"\\\")\n    vFMs = Split(sFM, Chr(92))\n\n    sMASK = vFMs(LBound(vFMs))\n    For fm = LBound(vFMs) + 1 To UBound(vFMs)\n        sMASK = Join(Array(sMASK, vFMs(fm)), Chr(92))\n        If CBool(InStr(1, vFMs(fm), Chr(42))) Or fm = UBound(vFMs) Then\n            build_FolderLevels dFNs, sFM:=sMASK, iFLDR:=Abs((fm &lt; UBound(vFMs)) * vbDirectory)\n            sMASK = vbNullString\n        End If\n    Next fm\n\n    'list the files\n    For Each fn In dFNs\n        Debug.Print \"from dict: \" &amp; fn\n    Next fn\n\n    dFNs.RemoveAll: Set dFNs = Nothing\nEnd Sub\n\nSub build_FolderLevels(dFMs As Scripting.Dictionary, _\n                       Optional sFM As String = \"\", _\n                       Optional iFLDR As Long = 0)\n    Dim d As Long, fp As String, vFMs As Variant\n\n    If CBool(dFMs.Count) Then\n        vFMs = dFMs.Keys\n        For d = LBound(vFMs) To UBound(vFMs)\n            vFMs(d) = vFMs(d) &amp; sFM\n        Next d\n    Else\n        vFMs = Array(sFM)\n    End If\n    dFMs.RemoveAll\n\n    For d = LBound(vFMs) To UBound(vFMs)\n        fp = Dir(vFMs(d), iFLDR)\n        Do While CBool(Len(fp))\n            dFMs.Add Key:=Left(vFMs(d), InStrRev(vFMs(d), Chr(92))) &amp; fp, _\n                     Item:=iFLDR\n            fp = Dir\n        Loop\n    Next d\nEnd Sub\n</code></pre>\n\n<p>To facilitate the recursive behavior, I passed the dictionary keys off to a variant array and then scrubbed the dictionary. Using the elements of the array concatenated with the new wildcard mask, I repopulated the dictionary. Rinse and repeat until all possible combinations had been run through.</p>\n\n<p>Here are the results from the VBE's <strong>Immediate</strong> window.</p>\n\n<pre><code>main\nfrom dict: t:\\TMP\\Main Directory\\ABC\\Y\\XYZ\\Temp.edf\nfrom dict: t:\\TMP\\Main Directory\\ABC\\Y\\XYZ\\Temp1.edf\nfrom dict: t:\\TMP\\Main Directory\\ABC\\Y\\XYZ\\Temp2.edf\nfrom dict: t:\\TMP\\Main Directory\\ABC\\Y\\XYZ1\\Temp.edf\nfrom dict: t:\\TMP\\Main Directory\\ABC\\Y\\XYZ1\\Temp1.edf\nfrom dict: t:\\TMP\\Main Directory\\ABC\\Y\\XYZ1\\Temp2.edf\nfrom dict: t:\\TMP\\Main Directory\\ABC\\Y\\XYZ2\\Temp.edf\nfrom dict: t:\\TMP\\Main Directory\\ABC\\Y\\XYZ2\\Temp1.edf\nfrom dict: t:\\TMP\\Main Directory\\ABC\\Y\\XYZ2\\Temp2.edf\nfrom dict: t:\\TMP\\Main Directory\\ABC1\\Y\\XYZ\\Temp.edf\nfrom dict: t:\\TMP\\Main Directory\\ABC1\\Y\\XYZ\\Temp1.edf\nfrom dict: t:\\TMP\\Main Directory\\ABC1\\Y\\XYZ\\Temp2.edf\nfrom dict: t:\\TMP\\Main Directory\\ABC1\\Y\\XYZ1\\Temp.edf\nfrom dict: t:\\TMP\\Main Directory\\ABC1\\Y\\XYZ1\\Temp1.edf\nfrom dict: t:\\TMP\\Main Directory\\ABC1\\Y\\XYZ1\\Temp2.edf\nfrom dict: t:\\TMP\\Main Directory\\ABC1\\Y\\XYZ2\\Temp.edf\nfrom dict: t:\\TMP\\Main Directory\\ABC1\\Y\\XYZ2\\Temp1.edf\nfrom dict: t:\\TMP\\Main Directory\\ABC1\\Y\\XYZ2\\Temp2.edf\nfrom dict: t:\\TMP\\Main Directory\\ABC2\\Y\\XYZ\\Temp.edf\nfrom dict: t:\\TMP\\Main Directory\\ABC2\\Y\\XYZ\\Temp1.edf\nfrom dict: t:\\TMP\\Main Directory\\ABC2\\Y\\XYZ\\Temp2.edf\nfrom dict: t:\\TMP\\Main Directory\\ABC2\\Y\\XYZ1\\Temp.edf\nfrom dict: t:\\TMP\\Main Directory\\ABC2\\Y\\XYZ1\\Temp1.edf\nfrom dict: t:\\TMP\\Main Directory\\ABC2\\Y\\XYZ1\\Temp2.edf\nfrom dict: t:\\TMP\\Main Directory\\ABC2\\Y\\XYZ2\\Temp.edf\nfrom dict: t:\\TMP\\Main Directory\\ABC2\\Y\\XYZ2\\Temp1.edf\nfrom dict: t:\\TMP\\Main Directory\\ABC2\\Y\\XYZ2\\Temp2.edf\n</code></pre>\n\n<p>I also ran through several variations on your original wildcard path with similar success.</p>\n"}], "owner": {"reputation": 47, "user_id": 5634862, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/09e86112ada5e62afea5eda8e45f8f37?s=128&d=identicon&r=PG&f=1", "display_name": "Franco Fransis", "link": "https://stackoverflow.com/users/5634862/franco-fransis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 289, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1450346384, "creation_date": 1450300754, "last_edit_date": 1450346384, "question_id": 34322290, "link": "https://stackoverflow.com/questions/34322290/loop-through-all-the-directories-and-sub-directories-with-intermediate-wildcard", "title": "Loop through all the directories and sub-directories with intermediate wildcard patterns", "body": "<p>I have a code that loops through all the directories but I need to loop through some specific directories only at each level. e.g the path. C:/Main Directory/ABC*/Y/XYZ*/*.edf.</p>\n\n<p>This code gives every file in every directory through recursion. I am unable to edit it so that it give only the sub-directories with a single pattern and the sub-directories of that folder with a single pattern and then it's sub-directories with another single pattern and then only the .edf files in that folder. I could do the .edf files thing though in this code</p>\n\n<p>I'm doing it through these two functions.</p>\n\n<pre><code>Function Recursive(FolderPath As String)\nDim Value As String, Folders() As String\nDim Folder As Variant, a As Long\nReDim Folders(0)\nIf Right(FolderPath, 2) = \"\\\\\" Then Exit Function\nValue = Dir(FolderPath, &amp;H10)\nDo Until Value = \"\"\n    If Value = \".\" Or Value = \"..\" Then\n    Else\n        If GetAttr(FolderPath &amp; Value) = 16 Then\n            Folders(UBound(Folders)) = Value\n            ReDim Preserve Folders(UBound(Folders) + 1)\n        Else\n            If Count = 4 Then\n                temp(0, UBound(temp, 2)) = FolderPath\n                temp(1, UBound(temp, 2)) = Value\n                temp(2, UBound(temp, 2)) = Count ' FileLen(FolderPath &amp; Value)\n                ReDim Preserve temp(UBound(temp, 1), UBound(temp, 2) + 1)\n                End If\n        End If\n    End If\n    Value = Dir\nLoop\nFor Each Folder In Folders\n    Count = Count + 1\n    Recursive FolderPath &amp; Folder &amp; \"\\\"\n    Count = Count - 1\nNext Folder\nEnd Function\n</code></pre>\n\n<p>And</p>\n\n<pre><code>Public temp() As String\nPublic Count As Integer\nFunction ListFiles(FolderPath As String)\nDim k As Long, i As Long\nReDim temp(2, 0)\nCount = 1\nIf Right(FolderPath, 1) &lt;&gt; \"\\\" Then\n    FolderPath = FolderPath &amp; \"\\\"\nEnd If\nRecursive FolderPath\nk = Range(Application.Caller.Address).Rows.Count\nIf k &lt; UBound(temp, 2) Then\n    MsgBox \"There are more rows, extend user defined function\"\nElse\n    For i = UBound(temp, 2) To k\n          ReDim Preserve temp(UBound(temp, 1), i)\n            temp(0, i) = \"\"\n            temp(1, i) = \"\"\n            temp(2, i) = \"\"\n    Next i\nEnd If\nListFiles = Application.Transpose(temp)\nReDim temp(0)\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5660990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae6ed67ade8ed25671ec3940c5e45218?s=128&d=identicon&r=PG&f=1", "display_name": "Andy Harris", "link": "https://stackoverflow.com/users/5660990/andy-harris"}, "edited": false, "score": 0, "creation_date": 1450360528, "post_id": 34333481, "comment_id": 56413937, "body": "I have edited the question in an attempt to clearify what it is I&#39;m trying to achieve.  I have used Control.SetFocus with no luck.  I also want to keep the ListBox values clear until the user tab&#39;s into the control so that i know the user has visited every field within the form before submitting the data."}], "tags": [], "owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "is_accepted": false, "score": 0, "last_activity_date": 1450351753, "creation_date": 1450351753, "answer_id": 34333481, "question_id": 34321957, "link": "https://stackoverflow.com/questions/34321957/call-control-enter-event-upon-re-entry/34333481#34333481", "title": "Call control enter event upon re-entry", "body": "<p>The <code>Control_Enter</code> event occurs just before the control gets focus, for example by tabbing onto the control. However it will not occur again until the user exits that control. If you wish to handle a kind of <em>re-enter</em> event then you'd need programmatically to exit the control. I believe setting focus on another control would do it, eg <code>CommandButton1.SetFocus</code>.</p>\n\n<p>However, I can't help thinking the user's interface experience would be odd. Changing a control when the user selects it, might cause the user to interpret his interface actions wrongly or as if the app was out of his control.</p>\n\n<p>I'm struggling to see why you wouldn't set the <code>ListBox</code> values when the app launches and then whenever you process his selections. Presumably there is some code which handles the <code>ListBox</code> values, perhaps even triggered by some kind of <em>Execute</em> <code>CommandButton</code>. I'd reset the default values at the end of that code. This way there'd be a cue to the user that his selections had been successfully processed.</p>\n"}], "owner": {"reputation": 1, "user_id": 5660990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae6ed67ade8ed25671ec3940c5e45218?s=128&d=identicon&r=PG&f=1", "display_name": "Andy Harris", "link": "https://stackoverflow.com/users/5660990/andy-harris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1450360293, "creation_date": 1450299366, "last_edit_date": 1531164843, "question_id": 34321957, "link": "https://stackoverflow.com/questions/34321957/call-control-enter-event-upon-re-entry", "title": "Call control enter event upon re-entry", "body": "<p>I have a UserForm that uses multiple ListBox as well as TextBox Controls.  I have the tab order set up so the user can tab through the controls in sequential order.  I also wrote a function to check for empty and or unselected controls, forcing the user to fill out the form in it's entirety and therefore want all control Values blank until the user tabs to that control and or types a value to ensure the control wasn't over looked.  </p>\n\n<p>I  have ListBox(n).Listindex defualt to 0 upon the Control_Enter Event rather than -1.  This allows the user to tab into the control and key down the list rather smoothly. This Works on the first entry with the following code:</p>\n\n<pre><code>Private Sub ListBox1_Enter()\nMe.ListBox1.ListIndex = 0\nEnd Sub\n</code></pre>\n\n<p>Upon submitting the form data, i.e. CommandButton1_Click(), The data is placed into a worksheet, all Control values are cleared and Focus is placed back on the first control in the form.  However, when the ListBox Controls are tabbed into, ListIdex defaults back to -1.  Why doesn't the Control_Enter event get triggered?  </p>\n"}, {"tags": ["vba", "excel", "userform"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1450298216, "post_id": 34321583, "comment_id": 56384912, "body": "All the <code>And</code>s that are meant as seperate functions; <code>Total = Total + CDbl(TextBox18.Value) And Count = Count + 1</code>, need to be either new lines or <code>:</code>.  vba does not allow this."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1450298283, "post_id": 34321583, "comment_id": 56384958, "body": "Also you are adding a double to an integer which will truncate any decimal.  If that is not what you want then declare total as Double."}, {"owner": {"reputation": 185, "user_id": 3794203, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/cba2a1760eb1c8f18f60de42d7070f21?s=128&d=identicon&r=PG&f=1", "display_name": "user3794203", "link": "https://stackoverflow.com/users/3794203/user3794203"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1450299672, "post_id": 34321583, "comment_id": 56385781, "body": "Thank you.  I have made the edits (above) and this now appears to work great when only numbers are entered, however anytime a non number is entered I get the &quot;Overflow&quot; error again... Any idea on how I could keep that from happening?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1450299899, "post_id": 34321583, "comment_id": 56385903, "body": "You are changing the values which is triggering the sub again and again till the memory fills up.  Instead of <code>TextBox14.Value = Null</code> try <code>TextBox14.Value = 0</code>.  Do that with all and see."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1450302536, "post_id": 34321583, "comment_id": 56387231, "body": "It looks silly to have duplicate code just for different textboxes. I would pass in <code>GPASum(TextBoxControl)</code> and work on that textbox control."}], "answers": [{"comments": [{"owner": {"reputation": 185, "user_id": 3794203, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/cba2a1760eb1c8f18f60de42d7070f21?s=128&d=identicon&r=PG&f=1", "display_name": "user3794203", "link": "https://stackoverflow.com/users/3794203/user3794203"}, "edited": false, "score": 0, "creation_date": 1450367608, "post_id": 34324683, "comment_id": 56418849, "body": "Thank you for the suggestion.  I tested this one out as well but am still getting the Overflow error on the last line of GPASum."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 185, "user_id": 3794203, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/cba2a1760eb1c8f18f60de42d7070f21?s=128&d=identicon&r=PG&f=1", "display_name": "user3794203", "link": "https://stackoverflow.com/users/3794203/user3794203"}, "edited": false, "score": 0, "creation_date": 1450370502, "post_id": 34324683, "comment_id": 56421059, "body": "What are the values of <code>Total</code> and <code>count</code> when it fails ?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 185, "user_id": 3794203, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/cba2a1760eb1c8f18f60de42d7070f21?s=128&d=identicon&r=PG&f=1", "display_name": "user3794203", "link": "https://stackoverflow.com/users/3794203/user3794203"}, "edited": false, "score": 0, "creation_date": 1450376956, "post_id": 34324683, "comment_id": 56424869, "body": "When it errors if you hover the pointer over the variable name in the VB editor it will show you the value.  Or enter <code>? Total</code> in the Immediate pane in the VBE and hit Enter"}, {"owner": {"reputation": 185, "user_id": 3794203, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/cba2a1760eb1c8f18f60de42d7070f21?s=128&d=identicon&r=PG&f=1", "display_name": "user3794203", "link": "https://stackoverflow.com/users/3794203/user3794203"}, "edited": false, "score": 0, "creation_date": 1450379009, "post_id": 34324683, "comment_id": 56425989, "body": "When I hover over the variable it says the <code>TextBox27.Value = &quot; &quot; </code> and the Immediate window gave a value of 0."}, {"owner": {"reputation": 185, "user_id": 3794203, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/cba2a1760eb1c8f18f60de42d7070f21?s=128&d=identicon&r=PG&f=1", "display_name": "user3794203", "link": "https://stackoverflow.com/users/3794203/user3794203"}, "edited": false, "score": 0, "creation_date": 1450385862, "post_id": 34324683, "comment_id": 56429744, "body": "Thank you. It does not seem to be doing anything now when I enter non numeric text."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 185, "user_id": 3794203, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/cba2a1760eb1c8f18f60de42d7070f21?s=128&d=identicon&r=PG&f=1", "display_name": "user3794203", "link": "https://stackoverflow.com/users/3794203/user3794203"}, "edited": false, "score": 0, "creation_date": 1450390976, "post_id": 34324683, "comment_id": 56432365, "body": "Code as posted works for me.  Have you made any changes ?"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1450381439, "last_edit_date": 1450381439, "creation_date": 1450312120, "answer_id": 34324683, "question_id": 34321583, "link": "https://stackoverflow.com/questions/34321583/userform-internal-counter-for-calculations/34324683#34324683", "title": "UserForm internal counter for calculations", "body": "<p>Best to move most of that logic to a separate Sub and call it for each textbox</p>\n\n<p>Tested:</p>\n\n<pre><code>Private Sub GPASum()\n\n    Dim Total As Double\n    Dim count As Long, numErrs As Long\n    Total = 0\n    count = 0\n    numErrs = 0\n\n    DoAdd TextBox14, Total, count, numErrs\n    DoAdd TextBox18, Total, count, numErrs\n    DoAdd TextBox23, Total, count, numErrs\n\n    If numErrs &gt; 0 Then\n        MsgBox numErrs &amp; \" non-numeric value(s) cleared\", vbExclamation, _\n                    \"Numbers only please!\"\n    End If\n\n    'EDIT:\n    If count &gt; 0 Then\n        TextBox27.Value = Total / count\n    Else\n        TextBox27.Value = Null\n    End If\n\nEnd Sub\n\nSub DoAdd(tb As Object, ByRef tot As Double, numVals As Long, ByRef numErrs As Long)\n    Dim v\n    v = tb.Value\n    If Len(v) &gt; 0 Then\n        If Not IsNumeric(v) Then\n            tb.Value = Null\n            numErrs = numErrs + 1\n        Else\n            tot = tot + CDbl(v)\n            numVals = numVals + 1\n        End If\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 185, "user_id": 3794203, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/cba2a1760eb1c8f18f60de42d7070f21?s=128&d=identicon&r=PG&f=1", "display_name": "user3794203", "link": "https://stackoverflow.com/users/3794203/user3794203"}, "is_accepted": false, "score": 0, "last_activity_date": 1450386187, "creation_date": 1450386187, "answer_id": 34344189, "question_id": 34321583, "link": "https://stackoverflow.com/questions/34321583/userform-internal-counter-for-calculations/34344189#34344189", "title": "UserForm internal counter for calculations", "body": "<p>Thank you so much to everyone for your help. I ended up using the suggestions from @ScottCraner and ended up with this working code:</p>\n\n<pre><code>Private Sub GPASum()\nDim Total As Double\nDim count As Double\nTotal = 0\ncount = 0\n\nIf Len(TextBox14.Value) &gt; 0 Then\nIf IsNumeric(TextBox14.Value) = False Then\nMsgBox \"Error, only numbers allowed\"\nTextBox14.Value = 0\nElse: Total = Total + CDbl(TextBox14.Value): count = count + 1\nEnd If\nElse:\nEnd If\n\nIf Len(TextBox18.Value) &gt; 0 Then\nIf IsNumeric(TextBox18.Value) = False Then\nMsgBox \"Error, only numbers allowed\"\nTextBox18.Value = 0\nExit Sub\nElse: Total = Total + CDbl(TextBox18.Value): count = count + 1\nEnd If\nElse:\nEnd If\n\nIf Len(TextBox23.Value) &gt; 0 Then\nIf IsNumeric(TextBox23.Value) = False Then\nMsgBox \"Error, only numbers allowed\"\nTextBox23.Value = 0\nExit Sub\nElse: Total = Total + CDbl(TextBox23.Value): count = count + 1\nEnd If\nElse:\nEnd If\n\nTextBox27.Value = Total / count\nEnd Sub\n\nPrivate Sub TextBox14_Change()\nGPASum\nEnd Sub\n\nPrivate Sub TextBox18_Change()\nGPASum\nEnd Sub\n\nPrivate Sub TextBox23_Change()\nGPASum\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 185, "user_id": 3794203, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/cba2a1760eb1c8f18f60de42d7070f21?s=128&d=identicon&r=PG&f=1", "display_name": "user3794203", "link": "https://stackoverflow.com/users/3794203/user3794203"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 187, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1450386187, "creation_date": 1450297957, "last_edit_date": 1450303092, "question_id": 34321583, "link": "https://stackoverflow.com/questions/34321583/userform-internal-counter-for-calculations", "title": "UserForm internal counter for calculations", "body": "<p>I am currently trying to create a mechanism of checking a userform textbox value (if it is empty, ignore; if it is text, msgbox error; if it is a number then proceed) in order to calculate GPAs from three different textbox values.  There are three different boxes for someone to enter values for up to three different schools, however it's possible that maybe only one will be entered or maybe just two or maybe three.  I thought that the following would work, but it keeps triggering an error when I enter any values saying:  </p>\n\n<blockquote>\n  <p>\"Runtime error '6': Overflow\".  </p>\n</blockquote>\n\n<p>Does anyone have any idea how this might be workable?</p>\n\n<pre><code>Private Sub TextBox14_Change()\n   GPASum\nEnd Sub\n\nPrivate Sub TextBox18_Change()\n   GPASum\nEnd Sub\n\nPrivate Sub TextBox23_Change()\n   GPASum\nEnd Sub\n\nPrivate Sub GPASum()\n\n   Dim Total As Double\n   Dim Count As Double\n   Total = 0\n   Count = 0\n\n   If Len(TextBox14.Value) &gt; 0 Then\n      If IsNumeric(TextBox14.Value) = False Then\n         MsgBox \"Error, only numbers allowed\"\n         TextBox14.Value = Null\n      Else: Total = Total + CDbl(TextBox14.Value): Count = Count + 1\n      End If\n   End If\n\n   If Len(TextBox18.Value) &gt; 0 Then\n      If IsNumeric(TextBox18.Value) = False Then\n         MsgBox \"Error, only numbers allowed\"\n         TextBox18.Value = Null\n      Else: Total = Total + CDbl(TextBox18.Value): Count = Count + 1\n      End If \n   End If\n\n   If Len(TextBox23.Value) &gt; 0 Then\n      If IsNumeric(TextBox23.Value) = False Then\n         MsgBox \"Error, only numbers allowed\"\n         TextBox23.Value = Null\n      Else: Total = Total + CDbl(TextBox23.Value): Count = Count + 1\n      End If\n   End If\n\n   TextBox27.Value = Total / Count\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1450299691, "post_id": 34321437, "comment_id": 56385790, "body": "Provide an example piece of data where it returns an unexpected result. Follow the code through that example, line by line, using f8 in the code module. At what point does the code do something you don&#39;t expect? What do you expect there, and what is the result?"}, {"owner": {"reputation": 45, "user_id": 5390827, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/cd06aed30460ab05a0c3962f276f15f3?s=128&d=identicon&r=PG", "display_name": "Martin", "link": "https://stackoverflow.com/users/5390827/martin"}, "edited": false, "score": 0, "creation_date": 1450301788, "post_id": 34321437, "comment_id": 56386847, "body": "Hi, thanks for the response. The macro works just fine, the problem is the result in the formula. This is the formula =IF(&quot;2015-11-09&quot;&gt;=&quot;8/9/2013&quot;,&quot;review&quot;,&quot;disabled&quot;), and this is what it returns. 2015-11-09 | 2013-08-09 | disabled. Is there any way to change the date format in all cells to reflect the same format? I belive that&#39;s whats wrong with the formula."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 1, "creation_date": 1450302375, "post_id": 34321437, "comment_id": 56387144, "body": "While those strings might look like dates to <i>you</i>, Excel treats them as the strings they are, so returns the False clause.  Modify the formula to convert the strings to actual dates.  (FYI, <i>edit</i> your post to include that vital piece of info.)"}, {"owner": {"reputation": 45, "user_id": 5390827, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/cd06aed30460ab05a0c3962f276f15f3?s=128&d=identicon&r=PG", "display_name": "Martin", "link": "https://stackoverflow.com/users/5390827/martin"}, "edited": false, "score": 0, "creation_date": 1450302866, "post_id": 34321437, "comment_id": 56387405, "body": "Would you tell me how to update the formula to convert those strings? I don&#39;t understand much about VBA. Thank you! :)"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1450304429, "post_id": 34321437, "comment_id": 56388173, "body": "You are making them strings with the Chr(34). try using the address instead of the value. <code>&quot;=IF(&quot; &amp;Cells(intCounter, rFind2.Column).Address(0,0) &amp; &quot;&gt;=&quot; &amp; Cells(intCounter, rFind1.Column).address(0,0) &amp; &quot; ,...</code>"}, {"owner": {"reputation": 45, "user_id": 5390827, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/cd06aed30460ab05a0c3962f276f15f3?s=128&d=identicon&r=PG", "display_name": "Martin", "link": "https://stackoverflow.com/users/5390827/martin"}, "edited": false, "score": 0, "creation_date": 1450304771, "post_id": 34321437, "comment_id": 56388359, "body": "But the address might change from one report to another, If I put an specific address for the value and it changes it&#39;s possition the formula will fail. Am I right?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1450304973, "post_id": 34321437, "comment_id": 56388460, "body": "Yes, then if your desire is to hard code values then <code>&quot;=IF(&quot; &amp;Cells(intCounter, rFind2.Column).value2 &amp; &quot;&gt;=&quot; &amp; Cells(intCounter, rFind1.Column).value2 &amp; &quot; ,...</code>  this will put the underlying value of the date.  The problem is that it is a number not a date and those who click on the formula will see a number like <code>42123</code> and not <code>29&#47;4&#47;2015</code>"}, {"owner": {"reputation": 45, "user_id": 5390827, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/cd06aed30460ab05a0c3962f276f15f3?s=128&d=identicon&r=PG", "display_name": "Martin", "link": "https://stackoverflow.com/users/5390827/martin"}, "edited": false, "score": 0, "creation_date": 1450305385, "post_id": 34321437, "comment_id": 56388657, "body": "I get Run-.Time error &#39;1004&#39;: Application-defined or object-defined error when I run this part of the code. I pasted like this ActiveSheet.Cells(intCounter, x + 1).Formula = &quot;=IF(&quot; &amp; Cells(intCounter, rFind2.Column).Value2 &amp; &quot;&gt;=&quot; &amp; Cells(intCounter, rFind1.Column).Value2 &amp; &quot;,&quot;&quot;review&quot;&quot;,&quot;&quot;old&quot;&quot;)&quot;"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1450305601, "post_id": 34321437, "comment_id": 56388766, "body": "Then one or both of the dates is a text string and not a true date(a formatted number)."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1450305677, "post_id": 34321437, "comment_id": 56388804, "body": "Try putting the same formula with cell references not values in manually and see what happens."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 5390827, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/cd06aed30460ab05a0c3962f276f15f3?s=128&d=identicon&r=PG", "display_name": "Martin", "link": "https://stackoverflow.com/users/5390827/martin"}, "edited": false, "score": 0, "creation_date": 1450306293, "post_id": 34323611, "comment_id": 56389086, "body": "Thank you all for all the answers and help with this!! :D"}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "reply_to_user": {"reputation": 45, "user_id": 5390827, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/cd06aed30460ab05a0c3962f276f15f3?s=128&d=identicon&r=PG", "display_name": "Martin", "link": "https://stackoverflow.com/users/5390827/martin"}, "edited": false, "score": 0, "creation_date": 1450306565, "post_id": 34323611, "comment_id": 56389215, "body": "Happy to help, make sure you tick the answer as correct if you believe it is so others may benefit from the answer in future :)."}, {"owner": {"reputation": 45, "user_id": 5390827, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/cd06aed30460ab05a0c3962f276f15f3?s=128&d=identicon&r=PG", "display_name": "Martin", "link": "https://stackoverflow.com/users/5390827/martin"}, "edited": false, "score": 0, "creation_date": 1450306616, "post_id": 34323611, "comment_id": 56389239, "body": "Sorry I have a problem with the line ActiveSheet.Cells(intcounter, x + 1).Formula = &quot;=IF(TEXT(&quot;&quot;&quot; &amp; Cells(intcounter, rFind.Column) &amp; &quot;&quot;&quot;,&quot;&quot;DD/MM/YYYY&quot;&quot;)&gt;=TEXT(&quot;&quot;&quot; &amp; Cells(intcounter, rFind1.Column) &amp; &quot;&quot;&quot;,&quot;&quot;DD/MM/YYYY&quot;&quot;),&quot;&quot;review&quot;&quot;,&quot;&quot;disabled&quot;&quot;)&quot;. It works with dates in the format DD/MM/YYYY, but I&#39;m working with dates in formats like MM-DD-YYYY and DD/MM/YYYY, that&#39;s why I need to set all the dates in the same format to make the formula work."}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "reply_to_user": {"reputation": 45, "user_id": 5390827, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/cd06aed30460ab05a0c3962f276f15f3?s=128&d=identicon&r=PG", "display_name": "Martin", "link": "https://stackoverflow.com/users/5390827/martin"}, "edited": false, "score": 0, "creation_date": 1450306789, "post_id": 34323611, "comment_id": 56389308, "body": "Where are you geographically?"}, {"owner": {"reputation": 45, "user_id": 5390827, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/cd06aed30460ab05a0c3962f276f15f3?s=128&d=identicon&r=PG", "display_name": "Martin", "link": "https://stackoverflow.com/users/5390827/martin"}, "edited": false, "score": 0, "creation_date": 1450306858, "post_id": 34323611, "comment_id": 56389339, "body": "This is an example of the results. the values are these: 2015-11-09 &gt;= 2015-09-27, it should return Review and is returning Disable."}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "reply_to_user": {"reputation": 45, "user_id": 5390827, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/cd06aed30460ab05a0c3962f276f15f3?s=128&d=identicon&r=PG", "display_name": "Martin", "link": "https://stackoverflow.com/users/5390827/martin"}, "edited": false, "score": 0, "creation_date": 1450306910, "post_id": 34323611, "comment_id": 56389367, "body": "Change &gt; to &lt; I think I had them back to front to you in my testing"}, {"owner": {"reputation": 45, "user_id": 5390827, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/cd06aed30460ab05a0c3962f276f15f3?s=128&d=identicon&r=PG", "display_name": "Martin", "link": "https://stackoverflow.com/users/5390827/martin"}, "edited": false, "score": 0, "creation_date": 1450306911, "post_id": 34323611, "comment_id": 56389370, "body": "I&#39;m in Argentina. But the reports come from  US, and the values on each cell have all different formats too. In case of dates for example."}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "reply_to_user": {"reputation": 45, "user_id": 5390827, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/cd06aed30460ab05a0c3962f276f15f3?s=128&d=identicon&r=PG", "display_name": "Martin", "link": "https://stackoverflow.com/users/5390827/martin"}, "edited": false, "score": 0, "creation_date": 1450306947, "post_id": 34323611, "comment_id": 56389387, "body": "For US, you may need to change the text hint from &quot;DD/MM/YYYY&quot; to &quot;MM/DD/YYYY&quot;"}, {"owner": {"reputation": 45, "user_id": 5390827, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/cd06aed30460ab05a0c3962f276f15f3?s=128&d=identicon&r=PG", "display_name": "Martin", "link": "https://stackoverflow.com/users/5390827/martin"}, "edited": false, "score": 0, "creation_date": 1450306973, "post_id": 34323611, "comment_id": 56389393, "body": "I was using the first line you gave me. I didn&#39;t use the test."}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "reply_to_user": {"reputation": 45, "user_id": 5390827, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/cd06aed30460ab05a0c3962f276f15f3?s=128&d=identicon&r=PG", "display_name": "Martin", "link": "https://stackoverflow.com/users/5390827/martin"}, "edited": false, "score": 0, "creation_date": 1450307008, "post_id": 34323611, "comment_id": 56389406, "body": "Which includes this twice: &quot;&quot;DD/MM/YYYY&quot;&quot;"}, {"owner": {"reputation": 45, "user_id": 5390827, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/cd06aed30460ab05a0c3962f276f15f3?s=128&d=identicon&r=PG", "display_name": "Martin", "link": "https://stackoverflow.com/users/5390827/martin"}, "edited": false, "score": 0, "creation_date": 1450307122, "post_id": 34323611, "comment_id": 56389448, "body": "Thanks once again and sorry for bothering you!"}, {"owner": {"reputation": 45, "user_id": 5390827, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/cd06aed30460ab05a0c3962f276f15f3?s=128&d=identicon&r=PG", "display_name": "Martin", "link": "https://stackoverflow.com/users/5390827/martin"}, "edited": false, "score": 0, "creation_date": 1450717443, "post_id": 34323611, "comment_id": 56542953, "body": "Sorry to  bother I have only one error in the formula. it should be Account Last Updated &gt;= Termination Date TRUE Review, FALSE Disabled.. and the dates are Account Last updated 2015-10-30 and Termination Date 2014-12-12 and I got Disabled. The rest of the formulas in the sheet bring the right result. Any Ideas? Can I change the TEXT variable by INTEGER?"}], "tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": true, "score": 1, "last_activity_date": 1450306034, "creation_date": 1450306034, "answer_id": 34323611, "question_id": 34321437, "link": "https://stackoverflow.com/questions/34321437/wrong-value-returned-from-formula/34323611#34323611", "title": "Wrong value returned from Formula", "body": "<p>I am unsure why you have mixed \"\" and CHR(34), I personally always prefer the \"\" and \"\"\" but its your call, you need to insert the TEXT formula to hint what the data you are comparing is otherwise it just assumes it's a text string comparison, it doesn't see it as a date.</p>\n\n<p>Try this:</p>\n\n<pre><code>\"=IF(TEXT(\"\"\" &amp; Cells(intcounter, rFind.column) &amp; \"\"\",\"\"DD/MM/YYYY\"\")&gt;=TEXT(\"\"\" &amp; Cells(intcounter, rFind1.column) &amp; \"\"\",\"\"DD/MM/YYYY\"\"),\"\"review\"\",\"\"disabled\"\")\"\n</code></pre>\n\n<p>It worked in my testing</p>\n\n<pre><code>Sub DateStringCompare()\nDim rFind As Range, rFind1 As Range, intcounter As Long\nintcounter = 1\nSet rFind = Range(\"B2\")\nSet rFind1 = Range(\"C2\")\nRange(\"B1\").Formula = \"15/10/2015\" 'You may need to change this depending on your \nRange(\"C1\").Formula = \"15/11/2015\" 'You may need to change this depending on your \nRange(\"D1\").Formula = \"=IF(TEXT(\"\"\" &amp; Cells(intcounter, rFind.column) &amp; \"\"\",\"\"DD/MM/YYYY\"\")&gt;=TEXT(\"\"\" &amp; Cells(intcounter, rFind1.column) &amp; \"\"\",\"\"DD/MM/YYYY\"\"),\"\"review\"\",\"\"disabled\"\")\"\nRange(\"D2\").Formula = \"=IF(TEXT(\"\"\" &amp; Cells(intcounter, rFind.column) &amp; \"\"\",\"\"DD/MM/YYYY\"\")&lt;=TEXT(\"\"\" &amp; Cells(intcounter, rFind1.column) &amp; \"\"\",\"\"DD/MM/YYYY\"\"),\"\"review\"\",\"\"disabled\"\")\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 5390827, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/cd06aed30460ab05a0c3962f276f15f3?s=128&d=identicon&r=PG", "display_name": "Martin", "link": "https://stackoverflow.com/users/5390827/martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 34323611, "answer_count": 1, "score": -1, "last_activity_date": 1450306034, "creation_date": 1450297560, "last_edit_date": 1450297933, "question_id": 34321437, "link": "https://stackoverflow.com/questions/34321437/wrong-value-returned-from-formula", "title": "Wrong value returned from Formula", "body": "<p>Hi I'm working on a macro that creates two columns and fills them with a formula IF in each row.</p>\n\n<p>The values to compare in the formula are returned in the macro from other columns with the variables Rfind, Rfind1, Rfind2. Those cells contain Dates. and must return \"review\" or \"disabled\". The thing is, the formula returns the wrong value. For example if the first cell contains 01/10/2015 and the other one 09/08/2013 it stills return Disabled. when it should be Review.</p>\n\n<p>Any Ideas?</p>\n\n<p>This is the whole macro.</p>\n\n<pre><code>Sub test()\n\n\nDim LastRow As Long\nLastRow = Cells.Find(What:=\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n\nDim rFind As Range\nWith Range(\"A:DB\")\n        Set rFind = .Find(What:=\"Account Last Updated\", LookAt:=xlWhole, MatchCase:=False, SearchFormat:=False)\n        If Not rFind Is Nothing Then\nEnd If\nEnd With\n\n Dim rFind1 As Range\n\n    With Range(\"A:DB\")\n        Set rFind1 = .Find(What:=\"Termination Date\", LookAt:=xlWhole, MatchCase:=False, SearchFormat:=False)\n        If Not rFind1 Is Nothing Then\n\n        End If\n    End With\n\n    Dim rFind2 As Range\n\n    With Range(\"A:DB\")\n        Set rFind2 = .Find(What:=\"Last Password set date\", LookAt:=xlWhole, MatchCase:=False, SearchFormat:=False)\n        If Not rFind2 Is Nothing Then\n        End If\n    End With\n\n\nx = ActiveSheet.UsedRange.Columns.Count\nActiveSheet.Cells(1, x + 1) = \"Account last updated after termination\"\nintCounter = 2\nWhile (intCounter &lt; LastRow)\n    ActiveSheet.Cells(intCounter, x + 1).Formula = \"=IF(\" &amp; Chr(34) &amp; Cells(intCounter, rFind2.Column) &amp; Chr(34) &amp; \"&gt;=\" &amp; Chr(34) &amp; Cells(intCounter, rFind1.Column) &amp; Chr(34) &amp; \",\"\"review\"\",\"\"old\"\")\"\n    intCounter = intCounter + 1\nWend\n\nDim x As Integer\nx = ActiveSheet.UsedRange.Columns.Count\nActiveSheet.Cells(1, x + 1) = \"Password After Termination\"\nintCounter = 2\nWhile (intCounter &lt; LastRow)\n    ActiveSheet.Cells(intCounter, x + 1).Formula = \"=IF(\" &amp; Chr(34) &amp; Cells(intCounter, rFind.Column) &amp; Chr(34) &amp; \"&gt;=\" &amp; Chr(34) &amp; Cells(intCounter, rFind1.Column) &amp; Chr(34) &amp; \",\"\"review\"\",\"\"disabled\"\")\"\n    intCounter = intCounter + 1\nWend\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "range"], "comments": [{"owner": {"reputation": 432, "user_id": 4976543, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iKE0A.jpg?s=128&g=1", "display_name": "Branden Keck", "link": "https://stackoverflow.com/users/4976543/branden-keck"}, "edited": false, "score": 0, "creation_date": 1450297480, "post_id": 34321292, "comment_id": 56384456, "body": "What is your end intention?  To use the data elsewhere?  If so, I would suggest using arrays.  I haven&#39;t done much with Range objects, but based on the microsoft documentation, a range object only refers to an area in a document and doesn&#39;t actually store the data from that area separately (found here: <a href=\"https://msdn.microsoft.com/en-us/library/office/ff835176.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff835176.aspx</a>)"}, {"owner": {"reputation": 544, "user_id": 4868761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b86485dea136b4aa5498ff3d8f2a413?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4868761/kyle"}, "edited": false, "score": 2, "creation_date": 1450297818, "post_id": 34321292, "comment_id": 56384648, "body": "If you need to keep track of something you shouldn&#39;t use <code>selection</code>. Use another <code>range</code> object."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1450298017, "post_id": 34321292, "comment_id": 56384784, "body": "There is something strange or missing in your post. It should not at all change the selection, unless the current selection is part of the affected range itself."}, {"owner": {"reputation": 13, "user_id": 5688206, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EP_EfH8PYx4/AAAAAAAAAAI/AAAAAAAAABE/mTsuEn0JX9U/photo.jpg?sz=128", "display_name": "Carlos Rabelo", "link": "https://stackoverflow.com/users/5688206/carlos-rabelo"}, "reply_to_user": {"reputation": 432, "user_id": 4976543, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iKE0A.jpg?s=128&g=1", "display_name": "Branden Keck", "link": "https://stackoverflow.com/users/4976543/branden-keck"}, "edited": false, "score": 0, "creation_date": 1450299627, "post_id": 34321292, "comment_id": 56385755, "body": "@BrandenKeck, my intention is to use the data on a loop but I need only unique values. Thanks."}, {"owner": {"reputation": 544, "user_id": 4868761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b86485dea136b4aa5498ff3d8f2a413?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4868761/kyle"}, "reply_to_user": {"reputation": 432, "user_id": 4976543, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iKE0A.jpg?s=128&g=1", "display_name": "Branden Keck", "link": "https://stackoverflow.com/users/4976543/branden-keck"}, "edited": false, "score": 1, "creation_date": 1450300548, "post_id": 34321292, "comment_id": 56386214, "body": "@CarlosRabelo What do you mean by &quot;I need only the range object to be changed&quot;? As @BrandenKeck pointed out, a <code>range</code> object is basically just a reference to a range on your worksheet. You cannot perform an action on the data of your range object without affecting the data on your worksheet."}, {"owner": {"reputation": 13, "user_id": 5688206, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EP_EfH8PYx4/AAAAAAAAAAI/AAAAAAAAABE/mTsuEn0JX9U/photo.jpg?sz=128", "display_name": "Carlos Rabelo", "link": "https://stackoverflow.com/users/5688206/carlos-rabelo"}, "reply_to_user": {"reputation": 544, "user_id": 4868761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b86485dea136b4aa5498ff3d8f2a413?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4868761/kyle"}, "edited": false, "score": 0, "creation_date": 1450314399, "post_id": 34321292, "comment_id": 56391712, "body": "@Kyle Now I see that working with Ranges is trickier than I thought. I&#39;ll review my code. Thank you for the advices."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5688206, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EP_EfH8PYx4/AAAAAAAAAAI/AAAAAAAAABE/mTsuEn0JX9U/photo.jpg?sz=128", "display_name": "Carlos Rabelo", "link": "https://stackoverflow.com/users/5688206/carlos-rabelo"}, "edited": false, "score": 0, "creation_date": 1450314620, "post_id": 34324571, "comment_id": 56391775, "body": "I&#39;m not very familiar to Collections so I haven&#39;t had this idea... I&#39;ll try this approach. Thank you so much."}, {"owner": {"reputation": 13, "user_id": 5688206, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EP_EfH8PYx4/AAAAAAAAAAI/AAAAAAAAABE/mTsuEn0JX9U/photo.jpg?sz=128", "display_name": "Carlos Rabelo", "link": "https://stackoverflow.com/users/5688206/carlos-rabelo"}, "edited": false, "score": 0, "creation_date": 1450374641, "post_id": 34324571, "comment_id": 56423615, "body": "your solution is just perfect. I managed to do the job using Collections. Many thanks to you and all who helped me."}], "tags": [], "owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "is_accepted": true, "score": 1, "last_activity_date": 1450311406, "creation_date": 1450311406, "answer_id": 34324571, "question_id": 34321292, "link": "https://stackoverflow.com/questions/34321292/removeduplicates-method-changes-selection-not-only-range-object/34324571#34324571", "title": "&#39;RemoveDuplicates&#39; method changes selection, not only Range object", "body": "<p>I agree with all the comments to your question. The <code>Range</code> object isn't really suitable for your task. It's quite easy to think that some of the Excel functions can simply be reproduced in a macro, but in VBA there are usually better ways of doing it ... and avoiding <code>Activate</code>/<code>Select</code> is the first step in recognising VBA's versatility.</p>\n\n<p>If you simply need to loop through a list of unique values and process them in some way, then a <code>Collection</code> object would be ideal for you because each key must be unique, and working away from the <code>Worksheet</code> will be vastly quicker for you.</p>\n\n<p>Here's some code which shows how simple it is to take the values from the <code>Range</code> object and to create a unique list from them.</p>\n\n<pre><code>Dim uniques As Collection\nDim r As Long\nDim v As Variant\n\n'Read the values\nWith ThisWorkbook.Worksheets(\"Sheet1\") 'adjust to your sheet name\n    v = .Range(.Cells(2, 1), .Cells(65000, 1)).Value2\nEnd With\n\n'Populate the unique collection\nSet uniques = New Collection\nOn Error Resume Next\nFor r = 1 To UBound(v, 1)\n    uniques.Add v(r, 1), CStr(v(r, 1))\nNext\nOn Error GoTo 0\n\n'Loop through your values\nFor Each v In uniques\n    'do something with your values\n    Debug.Print v\nNext\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5688206, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-EP_EfH8PYx4/AAAAAAAAAAI/AAAAAAAAABE/mTsuEn0JX9U/photo.jpg?sz=128", "display_name": "Carlos Rabelo", "link": "https://stackoverflow.com/users/5688206/carlos-rabelo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 1, "accepted_answer_id": 34324571, "answer_count": 1, "score": 1, "last_activity_date": 1450311406, "creation_date": 1450297074, "last_edit_date": 1450299218, "question_id": 34321292, "link": "https://stackoverflow.com/questions/34321292/removeduplicates-method-changes-selection-not-only-range-object", "title": "&#39;RemoveDuplicates&#39; method changes selection, not only Range object", "body": "<p>I have a Range object which contains data from a unique column of a selection. I want to use the <code>RemoveDuplicates</code> method on this range object in order to get only unique values. My problem is: the selection on the worksheet is also being changed by the <code>RemoveDuplicates</code> method. I need only the range object to be changed. Here's my code:</p>\n\n<pre><code>Dim rngTst As Excel.Range\nSet rngTst = Range(Cells(2, 1), Cells(65000, 1))\nWith rngTst\n    .RemoveDuplicates 1, xlYes  'remove duplicated values\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1450295157, "post_id": 34320755, "comment_id": 56383242, "body": "<code>instead of going row+1.</code> so you know what you need to do XD Edit: oh, <code>rw</code> is already <code>+1</code> hmmm"}, {"owner": {"reputation": 441, "user_id": 5399207, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ec68ecdefa2edf36d518e679b1f2a95d?s=128&d=identicon&r=PG&f=1", "display_name": "Daruki", "link": "https://stackoverflow.com/users/5399207/daruki"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1450295266, "post_id": 34320755, "comment_id": 56383302, "body": "i dunno where to put it :("}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1450295570, "post_id": 34320755, "comment_id": 56383461, "body": "Don&#39;t think it makes a difference as it resolves the string first but <code>If ws.Name Like &quot;*&quot; &amp; &quot;danger&quot; &amp; &quot;*&quot; Then</code> can just be <code>If ws.Name Like &quot;*danger*&quot; Then</code>."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1450295683, "post_id": 34320755, "comment_id": 56383512, "body": "@nbayly - wrong thread :P"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 4, "creation_date": 1450296054, "post_id": 34320755, "comment_id": 56383718, "body": "in the data that is being copied, is there data in column A?"}, {"owner": {"reputation": 441, "user_id": 5399207, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ec68ecdefa2edf36d518e679b1f2a95d?s=128&d=identicon&r=PG&f=1", "display_name": "Daruki", "link": "https://stackoverflow.com/users/5399207/daruki"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1450296253, "post_id": 34320755, "comment_id": 56383814, "body": "@ScottCraner, i&#39;m a fool................ that fixed it. thanks so much!"}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 1, "creation_date": 1450296307, "post_id": 34320755, "comment_id": 56383842, "body": "why don&#39;t you just try with <code>rw = rw +1</code> ?"}, {"owner": {"reputation": 441, "user_id": 5399207, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ec68ecdefa2edf36d518e679b1f2a95d?s=128&d=identicon&r=PG&f=1", "display_name": "Daruki", "link": "https://stackoverflow.com/users/5399207/daruki"}, "edited": false, "score": 0, "creation_date": 1450296430, "post_id": 34320755, "comment_id": 56383910, "body": "i&#39;m a novice at VBA, thanks for the tip!!"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1450296559, "post_id": 34320755, "comment_id": 56383978, "body": "Do not fret much, I did roughly the same thing just a few weeks ago.  It helps to go line by line and speak out loud in detail what each line does as if to someone that does not know programming."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1450300163, "post_id": 34320755, "comment_id": 56386046, "body": "@ScottCraner, we should all have <a href=\"https://en.wikipedia.org/wiki/Rubber_duck_debugging\" rel=\"nofollow noreferrer\">rubber duckys</a>."}], "answers": [{"tags": [], "owner": {"reputation": 549, "user_id": 5648688, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-SK9l0SoA00I/AAAAAAAAAAI/AAAAAAAAABs/nlLIlC66ANk/photo.jpg?sz=128", "display_name": "Shubham", "link": "https://stackoverflow.com/users/5648688/shubham"}, "is_accepted": false, "score": 0, "last_activity_date": 1463672045, "last_edit_date": 1463672045, "creation_date": 1463670529, "answer_id": 37327304, "question_id": 34320755, "link": "https://stackoverflow.com/questions/34320755/copy-rows-from-multiple-sheets-into-one-sheet/37327304#37327304", "title": "Copy rows from multiple sheets into one sheet", "body": "<p>Try this to copy rows from one worksheet to another worksheet(with each row on different row):</p>\n\n<pre><code>Dim i, lastRow as Integer\n\nDim wso, ws, copyFrom as Worksheet\n\nSet wso = Sheets(\"Master\")\n\nFor Each ws In ActiveWorkbook.Worksheets\n\nIf ws.Name Like \"*\" &amp; \"danger\" &amp; \"*\" Then\n\n    copyFrom =  ws.Select\n\nEnd if\n\n\nlastRow = Sheets(copyFrom).Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nFor i=1 to lastRow\n\nIf &lt;--your criteria--&gt; then\n\n    ThisWorkbook.Sheets(copyFrom).Rows(i).EntireRow.Copy Destination:=ThisWorkbook.Sheets(wso).Rows(i)\n\nEnd if\n\nNext i\nNext ws\n</code></pre>\n"}], "owner": {"reputation": 441, "user_id": 5399207, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ec68ecdefa2edf36d518e679b1f2a95d?s=128&d=identicon&r=PG&f=1", "display_name": "Daruki", "link": "https://stackoverflow.com/users/5399207/daruki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1455, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1463672045, "creation_date": 1450295096, "last_edit_date": 1450295513, "question_id": 34320755, "link": "https://stackoverflow.com/questions/34320755/copy-rows-from-multiple-sheets-into-one-sheet", "title": "Copy rows from multiple sheets into one sheet", "body": "<pre><code>Public Sub SubName()\nDim ws As Worksheet\nDim iCounter As Long\nDim wso As Worksheet\nDim rw As Long\nDim lastrow As Long\n\nSet wso = Sheets(\"Master\")\n\nFor Each ws In ActiveWorkbook.Worksheets\n    If ws.Name Like \"*\" &amp; \"danger\" &amp; \"*\" Then\n    ws.Select\n    lastrow = ws.Cells(Rows.Count, 4).End(xlUp).Row\n            For iCounter = 2 To lastrow\n                If ws.Cells(iCounter, 8) &lt; 0.15 And ws.Cells(iCounter, 8) &gt; -0.1 Then\n\n                    ws.Cells(iCounter, 8).EntireRow.Copy\n\n                    rw = wso.Cells(wso.Rows.Count, \"A\").End(xlUp).Row + 1\n                    wso.Cells(rw, 1).PasteSpecial Paste:=xlPasteAll\n\n                End If\n            Next iCounter\n\n    End If\nNext ws\nEnd Sub\n</code></pre>\n\n<p>This is what the code does:</p>\n\n<ol>\n<li>Look through all sheets, find sheets with text \"danger\"</li>\n<li>With sheets named \"danger*\", go through column H and copy the entire row if criteria is met</li>\n<li>Paste the entire row onto master sheet</li>\n</ol>\n\n<p>I believe the code is working fine up to the point where I need it to paste onto the master sheet. The problem i'm getting is that it simply pastes over the same row on the master sheet, instead of going row+1. </p>\n\n<p>The end result is there's only one row showing on the master sheet and it's the last row in the iteration that's to be pasted.</p>\n\n<p>Any help is appreciated!</p>\n\n<p><a href=\"https://i.stack.imgur.com/ds05x.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ds05x.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel", "loops"], "answers": [{"tags": [], "owner": {"reputation": 641, "user_id": 3931725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/612340301/picture?type=large", "display_name": "Johnson Jason", "link": "https://stackoverflow.com/users/3931725/johnson-jason"}, "is_accepted": false, "score": 0, "last_activity_date": 1450297327, "creation_date": 1450297327, "answer_id": 34321366, "question_id": 34320581, "link": "https://stackoverflow.com/questions/34320581/loop-copy-paste-randomly-leaving-out-data/34321366#34321366", "title": "loop copy paste randomly leaving out data", "body": "<p>Are your variables strings or integers?\nIf any of them are strings you can try making sure it's not an issue with capitalization on your string matches. </p>\n\n<pre><code> ucase(Sheets(\"Revised Budget\").Cells(rnum, 3).Value) = ucase(YrVal)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 367, "user_id": 5490120, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/164b3308717c8f1b3072d45f100c5910?s=128&d=identicon&r=PG&f=1", "display_name": "phroureo", "link": "https://stackoverflow.com/users/5490120/phroureo"}, "is_accepted": false, "score": 0, "last_activity_date": 1450298297, "creation_date": 1450298297, "answer_id": 34321684, "question_id": 34320581, "link": "https://stackoverflow.com/questions/34320581/loop-copy-paste-randomly-leaving-out-data/34321684#34321684", "title": "loop copy paste randomly leaving out data", "body": "<p>Consider updating all of your <code>.value</code> to <code>.value2</code>. I was running into a (potentially) similar issue, and that fixed it for me. </p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5688165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7a0f30e544fe1a5d2bccf9a5d7ccd4b?s=128&d=identicon&r=PG&f=1", "display_name": "jgritke", "link": "https://stackoverflow.com/users/5688165/jgritke"}, "is_accepted": false, "score": 0, "last_activity_date": 1450386441, "creation_date": 1450386441, "answer_id": 34344251, "question_id": 34320581, "link": "https://stackoverflow.com/questions/34320581/loop-copy-paste-randomly-leaving-out-data/34344251#34344251", "title": "loop copy paste randomly leaving out data", "body": "<p>I think I may have figured it out through some more research.  The page in which the macro was running through had data that was filtered.  I put in a code that would ShowAllData and I believe that should fix the issue.</p>\n"}], "owner": {"reputation": 1, "user_id": 5688165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7a0f30e544fe1a5d2bccf9a5d7ccd4b?s=128&d=identicon&r=PG&f=1", "display_name": "jgritke", "link": "https://stackoverflow.com/users/5688165/jgritke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1450386441, "creation_date": 1450294478, "last_edit_date": 1450294513, "question_id": 34320581, "link": "https://stackoverflow.com/questions/34320581/loop-copy-paste-randomly-leaving-out-data", "title": "loop copy paste randomly leaving out data", "body": "<p>has anyone had an issue in excel vba where a loop to copy and paste rows and check for certain criteria sometimes leaves out information and after i try to debug and run through it works fine</p>\n\n<p>I have a loop</p>\n\n<pre><code>For rnum = 3 To LastRow\n    'if all cells are equal to the Comboboxes then copy and paste the row\n    ThisWorkbook.Activate\n\n    If Sheets(\"Revised Budget\").Cells(rnum, 1).Value = BUval And _\n            Sheets(\"Revised Budget\").Cells(rnum, 2).Value = TeamLocVal And _\n            Sheets(\"Revised Budget\").Cells(rnum, 3).Value = YrVal And _\n            Sheets(\"Revised Budget\").Cells(rnum, 9).Value = InstVal Then\n\n        Sheets(\"Revised Budget\").Range(Cells(rnum, 1), Cells(rnum, 12)).Copy\n        NewWkbk.Sheets(\"Actual\").Activate\n\n        If NewWkbk.Sheets(\"Actual\").Range(\"A1\").Offset(1, 0).Value = \"\" Then\n            NewWkbk.Sheets(\"Actual\").Range(\"A1\").Offset(1, 0).PasteSpecial\n        Else\n            NewWkbk.Sheets(\"Actual\").Range(\"A1\").End(xlDown).Offset(1, 0).PasteSpecial\n        End If\n\n        Application.CutCopyMode = False\n\n    End If\n\nNext rnum\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1450294193, "post_id": 34320454, "comment_id": 56382714, "body": "Because one of your integer variable exceeds the max value it can hold. Look at the error when it happens and see what value is in the variable. Then figure out why and fix it."}, {"owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 0, "creation_date": 1450294461, "post_id": 34320454, "comment_id": 56382852, "body": "Integers are limited to <code>32767</code> in VBA, use <code>Long</code> instead."}], "answers": [{"tags": [], "owner": {"reputation": 3551, "user_id": 2276042, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/7p7MW.jpg?s=128&g=1", "display_name": "A.O.", "link": "https://stackoverflow.com/users/2276042/a-o"}, "is_accepted": true, "score": 1, "last_activity_date": 1450294261, "creation_date": 1450294261, "answer_id": 34320520, "question_id": 34320454, "link": "https://stackoverflow.com/questions/34320454/i-am-getting-error-6-overflow-why/34320520#34320520", "title": "I am getting error 6: overflow. Why?", "body": "<p>You are most likely getting that error for one (or combination) of three reasons:</p>\n\n<p><strong>1)</strong> Your <code>While</code> loop never escapes</p>\n\n<p><strong>2)</strong> <code>counter60M</code> is an extremely large number</p>\n\n<p><strong>3)</strong> <code>matchcounter</code> is an extremely large number</p>\n"}, {"tags": [], "owner": {"reputation": 641, "user_id": 3931725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/612340301/picture?type=large", "display_name": "Johnson Jason", "link": "https://stackoverflow.com/users/3931725/johnson-jason"}, "is_accepted": false, "score": 1, "last_activity_date": 1450296915, "creation_date": 1450296915, "answer_id": 34321254, "question_id": 34320454, "link": "https://stackoverflow.com/questions/34320454/i-am-getting-error-6-overflow-why/34321254#34321254", "title": "I am getting error 6: overflow. Why?", "body": "<p>Change </p>\n\n<pre><code>Dim j As Integer, matchcounter As Integer, k As Integer, runningtotal As Integer\n</code></pre>\n\n<p>To </p>\n\n<pre><code>Dim j As Long, matchcounter As Long, k As Long, runningtotal As Long\n</code></pre>\n\n<p>then you should be fine</p>\n"}], "owner": {"reputation": 53, "user_id": 5380661, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/17c36aa45a0a711bb16e2f63300382fe?s=128&d=identicon&r=PG&f=1", "display_name": "RG1of2", "link": "https://stackoverflow.com/users/5380661/rg1of2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 34320520, "answer_count": 2, "score": -1, "last_activity_date": 1450296915, "creation_date": 1450294033, "question_id": 34320454, "link": "https://stackoverflow.com/questions/34320454/i-am-getting-error-6-overflow-why", "title": "I am getting error 6: overflow. Why?", "body": "<p>This is a function that is in my program. In the while loop, i'm getting an overflow. Why? How do i fix this? </p>\n\n<pre><code>Sub durationhours(ByVal sheetname As String, ByVal counter60M As Integer)\n\nDim j As Integer, matchcounter As Integer, k As Integer, runningtotal As Integer\n\nj = 8: matchcounter = 0: runningtotal = 0\n\nFor counter = 7 To counter60M\n\n    While Worksheets(sheetname).Cells(counter, 2) = Worksheets(sheetname).Cells(j, 2)\n        j = j + 1\n        matchcounter = matchcounter + 1\n    Wend\n\n    If IsEmpty(Worksheets(sheetname).Cells(j, 2)) Then j = j + 3\n\n    For k = counter To (counter + matchcounter)\n        runningtotal = runningtotal + Worksheets(sheetname).Cells(counter, 10)\n        'here is where you do the calculations for the duration hours\n    Next k\n\n    Worksheets(sheetname).Cells(counter, 11) = runningtotal\n\n    counter = j: j = j + 1: matchcounter = 0: runningtotal = 0\n\n\nNext counter\n</code></pre>\n"}, {"tags": ["vba", "excel", "sorting"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1450294734, "post_id": 34320427, "comment_id": 56382992, "body": "The time strings you show <code>2PM</code>, <code>202PM</code> will not be interpreted as times by Excel, so they will be sorted as strings.  If you want information to be properly sorted, you must first make the data consistent."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1450294795, "post_id": 34320427, "comment_id": 56383028, "body": "Maybe your data is a mixture of date time serial numbers formatted as time and text that only <i>looks</i> like time"}, {"owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1450294803, "post_id": 34320427, "comment_id": 56383034, "body": "@RonRosenfeld I should have been more specific I was typing quick.  they&#39;re displayed initially in this format: 19:01:16 etc.  I will edit post."}, {"owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1450294903, "post_id": 34320427, "comment_id": 56383096, "body": "@chrisneilsen it appears to be time.  When the raw data is imported it is listed as 19:07:16 and then if I look at the formula bar it shows 7:01:16 PM"}], "answers": [{"comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 2, "creation_date": 1450295257, "post_id": 34320761, "comment_id": 56383295, "body": "Always be dynamic when defining areas in Excel - especially if you are already coding in VBA."}], "tags": [], "owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "is_accepted": false, "score": 0, "last_activity_date": 1450295112, "creation_date": 1450295112, "answer_id": 34320761, "question_id": 34320427, "link": "https://stackoverflow.com/questions/34320427/error-occurring-sorting-time-data/34320761#34320761", "title": "Error Occurring sorting Time data", "body": "<p>Issue was very stupid unfortunately.  The data had grown to a point outside my expected size and so the sort range was not capturing the last few rows unfortunately.   Apologies for a silly question.</p>\n\n<pre><code>'Formats Time data to avoid consolidated trade structures\nThisWorkbook.Sheets(\"Trade_Data_Insert\").Range(\"b3:b\" &amp; lastRow).Select\nActiveWorkbook.Worksheets(\"Trade_Data_Insert\").Sort.SortFields.Clear\nActiveWorkbook.Worksheets(\"Trade_Data_Insert\").Sort.SortFields.Add Key:=Range(\"B3\"), _\n    SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\nWith ActiveWorkbook.Worksheets(\"Trade_Data_Insert\").Sort\n    .SetRange Range(\"A3:Q5000\")\n    .Header = xlNo\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\nSelection.NumberFormat = \"[$-409]h:mm:ss AM/PM;@\"\n</code></pre>\n"}], "owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1450295112, "creation_date": 1450293946, "last_edit_date": 1450294864, "question_id": 34320427, "link": "https://stackoverflow.com/questions/34320427/error-occurring-sorting-time-data", "title": "Error Occurring sorting Time data", "body": "<p>This is a small piece of a data analysis program I developed to read many rows and decide upon structures.  One part of the macro relies on the time signatures of each row of data.  I wrote this code to sort the time so that it runs from earliest to latest since the default is latest to earliest (top to bottom).  It has been working fine until some data had time signatures mixed around a little bit (i.e. 19:01:16,19:00:00, 18:52:07.......18:48:05)  It sorted approximately 3 quarters of the data correctly and then it randomly restarts again (meaning the earliest data is towards the end ascending again.  Any ideas?  </p>\n\n<p>Here is the code:</p>\n\n<pre><code>'Formats Time data to avoid consolidated trade structures\nThisWorkbook.Sheets(\"Trade_Data_Insert\").Range(\"b3:b\" &amp; lastRow).Select\nActiveWorkbook.Worksheets(\"Trade_Data_Insert\").Sort.SortFields.Clear\nActiveWorkbook.Worksheets(\"Trade_Data_Insert\").Sort.SortFields.Add Key:=Range(\"B3\"), _\n    SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\nWith ActiveWorkbook.Worksheets(\"Trade_Data_Insert\").Sort\n    .SetRange Range(\"A3:Q278\")\n    .Header = xlNo\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\nSelection.NumberFormat = \"[$-409]h:mm:ss AM/PM;@\"\n</code></pre>\n"}, {"tags": ["vba", "excel", "ado", "dao"], "comments": [{"owner": {"reputation": 641, "user_id": 3931725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/612340301/picture?type=large", "display_name": "Johnson Jason", "link": "https://stackoverflow.com/users/3931725/johnson-jason"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1450295931, "post_id": 34320282, "comment_id": 56383653, "body": "@pnuts I don&#39;t have an expert insight as I don&#39;t fully understand the technology. I really don&#39;t know if there are any efficiency with one verses the other either theoretical or otherwise and wouldn&#39;t know how to measure it. Hoping to learn from someone who has torn this all apart already as opposed to building all the analysis and leanings from scratch. It would be a shame to spend several weeks learning ADO and developing a way to convert my code only to find I&#39;ve completely wasted my time."}, {"owner": {"reputation": 641, "user_id": 3931725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/612340301/picture?type=large", "display_name": "Johnson Jason", "link": "https://stackoverflow.com/users/3931725/johnson-jason"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1450296036, "post_id": 34320282, "comment_id": 56383705, "body": "I think it&#39;s a valid discussion that I&#39;ve not found online anywhere else. Humorous that some who have nothing to contribute to the discussion down vote simply because they have no answer."}, {"owner": {"reputation": 641, "user_id": 3931725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/612340301/picture?type=large", "display_name": "Johnson Jason", "link": "https://stackoverflow.com/users/3931725/johnson-jason"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1450297022, "post_id": 34320282, "comment_id": 56384213, "body": "This is a specific programming problem. Should I program my routine to pull data using ADO or VBA?  IF you don&#39;t know, hush,. What the hell?"}, {"owner": {"reputation": 641, "user_id": 3931725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/612340301/picture?type=large", "display_name": "Johnson Jason", "link": "https://stackoverflow.com/users/3931725/johnson-jason"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1450297523, "post_id": 34320282, "comment_id": 56384475, "body": "Nope, I want expert insight to know from a technology standpoint which technology is better suited for speed when retrieving and writing lots of data from excel to an external excel worksheet. There are FACTS to be shared, neither you nor I have them so let&#39;s stop talking and wait for an expert to answer."}], "answers": [{"comments": [{"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 2, "creation_date": 1450305245, "post_id": 34322469, "comment_id": 56388592, "body": "I don&#39;t get the impression OP wants to move to Sql Server but rather use SQL with ADO which can be used to treat an excel sheet as an &quot;table&quot;. The data need to be formatted in a specific way for this to work."}], "tags": [], "owner": {"reputation": 163, "user_id": 3758099, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/gE6bK.jpg?s=128&g=1", "display_name": "tc_NYC", "link": "https://stackoverflow.com/users/3758099/tc-nyc"}, "is_accepted": false, "score": 0, "last_activity_date": 1450301369, "creation_date": 1450301369, "answer_id": 34322469, "question_id": 34320282, "link": "https://stackoverflow.com/questions/34320282/is-reading-writing-to-an-excel-workbook-from-an-excel-workbook-faster-using-vb/34322469#34322469", "title": "Is reading &amp; writing to an excel workbook from an excel workbook faster using VBA or ADO + SQL?", "body": "<p>SQL is significantly faster for storing and accessing data and it easy to setup using SQL Server Express. It seems you are comfortable using SQL statements and should go down that route. You can download SQL Server <a href=\"https://www.microsoft.com/en-us/server-cloud/products/sql-server-editions/sql-server-express.aspx\" rel=\"nofollow\">here</a></p>\n\n<p>Basically, in SQL, the software isn't storing all the display properties that excel is. So in Excel, Excel is storing the value, the formatting (100s of different properties) and waiting on you to modify the value. SQL is just storing the raw value and some information like the data type. You can import your Excel sheet directly into SQL and it will set up the columns for you if you leave the headers in.</p>\n"}, {"comments": [{"owner": {"reputation": 641, "user_id": 3931725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/612340301/picture?type=large", "display_name": "Johnson Jason", "link": "https://stackoverflow.com/users/3931725/johnson-jason"}, "edited": false, "score": 0, "creation_date": 1450369945, "post_id": 34323341, "comment_id": 56420697, "body": "They put this topic on hold as &quot;too broad&quot; after you already answered it successfully. Moderation is funny sometimes. Anyway, your answer was perfect. Thank you :)"}], "tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": true, "score": 1, "last_activity_date": 1450306381, "last_edit_date": 1450306381, "creation_date": 1450304897, "answer_id": 34323341, "question_id": 34320282, "link": "https://stackoverflow.com/questions/34320282/is-reading-writing-to-an-excel-workbook-from-an-excel-workbook-faster-using-vb/34323341#34323341", "title": "Is reading &amp; writing to an excel workbook from an excel workbook faster using VBA or ADO + SQL?", "body": "<p>I believe you are talking an ADO call using a spreadsheet as your Active Data Object as opposed to exporting to an SQL database yes?</p>\n\n<p>I have tried both and found the difference to be negligible however, in saying that my query was a very simple one as it was just for messing around (i actually used a CSV or TXT file or something with a hint file).</p>\n\n<p>I still believe ADO has a place for Excel to Excel for simplifying the query but I could be wrong. If I do Excel to Excel via straight VBA, I will generally read the data into an array and manipulate in memory then make one update to my sheet, this is the quickest way you can do straight VBA manipulation, more sheet updates slows you down drastically.</p>\n\n<p>Depending on the complexity of your query, it could be considered a little overkill to use ADO but ultimately it's your call, it comes down to what you are most comfortable with. If you are comfortable with either, code up both and do some speed tests. I would be keen to see the results if you do for others wondering the same thing.</p>\n\n<p>Edit: If you are going down the path of doing everything in arrays, remember you can use multiple dimensions in arrays, a spreadsheet is a 2 dimensional with rows and columns, you can have loads of dimensions. Picture this: You have a solar system with a planet with an ocean with a ship with a container with a box with an item that's 7 dimensions but you can manipulate any one item by just knowing the coordinates through the many solar systems and planets and oceans and boats etc etc. There is lots of power in multi dimension arrays and in all honesty the only limit is getting your head around it (make sure you draw out a little map before you begin ;)) To get to an item would be as simple as MyItem(2,4,2,3,4,5,6) if you know you are on solar system 2, planet 4, ocean 2, boat 3 container 4 box 5 item 6.</p>\n"}], "owner": {"reputation": 641, "user_id": 3931725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/612340301/picture?type=large", "display_name": "Johnson Jason", "link": "https://stackoverflow.com/users/3931725/johnson-jason"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "closed_date": 1450320546, "accepted_answer_id": 34323341, "answer_count": 2, "score": -1, "last_activity_date": 1450306381, "creation_date": 1450293404, "last_edit_date": 1450296393, "question_id": 34320282, "link": "https://stackoverflow.com/questions/34320282/is-reading-writing-to-an-excel-workbook-from-an-excel-workbook-faster-using-vb", "closed_reason": "Needs more focus", "title": "Is reading &amp; writing to an excel workbook from an excel workbook faster using VBA or ADO + SQL?", "body": "<p>I have an excel workbook with several sub routines/functions that do a lot of reading and writing to an external excel workbook. It's almost like the external excel workbook is a database of sorts. </p>\n\n<p>For all the many reads and writes I must do, would it be faster for me to stop using VBA loops and use ADO and SQL SELECT/INSERT/UPDATE/DELETE statements?</p>\n\n<p>Not sure since this is excel to excel communication here. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 19, "user_id": 5687958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4e68960029b9209e0706540ea7b2b13?s=128&d=identicon&r=PG&f=1", "display_name": "HeyVBA", "link": "https://stackoverflow.com/users/5687958/heyvba"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 1, "creation_date": 1450291680, "post_id": 34319659, "comment_id": 56381262, "body": "I&#39;ve cut it down to the minimum, removed DB names and password and any identifiers."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 5687958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4e68960029b9209e0706540ea7b2b13?s=128&d=identicon&r=PG&f=1", "display_name": "HeyVBA", "link": "https://stackoverflow.com/users/5687958/heyvba"}, "edited": false, "score": 0, "creation_date": 1450291953, "post_id": 34319843, "comment_id": 56381423, "body": "Thank you, I&#39;ll try that now. Do I put this at the end of my code?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 19, "user_id": 5687958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4e68960029b9209e0706540ea7b2b13?s=128&d=identicon&r=PG&f=1", "display_name": "HeyVBA", "link": "https://stackoverflow.com/users/5687958/heyvba"}, "edited": false, "score": 0, "creation_date": 1450293577, "post_id": 34319843, "comment_id": 56382318, "body": "@HeyVBA - I don&#39;t know what your code looks like, so I&#39;m not sure.  You could just call this from when you need to. (Post your code in your OP if you want me to see if I can tell where to add it)."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 1, "last_activity_date": 1450291806, "creation_date": 1450291806, "answer_id": 34319843, "question_id": 34319659, "link": "https://stackoverflow.com/questions/34319659/simple-macro-to-delete-all-unused-columns-and-rows/34319843#34319843", "title": "SImple macro to delete all unused columns and rows", "body": "<pre><code>Sub hide_Empty_Columns()\nDim lastCol&amp;, i&amp;\nDim dataCol$\n\nlastCol = Cells(1, Columns.Count).End(xlToLeft).Column\n\nFor i = lastCol To 1 Step -1\n    With Columns(i)\n        If WorksheetFunction.CountA(Columns(i)) = 0 Then\n            Columns(i).Hidden = True\n        End If\n    End With\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>Pretty straightforward. You can tweak as needed.  It hides any column that is completely empty.  If you want instead to delete the column, change the <code>Columns(i).Hidden</code> line to <code>Columns(i).EntireColumn.Delete</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 641, "user_id": 3931725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/612340301/picture?type=large", "display_name": "Johnson Jason", "link": "https://stackoverflow.com/users/3931725/johnson-jason"}, "is_accepted": false, "score": 0, "last_activity_date": 1450298533, "creation_date": 1450298533, "answer_id": 34321745, "question_id": 34319659, "link": "https://stackoverflow.com/questions/34319659/simple-macro-to-delete-all-unused-columns-and-rows/34321745#34321745", "title": "SImple macro to delete all unused columns and rows", "body": "<p>Hi I too have had this problem in the past. Mostly the macros to delete unused columns and rows didn't help much. (some but not much).</p>\n\n<p>I found that most of the problem was 2 things.\n1) Excel saving a bunch of XML history.\n2. Cluttered VBA.</p>\n\n<p>Try these two things. \n1)Save your file as an xlsb file. This will change everything to binary and save wasted xml space.\n2)use code cleaner utility found here <a href=\"http://www.appspro.com/Utilities/CodeCleaner.htm\" rel=\"nofollow\">http://www.appspro.com/Utilities/CodeCleaner.htm</a> It's amazing how much space that thing can save for you.</p>\n\n<p>BTW, if you save your file as a myfile.zip you can open it up and see where the bulk of your issue is. Be-careful about editing there because you may corrupt things.</p>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 19, "user_id": 5687958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4e68960029b9209e0706540ea7b2b13?s=128&d=identicon&r=PG&f=1", "display_name": "HeyVBA", "link": "https://stackoverflow.com/users/5687958/heyvba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 590, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1450298533, "creation_date": 1450291148, "last_edit_date": 1450292520, "question_id": 34319659, "link": "https://stackoverflow.com/questions/34319659/simple-macro-to-delete-all-unused-columns-and-rows", "title": "SImple macro to delete all unused columns and rows", "body": "<p>I have linked a spreadsheet to a database and have created a macro that clears the contents of the worksheet and pastes In the results of the SQL I send to the database. </p>\n\n<p>It returns about 30 columns of data with about 6000 rows of data, yet the file size ballooned to 22mb!? I read on here about deleting/hiding empty columns and cells and this reduced the file to 2.5mb.</p>\n\n<p>Is there a quick macro that will save me having to do this manually each day please? I've seen a lot of variants on Google and I can't get one to work correctly.</p>\n\n<p>The number of columns stays the same each day but the number of rows fluctuate.</p>\n"}, {"tags": ["excel", "ms-office", "ribbon", "excel-2013", "vba"], "answers": [{"comments": [{"owner": {"reputation": 401, "user_id": 2812977, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/iudgu.jpg?s=128&g=1", "display_name": "Rocky Scott", "link": "https://stackoverflow.com/users/2812977/rocky-scott"}, "edited": false, "score": 2, "creation_date": 1533222866, "post_id": 34708556, "comment_id": 90277713, "body": "Thanks, Patrick. Instead of storing the pointer value in a cell, I used a <b><i>hidden name</i></b>, which I delete when the workbook closes. I figure this will minimize the possibility of it being accidentally altered. Also, immediately before the call to <code>Invalidate</code>, I check that <code>gobjRibbon</code> is not <code>Nothing</code>. I do this because I change the <code>enabled</code> property of some of the buttons on my ribbon based on which sheet is active; and <code>WorksheetActivate</code> is called <b><i>before</i></b> the ribbon is loaded, and the object pointer has been set.  This has brought my crashes to zero. Thanks again."}, {"owner": {"reputation": 76, "user_id": 5769876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/032233653bf34728bd38989daa38401c?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick Brunck", "link": "https://stackoverflow.com/users/5769876/patrick-brunck"}, "edited": false, "score": 0, "creation_date": 1548249431, "post_id": 34708556, "comment_id": 95474257, "body": "Hi Rocky, I like your idea using a <b>hidden name</b> instead of a <b>cell</b>. Thanks for sharing and for your feedback!"}], "tags": [], "owner": {"reputation": 76, "user_id": 5769876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/032233653bf34728bd38989daa38401c?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick Brunck", "link": "https://stackoverflow.com/users/5769876/patrick-brunck"}, "is_accepted": true, "score": 5, "last_activity_date": 1452447027, "creation_date": 1452447027, "answer_id": 34708556, "question_id": 34319470, "link": "https://stackoverflow.com/questions/34319470/invalidate-ribbon-control-without-module-level-variables/34708556#34708556", "title": "Invalidate Ribbon Control Without Module-Level Variables", "body": "<p>After reading your description I assume that you has developed a pure Excel VBA Add-In (instead of e.g. an Excel VSTO Add-In). Therefore, I'm afraid that there is no other way to achieve your goal. Fortunately, there is a workaround to restore the object reference to the ribbon object after a reset.</p>\n\n<p><strong>Workaround:</strong>\nWithin the \"Ribbon_Load\" event handler, where you would set the object reference to the Excel ribbon object, you should also save the \"ObjPtr()\" value of the ribbon object (e.g. within a worksheet cell). For example like this:</p>\n\n<pre><code>Public gobjRibbon As Office.IRibbonUI\n\n' Callback for customUI.onLoad\nSub Ribbon_Load(ribbon As Office.IRibbonUI)\n\n    Set gobjRibbon = ribbon\n\n    SampleWorksheet.Cells(1,1).Value = ObjPtr(ribbon)\nEnd Sub\n</code></pre>\n\n<p>In doing so, you can later restore the reference to the ribbon object (if necessary). You can achieve this by calling the \"RefreshRibbon\" procedure (which also invalidates the whole ribbon) from the following example:</p>\n\n<pre><code>#If VBA7 Then\n    Declare PtrSafe Sub CopyMemory Lib \"kernel32\" Alias \"RtlMoveMemory\" ( _\n        ByRef Destination As Any, ByRef Source As Any, ByVal Length As Long)\n#Else\n    Declare Sub CopyMemory Lib \"kernel32\" Alias \"RtlMoveMemory\" ( _\n        ByRef Destination As Any, ByRef Source As Any, ByVal Length As Long)\n#End If\n\n#If VBA7 Then\nFunction GetRibbon(ByVal lRibbonPointer As LongPtr) As Object\n#Else\nFunction GetRibbon(ByVal lRibbonPointer As Long) As Object\n#End If\n\n    Dim objRibbon As Object\n\n    Call CopyMemory(objRibbon, lRibbonPointer, LenB(lRibbonPointer))\n\n    Set GetRibbon = objRibbon\n    Set objRibbon = Nothing\nEnd Function\n\nPublic Sub RefreshRibbon()\n\n    If gobjRibbon Is Nothing Then\n        Set gobjRibbon = GetRibbon(SampleWorksheet.Cells(1,1).Value)\n    ' Else: Do nothing!\n    End If\n\n    On Error Resume Next\n    gobjRibbon.Invalidate\n    On Error GoTo 0\nEnd Sub\n</code></pre>\n\n<p>I recommend to clear the auxiliary cell at the end of an Excel session, because otherwise Excel suprisingly crashes sometimes.</p>\n\n<p><strong>Alternative:</strong>\nRe-develop your VBA Add-In as a VSTO Add-In to avoid having trouble with lost object references.</p>\n"}], "owner": {"reputation": 2969, "user_id": 2200824, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/14d5e4db680bf435588c48c505301479?s=128&d=identicon&r=PG", "display_name": "ARich", "link": "https://stackoverflow.com/users/2200824/arich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1440, "favorite_count": 3, "accepted_answer_id": 34708556, "answer_count": 1, "score": 4, "last_activity_date": 1533222723, "creation_date": 1450290473, "last_edit_date": 1531161705, "question_id": 34319470, "link": "https://stackoverflow.com/questions/34319470/invalidate-ribbon-control-without-module-level-variables", "title": "Invalidate Ribbon Control Without Module-Level Variables", "body": "<p>I've developed an Excel add-in that includes a custom ribbon. I'd like to be able to invalidate (enable/disable) a control on the ribbon in certain situations, but every example I can find uses a module-level or global variable to store the ribbon object when the ribbon is first loaded. This seems like a good way to do it, but, as <a href=\"https://stackoverflow.com/a/7043901/2200824\">listed here</a>, there are instances when variables can empty. </p>\n\n<p>So I'm wondering, is there a different way to achieve the result of enabling/disabling a control in an Excel ribbon without using a variable to store the ribbon object or without even using the invalidate method at all?</p>\n"}, {"tags": ["vba", "excel", "calendar"], "answers": [{"comments": [{"owner": {"reputation": 773, "user_id": 4588483, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh5.googleusercontent.com/-V06SrIEUCG8/AAAAAAAAAAI/AAAAAAAAABM/iJuysl7uixU/photo.jpg?sz=128", "display_name": "medavis6", "link": "https://stackoverflow.com/users/4588483/medavis6"}, "edited": false, "score": 0, "creation_date": 1450290209, "post_id": 34319302, "comment_id": 56380364, "body": "I agree with your logic about selecting the cell then clicking the button, but I&#39;m going to just assume that my users won&#39;t follow directions and will immediately click on the calendar button next to the cell. In order to prevent that error, that&#39;s why I&#39;m wondering if I can reuse the same code for multiple UserForm/Macro/Buttons. I&#39;m new to VBA and assume this is possible, I just don&#39;t know how difficult it is."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 773, "user_id": 4588483, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh5.googleusercontent.com/-V06SrIEUCG8/AAAAAAAAAAI/AAAAAAAAABM/iJuysl7uixU/photo.jpg?sz=128", "display_name": "medavis6", "link": "https://stackoverflow.com/users/4588483/medavis6"}, "edited": false, "score": 1, "creation_date": 1450290991, "post_id": 34319302, "comment_id": 56380862, "body": "If I were doing this I&#39;d probably either 1) use the worksheet&#39;s <code>SelectionChange</code> event to position a single button to the right of the date cell once it&#39;s been clicked on, or 2) implement something in the sheet&#39;s <code>BeforeDoubleClick</code> event to allow users to double-click the cell to launch the form."}, {"owner": {"reputation": 773, "user_id": 4588483, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh5.googleusercontent.com/-V06SrIEUCG8/AAAAAAAAAAI/AAAAAAAAABM/iJuysl7uixU/photo.jpg?sz=128", "display_name": "medavis6", "link": "https://stackoverflow.com/users/4588483/medavis6"}, "edited": false, "score": 0, "creation_date": 1450293628, "post_id": 34319302, "comment_id": 56382353, "body": "Thanks for the suggestions. I&#39;ll look into those options. Appreciate it!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1450289895, "creation_date": 1450289895, "answer_id": 34319302, "question_id": 34318769, "link": "https://stackoverflow.com/questions/34318769/reuse-userform-vba-code-for-multiple-date-pickers-in-same-worksheet/34319302#34319302", "title": "Reuse UserForm VBA Code for Multiple Date Pickers in Same Worksheet", "body": "<p>You can store the selected cell when the form opens and use that when you close it.</p>\n\n<pre><code>Dim cell As Range 'selected cell when launched\n\nPrivate Sub cmdClose_Click()\n    Unload Me\nEnd Sub\n\nPrivate Sub MonthView1_DateClick(ByVal DateClicked As Date)\n   On Error Resume Next\n   cell.Value = DateClicked\n   Unload Me\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\n   Set cell = Selection.Cells(1)\n   If IsDate(cell.Value) Then\n      Me.MonthView1.Value = cell.Value\n   End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 773, "user_id": 4588483, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh5.googleusercontent.com/-V06SrIEUCG8/AAAAAAAAAAI/AAAAAAAAABM/iJuysl7uixU/photo.jpg?sz=128", "display_name": "medavis6", "link": "https://stackoverflow.com/users/4588483/medavis6"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 693, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1450289895, "creation_date": 1450288049, "question_id": 34318769, "link": "https://stackoverflow.com/questions/34318769/reuse-userform-vba-code-for-multiple-date-pickers-in-same-worksheet", "title": "Reuse UserForm VBA Code for Multiple Date Pickers in Same Worksheet", "body": "<p>I'm wondering how to reuse the VBA code that I have to create multiple Calendar date pickers on the same worksheet that will input to different cells. I have tried changing the name of the .frm file and re-importing it to simply change the cell reference output, but Excel rejects this every time and says the name is already in use. I'm closely following <a href=\"http://www.fontstuff.com/vba/vbatut07.htm\" rel=\"nofollow noreferrer\">this example</a>.</p>\n\n<p><em>Bonus points if you know code for how to hide the clickable image until the cell with the date is selected.</em></p>\n\n<p>Here is the code that I am working with so far in frmCalendar:</p>\n\n<pre><code>Private Sub cmdClose_Click()\n    Unload Me\nEnd Sub\n\nPrivate Sub MonthView1_DateClick(ByVal DateClicked As Date)\n   On Error Resume Next\n   Dim cell As Object\n   For Each cell In Range(\"C18\")\n      cell.Value = DateClicked\n   Next cell\n   Unload Me\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\n   If IsDate(ActiveCell.Value) Then\n      Me.MonthView1.Value = Range(\"C18\")\n   End If\nEnd Sub\n</code></pre>\n\n<p>...and my code for Module1:</p>\n\n<pre><code>Sub Sample()\n    frmCalendar.Show\nEnd Sub\n</code></pre>\n\n<p>So basically, I have one calendar that unloads into C18. However, I would like to have up to 10 calendar buttons in my worksheet that have different output cells so they can all have different dates. </p>\n\n<p>Here is an example where the calendar button outputs to C18. It has been assigned the Macro \"Sample\" </p>\n\n<p><a href=\"https://i.stack.imgur.com/JbyD3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JbyD3.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>So how can I reuse my code for multiple calendar buttons?</strong> <em>Bonus if there is code to hide the calendar buttons until the cell is selected.</em></p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1450291016, "post_id": 34318710, "comment_id": 56380872, "body": "Why are you trying to do this instead of using the <a href=\"http://www.w3schools.com/Jsref/prop_node_attributes.asp\" rel=\"nofollow noreferrer\"><code>attributes</code></a> collection or <a href=\"https://msdn.microsoft.com/en-us/library/aa752280%28v=vs.85%29.aspx\" rel=\"nofollow noreferrer\"><code>getAttribute</code></a>?"}, {"owner": {"reputation": 11, "user_id": 5436940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/668fc56d68bcda5fec0b9413eb439587?s=128&d=identicon&r=PG&f=1", "display_name": "M Acc", "link": "https://stackoverflow.com/users/5436940/m-acc"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1450324167, "post_id": 34318710, "comment_id": 56394522, "body": "I run into the same problem by attempting to type &quot;aria-valuenow&quot; which turns into &quot;Aria - valuenow&quot; still causing the same compile error."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 9131843, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P-mwHPVxawM/AAAAAAAAAAI/AAAAAAAACZk/KD56w2Rf11g/photo.jpg?sz=128", "display_name": "Rodolfo Ocampo", "link": "https://stackoverflow.com/users/9131843/rodolfo-ocampo"}, "is_accepted": false, "score": 0, "last_activity_date": 1513961991, "creation_date": 1513961991, "answer_id": 47944939, "question_id": 34318710, "link": "https://stackoverflow.com/questions/34318710/vba-and-aria-html-control/47944939#47944939", "title": "VBA and Aria HTML Control", "body": "<p>just write \"ariaValuenow \" without the \"-\". So </p>\n\n<pre><code>If e.role = \"slider\" And e.tabindex = 1 Then\n    e.ariaValuenow = Pricelow\nElseIf e.role = \"slider\" And e.tabindex = 2 Then\n    e.ariaValuenow = Pricehigh\nEnd If\n</code></pre>\n\n<p>Cheers</p>\n"}], "owner": {"reputation": 11, "user_id": 5436940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/668fc56d68bcda5fec0b9413eb439587?s=128&d=identicon&r=PG&f=1", "display_name": "M Acc", "link": "https://stackoverflow.com/users/5436940/m-acc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1101, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1513961991, "creation_date": 1450287889, "last_edit_date": 1450290566, "question_id": 34318710, "link": "https://stackoverflow.com/questions/34318710/vba-and-aria-html-control", "title": "VBA and Aria HTML Control", "body": "<p>I have a seemingly simple but aggravating question. I am writing VBA code to control a slider bar on a webpage. This should be straightforward process like filling various types of check boxes and input boxes but I am running into a coding error. The slider bar has a high and low value that I would like to set (denoted by Price).</p>\n\n<p>Here is my code...</p>\n\n<pre><code>Function Master\nDim Elem As Object      ' Object used in For loop.\nDim e As Object         ' Object used in For loop.\nDim Element As Object   ' Object used to click buttons for search.\n\nDim PriceLow As Integer\nDim PriceHigh As Integer\n\nSet objShell = CreateObject(\"Shell.Application\")\nSet objWindow = objShell.Windows()\nSet Elem = objIEApp.Document.getElementsByTagName(\"div\")\nFor Each e In Elem\n    If e.role = \"slider\" And e.tabindex = 1 Then\n        e.aria-valuenow = Pricelow\n    ElseIf e.role = \"slider\" And e.tabindex = 2 Then\n        e.aria-valuenow = Pricehigh\n    End If\nNext e\nEnd Function\n</code></pre>\n\n<p>This is the HTML code for the low Price (without the &lt;> brackets)</p>\n\n<pre><code>div\n    tabindex=\"1\" class=\"airslide-handle\" role=\"slider\" aria-valuenow=\"10\"\n    aria-valuemin=\"10\" aria-valuemax=\"1000\" style=\"left: 0%;\" \n    data-reactid=\".4.1.1:$0\" abp=\"340\" data-handle-key=\"0\"&gt;\n/div\n</code></pre>\n\n<p>And for the high Price (same with &lt;>)</p>\n\n<pre><code>div tabindex=\"2\" class=\"airslide-handle\" role=\"slider\" aria-valuenow=\"1000\" \n    aria-valuemin=\"10\" aria-valuemax=\"1000\" style=\"left: 100%;\"\n    data-reactid=\".4.1.1:$1\" abp=\"341\" data-handle-key=\"1\"&gt;\n/div\n</code></pre>\n\n<p>When I type in the code lines \"e.aria-valuenow = Pricehigh\" and \"e.aria-valuenow = Pricelow\" though, VBA auto edits to make my code \"e. Aria - valuenow = Pricehigh\" and \"e.Aria - valuenow = Pricelow\" which obviously causes a compiling error in VBA. How do I fix or get around this?</p>\n"}, {"tags": ["vba", "excel", "scatter-plot"], "comments": [{"owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "edited": false, "score": 0, "creation_date": 1450296096, "post_id": 34318656, "comment_id": 56383740, "body": "start with <code>.ChartType=xlLineMarkers</code> instead of scatter?"}, {"owner": {"reputation": 432, "user_id": 4976543, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iKE0A.jpg?s=128&g=1", "display_name": "Branden Keck", "link": "https://stackoverflow.com/users/4976543/branden-keck"}, "reply_to_user": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "edited": false, "score": 0, "creation_date": 1450297103, "post_id": 34318656, "comment_id": 56384263, "body": "@MacroMarc  For some reason it wouldn&#39;t take that as a parameter.   I&#39;m not sure why.  I ended up solving it by making the xvalues doubles.  I have no idea why this worked, but I&#39;m not complaining.  Thanks anyway!"}], "answers": [{"tags": [], "owner": {"reputation": 432, "user_id": 4976543, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iKE0A.jpg?s=128&g=1", "display_name": "Branden Keck", "link": "https://stackoverflow.com/users/4976543/branden-keck"}, "is_accepted": true, "score": 0, "last_activity_date": 1450296946, "creation_date": 1450296946, "answer_id": 34321259, "question_id": 34318656, "link": "https://stackoverflow.com/questions/34318656/xyscatter-plot-incorrect-xaxis-when-drawn-in-visual-basic/34321259#34321259", "title": "XYScatter Plot Incorrect XAxis when Drawn in Visual Basic?", "body": "<p>I'm not sure why I didn't think of this... Two hours after I posted this I discovered that though using CStr() and CDate() on my XValues was useless, CDbl() actually worked.  I'm going to refrain from just deleting my question because I don't think this is very intuitive.  I'm not sure why this worked because I'm still formatting the xaxis as .CategoryType = xlTimeScale.  I added this bit of code to the code above (this is the code I had tested before with CStr() and CDate(), but I did not include it in the question):</p>\n\n<pre><code>For k = 0 To UBound(xval)\n    xval(k) = CDbl(xval(k))\nNext\n</code></pre>\n\n<p>This was added right before the MsgBox in the code from the question.  This is the new output from the MsgBox for the XValues of the first series in the set:</p>\n\n<p><a href=\"https://i.stack.imgur.com/vlKvV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vlKvV.png\" alt=\"enter image description here\"></a></p>\n\n<p>Note: These values are all in the 42000's because each whole number is equal to a day and this data is from 2015.  </p>\n\n<pre><code>2015 - 1900 = 115 years\n115 years * 365.25 days/year = 42003.75\n'In reality 2015 = 42005 (because of what years were leap years, etc.)\n</code></pre>\n\n<p>Finally, here is the actual output given the \"Numerical\" dates as xvalues in the scatter plot:</p>\n\n<p><a href=\"https://i.stack.imgur.com/LeiQ6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LeiQ6.png\" alt=\"enter image description here\"></a></p>\n\n<p>I guess the lesson here is that the xaxis likes numbers and using anything else could turn out to be a royal pain.  If anyone comes across this post, I hope it was helpful!</p>\n"}], "owner": {"reputation": 432, "user_id": 4976543, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iKE0A.jpg?s=128&g=1", "display_name": "Branden Keck", "link": "https://stackoverflow.com/users/4976543/branden-keck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 34321259, "answer_count": 1, "score": 2, "last_activity_date": 1450296946, "creation_date": 1450287727, "question_id": 34318656, "link": "https://stackoverflow.com/questions/34318656/xyscatter-plot-incorrect-xaxis-when-drawn-in-visual-basic", "title": "XYScatter Plot Incorrect XAxis when Drawn in Visual Basic?", "body": "<p>I'm trying to create a scatter plot using visual basic, the y axis being numerical values and the x axis being dates.  The intention is for the plot to contain multiple series.  Here is the relevant code:</p>\n\n<pre><code>ActiveWorkbook.Charts.Add\nActiveChart.ChartArea.Select\nWith ActiveChart\n    .ChartType = xlXYScatter\n    .HasTitle = True\n    .ChartTitle.Text = \"Time Trend of Data\"\n    .Axes(xlCategory, xlPrimary).HasTitle = True\n    .Axes(xlCategory, xlPrimary).AxisTitle.Characters.Text = \"Dates\"\n    .Axes(xlCategory, xlPrimary).CategoryType = xlTimeScale\n    .Axes(xlCategory, xlPrimary).TickLabels.NumberFormat = \"m/d/yy;@\"\n    .Axes(xlValue, xlPrimary).HasTitle = True\n    .Axes(xlValue, xlPrimary).AxisTitle.Characters.Text = \"Total Time\"\n    .Legend.Position = xlLegendPositionBottom\nEnd With\n\nActiveSheet.Move After:=Sheets(ActiveWorkbook.Sheets.count)\nActiveSheet.Name = \"Time Trend \" + CStr(currTT) ' This is just to make sure the new sheet does not have the same name\n</code></pre>\n\n<p>After I generate some data, I attempt to plot it with a loop.  The arrays I use are <strong>chartLabels</strong> - <em>which is the name of each series</em>, <strong>chartData</strong> - <em>a 3d array with several data points for each series</em> and <strong>xval and yval</strong> - <em>arrays built from the chartData array which are plotted against each other</em>:</p>\n\n<pre><code>For j = 0 To UBound(chartLabels)\n    If IsEmpty(chartLabels(j)) Then Exit For\n        Erase xval\n        Erase yval\n        ReDim Preserve xval(0 To 0)\n        ReDim Preserve yval(0 To 0)\n        xval(0) = chartData(1, j, 0)\n        yval(0) = chartData(2, j, 0)\n\n    For i = 0 To UBound(chartData, 3) - 1\n        If Not IsEmpty(chartData(2, j, i + 1)) Then\n            ReDim Preserve xval(0 To i + 1)\n            ReDim Preserve yval(0 To i + 1)\n            xval(i + 1) = chartData(1, j, i + 1)\n            yval(i + 1) = chartData(2, j, i + 1)\n        End If\n    Next\n\n    MsgBox (Join(xval, \" || \"))\n    ActiveChart.SeriesCollection.NewSeries\n    ActiveChart.SeriesCollection(j + 1).XValues = xval\n    ActiveChart.SeriesCollection(j + 1).Values = yval\n    ActiveChart.SeriesCollection(j + 1).Name = main.chartLabels(j)\nNext\n</code></pre>\n\n<p>The MsgBox Statement is included to view the array that I am passing as the XValues to my Scatter Plot.  The Output of the Array from the <strong>first series</strong> looks like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/md2Am.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/md2Am.png\" alt=\"enter image description here\"></a></p>\n\n<p>All of these values are in date format.  The number of series created varies.  Also, the number of data points in each series can very depending on options that the user picks.  However, the output that is generated on the scatter plot looks like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/cDtYw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cDtYw.png\" alt=\"enter image description here\"></a></p>\n\n<p>Everything on the graph is correct except the xaxis is scaled to the position of each data point in its respective series, NOT the actual date (i.e. 1/0/00 is actually 0 in date format and 3/10/00 is 70 because there are about 70 data points).</p>\n\n<p>I've tried using xlCategoryScale and xlAutomaticScale as my CategoryType.  I've tried using CDate() on each of my xvals as well as CStr().  I've tried outputting different arrays for the XValues.  Nothing works.</p>\n\n<p>I have my suspicions that the problem is related to the fact that I'm trying to graph multiple series of data.  But, if anybody could tell me the actual issue and/or a way around this issue, I would appreciate it very much.  Thank you in advance!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1450287524, "post_id": 34318241, "comment_id": 56378773, "body": "<code>varSheetB(iRow, iCol)</code> is a location in the variant, not on the sheet."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1450287596, "post_id": 34318241, "comment_id": 56378809, "body": "<code>Worksheets(&quot;Sheet4&quot;).Range(strRangeToCheck).Cells(iRow, iCol).Interior.Color = vbYellow</code>  You should probably create a varaible for that range though..."}, {"owner": {"reputation": 31, "user_id": 5664630, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8791ba72226878425233e0d471d607c3?s=128&d=identicon&r=PG&f=1", "display_name": "joes", "link": "https://stackoverflow.com/users/5664630/joes"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1450293066, "post_id": 34318241, "comment_id": 56382045, "body": "@Tim, worked great thanks, @ Raystafarian thanks for the direction on the mistake I was making."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 5664630, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8791ba72226878425233e0d471d607c3?s=128&d=identicon&r=PG&f=1", "display_name": "joes", "link": "https://stackoverflow.com/users/5664630/joes"}, "edited": false, "score": 0, "creation_date": 1450717518, "post_id": 34319691, "comment_id": 56542989, "body": "@Tim and Danno, awesome options, thanks for all the inputs!"}], "tags": [], "owner": {"reputation": 409, "user_id": 3657636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c62d4f70225e69fc19ac2bdf980e9014?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/3657636/dan"}, "is_accepted": false, "score": 0, "last_activity_date": 1450291263, "creation_date": 1450291263, "answer_id": 34319691, "question_id": 34318241, "link": "https://stackoverflow.com/questions/34318241/format-mismatching-cells-in-vba-worksheet-comparison-macro/34319691#34319691", "title": "Format mismatching cells in VBA worksheet comparison macro", "body": "<p>Here is a different approach that I typically use when trying to find and highlight mismatches. This should have the functionality you're looking for.</p>\n\n<pre><code>Option Explicit\n\nSub Compare2worksheets()\n\nDim iCol, iRow As Integer\n\nFor iCol = 1 To 27\n    For iRow = 1 To 17000\n        If Worksheets(\"Sheet3\").Cells(iRow, iCol) = Worksheets(\"Sheet4\").Cells(iRow, iCol) Then\n        'Do Nothing\n        Else\n        Worksheets(\"Sheet4\").Cells(iRow, iCol).Interior.Color = vbYellow\n        End If\n    Next iRow\nNext iCol\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1450295678, "creation_date": 1450295678, "answer_id": 34320917, "question_id": 34318241, "link": "https://stackoverflow.com/questions/34318241/format-mismatching-cells-in-vba-worksheet-comparison-macro/34320917#34320917", "title": "Format mismatching cells in VBA worksheet comparison macro", "body": "<p>Another approach:</p>\n\n<pre><code>Sub CompareRanges()\n\n    Dim rngA As Range, rngB As Range, arr, r As Long, c As Long\n\n    Set rngA = Range(\"A1:D4\")\n    Set rngB = Range(\"A6:D9\")\n    'will be evaluated as an array formula\n    arr = ActiveSheet.Evaluate(\"=IF(\" &amp; rngA.Address &amp; \"=\" &amp; rngB.Address &amp; \",1,0)\")\n\n    For r = LBound(arr, 1) To UBound(arr, 1)\n    For c = LBound(arr, 2) To UBound(arr, 2)\n        If Not IsError(arr(r, c)) Then\n            rngA(r, c).Interior.Color = IIf(arr(r, c) = 0, vbYellow, vbWhite)\n        End If\n    Next c\n    Next r\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 5664630, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8791ba72226878425233e0d471d607c3?s=128&d=identicon&r=PG&f=1", "display_name": "joes", "link": "https://stackoverflow.com/users/5664630/joes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1450322683, "creation_date": 1450286523, "last_edit_date": 1450322683, "question_id": 34318241, "link": "https://stackoverflow.com/questions/34318241/format-mismatching-cells-in-vba-worksheet-comparison-macro", "title": "Format mismatching cells in VBA worksheet comparison macro", "body": "<p>Quick question, below is code snippet of a comparison program that checks two worksheets to find mismatching data. I would like to highlight or format the mismatching cells on the sheet4 but am running into syntax or maybe logic trouble. Any guidance would be greatly appreciated.</p>\n\n<pre><code>Option Explicit\n\nSub compare2WorkSheets()\nDim varSheetA As Variant, varSheetB As Variant\nDim strRangeToCheck As String\nDim iRow As Long, iCol As Long\n\nstrRangeToCheck = \"A1:AB17000\"\n\nDebug.Print Now\nvarSheetA = Worksheets(\"Sheet3\").Range(strRangeToCheck)\nvarSheetB = Worksheets(\"Sheet4\").Range(strRangeToCheck)\nDebug.Print Now\n\nFor iRow = LBound(varSheetA, 1) To UBound(varSheetA, 1)\n    For iCol = LBound(varSheetA, 2) To UBound(varSheetA, 2)\n        If varSheetA(iRow, iCol) = varSheetB(iRow, iCol) Then\n            ' matching cells no format\n        Else\n            ' mismatch found,format the Sheet4 cells to yellow\n            varSheetB(iRow, iCol).Interior.Color = vbYellow '...referencing syntax trouble\n        End If\n    Next iCol\nNext iRow\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "replace", "outlook", "mailitem"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5687668, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0iSun.jpg?s=128&g=1", "display_name": "SuperDad", "link": "https://stackoverflow.com/users/5687668/superdad"}, "edited": false, "score": 0, "creation_date": 1450333069, "post_id": 34318433, "comment_id": 56397167, "body": "This looks great! sometimes it&#39;s just a second set of eyes. Thanks a bunch Tim, i&#39;ll try it in the AM and post up the results. Made my evening!"}, {"owner": {"reputation": 13, "user_id": 5687668, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0iSun.jpg?s=128&g=1", "display_name": "SuperDad", "link": "https://stackoverflow.com/users/5687668/superdad"}, "edited": false, "score": 0, "creation_date": 1450375647, "post_id": 34318433, "comment_id": 56424143, "body": "Tim, if I switch the mail property to .body it works. the weird thing is when I run this REPLACE() function in VBS it works on .HTMLBody"}, {"owner": {"reputation": 484, "user_id": 2846397, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/lYlxB.png?s=128&g=1", "display_name": "SOSidb", "link": "https://stackoverflow.com/users/2846397/sosidb"}, "edited": false, "score": 0, "creation_date": 1497546725, "post_id": 34318433, "comment_id": 76135210, "body": "Just ran into this myself (for anyone else seeing this post, hope this helps).  What was happening is that when I used &quot;special&quot; characters in my field to replace, it didn&#39;t work.  Turns out that HTMLbody is changing something like &quot;!NAME&quot; into &quot;&lt;/span&gt;!&lt;span class=SpellE&gt;NAME&quot; (without all the quotes).  So when I try to replace &quot;!NAME&quot; using PS, it can&#39;t find it (so it can&#39;t replace it).  So don&#39;t use special characters or spaces.  Credit goes to this post at SO <a href=\"https://stackoverflow.com/questions/24154063/replace-text-in-html-body\" title=\"replace text in html body\">stackoverflow.com/questions/24154063/replace-text-in-html-bo&zwnj;&#8203;dy</a>"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1450287064, "creation_date": 1450287064, "answer_id": 34318433, "question_id": 34318109, "link": "https://stackoverflow.com/questions/34318109/outlook-mailitem-htmlbody-replace-not-working-brand-new-be-gentle/34318433#34318433", "title": "Outlook MailItem HTMLBody Replace() not working - brand new be gentle", "body": "<p>Replace should work OK here:</p>\n\n<pre><code>If InStr(nextMessage.HTMLBody, \"%Customer_Name%\") &lt;&gt; 0 Then\n    NextHTMLBody = Replace(nextMessage.Body, \"%Customer_Name%\", bBodyName)\nEnd If\n</code></pre>\n\n<p>But in the next block you're discarding the replacement you performed above by going back to <code>nextMessage.HTMLBody</code> instead of continuing with <code>NextHTMLBody</code>. You're also switching to <code>HTMLBody</code> from <code>Body</code>: not sure if there's a reson for that. </p>\n\n<pre><code>If InStr(nextMessage.HTMLBody, \"%##%\") &lt;&gt; 0 Then\n\n    NextHTMLBody = Replace(nextMessage.HTMLBody, \"%##%\", _\n                             formPage.Controls(\"LoanNumber1\").Value)\nEnd If\n</code></pre>\n\n<p>Best bet is something more like this (you don't really need the If-Then here):</p>\n\n<pre><code>NextHTMLBody = nextMessage.HTMLBody\n\nNextHTMLBody = Replace(NextHTMLBody, \"%Customer_Name%\", bBodyName)\n\nNextHTMLBody = Replace(NextHTMLBody, \"%##%\", _\n                             formPage.Controls(\"LoanNumber1\").Value)\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5687668, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0iSun.jpg?s=128&g=1", "display_name": "SuperDad", "link": "https://stackoverflow.com/users/5687668/superdad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1654, "favorite_count": 0, "accepted_answer_id": 34318433, "answer_count": 1, "score": 0, "last_activity_date": 1450376592, "creation_date": 1450286105, "last_edit_date": 1450376592, "question_id": 34318109, "link": "https://stackoverflow.com/questions/34318109/outlook-mailitem-htmlbody-replace-not-working-brand-new-be-gentle", "title": "Outlook MailItem HTMLBody Replace() not working - brand new be gentle", "body": "<p>Okay here is the updated version... still not working though</p>\n\n<pre><code>        NextHTMLBody = nextMessage.HTMLBody\n        NextHTMLBody = Replace(NextHTMLBody, \"%Customer_Name%\", bBodyName)\n        NextHTMLBody = Replace(NextHTMLBody, \"%##%\", formPage.Controls(\"LoanNumber1\").Value)\n\n        With nextMessage\n            .HTMLBody = NextHTMLBody\n            .Subject = subjEmail\n            .To = sendTo\n            .Send\n        End With\n</code></pre>\n\n<p>-------------and here it works.. not sure what I did differently</p>\n\n<pre><code>        'Set body\n        NextHTMLBody = nextMessage.HTMLBody\n        NextHTMLBody = Replace(NextHTMLBody, \"%Customer_Name%\", bBodyName)\n        NextHTMLBody = Replace(NextHTMLBody, \"%##%\", formPage.Controls(\"LoanNumber1\").Value)\n\n        With nextMessage\n            .HTMLBody = NextHTMLBody\n            '.Body = NextHTMLBody\n            .Subject = subjEmail\n            .To = sendTo\n            '.Send\n            .Display\n        End With\n</code></pre>\n"}, {"tags": ["vba", "excel", "pdf", "outlook"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1450286254, "post_id": 34318046, "comment_id": 56378039, "body": "Have you tried commenting out the <code>On Error Resume Next</code> ?  It&#39;s odd that the debugger highlights the function call and not the actual problem"}, {"owner": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "edited": false, "score": 0, "creation_date": 1450286534, "post_id": 34318046, "comment_id": 56378202, "body": "Had a similar problem when workbook wasn&#39;t saved to local drive or not saved at all.  Check the value of <code>ThisWorkbook.Path</code> and verify it&#39;s not empty."}], "answers": [{"tags": [], "owner": {"reputation": 76, "user_id": 5769876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/032233653bf34728bd38989daa38401c?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick Brunck", "link": "https://stackoverflow.com/users/5769876/patrick-brunck"}, "is_accepted": false, "score": 0, "last_activity_date": 1452460510, "last_edit_date": 1452460510, "creation_date": 1452459710, "answer_id": 34710731, "question_id": 34318046, "link": "https://stackoverflow.com/questions/34318046/not-able-to-save-pdfs-from-excel-vba-on-one-computer/34710731#34710731", "title": "Not able to save PDFs from Excel/VBA on one computer", "body": "<ol>\n<li>Please check if there is enough disk space where the user wants to save the PDF file to!</li>\n<li>I would recommend to check the length of the PDF fullname (path, filename and file extension; in your example it is the variable \"Fname\") as well before calling \"ActiveSheet.ExportAsFixedFormat(...)\", because filenames (or rather fullnames) under Microsoft Windows regularly cannot exceed more than 255 characters (see: <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa365247%28v=vs.85%29.aspx\" rel=\"nofollow\">Naming Files, Paths, and Namespaces</a>).</li>\n</ol>\n"}], "owner": {"reputation": 81, "user_id": 5678572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4f10712b0cd974066cd42093d592bf8?s=128&d=identicon&r=PG&f=1", "display_name": "adamcwhite", "link": "https://stackoverflow.com/users/5678572/adamcwhite"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1200, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1452460510, "creation_date": 1450285889, "question_id": 34318046, "link": "https://stackoverflow.com/questions/34318046/not-able-to-save-pdfs-from-excel-vba-on-one-computer", "title": "Not able to save PDFs from Excel/VBA on one computer", "body": "<p>I recently received help here for an Excel spreadsheet we have that allows users to create quotations for customers. The spreadsheet uses VBA to allow the user to press a button which generates a PDF out from certain sheets, and attaches them to a new Outlook email.</p>\n\n<p>Unfortunately this isn't working on one of the user's computers. The problem seems to be with the generating of the PDF. Initially when pressing the button, nothing happened. I suspected it was to do with the Microsoft Add-in to Save as PDF, so I made sure it was installed, which it was. After 'commenting out' the error message coming from the code to get to the real error message from Visual Basic, I found it to be this:</p>\n\n<pre><code>run-time error '-2147467261 (80004003)': Document not saved.\n</code></pre>\n\n<p>When clicking 'Debug' it highlights:</p>\n\n<pre><code>FileName = Create_PDF_Sheet_Level_Names(NamedRange:=\"addtopdf1\", _\n                                        FixedFilePathName:=ThisWorkbook.Path &amp; \"\\\" &amp; \"Quotation - \" &amp; Range(\"G18\") &amp; \".pdf\", _\n                                        OverwriteIfFileExist:=True, _\n                                        OpenPDFAfterPublish:=False)\n</code></pre>\n\n<p>Which relates to:</p>\n\n<pre><code>Function Create_PDF_Sheet_Level_Names(NamedRange As String, FixedFilePathName As String, _\n                                      OverwriteIfFileExist As Boolean, OpenPDFAfterPublish As Boolean) As String\n'This function will create a PDF with every sheet with\n'a sheet level name variable &lt;NamedRange&gt; in it\n    Dim FileFormatstr As String\n    Dim Fname As Variant\n    Dim Ash As Worksheet\n    Dim sh As Worksheet\n    Dim ShArr() As String\n    Dim s As Long\n    Dim SheetLevelName As Name\n\n    'Test If the Microsoft Add-in is installed\n    If Dir(Environ(\"commonprogramfiles\") &amp; \"\\Microsoft Shared\\OFFICE\" _\n         &amp; Format(Val(Application.Version), \"00\") &amp; \"\\EXP_PDF.DLL\") &lt;&gt; \"\" Then\n\n        'We fill the Array with sheets with the sheet level name variable\n        For Each sh In ActiveWorkbook.Worksheets\n            If sh.Visible = -1 Then\n                Set SheetLevelName = Nothing\n                On Error Resume Next\n                Set SheetLevelName = sh.Names(NamedRange)\n                On Error GoTo 0\n                If Not SheetLevelName Is Nothing Then\n                    s = s + 1\n                    ReDim Preserve ShArr(1 To s)\n                    ShArr(s) = sh.Name\n                End If\n            End If\n        Next sh\n\n        'We exit the function If there are no sheets with\n        'a sheet level name variable named &lt;NamedRange&gt;\n        If s = 0 Then Exit Function\n\n        If FixedFilePathName = \"\" Then\n\n            'Open the GetSaveAsFilename dialog to enter a file name for the pdf\n            FileFormatstr = \"PDF Files (*.pdf), *.pdf\"\n            Fname = Application.GetSaveAsFilename(\"\", filefilter:=FileFormatstr, _\n                                                  Title:=\"Create PDF\")\n\n            'If you cancel this dialog Exit the function\n            If Fname = False Then Exit Function\n        Else\n            Fname = FixedFilePathName\n        End If\n\n\n        'If OverwriteIfFileExist = False we test if the PDF\n        'already exist in the folder and Exit the function if that is True\n        If OverwriteIfFileExist = False Then\n            If Dir(Fname) &lt;&gt; \"\" Then Exit Function\n        End If\n\n        Application.ScreenUpdating = False\n        Application.EnableEvents = False\n\n        'Remember the ActiveSheet\n        Set Ash = ActiveSheet\n\n        'Select the sheets with the sheet level name in it\n        Sheets(ShArr).Select\n\n        'Now the file name is correct we Publish to PDF\n        On Error Resume Next\n        ActiveSheet.ExportAsFixedFormat _\n                Type:=xlTypePDF, _\n                FileName:=Fname, _\n                Quality:=xlQualityStandard, _\n                IncludeDocProperties:=True, _\n                IgnorePrintAreas:=False, _\n                OpenAfterPublish:=OpenPDFAfterPublish\n        On Error GoTo 0\n\n        'If Publish is Ok the function will return the file name\n        If Dir(Fname) &lt;&gt; \"\" Then\n            Create_PDF_Sheet_Level_Names = Fname\n        End If\n\n        Ash.Select\n\n        Application.ScreenUpdating = True\n        Application.EnableEvents = True\n    End If\nEnd Function\n</code></pre>\n\n<p>I'm really scratching my head here! Checked all settings side-by-side with my machine on Excel and Outlook, including Trust Centre settings. Also checked add-ins.</p>\n"}, {"tags": ["vba", "ms-access-2010"], "answers": [{"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1450287511, "creation_date": 1450287511, "answer_id": 34318584, "question_id": 34317812, "link": "https://stackoverflow.com/questions/34317812/vba-ms-access-compare-values-in-a-column-to-a-value-using-instr/34318584#34318584", "title": "VBA MS Access Compare values in a column to a value using Instr", "body": "<p>You should be able to do this with just an update query.</p>\n\n<p>For example:<br>\n<code>Main_Table</code> contains these fields - <code>ID</code> (AutoNum) and <code>FieldToChange</code> (Text)<br>\n<code>ReferenceTable</code> contains these fields - <code>ID</code> (AutoNum), <code>ALookUpValue</code> (Text), <code>ChangeTo</code> (Text)</p>\n\n<p>If the value held in <code>ALookUpValue</code> appears anywhere in <code>FieldToChange</code> then replace the field value with whatevers in <code>ChangeTo</code>.</p>\n\n<p>So, if <code>FieldToChange</code> contains ABCDEFG, <code>ALookUpValue</code> contains A and <code>ChangeTo</code> contains 'blah blah' then ABCDEFG will update to say 'blah blah'</p>\n\n<pre><code>UPDATE MainTable INNER JOIN ReferenceTable ON MainTable.FieldToChange LIKE '*' &amp; ReferenceTable.ALookUpValue &amp; '*'\nSET MainTable.FieldToChange = ReferenceTable.ChangeTo\n</code></pre>\n\n<p>Hope that's understandable - end of the day. :)</p>\n\n<p><strong>Edit - test on a copy of your database - it will update values!</strong></p>\n"}, {"tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 0, "last_activity_date": 1450290983, "creation_date": 1450290983, "answer_id": 34319620, "question_id": 34317812, "link": "https://stackoverflow.com/questions/34317812/vba-ms-access-compare-values-in-a-column-to-a-value-using-instr/34319620#34319620", "title": "VBA MS Access Compare values in a column to a value using Instr", "body": "<p>Several things:</p>\n\n<ol>\n<li><a href=\"https://support.office.com/en-us/article/InStr-Function-85d3392c-3b1c-4232-bb18-77cd0cb8a55b\" rel=\"nofollow\">Instr()</a> returns a number (specifically variant type of Long) which is the first position of the lookup value. You have it compared to a boolean (T/F). But in VBA this is still legal as False is zero value and True non-zero value. However, it is advised never to rely on the equivalent numeric values of these <a href=\"https://msdn.microsoft.com/en-us/library/f0y616xy%28v=vs.90%29.aspx\" rel=\"nofollow\">types</a>. </li>\n<li>Brackets should not be wrapped around your entire recordset item but only around the field name:</li>\n<li>Check the array item types. How it is declared and populated may invoke a <code>Type Mismatch</code> error. You do not include how array, <code>MyArray</code> is initialized and defined. For your needs, you need either <code>String</code> or <code>Variant</code> type array.</li>\n</ol>\n\n<p>Try the following adjustment:</p>\n\n<pre><code>Set rstTableName = CurrentDb.OpenRecordset(\"MAIN_TABLE\")\n\nFor Each vItem In MyArray\n\n    Do While Not rstTableName.EOF\n        If InStr(1, rstTableName![NAME], vItem) &gt; 0 Then\n            Debug.Print (rstTableName![NAME])\n        End If\n        rstTableName.MoveNext\n    Loop\n\nNext vItem\n</code></pre>\n\n<p>Alternatively, use the <a href=\"https://msdn.microsoft.com/en-us/library/swf8kaxw.aspx\" rel=\"nofollow\">Like</a> operator</p>\n\n<pre><code>Set rstTableName = CurrentDb.OpenRecordset(\"MAIN_TABLE\")\n\nFor Each vItem In MyArray\n\n    Do While Not rstTableName.EOF\n        If rstTableName![NAME] Like \"*\" &amp; vItem &amp; \"*\" Then\n            Debug.Print (rstTableName![NAME])\n        End If\n        rstTableName.MoveNext\n    Loop\n\nNext vItem\n</code></pre>\n"}], "owner": {"reputation": 1824, "user_id": 1901071, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/fc4b1bc6808a1543de0a6259a67d8f2d?s=128&d=identicon&r=PG", "display_name": "John Smith", "link": "https://stackoverflow.com/users/1901071/john-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 561, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1450290983, "creation_date": 1450285174, "question_id": 34317812, "link": "https://stackoverflow.com/questions/34317812/vba-ms-access-compare-values-in-a-column-to-a-value-using-instr", "title": "VBA MS Access Compare values in a column to a value using Instr", "body": "<p>I have an Access database which contains a main table and a reference table. I'm trying to change a column in the table based on if it contains values in an array (pulled from the reference table) so the logic is something like this</p>\n\n<ul>\n<li>Compare the value of the array to see if its contained within a column of the main table</li>\n<li>If it is contained in the main table column change the group column to the value in the array</li>\n</ul>\n\n<p>I have the code below which simply compares the value in the array against the table and prints the value. Im getting the error \"Type mismatch\". Does anyone know how i can compare the records?</p>\n\n<pre><code>    Set rstTableName = CurrentDb.OpenRecordset(\"MAIN_TABLE\")\n\n    For Each vItem In MyArray\n\n        Do While Not rstTableName.EOF\n            If InStr(1, [rstTableName!NAME], vItem) Then\n                Debug.Print (rstTableName!NAME)\n            End If\n            rstTableName.MoveNext\n        Loop\n    Next\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1450290347, "post_id": 34317656, "comment_id": 56380455, "body": "<a href=\"http://stackoverflow.com/q/18067070/1161309\">stackoverflow.com/q/18067070/1161309</a>"}], "answers": [{"tags": [], "owner": {"reputation": 5222, "user_id": 1087852, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8cjly.jpg?s=128&g=1", "display_name": "LucasSeveryn", "link": "https://stackoverflow.com/users/1087852/lucasseveryn"}, "is_accepted": true, "score": 2, "last_activity_date": 1462950224, "last_edit_date": 1462950224, "creation_date": 1454064706, "answer_id": 35082651, "question_id": 34317656, "link": "https://stackoverflow.com/questions/34317656/how-to-name-the-connection-used-by-a-querytable/35082651#35082651", "title": "How to name the connection used by a QueryTable", "body": "<p>In the end I didn't find a way to directly name a new querytable connection, so I had to code a macro that looks for the new name in the connection list, and then renames it.</p>\n\n<pre><code>Sub NewQueryTable(ConnectionName As String)\n    OriginalConnections = ConnectionList()\n\n    With ActiveSheet.QueryTables.Add(Connection:= _\n        \"URL;http://myconnection&amp;format=csv\" _\n        , Destination:=Range(\"$D$1\"))\n        .Name = ConnectionName\n    End With\n\n\n' Looking for the newly created Connection to rename it\n'''''''''''''''''''''''''''''''''''''''''''''''''''''\n    UpdatedConnections = ConnectionList()\n    Dim NewConnectionName As String\n    Dim CheckedString As String\n\n\n    For Each conn In UpdatedConnections\n        CheckedString = conn\n        If Not (IsInArray(CheckedString, OriginalConnections)) Then\n            NewConnectionName = CheckedString\n        End If\n    Next conn\n\n    With ActiveWorkbook.Connections(NewConnectionName)\n            .Name = ConnectionName\n            .Description = \"\"\n    End With\n\n\nEnd Sub\n\n\nFunction ConnectionList() As Variant\n\n    Dim NumOfConnections As Integer\n    Dim Counter As Integer\n\n\n    NumOfConnections = 0\n    Counter = 1\n\n\n    Dim conn As WorkbookConnection\n    For Each conn In ActiveWorkbook.Connections\n        NumOfConnections = NumOfConnections + 1\n    Next conn\n\n\n    Dim ConnectionNames() As String, size As Integer, i As Integer\n    size = NumOfConnections\n    ReDim ConnectionNames(size)\n\n    For Each conn In ActiveWorkbook.Connections\n        ConnectionNames(Counter) = conn.Name\n        Counter = Counter + 1\n    Next conn\n\n    ConnectionList = ConnectionNames\n\n\nEnd Function\n\nFunction IsInArray(stringToBeFound As String, arr As Variant) As Boolean\n\n        IsInArray = (UBound(Filter(arr, stringToBeFound)) &gt; -1)\n\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 652, "user_id": 4338329, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-VNvM-kwy6Vo/AAAAAAAAAAI/AAAAAAAAAkg/BnXdycqT9eU/photo.jpg?sz=128", "display_name": "lovechillcool", "link": "https://stackoverflow.com/users/4338329/lovechillcool"}, "edited": false, "score": 1, "creation_date": 1564173422, "post_id": 51891725, "comment_id": 100957627, "body": "This is a much better solution. Using built-in features instead of creating new ones."}], "tags": [], "owner": {"reputation": 21, "user_id": 10238350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e841be2e926a0222d0dbde208c07aed2?s=128&d=identicon&r=PG&f=1", "display_name": "Stormin", "link": "https://stackoverflow.com/users/10238350/stormin"}, "is_accepted": false, "score": 2, "last_activity_date": 1534496031, "creation_date": 1534496031, "answer_id": 51891725, "question_id": 34317656, "link": "https://stackoverflow.com/questions/34317656/how-to-name-the-connection-used-by-a-querytable/51891725#51891725", "title": "How to name the connection used by a QueryTable", "body": "<p>This still comes up as a top result in Google, so I thought I'd answer. You use the <code>WorkbookConnection</code> property of the <code>QueryTable</code> object:</p>\n\n<pre><code>Dim oQT As QueryTable\n\nSet oQT = ActiveSheet.ListObjects(1).QueryTable\n\n'Rename the connection\nWith oQT.WorkbookConnection\n    .Name = \"NewConnectionName\"\n    .Description = \"New Connection Description\"\nEnd With\n\n'Delete the connection\noQT.WorkbookConnection.Delete\n</code></pre>\n"}], "owner": {"reputation": 5222, "user_id": 1087852, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8cjly.jpg?s=128&g=1", "display_name": "LucasSeveryn", "link": "https://stackoverflow.com/users/1087852/lucasseveryn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2726, "favorite_count": 0, "accepted_answer_id": 35082651, "answer_count": 2, "score": 1, "last_activity_date": 1574610124, "creation_date": 1450284768, "last_edit_date": 1574610124, "question_id": 34317656, "link": "https://stackoverflow.com/questions/34317656/how-to-name-the-connection-used-by-a-querytable", "title": "How to name the connection used by a QueryTable", "body": "<p>My current code:</p>\n\n<pre><code>ConnectionName = \"testCon\"\nWith ActiveSheet.QueryTables.Add(Connection:= _\n    \"URL;http://test/test?values=[]~[]~[]~[]~[]~[]~[]~[]~[]~[]~[]~[]~[]~[]~[]~[]~[]~[]~[]~[]~[]~[]~[]~[]~[]~[]~[]~[]~[]~[]~[]~[]~[]&amp;format=csv\" _\n    , Destination:=Range(\"$D$1\"))\n    .Name = ConnectionName\nEnd With\n</code></pre>\n\n<p>This results in a new connection being created, named \"Connection\", and if the process is repeated \"Connection1\" is created, then \"Connection2\" and so on. Is there any way to name the connection?</p>\n\n<p>the <code>.Name</code> parameter seems to refer to the data range name, rather than connection name.</p>\n"}, {"tags": ["excel", "excel-2010", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1450284126, "post_id": 34317425, "comment_id": 56376760, "body": "Please show the code you have tried.  We can help figure out the issue."}], "answers": [{"comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 1, "creation_date": 1450286310, "post_id": 34317651, "comment_id": 56378069, "body": "@pnuts See my <b>EDIT#1</b>"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1450287231, "post_id": 34317651, "comment_id": 56378611, "body": "@pnuts  I used to use <i>ROW()</i> for this kind of application, but I am now using <i>ROWS()</i> because it makes the series formula <b>independent</b> of the position of the starting cell!!"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1450288140, "post_id": 34317651, "comment_id": 56379143, "body": "@p <b>OUCH!!</b>  <i>I fixed it.</i>"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1450288104, "last_edit_date": 1450288104, "creation_date": 1450284750, "answer_id": 34317651, "question_id": 34317425, "link": "https://stackoverflow.com/questions/34317425/transpose-n-rows-to-one-single-column/34317651#34317651", "title": "Transpose n&#39; rows to one single column", "body": "<p>Pick a cell and enter:</p>\n\n<pre><code>=OFFSET($A$1,ROUNDUP(ROWS($1:1)/7,0)-1,MOD(ROWS($1:1)-1,7))\n</code></pre>\n\n<p>and then copy downwards.</p>\n\n<p><a href=\"https://i.stack.imgur.com/a7NxV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/a7NxV.png\" alt=\"enter image description here\"></a></p>\n\n<p>Using similar formulas, you can map any rectangular table into a single column or a single row.  It is also possible to map any single row or column into a rectangular table.</p>\n\n<p><strong>EDIT#1:</strong></p>\n\n<p>To get the <strong>second</strong> column in the Poster's example, pick the cell adjacent to my single column output and enter:</p>\n\n<pre><code>=ROUNDUP(ROWS($1:1)/7,0)\n</code></pre>\n\n<p>and copy downwards. <em>(in my example this is cell  <strong>I5</strong> )</em></p>\n"}], "owner": {"reputation": 7, "user_id": 5325405, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c8fbc28f9a8b4e00415b28e720a6c4c7?s=128&d=identicon&r=PG", "display_name": "Eudes", "link": "https://stackoverflow.com/users/5325405/eudes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1450288104, "creation_date": 1450284068, "last_edit_date": 1531161705, "question_id": 34317425, "link": "https://stackoverflow.com/questions/34317425/transpose-n-rows-to-one-single-column", "title": "Transpose n&#39; rows to one single column", "body": "<p>I want to transpose three rows into a single column. For example:</p>\n\n<pre><code>    A     B      C       D       E       F       G\n1 60000 40000   50000   40000   50000   50000   40000\n2 50000 40000   50000   50000   40000   50000   50000\n3 60000 50000   50000   50000   50000   50000   50000\n</code></pre>\n\n<p>.</p>\n\n<pre><code> A\n60000 1\n40000 1\n50000 1\n40000 1\n50000 1\n50000 1\n40000 1\n50000 2\n40000 2\n50000 2\n50000 2\n40000 2\n50000 2\n50000 2\n60000 3\n50000 3\n50000 3\n50000 3\n50000 3\n50000 3\n50000 3\n</code></pre>\n\n<p>I wrote VBA and ended up with code that wasn't automated enough. My logic is for each column transpose:true then concatenate them in a single column.</p>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1023602"}, "edited": false, "score": 1, "creation_date": 1450283073, "post_id": 34317067, "comment_id": 56375993, "body": "Remove brackets from the assignment: Hehe2 = Zliczacz"}], "answers": [{"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 2, "last_activity_date": 1450283218, "creation_date": 1450283218, "answer_id": 34317168, "question_id": 34317067, "link": "https://stackoverflow.com/questions/34317067/cant-assign-array-result-of-function-to-an-array/34317168#34317168", "title": "Can&#39;t assign array result of function to an array", "body": "<p>You can only assign one array to another if the receiving array is declared as dynamic and of the same type. Yours is fixed, so it won't work. You need to use:</p>\n\n<pre><code>Dim lol() as Double\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5687509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c744c18f26c3f05b3c5185bd4042f9a0?s=128&d=identicon&r=PG&f=1", "display_name": "IQSPolandMainProgrammer", "link": "https://stackoverflow.com/users/5687509/iqspolandmainprogrammer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1096, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1450283218, "creation_date": 1450282955, "last_edit_date": 1450283110, "question_id": 34317067, "link": "https://stackoverflow.com/questions/34317067/cant-assign-array-result-of-function-to-an-array", "title": "Can&#39;t assign array result of function to an array", "body": "<p>I'm trying to assign array result of function to an array. It works fine, if i try to assign one element of result array to my array, but it returns error while trying to assign whole result array to my array (\"Can't assign to array\"). </p>\n\n<pre><code>Sub test()\nDim lol(6) as Double\nlol = Hehe2()\nEnd Sub\n\nFunction Hehe2() As Double()\nDim Zliczacz(1 To 6) As Double\nZliczacz(1) = 1 / 2\nZliczacz(2) = 1 / 2\nZliczacz(3) = 1 / 2\nZliczacz(4) = 1 / 2\nZliczacz(5) = 1 / 2\nZliczacz(6) = 1 / 2\nHehe2 = Zliczacz()\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "edited": false, "score": 1, "creation_date": 1450281097, "post_id": 34316328, "comment_id": 56374501, "body": "Arrays are zero indexed.  The first element is &quot;0&quot;, and you have to be careful when looping to the end of a collection via .Count.  You want to end it at .Count - 1"}, {"owner": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "edited": false, "score": 0, "creation_date": 1450281168, "post_id": 34316328, "comment_id": 56374563, "body": "&quot;The problematic line of code is highlighted.&quot; &lt;-- where?"}, {"owner": {"reputation": 878, "user_id": 4839592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6d7b83ccb165cc0eb54b10e0ba29a7?s=128&d=identicon&r=PG&f=1", "display_name": "TMH8885", "link": "https://stackoverflow.com/users/4839592/tmh8885"}, "reply_to_user": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "edited": false, "score": 0, "creation_date": 1450281402, "post_id": 34316328, "comment_id": 56374775, "body": "@roryap I&#39;m assuming it&#39;s the 3rd line from the bottom with the two asterisks, along with the ReDim of the array prior to the For Loop."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 3, "creation_date": 1450282606, "post_id": 34316328, "comment_id": 56375684, "body": "Two words: <code>Option Explicit</code>. You&#39;ve declared <code>pointIteratEr</code> but then used <code>pointIteratOr</code> as the index."}], "answers": [{"comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 2, "creation_date": 1450282434, "post_id": 34316576, "comment_id": 56375563, "body": "Arrays are not zero indexed if you declare them as <code>1 To x</code> though."}, {"owner": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1450282910, "post_id": 34316576, "comment_id": 56375884, "body": "I&#39;ve never heard of that in 15 years of using VB.  Can you provide a reference?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1450283099, "post_id": 34316576, "comment_id": 56376022, "body": "The VBA language spec. It states, in part, &quot;If the &lt;lower-bound&gt; is present, its &lt;constant-expression&gt; provides the lower bound Long data value for the corresponding dimension.&quot; Frankly I&#39;m amazed you haven&#39;t come across this in 15 years."}, {"owner": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1450283593, "post_id": 34316576, "comment_id": 56376373, "body": "95% of my &quot;VB&quot; coding over that time has been done in VB.NET where <a href=\"https://support.microsoft.com/en-us/kb/311333\" rel=\"nofollow noreferrer\">the lower bound for arrays is always zero</a>.  The fact that VBA (or possibly other flavors of VB) allows something other than zero is one of those quirky and esoteric features that is understandably lost in the shuffle."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1450283741, "post_id": 34316576, "comment_id": 56376494, "body": "It&#39;s <i>only</i> VB.Net that doesn&#39;t allow it. ;)"}], "tags": [], "owner": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "is_accepted": false, "score": 1, "last_activity_date": 1450284077, "last_edit_date": 1450284077, "creation_date": 1450281578, "answer_id": 34316576, "question_id": 34316328, "link": "https://stackoverflow.com/questions/34316328/subscript-out-of-range-when-using-array/34316576#34316576", "title": "&quot;Subscript out of range&quot; When Using Array", "body": "<p>Arrays are zero indexed (by default -- see comments below). The first element is \"0\", and you have to be careful when looping to the end of a collection via .Count. You want to end it at .Count - 1</p>\n\n<p>Change your code to something like this:</p>\n\n<pre><code>For seriesIterator = 0 To ActiveChart.SeriesCollection.Count - 1\n\n    Set s = ActiveChart.SeriesCollection(seriesIterator)\n        If s.Name = \"Active &gt;24 h\" Or s.Name = \"Active\" Then\n            s.Format.Fill.ForeColor.RGB = RGB(192, 80, 77) 'Red Accent 2 Light 80\n            ElseIf s.Name = \"Active &lt;24 h\" Or s.Name = \"New\" Then\n            s.Format.Fill.ForeColor.RGB = RGB(247, 150, 70) 'Orange\n            ElseIf s.Name = \"Pending Customer\" Then\n            s.Format.Fill.ForeColor.RGB = RGB(79, 129, 189) 'Blue\n            ElseIf s.Name = \"Pending Vendor\" Then\n            s.Format.Fill.ForeColor.RGB = RGB(128, 100, 162) 'Purple\n            ElseIf s.Name = \"Scheduled\" Then\n            s.Format.Fill.ForeColor.RGB = RGB(155, 187, 89) 'Green\n            ElseIf s.Name = \"Closed\" Or s.Name = \"Resolved\" Then\n            s.Format.Fill.ForeColor.RGB = RGB(148, 138, 84) 'Brown\n            ElseIf s.Name = \"Unassigned\" Then\n            s.Format.Fill.ForeColor.RGB = RGB(255, 192, 0) 'Yellow\n        End If\n\n    'Find the \"Grand Total\" datapoint in each series and hide it\n    For pointIterater = 0 To s.Points.Count - 1\n        If s.XValues(pointIterater) = \"Grand Total\" Then\n               s.Points(pointIterater).Interior.ColorIndex = xlNone\n        End If\n        teamTotal(pointIterator) = teamTotal(pointIterator) + s.Values(pointIterator)\n    Next pointIterater\nNext seriesIterator\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5687340, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156280558675175/picture?type=large", "display_name": "Kai", "link": "https://stackoverflow.com/users/5687340/kai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 450, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1450284077, "creation_date": 1450280930, "last_edit_date": 1450281775, "question_id": 34316328, "link": "https://stackoverflow.com/questions/34316328/subscript-out-of-range-when-using-array", "title": "&quot;Subscript out of range&quot; When Using Array", "body": "<p>I am new to VBA and encountered the Error 9 issue \"Subscript out of Range\" when trying to use an array to calculate the greatest value in a list of numbers. I have a stacked bar chart across several teams (as x-axis values) and categories (as series). For each team, there are numbers from each category (incident ticket status), and I want to find which team has the greatest number of tickets and use that info to format my bar chart. The problematic line of code is highlighted. I've read many previous threads about Error 9 and VBA arrays, but the issue remains. Could anyone give me a hint about what goes wrong in my code? I'll greatly appreciate it.</p>\n\n<pre><code>Sub ChangeByTeamChartColor()\n\nWorkbooks.Application.ActiveWorkbook.Sheets(\"By Team - Incident State\").Select\nActiveSheet.ChartObjects(\"By Team Chart\").Select\n\nDim s As Series\nDim teamTotal() As Integer\nDim seriesCount As Integer, seriesIterator As Integer, pointIterater As Integer\n**ReDim teamTotal(1 To ActiveChart.SeriesCollection(1).Points.Count)**\n\n'Iterate through series and set colors\nFor seriesIterator = 1 To ActiveChart.SeriesCollection.Count\n\n    Set s = ActiveChart.SeriesCollection(seriesIterator)\n        If s.Name = \"Active &gt;24 h\" Or s.Name = \"Active\" Then\n            s.Format.Fill.ForeColor.RGB = RGB(192, 80, 77) 'Red Accent 2 Light 80\n            ElseIf s.Name = \"Active &lt;24 h\" Or s.Name = \"New\" Then\n            s.Format.Fill.ForeColor.RGB = RGB(247, 150, 70) 'Orange\n            ElseIf s.Name = \"Pending Customer\" Then\n            s.Format.Fill.ForeColor.RGB = RGB(79, 129, 189) 'Blue\n            ElseIf s.Name = \"Pending Vendor\" Then\n            s.Format.Fill.ForeColor.RGB = RGB(128, 100, 162) 'Purple\n            ElseIf s.Name = \"Scheduled\" Then\n            s.Format.Fill.ForeColor.RGB = RGB(155, 187, 89) 'Green\n            ElseIf s.Name = \"Closed\" Or s.Name = \"Resolved\" Then\n            s.Format.Fill.ForeColor.RGB = RGB(148, 138, 84) 'Brown\n            ElseIf s.Name = \"Unassigned\" Then\n            s.Format.Fill.ForeColor.RGB = RGB(255, 192, 0) 'Yellow\n        End If\n\n    'Find the \"Grand Total\" datapoint in each series and hide it\n    For pointIterater = 1 To s.Points.Count\n        If s.XValues(pointIterater) = \"Grand Total\" Then\n               s.Points(pointIterater).Interior.ColorIndex = xlNone\n        End If\n' The following line gives the error ===================================\n        teamTotal(pointIterator) = teamTotal(pointIterator) + s.Values(pointIterator)\n' ========================================================================\n    Next pointIterater\nNext seriesIterator\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["excel", "excel-2010", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1450281119, "post_id": 34316182, "comment_id": 56374519, "body": "Use: <code>Cells(i, &quot;A&quot;)</code>. But note that it is much more efficient not to select obejcts in code to manipulate them - it is almost never necessary."}], "answers": [{"tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": false, "score": 0, "last_activity_date": 1450281098, "creation_date": 1450281098, "answer_id": 34316393, "question_id": 34316182, "link": "https://stackoverflow.com/questions/34316182/calling-out-specific-cells-like-a15-using-integer-i/34316393#34316393", "title": "Calling out specific cells like A15 using integer &#39;i&#39;", "body": "<p>Try concatenating the string and integer, as below:</p>\n\n<pre><code>Range(\"B\" &amp; i).Select\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 5687275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b425e6e5c31a57b10bbdd9042f1232fe?s=128&d=identicon&r=PG&f=1", "display_name": "J2LAW", "link": "https://stackoverflow.com/users/5687275/j2law"}, "edited": false, "score": 0, "creation_date": 1450283874, "post_id": 34316520, "comment_id": 56376601, "body": "Thank you for your input."}], "tags": [], "owner": {"reputation": 1570, "user_id": 3324507, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/653f2f879a98a201288ef32e6e344163?s=128&d=identicon&r=PG&f=1", "display_name": "sgp667", "link": "https://stackoverflow.com/users/3324507/sgp667"}, "is_accepted": false, "score": 1, "last_activity_date": 1450281431, "creation_date": 1450281431, "answer_id": 34316520, "question_id": 34316182, "link": "https://stackoverflow.com/questions/34316182/calling-out-specific-cells-like-a15-using-integer-i/34316520#34316520", "title": "Calling out specific cells like A15 using integer &#39;i&#39;", "body": "<p>I'm lost as to what are you trying to do but to it looks like you want to copy contents from 'WorkbookA.xlsm' to 'WorkbookB.xlsm'.</p>\n\n<pre><code>For i=16 to 19\n    Range(\"A\"&amp;i).Copy(Destination:=Workbooks(\"WorkbookB.xlsm\").Sheets().Range(\"C\"&amp;i))\nNext\n</code></pre>\n\n<p>That code will copy contents of A16:A19 in currently open worksheet to C16:C19 in first sheet of workbook 'WorkbookB.xlsm' </p>\n\n<p>Please elaborate on your problem and I'll give you more precise answer.</p>\n"}], "owner": {"reputation": 1, "user_id": 5687275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b425e6e5c31a57b10bbdd9042f1232fe?s=128&d=identicon&r=PG&f=1", "display_name": "J2LAW", "link": "https://stackoverflow.com/users/5687275/j2law"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 890, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1450379870, "creation_date": 1450280526, "last_edit_date": 1531164843, "question_id": 34316182, "link": "https://stackoverflow.com/questions/34316182/calling-out-specific-cells-like-a15-using-integer-i", "title": "Calling out specific cells like A15 using integer &#39;i&#39;", "body": "<p>How do you call out a specific cell in Excel 2010, like A5 or B5, when you are in a VBA loop?  </p>\n\n<p>At the top I have:</p>\n\n<pre><code>SubAA()\n\nDim i As Integer\n\nFor i = 16 To 19\n\nWindows(\"WorkbookA.xlsm\").Activate\nRange(\"(A,i)\").Select\nSelection.Copy\nWindows(\"WorkbookB.xlsm\").Activate\nRange(\"C14\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n\nWindows(\"WorkbookA.xlsm\").Activate\nRange(\"(B,i)\").Select\nSelection.Copy\nWindows(\"WorkbookB.xlsm\").Activate\nRange(\"C18\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False                 \n\nNext i    \n\nEnd Sub\n</code></pre>\n\n<p>There is an issue with <code>Range(\"A,i)\").Select</code>.</p>\n\n<p>I want to have this macro work for multiple rows, and just not one.  I had it working correctly for just row 15, where the command was <code>Range(\"A15\").Select</code>.</p>\n\n<p>I would actually love the macro to work until it reaches a blank row but this will do for now.  I will figure that out.</p>\n"}, {"tags": ["mysql", "vba", "excel"], "comments": [{"owner": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "edited": false, "score": 1, "creation_date": 1450280380, "post_id": 34315972, "comment_id": 56373918, "body": "It sounds like you are just looking for the <code>CountIf</code> function?  Something like <code>=COUNTIF(N:N,O2)</code> copied down?"}, {"owner": {"reputation": 17, "user_id": 4775461, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f941a4f3881a600cf969e7f7449ceca1?s=128&d=identicon&r=PG&f=1", "display_name": "joel", "link": "https://stackoverflow.com/users/4775461/joel"}, "edited": false, "score": 0, "creation_date": 1450290008, "post_id": 34315972, "comment_id": 56380238, "body": "Hello - Demetri and - pnuts. I know how to use the countif function, but only familiar with writing a formula that would give a total for the a country in the cell where I am writing the formula."}, {"owner": {"reputation": 17, "user_id": 4775461, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f941a4f3881a600cf969e7f7449ceca1?s=128&d=identicon&r=PG&f=1", "display_name": "joel", "link": "https://stackoverflow.com/users/4775461/joel"}, "edited": false, "score": 0, "creation_date": 1450290344, "post_id": 34315972, "comment_id": 56380453, "body": "Hello - Demetri and - pnuts. I know how to use the countif function, but only familiar with writing a formula that would give a total for the country in the cell where I am writing the formula. Example: In picture two I would write the formula in cell P2 (=countif(sheet1!N2:N25000). That isn&#39;t what I want, since I would have to edit the formula 64 times for each country. What I want is a formula, or macro give me a total for all 64 countries and insert the total on the cell(s) related to each country."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 4775461, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f941a4f3881a600cf969e7f7449ceca1?s=128&d=identicon&r=PG&f=1", "display_name": "joel", "link": "https://stackoverflow.com/users/4775461/joel"}, "edited": false, "score": 0, "creation_date": 1450450974, "post_id": 34320322, "comment_id": 56458381, "body": "Danno161 and Demetri. Thanks for update! :) I found that I had pasted the wrong column. When I tried to use it on the correct column, the formula didn&#39;t work. I have edited and added the correct picture. I want to compare column I and N and write the formula in column O and have the results in that column. I am trying to find the same thing that I stated originally on this post, but the extra commas and abbreviated cities next to the country are not giving me any results on the previous formula you were so kind to assist me. Please assist and again, thanks!"}, {"owner": {"reputation": 409, "user_id": 3657636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c62d4f70225e69fc19ac2bdf980e9014?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/3657636/dan"}, "reply_to_user": {"reputation": 17, "user_id": 4775461, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f941a4f3881a600cf969e7f7449ceca1?s=128&d=identicon&r=PG&f=1", "display_name": "joel", "link": "https://stackoverflow.com/users/4775461/joel"}, "edited": false, "score": 0, "creation_date": 1450453264, "post_id": 34320322, "comment_id": 56459820, "body": "Simply change your formula to &#39;=COUNTIF(N:N, &quot;<i>&quot; &amp; O2 &amp; &quot;</i>&quot;)&#39; for the locationname column. Putting the asterisk in quotations before and after the cell address allows you to find cells that contain what you are searching for, rather than requiring an exact match.   By not giving specific information on what &quot;Total Number of Good Users&quot; implies in column O, it is difficult to tell what you are trying to do with it. Does compare mean add them together? Subtract one from the other? You need to be more specific."}, {"owner": {"reputation": 409, "user_id": 3657636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c62d4f70225e69fc19ac2bdf980e9014?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/3657636/dan"}, "reply_to_user": {"reputation": 17, "user_id": 4775461, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f941a4f3881a600cf969e7f7449ceca1?s=128&d=identicon&r=PG&f=1", "display_name": "joel", "link": "https://stackoverflow.com/users/4775461/joel"}, "edited": false, "score": 0, "creation_date": 1450453673, "post_id": 34320322, "comment_id": 56460091, "body": "=COUNTIF(N:N, &#39;&#39; * &#39;&#39; &amp; O2 &amp; &#39;&#39; * &#39;&#39;) is the correct formula (no spacing between the quotation marks and asterisk), the previous comment interpreted it as formatting  If you are trying to add or subtract results within a cell, simply add another COUNTIF statement after the first. =COUNTIF(N:N, &#39;&#39; * &#39;&#39; &amp; O2 &amp; &#39;&#39; * &#39;&#39;) + COUNTIF..."}, {"owner": {"reputation": 17, "user_id": 4775461, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f941a4f3881a600cf969e7f7449ceca1?s=128&d=identicon&r=PG&f=1", "display_name": "joel", "link": "https://stackoverflow.com/users/4775461/joel"}, "edited": false, "score": 0, "creation_date": 1450465671, "post_id": 34320322, "comment_id": 56466852, "body": "@Danno161...I tried your recommendation and it returned a value of 0. I added the cell numbers next to the column letter and still wouldn&#39;t work. What could be the problem??? :("}], "tags": [], "owner": {"reputation": 409, "user_id": 3657636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c62d4f70225e69fc19ac2bdf980e9014?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/3657636/dan"}, "is_accepted": false, "score": 0, "last_activity_date": 1450293572, "creation_date": 1450293572, "answer_id": 34320322, "question_id": 34315972, "link": "https://stackoverflow.com/questions/34315972/create-macro-to-count-specific-words-in-column-and-insert-total-in-another-cell/34320322#34320322", "title": "Create macro to count specific words in column and insert total in another cell", "body": "<p>Unfortunately my reputation isn't high enough to embed the images in this post, so I regretfully provided the links to the images instead. Apologies for this temporary inconvenience.</p>\n\n<p>The comment by Demetri is correct on how to do this with a function. You won't have to edit the formula 64 times. I'll explain it with pictures (keep in mind my table data is different because I do not have the full table) .</p>\n\n<ol>\n<li><p>The formula Demetri provided is shown in the formula bar, and as you can see it returns the number of times 'Cyprus' appears in column N. The O2 portion of the formula is referencing the country you are counting in column O. </p></li>\n<li><p>See the small black square that appears when the cell P2 is selected (as indicated by the red box)? If you click and drag this, it will carry your formula down the column.</p></li>\n</ol>\n\n<p><a href=\"http://i.imgur.com/BAVYbCz.png\" rel=\"nofollow\">http://i.imgur.com/BAVYbCz.png</a></p>\n\n<ol start=\"3\">\n<li>The formula has been edited automatically by Excel down the column to take the country directly to the left of the \"Total Good Users\" column and search for the number of times it occurs in column N. If you select P4 as shown in the picture, the O2 has been changed to O4 (as highlighted by the red box).</li>\n</ol>\n\n<p><a href=\"http://i.imgur.com/qp31vdM.png\" rel=\"nofollow\">http://i.imgur.com/qp31vdM.png</a></p>\n\n<p>Simply drag this formula all the way down until the last country and it'll edit the formula for each country automatically.</p>\n"}], "owner": {"reputation": 17, "user_id": 4775461, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f941a4f3881a600cf969e7f7449ceca1?s=128&d=identicon&r=PG&f=1", "display_name": "joel", "link": "https://stackoverflow.com/users/4775461/joel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 311, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1450465557, "creation_date": 1450279913, "last_edit_date": 1450465557, "question_id": 34315972, "link": "https://stackoverflow.com/questions/34315972/create-macro-to-count-specific-words-in-column-and-insert-total-in-another-cell", "title": "Create macro to count specific words in column and insert total in another cell", "body": "<p>I am trying to create a formula(s) or macro that would help me do the following:</p>\n\n<ol>\n<li>Count how many times a country name appears in a specific column</li>\n<li>Then add the total of how many times it appeared in that specific column</li>\n<li>Finally insert the total of the previous step into the neighboring column/row</li>\n</ol>\n\n<p>Below I have inserted 2 pictures.</p>\n\n<p>The 2nd picture will show a snippet of the spreadsheet with the countries.\nThe 1st shows a snippet of a table with the country and total users I would like to insert the totals. The table is next to the country column.</p>\n\n<p>Please assist since I am having to do this for 64 countries with over 25,000 rows.</p>\n\n<p><img src=\"https://i.stack.imgur.com/65pFT.png\" alt=\"enter image description here\"></p>\n\n<p><img src=\"https://i.stack.imgur.com/FjlZj.png\" alt=\"enter image description here\"></p>\n\n<p>UPDATE!!!!</p>\n\n<p>below are the results from your recommendation of how to setup the formula. Doesn't seem to be working. I tried to add the cell numbers next to column letter but still no dice.</p>\n\n<p>Both pictures are shown below.</p>\n\n<p><a href=\"https://i.stack.imgur.com/I2TIq.png\" rel=\"nofollow noreferrer\">enter image description here</a>\n<a href=\"https://i.stack.imgur.com/mxblT.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4897, "user_id": 1188357, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/cKQ6S.png?s=128&g=1", "display_name": "Kiril", "link": "https://stackoverflow.com/users/1188357/kiril"}, "edited": false, "score": 0, "creation_date": 1450279437, "post_id": 34315734, "comment_id": 56373238, "body": "try something like: <code>Shell(&quot;C:\\Temp\\gc.exe 1&quot;, vbNormalFocus)</code>"}, {"owner": {"reputation": 949, "user_id": 4210110, "user_type": "registered", "accept_rate": 92, "profile_image": "https://lh5.googleusercontent.com/-V_sAK37z25M/AAAAAAAAAAI/AAAAAAAABsg/kzDEZOpn-UM/photo.jpg?sz=128", "display_name": "Juanjo Salvador", "link": "https://stackoverflow.com/users/4210110/juanjo-salvador"}, "edited": false, "score": 0, "creation_date": 1450279837, "post_id": 34315734, "comment_id": 56373530, "body": "Mmm... I think you can do all from VisualBasic without call a ruby script"}, {"owner": {"reputation": 765, "user_id": 5135716, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NEEN9.jpg?s=128&g=1", "display_name": "RealCheeseLord", "link": "https://stackoverflow.com/users/5135716/realcheeselord"}, "edited": false, "score": 1, "creation_date": 1450280205, "post_id": 34315734, "comment_id": 56373791, "body": "I tried <code>Shell(&quot; ruby C:\\Folder1\\dostuff.rb  file1.csv file2.csv&quot; )</code>"}, {"owner": {"reputation": 4897, "user_id": 1188357, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/cKQ6S.png?s=128&g=1", "display_name": "Kiril", "link": "https://stackoverflow.com/users/1188357/kiril"}, "edited": false, "score": 0, "creation_date": 1450280317, "post_id": 34315734, "comment_id": 56373878, "body": "@Conny are file1 and file2 in the same directory as your excel sheet? Maybe you should fully qualified name"}, {"owner": {"reputation": 765, "user_id": 5135716, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NEEN9.jpg?s=128&g=1", "display_name": "RealCheeseLord", "link": "https://stackoverflow.com/users/5135716/realcheeselord"}, "reply_to_user": {"reputation": 4897, "user_id": 1188357, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/cKQ6S.png?s=128&g=1", "display_name": "Kiril", "link": "https://stackoverflow.com/users/1188357/kiril"}, "edited": false, "score": 1, "creation_date": 1450280432, "post_id": 34315734, "comment_id": 56373964, "body": "@Kiril damn you are right, I forgot to add C:\\Folder1\\ to the files.... Thank you"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1450283550, "post_id": 34315734, "comment_id": 56376349, "body": "Welcome to Stack Overflow. Please read &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; and &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>&quot;. When asking you need to show where you&#39;ve searched and why it didn&#39;t help, and preferably what you&#39;ve tried. We expect evidence of trying to solve the problem yourself. We want to help you, but we don&#39;t want to do the work for you."}], "answers": [{"tags": [], "owner": {"reputation": 4897, "user_id": 1188357, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/cKQ6S.png?s=128&g=1", "display_name": "Kiril", "link": "https://stackoverflow.com/users/1188357/kiril"}, "is_accepted": true, "score": 1, "last_activity_date": 1450280714, "last_edit_date": 1450280714, "creation_date": 1450280597, "answer_id": 34316209, "question_id": 34315734, "link": "https://stackoverflow.com/questions/34315734/run-ruby-script-through-vba/34316209#34316209", "title": "Run ruby script through vba", "body": "<p>The comment section made it clear: fully qualify your parameters, if they are files, and the files are not in the same directory as your Excel sheet.</p>\n\n<pre><code>Shell(\"ruby C:\\Folder\\dostuff.rb C:\\Folder\\file1.csv C:\\Folder\\file2.csv\", vbNormalFocus)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "is_accepted": false, "score": 1, "last_activity_date": 1501585092, "last_edit_date": 1501585092, "creation_date": 1501584581, "answer_id": 45435789, "question_id": 34315734, "link": "https://stackoverflow.com/questions/34315734/run-ruby-script-through-vba/45435789#45435789", "title": "Run ruby script through vba", "body": "<p>Sometimes you need to use the environment variable comspec to successfully launch external program from VBA.   <a href=\"https://exceldevelopmentplatform.blogspot.co.uk/search?q=comspec\" rel=\"nofollow noreferrer\">See these blog search result for examples.</a></p>\n"}, {"tags": [], "owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "is_accepted": false, "score": 1, "last_activity_date": 1501629148, "last_edit_date": 1501629148, "creation_date": 1501587507, "answer_id": 45436771, "question_id": 34315734, "link": "https://stackoverflow.com/questions/34315734/run-ruby-script-through-vba/45436771#45436771", "title": "Run ruby script through vba", "body": "<p>There are multiple ways to run a ruby script with VBA.</p>\n\n<p>With <a href=\"https://support.office.com/en-gb/article/Shell-Function-ff2e4b1b-712d-4e34-aea6-6832eadd3c63\" rel=\"nofollow noreferrer\">Shell</a>, asynchronous with console:</p>\n\n<pre><code>Public Sub RunRuby(file As String, ParamArray args())\n  Shell \"ruby.exe \"\"\" &amp; file &amp; \"\"\" \" &amp; Join(args, \" \")\nEnd Sub\n</code></pre>\n\n<p>With <a href=\"https://support.office.com/en-gb/article/Shell-Function-ff2e4b1b-712d-4e34-aea6-6832eadd3c63\" rel=\"nofollow noreferrer\">Shell</a>, synchronous without console:</p>\n\n<pre><code>Public Sub RunRuby(file As String, ParamArray args())\n  Shell \"rubyw.exe \"\"\" &amp; file &amp; \"\"\" \" &amp; Join(args, \" \")\nEnd Function\n</code></pre>\n\n<p>With <a href=\"https://msdn.microsoft.com/en-us/subscriptions/d5fk67ky(v=vs.84).aspx\" rel=\"nofollow noreferrer\">WScript.Shell</a>, synchronous without console and with exit code:</p>\n\n<pre><code>Public Function RunRuby(file As String, ParamArray args()) As Long\n  Dim obj As Object\n  Set obj = CreateObject(\"WScript.Shell\")\n  RunRuby = obj.Run(\"rubyw.exe \"\"\" &amp; file &amp; \"\"\" \" &amp; Join(args, \" \"), 0, True)\nEnd Function\n</code></pre>\n\n<p>And to set the working directory in case there's a relative path:</p>\n\n<pre><code>ChDir \"C:\\Folder1\"\n</code></pre>\n\n<p>, or with the folder of the current workbook:</p>\n\n<pre><code>ChDir ThisWorkbook.Path\n</code></pre>\n"}], "owner": {"reputation": 765, "user_id": 5135716, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NEEN9.jpg?s=128&g=1", "display_name": "RealCheeseLord", "link": "https://stackoverflow.com/users/5135716/realcheeselord"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1066, "favorite_count": 1, "accepted_answer_id": 34316209, "answer_count": 3, "score": 4, "last_activity_date": 1501629148, "creation_date": 1450279260, "last_edit_date": 1531164843, "question_id": 34315734, "link": "https://stackoverflow.com/questions/34315734/run-ruby-script-through-vba", "title": "Run ruby script through vba", "body": "<p>Is there a way to start a Ruby script from through an Excel macro?</p>\n\n<p>The macro creates two CSV files and I would like to automate the procss of running</p>\n\n<pre><code>ruby dostuff.rb file1.csv file2.csv\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 69, "user_id": 2572477, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/LtvEp.jpg?s=128&g=1", "display_name": "hschokker", "link": "https://stackoverflow.com/users/2572477/hschokker"}, "edited": false, "score": 0, "creation_date": 1450279403, "post_id": 34315693, "comment_id": 56373203, "body": "Updated it in my inital post, run-time error 1004. It is usually generated when something is wrong with the formula. For example      ActiveSheet.Cells(1,2).Formula = &quot;=2+(3*4&quot; Will generate the same error because a final ) is missing."}, {"owner": {"reputation": 69, "user_id": 2572477, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/LtvEp.jpg?s=128&g=1", "display_name": "hschokker", "link": "https://stackoverflow.com/users/2572477/hschokker"}, "edited": false, "score": 0, "creation_date": 1450279825, "post_id": 34315693, "comment_id": 56373519, "body": "I see the FormulaArray works with the R1C1 style of cell naming, I will give it a try tomorrow. (<a href=\"https://msdn.microsoft.com/en-us/library/office/ff837104.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff837104.aspx</a>)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 4, "creation_date": 1450279915, "post_id": 34315693, "comment_id": 56373586, "body": "Use commas. I know your system uses a semi-colon list separator but VBA wants EN-US commas when putting a formula into a cell."}], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1450284188, "post_id": 34315880, "comment_id": 56376793, "body": "Just a FYI,  From the remarks <a href=\"https://msdn.microsoft.com/en-us/library/office/ff837104.aspx\" rel=\"nofollow noreferrer\">here</a>; <code>If you use this property to enter an array formula, the formula must use the R1C1 reference style, not the A1 reference style (see the second example).</code>"}], "tags": [], "owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "is_accepted": false, "score": 1, "last_activity_date": 1450284295, "last_edit_date": 1450284295, "creation_date": 1450279647, "answer_id": 34315880, "question_id": 34315693, "link": "https://stackoverflow.com/questions/34315693/writing-formula-in-cell-gives-error-although-formula-is-correct/34315880#34315880", "title": "Writing formula in cell gives error although formula is correct", "body": "<p>My bet is because it's an array formula, you should use the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff837104.aspx\" rel=\"nofollow\">FormulaArray</a> property.</p>\n\n<pre><code>ActiveSheet.Cells(Row + 3, Column + i).FormulaArray = \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 69, "user_id": 2572477, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/LtvEp.jpg?s=128&g=1", "display_name": "hschokker", "link": "https://stackoverflow.com/users/2572477/hschokker"}, "is_accepted": false, "score": 1, "last_activity_date": 1450425827, "creation_date": 1450425827, "answer_id": 34350980, "question_id": 34315693, "link": "https://stackoverflow.com/questions/34315693/writing-formula-in-cell-gives-error-although-formula-is-correct/34350980#34350980", "title": "Writing formula in cell gives error although formula is correct", "body": "<p>Jeeped gave the correct answer to my problem, replace the semi-colon list seperators with EN-US commas. Below actually works without a problem:</p>\n\n<pre><code>ActiveSheet.Cells(Row + 3, Column + i).Formula = \"=SUMPRODUCT(--(OFFSET(endResourceNaam,2,0):OFFSET(endResourceNaam,1000,0)=$A\" &amp; Row + 1 &amp; \"),--(OFFSET(endResourceNaam,2,4):OFFSET(endResourceNaam,1000,4)=$E\" &amp; Row + 1 &amp; \"),OFFSET(endResourceWeek,2,\" &amp; ColumnLetter(Column - 1) &amp; \"$1):OFFSET(endResourceWeek,1000,\" &amp; ColumnLetter(Column - 1) &amp; \"$1))\"\n</code></pre>\n\n<p>I have not tried the FormulaArray method since this already solved my problem. </p>\n"}], "owner": {"reputation": 69, "user_id": 2572477, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/LtvEp.jpg?s=128&g=1", "display_name": "hschokker", "link": "https://stackoverflow.com/users/2572477/hschokker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1450425827, "creation_date": 1450279151, "last_edit_date": 1450283179, "question_id": 34315693, "link": "https://stackoverflow.com/questions/34315693/writing-formula-in-cell-gives-error-although-formula-is-correct", "title": "Writing formula in cell gives error although formula is correct", "body": "<p>I am using VBA to write formulas in an MS Excel sheet. When I copy the formula to the cell manually it works but when I use the line below it gives me a run-time error:  </p>\n\n<blockquote>\n  <p>'1004': Application-defined or object-defined error.</p>\n</blockquote>\n\n<pre><code>ActiveSheet.Cells(Row + 3, Column + i).Formula = \"=SUMPRODUCT(--(OFFSET(endResourceNaam;2;0):OFFSET(endResourceNaam;1000;0)=$A\" &amp; Row + 1 &amp; \");--(OFFSET(endResourceNaam;2;4):OFFSET(endResourceNaam;1000;4)=$E\" &amp; Row + 1 &amp; \");OFFSET(endResourceWeek;2;\" &amp; ColumnLetter(Column - 1) &amp; \"$1):OFFSET(endResourceWeek;1000;\" &amp; ColumnLetter(Column - 1) &amp; \"$1))\"\n</code></pre>\n\n<p>The (first in loop) string generated is:</p>\n\n<pre><code>=SUMPRODUCT(--(OFFSET(endResourceNaam;2;0):OFFSET(endResourceNaam;1000;0)=$A6);--(OFFSET(endResourceNaam;2;4):OFFSET(endResourceNaam;1000;4)=$E6);OFFSET(endResourceWeek;2;O$1):OFFSET(endResourceWeek;1000;O$1))\n</code></pre>\n\n<p>I tested the formula by printing it from the VBA code and than copy/pasta that to the cell. That way I know for certain that the generated string is actually correct. From what I have learned there is some kind of protection build into VBA that makes sure that when I try to write a formula the formula is correct and working. There might be something in that protection that is keeping me from writing the formula to a cell.</p>\n\n<p>Is there any solution for me to write the desired formula to a cell using VBA?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 1, "last_activity_date": 1450279383, "creation_date": 1450279383, "answer_id": 34315781, "question_id": 34315617, "link": "https://stackoverflow.com/questions/34315617/how-do-i-set-a-formula-in-a-cell-using-r1c1-notation-from-variables/34315781#34315781", "title": "How do I set a formula in a cell using R1C1 notation from variables?", "body": "<p>Assuming <code>wsCalc</code> is a reference to a range of cells:</p>\n\n<pre><code>wscalc.FormulaR1C1 = \"=IF(ISBLANK(RC1),\"\"\"\",\"\"SELECT\"\")\"\n</code></pre>\n\n<p>As a working example:</p>\n\n<pre><code>Sub Test()\n\n    ThisWorkbook.Worksheets(\"Sheet1\").Range(\"B1:B10\").FormulaR1C1 = \"=IF(ISBLANK(RC1),\"\"\"\",\"\"SELECT\"\")\"\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 713, "user_id": 5649582, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh4.googleusercontent.com/-HUnVeS74mpQ/AAAAAAAAAAI/AAAAAAAADMQ/VxQa9JFJLKw/photo.jpg?sz=128", "display_name": "Andrew Perry", "link": "https://stackoverflow.com/users/5649582/andrew-perry"}, "edited": false, "score": 0, "creation_date": 1450280098, "post_id": 34315806, "comment_id": 56373710, "body": "Ah, good catch - sorry, it would be all in the same row and the formula would (in this example) be going in B2. Fixed now, thanks. And the code there works nicely, too."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 3, "last_activity_date": 1450279458, "creation_date": 1450279458, "answer_id": 34315806, "question_id": 34315617, "link": "https://stackoverflow.com/questions/34315617/how-do-i-set-a-formula-in-a-cell-using-r1c1-notation-from-variables/34315806#34315806", "title": "How do I set a formula in a cell using R1C1 notation from variables?", "body": "<p>It depends on what the <code>iImportCounter</code> starts at. If it is <strong>3</strong> (<em>row 3</em> in B3) then the formula would be,</p>\n\n<pre><code>with wsCalc.Cells(iImportCounter, 3)\n    .FormulaR1C1 = \"=IF(ISBLANK(R[-1]C1), \"\"\"\", \"\"SELECT\"\")\nend with\n</code></pre>\n\n<p>The <strong>R</strong> in <strong>RC1</strong> means the same row that you are putting the formula on so if you are putting on row 2 and you want to reference A2 then <strong>R</strong> is all you need. If the formula is going into B3 then you need to reference the current row minus 1 with <strong>R[-1]C1</strong>.</p>\n\n<p>The <strong>C1</strong> in <strong>RC1</strong> means a 'locked' (<em>absolute</em>) column A (the <em>first</em> column). This doesn't seem absolutely necessary as the formula does not travel laterally.</p>\n"}], "owner": {"reputation": 713, "user_id": 5649582, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh4.googleusercontent.com/-HUnVeS74mpQ/AAAAAAAAAAI/AAAAAAAADMQ/VxQa9JFJLKw/photo.jpg?sz=128", "display_name": "Andrew Perry", "link": "https://stackoverflow.com/users/5649582/andrew-perry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1310, "favorite_count": 0, "accepted_answer_id": 34315781, "answer_count": 2, "score": 0, "last_activity_date": 1450285791, "creation_date": 1450278953, "last_edit_date": 1450285791, "question_id": 34315617, "link": "https://stackoverflow.com/questions/34315617/how-do-i-set-a-formula-in-a-cell-using-r1c1-notation-from-variables", "title": "How do I set a formula in a cell using R1C1 notation from variables?", "body": "<p>I've got a series of IF/ELSE clauses to see if items fit into one of three categories. If an item doesn't fit into any of them, its category field should simply read \"SELECT\".</p>\n\n<p>Now, with simple text strings it works fine. But I also want to include a simple formula (as in most of the other autopopulated fields in the sheet) to blank the field if it's on an empty line. Based on the code I've used in other cases, I would want to set the cell's formula to</p>\n\n<pre><code>=IF(ISBLANK($A2, \"\", \"SELECT\")\n</code></pre>\n\n<p>(...where the cell itself is B2)</p>\n\n<p>Problem is, the cell to look at will depend on which line it's on; A2, A3, A4 and so on. The column number remains constant, but the row number is defined by the variable <code>iImportCounter</code>.</p>\n\n<p>I've tried both <code>.Value</code> and <code>.Formula</code>, both <code>\"\"\"</code> and <code>Chr(34)</code>, and it still doesn't seem to work. The full code for that line as it stands is</p>\n\n<pre><code>Else:\n    wsCalc.Cells(iImportCounter, 3).Formula = \"=IF(ISBLANK($\" &amp; Application.ConvertFormula(Cells(iImportCounter, 2), xlA1) &amp; \", \" &amp; Chr(34) &amp; Chr(34) &amp; \", \" &amp; Chr(34) &amp; \"SELECT\" &amp; Chr(34) &amp; \")\"\n</code></pre>\n\n<p>Is there something terribly obvious I'm missing?  </p>\n\n<p>I've seen comments elsewhere that the fact that it's in a module rather than a sheet-based macro could make some of that code malfunction, but I'm not sure what or how.</p>\n"}, {"tags": ["python", "vba", "win32com"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1450286442, "post_id": 34315429, "comment_id": 56378148, "body": "When having a problem with code it&#39;s best to post the code.  You should know however that when Excel is opened using automation, add-ins (such as e.g. Solver) do not load by default: you will need to load it using your code. See:  <a href=\"https://support.microsoft.com/en-us/kb/213489\" rel=\"nofollow noreferrer\">support.microsoft.com/en-us/kb/213489</a>"}, {"owner": {"reputation": 1271, "user_id": 5016733, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-ss2XPAHqlYQ/AAAAAAAAAAI/AAAAAAAAAsc/uQeBOZ0C0KM/photo.jpg?sz=128", "display_name": "athlonshi", "link": "https://stackoverflow.com/users/5016733/athlonshi"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1450290580, "post_id": 34315429, "comment_id": 56380601, "body": "Thanks. According to your link, I tried to add x1.Workbooks.Open(Filename=&quot;C:\\Program Files (x86)\\Microsoft Office\\Office14\\Library\\SOLVER\\SOLVER.XLAM&quot;) to my code, and it works now."}], "owner": {"reputation": 1271, "user_id": 5016733, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-ss2XPAHqlYQ/AAAAAAAAAAI/AAAAAAAAAsc/uQeBOZ0C0KM/photo.jpg?sz=128", "display_name": "athlonshi", "link": "https://stackoverflow.com/users/5016733/athlonshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 436, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1450290248, "creation_date": 1450278356, "last_edit_date": 1450290248, "question_id": 34315429, "link": "https://stackoverflow.com/questions/34315429/python-win32com-client-run-can-not-find-solver-xlam", "title": "Python win32com.client run can not find solver.xlam", "body": "<p>I was trying to use win32com.client to connect an Excel 2010 workbook and run its VBA macro. The macro uses the Excel solver.xlam. There is no problem running the Macro from Excel. But when using win32com.client to run the Macro, it terminated with error message saying the Macro cannot find solver.xlam. The file path shown in the dialog window is just my personal default folder, which is wrong. Anyone has a clue? Thanks!</p>\n\n<p>Here is the code sample</p>\n\n<pre><code>import win32com.client\n\nx1 = win32com.client.Dispatch(\"Excel.Application\")\nx1.Visible = False\nx1.Workbooks.Open(Filename=\"Macro.xlsm\")\nx1.Application.Run(\"Macro.xlsm!Module1.Prediction\")\nx1.DisplayAlerts = False\nx1.Application.Quit()\ndel x1\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 0, "last_activity_date": 1450278352, "creation_date": 1450278352, "answer_id": 34315428, "question_id": 34315017, "link": "https://stackoverflow.com/questions/34315017/loop-to-copy-results-of-filtered-table/34315428#34315428", "title": "Loop to copy results of filtered table", "body": "<p>Try this :</p>\n\n<pre><code>Sub EnvoiPlanning()\n    'Sheets(\"People\").Range(\"B:B\").RemoveDuplicates Columns:=1, Header:= _\n        xlYes\n    Dim i As Integer, _\n        Ws As Worksheet\n    i = 2\n    While Sheets(\"People\").Cells(i, 1) &lt;&gt; \"\"\n        Sheets(\"Data\").Range(\"A:O\").AutoFilter Field:=2, Criteria1:=Sheets(\"People\").Cells(i, 1).Value\n        Sheets(\"Data\").Range(\"A:F\").Copy\n        Set Ws = Sheets.Add(After:=Sheets(Sheets.Count))\n        Ws.Range(\"A1\").PasteSpecial Paste:=xlPasteValues, _\n                                Operation:=xlNone, _\n                                SkipBlanks:=False, _\n                                Transpose:=False\n        Ws.Name = Sheets(\"People\").Cells(2, 1).Value\n        i = i + 1\n    Wend\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5687156, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153306456880959/picture?type=large", "display_name": "Florian AroundtheWorld", "link": "https://stackoverflow.com/users/5687156/florian-aroundtheworld"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1450283856, "creation_date": 1450277225, "last_edit_date": 1450283856, "question_id": 34315017, "link": "https://stackoverflow.com/questions/34315017/loop-to-copy-results-of-filtered-table", "title": "Loop to copy results of filtered table", "body": "<p>I'm working on a work schedule, where I have a list of employees name and a flat table with everyone schedule per day. My macro should for each employee filter the data, copy it and paste it in a new sheet with his/her name.</p>\n\n<pre><code>Sub EnvoiPlanning()\n    'Sheets(\"People\").Range(\"B:B\").RemoveDuplicates Columns:=1, Header:= _\n        xlYes\n    Dim i As Integer\n    i = 2\n    While Sheets(\"People\").Cells(i, 1) &lt;&gt; \"\"\n        Sheets(\"Data\").Range(\"A:O\").AutoFilter Field:=2, Criteria1:=Sheets(\"People\").Cells(i, 1).Value\n        Sheets(\"Data\").Range(\"A:F\").Select\n        Selection.Copy\n        Sheets.Add After:=Sheets(Sheets.Count)\n        Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n            :=False, Transpose:=False\n        Sheets(Sheets.Count).Name = Sheets(\"People\").Cells(2, 1).Value\n        i = i + 1\n    Wend\nEnd Sub\n</code></pre>\n\n<p>There is error:  </p>\n\n<blockquote>\n  <p>Run-time error '1004': Select method of Range class failed  </p>\n</blockquote>\n\n<p>on the second instruction of the loop after the first iteration.</p>\n\n<p><img src=\"https://i.stack.imgur.com/62HNz.png\" alt=\"Exception screenshot\"></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 5629294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/baf30c050eedcd0aac8704ea78a06aaa?s=128&d=identicon&r=PG&f=1", "display_name": "Nallatheryth", "link": "https://stackoverflow.com/users/5629294/nallatheryth"}, "edited": false, "score": 0, "creation_date": 1450425751, "post_id": 34316022, "comment_id": 56443463, "body": "Thank you sir (apologies for the late answer)  Let me test and get back shortly !"}, {"owner": {"reputation": 7, "user_id": 5629294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/baf30c050eedcd0aac8704ea78a06aaa?s=128&d=identicon&r=PG&f=1", "display_name": "Nallatheryth", "link": "https://stackoverflow.com/users/5629294/nallatheryth"}, "edited": false, "score": 0, "creation_date": 1450426374, "post_id": 34316022, "comment_id": 56443772, "body": "Hello Demetri,   THANK YOU! It works perfectly. I modified it a little bit in order to include a wider range of possibilities (and succeded mind you) to the following   <code>If UCase(Sheets(&quot;DebitCard_Check&quot;).Range(&quot;G&quot; &amp; i).Value) Like &quot;*TAX*&quot; Then GoTo Skip1</code>      If I understood correctly as I dislike just copy pasting but also learning (its not the idea that someone else would write these for me everytime)    The actual block of code that executes the loop starts from my original <code>Do While</code> part.   end ends with <code>End Sub</code>"}, {"owner": {"reputation": 7, "user_id": 5629294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/baf30c050eedcd0aac8704ea78a06aaa?s=128&d=identicon&r=PG&f=1", "display_name": "Nallatheryth", "link": "https://stackoverflow.com/users/5629294/nallatheryth"}, "edited": false, "score": 0, "creation_date": 1450426609, "post_id": 34316022, "comment_id": 56443909, "body": "Therefore, in order to include a pre--cursor/filter that will command and direct the code, I had to include the bit before the begining of that loop. I hope I am correct.   I was aiming at the same thing but failing because it seems my syntax naturally goes to C# and refused to wrap around VBA. Do you know of a good solid place where summarized I might find a good sheet with syntax for VBA?   Other than the above -&gt; THANK YOU! It is just what I was looking for."}, {"owner": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "reply_to_user": {"reputation": 7, "user_id": 5629294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/baf30c050eedcd0aac8704ea78a06aaa?s=128&d=identicon&r=PG&f=1", "display_name": "Nallatheryth", "link": "https://stackoverflow.com/users/5629294/nallatheryth"}, "edited": false, "score": 0, "creation_date": 1450453039, "post_id": 34316022, "comment_id": 56459677, "body": "That&#39;s funny as I have similar difficulties understanding c#, because my mind naturally goes to VBA.  I&#39;m sorry that I don&#39;t know a place where you would necessarily find what you need, but here are two links to at least get you started: <a href=\"https://msdn.microsoft.com/en-us/library/office/ee814737%28v=office.14%29.aspx\" rel=\"nofollow noreferrer\">link</a> <a href=\"http://www.rondebruin.nl\" rel=\"nofollow noreferrer\">link</a>  Good luck!"}, {"owner": {"reputation": 7, "user_id": 5629294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/baf30c050eedcd0aac8704ea78a06aaa?s=128&d=identicon&r=PG&f=1", "display_name": "Nallatheryth", "link": "https://stackoverflow.com/users/5629294/nallatheryth"}, "edited": false, "score": 0, "creation_date": 1450529919, "post_id": 34316022, "comment_id": 56483611, "body": "This is great! The links are actually awesome. And yeah, switching between languages is usually something super easy but when you are not familiar with the new language - goes from bad to worst :D"}], "tags": [], "owner": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "is_accepted": true, "score": 0, "last_activity_date": 1450280070, "creation_date": 1450280070, "answer_id": 34316022, "question_id": 34315011, "link": "https://stackoverflow.com/questions/34315011/how-to-modify-the-subsequent-code-to-obtain-a-condition-based-on-which-the-rest/34316022#34316022", "title": "How to modify the subsequent code to obtain a condition based on which the rest is executed:", "body": "<p>I believe the modification you are requesting is incorporated below (see asterisks &amp; ensuing comments for explanation):</p>\n\n<pre><code>Sub Categories_Update()\n\nDim lastrow As Long, lastrow2 As Long\nDim i As Integer, j As Integer\nDim PatternFound As Boolean\n\nCall speedup\n\nlastrow = Sheets(\"Rules\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nlastrow2 = Sheets(\"DebitCard_Check\").Range(\"L\" &amp; Rows.Count).End(xlUp).Row\n\nFor i = 4 To lastrow2\n\n    ' *** I think this is what you are trying to insert, a conditional that causes the row to get skipped based on\n    'column G being \"TAX\" - this conditional sends it to the part \"Skip1\" (you can call it anything) down below\n    If UCase(Sheets(\"DebitCard_Check\").Range(\"G\" &amp; i).Value) = \"TAX\" Then GoTo Skip1\n\n    PatternFound = False\n    j = 1\n\n    Do While PatternFound = False And j &lt; lastrow\n        j = j + 1\n        If UCase(Sheets(\"DebitCard_Check\").Range(\"L\" &amp; i).Value) Like \"*\" &amp; UCase(Sheets(\"Rules\").Range(\"A\" &amp; j).Value) &amp; \"*\" Then\n            Sheets(\"DebitCard_Check\").Range(\"M\" &amp; i).Value = Sheets(\"Rules\").Range(\"C\" &amp; j).Value\n            PatternFound = True\n        End If\n    Loop\n\n    ' ***You need to add this piece to tell it where to skip to.  It has to have a colon after it.\nSkip1:\n\n    Next i\n\n    Call normal\n\nEnd Sub\n\n'-------------------------------\n\nPublic Sub speedup()\n\n    Application.ScreenUpdating = False\n    Application.DisplayStatusBar = False\n    Application.Calculation = xlCalculationManual\n    Application.EnableEvents = False\nEnd Sub\n\n'-------------------------------\n\nPublic Sub normal()\n\n    Application.ScreenUpdating = True\n    Application.DisplayStatusBar = True\n    Application.Calculation = xlCalculationAutomatic\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 5629294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/baf30c050eedcd0aac8704ea78a06aaa?s=128&d=identicon&r=PG&f=1", "display_name": "Nallatheryth", "link": "https://stackoverflow.com/users/5629294/nallatheryth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 34316022, "answer_count": 1, "score": 0, "last_activity_date": 1450280070, "creation_date": 1450277217, "last_edit_date": 1450277369, "question_id": 34315011, "link": "https://stackoverflow.com/questions/34315011/how-to-modify-the-subsequent-code-to-obtain-a-condition-based-on-which-the-rest", "title": "How to modify the subsequent code to obtain a condition based on which the rest is executed:", "body": "<p>Good evening. I spend the better part of 5 hours trying to understand and find how to modify the below code to include a separate condition which determines whether the rest of the code for each row is executed or is skipped to the next row. </p>\n\n<p>I cannot find anything. \nI tried to Dim the criteria as range (a column) but to no avail. I do not understand how to enter the condition. I either get <strong>Next without For</strong> or <strong>If without End If</strong> or other similar errors.    </p>\n\n<p>What I want to ask if there is a kind soul that might give me a clue as to where such statement should be inserted?\nThe statement is:</p>\n\n<p>IF <em>corresponding cell</em> value is <strong>value</strong> then\n       skip and do next i\nElse do</p>\n\n<pre><code>If UCase(Sheets(\"DebitCard_Check\").Range(\"L\" &amp; i).Value) Like \"*\" &amp; UCase(Sheets(\"Rules\").Range(\"A\" &amp; j).Value) &amp; \"*\" Then\n                Sheets(\"DebitCard_Check\").Range(\"M\" &amp; i).Value = Sheets(\"Rules\").Range(\"C\" &amp; j).Value\n                PatternFound = True\n</code></pre>\n\n<p>The columns and sheets are:</p>\n\n<p><strong>Sheet 1:</strong></p>\n\n<p><em>Column G</em> - contains 5 categories one of which is TAX. Based on that, IF IS TAX - skip, ELSE EXECUTE.</p>\n\n<p><em>Column L</em> - contains the description with keywords. Usualy 2-3 lines of text with 1 unique keyword in. \n<em>Column M</em> - where the categories based on the keywords are placed</p>\n\n<p><strong>Sheet 2:</strong></p>\n\n<p><em>Column A</em> - the keywords to search for </p>\n\n<p><em>Column C</em> - the categories that should correspond next to each keyword (Gaz, Electricity etc.) </p>\n\n<p>This is the original code below which needs modifying. </p>\n\n<pre><code>Sub Categories_Update()\n    Dim lastrow As Long, lastrow2 As Long\n    Dim i As Integer, j As Integer\n    Dim PatternFound As Boolean\n\n    Call speedup\n\n    lastrow = Sheets(\"Rules\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    lastrow2 = Sheets(\"DebitCard_Check\").Range(\"L\" &amp; Rows.Count).End(xlUp).Row\n\n    For i = 4 To lastrow2\n\n        PatternFound = False\n        j = 1\n\n        Do While PatternFound = False And j &lt; lastrow\n            j = j + 1\n            If UCase(Sheets(\"DebitCard_Check\").Range(\"L\" &amp; i).Value) Like \"*\" &amp; UCase(Sheets(\"Rules\").Range(\"A\" &amp; j).Value) &amp; \"*\" Then\n                Sheets(\"DebitCard_Check\").Range(\"M\" &amp; i).Value = Sheets(\"Rules\").Range(\"C\" &amp; j).Value\n                PatternFound = True\n            End If\n        Loop\n\n    Next i\n\n    Call normal\n\nEnd Sub\n\n'-------------------------------\n\nPublic Sub speedup()\n\n    Application.ScreenUpdating = False\n    Application.DisplayStatusBar = False\n    Application.Calculation = xlCalculationManual\n    Application.EnableEvents = False\nEnd Sub\n\n'-------------------------------\n\nPublic Sub normal()\n\n    Application.ScreenUpdating = True\n    Application.DisplayStatusBar = True\n    Application.Calculation = xlCalculationAutomatic\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "excel-2010", "vba"], "comments": [{"owner": {"reputation": 2788, "user_id": 4139024, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/qOcL9.jpg?s=128&g=1", "display_name": "blckbird", "link": "https://stackoverflow.com/users/4139024/blckbird"}, "edited": false, "score": 0, "creation_date": 1450276721, "post_id": 34314758, "comment_id": 56371240, "body": "What do you mean by &quot;the last value of the iterator&quot;?"}, {"owner": {"reputation": 551, "user_id": 4354213, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-S2uUqL01dZw/AAAAAAAAAAI/AAAAAAAAAHE/-EF-FSEoysE/photo.jpg?sz=128", "display_name": "Jonathan Camilleri", "link": "https://stackoverflow.com/users/4354213/jonathan-camilleri"}, "edited": false, "score": 0, "creation_date": 1450276729, "post_id": 34314758, "comment_id": 56371251, "body": "shouldn&#39;t x.Value = i be after the if c.value = ... ?"}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 5325405, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c8fbc28f9a8b4e00415b28e720a6c4c7?s=128&d=identicon&r=PG", "display_name": "Eudes", "link": "https://stackoverflow.com/users/5325405/eudes"}, "edited": false, "score": 0, "creation_date": 1450277557, "post_id": 34315003, "comment_id": 56371877, "body": "Yap just what i was looking for, i&#39;ve kinda the ideia but no the skills set. Thanks for the help, i would upvote but i cant. ^^"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 7, "user_id": 5325405, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c8fbc28f9a8b4e00415b28e720a6c4c7?s=128&d=identicon&r=PG", "display_name": "Eudes", "link": "https://stackoverflow.com/users/5325405/eudes"}, "edited": false, "score": 0, "creation_date": 1450277634, "post_id": 34315003, "comment_id": 56371923, "body": "@Eudes  That is O.K. Your feedback is all I need."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1450277203, "creation_date": 1450277203, "answer_id": 34315003, "question_id": 34314758, "link": "https://stackoverflow.com/questions/34314758/autofill-increments-when-given-a-string/34315003#34315003", "title": "Autofill increments when given a string", "body": "<p>How about:</p>\n\n<pre><code>Sub qwerty()\n   Dim x As Long, r As Range\n   x = 1\n\n   For Each r In Range(\"F57:F77\")\n      r.Offset(0, -1).Value = x\n      If r.Text = \"02:00\" Then x = x + 1\n   Next r\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/tEU6H.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tEU6H.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 2, "last_activity_date": 1450277849, "creation_date": 1450277849, "answer_id": 34315238, "question_id": 34314758, "link": "https://stackoverflow.com/questions/34314758/autofill-increments-when-given-a-string/34315238#34315238", "title": "Autofill increments when given a string", "body": "<p>Have you considered using a native worksheet function like <a href=\"https://support.office.com/en-US/article/COUNTIF-function-E0DE10C6-F885-4E71-ABB4-1F464816DF34\" rel=\"nofollow\">COUNTIF</a> for a bulk operation?</p>\n\n<pre><code>With Worksheets(\"Sheet7\")\n    With .Range(\"F57\", .Cells(Rows.Count, \"F\").End(xlUp))\n        .Offset(0, -1).Formula = \"=COUNTIF(F$57:F57, \"\"02:00\"\")+1\"\n        .Cells = .Value\n    End With\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 5325405, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c8fbc28f9a8b4e00415b28e720a6c4c7?s=128&d=identicon&r=PG", "display_name": "Eudes", "link": "https://stackoverflow.com/users/5325405/eudes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1450278132, "creation_date": 1450276559, "last_edit_date": 1531161705, "question_id": 34314758, "link": "https://stackoverflow.com/questions/34314758/autofill-increments-when-given-a-string", "title": "Autofill increments when given a string", "body": "<p>I've beeing searching around for quite a while and trying.</p>\n\n<p>What I want to do, is basically an auto-fill that only increments when it finds a value of \"02:00\" on the column F</p>\n\n<pre><code>1   00:15\u00a0\n1   00:45\u00a0\n1   01:00\u00a0\n1   01:15\u00a0\n1   01:30\u00a0\n1   01:45\u00a0\n1   02:00\u00a0 -\n2   00:15\u00a0\n2   00:45\u00a0\n2   01:00\u00a0\n2   01:15\u00a0\n2   01:30\u00a0\n2   01:45\u00a0\n2   02:00\u00a0-\n3   00:15\u00a0\n3   00:45\u00a0\n3   01:00\u00a0\n3   01:15\u00a0\n3   01:30\u00a0\n3   01:45\u00a0\n3   02:00\u00a0\n</code></pre>\n\n<p>The code I've does it almost right but always end up filling the column with the last value of the iterator.</p>\n\n<pre><code>    'Days :D\n    i = 0\n    For Each c In Range(\"F57:F77\")\n        For Each x In Range(\"E57:F77\")\n            x.Value = i \n            If c.Value = \"02:00\u00a0\" Then\n                i = i + 1\n                If i &gt;= 4 Then\n                    'Exits when overlap\n                    Exit Sub\n                End If\n                Debug.Print i\n            End If\n        Next\n    Next\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1450277598, "post_id": 34314641, "comment_id": 56371900, "body": "The issue is a few thing, but the main issue is all the <code>.select</code>,  This slows it down and are not needed in most cases.  See <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">THIS</a> for ways to avoid the <code>.select</code>.  Though a good job using the recorder to learn."}, {"owner": {"reputation": 571, "user_id": 2349516, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9e981a07089b3ec832c6dc3d8dd5f84a?s=128&d=identicon&r=PG", "display_name": "gmeroni", "link": "https://stackoverflow.com/users/2349516/gmeroni"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1450278149, "post_id": 34314641, "comment_id": 56372338, "body": "Thank you @ScottCraner I&#39;ll try to get rid of all those select ! I found that using <code>Application.ScreenUpdating = False</code> could improve a bit too!"}, {"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1450279772, "post_id": 34314641, "comment_id": 56373474, "body": "What do you mean transpose and then stack? Do you have an example?"}], "answers": [{"tags": [], "owner": {"reputation": 1631, "user_id": 4530630, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4a20adf8de6160beb0b8c2096e49f8e7?s=128&d=identicon&r=PG&f=1", "display_name": "TPhe", "link": "https://stackoverflow.com/users/4530630/tphe"}, "is_accepted": false, "score": 1, "last_activity_date": 1450375232, "last_edit_date": 1450375232, "creation_date": 1450281794, "answer_id": 34316669, "question_id": 34314641, "link": "https://stackoverflow.com/questions/34314641/fast-stack-columns-and-transpose/34316669#34316669", "title": "Fast Stack-Columns and Transpose", "body": "<p>Take a look at this link for several other things that you can turn off, such as formula recalculation: <a href=\"http://datapigtechnologies.com/blog/index.php/ten-things-you-can-do-to-speed-up-your-excel-vba-code/\" rel=\"nofollow\">http://datapigtechnologies.com/blog/index.php/ten-things-you-can-do-to-speed-up-your-excel-vba-code/</a>\nI agree that the multiple selects are unnecessary and likely slowing down the code significantly. In many cases, they can simply be combined - as in using </p>\n\n<pre><code>Selection.Resize(1, 1).Offset(0, 1).Select\n</code></pre>\n\n<p>instead of </p>\n\n<pre><code>Selection.Resize(1, 1).Select\nSelection.Offset(0, 1).Select\n</code></pre>\n\n<p>But also, why not reference your ranges explicitly using your counter value, and avoid using resize and offset so frequently?</p>\n\n<p>Another thought is to see if you can remove the final operation that stacks the columns after they are pasted to a new sheet - would it be possible to rearrange your source data, perhaps at the top of your macro before you get into the loop? That way you would have to perform that stacking once instead of 7589 times. Or, alternatively, find a way to combine the columns after the end of the loop.</p>\n"}, {"comments": [{"owner": {"reputation": 1631, "user_id": 4530630, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4a20adf8de6160beb0b8c2096e49f8e7?s=128&d=identicon&r=PG&f=1", "display_name": "TPhe", "link": "https://stackoverflow.com/users/4530630/tphe"}, "edited": false, "score": 0, "creation_date": 1450715885, "post_id": 34398976, "comment_id": 56542056, "body": "This looks much better. What time did you get it down to? I&#39;ve also had good results with using the dictionary data type, which tends to be much faster than an array but is somewhat different in use and applications. I can&#39;t say if it would help in your situation or not, but you may be interested: <a href=\"http://www.snb-vba.eu/VBA_Dictionary_en.html\" rel=\"nofollow noreferrer\">snb-vba.eu/VBA_Dictionary_en.html</a>"}, {"owner": {"reputation": 571, "user_id": 2349516, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9e981a07089b3ec832c6dc3d8dd5f84a?s=128&d=identicon&r=PG", "display_name": "gmeroni", "link": "https://stackoverflow.com/users/2349516/gmeroni"}, "reply_to_user": {"reputation": 1631, "user_id": 4530630, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4a20adf8de6160beb0b8c2096e49f8e7?s=128&d=identicon&r=PG&f=1", "display_name": "TPhe", "link": "https://stackoverflow.com/users/4530630/tphe"}, "edited": false, "score": 0, "creation_date": 1450716152, "post_id": 34398976, "comment_id": 56542212, "body": "Around 1 minute :)! Much more usable! Now I&#39;m trying to solve another problem, get rid of specific rows based on a condition but seems that arrays don&#39;t let to do that -.-&#39; Thanks for the link, i&#39;ll look in to it"}, {"owner": {"reputation": 1631, "user_id": 4530630, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4a20adf8de6160beb0b8c2096e49f8e7?s=128&d=identicon&r=PG&f=1", "display_name": "TPhe", "link": "https://stackoverflow.com/users/4530630/tphe"}, "edited": false, "score": 1, "creation_date": 1450716466, "post_id": 34398976, "comment_id": 56542408, "body": "Well, no need for more optimization, then. I think you could add this filtering into you existing code without too much difficulty - you already have a loop that cycles through a range and adds the values to an array, so just add in an if statement that assess whether or not each row/cell meets you criteria, and only adds it to the array if it passes the logical test. And this is assuming you can&#39;t just remove all the values up front - it&#39;s always easier to get rid of them before you start looping through row by row."}], "tags": [], "owner": {"reputation": 571, "user_id": 2349516, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9e981a07089b3ec832c6dc3d8dd5f84a?s=128&d=identicon&r=PG", "display_name": "gmeroni", "link": "https://stackoverflow.com/users/2349516/gmeroni"}, "is_accepted": true, "score": 0, "last_activity_date": 1450711184, "creation_date": 1450711184, "answer_id": 34398976, "question_id": 34314641, "link": "https://stackoverflow.com/questions/34314641/fast-stack-columns-and-transpose/34398976#34398976", "title": "Fast Stack-Columns and Transpose", "body": "<p>The answer to my question was: \"Use arrays\" :)</p>\n\n<p>The code now is this: </p>\n\n<pre><code>Sub pivotsourcedata()\n\n    'Set ScreenUpdating to False\n        Application.ScreenUpdating = False\n        Application.StatusBar = True\n\n    Dim OppsClosed As Worksheet\n        Set OppsClosed = Worksheets(\"Opps Closed FY15\")\n    Sheets.Add.Name = \"Shadow2\"\n    Dim Shadow2 As Worksheet\n        Set Shadow2 = Worksheets(\"Shadow2\")\n    Dim ID As Range\n    Dim ID0 As Range\n        Set ID0 = OppsClosed.Range(\"A13\")\n    Dim HeaderSelect As Range\n        Set HeaderSelect = OppsClosed.Range(\"FB1\")\n    Dim DataSelect As Range\n        Set DataSelect = OppsClosed.Range(\"FC14\")\n\n    Dim RowSize As Integer\n        OppsClosed.Activate\n        Dim lastrow, records, nHeader As Integer\n            lastrow = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row - 13\n            nHeader = 56\n            records = lastrow * nHeader\n\n\n    'Stack DataSelect on column C of Shadow 2\n        ReDim TempTableData(1 To nHeader, 1 To lastrow) As Variant\n        ReDim TempTableHeader(1 To nHeader, 1 To lastrow)\n        ReDim FixedHeaders(1 To nHeader, 1 To 1)\n        ReDim Temp_Array1(1 To records, 1 To 1) As Variant\n        ReDim Temp_Array2(1 To records, 1 To 1) As Variant\n        FixedHeaders = OppsClosed.Range(\"FC1\").Resize(1, nHeader)\n        FixedHeaders = Application.Transpose(FixedHeaders)\n\n            For j = 1 To lastrow\n            'Progress bar\n                    Application.StatusBar = \"Progress: \" &amp; j &amp; \" of \" &amp; lastrow &amp; \": \" &amp; Format(j / lastrow, \"0%\")\n\n                For i = 1 To nHeader\n                    TempTableData(i, j) = DataSelect.Offset(j - 1, i - 1)\n                    TempTableHeader(i, j) = FixedHeaders(i, 1)\n                Next i\n            Next j\n\n            For j = 1 To nHeader\n                For i = 0 To lastrow - 1\n                    Temp_Array1((i * nHeader) + j, 1) = TempTableData(j, i + 1)\n                    Temp_Array2((i * nHeader) + j, 1) = TempTableHeader(j, i + 1)\n                Next i\n            Next j\n\n            Shadow2.Range(\"C1:C\" &amp; records).Value2 = Temp_Array1\n            Shadow2.Range(\"B1:B\" &amp; records).Value2 = Temp_Array2\n\n        'Copy and Replicate ID\n            ReDim TempTableID(1 To records, 1 To 1)\n                k = 1\n\n                For i = 1 To records\n                    'Progress bar\n                    Application.StatusBar = \"Progress: \" &amp; i &amp; \" of \" &amp; records &amp; \": \" &amp; Format(i / records, \"0%\")\n                    DoEvents\n\n                    'FixedID = OppsClosed.Range(\"A13\").Offset(k, 0)\n                    TempTableID(i, 1) = OppsClosed.Range(\"A13\").Offset(k, 0)\n\n                    variable = i / nHeader\n\n                    If Fix(variable) = variable Then\n                        k = k + 1\n                    End If\n\n                Next i\n             Shadow2.Range(\"A1:A\" &amp; records).Value2 = TempTableID\n\n\n\n    Application.StatusBar = False\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 571, "user_id": 2349516, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9e981a07089b3ec832c6dc3d8dd5f84a?s=128&d=identicon&r=PG", "display_name": "gmeroni", "link": "https://stackoverflow.com/users/2349516/gmeroni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 0, "accepted_answer_id": 34398976, "answer_count": 2, "score": 2, "last_activity_date": 1450711184, "creation_date": 1450276217, "last_edit_date": 1592644375, "question_id": 34314641, "link": "https://stackoverflow.com/questions/34314641/fast-stack-columns-and-transpose", "title": "Fast Stack-Columns and Transpose", "body": "<p>After few days learning VBA, I managed to get a simple macro to take some data from a sheet and transpose to another, then stack the columns together.</p>\n<p><strong>Macro</strong></p>\n<pre><code>Sub pivotsourcedata()\n    \n    Dim HeaderSelect As Range\n    Dim DataSelect As Range\n    Dim ID As Range\n     \n    'Variabile Declaration for Progress bar \n        Dim x               As Integer\n        Dim MyTimer         As Double\n\n\n    For i = 1 To 7589\n    'Progress bar\n        Application.StatusBar = &quot;Progress: &quot; &amp; i &amp; &quot; of 7589: &quot; &amp; Format(i / 7589, &quot;0%&quot;)\n    \n    'Copy ID Range\n        Sheets(&quot;Opps Closed FY15&quot;).Select\n        Range(&quot;A13&quot;).Offset(i, 0).Select\n        Set ID = Selection\n    'Copy Header Range\n        Range(&quot;EX13:HA13&quot;).Select\n        Set HeaderSelect = Selection\n    'Copy Data Range\n        Range(&quot;EX13:HA13&quot;).Offset(i, 0).Select\n        Set DataSelect = Selection\n    'Select ID and copy it to the next sheet and fill it down\n        ID.Copy\n        Sheets(&quot;Sheet1&quot;).Select\n        If i = 1 Then\n        Else\n        Selection.Resize(1, 1).Offset(0, 1).Select\n        End If\n        Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _\n            False, Transpose:=True\n        Selection.Resize(HeaderSelect.Columns.Count).FillDown\n    \n    'Select the Header, copy it in the adjacent column    \n        Selection.Resize(1, 1).Select\n        Selection.Offset(0, 1).Select\n        Sheets(&quot;Opps Closed FY15&quot;).Select\n            HeaderSelect.Copy\n            Sheets(&quot;Sheet1&quot;).Select\n            Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:= _\n                False, Transpose:=True\n                \n    'Same for the data, copy to the right of Header        \n        Selection.Resize(1, 1).Select\n        Selection.Offset(0, 1).Select\n        Sheets(&quot;Opps Closed FY15&quot;).Select\n            DataSelect.Copy\n            Sheets(&quot;Sheet1&quot;).Select\n            Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:= _\n                False, Transpose:=True\n            \n    'Stack the columns one over the other 3 by 3.\n    ' take the 4th, 5th and 6th columns and stuck'em\n    ' below 1st, 2nd and 3rd\n    If i = 1 Then\n    \n    Else\n        Range(&quot;A1:C1&quot;).Offset(56 * (i - 1), 0).Resize(56, 3).Select\n        Dim PasteSelect As Range\n        Set PasteSelect = Selection\n        Range(&quot;D1:F56&quot;).Select\n        Selection.Cut Destination:=PasteSelect\n        Selection.Resize(1, 1).Offset(0, -1).Select\n    End If\n    \n    Next i\n    \n    Application.StatusBar = False\n\nEnd Sub\n</code></pre>\n<p>As you can see for each of the 7589 times, I copy and transpose 3 times a range of 56 columns. This is taking a while, around 1.5h. Since I need to run it every week, I'm asking if I wrote badly some code portions...maybe I don't know I can seed it up in some areas...</p>\n<p>any thoughts?</p>\n<h2>Update</h2>\n<p>After yours suggestions i get to tune up a bit the code, I'd like to know if there are others &quot;imperfections&quot;</p>\n<pre><code>Sub pivotsourcedata()\n\n    Dim OppsClosed As Worksheet\n        Set OppsClosed = Worksheets(&quot;Opps Closed FY15&quot;)\n    Dim Shadow2 As Worksheet\n        Set Shadow2 = Worksheets(&quot;Shadow2&quot;)\n    Dim ID As Range\n    Dim ID0 As Range\n        Set ID0 = OppsClosed.Range(&quot;A14&quot;)\n    Dim HeaderSelect As Range\n        Set HeaderSelect = OppsClosed.Range(&quot;EX13:HA13&quot;)\n    Dim DataSelect As Range\n        Set DataSelect = HeaderSelect\n    Dim PasteSelect As Range\n    Dim PasteSelect0 As Range\n        Set PasteSelect0 = Shadow2.Range(&quot;A1:C1&quot;).Resize(56, 3)\n    Dim CopySelect As Range\n        Set CopySelect = Shadow2.Range(&quot;D1:F56&quot;)\n    Dim Inizialize As Range\n        Set Inizialize = Shadow2.Range(&quot;D1:D1&quot;)\n    \n    'Variabile Declaration for Progress bar\n        Dim x               As Integer\n        Dim MyTimer         As Double\n\n    'Set ScreenUpdating to False\n        Application.ScreenUpdating = False\n    \n    For i = 1 To 7589\n    'Progress bar\n        Application.StatusBar = &quot;Progress: &quot; &amp; i &amp; &quot; of 7589: &quot; &amp; Format(i / 7589, &quot;0%&quot;)\n    \n    'Copy ID Range\n        Set ID = ID0.Offset(i, 0)\n        \n    'Copy Data Range\n        Set DataSelect = HeaderSelect.Offset(i, 0)\n\n    'Select ID and copy it to the next sheet and fill it down\n        ID.Copy\n        Shadow2.Select\n        \n        If i = 1 Then\n            Range(&quot;A1&quot;).PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _\n                False, Transpose:=True\n            Range(&quot;A1&quot;).Resize(HeaderSelect.Columns.Count).FillDown\n        Else\n            Range(&quot;D1&quot;).PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _\n                False, Transpose:=True\n            Range(&quot;D1&quot;).Resize(HeaderSelect.Columns.Count).FillDown\n        End If\n\n    'Select the Header, copy it in the adiacent column\n        HeaderSelect.Copy\n        If i = 1 Then\n            Shadow2.Range(&quot;B1&quot;).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:= _\n                False, Transpose:=True\n        Else\n            Shadow2.Range(&quot;E1&quot;).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:= _\n                False, Transpose:=True\n        End If\n        \n                \n    'Same for the data, copy to the right of Header\n        DataSelect.Copy\n        If i = 1 Then\n                Shadow2.Range(&quot;C1&quot;).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:= _\n                    False, Transpose:=True\n        Else\n                Shadow2.Range(&quot;F1&quot;).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:= _\n                    False, Transpose:=True\n        End If\n        \n            \n    'Stack the columns one over the other 3 by 3.\n    ' take the 4th, 5th and 6th columns and stuck'em\n    ' below 1st, 2nd and 3rd\n        If i = 1 Then\n        Else\n            Set PasteSelect = PasteSelect0.Offset(HeaderSelect.Columns.Count * (i - 1), 0)\n            Shadow2.Range(&quot;D1:F56&quot;).Cut Destination:=PasteSelect\n        End If\n    \n    Next i\n    \n    Application.StatusBar = False660858\n    'Set ScreenUpdating to True\n        Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "loops", "if-statement", "ms-word", "form-fields"], "comments": [{"owner": {"reputation": 2788, "user_id": 4139024, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/qOcL9.jpg?s=128&g=1", "display_name": "blckbird", "link": "https://stackoverflow.com/users/4139024/blckbird"}, "edited": false, "score": 0, "creation_date": 1450277003, "post_id": 34314629, "comment_id": 56371469, "body": "why do you need the second &quot;Do&quot;?"}, {"owner": {"reputation": 1, "user_id": 5687072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/552bd411f81ba54344538e3a2a08682d?s=128&d=identicon&r=PG&f=1", "display_name": "thormann", "link": "https://stackoverflow.com/users/5687072/thormann"}, "reply_to_user": {"reputation": 2788, "user_id": 4139024, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/qOcL9.jpg?s=128&g=1", "display_name": "blckbird", "link": "https://stackoverflow.com/users/4139024/blckbird"}, "edited": false, "score": 0, "creation_date": 1452588558, "post_id": 34314629, "comment_id": 57223929, "body": "Okay. Then I don&#39;t need the second &quot;loop while&quot; either, do I?"}, {"owner": {"reputation": 2788, "user_id": 4139024, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/qOcL9.jpg?s=128&g=1", "display_name": "blckbird", "link": "https://stackoverflow.com/users/4139024/blckbird"}, "edited": false, "score": 0, "creation_date": 1452588826, "post_id": 34314629, "comment_id": 57224083, "body": "Yes, that is correct"}], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 0, "last_activity_date": 1450281210, "creation_date": 1450281210, "answer_id": 34316434, "question_id": 34314629, "link": "https://stackoverflow.com/questions/34314629/how-do-i-define-two-tasks-within-an-if-formula-using-vba/34316434#34316434", "title": "How do I define two tasks within an &quot;if&quot;-formula using VBA?", "body": "<p>The FormField object has no SetFocus method. I'm surprised you're not getting a compile-time error message. (Or are you and you just didn't mention it - you should always mention error messages and the line of code on which they occur!)</p>\n\n<p>You can use the Select method of the FormField object to put the cursor in a form field:</p>\n\n<pre><code>ActiveDocument.FormFields(fieldvars(i)).Select\n</code></pre>\n\n<p>Beyond that, I agree with blckbird's remark that the second \"Do\" seems unnecessary...</p>\n"}], "owner": {"reputation": 1, "user_id": 5687072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/552bd411f81ba54344538e3a2a08682d?s=128&d=identicon&r=PG&f=1", "display_name": "thormann", "link": "https://stackoverflow.com/users/5687072/thormann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1450281210, "creation_date": 1450276194, "last_edit_date": 1450276356, "question_id": 34314629, "link": "https://stackoverflow.com/questions/34314629/how-do-i-define-two-tasks-within-an-if-formula-using-vba", "title": "How do I define two tasks within an &quot;if&quot;-formula using VBA?", "body": "<p>I am currently creating an order form for users to fill out.</p>\n\n<p>For that I have created several form fields in a Word document.</p>\n\n<p>For me to make sure that users will fill the appropriate fields, I have created a macro. I succeeded in making a macro that will force the user to enter something in a pop-up box (this is the first \"do\"-string.</p>\n\n<p>However I want the view to jump to the given field, which is what I am trying to do in the second \"do\"-string.</p>\n\n<p>This is the code:</p>\n\n<pre><code>Sub mustFill()\n\n    Dim fieldvars(1 To 12) As String\n    Dim labels(1 To 12) As String\n\n    fieldvars(1) = \"siteName\"\n    fieldvars(2) = \"currentDate\"\n    fieldvars(3) = \"deliveryDate\"\n    fieldvars(4) = \"pcpName\"\n    fieldvars(5) = \"pcpMail\"\n    fieldvars(6) = \"pcpPhone\"\n    fieldvars(7) = \"numberOfTurbines\"\n    fieldvars(8) = \"siteAddress\"\n    fieldvars(9) = \"emergencyPhone\"\n    fieldvars(10) = \"hubHeight\"\n    fieldvars(11) = \"towerSections\"\n    fieldvars(12) = \"coordinateSystem\"\n\n    labels(1) = \"Site name\"\n    labels(2) = \"Current date\"\n    labels(3) = \"Requested delivery date\"\n    labels(4) = \"Project contact person, Name\"\n    labels(5) = \"Project contact person, E-mail\"\n    labels(6) = \"Project contact person, Phone no.\"\n    labels(7) = \"Number of turbines\"\n    labels(8) = \"Site address\"\n    labels(9) = \"Emergency phone no.\"\n    labels(10) = \"Hub height\"\n    labels(11) = \"Number of tower sections\"\n    labels(12) = \"Turbine coordinate system, datum and zone\"\n\n    For i = 1 To 12\n    If ActiveDocument.FormFields(fieldvars(i)).Result = \"\" Then\n    Do\n            sInFld = InputBox(\"This field: \" &amp; labels(i) &amp; \" is mandatory. Please fill in below.\")\n    Do\n            ActiveDocument.FormFields(fieldvars(i)).SetFocus\n        Loop While sInFld = \"\"\n        Loop While sInFld = \"\"\n        ActiveDocument.FormFields(fieldvars(i)).Result = sInFld\n    End If\n    Next i\nEnd Sub\n</code></pre>\n\n<p>Is it the string that I have done wrong or is it a problem with multiple \"Do\"-strings inside the \"If\"-formula.</p>\n\n<p>Thank you a lot in advance!</p>\n\n<p>/thormann</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 2, "creation_date": 1450275777, "post_id": 34314281, "comment_id": 56370540, "body": "Better to create 2 procedures and store the times in public variables and call the 2 procedures from workbook_open! See the reference here : <a href=\"http://www.cpearson.com/excel/OnTime.aspx\" rel=\"nofollow noreferrer\">cpearson.com/excel/OnTime.aspx</a>"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 3, "creation_date": 1450275823, "post_id": 34314281, "comment_id": 56370573, "body": "Procedure name should be a string, <code>&quot;MyFunction&quot;</code>."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1450276672, "post_id": 34314281, "comment_id": 56371203, "body": "And, FYI, you are not running Excel 2012 as that doesn&#39;t exist. ;)"}, {"owner": {"reputation": 5712, "user_id": 2730554, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6682e696c4f9438678b6638f271230a?s=128&d=identicon&r=PG&f=1", "display_name": "mHelpMe", "link": "https://stackoverflow.com/users/2730554/mhelpme"}, "edited": false, "score": 0, "creation_date": 1450276723, "post_id": 34314281, "comment_id": 56371245, "body": "I&#39;ve put the procedure name as a string now and yes it doesn&#39;t run the function on opening the workbook so thanks. However when the time comes to run the function I get a message saying &quot;Cannot run the macro, macro may not be available in this workbook or all macros may be disabled&quot;. Macros aren&#39;t disabled and the function is there"}, {"owner": {"reputation": 5712, "user_id": 2730554, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6682e696c4f9438678b6638f271230a?s=128&d=identicon&r=PG&f=1", "display_name": "mHelpMe", "link": "https://stackoverflow.com/users/2730554/mhelpme"}, "edited": false, "score": 0, "creation_date": 1450276754, "post_id": 34314281, "comment_id": 56371271, "body": "Ah yes! Sorry that should be Excel 2013. I&#39;ll update"}, {"owner": {"reputation": 5712, "user_id": 2730554, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6682e696c4f9438678b6638f271230a?s=128&d=identicon&r=PG&f=1", "display_name": "mHelpMe", "link": "https://stackoverflow.com/users/2730554/mhelpme"}, "edited": false, "score": 0, "creation_date": 1450277455, "post_id": 34314281, "comment_id": 56371800, "body": "Its now working so thanks for your help. I had MyFunction in ThisWorkbook forgot to put it in a module"}, {"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1450277530, "post_id": 34314281, "comment_id": 56371855, "body": "You only gave an <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196165.aspx\" rel=\"nofollow noreferrer\">EarliestTime</a> argument then made the workbook unavailable (as you claim they run when you open it)?"}], "owner": {"reputation": 5712, "user_id": 2730554, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6682e696c4f9438678b6638f271230a?s=128&d=identicon&r=PG&f=1", "display_name": "mHelpMe", "link": "https://stackoverflow.com/users/2730554/mhelpme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 236, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1450276793, "creation_date": 1450275275, "last_edit_date": 1450276793, "question_id": 34314281, "link": "https://stackoverflow.com/questions/34314281/ontime-running-on-workbook-open-not-at-specified-time", "title": "onTime running on Workbook open not at specified time", "body": "<p>I am using Excel 2013.</p>\n\n<p>I wish to run a macro at two set times. So I have the code below. The issue I have is that it runs MyFunction when I open the workbook which I don't understand. I have specified it to run at 2.30pm &amp; 3.30pm. Is there anyway of stopping it running the code at the wrong time?</p>\n\n<pre><code>Private Sub Workbook_Open()\n\nApplication.OnTime TimeValue(\"14:30:00\"), MyFunction\nApplication.OnTime TimeValue(\"15:30:00\"), MyFunction\n\nEnd Sub\n\npublic Function MyFunction()\n\nend function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1450275892, "post_id": 34314208, "comment_id": 56370629, "body": "Why loop over all worksheets if you only want to process the worksheet named &quot;Candidates&quot;? That seems like a pointless loop. Why not just <code>Set wks =ThisWorkbook. Worksheets(&quot;Candidates&quot;)</code>? Similar remarks hold for &quot;Job live&quot;. You have two nested loops that can be replaced by simple variable setting."}, {"owner": {"reputation": 45, "user_id": 5685982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1fc4c563a7cd44c56d10fedf6b11669?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doe", "link": "https://stackoverflow.com/users/5685982/j-doe"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1450275982, "post_id": 34314208, "comment_id": 56370697, "body": "@JohnColeman I did that but i don&#39;t know why it stays on the same sheet if i do that. And it&#39;s always the current active sheet."}, {"owner": {"reputation": 45, "user_id": 5685982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1fc4c563a7cd44c56d10fedf6b11669?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doe", "link": "https://stackoverflow.com/users/5685982/j-doe"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1450276167, "post_id": 34314208, "comment_id": 56370828, "body": "@JohnColeman Oh wait i did it again, i didn&#39;t mention the &quot;Set&quot; so maybe that&#39;s why. Anyway i have deleted the for loops and set it like you said. It doesn&#39;t solve my problem tho"}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1450277283, "post_id": 34314208, "comment_id": 56371668, "body": "Usually I think it is helpfull to declare all your variables in one place, so that it is easy to identify them. Perhaps do it as one of the first things. It also makes your loops look cleaner, and therefore makes it easier to see when there is an error somewhere. Also at what row exactly does it show subscript out of range?"}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1450277429, "post_id": 34314208, "comment_id": 56371780, "body": "Cell2(i2,1) makes your comparison over all values in the range of cell2 that you identified earlier: <code>cell2 = wks2.Range(&quot;A2:A&quot; &amp; Lastrow2).Value</code> as <code>i2</code> identifies the row and <code>1</code> identifies the column"}, {"owner": {"reputation": 45, "user_id": 5685982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1fc4c563a7cd44c56d10fedf6b11669?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doe", "link": "https://stackoverflow.com/users/5685982/j-doe"}, "edited": false, "score": 0, "creation_date": 1450277486, "post_id": 34314208, "comment_id": 56371823, "body": "All the variables are already declared at one place. And here the row:                     If cell = cell2(i2, 1) Then"}, {"owner": {"reputation": 45, "user_id": 5685982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1fc4c563a7cd44c56d10fedf6b11669?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doe", "link": "https://stackoverflow.com/users/5685982/j-doe"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1450277572, "post_id": 34314208, "comment_id": 56371886, "body": "@Luuklag But then i don&#39;t understand why i can&#39;t compare cell(i,1) to cell2(i2,1). If i do this it says type missmatch."}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1450277885, "post_id": 34314208, "comment_id": 56372110, "body": "why is <code>lastrow2</code> then declared halfway your loop?"}, {"owner": {"reputation": 45, "user_id": 5685982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1fc4c563a7cd44c56d10fedf6b11669?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doe", "link": "https://stackoverflow.com/users/5685982/j-doe"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1450342582, "post_id": 34314208, "comment_id": 56402059, "body": "@Luuklag ` Dim Lastrow As String, Lastrow2 As String` It is declared in the header"}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1450342851, "post_id": 34314208, "comment_id": 56402224, "body": "Ah then I messed up declared and set. Terminology isn&#39;t my strong part sorry. Anyway you could also move <code>Lastrow2 = wks2.Range(&quot;A&quot; &amp; Rows.Count).End(xlUp).Row</code> to the top, as well as <code>cell2 = wks2.Range(&quot;A2:A&quot; &amp; Lastrow2).Value</code> as both do not depend on what happens in your loops."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 5685982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1fc4c563a7cd44c56d10fedf6b11669?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doe", "link": "https://stackoverflow.com/users/5685982/j-doe"}, "edited": false, "score": 0, "creation_date": 1450342138, "post_id": 34315536, "comment_id": 56401756, "body": "I&#39;ve added another condition to not compare blank and deleted the else statement. But it takes too much time to compare. Excel end&#39;s up in no responding mode for 30s or more. It also only compares the first line of Candidates, i tried adding another candidates and it doesn&#39;t compare anymore after the first line"}, {"owner": {"reputation": 45, "user_id": 5685982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1fc4c563a7cd44c56d10fedf6b11669?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doe", "link": "https://stackoverflow.com/users/5685982/j-doe"}, "edited": false, "score": 0, "creation_date": 1450343648, "post_id": 34315536, "comment_id": 56402762, "body": "After some tests it works with some values but not with others. I copy paste them so i know its exactly the same. How is possible that it works only with some values?"}, {"owner": {"reputation": 45, "user_id": 5685982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1fc4c563a7cd44c56d10fedf6b11669?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doe", "link": "https://stackoverflow.com/users/5685982/j-doe"}, "edited": false, "score": 0, "creation_date": 1450344701, "post_id": 34315536, "comment_id": 56403465, "body": "I found why. The rng2.Rows.Count was only counting like the first 2 items and then it stoppes idk why. So i changed it by a number and it works. It compares everything"}, {"owner": {"reputation": 64, "user_id": 5402899, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b401b1a00867ef32c79e5d8c3006baff?s=128&d=identicon&r=PG&f=1", "display_name": "JoeJoe", "link": "https://stackoverflow.com/users/5402899/joejoe"}, "reply_to_user": {"reputation": 45, "user_id": 5685982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1fc4c563a7cd44c56d10fedf6b11669?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doe", "link": "https://stackoverflow.com/users/5685982/j-doe"}, "edited": false, "score": 0, "creation_date": 1450383657, "post_id": 34315536, "comment_id": 56428652, "body": "Hi, @J. Doe, the limits of the two for-cycle are static according the range pre-defined in the first lines, it is a property of range object that should work well. Let&#39;s do this, may this could be solved modifying changing the sentence to evaluate <code>If rng1.Item(i) = rng2.Item(j) Then</code>   to   <code>If rng1.Item(i).value = rng2.Item(j).value</code> , tell me please if this works for you"}], "tags": [], "owner": {"reputation": 64, "user_id": 5402899, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b401b1a00867ef32c79e5d8c3006baff?s=128&d=identicon&r=PG&f=1", "display_name": "JoeJoe", "link": "https://stackoverflow.com/users/5402899/joejoe"}, "is_accepted": true, "score": 1, "last_activity_date": 1450278681, "creation_date": 1450278681, "answer_id": 34315536, "question_id": 34314208, "link": "https://stackoverflow.com/questions/34314208/comparing-value-of-cells-from-two-different-sheets/34315536#34315536", "title": "Comparing value of cells from two different sheets", "body": "<p>I see your code, and here's a proposal</p>\n\n<pre><code>Option Explicit\nSub CompareDefinedRanges()\nDim rng1, rng2 As Range\nDim found As Boolean\nDim i, j, foundAt As Integer\nSet rng1 = Worksheets(\"Candidates\").Range(\"B2\", Worksheets(\"candidates\").Range(\"B2\").End(xlDown).Address)\nSet rng2 = Worksheets(\"Job live\").Range(\"A2\", Worksheets(\"Job Live\").Range(\"A2\").End(xlDown).Address)\n'show items\nFor i = 1 To rng1.Rows.Count\nfound = False\nfoundAt = 0\nFor j = 1 To rng2.Rows.Count\n   If rng1.Item(i) = rng2.Item(j) Then\n   found = True\n   foundAt = j\n   End If\nNext j\n   If found Then\n   MsgBox rng1.Item(i).Value &amp; \" found at \" &amp; CStr(foundAt), , \"Candidates\"\n   Else\n   MsgBox rng1.Item(i).Value &amp; \" not found\", , \"Candidates\"\n   End If\nNext i\nSet rng1 = Nothing\nSet rng2 = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 5685982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1fc4c563a7cd44c56d10fedf6b11669?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doe", "link": "https://stackoverflow.com/users/5685982/j-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 34315536, "answer_count": 1, "score": 0, "last_activity_date": 1450284112, "creation_date": 1450275005, "last_edit_date": 1450284112, "question_id": 34314208, "link": "https://stackoverflow.com/questions/34314208/comparing-value-of-cells-from-two-different-sheets", "title": "Comparing value of cells from two different sheets", "body": "<p>First my code: </p>\n\n<pre><code>   Option Explicit\nSub UpdateCandidates()\n  Application.ScreenUpdating = False\n  Dim wks As Worksheet, wks2 As Worksheet\n  Dim Lastrow As String, Lastrow2 As String\n  Dim Rng As Range, i As Long, Rng2 As Range, i2 As Long\n  Dim cell As Variant, cell2 As Variant\n\n  Set wks = ThisWorkbook.Worksheets(\"Candidates\")\n    Lastrow = wks.Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n    If Lastrow &gt; 1 Then\n      cell = wks.Range(\"B2:B\" &amp; Lastrow).Value\n      i = 1: Set Rng = Nothing\n            While i &lt;= Lastrow\n            For i = i To Lastrow\n                Set wks2 = ThisWorkbook.Worksheets(\"Job live\")\n                        Lastrow2 = wks2.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n                        If Lastrow2 &gt; 1 Then\n                            cell2 = wks2.Range(\"A2:A\" &amp; Lastrow2).Value\n                            i2 = 1: Set Rng2 = Nothing\n                            While i2 &lt;= Lastrow2\n                                For i2 = i2 To Lastrow2\n                                    If cell = cell2(i2, 1) Then\n                                        MsgBox (\"found\")\n                                    End If\n                                Next\n                            Wend\n                        End If\n\n            Next\n      Wend\n    End If\n  Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>This basically works and compares the two columns but at the end it shows an error: </p>\n\n<blockquote>\n  <p>\"Subscript out of range\"  </p>\n</blockquote>\n\n<p>I don't understand why. I thought it's because of <code>&lt;= Lastrow</code> but fixing to <code>&lt; Lastrow</code> doesn't change anything.  </p>\n\n<p>I also would like to copy a value from the first sheet to the second one to a particular cell. And also insert a row below the cell from my second sheet.</p>\n\n<p>I also don't understand why I have to compare cell to <code>cell2(i2,1)</code> and not cell to <code>cell2</code>. If I compare cell to cell2 it says type mismatch. And I have the same error if I enter a second value in my sheets. </p>\n\n<p>What's wrong with my code?</p>\n"}, {"tags": ["excel", "clipboard", "vba"], "comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1450274904, "post_id": 34313757, "comment_id": 56369905, "body": "Isn&#39;t there a way to make Excel read a number/formula as the locally acceptable format? Can&#39;t recall off the top of my head how to do this. The key question, though, is where the data is going after the clipboard? If it pastes into Excel... couldn&#39;t you ignore the separators and trust that two open windows of Excel by the same user would use the same local format settings? Maybe I&#39;m misunderstanding why you want to do this."}, {"owner": {"reputation": 367, "user_id": 1568618, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/350a67b9caf53d86cf3fc43db63041c7?s=128&d=identicon&r=PG", "display_name": "Jakabfi Attila", "link": "https://stackoverflow.com/users/1568618/jakabfi-attila"}, "reply_to_user": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 1, "creation_date": 1450275415, "post_id": 34313757, "comment_id": 56370240, "body": "The data will go into a different application. The application doesn&#39;t really care about which separators are used, as long as they are consistent. (every user sends the  same). Passing the locale would be cumbersome, since than the CTRL+C would have to differ from the macro, content wise, not only format wise."}, {"owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 0, "creation_date": 1450276660, "post_id": 34313757, "comment_id": 56371186, "body": "Well your code is working completely fine for me. For testing purpose, I&#39;ve changed the separators in my Excel before running your code."}, {"owner": {"reputation": 367, "user_id": 1568618, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/350a67b9caf53d86cf3fc43db63041c7?s=128&d=identicon&r=PG", "display_name": "Jakabfi Attila", "link": "https://stackoverflow.com/users/1568618/jakabfi-attila"}, "edited": false, "score": 0, "creation_date": 1450278256, "post_id": 34313757, "comment_id": 56372440, "body": "I&#39;m using MS Office Home and Business 2013 on a Win 7 Profession SP1 OS. On which version did it work for you?"}, {"owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "edited": false, "score": 1, "creation_date": 1452877326, "post_id": 34313757, "comment_id": 57374391, "body": "@JakabfiAttila, I think you just need to change <code>.UseSystemSeparators = True</code> to <code>False</code>, I tested it by changing my Excel and System settings and it worked 100% for me."}, {"owner": {"reputation": 544, "user_id": 4868761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b86485dea136b4aa5498ff3d8f2a413?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4868761/kyle"}, "edited": false, "score": 0, "creation_date": 1452894332, "post_id": 34313757, "comment_id": 57383260, "body": "Have you tried <code>NUMBERVALUE()</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "is_accepted": false, "score": 2, "last_activity_date": 1453154710, "last_edit_date": 1525816098, "creation_date": 1453154170, "answer_id": 34864783, "question_id": 34313757, "link": "https://stackoverflow.com/questions/34313757/excel-to-clipboard-with-macro-decimal-separator/34864783#34864783", "title": "Excel to clipboard with macro decimal separator", "body": "<p>From <a href=\"http://www.cpearson.com/EXCEL/clipboard.aspx\" rel=\"nofollow noreferrer\">Cpearson Site</a> with some modification we can copy any range with custom formats for <code>Numbers</code> and <code>Dates</code> to Clipboard with no need to change Excel or System Settings.\nThis module requires a reference to the \"Microsoft Forms 2.0 Object Library\", we can do this reference by adding <code>UserForm</code> to the Workbook then we can delete it, (if already there is any <code>UserForm</code> in the Workbook we can skip this step).</p>\n\n<pre><code>Option Explicit\nOption Compare Text\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n' modClipboard\n' By Chip Pearson\n'       chip@cpearson.com\n'       www.cpearson.com/Excel/Clipboard.aspx\n' Date: 15-December-2008\n'\n' This module contains functions for working with text string and\n' the Windows clipboard.\n' This module requires a reference to the \"Microsoft Forms 2.0 Object Library\".\n'\n' !!!!!!!!!!!\n' Note that in order to retrieve data from the clipboard that was placed\n' in the clipboard via a DataObject, that DataObject object must not be\n' set to Nothing or allowed to go out of scope after adding text to the\n' clipboard and before retrieving data from the clipboard. If the DataObject\n' is destroyed, the data cannot be retrieved from the clipboard.\n' !!!!!!!!!!!\n'\n' Functions In This Module\n' -------------------------\n'   PutInClipboard              Puts a text string in the clipboard. Supprts\n'                               clipboard format identifiers.\n'   GetFromClipboard            Retrieves whatever text is in the clipboard.\n'                               Supports format identifiers.\n'   RangeToClipboardString      Converts a Range object into a String that\n'                               can then be put in the clipboard and pasted.\n'   ArrayToClipboardString      Converts a 1 or 2 dimensional array into\n'                               a String that can be put in the clipboard\n'                               and pasted.\n' Private Support Functions\n' -------------------------\n'   ArrNumDimensions            Returns the number of dimensions in an array.\n'                               Returns 0 if parameter is not an array or\n'                               is an unallocated array.\n'   IsArrayAllocated            Returns True if the parameter is an allocated\n'                               array. Returns False under all other circumstances.\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\nPrivate DataObj As MSForms.DataObject\nPublic Function PutInClipboard(RR As Range, Optional NmFo As String, Optional DtFo As String) As Boolean\n    ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n    ' RangeToClipboardString\n    ' This function changes the cells in RR to a String that can be put in the\n    ' Clipboard. It delimits columns with a vbTab character so that values\n    ' can be pasted in a row of cells. Each row of vbTab delimited strings are\n    ' delimited by vbNewLine characters to allow pasting accross multiple rows.\n    ' The values within a row are delimited by vbTab characters and each row\n    ' is separated by a vbNewLine character. For example,\n    '   T1 vbTab T2 vbTab T3 vbNewLine\n    '   U1 vbTab U2 vbTab U3 vbNewLine\n    '   V1 vtTab V2 vbTab V3\n    ' There is no vbTab after the last item in a row and there\n    ' is no vbNewLine after the last row.\n    ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n    Dim R As Long\n    Dim C As Long\n    Dim s As String\n    Dim S1 As String\n    For R = 1 To RR.Rows.Count\n        For C = 1 To RR.Columns.Count\n          If IsNumeric(RR(R, C).Value) And Not IsMissing(NmFo) Then\n            S1 = Format(RR(R, C).Value, NmFo)\n          ElseIf IsDate(RR(R, C).Value) And Not IsMissing(DtFo) Then\n            S1 = Format(RR(R, C).Value, DtFo)\n          End If\n            s = s &amp; S1 &amp; IIf(C &lt; RR.Columns.Count, vbTab, vbNullString)\n        Next C\n        s = s &amp; IIf(R &lt; RR.Rows.Count, vbNewLine, vbNullString)\n    Next R\n\n    ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n    ' PutInClipboard\n    ' This function puts the text string S in the Windows clipboard, using\n    ' FormatID if it is provided.\n    ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n\n    On Error GoTo ErrH:\n    If DataObj Is Nothing Then\n        Set DataObj = New MSForms.DataObject\n    End If\n\n    DataObj.SetText s\n    DataObj.PutInClipboard\n    PutInClipboard = True\n    Exit Function\nErrH:\n    PutInClipboard = False\n    Exit Function\nEnd Function\n\n\n\n' How to use this:\n\nSub Test()\n Dim Rng As Range\n Set Rng = ActiveSheet.Range(\"H2:I150\") ' change this to your range\n\n Call PutInClipboard(Rng, \"##,#0.0000000000\") ' change the formats as you need\n 'or\n 'Call PutInClipboard(Rng, \"##,#0.0000000000\", \"m/dd/yyyy\")\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "edited": false, "score": 0, "creation_date": 1453312000, "post_id": 34895884, "comment_id": 57549913, "body": "this was my first suggesting (in the question comments), when you didn&#39;t comment at it I thought it didn&#39;t work for you, so i posted my answer that provide another way."}, {"owner": {"reputation": 367, "user_id": 1568618, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/350a67b9caf53d86cf3fc43db63041c7?s=128&d=identicon&r=PG", "display_name": "Jakabfi Attila", "link": "https://stackoverflow.com/users/1568618/jakabfi-attila"}, "reply_to_user": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "edited": false, "score": 1, "creation_date": 1453462896, "post_id": 34895884, "comment_id": 57623043, "body": "Sorry Fadi, I missed it. Please put it as an answer and I&#39;ll award the bounty."}, {"owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "edited": false, "score": 0, "creation_date": 1453491879, "post_id": 34895884, "comment_id": 57640924, "body": "Jakabfi, no problem at all, it is clear that you found this answer before seeing my comment, So you can just accept your own answer to help other user to know that this is the correct answer for this question."}], "tags": [], "owner": {"reputation": 367, "user_id": 1568618, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/350a67b9caf53d86cf3fc43db63041c7?s=128&d=identicon&r=PG", "display_name": "Jakabfi Attila", "link": "https://stackoverflow.com/users/1568618/jakabfi-attila"}, "is_accepted": true, "score": 1, "last_activity_date": 1453281404, "creation_date": 1453281404, "answer_id": 34895884, "question_id": 34313757, "link": "https://stackoverflow.com/questions/34313757/excel-to-clipboard-with-macro-decimal-separator/34895884#34895884", "title": "Excel to clipboard with macro decimal separator", "body": "<p>The problem was</p>\n\n<pre><code>.UseSystemSeparators = True\n</code></pre>\n\n<p>setting this to false solves the problem.</p>\n"}], "owner": {"reputation": 367, "user_id": 1568618, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/350a67b9caf53d86cf3fc43db63041c7?s=128&d=identicon&r=PG", "display_name": "Jakabfi Attila", "link": "https://stackoverflow.com/users/1568618/jakabfi-attila"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 592, "favorite_count": 1, "accepted_answer_id": 34895884, "answer_count": 2, "score": 8, "last_activity_date": 1453281404, "creation_date": 1450273703, "last_edit_date": 1531161705, "question_id": 34313757, "link": "https://stackoverflow.com/questions/34313757/excel-to-clipboard-with-macro-decimal-separator", "title": "Excel to clipboard with macro decimal separator", "body": "<p>I would like to copy the contents of an excel file to the clipboard, using the same separators and format regardless of user configuration.</p>\n\n<p>Here's my macro:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n'save number separators\nDim d, t, u\nd = Application.DecimalSeparator\nt = Application.ThousandsSeparator\nu = Application.UseSystemSeparators\n\n'set number separators\nWith Application\n        .DecimalSeparator = \".\"\n        .ThousandsSeparator = \",\"\n        .UseSystemSeparators = True\nEnd With\n\n'create temporary copy\nActiveSheet.Copy\n\n'set number format\nActiveSheet.Range(\"H2:I150\").NumberFormat = \"0.0000000000\"\n\n[...]\n\n'copy sheet to clipboard\nActiveSheet.Range(\"A1:O150\").Copy\n\n'disable messages (clipboard)\nApplication.DisplayAlerts = False\n\n'close temporary copy\nActiveWorkbook.Close SaveChanges:=False\n\n'reenable messages\nApplication.DisplayAlerts = True\n\n'reset original separators\nWith Application\n        .DecimalSeparator = d\n        .ThousandsSeparator = t\n        .UseSystemSeparators = u\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>If I don't reset the original separators at the end, everything works fine, but this is not acceptable for me.</p>\n\n<p>If I do reset the separators (as seen in this code), then the contents of the clipboard are going to have the user specific separators, not the ones I defined at the beginning.</p>\n\n<p>Any ideas on how to fix this?</p>\n"}, {"tags": ["vb.net", "excel", "vba"], "comments": [{"owner": {"reputation": 1370, "user_id": 2717068, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1443043394/picture?type=large", "display_name": "Lubo\u0161 Suk", "link": "https://stackoverflow.com/users/2717068/lubo%c5%a1-suk"}, "edited": false, "score": 0, "creation_date": 1450273785, "post_id": 34313698, "comment_id": 56369084, "body": "Please describe your issue more and formate code as code."}, {"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 0, "creation_date": 1450274605, "post_id": 34313698, "comment_id": 56369669, "body": "Thats not the exact error message.  What is <code>source1</code> and even <code>ExcelDB</code> for that matter.  What type of control or object?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1450276748, "post_id": 34313698, "comment_id": 56371266, "body": "You can&#39;t declare and assign a variable (only a constant) in one statement, so this won&#39;t work: <code>Dim searchstring As String = &quot;&quot;</code>"}, {"owner": {"reputation": 5724, "user_id": 1655674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1440c2e508496b3e95684461a6ba6a95?s=128&d=identicon&r=PG", "display_name": "Dave Doknjas", "link": "https://stackoverflow.com/users/1655674/dave-doknjas"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1450277432, "post_id": 34313698, "comment_id": 56371781, "body": "@Rory: actually you can and you should."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 5724, "user_id": 1655674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1440c2e508496b3e95684461a6ba6a95?s=128&d=identicon&r=PG", "display_name": "Dave Doknjas", "link": "https://stackoverflow.com/users/1655674/dave-doknjas"}, "edited": false, "score": 0, "creation_date": 1450278273, "post_id": 34313698, "comment_id": 56372455, "body": "@DaveDoknjas This is also tagged Excel-VBA (which is why I saw it) and you can&#39;t in that."}], "answers": [{"tags": [], "owner": {"reputation": 5724, "user_id": 1655674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1440c2e508496b3e95684461a6ba6a95?s=128&d=identicon&r=PG", "display_name": "Dave Doknjas", "link": "https://stackoverflow.com/users/1655674/dave-doknjas"}, "is_accepted": false, "score": 0, "last_activity_date": 1450277373, "creation_date": 1450277373, "answer_id": 34315071, "question_id": 34313698, "link": "https://stackoverflow.com/questions/34313698/why-is-it-not-accepting-the-assignment-operator-and-how-do-i-fix-it/34315071#34315071", "title": "Why is it not accepting the assignment operator and how do i fix it", "body": "<p>As Plutonix said, that can't be the actual error message, but the main problem is that in VB you don't use '=' for testing identity of reference types, and I'm guessing that 'DataSource' is a reference type instance, so you must use 'Is':</p>\n\n<pre><code>If Not source1.DataSource Is ExcelDB.DataSource Then\n    source1.DataSource = ExcelDB.DataSource\nEnd If\n</code></pre>\n\n<p>or with newer syntax:</p>\n\n<pre><code>If source1.DataSource IsNot ExcelDB.DataSource Then\n    source1.DataSource = ExcelDB.DataSource\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5686908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a5b3a433e16b7b178ab4f8dd05b24e8?s=128&d=identicon&r=PG&f=1", "display_name": "Abdulaleem Saleh", "link": "https://stackoverflow.com/users/5686908/abdulaleem-saleh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1450277373, "creation_date": 1450273537, "last_edit_date": 1531164843, "question_id": 34313698, "link": "https://stackoverflow.com/questions/34313698/why-is-it-not-accepting-the-assignment-operator-and-how-do-i-fix-it", "title": "Why is it not accepting the assignment operator and how do i fix it", "body": "<pre><code>Sub searchfilter(ByVal mytextbox As TextBox, ByVal myfield As String)\n    If Not source1.DataSource = ExcelDB.DataSource Then\n        source1.DataSource = ExcelDB.DataSource\n    End If\n    ExcelDB.DataSource = source1\n    Dim searchstring As String = \"\"\n    If mytextbox.Text = \"\" Then\n        source1.RemoveFilter()\n    Else\n        source1.Filter = myfield &amp; \" = '\" &amp; mytextbox.Text &amp; \"'\"\n        addquery(myfield &amp; \"= '\" &amp; mytextbox.Text &amp; \"'\")\n    End If\nEnd Sub\n</code></pre>\n\n<p>In the if not statement it says that the = operation is not a datatype</p>\n"}, {"tags": ["javascript", "vba", "excel"], "comments": [{"owner": {"reputation": 2520, "user_id": 1307262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a11e97d5da4ec92d27df4c4fedde3e8d?s=128&d=identicon&r=PG&f=1", "display_name": "Red", "link": "https://stackoverflow.com/users/1307262/red"}, "edited": false, "score": 2, "creation_date": 1450271542, "post_id": 34312899, "comment_id": 56367504, "body": "Can you clarify what exactly is not working? What are the inputs, what you expect, what you actually get?"}, {"owner": {"reputation": 75, "user_id": 1686061, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/cb73cb28c4497c4c0b5eb1624906af54?s=128&d=identicon&r=PG", "display_name": "Amoeba", "link": "https://stackoverflow.com/users/1686061/amoeba"}, "reply_to_user": {"reputation": 2520, "user_id": 1307262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a11e97d5da4ec92d27df4c4fedde3e8d?s=128&d=identicon&r=PG&f=1", "display_name": "Red", "link": "https://stackoverflow.com/users/1307262/red"}, "edited": false, "score": 0, "creation_date": 1450271981, "post_id": 34312899, "comment_id": 56367817, "body": "I expect the same results that the VBA ones... I can&#39;t clarify much, cause I don&#39;t know the outputs in VBA line by line. The inputs are for example : y = 0 to 7; tour = 1; tri1 = 0 (first iteration); tri = 0 (first iteration); But is my &quot;translation&quot; is correct ?"}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 1686061, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/cb73cb28c4497c4c0b5eb1624906af54?s=128&d=identicon&r=PG", "display_name": "Amoeba", "link": "https://stackoverflow.com/users/1686061/amoeba"}, "edited": false, "score": 0, "creation_date": 1450283334, "post_id": 34313565, "comment_id": 56376205, "body": "After struggling with this a few hours, I found my mistake : &quot;And&quot; in VBA, in these case is &quot;&amp;&quot; in JS, the binary operator... Thanks anyway"}], "tags": [], "owner": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "is_accepted": false, "score": 2, "last_activity_date": 1450273210, "last_edit_date": 1495541748, "creation_date": 1450273210, "answer_id": 34313565, "question_id": 34312899, "link": "https://stackoverflow.com/questions/34312899/conversion-from-vba-to-javascript/34313565#34313565", "title": "Conversion from VBA to Javascript", "body": "<p>This is not a complete answer, but I think that information could get you to the goal. Because you are just trying to translate the words from vba to js. But js is not vba and js has some special things.</p>\n\n<p><strong>First: Floating numbers</strong></p>\n\n<p>A floating number in js is not always that like it looks like. That question here will give you more information about that topic:\n<a href=\"https://stackoverflow.com/questions/1458633/how-to-deal-with-floating-point-number-precision-in-javascript\">How to deal with floating point number precision in JavaScript?</a></p>\n\n<p>Because of the code snipets I don't know if one of your variables is a floating number. But if, you should know about that problem.</p>\n\n<p><strong>Second: Comparison</strong></p>\n\n<p>The way JS is handling comparisons is a litle bit different to some other languages. Some helpful links about that topic:</p>\n\n<ul>\n<li><a href=\"http://www.w3schools.com/js/js_comparisons.asp\" rel=\"nofollow noreferrer\">http://www.w3schools.com/js/js_comparisons.asp</a></li>\n<li><a href=\"https://stackoverflow.com/questions/359494/does-it-matter-which-equals-operator-vs-i-use-in-JavaScript-comparisons\">Which equals operator (== vs ===) should be used in JavaScript comparisons?</a></li>\n</ul>\n\n<p>Specially the comparisons in your code are not very clear. For example:</p>\n\n<pre><code>var a = 10;\nvar b = 0;\ndocument.write((a &amp;&amp; b) == 0); // is true\ndocument.write(a &amp;&amp; b) // is 0\nvar a = 10;\nvar b = 11;\ndocument.write((a &amp;&amp; b) == 0); // is false\ndocument.write(a &amp;&amp; b) // is 11\n</code></pre>\n\n<p>Is that really the behaviour you want to have? So try to simplify your comparisons and your code could work.</p>\n"}], "owner": {"reputation": 75, "user_id": 1686061, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/cb73cb28c4497c4c0b5eb1624906af54?s=128&d=identicon&r=PG", "display_name": "Amoeba", "link": "https://stackoverflow.com/users/1686061/amoeba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 948, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1450273210, "creation_date": 1450271200, "last_edit_date": 1531164843, "question_id": 34312899, "link": "https://stackoverflow.com/questions/34312899/conversion-from-vba-to-javascript", "title": "Conversion from VBA to Javascript", "body": "<p>I am trying to convert some VBA excel code to JS, but even I was sure of me, the code does not work properly.\nHere are the snippets which cause me problems :</p>\n\n<pre><code>VBA: Tri1 = Tri1 + 2 ^ (2 - Tour)\nJS: tri1 = tri1 + Math.pow(2, (2 - tour));\n</code></pre>\n\n<p>And:</p>\n\n<pre><code>VBA: If (y And (2 ^ (5 - Tour))) &lt;&gt; (Tri2 And 2 ^ (5 - Tour)) Then\nJS: if ((y &amp;&amp; Math.pow(2, 5 - tour)) != (tri2 &amp;&amp; Math.pow(2, 5 - tour)))\n</code></pre>\n\n<p>And :</p>\n\n<pre><code>VBA: If (Tri1 And 2 ^ (2 - Tour)) = 0 Then\nJS: if ((tri1 &amp;&amp; Math.pow(2, 2 - tour)) == 0)\n</code></pre>\n\n<p>tri1, tri2 and y are all integers.</p>\n\n<p>I have good understanding of JS, but none in VBA. So I googled a lot before already.</p>\n\n<p>Thanks !</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1641172"}, "edited": false, "score": 0, "creation_date": 1450272211, "post_id": 34312649, "comment_id": 56367971, "body": "What are you expecting dbDate to be? you aren&#39;t setting any value to it so it will be 0 and you aren&#39;t using the Date variable dDate"}, {"owner": {"reputation": 437, "user_id": 360315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10b3c6750423b686703600e6c7e2cb82?s=128&d=identicon&r=PG", "display_name": "Bob Phillips", "link": "https://stackoverflow.com/users/360315/bob-phillips"}, "edited": false, "score": 0, "creation_date": 1450273075, "post_id": 34312649, "comment_id": 56368547, "body": "Try this alternative Range(&quot;$11:$11&quot;).AutoFilter Field:=8, Criteria1:=&quot;&gt;&quot; &amp; CLng(dbDate), Operator:=xlAnd, Criteria2:=&quot;&lt;=&quot; &amp; CLng(dbDate)"}], "answers": [{"comments": [{"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1450337905, "post_id": 34314090, "comment_id": 56399536, "body": "Note that you are assuming that if the <code>AutoFilter</code> is <code>ON</code> the <code>FilterRange</code> is the range <code>rFilterRange</code> that is not a good assumption, you should clear the <code>AutoFilter</code> and Set it for the <code>rFilterRange</code>..."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1450348123, "post_id": 34314090, "comment_id": 56405848, "body": "True - there&#39;s nothing stopping another range having a filter applied and the code will just assume it&#39;s the correct range.  I&#39;ll update my code."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1450349439, "post_id": 34314090, "comment_id": 56406762, "body": "After the update suggested by EEM I&#39;ve now realised - if the filter returns no rows then <code>rFilterRange.Offset(1).Resize(rFilterRange.Rows.Count - 1).SpecialCells(xlCellTypeVisible).EntireRow.Delete Shift:=xlUp</code> will give error 1004 - no cells found."}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1450349032, "last_edit_date": 1450349032, "creation_date": 1450274619, "answer_id": 34314090, "question_id": 34312649, "link": "https://stackoverflow.com/questions/34312649/excel-vba-filter-deleting-data-updating/34314090#34314090", "title": "Excel VBA filter, deleting data &amp; updating", "body": "<p>The codes a bit messy near the bottom, and some thing's I'd normally push out to a separate function (find last cell for example).</p>\n\n<pre><code>Sub AutoDate()\n\n    Dim lastRow As Long\n    Dim lastUpdateRow As Long\n    Dim wrksht As Worksheet\n    Dim rFilterRange As Range\n\n    Set wrksht = ThisWorkbook.Worksheets(\"master\")\n\n    'Any statement that starts with a '.' applies to wrksht (With... End With)\n    With wrksht\n        lastRow = .Cells(Rows.Count, \"A\").End(xlUp).Row\n\n        'The range to be filtered - currently columns A:J (columns 1 - 10)\n        Set rFilterRange = .Range(.Cells(11, 1), .Cells(lastRow, 10))\n\n        'Turn off the autofilter if it's already on.\n        If .AutoFilterMode Then\n              wrksht.AutoFilterMode = False\n        End If\n        'Apply filter to correct range.\n        rFilterRange.AutoFilter\n\n        If IsDate(.Range(\"B9\")) Then\n            'Apply filter.\n            rFilterRange.AutoFilter Field:=8, Criteria1:=\"&gt;\" &amp; .Range(\"B9\")\n            If .FilterMode Then\n                'Resize to ignore header row &amp; delete visible rows.\n                rFilterRange.Offset(1).Resize(rFilterRange.Rows.Count - 1) _\n                    .SpecialCells(xlCellTypeVisible).EntireRow.Delete Shift:=xlUp\n                .ShowAllData\n            End If\n\n            'Find new last row.\n            lastRow = .Cells(Rows.Count, \"A\").End(xlUp).Row + 1\n            Set rFilterRange = .Range(.Cells(11, 1), .Cells(lastRow, 10))\n\n            lastUpdateRow = ThisWorkbook.Worksheets(\"Update\").Cells(Rows.Count, \"A\").End(xlUp).Row\n            rFilterRange.Offset(1).Resize(rFilterRange.Rows.Count - 1).Copy _\n                Destination:=ThisWorkbook.Worksheets(\"Update\").Cells(lastUpdateRow, 1)\n\n        End If\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": false, "score": 0, "last_activity_date": 1450372976, "creation_date": 1450372976, "answer_id": 34340629, "question_id": 34312649, "link": "https://stackoverflow.com/questions/34312649/excel-vba-filter-deleting-data-updating/34340629#34340629", "title": "Excel VBA filter, deleting data &amp; updating", "body": "<p><strong>Requirements:</strong></p>\n\n<ol>\n<li>Filter Column H in sheet <code>master</code> to select dates before a date located in same sheet at <code>B9</code></li>\n<li>Delete filtered lines</li>\n<li>Copy from sheet <code>update</code> range <code>A:18</code> <em>dynamically to last column &amp; last row</em></li>\n<li>Paste range from previous point in the <em>last row + 1</em> of sheet <code>master</code></li>\n</ol>\n\n<p><strong>Assumptions:</strong> <em>(in line with code posted)</em>:</p>\n\n<ol>\n<li>Data range in sheet <code>master</code> starts at <code>A11</code> and all cells in columns 8 of the data range have same <code>NumberFormat</code></li>\n<li>Data range in sheet <code>update</code> starts at <code>A18</code></li>\n<li>Data ranges in both sheets are continuous <em>(i.e. no blank rows nor blank columns in between)</em></li>\n<li>Copy of the data includes formulas &amp; formats</li>\n</ol>\n\n<p><em>Thy this code:</em></p>\n\n<pre><code>Option Explicit\n\nSub Rng_AutoFilter_Delete_And_Paste()\nDim WshMaster As Worksheet, WshUpdate As Worksheet\nDim rMaster As Range, rUpdate As Range\nDim dDate As Date\nDim rTmp As Range\n\n    Rem Application Settings - OFF\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n    Application.EnableEvents = False\n\n    Rem Set Worksheet Object - End Procedure If any of them is not present\n    With ThisWorkbook\n        On Error GoTo ExitTkn\n        Set WshMaster = .Sheets(\"master\")\n        Set WshUpdate = .Sheets(\"update\")\n        On Error GoTo 0\n    End With\n\n    If IsDate(WshMaster.Range(\"B9\")) Then\n\n        Rem Cleared Records in Wsh Master\n        With WshMaster\n            Rem Set Date to Filter By\n            dDate = .Range(\"B9\")\n\n            Rem Set Data Ramge in Wsh Master\n            'Assumes range start at `A11` and it's continuous (i.e. no blank rows nor blank columns in between)\n            Set rMaster = .Range(\"A11\").CurrentRegion\n\n            Rem Set AutoFilter\n            'Use the `AutoFilter` property instead of the `AutoFilterMode` property\n            If Not (.AutoFilter Is Nothing) Then .Cells(1).AutoFilter\n            rMaster.AutoFilter\n        End With\n\n        With rMaster\n            Rem Filter and Delete Records in Wsh Master\n            'Uses the `NumberFormat` to build the Filter Criteria\n            'Assumes all cells in has same `NumberFormat`\n            .AutoFilter Field:=8, Criteria1:=\"&gt;\" &amp; Format(dDate, .Cells(2, 8).NumberFormat)\n            'Sets a Temp Range to grab the Filter results\n            On Error Resume Next\n            Set rTmp = .Offset(1).Resize(-1 + .Rows.Count).Columns(8).SpecialCells(xlCellTypeVisible)\n            On Error GoTo 0\n            'If Temp Range is `Nothing` then there is `Nothing` to delete\n            If Not (rTmp Is Nothing) Then rTmp.EntireRow.Delete\n            .Worksheet.ShowAllData\n        End With\n\n        Rem Set Data Range in Wsh Update\n        With WshUpdate\n\n            Rem Set Data Range in Wsh Update\n            'Assumes range start at `A18` and it's continuous (i.e. no blank rows nor blank columns in between)\n            Set rUpdate = .Range(\"A18\").CurrentRegion\n\n            Rem Set AutoFilter\n            If Not (.AutoFilter Is Nothing) Then .Cells(1).AutoFilter\n            rUpdate.AutoFilter\n        End With\n\n        Rem Paste Records from Wsh Update into Wsh Master\n        rUpdate.Copy\n        'In line with code posted this assumes OP wants to copy the data as it is (i.e. including formulas &amp; format)\n        rMaster.Offset(rMaster.Rows.Count).Resize(1, 1).PasteSpecial\n        Application.CutCopyMode = False\n        Application.Goto WshMaster.Cells(1), 1\n\n    End If\n\nExitTkn:\n    Rem Application Settings - ON\n    Application.ScreenUpdating = True\n    Application.DisplayAlerts = True\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n\n<p>Suggest to read the following pages to gain a deeper understanding of the resources used:</p>\n\n<p><a href=\"http://www.excelfunctions.net/Excel-Objects.html\" rel=\"nofollow\">Excel Objects</a>, <a href=\"https://msdn.microsoft.com/en-us/library/office/gg251688.aspx\" rel=\"nofollow\">On Error Statement</a>, <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838238.aspx\" rel=\"nofollow\">Range Object (Excel)</a>, <a href=\"http://www.excelfunctions.net/VBA-Variables-And-Constants.html\" rel=\"nofollow\">Variables &amp; Constants</a>, </p>\n\n<p><a href=\"https://msdn.microsoft.com/EN-US/library/office/ff823161.aspx\" rel=\"nofollow\">Worksheet.AutoFilter Property (Excel)</a>, <a href=\"https://msdn.microsoft.com/EN-US/library/office/ff821903.aspx\" rel=\"nofollow\">Worksheet.AutoFilterMode Property (Excel)</a>, </p>\n\n<p><a href=\"https://msdn.microsoft.com/EN-US/library/office/ff194464.aspx\" rel=\"nofollow\">Worksheet Object (Excel)</a>, <a href=\"https://msdn.microsoft.com/EN-US/library/office/gg264723.aspx\" rel=\"nofollow\">With Statement</a></p>\n\n<p>I have also done a review of your code see below <em>(including only lines with comments)</em>:</p>\n\n<pre><code>'lastRow variable is not declared.\n'Suggest to always have Option Explicit at the begining of the module\n'To do it goto Main Menu \\ Options \\ Tab: Editor \\ Check: Require Variable Declaration\nlastRow = ActiveSheet.Cells(Rows.Count, \"A\").End(xlUp).Row + 1  'This is done too early as it will change after deletion of filtered rows\n\ndbDate = DateSerial(Year(dbDate), Month(dbDate), Day(dbDate) + 1)   'Have no purpose as no value have been assigned to the variable as yet\n\nApplication.ScreenUpdating = False  'this should be done at the beginning\n\nSheets(\"master\").Select 'should be qualified\n\ndbDate = DateSerial(Year(dbDate), Month(dbDate), Day(dbDate)) + _\n    TimeSerial(Hour(dbDate), Minute(dbDate), Second(dbDate))    'This line achieves nothing.\n\nRange(\"H11\").Select 'Select should be avoided, instead work with objects\n\nSelection.AutoFilter    'Sould check first is the AutoFilter is ON\n\nRange(\"$11:$11\").AutoFilter Field:=8, Criteria1:=\"&gt;\" &amp; dbDate   'Should filter the entire range\n\nOn Error Resume Next    'On error should be used for specific purposes and cleared after with On Error Goto 0\n\nSelection.PasteSpecial   'After paste the Clipboard must be cleared with Application.CutCopyMode = False\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 4252031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c65b0239b3a421ea523faae28a124386?s=128&d=identicon&r=PG&f=1", "display_name": "Werra2006", "link": "https://stackoverflow.com/users/4252031/werra2006"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1381, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1450372976, "creation_date": 1450270456, "last_edit_date": 1450274109, "question_id": 34312649, "link": "https://stackoverflow.com/questions/34312649/excel-vba-filter-deleting-data-updating", "title": "Excel VBA filter, deleting data &amp; updating", "body": "<p>Could someone please help with my code, I am not a million miles away from what I am looking to do but I have now come unstuck and reached a dead end. I have no programming experience &amp; am no expert with VBA so what I have done might not make sense, or look silly; please bear with me as I am learning.      </p>\n\n<p>What I want to do is be able to:</p>\n\n<ol>\n<li>Filter Column H in sheet \u201cmaster\u201d to select dates before a date\nwhich I will input  in Range \u201cB9\u201d.</li>\n<li>Delete the filtered  lines</li>\n<li>Go to sheet \u201cupdate\u201d</li>\n<li>Copy from A:18 dynamically to last column &amp; last row</li>\n<li>Paste everything in the last row in sheet \u201cmaster\u201d</li>\n</ol>\n\n<p>Problem I have is that the filter for the date is not working</p>\n\n<pre><code>Sub AUTODATE()\n\nDim dDate As Date\nDim dbDate As Double\nlastRow = ActiveSheet.Cells(Rows.Count, \"A\").End(xlUp).Row + 1\ndbDate = DateSerial(Year(dbDate), Month(dbDate), Day(dbDate) + 1)\nApplication.ScreenUpdating = False\nSheets(\"master\").Select\n\nIf IsDate(Range(\"B9\")) Then\n\ndbDate = Range(\"B9\")\ndbDate = DateSerial(Year(dbDate), Month(dbDate), Day(dbDate)) + _\n TimeSerial(Hour(dbDate), Minute(dbDate), Second(dbDate))\n        Range(\"H11\").Select\n        Range(Selection, Selection.End(xlDown)).Select\n        Selection.AutoFilter\n        Range(\"$11:$11\").AutoFilter Field:=8, Criteria1:=\"&gt;\" &amp; dbDate\n        Range(\"$12:12\").Select\n        Range(Selection, Selection.End(xlDown)).Select\n        Selection.SpecialCells _\n        (xlCellTypeVisible).EntireRow.Delete\n            Range(\"A11\").Select\n            On Error Resume Next\n            ActiveSheet.ShowAllData\n               Sheets(\"update\").Select\n               ActiveSheet.ShowAllData\n               Range(\"$18:$18\").Select\n               Range(Selection, Selection.End(xlDown)).Select\n               Selection.Copy\n           Sheets(\"master\").Select\n           Range(\"A\" &amp; lastRow).Select\n           Selection.PasteSpecial\n    End If\n  Application.ScreenUpdating = False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "pivot"], "comments": [{"owner": {"reputation": 437, "user_id": 360315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10b3c6750423b686703600e6c7e2cb82?s=128&d=identicon&r=PG", "display_name": "Bob Phillips", "link": "https://stackoverflow.com/users/360315/bob-phillips"}, "edited": false, "score": 0, "creation_date": 1450272301, "post_id": 34312508, "comment_id": 56368038, "body": "I think you need to replace Activesheet with the actual sheet object that contains the pivot (at the least)."}, {"owner": {"reputation": 1367, "user_id": 3343071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4a7e01c427c8d9daa8d944e9cd1d1410?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelH", "link": "https://stackoverflow.com/users/3343071/miguelh"}, "reply_to_user": {"reputation": 437, "user_id": 360315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10b3c6750423b686703600e6c7e2cb82?s=128&d=identicon&r=PG", "display_name": "Bob Phillips", "link": "https://stackoverflow.com/users/360315/bob-phillips"}, "edited": false, "score": 0, "creation_date": 1450280358, "post_id": 34312508, "comment_id": 56373901, "body": "Thanks @BobPhillips. I did try this, but still no joy!"}, {"owner": {"reputation": 1367, "user_id": 3343071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4a7e01c427c8d9daa8d944e9cd1d1410?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelH", "link": "https://stackoverflow.com/users/3343071/miguelh"}, "reply_to_user": {"reputation": 437, "user_id": 360315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10b3c6750423b686703600e6c7e2cb82?s=128&d=identicon&r=PG", "display_name": "Bob Phillips", "link": "https://stackoverflow.com/users/360315/bob-phillips"}, "edited": false, "score": 0, "creation_date": 1450281802, "post_id": 34312508, "comment_id": 56375075, "body": "I&#39;ve also tried moving this sub into the Worksheet (rather than calling the Module) but this doesn&#39;t work either!"}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1450444448, "post_id": 34312508, "comment_id": 56454412, "body": "1) Would you please confirm that the intent is to filter a <code>PivotField</code> based in another <code>PivotField</code>? If so please publish a picture of the PivotTable indicating the <code>PivotFields</code> involved, in order to increase your chances of getting a working solution. 2) Do you have worksheets with more than one <code>PivotTables</code>?"}, {"owner": {"reputation": 1367, "user_id": 3343071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4a7e01c427c8d9daa8d944e9cd1d1410?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelH", "link": "https://stackoverflow.com/users/3343071/miguelh"}, "reply_to_user": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1450447004, "post_id": 34312508, "comment_id": 56455926, "body": "Many thanks @EEM. I&#39;ve updated my question with a screenshot of the pivot. There are other worksheets in the workbook with data, but these only have single <code>PivotTable</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1367, "user_id": 3343071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4a7e01c427c8d9daa8d944e9cd1d1410?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelH", "link": "https://stackoverflow.com/users/3343071/miguelh"}, "edited": false, "score": 0, "creation_date": 1450691000, "post_id": 34363314, "comment_id": 56526526, "body": "Many thanks @EEM. This works a treat in almost all cases! One complication I can&#39;t seem  to resolve though is where I create the calculated fields/Names within the script itself (during Worksheet Open). However, I can use my alternate code in these cases!"}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "reply_to_user": {"reputation": 1367, "user_id": 3343071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4a7e01c427c8d9daa8d944e9cd1d1410?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelH", "link": "https://stackoverflow.com/users/3343071/miguelh"}, "edited": false, "score": 0, "creation_date": 1450714731, "post_id": 34363314, "comment_id": 56541328, "body": "Glad it solved your issue, however it&#39;s strange what you reported about calculated fields. It should work with then as I tested with calculated fields as well. Check the <code>PivotField</code> name you are using..."}], "tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": true, "score": 1, "last_activity_date": 1450469746, "creation_date": 1450469746, "answer_id": 34363314, "question_id": 34312508, "link": "https://stackoverflow.com/questions/34312508/excel-vba-for-pivot-value-using-xlvalueisbetween/34363314#34363314", "title": "Excel VBA for pivot Value using xlValueIsBetween", "body": "<p><strong>Requirement:</strong>\nTo filter a Pivot <code>RowField</code> based on a Pivot <code>DataField</code></p>\n\n<p>This procedure uses the <code>PivotField.SourceName</code> to validate &amp; set the <code>DataField</code> to apply the Filter Type and Values.</p>\n\n<pre><code>Sub Ptb_Filter_Between(WshTrg As Worksheet, _\n    sFldTrg As String, sFldDta As String, dFromVal As Double, dToValue As Double)\nDim pTbl As PivotTable, pFldDta As PivotField\n\n    Rem Application Settings - OFF\n    Application.ScreenUpdating = False\n    Application.EnableEvents = False\n\n    Rem Set PivotTable\n    'Using Index 1 as OP confirmed there is only one PivotTable per Sheet\n    'If this condition change then PivotTable Index should be provided as an argument\n    Set pTbl = ActiveSheet.PivotTables(1)\n    With pTbl\n\n        Rem Set DataField - User provides the Data Field\n        For Each pFldDta In .DataFields\n            If pFldDta.SourceName = sFldDta Then Exit For\n        Next\n        If pFldDta Is Nothing Then GoTo ExitTkn\n\n        Rem Filter PivotField\n        .ClearAllFilters    'Use this line to clear all PivotTable Filters\n        On Error GoTo ExitTkn\n        With .PivotFields(sFldTrg)\n            .ClearAllFilters    'This line clears all PivotField Filters\n            .PivotFilters.Add2 Type:=xlValueIsBetween, _\n                DataField:=pFldDta, Value1:=dFromVal, Value2:=dToValue\n    End With: End With\n\nExitTkn:\n    Rem Application Settings - ON\n    Application.ScreenUpdating = True\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n\n<p>These are some samples of how to call the procedure:</p>\n\n<pre><code>sFldTrg = \"Type\"\nsFldDta = \"Amount\"\ndFromVal = 25000\ndToValue = 30000\n    Call Ptb_Filter_Between(Worksheet Object, sFldTrg, sFldDta, dFromVal, dToValue)\n\nsFldTrg = \"Type\"\nsFldDta = \"YTD%\"\ndFromVal = 0.3\ndToValue = 0.35\n    Call Ptb_Filter_Between(Worksheet Object, sFldTrg, sFldDta, dFromVal, dToValue)\n\nsFldTrg = \"Row\"\nsFldDta = \"YTD%\"\ndFromVal = 0.1  'To set from value as 10%\ndToValue = 0.2  'To set to value as 20%\n    Call Ptb_Filter_Between(Worksheet Object, sFldTrg, sFldDta, dFromVal, dToValue)\n</code></pre>\n"}], "owner": {"reputation": 1367, "user_id": 3343071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4a7e01c427c8d9daa8d944e9cd1d1410?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelH", "link": "https://stackoverflow.com/users/3343071/miguelh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1266, "favorite_count": 0, "accepted_answer_id": 34363314, "answer_count": 1, "score": 0, "last_activity_date": 1450469746, "creation_date": 1450270072, "last_edit_date": 1592644375, "question_id": 34312508, "link": "https://stackoverflow.com/questions/34312508/excel-vba-for-pivot-value-using-xlvalueisbetween", "title": "Excel VBA for pivot Value using xlValueIsBetween", "body": "<p>I am trying to create a module to share functionality across a number of worksheets within a single workbook. All works fine apart from some filter code.\n<br><br>The code below works fine if I place it in a single worksheet</p>\n<pre><code>ActiveSheet.PivotTables(&quot;PivotTable1&quot;).PivotFields(&quot;MyField&quot;). _\n    ClearValueFilters\n ActiveSheet.PivotTables(&quot;PivotTable1&quot;).PivotFields(&quot;MyField&quot;).PivotFilters.Add Type:=xlValueIsBetween, DataField:=ActiveSheet.PivotTables _\n    (&quot;PivotTable1&quot;).PivotFields(&quot;MyValue&quot;), Value1:=bottom, Value2:=Top\n</code></pre>\n<p>However, I want to use this code in my Module and send it the following:<br><br> Pivot Table Name, <br>Row PivotField, <br>Value Pivot field<br>top &quot;between&quot; value<br>bottom &quot;between&quot; value</p>\n<p>Something like:</p>\n<p>The sheet call</p>\n<pre><code>Call Mod_Filter(&quot;PivotTable1&quot;, &quot;MyRowFieldName&quot;, &quot;MyValueFieldName&quot;, 0, intvalue)\n</code></pre>\n<p>The Module code</p>\n<pre><code>Public Sub Mod_Filter(ByRef PT_Name As String, ByRef StaticField As String, ByRef Filter_field As String, bottom As Double, Top As Double)\n     ActiveSheet.PivotTables(PT_Name).PivotFields(StaticField).ClearValueFilters\n     ActiveSheet.PivotTables(PT_Name).PivotFields(StaticField).PivotFilters.Add Type:=xlValueIsBetween, DataField:=ActiveSheet.PivotTables _\n    (PT_Name).PivotFields(Filter_field), Value1:=bottom, Value2:=Top\nEnd Sub\n</code></pre>\n<p>However, I cannot get this to work. Any suggestions??</p>\n<p><a href=\"https://i.stack.imgur.com/HBopp.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HBopp.jpg\" alt=\"enter image description here\" /></a></p>\n<p>So I'm using the &quot;St&quot; Row to filter the YTD% based on a value selected from a dropdown combo box</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 47, "user_id": 5684045, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208025242246072/picture?type=large", "display_name": "Bernes Lase", "link": "https://stackoverflow.com/users/5684045/bernes-lase"}, "is_accepted": true, "score": 0, "last_activity_date": 1450272123, "creation_date": 1450272123, "answer_id": 34313205, "question_id": 34312135, "link": "https://stackoverflow.com/questions/34312135/extracting-unique-values-from-access-table-and-creating-an-array-which-can-be-us/34313205#34313205", "title": "Extracting unique values from Access Table and Creating an array which can be used in a combo box", "body": "<pre><code>\"SELECT DISTINCT qteVehicleDetails.* FROM qteVehicleDetails WHERE (qteVehicleDetails.policyno=\" &amp; LoadQuoteDetails.Controls(\"PolicyNo\").Value &amp; \" AND qteVehicleDetails.Class=\" &amp; LoadQuoteDetails.Controls(\"Class\").Value &amp; \");\"\n</code></pre>\n\n<p>you can try add 'distinct' in your sql script</p>\n"}], "owner": {"reputation": 35, "user_id": 5534721, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/2710a7cf4de3d32d45d70f4e634eb6ee?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Brophy", "link": "https://stackoverflow.com/users/5534721/matthew-brophy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 628, "favorite_count": 0, "accepted_answer_id": 34313205, "answer_count": 1, "score": 0, "last_activity_date": 1450272823, "creation_date": 1450269052, "last_edit_date": 1450272823, "question_id": 34312135, "link": "https://stackoverflow.com/questions/34312135/extracting-unique-values-from-access-table-and-creating-an-array-which-can-be-us", "title": "Extracting unique values from Access Table and Creating an array which can be used in a combo box", "body": "<p>I want to be able to extract details from an Access database to my excel workbook. I have created a userform where the user enters the policy number  and then click a command button that should provide a another userform with a dropdown list of all the quotes for that policy</p>\n\n<p>The access database table contains multiple rows for a given quote but I want to be able to extract a list of unique quote ids for the policy from which the user can select the quote they want to load the details for.</p>\n\n<p>Below is an extract from the Access database (table name qteVehicleDetails, database name QuoteDB)</p>\n\n<p><a href=\"http://i.stack.imgur.com/OiyMz.gif\" rel=\"nofollow\">Database Extract</a></p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim dbQuoteDB As Database\nDim rTemp As Recordset\nDim sSQL As String\n\n\n\nSet dbQuoteDB = OpenDatabase(QuoteDB, False, False, \"MS Access;PWD=***\")\n\n    sSQL = \"SELECT qteVehicleDetails.* FROM qteVehicleDetails WHERE (qteVehicleDetails.policyno=\" &amp; LoadQuoteDetails.Controls(\"PolicyNo\").Value &amp; \" AND qteVehicleDetails.Class=\" &amp; LoadQuoteDetails.Controls(\"Class\").Value &amp; \");\"\n    Set rTemp = dbQuoteDB.OpenRecordset(sSQL)\n\n    Do Until rTemp.EOF\n\n    ???\n\n\n\n    rTemp.MoveNext\n\n\nEnd Sub\n</code></pre>\n\n<p>I want to be able to extract a list of unique quotes ids for a given policy (you will see from the database extract that there are duplicates) </p>\n\n<p>Then I want to save this as a range which can be used to populate the combo box in the second userform.</p>\n"}, {"tags": ["excel", "vba", "url", "pdf", "browser"], "comments": [{"owner": {"reputation": 5795, "user_id": 1682924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09267d283f9e9b779ae68df72584ca99?s=128&d=identicon&r=PG", "display_name": "David van Driessche", "link": "https://stackoverflow.com/users/1682924/david-van-driessche"}, "edited": false, "score": 0, "creation_date": 1450270204, "post_id": 34312087, "comment_id": 56366519, "body": "If you can&#39;t use software on the servers these URL&#39;s point to, and you don&#39;t want to download the PDF files, how do you suggest to know anything about the files? Me thinks you&#39;ve defined a physical impossibility here..."}, {"owner": {"reputation": 15, "user_id": 5686103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4ab0963fda49654d06a576ac700c714?s=128&d=identicon&r=PG&f=1", "display_name": "Aravind Palani", "link": "https://stackoverflow.com/users/5686103/aravind-palani"}, "reply_to_user": {"reputation": 5795, "user_id": 1682924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09267d283f9e9b779ae68df72584ca99?s=128&d=identicon&r=PG", "display_name": "David van Driessche", "link": "https://stackoverflow.com/users/1682924/david-van-driessche"}, "edited": false, "score": 0, "creation_date": 1450276744, "post_id": 34312087, "comment_id": 56371262, "body": "If any software is there, suggest that. So i can try it out."}, {"owner": {"reputation": 5795, "user_id": 1682924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09267d283f9e9b779ae68df72584ca99?s=128&d=identicon&r=PG", "display_name": "David van Driessche", "link": "https://stackoverflow.com/users/1682924/david-van-driessche"}, "edited": false, "score": 1, "creation_date": 1450291517, "post_id": 34312087, "comment_id": 56381157, "body": "If it&#39;s physically impossible, how can anyone suggest software? Moreover, asking for software recommendations on Stackoverflow is out-of-bounds."}], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 5450978, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FjfqjFX9NGk/AAAAAAAAAAI/AAAAAAAAA9s/BRty0hhDyLU/photo.jpg?sz=128", "display_name": "Nicolas Mastromarino", "link": "https://stackoverflow.com/users/5450978/nicolas-mastromarino"}, "edited": false, "score": 0, "creation_date": 1450278939, "post_id": 34315579, "comment_id": 56372881, "body": "I forgot to clarify : it is a custom function to excel!!"}, {"owner": {"reputation": 15, "user_id": 5686103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4ab0963fda49654d06a576ac700c714?s=128&d=identicon&r=PG&f=1", "display_name": "Aravind Palani", "link": "https://stackoverflow.com/users/5686103/aravind-palani"}, "edited": false, "score": 0, "creation_date": 1450337353, "post_id": 34315579, "comment_id": 56399240, "body": "Nicolas, Thanks for the work. However, the document created date and modified date gives a wrong data. It shows the actual time. Is there an any solution for that?"}], "tags": [], "owner": {"reputation": 91, "user_id": 5450978, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FjfqjFX9NGk/AAAAAAAAAAI/AAAAAAAAA9s/BRty0hhDyLU/photo.jpg?sz=128", "display_name": "Nicolas Mastromarino", "link": "https://stackoverflow.com/users/5450978/nicolas-mastromarino"}, "is_accepted": true, "score": 0, "last_activity_date": 1450278836, "creation_date": 1450278836, "answer_id": 34315579, "question_id": 34312087, "link": "https://stackoverflow.com/questions/34312087/extract-pdf-properties-from-the-pdf-url/34315579#34315579", "title": "Extract pdf properties from the pdf URL", "body": "<p>well... i was writing a bit and searching the Internet for a solution to this... </p>\n\n<p>solution without downloading the file not found, and didn't think possible.</p>\n\n<p>but this I made a code that downloads the file , gets its properties , and then deletes it. all completely transparent to the user.</p>\n\n<p>HOW TO USE:\nany cell type\n=GetPDFData(URL;NumberData)</p>\n\n<p>for ex:\n=getPDFData(A2;1)</p>\n\n<p>NumbersData:</p>\n\n<p>1 = Name</p>\n\n<p>2 = DateCreated</p>\n\n<p>3 = DateModificated</p>\n\n<p>4 = PageCount (is \"Beta\" , sometimes not work lol )</p>\n\n<p>5 = size</p>\n\n<p>6 = kind</p>\n\n<p>And the Code: (paste this in a new module)</p>\n\n<pre><code>Public Function GetPDFData(URL As String, TipoDato As Integer) As String\n\n    Dim oFS As Object\n    Dim strFilename As String\n    CreateFolder\n    DownloadFile (URL)\n    strFilename = \"C:\\Temp\\pdfTemporal\\\" &amp; NombreDeArchivo(URL)\n    Set oFS = CreateObject(\"Scripting.FileSystemObject\")\n    Select Case TipoDato\n        Case 1\n        GetPDFData = NombreDeArchivo(URL)\n        Case 2\n        GetPDFData = oFS.GetFile(strFilename).DateCreated\n        Case 3\n        GetPDFData = oFS.GetFile(strFilename).DateLastModified\n        Case 4\n        GetPDFData = pagecount(strFilename)\n        Case 5\n        GetPDFData = oFS.GetFile(strFilename).Size / 1024 &amp; \"Kb\"\n        Case 6\n        GetPDFData = oFS.GetFile(strFilename).Type\n        Case Else\n        GetPDFData = \"ERROR\"\n    End Select\n    Set oFS = Nothing\n    DeleteFolder\n\nEnd Function\n\nSub DownloadFile(myURL As String)\n\n    Dim TextUrl As String\n    TextUrl = myURL\n    Dim WinHttpReq As Object\n    Set WinHttpReq = CreateObject(\"Microsoft.XMLHTTP\")\n    WinHttpReq.Open \"GET\", myURL, False\n    WinHttpReq.send\n    myURL = WinHttpReq.responseBody\n    If WinHttpReq.Status = 200 Then\n        Set oStream = CreateObject(\"ADODB.Stream\")\n        oStream.Open\n        oStream.Type = 1\n        oStream.Write WinHttpReq.responseBody\n        oStream.SaveToFile \"c:\\Temp\\pdfTemporal\\\" &amp; NombreDeArchivo(TextUrl), 2 ' 1 = no overwrite, 2 = overwrite\n        oStream.Close\n    End If\n\nEnd Sub\n\nSub CreateFolder()\n    Dim Path As String, NombreCarpeta As String\n    Path = \"c:\\Temp\\\"\n    NombreCarpeta = \"pdfTemporal\"\n     If Dir(Path, vbDirectory) &lt;&gt; \"\" Then\n       If Dir(Path &amp; NombreCarpeta, vbDirectory) = \"\" Then MkDir Path &amp; NombreCarpeta\n     End If\nEnd Sub\n\nSub DeleteFolder()\n    On Error Resume Next\n     Kill \"c:\\Temp\\pdfTemporal\\*.*\"\n    RmDir \"c:\\Temp\\pdfTemporal\\\"\n    On Error GoTo 0\nEnd Sub\n\nPublic Function NombreDeArchivo(URL As String) As String\n\nDim a As String\nDim esp As String\nesp = \" \"\na = URL\nFor i = 1 To 500\n esp = esp &amp; \" \"\nNext i\na = Replace(a, \"/\", esp)\na = Right(a, 500)\na = Trim(a)\nNombreDeArchivo = a\n\nEnd Function\n\nPublic Function pagecount(sfilename As String) As String\nDim pages As Long\nOn Error GoTo a\nDim nFileNum As Integer\nDim s As String\nDim c As Integer\nDim pos, pos1 As Integer\npos = 0\npos1 = 0\nc = 0\nnFileNum = FreeFile\nOpen sfilename For Binary Lock Read Write As #nFileNum\n\n  Do Until EOF(nFileNum)\n    Input #1, s\n    c = c + 1\n    If c &lt;= 10 Then\n        pos = InStr(s, \"/N\")\n    End If\n    pos1 = InStr(s, \"/count\")\n       If pos &gt; 0 Or pos1 &gt; 0 Then\n            Close #nFileNum\n            s = Trim(Mid(s, pos, 10))\n            s = Replace(s, \"/N\", \"\")\n            s = Replace(s, \"/count\", \"\")\n            s = Replace(s, \" \", \"\")\n            s = Replace(s, \"/\", \"\")\n            For i = 65 To 125\n                    s = Replace(s, Chr(i), \"\")\n            Next\n            pages = Val(Trim(s))\n            If pages &lt; 0 Then\n                pages = 1\n            End If\n            Close #nFileNum\n            pagecount = pages\n            Exit Function\n        End If\n        If c &gt;= 10000 Then\n             GoTo a\n        End If\n  Loop\n    Close #nFileNum\n    pagecount = pages\n    Exit Function\na:\n    Close #nFileNum\n    pages = 1\n    pagecount = pages\n    Exit Function\nEnd Function\n</code></pre>\n\n<p>I hope you find it useful, or at least a start</p>\n\n<p>Greetings!</p>\n"}], "owner": {"reputation": 15, "user_id": 5686103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4ab0963fda49654d06a576ac700c714?s=128&d=identicon&r=PG&f=1", "display_name": "Aravind Palani", "link": "https://stackoverflow.com/users/5686103/aravind-palani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 542, "favorite_count": 0, "accepted_answer_id": 34315579, "answer_count": 1, "score": -2, "last_activity_date": 1450278836, "creation_date": 1450268909, "question_id": 34312087, "link": "https://stackoverflow.com/questions/34312087/extract-pdf-properties-from-the-pdf-url", "title": "Extract pdf properties from the pdf URL", "body": "<p>I have a set of 4000 pdf url's which need to extract the document properties such as document created date, document size, number of pages. </p>\n\n<p><strong>Note:</strong> PDF document should not to be downloaded.</p>\n\n<p>Please give me a suggestion.</p>\n\n<p>Regards,\nAravind</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1450272775, "post_id": 34311512, "comment_id": 56368349, "body": "So you have checked and there are at least 8 DIVs inside hte element with the <b>rhs_block</b> ID  and inside the eighth DIV there are at least 3 As and inside the third A there are at least one SPAN and that span has text. Correct?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1450273064, "post_id": 34311512, "comment_id": 56368540, "body": "<code>getElementById</code> doesn&#39;t return a collection. It should only return a single element. You do not need the <code>(0)</code>."}, {"owner": {"reputation": 2788, "user_id": 4139024, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/qOcL9.jpg?s=128&g=1", "display_name": "blckbird", "link": "https://stackoverflow.com/users/4139024/blckbird"}, "edited": false, "score": 0, "creation_date": 1450277845, "post_id": 34311512, "comment_id": 56372076, "body": "Do you get runtime error 424 or 91?"}, {"owner": {"reputation": 965, "user_id": 2269164, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/d3d1bcc7c0bc38e6addce3d15c02168c?s=128&d=identicon&r=PG", "display_name": "user2269164", "link": "https://stackoverflow.com/users/2269164/user2269164"}, "edited": false, "score": 0, "creation_date": 1450340848, "post_id": 34311512, "comment_id": 56401060, "body": "After Removing (0) from id now, it is showing runtime error 91."}, {"owner": {"reputation": 965, "user_id": 2269164, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/d3d1bcc7c0bc38e6addce3d15c02168c?s=128&d=identicon&r=PG", "display_name": "user2269164", "link": "https://stackoverflow.com/users/2269164/user2269164"}, "edited": false, "score": 0, "creation_date": 1450341139, "post_id": 34311512, "comment_id": 56401226, "body": "@Jeeped - Question edited with image showing what i am trying to fetch is highlighted. 40 under span tag is what i am trying to fetch."}], "answers": [{"comments": [{"owner": {"reputation": 2788, "user_id": 4139024, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/qOcL9.jpg?s=128&g=1", "display_name": "blckbird", "link": "https://stackoverflow.com/users/4139024/blckbird"}, "reply_to_user": {"reputation": 965, "user_id": 2269164, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/d3d1bcc7c0bc38e6addce3d15c02168c?s=128&d=identicon&r=PG", "display_name": "user2269164", "link": "https://stackoverflow.com/users/2269164/user2269164"}, "edited": false, "score": 0, "creation_date": 1452169905, "post_id": 34315038, "comment_id": 57055501, "body": "@user2269164 If this helped you, please upvote and accept as answer."}], "tags": [], "owner": {"reputation": 2788, "user_id": 4139024, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/qOcL9.jpg?s=128&g=1", "display_name": "blckbird", "link": "https://stackoverflow.com/users/4139024/blckbird"}, "is_accepted": false, "score": 0, "last_activity_date": 1450277601, "last_edit_date": 1450277601, "creation_date": 1450277283, "answer_id": 34315038, "question_id": 34311512, "link": "https://stackoverflow.com/questions/34311512/run-time-error-424-object-required/34315038#34315038", "title": "Run time error 424 Object required", "body": "<p>The element IDs on a html page have be unique (otherwise it would not be an \"identifier\"). So one ID should be attached to one element only. However, a browser will not check this, respectivly ignore that mistake in the html file.</p>\n\n<p>Anyway for your javascript function <code>getElementById()</code> this means that it will return only one single element.\nYou need to change:</p>\n\n<pre><code>Set objResultDiv = html.getElementById(\"rhs_block\")(0)\n</code></pre>\n\n<p>To</p>\n\n<pre><code>Set objResultDiv = html.getElementById(\"rhs_block\")\n</code></pre>\n\n<p>Then your <code>objResultDiv</code> should no longer throw the runtime error 91.</p>\n\n<p>BTW, there are javascript functions which do return an array of elements. Like <code>getElementsByTagName(\"p\")</code> (returns all elements with the paragraph tag) or <code>getElementsByName(\"test123\")</code> (returns all elements with <code>name=\"test123\"</code>).</p>\n\n<p>You can tell from the function name, whether a single or multiple elements are returned. (getElementById vs. getElement<strong>s</strong>ByName)</p>\n"}], "owner": {"reputation": 965, "user_id": 2269164, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/d3d1bcc7c0bc38e6addce3d15c02168c?s=128&d=identicon&r=PG", "display_name": "user2269164", "link": "https://stackoverflow.com/users/2269164/user2269164"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1038, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1452130100, "creation_date": 1450267297, "last_edit_date": 1531161705, "question_id": 34311512, "link": "https://stackoverflow.com/questions/34311512/run-time-error-424-object-required", "title": "Run time error 424 Object required", "body": "<p>I am getting Run time error 91 Object or block variable not set for the below line that says &lt;- Error Here!!</p>\n\n<pre><code>    Set html = CreateObject(\"htmlfile\")\n    html.body.innerHTML = XMLHTTP.ResponseText\n    Set objResultDiv = html.getElementById(\"rhs_block\")(0) ' &lt;- Error Here!!\n    Set objH3 = objResultDiv.getElementsByTagName(\"div\")(7).getElementsByTagName(\"a\")(2).getElementsByTagName(\"span\")(0).innerHTML\n    Cells(i, 2) = objH3\n</code></pre>\n\n<p>I searched in Stackoverflow but have not found an answer for this.</p>\n\n<p>Complete VBA code:</p>\n\n<pre><code>Sub XMLHTTP()\n\nDim url As String, lastRow As Long\nDim XMLHTTP As Object, html As Object, objResultDiv As Object, objH3 As Object\nDim start_time As Date\nDim end_time As Date\nlastRow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nDim cookie As String\nDim result_cookie As String\nstart_time = Time\nDebug.Print \"start_time:\" &amp; start_time\n\nFor i = 2 To lastRow\n\n    url = \"https://www.google.co.in/search?q=\" &amp; Cells(i, 1) &amp; \"&amp;rnd=\" &amp; WorksheetFunction.RandBetween(1, 10000)\n\n    Set XMLHTTP = CreateObject(\"MSXML2.serverXMLHTTP\")\n    XMLHTTP.Open \"GET\", url, False\n    XMLHTTP.setRequestHeader \"Content-Type\", \"text/xml\"\n    XMLHTTP.setRequestHeader \"User-Agent\", \"Mozilla/5.0 (Windows NT 6.1; rv:25.0) Gecko/20100101 Firefox/25.0\"\n    XMLHTTP.send\n\n    Set html = CreateObject(\"htmlfile\")\n    html.body.innerHTML = XMLHTTP.ResponseText\n    Set objResultDiv = html.getElementById(\"rhs_block\")(0)\n    Set objH3 = objResultDiv.getElementsByTagName(\"div\")(7).getElementsByTagName(\"a\")(2).getElementsByTagName(\"span\")(0).innerHTML\n    Cells(i, 2) = objH3\n    DoEvents\nNext\n\n    end_time = Time\n    Debug.Print \"end_time:\" &amp; end_time\n    Debug.Print \"done\" &amp; \"Time taken : \" &amp; DateDiff(\"n\", start_time, end_time)\n    MsgBox \"done\" &amp; \"Time taken : \" &amp; DateDiff(\"n\", start_time, end_time)\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/sOxXU.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sOxXU.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1450267054, "post_id": 34310986, "comment_id": 56364302, "body": "Please show us some code you already have, and where it has errors or where it needs to be improved."}], "answers": [{"comments": [{"owner": {"reputation": 498, "user_id": 2704746, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/mEmq9.jpg?s=128&g=1", "display_name": "JeremyA1", "link": "https://stackoverflow.com/users/2704746/jeremya1"}, "edited": false, "score": 1, "creation_date": 1450270412, "post_id": 34312119, "comment_id": 56366683, "body": "You&#39;re correct it was not so much a VBA as it is using SUMIFS along with a Pivot table. I found another website that provided a pretty close example that I&#39;m using. Thanks for the reply I will use it if needed"}], "tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": true, "score": 1, "last_activity_date": 1450269012, "creation_date": 1450269012, "answer_id": 34312119, "question_id": 34310986, "link": "https://stackoverflow.com/questions/34310986/index-and-match-excel/34312119#34312119", "title": "Index and Match Excel", "body": "<p>I'm not convinced this has much to do with VBA. Seems enough detail of final design but rather light on the data gathering process. However <em>when I perform a SharePoint pull I have 3 different rows of vacation dates</em> hints at a use for Subtotal. Three rows may be 'converted' into one:  </p>\n\n<p><a href=\"https://i.stack.imgur.com/1cfAb.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1cfAb.jpg\" alt=\"SO34310986 example\"></a>  </p>\n\n<p>where the unshaded part (some cells with <code>X</code>s) is assumed to be a representation of the current SharePoint data extract. Subtotal is able to add the rows shown lightly filled, which might then be used to <code>=VLOOKUP(\"Boss\"&amp;\" Count\",A:F,n,0)</code> where <code>n</code> represent the choice of column label.</p>\n"}], "owner": {"reputation": 498, "user_id": 2704746, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/mEmq9.jpg?s=128&g=1", "display_name": "JeremyA1", "link": "https://stackoverflow.com/users/2704746/jeremya1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "accepted_answer_id": 34312119, "answer_count": 1, "score": -1, "last_activity_date": 1450269012, "creation_date": 1450265707, "last_edit_date": 1450268103, "question_id": 34310986, "link": "https://stackoverflow.com/questions/34310986/index-and-match-excel", "title": "Index and Match Excel", "body": "<p>I'm creating a vacation tracker in Excel. The first sheet pulls the data from SharePoint which has Start Date, End Date and a Date Difference calculation.</p>\n\n<p>Sheet1</p>\n\n<pre><code>A2=12/16/2015\nB2=12/20/2015\nC2=5\n</code></pre>\n\n<p>The second sheet is the visualization of the data. It starts with cell B1 and goes out for 90 days. Is is a word representation of the date. Here is the formula I'm using <code>=UPPER(TEXT(B2,\"DDD\"))</code></p>\n\n<p>Sheet2</p>\n\n<pre><code>B1=WED\nC1=THU\nD1=FRI\nE1=SAT\nF1=SUN\n</code></pre>\n\n<p>The next row always <code>B2</code> has a formula which is always today's date. From there I add one date to increment the dates out to 90 days. <code>B2=Today()</code> and the other cells <code>=B2+1</code> and so forth</p>\n\n<pre><code>B2=16\nC2=17\nD2=18\nE2=19\nF2=20\n</code></pre>\n\n<p>The problem I'm running to is that our boss can have 3 calendar entries consisting of different dates. So when I perform a SharePoint pull I have 3 different rows of vacation dates. I'm experimenting with an Index and Match example, however the data match it is placed in a new row. How do I place the data on the same row?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 5686313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71779abba0e97751de572d6923866c3f?s=128&d=identicon&r=PG&f=1", "display_name": "vijju", "link": "https://stackoverflow.com/users/5686313/vijju"}, "edited": false, "score": 0, "creation_date": 1450266074, "post_id": 34310786, "comment_id": 56363618, "body": "after changing it to Workbook_BeforeSave event. the validatios are not wrking."}, {"owner": {"reputation": 23, "user_id": 5686313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71779abba0e97751de572d6923866c3f?s=128&d=identicon&r=PG&f=1", "display_name": "vijju", "link": "https://stackoverflow.com/users/5686313/vijju"}, "edited": false, "score": 0, "creation_date": 1450266150, "post_id": 34310786, "comment_id": 56363663, "body": "please someday help me out"}, {"owner": {"reputation": 2788, "user_id": 4139024, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/qOcL9.jpg?s=128&g=1", "display_name": "blckbird", "link": "https://stackoverflow.com/users/4139024/blckbird"}, "reply_to_user": {"reputation": 23, "user_id": 5686313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71779abba0e97751de572d6923866c3f?s=128&d=identicon&r=PG&f=1", "display_name": "vijju", "link": "https://stackoverflow.com/users/5686313/vijju"}, "edited": false, "score": 0, "creation_date": 1450266891, "post_id": 34310786, "comment_id": 56364186, "body": "My first guess: You need to put the code into <code>This Workbook</code> not into the code for the sheet. However, you need to be <b>more detailed</b> with your post so we can help you."}, {"owner": {"reputation": 23, "user_id": 5686313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71779abba0e97751de572d6923866c3f?s=128&d=identicon&r=PG&f=1", "display_name": "vijju", "link": "https://stackoverflow.com/users/5686313/vijju"}, "edited": false, "score": 0, "creation_date": 1450266984, "post_id": 34310786, "comment_id": 56364268, "body": "i want to validate the cell as soon as the cursor moves to the next cell"}, {"owner": {"reputation": 2788, "user_id": 4139024, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/qOcL9.jpg?s=128&g=1", "display_name": "blckbird", "link": "https://stackoverflow.com/users/4139024/blckbird"}, "reply_to_user": {"reputation": 23, "user_id": 5686313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71779abba0e97751de572d6923866c3f?s=128&d=identicon&r=PG&f=1", "display_name": "vijju", "link": "https://stackoverflow.com/users/5686313/vijju"}, "edited": false, "score": 0, "creation_date": 1450267294, "post_id": 34310786, "comment_id": 56364463, "body": "there&#39;s no event which gets fired <i>after</i> a cell is changed. Only when you select the cell. However, the solution I provided you does implement the mandatory fields accordning to your question. Why dont you implement it like that?"}, {"owner": {"reputation": 23, "user_id": 5686313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71779abba0e97751de572d6923866c3f?s=128&d=identicon&r=PG&f=1", "display_name": "vijju", "link": "https://stackoverflow.com/users/5686313/vijju"}, "edited": false, "score": 0, "creation_date": 1450267742, "post_id": 34310786, "comment_id": 56364750, "body": "as in the excel sheet i need to poplulate some 20000 records at a time, so by doing that during save how i can handle that much errors at a time"}, {"owner": {"reputation": 2788, "user_id": 4139024, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/qOcL9.jpg?s=128&g=1", "display_name": "blckbird", "link": "https://stackoverflow.com/users/4139024/blckbird"}, "reply_to_user": {"reputation": 23, "user_id": 5686313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71779abba0e97751de572d6923866c3f?s=128&d=identicon&r=PG&f=1", "display_name": "vijju", "link": "https://stackoverflow.com/users/5686313/vijju"}, "edited": false, "score": 0, "creation_date": 1450268463, "post_id": 34310786, "comment_id": 56365275, "body": "Create a string, and per mandatory cell which is missing add the cell name (&quot;A1&quot;) to that tring. At the end you can output in one error message which cells have to be filled in."}, {"owner": {"reputation": 23, "user_id": 5686313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71779abba0e97751de572d6923866c3f?s=128&d=identicon&r=PG&f=1", "display_name": "vijju", "link": "https://stackoverflow.com/users/5686313/vijju"}, "edited": false, "score": 0, "creation_date": 1450324706, "post_id": 34310786, "comment_id": 56394667, "body": "is there any way to make a cell mandatory using data validation or any other feature of excel other than writing code  in vb"}, {"owner": {"reputation": 2788, "user_id": 4139024, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/qOcL9.jpg?s=128&g=1", "display_name": "blckbird", "link": "https://stackoverflow.com/users/4139024/blckbird"}, "reply_to_user": {"reputation": 23, "user_id": 5686313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71779abba0e97751de572d6923866c3f?s=128&d=identicon&r=PG&f=1", "display_name": "vijju", "link": "https://stackoverflow.com/users/5686313/vijju"}, "edited": false, "score": 0, "creation_date": 1450334459, "post_id": 34310786, "comment_id": 56397778, "body": "No not that I am ware of. If this helped you please up vote my answers and consider accepting one."}, {"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 0, "creation_date": 1450345718, "post_id": 34310786, "comment_id": 56404220, "body": "@blckbird <i>there&#39;s no event which gets fired after a cell is changed</i> - this is exactly what the Change event does."}, {"owner": {"reputation": 23, "user_id": 5686313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71779abba0e97751de572d6923866c3f?s=128&d=identicon&r=PG&f=1", "display_name": "vijju", "link": "https://stackoverflow.com/users/5686313/vijju"}, "edited": false, "score": 0, "creation_date": 1450439340, "post_id": 34310786, "comment_id": 56451435, "body": "Sub Worksheet_SelectionChange(ByVal Target As Range) Dim oldTarget  As Range  Set oldTarget = Target If oldTarget.Address = &quot;$B$1&quot; Then If Range(&quot;A1&quot;).Value = &quot;&quot; Then MsgBox &quot;Hi&quot; End If End If End Sub  i have used this for making cell mandatory, and this is wrking well for a cell, but now i want to use them for the whole column not only for A1 and A2"}], "tags": [], "owner": {"reputation": 2788, "user_id": 4139024, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/qOcL9.jpg?s=128&g=1", "display_name": "blckbird", "link": "https://stackoverflow.com/users/4139024/blckbird"}, "is_accepted": false, "score": -1, "last_activity_date": 1450267396, "last_edit_date": 1450267396, "creation_date": 1450265130, "answer_id": 34310786, "question_id": 34310581, "link": "https://stackoverflow.com/questions/34310581/make-cell-mandatory-in-excel-using-vba/34310786#34310786", "title": "Make cell mandatory in excel using vba", "body": "<p>I think the event you are using may cause your problem.</p>\n\n<p>You could implement mandatory fields with the <code>Workbook_BeforeSave</code> event. This will get fired, as soon as the user tries to save the excel file. Now you check all your fields which you define as mandatory and display the respective \"error message\".</p>\n\n<p>When you set <code>Cancel = True</code> you can abort the saving process wich then really forces the user to add something in the required fields.</p>\n\n<p>In the <code>Workbook_BeforeSave</code> event you can paste in all your checks you have already implemented.</p>\n\n<p>More details on the <code>Workbook_BeforeSave</code> can be found here: <a href=\"https://msdn.microsoft.com/de-de/library/office/ff840057.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/de-de/library/office/ff840057.aspx</a></p>\n\n<p>Here you can find more info on how to implement the <code>Workbook_BeforeSave</code> event:<a href=\"http://www.positivevision.biz/blog/bid/153139/Excel-Tips-and-Tricks-Mandatory-Cell-Input\" rel=\"nofollow\">http://www.positivevision.biz/blog/bid/153139/Excel-Tips-and-Tricks-Mandatory-Cell-Input</a></p>\n"}, {"tags": [], "owner": {"reputation": 2788, "user_id": 4139024, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/qOcL9.jpg?s=128&g=1", "display_name": "blckbird", "link": "https://stackoverflow.com/users/4139024/blckbird"}, "is_accepted": false, "score": 0, "last_activity_date": 1450268708, "creation_date": 1450268708, "answer_id": 34312007, "question_id": 34310581, "link": "https://stackoverflow.com/questions/34310581/make-cell-mandatory-in-excel-using-vba/34312007#34312007", "title": "Make cell mandatory in excel using vba", "body": "<p>Another approach would be:</p>\n\n<ol>\n<li>In your Worksheet_SelectionChange make all cells which do not pass your checks red. All who pass your checks green. You can do this with the following code. Do not produce any error messages in this procedure. </li>\n</ol>\n\n<p><code>Range(\"A1\").Interior.Color = RGB(255, 0, 0) 'red</code></p>\n\n<p><code>Range(\"A1\").Interior.Color = RGB(0, 255, 0) 'green</code></p>\n\n<ol start=\"2\">\n<li>Do only allow saving the workbook if all your checks are passed. Therefore you can use the proceudre I have provided you in the other answer.</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": false, "score": 1, "last_activity_date": 1450346180, "creation_date": 1450346180, "answer_id": 34331565, "question_id": 34310581, "link": "https://stackoverflow.com/questions/34310581/make-cell-mandatory-in-excel-using-vba/34331565#34331565", "title": "Make cell mandatory in excel using vba", "body": "<p>This code</p>\n\n<ul>\n<li>tracks A1:A10 to see if any cells are changed</li>\n<li>then looks to see if the corresponding cell in row Y is empty\n\n<ul>\n<li>if empty a message is returned and the cell in A1:A10 that was changed is then blanked out</li>\n</ul></li>\n</ul>\n\n<p><em>code</em> </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim rng1 As Range\nDim rng2 As Range\n\nSet rng1 = Intersect(Target, [a1:a10])\n'exit if no cells in A1:A10 are changed\nIf rng1 Is Nothing Then Exit Sub\n\n'turn off events to avoid code retriggering itself\nApplication.EnableEvents = False\nFor Each rng2 In rng1\n    If Cells(rng2.Row, \"Y\") = vbNullString Then\n       MsgBox \"Please Enter Consignee Final Destination Location Code Value, your entry will be deleted\", vbOKOnly\n       rng2.Value = vbNullString\n    End If\nNext\nApplication.EnableEvents = True    \nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 5686313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71779abba0e97751de572d6923866c3f?s=128&d=identicon&r=PG&f=1", "display_name": "vijju", "link": "https://stackoverflow.com/users/5686313/vijju"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 960, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1450346180, "creation_date": 1450264514, "last_edit_date": 1531161705, "question_id": 34310581, "link": "https://stackoverflow.com/questions/34310581/make-cell-mandatory-in-excel-using-vba", "title": "Make cell mandatory in excel using vba", "body": "<p>I have tried this code for creating mandatory fields but the problem is it is showing the error message before going to the cell.</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n\n    Dim lastRow As Long\n    With ActiveSheet\n        lastRow = .Cells(.Rows.count, \"A\").End(xlUp).Row\n        Dim I, J As Integer\n        For I = 1 To lastRow\n        If Cells(I, \"C\").Value = \"\" Then\n        MsgBox \"Please Enter Business Type Value\", vbOKOnly\n        Exit Sub\n        End If\n        'If Cells(I, \"D\").Value = \"\" Then\n        'MsgBox \"Please Enter Customer Account Code\", vbOKOnly\n        'Exit Sub\n        'End If\n        'If Cells(I, \"E\").Value = \"\" Then\n        'MsgBox \"Please Enter Transport Mode Value\", vbOKOnly\n        'Exit Sub\n        'End If\n        'If Cells(I, \"F\").Value = \"\" Then\n        'MsgBox \"Please Enter Incoterm Value\", vbOKOnly\n        'Exit Sub\n        'End If\n        'If Cells(I, \"K\").Value = \"\" Then\n        'MsgBox \"Please Enter From date Value\", vbOKOnly\n        'Exit Sub\n        'End If\n        'If Cells(I, \"L\").Value = \"\" Then\n        'MsgBox \"Please Enter To date Value\", vbOKOnly\n        'Exit Sub\n        'End If\n        'If Cells(I, \"K\").Value &gt; Cells(I, \"L\").Value Then\n        'MsgBox \"To date value should greater than From value\", vbOKOnly\n        'Exit Sub\n        'End If\n        'If Cells(I, \"N\").Value = \"\" Then\n        'MsgBox \"Please Enter Origin Country Code Value\", vbOKOnly\n        'Exit Sub\n        'End If\n        'If Cells(I, \"O\").Value = \"\" Then\n        'MsgBox \"Please Enter Point of Origin Location Code Value\", vbOKOnly\n        'Exit Sub\n        'End If\n        'If Cells(I, \"R\").Value = \"\" Then\n        'MsgBox \"Please Enter Port of Loading Code Value\", vbOKOnly\n        'Exit Sub\n        'End If\n        'If Cells(I, \"S\").Value = \"\" Then\n        'MsgBox \"Please Enter Origin Clearance Location Value\", vbOKOnly\n        'Exit Sub\n        'End If\n        'If Cells(I, \"T\").Value = \"\" Then\n        'MsgBox \"Please Enter Destination Clearance Location Value\", vbOKOnly\n        'Exit Sub\n        'End If\n        'If Cells(I, \"U\").Value = \"\" Then\n        'MsgBox \"Please Enter Port of Discharge Code Value\", vbOKOnly\n        'Exit Sub\n        'End If\n        If Cells(I, \"Y\").Value = \"\" Then\n        MsgBox \"Please Enter Consignee Final Destination Location Code Value\", vbOKOnly\n        Exit Sub\n        End If\n        If Cells(I, \"Z\").Value = \"\" Then\n        MsgBox \"Please Enter Destination Country Code Value\", vbOKOnly\n        Exit Sub\n        End If\n        If Cells(I, \"AF\").Value = \"\" Then\n        MsgBox \"Please Enter Active status Value\", vbOKOnly\n        Exit Sub\n        End If\n        If Cells(I, \"AH\").Value = \"\" Then\n        MsgBox \"Please Enter Carrier Allocation Number Value\", vbOKOnly\n        Exit Sub\n        End If\n        If Cells(I, \"AI\").Value = \"\" Then\n        MsgBox \"Please Enter  Carrier Allocation Valid From Date Value\", vbOKOnly\n        Exit Sub\n        End If\n        If Cells(I, \"AJ\").Value = \"\" Then\n        MsgBox \"Please Enter Carrier Nomination Sequence Number Value\", vbOKOnly\n        Exit Sub\n        End If\n        Next I\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "excel-udf", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1450264191, "post_id": 34310219, "comment_id": 56362318, "body": "Are you finalizing that with [Ctrl]+[Shift]+[Enter] rather than simply [Enter]? It is an <b>array formula</b>. Maybe this <b>standard</b> formula would be better <code>=AVERAGEIF(B:B, &quot;&gt;&quot;&amp;PERCENTILE(B:B,0.9))</code>."}, {"owner": {"reputation": 3, "user_id": 2886222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6571a787310bebf8328139a3a81e7902?s=128&d=identicon&r=PG&f=1", "display_name": "Ruben", "link": "https://stackoverflow.com/users/2886222/ruben"}, "edited": false, "score": 0, "creation_date": 1450265037, "post_id": 34310219, "comment_id": 56362915, "body": "Yes I&#39;m finalizing with Ctrl+Shift+Enter. How can I use your formula and only find the value for only one part-type without using an array?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1450265423, "post_id": 34310219, "comment_id": 56363149, "body": "Well, <code>=AVERAGEIFS(B:B, A:A, &quot;book&quot;, B:B, &quot;&gt;&quot;&amp;PERCENTILE(B:B,0.9))</code> would be the easy way but that uses the percentile from the entire column of B not just the percentile from the book values of B. How many rows are you talking about and is column A sorted so that the parts are always together?"}, {"owner": {"reputation": 3, "user_id": 2886222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6571a787310bebf8328139a3a81e7902?s=128&d=identicon&r=PG&f=1", "display_name": "Ruben", "link": "https://stackoverflow.com/users/2886222/ruben"}, "edited": false, "score": 0, "creation_date": 1450265845, "post_id": 34310219, "comment_id": 56363453, "body": "Right now it&#39;s about 2500 rows with 30-ish different &quot;parts&quot;. Unfortunately they are not sorted."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1450266328, "post_id": 34310219, "comment_id": 56363813, "body": "If they are not sorted then you need an array formula that references the full extent of the data; not as bad as full column references but not ideal. If they were sorted then you can pick up the row numbers of the first &#39;book&#39; and the last &#39;book&#39; and your standard formula calculations are minimized."}, {"owner": {"reputation": 3, "user_id": 2886222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6571a787310bebf8328139a3a81e7902?s=128&d=identicon&r=PG&f=1", "display_name": "Ruben", "link": "https://stackoverflow.com/users/2886222/ruben"}, "edited": false, "score": 0, "creation_date": 1450266771, "post_id": 34310219, "comment_id": 56364108, "body": "Yep, that is why I was looking for a solution using VBA. Someone out there can probably make an UDF with arguments like:<code>=MYFUNCTION(A:B,&quot;book&quot;,10)</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1450268379, "post_id": 34310219, "comment_id": 56365214, "body": "For 2500 rows, you don&#39;t need a UDF but you do need an array formula that dynamically updates the full extent of the data without referencing so much as a single row beyond that."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1450269396, "creation_date": 1450269396, "answer_id": 34312260, "question_id": 34310219, "link": "https://stackoverflow.com/questions/34310219/find-average-of-top-and-bottom-n-percent-of-range-with-extra-condition/34312260#34312260", "title": "Find average of top and bottom n percent of range with extra condition", "body": "<p>To isolate the values in column B that are relevant to 'book' on sorted <strong>Part</strong> data you can reference the cells in column B as:</p>\n\n<pre><code>INDEX(B:B, MATCH(\"book\", A:A, 0):INDEX(B:B, MATCH(\"book\", A:A)\n</code></pre>\n\n<p>To isolate the values in column B that are relevant to any part on unsorted <strong>Part</strong> data you can reference the cells in column B as:</p>\n\n<pre><code>B2:INDEX(B:B, MATCH(\"zzz\", A:A)\n</code></pre>\n\n<p>These ranges will dynamically update when new values are added but the first is only accurate once the values in column A have been resorted.</p>\n\n<p><strong>Standard Formula on Sorted</strong></p>\n\n<p>In the following sample image the standard formulas in E4:F4 are:</p>\n\n<pre><code>=PERCENTILE(INDEX(B:B, MATCH(D4,A:A, 0)):INDEX(B:B, MATCH(D4,A:A )), 0.9)\n=AVERAGEIF(INDEX(B:B, MATCH(D4,A:A, 0)):INDEX(B:B, MATCH(D4,A:A  )), \"&gt;\"&amp;PERCENTILE(INDEX(B:B, MATCH(D4,A:A, 0)):INDEX(B:B, MATCH(D4,A:A )), 0.9))\n'alternate standard formula for F4\n=AVERAGEIF(INDEX(B:B, MATCH(D4,A:A, 0)):INDEX(B:B, MATCH(D4,A:A  )), \"&gt;\"&amp;E4)\n</code></pre>\n\n<p>Fill down as necessary.</p>\n\n<p>\u00a0\u00a0\u00a0\u00a0<a href=\"https://i.stack.imgur.com/KWfiq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KWfiq.png\" alt=\"Find average of top and bottom n percent of range with extra condition2\"></a><br/>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<sup>Standard Formula on Sorted</sup></p>\n\n<p><strong>Array\u00b9 Formula on Unsorted</strong></p>\n\n<p>In the following sample image the array formulas in E10:F10 are:</p>\n\n<pre><code>=PERCENTILE(IF(A$2:INDEX(A:A, MATCH(\"zzz\",A:A ))=D10, B$2:INDEX(B:B, MATCH(\"zzz\",A:A ))), 0.9)\n=AVERAGEIFS(B:B,A:A, D10,B:B, \"&gt;\"&amp;PERCENTILE(IF(A$2:INDEX(A:A, MATCH(\"zzz\",A:A ))=D10, B$2:INDEX(B:B, MATCH(\"zzz\",A:A ))), 0.9))\n'alternate standard formula for F10\n=AVERAGEIFS(B:B,A:A, D10,B:B, \"&gt;\"&amp;E10)\n</code></pre>\n\n<p>\u00a0\u00a0\u00a0\u00a0<a href=\"https://i.stack.imgur.com/q6Dks.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/q6Dks.png\" alt=\"Find average of top and bottom n percent of range with extra condition\"></a><br/>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<sup>Array Formula on Unsorted</sup></p>\n\n<hr>\n\n<p>\u00b9 <sub>Array formulas need to be finalized with <kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>Enter\u21b5</kbd>. Once entered into the first cell correctly, they can be filled or copied down or right just like any other formula. Try and reduce your full-column references to ranges more closely representing the extents of your actual data. Array formulas chew up calculation cycles logarithmically so it is good practise to narrow the referenced ranges to a minimum. See <a href=\"https://support.office.com/en-ca/article/guidelines-and-examples-of-array-formulas-7d94a64e-3ff3-4686-9372-ecfd5caa57c7\" rel=\"nofollow noreferrer\">Guidelines and examples of array formulas</a> for more information.</sub></p>\n"}], "owner": {"reputation": 3, "user_id": 2886222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6571a787310bebf8328139a3a81e7902?s=128&d=identicon&r=PG&f=1", "display_name": "Ruben", "link": "https://stackoverflow.com/users/2886222/ruben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 825, "favorite_count": 0, "accepted_answer_id": 34312260, "answer_count": 1, "score": -1, "last_activity_date": 1450269396, "creation_date": 1450263556, "last_edit_date": 1531161705, "question_id": 34310219, "link": "https://stackoverflow.com/questions/34310219/find-average-of-top-and-bottom-n-percent-of-range-with-extra-condition", "title": "Find average of top and bottom n percent of range with extra condition", "body": "<p>Example:  </p>\n\n<pre><code>Part, Qty  \nBook, 1  \nBook, 2  \nBook, 3  \nBook, 4  \nBook, 5  \nBook, 6  \nBook, 7  \nBook, 8  \nBook, 9  \nBook, 10  \nPen, 4  \nPen, 7  \n</code></pre>\n\n<p>I'm trying to calculate the book qty average of top 10% in the range B:B.<br>\nTried getting it to work with an array formula based on:</p>\n\n<pre><code>{=AVERAGE(IF(B:B&gt;PERCENTILE(B:B,0.9),B:B))}  \n</code></pre>\n\n<p>When I was trying to get it working with an array formula I realized that I had a lot of data, and it takes a lot of time calculating when adding new data.  </p>\n\n<p>Can this be done with a user defined function in VBA to speed it up?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 668, "user_id": 5376180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dbbcf86576c59034abee94863876812?s=128&d=identicon&r=PG&f=1", "display_name": "Vulthil", "link": "https://stackoverflow.com/users/5376180/vulthil"}, "edited": false, "score": 0, "creation_date": 1450260476, "post_id": 34308943, "comment_id": 56359693, "body": "You could change the cell.EntireRow.Hidden = True to something like .Range(cell, cell.end(xldown).offset(-1,0)).EntireRow.Hidden = True."}, {"owner": {"reputation": 45, "user_id": 5685982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1fc4c563a7cd44c56d10fedf6b11669?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doe", "link": "https://stackoverflow.com/users/5685982/j-doe"}, "reply_to_user": {"reputation": 668, "user_id": 5376180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dbbcf86576c59034abee94863876812?s=128&d=identicon&r=PG&f=1", "display_name": "Vulthil", "link": "https://stackoverflow.com/users/5376180/vulthil"}, "edited": false, "score": 0, "creation_date": 1450260653, "post_id": 34308943, "comment_id": 56359803, "body": "@Alex4336 Sorry i don&#39;t understand your code. How this code woud get to stop hiding rows? In my screenshot there the second &quot;closed&quot; so it should stop there, in my screenshot it&#39;s closed but it can be anything else, like open."}, {"owner": {"reputation": 668, "user_id": 5376180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dbbcf86576c59034abee94863876812?s=128&d=identicon&r=PG&f=1", "display_name": "Vulthil", "link": "https://stackoverflow.com/users/5376180/vulthil"}, "edited": false, "score": 0, "creation_date": 1450260822, "post_id": 34308943, "comment_id": 56359919, "body": "My code starts from the cell in your loop, and expands the selection downwards to the cell above the next cell with a value in it, so in your example it should hide the rows from the orange Closed to the row just above the blue closed. This is assuming you have blank rows between every occurence of closed in the cell."}, {"owner": {"reputation": 45, "user_id": 5685982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1fc4c563a7cd44c56d10fedf6b11669?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doe", "link": "https://stackoverflow.com/users/5685982/j-doe"}, "reply_to_user": {"reputation": 668, "user_id": 5376180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dbbcf86576c59034abee94863876812?s=128&d=identicon&r=PG&f=1", "display_name": "Vulthil", "link": "https://stackoverflow.com/users/5376180/vulthil"}, "edited": false, "score": 0, "creation_date": 1450260974, "post_id": 34308943, "comment_id": 56360028, "body": "@Alex4336 It kinda works for the first two &quot;closed&quot; met but then it stops working. It also doesn&#39;t hide the row where the &quot;closed&quot; is so i added the cell.EntireRow.hidden = true. But then it say it can&#39;t run it in break mode"}, {"owner": {"reputation": 668, "user_id": 5376180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dbbcf86576c59034abee94863876812?s=128&d=identicon&r=PG&f=1", "display_name": "Vulthil", "link": "https://stackoverflow.com/users/5376180/vulthil"}, "edited": false, "score": 0, "creation_date": 1450261235, "post_id": 34308943, "comment_id": 56360210, "body": "If it can&#39;t run in break mode it&#39;s because some code is already running or in debug mode. Reset the code, and you should be able to do it again. As for the the hidding of rows part, I haven&#39;t tested my suggestion, so I have no idea if it works."}, {"owner": {"reputation": 45, "user_id": 5685982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1fc4c563a7cd44c56d10fedf6b11669?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doe", "link": "https://stackoverflow.com/users/5685982/j-doe"}, "reply_to_user": {"reputation": 668, "user_id": 5376180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dbbcf86576c59034abee94863876812?s=128&d=identicon&r=PG&f=1", "display_name": "Vulthil", "link": "https://stackoverflow.com/users/5376180/vulthil"}, "edited": false, "score": 0, "creation_date": 1450261272, "post_id": 34308943, "comment_id": 56360247, "body": "@Alex4336 See screenshot: <a href=\"http://postimg.org/image/4glvgkkyt/\" rel=\"nofollow noreferrer\">postimg.org/image/4glvgkkyt</a>"}, {"owner": {"reputation": 668, "user_id": 5376180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dbbcf86576c59034abee94863876812?s=128&d=identicon&r=PG&f=1", "display_name": "Vulthil", "link": "https://stackoverflow.com/users/5376180/vulthil"}, "edited": false, "score": 0, "creation_date": 1450262273, "post_id": 34308943, "comment_id": 56360966, "body": "cell.value = &quot;Closed&quot; and cell.value = &quot;closed&quot; are not the same. I&#39;d suggest using Ucase(cell.value)= &quot;CLOSED&quot;. That works for me at least, except if the last entry in the H column is closed it will hide every row beneath it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1450262432, "post_id": 34308943, "comment_id": 56361078, "body": "How many pairs of &#39;Closed&#39; do you expect? Is it guaranteed that &#39;Closed&#39; will always come in pairs? What do you do with the orphaned &#39;Closed&#39; if an od one exists?"}, {"owner": {"reputation": 45, "user_id": 5685982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1fc4c563a7cd44c56d10fedf6b11669?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doe", "link": "https://stackoverflow.com/users/5685982/j-doe"}, "reply_to_user": {"reputation": 668, "user_id": 5376180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dbbcf86576c59034abee94863876812?s=128&d=identicon&r=PG&f=1", "display_name": "Vulthil", "link": "https://stackoverflow.com/users/5376180/vulthil"}, "edited": false, "score": 0, "creation_date": 1450262568, "post_id": 34308943, "comment_id": 56361173, "body": "@Alex4336 It doesn&#39;t work. I changed to UCase but still it doesn&#39;t change much. Sometimes there&#39;s even an &quot;open&quot; And it hides it too with that modification. It doesn&#39;t hide the &quot;open&quot; one with the not modified code tho"}, {"owner": {"reputation": 45, "user_id": 5685982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1fc4c563a7cd44c56d10fedf6b11669?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doe", "link": "https://stackoverflow.com/users/5685982/j-doe"}, "edited": false, "score": 0, "creation_date": 1450262695, "post_id": 34308943, "comment_id": 56361268, "body": "@Jeeped Hi Jeeped. Close doesn&#39;t comes in pairs. It mays be Closed, then another one Open, and there again a CLosed one, it&#39;s random. I would like to hide rows for every blank cell after the &quot;Closed&quot; only and do this until there another value in the cell. It could be anything as a value, Open or Closed. And if it&#39;s closed to the same as before, if open don&#39;t do anything and go further until the next Closed."}, {"owner": {"reputation": 668, "user_id": 5376180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dbbcf86576c59034abee94863876812?s=128&d=identicon&r=PG&f=1", "display_name": "Vulthil", "link": "https://stackoverflow.com/users/5376180/vulthil"}, "edited": false, "score": 0, "creation_date": 1450263051, "post_id": 34308943, "comment_id": 56361512, "body": "You lost me there. Do you want the row containing the word closed to remain visible, or should it be closed aswell? Did you use my earlier suggestion or did you add the cell.entireRow.hidden aswell ?"}, {"owner": {"reputation": 45, "user_id": 5685982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1fc4c563a7cd44c56d10fedf6b11669?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doe", "link": "https://stackoverflow.com/users/5685982/j-doe"}, "reply_to_user": {"reputation": 668, "user_id": 5376180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dbbcf86576c59034abee94863876812?s=128&d=identicon&r=PG&f=1", "display_name": "Vulthil", "link": "https://stackoverflow.com/users/5376180/vulthil"}, "edited": false, "score": 0, "creation_date": 1450263198, "post_id": 34308943, "comment_id": 56361622, "body": "@Alex4336 I used your solution only and it left the row containing &quot;closed&quot; visible. It also hides some other rows that contain &quot;open&quot;. And it doesn&#39;t always hide the rows following the &quot;closed&quot; one."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 5685982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1fc4c563a7cd44c56d10fedf6b11669?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doe", "link": "https://stackoverflow.com/users/5685982/j-doe"}, "edited": false, "score": 0, "creation_date": 1450263662, "post_id": 34310060, "comment_id": 56361933, "body": "It hides some cells with open too. It also doesn&#39;t hide the cell it self. And it doesn&#39;t work with every row. Could it be something wrong with my excel file?"}, {"owner": {"reputation": 437, "user_id": 360315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10b3c6750423b686703600e6c7e2cb82?s=128&d=identicon&r=PG", "display_name": "Bob Phillips", "link": "https://stackoverflow.com/users/360315/bob-phillips"}, "reply_to_user": {"reputation": 45, "user_id": 5685982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1fc4c563a7cd44c56d10fedf6b11669?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doe", "link": "https://stackoverflow.com/users/5685982/j-doe"}, "edited": false, "score": 0, "creation_date": 1450271955, "post_id": 34310060, "comment_id": 56367801, "body": "You said between the rows, not including, so I coded it that way. As for your data, I cannot say without seeing it for real, I created data based upon the image and it worked, but maybe you have something else not catered for."}], "tags": [], "owner": {"reputation": 437, "user_id": 360315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10b3c6750423b686703600e6c7e2cb82?s=128&d=identicon&r=PG", "display_name": "Bob Phillips", "link": "https://stackoverflow.com/users/360315/bob-phillips"}, "is_accepted": false, "score": 0, "last_activity_date": 1450263135, "creation_date": 1450263135, "answer_id": 34310060, "question_id": 34308943, "link": "https://stackoverflow.com/questions/34308943/how-to-hide-a-series-of-rows-in-excel-until-the-value-changes/34310060#34310060", "title": "How to hide a series of rows in Excel until the value changes", "body": "<p>Does this do what you want?</p>\n\n<pre><code>Sub Hide()\nDim wks As Worksheet\nDim lastrow As Long\nDim startrow As Long\nDim i As Long\n\n    Application.ScreenUpdating = False\n\n    On Error Resume Next\n    For Each wks In ThisWorkbook.Worksheets\n\n        With wks\n\n            .Rows.Hidden = False\n            lastrow = .Range(\"H\" &amp; .Rows.Count).End(xlUp).Row\n            For i = 2 To lastrow\n\n                If .Cells(i, \"H\").Value = \"Closed\" Then\n\n                    startrow = i + 1\n                    Do Until .Cells(i + 1, \"H\").Value = \"Closed\" Or i + 1 &gt; lastrow\n\n                        i = i + 1\n                    Loop\n                    If .Cells(i + 1, \"H\").Value = \"Closed\" Then\n\n                        If i &gt;= startrow Then .Rows(startrow).Resize(i - startrow + 1).Hidden = True\n                        i = i + 1\n                    End If\n                End If\n            Next i\n        End With\n    Next wks\n\n    MsgBox \"All Rows containing Closed in Column H have been hidden\", vbInformation, \"Information\"\n\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 45, "user_id": 5685982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1fc4c563a7cd44c56d10fedf6b11669?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doe", "link": "https://stackoverflow.com/users/5685982/j-doe"}, "edited": false, "score": 0, "creation_date": 1450263741, "post_id": 34310165, "comment_id": 56361993, "body": "It says. &quot;Unable to set the hidden property of the range Class&quot; when i try to run it"}, {"owner": {"reputation": 45, "user_id": 5685982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1fc4c563a7cd44c56d10fedf6b11669?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doe", "link": "https://stackoverflow.com/users/5685982/j-doe"}, "edited": false, "score": 0, "creation_date": 1450263823, "post_id": 34310165, "comment_id": 56362049, "body": "Yes. there are conditionall formatting on some rows"}, {"owner": {"reputation": 45, "user_id": 5685982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1fc4c563a7cd44c56d10fedf6b11669?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doe", "link": "https://stackoverflow.com/users/5685982/j-doe"}, "edited": false, "score": 0, "creation_date": 1450263992, "post_id": 34310165, "comment_id": 56362158, "body": "When i click the debug button it highlights: &quot;If Not Rng Is Nothing Then Rng.Hidden = True&quot;"}, {"owner": {"reputation": 45, "user_id": 5685982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1fc4c563a7cd44c56d10fedf6b11669?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doe", "link": "https://stackoverflow.com/users/5685982/j-doe"}, "edited": false, "score": 0, "creation_date": 1450267139, "post_id": 34310165, "comment_id": 56364359, "body": "Sorry to bother you. I have one more question. I would like to check the value of the cell next to the blank cell before hiding it. Is it possible? Like it&#39;s currently checking H column on row 3 and i would like to check the G column on row 3 before hiding."}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "reply_to_user": {"reputation": 45, "user_id": 5685982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1fc4c563a7cd44c56d10fedf6b11669?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doe", "link": "https://stackoverflow.com/users/5685982/j-doe"}, "edited": false, "score": 0, "creation_date": 1450274101, "post_id": 34310165, "comment_id": 56369329, "body": "while it would slow down the process itself, you can do it with <code>wks.Cells(i, 7).value</code>... but this double-loop-inside-loop is not suited for that... I&#39;ll create a different way to do the same, and add it to my answer... but may take some time..."}, {"owner": {"reputation": 45, "user_id": 5685982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1fc4c563a7cd44c56d10fedf6b11669?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doe", "link": "https://stackoverflow.com/users/5685982/j-doe"}, "edited": false, "score": 0, "creation_date": 1450274605, "post_id": 34310165, "comment_id": 56369670, "body": "No don&#39;t over do thank you already. I have found another solution. It was deleting lines i didn&#39;t want to deleter so i just add a blank space and it works so."}], "tags": [], "owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "is_accepted": true, "score": 1, "last_activity_date": 1450278088, "last_edit_date": 1450278088, "creation_date": 1450263426, "answer_id": 34310165, "question_id": 34308943, "link": "https://stackoverflow.com/questions/34308943/how-to-hide-a-series-of-rows-in-excel-until-the-value-changes/34310165#34310165", "title": "How to hide a series of rows in Excel until the value changes", "body": "<p>To do it in a fast way, try this:</p>\n\n<pre><code>Option Explicit\nSub Hide()\n  Application.ScreenUpdating = False\n  Dim wks As Worksheet\n  Dim Lastrow As String\n  Dim Rng As Range, i As Long\n  Dim cell As Variant\n  For Each wks In ThisWorkbook.Worksheets\n    wks.Rows.Hidden = False\n    Lastrow = wks.Range(\"H\" &amp; Rows.Count).End(xlUp).Row\n    If Lastrow &gt; 1 Then\n      cell = wks.Range(\"H1:H\" &amp; Lastrow).Value\n      i = 1: Set Rng = Nothing\n      While i &lt;= Lastrow\n        For i = i To Lastrow\n          If LCase(cell(i, 1)) = \"closed\" Then Exit For\n        Next\n        For i = i To Lastrow\n          If LCase(cell(i, 1)) = \"closed\" Or cell(i, 1) = \"\" Then\n            If Rng Is Nothing Then\n              Set Rng = wks.Rows(i)\n            Else\n              Set Rng = Union(Rng, wks.Rows(i))\n            End If\n          Else\n            Exit For\n          End If\n        Next\n      Wend\n      If Not Rng Is Nothing Then Rng.EntireRow.Hidden = True\n    End If\n  Next\n  MsgBox \"All Rows containing Closed in Column H have been hidden\", vbInformation, \"Information\"\n  Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>To do it without while and have easier access for conditions:</p>\n\n<pre><code>Option Explicit\nSub Hide()\n  Application.ScreenUpdating = False\n  Dim wks As Worksheet\n  Dim Lastrow As String\n  Dim i As Long, hideB As Boolean\n  Dim cell As Variant\n  For Each wks In ThisWorkbook.Worksheets\n    wks.Rows.Hidden = False\n    Lastrow = wks.Range(\"H\" &amp; Rows.Count).End(xlUp).Row\n    If Lastrow &gt; 1 Then\n      cell = wks.Range(\"H1:H\" &amp; Lastrow).Value\n      Set Rng = Nothing: hideB = False\n      For i = 1 To Lastrow\n        If Len(cell(i, 1)) Then\n          'this determinates if the line will be hidden\n          hideB = (LCase(cell(i, 1)) = \"closed\")\n          'if you want to check G also =&gt; hideB = (LCase(cell(i, 1)) = \"closed\") And (LCase(wks.cells(i, \"G\")) = \"keyword2\")\n        End If\n        If hideB Then\n          If Rng Is Nothing Then\n            Set Rng = wks.Rows(i)\n          Else\n            Set Rng = Union(Rng, wks.Rows(i))\n          End If\n        End If\n      Next\n      If Not Rng Is Nothing Then Rng.EntireRow.Hidden = True\n    End If\n  Next\n  MsgBox \"All Rows containing Closed in Column H have been hidden\", vbInformation, \"Information\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 5685982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1fc4c563a7cd44c56d10fedf6b11669?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doe", "link": "https://stackoverflow.com/users/5685982/j-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 921, "favorite_count": 0, "accepted_answer_id": 34310165, "answer_count": 2, "score": 4, "last_activity_date": 1528975212, "creation_date": 1450260142, "last_edit_date": 1592644375, "question_id": 34308943, "link": "https://stackoverflow.com/questions/34308943/how-to-hide-a-series-of-rows-in-excel-until-the-value-changes", "title": "How to hide a series of rows in Excel until the value changes", "body": "<p>So first of all i have a macro in my excel workbook that Hides rows based on a cell value. And this works. First of all here's what my worksheet looks like:</p>\n<h3>Screenshot of my worksheet</h3>\n<p><img src=\"https://i.stack.imgur.com/myTSo.png\" alt=\"Screenshot of my worksheet\" /></p>\n<p>And here is my code:</p>\n<pre><code>Option Explicit\nSub Hide()\nApplication.ScreenUpdating = False\n\nDim wks As Worksheet\nDim Lastrow As String\nDim Rng As Range\nDim cell As Range\n\nOn Error Resume Next\nFor Each wks In ThisWorkbook.Worksheets\n    \n    With wks\n     wks.Select\n      Rows.Hidden = False\n      Lastrow = Range(&quot;H&quot; &amp; Rows.Count).End(xlUp).Row          '\n               Set Rng = Range(&quot;H1:H&quot; &amp; Lastrow) '\n               For Each cell In Rng\n                    If cell.Value = &quot;Closed&quot; Then  '\n                       cell.EntireRow.Hidden = True\n                    End If\n                Next cell\n    End With\n    Exit For\nNext wks\n\nMsgBox &quot;All Rows containing Closed in Column H have been hidden&quot;, vbInformation, &quot;Information&quot;\n\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n<p>So this will hide any row that contains &quot;Closed&quot; on my first worksheet in the column &quot;H&quot;.</p>\n<p>But as you can see on  my print screen, i would like to hide all the rows between the first met value &quot;closed&quot; and the second value &quot;closed&quot;. And do this until the last row. But i don't know how to do this, can someone help me please?</p>\n"}, {"tags": ["vba", "excel", "excel-2010"], "answers": [{"comments": [{"owner": {"reputation": 498, "user_id": 2704746, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/mEmq9.jpg?s=128&g=1", "display_name": "JeremyA1", "link": "https://stackoverflow.com/users/2704746/jeremya1"}, "edited": false, "score": 0, "creation_date": 1450261635, "post_id": 34309055, "comment_id": 56360500, "body": "Thank you sir. This was exactly what I needed"}], "tags": [], "owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "is_accepted": true, "score": 1, "last_activity_date": 1450261216, "last_edit_date": 1450261216, "creation_date": 1450260412, "answer_id": 34309055, "question_id": 34308778, "link": "https://stackoverflow.com/questions/34308778/highlight-x-number-of-cells-based-on-numeric-value/34309055#34309055", "title": "Highlight X number of cells based on numeric value", "body": "<p>Conditional formatting for <code>B2:ZZ2</code> at Sheet2</p>\n\n<pre><code>=AND(B2&gt;=Sheet1!$A$2,B2&lt;=Sheet1!$B$2)\n</code></pre>\n\n<p>And select the color you like</p>\n"}], "owner": {"reputation": 498, "user_id": 2704746, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/mEmq9.jpg?s=128&g=1", "display_name": "JeremyA1", "link": "https://stackoverflow.com/users/2704746/jeremya1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 503, "favorite_count": 0, "accepted_answer_id": 34309055, "answer_count": 1, "score": 0, "last_activity_date": 1450261216, "creation_date": 1450259684, "question_id": 34308778, "link": "https://stackoverflow.com/questions/34308778/highlight-x-number-of-cells-based-on-numeric-value", "title": "Highlight X number of cells based on numeric value", "body": "<p>I'm creating a vacation tracker in excel. The first sheet pulls the data from SharePoint which has Start Date, End Date and a Date Difference calculation.</p>\n\n<pre><code>Sheet1\nA2=12/16/2015\nB2=12/20/2015\nC2=5\n</code></pre>\n\n<p>The second sheet is the visualization of the data. It starts with cell <code>B1</code> and goes out for 90 days. It is a word representation of the date. Here is the formula I'm using <code>=UPPER(TEXT(B2,\"DDD\"))</code></p>\n\n<pre><code>Sheet2\nB1=WED\nC1=THU\nD1=FRI\nE1=SAT\nF1=SUN\n</code></pre>\n\n<p>The next row always <code>B2</code> has a formula which is always today's date. From there I add one date to increment the dates out to 90 days. <code>B2=Today()</code> and the other cells <code>=B2+1</code> and so forth</p>\n\n<pre><code>B2=16\nC2=17\nD2=18\nE2=19\nF2=20\n</code></pre>\n\n<p>What I'm trying to do is have the <code>start date</code> and <code>end date</code> highlighted on <code>Sheet2</code>. For example the boss is out on vacation from <code>12/16/2015</code> until <code>12/20/2015</code>. I need the cells <code>B3-F3</code> on <code>Sheet2</code> highlighted in Red. The secretary who is on leave from <code>12/17/2015</code> to <code>12/19/2015</code> have her cells highlighted in another color from cells <code>C4-E4.</code></p>\n\n<p>This will probably take some VBA I just need a starting point. I tried using a <code>VLOOKUP</code> to pull the data, however the using a range from another sheet is not working. And to be honest I do not know if this is the correct approach.</p>\n"}, {"tags": ["vba", "excel", "qtp", "hp-uft"], "comments": [{"owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 0, "creation_date": 1450273413, "post_id": 34308463, "comment_id": 56368795, "body": "There must be something wrong in that file or macro of that file if same thing is working for another file. Kindly double check."}, {"owner": {"reputation": 35, "user_id": 4849761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbd3b69499b83012bc1555244c3485d2?s=128&d=identicon&r=PG&f=1", "display_name": "Pradeep Bhandari", "link": "https://stackoverflow.com/users/4849761/pradeep-bhandari"}, "reply_to_user": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 0, "creation_date": 1450341484, "post_id": 34308463, "comment_id": 56401416, "body": "@ManishChristian: well the code of the excel file is not visible to my team and issue is that same excel file works fine when action is performed manually opening it...the issue only arises when qtp opens that file"}, {"owner": {"reputation": 200, "user_id": 5612655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0acdb859f9dd725bb91d418d0d3f8e2d?s=128&d=identicon&r=PG&f=1", "display_name": "user5612655", "link": "https://stackoverflow.com/users/5612655/user5612655"}, "edited": false, "score": 0, "creation_date": 1450473494, "post_id": 34308463, "comment_id": 56470657, "body": "on which line exactly is the error displayed i.e on Createobject or open etc.. Try putting a breakpoint and go line by line and check and let us know"}, {"owner": {"reputation": 35, "user_id": 4849761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbd3b69499b83012bc1555244c3485d2?s=128&d=identicon&r=PG&f=1", "display_name": "Pradeep Bhandari", "link": "https://stackoverflow.com/users/4849761/pradeep-bhandari"}, "reply_to_user": {"reputation": 200, "user_id": 5612655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0acdb859f9dd725bb91d418d0d3f8e2d?s=128&d=identicon&r=PG&f=1", "display_name": "user5612655", "link": "https://stackoverflow.com/users/5612655/user5612655"}, "edited": false, "score": 0, "creation_date": 1450692423, "post_id": 34308463, "comment_id": 56527415, "body": "@user5612655 Error is not displayed on any code line above...it is just that after above code execution excel goes into Not Responding state and never recovers due to which further code is not executed"}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 4849761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbd3b69499b83012bc1555244c3485d2?s=128&d=identicon&r=PG&f=1", "display_name": "Pradeep Bhandari", "link": "https://stackoverflow.com/users/4849761/pradeep-bhandari"}, "edited": false, "score": 0, "creation_date": 1452754165, "post_id": 34752132, "comment_id": 57310638, "body": "First thing, i was using QTP 11 and secondly UFT does support both XLSX/XLSM."}], "tags": [], "owner": {"reputation": 955, "user_id": 2486242, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Xkz3V.jpg?s=128&g=1", "display_name": "Seth Eden", "link": "https://stackoverflow.com/users/2486242/seth-eden"}, "is_accepted": false, "score": 0, "last_activity_date": 1452626673, "creation_date": 1452626673, "answer_id": 34752132, "question_id": 34308463, "link": "https://stackoverflow.com/questions/34308463/vba-excel-not-responding-when-opened-through-qtp/34752132#34752132", "title": "VBA Excel Not Responding when opened through QTP", "body": "<p>XLSX/XLSM is not supported by UFT. Yea I ran into this as well. Real pain in the neck, but that's just the way it is. Just use old-style .XLS files and it will work just fine.</p>\n"}], "owner": {"reputation": 35, "user_id": 4849761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbd3b69499b83012bc1555244c3485d2?s=128&d=identicon&r=PG&f=1", "display_name": "Pradeep Bhandari", "link": "https://stackoverflow.com/users/4849761/pradeep-bhandari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 246, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1491998724, "creation_date": 1450258711, "last_edit_date": 1491998724, "question_id": 34308463, "link": "https://stackoverflow.com/questions/34308463/vba-excel-not-responding-when-opened-through-qtp", "title": "VBA Excel Not Responding when opened through QTP", "body": "<p>Action performed using QTP script --> After opening the Spreadsheet <code>abc.xlsm</code> ,when the <strong><code>Search</code></strong> macro is invoked, the search window opens and by providing search criteria in it when I hit \"Enter\" button, the Excel goes into Not Responding state (macro is not run completely) until the server itself gives the following:</p>\n\n<blockquote>\n  <p>408 timed out request</p>\n</blockquote>\n\n<p>When the same above action is performed by manually invoking the spreadsheet. it works perfectly fine.\nbelow is the code i am using to open the spreadsheet and performing <strong><code>Search</code></strong> macro run..</p>\n\n<pre><code>Dim wShell\nSet oexcel= CreateObject(\"Excel.Application\")\noexcel.Application.Visible=True\nSet obook=oexcel.Workbooks.Open(\"C:\\abc.xlsm\")\nSet osheet=obook.Worksheets(\"Search\")\n\noexcel.Application.Run(\"search\") 'This is the Search macro that we are runnig\nwait 2\n\nWindow(\"search\").Activate\nSet wShell = CreateObject( \"WScript.Shell\" )\n\nwShell.SendKeys (\"%\")  ' this is the input search criteria \nwShell.SendKeys \"{TAB}\"\nwait 2\nwShell.SendKeys \"{ENTER}\"\nwait 5  \n</code></pre>\n\n<p>After the above line of code is executed,the excel goes into not responding state.<br>\nHowever the same code works perfectly fine for another spreadsheet say <code>xyz.xlsm</code> for the same search macro. And it always works well manually.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1101, "user_id": 3419044, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/179d307d22a81ef7f846c3ae7c30b354?s=128&d=identicon&r=PG&f=1", "display_name": "Jure", "link": "https://stackoverflow.com/users/3419044/jure"}, "edited": false, "score": 1, "creation_date": 1450258749, "post_id": 34308367, "comment_id": 56358478, "body": "Maybe first use pipe character (<code>|</code> = AltGr+W) for replacing (e.g. <code>&amp;amp|</code> and <code>&amp;#59|</code>) and then after all replaces, replace <code>|</code> character with <code>;</code>. This won&#39;t work however, if pipe character is anywhere used as a content."}, {"owner": {"reputation": 2253, "user_id": 1804181, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/2c97c03c397eee70b54c26dc0ff8dbdb?s=128&d=identicon&r=PG", "display_name": "Madivad", "link": "https://stackoverflow.com/users/1804181/madivad"}, "edited": false, "score": 0, "creation_date": 1450259134, "post_id": 34308367, "comment_id": 56358756, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/7020156/how-to-html-encode-or-transliterate-high-characters-in-excel\">How to HTML encode or transliterate &quot;high&quot; characters in Excel?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 279, "user_id": 5607762, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/fae4c4a7bf2793baa71cd24bdced10f5?s=128&d=identicon&r=PG&f=1", "display_name": "GohanP", "link": "https://stackoverflow.com/users/5607762/gohanp"}, "edited": false, "score": 1, "creation_date": 1450259481, "post_id": 34308526, "comment_id": 56359020, "body": "Probably in last line you mean `(sObserved, &quot;&amp;amp&amp;#59;&quot;, &quot;&amp;amp;&quot;). Thanks! There is so easy sollution when I combined too much earlier :)"}, {"owner": {"reputation": 2253, "user_id": 1804181, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/2c97c03c397eee70b54c26dc0ff8dbdb?s=128&d=identicon&r=PG", "display_name": "Madivad", "link": "https://stackoverflow.com/users/1804181/madivad"}, "edited": false, "score": 1, "creation_date": 1450262385, "post_id": 34308526, "comment_id": 56361050, "body": "I like simple and elegant solutions, one additional <code>Replace</code>, perfect  :)"}], "tags": [], "owner": {"reputation": 12976, "user_id": 1758762, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Nt89f.jpg?s=128&g=1", "display_name": "Leo Chapiro", "link": "https://stackoverflow.com/users/1758762/leo-chapiro"}, "is_accepted": true, "score": 2, "last_activity_date": 1450260184, "last_edit_date": 1450260184, "creation_date": 1450258902, "answer_id": 34308526, "question_id": 34308367, "link": "https://stackoverflow.com/questions/34308367/replace-function-how-to-replace-not-all-founded-strings/34308526#34308526", "title": "Replace function, how to replace not all founded strings?", "body": "<p>Try this:</p>\n\n<pre><code>sObserved = Replace(sObserved, \"&amp;\", \"&amp;amp;\")\nsObserved = Replace(sObserved, \";\", \"&amp;#59;\")\nsObserved = Replace(sObserved, \"&amp;amp&amp;#59;\", \"&amp;amp;\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5358, "user_id": 1562451, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/qEhut.jpg?s=128&g=1", "display_name": "Fred", "link": "https://stackoverflow.com/users/1562451/fred"}, "is_accepted": false, "score": 1, "last_activity_date": 1450258949, "creation_date": 1450258949, "answer_id": 34308536, "question_id": 34308367, "link": "https://stackoverflow.com/questions/34308367/replace-function-how-to-replace-not-all-founded-strings/34308536#34308536", "title": "Replace function, how to replace not all founded strings?", "body": "<p>This function is from <a href=\"http://www.codeproject.com/Articles/33064/VBScript-HTML-Encode\" rel=\"nofollow\">http://www.codeproject.com/Articles/33064/VBScript-HTML-Encode</a>.  You may need to tweek it but it does a character by character check.</p>\n\n<pre><code>Function HTMLEncode(ByVal sVal)\n\n    sReturn = \"\"\n\n    If ((TypeName(sVal)=\"String\") And (Not IsNull(sVal)) And (sVal&lt;&gt;\"\")) Then\n\n        For i = 1 To Len(sVal)\n\n            ch = Mid(sVal, i, 1)\n\n            Set oRE = New RegExp : oRE.Pattern = \"[ a-zA-Z0-9]\"\n\n            If (Not oRE.Test(ch)) Then\n                ch = \"&amp;#\" &amp; Asc(ch) &amp; \";\"\n            End If\n\n            sReturn = sReturn &amp; ch\n\n            Set oRE = Nothing\n        Next\n    End If\n\n    HTMLEncode = sReturn\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2253, "user_id": 1804181, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/2c97c03c397eee70b54c26dc0ff8dbdb?s=128&d=identicon&r=PG", "display_name": "Madivad", "link": "https://stackoverflow.com/users/1804181/madivad"}, "is_accepted": false, "score": 1, "last_activity_date": 1450259279, "last_edit_date": 1450259279, "creation_date": 1450258962, "answer_id": 34308543, "question_id": 34308367, "link": "https://stackoverflow.com/questions/34308367/replace-function-how-to-replace-not-all-founded-strings/34308543#34308543", "title": "Replace function, how to replace not all founded strings?", "body": "<p>What you're after is a function to encode the output to be HTML friendly: htmlEncode. There are several scripts/functions around the web people have wrote, here is one:</p>\n\n<pre><code>' Encode an string so that it can be displayed correctly\n' inside the browser.\n'\n' Same effect as the Server.HTMLEncode method in ASP\n\nFunction HTMLEncode(ByVal Text As String) As String\nDim i As Integer\nDim acode As Integer\nDim repl As String\n\nHTMLEncode = Text\n\nFor i = Len(HTMLEncode) To 1 Step -1\n    acode = Asc(Mid$(HTMLEncode, i, 1))\n    Select Case acode\n        Case 32\n            repl = \"&amp;nbsp;\"\n        Case 34\n            repl = \"&amp;quot;\"\n        Case 38\n            repl = \"&amp;amp;\"\n        Case 60\n            repl = \"&amp;lt;\"\n        Case 62\n            repl = \"&amp;gt;\"\n        Case 32 To 127\n            ' don't touch alphanumeric chars\n        Case Else\n            repl = \"&amp;#\" &amp; CStr(acode) &amp; \";\"\n    End Select\n    If Len(repl) Then\n        HTMLEncode = Left$(HTMLEncode, i - 1) &amp; repl &amp; Mid$(HTMLEncode, _\n            i + 1)\n        repl = \"\"\n    End If\nNext\nEnd Function\n</code></pre>\n\n<p>ref: <a href=\"http://www.devx.com/vb2themax/Tip/19162\" rel=\"nofollow\">http://www.devx.com/vb2themax/Tip/19162</a></p>\n\n<p>There is another here: <a href=\"http://www.codeproject.com/Articles/33064/VBScript-HTML-Encode\" rel=\"nofollow\">http://www.codeproject.com/Articles/33064/VBScript-HTML-Encode</a> \nbut that seems to encode everything that's not a character or letter. The regex in this one could probably be expanded a little better to include those that are ok for HTML.</p>\n\n<pre><code>Function HTMLEncode(ByVal sVal)\n\nsReturn = \"\"\n\nIf ((TypeName(sVal)=\"String\") And (Not IsNull(sVal)) And (sVal&lt;&gt;\"\")) Then\n\n    For i = 1 To Len(sVal)\n\n        ch = Mid(sVal, i, 1)\n\n        Set oRE = New RegExp : oRE.Pattern = \"[ a-zA-Z0-9]\"\n\n        If (Not oRE.Test(ch)) Then\n            ch = \"&amp;#\" &amp; Asc(ch) &amp; \";\"\n        End If\n\n        sReturn = sReturn &amp; ch\n\n        Set oRE = Nothing\n    Next\nEnd If\n\nHTMLEncode = sReturn\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 279, "user_id": 5607762, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/fae4c4a7bf2793baa71cd24bdced10f5?s=128&d=identicon&r=PG&f=1", "display_name": "GohanP", "link": "https://stackoverflow.com/users/5607762/gohanp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 0, "accepted_answer_id": 34308526, "answer_count": 3, "score": 4, "last_activity_date": 1450260184, "creation_date": 1450258417, "last_edit_date": 1531164843, "question_id": 34308367, "link": "https://stackoverflow.com/questions/34308367/replace-function-how-to-replace-not-all-founded-strings", "title": "Replace function, how to replace not all founded strings?", "body": "<p>I create XML file from excel file. I save a string from one cell in a variable sObserved. When in that string I have a character <code>\"&amp;\"</code> it should be replaced to <code>\"&amp;amp;\"</code>and when I have a character <code>\";\"</code> it should be replaced to <code>\"&amp;#59;\"</code>.\n I use for this function Replace, this is my code:</p>\n\n<pre><code>        sObserved = Replace(sObserved, \"&amp;\", \"&amp;amp;\")\n        sObserved = Replace(sObserved, \";\", \"&amp;#59;\")\n</code></pre>\n\n<p>But this can't work good, because when it will replace <code>\"&amp;\"</code> on <code>\"&amp;amp;\"</code>, the <code>\";\"</code> will appear and next operation will change it to <code>\"&amp;amp&amp;#59;\"</code>\nIf I'll change an order it also will be wrong, because then sign \"&amp;\" in <code>\"&amp;#59\"</code> will be replaced.</p>\n\n<p>Is there any possibility to replace it just like I wanted? I will be gratefull for any ideas because I stuck here.</p>\n"}, {"tags": ["excel", "vba", "macos"], "answers": [{"tags": [], "owner": {"reputation": 926, "user_id": 5621032, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zG42x.jpg?s=128&g=1", "display_name": "Kathara", "link": "https://stackoverflow.com/users/5621032/kathara"}, "is_accepted": false, "score": 0, "last_activity_date": 1450430933, "creation_date": 1450430933, "answer_id": 34352319, "question_id": 34306893, "link": "https://stackoverflow.com/questions/34306893/copy-and-paste-data-in-mac-using-terminal/34352319#34352319", "title": "Copy and paste data in Mac using terminal", "body": "<p>I believe the only thing you need to change is instead of \"sourcefile.xlsx\" and \"destinationfile.xlsm\" you need to add the full Path. Be aware that on mac the path is written differently than on windows.</p>\n\n<p>Windows EX: C:\\Documents\\sourcefile.xlsx</p>\n\n<p>Mac EX:     OSX:Users:\"Username\":Documents:sourcefile.xlsx</p>\n\n<p>On Mac you can get the username with the following code</p>\n\n<pre><code>Function GetUserName() As String\n    Dim sMyScript As String\n\n    sMyScript = \"set userName to short user name of (system info)\" &amp; vbNewLine &amp; \"return userName\"\n\n    GetUserName = MacScript(sMyScript)\nEnd Function\n</code></pre>\n\n<p>In your code this would look something like this:</p>\n\n<pre><code>Set objExcel = CreateObject(\"Excel.Application\")\nobjExcel.Visible = True\nSet srcData = objExcel.Workbooks.Open(\"OSX:Users:\" &amp; GetUserName.GetUserName &amp; \":Documents:sourcefile.xlsx\")\nSet destinationData = objExcel.Workbooks.Open(\"OSX:Users:\" &amp; GetUserName.GetUserName &amp; \":Documents:destinationfile.xlsm\")\n</code></pre>\n\n<p>You could also:</p>\n\n<pre><code>Dim xlPath As String\nxlPath = \"OSX:Users:\" &amp; GetUserName.GetUserName &amp; \":Documents:\"\nSet objExcel = CreateObject(\"Excel.Application\")\nobjExcel.Visible = True\nSet srcData = objExcel.Workbooks.Open(xlPath &amp; \"sourcefile.xlsx\")\nSet destinationData = objExcel.Workbooks.Open(xlPath &amp; \"destinationfile.xlsm\")\n</code></pre>\n\n<p>For me this worked just fine. Hope it works for you as well.</p>\n\n<p>CU</p>\n"}], "owner": {"reputation": 29, "user_id": 5436308, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/be7c36f1aea401252ccb3e513eef0c19?s=128&d=identicon&r=PG&f=1", "display_name": "Maya", "link": "https://stackoverflow.com/users/5436308/maya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 607, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1593729097, "creation_date": 1450253671, "last_edit_date": 1593729097, "question_id": 34306893, "link": "https://stackoverflow.com/questions/34306893/copy-and-paste-data-in-mac-using-terminal", "title": "Copy and paste data in Mac using terminal", "body": "<p>I used vbscript to copy and paste data in Excel through command line. I would like to perform the same work in Mac. Following is the vbscript, I've used for Windows:</p>\n\n<pre><code>    Set objExcel = CreateObject(\"Excel.Application\") \n    objExcel.Visible = True\n    Set srcData = objExcel.Workbooks.Open(\"sourcefile.xlsx\") \n    Set destinationData = objExcel.Workbooks.Open(\"destinationfile.xlsm\") \n    srcData.sheets(\"Sheet1\").Range(\"A1\").copy destinationData.sheets(\"Sheet1\").Range(\"A1\")\n    srcData.close False\n</code></pre>\n\n<p>I don't know how to do it in Mac. Please help me in converting the script.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "edited": false, "score": 3, "creation_date": 1450251221, "post_id": 34306205, "comment_id": 56354127, "body": "please share your code you have tried before"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1450251763, "post_id": 34306205, "comment_id": 56354404, "body": "What do you want if it is in one of the cells? What if it is in both of the cells? What if it is in none of the cells? If you had included what you had tried (working or not) then these questions would have been answered."}, {"owner": {"reputation": 1, "user_id": 5685343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eac6b5609fd9816777a3ed219a6c236a?s=128&d=identicon&r=PG&f=1", "display_name": "Azure", "link": "https://stackoverflow.com/users/5685343/azure"}, "edited": false, "score": 0, "creation_date": 1450251898, "post_id": 34306205, "comment_id": 56354465, "body": "Sub try()      Dim lRow As Long     Dim strSearch As String      strSearch = &quot;BHA&quot;      With Sheets(&quot;Sheet1&quot;)                  .AutoFilterMode = False          lRow = .Range(&quot;A&quot; &amp; .Rows.Count).End(xlUp).Row          With .Range(&quot;A&quot; &amp; lRow)             .AutoFilter Field:=1, Criteria1:=&quot;=*&quot; &amp; strSearch &amp; &quot;*&quot;             .Offset(1, 0).SpecialCells(xlCellTypeVisible).EntireRow.Delete         End With          .AutoFilterMode = False     End With End Sub"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1450254219, "post_id": 34306205, "comment_id": 56355661, "body": "... so .... now you want to delete the row ...?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1450255634, "post_id": 34306205, "comment_id": 56356438, "body": "Azure - I get that you need some help getting started but when you ask for putting a value in column C and supply code that deletes a row some clarification is in order. Either you have misinterpreted what you were trying or simply don&#39;t know what a delete command does; I cannot tell from this side of the computer screen. That code would have been better if you had removed the delete command and simply put a comment in that said <code>&#39;here is where I want to put a value in C</code>."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 1, "user_id": 5685343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eac6b5609fd9816777a3ed219a6c236a?s=128&d=identicon&r=PG&f=1", "display_name": "Azure", "link": "https://stackoverflow.com/users/5685343/azure"}, "edited": false, "score": 0, "creation_date": 1450282416, "post_id": 34307378, "comment_id": 56375547, "body": "That sounds like a new question. Suggest you close off this question (click the checkmark on the left beside one of the suggested answers) then start work on modifying the code. <a href=\"http://stackoverflow.com/questions/29084078/filter-column-values-different-one-by-one-using-excel-vba/29107536#29107536\">Hint</a>. If you run into trouble, start a new question with your own effort, noting where you are having trouble and any error messages that you are receiving."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1450255435, "creation_date": 1450255435, "answer_id": 34307378, "question_id": 34306205, "link": "https://stackoverflow.com/questions/34306205/extract-a-word-from-string-with-noise-and-print-it-in-the-next-column/34307378#34307378", "title": "Extract a word from string with noise and print it in the next column", "body": "<p>This short snippet is taken largely from the snippet you provided but replaces the row deletion with stuffing the value of the strSearch var in column C on the matching rows.</p>\n\n<pre><code>Sub try_again()\n    Dim strSearch As String, c As Long\n\n    strSearch = \"BHA\"\n    With Worksheets(\"Sheet4\")\n        .AutoFilterMode = False\n        For c = 1 To 2\n            With Intersect(.Columns(c), .UsedRange)\n                .AutoFilter Field:=1, Criteria1:=Chr(42) &amp; strSearch &amp; Chr(42)\n                With .Resize(.Rows.Count - 1, 1).Offset(1, 0)\n                    If CBool(Application.Subtotal(103, .Cells)) Then\n                        .Offset(0, 2 + (c &gt; 1)) = strSearch\n                    End If\n                End With\n                .AutoFilter\n            End With\n        Next c\n        .AutoFilterMode = False\n    End With\nEnd Sub\n</code></pre>\n\n<p>The native worksheet <a href=\"https://support.office.com/en-us/article/SUBTOTAL-function-e27c301c-be9a-458b-9d12-b9a2ce3c62af\" rel=\"nofollow\">SUBTOTAL function</a> is used to check for visible rows since its <a href=\"https://support.office.com/en-us/article/counta-function-47239e46-e523-40f4-94d7-fa2e1711fd4a\" rel=\"nofollow\">COUNTA sub-function</a> does not count hidden values.</p>\n"}, {"comments": [{"owner": {"reputation": 255, "user_id": 2977498, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e428db2f7d16874d410ca76becc84455?s=128&d=identicon&r=PG&f=1", "display_name": "Ollie", "link": "https://stackoverflow.com/users/2977498/ollie"}, "reply_to_user": {"reputation": 1, "user_id": 5685343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eac6b5609fd9816777a3ed219a6c236a?s=128&d=identicon&r=PG&f=1", "display_name": "Azure", "link": "https://stackoverflow.com/users/5685343/azure"}, "edited": false, "score": 0, "creation_date": 1450289159, "post_id": 34307903, "comment_id": 56379736, "body": "@Azure Yes, that is possible. I am tied up right now, but I am happy to tweak the code to do what you&#39;re asking. I&#39;ll respond shortly. Sorry for the delay."}, {"owner": {"reputation": 255, "user_id": 2977498, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e428db2f7d16874d410ca76becc84455?s=128&d=identicon&r=PG&f=1", "display_name": "Ollie", "link": "https://stackoverflow.com/users/2977498/ollie"}, "reply_to_user": {"reputation": 1, "user_id": 5685343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eac6b5609fd9816777a3ed219a6c236a?s=128&d=identicon&r=PG&f=1", "display_name": "Azure", "link": "https://stackoverflow.com/users/5685343/azure"}, "edited": false, "score": 0, "creation_date": 1450294588, "post_id": 34307903, "comment_id": 56382913, "body": "@Azure I updated my original post. It should work OK for you. The only thing is if &quot;X&quot; appears in COL A and &quot;X&quot; appears in COL B too, then you will get A-A. Not sure if having duplicates matters. If you are happy with the answer, would you mind selecting the check mark next to my post. I&#39;m a newbie too and trying to build my rep here (for bragging points and hopefully a programming job somewhere soon!). Thank you!!"}, {"owner": {"reputation": 255, "user_id": 2977498, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e428db2f7d16874d410ca76becc84455?s=128&d=identicon&r=PG&f=1", "display_name": "Ollie", "link": "https://stackoverflow.com/users/2977498/ollie"}, "reply_to_user": {"reputation": 1, "user_id": 5685343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eac6b5609fd9816777a3ed219a6c236a?s=128&d=identicon&r=PG&f=1", "display_name": "Azure", "link": "https://stackoverflow.com/users/5685343/azure"}, "edited": false, "score": 0, "creation_date": 1450297360, "post_id": 34307903, "comment_id": 56384393, "body": "@Azure Same to you!! Happy to help!!"}], "tags": [], "owner": {"reputation": 255, "user_id": 2977498, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e428db2f7d16874d410ca76becc84455?s=128&d=identicon&r=PG&f=1", "display_name": "Ollie", "link": "https://stackoverflow.com/users/2977498/ollie"}, "is_accepted": true, "score": 0, "last_activity_date": 1450294945, "last_edit_date": 1450294945, "creation_date": 1450257085, "answer_id": 34307903, "question_id": 34306205, "link": "https://stackoverflow.com/questions/34306205/extract-a-word-from-string-with-noise-and-print-it-in-the-next-column/34307903#34307903", "title": "Extract a word from string with noise and print it in the next column", "body": "<p>This should get you started. It will search COL A for the key word, then search COL B for the key word. If the word is found in either A or B, it will print the word in COL C of the same row.</p>\n\n<p><strong>This is with Single Search Term</strong></p>\n\n<pre><code>Sub ExtractKeyWordFromColAAndColB()\n\n    Dim SearchedWord As String\n    Dim NewString As String\n    Dim LengthWord As Long\n    Dim IndexStartWord As Long\n    SearchedWord = \"Y\" 'The Key Word\n    LengthWord = Len(SearchedWord) 'The Length of the key word\n\n    For i = 1 To ActiveSheet.UsedRange.Rows.Count\n        NewString = \"\" 'Set to EMPTY with each iteration\n\n        If InStr(UCase(Range(\"A\" &amp; i).Value), UCase(SearchedWord)) &gt; 0 Then 'Look for Key word in Column A; Not Case sensitive\n            IndexStartWord = WorksheetFunction.Find(UCase(SearchedWord), UCase(Range(\"A\" &amp; i).Value))\n            NewString = Mid(Range(\"A\" &amp; i).Value, IndexStartWord, LengthWord)\n        End If\n\n         If InStr(UCase(Range(\"B\" &amp; i).Value), UCase(SearchedWord)) &gt; 0 Then 'Look for Key word in Column B; Not Case sensitive\n            IndexStartWord = WorksheetFunction.Find(UCase(SearchedWord), UCase(Range(\"B\" &amp; i).Value))\n            NewString = NewString + \" \" + Mid(Range(\"B\" &amp; i).Value, IndexStartWord, LengthWord)\n        End If\n\n        Range(\"C\" &amp; i).Value = WorksheetFunction.Trim(NewString)\n\n\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p><strong>This is with Multiple Search Terms</strong></p>\n\n<pre><code>Sub ExtractKeyWordFromColAAndColB()\n\n    Dim NewString As String\n    Dim ColumnLetter As String\n    Dim IndexStartWord As Long\n    Dim SearchedWord(0 To 2) As String 'Key Words; You may add more to the list.\n    'If you add more to the list update numbers above (i.e. SearchedWord(0 To 2))\n    SearchedWord(0) = \"X\"\n    SearchedWord(1) = \"Y\"\n    SearchedWord(2) = \"Z\"\n\n    For i = 1 To ActiveSheet.UsedRange.Rows.Count\n        NewString = \"\" 'Set to EMPTY with each iteration\n\n        For k = 1 To 2\n\n            If k = 1 Then ColumnLetter = \"A\" Else ColumnLetter = \"B\"\n\n            For j = 0 To UBound(SearchedWord) 'Look for Key words; Not Case sensitive\n                If InStr(UCase(Range(ColumnLetter &amp; i).Value), UCase(SearchedWord(j))) &gt; 0 Then\n                    IndexStartWord = WorksheetFunction.Find(UCase(SearchedWord(j)), UCase(Range(ColumnLetter &amp; i).Value))\n                    NewString = NewString + \"-\" + Mid(Range(ColumnLetter &amp; i).Value, IndexStartWord, Len(SearchedWord(j)))\n                End If\n            Next j\n        Next k\n\n        Range(\"C\" &amp; i).Value = WorksheetFunction.Substitute(NewString, \"-\", \"\", 1)\n    Next i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5685343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eac6b5609fd9816777a3ed219a6c236a?s=128&d=identicon&r=PG&f=1", "display_name": "Azure", "link": "https://stackoverflow.com/users/5685343/azure"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 34307903, "answer_count": 2, "score": -5, "last_activity_date": 1450294945, "creation_date": 1450250950, "last_edit_date": 1450252561, "question_id": 34306205, "link": "https://stackoverflow.com/questions/34306205/extract-a-word-from-string-with-noise-and-print-it-in-the-next-column", "title": "Extract a word from string with noise and print it in the next column", "body": "<p>I have two columns (column A and B) of data with lots of noise that I am trying to extract certain words out of and print those words in the next columns using VBA. The columns go as follows (comma separates the rows):</p>\n\n<pre><code>Column A: Blah, Blah, Y, Blah\nColumn B: Blah, %_Y, Blah\n</code></pre>\n\n<p>Code so far (from comments):</p>\n\n<pre><code>Sub try() \n    Dim lRow As Long\n    Dim strSearch As String\n\n    strSearch = \"BHA\"\n    With Sheets(\"Sheet1\") \n        .AutoFilterMode = False \n        lRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row \n        With .Range(\"A\" &amp; lRow)\n            .AutoFilter Field:=1, Criteria1:=\"=*\" &amp; strSearch &amp; \"*\"\n            .Offset(1, 0).SpecialCells(xlCellTypeVisible).EntireRow.Delete\n        End With\n        .AutoFilterMode = False\n    End With \nEnd Sub\n</code></pre>\n\n<p>I would like to extract the word \"Y\" from both columns when \"Y\" is found in a row, I would like to have it printed in the exact same row in Column C.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1450251214, "post_id": 34305880, "comment_id": 56354124, "body": "Do you have any volatile functions in the workbook? Particularly in columns H:AU (e.g. INDIRECT, OFFSET, NOW, TODAY, etc). fwiw, you are writing 39,960 formulas; mine takes ~80 seconds; what is the extent (last row) of MOODLE?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1450253862, "post_id": 34305880, "comment_id": 56355476, "body": "Addendum: Is there a Worksheet_Change for that worksheet or a Workbook_Sheetchange for the workbook?"}], "answers": [{"tags": [], "owner": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "is_accepted": false, "score": 0, "last_activity_date": 1450252761, "creation_date": 1450252761, "answer_id": 34306675, "question_id": 34305880, "link": "https://stackoverflow.com/questions/34305880/why-does-this-one-line-take-so-long/34306675#34306675", "title": "Why does this one line take SO long?", "body": "<p>I can think of two reasons for your problem:</p>\n\n<ol>\n<li>your formula itself requires lots of calculation. A column has <code>2^10</code> rows. In your formula, you input two whole column into the <code>criteria_range</code> fields, it means Excel has <code>2^10 + 2^10</code> of <code>IF</code> to check, and that only is for one cell. You apply it to <code>39960</code> cells. Try limit the input of <code>criteria_range</code> to a smaller range. (In my experience, when using <code>COUNTIF</code> with <code>criteria_range</code> of 10,000 cells and applying the formula over 10,000 cells, things start to get very sloppy).</li>\n<li>you have other Excel open which also has many volatile functions. Try closing them.</li>\n</ol>\n\n<p>Also, may be turning calculation to Manual mode would ease the pain? </p>\n"}], "owner": {"reputation": 199, "user_id": 2820267, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/81460d8b54aa72f2a2750aa5679d25c0?s=128&d=identicon&r=PG&f=1", "display_name": "M. H", "link": "https://stackoverflow.com/users/2820267/m-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1450271618, "creation_date": 1450249695, "last_edit_date": 1450271618, "question_id": 34305880, "link": "https://stackoverflow.com/questions/34305880/why-does-this-one-line-take-so-long", "title": "Why does this one line take SO long?", "body": "<p>I want to put a lot of identical formulas in to a medium sized range. And it is taking forever to process. The code I am using is:       </p>\n\n<pre><code>.Range(\"M2:AZ1000\").FormulaR1C1 = \"=COUNTIFS(MOODLE!C[-5],\"\"Y\"\",MOODLE!C3,RC3)\"  \n</code></pre>\n\n<p>but the line takes about five minutes to run.</p>\n\n<p>I have tried switching calculation off, inserting the formulas then back on (this INCREASES the time it takes as it seems to now calculate twice!).</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 1, "creation_date": 1450248593, "post_id": 34305560, "comment_id": 56352867, "body": "So you just need to put <code>0</code> in all the cells of worksheet and you don&#39;t know how ?"}, {"owner": {"reputation": 197, "user_id": 2237769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7SvdY.jpg?s=128&g=1", "display_name": "Kanike Vamshi Krishna", "link": "https://stackoverflow.com/users/2237769/kanike-vamshi-krishna"}, "edited": false, "score": 0, "creation_date": 1450249778, "post_id": 34305560, "comment_id": 56353397, "body": "Give more context please. About how the data looks or where are you copying it to and change which values to 0"}, {"owner": {"reputation": 45, "user_id": 5681777, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/86108a366d2a195ca8de9a57b3649f74?s=128&d=identicon&r=PG&f=1", "display_name": "anp", "link": "https://stackoverflow.com/users/5681777/anp"}, "edited": false, "score": 0, "creation_date": 1450252125, "post_id": 34305560, "comment_id": 56354564, "body": "Thanks for your reply. I copying from inactive workbooks, and there is one column i need to change. This would be C3:C19. After copying them they should be changed. The plan is to use this as a test to check if they have been updated until next month."}], "answers": [{"tags": [], "owner": {"reputation": 686, "user_id": 5623502, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ZYRAI.gif?s=128&g=1", "display_name": "Eric K.", "link": "https://stackoverflow.com/users/5623502/eric-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1450248990, "creation_date": 1450248990, "answer_id": 34305687, "question_id": 34305560, "link": "https://stackoverflow.com/questions/34305560/how-to-change-values-in-spesific-cells-after-copying-vba/34305687#34305687", "title": "How to change values in spesific cells after copying VBA", "body": "<p>It will be better if you could show some of your code.</p>\n\n<pre><code>Range(\"whatever\") = 0\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 45, "user_id": 5681777, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/86108a366d2a195ca8de9a57b3649f74?s=128&d=identicon&r=PG&f=1", "display_name": "anp", "link": "https://stackoverflow.com/users/5681777/anp"}, "edited": false, "score": 0, "creation_date": 1450256742, "post_id": 34307472, "comment_id": 56357163, "body": "When using the Range.(&quot;C3:C19&quot;).Value=0, it changes both values in the workbook I copy from and the one I paste it into. Do I need to paste before changing the values? I do it after."}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "reply_to_user": {"reputation": 45, "user_id": 5681777, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/86108a366d2a195ca8de9a57b3649f74?s=128&d=identicon&r=PG&f=1", "display_name": "anp", "link": "https://stackoverflow.com/users/5681777/anp"}, "edited": false, "score": 0, "creation_date": 1450258447, "post_id": 34307472, "comment_id": 56358270, "body": "You need to do it in the order I specified. If you change the value to 0 before you copy, you&#39;re copying the 0, not the previous values."}], "tags": [], "owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "is_accepted": true, "score": 0, "last_activity_date": 1450255776, "creation_date": 1450255776, "answer_id": 34307472, "question_id": 34305560, "link": "https://stackoverflow.com/questions/34305560/how-to-change-values-in-spesific-cells-after-copying-vba/34307472#34307472", "title": "How to change values in spesific cells after copying VBA", "body": "<pre><code>Worksheets(1).Range(\"A3:D19\").Copy\nWorksheets(2).Range(\"A3:D19\").Paste ' &lt;~~ Do whatever else here\nWorksheets(1).Range(\"C3:C19\").Value = 0\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 5681777, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/86108a366d2a195ca8de9a57b3649f74?s=128&d=identicon&r=PG&f=1", "display_name": "anp", "link": "https://stackoverflow.com/users/5681777/anp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 34307472, "answer_count": 2, "score": -3, "last_activity_date": 1509477778, "creation_date": 1450248518, "last_edit_date": 1509477778, "question_id": 34305560, "link": "https://stackoverflow.com/questions/34305560/how-to-change-values-in-spesific-cells-after-copying-vba", "title": "How to change values in spesific cells after copying VBA", "body": "<p>I need to change all the values in a workbook that is not active. All the values are listed in the same column. </p>\n\n<p>In the code i'm first going to copy some specific cells, after copy them I want to set the value = 0 in cells C3:C19. My code looks like this:</p>\n\n<pre><code>Range(\"A3:D19\").Copy\n\nActiveWorkbook.Close False\n</code></pre>\n\n<p>I then tried to used replace on C3:C19, this did not work.</p>\n\n<p>Thanks :) </p>\n"}, {"tags": ["sql", "vba", "ms-access", "random", "insert-update"], "comments": [{"owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "edited": false, "score": 0, "creation_date": 1450244822, "post_id": 34304485, "comment_id": 56351394, "body": "Function should work fine. Please share us with SQL you use for update. And please format function code as code"}, {"owner": {"reputation": 5, "user_id": 2491058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6448de9cd0874c991e5392d4bd9594d?s=128&d=identicon&r=PG", "display_name": "cicor", "link": "https://stackoverflow.com/users/2491058/cicor"}, "reply_to_user": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "edited": false, "score": 0, "creation_date": 1450256377, "post_id": 34304485, "comment_id": 56356913, "body": "Thanks can you check it out now I have updated @SergeyS."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 2491058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6448de9cd0874c991e5392d4bd9594d?s=128&d=identicon&r=PG", "display_name": "cicor", "link": "https://stackoverflow.com/users/2491058/cicor"}, "edited": false, "score": 0, "creation_date": 1450272979, "post_id": 34307839, "comment_id": 56368480, "body": "thanks when i add (8.10,8.30) it produce 8.10235 random but i need only 2 decimal how can i do that like &quot;8.13&quot; @SergeyS."}, {"owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "reply_to_user": {"reputation": 5, "user_id": 2491058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6448de9cd0874c991e5392d4bd9594d?s=128&d=identicon&r=PG", "display_name": "cicor", "link": "https://stackoverflow.com/users/2491058/cicor"}, "edited": false, "score": 0, "creation_date": 1450275004, "post_id": 34307839, "comment_id": 56369977, "body": "Use <code>Round</code> and/or <code>Format</code> functions."}, {"owner": {"reputation": 5, "user_id": 2491058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6448de9cd0874c991e5392d4bd9594d?s=128&d=identicon&r=PG", "display_name": "cicor", "link": "https://stackoverflow.com/users/2491058/cicor"}, "edited": false, "score": 0, "creation_date": 1450615029, "post_id": 34307839, "comment_id": 56503459, "body": "thanks for answer how can I use time between like (6:20,6:30) instead of numbers. @SergeyS."}, {"owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "reply_to_user": {"reputation": 5, "user_id": 2491058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6448de9cd0874c991e5392d4bd9594d?s=128&d=identicon&r=PG", "display_name": "cicor", "link": "https://stackoverflow.com/users/2491058/cicor"}, "edited": false, "score": 0, "creation_date": 1450673074, "post_id": 34307839, "comment_id": 56519441, "body": "For instance <code>DateAdd(&quot;n&quot;,Rnd()*10,#6:20#)</code>"}, {"owner": {"reputation": 5, "user_id": 2491058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6448de9cd0874c991e5392d4bd9594d?s=128&d=identicon&r=PG", "display_name": "cicor", "link": "https://stackoverflow.com/users/2491058/cicor"}, "edited": false, "score": 0, "creation_date": 1450674164, "post_id": 34307839, "comment_id": 56519716, "body": "I am using same function but it doesn&#39;t produce different random no"}, {"owner": {"reputation": 5, "user_id": 2491058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6448de9cd0874c991e5392d4bd9594d?s=128&d=identicon&r=PG", "display_name": "cicor", "link": "https://stackoverflow.com/users/2491058/cicor"}, "edited": false, "score": 0, "creation_date": 1450674626, "post_id": 34307839, "comment_id": 56519841, "body": "I am using same function but it doesn&#39;t produce different random time it produce like in column time2 : 0.2673611 same value in whole column i know its number format of time. every cell gets same its not ramdom. can you please provide vb and sql both please it will be helpful @SergeyS."}, {"owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "reply_to_user": {"reputation": 5, "user_id": 2491058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6448de9cd0874c991e5392d4bd9594d?s=128&d=identicon&r=PG", "display_name": "cicor", "link": "https://stackoverflow.com/users/2491058/cicor"}, "edited": false, "score": 0, "creation_date": 1450676175, "post_id": 34307839, "comment_id": 56520270, "body": "Change data type of Time columns to date/time and rewrite RanNumBtw, it should return Date data type. Use [ID] column for randomizing in each row"}], "tags": [], "owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "is_accepted": true, "score": 1, "last_activity_date": 1450256885, "creation_date": 1450256885, "answer_id": 34307839, "question_id": 34304485, "link": "https://stackoverflow.com/questions/34304485/how-to-do-microsoft-access-update-query-or-vb-function-which-use-random-unique-n/34307839#34307839", "title": "How to do microsoft access update query or vb function which use random unique number with in specific numbers range", "body": "<p>Change your function as:</p>\n\n<pre><code>Public Function RanNumBtw(LwLimit As Long, UpLimit As Long, RandInit As Long) As Long\n    Randomize RandInit + Now()\n    RanNumBtw = Rnd * (UpLimit - LwLimit) + LwLimit\nEnd Function\n</code></pre>\n\n<p>and query as:</p>\n\n<pre><code>UPDATE Table1 SET Table1.time2 = RanNumBtw(10,20,[id]), Table1.tim1 = RanNumBtw(10,20,[id])\nWHERE (((Table1.id1) In (101,102)));\n</code></pre>\n\n<p>Access cashes function results if arguments are the same for each row.</p>\n"}], "owner": {"reputation": 5, "user_id": 2491058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6448de9cd0874c991e5392d4bd9594d?s=128&d=identicon&r=PG", "display_name": "cicor", "link": "https://stackoverflow.com/users/2491058/cicor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 216, "favorite_count": 0, "accepted_answer_id": 34307839, "answer_count": 1, "score": 0, "last_activity_date": 1450256885, "creation_date": 1450243414, "last_edit_date": 1450255209, "question_id": 34304485, "link": "https://stackoverflow.com/questions/34304485/how-to-do-microsoft-access-update-query-or-vb-function-which-use-random-unique-n", "title": "How to do microsoft access update query or vb function which use random unique number with in specific numbers range", "body": "<p>How can i write ms access update query that updates table records which uses random unique number but with in specific range.</p>\n\n<p>Here what i need help with</p>\n\n<p>Problem Before</p>\n\n<p>id  Id1 time2   tim1<br>\n1   101 <strong>8.12</strong>    <strong>9.11</strong><br>\n2   102 <strong>8.20</strong>    <strong>9.45</strong><br>\n3   103 8.31    9.12<br>\n4   104 8.10    9.10<br>\n5   105 8.55    9.43  </p>\n\n<p>after running query</p>\n\n<pre><code>UPDATE Table1 SET Table1.time2 = RanNumBtw(10,20), Table1.tim1 = RanNumBtw(10,20)\nWHERE (((Table1.id1) In (101,102)));\n</code></pre>\n\n<p>Output which i don't need </p>\n\n<p>id  Id1 time2   tim1<br>\n1   101 <strong>13</strong>      <strong>13</strong><br>\n2   102 <strong>13</strong>      <strong>13</strong><br>\n3   103 8.31    9.12<br>\n4   104 8.10    9.10<br>\n5   105 8.55    9.43  </p>\n\n<p>what i need as output</p>\n\n<p>id  Id1 time2   tim1<br>\n1   101 <strong>13</strong>      <strong>16</strong><br>\n2   102 <strong>19</strong>      <strong>11</strong><br>\n3   103 8.31    9.12<br>\n4   104 8.10    9.10<br>\n5   105 8.55    9.43  </p>\n\n<p>Now problem what i need to do is update time2 column and tim1 column with in specific range based on id1 column.</p>\n\n<p>like where id1 is 101,102 update time2 between (8.10  to 8.30) and tim1 between (9.10  to 9.30) to Random Unique number.</p>\n\n<p>I have tried vb function which generate number between specified range but it update with same number again and again</p>\n\n<pre><code>Public Function RanNumBtw(ByVal LwLimit As Long, ByVal UpLimit As Long) As Long \n    Randomize\n    RanNumBtw = Rnd * (UpLimit - LwLimit) + LwLimit\nEnd Function\n</code></pre>\n\n<p>what this function does is it gives same number again for all cells</p>\n\n<p>query or vb code will help </p>\n\n<p>thanks </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 197, "user_id": 2237769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7SvdY.jpg?s=128&g=1", "display_name": "Kanike Vamshi Krishna", "link": "https://stackoverflow.com/users/2237769/kanike-vamshi-krishna"}, "edited": false, "score": 0, "creation_date": 1450247141, "post_id": 34304460, "comment_id": 56352232, "body": "Do you want a report with the Sum of object (similar #post) for every Region in your above table? Or Do you want to have the sum of objects based on the how you change the filter ?"}, {"owner": {"reputation": 29, "user_id": 5633202, "user_type": "registered", "accept_rate": 17, "profile_image": "https://lh4.googleusercontent.com/-qyIvCk55uGo/AAAAAAAAAAI/AAAAAAAAAME/ppf8nHoJtfo/photo.jpg?sz=128", "display_name": "DK23", "link": "https://stackoverflow.com/users/5633202/dk23"}, "reply_to_user": {"reputation": 197, "user_id": 2237769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7SvdY.jpg?s=128&g=1", "display_name": "Kanike Vamshi Krishna", "link": "https://stackoverflow.com/users/2237769/kanike-vamshi-krishna"}, "edited": false, "score": 0, "creation_date": 1450248092, "post_id": 34304460, "comment_id": 56352658, "body": "Hi Kanike, here is the condition that need to be True - Date = Today&#39;s date, Tag = Same ( in this case &quot;Research Investment Banking&quot;) and Region = UK &amp; EMEA ( in this case). So yes, it will be based on the filter I chose.  You let me know if you want the whole VBA code to get a picture. Thanks!"}, {"owner": {"reputation": 29, "user_id": 5633202, "user_type": "registered", "accept_rate": 17, "profile_image": "https://lh4.googleusercontent.com/-qyIvCk55uGo/AAAAAAAAAAI/AAAAAAAAAME/ppf8nHoJtfo/photo.jpg?sz=128", "display_name": "DK23", "link": "https://stackoverflow.com/users/5633202/dk23"}, "reply_to_user": {"reputation": 197, "user_id": 2237769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7SvdY.jpg?s=128&g=1", "display_name": "Kanike Vamshi Krishna", "link": "https://stackoverflow.com/users/2237769/kanike-vamshi-krishna"}, "edited": false, "score": 0, "creation_date": 1450248209, "post_id": 34304460, "comment_id": 56352695, "body": "I&#39;ve written this code:"}, {"owner": {"reputation": 197, "user_id": 2237769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7SvdY.jpg?s=128&g=1", "display_name": "Kanike Vamshi Krishna", "link": "https://stackoverflow.com/users/2237769/kanike-vamshi-krishna"}, "edited": false, "score": 0, "creation_date": 1450249027, "post_id": 34304460, "comment_id": 56353050, "body": "If you want the sum of posts on the fly, based on region &amp; tag, then using Pivots is easy and writing VBA can be avoided. And change the pivot filters based on your requirement. You can follow the steps below, answered by @Ethun_Hunt"}, {"owner": {"reputation": 29, "user_id": 5633202, "user_type": "registered", "accept_rate": 17, "profile_image": "https://lh4.googleusercontent.com/-qyIvCk55uGo/AAAAAAAAAAI/AAAAAAAAAME/ppf8nHoJtfo/photo.jpg?sz=128", "display_name": "DK23", "link": "https://stackoverflow.com/users/5633202/dk23"}, "reply_to_user": {"reputation": 197, "user_id": 2237769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7SvdY.jpg?s=128&g=1", "display_name": "Kanike Vamshi Krishna", "link": "https://stackoverflow.com/users/2237769/kanike-vamshi-krishna"}, "edited": false, "score": 0, "creation_date": 1450249715, "post_id": 34304460, "comment_id": 56353365, "body": "These selection are to be made in the background and final output is in a different sheet in a form of Table. Hence, can&#39;t use Pivot. Plus this a client requirement. But not a problem. I got the fix but just making some changes to the existing code it&#39;s working fine now. Thanks!"}, {"owner": {"reputation": 29, "user_id": 5633202, "user_type": "registered", "accept_rate": 17, "profile_image": "https://lh4.googleusercontent.com/-qyIvCk55uGo/AAAAAAAAAAI/AAAAAAAAAME/ppf8nHoJtfo/photo.jpg?sz=128", "display_name": "DK23", "link": "https://stackoverflow.com/users/5633202/dk23"}, "reply_to_user": {"reputation": 197, "user_id": 2237769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7SvdY.jpg?s=128&g=1", "display_name": "Kanike Vamshi Krishna", "link": "https://stackoverflow.com/users/2237769/kanike-vamshi-krishna"}, "edited": false, "score": 0, "creation_date": 1450249785, "post_id": 34304460, "comment_id": 56353401, "body": "This step resolved the problem:     &#39;filtering data as per Tag &amp; Region          Dim Tag As String     Dim Region As String      Tag = Sheets(&quot;Raw&quot;).Range(&quot;I1&quot;)     Region = Sheets(&quot;Raw&quot;).Range(&quot;H1&quot;)      Range(&quot;D1&quot;).Select     Selection.AutoFilter     Sheets(&quot;Raw&quot;).Range(&quot;$A$1:$E$23&quot;).AutoFilter Field:=4, Criteria1:= _      Tag     Sheets(&quot;Raw&quot;).Range(&quot;$A$1:$E$23&quot;).AutoFilter Field:=5, Criteria1:= _         Region"}, {"owner": {"reputation": 197, "user_id": 2237769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7SvdY.jpg?s=128&g=1", "display_name": "Kanike Vamshi Krishna", "link": "https://stackoverflow.com/users/2237769/kanike-vamshi-krishna"}, "edited": false, "score": 0, "creation_date": 1450249878, "post_id": 34304460, "comment_id": 56353452, "body": "If it is resolved then great. Do let know if you face further difficulties"}], "answers": [{"tags": [], "owner": {"reputation": 257, "user_id": 5662362, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9bacf16a9f4c5b0d533e798df9b69d58?s=128&d=identicon&r=PG&f=1", "display_name": "Ethun_Hunt", "link": "https://stackoverflow.com/users/5662362/ethun-hunt"}, "is_accepted": false, "score": 1, "last_activity_date": 1450248241, "last_edit_date": 1450248241, "creation_date": 1450247918, "answer_id": 34305421, "question_id": 34304460, "link": "https://stackoverflow.com/questions/34304460/sum-of-object-based-on-data-validation-through-vba/34305421#34305421", "title": "Sum of Object based on Data Validation through VBA", "body": "<p>You can use pivot table.</p>\n\n<p>Insert > Pivot Table > Select All data and Change location of pivot tabel accordingly</p>\n\n<p>In the values field put the \"# similar post\"<br>\nIn rows field put the \"Tag\"</p>\n\n<p>and you will get output as follows:<br>\n<a href=\"http://i.stack.imgur.com/dqXt0.jpg\" rel=\"nofollow\">Click here to see the output of the Pivot Table</a></p>\n"}, {"comments": [{"owner": {"reputation": 197, "user_id": 2237769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7SvdY.jpg?s=128&g=1", "display_name": "Kanike Vamshi Krishna", "link": "https://stackoverflow.com/users/2237769/kanike-vamshi-krishna"}, "edited": false, "score": 0, "creation_date": 1450251942, "post_id": 34305946, "comment_id": 56354485, "body": "What new have you done in this code?  How is it different from the above code ? If I am not understanding wrong, you have collated both pieces of code (Tag&amp; Region) as one"}], "tags": [], "owner": {"reputation": 29, "user_id": 5633202, "user_type": "registered", "accept_rate": 17, "profile_image": "https://lh4.googleusercontent.com/-qyIvCk55uGo/AAAAAAAAAAI/AAAAAAAAAME/ppf8nHoJtfo/photo.jpg?sz=128", "display_name": "DK23", "link": "https://stackoverflow.com/users/5633202/dk23"}, "is_accepted": false, "score": -1, "last_activity_date": 1450249927, "creation_date": 1450249927, "answer_id": 34305946, "question_id": 34304460, "link": "https://stackoverflow.com/questions/34304460/sum-of-object-based-on-data-validation-through-vba/34305946#34305946", "title": "Sum of Object based on Data Validation through VBA", "body": "<p>Here is the resolution:</p>\n\n<pre><code>'filtering data as per Tag &amp; Region\n\nDim Tag As String\nDim Region As String\n\nTag = Sheets(\"Raw\").Range(\"I1\")\nRegion = Sheets(\"Raw\").Range(\"H1\")\n\nRange(\"D1\").Select\nSelection.AutoFilter\nSheets(\"Raw\").Range(\"$A$1:$E$23\").AutoFilter Field:=4, Criteria1:= _\n Tag\nSheets(\"Raw\").Range(\"$A$1:$E$23\").AutoFilter Field:=5, Criteria1:= _\n    Region\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 5633202, "user_type": "registered", "accept_rate": 17, "profile_image": "https://lh4.googleusercontent.com/-qyIvCk55uGo/AAAAAAAAAAI/AAAAAAAAAME/ppf8nHoJtfo/photo.jpg?sz=128", "display_name": "DK23", "link": "https://stackoverflow.com/users/5633202/dk23"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 1, "answer_count": 2, "score": -1, "last_activity_date": 1450249965, "creation_date": 1450243283, "last_edit_date": 1450249965, "question_id": 34304460, "link": "https://stackoverflow.com/questions/34304460/sum-of-object-based-on-data-validation-through-vba", "title": "Sum of Object based on Data Validation through VBA", "body": "<p>Objective: Sum of Object (similar# post) based on Similar Specific Tag (a data validation has been used).</p>\n\n<p>Here is the screenshot:</p>\n\n<p>This is the data after filter and conditions:\n<a href=\"https://i.stack.imgur.com/XRA62.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XRA62.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>This is what the output should be:\n<a href=\"https://i.stack.imgur.com/o6vEr.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/o6vEr.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>For Example: So, when \"Tag\" is selected \"Research Investment Banking\" the output should be Sum of \"# similar posts\" that is 10 + 35 + 14 = 59</p>\n\n<p>Since I'm not great with VBA. I was wondering if AutoFilter would work or SumIf?</p>\n\n<pre><code>Selection.AutoFilter\nSheets(\"Raw\").Range(\"$A$1:$E$23\").AutoFilter Field:=5, Criteria1:= _\n    Region\n</code></pre>\n\n<p>I've written this code:     'filtering data as per Tag</p>\n\n<pre><code>Dim Tag As String\n\nTag = Sheets(\"Raw\").Range(\"I1\")\n\nRange(\"D2\").Select\nSelection.AutoFilter\n ActiveSheet.Range(\"$A$1:$E$23\").AutoFilter Field:=4, Criteria1:= _\n Tag\n</code></pre>\n\n<p>But it's missing the previous code which is to filter data based on Selected Region.</p>\n\n<pre><code>'filtering data as per region\n\nDim Region As String\n\nRegion = Sheets(\"Raw\").Range(\"H1\")\n\nRange(\"E2\").Select\nSelection.AutoFilter\nSheets(\"Raw\").Range(\"$A$1:$E$23\").AutoFilter Field:=5, Criteria1:= _\n    Region\n</code></pre>\n"}, {"tags": ["vba", "ms-word", "save-as"], "comments": [{"owner": {"reputation": 6762, "user_id": 845655, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ySyzL.jpg?s=128&g=1", "display_name": "DeanOC", "link": "https://stackoverflow.com/users/845655/deanoc"}, "edited": false, "score": 1, "creation_date": 1450241075, "post_id": 34303897, "comment_id": 56350179, "body": "Can you manually save to that location from Word?"}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1450242376, "post_id": 34303897, "comment_id": 56350589, "body": "You say it &#39;...doesn&#39;t put it in the right location...&#39; - does it save it anywhere? if so what is the full path? The syntax of the save is correct."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1450255166, "post_id": 34303897, "comment_id": 56356201, "body": "Did you have spaces in filename before? I&#39;m not sure if VBA manages spaces in path rightly. Maybe you could try <code>&quot;&quot;&quot;C:\\Users\\Schlechter Ag Liquid\\OneDrive\\BOLs\\&quot; &amp; Format(Invoice, &quot;&quot;) &amp; &quot;.docx&quot;&quot;&quot;</code>?"}, {"owner": {"reputation": 53, "user_id": 4292409, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-Mh8TIaD2NX4/AAAAAAAAAAI/AAAAAAAAAeQ/rJe-5Nxtfrs/photo.jpg?sz=128", "display_name": "Ellen Schlechter", "link": "https://stackoverflow.com/users/4292409/ellen-schlechter"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1450294234, "post_id": 34303897, "comment_id": 56382743, "body": "@VincentG after substituting your code for mine, nothing changed."}], "answers": [{"tags": [], "owner": {"reputation": 926, "user_id": 5621032, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zG42x.jpg?s=128&g=1", "display_name": "Kathara", "link": "https://stackoverflow.com/users/5621032/kathara"}, "is_accepted": false, "score": 0, "last_activity_date": 1450431438, "creation_date": 1450431438, "answer_id": 34352464, "question_id": 34303897, "link": "https://stackoverflow.com/questions/34303897/why-cant-i-get-a-file-to-save-in-a-specific-place/34352464#34352464", "title": "Why can&#39;t I get a file to save in a specific place?", "body": "<p>Why do you Format the Invoice?? If you want to make a string out of it why don't you just set CStr(Invoice) instead of Format? And if you add an Integer to a string it normally converts itself to a string automatically... I would advise you to get rid of the format and just leave Invoice there. So:</p>\n\n<pre><code>ActiveDocument.SaveAs FileName:= _\n    \"C:\\Users\\Schlechter Ag Liquid\\OneDrive\\BOLs\\\" &amp; Invoice &amp; \".docx\"\n</code></pre>\n\n<p>at least you can try it... If it doesn't work, well then I'm sorry :)</p>\n\n<p>EDIT:\nIt might be possible that I missunderstood a part of your code. The file itself should be called \"invoice-1.docx\"? If so you need to change something:</p>\n\n<pre><code>Invoice = \"Invoice\" &amp; 1\n</code></pre>\n\n<p>Then you could use the other code i wrote ;)</p>\n"}], "owner": {"reputation": 53, "user_id": 4292409, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-Mh8TIaD2NX4/AAAAAAAAAAI/AAAAAAAAAeQ/rJe-5Nxtfrs/photo.jpg?sz=128", "display_name": "Ellen Schlechter", "link": "https://stackoverflow.com/users/4292409/ellen-schlechter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 202, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1450431438, "creation_date": 1450239824, "last_edit_date": 1450286879, "question_id": 34303897, "link": "https://stackoverflow.com/questions/34303897/why-cant-i-get-a-file-to-save-in-a-specific-place", "title": "Why can&#39;t I get a file to save in a specific place?", "body": "<p>I am using the code below to insert a number from a .txt file, \"save-as\" the word file using that number as the name, then completing a mail merge. </p>\n\n<p>The code worked fine until I had to switch computers, so file locations changed...I obviously changed the locations to match those of the new computer. </p>\n\n<p>Now, the number is inserted in the correct place, then the save dialog box opens but it doesn't put it in the right location nor does it insert the specified number. </p>\n\n<p>It tries to save it here no matter what I change the file path to be:\nC:\\Users\\Schlechter Ag Liquid\\OneDrive\\BOLTemplate\\</p>\n\n<pre><code>Sub CommandButton1_Click()\n\n\nInvoice = System.PrivateProfileString(\"C:\\Users\\Schlechter Ag Liquid\\OneDrive\\BOLTemplate\\\" &amp; _\n    \"invoice-number.txt\", \"InvoiceNumber\", \"Invoice\")\n\nIf Invoice = \"\" Then\n    Invoice = 1\nElse\n    Invoice = Invoice + 1\nEnd If\n\nSystem.PrivateProfileString(\"C:\\Users\\Schlechter Ag Liquid\\OneDrive\\BOLTemplate\\\" &amp; _\n    \"invoice-number.txt\", \"InvoiceNumber\", \"Invoice\") = Invoice\n\n' Insert the number in the document\nActiveDocument.Bookmarks(\"Invoicenan\").Range.InsertBefore Format(Invoice, \"\")\n\nActiveDocument.SaveAs FileName:= _\n \"C:\\Users\\Schlechter Ag Liquid\\OneDrive\\BOLs\\\" &amp; Format(Invoice, \"\") &amp; \".docx\"\n\nActiveDocument.MailMerge.MainDocumentType = wdFormLetters\n    ActiveDocument.MailMerge.OpenDataSource Name:= _\n        \"C:\\Users\\Schlechter Ag Liquid\\OneDrive\\BOLTemplate\\Customer Database.accdb\" _\n        , ConfirmConversions:=False, ReadOnly:=False, LinkToSource:=True, _\n        AddToRecentFiles:=False, PasswordDocument:=\"\", PasswordTemplate:=\"\", _\n        WritePasswordDocument:=\"\", WritePasswordTemplate:=\"\", Revert:=False, _\n        Format:=wdOpenFormatAuto, Connection:= _\n        \"Provider=Microsoft.ACE.OLEDB.12.0;User ID=Admin;Data Source=C:\\Users\\Schlechter Ag Liquid\\OneDrive\\BOLTemplate\\Customer Database.accdb;Mode=Read;Extended Properties=\"\"\"\";Jet OLEDB:System database=\"\"\"\";Jet OLEDB:Registry Path=\"\"\"\";Jet OLEDB:Engine Type=6;Jet OLE\" _\n        , SQLStatement:=\"SELECT * FROM `report1 (1)`\", SQLStatement1:=\"\", SubType _\n        :=wdMergeSubTypeAccess\n    ActiveDocument.MailMerge.ViewMailMergeFieldCodes = wdToggle\n     WordBasic.MailMergeFindEntry\nEnd Sub\n</code></pre>\n\n<p>It says that the error is in this line, but I can't seem to figure out what is wrong with it. </p>\n\n<pre><code>ActiveDocument.SaveAs FileName:= _\n \"C:\\Users\\Schlechter Ag Liquid\\OneDrive\\BOLs\\\" &amp; Format(Invoice, \"\") &amp; \".docx\"\n</code></pre>\n\n<p>Any help would be greatly appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2275, "user_id": 2040286, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/38346fd1ac7ec2130b6644fa44acb88c?s=128&d=identicon&r=PG", "display_name": "Paresh J", "link": "https://stackoverflow.com/users/2040286/paresh-j"}, "edited": false, "score": 2, "creation_date": 1450240148, "post_id": 34303812, "comment_id": 56349910, "body": "Don&#39;t do range.select and then use selection.copy instead use range.copy and use paste to required range."}, {"owner": {"reputation": 19, "user_id": 5683796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b27d4fdf508d1dc514832ded3d193067?s=128&d=identicon&r=PG&f=1", "display_name": "fastfood123", "link": "https://stackoverflow.com/users/5683796/fastfood123"}, "reply_to_user": {"reputation": 2275, "user_id": 2040286, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/38346fd1ac7ec2130b6644fa44acb88c?s=128&d=identicon&r=PG", "display_name": "Paresh J", "link": "https://stackoverflow.com/users/2040286/paresh-j"}, "edited": false, "score": 0, "creation_date": 1450242670, "post_id": 34303812, "comment_id": 56350672, "body": "@PareshJ, thanks for the response. I realize the problem is my correlation table code fails to capture data headers. That&#39;s what is causing Excel to debug the copy line. WIll need to figure out how to fix the correlation table code."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 5683796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b27d4fdf508d1dc514832ded3d193067?s=128&d=identicon&r=PG&f=1", "display_name": "fastfood123", "link": "https://stackoverflow.com/users/5683796/fastfood123"}, "edited": false, "score": 0, "creation_date": 1450277600, "post_id": 34304821, "comment_id": 56371905, "body": "I am still having the same problem with your new code. Part of my correlation table will go the tab (&quot;Statistics&quot;) that I want it to be.but part of it will replace my source data."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 19, "user_id": 5683796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b27d4fdf508d1dc514832ded3d193067?s=128&d=identicon&r=PG&f=1", "display_name": "fastfood123", "link": "https://stackoverflow.com/users/5683796/fastfood123"}, "edited": false, "score": 0, "creation_date": 1450277950, "post_id": 34304821, "comment_id": 56372171, "body": "It is just too hard to speculate upon without seeing the rest of the code. If it cannot be added to this question through an edit, consider starting a new question which links back to this one."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1450245087, "last_edit_date": 1495540409, "creation_date": 1450245087, "answer_id": 34304821, "question_id": 34303812, "link": "https://stackoverflow.com/questions/34303812/vba-code-works-when-using-f8-but-not-when-run-fully/34304821#34304821", "title": "VBA Code Works When Using F8 but Not When Run Fully", "body": "<p>Unless this,</p>\n\n<pre><code>Application.Run \"ATPVBAEN.XLAM!Mcorrel\", myRange, _\n    \"Statistics\", \"C\", True\n</code></pre>\n\n<p>... changes the selection, then you can avoid relying on what is the current selection altogether. A few nested <a href=\"https://msdn.microsoft.com/en-us/library/wc500chb.aspx\" rel=\"nofollow noreferrer\">With ... End With statements</a> can reinterpret your code much the same way you were relying upon the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff840834.aspx\" rel=\"nofollow noreferrer\">Application.Selection</a> property but referencing everything directly.</p>\n\n<pre><code>Sub vert()\n    Dim nCols As Long\n    'this is how to declare multiple range objects\n    Dim myRange As Range, myCorrel As Range, c As Range\n\n    With Worksheets(\"Sheet1\")   '&lt;~~set this worksheet reference!\n        With .Range(\"A1\").CurrentRegion\n            nCols = .Columns.Count\n            With .Resize(.Rows.Count, nCols-1).Offset(0, 1)  '&lt;~~all of col B over to the right side\n\n                Set myRange = .Cells\n\n                 ' create correlation table\n                Application.Run \"ATPVBAEN.XLAM!Mcorrel\", myRange, _\n                        \"Statistics\", \"C\", True\n\n                'change formulas to their values\n                .Cells = .Value\n            End With\n        End With\n    End With\nEnd Sub\n</code></pre>\n\n<p>It looks like you take all of column B over to the right end extents of the data and provide some processing with <strong>ATPVBAEN.XLAM!Mcorrel</strong>. This leaves formulas that you then revert to the formula results (i.e. <a href=\"https://msdn.microsoft.com/en-us/library/office/ff195193.aspx\" rel=\"nofollow noreferrer\">Range.Value property</a>).</p>\n\n<p>So you can see how using the With ... End With is very much like progressively changing the Selection. The main difference is that it is not going to change due to any outside interference.</p>\n\n<hr>\n\n<p><sub>See <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid using Select in Excel VBA macros</a> for more methods on getting away from relying on select and activate to accomplish your goals.</sub></p>\n"}], "owner": {"reputation": 19, "user_id": 5683796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b27d4fdf508d1dc514832ded3d193067?s=128&d=identicon&r=PG&f=1", "display_name": "fastfood123", "link": "https://stackoverflow.com/users/5683796/fastfood123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 659, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1555124187, "creation_date": 1450239219, "last_edit_date": 1450242601, "question_id": 34303812, "link": "https://stackoverflow.com/questions/34303812/vba-code-works-when-using-f8-but-not-when-run-fully", "title": "VBA Code Works When Using F8 but Not When Run Fully", "body": "<p>Below is a my called code. It is being called into a code that asks user to open a desired workbook. The called code works properly when I step it through using <strong>F8</strong> but it fails to create a proper correlation table when I run the code fully.</p>\n\n<pre><code>Dim nCols As Integer\nDim myRange, myCorrel, c As Range\n\nRange(\"A1\").CurrentRegion.Select\nnCols = Selection.Columns.Count\n\nRange(\"B1\").Resize(1, nCols - 1).Select\nRange(Selection, Selection.End(xlToRight)).Select\nRange(Selection, Selection.End(xlDown)).Select\n\nSet myRange = Selection\n\n ' create correlation table\n\nApplication.Run \"ATPVBAEN.XLAM!Mcorrel\", myRange, _\n        \"Statistics\", \"C\", True\n\nSelection.Copy\n\nRange(\"B1\").End(xlToRight).Offset(0, 2).Select\nSelection.PasteSpecial \n\nEnd Sub\n</code></pre>\n\n<p>My correlation table code fails to capture the data headers. I would receive a bunch of correlation calculated without the original column headers. </p>\n"}, {"tags": ["vba", "excel", "loops"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1450238478, "post_id": 34303675, "comment_id": 56349511, "body": "put a <code>.</code> in front of every cells and range.  <code>.Cells(i, 5).Value &gt;= 0.25 Or</code>"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 5684802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46abe44fbd158aaf3567b5b76af61b14?s=128&d=identicon&r=PG&f=1", "display_name": "vbanoob27", "link": "https://stackoverflow.com/users/5684802/vbanoob27"}, "edited": false, "score": 0, "creation_date": 1450239480, "post_id": 34303724, "comment_id": 56349726, "body": "This works perfectly! Thanks a lot!!"}, {"owner": {"reputation": 5, "user_id": 5684802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46abe44fbd158aaf3567b5b76af61b14?s=128&d=identicon&r=PG&f=1", "display_name": "vbanoob27", "link": "https://stackoverflow.com/users/5684802/vbanoob27"}, "edited": false, "score": 0, "creation_date": 1450252377, "post_id": 34303724, "comment_id": 56354676, "body": "not me.. i  already upvote it"}], "tags": [], "owner": {"reputation": 28264, "user_id": 2554537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fc10039cfab30080c4b326033062f5c?s=128&d=identicon&r=PG", "display_name": "zedfoxus", "link": "https://stackoverflow.com/users/2554537/zedfoxus"}, "is_accepted": true, "score": 0, "last_activity_date": 1450238574, "creation_date": 1450238574, "answer_id": 34303724, "question_id": 34303675, "link": "https://stackoverflow.com/questions/34303675/excel-vba-to-loop-coloring-range-based-on-cell-value/34303724#34303724", "title": "Excel VBA to Loop Coloring Range Based on Cell Value", "body": "<p>Just slightly change your code like this:</p>\n\n<pre><code>Dim i As Integer\nDim arrSht, k\narrSht = Array(\"1. Asia\", \"2. Asia\") ', \"3. Asia\", \"4. Asia\", \"6. Europe\", \"7. Europe\")\n\nFor k = LBound(arrSht) To UBound(arrSht)\n    Worksheets(arrSht(k)).Activate\n    With ActiveSheet\n        For i = 4 To 11\n            If Cells(i, 5).Value &gt;= 0.25 Or _\n                Cells(i, 5).Value &lt;= -0.25 Then\n            Range(Cells(i, 1), Cells(i, 5)).Interior.Color = 65535\n            End If\n        Next i\n   End With\nNext k\n</code></pre>\n\n<p>Notice that I have used <code>Worksheets(arrSht(k)).Activate</code> and then <code>With ActiveSheet</code>.</p>\n"}], "owner": {"reputation": 5, "user_id": 5684802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46abe44fbd158aaf3567b5b76af61b14?s=128&d=identicon&r=PG&f=1", "display_name": "vbanoob27", "link": "https://stackoverflow.com/users/5684802/vbanoob27"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2285, "favorite_count": 0, "closed_date": 1450239154, "accepted_answer_id": 34303724, "answer_count": 1, "score": 0, "last_activity_date": 1450238574, "creation_date": 1450238249, "question_id": 34303675, "link": "https://stackoverflow.com/questions/34303675/excel-vba-to-loop-coloring-range-based-on-cell-value", "closed_reason": "Duplicate", "title": "Excel VBA to Loop Coloring Range Based on Cell Value", "body": "<p>I have an excel macro to color a row (from column A to E) \" i \", starting from row 4 based on the value in \"E(i)\" ; the code goes like this :</p>\n\n<pre><code>Dim i As Integer\nDim arrSht, k\narrSht = Array(\"1. Asia\", \"2. Asia\", \"3. Asia\", _\n    \"4. Asia\", \"6. Europe\", \"7. Europe\")\n\nFor k = LBound(arrSht) To UBound(arrSht)\n    With Worksheets(arrSht(k))\n        For i = 4 To 11\n            If Cells(i, 5).Value &gt;= 0.25 Or _\n                Cells(i, 5).Value &lt;= -0.25 Then\n            Range(Cells(i, 1), Cells(i, 5)).Interior.Color = 65535\n            End If\n        Next i\n   End With\nNext k\n\nEnd Sub\n</code></pre>\n\n<p>The code works fine in coloring the rows, except that it only color the row for the active sheet.\nWhen I tried to put something like </p>\n\n<pre><code> Workbooks(\"Color row.xlsx\").Sheets(arrSht(k)).Range(Cells(i, 1), Cells(i, 5)).Interior.Color = 65535\n</code></pre>\n\n<p>I get the \"Run-time error '438': Object doesn't support this property or method\" for that line.\nI don't know what should i put so that it colors the cell for each worksheets in the specified array. </p>\n\n<p>Please help! </p>\n\n<p>Thanks a lot :)</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1450236095, "post_id": 34303349, "comment_id": 56348897, "body": "change lra to <code>Sheets(2).Range(&quot;a&quot; &amp; lr + 1)</code> and lrb to <code>Sheets(2).Range(&quot;a&quot; &amp; lr)</code> and it should work."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1450237644, "post_id": 34303349, "comment_id": 56349296, "body": "I&#39;m not sure whether this is important to the data but using <code>&quot;[hh]:mm:ss&quot;</code> will allow showing a time greater than 24 hours. <code>&quot;hh:mm:ss&quot;</code> truncates off the &#39;less-than-a-day&#39; portion so that 26 hours becomes 2 hours. Might not be mission critical in this situation but I always use the square brackets when displaying elapsed time rather than time-of-the-day."}, {"owner": {"reputation": 15, "user_id": 5672532, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ELtIE.jpg?s=128&g=1", "display_name": "Matt the newb", "link": "https://stackoverflow.com/users/5672532/matt-the-newb"}, "edited": false, "score": 0, "creation_date": 1450247626, "post_id": 34303349, "comment_id": 56352437, "body": "@Jeeped In this case i hope that no one spends more than 24 hours in a task; however if someone were to forget to click the stop task button until the next day this may actually be a big help. Thanks a lot for the input"}], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1450236945, "post_id": 34303417, "comment_id": 56349098, "body": "You need to comment out the variables. <code>&quot;=Text(&quot; &amp; lra - lrb &amp; &quot;, &quot;&quot;hh:mm:ss&quot;&quot;)&quot;</code>"}], "tags": [], "owner": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "is_accepted": false, "score": 0, "last_activity_date": 1450239832, "last_edit_date": 1450239832, "creation_date": 1450236150, "answer_id": 34303417, "question_id": 34303349, "link": "https://stackoverflow.com/questions/34303349/how-do-i-place-a-formula-in-column-d-for-every-stop-sub/34303417#34303417", "title": "How do I place a formula in column D for every stop sub?", "body": "<p>placing formula:</p>\n\n<p><code>Sheets(2).Range(\"d\" &amp; lr + 1).Formula = \"=Text(\" &amp; lra.Address &amp; \" - \" &amp; lrb.Address &amp; \", \"\"hh:mm:ss\"\")\"</code></p>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 5672532, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ELtIE.jpg?s=128&g=1", "display_name": "Matt the newb", "link": "https://stackoverflow.com/users/5672532/matt-the-newb"}, "edited": false, "score": 0, "creation_date": 1450247166, "post_id": 34303470, "comment_id": 56352238, "body": "So this code gives me the error message &quot;Object variable or with block variable not set&quot;. Being as I am a total novice i have no idea why it isn&#39;t working, and the Help function from microsoft confused me even more... thoughts?"}, {"owner": {"reputation": 668, "user_id": 5376180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dbbcf86576c59034abee94863876812?s=128&d=identicon&r=PG&f=1", "display_name": "Vulthil", "link": "https://stackoverflow.com/users/5376180/vulthil"}, "edited": false, "score": 0, "creation_date": 1450251214, "post_id": 34303470, "comment_id": 56354123, "body": "The Object Variable or with Block vairable not set occurs because the set property has not been used in front of the range variables."}, {"owner": {"reputation": 15, "user_id": 5672532, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ELtIE.jpg?s=128&g=1", "display_name": "Matt the newb", "link": "https://stackoverflow.com/users/5672532/matt-the-newb"}, "edited": false, "score": 0, "creation_date": 1450307211, "post_id": 34303470, "comment_id": 56389478, "body": "@ScottCraner You really are the man. Thanks so much for holding my hand through this."}, {"owner": {"reputation": 15, "user_id": 5672532, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ELtIE.jpg?s=128&g=1", "display_name": "Matt the newb", "link": "https://stackoverflow.com/users/5672532/matt-the-newb"}, "edited": false, "score": 0, "creation_date": 1450307693, "post_id": 34303470, "comment_id": 56389680, "body": "@ScottCraner I realize that i need to learn more about the language that excel VBA uses. Can you recommend a good starting point? like a book, or possibly a college level class? This sight is amazing but i really want to go beyond copying and pasting other peoples code and cleaning up recorded macro code."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 0, "last_activity_date": 1450274341, "last_edit_date": 1450274341, "creation_date": 1450236556, "answer_id": 34303470, "question_id": 34303349, "link": "https://stackoverflow.com/questions/34303349/how-do-i-place-a-formula-in-column-d-for-every-stop-sub/34303470#34303470", "title": "How do I place a formula in column D for every stop sub?", "body": "<p>As per my comment:</p>\n\n<pre><code>Sub StopTask()\n\n\nDim lr As Long\nDim lra As Range\nDim lrb As Range\n'\nlr = Sheets(2).Range(\"a\" &amp; Rows.count).End(xlUp).Row\nSet lra =2 Sheets(2).Range(\"a\" &amp; lr + 1)\nSet lrb = Sheets(2).Range(\"a\" &amp; lr)\nSheets(2).Range(\"a\" &amp; lr + 1).Formula = Now()\nSheets(2).Range(\"b\" &amp; lr + 1) = \"Task Name\"\nSheets(2).Range(\"c\" &amp; lr + 1) = \"Stop\"\nSheets(2).Range(\"d\" &amp; lr + 1).Value = Format(lra - lrb, \"hh:mm:ss\")\nEnd Sub\n</code></pre>\n\n<p>First if you look, you were referring to the wrong rows for your values.  Second text is a worksheet function.  Use format instead.</p>\n"}], "owner": {"reputation": 15, "user_id": 5672532, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ELtIE.jpg?s=128&g=1", "display_name": "Matt the newb", "link": "https://stackoverflow.com/users/5672532/matt-the-newb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 34303470, "answer_count": 2, "score": 0, "last_activity_date": 1450274341, "creation_date": 1450235619, "last_edit_date": 1531161705, "question_id": 34303349, "link": "https://stackoverflow.com/questions/34303349/how-do-i-place-a-formula-in-column-d-for-every-stop-sub", "title": "How do I place a formula in column D for every stop sub?", "body": "<p>So I have been tasked with creating a Spread Sheet to calculate how much time is spent in any given task. So far I have buttons set up to start and stop the clock but now i am stuck trying to add the following formula to each Stop Sub:</p>\n\n<p>=text(A2-A3,HH:MM:SS)</p>\n\n<p>Here is what I have so far:</p>\n\n<pre><code>' \nSub StartTask()\n'\nDim lr As Long\nlr = Sheets(2).Range(\"a\" &amp; Rows.Count).End(xlUp).Row\nSheets(2).Range(\"a\" &amp; lr + 1).Formula = Now()\nSheets(2).Range(\"b\" &amp; lr + 1) = \"Task Name\"\nSheets(2).Range(\"c\" &amp; lr + 1) = \"Start\"\n\nEnd Sub\n\n\nSub StopTask()\n\n\nDim lr As Long\nDim lra As Range\nDim lrb As Range\n'\nlr = Sheets(2).Range(\"a\" &amp; Rows.Count).End(xlUp).Row\nlra = Sheets(2).Range(\"a\" &amp; lr)\nlrb = Sheets(2).Range(\"a\" &amp; lr - 1)\nSheets(2).Range(\"a\" &amp; lr + 1).Formula = Now()\nSheets(2).Range(\"b\" &amp; lr + 1) = \"Task Name\"\nSheets(2).Range(\"c\" &amp; lr + 1) = \"Stop\"\nSheets(2).Range(\"d\" &amp; lr + 1).Formula = Text(lra - lrb, \"hh:mm:ss\")\nEnd Sub\n</code></pre>\n\n<p>The formula is to find the amount of time spent in each task by subtracting the start time from the stop time. Every time Sub StartTask is run a new row is placed in sheet two, and every time Sub StopTask is run a new row is inserted in the row below that, and so on. this means that the formula needs to be placed in the same row as all the other data from Sub StopTask. I think the problem is that i am not defining lra and lrb correctly, but I'm not really sure. How can i place the formula in column D of each StopTask row? </p>\n"}, {"tags": ["excel", "date", "dayofweek", "vba"], "answers": [{"comments": [{"owner": {"reputation": 668, "user_id": 5376180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dbbcf86576c59034abee94863876812?s=128&d=identicon&r=PG&f=1", "display_name": "Vulthil", "link": "https://stackoverflow.com/users/5376180/vulthil"}, "edited": false, "score": 0, "creation_date": 1450336213, "post_id": 34307096, "comment_id": 56398632, "body": "Any explanation to the downvote? This works perfectly fine for me."}, {"owner": {"reputation": 17, "user_id": 5586820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff6d4c4f611db5bccfec3e802795a399?s=128&d=identicon&r=PG", "display_name": "GregNH", "link": "https://stackoverflow.com/users/5586820/gregnh"}, "edited": false, "score": 0, "creation_date": 1450359885, "post_id": 34307096, "comment_id": 56413467, "body": "I am getting a compile error for undefined &quot;HowManyDays&quot;"}, {"owner": {"reputation": 668, "user_id": 5376180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dbbcf86576c59034abee94863876812?s=128&d=identicon&r=PG&f=1", "display_name": "Vulthil", "link": "https://stackoverflow.com/users/5376180/vulthil"}, "reply_to_user": {"reputation": 17, "user_id": 5586820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff6d4c4f611db5bccfec3e802795a399?s=128&d=identicon&r=PG", "display_name": "GregNH", "link": "https://stackoverflow.com/users/5586820/gregnh"}, "edited": false, "score": 0, "creation_date": 1450364021, "post_id": 34307096, "comment_id": 56416323, "body": "Have you implemented the Function from the top of my answer ?"}, {"owner": {"reputation": 17, "user_id": 5586820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff6d4c4f611db5bccfec3e802795a399?s=128&d=identicon&r=PG", "display_name": "GregNH", "link": "https://stackoverflow.com/users/5586820/gregnh"}, "edited": false, "score": 0, "creation_date": 1450394451, "post_id": 34307096, "comment_id": 56433799, "body": "Thank you that did work.  I have one more textbox, txtPayDays, that will display the number of Combobox1.Value Case, IE &quot;5&quot; Thurday&#39;s this month."}, {"owner": {"reputation": 17, "user_id": 5586820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff6d4c4f611db5bccfec3e802795a399?s=128&d=identicon&r=PG", "display_name": "GregNH", "link": "https://stackoverflow.com/users/5586820/gregnh"}, "edited": false, "score": 0, "creation_date": 1450403069, "post_id": 34307096, "comment_id": 56436238, "body": "@EEM Thank you for all that.  I can&#39;t seem to get it to work.  No more errors but no results either."}], "tags": [], "owner": {"reputation": 668, "user_id": 5376180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dbbcf86576c59034abee94863876812?s=128&d=identicon&r=PG&f=1", "display_name": "Vulthil", "link": "https://stackoverflow.com/users/5376180/vulthil"}, "is_accepted": false, "score": -1, "last_activity_date": 1450257965, "last_edit_date": 1450257965, "creation_date": 1450254422, "answer_id": 34307096, "question_id": 34303252, "link": "https://stackoverflow.com/questions/34303252/need-to-count-the-number-of-a-specific-day-between-two-dates-ie-number-of-friday/34307096#34307096", "title": "Need to count the number of a specific day between two dates IE number of Fridays from the begining of the current month to now() in excel vba", "body": "<p>This UDF will count the number of whatever day you pass into it, between two dates passed as longs.</p>\n\n<pre><code>Public Function HowManyDays(Sdate As Long, Edate As Long, Wday As Long)\nDim i\nDim MyCount As Long\nFor i = Sdate To Edate\n    If Weekday(i) = Wday Then MyCount = MyCount + 1\nNext i\nHowManyDays = MyCount\nEnd Function\n</code></pre>\n\n<p>Wday represents the day of the week, eg. sunday=1, monday=2... etc.\nI don't know if it changes to monday=1, tuesday=2 etc. on other systems, or if it's always sunday=1.</p>\n\n<p>With this UserForm code, a textbox will show the number of anyday depending on the value in a combobox:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim Sdate As Long, Edate As Long, Wday As Long\n\nSdate = CLng(DateSerial(Format(Now, \"yy\"), Format(Now, \"mm\"), 1))\n\nEdate = CLng(Now)\n\nSelect Case ComboBox1.Value\n\n    Case \"Sunday\"\n        Wday = 1\n    Case \"Monday\"\n        Wday = 2\n    Case \"Tuesday\"\n        Wday = 3\n    Case \"Wednesday\"\n        Wday = 4\n    Case \"Thursday\"\n        Wday = 5\n    Case \"Friday\"\n        Wday = 6\n    Case \"Saturday\"\n        Wday = 7\n\nEnd Select\nTextBox1.Value = HowManyDays(Sdate, Edate, Wday)\n\n\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\n\nDim Day As Variant\n\nReDim Day(7)\nDay = Array(\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\")\nComboBox1.ColumnCount = 1\nComboBox1.List() = Day\n\n\nEnd Sub\n</code></pre>\n\n<p>The start date is currently set to the first of the current month.</p>\n\n<p>If you don't want to click a button to perform the action you can take the code from the CommandButton1_Click() and put it in ComboBox1_Change(), that way it will update the textbox whenever the combobox changes.</p>\n"}, {"tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": false, "score": 0, "last_activity_date": 1450388161, "creation_date": 1450388161, "answer_id": 34344688, "question_id": 34303252, "link": "https://stackoverflow.com/questions/34303252/need-to-count-the-number-of-a-specific-day-between-two-dates-ie-number-of-friday/34344688#34344688", "title": "Need to count the number of a specific day between two dates IE number of Fridays from the begining of the current month to now() in excel vba", "body": "<p><strong>Requirements:</strong></p>\n\n<ol>\n<li>To show in Textbox <code>txtDate</code> the date of the machine</li>\n<li>To calculate the number of Fridays or Thursdays in the month of <code>txtDate</code> till the date of the machine</li>\n<li>To show in Textbox <code>txtWeek</code> the number of Fridays or Thursdays as per prior point</li>\n</ol>\n\n<p><strong>Assumptions:</strong></p>\n\n<ol>\n<li>The <code>Sheet1</code> of the workbook containing the procedures has two <code>TextBoxes</code> and one <code>ComboBox</code></li>\n<li>The Procedures will be triggered by the change events of the <code>ComboBox</code>, when user select the weekday to count</li>\n</ol>\n\n<p><strong>Copy this procedure in the Code Module of <code>Sheet1</code></strong> - <em>Change Event for the ComboBox</em></p>\n\n<pre><code>Private Sub CmbBox1_Change()\nDim sWkDy As String\nDim dDte1 As Date\nDim bDayC As Byte\nDim bThu As Boolean, bFri As Boolean\n\n    Rem Set Weekday\n    sWkDy = Me.CmbBox1.Value\n    Select Case sWkDy\n    Case \"Thursday\":    bThu = True\n    Case \"Friday\":      bFri = True\n    Case Else:          Exit Sub\n    End Select\n\n    Rem Set First date of the current month\n    dDte1 = 1 + WorksheetFunction.EoMonth(Date, -1)\n\n    Rem Counts the weekdays\n    bDayC = Dte_Days_Count_To_Today(dDte1, blThu:=bThu, blFri:=bFri)\n\n    Rem Set Current Date in `txtDate`\n    'Using format `mmm-dd-yyyy` to ease reading of the date independently of the format (American or International)\n    Me.TxtDate.Value = Format(Date, \"mmm-dd-yyyy\")  'change as required\n\n    Rem Set count of weekdays `txtWeek`\n    'Using this format to directly show the weekdays counted\n    Me.TxtWeek.Value = \"Count of \" &amp; sWkDy &amp; \"s: \" &amp; bDayC 'change as required\n\nEnd Sub\n</code></pre>\n\n<p><strong>Copy these procedures in a standard module</strong></p>\n\n<pre><code>'Ensure these Keywords are at the top of the module \nOption Explicit\nOption Base 1        \n</code></pre>\n\n<p>This procedure sets the available options in the <code>Combobox</code> \u2013 <em>Run this first, need to run only once</em></p>\n\n<pre><code>Private Sub CmbBox1_Set()\nDim aWkDys As Variant\naWkDys = [{\"Thursday\", \"Friday\"}]\n    With Me.CmbBox1\n        .ColumnCount = 1\n        .List() = aWkDys\n    End With\nEnd Sub\n</code></pre>\n\n<p>This Function counts the numbers of days from the date entered as input date <code>dDteInp</code> to the actual date of the machine <code>TODAY</code>. The results are generated using arithmetic calculus and avoids the loop trough each of the dates in the range. It also gives the option to count various weekdays at once e.g.: to count Thursdays and Fridays from a given date till today call it this way <code>Call Dte_Days_Count_To_Today(dDteInp, blThu:=True, blFri:=True)</code></p>\n\n<pre><code>Public Function Dte_Days_Count_To_Today(dDteInp As Date, _\n    Optional blSun As Boolean, Optional blMon As Boolean, _\n    Optional blTue As Boolean, Optional blWed As Boolean, _\n    Optional blThu As Boolean, Optional blFri As Boolean, _\n    Optional blSat As Boolean)\nDim aDaysT As Variant, bDayT As Byte    'Days Target\nDim bDayI As Byte                       'Day Ini\nDim iWeeks As Integer                   'Weeks Period\nDim bDaysR As Byte                      'Days Remaining\nDim bDaysA As Byte                      'Days Additional\nDim aDaysC(7) As Integer                'Days count\n\n    Rem Set Days Base\n    aDaysT = Array(blSun, blMon, blTue, blWed, blThu, blFri, blSat)\n    bDayI = Weekday(dDteInp, vbSunday)\n    iWeeks = Int((Date - dDteInp + 1) / 7)\n    bDaysR = (Date - dDteInp + 1) Mod 7\n\n    Rem Set Day Target Count\n    For bDayT = 1 To 7\n        bDaysA = 0\n        aDaysC(bDayT) = 0\n        If aDaysT(bDayT) Then\n            If bDaysR = 0 Then\n                bDaysA = 0\n            ElseIf bDayI = bDayT Then\n                bDaysA = 1\n            ElseIf bDayI &lt; bDayT Then\n                If bDayI + bDaysR - 1 &gt;= bDayT Then bDaysA = 1\n            Else\n                If bDayI + bDaysR - 8 &gt;= bDayT Then bDaysA = 1\n            End If\n\n            Rem Target Day Total\n            aDaysC(bDayT) = iWeeks + bDaysA\n\n    End If: Next\n\n    Rem Set Results - Total Days\n    Dte_Days_Count_To_Today = WorksheetFunction.Sum(aDaysC)\nEnd Function\n</code></pre>\n\n<p>Suggest to read the following pages to gain a deeper understanding of the resources used:</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/gg278518(v=office.15).aspx\" rel=\"nofollow\">Option keyword</a>, \n<a href=\"http://www.excelfunctions.net/VBA-Variables-And-Constants.html\" rel=\"nofollow\">Variables &amp; Constants</a>, \n<a href=\"https://msdn.microsoft.com/en-us/library/office/gg251528.aspx\" rel=\"nofollow\">Data Type Summary</a>,</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/gg251696(v=office.15).aspx\" rel=\"nofollow\">Optional keyword</a>, \n<a href=\"https://msdn.microsoft.com/en-us/library/office/gg264233(v=office.15).aspx\" rel=\"nofollow\">Function Statement</a>, \n<a href=\"https://msdn.microsoft.com/EN-US/library/office/gg251601.aspx\" rel=\"nofollow\">For...Next Statement</a>,</p>\n\n<p><a href=\"https://msdn.microsoft.com/EN-US/library/office/gg251599.aspx\" rel=\"nofollow\">If...Then...Else Statement</a>, \n<a href=\"https://msdn.microsoft.com/EN-US/library/office/ff838805.aspx\" rel=\"nofollow\">Control and Dialog Box Events</a>, </p>\n\n<p><a href=\"https://msdn.microsoft.com/EN-US/library/office/gg278665.aspx\" rel=\"nofollow\">Select Case Statement</a>,\n<a href=\"https://msdn.microsoft.com/en-us/library/office/ff834434.aspx\" rel=\"nofollow\">WorksheetFunction Object (Excel)</a></p>\n"}], "owner": {"reputation": 17, "user_id": 5586820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff6d4c4f611db5bccfec3e802795a399?s=128&d=identicon&r=PG", "display_name": "GregNH", "link": "https://stackoverflow.com/users/5586820/gregnh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 510, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1450388161, "creation_date": 1450234906, "last_edit_date": 1531164843, "question_id": 34303252, "link": "https://stackoverflow.com/questions/34303252/need-to-count-the-number-of-a-specific-day-between-two-dates-ie-number-of-friday", "title": "Need to count the number of a specific day between two dates IE number of Fridays from the begining of the current month to now() in excel vba", "body": "<p>I would like a textbox, \"txtWeek,\" to show the number of Fridays or Thursdays between the beginning of the month to the current date, IE I have started with </p>\n\n<pre><code>Dim MyDate, MyStr\n    MyDate = Format(Now, \"M/d/yy\")\n    Me.txtDate.Value = MyDate\nDim Day As Variant\n    ReDim Day(2)\n    Day = Array(\"Thursday\", \"Friday\")\n    ComboBox1.ColumnCount = 1\n    ComboBox1.List() = Day\nDim X, AsDate\n    X = Format(Now, \"M/1/yy\")\nIf Me.ComboBox1.Text = \"Friday\" Then\n    Me.txtWeek.Value = Int((Weekday(X - 6) - X + Me.txtDate.Value) / 7)\nElse\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5684679, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-tmdgFholtRQ/AAAAAAAAAAI/AAAAAAAAAAA/fRB9nut3eXA/photo.jpg?sz=128", "display_name": "benfunks", "link": "https://stackoverflow.com/users/5684679/benfunks"}, "edited": false, "score": 0, "creation_date": 1450293674, "post_id": 34306213, "comment_id": 56382380, "body": "Actually the most useful thing that would help my data set is a VBA script to place the name of the worksheet into a new column of data on my, then for all of the sheets to be merged into a single sheet in a new bookl."}], "tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1450250967, "creation_date": 1450250967, "answer_id": 34306213, "question_id": 34303198, "link": "https://stackoverflow.com/questions/34303198/changing-range-in-a-lookup-formula-based-upon-a-value/34306213#34306213", "title": "Changing range in a lookup formula based upon a value", "body": "<p>You may want to re-think the data architecture. If possible, let the golden rule apply to have data in one sheet and reporting on other sheets. </p>\n\n<p>Find a way to have all the 200 sheet's data in just one sheet. You may have to introduce a few additional columns to distinguish each row. </p>\n\n<p>Then you can start building reports on all the data, using Pivot Tables, or more sophisticated tools like Power Pivot.</p>\n\n<p>With the next to nothing info you provide about your data set it is hard to suggest more concrete advice.</p>\n"}], "owner": {"reputation": 1, "user_id": 5684679, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-tmdgFholtRQ/AAAAAAAAAAI/AAAAAAAAAAA/fRB9nut3eXA/photo.jpg?sz=128", "display_name": "benfunks", "link": "https://stackoverflow.com/users/5684679/benfunks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1450250967, "creation_date": 1450234499, "last_edit_date": 1531161705, "question_id": 34303198, "link": "https://stackoverflow.com/questions/34303198/changing-range-in-a-lookup-formula-based-upon-a-value", "title": "Changing range in a lookup formula based upon a value", "body": "<p>I have a very large excel file with approximately 200 sheets with fields. Each sheet is a ranking of a subset of values which was output from an R program. There are 2 versions for about each entry. The subset data is not in the original sheet - only the name of the sheet, and the summary table i'm trying to build. I'd like to automatically determine which range (sheet) the lookup queries.</p>\n\n<p>The Manual answer is to sort, filter create a lookup and consolidate the summary data, copy the formula, find replace the range reference, fill, repeat.  hopefully there is a solution rather than copy-pasting, editing, hundreds of times. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 1, "creation_date": 1450233700, "post_id": 34302889, "comment_id": 56348273, "body": "What line gives the error?"}, {"owner": {"reputation": 11, "user_id": 5684616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f89bc9bd7272940c415c21d5c75b66a?s=128&d=identicon&r=PG&f=1", "display_name": "klarsen427", "link": "https://stackoverflow.com/users/5684616/klarsen427"}, "reply_to_user": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1450709720, "post_id": 34302889, "comment_id": 56538046, "body": "The Wb2.Sheets(J).Range(&quot;A1&quot;).PasteSpecial Paste:=xlPasteValues line of the Else statement:   Else    If Left(Sheets(J).Name, 5) = &quot;Sheet&quot; Then             Sheets(J).Name = sDay             Wb2.Sheets(J).Range(&quot;A1&quot;).PasteSpecial Paste:=xlPasteValues"}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1450714823, "post_id": 34302889, "comment_id": 56541401, "body": "Have you tried the solution provided?"}], "answers": [{"tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": false, "score": 1, "last_activity_date": 1450248092, "creation_date": 1450248092, "answer_id": 34305458, "question_id": 34302889, "link": "https://stackoverflow.com/questions/34302889/throwing-1004-error-only-on-pc/34305458#34305458", "title": "Throwing 1004 Error Only On PC", "body": "<p>The reason for the error is that you are prematurely copying the source range to the clipboard, and somehow by the time when you try to paste the source range to the corresponding worksheet the clipboard is empty thus giving the error <code>1004</code>. As to why the Mac does not give an error I have no idea, probably none of the actions performed between the <code>L.Copy</code> and the <code>.PasteSpecial</code>  clears the clipboard or whatever the Mac uses. Nevertheless, it\u2019s a bad practice to keep the items to be copied that long in the clipboard.</p>\n\n<p>I have also done a review of your code and highlighted some points for improvement <em>(see comments below)</em></p>\n\n<pre><code>Set Wb = ThisWorkbook                       'Here you set the Wb variable but is not used at all in the entire procedure\nSet L = Sheets(\"Sheet1\").Range(\"A1:G7\")     'Here was an opportunity to use the `Wb` variable instead this line points to whatever workbook is active\n\n'This is the cause of the error: here you copy `A1:G7` to the clipboard (1\\2)\nL.Copy\n\n'This Loop Through All Open Workbooks Seems To Have No Purpose!\nFor Each Wb2 In Application.Workbooks\n    Wb2.Activate\nNext\n\n'This is not efficient, if the user does not enter neither a valid number nor a zero it will go endlessly\n'Also suggest to use Do...Loop for the reasons mentioned in the Tip of the page While...Wend Statement (see suggested pages)\niTarget = 13\nWhile (iTarget &lt; 1) Or (iTarget &gt; 12)\n            iTarget = Val(InputBox(\"Numeric month?\"))\n    If iTarget = 0 Then Exit Sub\nWend\n\n'This way of setting the date is not efficient as it depends on knowing the date format used by the user machine\n'Sugest to use instead the DateSerial Function (see suggested pages)\nsTemp = Str(iTarget) &amp; \"/1/\" &amp; Year(Now())\ndBasis = CDate(sTemp)\n\n        If J &gt; Sheets.Count Then\n            Sheets.Add.Move after:=Sheets(Sheets.Count)\n\n            'These lines are repeated for each \"situation\" of the sheets (three times)\n            ActiveSheet.Name = sDay\n\n            'This is the cause of the error(2\\2): here you try to paste from an empty clipboard\n            Wb2.Sheets(J).Range(\"A1\").PasteSpecial Paste:=xlPasteValues\n            Wb2.Sheets(J).Range(\"A1\").PasteSpecial Paste:=xlPasteFormats\n            Wb2.Sheets(J).Range(\"A1\").PasteSpecial Paste:=xlPasteColumnWidths\n            Range(\"A1\").Value = sDay\n        Else\n            If Left(Sheets(J).Name, 5) = \"Sheet\" Then\n            Sheets(J).Name = sDay\n            Wb2.Sheets(J).Range(\"A1\").PasteSpecial Paste:=xlPasteValues\n            Wb2.Sheets(J).Range(\"A1\").PasteSpecial Paste:=xlPasteFormats\n            Wb2.Sheets(J).Range(\"A1\").PasteSpecial Paste:=xlPasteColumnWidths\n            Range(\"A1\").Value = sDay\n            Else\n            Sheets.Add.Move after:=Sheets(Sheets.Count)\n            ActiveSheet.Name = sDay\n            Wb2.Sheets(J).Range(\"A1\").PasteSpecial Paste:=xlPasteValues\n            Wb2.Sheets(J).Range(\"A1\").PasteSpecial Paste:=xlPasteFormats\n            Wb2.Sheets(J).Range(\"A1\").PasteSpecial Paste:=xlPasteColumnWidths\n            Range(\"A1\").Value = sDay\n            End If\n\n        End If\n    End If\nNext J\n\n'This sort is redundant, instead have a more efficient process to add the required worksheets\nFor J = 1 To (Sheets.Count - 1)\n    For K = J + 1 To Sheets.Count\n        If Right(Sheets(J).Name, 10) &gt; _\n          Right(Sheets(K).Name, 10) Then\n            Sheets(K).Move Before:=Sheets(J)\n        End If\n    Next K\nNext J\n\nSheets(1).Activate\nApplication.ScreenUpdating = True\n'Missed to restate the `Application.DisplayAlerts = True`\n'This is very dangerous as the system will not advise when closing a workbook without saving it first.\n'And it will result in losing all work done on that workbook!\n\n'This will give an error if by any chance a workbook with same name is open\nWb2.SaveAs Filename:=\"DCR_\" + sMonth + \".xlsx\"\n</code></pre>\n\n<p>This is the revised code. \nFor a deeper understanding of the resources used suggest to visit these pages:</p>\n\n<p><a href=\"https://msdn.microsoft.com/EN-US/library/office/ff198091.aspx\" rel=\"nofollow\">Application Members (Excel)</a>, \n<a href=\"https://msdn.microsoft.com/en-us/library/office/gg251688.aspx\" rel=\"nofollow\">On Error Statement</a>, \n<a href=\"https://msdn.microsoft.com/EN-US/library/office/gg264202.aspx\" rel=\"nofollow\">DateSerial Function</a></p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/gg264682.aspx\" rel=\"nofollow\">While...Wend Statement</a>, \n<a href=\"https://msdn.microsoft.com/EN-US/library/office/gg278815.aspx\" rel=\"nofollow\">Do...Loop Statement</a>, \n<a href=\"https://msdn.microsoft.com/EN-US/library/office/gg264723.aspx\" rel=\"nofollow\">With Statement</a></p>\n\n<pre><code>Option Explicit\n\nSub DCR()\nDim rSrc As Range           'Source Range to be copied\nDim WbkTrg As Workbook      'Target Workbook to act upon\nDim sWbkTrg As String       'Target Workbook name\nDim WshTrg As Worksheet     'Target Worksheet to act upon\nDim sWshTrg As String       'Target Worksheet name\nDim bMonth As Byte\nDim dDate As Date\nDim bDay As Byte\nDim b As Byte\n\n    Rem Application Settings OFF\n    Application.EnableEvents = False\n    Application.DisplayAlerts = False\n    Application.ScreenUpdating = False\n\n    Rem Get User Input\n    Do\n        On Error Resume Next\n        bMonth = InputBox(\"Enter month number (1 to 12) or 0 to cancel.\")\n        On Error GoTo 0\n        b = 1 + b\n        If bMonth = 0 Then GoTo ExitTkn\n        If b = 3 Then GoTo ExitTkn\n    Loop Until bMonth &gt;= 1 And bMonth &lt;= 12        \n\n    Rem Set Target Range To Be Copied Into New Workbook\n    Set rSrc = ThisWorkbook.Sheets(\"Sheet1\").Range(\"A1:G7\")\n\n    Rem Add Target Workbook\n    Set WbkTrg = Workbooks.Add\n    sWbkTrg = \"DCR_\" &amp; Format(DateSerial(Year(Now), bMonth, 1), \"yyyy-mm\") &amp; \".xlsx\"\n\n    Rem Delete All Worksheets Minus One In Target Workbook\n    Do\n        With WbkTrg\n            If .Sheets.Count = 1 Then Exit Do\n            .Sheets(1).Delete\n        End With\n    Loop\n\n    Rem Add Worksheet for each day of the month\n    For bDay = 1 To 31\n        Rem Set Date &amp; Month\n        dDate = DateSerial(Year(Now), bMonth, bDay)\n        sWshTrg = Format(dDate, \"dddd mm-dd-yyyy\")\n\n        If Month(dDate) = bMonth Then\n\n            Rem Process Worksheets - Days\n            With WbkTrg\n                If bDay = 1 Then\n                    Rem Process 1st Day\n                    Set WshTrg = .Sheets(bDay)\n                Else\n                    Rem Add Remaining Days\n                    Set WshTrg = .Sheets.Add(after:=.Sheets(.Sheets.Count))\n            End If: End With\n\n            Rem Update Day Standard Data\n            WshTrg.Name = sWshTrg\n            With WshTrg.Range(\"A1\")\n                rSrc.Copy\n                .PasteSpecial Paste:=xlPasteValues\n                .PasteSpecial Paste:=xlPasteFormats\n                .PasteSpecial Paste:=xlPasteColumnWidths\n                .Value = sWshTrg\n                Application.CutCopyMode = False\n            End With\n\n    End If: Next\n\n    Rem Save Target Workbook\n    Application.Goto WbkTrg.Sheets(1).Cells(1), 1\n    On Error Resume Next\n    Workbooks(sWbkTrg).Close    'Close Workbook If Open\n    On Error GoTo 0\n    WbkTrg.SaveAs Filename:=sWbkTrg\n\nExitTkn:\n    Rem Application Settings ON\n    Application.EnableEvents = True\n    Application.DisplayAlerts = True\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5684616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f89bc9bd7272940c415c21d5c75b66a?s=128&d=identicon&r=PG&f=1", "display_name": "klarsen427", "link": "https://stackoverflow.com/users/5684616/klarsen427"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1450248092, "creation_date": 1450232161, "last_edit_date": 1450232959, "question_id": 34302889, "link": "https://stackoverflow.com/questions/34302889/throwing-1004-error-only-on-pc", "title": "Throwing 1004 Error Only On PC", "body": "<p>VBA macro throwing Run-time error '1004':\nPasteSpecial method of Range class failed</p>\n\n<p>This error is only being thrown when the macro runs on PC. On a Mac, the macro runs seamlessly. Is there any reason the below macro would throw an error?</p>\n\n<pre><code>Option Explicit\nSub DCR()\nDim J As Integer\nDim K As Integer\nDim L As Range\nDim sDay As String\nDim sMonth As String\nDim sTemp As String\nDim iTarget As Integer\nDim dBasis As Date\nDim Wb As Workbook\nDim Wb2 As Workbook\n\nSet Wb = ThisWorkbook\nSet L = Sheets(\"Sheet1\").Range(\"A1:G7\")\nL.Copy\nFor Each Wb2 In Application.Workbooks\nWb2.Activate\nNext\n\n\n\niTarget = 13\nWhile (iTarget &lt; 1) Or (iTarget &gt; 12)\n            iTarget = Val(InputBox(\"Numeric month?\"))\n    If iTarget = 0 Then Exit Sub\nWend\nSet Wb2 = Workbooks.Add\n\n\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\nsTemp = Str(iTarget) &amp; \"/1/\" &amp; Year(Now())\ndBasis = CDate(sTemp)\n\nFor J = 1 To 31\n    sDay = Format((dBasis + J - 1), \"dddd mm-dd-yyyy\")\n    sMonth = Format((dBasis), \"yyyy-mm\")\n    If Month(dBasis + J - 1) = iTarget Then\n        If J &gt; Sheets.Count Then\n            Sheets.Add.Move after:=Sheets(Sheets.Count)\n            ActiveSheet.Name = sDay\n            Wb2.Sheets(J).Range(\"A1\").PasteSpecial Paste:=xlPasteValues\n            Wb2.Sheets(J).Range(\"A1\").PasteSpecial Paste:=xlPasteFormats\n            Wb2.Sheets(J).Range(\"A1\").PasteSpecial Paste:=xlPasteColumnWidths\n            Range(\"A1\").Value = sDay\n        Else\n            If Left(Sheets(J).Name, 5) = \"Sheet\" Then\n            Sheets(J).Name = sDay\n            Wb2.Sheets(J).Range(\"A1\").PasteSpecial Paste:=xlPasteValues\n            Wb2.Sheets(J).Range(\"A1\").PasteSpecial Paste:=xlPasteFormats\n            Wb2.Sheets(J).Range(\"A1\").PasteSpecial Paste:=xlPasteColumnWidths\n            Range(\"A1\").Value = sDay\n            Else\n            Sheets.Add.Move after:=Sheets(Sheets.Count)\n            ActiveSheet.Name = sDay\n            Wb2.Sheets(J).Range(\"A1\").PasteSpecial Paste:=xlPasteValues\n            Wb2.Sheets(J).Range(\"A1\").PasteSpecial Paste:=xlPasteFormats\n            Wb2.Sheets(J).Range(\"A1\").PasteSpecial Paste:=xlPasteColumnWidths\n            Range(\"A1\").Value = sDay\n            End If\n\n        End If\n    End If\nNext J\n\nFor J = 1 To (Sheets.Count - 1)\n    For K = J + 1 To Sheets.Count\n        If Right(Sheets(J).Name, 10) &gt; _\n          Right(Sheets(K).Name, 10) Then\n            Sheets(K).Move Before:=Sheets(J)\n        End If\n    Next K\nNext J\n\nSheets(1).Activate\nApplication.ScreenUpdating = True\nWb2.SaveAs Filename:=\"DCR_\" + sMonth + \".xlsx\"\n'\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "getelementsbyclassname"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1450229992, "post_id": 34302502, "comment_id": 56347340, "body": "<a href=\"http://stackoverflow.com/questions/7927905/internet-explorer-innerhtml-outputs-attributes-without-quotes\" title=\"internet explorer innerhtml outputs attributes without quotes\">stackoverflow.com/questions/7927905/&hellip;</a>  I don&#39;t think HTML requires quotes around attribute values when the values contain no whitespace, and what you&#39;re seeing when you look at outerHTML reflects IE&#39;s representation of this.  That&#39;s probably not the source of the error you&#39;re getting though."}, {"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 0, "creation_date": 1450230892, "post_id": 34302502, "comment_id": 56347599, "body": "What happens if you try <code>Set varTemp2 = vr.querySelectorAll(&quot;span.post_date&quot;)</code> ?"}, {"owner": {"reputation": 43, "user_id": 5684481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f495362a4bdb86c8ad022c3cc33226d7?s=128&d=identicon&r=PG&f=1", "display_name": "Soborubang", "link": "https://stackoverflow.com/users/5684481/soborubang"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1450238532, "post_id": 34302502, "comment_id": 56349521, "body": "Thanks to all!! @TimWilliams I see. then getElementsByTagName(&quot;span&quot;) is the only way I could pharse innerText???"}, {"owner": {"reputation": 43, "user_id": 5684481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f495362a4bdb86c8ad022c3cc33226d7?s=128&d=identicon&r=PG&f=1", "display_name": "Soborubang", "link": "https://stackoverflow.com/users/5684481/soborubang"}, "reply_to_user": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 0, "creation_date": 1450238576, "post_id": 34302502, "comment_id": 56349532, "body": "@barrowc Sorry your code occur same Error message :( but, thanks for your help!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1450239096, "post_id": 34302502, "comment_id": 56349646, "body": "I&#39;m running through some of your code now with an eye to alternate solutions but at a minimum <code>Cells(i + 1, 4) = varTemp2.innerText</code> should be <code>Cells(i + 1, 4) = varTemp2(0).innerText</code>. <code>getElementsByClassName</code> returns a collection, not a single object even if that collection is a collection of one element."}, {"owner": {"reputation": 43, "user_id": 5684481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f495362a4bdb86c8ad022c3cc33226d7?s=128&d=identicon&r=PG&f=1", "display_name": "Soborubang", "link": "https://stackoverflow.com/users/5684481/soborubang"}, "edited": false, "score": 0, "creation_date": 1450239618, "post_id": 34302502, "comment_id": 56349764, "body": "Thanks @Jeeped! That&#39;s a quiet good advice. but my problem is how to get the text from class tag. the only way is to use getElementsByTagName but it&#39;s no good enough for me. could you give me another advice?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 0, "creation_date": 1450244086, "post_id": 34302502, "comment_id": 56351136, "body": "@barrowc - <b>querySelector</b> and <b>querySelectorAll</b> are not yet available in a VBA DOM model."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1450252451, "post_id": 34302502, "comment_id": 56354716, "body": "@Jeeped - <code>querySelectorAll</code> works for me on an instance of <code>HTMLDocument</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1450252892, "post_id": 34302502, "comment_id": 56354948, "body": "@TimWilliams - Thanks for that. I&#39;ve still got that sample workbook lying around unsaved so I&#39;ll go back and test."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 5684481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f495362a4bdb86c8ad022c3cc33226d7?s=128&d=identicon&r=PG&f=1", "display_name": "Soborubang", "link": "https://stackoverflow.com/users/5684481/soborubang"}, "edited": false, "score": 0, "creation_date": 1450245219, "post_id": 34304544, "comment_id": 56351498, "body": "really thank you! I didn&#39;t know that getElementsByClassName is special one. Serously I admire you!"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1450250204, "post_id": 34304544, "comment_id": 56353595, "body": "MDN has &quot;You may also call <code>getElementsByClassName()</code> on any element; it will return only elements which are descendants of the specified root element with the given class names.&quot; and I&#39;m pretty sure I&#39;ve used it that way in the past in IE..."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1450252689, "post_id": 34304544, "comment_id": 56354844, "body": "Having said that, it doesn&#39;t work for me via VBA except when called on the <code>document</code> object.  ;-["}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1450253473, "post_id": 34304544, "comment_id": 56355255, "body": "@TimWilliams - The MDSN docs (linked above) have a few errors. They say it has a return value of type <b>Element</b> when it should be something like an HtmlElementCollection object. fwiw, I have seen several examples of VBA HTMLDocument method behavior that don&#39;t quite match what is expected from what the standards state (and javascript does properly)."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 5, "last_activity_date": 1450243685, "creation_date": 1450243685, "answer_id": 34304544, "question_id": 34302502, "link": "https://stackoverflow.com/questions/34302502/vba-getelementsbyclassname-htmlsources-double-quotation-marks-are-gone/34304544#34304544", "title": "vba, getElementsByClassName, HTMLSource&#39;s double quotation marks are gone", "body": "<p>The <a href=\"https://msdn.microsoft.com/en-us/library/ff975198(v=vs.85).aspx\" rel=\"noreferrer\">getElementsByClassName method</a> is not considered a method of itself; only of the parent HTMLDocument. If you want to use it to locate elements within a DIV element, you need to create a sub-HTMLDocument comprised of the .outerHtml of that specific DIV element.</p>\n\n<pre><code>Public Sub XMLhtmlDocumentHTMLSourceScraper()\n\n    Dim xmlHTTPReq As New MSXML2.XMLHTTP\n    Dim htmlDOC As New HTMLDocument, divSUBDOC As New HTMLDocument\n    Dim iDIV As Long, iSPN As Long, iEL As Long\n    Dim postURL As String, nr As Long, i As Long\n\n    postURL = \"http://foodffs.tumblr.com/archive/2015/11\"\n\n    With xmlHTTPReq\n        .Open \"GET\", postURL, False\n        .Send\n    End With\n\n    'Set htmlDOC = New HTMLDocument\n    With htmlDOC\n        .body.innerHTML = xmlHTTPReq.responseText\n    End With\n\n    i = 0\n\n    With htmlDOC\n        For iDIV = 0 To .getElementsByClassName(\"post_glass post_micro_glass\").Length - 1\n            nr = Sheet1.Cells(Rows.Count, 3).End(xlUp).Offset(1, 0).Row\n            With .getElementsByClassName(\"post_glass post_micro_glass\")(iDIV)\n                'method 1 - run through multiples in a collection\n                For iSPN = 0 To .getElementsByTagName(\"span\").Length - 1\n                    With .getElementsByTagName(\"span\")(iSPN)\n                        Select Case LCase(.className)\n                            Case \"post_date\"\n                                Cells(nr, 3) = .innerText\n                            Case \"post_notes\"\n                                Cells(nr, 4) = .innerText\n                            Case Else\n                                'do nothing\n                        End Select\n                    End With\n                Next iSPN\n                'method 2 - create a sub-HTML doc to facilitate getting els by classname\n                divSUBDOC.body.innerHTML = .outerHTML  'only the HTML from this DIV\n                With divSUBDOC\n                    If CBool(.getElementsByClassName(\"hover_inner\").Length) Then 'there is at least 1\n                        'use the first\n                        Cells(nr, 5) = .getElementsByClassName(\"hover_inner\")(0).innerText\n                    End If\n                End With\n            End With\n        Next iDIV\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>While other <strong>.getElementsByXXXX</strong> can readily retrieve collections within another element, the <a href=\"https://msdn.microsoft.com/en-us/library/ff975198(v=vs.85).aspx\" rel=\"noreferrer\">getElementsByClassName method</a> needs to consider what it believes to be the HTMLDocument as a whole, even if you have fooled it into thinking that.</p>\n"}, {"tags": [], "owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "is_accepted": false, "score": 1, "last_activity_date": 1450316112, "last_edit_date": 1495541239, "creation_date": 1450316112, "answer_id": 34325231, "question_id": 34302502, "link": "https://stackoverflow.com/questions/34302502/vba-getelementsbyclassname-htmlsources-double-quotation-marks-are-gone/34325231#34325231", "title": "vba, getElementsByClassName, HTMLSource&#39;s double quotation marks are gone", "body": "<p>Here's an alternative approach. It's very similar to the original code but uses querySelectorAll to select the relevant span elements. One important point for this method is that vr has to be declared as being a specific element type and not as an IHTMLElement or generic Object:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub XMLhtmlDocumentHTMLSourceScraper()\n\n' Changed from generic Object to specific type - not\n' strictly necessary to do this\nDim XMLHTTPReq As MSXML2.XMLHTTP60\nDim htmlDoc As HTMLDocument\n\n' These declarations weren't included in the original code\nDim i As Integer\nDim varTemp As Object\n' IMPORTANT: vr must be declared as a specific element type and not\n' as an IHTMLElement or generic Object\nDim vr As HTMLDivElement\nDim varTemp2 As Object\n\nDim postURL As String\n\npostURL = \"http://foodffs.tumblr.com/archive/2015/11\"\n\n' Changed from XMLHTTP to XMLHTTP60 as XMLHTTP is equivalent\n' to the older XMLHTTP30\nSet XMLHTTPReq = New MSXML2.XMLHTTP60\n\nWith XMLHTTPReq\n    .Open \"GET\", postURL, False\n    .Send\nEnd With\n\nSet htmlDoc = New HTMLDocument\nWith htmlDoc\n    .body.innerHTML = XMLHTTPReq.responseText\nEnd With\n\ni = 0\n\nSet varTemp = htmlDoc.getElementsByClassName(\"post_glass post_micro_glass\")\n\nFor Each vr In varTemp\n   ''''the next line is important to solve this issue *1\n   Cells(1, 1) = vr.outerHTML\n\n   Set varTemp2 = vr.querySelectorAll(\"span.post_date\")\n   Cells(i + 1, 3) = varTemp2.Item(0).innerText\n\n   Set varTemp2 = vr.getElementsByClassName(\"hover_inner\")\n   ' incorporating correction from Jeeped's comment (#56349646)\n   Cells(i + 1, 4) = varTemp2.Item(0).innerText\n\n   i = i + 1\nNext vr\n\nEnd Sub\n</code></pre>\n\n<p>Notes:</p>\n\n<ul>\n<li>XMLHTTP equivalent to XMLHTTP30 as described <a href=\"http://blogs.msdn.com/b/xmlteam/archive/2006/10/23/using-the-right-version-of-msxml-in-internet-explorer.aspx\" rel=\"nofollow noreferrer\">here</a></li>\n<li>apparent need to declare a specific element type explored in <a href=\"https://stackoverflow.com/q/33677107/2127508\">this question</a> but, unlike getElementsByClassName, querySelectorAll doesn't exist in any version of IHTMLElement</li>\n</ul>\n"}], "owner": {"reputation": 43, "user_id": 5684481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f495362a4bdb86c8ad022c3cc33226d7?s=128&d=identicon&r=PG&f=1", "display_name": "Soborubang", "link": "https://stackoverflow.com/users/5684481/soborubang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4803, "favorite_count": 0, "accepted_answer_id": 34304544, "answer_count": 2, "score": 4, "last_activity_date": 1450316112, "creation_date": 1450229075, "last_edit_date": 1450244011, "question_id": 34302502, "link": "https://stackoverflow.com/questions/34302502/vba-getelementsbyclassname-htmlsources-double-quotation-marks-are-gone", "title": "vba, getElementsByClassName, HTMLSource&#39;s double quotation marks are gone", "body": "<p>I scrape some websites with vba for fun and I use VBA as tool. I use XMLHTTP and HTMLDocument (cause it's more faster than internetExplorer.Application).</p>\n\n<pre><code>Public Sub XMLhtmlDocumentHTMLSourceScraper()\n\n    Dim XMLHTTPReq As Object\n    Dim htmlDoc As HTMLDocument\n\n    Dim postURL As String\n\n    postURL = \"http://foodffs.tumblr.com/archive/2015/11\"\n\n        Set XMLHTTPReq = New MSXML2.XMLHTTP\n\n        With XMLHTTPReq\n            .Open \"GET\", postURL, False\n            .Send\n        End With\n\n        Set htmlDoc = New HTMLDocument\n        With htmlDoc\n            .body.innerHTML = XMLHTTPReq.responseText\n        End With\n\n        i = 0\n\n        Set varTemp = htmlDoc.getElementsByClassName(\"post_glass post_micro_glass\")\n\n        For Each vr In varTemp\n            ''''the next line is important to solve this issue *1\n            Cells(1, 1) = vr.outerHTML\n            Set varTemp2 = vr.getElementsByTagName(\"SPAN class=post_date\")\n            Cells(i + 1, 3) = varTemp2.Item(0).innerText\n            ''''the next line occur 438Error''''\n            Set varTemp2 = vr.getElementsByClassName(\"hover_inner\")\n            Cells(i + 1, 4) = varTemp2.innerText\n\n            i = i + 1\n\n        Next vr\nEnd Sub\n</code></pre>\n\n<p>I figure out this problem by *1\ncells(1,1) shows me the next things</p>\n\n<pre><code>&lt;DIV class=\"post_glass post_micro_glass\" title=\"\"&gt;&lt;A class=hover title=\"\" href=\"http://foodffs.tumblr.com/post/134291668251/sugar-free-low-carb-coffee-ricotta-mousse-really\" target=_blank&gt;\n&lt;DIV class=hover_inner&gt;&lt;SPAN class=post_date&gt;...............\n</code></pre>\n\n<p>Yeah all the class tag lost \" \". only the first function's class has \" \"\nI really don't know why this situation occur.</p>\n\n<p>//Well I could pharse by getElementsByTagName(\"span\"). but I prefer \"class\" Tag.....</p>\n"}, {"tags": ["vba", "insert", "formula"], "answers": [{"comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 103, "user_id": 5534667, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d8ba2be934856b895517d8bd7ba7919e?s=128&d=identicon&r=PG&f=1", "display_name": "ichoi", "link": "https://stackoverflow.com/users/5534667/ichoi"}, "edited": false, "score": 1, "creation_date": 1450231578, "post_id": 34302663, "comment_id": 56347780, "body": "Missed the opening <code>[</code>"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1450231566, "last_edit_date": 1450231566, "creation_date": 1450230365, "answer_id": 34302663, "question_id": 34302359, "link": "https://stackoverflow.com/questions/34302359/go-through-cell-l-and-font-red-if-cell-value-is-0-and-insert-relational-formula/34302663#34302663", "title": "Go through cell L and font red if cell value is 0 and insert relational formula", "body": "<pre><code>cell.Formula = \"=VLOOKUP(F\" &amp; cell.Row &amp; \", [PickupCompaniesCommissions.xls]Sheet1!$U:$V,2,FALSE)\"\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 5534667, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d8ba2be934856b895517d8bd7ba7919e?s=128&d=identicon&r=PG&f=1", "display_name": "ichoi", "link": "https://stackoverflow.com/users/5534667/ichoi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 17, "favorite_count": 0, "accepted_answer_id": 34302663, "answer_count": 1, "score": 0, "last_activity_date": 1450231566, "creation_date": 1450228071, "question_id": 34302359, "link": "https://stackoverflow.com/questions/34302359/go-through-cell-l-and-font-red-if-cell-value-is-0-and-insert-relational-formula", "title": "Go through cell L and font red if cell value is 0 and insert relational formula", "body": "<p>So everything works but the vlookup part. The lookup value of the vlookup does not move with the cell rows. I am not sure how to go about making the \"F&amp;cell.number\" move along with the rows.</p>\n\n<pre><code>Sub fontredd()\n        Application.ScreenUpdating = False\n        Application.Calculation = xlCalculationManual\n        Dim rngL As range\n        Dim cell As range\n\n        Set rngL = range(\"L1\", range(\"L65536\").End(xlUp))\n        For Each cell In rngL\n            If cell.Value = \"0\" Then\n                cell.EntireRow.Font.Color = vbRed\n                cell.Formula = \"=VLOOKUP(F&amp;cell.number,[PickupCompaniesCommissions.xls]Sheet1!$U:$V,2,FALSE)\"\n            End If\n        Next cell\n        Application.ScreenUpdating = True\n        Application.Calculation = xlCalculationAutomatic\n\n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "edited": false, "score": 0, "creation_date": 1450228998, "post_id": 34302310, "comment_id": 56347048, "body": "yesterday I saw similar question from you, I prepared answer but your post has been deleted:)"}], "answers": [{"tags": [], "owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "is_accepted": true, "score": 4, "last_activity_date": 1450508406, "last_edit_date": 1450508406, "creation_date": 1450228701, "answer_id": 34302443, "question_id": 34302310, "link": "https://stackoverflow.com/questions/34302310/program-copies-and-pastes-twice/34302443#34302443", "title": "Program copies and pastes twice", "body": "<p>the first problem of your code is in this line:</p>\n\n<pre><code>If wS.Name = \"2012\" Or \"2013\" Or \"2014\" Or \"2015\" Or \"2016\" Or \"2017\" Or \"2018\" Or \"2019\" Or \"2020\" Then\n</code></pre>\n\n<p>Vba doesn't has understanding of such syntax</p>\n\n<p>So, should be:</p>\n\n<pre><code>If wS.Name = \"2012\" Or wS.Name = \"2013\" Or wS.Name = \"2014\" Or _\n   wS.Name = \"2015\" Or wS.Name = \"2016\" Or wS.Name = \"2017\" Or _\n   wS.Name = \"2018\" Or wS.Name = \"2019\" Or wS.Name = \"2020\" Then\n</code></pre>\n\n<p>Or you can use this method:</p>\n\n<pre><code>If \"|2012|2013|2014|2015|2016|2017|2018|2019|2020|\" Like \"*|\" &amp; wS.Name &amp; \"|*\" Then\n</code></pre>\n\n<p>Or like this:</p>\n\n<pre><code>If wS.Name Like \"201[2-9]\" Or wS.Name = \"2020\" Then\n</code></pre>\n\n<p><em>Finally</em>, if I have correct understanding what you want to achieve within your code, then you can use this:</p>\n\n<pre><code>For Each wS In ThisWorkbook.Worksheets\n    If \"|2012|2013|2014|2015|2016|2017|2018|2019|2020|\" Like \"*|\" &amp; wS.Name &amp; \"|*\" Then\n    lastrow = wS.Cells(wS.Rows.Count, \"B\").End(xlUp).Row\n        For r = 2 To lastrow\n            With Sheets(\"Male\")\n                If wS.Range(\"B\" &amp; r).Value = Sheets(\"Query\").[A2].Value Then\n                    wS.Rows(r).Copy .Rows(.Cells(Rows.Count, \"A\").End(xlUp).Row + 1)\n                End If\n            End With\n        Next r\n    End If\nNext\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 5657241, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5af439edb976523509c1f66146000cee?s=128&d=identicon&r=PG&f=1", "display_name": "mrwave", "link": "https://stackoverflow.com/users/5657241/mrwave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 34302443, "answer_count": 1, "score": 2, "last_activity_date": 1450508406, "creation_date": 1450227807, "last_edit_date": 1450230218, "question_id": 34302310, "link": "https://stackoverflow.com/questions/34302310/program-copies-and-pastes-twice", "title": "Program copies and pastes twice", "body": "<p>I have created a macro to allow me to search through my existing worksheets to search under a cell value.</p>\n\n<pre><code>If wS.Name = \"2012\" Or \"2013\" Or \"2014\" Or \"2015\" Or \"2016\" Or \"2017\" Or \"2018\" Or \"2019\" Or \"2020\" Then\n            lastrow = wS.Cells(wS.Rows.count, \"B\").End(xlUp).Row\n\n            'LastRow means to search till the end\n             For r = 2 To lastrow\n                    'This will check entire column for value\n                    If wS.Range(\"B\" &amp; r).value = Sheets(\"Query\").Range(\"A2\").value Then\n                        wS.Rows(r &amp; \":\" &amp; r).Copy Sheets(\"Male\").Range(\"A65536\").End(xlUp).Offset(1)\n                    End If\n            Next r\n            'Exit For\n         End If\n         Next\n</code></pre>\n\n<p>The problem I have with the code above is that it copies the row twice. Example:  </p>\n\n<pre><code>1/1/2000 | 12345 | 100   \n2/1/2000 | 12345 | 191   \n3/1/2000 | 12345 | 211  \n1/1/2000 | 12345 | 100   \n2/1/2000 | 12345 | 191   \n3/1/2000 | 12345 | 211  \n</code></pre>\n"}, {"tags": ["excel", "vba", "reference", "ms-word"], "comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 1, "creation_date": 1450230010, "post_id": 34302237, "comment_id": 56347346, "body": "Maybe do late binding? Something like Dim WrdApp as Object   Set WrdApp = CreateObject(&quot;Word.Application&quot;). If that doesn&#39;t work, try repairing office."}, {"owner": {"reputation": 971, "user_id": 3177855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909e8e34e0ec4b66788e190c7bf1e4f3?s=128&d=identicon&r=PG&f=1", "display_name": "DanL", "link": "https://stackoverflow.com/users/3177855/danl"}, "edited": false, "score": 0, "creation_date": 1450256895, "post_id": 34302237, "comment_id": 56357236, "body": "There are several possible reasons for the references option being greyed out. Make sure no code is running, and make sure you&#39;ve selected the actual project (or an object within) in the Properties Window (the task pane to the left in the VBA editor)."}, {"owner": {"reputation": 91, "user_id": 5302295, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b1605e4427904cd1ae1b65ae86a180d7?s=128&d=identicon&r=PG&f=1", "display_name": "willlow1044", "link": "https://stackoverflow.com/users/5302295/willlow1044"}, "reply_to_user": {"reputation": 971, "user_id": 3177855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909e8e34e0ec4b66788e190c7bf1e4f3?s=128&d=identicon&r=PG&f=1", "display_name": "DanL", "link": "https://stackoverflow.com/users/3177855/danl"}, "edited": false, "score": 0, "creation_date": 1450287247, "post_id": 34302237, "comment_id": 56378618, "body": "@DanL - having code running appears to be the issue. I closed excel, went home and re-opened the file and I can now add the Microsoft Word reference. Thanks,"}], "answers": [{"tags": [], "owner": {"reputation": 91, "user_id": 5302295, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b1605e4427904cd1ae1b65ae86a180d7?s=128&d=identicon&r=PG&f=1", "display_name": "willlow1044", "link": "https://stackoverflow.com/users/5302295/willlow1044"}, "is_accepted": true, "score": 2, "last_activity_date": 1450288713, "creation_date": 1450288713, "answer_id": 34318956, "question_id": 34302237, "link": "https://stackoverflow.com/questions/34302237/cant-set-reference-in-excel-ide-to-ms-word/34318956#34318956", "title": "Can&#39;t set reference in Excel IDE to MS Word", "body": "<p>The references option in the editor is greyed out when the application is in break mode or code is otherwise running. I closed excel, reopened it and was able to add the Microsoft Word library reference.</p>\n"}], "owner": {"reputation": 91, "user_id": 5302295, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b1605e4427904cd1ae1b65ae86a180d7?s=128&d=identicon&r=PG&f=1", "display_name": "willlow1044", "link": "https://stackoverflow.com/users/5302295/willlow1044"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 34318956, "answer_count": 1, "score": 3, "last_activity_date": 1450288713, "creation_date": 1450227381, "last_edit_date": 1450227697, "question_id": 34302237, "link": "https://stackoverflow.com/questions/34302237/cant-set-reference-in-excel-ide-to-ms-word", "title": "Can&#39;t set reference in Excel IDE to MS Word", "body": "<p>I want to populate a Word document with values from an Excel spreadsheet. Apparently the way to do this is to make reference to MS Word and use the following code snippet:  </p>\n\n<pre><code>Dim wrdApp As Word.Application\n</code></pre>\n\n<p>However I get an error:  </p>\n\n<blockquote>\n  <p>\"User-Defined Type Not Defined\"  </p>\n</blockquote>\n\n<p>So I try and set the reference via the tools menu but the references option is greyed out.</p>\n\n<p>What do I need to do to enable this feature?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1450230723, "post_id": 34302168, "comment_id": 56347553, "body": "Are the values being used for looking up information on other sheets unique, or could there be multiple corresponding rows?"}, {"owner": {"reputation": 11, "user_id": 5684274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e5c69561f4c334a55a9acc9c6b59b64?s=128&d=identicon&r=PG&f=1", "display_name": "MagnaDrago", "link": "https://stackoverflow.com/users/5684274/magnadrago"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1450235419, "post_id": 34302168, "comment_id": 56348714, "body": "The values are unique."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5684274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e5c69561f4c334a55a9acc9c6b59b64?s=128&d=identicon&r=PG&f=1", "display_name": "MagnaDrago", "link": "https://stackoverflow.com/users/5684274/magnadrago"}, "edited": false, "score": 0, "creation_date": 1450283151, "post_id": 34305501, "comment_id": 56376050, "body": "It is a 424 Error that highlights that particular line."}, {"owner": {"reputation": 11, "user_id": 5684274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e5c69561f4c334a55a9acc9c6b59b64?s=128&d=identicon&r=PG&f=1", "display_name": "MagnaDrago", "link": "https://stackoverflow.com/users/5684274/magnadrago"}, "edited": false, "score": 0, "creation_date": 1450283515, "post_id": 34305501, "comment_id": 56376327, "body": "It is a 424 Error that highlights that particular line. I attempted to rerun it and it worked correctly, but it highlighted the &quot;C.EntireRow.Cells - (1, ValCol)&quot; as a 1004 Error."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 11, "user_id": 5684274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e5c69561f4c334a55a9acc9c6b59b64?s=128&d=identicon&r=PG&f=1", "display_name": "MagnaDrago", "link": "https://stackoverflow.com/users/5684274/magnadrago"}, "edited": false, "score": 0, "creation_date": 1450285530, "post_id": 34305501, "comment_id": 56377587, "body": "What are the values of <code>DestCol</code> and <code>ValCol</code> when it fails ?"}, {"owner": {"reputation": 11, "user_id": 5684274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e5c69561f4c334a55a9acc9c6b59b64?s=128&d=identicon&r=PG&f=1", "display_name": "MagnaDrago", "link": "https://stackoverflow.com/users/5684274/magnadrago"}, "edited": false, "score": 0, "creation_date": 1450819849, "post_id": 34305501, "comment_id": 56591060, "body": "It may be an error on my end. Initial Do Lookup should remain as written(with columns being changed to suit lookup needs). The second set of code from your explanation believes the necessary data is on the consolidated sheet, when it comes from the SQR Sheet and needs to be copied to the Consolidated sheet.  Val Col should be the column on SQR Sheet from which the data is copied and Dest should be the location on Consolidated Sheet where it is copied to. Please confirm or correct."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1450248267, "creation_date": 1450248267, "answer_id": 34305501, "question_id": 34302168, "link": "https://stackoverflow.com/questions/34302168/match-value-between-two-sheets-and-copy-corresponding-value-to-initial-sheet-twi/34305501#34305501", "title": "Match value between two sheets and copy corresponding value to initial sheet twice", "body": "<p>Your first part is functional, but can be shortened quite a bit (and so made easier to maintain) if you use a small Sub to do the actual copying:</p>\n\n<pre><code>Sub InitialMigration()\n    CopyColumn \"B\", \"D\"\n    CopyColumn \"AH\", \"H\"\n    CopyColumn \"AV\", \"L\"\n    CopyColumn \"AW\", \"M\"\n    CopyColumn \"D\", \"N\"\n    CopyColumn \"I\", \"O\"\n    CopyColumn \"AS\", \"P\"\n    CopyColumn \"BC\", \"W\"\n    CopyColumn \"AO\", \"Z\"\n    CopyColumn \"AN\", \"AB\"\n    '...ETC ETC\nEnd Sub\n\n'Utility sub: Copy col letter S to col letter D\nSub CopyColumn(S As String, D As String)\n    Worksheets(\"Offer_Report_Raw_Data\").Columns(S).Copy _\n            Worksheets(\"Consolidated_Sheet\").Columns(D)\nEnd Sub\n</code></pre>\n\n<p>The last part is a bit more complicated but in the example below all of the logic is in the <code>DoLookup</code> Sub, so you can call this repeatedly from <code>Submission</code>, with different parameters for:</p>\n\n<ul>\n<li>the column you want to look up</li>\n<li>which column you want to check that against</li>\n<li>where to pick the value from in the event of a match</li>\n<li>which column to put that value into</li>\n</ul>\n\n<p>Here's the code: </p>\n\n<pre><code>Sub Submission()\n\n    Dim wksCS As Worksheet, wksSQR As Worksheet\n\n    Set wksCS = Worksheets(\"Consolidated_Sheet\")\n    Set wksSQR = Worksheets(\"SQR_Report_Raw_Data\")\n\n    'look up colU against colJ - copy match from ColF to ColO\n    DoLookup wksCS.Columns(\"U\"), wksSQR.Columns(\"J\"), \"F\", \"O\"\n\n    'add more lookups here....\n\n\nEnd Sub\n\n'Utility: for each value in SrcCol, check MatchCol for a match.\n'  If found, copy the value from Col 'ValCol' on the matched row to Col 'DestCol' on\n'   the consolidation sheet.\nSub DoLookup(SrcCol As Range, MatchCol As Range, ValCol As String, DestCol As String)\n    Dim rngSrc As Range, rngMatch As Range, c As Range, v, m\n    'just work with the \"used\" parts of the match columns\n    Set rngSrc = Application.Intersect(SrcCol, SrcCol.Parent.UsedRange)\n    Set rngMatch = Application.Intersect(MatchCol, MatchCol.Parent.UsedRange)\n\n    For Each c In rngSrc.Cells\n        v = c.Value\n        If Len(v) &gt; 0 Then\n            m = Application.Match(v, rngMatch, 0)\n            If Not IsError(m) Then\n                c.EntireRow.Cells(1, DestCol).Value = _\n                   rngMatch.Cells(m).EntireRow.Cells(1, ValCol)\n            Else\n                'decide what you want to do here...\n                c.EntireRow.Cells(1, DestCol).Value = \"No match!\"\n            End If\n        End If\n    Next c\nEnd Sub\n</code></pre>\n\n<p>Good luck!</p>\n"}], "owner": {"reputation": 11, "user_id": 5684274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e5c69561f4c334a55a9acc9c6b59b64?s=128&d=identicon&r=PG&f=1", "display_name": "MagnaDrago", "link": "https://stackoverflow.com/users/5684274/magnadrago"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1450248267, "creation_date": 1450226932, "last_edit_date": 1450227491, "question_id": 34302168, "link": "https://stackoverflow.com/questions/34302168/match-value-between-two-sheets-and-copy-corresponding-value-to-initial-sheet-twi", "title": "Match value between two sheets and copy corresponding value to initial sheet twice", "body": "<p>I have one workbook with four sheets - one Consolidated sheet that draws all information from the other items (Sheet2-4). The Consolidated sheet will be used as the source file for another Excel sheet that will be used to edit and update fields that could not be populated from the below reports (Sheet2-4). I am unable to use Access or another database type do to constraints beyond my control. </p>\n\n<pre><code>Sheet1 : Consolidated_Sheet  \nSheet2 : Incentive_Report_Raw_Data  \nSheet3 : Offer_Report_Raw_Data  \nSheet4 : SQR_Report_Raw_Data  \n</code></pre>\n\n<p><strong>Step 1:</strong> Integrate Data From Sheet3 to Consolidated Sheet - Works </p>\n\n<pre><code>Sub InitialMigration()\nDim sourceColumn As Range, targetColumn As Range\n\nSet sourceColumn = Worksheets(\"Offer_Report_Raw_Data\").Columns(\"B\")\nSet targetColumn = Worksheets(\"Consolidated_Sheet\").Columns(\"D\")\n\nsourceColumn.Copy [targetColumn]\n\nSet sourceColumn = Worksheets(\"Offer_Report_Raw_Data\").Columns(\"AH\")\nSet targetColumn = Worksheets(\"Consolidated_Sheet\").Columns(\"H\")\n\nsourceColumn.Copy [targetColumn]\n\nSet sourceColumn = Worksheets(\"Offer_Report_Raw_Data\").Columns(\"AV\")\nSet targetColumn = Worksheets(\"Consolidated_Sheet\").Columns(\"L\")\n\nsourceColumn.Copy [targetColumn]\n\nSet sourceColumn = Worksheets(\"Offer_Report_Raw_Data\").Columns(\"AW\")\nSet targetColumn = Worksheets(\"Consolidated_Sheet\").Columns(\"M\")\n\nsourceColumn.Copy [targetColumn]\n\nSet sourceColumn = Worksheets(\"Offer_Report_Raw_Data\").Columns(\"D\")\nSet targetColumn = Worksheets(\"Consolidated_Sheet\").Columns(\"N\")\n\nsourceColumn.Copy [targetColumn]\n\nSet sourceColumn = Worksheets(\"Offer_Report_Raw_Data\").Columns(\"I\")\nSet targetColumn = Worksheets(\"Consolidated_Sheet\").Columns(\"O\")\n\nsourceColumn.Copy [targetColumn]\n\nSet sourceColumn = Worksheets(\"Offer_Report_Raw_Data\").Columns(\"AS\")\nSet targetColumn = Worksheets(\"Consolidated_Sheet\").Columns(\"P\")\n\nsourceColumn.Copy [targetColumn]\n\nSet sourceColumn = Worksheets(\"Offer_Report_Raw_Data\").Columns(\"BC\")\nSet targetColumn = Worksheets(\"Consolidated_Sheet\").Columns(\"W\")\n\nsourceColumn.Copy [targetColumn]\n\nSet sourceColumn = Worksheets(\"Offer_Report_Raw_Data\").Columns(\"AO\")\nSet targetColumn = Worksheets(\"Consolidated_Sheet\").Columns(\"Z\")\n\nsourceColumn.Copy [targetColumn]\n\nSet sourceColumn = Worksheets(\"Offer_Report_Raw_Data\").Columns(\"AN\")\nSet targetColumn = Worksheets(\"Consolidated_Sheet\").Columns(\"AB\")\n\nsourceColumn.Copy [targetColumn]\n\nSet sourceColumn = Worksheets(\"Offer_Report_Raw_Data\").Columns(\"AK\")\nSet targetColumn = Worksheets(\"Consolidated_Sheet\").Columns(\"Y\")\n\nsourceColumn.Copy [targetColumn]\n\nSet sourceColumn = Worksheets(\"Offer_Report_Raw_Data\").Columns(\"AM\") 'Pricing\nSet targetColumn = Worksheets(\"Consolidated_Sheet\").Columns(\"AD\")\n\nsourceColumn.Copy [targetColumn]\n\nSet sourceColumn = Worksheets(\"Offer_Report_Raw_Data\").Columns(\"F\") 'Campaign Owner\nSet targetColumn = Worksheets(\"Consolidated_Sheet\").Columns(\"I\")\n\nsourceColumn.Copy [targetColumn]\n\nSet sourceColumn = Worksheets(\"Offer_Report_Raw_Data\").Columns(\"AG\") 'Product\nSet targetColumn = Worksheets(\"Consolidated_Sheet\").Columns(\"F\")\n\nsourceColumn.Copy [targetColumn]\nEnd Sub\n</code></pre>\n\n<p><strong>Step 2:</strong> I Need to match value from Consolidated_Sheet (Column U) to that in SQR (Column J) then copy value in same row SQR (Column F) to the corresponding row of initial value in Consolidated_Sheet (Column O).\n Match (CS-U) to (SQR-J) then copy (SQR-F) to (CS-O).</p>\n\n<p>Note: The rows on the two different sheets Do Not match. </p>\n\n<p>I have attempted this with limited success on a small scale - one row and it works, but I cannot find a way to make it work amongst a larger dataset - (~2,000+ rows). I found this on the internet and this is the closest I could get to what I was looking for - I honestly don't know if I asked the correct way. </p>\n\n<pre><code>Sub Submission()\nSet wks1 = Worksheets(\"Consolidated_Sheet\")\nSet wks2 = Worksheets(\"SQR_Report_Raw_Data\")\n\n\nWith wks1\n\nEnd With\nIf wks1.Range(\"U\") = wks2.Range(\"J\") Then\nwks2.Range(\"F\").Copy wks1.Range(\"O\") '&lt;&lt; cpy to 2nd WS\nEnd If\nEnd Sub\n</code></pre>\n\n<p><strong>Step 3:</strong> The requirement from the previous exercise would be necessary between the Consolidated_Sheet and the Incentive_Report_Raw_Data. </p>\n\n<p>Please note also that these Raw Data Sheets will be updated weekly and I would lie this to be able to continuously update everything. Ideally in a step by step process.</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1450225764, "post_id": 34301846, "comment_id": 56346112, "body": "What are q1, q2, and q3?"}, {"owner": {"reputation": 559, "user_id": 3703566, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/100007694648240/picture?type=large", "display_name": "Sami", "link": "https://stackoverflow.com/users/3703566/sami"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1450226021, "post_id": 34301846, "comment_id": 56346181, "body": "Hey! thanks for the response. q1 q2 and q3 are the names of the queries in Access"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1450226113, "post_id": 34301846, "comment_id": 56346216, "body": "So you mean they are string values?  And <code>Debug.Print TypeName(q1)</code> tells you &#39;String&#39;?"}, {"owner": {"reputation": 559, "user_id": 3703566, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/100007694648240/picture?type=large", "display_name": "Sami", "link": "https://stackoverflow.com/users/3703566/sami"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1450226479, "post_id": 34301846, "comment_id": 56346327, "body": "Yes, q1, q2, and q3 are <code>string</code> values"}], "answers": [{"comments": [{"owner": {"reputation": 559, "user_id": 3703566, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/100007694648240/picture?type=large", "display_name": "Sami", "link": "https://stackoverflow.com/users/3703566/sami"}, "edited": false, "score": 1, "creation_date": 1450279535, "post_id": 34302193, "comment_id": 56373307, "body": "that&#39;s exactly what I was looking for, really nice job explaining why I was getting the error and providing an explanation of the solution needed."}], "tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 1, "last_activity_date": 1450280032, "last_edit_date": 1450280032, "creation_date": 1450227085, "answer_id": 34302193, "question_id": 34301846, "link": "https://stackoverflow.com/questions/34301846/counting-number-of-headers-in-an-access-query-and-finding-the-max/34302193#34302193", "title": "Counting number of headers in an Access Query and Finding the Max", "body": "<p>You reported that <code>q1</code>, <code>q2</code>, and <code>q3</code> are String variables which contain the names of queries.</p>\n\n<p>So the problem is that a String does not have a <code>Fields</code> collection. Therefore <code>Qs(0).Fields.Count</code> triggers error #424, <em>\"Object required\"</em>.</p>\n\n<p>If you want <code>Fields.Count</code>, you must reference it via a suitable <em>object</em>.</p>\n\n<p>Since <code>Qs(0)</code> holds the name of a query, you can reference the actual <code>DAO.QueryDef</code> (the saved query) object with <code>CurrentDb.QueryDefs(Qs(0))</code></p>\n\n<p>But since you want the <code>Count</code> of that query's <code>Fields</code>, use this:</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>CurrentDb.QueryDefs(Qs(0)).Fields.Count\n</code></pre>\n\n<p>Another way to approach this would be to make <code>q1</code>, <code>q2</code>, and <code>q3</code> object variables instead of strings ...</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim db As DAO.Database\nDim q1 As DAO.QueryDef\nDim q2 As DAO.QueryDef\nDim q3 As DAO.QueryDef\nDim Qs As Variant\n\nSet db = CurrentDb\nWith db\n    Set q1 = .QueryDefs(\"Query1\")\n    Set q2 = .QueryDefs(\"Query2\")\n    Set q3 = .QueryDefs(\"Query3\")\nEnd With\nQs = Array(q1, q2, q3)\nDebug.Print WorksheetFunction.Max(Qs(0).Fields.Count, Qs(1).Fields.Count, Qs(2).Fields.Count)\n</code></pre>\n\n<p>I tested that sample code in Access 2010 and it prints the maximum <code>Fields.Count</code> of the 3 queries.  But I don't know whether this suggestion will easily integrate with the rest of your code.  Hopefully it points you to something useful.</p>\n"}], "owner": {"reputation": 559, "user_id": 3703566, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/100007694648240/picture?type=large", "display_name": "Sami", "link": "https://stackoverflow.com/users/3703566/sami"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 34302193, "answer_count": 1, "score": 1, "last_activity_date": 1450280032, "creation_date": 1450224758, "question_id": 34301846, "link": "https://stackoverflow.com/questions/34301846/counting-number-of-headers-in-an-access-query-and-finding-the-max", "title": "Counting number of headers in an Access Query and Finding the Max", "body": "<p>I am using VBA and I am exporting some <code>Access</code> queries to Excel. This macro is being built on the <code>Access</code> side. I have an array of queries such as:</p>\n\n<p><code>Qs = Array(q1, q2, q3)</code></p>\n\n<p>I need to <code>count</code> the number of headers in each query and find the <code>max</code>.</p>\n\n<p>Based on a couple searches, I found you can use the <code>WorksheetFunction.Max</code> but I am getting an <code>\"Object Required\" error</code>.</p>\n\n<p>Here is the code I am trying that is raising an error:</p>\n\n<pre><code> WorksheetFunction.Max(Qs(0).Fields.Count, Qs(1).Fields.Count, Qs(2).Fields.Count) \n</code></pre>\n\n<p>Is there another way to do this? </p>\n\n<p>P.S. I already added a reference to <code>Microsoft Excel 14.0 Object Library</code></p>\n"}, {"tags": ["string", "vba"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1450222957, "post_id": 34301444, "comment_id": 56345228, "body": "<code>s = DayTraArray(i)</code> to read the ith entry in the array. To <i>assign</i> a new value to it, <code>DayTraArray(i) = s</code>"}], "answers": [{"tags": [], "owner": {"reputation": 32382, "user_id": 587803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7431a850a166ca3a648141c532aa9d0?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/587803/ben"}, "is_accepted": false, "score": 0, "last_activity_date": 1450432835, "creation_date": 1450432835, "answer_id": 34352875, "question_id": 34301444, "link": "https://stackoverflow.com/questions/34301444/vba-accessing-an-element-in-a-string-array/34352875#34352875", "title": "VBA - accessing an element in a string array", "body": "<p>VB arrays may or may not begin at zero. They can have any base. The default base is 1, and can be set to zero with the <code>Option Base</code> statement. (Don't do that, you will confuse people - in VB many people will assume the array is 1-based).</p>\n\n<p>To find out the base of an array use the <code>LBound(arr)</code> function, which returns the lowest valid index. Find the highest valid index use <code>UBound(arr)</code></p>\n\n<p>To loop through an array properly:</p>\n\n<pre><code>Debug.Print \"arr has \" &amp; (UBound(arr) - LBound(arr) - 1) &amp; \" entries\"\nDebug.Print \"    from \" &amp; LBound(arr) &amp; \" to \" &amp; UBound(arr) &amp; \".\"\nFor i = LBound(arr) To UBound(arr)\n    Debug.Print \"arr(\" &amp; i &amp; \"): \" &amp; arr(i)\nNext\n</code></pre>\n\n<p>To change the size of an array:</p>\n\n<pre><code>Redim Preserve arr(1 To 10)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5684287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2214f509087ce2e299e48f5eabe3094?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Kavaliku", "link": "https://stackoverflow.com/users/5684287/tom-kavaliku"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 118, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1450432835, "creation_date": 1450222271, "last_edit_date": 1450224987, "question_id": 34301444, "link": "https://stackoverflow.com/questions/34301444/vba-accessing-an-element-in-a-string-array", "title": "VBA - accessing an element in a string array", "body": "<p>I currently have a string array called DayTraArray. I want to assign a particular element in the array to another string. I was wondering if this was the right syntax</p>\n\n<pre><code>dim s As String\ndim i As Integer\n\ns = DayTraArray(i) \n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 962, "user_id": 4787855, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/809517039155976/picture?type=large", "display_name": "Lucas Crostarosa", "link": "https://stackoverflow.com/users/4787855/lucas-crostarosa"}, "edited": false, "score": 0, "creation_date": 1450220017, "post_id": 34300966, "comment_id": 56344029, "body": "I found this example, but cannot seem to bridge the two together. <a href=\"http://www.ozgrid.com/VBA/IsWorkbookOpen.htm\" rel=\"nofollow noreferrer\">ozgrid.com/VBA/IsWorkbookOpen.htm</a>"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1450220182, "post_id": 34300966, "comment_id": 56344113, "body": "<code>for each b in application.workbooks | if not b.fullname= MCDistroNumberPath then</code> Not sure why your variable name changed..."}, {"owner": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1450220433, "post_id": 34300966, "comment_id": 56344219, "body": "And the file name is disconnected from the path in the example, but never-the-less, @findwindow has a good solution, I tend to do something like the following:<code>On Error Resume Next: Set WorkbookVariable = Workbooks(Filename:=MCDistroNumberPath): On Error GoTo 0     If Not WorkbookVariable Is Nothing Then Set WorkbookVariable = Workbooks.Open(Filename:=MCDistroNumberPath)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1450223555, "post_id": 34301545, "comment_id": 56345405, "body": "Nice. But we could get the name from the path using string manipulation, without &quot;disturbing&quot; the OS ;)"}], "tags": [], "owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "is_accepted": false, "score": 3, "last_activity_date": 1450222874, "creation_date": 1450222874, "answer_id": 34301545, "question_id": 34300966, "link": "https://stackoverflow.com/questions/34300966/referencing-external-workbook-vba-through-variable-and-if-statement/34301545#34301545", "title": "Referencing External Workbook VBA through Variable and If Statement", "body": "<p>Consider putting it into its own function like below.</p>\n\n<pre><code>Public Function GetOrOpenWorkbook(ByVal sFullPath As String) As Workbook\n\n    Dim wbReturn As Workbook\n\n    On Error Resume Next\n        Set wbReturn = Workbooks(Dir(sFullPath))\n    On Error GoTo 0\n\n    If wbReturn Is Nothing Then\n        Set wbReturn = Workbooks.Open(sFullPath)\n    End If\n\n    Set GetOrOpenWorkbook = wbReturn\n\nEnd Function\n\nSub test()\n\n    Dim wb As Workbook\n\n    Set wb = GetOrOpenWorkbook(\"C:\\Path\\Path.xlsx\")\n\nEnd Sub\n</code></pre>\n\n<p>The <code>Dir</code> function will return just the file name without the path. If a workbook with that name is already open, it will return that workbook. If not, it attempts to open it.</p>\n"}], "owner": {"reputation": 962, "user_id": 4787855, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/809517039155976/picture?type=large", "display_name": "Lucas Crostarosa", "link": "https://stackoverflow.com/users/4787855/lucas-crostarosa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 368, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1450222874, "creation_date": 1450219943, "question_id": 34300966, "link": "https://stackoverflow.com/questions/34300966/referencing-external-workbook-vba-through-variable-and-if-statement", "title": "Referencing External Workbook VBA through Variable and If Statement", "body": "<p>Currently my code looks like this and it works fine</p>\n\n<pre><code>    Dim WorkbookVar As Workbook\n    Dim Path As String\n    Path = \"C:\\Path.xlsx\"\n    Set WorkbookVariable = Workbooks.Open (Filename:=MCDistroNumberPath)\n</code></pre>\n\n<p>But I would like it to go a step further and have an if statement saying <code>If</code> this workbook is already open <code>Then</code> skip it and start running the rest of my macro. </p>\n\n<p>How would I go about doing that?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "edited": false, "score": 0, "creation_date": 1450271880, "post_id": 34300731, "comment_id": 56367752, "body": "Have you tried your example code? What happened? Also, if you want to avoid a bunch of IFs, there&#39;s always the SELECT CASE."}, {"owner": {"reputation": 1435, "user_id": 5661165, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gFRnF.png?s=128&g=1", "display_name": "SilentRevolution", "link": "https://stackoverflow.com/users/5661165/silentrevolution"}, "reply_to_user": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "edited": false, "score": 0, "creation_date": 1450274224, "post_id": 34300731, "comment_id": 56369416, "body": "The example code is just to demonstrate what I want but with different objects, it doesn&#39;t even run because in the same sub a worksheet is activated based on a choice in a listbox that is filled in the same sub. Also I&#39;ve looked at the select but that still is many lines of code for each different form I might want to show, it would be easiest, provided it is possible to have something like <code>Forms(me.listbox1).Show</code> but that obviously doesn&#39;t work and so far I&#39;ve not been able to find out if even possible."}], "answers": [{"comments": [{"owner": {"reputation": 1435, "user_id": 5661165, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gFRnF.png?s=128&g=1", "display_name": "SilentRevolution", "link": "https://stackoverflow.com/users/5661165/silentrevolution"}, "edited": false, "score": 0, "creation_date": 1450304929, "post_id": 34322723, "comment_id": 56388437, "body": "Thank you so much! I don&#39;t know why I couldn&#39;t find that resource but thank you."}, {"owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "reply_to_user": {"reputation": 1435, "user_id": 5661165, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gFRnF.png?s=128&g=1", "display_name": "SilentRevolution", "link": "https://stackoverflow.com/users/5661165/silentrevolution"}, "edited": false, "score": 0, "creation_date": 1450309456, "post_id": 34322723, "comment_id": 56390280, "body": "@SilentRevolution , you are welcome!, maybe  because it is very old (for Microsoft Excel 97)"}], "tags": [], "owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "is_accepted": true, "score": 2, "last_activity_date": 1450302512, "creation_date": 1450302512, "answer_id": 34322723, "question_id": 34300731, "link": "https://stackoverflow.com/questions/34300731/show-form-based-on-variable-string-input/34322723#34322723", "title": "Show form based on variable string input", "body": "<p>Try using this :</p>\n\n<pre><code>VBA.UserForms.Add(Me.ListBox1).Show\n</code></pre>\n\n<p>Source:\n<a href=\"https://support.microsoft.com/en-us/kb/157609\" rel=\"nofollow\">How to Display a UserForm Whose Name Is in a Variable</a></p>\n"}], "owner": {"reputation": 1435, "user_id": 5661165, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gFRnF.png?s=128&g=1", "display_name": "SilentRevolution", "link": "https://stackoverflow.com/users/5661165/silentrevolution"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 342, "favorite_count": 0, "accepted_answer_id": 34322723, "answer_count": 1, "score": 1, "last_activity_date": 1450302512, "creation_date": 1450218838, "last_edit_date": 1531164843, "question_id": 34300731, "link": "https://stackoverflow.com/questions/34300731/show-form-based-on-variable-string-input", "title": "Show form based on variable string input", "body": "<p>Is it possible to show a form like <code>Form_1.show</code> based on a string variable like with the worksheets or controls like such</p>\n\n<pre><code>Private Sub Demo()\n    Dim i As Long\n    For i = 1 To 10\n        me.Controls(\"Label_\" &amp; i) = Rnd()\n    Next i\n\n    'Or select a worksheet based on an input\n\n    With Me.ListBox1\n        For i = 1 to 5\n            .additem Cstr(\"Sheet\" &amp; i)\n        Next i\n    End With\n\n    ThisWorkBook.Worksheets(me.ListBox1).Activate\nEnd Sub\n</code></pre>\n\n<p>Basically what I'm trying to do is show Form1 to 10 based on a choice made from a listbox in a form and instead of writing a lot of <code>If</code> statements is it possible to change the form which is shown based on a choice?</p>\n\n<p>Below is the current situation.</p>\n\n<pre><code>Private Sub Worksheet_Activate()\n    Dim Table1 as ListObject\n    Set Table1 = Thisworkbook.Worksheets(\"Sheet1\").Listobjects(\"Forms_List\")\n    Dim Rows As Long\n    Rows = Table1.ListRows.Count\n    Dim i As Long\n\n    With Me.ListBox1\n        For i = 1 To Rows\n            .AddItem Table1.DataBodyRange(i, 1)\n        Next i\n    End With\nEnd Sub\n\nPrivate Sub ListBox1_dblclick(ByVal Cancel As MSForms.ReturnBoolean) \n    'This is what I want to avoid, mainly because it isn't flexible\n    If Me.ListBox1 = \"Form1\" Then Form1.Show\n    If Me.ListBox1 = \"Form2\" Then Form2.Show\n    If Me.ListBox1 = \"Form3\" Then Form3.Show\n    If Me.ListBox1 = \"Form4\" Then Form4.Show\n    If Me.ListBox1 = \"Form5\" Then Form5.Show\n    If Me.ListBox1 = \"Form6\" Then Form6.Show\n    If Me.ListBox1 = \"Form7\" Then Form7.Show\n    If Me.ListBox1 = \"Form8\" Then Form8.Show\n    If Me.ListBox1 = \"Form9\" Then Form9.Show\n    If Me.ListBox1 = \"Form10\" Then Form10.Show\nEnd Sub\n</code></pre>\n"}, {"tags": ["c#", "excel", "vba", "excel-interop", "excel.application"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1450218431, "post_id": 34300606, "comment_id": 56343238, "body": "Not sure about why it&#39;s adding the sheet, but maybe add a line that removes a sheet called &quot;Sheet1&quot; at the end, after you set up your sheet?"}, {"owner": {"reputation": 525, "user_id": 875317, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/tQ8Th.jpg?s=128&g=1", "display_name": "B. Clay Shannon", "link": "https://stackoverflow.com/users/875317/b-clay-shannon"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1450218844, "post_id": 34300606, "comment_id": 56343434, "body": "@Batman: How is that done? I have never removed a sheet."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1450219800, "post_id": 34300606, "comment_id": 56343919, "body": "Unfortunately I&#39;m not well versed (or even terribly versed) in C# for Excel.  However, it looks like <a href=\"http://stackoverflow.com/questions/16328923/delete-excel-worksheets-programatically\">this thread</a> has that answer to that question.  Does that help?"}, {"owner": {"reputation": 525, "user_id": 875317, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/tQ8Th.jpg?s=128&g=1", "display_name": "B. Clay Shannon", "link": "https://stackoverflow.com/users/875317/b-clay-shannon"}, "edited": false, "score": 1, "creation_date": 1450220632, "post_id": 34300606, "comment_id": 56344308, "body": "@Batman: Thanks, that link had two good ideas, the water pistol, which will probably work, and the water cannon, which I might use just for the heck of it."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1450220695, "post_id": 34300606, "comment_id": 56344338, "body": "@pnuts - if he changed that to <code>0</code> would it create a single sheet?  Since the default is 1, I&#39;m thinking the number he has, <code>1</code>, technically means <i>in addition to default number</i>?"}, {"owner": {"reputation": 2412, "user_id": 1375538, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4e3d00e1be284479c46f4e1d20c14b63?s=128&d=identicon&r=PG", "display_name": "test", "link": "https://stackoverflow.com/users/1375538/test"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1450221015, "post_id": 34300606, "comment_id": 56344501, "body": "@BruceWayne The <code>SheetsInNewWorkbook</code> property must be between 1 and 255. But @B.ClayShannon, I&#39;m confused because simply removing your line <code>_xlBook.Worksheets.Add(Type.Missing, Type.Missing, Type.Missing, Type.Missing);</code> would do the trick since you&#39;d simply be renaming <code>Sheet1</code>"}, {"owner": {"reputation": 525, "user_id": 875317, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/tQ8Th.jpg?s=128&g=1", "display_name": "B. Clay Shannon", "link": "https://stackoverflow.com/users/875317/b-clay-shannon"}, "reply_to_user": {"reputation": 2412, "user_id": 1375538, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4e3d00e1be284479c46f4e1d20c14b63?s=128&d=identicon&r=PG", "display_name": "test", "link": "https://stackoverflow.com/users/1375538/test"}, "edited": false, "score": 1, "creation_date": 1450221863, "post_id": 34300606, "comment_id": 56344845, "body": "@test - you&#39;re right; that was a bogus call to Worksheets.Add(). Removing it solved the superfluency. Make that an answer, and I&#39;ll mark it as such."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 2, "creation_date": 1450221975, "post_id": 34300606, "comment_id": 56344888, "body": "@pnuts - I was thinking it&#39;d be understood as <code>create 0 additional sheets to default amount</code>. But that&#39;s probably not right.  And it looks like B.ClayShannon found his solution anyways, so huzzah!"}], "answers": [{"tags": [], "owner": {"reputation": 2412, "user_id": 1375538, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4e3d00e1be284479c46f4e1d20c14b63?s=128&d=identicon&r=PG", "display_name": "test", "link": "https://stackoverflow.com/users/1375538/test"}, "is_accepted": true, "score": 3, "last_activity_date": 1450222395, "creation_date": 1450222395, "answer_id": 34301466, "question_id": 34300606, "link": "https://stackoverflow.com/questions/34300606/why-am-i-getting-a-superfluous-sheet-even-though-im-explicitly-setting-sheet-co/34301466#34301466", "title": "Why am I getting a superfluous sheet even though I&#39;m explicitly setting sheet count to 1?", "body": "<p>The answer to your question can be found in the documentation of the <code>Template</code> parameter on the <code>Workbook.Add</code> method.</p>\n\n<blockquote>\n  <p>[...] If this argument is omitted, Microsoft Excel creates a new\n  workbook with a number of blank sheets (the number of sheets is set by\n  the <code>SheetsInNewWorkbook</code> property).</p>\n</blockquote>\n\n<p>Your code is omitting it, therefore it is creating a single Worksheet for you (since you've set <code>SheetsInNewWorkbook</code> to 1.</p>\n\n<p>That property is also constrained to be between 1 and 255, so you aren't able to add a work book without a sheet (unless you use a file template).</p>\n\n<p>Also from the <code>Template</code> parameter documentation:</p>\n\n<blockquote>\n  <p>If this argument is a constant, the new workbook contains a <strong>single</strong>\n  <strong>sheet</strong> of the specified\n       type. Can be one of the following <code>Microsoft.Office.Interop.Excel.XlWBATemplate</code>\n       constants: <code>xlWBATChart</code>, <code>xlWBATExcel4IntlMacroSheet</code>, <code>xlWBATExcel4MacroSheet</code>,\n       or <code>xlWBATWorksheet</code>.</p>\n</blockquote>\n\n<p>So an alternative way to do this is:</p>\n\n<pre><code>_xlApp = new Excel.Application();\n_xlBook = _xlApp.Workbooks.Add(Excel.XlWBATemplate.xlWBATWorksheet);\n_xlSheets = _xlBook.Worksheets;\n_xlSheet = (Excel.Worksheet)_xlSheets.Item[1];\n_xlSheet.Name = String.Format(\"Price Compliance {0} {1}\", _month, _year);\n</code></pre>\n\n<p>Which simply renames the single created sheet.</p>\n"}], "owner": {"reputation": 525, "user_id": 875317, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/tQ8Th.jpg?s=128&g=1", "display_name": "B. Clay Shannon", "link": "https://stackoverflow.com/users/875317/b-clay-shannon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "accepted_answer_id": 34301466, "answer_count": 1, "score": 1, "last_activity_date": 1453778718, "creation_date": 1450218297, "last_edit_date": 1453778718, "question_id": 34300606, "link": "https://stackoverflow.com/questions/34300606/why-am-i-getting-a-superfluous-sheet-even-though-im-explicitly-setting-sheet-co", "title": "Why am I getting a superfluous sheet even though I&#39;m explicitly setting sheet count to 1?", "body": "<p>I want to avoid generated spreadsheets having empty/superfluous sheets named \"Sheet1\" and such. I thought I could do that by specifying how many sheets a workbook should have this way:</p>\n\n<pre><code>_xlApp = new Excel.Application { SheetsInNewWorkbook = 1 };\n</code></pre>\n\n<p>...But I'm still getting an unwanted \"Sheet1\" in addition to the sheet I create. Here is the pertinent code:</p>\n\n<pre><code>using Excel = Microsoft.Office.Interop.Excel;\n. . .\nprivate Excel.Application _xlApp;\nprivate Excel.Workbook _xlBook;\nprivate Excel.Sheets _xlSheets;\nprivate Excel.Worksheet _xlSheet;\n. . .\nprivate void InitializeSheet()\n{\n    _xlApp = new Excel.Application { SheetsInNewWorkbook = 1 };\n    _xlBook = _xlApp.Workbooks.Add(Type.Missing);\n    _xlBook.Worksheets.Add(Type.Missing, Type.Missing, Type.Missing, Type.Missing);\n    _xlSheets = _xlBook.Worksheets;\n    _xlSheet = (Excel.Worksheet)_xlSheets.Item[1];\n    _xlSheet.Name = String.Format(\"Price Compliance {0} {1}\", _month, _year);\n}\n</code></pre>\n\n<p>So since setting SheetsInNewWorkbook to 1 in the Excel.Application instance doesn't do the trick, what do I need to do to prevent these tramp sheets from showing up?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1450217826, "post_id": 34300442, "comment_id": 56342922, "body": "<code>Sub FormatCharts(ws as worksheet)</code> then when you call <code>FormatCharts ActiveSheet</code>  Then replace all the active sheets in the procedure with ws."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1450218477, "post_id": 34300442, "comment_id": 56343261, "body": "Call <code>FormatCharts Target.Parent</code> after adding a <code>ws</code> parameter to <code>FormatCharts</code> as Scott describes"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1450218581, "post_id": 34300442, "comment_id": 56343314, "body": "@TimWilliams that was what I couldn&#39;t think of right of the top of my head.  It&#39;s been one of those days today."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1450218930, "post_id": 34300442, "comment_id": 56343479, "body": "@ScottCraner - I know those days..."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1450222678, "post_id": 34300442, "comment_id": 56345130, "body": "@TimWilliams and Scott, I think that the problem is elsewhere. I dont see how <code>ActiveSheet</code> would be anything else than the sheet where the change actually occured?"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1450222753, "post_id": 34300442, "comment_id": 56345161, "body": "OP, if you are using <code>Option Explicit</code>, I dont see where your variable <code>maxValue</code> is defined?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1450224797, "post_id": 34300442, "comment_id": 56345773, "body": "ASH has your actual problem, but still it&#39;s best to <i>never</i> use <code>ActiveSheet</code>/<code>Selection</code> etc in your code unless you absolutely need to (and in most cases it can be avoided).  What if (for example) you end up writing code which updates your Chart sheet and that gets run while the sheet isn&#39;t active?"}], "owner": {"reputation": 2521, "user_id": 3250992, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/625932982113d9c5a46e88f442501cf3?s=128&d=identicon&r=PG&f=1", "display_name": "noobmaster69", "link": "https://stackoverflow.com/users/3250992/noobmaster69"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 211, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1450218139, "creation_date": 1450217691, "last_edit_date": 1450218139, "question_id": 34300442, "link": "https://stackoverflow.com/questions/34300442/pass-active-sheet-to-a-sub-routine", "title": "Pass active sheet to a sub routine", "body": "<p>In Excel 2013, I have a worksheet (named \"ChartSheet\") which has six charts. I'm trying to automatically set the minimum and maximum values of the Y axis of each chart, upon any change within the worksheet. The values for the minimum and maximum values for each chart are contained within named ranges, specific to the <code>ChartSheet</code> worksheet, called <code>rng_MaxAxis</code> and <code>rng_MinAxis</code>.</p>\n\n<p>In order to accomplish my goal I have the following VBA code in the <em>ChartSheet</em> sheet:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    FormatCharts\nEnd Sub\n</code></pre>\n\n<p>This feeds off of a SubRoutine I have in a module called <code>FormatCharts</code> and the code in that is:</p>\n\n<pre><code>Sub FormatCharts()\n\nDim objCht As ChartObject\nDim maxAxis As Range\nDim minAxis As Range\n\nSet maxAxis = ActiveSheet.Range(\"rng_MaxAxis\")\nSet minAxis = ActiveSheet.Range(\"rng_MinAxis\")\n\nFor Each objCht In ActiveSheet.ChartObjects\n    With objCht.Chart\n     ' Value (Y) Axis\n        With .Axes(xlValue)\n            For Each maxValue In maxAxis\n                .MaximumScale = maxValue.Value\n            Next maxValue\n\n            For Each minValue In minAxis\n                .MinimumScale = minValue.Value\n            Next minValue\n        End With\n    End With\nNext objCht\n\nEnd Sub\n</code></pre>\n\n<p>Upon any change I receive the following error, <code>Compile Error: Variable not found</code> and it points to the <code>maxValue</code> For Each loop.</p>\n\n<p>I believe this is due to Excel not knowing which worksheet to pass to the <code>FormartCharts</code> subroutine. How can I pass the active sheet to the <code>FormatCharts</code> subroutine?</p>\n"}, {"tags": ["vba", "excel", "userform"], "comments": [{"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 1, "creation_date": 1450218328, "post_id": 34300301, "comment_id": 56343186, "body": "after they input the values, they need to hit a button to start everything, just run a <code>isnumeric()</code> and if it returns any false for any textbox, pop a msgbox and <code>EXIT SUB</code>... just do not do it with an <code>ONCHANGE</code> event, a decimal point may pop errors while typing..."}], "answers": [{"tags": [], "owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "is_accepted": true, "score": 1, "last_activity_date": 1450220328, "last_edit_date": 1450220328, "creation_date": 1450219866, "answer_id": 34300945, "question_id": 34300301, "link": "https://stackoverflow.com/questions/34300301/userform-entry-validation/34300945#34300945", "title": "Userform entry validation", "body": "<p>If you really need to do it on the run, you can do it like this:</p>\n\n<pre><code>Private Sub TextBox12_Change()\n  If chkNum Then Sumdatup\n  If IsNumeric(TextBox12.Value) Then TextBox12.BackColor = 16777215 Else TextBox12.BackColor = 255\nEnd Sub\n\nPrivate Sub TextBox16_Change()\n  If chkNum Then Sumdatup\n  If IsNumeric(TextBox16.Value) Then TextBox16.BackColor = 16777215 Else TextBox16.BackColor = 255\nEnd Sub\n\nPrivate Sub TextBox21_Change()\n  If chkNum Then Sumdatup\n  If IsNumeric(TextBox21.Value) Then TextBox21.BackColor = 16777215 Else TextBox21.BackColor = 255\nEnd Sub\n\nPrivate Function chkNum() As Boolean\n  If IsNumeric(TextBox12.Value) And IsNumeric(TextBox16.Value) And IsNumeric(TextBox21.Value) Then\n    chkNum = (Len(TextBox12.Value) * Len(TextBox16.Value) * Len(TextBox21.Value)) &gt; 0\n  End If\nEnd Function\n\nPrivate Sub Sumdatup()\n  TextBox26.Value = TextBox12.Value + TextBox16.Value + TextBox21.Value\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 185, "user_id": 3794203, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/cba2a1760eb1c8f18f60de42d7070f21?s=128&d=identicon&r=PG&f=1", "display_name": "user3794203", "link": "https://stackoverflow.com/users/3794203/user3794203"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 803, "favorite_count": 0, "accepted_answer_id": 34300945, "answer_count": 1, "score": 0, "last_activity_date": 1450220328, "creation_date": 1450217120, "last_edit_date": 1450218100, "question_id": 34300301, "link": "https://stackoverflow.com/questions/34300301/userform-entry-validation", "title": "Userform entry validation", "body": "<p>I have a userform with specific TextBoxes that I want to apply numeric rules only (no string entries).  I am having difficulties with creating an adequate error handler for this.  Essentially, because these textboxes are going to be used to perform a mathematical function, having string values causes the subs to crash and I cannot figure out the correct syntax to halt at string entries.</p>\n\n<p>My current code is:</p>\n\n<pre><code>Private Sub TextBox12_Change()\n    Sumdatup\nEnd Sub\n\nPrivate Sub TextBox16_Change()\nSumdatup\nEnd Sub\n\nPrivate Sub TextBox21_Change()\nSumdatup\nEnd Sub\n\nPrivate Sub Sumdatup()\nDim Total As Double\nTotal = 0\nIf Len(TextBox12.Value) &gt; 0 Then Total = Total + CDbl(TextBox12.Value)\nIf Len(TextBox16.Value) &gt; 0 Then Total = Total + CDbl(TextBox16.Value)\nIf Len(TextBox21.Value) &gt; 0 Then Total = Total + CDbl(TextBox21.Value)\n' Add more for the rest of your text boxes\nTextBox26.Value = Total\nEnd Sub\n</code></pre>\n\n<p>I had tried incorporating another sub to trap the string values from going through, but I continue to get an error tracing back to the first If clause in the Sumdatup program.  </p>\n\n<p>This is what I have tried that gives me errors:</p>\n\n<pre><code>Private Sub TextBox12_Change()\nNumbersOnly\nSumdatup\nEnd Sub\n\nPrivate Sub TextBox16_Change()\nNumbersOnly\nSumdatup\nEnd Sub\n\nPrivate Sub TextBox21_Change()\nNumbersOnly\nSumdatup\nEnd Sub\n\nPrivate Sub NumbersOnly()\n\nIf TypeName(Me.ActiveControl) = \"TextBox\" Then\nWith Me.ActiveControl\nIf Not IsNumeric(.Value) And .Value &lt;&gt; vbNullString Then\nMsgBox \"Only numeric values allowed.\"\n.Value = vbNullString\n\nEnd If\nEnd With\nEnd If\nEnd Sub\n\nPrivate Sub Sumdatup()\nDim Total As Double\nTotal = 0\nIf Len(TextBox12.Value) &gt; 0 Then Total = Total + CDbl(TextBox12.Value)\nIf Len(TextBox16.Value) &gt; 0 Then Total = Total + CDbl(TextBox16.Value)\nIf Len(TextBox21.Value) &gt; 0 Then Total = Total + CDbl(TextBox21.Value)\n' Add more for the rest of your text boxes\nTextBox26.Value = Total\nEnd Sub\n</code></pre>\n\n<p>The code never seems to check the NumbersOnly sub and goes straight to the Sumdatup code where it errors out when I try entering string values...</p>\n\n<p>Any thoughts on how I might go at this a different way?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 878, "user_id": 4839592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6d7b83ccb165cc0eb54b10e0ba29a7?s=128&d=identicon&r=PG&f=1", "display_name": "TMH8885", "link": "https://stackoverflow.com/users/4839592/tmh8885"}, "edited": false, "score": 0, "creation_date": 1450216923, "post_id": 34300212, "comment_id": 56342433, "body": "So just to be clear, are you asking about how to use N correctly, or how to get the value of N?"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1450217564, "post_id": 34300212, "comment_id": 56342781, "body": "<a href=\"http://stackoverflow.com/a/10717999/445425\">Useful read on using variables to reference ranges and sheets</a>"}, {"owner": {"reputation": 1, "user_id": 4235791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdf3a3adf0862cce1ce1ff5c172ad035?s=128&d=identicon&r=PG&f=1", "display_name": "Amjad", "link": "https://stackoverflow.com/users/4235791/amjad"}, "reply_to_user": {"reputation": 878, "user_id": 4839592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6d7b83ccb165cc0eb54b10e0ba29a7?s=128&d=identicon&r=PG&f=1", "display_name": "TMH8885", "link": "https://stackoverflow.com/users/4839592/tmh8885"}, "edited": false, "score": 0, "creation_date": 1450251195, "post_id": 34300212, "comment_id": 56354110, "body": "Yes this is what I mean How to use N correctly. @TMH8885"}, {"owner": {"reputation": 1, "user_id": 4235791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdf3a3adf0862cce1ce1ff5c172ad035?s=128&d=identicon&r=PG&f=1", "display_name": "Amjad", "link": "https://stackoverflow.com/users/4235791/amjad"}, "edited": false, "score": 0, "creation_date": 1450257413, "post_id": 34300212, "comment_id": 56357578, "body": "The code will generate Sheet3 Sheet4 Sheet5 and so....  So the code should be able to address the different sheets. When N=2 then it should use sheet2 When N=3 should use sheet3 and so on....  So I don&#39;t know how to link between N value and the sheet"}, {"owner": {"reputation": 1, "user_id": 4235791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdf3a3adf0862cce1ce1ff5c172ad035?s=128&d=identicon&r=PG&f=1", "display_name": "Amjad", "link": "https://stackoverflow.com/users/4235791/amjad"}, "edited": false, "score": 0, "creation_date": 1450272489, "post_id": 34300212, "comment_id": 56368151, "body": "I figure it out, I used Worksheets(N) this fixed the code  Thank you"}], "owner": {"reputation": 1, "user_id": 4235791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdf3a3adf0862cce1ce1ff5c172ad035?s=128&d=identicon&r=PG&f=1", "display_name": "Amjad", "link": "https://stackoverflow.com/users/4235791/amjad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 198, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1450472200, "creation_date": 1450216756, "last_edit_date": 1531164843, "question_id": 34300212, "link": "https://stackoverflow.com/questions/34300212/excel-how-to-reference-an-excel-sheet-index-in-vba", "title": "Excel: How to reference an excel sheet index in VBA", "body": "<p>I want to split the data from one sheet to multi sheets depending on condition.</p>\n\n<p>The code will start with two sheets \"Sheet1\" and \"Sheet2\" and then add a new sheet to the workbook and fill it with data if the condition is false.</p>\n\n<p>I am planning to use an integer variable  \"N\" to address the new sheet, it will increase each time the code creates a new sheet.</p>\n\n<p>So how to reference to the sheet with the integer Sheet(N)?</p>\n\n<pre><code>Sub Button1_Click()\nDim C, P, N As Integer\n\nC = P = 1\nnumber = 2\n\nFor C = 2 To 100\n\n    If Sheet1.Cells(C, 6) = Sheet1.Cells(C - 1, 6) Then\n        SHEET(N).Cells(P, 2) = Sheet1.Cells(C, 2)\n        Sheet(N).Cells(P, 3) = Sheet1.Cells(C, 3) ' How to reference the N here?\n        Sheet(N).Cells(P, 4) = Sheet1.Cells(C, 4)\n        Sheet(N).Cells(P, 5) = Sheet1.Cells(C, 5)\n        P=P+1\n\n    Else\n        P = 1\n        Sheets.Add , Count:=1, after:=Sheets(N)\n        Sheet(N)= Sheet(N + 1)\n        Sheet(N).Cells(P, 2) = Sheet1.Cells(C, 2)\n        Sheet(N).Cells(P, 3) = Sheet1.Cells(C, 3)\n        Sheet(N).Cells(P, 4) = Sheet1.Cells(C, 4)\n        Sheet(N).Cells(P, 5) = Sheet1.Cells(C, 5)\n    End If\nNext C\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "formula"], "answers": [{"tags": [], "owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "is_accepted": true, "score": 3, "last_activity_date": 1450215839, "creation_date": 1450215839, "answer_id": 34299970, "question_id": 34299921, "link": "https://stackoverflow.com/questions/34299921/placing-a-variable-within-an-inserted-formula/34299970#34299970", "title": "Placing a variable within an inserted formula", "body": "<p>Just replace your formula from:  </p>\n\n<pre><code>\"=INDEX(MatList!$D$13:$D$62,MATCH(A2,MatList!$A$13:$A$62,0))\"\n</code></pre>\n\n<p>To:  </p>\n\n<pre><code>\"=INDEX(MatList!$D$13:$D$62,MATCH(\" &amp; YourVariableName &amp; \",MatList!$A$13:$A$62,0))\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 17, "user_id": 4975326, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0da4616b88ae5b890b99dfeec40b9a10?s=128&d=identicon&r=PG&f=1", "display_name": "bermudamohawk", "link": "https://stackoverflow.com/users/4975326/bermudamohawk"}, "is_accepted": false, "score": 0, "last_activity_date": 1450281553, "creation_date": 1450281553, "answer_id": 34316565, "question_id": 34299921, "link": "https://stackoverflow.com/questions/34299921/placing-a-variable-within-an-inserted-formula/34316565#34316565", "title": "Placing a variable within an inserted formula", "body": "<p>thank you for that. getting closer. seems like i'm in a paradox now though the variable \"x\" has a value of 0 and 6 at the same time.\n<a href=\"http://i.stack.imgur.com/2phfN.jpg\" rel=\"nofollow\">curious</a></p>\n"}], "owner": {"reputation": 17, "user_id": 4975326, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0da4616b88ae5b890b99dfeec40b9a10?s=128&d=identicon&r=PG&f=1", "display_name": "bermudamohawk", "link": "https://stackoverflow.com/users/4975326/bermudamohawk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 34299970, "answer_count": 2, "score": 0, "last_activity_date": 1450281553, "creation_date": 1450215632, "last_edit_date": 1450215921, "question_id": 34299921, "link": "https://stackoverflow.com/questions/34299921/placing-a-variable-within-an-inserted-formula", "title": "Placing a variable within an inserted formula", "body": "<p>The loop is already in place, but I can't seem to get the syntax for replacing A2 with a correct variable.</p>\n\n<pre><code>For Each c In rng1\n    If WorksheetFunction.CountIf(rng2, c.Value) = 0 Then\n        sh3.Cells(Rows.Count, 1).End(xlUp)(2) = c.Value\n        sh3.Cells(Rows.Count, 2).End(xlUp)(2).Formula = _\n            \"=INDEX(MatList!$D$13:$D$62,MATCH(A2,MatList!$A$13:$A$62,0))\"\n    End If\nNext\n</code></pre>\n"}, {"tags": ["string", "excel", "vba", "sorting"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1450214023, "post_id": 34299475, "comment_id": 56340849, "body": "Have you tried regex?"}, {"owner": {"reputation": 1, "user_id": 5683870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/505e141a96fab5feffcebd069a1bb691?s=128&d=identicon&r=PG&f=1", "display_name": "jimf", "link": "https://stackoverflow.com/users/5683870/jimf"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1450214222, "post_id": 34299475, "comment_id": 56340958, "body": "Yes, but the only part I could figure out is: re.Pattern = &quot;GALLON|BOX|#|LF|GAL|EA|CS|BTLS&quot;"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1450214315, "post_id": 34299475, "comment_id": 56341020, "body": "You should post the actual regex. Edit: or is that what you&#39;re using? Edit2: check <a href=\"http://stackoverflow.com/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loops/22542835#22542835\">here</a>."}, {"owner": {"reputation": 1, "user_id": 5683870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/505e141a96fab5feffcebd069a1bb691?s=128&d=identicon&r=PG&f=1", "display_name": "jimf", "link": "https://stackoverflow.com/users/5683870/jimf"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1450214676, "post_id": 34299475, "comment_id": 56341216, "body": "Function NumericOnly(s As String) As String     Dim StrUnit As String     Static re As RegExp     If re Is Nothing Then Set re = New RegExp     re.IgnoreCase = True     re.Global = True     re.Pattern = &quot;GALLON|BOX|#|LF|GAL|EA|CS|BTLS&quot;     StrUnit = re.Replace(s, &quot;&quot;) End Function"}, {"owner": {"reputation": 1, "user_id": 5683870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/505e141a96fab5feffcebd069a1bb691?s=128&d=identicon&r=PG&f=1", "display_name": "jimf", "link": "https://stackoverflow.com/users/5683870/jimf"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1450215253, "post_id": 34299475, "comment_id": 56341541, "body": "Sorry about that...fixed it :)"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1450215359, "post_id": 34299475, "comment_id": 56341617, "body": "Did you check the link? Your regex won&#39;t work..."}, {"owner": {"reputation": 1, "user_id": 5683870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/505e141a96fab5feffcebd069a1bb691?s=128&d=identicon&r=PG&f=1", "display_name": "jimf", "link": "https://stackoverflow.com/users/5683870/jimf"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1450215530, "post_id": 34299475, "comment_id": 56341729, "body": "I have actually never used regex before. Originally, I was trying to go through every line character by character using an IF statement:  &#39;If (IsNumeric(Mid(PhraseArr(0), Current_Pos, 1))) = True Then&#39;  But there is too much variation in the text to get this to work well, and it is super slow which doesn&#39;t help."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1450215736, "post_id": 34299475, "comment_id": 56341822, "body": "Neither have I XD It&#39;s tedious. The link is pretty comprehensive."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1450215917, "post_id": 34299475, "comment_id": 56341903, "body": "Does <code>Text to Columns</code> not do the trick? You could iterate and run it three times, or however many to split things. ...if you want to avoid RegEx I suppose."}, {"owner": {"reputation": 1, "user_id": 5683870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/505e141a96fab5feffcebd069a1bb691?s=128&d=identicon&r=PG&f=1", "display_name": "jimf", "link": "https://stackoverflow.com/users/5683870/jimf"}, "edited": false, "score": 0, "creation_date": 1450216351, "post_id": 34299475, "comment_id": 56342103, "body": "I don&#39;t have a problem using RegEx, just never used it before. Not sure how text to columns would help in this case. There isn&#39;t just one thing you could delimite upon to pull out the required information from the string."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1450216455, "post_id": 34299475, "comment_id": 56342140, "body": "You could start delimiting with a space, which would put everything into columns.  From there it shouldn&#39;t be too hard to run through the rest unless I&#39;m overlooking something."}, {"owner": {"reputation": 1, "user_id": 5683870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/505e141a96fab5feffcebd069a1bb691?s=128&d=identicon&r=PG&f=1", "display_name": "jimf", "link": "https://stackoverflow.com/users/5683870/jimf"}, "edited": false, "score": 0, "creation_date": 1450216715, "post_id": 34299475, "comment_id": 56342297, "body": "How would you then know the difference between 6/1GA and 6 / 5 GA?"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1450226111, "post_id": 34299475, "comment_id": 56346214, "body": "I would consider creating a few Boolean variables to separate out what a line contains and so act differently based on the Boolean combinations."}, {"owner": {"reputation": 1, "user_id": 5683870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/505e141a96fab5feffcebd069a1bb691?s=128&d=identicon&r=PG&f=1", "display_name": "jimf", "link": "https://stackoverflow.com/users/5683870/jimf"}, "edited": false, "score": 0, "creation_date": 1450226895, "post_id": 34299475, "comment_id": 56346446, "body": "Not sure what you mean...can you give an example?"}], "owner": {"reputation": 1, "user_id": 5683870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/505e141a96fab5feffcebd069a1bb691?s=128&d=identicon&r=PG&f=1", "display_name": "jimf", "link": "https://stackoverflow.com/users/5683870/jimf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1450237388, "creation_date": 1450213919, "last_edit_date": 1450237388, "question_id": 34299475, "link": "https://stackoverflow.com/questions/34299475/separate-complex-text-from-number-patterns-from-a-single-string", "title": "Separate complex text from number patterns from a single string", "body": "<p>I have a text file that looks something like this (but with hundreds of lines):</p>\n\n<pre><code>1147-1 SYRUP: DR.PEPPER 5GALLON/BOX\n1653-1 SYRUP: DIET DR.PEPPER 5GAL/BOX\n2011-2 WATER DISTILLED 6 / 1 GA\n1217-2 ALL PURPOSE RASPBERRY FIL 40#\n1273-1 STRAWBERRY PIE FILLING 38#\n2893-1 BREAD: SOURDOUGH 12/1# OVAL\n2287-1 BREAD SQUAW: 8/2.25#LF\n1929-1 VINEGAR HERB CONT GRDN 12/12.7\n1949-2 KETCHUP: 16/14OZ-PLASTIC BTLS\n2408-1 CONE 3 NAB SAMPLER 28/45\n2939-1 DULCE LECH FLVR PKT 3/12 EA CS\n3017-1 GINGRBRD FLVR PKT 3/12 EA CS\n3055-2 EGGNOG FLVR PKT 3/12 EA CS\n3192-1 ORIGINAL MRS. DASH SEASONING\n</code></pre>\n\n<p>I've created the code to pull everything in from the text file line by line and strip out the numbers at the beginning and save the next portion (ie <code>SYRUP: DR.PEPPER 5GALLON/BOX</code>, <code>ALL PURPOSE RASPBERRY FIL 40#</code>) to <code>Mid(nextLine, 10, 30)</code>. I want to take that portion and split it up by pulling the name (<code>SYRUP: DR.PEPPER</code>, <code>ALL PURPOSE RASPBERRY FIL</code>), the size (<code>5GALLON</code>, <code>40#</code>) the number of that size (if it is <code>12/1#</code> = <code>12x 1LB</code>) and the unit (<code>BOX</code>, <code>LB</code>) out. As you can see almost every line is different but with many similarities. Not really sure what to do next. I have been trying to use:  </p>\n\n<pre><code>re.Pattern = \"GALLON|BOX|#|LF|GAL|EA|CS|BTLS\"  \n</code></pre>\n\n<p>to pull out the unit portion but I don't know what else to do.</p>\n\n<p>Here is the code I have so far for this portion:</p>\n\n<pre><code> Function NumericOnly(s As String) As String\n Dim StrUnit As String\n Static re As RegExp\n If re Is Nothing Then Set re = New RegExp\n re.IgnoreCase = True\n re.Global = True\n re.Pattern = \"GALLON|BOX|#|LF|GAL|EA|CS|BTLS\"\n StrUnit = re.Replace(s, \"\")\n End Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 1, "creation_date": 1450214087, "post_id": 34299364, "comment_id": 56340880, "body": "Why don&#39;t you try <a href=\"http://www.excel-easy.com/vba/userform.html\" rel=\"nofollow noreferrer\"><b>UserForm</b></a> instead of simple inputbox. This way you can do what you want to do."}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1450214425, "post_id": 34299364, "comment_id": 56341092, "body": "Yes, a userform is more flexible and will help you achieve your desired custom layout."}], "answers": [{"tags": [], "owner": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "is_accepted": false, "score": -1, "last_activity_date": 1450215649, "creation_date": 1450215649, "answer_id": 34299929, "question_id": 34299364, "link": "https://stackoverflow.com/questions/34299364/vba-script-to-parse-a-multiline-input-from-user/34299929#34299929", "title": "VBA script to parse a multiline input from user", "body": "<p><code>Application.WorksheetFunction.Find</code> will return a <code>1004</code> error when the target is not found in search text. Take a look at what your input box is receiving into <code>clientInfo</code>. I would bet you that it's not including the \"&lt;\" when the link is pasted.</p>\n\n<p>As for your other questions:</p>\n\n<p>The way I'd find the first available cell in column B is:</p>\n\n<pre><code>Do Until Sheets(\"Sheet1\").Cells(i,2).Value = \"\"\n    i = i+1\nLoop\nSet rClientTarget = Range(Cells(i,2).Address)\n</code></pre>\n\n<p>And using the macro recorder produced:\n<code>Sheets(\"Sheet1\").Hyperlinks.Add Anchor:=rClientTarget, Address:= \"http://www.stackoverflow.com\", TextToDisplay:=\"asdf\"</code></p>\n"}, {"tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": false, "score": 0, "last_activity_date": 1450245404, "creation_date": 1450245404, "answer_id": 34304881, "question_id": 34299364, "link": "https://stackoverflow.com/questions/34299364/vba-script-to-parse-a-multiline-input-from-user/34304881#34304881", "title": "VBA script to parse a multiline input from user", "body": "<p>You are looking for something like this to do an efficient <code>Find</code> - which is not the same as the Worksheet Function <code>Find</code></p>\n\n<p>This looks in column A (bottom up), for the last match on cell B7.</p>\n\n<p>If it finds a match it adds the contents of B7 to that cell in A (so you will need to tweak it a little for your purposes).</p>\n\n<pre><code>Sub UpdateMe()\nDim rng1 As Range\nIf Len([b7].Value) &gt; 0 Then\nSet rng1 = Columns(\"A:A\").Find([b7].Value, [a1], xlFormulas, xlWhole, , xlPrevious)\n    If Not rng1 Is Nothing Then\n        rng1.Value = rng1.Value &amp; \" \" &amp; [b7].Value\n    Else\n        MsgBox \"Client not find\", vbCritical\n    End If\nElse\n    MsgBox \"No value to find\", vbCritical\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 628, "user_id": 4679332, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-6A3_vIZehYw/AAAAAAAAAAI/AAAAAAAACI0/ExTSSO1w_l4/photo.jpg?sz=128", "display_name": "Christopher Warrington", "link": "https://stackoverflow.com/users/4679332/christopher-warrington"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 922, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1450245404, "creation_date": 1450213508, "last_edit_date": 1531161705, "question_id": 34299364, "link": "https://stackoverflow.com/questions/34299364/vba-script-to-parse-a-multiline-input-from-user", "title": "VBA script to parse a multiline input from user", "body": "<p>I am writing a VBA script for an Excel document. Here is what I am wanting to happen.</p>\n\n<ol>\n<li>The user clicks on a button to Add a new Client to a list. </li>\n<li>A popup instructs the user to copy a link in another program and paste it in the text field provided. </li>\n<li>The Client's name is added to the bottom of the list and the name is a hyperlink to the client's online profile.</li>\n</ol>\n\n<p><strong>Needed Information</strong></p>\n\n<p>The link that is copied from the other program is automatically formatted like so: </p>\n\n<p><code>FirstName LastName\n&lt;link_to_client_in_program&gt;</code></p>\n\n<p>So the link prints out the Client's first name then last, then on the next line prints out a hyperlink to the client's online profile nested within the carrot brackets. </p>\n\n<p>I have the working code up to this point of where the User gets prompted to add the link, though the text field where the user can paste the link does not show multiple lines, so it only shows the Client's first and last name.</p>\n\n<p><strong>What I Need Help On</strong></p>\n\n<ul>\n<li>Show the Client's Name and the link after the user pastes it into the\ninput box. </li>\n<li>Upon the user clicking \"OK\", the script should parse the inputted text to capture the first name and last name as a variable, and the link to the online profile as a separate variable.</li>\n<li>Then I would like to look through the table on the sheet to find the line following the last added Client and add the Client's name in that cell and make that name a hyperlink to the online profile. </li>\n</ul>\n\n<p><strong>My Current Code</strong></p>\n\n<pre><code>Sub addClient()\n   Dim clientInfo As String\n   Dim clientName As String\n   Dim clientURL As String\n\n   clientInfo= InputBox(\"Click on the 'Copy a Link' in CRM for the Client and paste in the field below.\", \"Client Information\")\n   clientName  = Left(clientInfo, Application.WorksheetFunction.Find(\"&lt;\", clientInfo) - 1)\n   clientURL  = Right(clientInfo, Application.WorksheetFunction.Find(\"&lt;\", clientInfo) - 1)\n   Range(\"B7\").Value = clientName \nEnd Sub\n</code></pre>\n\n<p><strong>Errors</strong></p>\n\n<p>When I run the script and click the button the popup happens and I paste the link into the text box provided. When I click \"OK\" I get an error that says, \"Run-time error '1004': Unable to get the Find property of the WorksheetFunction class\".</p>\n\n<p><strong>How To</strong></p>\n\n<ul>\n<li>How do I search through the table and get the next cell in the column 'B' that does not have a Client's data?</li>\n<li>How do I fix this parsing problem?</li>\n<li>How do I paste the data in the correct cell and make it a hyperlink to the Client's URL?</li>\n</ul>\n"}, {"tags": ["excel", "excel-2007", "vba"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1450213073, "post_id": 34299064, "comment_id": 56340311, "body": "Worked for me on 2013."}, {"owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1450213337, "post_id": 34299064, "comment_id": 56340464, "body": "Does it matter which cell is active when this is run?"}], "answers": [{"tags": [], "owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "is_accepted": true, "score": 2, "last_activity_date": 1450975846, "creation_date": 1450975846, "answer_id": 34455735, "question_id": 34299064, "link": "https://stackoverflow.com/questions/34299064/macro-to-freeze-panes-top-row-not-working/34455735#34455735", "title": "Macro to Freeze Panes (Top Row) Not Working", "body": "<p>I found this code works perfectly:</p>\n\n<pre><code>Sub Freeze_Top_Panes()\n   Application.ScreenUpdating = False\n\n   Rows(\"2:2\").Select\n   ActiveWindow.FreezePanes = True\n\n   Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>To achieve this for all sheets in your workbook, try this:</p>\n\n<pre><code>Sub Freeze_All()\nDim Ws As Worksheet\nApplication.ScreenUpdating = False\nFor Each Ws In Application.ActiveWorkbook.Worksheets\n    Ws.Activate\n    With Application.ActiveWindow\n        .FreezePanes = True\n    End With\nNext\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Ii am not sure if this only affects Excel 2007 (as I have not tested it on other versions yet), but it appears that you must turn off screen updating for the freeze panes function to work with VBA. Not sure as to why that is.</p>\n"}], "owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3128, "favorite_count": 1, "accepted_answer_id": 34455735, "answer_count": 1, "score": 0, "last_activity_date": 1450975846, "creation_date": 1450212357, "last_edit_date": 1531164843, "question_id": 34299064, "link": "https://stackoverflow.com/questions/34299064/macro-to-freeze-panes-top-row-not-working", "title": "Macro to Freeze Panes (Top Row) Not Working", "body": "<p>I recorded a macro to freeze panes, but it is not working as intended. It freezes at the 2nd row and makes the top row hidden. Help. I am using Excel 2007. The code is below:</p>\n\n<p>' Freeze Pains - Top Row</p>\n\n<pre><code>With ActiveWindow\n    .SplitColumn = 0\n    .SplitRow = 1\nEnd With\nActiveWindow.FreezePanes = True\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1450211993, "post_id": 34298924, "comment_id": 56339702, "body": "What&#39;s wrong with the second one exactly? It does what you want?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1450212080, "post_id": 34298924, "comment_id": 56339753, "body": "@findwindow - he needs to add the <code>ws.</code> before each <code>Range()</code>, otherwise it just runs on the active sheet."}], "answers": [{"comments": [{"owner": {"reputation": 441, "user_id": 5399207, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ec68ecdefa2edf36d518e679b1f2a95d?s=128&d=identicon&r=PG&f=1", "display_name": "Daruki", "link": "https://stackoverflow.com/users/5399207/daruki"}, "edited": false, "score": 0, "creation_date": 1450212528, "post_id": 34298989, "comment_id": 56340001, "body": "@BruceWayne, unfortunately the code doesn&#39;t do what I want it to. the first code <code>subname()</code> doesn&#39;t do anything, while the second one <code>worksheetloop</code> only executes my code when the worksheet name matches exactly with the text string I entered in the code - i.e. when the worksheet name is danger, only then it will execute, it won&#39;t execute when the worksheet name is danger man"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 441, "user_id": 5399207, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ec68ecdefa2edf36d518e679b1f2a95d?s=128&d=identicon&r=PG&f=1", "display_name": "Daruki", "link": "https://stackoverflow.com/users/5399207/daruki"}, "edited": false, "score": 0, "creation_date": 1450212588, "post_id": 34298989, "comment_id": 56340042, "body": "@Daruki - Are you aware that this will only change sheet names that are <code>danger</code>, lowercase, without anything else? Are you trying to run this on <code>dangerMouse</code>, <code>dangerDoom</code>, <code>danger Man</code> sheet type names?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 441, "user_id": 5399207, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ec68ecdefa2edf36d518e679b1f2a95d?s=128&d=identicon&r=PG&f=1", "display_name": "Daruki", "link": "https://stackoverflow.com/users/5399207/daruki"}, "edited": false, "score": 0, "creation_date": 1450212931, "post_id": 34298989, "comment_id": 56340237, "body": "@Daruki - See my edit regarding the sheet names. Does that help?"}, {"owner": {"reputation": 441, "user_id": 5399207, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ec68ecdefa2edf36d518e679b1f2a95d?s=128&d=identicon&r=PG&f=1", "display_name": "Daruki", "link": "https://stackoverflow.com/users/5399207/daruki"}, "edited": false, "score": 1, "creation_date": 1450213139, "post_id": 34298989, "comment_id": 56340344, "body": "@BruceWayne, I tried both of your code edits but none could work. Basically, i wanted my code to execute whenever a sheet name had &quot;danger&quot; in it - <code>dangermouse</code>, <code>danger man</code>, <code>123 me danger</code>, etc.."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 5, "last_activity_date": 1450212909, "last_edit_date": 1450212909, "creation_date": 1450212056, "answer_id": 34298989, "question_id": 34298924, "link": "https://stackoverflow.com/questions/34298924/loop-through-worksheets-with-a-specific-name/34298989#34298989", "title": "Loop through worksheets with a specific name", "body": "<p>I'm pretty sure you just need to add in explicitly which worksheets you're using.</p>\n\n<pre><code>Public Sub SubName()\nDim ws As Worksheet\n\nFor Each ws In ActiveWorkbook.Worksheets\n    If ws.Name Like \"danger\" Then\n      ' *Also tried this version: If ws.Name Like \"danger\" = True Then*\n        ws.Range(\"A1\").Interior.ColorIndex = 37\n    End If\nNext ws\n\nEnd Sub\n\nSub WorksheetLoop()\n\nDim ws  As Worksheet\n\nFor Each ws In ActiveWorkbook.Worksheets\n    If InStr(\"danger\", ws.Name) &gt; 0 Then\n        ws.Range(\"A1\").Interior.ColorIndex = 37\n    End If\nNext ws\n\nEnd Sub\n</code></pre>\n\n<p>It's a simple fix (all I did was add <code>ws.</code> before each <code>Range()</code>), but <strong>very important</strong> when working with multiple sheets.  Always be explicit when using multiple ranges. If you were using <code>Cells()</code>, <code>Row()</code>,<code>Column()</code>, etc. you should add the worksheet you're using as well.</p>\n\n<p>An alternative layout is using <code>With</code> (see below for example with your <code>SubName()</code> routine):</p>\n\n<pre><code>Public Sub SubName()\nDim ws As Worksheet\n\nFor Each ws In ActiveWorkbook.Worksheets\n    With ws\n    If .Name Like \"danger\" Then\n      ' *Also tried this version: If ws.Name Like \"danger\" = True Then*\n        .Range(\"A1\").Interior.ColorIndex = 37\n      ' For illusatration, this will color the range A1:B10\n      ' .Range(.Cells(1,1),.Cells(10,2)).Interior.ColorIndex = 37\n    End If\n    End with\nNext ws\n\nEnd Sub\n</code></pre>\n\n<p>Notice that using <code>With</code> allows you to just use a \"placeholder\" <code>.</code> to refer to the <code>WS</code> (or whatever follows <code>With</code>).  See the line I added that uses <code>Range(Cells(),Cells())</code> for a good example of this.</p>\n\n<p>Edit: Using <code>If ws.Name like \"danger\" Then</code> will <em>only</em> run on sheets named <code>danger</code> (lowercase, no spaces).  If you want this to work on sheets named like <code>DangerMouse</code>, <code>DangerDoom</code>, <code>Carlos Danger</code>, then you'll need to use <code>... Like \"*danger*\" Then</code></p>\n"}, {"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1450215984, "post_id": 34299094, "comment_id": 56341927, "body": "@Daruki - This may not work exactly as you want (the first one anyways), unless you add the <code>ws.</code> before ` Range(&quot;A1&quot;)...`."}, {"owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1450218559, "post_id": 34299094, "comment_id": 56343307, "body": "Thanks @BruceWayne , But I changed the answer before your comment"}], "tags": [], "owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "is_accepted": true, "score": 2, "last_activity_date": 1450213212, "last_edit_date": 1450213212, "creation_date": 1450212474, "answer_id": 34299094, "question_id": 34298924, "link": "https://stackoverflow.com/questions/34298924/loop-through-worksheets-with-a-specific-name/34299094#34299094", "title": "Loop through worksheets with a specific name", "body": "<p>I think Your first code will work if you change this:</p>\n\n<pre><code> If ws.Name Like \"danger\" Then\n   *Also tried this version: If ws.Name Like \"danger\" = True Then*\n\n    Range(\"A1\").Interior.ColorIndex = 37\nEnd If\n</code></pre>\n\n<p>to this :</p>\n\n<pre><code>If ws.Name Like \"danger\" &amp; \"*\" Then    \n     ws.Range(\"A1\").Interior.ColorIndex = 37\nEnd If\n</code></pre>\n\n<p>and simply you can use \"danger*\".</p>\n"}, {"tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": false, "score": 1, "last_activity_date": 1450245763, "creation_date": 1450245763, "answer_id": 34304952, "question_id": 34298924, "link": "https://stackoverflow.com/questions/34298924/loop-through-worksheets-with-a-specific-name/34304952#34304952", "title": "Loop through worksheets with a specific name", "body": "<p>Or without looping</p>\n\n<pre><code>Sub GetSheets()\nDim strIn As String\nDim X, xArr\n\nstrIn = Application.InputBox(\"Search string\", \"Enter string to find\", \"*List*\", , , , , 2)\nIf strIn = \"False\" Then Exit Sub\n\nActiveWorkbook.Names.Add \"shtNames\", \"=RIGHT(GET.WORKBOOK(1),LEN(GET.WORKBOOK(1))-FIND(\"\"]\"\",GET.WORKBOOK(1)))\"\nX = Filter([index(shtNames,)], strIn, True, 1)\n\nFor Each xArr In X\nSheets(xArr).Range(\"A1\").Interior.ColorIndex = 37\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 9481391, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/b5feeba06dc4a5f4cb15c3a2f5e42b44?s=128&d=identicon&r=PG", "display_name": "Kat", "link": "https://stackoverflow.com/users/9481391/kat"}, "is_accepted": false, "score": 0, "last_activity_date": 1520880587, "last_edit_date": 1520880587, "creation_date": 1520879588, "answer_id": 49242228, "question_id": 34298924, "link": "https://stackoverflow.com/questions/34298924/loop-through-worksheets-with-a-specific-name/49242228#49242228", "title": "Loop through worksheets with a specific name", "body": "<p>Add an asterisk <code>*</code> before the <code>like</code> name. e.g. .<code>Name Like \"*danger\"</code></p>\n\n<p>Asterisk <code>*</code> is the wildcard for Excel</p>\n"}], "owner": {"reputation": 441, "user_id": 5399207, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ec68ecdefa2edf36d518e679b1f2a95d?s=128&d=identicon&r=PG&f=1", "display_name": "Daruki", "link": "https://stackoverflow.com/users/5399207/daruki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14150, "favorite_count": 0, "accepted_answer_id": 34299094, "answer_count": 4, "score": 4, "last_activity_date": 1520880587, "creation_date": 1450211800, "last_edit_date": 1450245861, "question_id": 34298924, "link": "https://stackoverflow.com/questions/34298924/loop-through-worksheets-with-a-specific-name", "title": "Loop through worksheets with a specific name", "body": "<p>Say I have 10 worksheets and 4 have very similar names: </p>\n\n<blockquote>\n  <p>1.danger tom<br>\n  2.danger man<br>\n  3.danger ten<br>\n  4.danger lan  </p>\n</blockquote>\n\n<p>I want my code to find all worksheets with the text string <em>danger</em> in its name and execute my code</p>\n\n<p>I've tried the following two instances:</p>\n\n<pre><code>Public Sub SubName()\n\nDim ws As Worksheet\n\nFor Each ws In ActiveWorkbook.Worksheets\n\n    If ws.Name Like \"danger\" Then\n       *Also tried this version: If ws.Name Like \"danger\" = True Then*\n\n        Range(\"A1\").Interior.ColorIndex = 37\n    End If\n\nNext ws\n\nEnd Sub \n</code></pre>\n\n<p><em>take 2</em></p>\n\n<pre><code>Sub WorksheetLoop()\n\nDim ws  As Worksheet\n\nFor Each ws In ActiveWorkbook.Worksheets\n    If InStr(\"danger\", ws.Name) &gt; 0 Then\n        Range(\"A1\").Interior.ColorIndex = 37\n    End If\nNext ws\n\nEnd Sub\n</code></pre>\n\n<p>The first code doesn't do anything, even though there's no errors. The second code only does something if the name matches exactly with what I wrote down.</p>\n\n<p>Any help is needed.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1450208055, "post_id": 34297809, "comment_id": 56337373, "body": "As <code>Value</code> is a word used in vba, It should not be used as a variable.  This is not your problem but an observance."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1450208492, "post_id": 34297809, "comment_id": 56337643, "body": "<code>value = CDbl(Range(&quot;K&quot; &amp; i).Value) \\ CDbl(Range(&quot;M3&quot;).Value):</code> What&#39;s the <code>:</code> doing there?"}, {"owner": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "edited": false, "score": 3, "creation_date": 1450208985, "post_id": 34297809, "comment_id": 56337955, "body": "If you want to divide, use / not \\"}, {"owner": {"reputation": 21, "user_id": 3099517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22adaaac4b59097273665093ff99ba72?s=128&d=identicon&r=PG&f=1", "display_name": "fsm", "link": "https://stackoverflow.com/users/3099517/fsm"}, "edited": false, "score": 0, "creation_date": 1450209195, "post_id": 34297809, "comment_id": 56338093, "body": "Firstly, <code>:</code> is used to seperata a block, i tried another name instead of  value, but it did not work."}, {"owner": {"reputation": 21, "user_id": 3099517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22adaaac4b59097273665093ff99ba72?s=128&d=identicon&r=PG&f=1", "display_name": "fsm", "link": "https://stackoverflow.com/users/3099517/fsm"}, "edited": false, "score": 0, "creation_date": 1450209289, "post_id": 34297809, "comment_id": 56338143, "body": "Sorry, in normally use /, but I write wrong, when i write here."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1450209529, "post_id": 34297809, "comment_id": 56338303, "body": "It&#39;s confusing to have <code>:</code> with nothing following it. Implying something&#39;s there when there isn&#39;t. Anyways, division sign worked for me."}, {"owner": {"reputation": 21, "user_id": 3099517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22adaaac4b59097273665093ff99ba72?s=128&d=identicon&r=PG&f=1", "display_name": "fsm", "link": "https://stackoverflow.com/users/3099517/fsm"}, "edited": false, "score": 0, "creation_date": 1450209909, "post_id": 34297809, "comment_id": 56338528, "body": "Well, result is double?"}], "answers": [{"comments": [{"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "reply_to_user": {"reputation": 21, "user_id": 3099517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22adaaac4b59097273665093ff99ba72?s=128&d=identicon&r=PG&f=1", "display_name": "fsm", "link": "https://stackoverflow.com/users/3099517/fsm"}, "edited": false, "score": 0, "creation_date": 1450210345, "post_id": 34298378, "comment_id": 56338779, "body": "Are you using Excel or Visual Studio 1015, <i>read properly they are different</i>."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1450210424, "post_id": 34298378, "comment_id": 56338814, "body": "I was wondering why i was getting the correct answer when using 700\\100 but 0 when 7\\100.  Thanks for the explanation."}, {"owner": {"reputation": 21, "user_id": 3099517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22adaaac4b59097273665093ff99ba72?s=128&d=identicon&r=PG&f=1", "display_name": "fsm", "link": "https://stackoverflow.com/users/3099517/fsm"}, "edited": false, "score": 0, "creation_date": 1450210451, "post_id": 34298378, "comment_id": 56338829, "body": "using excel, what is the different?"}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1450210521, "post_id": 34298378, "comment_id": 56338862, "body": "Exactly that you are <i>using Excel</i> no <i>Visual Studio 2015</i>"}], "tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": true, "score": 2, "last_activity_date": 1450209881, "creation_date": 1450209881, "answer_id": 34298378, "question_id": 34297809, "link": "https://stackoverflow.com/questions/34297809/excel-vba-int-conver-to-double-failed/34298378#34298378", "title": "Excel vba int conver to double failed", "body": "<p>Although Op mentioned:</p>\n\n<blockquote>\n  <p>Sorry, in normally use /, but I write wrong, when i write here</p>\n</blockquote>\n\n<p>That seems to be the reason of the problem see <a href=\"https://msdn.microsoft.com/EN-US/library/office/gg264594.aspx\" rel=\"nofollow\">\\ Operator</a></p>\n\n<p>Replace <code>\\</code> with <code>/</code></p>\n"}], "owner": {"reputation": 21, "user_id": 3099517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22adaaac4b59097273665093ff99ba72?s=128&d=identicon&r=PG&f=1", "display_name": "fsm", "link": "https://stackoverflow.com/users/3099517/fsm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 34298378, "answer_count": 1, "score": 1, "last_activity_date": 1450210847, "creation_date": 1450207921, "last_edit_date": 1450210847, "question_id": 34297809, "link": "https://stackoverflow.com/questions/34297809/excel-vba-int-conver-to-double-failed", "title": "Excel vba int conver to double failed", "body": "<p>I want to divide an integer value by a double value, and show a double value result. In the below code, the cell found in column K is an integer, and the conversion to integer fails. How can I fix this?</p>\n\n<pre><code>Dim i As Integer\nDim value As Double\nFor i = 9 To 75\n  If Range(\"K\" &amp; i) &gt; 0 Then\n    value = CDbl(Range(\"K\" &amp; i).Value) / CDbl(Range(\"M3\").Value):\n    Range(\"E\" &amp; i).Value = value \nElse\n    Range(\"E\" &amp; i).Value = Range(\"L\" &amp; i).Value\nEnd If\nNext i\n</code></pre>\n"}, {"tags": ["sql-server", "ms-access", "vba"], "comments": [{"owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "edited": false, "score": 0, "creation_date": 1450206635, "post_id": 34297261, "comment_id": 56336472, "body": "You could run it as a pass-thru...  this way it accepts (and expects) the native DBMS SQL"}, {"owner": {"reputation": 235, "user_id": 4592859, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/83b0eda24d07ac5c129e0b52b2737fbb?s=128&d=identicon&r=PG&f=1", "display_name": "YellowLarry", "link": "https://stackoverflow.com/users/4592859/yellowlarry"}, "edited": false, "score": 0, "creation_date": 1450207897, "post_id": 34297261, "comment_id": 56337274, "body": "Set dbSQL = OpenDatabase(&quot;&quot;, False, False, &quot;Driver={SQL Server Native Client 11.0};&quot; &amp; _  &quot;Server=MY-PC\\SQLEXPRESS; Database=DB1; Trusted_Connection=yes;&quot;)"}, {"owner": {"reputation": 235, "user_id": 4592859, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/83b0eda24d07ac5c129e0b52b2737fbb?s=128&d=identicon&r=PG&f=1", "display_name": "YellowLarry", "link": "https://stackoverflow.com/users/4592859/yellowlarry"}, "edited": false, "score": 0, "creation_date": 1450208772, "post_id": 34297261, "comment_id": 56337819, "body": "Thank you Hambone,  yes pass-through works."}], "answers": [{"tags": [], "owner": {"reputation": 235, "user_id": 4592859, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/83b0eda24d07ac5c129e0b52b2737fbb?s=128&d=identicon&r=PG&f=1", "display_name": "YellowLarry", "link": "https://stackoverflow.com/users/4592859/yellowlarry"}, "is_accepted": false, "score": 0, "last_activity_date": 1450209057, "creation_date": 1450209057, "answer_id": 34298152, "question_id": 34297261, "link": "https://stackoverflow.com/questions/34297261/update-sql-by-dao-in-sql-server/34298152#34298152", "title": "UPDATE SQL by DAO in SQL Server", "body": "<p>Works with pass-through.  semicolon is not required.</p>\n\n<pre><code>DBSQL.Execute \"UPDATE PriceGroupDetail SET Status = 'h' \" &amp; _\n     \"FROM PriceGroupDetail INNER JOIN PriceGroup \" &amp; _\n     \"ON PriceGroupDetail.[_FID_Group] = PriceGroup.[_ID] \" &amp; _\n     \"WHERE PriceGroup.[Group] = 'Dealer'\", dbSQLPassThrough\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 1, "last_activity_date": 1450220585, "creation_date": 1450220585, "answer_id": 34301111, "question_id": 34297261, "link": "https://stackoverflow.com/questions/34297261/update-sql-by-dao-in-sql-server/34301111#34301111", "title": "UPDATE SQL by DAO in SQL Server", "body": "<p>For reference, in Access SQL there is no UPDATE ... FROM ...</p>\n\n<p>Correct syntax would be:</p>\n\n<pre><code>UPDATE PriceGroupDetail INNER JOIN PriceGroup\n    ON PriceGroupDetail.[_FID_Group] = PriceGroup.[_ID]\nSET PriceGroupDetail.Status = 'h'\nWHERE PriceGroup.[Group] = 'Dealer'\n</code></pre>\n"}], "owner": {"reputation": 235, "user_id": 4592859, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/83b0eda24d07ac5c129e0b52b2737fbb?s=128&d=identicon&r=PG&f=1", "display_name": "YellowLarry", "link": "https://stackoverflow.com/users/4592859/yellowlarry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 399, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1450220585, "creation_date": 1450205887, "question_id": 34297261, "link": "https://stackoverflow.com/questions/34297261/update-sql-by-dao-in-sql-server", "title": "UPDATE SQL by DAO in SQL Server", "body": "<p>The query below works in SQL server</p>\n\n<pre><code>UPDATE PriceGroupDetail SET Status = 'h'\nFROM PriceGroupDetail INNER JOIN PriceGroup\nON PriceGroupDetail.[_FID_Group] = PriceGroup.[_ID]\nWHERE PriceGroup.[Group] = 'Dealer'\n</code></pre>\n\n<p>But, I run it in Access 2013 VBA code.  error message is \"Syntax error(missing operator) in query expression\".  The DBSQL is project global variable and connects to SQL server.</p>\n\n<pre><code>DBSQL.Execute \"UPDATE PriceGroupDetail SET Status = 'h' \" &amp; _\n     \"FROM PriceGroupDetail INNER JOIN PriceGroup \" &amp; _\n     \"ON PriceGroupDetail.[_FID_Group] = PriceGroup.[_ID] \" &amp; _\n     \"WHERE PriceGroup.[Group] = 'Dealer'\"\n</code></pre>\n"}, {"tags": ["vba", "excel", "activex"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1450205561, "post_id": 34297113, "comment_id": 56335866, "body": "Please show the code.  You probably have <code>.select</code> in your code that needs to be qualified."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1450205629, "post_id": 34297113, "comment_id": 56335904, "body": "Scott, then it should also fail for the other methods?"}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1450205795, "post_id": 34297113, "comment_id": 56336002, "body": "the only i can think of is showing a (non closeable) modal userform which executes the macro (so you cant click anything) and then unload itself after execution ended..."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1450206225, "post_id": 34297113, "comment_id": 56336240, "body": "Don&#39;t make us guess - need to see the code in question"}, {"owner": {"reputation": 23, "user_id": 4798260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2643162c11f1a4f4169f0b6afca4da2a?s=128&d=identicon&r=PG&f=1", "display_name": "UserError", "link": "https://stackoverflow.com/users/4798260/usererror"}, "edited": false, "score": 0, "creation_date": 1450206641, "post_id": 34297113, "comment_id": 56336478, "body": "Making you guess was not my intent.  I wasn&#39;t intending to make anyone guess.  I thought that perhaps the answer to my question would be obvious to someone."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1450206742, "post_id": 34297113, "comment_id": 56336555, "body": "Scott&#39;s right. <code>Range(diagonal_vector, Cells(1000, 1000)).Clear</code> But then why didn&#39;t it fail for the other methods?"}, {"owner": {"reputation": 23, "user_id": 4798260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2643162c11f1a4f4169f0b6afca4da2a?s=128&d=identicon&r=PG&f=1", "display_name": "UserError", "link": "https://stackoverflow.com/users/4798260/usererror"}, "edited": false, "score": 0, "creation_date": 1450207067, "post_id": 34297113, "comment_id": 56336737, "body": "Maybe what I should be saying is that the macro ALWAYS works as intended... It copies the results from the &#39;vector_out&#39; range to an offset column repeatedly.  The issue is that the results in the &#39;vector_out&#39; range are inconsistent if I happen to click inside the Excel window somewhere while running."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1450207350, "post_id": 34297113, "comment_id": 56336923, "body": "How do I articulate this better... if the results are inconsistent for activex button, it should be same for form button. Edit: anyways, the only thing unqualified is the <code>cells</code> so not sure why."}, {"owner": {"reputation": 23, "user_id": 4798260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2643162c11f1a4f4169f0b6afca4da2a?s=128&d=identicon&r=PG&f=1", "display_name": "UserError", "link": "https://stackoverflow.com/users/4798260/usererror"}, "edited": false, "score": 0, "creation_date": 1450207879, "post_id": 34297113, "comment_id": 56337259, "body": "The results I&#39;m seeing contradict what you&#39;re saying.  The only real difference I see is that for the form button, I can connect it directly to the run_loop sub.  For the ActiveX button, it calls a command contained in the sheet object containing the button, which then calls the run_loop sub."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1450207954, "post_id": 34297113, "comment_id": 56337316, "body": "ActiveX button has a <code>TakeFocusOnClick</code> property whose default value is <code>True</code>.  I recall that sometimes being a problem, so you could try setting it to <code>False</code>.  Is there any event handler code running for the sheet?"}, {"owner": {"reputation": 23, "user_id": 4798260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2643162c11f1a4f4169f0b6afca4da2a?s=128&d=identicon&r=PG&f=1", "display_name": "UserError", "link": "https://stackoverflow.com/users/4798260/usererror"}, "edited": false, "score": 0, "creation_date": 1450208358, "post_id": 34297113, "comment_id": 56337561, "body": "I added the code for the sheet."}], "answers": [{"tags": [], "owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "is_accepted": false, "score": 0, "last_activity_date": 1450213864, "last_edit_date": 1450213864, "creation_date": 1450211594, "answer_id": 34298873, "question_id": 34297113, "link": "https://stackoverflow.com/questions/34297113/is-user-interaction-allowed-when-running-a-vba-subroutine-via-an-activex-control/34298873#34298873", "title": "Is user interaction allowed when running a VBA subroutine via an ActiveX control button?", "body": "<p>I am not sure, but try to replace your line:</p>\n\n<pre><code>Range(diagonal_vector, Cells(1000, 1000)).Clear \n</code></pre>\n\n<p>with this line:</p>\n\n<pre><code>Range(diagonal_vector, ThisWorkbook.Sheets(FINALSHEET).Cells(1000, 1000)).Clear\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 4798260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2643162c11f1a4f4169f0b6afca4da2a?s=128&d=identicon&r=PG&f=1", "display_name": "UserError", "link": "https://stackoverflow.com/users/4798260/usererror"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 123, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1450283240, "creation_date": 1450205463, "last_edit_date": 1450283240, "question_id": 34297113, "link": "https://stackoverflow.com/questions/34297113/is-user-interaction-allowed-when-running-a-vba-subroutine-via-an-activex-control", "title": "Is user interaction allowed when running a VBA subroutine via an ActiveX control button?", "body": "<p>I have a subroutine that executes as intended when run from the macro window (ALT+F8).  I can also link a Form button to this sub and it continues to work properly.  </p>\n\n<p>Now, when I hook up an ActiveX control button to the sub, click the button, and make sure not to click anything else, the macro executes as intended again.  However, if I click anywhere on the screen while the macro is running, my results come out different than expected.  It seems like user interaction is somehow enabled when running from an ActiveX button.  Even so, why would clicking around the screen alter anything?</p>\n\n<p>Obviously, I could just make sure I don't touch anything while it is executing, or simply use a form button, or just always run the macro from the macro window... but I'd like to understand why it behaves this way.</p>\n\n<pre><code>Option Explicit\n\nSub run_loop()\n\nConst FINALSHEET As String = \"Final UV's\"\nConst VARYYEAR As String = \"G6\"\nConst STARTYEAR As String = \"H1\"\nConst ENDYEAR As String = \"H2\"\nConst OUTPUTVECTOR As String = \"G6:G46\"\nConst DIAGONALVECTOR As String = \"H3\"\n\n' variable declarations\nDim input_year As Range\nDim vector_out As Range\nDim diagonal_vector As Range\n\nDim start_year As Integer\nDim end_year As Integer\nDim duration As Integer\n\n' variable initializations\nWith ThisWorkbook.Sheets(FINALSHEET)\n    Set input_year = .Range(VARYYEAR)\n    Set vector_out = .Range(OUTPUTVECTOR)\n    Set diagonal_vector = .Range(DIAGONALVECTOR)\n\n    start_year = .Range(STARTYEAR).Value\n    end_year = .Range(ENDYEAR).Value\nEnd With\n\n' clear any prior results\nRange(diagonal_vector, Cells(1000, 1000)).Clear\n\n' set initial issue year (loop decrements by 1 immediately so set to 1 higher than initial)\ninput_year.Value = start_year + 1\n\n' main loop\nDo While input_year.Value &gt; end_year   ' ensure that the issue year hasn't gone past the specified end year\n\n    ' decrement the issue year by 1 (sheet auto recalculates at this point)\n    input_year.Value = input_year.Value - 1\n\n    ' recalculate duration\n    duration = start_year - input_year.Value + 1\n\n    ' copy the resulting vector of UV factors for current issue year to the appropriate column\n    vector_out.Offset(0, duration).Value = vector_out.Value\n\n    ' copy diagonal values to a single vector of current year unit values by duration\n    diagonal_vector.Offset(0, duration - 1).Value = vector_out(duration + 1, 1)\nLoop\nEnd Sub\n</code></pre>\n\n<p>The code for the ActiveX control button lives in the code for the sheet that contains it and simply calls run_loop.</p>\n\n<pre><code>Private Sub RunToggle_Click()\n\nrun_loop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "vba", "csv"], "comments": [{"owner": {"reputation": 4595, "user_id": 314507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f35fa938f2b64b7620be0181281f2ae1?s=128&d=identicon&r=PG", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/314507/jeremy"}, "edited": false, "score": 0, "creation_date": 1450205942, "post_id": 34297102, "comment_id": 56336092, "body": "can you be more specific as to what is happening? are you getting an error? When you step through the code (and you HAVE stepped through the code, right?) what path is executing that you don&#39;t expect. If the files are too big for you to test with, create a sample file with 2 or 3 lines with the conditions you are checking for and ensure it works with the small file, and step through your code line by line."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1450206395, "post_id": 34297102, "comment_id": 56336337, "body": "Is <code>a()</code> a 1-based 1-dimensional array?"}], "owner": {"reputation": 193, "user_id": 4314348, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/700448e67b75d812d1dee863153e132d?s=128&d=identicon&r=PG&f=1", "display_name": "alcor8", "link": "https://stackoverflow.com/users/4314348/alcor8"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1450205637, "creation_date": 1450205392, "last_edit_date": 1450205637, "question_id": 34297102, "link": "https://stackoverflow.com/questions/34297102/updating-a-csv-parsing-script", "title": "Updating a CSV parsing script", "body": "<p>I'm trying to modify a parsing script to exclude a record in the first field that does not have a value but I want the script to finish the file.</p>\n\n<pre><code>lastRO = \"\"\nFirstLine = True\nFacilityCode = Left(InputFile, InStr(InputFile,\"_\")-1)\n\nDo Until EOF\n    a = CSVParser(ExtractLine(0))\n\nIf a(1) &lt;&gt; lastRO Then\n    If FirstLine Then\n        FirstLine = False\n    Else\n        WriteFields()\n\n    End If\n    lastRO = a(1)\n    Field(\"Department\") = \"\"\n    Field(\"RepairOrder\") = FacilityCode &amp; a(1)\nEnd If\nDim xReg\nSet xReg = new  RegExp\nFor i = 0 to Ubound(RepairOrderDepartmentExpressions)\n    xReg.Pattern = RepairOrderDepartmentExpressions(i)\n    If xReg.Test(a(RepairOrderDepartmentField(i))) Then\n        If Field(\"Department\") = \"\" Or Field(\"Department\") = RepairOrderDepartmentKey(i) Then\n            Field(\"Department\") = RepairOrderDepartmentKey(i)\n        Else\n            Field(\"Department\") = RepairOrderSharedDepartment\n        End if\n        Exit For\n    End if\nNext\nSkip\nLoop\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1450205216, "post_id": 34297028, "comment_id": 56335685, "body": "Seems you qualified sheet for <code>tbl</code> but you want to do that for workbook as well. (+1 for ridding of <code>select</code>)."}, {"owner": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "edited": false, "score": 2, "creation_date": 1450206698, "post_id": 34297028, "comment_id": 56336517, "body": "<code>Resize</code> is an action done on a range.  An action cannot be assigned to a variable.  Just replace <code>Set seltbl = selrng.Resize(, 3)</code> with <code>selrng.Resize(, 3)</code> and it should work correctly.  (If we assume the rest of the code that has not been presented is also correct)"}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "reply_to_user": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "edited": false, "score": 1, "creation_date": 1450210493, "post_id": 34297028, "comment_id": 56338851, "body": "@Demetri to make it simple: <code>Resize</code> just does not return an object/range like <code>worksheets.copy</code> also does not (but <code>worksheets.add</code> will do)?"}, {"owner": {"reputation": 25, "user_id": 5683460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/482d76ad54763aaec1bdd9f5c786792e?s=128&d=identicon&r=PG&f=1", "display_name": "Aline", "link": "https://stackoverflow.com/users/5683460/aline"}, "reply_to_user": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1450211058, "post_id": 34297028, "comment_id": 56339189, "body": "@DirkReichel So if resize doesn&#39;t return an object what do I have to do to get it to?   Basically what I need is the used range of a workskeet, without the first 2 rows, and no blank spaces."}], "answers": [{"tags": [], "owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "is_accepted": true, "score": 0, "last_activity_date": 1450212165, "last_edit_date": 1450212165, "creation_date": 1450211643, "answer_id": 34298887, "question_id": 34297028, "link": "https://stackoverflow.com/questions/34297028/need-help-fixing-a-vba-error-1004-after-editing-a-section-of-code/34298887#34298887", "title": "Need help fixing a vba Error &#39;1004&#39; after editing a section of code", "body": "<p>one option would be:</p>\n\n<pre><code>Set tbl = shtOfErrors.UsedRange\nSet tbl = Intersect(tbl, tbl.Offset(2, 0)).Resize(, 3).SpecialCells(2, 23)\n</code></pre>\n\n<p>should do everything you want... (not tested)</p>\n\n<p>another option:</p>\n\n<pre><code>Set tbl = shtOfErrors.Range(\"$2:$2\", Rows(Rows.Count).Address).UsedRange.Resize(, 3).SpecialCells(2, 23)\n</code></pre>\n\n<p>a third option would be:</p>\n\n<pre><code>Set tbl = shtOfErrors.UsedRange.Offset(2, 0).UsedRange.Resize(, 3).SpecialCells(2, 23)\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 5683460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/482d76ad54763aaec1bdd9f5c786792e?s=128&d=identicon&r=PG&f=1", "display_name": "Aline", "link": "https://stackoverflow.com/users/5683460/aline"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 34298887, "answer_count": 1, "score": 2, "last_activity_date": 1450212165, "creation_date": 1450205144, "question_id": 34297028, "link": "https://stackoverflow.com/questions/34297028/need-help-fixing-a-vba-error-1004-after-editing-a-section-of-code", "title": "Need help fixing a vba Error &#39;1004&#39; after editing a section of code", "body": "<p>Some background, I've written a piece of code that cycles through all workbooks in a directory and executes a function, and that function also executes another function. Both functions tested fine and worked without an issue until I put them into the code that goes through all workbooks.\nI had this code originally and had no problems with it: </p>\n\n<pre><code>Set tbl = shtOfErrors.UsedRange\ntbl.Offset(2, 0).SpecialCells(2, 23).Select\nSelection.Resize(, 3).Select\n</code></pre>\n\n<p>I was trying to get rid of all .select I had in the original functions, because it kept erroring when it was called as part of the workbook loop. But now I get an error 1004 application-defined or object-defined error here on line 3 :</p>\n\n<pre><code>Set tbl = shtOfErrors.UsedRange\nSet selrng = tbl.Offset(2, 0).SpecialCells(2, 23)\nSet seltbl = selrng.Resize(, 3)\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1450202529, "post_id": 34296241, "comment_id": 56334082, "body": "You didn&#39;t qualify <code>cells</code> or pass <code>i</code>."}, {"owner": {"reputation": 169, "user_id": 4418929, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/3d7ef69f1bb2cf0f5b39cb4f1ee15ee7?s=128&d=identicon&r=PG&f=1", "display_name": "siddharth taunk", "link": "https://stackoverflow.com/users/4418929/siddharth-taunk"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1450202640, "post_id": 34296241, "comment_id": 56334141, "body": "getting error here Call Internal_Array(i) it says expected sub or function or property"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1450202708, "post_id": 34296241, "comment_id": 56334201, "body": "You cannot <code>Call</code> a string. Try looking at at <code>CallByName</code>"}, {"owner": {"reputation": 169, "user_id": 4418929, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/3d7ef69f1bb2cf0f5b39cb4f1ee15ee7?s=128&d=identicon&r=PG&f=1", "display_name": "siddharth taunk", "link": "https://stackoverflow.com/users/4418929/siddharth-taunk"}, "edited": false, "score": 0, "creation_date": 1450203007, "post_id": 34296241, "comment_id": 56334380, "body": "Can you please eloberate I am very novice with vba or excel vba"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1450203072, "post_id": 34296241, "comment_id": 56334429, "body": "@findwindow - <code>i</code> will work in this instance since it&#39;s Dimensioned outside the scope of any particular procedure."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1450203136, "post_id": 34296241, "comment_id": 56334469, "body": "Good call. Didn&#39;t catch that."}, {"owner": {"reputation": 169, "user_id": 4418929, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/3d7ef69f1bb2cf0f5b39cb4f1ee15ee7?s=128&d=identicon&r=PG&f=1", "display_name": "siddharth taunk", "link": "https://stackoverflow.com/users/4418929/siddharth-taunk"}, "edited": false, "score": 0, "creation_date": 1450203427, "post_id": 34296241, "comment_id": 56334657, "body": "Can I please have a solution"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1450203799, "post_id": 34296241, "comment_id": 56334863, "body": "Did you look up what Tim said? Don&#39;t make me regret my upvote XD"}, {"owner": {"reputation": 169, "user_id": 4418929, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/3d7ef69f1bb2cf0f5b39cb4f1ee15ee7?s=128&d=identicon&r=PG&f=1", "display_name": "siddharth taunk", "link": "https://stackoverflow.com/users/4418929/siddharth-taunk"}, "edited": false, "score": 1, "creation_date": 1450204247, "post_id": 34296241, "comment_id": 56335112, "body": "okey this is how we do it Application.Run (Internal_Array(i)) in the called sub and it worked"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1450204688, "last_edit_date": 1495541747, "creation_date": 1450204688, "answer_id": 34296923, "question_id": 34296241, "link": "https://stackoverflow.com/questions/34296241/call-multiple-macro-using-array-and-function-in-excel-vba/34296923#34296923", "title": "Call multiple macro using array and function in excel vba", "body": "<p>TBBH, I really don't know what you are trying to accomplish and the heavily redacted code does nothing to show specific methods other than the attempt at calling a macro from a string derived from an array element.</p>\n\n<p>The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196165.aspx\" rel=\"nofollow noreferrer\">Application.OnTime method</a> uses a string as the name of the procedure to call. </p>\n\n<pre><code>Option Explicit\nOption Compare Text\nDim i As Integer, Ro As Integer\n\nSub zero()\n    Debug.Print \"zero: \" &amp; i\nEnd Sub\n\nSub first()\n    Debug.Print \"first: \" &amp; i\nEnd Sub\n\nSub second()\n    Debug.Print \"second: \" &amp; i\nEnd Sub\n\nSub third()\n    Debug.Print \"third: \" &amp; i\nEnd Sub\n\nPublic Sub Universal_Macro()\n    Dim Col() As Integer\n    Dim macro_Name As Variant\n\n\n    macro_Name = Array(\"zero\", \"first\", \"second\", \"third\")\n    ReDim Col(UBound(macro_Name))\n    For i = LBound(macro_Name) To UBound(macro_Name)\n        Col(i) = i\n    Next\n\n    Ro = ActiveCell.Row\n\n    For i = LBound(macro_Name) To UBound(macro_Name)\n        Call macro_Sched(Col(i), macro_Name)\n    Next\n\nEnd Sub\n\nSub macro_Sched(c As Integer, internal_Array As Variant)\n    Cells(Ro, c + 1).Select '&lt;~~Don't rely on Select! You dont' even reference a worksheet here.\n    Application.OnTime Now, internal_Array(c)\nEnd Sub\n</code></pre>\n\n<p>If parameters were to be passed to the children sub procedures, then some sort of string replacement might accommodate this but specifics on the child subs are not evident.</p>\n\n<hr>\n\n<p><sub>See <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid using Select in Excel VBA macros</a> for more methods on getting away from relying on select and activate to accomplish your goals.</sub></p>\n"}, {"tags": [], "owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "is_accepted": false, "score": 2, "last_activity_date": 1450206339, "creation_date": 1450206339, "answer_id": 34297378, "question_id": 34296241, "link": "https://stackoverflow.com/questions/34296241/call-multiple-macro-using-array-and-function-in-excel-vba/34297378#34297378", "title": "Call multiple macro using array and function in excel vba", "body": "<p>Try to use <strong>Application.Run</strong>:</p>\n\n<pre><code>Sub RunMc()\n\n Dim a(1 To 2) As String\n Dim MN As String\n\n For i = 1 To 2 'Fill the array\n  a(i) = \"m\" &amp; i\n Next\n MN = \"Module1\" 'the module name\n\n For i = LBound(a) To UBound(a)\n  Application.Run MN &amp; \".\" &amp; a(i)\n Next\n\nEnd Sub\n\nSub m1()\n Debug.Print \"m1\"\nEnd Sub\n\nSub m2()\n Debug.Print \"m2\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 169, "user_id": 4418929, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/3d7ef69f1bb2cf0f5b39cb4f1ee15ee7?s=128&d=identicon&r=PG&f=1", "display_name": "siddharth taunk", "link": "https://stackoverflow.com/users/4418929/siddharth-taunk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 865, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1450206339, "creation_date": 1450202309, "last_edit_date": 1450205030, "question_id": 34296241, "link": "https://stackoverflow.com/questions/34296241/call-multiple-macro-using-array-and-function-in-excel-vba", "title": "Call multiple macro using array and function in excel vba", "body": "<p>I am unable to call macros whose names I have stored in a String Array.</p>\n\n<p>I attach the code.</p>\n\n<pre><code>Option Explicit\nOption Compare Text\n\nDim i, Ro As Integer\n\nPublic Sub Universal_Macro()\n\nDim Col(10) As Integer\nDim macro_name(10) As String\n\nRo = ActiveCell.Row\n\ni = 1\n\nFor i = 1 To 10\n    Call Mac_Sched(Col(), macro_name())\nNext\n\nEnd Sub\n\nSub Mac_Sched(Col() As Integer, Internal_Array() As String)\n    Cells(Ro, Col(i)).Select\n    Call Internal_Array(i)\nEnd Sub\n</code></pre>\n\n<p>Getting error in the <code>sub Mac_Sched</code>.</p>\n"}, {"tags": ["regex", "vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1450202160, "post_id": 34296076, "comment_id": 56333812, "body": "Since you&#39;re doing this with Excel VBA, what code do you have so far? Or is your question <i>how</i> to use regex with VBA?"}, {"owner": {"reputation": 72931, "user_id": 2538939, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/876f7ddaf27a16c17a62b8a9705b45f1?s=128&d=identicon&r=PG&f=1", "display_name": "Code Different", "link": "https://stackoverflow.com/users/2538939/code-different"}, "edited": false, "score": 0, "creation_date": 1450202347, "post_id": 34296076, "comment_id": 56333964, "body": "Your requirements with regards to the final character are not clear. In your first example, <code>b</code> stands alone in its capture group. In the third example, <code>h</code> is grouped with <code>6</code>. Which one is correct?"}, {"owner": {"reputation": 105, "user_id": 2062443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3530b25ebf4ee154c359eacf517f6352?s=128&d=identicon&r=PG", "display_name": "Persiden", "link": "https://stackoverflow.com/users/2062443/persiden"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1450202552, "post_id": 34296076, "comment_id": 56334098, "body": "@BruceWayne the program over 4k lines, but my question is just in regards of how to change my current regex to match the cases ive listed above."}, {"owner": {"reputation": 105, "user_id": 2062443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3530b25ebf4ee154c359eacf517f6352?s=128&d=identicon&r=PG", "display_name": "Persiden", "link": "https://stackoverflow.com/users/2062443/persiden"}, "reply_to_user": {"reputation": 72931, "user_id": 2538939, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/876f7ddaf27a16c17a62b8a9705b45f1?s=128&d=identicon&r=PG&f=1", "display_name": "Code Different", "link": "https://stackoverflow.com/users/2538939/code-different"}, "edited": false, "score": 0, "creation_date": 1450202757, "post_id": 34296076, "comment_id": 56334227, "body": "@JustAnotherCoder both are correct if you look at the first example it has (1-122010408174)  but in the last example it has (6h-122010408174) if there is a letter grouped with the number before the - then it should also be grouped at the end but if not it is used for something else so it should be separated in the case of (b)"}, {"owner": {"reputation": 200330, "user_id": 2680216, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K877D.png?s=128&g=1", "display_name": "Josh Crozier", "link": "https://stackoverflow.com/users/2680216/josh-crozier"}, "edited": false, "score": 0, "creation_date": 1450203619, "post_id": 34296076, "comment_id": 56334765, "body": "@Persiden Are you trying to get something similar to this? <a href=\"https://regex101.com/r/mO3eE6/1\" rel=\"nofollow noreferrer\">regex101.com/r/mO3eE6/1</a> - <code>(\\d*)(\\D*(\\d[a-z]*)-\\d*)(\\3)([a-z])?</code>"}, {"owner": {"reputation": 23021, "user_id": 898478, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/EhSlm.jpg?s=128&g=1", "display_name": "m0skit0", "link": "https://stackoverflow.com/users/898478/m0skit0"}, "edited": false, "score": 0, "creation_date": 1450203668, "post_id": 34296076, "comment_id": 56334793, "body": "<i>&quot;any number for numbers followed by the same number&quot;</i> I don&#39;t fully understand what you mean by this. Can you show an example for this part only?"}, {"owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "edited": false, "score": 2, "creation_date": 1450203925, "post_id": 34296076, "comment_id": 56334939, "body": "you say that the first part is a number &quot;from 0-1million&quot;, but then in the second example, the number is 19,212,321, which is larger than 1 million. The other parts of your description are equally imprecise. Can you clean up your description to be more specific and provide a couple more examples?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1450204304, "post_id": 34296076, "comment_id": 56335148, "body": "So your question is about RegEx, not necessarily Excel/VBA at all? You&#39;re just looking for the right pattern to use?"}, {"owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1450204421, "post_id": 34296076, "comment_id": 56335218, "body": "@BruceWayne it&#39;s still relatively valid to know that it&#39;s the RegExp class imported from VBScript, since it is a particularly limited flavor."}, {"owner": {"reputation": 105, "user_id": 2062443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3530b25ebf4ee154c359eacf517f6352?s=128&d=identicon&r=PG", "display_name": "Persiden", "link": "https://stackoverflow.com/users/2062443/persiden"}, "reply_to_user": {"reputation": 200330, "user_id": 2680216, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K877D.png?s=128&g=1", "display_name": "Josh Crozier", "link": "https://stackoverflow.com/users/2680216/josh-crozier"}, "edited": false, "score": 1, "creation_date": 1450204665, "post_id": 34296076, "comment_id": 56335360, "body": "To better clarify my question the regex should match (one to infinite)(A number, Zero or one Letter, there character &#39;-&#39;  ,one to infinite numbers)(the same patter before &#39;-&#39;)(zero or one letter)  , but it seems @JoshCrozier has done exactly what I needed this will work nicely, I had no idea you could reference previous matches."}], "answers": [{"comments": [{"owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "edited": false, "score": 0, "creation_date": 1450208178, "post_id": 34296338, "comment_id": 56337447, "body": "Nice trick with nested capture groups! Is the <code>\\D*</code> necessary? It doesn&#39;t appear to be part of the OP&#39;s requirements in his comment."}], "tags": [], "owner": {"reputation": 200330, "user_id": 2680216, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K877D.png?s=128&g=1", "display_name": "Josh Crozier", "link": "https://stackoverflow.com/users/2680216/josh-crozier"}, "is_accepted": true, "score": 4, "last_activity_date": 1450210176, "last_edit_date": 1450210176, "creation_date": 1450202579, "answer_id": 34296338, "question_id": 34296076, "link": "https://stackoverflow.com/questions/34296076/regular-expressions-matching-difficulty/34296338#34296338", "title": "Regular Expressions matching difficulty", "body": "<p>You could capture the character(s) before the dash character, and then back reference that match.</p>\n\n<p>In the expression below, <code>\\3</code> would match what was matched by the 3rd capturing group:</p>\n\n<pre><code>(\\d*)((\\d[a-z]*)-\\d*)(\\3)([a-z])?\n</code></pre>\n\n<p><a href=\"https://regex101.com/r/aU0oA6/1\" rel=\"nofollow noreferrer\"><strong>Example Here</strong></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/qdUSr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qdUSr.png\" alt=\"enter image description here\"></a></p>\n\n<p>Output after merging the capture groups:</p>\n\n<pre><code>1921-1220104081741b\n(192) (1-122010408174) (1) (b)\n</code></pre>\n\n\n\n<pre><code>192123212a-1220234104081742ab\n(19212321) (2a-122023410408174) (2a) (b)\n</code></pre>\n\n\n\n<pre><code>1926h-1220104081746h\n(192) (6h-122010408174) (6h)\n</code></pre>\n\n<h3>Example:</h3>\n\n<p>Disregard the JS. Here is the output after merging the capture groups:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"true\" data-console=\"false\" data-babel=\"false\">\r\n<div class=\"snippet-code snippet-currently-hidden\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>var strings = ['1921-1220104081741b', '192123212a-1220234104081742ab', '1926h-1220104081746h'], exp = /(\\d*)((\\d[a-z]*)-\\d*)(\\3)([a-z])?/;\r\n\r\nstrings.forEach(function(str) {\r\n  var m = str.match(exp);\r\n  \r\n  snippet.log(str);\r\n  snippet.log('(' + m[1] + ') ('+ m[2] + ') (' + m[4] + ') (' + (m[5]||'') + ')');\r\n  snippet.log('---');\r\n});</code></pre>\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;script src=\"http://tjcrowder.github.io/simple-snippets-console/snippet.js\"&gt;&lt;/script&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": [], "owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "is_accepted": false, "score": 1, "last_activity_date": 1450204618, "creation_date": 1450204618, "answer_id": 34296904, "question_id": 34296076, "link": "https://stackoverflow.com/questions/34296076/regular-expressions-matching-difficulty/34296904#34296904", "title": "Regular Expressions matching difficulty", "body": "<p>I think what you are saying with \"followed by the same number\" is that the piece right before the dash is repeated as your third capture group. I would suggest implementing this by splitting up your second capture group and then using a backreference:</p>\n\n<pre><code>([\\d]*)([\\d][a-z]*)-([\\d]*)(\\2)(.?)\n</code></pre>\n\n<p>For your three examples:</p>\n\n<pre><code>1921-1220104081741b\n192123212a-1220234104081742ab\n1926h-1220104081746h\n</code></pre>\n\n<p>This results in:</p>\n\n<pre><code>(192)      (1)  - (122010408174)    (1)  (b)\n(19212321) (2a) - (122023410408174) (2a) (b)\n(192)      (6h) - (122010408174)    (6h) ()\n</code></pre>\n\n<p>...and you can join the two middle groups back together to get the hyphenated term you wanted.</p>\n"}], "owner": {"reputation": 105, "user_id": 2062443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3530b25ebf4ee154c359eacf517f6352?s=128&d=identicon&r=PG", "display_name": "Persiden", "link": "https://stackoverflow.com/users/2062443/persiden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 34296338, "answer_count": 2, "score": 7, "last_activity_date": 1521031206, "creation_date": 1450201777, "last_edit_date": 1521031206, "question_id": 34296076, "link": "https://stackoverflow.com/questions/34296076/regular-expressions-matching-difficulty", "title": "Regular Expressions matching difficulty", "body": "<p>My current regex:</p>\n\n<pre><code>([\\d]*)([^\\d]*[\\d][a-z]*-[\\d]*)([\\d][a-z?])(.?)\n</code></pre>\n\n<p>Right so I am attempting to make regex match a string based on: a count that can be any amount of number from 0-1million then followed by a number then sometimes a letter then - then any number for numbers followed by the same number and sometimes a letter then sometimes a letter. example of strings it should match:</p>\n\n<pre><code>1921-1220104081741b\n192123212a-1220234104081742ab\n</code></pre>\n\n<p>an example of what it should return based on above (this is 2 examples it shouldn't read both lines.)</p>\n\n<pre><code>(192) (1-122010408174) (1) (b)\n(19212321) (2a-122023410408174) (2a) (b)\n</code></pre>\n\n<p>My current regex works with the second one but it returns (1b) in the first when I would like it to return (1) (b) but also return (2a) in the case of the second one or the case of: </p>\n\n<pre><code>1926h-1220104081746h  Should Return: (192) (6h-122010408174) (6h)\n</code></pre>\n\n<p>Not 100% sure if its possible, sense I'm fairly new to regex.  For reference I'm doing this in excel-vba if there is any other way to do this easier. </p>\n"}, {"tags": ["excel", "vba", "date"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1450202203, "post_id": 34296062, "comment_id": 56333845, "body": "Excel has <code>WEEKNUM()</code>, which you could use on your holiday dates and your cells to be highlighted.  A formula-based CF rule should work using that."}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 5683238, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/76433a9de379d7215b51e41211ef26fb?s=128&d=identicon&r=PG&f=1", "display_name": "AlanB", "link": "https://stackoverflow.com/users/5683238/alanb"}, "edited": false, "score": 0, "creation_date": 1450263556, "post_id": 34296439, "comment_id": 56361860, "body": "this worked nicely, thank you. The complication is the final week of the year, though, where Weeknum 53 would usually be included in week 1 of the following year.  This doesn&#39;t appear as a relevant date within the analysis being carried out but I&#39;ll see if extending the formula to include INDEX and MATCH will take this into account.  Does conditional formatting accept array formulas?"}], "tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": false, "score": 0, "last_activity_date": 1450203010, "creation_date": 1450203010, "answer_id": 34296439, "question_id": 34296062, "link": "https://stackoverflow.com/questions/34296062/highlight-cell-if-it-falls-in-a-list-of-dates/34296439#34296439", "title": "Highlight cell if it falls in a list of dates", "body": "<p>As suggested by @Tim Williams, and assuming you have a list of holiday dates, say in ColumnH starting in H1, you might enter in I1 and copy down to suit:  </p>\n\n<pre><code>=WEEKNUM(H1)  \n</code></pre>\n\n<p>then select your other column of dates (assumed to be ColumnA) and HOME > Styles - Conditional Formatting, New Rule..., <em>Use a formula to determine which cells to format</em> and <strong>Format values where this formula is true:</strong>:    </p>\n\n<pre><code>=WEEKNUM(A1)=VLOOKUP(WEEKNUM(A1),I:I,1,0)\n</code></pre>\n\n<p><kbd>Format...</kbd>, select your choice of formatting, OK, OK. </p>\n\n<p>Note this only works for one year at a time.</p>\n"}], "owner": {"reputation": 83, "user_id": 5683238, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/76433a9de379d7215b51e41211ef26fb?s=128&d=identicon&r=PG&f=1", "display_name": "AlanB", "link": "https://stackoverflow.com/users/5683238/alanb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1267, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1450203010, "creation_date": 1450201730, "last_edit_date": 1450202426, "question_id": 34296062, "link": "https://stackoverflow.com/questions/34296062/highlight-cell-if-it-falls-in-a-list-of-dates", "title": "Highlight cell if it falls in a list of dates", "body": "<p>I have a weekly sales summary where I would like to highlight if the weekending date falls in a week with a public holiday in it.</p>\n\n<p>I can use conditional formatting for a date range or single date but can't find a method of comparing the weekending date with a list of dates to show if a public holiday falls in that week.</p>\n\n<p>The weekending date is always a Sunday but the public holiday dates could be any week day, so a range of Monday-Friday will be necessary i.e. weekend 13/12/2015 would need to look at 07/12/15-11/12/15.</p>\n\n<p>I suspect conditional formatting cannot cope with this and a formula in an adjacent column will be fine.  VBA is also fine.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1450201304, "post_id": 34295604, "comment_id": 56333286, "body": "Need more info or photo to understand/help. Loops are tricky to architect if you&#39;re unfamiliar, best way is to just do trial and error."}, {"owner": {"reputation": 821, "user_id": 2867882, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/H7m2W.jpg?s=128&g=1", "display_name": "Shenanigator", "link": "https://stackoverflow.com/users/2867882/shenanigator"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1450201814, "post_id": 34295604, "comment_id": 56333614, "body": "If I could give a photo or upload of the data I would, but it is confidential information.  The builds sheet has columns of builds From I:CW (currently, though it can change and add columns) with buildname in row 1 and phasenum in row 2.  The rest of the data to look-up and copy are in rows 3 to 168.  the build compare sheet will have a blank cell in row 1 and row 2 for input of a buildname and phasenum.  I have been asked to take in 4 different buildnames and phasenum&#39;s to return data to compare.  so I need to lookup buildname1 and phasenum1 and paste the data, then loop to 2,3,4 and paste."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1450202686, "post_id": 34295604, "comment_id": 56334179, "body": "So the 4 buildnames and phasenums repeat in columns <code>I:CW</code>? Why did you only mention <code>column B, D, F, or H</code> in OP? Confused XD And what data size are you pulling from rows 3 to 168? Single cell? A range? Make up data or black it out for picture."}, {"owner": {"reputation": 821, "user_id": 2867882, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/H7m2W.jpg?s=128&g=1", "display_name": "Shenanigator", "link": "https://stackoverflow.com/users/2867882/shenanigator"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1450202796, "post_id": 34295604, "comment_id": 56334244, "body": "Here is my thinking: I need to find the buildname first, then shift down a row and see if it is the right phasenum, if not go to the next.  Also there will be multiple of the same buildname, but a different phase number per buildname. so AAA### can repeat multiple times, but phasenum will be 1 or 2 etc."}, {"owner": {"reputation": 821, "user_id": 2867882, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/H7m2W.jpg?s=128&g=1", "display_name": "Shenanigator", "link": "https://stackoverflow.com/users/2867882/shenanigator"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1450202833, "post_id": 34295604, "comment_id": 56334272, "body": "B,D,F, or H are the place where the person enters the buildname and phasenum they want to search for to compare.  The original data is on another sheet."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1450202931, "post_id": 34295604, "comment_id": 56334334, "body": "What data are you pulling? Is it something a pivot table or <code>sumif</code> can do? Edit: or just run with your thought. Trial and error is fine for loops. Come back with specific loop problem."}, {"owner": {"reputation": 821, "user_id": 2867882, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/H7m2W.jpg?s=128&g=1", "display_name": "Shenanigator", "link": "https://stackoverflow.com/users/2867882/shenanigator"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1450203355, "post_id": 34295604, "comment_id": 56334609, "body": "The problem is the way the data is setup a pivot table won&#39;t work.  The data is in rows and the buildnames are in columns. and there is a blank template column that is used on the main data sheet for adding new columns when they need to be added via vba.  I tried a pivot table already and it errors out"}, {"owner": {"reputation": 821, "user_id": 2867882, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/H7m2W.jpg?s=128&g=1", "display_name": "Shenanigator", "link": "https://stackoverflow.com/users/2867882/shenanigator"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1450203516, "post_id": 34295604, "comment_id": 56334712, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/98010/discussion-between-user2867882-and-findwindow\">continue this discussion in chat</a>."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1450203740, "post_id": 34295604, "comment_id": 56334829, "body": "I can&#39;t chat. Try a shot at looping then ask a loop question."}], "answers": [{"comments": [{"owner": {"reputation": 821, "user_id": 2867882, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/H7m2W.jpg?s=128&g=1", "display_name": "Shenanigator", "link": "https://stackoverflow.com/users/2867882/shenanigator"}, "edited": false, "score": 0, "creation_date": 1450282974, "post_id": 34300225, "comment_id": 56375929, "body": "Thanks, this is way more simple than what I had originally thought.  I did make a modification I will post, but it is not pasting any data to the Build Compare page.  It does run with no errors though."}, {"owner": {"reputation": 821, "user_id": 2867882, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/H7m2W.jpg?s=128&g=1", "display_name": "Shenanigator", "link": "https://stackoverflow.com/users/2867882/shenanigator"}, "edited": false, "score": 0, "creation_date": 1450285487, "post_id": 34300225, "comment_id": 56377559, "body": "I was wrong, using your exact code does error with Method &#39;Range&#39; of object &#39;_Worksheet&#39; failed."}, {"owner": {"reputation": 821, "user_id": 2867882, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/H7m2W.jpg?s=128&g=1", "display_name": "Shenanigator", "link": "https://stackoverflow.com/users/2867882/shenanigator"}, "edited": false, "score": 0, "creation_date": 1450286167, "post_id": 34300225, "comment_id": 56377986, "body": "Okay, I got it to work; apparently setting the range beyond ZZ breaks it though."}, {"owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "reply_to_user": {"reputation": 821, "user_id": 2867882, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/H7m2W.jpg?s=128&g=1", "display_name": "Shenanigator", "link": "https://stackoverflow.com/users/2867882/shenanigator"}, "edited": false, "score": 0, "creation_date": 1450371297, "post_id": 34300225, "comment_id": 56421562, "body": "<code>shBuild.Range(&quot;A1&quot; &amp; Columns.Count</code> does not do what you think it does. First, <code>Columns.Count</code> refers to the active sheet. You should use <code>shBuild.Columns.Count</code>, but really you shouldn&#39;t use that either. If there are, say, 16,384 columns in your worksheet, you will be looking at every cell in A116384 - which is one cell. Try <code>For Each rCell in shBuild.Range(&quot;A1&quot;).Resize(1,shBuild.Columns.Count).Cells</code> instead."}, {"owner": {"reputation": 821, "user_id": 2867882, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/H7m2W.jpg?s=128&g=1", "display_name": "Shenanigator", "link": "https://stackoverflow.com/users/2867882/shenanigator"}, "edited": false, "score": 0, "creation_date": 1450459418, "post_id": 34300225, "comment_id": 56463560, "body": "Yea, I figured out that it was not doing what I thought.  I will change to your other suggestion; thanks!"}], "tags": [], "owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "is_accepted": true, "score": 0, "last_activity_date": 1450216799, "creation_date": 1450216799, "answer_id": 34300225, "question_id": 34295604, "link": "https://stackoverflow.com/questions/34295604/i-am-trying-to-write-some-vba-to-help-compare-some-data/34300225#34300225", "title": "I am trying to write some VBA to help compare some data", "body": "<p>I'm not sure putting those values in variables is the way to go.  In the below example, it reads each of the comps cells, finds that cell on builds, and copies the data over.</p>\n\n<pre><code>Public Sub MakeCompareSheet()\n\n    Dim i As Long\n    Dim rCell As Range\n    Dim shBuild As Worksheet\n    Dim shComp As Worksheet\n\n    Set shBuild = Sheets(\"Builds\")\n    Set shComp = Sheets(\"Build Compare\")\n\n    For i = 2 To 8 Step 2 'cols B through H\n\n        'loop through row 1 of the builds sheet\n        For Each rCell In shBuild.Range(\"A1:Z1\").Cells\n\n            'if row 1 of builds = row 1, column i of comps\n            'and if the cell below equals the cell below\n            If rCell.Value = shComp.Cells(1, i).Value And rCell.Offset(1, 0).Value = shComp.Cells(2, i).Value Then\n\n                'copy row three down 166 rows to the comps wheet\n                rCell.Offset(2, 0).Resize(166, 1).Copy shComp.Cells(3, i)\n\n                'Since we already found it, we don't need to look anymore\n                Exit For\n            End If\n        Next rCell\n    Next i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 821, "user_id": 2867882, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/H7m2W.jpg?s=128&g=1", "display_name": "Shenanigator", "link": "https://stackoverflow.com/users/2867882/shenanigator"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 34300225, "answer_count": 1, "score": 0, "last_activity_date": 1450472874, "creation_date": 1450200246, "last_edit_date": 1450472874, "question_id": 34295604, "link": "https://stackoverflow.com/questions/34295604/i-am-trying-to-write-some-vba-to-help-compare-some-data", "title": "I am trying to write some VBA to help compare some data", "body": "<p>Edit:</p>\n\n<p>Based on the suggestion below I tried the following on sample data that should be pasting some data; it is not erroring, but it is not pasting data either:</p>\n\n<pre><code>Public Sub MakeCompareSheet()\n\nDim i As Long\nDim rCell As Range\nDim shBuild As Worksheet\nDim shComp As Worksheet\n\nSet shBuild = Sheets(\"Builds\")\nSet shComp = Sheets(\"Build Compare\")\n\nFor i = 2 To 8 Step 2 'cols B through H\n\n    'loop through row 1 of the builds sheet\n    For Each rCell In shBuild.Range(\"A1\" &amp; Columns.Count).Cells\n        'if row 1 of builds = row 1, column i of comps\n        'and if the cell below equals the cell below\n        If rCell.Value = shComp.Cells(1, i).Value And rCell.Offset(1, 0).Value = shComp.Cells(2, i).Value Then\n\n            'copy row 3 down 166 rows to the comps wheet\n            rCell.Offset(2, 0).Resize(166, 1).Copy shComp.Cells(3, i)\n\n            'Since we already found it, we don't need to look anymore\n            Exit For\n        End If\n    Next rCell\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>Edit #2:</p>\n\n<p>When I go back to the original code it errors.  I suspect that is because the first thing it is searching for can be found in multiple cells.</p>\n\n<p>For an example AAA### is in 6 cells in the Range. I am not sure why when I use Columns.Count it doesn't error but using a hard range it does.</p>\n\n<p>Edit #3:</p>\n\n<p>Well the above code does not work right and setting the range beyond ZZ1 breaks it as well.  I will have to let them know that as we approach ZZ we will need a new sheet to start over.</p>\n\n<p>Edit #4:</p>\n\n<pre><code>Public Sub MakeCompareSheet()\n\nDim i As Long\nDim rCell As Range\nDim shBuild As Worksheet\nDim shComp As Worksheet\n\nSet shBuild = Sheets(\"Builds\")\nSet shComp = Sheets(\"Build Compare\")\n\nIf IsEmpty(shComp.Cells(1, 2)) = True Then\n    MsgBox (\"Please enter at least 1 build ID into Cell B1\")\n    Else\n    If IsEmpty(shComp.Cells(2, 2)) = True Then\n        MsgBox (\"Please enter the phase for the build\")\n    End If\nEnd If\n\n    For i = 2 To 8 Step 2 'cols B through H\n\n            'loop through row 1 of the builds sheet\n            For Each rCell In shBuild.Range(\"A1\").Resize(1, shBuild.Columns.Count).Cells\n                'if row 1 of builds = row 1, column i of comps\n                'and if the cell below equals the cell below\n                If rCell.Value = shComp.Cells(1, i).Value And rCell.Offset(1, 0).Value = shComp.Cells(2, i).Value Then\n                    If IsEmpty(rCell) Then GoTo 34 Else\n                    'copy row 3 down 166 rows to the comps sheet\n                    rCell.Offset(2, 0).Resize(166, 1).Copy shComp.Cells(3, i)\n\n                    'Since we already found it, we don't need to look anymore\n                Exit For\n            End If\n        Next rCell\n34:     Next i\n\nEnd Sub\n</code></pre>\n\n<p>that is the code as it stands now, working well.  Big thanks to Dick for all the help; I really appreciate it.</p>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 366, "user_id": 4919511, "user_type": "registered", "accept_rate": 12, "profile_image": "https://graph.facebook.com/10153644441556549/picture?type=large", "display_name": "Oliver Humphreys", "link": "https://stackoverflow.com/users/4919511/oliver-humphreys"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1450200590, "post_id": 34295360, "comment_id": 56332869, "body": "Yes, Microsoft Access 14.0 Object Library"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1450201023, "post_id": 34295360, "comment_id": 56333112, "body": "<code>ImportExportSpecifications</code> are saved jobs.  <code>SpecificationName</code> is something else.  What happens if you open an Access session (without Excel) and attempt the same <code>TransferText</code> ... replacing <code>ThisWorkbook.Path</code> with the path to the folder which contains the CSV file?"}, {"owner": {"reputation": 366, "user_id": 4919511, "user_type": "registered", "accept_rate": 12, "profile_image": "https://graph.facebook.com/10153644441556549/picture?type=large", "display_name": "Oliver Humphreys", "link": "https://stackoverflow.com/users/4919511/oliver-humphreys"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1450434552, "post_id": 34295360, "comment_id": 56448445, "body": "@HansUp It returns the same error message. as suggested I used: <code>DoCmd.TransferText TransferType:=acImportDelim, SpecificationName:=&quot;Import-FACTS&quot;, TableName:=&quot;Facts&quot;, FileName:=&quot;C:\\***\\Facts.csv&quot;, HasFieldNames:=False</code>. Do you know how I create an import specification rather than a saved job? I hadn&#39;t realised there was a difference."}, {"owner": {"reputation": 366, "user_id": 4919511, "user_type": "registered", "accept_rate": 12, "profile_image": "https://graph.facebook.com/10153644441556549/picture?type=large", "display_name": "Oliver Humphreys", "link": "https://stackoverflow.com/users/4919511/oliver-humphreys"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 2, "creation_date": 1450438266, "post_id": 34295360, "comment_id": 56450774, "body": "@HansUp I&#39;ve managed it! Many thanks for pointing me in the right direction! There&#39;s a way of saving import specifications in the Advanced options of the import wizard."}], "answers": [{"comments": [{"owner": {"reputation": 366, "user_id": 4919511, "user_type": "registered", "accept_rate": 12, "profile_image": "https://graph.facebook.com/10153644441556549/picture?type=large", "display_name": "Oliver Humphreys", "link": "https://stackoverflow.com/users/4919511/oliver-humphreys"}, "edited": false, "score": 0, "creation_date": 1479306624, "post_id": 40304969, "comment_id": 68501648, "body": "Cheers! I&#39;ll give it a go!"}, {"owner": {"reputation": 567, "user_id": 5805795, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5e306c676900f1dc3f798f3915879f03?s=128&d=identicon&r=PG&f=1", "display_name": "jcarroll", "link": "https://stackoverflow.com/users/5805795/jcarroll"}, "edited": false, "score": 2, "creation_date": 1573150991, "post_id": 40304969, "comment_id": 103797431, "body": "This deserves way more up votes, I searched all over trying to solve the issue explained here"}], "tags": [], "owner": {"reputation": 61, "user_id": 7085215, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/289436cf8c759ad2e69794076a7d0352?s=128&d=identicon&r=PG", "display_name": "Serge Salvaille", "link": "https://stackoverflow.com/users/7085215/serge-salvaille"}, "is_accepted": false, "score": 6, "last_activity_date": 1477664206, "last_edit_date": 1477664206, "creation_date": 1477657148, "answer_id": 40304969, "question_id": 34295360, "link": "https://stackoverflow.com/questions/34295360/the-text-file-specification-does-not-exist-when-importing-into-access/40304969#40304969", "title": "The text file specification does not exist when importing into Access", "body": "<p><strong>Important note for imports</strong></p>\n\n<p>There is a problem with the text file specification as the name may not be the same that is displayed when you check your saved imports.</p>\n\n<p>To know the true name, run the following SQL:</p>\n\n<pre><code>SELECT MSysIMEXSpecs.SpecName, \n       MSysIMEXColumns.FieldName, \n       MSysIMEXColumns.Start, \n       MSysIMEXColumns.Width, \n       MSysIMEXColumns.SkipColumn\n\nFROM MSysIMEXColumns INNER JOIN \n     MSysIMEXSpecs ON MSysIMEXColumns.SpecID = MSysIMEXSpecs.SpecID\n\nORDER BY MSysIMEXSpecs.SpecName, \n         MSysIMEXColumns.Start, \n         MSysIMEXColumns.Width;\n</code></pre>\n\n<p>The <code>SpecName</code> field contains the right name you are looking for!</p>\n"}], "owner": {"reputation": 366, "user_id": 4919511, "user_type": "registered", "accept_rate": 12, "profile_image": "https://graph.facebook.com/10153644441556549/picture?type=large", "display_name": "Oliver Humphreys", "link": "https://stackoverflow.com/users/4919511/oliver-humphreys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4415, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1608697168, "creation_date": 1450199530, "last_edit_date": 1594641180, "question_id": 34295360, "link": "https://stackoverflow.com/questions/34295360/the-text-file-specification-does-not-exist-when-importing-into-access", "title": "The text file specification does not exist when importing into Access", "body": "<p>I'm trying to import a semi colon delimited <code>.csv</code> file into an access database using the following code. I've set up an import specification which works called \"Import-FACTS\". and VBA can see the specification (by putting <code>OLEacc.CurrentProject.ImportExportSpecifications(0)</code> into the watch window.</p>\n\n<pre><code>Sub ImportFacts()\n\nDim OLEacc As Access.Application\n\nSet OLEacc = GetObject(\"\", \"Access.Application\")\n\nOLEacc.OpenCurrentDatabase (ThisWorkbook.Path &amp; \"\\\" &amp; \"LargeData.accdb\")\n\nOLEacc.DoCmd.TransferText TransferType:=acImportDelim, _ \n   SpecificationName:=\"Import-FACTS\",_\n   TableName:=\"Facts\",_\n   Filename:=ThisWorkbook.Path &amp; \"\\Facts.csv\",_\n   HasFieldNames:=False\n\nEnd Sub\n</code></pre>\n\n<p>However I get the debug message: </p>\n\n<blockquote>\n  <p>Run-time error '3625' The text file specification \"Import-Facts\" does\n  not exist You cannot import export or link using the specification.</p>\n</blockquote>\n\n<p>Any ideas?</p>\n"}, {"tags": ["excel", "vba"], "owner": {"reputation": 2528, "user_id": 4668368, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/70b77439d7ee9bb7410105b7bc912afb?s=128&d=identicon&r=PG&f=1", "display_name": "justaguy", "link": "https://stackoverflow.com/users/4668368/justaguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1084, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1450205615, "creation_date": 1450198659, "last_edit_date": 1531164843, "question_id": 34295070, "link": "https://stackoverflow.com/questions/34295070/print-variable-to-output-text-file-in-excel-2010-vba", "title": "print variable to output text file in excel 2010 vba", "body": "<p>The below <code>excel 2010 vba</code> runs perfectly except I can not seem to get the variable <code>process</code> (time elapsed) to print from the <code>Call Perl section</code> to the <code>analysis.txt</code>, which captures some information regarding the analysis.  Thank you :).</p>\n\n<pre><code>Private Sub CommandButton3_Click()\n\nDim MyBarCode   As String      ' Enter Barcode\nDim MyScan      As String      ' Enter ScanDate\nDim MyDirectory As String\n\n'GET USER INPUT '\nLine1:\nMyBarCode = Application.InputBox(\"Please enter the last 5 digits of the barcode\", \"Bar Code\", Type:=2)\n\nIf MyBarCode = \"False\" Then Exit Sub   'user canceled\nDo\n    MyScan = Application.InputBox(\"Please enter scan date\", \"Scan Date\", Date - 1, Type:=2)\n    If MyScan = \"False\" Then Exit Sub   'user canceled\n    If IsDate(MyScan) Then Exit Do\n    MsgBox \"Please enter a valid date format. \", vbExclamation, \"Invalid Date Entry\"\nLoop\n\n'CREATE NEXUS DIRECTORY AND VERIFY FOLDER '\nMyDirectory = \"N:\\1_DATA\\MicroArray\\NexusData\\\" &amp; \"2571683\" &amp; MyBarCode &amp; \"_\" &amp; Format(CDate(MyScan), \"m-d-yyyy\") &amp; \"\\\"\nIf Dir(MyDirectory, vbDirectory) = \"\" Then\n    MkDir MyDirectory\nElse\n    MsgBox (\"Already exsists! Please enter again\")\n    GoTo Line1\nEnd If\n\n'Write to text file\n    Open MyDirectory &amp; \"sample_descriptor.txt\" For Output As #1\n    Print #1, \"Experiment Sample\" &amp; vbTab &amp; \"Control Sample\" &amp; vbTab &amp; \"Display Name\" &amp; vbTab &amp; \"Gender\" &amp; vbTab &amp; \"Control Gender\" &amp; vbTab &amp; \"Spikein\" &amp; vbTab &amp; \"Location\" &amp; vbTab &amp; \"Barcode\" &amp; vbTab &amp; \"Medical Record\" &amp; vbTab &amp; \"Date of Birth\" &amp; vbTab &amp; \"Order Date\"\n    Print #1, \"2571683\" &amp; MyBarCode &amp; \"_532Block1.txt\" &amp; vbTab &amp; \"2571683\" &amp; MyBarCode &amp; \"_635Block1.txt\" &amp; vbTab &amp; ActiveSheet.Range(\"B8\").Value &amp; \" \" &amp; ActiveSheet.Range(\"B9\").Value &amp; vbTab &amp; ActiveSheet.Range(\"B10\").Value &amp; vbTab &amp; ActiveSheet.Range(\"B5\").Value &amp; vbTab &amp; ActiveSheet.Range(\"B11\").Value &amp; vbTab &amp; ActiveSheet.Range(\"B12\").Value &amp; vbTab &amp; \"2571683\" &amp; MyBarCode &amp; vbTab &amp; ActiveSheet.Range(\"C201\").Value &amp; vbTab &amp; ActiveSheet.Range(\"D201\").Value &amp; vbTab &amp; ActiveSheet.Range(\"E201\").Value\n    Print #1, \"2571683\" &amp; MyBarCode &amp; \"_532Block2.txt\" &amp; vbTab &amp; \"2571683\" &amp; MyBarCode &amp; \"_635Block2.txt\" &amp; vbTab &amp; ActiveSheet.Range(\"C8\").Value &amp; \" \" &amp; ActiveSheet.Range(\"C9\").Value &amp; vbTab &amp; ActiveSheet.Range(\"C10\").Value &amp; vbTab &amp; ActiveSheet.Range(\"C5\").Value &amp; vbTab &amp; ActiveSheet.Range(\"C11\").Value &amp; vbTab &amp; ActiveSheet.Range(\"C12\").Value &amp; vbTab &amp; \"2571683\" &amp; MyBarCode &amp; vbTab &amp; ActiveSheet.Range(\"C202\").Value &amp; vbTab &amp; ActiveSheet.Range(\"D202\").Value &amp; vbTab &amp; ActiveSheet.Range(\"E202\").Value\n    Print #1, \"2571683\" &amp; MyBarCode &amp; \"_532Block3.txt\" &amp; vbTab &amp; \"2571683\" &amp; MyBarCode &amp; \"_635Block3.txt\" &amp; vbTab &amp; ActiveSheet.Range(\"D8\").Value &amp; \" \" &amp; ActiveSheet.Range(\"D9\").Value &amp; vbTab &amp; ActiveSheet.Range(\"D10\").Value &amp; vbTab &amp; ActiveSheet.Range(\"D5\").Value &amp; vbTab &amp; ActiveSheet.Range(\"D11\").Value &amp; vbTab &amp; ActiveSheet.Range(\"D12\").Value &amp; vbTab &amp; \"2571683\" &amp; MyBarCode &amp; vbTab &amp; ActiveSheet.Range(\"C203\").Value &amp; vbTab &amp; ActiveSheet.Range(\"D203\").Value &amp; vbTab &amp; ActiveSheet.Range(\"E203\").Value\n    Print #1, \"2571683\" &amp; MyBarCode &amp; \"_532Block4.txt\" &amp; vbTab &amp; \"2571683\" &amp; MyBarCode &amp; \"_635Block4.txt\" &amp; vbTab &amp; ActiveSheet.Range(\"E8\").Value &amp; \" \" &amp; ActiveSheet.Range(\"E9\").Value &amp; vbTab &amp; ActiveSheet.Range(\"E10\").Value &amp; vbTab &amp; ActiveSheet.Range(\"E5\").Value &amp; vbTab &amp; ActiveSheet.Range(\"E11\").Value &amp; vbTab &amp; ActiveSheet.Range(\"E12\").Value &amp; vbTab &amp; \"2571683\" &amp; MyBarCode &amp; vbTab &amp; ActiveSheet.Range(\"C201\").Value &amp; vbTab &amp; ActiveSheet.Range(\"D204\").Value &amp; vbTab &amp; ActiveSheet.Range(\"E204\").Value\n    Close #1\n\n'CREATE ANALYSIS LOG '\n Dim Process As String\n\n Open MyDirectory &amp; \"analysis.txt\" For Output As #2\n Print #2, \"Analysis done by\" &amp; \" \" &amp; Environ(\"UserName\") &amp; \" \" &amp; \"on\" &amp; \" \" &amp; Date &amp; \" \" &amp; \"at\" &amp; \" \" &amp; Time &amp; \" \" &amp; \"and took\" &amp; Process &amp; \"to complete\"\n Close #2\n\n'CONFIRM ENTRIES '\nDim Patient As String\nDim Barcode As String\nDim Directory As String\nDim MyFile As Variant\nDim MyFolder As String\nDim i As Long\n\nDirectory = \"N:\\1_DATA\\MicroArray\\NexusData\\\" &amp; \"2571683\" &amp; MyBarCode &amp; \"_\" &amp; Format(CDate(MyScan), \"m-d-yyyy\")\n\n  Patient = ActiveSheet.Range(\"B9\").Value &amp; \" \" &amp; ActiveSheet.Range(\"C9\").Value &amp; \" \" &amp; ActiveSheet.Range(\"D9\").Value &amp; \" \" &amp; ActiveSheet.Range(\"E9\").Value\nBarcode = \"2571683\" &amp; MyBarCode\n  MsgBox \"The patients that will be analyzed are:\" + Patient &amp; \"The barcode is:\" + Barcode\n\n\n  iYesNo = MsgBox(\"Do the patients and barcode match the setup sheet?\", vbYesNoCancel)\n      Select Case iYesNo\n             Case vbYes\n             GoTo Line2\n             Case vbNo\n             MsgBox (\"Doesn't match! Please enter again\")\n             Call DeleteFolder(Directory)\n             GoTo Line1\n       End Select\n\n'ADD VBA REFERENCE: MICROSOFT XML, v3.0 or v6.0 '\nLine2:\nDim oXMLFile As New MSXML2.DOMDocument\nDim imgNode As MSXML2.IXMLDOMNodeList, destNode As MSXML2.IXMLDOMNodeList\nDim XML\u00adFile\u00adName As String\n\nXML\u00adFile\u00adName = \"C:\\Users\\cmccabe\\Desktop\\EmArray\\Design\\imagene.bch\"\noXMLFile.Load (XML\u00adFile\u00adName)\n\n'EXTRACT NODES INTO LIST AND REWRITE NODES '\nSet imgNode = oXMLFile.DocumentElement.SelectNodes(\"/Batch/Entry/Image\")\nimgNode(0).Text = \"I:\\\" &amp; \"2571683\" &amp; MyBarCode &amp; \"_532.tif\"\nimgNode(1).Text = \"I:\\\" &amp; \"2571683\" &amp; MyBarCode &amp; \"_635.tif\"\n\nSet destNode = oXMLFile.DocumentElement.SelectNodes(\"/Batch/Entry/Destination\")\ndestNode(0).Text = MyDirectory\ndestNode(1).Text = MyDirectory\n\n'SAVE UPDATED XML '\n oXMLFile.Save XML\u00adFile\u00adName\n\n'UNINTIALIZE OBJECTS '\nSet imgNode = Nothing\nSet destNode = Nothing\nSet oXMLFile = Nothing\n\n'CALCULATE TIME FOR PROCESS '\nDim StartTime As Double\nDim MinutesElapsed As String\n\nStartTime = Timer ' define start time\n'CALL JAVA PROGRAM USING SHELL AND COMPLETE PROCESS '\nDim wshell As Object\nSet wshell = CreateObject(\"wscript.shell\")\n\nDim waitOnReturn As Boolean: waitOnReturn = True\nDim windowStyle As Integer: windowStyle = 1\nwshell.Run Chr(34) &amp; \"C:\\Users\\cmccabe\\Desktop\\EmArray\\Design\\java.bat\", windowsStyle, waitOnReturn\n\n'UPDATE PERL VARIABLES USING SHELL '\n Dim PerlCommand As String, PerlParameters As String, VarDirectory As String\n Dim var As String, var1 As String, var2 As String, var3 As String\n\n MsgBox (\"Verifying spike-ins, please wait\")\n\nVarDirectory = \"N:\\1_DATA\\MicroArray\\NexusData\\\" &amp; \"2571683\" &amp; MyBarCode &amp; \"_\" &amp; Format(CDate(MyScan), \"m-d-yyyy\")\n\nvar = VarDirectory\nvar1 = \"sample_descriptor.txt\"\nvar2 = \"C:\\cygwin\\home\\cmccabe\\test_probes8.txt\"\nvar3 = var &amp; \"\\\" &amp; \"output.txt\"\n\n'CALL PERL '\nPerlCommand = \"\"\"C:\\Users\\cmccabe\\Desktop\\EmArray\\Design\\perl.bat\"\"\"\nPerlParameters = \"\"\"\" &amp; var &amp; \"\"\"\" &amp; \" \" &amp; _\n\"\"\"\" &amp; var1 &amp; \"\"\"\" &amp; \" \" &amp; _\n\"\"\"\" &amp; var2 &amp; \"\"\"\" &amp; \" \" &amp; _\n\"\"\"\" &amp; var3 &amp; \"\"\"\"\nCreateObject(\"wscript.shell\").Run PerlCommand &amp; \"  \" &amp; PerlParameters, windowsStyle, waitOnReturn\n\nMinutesElapsed = Format((Timer - StartTime) / 86400, \"hh:mm:ss\") 'elapsed seconds\nProcess = MinutesElapsed &amp; \" minutes\"\n\n iYesNo = MsgBox(\"ImaGene and spike-in anlysis complete, do you want to run NxClinical?\", vbYesNoCancel)\n\nSelect Case iYesNo\n\n       Case vbYes\n'CALL AND EXECUTE NXCLINICAL '\nDim x As Variant\nDim Path As String\n\n'SET INSTALLATION PATH '\nPath = \"C:\\Program Files\\BioDiscovery\\NxClinical Client\\NxClinical.exe\"\n\nx = Shell(Path, vbNormalFocus)\n\n        Case vbNo\n 'CLOSE AND EXIT '\n Application.DisplayAlerts = False\n Application.Quit\nEnd Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1450226857, "post_id": 34294473, "comment_id": 56346436, "body": "What is the recordsource query/table of report? How are subreports related to each other and master report? Please edit with details. I am almost sure you can combine all records somehow and simply use grouping."}, {"owner": {"reputation": 49, "user_id": 2630997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/331101256/picture?type=large", "display_name": "icouper", "link": "https://stackoverflow.com/users/2630997/icouper"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1450275946, "post_id": 34294473, "comment_id": 56370667, "body": "The reports are all employee-related data for multiple clients of the company I work for. Each subreport would have a different category of data for each employee - basic information, compensation, etc. They would like the flexibility to rearrange these subreports or not include reports that aren&#39;t applicable for a particular company/employee."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1450278001, "post_id": 34294473, "comment_id": 56372205, "body": "Subreports like other controls can be made conditionally visible or not with <a href=\"https://msdn.microsoft.com/en-us/library/office/ff821493.aspx\" rel=\"nofollow noreferrer\">Visible</a> property and have a <code>CanShrink</code> property that will not display if corresponding data is empty. Simply group main report on Employee and move all sub reports into grouping each linked by <code>EmployeeID</code>."}, {"owner": {"reputation": 49, "user_id": 2630997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/331101256/picture?type=large", "display_name": "icouper", "link": "https://stackoverflow.com/users/2630997/icouper"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1450378449, "post_id": 34294473, "comment_id": 56425696, "body": "Yeah, however I&#39;m trying to create one report per employee. Not a single report for a group of employees.  The idea was that I could create a list of reports for each employee - they would differ per employee. However when I try to group on my &quot;EmployeeReports&quot; table (which lists the reports for each employee) I don&#39;t get different reports in each sub report. I get the same report repeated multiple times."}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 2630997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/331101256/picture?type=large", "display_name": "icouper", "link": "https://stackoverflow.com/users/2630997/icouper"}, "edited": false, "score": 0, "creation_date": 1450458524, "post_id": 34346873, "comment_id": 56463069, "body": "That&#39;s great! Thanks for the detailed answer. I&#39;ll give it a try and let you know if I have any follow up questions."}, {"owner": {"reputation": 49, "user_id": 2630997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/331101256/picture?type=large", "display_name": "icouper", "link": "https://stackoverflow.com/users/2630997/icouper"}, "edited": false, "score": 0, "creation_date": 1450712828, "post_id": 34346873, "comment_id": 56540169, "body": "Quick question - what is the purpose of putting the subreports in the group header instead of the detail section in the first option?"}, {"owner": {"reputation": 49, "user_id": 2630997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/331101256/picture?type=large", "display_name": "icouper", "link": "https://stackoverflow.com/users/2630997/icouper"}, "edited": false, "score": 0, "creation_date": 1450716540, "post_id": 34346873, "comment_id": 56542442, "body": "Another question while I&#39;m at it - I&#39;m looking to have a page break between each sub report. Is there a way to adapt either of your suggestions above to accomplish that?"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 49, "user_id": 2630997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/331101256/picture?type=large", "display_name": "icouper", "link": "https://stackoverflow.com/users/2630997/icouper"}, "edited": false, "score": 0, "creation_date": 1450734229, "post_id": 34346873, "comment_id": 56551468, "body": "Group header or footer forces records to only those in specified group id, here being specific Employee. Had you put subreports in Detail - all Employees will appear which you had an issue about. See that in second type - Detail (no grouping) report. Hence you need the filter."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 49, "user_id": 2630997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/331101256/picture?type=large", "display_name": "icouper", "link": "https://stackoverflow.com/users/2630997/icouper"}, "edited": false, "score": 0, "creation_date": 1450734358, "post_id": 34346873, "comment_id": 56551517, "body": "For page breaks, try spacing out subreports, resize their heights to never shrink, and keep checking adjustments in Print Preview. Or place couple in group header and group footer and specify <a href=\"https://support.office.com/en-gb/article/Insert-a-page-break-control-in-an-Access-report-86d2ea7d-7aa6-44f2-8507-23134a9a2e15\" rel=\"nofollow noreferrer\">Force New Page</a>."}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 1, "last_activity_date": 1450399528, "creation_date": 1450399528, "answer_id": 34346873, "question_id": 34294473, "link": "https://stackoverflow.com/questions/34294473/dynamically-combine-multiple-reports-using-sub-reports-ms-access/34346873#34346873", "title": "Dynamically combine multiple reports using Sub-Reports - MS Access", "body": "<p>Consider the following two options which does not require table storage of subreports to be called dynamically by master report.</p>\n\n<p><strong>Grouped Report</strong></p>\n\n<p>Insert all subreports into the Group Header section (zero-length Detail section). Then, set each subreport Format property to <code>Can Shrink = Yes</code> and have report page break by Employee Group using <code>Force New Page = Before Section</code>. You can now open report in Print Preview and save as PDF using option on Ribbon.</p>\n\n<p><a href=\"https://i.stack.imgur.com/ts9pE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ts9pE.png\" alt=\"MS Access Report with Grouping\"></a></p>\n\n<p><strong>Non-Grouped Report</strong></p>\n\n<p>Insert all subreports into Detail section (no grouping). Then, dynamically filter report using <a href=\"https://msdn.microsoft.com/en-us/library/office/ff192676.aspx\" rel=\"nofollow noreferrer\">DoCmd.OpenReport</a> method. Use <code>Where Condition</code> argument to filter by EmployeeID.</p>\n\n<p><a href=\"https://i.stack.imgur.com/bC9MP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bC9MP.png\" alt=\"MS Access Report without Grouping\"></a></p>\n\n<p>Below is a VBA loop to iterate through all employees and then <a href=\"https://msdn.microsoft.com/en-us/library/office/ff192065.aspx\" rel=\"nofollow noreferrer\">output</a> each individual employee report to PDF. Code can be used for either above grouped or non-grouped report.</p>\n\n<pre><code>Dim db as Database\nDim rst as Recordset\nDim strFile As String    \n\nSet db = CurrentDb\nSet rst = db.OpenRecordset(\"SELECT EmployeeID FROM Employees\", dbOpenDynaset)\n\nDo While Not rst.EOF\n    ' OPEN FILTERED REPORT IN PRINT PREVIEW '\n    DoCmd.OpenReport \"ReportName\", acViewPreview, , \"EmployeeID = \" &amp; rst!EmployeeID\n\n    ' OUTPUT REPORT INTO PDF '\n    strFile = \"C:\\Path\\To\\Output\\Folder\\Employee_\" &amp; rst!EmployeeID &amp; \".pdf\"\n    DoCmd.OutputTo acOutputReport, \"ReportName\", acFormatPDF, strFile, False\n\n    rst.MoveNext\nLoop\n\nrst.Close\nSet rst = Nothing\nSet db = Nothing\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 2630997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/331101256/picture?type=large", "display_name": "icouper", "link": "https://stackoverflow.com/users/2630997/icouper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7597, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1450399528, "creation_date": 1450197022, "question_id": 34294473, "link": "https://stackoverflow.com/questions/34294473/dynamically-combine-multiple-reports-using-sub-reports-ms-access", "title": "Dynamically combine multiple reports using Sub-Reports - MS Access", "body": "<p>I'm attempting to create a master report that I can use to combine multiple other reports into one. Ideally with the end result being a single PDF output.</p>\n\n<p>I've been attempting to use a table to store the names of the reports I would like to populate into the master report and use those to define the SourceObject for the sub reports on load.</p>\n\n<p>Ideally would like the option to have a variable number of sub-reports, so I've been attempting to use the Grouping function to accomplish that. So far the only result I'm getting is having the same report in all groups. I've tried putting the following code into <code>OnLoad</code> and <code>OnCurrent</code> - where txtPageReport is a textbox that is storing the report name.</p>\n\n<pre><code>subReportName = Me.txtPageReport\nMe.subReport.SourceObject = subReportName\n</code></pre>\n\n<p>Any suggestions would be appreciated. Maybe I'm going about this the wrong way completely.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["sql", "vba", "excel", "ado"], "comments": [{"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1450198818, "post_id": 34294382, "comment_id": 56331692, "body": "<a href=\"http://www.mrexcel.com/forum/excel-questions/524214-visual-basic-applications-joining-multiple-recordets-multiple-databases.html\" rel=\"nofollow noreferrer\">mrexcel.com/forum/excel-questions/&hellip;</a> plenty of google answers on this."}, {"owner": {"reputation": 61, "user_id": 5682960, "user_type": "registered", "profile_image": "https://graph.facebook.com/1126891514002328/picture?type=large", "display_name": "Abhishek Shrirang", "link": "https://stackoverflow.com/users/5682960/abhishek-shrirang"}, "reply_to_user": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1450199302, "post_id": 34294382, "comment_id": 56332015, "body": "Thank You MatthewD, but how can I perform sql like join? I did not understand as provided in your link."}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1450199718, "post_id": 34294382, "comment_id": 56332270, "body": "Here is another that is a bit more sql like. But you may have to do some work and not just a single statement.  <a href=\"https://social.msdn.microsoft.com/Forums/en-US/bee47e0a-2a73-4653-aa10-78e1f03cc4e2/need-to-do-left-join-between-two-recordsets\" rel=\"nofollow noreferrer\">social.msdn.microsoft.com/Forums/en-US/&hellip;</a>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1450202552, "post_id": 34294382, "comment_id": 56334099, "body": "If you place both sets of data in Excel you can use SQL to perform the join on the two tables: <a href=\"http://stackoverflow.com/questions/15304563/how-to-use-sql-joins-in-excel\" title=\"how to use sql joins in excel\">stackoverflow.com/questions/15304563/&hellip;</a>"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1450211985, "post_id": 34294382, "comment_id": 56339694, "body": "@AbhishekUpadhyay Do both of your sets of data have exactly the same fields? What is your Excel version, 2003 or later, 32-bit / 64-bit?"}], "answers": [{"comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1450576047, "post_id": 34376642, "comment_id": 56496025, "body": "Consider beginning your answer with the strategy used: VBA ADO connection. And even suggest that OP can connect directly to Oracle also with ADO (like any other database) using <a href=\"http://www.oracle.com/technetwork/database/windows/index-098976.html\" rel=\"nofollow noreferrer\">Oracle ODBC driver</a>."}, {"owner": {"reputation": 61, "user_id": 5682960, "user_type": "registered", "profile_image": "https://graph.facebook.com/1126891514002328/picture?type=large", "display_name": "Abhishek Shrirang", "link": "https://stackoverflow.com/users/5682960/abhishek-shrirang"}, "edited": false, "score": 0, "creation_date": 1497059401, "post_id": 34376642, "comment_id": 75933955, "body": "Thanks for your example."}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "reply_to_user": {"reputation": 61, "user_id": 5682960, "user_type": "registered", "profile_image": "https://graph.facebook.com/1126891514002328/picture?type=large", "display_name": "Abhishek Shrirang", "link": "https://stackoverflow.com/users/5682960/abhishek-shrirang"}, "edited": false, "score": 0, "creation_date": 1498903763, "post_id": 34376642, "comment_id": 76699230, "body": "@AbhishekUpadhyay please click to accept the answer if you find it helpful."}, {"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1570263582, "post_id": 34376642, "comment_id": 102864467, "body": "@omegastripes sorry for commenting on an old post, but cudnt find any docs for such a SELECT statement. What i want to know is if i replace the excel files with 2 csv files located in different folders, can i JOIN them together? Right now i am getting a SYNTAX error. I am not using <code>ODBC MICROSOFT ACCESS TEXT DRIVER</code> as i see it cannot handle spaces in paths. I can share the code as a new post. Please advice."}], "tags": [], "owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "is_accepted": true, "score": 6, "last_activity_date": 1533841254, "last_edit_date": 1533841254, "creation_date": 1450569219, "answer_id": 34376642, "question_id": 34294382, "link": "https://stackoverflow.com/questions/34294382/how-to-join-two-recordset-created-from-two-different-data-source-in-excel-vba/34376642#34376642", "title": "How to join two recordset created from two different data source in excel vba", "body": "<p>Consider the below example using ADO. The code allows to get data from several data sources within single SQL query (Jet SQL), particularly make unions from <code>.xlsx</code> files, and put result recordset to the worksheet. Unfortunately I have no available Oracle data source to test, though you can connect directly to Oracle also with ADO (like any other database) via <a href=\"http://www.oracle.com/technetwork/database/windows/index-098976.html\" rel=\"nofollow noreferrer\">Oracle ODBC driver</a>.</p>\n\n<p>The code is placed in <code>Query.xlsm</code>:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nSub SqlUnionTest()\n\n    Dim strConnection As String\n    Dim strQuery As String\n    Dim objConnection As Object\n    Dim objRecordSet As Object\n\n    strConnection = _\n        \"Provider=Microsoft.ACE.OLEDB.12.0;\" &amp; _\n        \"User ID=Admin;\" &amp; _\n        \"Data Source='\" &amp; ThisWorkbook.FullName &amp; \"';\" &amp; _\n        \"Mode=Read;\" &amp; _\n        \"Extended Properties=\"\"Excel 12.0 Macro;\"\";\"\n\n    strQuery = _\n        \"SELECT * FROM [Sheet1$] \" &amp; _\n        \"IN '\" &amp; ThisWorkbook.Path &amp; \"\\Source1.xlsx' \" &amp; _\n        \"[Excel 12.0;Provider=Microsoft.ACE.OLEDB.12.0;Mode=Read;Extended Properties='HDR=YES;'] \" &amp; _\n        \"UNION \" &amp; _\n        \"SELECT * FROM [Sheet1$] \" &amp; _\n        \"IN '\" &amp; ThisWorkbook.Path &amp; \"\\Source2.xlsx' \" &amp; _\n        \"[Excel 12.0;Provider=Microsoft.ACE.OLEDB.12.0;Mode=Read;Extended Properties='HDR=YES;'] \" &amp; _\n        \"UNION \" &amp; _\n        \"SELECT * FROM [Sheet1$] \" &amp; _\n        \"IN '\" &amp; ThisWorkbook.Path &amp; \"\\Source3.xlsx' \" &amp; _\n        \"[Excel 12.0;Provider=Microsoft.ACE.OLEDB.12.0;Mode=Read;Extended Properties='HDR=YES;'] \" &amp; _\n        \"ORDER BY ContactName;\"\n\n    Set objConnection = CreateObject(\"ADODB.Connection\")\n    objConnection.Open strConnection\n    Set objRecordSet = objConnection.Execute(strQuery)\n    RecordSetToWorksheet Sheets(1), objRecordSet\n    objConnection.Close\n\nEnd Sub\n\nSub RecordSetToWorksheet(objSheet As Worksheet, objRecordSet As Object)\n\n    Dim i As Long\n\n    With objSheet\n        .Cells.Delete\n        For i = 1 To objRecordSet.Fields.Count\n            .Cells(1, i).Value = objRecordSet.Fields(i - 1).Name\n        Next\n        .Cells(2, 1).CopyFromRecordset objRecordSet\n        .Cells.Columns.AutoFit\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Note, <code>ThisWorkbook.Path</code> should not contain <code>'</code> within path. Otherwise you have to escape them by replacing <code>'</code> with <code>''</code>.</p>\n\n<p>Also there are three <a href=\"https://www.w3schools.com/sql/trysql.asp?filename=trysql_select_all\" rel=\"nofollow noreferrer\">data source</a> files in the same folder as <code>Query.xlsm</code>.</p>\n\n<p><code>Source1.xlsx</code>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ArLtO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ArLtO.png\" alt=\"Source1.xlsx\"></a></p>\n\n<p><code>Source2.xlsx</code>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/LUTfK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LUTfK.png\" alt=\"Source2.xlsx\"></a></p>\n\n<p><code>Source3.xlsx</code>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/LlryC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LlryC.png\" alt=\"Source3.xlsx\"></a></p>\n\n<p>The resulting worksheet is as follows:</p>\n\n<p><a href=\"https://i.stack.imgur.com/auFC9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/auFC9.png\" alt=\"Query.xlsm result\"></a></p>\n\n<p>It works on 64-bit version Excel 2013 for me. To make it compatible with <code>.xls</code> and Excel 2003 (where the provider <code>ACE.OLEDB.12.0</code> isn't installed) you have to replace <code>Provider=Microsoft.ACE.OLEDB.12.0;</code> with <code>Provider=Microsoft.Jet.OLEDB.4.0;</code>, and also in extended properties <code>Excel 12.0 Macro;</code> / <code>Excel 12.0;</code> with <code>Excel 8.0;</code>. You can easily add <code>WHERE</code> clause and other SQL stuff to the query. Actually data source for connection object isn't limited the only <code>Query.xlsm</code> file, which the code placed in. It could be another data source, compatible with one of the available providers, either file-based or server-based. Find more connection strings for your data source on <a href=\"http://www.connectionstrings.com/\" rel=\"nofollow noreferrer\">http://www.connectionstrings.com/</a></p>\n"}], "owner": {"reputation": 61, "user_id": 5682960, "user_type": "registered", "profile_image": "https://graph.facebook.com/1126891514002328/picture?type=large", "display_name": "Abhishek Shrirang", "link": "https://stackoverflow.com/users/5682960/abhishek-shrirang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7838, "favorite_count": 3, "accepted_answer_id": 34376642, "answer_count": 1, "score": 5, "last_activity_date": 1533841254, "creation_date": 1450196796, "last_edit_date": 1533833348, "question_id": 34294382, "link": "https://stackoverflow.com/questions/34294382/how-to-join-two-recordset-created-from-two-different-data-source-in-excel-vba", "title": "How to join two recordset created from two different data source in excel vba", "body": "<p>My Scenario is -\nI have one set of data in .xls file and another set of data in oracle data base table. I want import both data using excel vba then perform join (sql like) and finally save the data in some workbook.</p>\n\n<p>Problem -\nI do not know how to get two different set of data in vba and then perform join.\nIn .Net there is DataSet object where we can save the imported data and then perform any query on it but vba How I can do this?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 516, "user_id": 5102865, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/71bf035de4fbcb43a6b9a1eb2d07c76e?s=128&d=identicon&r=PG&f=1", "display_name": "Sergey Ryabov", "link": "https://stackoverflow.com/users/5102865/sergey-ryabov"}, "edited": false, "score": 0, "creation_date": 1450197353, "post_id": 34294350, "comment_id": 56330712, "body": "Do you want it to be higher by 1 comparing to previous row? Or do you want to make a loop with certain number of records?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1450198021, "post_id": 34294350, "comment_id": 56331175, "body": "Do you want the 10000,10001... to reset each day or just keep incrementing regardless of the date?"}, {"owner": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1450198186, "post_id": 34294350, "comment_id": 56331281, "body": "@ScottCraner - Minor point, but he&#39;s actually looking for 4 decimal places.  It looks like 5 because of the way there is no space before the date."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "edited": false, "score": 0, "creation_date": 1450198307, "post_id": 34294350, "comment_id": 56331357, "body": "@Demetri you are correct.  The question still stands, just with 1000,1001..."}, {"owner": {"reputation": 25, "user_id": 5682939, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fryrfbEpMAE/AAAAAAAAAAI/AAAAAAAAEGk/9lVJ55r9rPA/photo.jpg?sz=128", "display_name": "ahmed samir", "link": "https://stackoverflow.com/users/5682939/ahmed-samir"}, "edited": false, "score": 0, "creation_date": 1450342276, "post_id": 34294350, "comment_id": 56401850, "body": "I want it incrementing regardless the date Thanks Scott Craner ,"}, {"owner": {"reputation": 25, "user_id": 5682939, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fryrfbEpMAE/AAAAAAAAAAI/AAAAAAAAEGk/9lVJ55r9rPA/photo.jpg?sz=128", "display_name": "ahmed samir", "link": "https://stackoverflow.com/users/5682939/ahmed-samir"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1450342454, "post_id": 34294350, "comment_id": 56401953, "body": "@ScottCraner I WANT IT just TO keep incrementing regardless of the date"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 5682939, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fryrfbEpMAE/AAAAAAAAAAI/AAAAAAAAEGk/9lVJ55r9rPA/photo.jpg?sz=128", "display_name": "ahmed samir", "link": "https://stackoverflow.com/users/5682939/ahmed-samir"}, "edited": false, "score": 0, "creation_date": 1470342639, "post_id": 34294799, "comment_id": 64925180, "body": "Hi demetri can u help me in my other question"}], "tags": [], "owner": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "is_accepted": true, "score": 0, "last_activity_date": 1450197908, "creation_date": 1450197908, "answer_id": 34294799, "question_id": 34294350, "link": "https://stackoverflow.com/questions/34294350/use-vba-for-generating-auto-reference-for-a-transaction/34294799#34294799", "title": "Use VBA for generating Auto reference for a transaction", "body": "<p>I would adjust the code like so:</p>\n\n<pre><code>Sub LeftArrow2_Click()\n\nDim RowCount As Long\nDim cell As Range, Rng As Range, i As Long\n\nRowCount = Worksheets(\"Sheet1\").Range(\"A1\").CurrentRegion.Rows.Count\nWith Worksheets(\"Sheet1\").Range(\"A1\")\n\n    .Offset(RowCount, 1).Value = Environ(\"username\")\n    ' Get the next index based on the prior index, if it existed, adding one to it.\n    On Error Resume Next: i = Val(Mid(.Offset(RowCount - 1, 0).Value, 5, 4)) + 1: On Error GoTo 0\n    ' Put the index in, formatted to 4 zeroes.\n    .Offset(RowCount, 0).Value = \"COMP\" &amp; Format(i, \"0000\") &amp; Date\n    .Offset(RowCount, 2).Value = Format(Now, \"dd/mm/yyyy hh:nn:ss\")\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "edited": false, "score": 0, "creation_date": 1450198060, "post_id": 34294811, "comment_id": 56331206, "body": "Well done - does what my solution does but better, and more compact."}, {"owner": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "edited": false, "score": 0, "creation_date": 1450198094, "post_id": 34294811, "comment_id": 56331225, "body": "The only thing I might add is the format to 4 zeroes."}, {"owner": {"reputation": 392, "user_id": 3099567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/938d9baf6e29eda581cd3d99ee9b45a2?s=128&d=identicon&r=PG&f=1", "display_name": "PankajR", "link": "https://stackoverflow.com/users/3099567/pankajr"}, "reply_to_user": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "edited": false, "score": 0, "creation_date": 1450198280, "post_id": 34294811, "comment_id": 56331335, "body": "@Demetri Infact your answer is better, since it includes error checking that  can occur when filling first row. and it also format for 4 digit number"}], "tags": [], "owner": {"reputation": 392, "user_id": 3099567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/938d9baf6e29eda581cd3d99ee9b45a2?s=128&d=identicon&r=PG&f=1", "display_name": "PankajR", "link": "https://stackoverflow.com/users/3099567/pankajr"}, "is_accepted": false, "score": 0, "last_activity_date": 1450197935, "creation_date": 1450197935, "answer_id": 34294811, "question_id": 34294350, "link": "https://stackoverflow.com/questions/34294350/use-vba-for-generating-auto-reference-for-a-transaction/34294811#34294811", "title": "Use VBA for generating Auto reference for a transaction", "body": "<p>Assuming you need transaction reference in column 1, try this:</p>\n\n<pre><code>Sub LeftArrow2_Click()\n Dim RowCount As Long\n\n Dim cell As Range, Rng As Range\n\n RowCount = Worksheets(\"Sheet1\").Range(\"A1\").CurrentRegion.Rows.Count\n\n With Worksheets(\"Sheet1\").Range(\"A1\")\n     .Offset(RowCount, 1).Value = Environ(\"username\")\n     .Offset(RowCount, 0).Value = \"COMP\" &amp; CInt(Mid(.Offset(RowCount-1, 0).Value, 5, 4)) + 1 &amp; Date\n     .Offset(RowCount, 2).Value = Format(Now, \"dd/mm/yyyy hh:nn:ss\")\n End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 5682939, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fryrfbEpMAE/AAAAAAAAAAI/AAAAAAAAEGk/9lVJ55r9rPA/photo.jpg?sz=128", "display_name": "ahmed samir", "link": "https://stackoverflow.com/users/5682939/ahmed-samir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 34294799, "answer_count": 2, "score": 0, "last_activity_date": 1450199759, "creation_date": 1450196690, "last_edit_date": 1450199759, "question_id": 34294350, "link": "https://stackoverflow.com/questions/34294350/use-vba-for-generating-auto-reference-for-a-transaction", "title": "Use VBA for generating Auto reference for a transaction", "body": "<p>I am  trying to write a code to generate auto transaction reference as well as assigning it to the employee ,could any one help me to find the equation for making it incremental as for example reference is <code>COMP100015/12/2015</code> , the next would be <code>COMP100115/12/2015</code></p>\n\n<p>Code I use:</p>\n\n<pre><code>Sub LeftArrow2_Click()\n Dim RowCount As Long\n\n Dim cell As Range, Rng As Range\n\nRowCount = Worksheets(\"Sheet1\").Range(\"A1\").CurrentRegion.Rows.Count\n  With Worksheets(\"Sheet1\").Range(\"A1\")\n\n  .Offset(RowCount, 1).Value = Environ(\"username\")\n  .Offset(RowCount, 0).Value = \"COMP\" &amp; Date\n  .Offset(RowCount, 2).Value = Format(Now, \"dd/mm/yyyy hh:nn:ss\")\n\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Result of this code:</p>\n\n<pre><code>reference   Officer                Date \nCOMP15/12/2015  aselhayani  15/12/2015 18:10:18\nCOMP15/12/2015  aselhayani  15/12/2015 18:10:19\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula", "evaluate"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1450196125, "post_id": 34294086, "comment_id": 56329701, "body": "You know how to use an esoteric function like <code>evaluate</code> but can&#39;t find last row O.o"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1450196218, "post_id": 34294086, "comment_id": 56329781, "body": "<a href=\"http://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba\">Find</a> the last row and store it in a variable like <code>lastrow</code> then: <code>i = Evaluate(&quot;MIN(IF((LEFT($B$1:$B$&quot; &amp; lastrow &amp; &quot;,5)*1)=C1,$B$1:$B$&quot; &amp; lastrow &amp; &quot;,&quot;&quot;&quot;&quot;))&quot;)</code>. Edit there is no <code>.</code> before <code>Evaluate</code>"}, {"owner": {"reputation": 65, "user_id": 5305387, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2230940463e3dbede18d8abbbbc8eb2f?s=128&d=identicon&r=PG&f=1", "display_name": "StarShines", "link": "https://stackoverflow.com/users/5305387/starshines"}, "edited": false, "score": 0, "creation_date": 1450197144, "post_id": 34294086, "comment_id": 56330567, "body": "Hi Scott, Thank you very much, I do know LR thingy but just couldn&#39;t understand how to use it in, as FindWindow said: esoteric, evaluate formula.     Sub Evaluation_Formula_w_LR()     Dim i As Long     Dim LR As Long     With Worksheets(&quot;Sheet1&quot;)         LR = .Cells(Rows.Count, 2).End(xlUp).Row         i = Evaluate(&quot;MIN(IF((LEFT($B$1:$B$&quot; &amp; LR &amp; &quot;,5)*1)=C1,$B$1:$B$&quot; &amp; LR &amp; &quot;,&quot;&quot;&quot;&quot;))&quot;)         .Range(&quot;F10&quot;).Value2 = i     End With End Sub"}, {"owner": {"reputation": 65, "user_id": 5305387, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2230940463e3dbede18d8abbbbc8eb2f?s=128&d=identicon&r=PG&f=1", "display_name": "StarShines", "link": "https://stackoverflow.com/users/5305387/starshines"}, "edited": false, "score": 0, "creation_date": 1450197357, "post_id": 34294086, "comment_id": 56330713, "body": "Yes, it works <i>like</i> a charm. How can I add code in replies here on SF btw ? I couldn&#39;t post my new code :( properly"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1450197435, "post_id": 34294086, "comment_id": 56330778, "body": "You can&#39;t add them to the comments,  either add it as and answer or back on the original post."}], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1450197790, "post_id": 34294656, "comment_id": 56331015, "body": "I made a little edit.  When you can mark it as correct."}, {"owner": {"reputation": 65, "user_id": 5305387, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2230940463e3dbede18d8abbbbc8eb2f?s=128&d=identicon&r=PG&f=1", "display_name": "StarShines", "link": "https://stackoverflow.com/users/5305387/starshines"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1450197970, "post_id": 34294656, "comment_id": 56331137, "body": "May I know how to do that please ? :)"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1450198067, "post_id": 34294656, "comment_id": 56331208, "body": "Eventually there will be a green check mark beside the answer.  click on it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1450198152, "post_id": 34294656, "comment_id": 56331264, "body": "btw, the empty quotes in the latter half of the IF formula are completely unnecessary and only serve to confuse the issue at hand. You can mark a self-answered post as the accepted answer after 48 hours."}, {"owner": {"reputation": 65, "user_id": 5305387, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2230940463e3dbede18d8abbbbc8eb2f?s=128&d=identicon&r=PG&f=1", "display_name": "StarShines", "link": "https://stackoverflow.com/users/5305387/starshines"}, "edited": false, "score": 0, "creation_date": 1450198939, "post_id": 34294656, "comment_id": 56331768, "body": "Which quotes you are talking about ? ...LR &amp; &quot;,&quot;&quot;&quot;&quot;))&quot;)...If I remove two of them, it gives me Type Mismatch error."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1450199202, "post_id": 34294656, "comment_id": 56331945, "body": "The Third criteria in the if statement is not needed, If it is false then it is going to through an error regardless of the third criteria.  So <code>Evaluate(&quot;MIN(IF((LEFT($B$1:$B$&quot; &amp; LR &amp; &quot;,5)*1)=C1,$B$1:$B$&quot; &amp; LR &amp; &quot;))&quot;)</code>"}, {"owner": {"reputation": 65, "user_id": 5305387, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2230940463e3dbede18d8abbbbc8eb2f?s=128&d=identicon&r=PG&f=1", "display_name": "StarShines", "link": "https://stackoverflow.com/users/5305387/starshines"}, "edited": false, "score": 0, "creation_date": 1450199698, "post_id": 34294656, "comment_id": 56332259, "body": "Oh I got it now. Thanks for your help Scott and Jeeped :)"}], "tags": [], "owner": {"reputation": 65, "user_id": 5305387, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2230940463e3dbede18d8abbbbc8eb2f?s=128&d=identicon&r=PG&f=1", "display_name": "StarShines", "link": "https://stackoverflow.com/users/5305387/starshines"}, "is_accepted": true, "score": 1, "last_activity_date": 1450197743, "last_edit_date": 1450197743, "creation_date": 1450197528, "answer_id": 34294656, "question_id": 34294086, "link": "https://stackoverflow.com/questions/34294086/last-row-in-excel-vba-evaluate/34294656#34294656", "title": "Last Row in Excel VBA Evaluate", "body": "<p>I guess this will post proper code:</p>\n\n<pre><code>Sub Evaluation_Formula_w_LR()\nDim i As Long\nDim LR As Long\nWith Worksheets(\"Sheet1\")\n    LR = .Cells(.Rows.Count, 2).End(xlUp).Row\n    i = Evaluate(\"MIN(IF((LEFT($B$1:$B$\" &amp; LR &amp; \",5)*1)=C1,$B$1:$B$\" &amp; LR &amp; \",\"\"\"\"))\")\n    .Range(\"F10\").Value2 = i\nEnd With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 65, "user_id": 5305387, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2230940463e3dbede18d8abbbbc8eb2f?s=128&d=identicon&r=PG&f=1", "display_name": "StarShines", "link": "https://stackoverflow.com/users/5305387/starshines"}, "edited": false, "score": 0, "creation_date": 1450200135, "post_id": 34295396, "comment_id": 56332545, "body": "Aaahhh lovely....thanks a million Jeeped, that&#39;s one comprehensive answer. God Bless You :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 65, "user_id": 5305387, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2230940463e3dbede18d8abbbbc8eb2f?s=128&d=identicon&r=PG&f=1", "display_name": "StarShines", "link": "https://stackoverflow.com/users/5305387/starshines"}, "edited": false, "score": 0, "creation_date": 1450200326, "post_id": 34295396, "comment_id": 56332683, "body": "@StarShines - and thank YOU for asking a decent question that showed both research and effort on your part."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 3, "last_activity_date": 1450199659, "creation_date": 1450199659, "answer_id": 34295396, "question_id": 34294086, "link": "https://stackoverflow.com/questions/34294086/last-row-in-excel-vba-evaluate/34295396#34295396", "title": "Last Row in Excel VBA Evaluate", "body": "<p>For all intents and purposes you are really only concerned with the last number in column B, not specifically the last row. To do that in a worksheet formula you would use something like this array formula.</p>\n\n<pre><code>=MIN(IF(--LEFT(B1:INDEX(B:B, MATCH(1E+99,B:B )),5)=C1, B1:INDEX(B:B, MATCH(1E+99,B:B))))\n</code></pre>\n\n<p>That can translate into your VBA <a href=\"https://msdn.microsoft.com/en-us/library/office/ff193019.aspx\" rel=\"nofollow\">Evaluate method</a> like the following.</p>\n\n<pre><code>Sub Evaluation_Formula()\n    Dim i As Long\n    With Worksheets(\"Sheet1\")\n        i = .Evaluate(\"MIN(IF(--LEFT(B1:INDEX(B:B, MATCH(1E+99,B:B )),5)=C1, B1:INDEX(B:B, MATCH(1E+99,B:B))))\")\n        .Range(\"F3\").Value2 = i\n    End With\nEnd Sub\n</code></pre>\n\n<p>The <strong>double unary</strong> (aka <em>double-minus</em> or <code>--</code>) does the same job as multiplying the text result from the <a href=\"https://support.office.com/en-us/article/LEFT-function-BE3191EA-D332-43E4-BAC3-810C97773A22\" rel=\"nofollow\">LEFT function</a> by 1. There is no need to pass a zero-length string (e.g. <code>\"\"</code>) in as the FALSE is sufficient for non-matches in the IF function. Since you are evaluating text into a formula, there is no need for the <code>$</code> absolute markers.</p>\n\n<p>Keep the <code>.</code> in <code>.Evaluate</code> or add the worksheet name to the cell references in the formula. Without it you run the risk of evaluating another worksheet's B1:B89 and C1 cells if <strong>Sheet1</strong> does not hold the workbook's <a href=\"https://msdn.microsoft.com/en-us/library/office/ff822753.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\">ActiveSheet property</a>.</p>\n"}], "owner": {"reputation": 65, "user_id": 5305387, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2230940463e3dbede18d8abbbbc8eb2f?s=128&d=identicon&r=PG&f=1", "display_name": "StarShines", "link": "https://stackoverflow.com/users/5305387/starshines"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 262, "favorite_count": 0, "accepted_answer_id": 34294656, "answer_count": 2, "score": 1, "last_activity_date": 1450200101, "creation_date": 1450196024, "last_edit_date": 1450200101, "question_id": 34294086, "link": "https://stackoverflow.com/questions/34294086/last-row-in-excel-vba-evaluate", "title": "Last Row in Excel VBA Evaluate", "body": "<p>I am using the below code:</p>\n\n<pre><code>Sub Evaluation_Formula()\n    Dim i As Long\n    With Worksheets(\"Sheet1\")\n        i = .Evaluate(\"MIN(IF((LEFT($B$1:$B$89,5)*1)=C1,$B$1:$B$89,\"\"\"\"))\")\n        .Range(\"F3\").Value2 = i\n    End With\nEnd Sub\n</code></pre>\n\n<p>However, the formula is limited to B89, how can I use Last Row in Column B in the formula ?</p>\n"}, {"tags": ["vba", "excel", "authentication", "excel-web-query"], "answers": [{"comments": [{"owner": {"reputation": 3844, "user_id": 165034, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e4cd88ee8e08972785d3b6711735aae4?s=128&d=identicon&r=PG", "display_name": "Josh", "link": "https://stackoverflow.com/users/165034/josh"}, "edited": false, "score": 0, "creation_date": 1450214305, "post_id": 34299102, "comment_id": 56341013, "body": "Ick. Really? There&#39;s no direct way to do this, and keep authentication persistent even when the spreadsheet is reloaded?  I think I&#39;ll have to take my alternative option, which is to write a stupid PHP in the middle that takes the user and password as POST arguments, talks to the &quot;real&quot; script with curl using basic auth, and spits back the results to the WebQuery. Disappointing."}, {"owner": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "reply_to_user": {"reputation": 3844, "user_id": 165034, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e4cd88ee8e08972785d3b6711735aae4?s=128&d=identicon&r=PG", "display_name": "Josh", "link": "https://stackoverflow.com/users/165034/josh"}, "edited": false, "score": 0, "creation_date": 1450214646, "post_id": 34299102, "comment_id": 56341204, "body": "I&#39;m sure there are probably lots of other ways to do it, but VBA is not known for its eloquence. That just happens to be a pretty easy way to have the macro log on for you."}], "tags": [], "owner": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "is_accepted": false, "score": 0, "last_activity_date": 1450212501, "creation_date": 1450212501, "answer_id": 34299102, "question_id": 34294068, "link": "https://stackoverflow.com/questions/34294068/basic-authentication-with-excel-vba-webquery/34299102#34299102", "title": "Basic Authentication with Excel VBA &quot;WebQuery&quot;?", "body": "<p>You have to go into the source code and find id's for the button, username textbox and password textbox then something like:</p>\n\n<pre><code> If objExist(\"LoginButton id\", IE) Then\n                    .Document.getElementById(\"username textbox id\").Value = \"username\"\n                    .Document.getElementById(\"password textbox id\").Value = \"password\"\n                    .Document.getElementById(\"LoginButton id\").Click \n End If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3844, "user_id": 165034, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e4cd88ee8e08972785d3b6711735aae4?s=128&d=identicon&r=PG", "display_name": "Josh", "link": "https://stackoverflow.com/users/165034/josh"}, "edited": false, "score": 0, "creation_date": 1450217555, "post_id": 34300363, "comment_id": 56342777, "body": "Yeah this is entirely something I&#39;m doing to be able to Refresh simple requests in the background without rewriting it in VBA and probably screwing something up. It&#39;s part of a larger codebase that already uses MSXML for &quot;non-refreshing&quot; requests which works fine."}], "tags": [], "owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "is_accepted": false, "score": 0, "last_activity_date": 1450217341, "creation_date": 1450217341, "answer_id": 34300363, "question_id": 34294068, "link": "https://stackoverflow.com/questions/34294068/basic-authentication-with-excel-vba-webquery/34300363#34300363", "title": "Basic Authentication with Excel VBA &quot;WebQuery&quot;?", "body": "<p>If you want to use QueryTables, authentication is tricky. So much so that it's not even worth it, IMO. Excel uses different cookies than IE. So even if you authenticated via IE, the QueryTable wouldn't recognize it. If you authenticate via the Web Query interface, then it sets the proper cookie and you can automate. </p>\n\n<p>The right way is to avoid the QueryTable and do it all yourself through the MS XML object library. Create an HTTP Request object, send a POST request, etc. If it's not RESTFUL, I think you have to use a HTTPServer object. See JP's comment at <a href=\"http://dailydoseofexcel.com/archives/2011/03/08/get-data-from-website-that-requires-a-login/\" rel=\"nofollow\">http://dailydoseofexcel.com/archives/2011/03/08/get-data-from-website-that-requires-a-login/</a> for more information on using XML.</p>\n\n<p>Of course that's a lot more work because you have to do all the stuff the querytable would normally do. And you have to handle refreshes if you want that function. </p>\n"}, {"tags": [], "owner": {"reputation": 3844, "user_id": 165034, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e4cd88ee8e08972785d3b6711735aae4?s=128&d=identicon&r=PG", "display_name": "Josh", "link": "https://stackoverflow.com/users/165034/josh"}, "is_accepted": false, "score": 0, "last_activity_date": 1450217721, "creation_date": 1450217721, "answer_id": 34300453, "question_id": 34294068, "link": "https://stackoverflow.com/questions/34294068/basic-authentication-with-excel-vba-webquery/34300453#34300453", "title": "Basic Authentication with Excel VBA &quot;WebQuery&quot;?", "body": "<p>Judging by other answers, I think my correct course of action is not to even try and get WebQuery to authenticate, and to use a server-side script in the middle that takes userid and password as POST arguments and communicates through to the \"real\" back-end over Basic Auth.  </p>\n\n<p>I've already written and tested one, and this seems to solve the actual problem I am trying to address.</p>\n"}], "owner": {"reputation": 3844, "user_id": 165034, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e4cd88ee8e08972785d3b6711735aae4?s=128&d=identicon&r=PG", "display_name": "Josh", "link": "https://stackoverflow.com/users/165034/josh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4546, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1450217721, "creation_date": 1450195973, "last_edit_date": 1531164843, "question_id": 34294068, "link": "https://stackoverflow.com/questions/34294068/basic-authentication-with-excel-vba-webquery", "title": "Basic Authentication with Excel VBA &quot;WebQuery&quot;?", "body": "<p>In VBA I am trying to leverage WebQuery for a tool I am writing that retrieves financial data.<br>\nI create a WebQuery with similar code to this:</p>\n\n<pre><code>    url = \"URL;http://my.url.com/\"\n    With Worksheets(\"Sheet1\").QueryTables.Add(Connection:=url, Destination:=Worksheets(\"Sheet1\").Range(\"A1\"))\n    .PostText = \"Param1=Foo&amp;Param2=Bar\"\n    .Name = \"My Query\"\n    .RowNumbers = False\n    .FillAdjacentFormulas = False\n    .PreserveFormatting = True\n    .RefreshOnFileOpen = False\n    .BackgroundQuery = True\n    .RefreshStyle = xlOverwriteCells\n    .SavePassword = False\n    .SaveData = True\n    .AdjustColumnWidth = True\n    .RefreshPeriod = 1\n    .WebSelectionType = xlEntirePage\n    .WebFormatting = xlWebFormattingNone\n    .WebPreFormattedTextToColumns = True\n    .WebConsecutiveDelimitersAsOne = True\n    .WebSingleBlockTextImport = False\n    .WebDisableDateRecognition = False\n    .WebDisableRedirections = False\n    .Refresh BackgroundQuery:=False\nEnd With\n</code></pre>\n\n<p>The problem I am coming across is that <strong>my.url.com</strong> requires a <a href=\"https://en.wikipedia.org/wiki/Basic_access_authentication\" rel=\"nofollow\">Basic Authentication</a> userid and password.<br>\nIf I simply run this code, I get a Runtime Error 1004; it does not prompt for authentication credentials.</p>\n\n<p>But if I go into the Excel \"Data\" ribbon, select \"From Web\", and then go to <a href=\"http://my.url.com/\" rel=\"nofollow\">http://my.url.com/</a> in their mini web browser, I am prompted for userid and password.<br>\nAfter closing this window and then re-running my VBA code without changing anything, the query works.\nBut upon closing Excel and re-running, it fails again unless I go through this extremely ugly manual authentication step. Even if I have told Internet Explorer to save these credentials permanently.</p>\n\n<p>How can I get VBA to <em>programmatically</em> authenticate a <strong>WebQuery</strong> with Basic Authentication so I don't need to take this extra step?  </p>\n\n<p>(<strong>Edit:</strong> Either this, or is there a setting within Excel to force this prompt to happen, regardless of how the WebQuery was initiated?)</p>\n\n<p>I am using Excel 2010 (32-bit), on Windows 7, but my target users might be using a variety of Excel versions (all on Windows).</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1450195177, "post_id": 34293671, "comment_id": 56329010, "body": "Can we see your full code that you have attempted?  It is difficult to find fault in one line."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1450195229, "post_id": 34293671, "comment_id": 56329049, "body": "What are the names of your 2 workbooks? And what is the sheet name that you want to paste the names in?"}, {"owner": {"reputation": 581, "user_id": 5682727, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dd5bd3fafa950c4d6eb0ac8a83954cec?s=128&d=identicon&r=PG&f=1", "display_name": "John B. Walugembe", "link": "https://stackoverflow.com/users/5682727/john-b-walugembe"}, "edited": false, "score": 0, "creation_date": 1507875144, "post_id": 34293671, "comment_id": 80393316, "body": "In addition to the correct VBA answers, the problem could also be solved by selecting all the tabs for the worksheets of interest and applying the following formula in cell B1 of the current worksheet: <code>=RIGHT(CELL(&quot;filename&quot;,A1),LEN(CELL(&quot;filename&quot;,A1))-SEARCH(&quot;&zwnj;&#8203;]&quot;,CELL(&quot;filename&quot;,A&zwnj;&#8203;1)))</code>      Courtesy phantom1975 at <a href=\"https://www.mrexcel.com/forum/excel-questions/33252-formula-get-worksheet-name-solved.html\" rel=\"nofollow noreferrer\">mrexcel.com/forum/excel-questions/&hellip;</a>."}], "answers": [{"tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 0, "last_activity_date": 1450195535, "creation_date": 1450195535, "answer_id": 34293887, "question_id": 34293671, "link": "https://stackoverflow.com/questions/34293671/paste-worksheet-names-in-multiple-worksheets/34293887#34293887", "title": "Paste worksheet names in multiple worksheets", "body": "<p>So with this code, that you'll paste in the destination workbook, <br>\nyou'll just need to change :</p>\n\n<ol>\n<li><code>workbook_to_scan's Name</code> and </li>\n<li><code>Sheet's name in which to paste the names</code> </li>\n</ol>\n\n<p>to fit your needs!</p>\n\n<pre><code>Sub test_johnB()\nDim wB1 As Workbook, _\n    wB2 As Workbook, _\n    wSDest As Worksheet, _\n    wS As Worksheet, _\n    i As Integer\n\nSet wB1 = ThisWorkbook\nSet wB2 = Workbooks(\"workbook_to_scan's Name\")\nSet wSDest = wB1.Sheets(\"Sheet's name in which to paste the names\")\n\ni = 0\nFor Each wS In wB2.Sheets\n   wSDest.Range(\"B1\").Offset(i, 0) = wS.Name\nNext wS\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 2, "last_activity_date": 1450196051, "last_edit_date": 1495535240, "creation_date": 1450195684, "answer_id": 34293950, "question_id": 34293671, "link": "https://stackoverflow.com/questions/34293671/paste-worksheet-names-in-multiple-worksheets/34293950#34293950", "title": "Paste worksheet names in multiple worksheets", "body": "<p>Avoid relying on the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff822753.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">ActiveSheet property</a> to identify the worksheet you want to process. The <a href=\"https://msdn.microsoft.com/en-us/library/wc500chb.aspx\" rel=\"nofollow noreferrer\">With ... End With statement</a> can readily provide the worksheet and help retrieve the Worksheet <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196974.aspx\" rel=\"nofollow noreferrer\">.Name property</a>.</p>\n\n<pre><code>Sub name_Worksheets()\n    Dim w As Long\n\n    For w = 1 To 30\n        With Worksheets(w)\n            .Cells(1, 2) = .Name\n        End With\n    Next w\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><sub>See <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid using Select in Excel VBA macros</a> for more methods on getting away from relying on select and activate to accomplish your goals.</sub></p>\n"}, {"tags": [], "owner": {"reputation": 255, "user_id": 2977498, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e428db2f7d16874d410ca76becc84455?s=128&d=identicon&r=PG&f=1", "display_name": "Ollie", "link": "https://stackoverflow.com/users/2977498/ollie"}, "is_accepted": false, "score": 2, "last_activity_date": 1450195782, "creation_date": 1450195782, "answer_id": 34293977, "question_id": 34293671, "link": "https://stackoverflow.com/questions/34293671/paste-worksheet-names-in-multiple-worksheets/34293977#34293977", "title": "Paste worksheet names in multiple worksheets", "body": "<p>My Understanding is you want to 1) Go through first 30 sheets of your workbook and 2) Paste the sheet name into cell B1.</p>\n\n<pre><code>Sub PasteSheetNameInB1()\n\n    For i = 1 To 30 '(1 to 30 because you said \" I would like it to get the names of the first 30 worksheets only.\")\n        ActiveWorkbook.Sheets(i).Select 'Iterates through first 30 sheets\n        Range(\"B1\") = ActiveSheet.Name 'Pastes Sheet name into B1\n    Next i\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "is_accepted": false, "score": 2, "last_activity_date": 1450203607, "creation_date": 1450203607, "answer_id": 34296615, "question_id": 34293671, "link": "https://stackoverflow.com/questions/34293671/paste-worksheet-names-in-multiple-worksheets/34296615#34296615", "title": "Paste worksheet names in multiple worksheets", "body": "<p>You can use this code:</p>\n\n<pre><code>For i = 1 To 30\n Sheets(i).Range(\"B1\").Formula = \"=MID(CELL(\"\"filename\"\",A1),FIND(\"\"]\"\",CELL(\"\"filename\"\",A1))+1,255)\"\nNext\n</code></pre>\n\n<p>Now if you change the name of any worksheet, You don't need to run the macro again, the formula in Rnage(\"B1\") will display the new name.</p>\n"}], "owner": {"reputation": 581, "user_id": 5682727, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dd5bd3fafa950c4d6eb0ac8a83954cec?s=128&d=identicon&r=PG&f=1", "display_name": "John B. Walugembe", "link": "https://stackoverflow.com/users/5682727/john-b-walugembe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1645, "favorite_count": 0, "accepted_answer_id": 34293950, "answer_count": 4, "score": 2, "last_activity_date": 1450203607, "creation_date": 1450194946, "last_edit_date": 1450196414, "question_id": 34293671, "link": "https://stackoverflow.com/questions/34293671/paste-worksheet-names-in-multiple-worksheets", "title": "Paste worksheet names in multiple worksheets", "body": "<p>I have a workbook with over 50 worksheets. I would like to copy the name of each worksheet into a cell of that particular workbook. I can do it for one sheet at a time using a macro with the following VBA code: </p>\n\n<pre><code>Range(\"B1\") = ActiveSheet.Name\n</code></pre>\n\n<p>But when I try to apply the macro to several worksheets at a time, it fails. I would like it to get the names of the first 30 worksheets only.</p>\n"}, {"tags": ["excel", "vba", "text"], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 5376569, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iqpz2.jpg?s=128&g=1", "display_name": "Amostafa", "link": "https://stackoverflow.com/users/5376569/amostafa"}, "edited": false, "score": 0, "creation_date": 1450197408, "post_id": 34293834, "comment_id": 56330752, "body": "The trim line works fine but the empty line goes to the address twice and duplicates entries   EDIT: Nvm, fixed! Thank you"}], "tags": [], "owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "is_accepted": true, "score": 2, "last_activity_date": 1450195380, "creation_date": 1450195380, "answer_id": 34293834, "question_id": 34293475, "link": "https://stackoverflow.com/questions/34293475/ignoring-blank-lines-and-spaces-in-text-files-when-reading/34293834#34293834", "title": "Ignoring blank lines and spaces in text files when reading", "body": "<p>You will add two lines which will ignore blank lines and spaces like this:  </p>\n\n<pre><code>Line Input #1, SourceFile\nSourceFile = Trim(SourceFile)    '~~&gt; This will trim all the spaces\nIf Not SourceFile = \"\" Then      '~~&gt; This will check if lines is empty\n    Set Source = Workbooks.Open(SourceFile)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": false, "score": 1, "last_activity_date": 1450328180, "creation_date": 1450328180, "answer_id": 34326891, "question_id": 34293475, "link": "https://stackoverflow.com/questions/34293475/ignoring-blank-lines-and-spaces-in-text-files-when-reading/34326891#34326891", "title": "Ignoring blank lines and spaces in text files when reading", "body": "<p>Suggest you add further code to </p>\n\n<ul>\n<li>test if the file actually exists</li>\n<li>test if the file is of a valid type for excel to open</li>\n</ul>\n\n<p><em>code</em></p>\n\n<pre><code>Dim SourceFile As String\nDim PathFile As String\nSet ActiveBook = Application.ActiveWorkbook\n\nPathFile = ActiveWorkbook.Path &amp; \"\\FilePaths.txt\"\nOpen PathFile For Input As #1\n\nDo Until EOF(1)\n    Line Input #1, SourceFile\n    SourceFile = Trim$(SourceFile)\n    If Len(Dir(ActiveWorkbook.Path &amp; \"\\\" &amp; SourceFile)) &gt; 0 Then\n         Select Case Right$(SourceFile, Len(SourceFile) - InStrRev(SourceFile, \".\"))\n         Case \"xls\", \"xls*\"\n         Set Source = Workbooks.Open(ActiveWorkbook.Path &amp; \"\\\" &amp; SourceFile)\n         Case Else\n         Debug.Print \"source not valid\"\n         End Select\n    End If\nLoop\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 5376569, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iqpz2.jpg?s=128&g=1", "display_name": "Amostafa", "link": "https://stackoverflow.com/users/5376569/amostafa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1849, "favorite_count": 0, "accepted_answer_id": 34293834, "answer_count": 2, "score": 1, "last_activity_date": 1450328211, "creation_date": 1450194419, "last_edit_date": 1450328211, "question_id": 34293475, "link": "https://stackoverflow.com/questions/34293475/ignoring-blank-lines-and-spaces-in-text-files-when-reading", "title": "Ignoring blank lines and spaces in text files when reading", "body": "<p>I have a text file with file addresses listed line by line. </p>\n\n<p>Sometimes, however, the users go in there and accidentally add a space or a blank line between the addresses and that crashes the entire code.  </p>\n\n<p>How could I avoid this when reading the file using VBA?</p>\n\n<p>This is the current block used to open the text file and read addresses line by line:</p>\n\n<pre><code>Set ActiveBook = Application.ActiveWorkbook\n\nPathFile = ActiveWorkbook.Path &amp; \"\\FilePaths.txt\"\nOpen PathFile For Input As #1\n\nDo Until EOF(1)\n    Line Input #1, SourceFile            \n    Set Source = Workbooks.Open(SourceFile)\n</code></pre>\n"}]