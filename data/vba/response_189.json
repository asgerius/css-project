[{"tags": ["excel", "vba", "autofilter"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1534982074, "post_id": 51976507, "comment_id": 90903399, "body": "Kudos for qualified ranges :)"}], "answers": [{"tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": true, "score": 0, "last_activity_date": 1534982943, "last_edit_date": 1534982943, "creation_date": 1534982053, "answer_id": 51976645, "question_id": 51976507, "link": "https://stackoverflow.com/questions/51976507/paste-special-with-autofilter-and-unfilter-after-autofilter-and-paste-is-complet/51976645#51976645", "title": "Paste special with autofilter and unfilter after autofilter and paste is complete", "body": "<p>Disable <code>Alert</code> to by-pass the alert, </p>\n\n<pre><code>Application.DisplayAlerts = False\n    copyRange4.SpecialCells(xlCellTypeVisible).Copy tgt.Range(\"E10\")\nApplication.DisplayAlerts = True\n</code></pre>\n\n<hr>\n\n<p>To unfilter, </p>\n\n<pre><code>If (Range).AutoFilterMode Then\n    (Range).ShowAllData\nEnd If\n</code></pre>\n\n<p>Where <code>(Range)</code> is your range with filter. </p>\n"}], "owner": {"reputation": 3, "user_id": 7863139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac60b0f50971a391220082b27971fab9?s=128&d=identicon&r=PG&f=1", "display_name": "DHGS11", "link": "https://stackoverflow.com/users/7863139/dhgs11"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 51976645, "answer_count": 1, "score": 0, "last_activity_date": 1534982943, "creation_date": 1534980921, "last_edit_date": 1534981854, "question_id": 51976507, "link": "https://stackoverflow.com/questions/51976507/paste-special-with-autofilter-and-unfilter-after-autofilter-and-paste-is-complet", "title": "Paste special with autofilter and unfilter after autofilter and paste is complete", "body": "<p>I am using the solution from <a href=\"https://stackoverflow.com/questions/17531128/copy-paste-calculate-visible-cells-from-one-column-of-a-filtered-table\">this post</a> to autofilter a table and paste the selected columns to another sheet.</p>\n\n<p>It is doing exactly what I want it to do with one exception. I am copying from a table that uses filtered drop down menus. As a result, the following message pops up while copying: <a href=\"http://samirvaidya.blogspot.com/2015/01/name-already-exists-dialog-in-microsoft.html\" rel=\"nofollow noreferrer\">The name already exists</a></p>\n\n<p>The solution offered in this blog is not an option as the source table is dependent on the named values in it.</p>\n\n<p>Is there an additional statement I can add to the below code that will make it paste special?</p>\n\n<pre><code>  copyRange4.SpecialCells(xlCellTypeVisible).Copy tgt.Range(\"E10\")\n</code></pre>\n\n<p>If not, can something be added to select \"Yes\" without the pop up appearing at all?</p>\n\n<p>Finally, after it pastes to my target, can an additional line be added to unfilter the source?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 5814, "user_id": 4408538, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cPoEu.jpg?s=128&g=1", "display_name": "Joseph Wood", "link": "https://stackoverflow.com/users/4408538/joseph-wood"}, "edited": false, "score": 4, "creation_date": 1534981415, "post_id": 51976432, "comment_id": 90903290, "body": "It&#39;s not really clear what the OP is after, but I&#39;d say you did a pretty good job of <i>deciphering</i> the meaning..  Nice job"}], "tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": true, "score": 5, "last_activity_date": 1534981132, "last_edit_date": 1534981132, "creation_date": 1534980096, "answer_id": 51976432, "question_id": 51976371, "link": "https://stackoverflow.com/questions/51976371/vba-encryption-method/51976432#51976432", "title": "VBA Encryption Method", "body": "<p>You would need to change the <a href=\"https://docs.microsoft.com/en-us/office/vba/Language/Concepts/Getting-Started/calling-sub-and-function-procedures\" rel=\"noreferrer\">Sub Routine to a Function</a>. Also, get rid of the <code>Private</code> keyword as this will not allow you to call it across different modules.</p>\n\n<p>So Change this:</p>\n\n<pre><code>Private Sub Encryption()\n   'Encryption method of string Var\nEnd Sub\n</code></pre>\n\n<p>to this:</p>\n\n<pre><code>Function Encryption(ByVal inputString as String) As String\n   'Encryption method of string Var\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Now, inside your function you need to change whatever variable holds the first string (the one to be encrypted) to the newly created variable, <code>inputString</code>. It's hard to help you in this area as you did not provide the full code for <code>Sub Encryption()</code>.</p>\n\n<p>Also, ensure that you set the <strong>Function</strong> name itself to the newly encrypted text within the function. So your function would essentially look as follows:</p>\n\n<pre><code>Function Encryption(ByVal inputString as String) As String\n   'Encryption method of string Var\n    Encryption = 'the value to return from this function        \nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Now, your second sub would look like this:</p>\n\n<pre><code>Private Sub test()\n   Dim Text as String, encryptedText as String\n   Text = \"Hello\"\n   encryptedText = Encryption(Text)\nEnd Sub\n</code></pre>\n\n<p>You will just make the new variable <code>encryptedText</code> equal to the new function, <code>Encryption</code>.</p>\n\n<hr>\n\n<p>So, the major difference between a <code>Sub</code> and a <code>Function</code> is that a Function will <em>return values</em>. They both essentially process code the same way.</p>\n\n<h2>METHOD 2 (Edit)</h2>\n\n<p>After rethinking your question, I believe that you were using your Sub to obtain your encrypted text from passing the variable as <code>ByRef</code>, and you may just be having difficulties with calling the Sub because of the <code>Private</code> keyword.</p>\n\n<p>If this what was going on, then you can simply remove the Private keyword and it should work as intended. </p>\n\n<p>So your Sub should look like:</p>\n\n<pre><code>Sub Encryption()    '&lt;-- Notice, no Private scope\n   'Encryption method of string Var\nEnd Sub\n</code></pre>\n\n<p>or</p>\n\n<pre><code>Public Sub Encryption()\n   'Encryption method of string Var\nEnd Sub\n</code></pre>\n\n<p>You should take a <a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/programming-guide/language-features/declared-elements/scope\" rel=\"noreferrer\">look at this</a> for additional reading regarding scope.</p>\n"}], "owner": {"reputation": 1009, "user_id": 8981066, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HFh7Jm-OT-E/AAAAAAAAAAI/AAAAAAAABl8/oDH6HzC4eFw/photo.jpg?sz=128", "display_name": "Oday Salim", "link": "https://stackoverflow.com/users/8981066/oday-salim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1114, "favorite_count": 0, "accepted_answer_id": 51976432, "answer_count": 1, "score": 1, "last_activity_date": 1534981132, "creation_date": 1534979620, "question_id": 51976371, "link": "https://stackoverflow.com/questions/51976371/vba-encryption-method", "title": "VBA Encryption Method", "body": "<p>I have written a very simple Ceaser Cipher encryption algorithm on VBA. It takes a string value and applies <em>x</em> shift. </p>\n\n<p>Quite happy with it. However, would like to take it to the next step, but I am not sure if it is doable. </p>\n\n<p>I would like to call this encryption function in another module and pass a string value to encrypt. </p>\n\n<p>I.e. What I am trying to do is something like this</p>\n\n<pre><code>Private Sub Encryption()\n   'Encryption method of string Var\nEnd Sub\n</code></pre>\n\n<p>---- and in another sub ----</p>\n\n<pre><code>Private Sub function()\n   Dim Text as String\n   Text = \"Hello\"\n   Encryption(Text)\nEnd Sub\n</code></pre>\n\n<p>So in this example, I have defined a method to encrypt any string variable. In the other function, I defined a string and initialised it as \"Hello\". Then called Encryption function on it... Not sure if this is doable in VBA?</p>\n\n<p>I am not sure how I could pass in a variable when I am calling a function within a function. Any advise please?</p>\n"}, {"tags": ["vba", "sap-gui"], "comments": [{"owner": {"reputation": 3167, "user_id": 1751825, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c157caf2d0f9ff38e5a9820315c0a15f?s=128&d=identicon&r=PG&f=1", "display_name": "user1751825", "link": "https://stackoverflow.com/users/1751825/user1751825"}, "edited": false, "score": 0, "creation_date": 1534977869, "post_id": 51976101, "comment_id": 90902604, "body": "Can you provide more detail about what doesn&#39;t work. Does it error, or just not behave as you&#39;re expecting?"}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 1, "creation_date": 1534978168, "post_id": 51976101, "comment_id": 90902675, "body": "Welcome. Just remember we can&#39;t run your code or see your screen. Your question doesn&#39;t explain the actual problem. Does your code throw an error? Whats the error and what line? Does it not behave as expected? Explain what happens. Please don&#39;t write &quot;nothing happens&quot; or &quot;it doesn&#39;t work&quot;."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1534978274, "post_id": 51976101, "comment_id": 90902698, "body": "When you say VBScript, do you mean that you&#39;re running this from a .vbs file or from a VBA procedure from inside of Excel?"}], "answers": [{"comments": [{"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1535077136, "post_id": 51989828, "comment_id": 90942525, "body": "Feedback for your next question: post the error!!! Words like &#39;Does not work&#39; and &#39;does not run&#39; means absolutely nothing."}, {"owner": {"reputation": 6762, "user_id": 845655, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ySyzL.jpg?s=128&g=1", "display_name": "DeanOC", "link": "https://stackoverflow.com/users/845655/deanoc"}, "edited": false, "score": 0, "creation_date": 1535077626, "post_id": 51989828, "comment_id": 90942613, "body": "Glad you got a solution, and thanks for posting it as an answer (new contributors often just edit the question). BTW, your first 3 <code>IF</code> statements are now redundant, and you should get the same results if you delete them."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1535077923, "post_id": 51989828, "comment_id": 90942663, "body": "Keep in mind that you have declared <code>Application</code>and <code>Connection</code>as implicit Variant and that they are keywords.. use <code>Dim App as Object, Conn as Object</code> instead."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "reply_to_user": {"reputation": 6762, "user_id": 845655, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ySyzL.jpg?s=128&g=1", "display_name": "DeanOC", "link": "https://stackoverflow.com/users/845655/deanoc"}, "edited": false, "score": 0, "creation_date": 1535081631, "post_id": 51989828, "comment_id": 90943366, "body": "@DeanOC with the implicit variant declaration the Ifs just worked for Application and Connection before as they were not variant/objects, If they were declared as objects they would n&#39;t have worked too like Session, but  you should check for Is Nothing to determ if they are set to anything, if not they need to be set!"}, {"owner": {"reputation": 8896, "user_id": 9150270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07e89ef7ec2f93f949e76081bd9d1749?s=128&d=identicon&r=PG&f=1", "display_name": "Sandra Rossi", "link": "https://stackoverflow.com/users/9150270/sandra-rossi"}, "edited": false, "score": 0, "creation_date": 1610183028, "post_id": 51989828, "comment_id": 116055651, "body": "Based on your answer, I assume that you had the error &quot;Variable not defined&quot;, probably because your VBA module had the line <code>Option Explicit</code> at the top (was not part of your excerpt). Consequently, I changed the title of the question so that it makes sense."}], "tags": [], "owner": {"reputation": 21, "user_id": 10256052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3BFqc.jpg?s=128&g=1", "display_name": "OAltyn", "link": "https://stackoverflow.com/users/10256052/oaltyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1535077496, "last_edit_date": 1535077496, "creation_date": 1535039751, "answer_id": 51989828, "question_id": 51976101, "link": "https://stackoverflow.com/questions/51976101/variable-not-defined-when-running-generated-script-in-excel/51989828#51989828", "title": "&quot;Variable not defined&quot; when running generated script in Excel", "body": "<p>Thank you for feedback. It turned out that I needed to declare SAP objects in Excel before running a script. Here is the script that works from Excel. </p>\n\n<pre><code>Dim Application, Connection, Session As Object\nSet SapGuiAuto = GetObject(\"SAPGUI\")\nSet Application = SapGuiAuto.GetScriptingEngine\nSet Connection = Application.Children(0)\nSet Session = Connection.Children(0)\n\nIf Not IsObject(Application) Then\n   Set SapGuiAuto = GetObject(\"SAPGUI\")\n   Set Application = SapGuiAuto.GetScriptingEngine\nEnd If\nIf Not IsObject(Connection) Then\n   Set Connection = Application.Children(0)\nEnd If\nIf Not IsObject(Session) Then\n   Set Session = Connection.Children(0)\nEnd If\nIf IsObject(WScript) Then\n   WScript.ConnectObject Session, \"on\"\n   WScript.ConnectObject Application, \"on\"\nEnd If\nSession.findById(\"wnd[0]\").maximize\n\nDim objExcel As Object\nDim objSheet As Object\n\nSet objExcel = GetObject(, \"Excel.Application\")\nSet objSheet = objExcel.ActiveWorkbook.ActiveSheet\n\nCOL1 = Trim(CStr(objSheet.Range(\"A1\").Value)) 'Column1\n\nSession.findById(\"wnd[0]/tbar[0]/okcd\").Text = \"/nCS15\"\nSession.findById(\"wnd[0]/tbar[0]/btn[0]\").press\n\nSession.findById(\"wnd[0]/usr/ctxtRC29L-MATNR\").Text = COL1\nSession.findById(\"wnd[0]/usr/ctxtRC29L-MATNR\").SetFocus\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 10256052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3BFqc.jpg?s=128&g=1", "display_name": "OAltyn", "link": "https://stackoverflow.com/users/10256052/oaltyn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 244, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1610182836, "creation_date": 1534977495, "last_edit_date": 1610182836, "question_id": 51976101, "link": "https://stackoverflow.com/questions/51976101/variable-not-defined-when-running-generated-script-in-excel", "title": "&quot;Variable not defined&quot; when running generated script in Excel", "body": "<p>So, my task is to connect Excel with SAP by pulling values from a spreadsheet, inserting them into SAP form, and getting values from SAP transaction.</p>\n<p>I assume I just need to run VBA file for that. When I run the code my spreadsheet is open and I am logged onto SAP.</p>\n<p>The error is:</p>\n<blockquote>\n<p>Variable not defined</p>\n</blockquote>\n<p>Code:</p>\n<pre><code>If Not IsObject(application) Then\n   Set SapGuiAuto  = GetObject(&quot;SAPGUI&quot;)\n   Set application = SapGuiAuto.GetScriptingEngine\nEnd If\nIf Not IsObject(connection) Then\n   Set connection = application.Children(0)\nEnd If\nIf Not IsObject(session) Then\n   Set session    = connection.Children(0)\nEnd If\nIf IsObject(WScript) Then\n   WScript.ConnectObject session,     &quot;on&quot;\n   WScript.ConnectObject application, &quot;on&quot;\nEnd If\nsession.findById(&quot;wnd[0]&quot;).maximize\n\nDim objExcel as Object\nDim objSheet as Object\n\nSet objExcel = GetObject(, &quot;Excel.Application&quot;)\nSet objSheet = objExcel.ActiveWorkbook.ActiveSheet\n\nCOL1 = Trim(CStr(objSheet.Range(&quot;A1&quot;).Value)) 'Column1\n\nsession.findById(&quot;wnd[0]/tbar[0]/okcd&quot;).text = &quot;/nCS15&quot;\nsession.findById(&quot;wnd[0]/tbar[0]/btn[0]&quot;).press\n\nsession.findById(&quot;wnd[0]/usr/ctxtRC29L-MATNR&quot;).text = COL1\nsession.findById(&quot;wnd[0]/usr/ctxtRC29L-MATNR&quot;).setFocus\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2016"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1534982852, "post_id": 51976092, "comment_id": 90903535, "body": "You could test if the cell 1 row above the result of  <code>End(xlUp)</code>, i.e. a blank row in the table, is empty, and then use <code>End(xlUp)</code> again to get to the last populated row in the table. Or you could use the properties and methods of the table to find the last non-empty row, which might be a better approach."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1534989950, "post_id": 51976092, "comment_id": 90904862, "body": "Note that in your revised code, you should still handle the possibility of there being no empty rows. Your lines <code>lastRow1 = ActiveSheet...</code> and <code>lastRow2 = ActiveSheet...</code> will throw an error if <code>Cells.Find</code> doesn&#39;t find anything."}, {"owner": {"reputation": 258, "user_id": 3099345, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/662be73d766ce241f690ff4b1644422b?s=128&d=identicon&r=PG&f=1", "display_name": "xyz", "link": "https://stackoverflow.com/users/3099345/xyz"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1535034981, "post_id": 51976092, "comment_id": 90926158, "body": "Thank you. I implemented the change into the program."}], "answers": [{"comments": [{"owner": {"reputation": 258, "user_id": 3099345, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/662be73d766ce241f690ff4b1644422b?s=128&d=identicon&r=PG&f=1", "display_name": "xyz", "link": "https://stackoverflow.com/users/3099345/xyz"}, "edited": false, "score": 0, "creation_date": 1534981490, "post_id": 51976218, "comment_id": 90903301, "body": "Thank you for the response. Would the Find function be able to achieve a similar result?"}, {"owner": {"reputation": 1570, "user_id": 8305056, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XVNQC.png?s=128&g=1", "display_name": "girlvsdata", "link": "https://stackoverflow.com/users/8305056/girlvsdata"}, "reply_to_user": {"reputation": 258, "user_id": 3099345, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/662be73d766ce241f690ff4b1644422b?s=128&d=identicon&r=PG&f=1", "display_name": "xyz", "link": "https://stackoverflow.com/users/3099345/xyz"}, "edited": false, "score": 1, "creation_date": 1534981775, "post_id": 51976218, "comment_id": 90903344, "body": "The <code>.Find</code> function will return the single-cell range of a keyword. I&#39;m not sure how you are hoping to use it. <a href=\"https://docs.microsoft.com/en-us/office/vba/api/Excel.Range.Find\" rel=\"nofollow noreferrer\">Here</a> is the MSDN documentation for <code>.Find</code>. Does that answer your question?"}, {"owner": {"reputation": 258, "user_id": 3099345, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/662be73d766ce241f690ff4b1644422b?s=128&d=identicon&r=PG&f=1", "display_name": "xyz", "link": "https://stackoverflow.com/users/3099345/xyz"}, "edited": false, "score": 1, "creation_date": 1534985902, "post_id": 51976218, "comment_id": 90904090, "body": "I updated the main post with the new code. Thank you!"}], "tags": [], "owner": {"reputation": 1570, "user_id": 8305056, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XVNQC.png?s=128&g=1", "display_name": "girlvsdata", "link": "https://stackoverflow.com/users/8305056/girlvsdata"}, "is_accepted": true, "score": 1, "last_activity_date": 1534978368, "creation_date": 1534978368, "answer_id": 51976218, "question_id": 51976092, "link": "https://stackoverflow.com/questions/51976092/can-endxlup-skip-blank-rows-cells-at-the-bottom-of-an-excel-table-data-range/51976218#51976218", "title": "Can .End(xlUp) skip blank rows/cells at the bottom of an Excel table data range?", "body": "<p>You can't skip blanks using the <code>.End</code> property, it mimics the action that would take place if you clicked a cell and pressed <kbd>ctrl</kbd>+<kbd>up</kbd> or <kbd>end</kbd>+<kbd>up</kbd> on your keyboard.</p>\n\n<ul>\n<li>If you start from a non-blank cell, it will automatically stop where the range is blank, <strong>or</strong> </li>\n<li>If you start from a blank cell, it will automatically stop where the range is <strong>not</strong> blank.</li>\n</ul>\n\n<p><a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.end\" rel=\"nofollow noreferrer\">Here</a> is the MSDN documentation on the property and <a href=\"https://stackoverflow.com/a/20230559/8305056\">here</a> is another very good answer on the topic.</p>\n"}], "owner": {"reputation": 258, "user_id": 3099345, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/662be73d766ce241f690ff4b1644422b?s=128&d=identicon&r=PG&f=1", "display_name": "xyz", "link": "https://stackoverflow.com/users/3099345/xyz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1050, "favorite_count": 0, "accepted_answer_id": 51976218, "answer_count": 1, "score": 0, "last_activity_date": 1534985878, "creation_date": 1534977437, "last_edit_date": 1534985878, "question_id": 51976092, "link": "https://stackoverflow.com/questions/51976092/can-endxlup-skip-blank-rows-cells-at-the-bottom-of-an-excel-table-data-range", "title": "Can .End(xlUp) skip blank rows/cells at the bottom of an Excel table data range?", "body": "<p>I currently have a program that determines the next empty row by using this code:</p>\n\n<pre><code>Public Function GetEmptyRow() As Long\n    If ActiveSheet.Range(\"E\" &amp; Rows.Count).End(xlUp).Row &gt; _\n    ActiveSheet.Range(\"A\" &amp; Rows.Count).End(xlUp).Row Then\n        GetEmptyRow = ActiveSheet.Range(\"E\" &amp; Rows.Count).End(xlUp).Row + 1\n    Else\n        GetEmptyRow = ActiveSheet.Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1\n    End If\nEnd Function\n</code></pre>\n\n<p>The greater than comparison is there because if the item in the active row is used by more than one person, it creates a new row and nests the second name in column E, with columns A through D being blank.</p>\n\n<p>I was trying to add striped formatting with an Excel table, and now when a new row is added, the blank cells that are in A through D in the data range \"stop\" the End(xlUp) value, allowing me to change to just one line of code:</p>\n\n<pre><code>Public Function GetEmptyRow() As Long\n    GetEmptyRow = ActiveSheet.Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1\nEnd Function\n</code></pre>\n\n<p>If any rows are deleted at the bottom, however, it returns the row under the last in the range, even if it's blank. Is there a way to skip blanks in an Excel table data range using .End(xlUp)? </p>\n\n<p><strong>Update</strong>\nAfter reading the suggestions, I ended up changing the code to this:</p>\n\n<pre><code>Public Function GetEmptyRow() As Long\n\n    Dim lastRow1 As Integer, lastRow2 As Integer\n\n    lastRow1 = ActiveSheet.ListObjects(\"Table3\").Range.Columns(2) _\n    .Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n    lastRow2 = ActiveSheet.ListObjects(\"Table3\").Range.Columns(5) _\n    .Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n\n    If lastRow2 &gt; lastRow1 Then\n        GetEmptyRow = lastRow2 + 1\n    Else\n        GetEmptyRow = lastRow1 + 1\n    End If\n\nEnd Function\n</code></pre>\n\n<p>Which seems to do the trick. I'm not sure if this is the most efficient way but it definitely gets the job done. Thanks for the suggestions!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 0, "creation_date": 1534977691, "post_id": 51976053, "comment_id": 90902565, "body": "This is not the place to look. We can help you fix your code but we aren&#39;t here to write it for you."}], "answers": [{"tags": [], "owner": {"reputation": 113, "user_id": 5919177, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd1ee22939ddfc01e36f0ed49f33c721?s=128&d=identicon&r=PG", "display_name": "Lev", "link": "https://stackoverflow.com/users/5919177/lev"}, "is_accepted": true, "score": 1, "last_activity_date": 1535059355, "last_edit_date": 1535059355, "creation_date": 1534977437, "answer_id": 51976093, "question_id": 51976053, "link": "https://stackoverflow.com/questions/51976053/loop-through-all-excel-workbooks-in-a-folder-and-convert-all-formulas-to-values/51976093#51976093", "title": "Loop through all excel workbooks in a folder and convert all formulas to values", "body": "<p>Use the following code which loops through all the workbooks in a user-specified folder and does the following:</p>\n\n<ol>\n<li><p>It opens the workbook</p></li>\n<li><p>It loops within each worksheet in the workbook (including hidden worksheets), and converts to values every cell that contains a formula. </p></li>\n<li><p>After performing the conversion, it saves and closes the workbook, and moves on to the next workbook in the folder.</p></li>\n</ol>\n\n<p>See code below:</p>\n\n<pre><code>Sub LoopAllExcelFilesInFolderCancelFormulas()\n'Purpose: To loop through all Excel files in a user specified folder and convert all formulas to values\nDim wb As Workbook\nDim ws As Worksheet\nDim myPath As String\nDim myFile As String\nDim myExtension As String\nDim FldrPicker As FileDialog\n\n'Optimize Macro Speed\nApplication.EnableEvents = False\nApplication.Calculation = xlCalculationManual\n'Disable Excel Pop-up messages:\nApplication.DisplayAlerts = False\n\n'Retrieve Target Folder Path From User\nSet FldrPicker = Application.FileDialog(msoFileDialogFolderPicker)\n\nWith FldrPicker\n   .Title = \"Select A Target Folder\"\n   .AllowMultiSelect = False\n   If .Show &lt;&gt; -1 Then GoTo NextCode\n   myPath = .SelectedItems(1) &amp; \"\\\"\nEnd With\n\n'In Case of Cancel\nNextCode:\nmyPath = myPath\nIf myPath = \"\" Then GoTo ResetSettings\n\n'Target File Extension (must include wildcard \"*\")\nmyExtension = \"*.xls*\"\n\n'Target Path with Ending Extention\nmyFile = Dir(myPath &amp; myExtension)\n\n'Loop through each Excel file in folder\nDo While myFile &lt;&gt; \"\"\n   'Set variable equal to opened workbook\n   Set wb = Workbooks.Open(Filename:=myPath &amp; myFile)\n\n   'Ensure Workbook has opened before moving on to next line of code\n   DoEvents\n\n   For Each ws In wb.Sheets\n       ws.UsedRange.Value = ws.UsedRange.Value\n   Next\n\n   'Save and Close Workbook\n   wb.Close SaveChanges:=True\n\n   'Ensure Workbook has closed before moving on to next line of code\n   DoEvents\n\n   'Get next file name\n   myFile = Dir\nLoop\n\n'Message Box when tasks are completed\nMsgBox \"Task Complete!\"\n\nResetSettings:\n'Reset Macro Optimization Settings\nApplication.EnableEvents = True\nApplication.Calculation = xlCalculationAutomatic\nApplication.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n\n<p>The code for looping through all workbooks in a certain folder is based on the following <a href=\"https://www.thespreadsheetguru.com/the-code-vault/2014/4/23/loop-through-all-excel-files-in-a-given-folder\" rel=\"nofollow noreferrer\">code</a>.</p>\n"}], "owner": {"reputation": 113, "user_id": 5919177, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd1ee22939ddfc01e36f0ed49f33c721?s=128&d=identicon&r=PG", "display_name": "Lev", "link": "https://stackoverflow.com/users/5919177/lev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1563, "favorite_count": 0, "accepted_answer_id": 51976093, "answer_count": 1, "score": 0, "last_activity_date": 1535059355, "creation_date": 1534977166, "question_id": 51976053, "link": "https://stackoverflow.com/questions/51976053/loop-through-all-excel-workbooks-in-a-folder-and-convert-all-formulas-to-values", "title": "Loop through all excel workbooks in a folder and convert all formulas to values", "body": "<p>I am looking for a VBA code that would allow me to loop through all the Excel workbooks in a certain folder, and for each workbook will convert the cells in each worksheet from formulas to values. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1534983198, "post_id": 51975960, "comment_id": 90903599, "body": "I don&#39;t exactly know what you want the output to look like. Will the output interact with the shown sheet above? Can you show an example of the output you want?"}, {"owner": {"reputation": 1, "user_id": 10261991, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156056853134675/picture?type=large", "display_name": "Andr3ahh", "link": "https://stackoverflow.com/users/10261991/andr3ahh"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1535008277, "post_id": 51975960, "comment_id": 90909962, "body": "The output is the red highlighted part. If you type 01 of corse. If you type 02 (meaning 2nd of August), the output would be the next column."}], "owner": {"reputation": 1, "user_id": 10261991, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156056853134675/picture?type=large", "display_name": "Andr3ahh", "link": "https://stackoverflow.com/users/10261991/andr3ahh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594031073, "creation_date": 1534976598, "last_edit_date": 1594031073, "question_id": 51975960, "link": "https://stackoverflow.com/questions/51975960/excel-formula-vba-that-shows-only-a-part-of-a-column-of-another-sheet", "title": "Excel formula/VBA that shows only a part of a column of another sheet", "body": "<p>What I am trying to do is to show only a part of a column into another sheet through a formula.</p>\n\n<p>Basically I have an Excel file in which I type in work shifts, as you can see on the example. The top of this table contains the date. The first column contains the name of the employee.</p>\n\n<p>If possible I'd like to have the column of a specified date on another sheet (maintaining formatting), so that I can \u201csort\u201d employees in their exact place without the need of swapping between Sheets.</p>\n\n<p>The \u201cblacked out\u201d part is the one with employees names, the red-highlighted part is the one that should \u201cappear\u201d on the other sheet.</p>\n\n<p><a href=\"https://i.stack.imgur.com/mmZMo.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mmZMo.jpg\" alt=\"https://i.stack.imgur.com/mmZMo.jpg\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 2, "creation_date": 1534978623, "post_id": 51975742, "comment_id": 90902765, "body": "I am not seeing anything in that code that will change the sheet you are looking at. I am thinking it may be code listed in the userform code."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 5023479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a72b3c3114d5371fe7f9948210691121?s=128&d=identicon&r=PG", "display_name": "aureli", "link": "https://stackoverflow.com/users/5023479/aureli"}, "edited": false, "score": 0, "creation_date": 1535010894, "post_id": 51976784, "comment_id": 90911361, "body": "Thanks @K.Davis and urdearboy  I will have a look at the code at the end of the day as now the workbook is shared and cannot access the macros until everyone stops using it."}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 0, "last_activity_date": 1534983516, "creation_date": 1534983516, "answer_id": 51976784, "question_id": 51975742, "link": "https://stackoverflow.com/questions/51975742/staying-on-the-active-worksheet/51976784#51976784", "title": "Staying on the active worksheet", "body": "<p>If you remove any instances of <code>.Select</code> or <code>.Activate</code> on worksheet, range, or cell objects, your sheet shouldn't change. </p>\n\n<p>If that is not an option, another solution would be to note what sheet you are on when the code is called and then <code>Activate</code> that sheet before ending your sub. Since we do not see all of the userform code, you will have to strategically decide where this goes (as mentioned by @K.Davis, nothing shown switches the sheet so it must be happening in some other code). </p>\n\n<hr>\n\n<p>When the macro/userform is launched: </p>\n\n<pre><code>Dim StartSheet as Worksheet\nSet StartSheet = ActiveSheet\n</code></pre>\n\n<p>Then, before exiting macro/userform: </p>\n\n<pre><code>StartSheet.Activate\n</code></pre>\n\n<p>You may have to pass this along as a parameter depending on how your code is structured. </p>\n"}], "owner": {"reputation": 5, "user_id": 5023479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a72b3c3114d5371fe7f9948210691121?s=128&d=identicon&r=PG", "display_name": "aureli", "link": "https://stackoverflow.com/users/5023479/aureli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 455, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594031344, "creation_date": 1534975165, "last_edit_date": 1594031344, "question_id": 51975742, "link": "https://stackoverflow.com/questions/51975742/staying-on-the-active-worksheet", "title": "Staying on the active worksheet", "body": "<p>I have a workbook with monthly worksheets.  One for Emails and one for Calls and I have created two userForms for data entry, one for Emails and one for Calls.</p>\n<p>The forms do the job and they enter date in the right place but if I have selected the &quot;August 18 Email&quot; sheet and use the Email form, once the form is submitted it jumps to display the &quot;August 18 Calls&quot; sheet.</p>\n<p>I just want it to stay in the selected worksheet, in this case &quot;August 18 Email&quot;.</p>\n<p>The code for the Emails form is the one below and the one for the Calls is nearly the same but only changing this line :  <code> Set ws = Sheets(Format(Date, &quot;mmmm yy&quot;) &amp; &quot; calls&quot;)</code></p>\n<pre><code>Private Sub CommandButton2_Click()\n\n\nDim lRow As Long\nDim ws As Worksheet\nSet ws = ActiveSheet\nSet ws = Sheets(Format(Date, &quot;mmmm yy&quot;) &amp; &quot; emails&quot;)\n\n\nlRow = ws.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row\nWith ws\n    If Me.txtDateBox.Value = &quot;&quot; Then\n        .Cells(lRow, 1).Value = Format(Date, &quot;dd/mmm/yy&quot;)\n    Else\n        .Cells(lRow, 1).Value = Me.txtDateBox.Value\n    End If\n\n myVar = &quot;&quot;\n\nFor x = 0 To Me.ListBox2.ListCount - 1\n    If Me.ListBox2.Selected(x) Then\n        If myVar = &quot;&quot; Then\n            myVar = Me.ListBox2.List(x, 0)\n        Else\n            myVar = myVar &amp; &quot;,&quot; &amp; Me.ListBox2.List(x, 0)\n        End If\n    End If\nNext x\n\n.Cells(lRow, 11).Value = myVar\n\n\n\nmyVarSign = &quot;&quot;\n\nFor x = 0 To Me.ListBox3.ListCount - 1\n    If Me.ListBox3.Selected(x) Then\n        If myVarSign = &quot;&quot; Then\n            myVarSign = Me.ListBox3.List(x, 0)\n        Else\n            myVarSign = myVarSign &amp; &quot;,&quot; &amp; Me.ListBox3.List(x, 0)\n        End If\n    End If\nNext x\n\n.Cells(lRow, 12).Value = myVarSign\n\nmyVarTheme = &quot;&quot;\n\nFor x = 0 To Me.ListBox1.ListCount - 1\n    If Me.ListBox1.Selected(x) Then\n        If myVarTheme = &quot;&quot; Then\n            myVarTheme = Me.ListBox1.List(x, 0)\n        Else\n            myVarTheme = myVarTheme &amp; &quot;,&quot; &amp; Me.ListBox1.List(x, 0)\n        End If\n    End If\nNext x\n\n.Cells(lRow, 14).Value = myVarTheme\n\n    .Cells(lRow, 2).Value = Me.Time.Value\n    .Cells(lRow, 3).Value = Me.ComboBox1.Value\n    .Cells(lRow, 4).Value = Me.ComboBox2.Value\n    .Cells(lRow, 5).Value = Me.ComboBox3.Value\n    .Cells(lRow, 6).Value = Me.ComboBox4.Value\n    .Cells(lRow, 7).Value = Me.ComboBox5.Value\n    .Cells(lRow, 8).Value = Me.ComboBox15.Value\n    .Cells(lRow, 9).Value = Me.ComboBox6.Value\n    .Cells(lRow, 10).Value = Me.ComboBox7.Value\n    .Cells(lRow, 13).Value = Me.ComboBox11.Value\n    .Cells(lRow, 15).Value = Me.ComboBox16.Value\n    .Cells(lRow, 16).Value = Me.TextBox2.Value\nEnd With\n\nMe.txtDateBox.Value = &quot;&quot;\nMe.Time.Value = &quot;&quot;\nMe.ComboBox1.Value = &quot;&quot;\nMe.ComboBox2.Value = &quot;&quot;\nMe.ComboBox3.Value = &quot;&quot;\nMe.ComboBox4.Value = &quot;&quot;\nMe.ComboBox5.Value = &quot;&quot;\nMe.ComboBox6.Value = &quot;&quot;\nMe.ComboBox7.Value = &quot;&quot;\nMe.ComboBox11.Value = &quot;&quot;\nMe.ComboBox16.Value = &quot;&quot;\nMe.ComboBox15.Value = &quot;&quot;\nMe.TextBox2.Value = &quot;&quot;\n\nDim iCount As Integer\n\nFor iCount = 0 To Me!ListBox1.ListCount\n    Me!ListBox1.Selected(iCount) = False\nNext iCount\n\n For iCount = 0 To Me!ListBox2.ListCount\n    Me!ListBox2.Selected(iCount) = False\nNext iCount\n\n For iCount = 0 To Me!ListBox3.ListCount\n    Me!ListBox3.Selected(iCount) = False\nNext iCount\n\n\nEnd Sub\n</code></pre>\n<p>It could be improved a lot but I am happy if after submission the worksheet in view stays instead to jumping to another one.</p>\n<p>As you can see I am only beginning (I have managed to create this with help of others).</p>\n"}, {"tags": ["excel", "vba", "loops"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1534976300, "post_id": 51975714, "comment_id": 90902229, "body": "Is it always 4 rows per combination?"}, {"owner": {"reputation": 11, "user_id": 10261864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eefc86d2d9ecc9b15ebeb3042da26d88?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor R", "link": "https://stackoverflow.com/users/10261864/taylor-r"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1534976503, "post_id": 51975714, "comment_id": 90902291, "body": "Yes! Some Y-values are 0 (no employees), but always 4 rows for the store type."}, {"owner": {"reputation": 1570, "user_id": 8305056, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XVNQC.png?s=128&g=1", "display_name": "girlvsdata", "link": "https://stackoverflow.com/users/8305056/girlvsdata"}, "edited": false, "score": 0, "creation_date": 1534976585, "post_id": 51975714, "comment_id": 90902315, "body": "Welcome to Stack Overflow, Taylor! Have you tried Pivot Charts? You can use filters in Pivot Charts to cut down a lot of the work here. Here&#39;s a link to a tutorial with more information - <a href=\"https://www.excel-easy.com/examples/pivot-chart.html\" rel=\"nofollow noreferrer\">Link</a>."}, {"owner": {"reputation": 11, "user_id": 10261864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eefc86d2d9ecc9b15ebeb3042da26d88?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor R", "link": "https://stackoverflow.com/users/10261864/taylor-r"}, "edited": false, "score": 0, "creation_date": 1534982061, "post_id": 51975714, "comment_id": 90903396, "body": "Hello! Yes, I&#39;ve used Pivot Charts, but only for dynamic data sets of single tables--I&#39;ll look into it, thanks"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10261864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eefc86d2d9ecc9b15ebeb3042da26d88?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor R", "link": "https://stackoverflow.com/users/10261864/taylor-r"}, "edited": false, "score": 0, "creation_date": 1534981006, "post_id": 51975961, "comment_id": 90903219, "body": "Thank you for your answer! I tried this, but I kept getting a &quot;type mismatch&quot; error for the line Set co = ActiveSheet.Shapes.AddChart2(201, xlColumnClustered)"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 11, "user_id": 10261864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eefc86d2d9ecc9b15ebeb3042da26d88?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor R", "link": "https://stackoverflow.com/users/10261864/taylor-r"}, "edited": false, "score": 0, "creation_date": 1534986352, "post_id": 51975961, "comment_id": 90904202, "body": "I edited the declaration for <code>co</code> to remove <code>As ChartObject</code> -  that should fix it"}, {"owner": {"reputation": 11, "user_id": 10261864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eefc86d2d9ecc9b15ebeb3042da26d88?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor R", "link": "https://stackoverflow.com/users/10261864/taylor-r"}, "edited": false, "score": 0, "creation_date": 1535393134, "post_id": 51975961, "comment_id": 91040360, "body": "Thank you so much!!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 2, "last_activity_date": 1534986279, "last_edit_date": 1534986279, "creation_date": 1534976600, "answer_id": 51975961, "question_id": 51975714, "link": "https://stackoverflow.com/questions/51975714/coding-multiple-row-graphs-looping-in-vba/51975961#51975961", "title": "Coding multiple-row graphs (looping) in VBA", "body": "<p>Untested, but try this:</p>\n\n<pre><code>Sub makegraph()\n\n    Dim i As Long, co, cht As Chart '&lt;&lt;edit here\n    Dim sht As Worksheet\n\n    Set sht = Sheets(\"Sheet1\")\n\n    For i = 1 To 50\n        Set co = ActiveSheet.Shapes.AddChart2(201, xlColumnClustered)\n        'position and size the chart here by setting the\n        '  Top/Left/Width/Height properties\n        With co.Chart\n            'calculate the required offset\n            .SetSourceData Source:=sht.Range(\"A2:D5\").Offset((i - 1) * 4, 0)\n            .ChartTitle.Text = \"Employees by Store Type\"\n        End With\n    Next i\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1570, "user_id": 8305056, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XVNQC.png?s=128&g=1", "display_name": "girlvsdata", "link": "https://stackoverflow.com/users/8305056/girlvsdata"}, "edited": false, "score": 1, "creation_date": 1534977525, "post_id": 51976051, "comment_id": 90902517, "body": "Upvoting for great use of the <a href=\"https://www.excel-easy.com/vba/examples/step-keyword.html\" rel=\"nofollow noreferrer\">Step</a> Keyword! I will definitely be making use of this. Nice answer."}, {"owner": {"reputation": 11, "user_id": 10261864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eefc86d2d9ecc9b15ebeb3042da26d88?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor R", "link": "https://stackoverflow.com/users/10261864/taylor-r"}, "edited": false, "score": 1, "creation_date": 1534981189, "post_id": 51976051, "comment_id": 90903257, "body": "Thank you! The variable range makes the most sense to me, but I keep getting a &quot;Object variable or With block variable not set&quot; for the line Area = Range(&quot;Sheet1!A2:D5&quot;) not sure why :("}, {"owner": {"reputation": 11, "user_id": 10261864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eefc86d2d9ecc9b15ebeb3042da26d88?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor R", "link": "https://stackoverflow.com/users/10261864/taylor-r"}, "edited": false, "score": 0, "creation_date": 1534981268, "post_id": 51976051, "comment_id": 90903267, "body": "And using absolute values, I keep getting a mismatch error for the line &quot;ActiveChart.SetSourceData Source:=Range(&quot;Sheet1!A&quot; + Row + &quot;:D&quot; + (Row + 3))&quot; related to using &quot;Row&quot; which I also don&#39;t understand..."}, {"owner": {"reputation": 340, "user_id": 10259066, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vZVBX.png?s=128&g=1", "display_name": "DaanV", "link": "https://stackoverflow.com/users/10259066/daanv"}, "edited": false, "score": 0, "creation_date": 1535008141, "post_id": 51976051, "comment_id": 90909893, "body": "Oh sorry if you ever get &#39;the object variable or with block&#39; error you need to use set: set Area = Range()"}, {"owner": {"reputation": 340, "user_id": 10259066, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vZVBX.png?s=128&g=1", "display_name": "DaanV", "link": "https://stackoverflow.com/users/10259066/daanv"}, "edited": false, "score": 0, "creation_date": 1535008717, "post_id": 51976051, "comment_id": 90910170, "body": "I have edited the examples to make sure they work. Im sorry they didn&#39;t as I did them from the top of my head"}], "tags": [], "owner": {"reputation": 340, "user_id": 10259066, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vZVBX.png?s=128&g=1", "display_name": "DaanV", "link": "https://stackoverflow.com/users/10259066/daanv"}, "is_accepted": false, "score": 1, "last_activity_date": 1535008667, "last_edit_date": 1535008667, "creation_date": 1534977136, "answer_id": 51976051, "question_id": 51975714, "link": "https://stackoverflow.com/questions/51975714/coding-multiple-row-graphs-looping-in-vba/51976051#51976051", "title": "Coding multiple-row graphs (looping) in VBA", "body": "<pre><code>Sub makegraph()\nDim Row As Integer\n\nFor Row = 1 To 50\nActiveSheet.Shapes.AddChart2(201, xlColumnClustered).Select\nActiveChart.SetSourceData Source:=Range(\"Sheet1!A2:D50\").Offset(4, 0)\nActiveChart.ChartTitle.Select\nActiveChart.ChartTitle.Text = \"Employees by Store Type\"\nNext Row\nEnd Sub\n</code></pre>\n\n<p>from what I understand by this code. the offset you apply is always from the same spot which is Range(\"Sheet!A2:D50\") secondly you have specified the whole area as the source.</p>\n\n<p>I would suggest doing more absolute values or make a variable for the range:</p>\n\n<p>example of variable range:</p>\n\n<pre><code>Sub makegraph()\n    Dim Row As Integer\n    Dim Area As Range\n\n    Set Area = Range(\"A2:D5\")\n\n    For Row = 1 To 50\n        ActiveSheet.Shapes.AddChart2(201, xlColumnClustered).Select\n        ActiveChart.SetSourceData Source:=Area\n        Set Area = Area.Offset(4, 0)\n        ActiveChart.ChartTitle.Select\n        ActiveChart.ChartTitle.Text = \"Employees by Store Type\"\n    Next Row\nEnd Sub\n</code></pre>\n\n<p>Example of Absolute values:</p>\n\n<pre><code>Sub makegraph()\n    Dim Row As Integer\n\n    For Row = 2 To 50 Step 4\n        ActiveSheet.Shapes.AddChart2(201, xlColumnClustered).Select\n        ActiveChart.SetSourceData Source:=Range(Cells(Row, 1), Cells(Row + 3, 1))\n        ActiveChart.ChartTitle.Select\n        ActiveChart.ChartTitle.Text = \"Employees by Store Type\"\n    Next Row\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10261864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eefc86d2d9ecc9b15ebeb3042da26d88?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor R", "link": "https://stackoverflow.com/users/10261864/taylor-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1535008667, "creation_date": 1534974973, "last_edit_date": 1534975473, "question_id": 51975714, "link": "https://stackoverflow.com/questions/51975714/coding-multiple-row-graphs-looping-in-vba", "title": "Coding multiple-row graphs (looping) in VBA", "body": "<p>I'm sure there is a fairly simple answer to this question but I've been pulling my hair out for multiple days trying to figure this out and no one in my department works with VBA enough to know.\nI'm new to automating graphs but I have a project where I need to make almost 800 graphs! The data itself is fairly straightforward, with 4 variables (columns): County, City, Store Type, and Number of Employees:</p>\n\n<pre><code>COUNTY  CITY    STORE TYPE  NUMBER OF EMPLOYEES\nX   A   1   100\nX   A   2   100\nX   A   3   100\nX   A   4   100\nX   B   1   100\nX   B   2   100\nX   B   3   100\nX   B   4   100\n</code></pre>\n\n<p>I need to make bar graphs for each County/City combination with the Store Type as the X-values and the Number of Employees displayed on the Y-axis. This is super easy to do in VBA:</p>\n\n<pre><code>Sub makegraph2()\nRange(\"A2:D5\").Select\nActiveSheet.Shapes.AddChart2(201, xlColumnClustered).Select\nActiveChart.SetSourceData Source:=Range(\"Sheet1!$A$2:$D$5\")\nActiveChart.ChartTitle.Text = \"Employees per Store Type\"\nSelection.Format.TextFrame2.TextRange.Characters.Text = \"Employees per Store \nType\"\nEnd Sub\n</code></pre>\n\n<p>Rather than copying/pasting the same graph and reselecting the data for each 4 rows downward, I'm trying to find a way to automate it with a loop. I've tried doing this myself (testing with only 50 rows ((A2:D50 represents all 4 columns and 50 rows)) so not to get 800 graphs that are wrong and crash my computer) using offset in many different ways. My most resent attempt produces a graph with all 50 rows on it at once:</p>\n\n<pre><code>Sub makegraph()\nDim Row As Integer\n\nFor Row = 1 To 50\nActiveSheet.Shapes.AddChart2(201, xlColumnClustered).Select\nActiveChart.SetSourceData Source:=Range(\"Sheet1!A2:D50\").Offset(4, 0)\nActiveChart.ChartTitle.Select\nActiveChart.ChartTitle.Text = \"Employees by Store Type\"\nNext Row\nEnd Sub\n</code></pre>\n\n<p>Before that, I made separate graphs but they were all of the same data (would not go down 4 rows to graph the next set). So clearly I'm using Offset and Range wrong, but I can't figure out how...</p>\n\n<p>Any help is so appreciated!! Thank you!!</p>\n"}, {"tags": ["excel", "vba", "ms-access", "import", "error-handling"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 9727480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8e234c32dadfbf54e1b3fa2b549bb33?s=128&d=identicon&r=PG&f=1", "display_name": "greatshogon", "link": "https://stackoverflow.com/users/9727480/greatshogon"}, "edited": false, "score": 0, "creation_date": 1535043591, "post_id": 51977369, "comment_id": 90931358, "body": "Thank you for the book recommendation. My main job title isn&#39;t as a developer, I&#39;m just writing scripts to be more efficient. But I&#39;m being asked to do this stuff more and more, so maybe I should learn to do this right."}, {"owner": {"reputation": 21, "user_id": 9727480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8e234c32dadfbf54e1b3fa2b549bb33?s=128&d=identicon&r=PG&f=1", "display_name": "greatshogon", "link": "https://stackoverflow.com/users/9727480/greatshogon"}, "edited": false, "score": 0, "creation_date": 1535048712, "post_id": 51977369, "comment_id": 90933780, "body": "It turns out that this doesn&#39;t quite work. So basically, as it loops through, it comes across February 19th, a holiday, and breaks the code. No error is logged in the table and it doesn&#39;t resume."}, {"owner": {"reputation": 2682, "user_id": 9059424, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ez4b8InqhCI/AAAAAAAAAAI/AAAAAAAAAWE/IY8n6L2OBQk/photo.jpg?sz=128", "display_name": "aduguid", "link": "https://stackoverflow.com/users/9059424/aduguid"}, "reply_to_user": {"reputation": 21, "user_id": 9727480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8e234c32dadfbf54e1b3fa2b549bb33?s=128&d=identicon&r=PG&f=1", "display_name": "greatshogon", "link": "https://stackoverflow.com/users/9727480/greatshogon"}, "edited": false, "score": 0, "creation_date": 1535065029, "post_id": 51977369, "comment_id": 90940168, "body": "Can you post a list of file names to test with?"}, {"owner": {"reputation": 2682, "user_id": 9059424, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ez4b8InqhCI/AAAAAAAAAAI/AAAAAAAAAWE/IY8n6L2OBQk/photo.jpg?sz=128", "display_name": "aduguid", "link": "https://stackoverflow.com/users/9059424/aduguid"}, "reply_to_user": {"reputation": 21, "user_id": 9727480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8e234c32dadfbf54e1b3fa2b549bb33?s=128&d=identicon&r=PG&f=1", "display_name": "greatshogon", "link": "https://stackoverflow.com/users/9727480/greatshogon"}, "edited": false, "score": 0, "creation_date": 1535811232, "post_id": 51977369, "comment_id": 91208265, "body": "Sorry, I just noticed that I didn&#39;t error trap the <code>GetMonth</code> function."}], "tags": [], "owner": {"reputation": 2682, "user_id": 9059424, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ez4b8InqhCI/AAAAAAAAAAI/AAAAAAAAAWE/IY8n6L2OBQk/photo.jpg?sz=128", "display_name": "aduguid", "link": "https://stackoverflow.com/users/9059424/aduguid"}, "is_accepted": false, "score": 0, "last_activity_date": 1535026817, "last_edit_date": 1535026817, "creation_date": 1534989593, "answer_id": 51977369, "question_id": 51975609, "link": "https://stackoverflow.com/questions/51975609/how-to-provide-error-handling-in-ms-access-for-an-excel-spreadsheet-import/51977369#51977369", "title": "How to provide error handling in MS Access for an Excel spreadsheet import", "body": "<p>I'd break up your <code>importer</code> procedure into 2 parts. </p>\n\n<ol>\n<li><code>ProcessExcelFiles</code> which does your directory file loop.</li>\n<li><code>ExcelFileImport</code> that imports the file. </li>\n</ol>\n\n<p><em>Then the error trap will log a record for that individual file.</em></p>\n\n<p>I recommend reading <a href=\"https://rads.stackoverflow.com/amzn/click/com/B001GSTOAM\" rel=\"nofollow noreferrer\" rel=\"nofollow noreferrer\"><strong>Clean Code</strong></a>, it really improved my coding skills. One of the concepts it covers is if the procedure does more than one <em>thing</em>, it needs to be split into separate procedures. Also, name the procedures what they do e.g. <code>importer</code> would be better named <code>ExcelFileImport</code> or in a module <code>Excel</code> as a procedure <code>FileImport</code>. </p>\n\n<pre><code>Public Sub ProcessExcelFiles()\nOn Error GoTo ErrTrap\nDim file As String, path As String, i As Integer, datevar As Date, month As Integer, fDate As Variant\nDim filePath As String\n\n    path = \"path\"\n    file = Dir(path &amp; \"*client*\")\n\n    DoCmd.RunSQL (\"DELETE * FROM [table]\")\n\n    Do While file &lt;&gt; \"\"\n        If file Like \"*2018*\" Then\n            month = GetMonth(file)\n            'MsgBox (path &amp; file)\n\n            For i = 1 To 31\n                If IsDate(month &amp; \"/\" &amp; i &amp; \"/2018\") = True Then\n                datevar = CDate(month &amp; \"/\" &amp; i &amp; \"/2018\")\n                    If IsDate(datevar) = True And datevar &lt; CDate(\"8/8/2018\") Then\n                        fDate = Weekday(month &amp; \"/\" &amp; i &amp; \"/2018\", vbMonday)\n                        If fDate &lt; 5 Then\n                            filePath = path &amp; file\n                            ExcelFileImport filePath, i\n                        End If\n                     End If\n                End If\n            Next i\n\n         Else\n            MsgBox (\"No\")\n        End If\n        file = Dir\n    Loop\n\nExitProcedure:\n    On Error Resume Next\n    Exit Sub\n\nErrTrap:\n    Select Case Err.number\n        Case Is &lt;&gt; 0\n            ErrorLog \"MyModule\", \"ProcessExcelFiles\", Err.number, Err.description, file\n            Resume ExitProcedure\n        Case Else\n            Resume ExitProcedure\n    End Select\n\nEnd Sub\n\nPrivate Sub ExcelFileImport(ByVal filePath As String, ByVal index As Integer)\nOn Error GoTo ErrTrap\n\n    DoCmd.TransferSpreadsheet acImport, , \"table\", filePath, True, \"_\" &amp; index\n\nExitProcedure:\n    On Error Resume Next\n    Exit Sub\n\nErrTrap:\n    Select Case Err.number\n        Case Is &lt;&gt; 0\n            ErrorLog \"MyModule\", \"ExcelFileImport\", Err.number, Err.description, filePath\n            Resume ExitProcedure\n        Case Else\n            Resume ExitProcedure\n    End Select\n\nEnd Sub\n\nPrivate Function GetMonth(ByVal file As String) As Variant\n    Dim monthnumberx As Integer\n        Select Case True\n            Case file Like \"*January*\"\n            monthnumberx = 1\n            Case file Like \"*February*\"\n            monthnumberx = 2\n            Case file Like \"*March*\"\n            monthnumberx = 3\n            Case file Like \"*April*\"\n            monthnumberx = 4\n            Case file Like \"*May*\"\n            monthnumberx = 5\n            Case file Like \"*June*\"\n            monthnumberx = 6\n            Case file Like \"*July*\"\n            monthnumberx = 7\n            Case file Like \"*August*\"\n            monthnumberx = 8\n            Case file Like \"*September*\"\n            monthnumberx = 9\n            Case file Like \"*October*\"\n            monthnumberx = 10\n            Case file Like \"*November*\"\n            monthnumberx = 11\n            Case file Like \"*December*\"\n            monthnumberx = 12\n            End Select\n     GetMonth = monthnumberx\nEnd Function\n\nPublic Sub ErrorLog( _\n  ByVal Module As String _\n, ByVal procedure As String _\n, ByVal number As Variant _\n, ByVal description As String _\n, ByVal fileName As String)\nOn Error GoTo ErrTrap\n'--------------------------------------------------------------------------------------------------------------------\n' Purpose:  Creates a record of the error\n' Example:  ErrorLog \"MyModule\", \"ExcelFileImport\", \"404\", \"Error Message Here...\", \"C:\\Temp\\test.xlsx\"\n'--------------------------------------------------------------------------------------------------------------------\n\n    DoCmd.RunSQL (\"INSERT INTO [ERROR_LOG] (UserName, ComputerName, ErrorDateTime, ModuleName, ProcedureName, ErrorNumber, ErrorDescription, FilePath) VALUES \" _\n    &amp; \"('\" &amp; Environ(\"UserName\") &amp; \"', '\" &amp; Environ(\"ComputerName\") &amp; \"', '\" &amp; CStr(Format(Now(), \"dd-MMM-yyyy hh:nn:ss AM/PM\")) &amp; \"', '\" &amp; Module &amp; \"', '\" &amp; procedure &amp; \"', '\" &amp; CStr(number) &amp; \"', '\" &amp; description &amp; \"', '\" &amp; fileName &amp; \"');\")\n\nExitProcedure:\n    On Error Resume Next\n    Exit Sub\n\nErrTrap:\n    Select Case Err.number\n        Case Is &lt;&gt; 0\n            Resume ExitProcedure\n        Case Else\n            Resume ExitProcedure\n    End Select\n\nEnd Sub\n</code></pre>\n\n<blockquote>\n  <p>FYI, you'll have to create an <code>[ERROR_LOG]</code> table.</p>\n</blockquote>\n\n<pre><code>CREATE TABLE ERROR_LOG \n(\n  UserName Text(255)\n, ComputerName Text(255)\n, ErrorDateTime Text(255)\n, ModuleName Text(255)\n, ProcedureName Text(255)\n, ErrorNumber Text(255)\n, ErrorDescription Text(255)\n, FilePath Text(255)\n)\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 9727480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8e234c32dadfbf54e1b3fa2b549bb33?s=128&d=identicon&r=PG&f=1", "display_name": "greatshogon", "link": "https://stackoverflow.com/users/9727480/greatshogon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 167, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1535026817, "creation_date": 1534974385, "last_edit_date": 1535002456, "question_id": 51975609, "link": "https://stackoverflow.com/questions/51975609/how-to-provide-error-handling-in-ms-access-for-an-excel-spreadsheet-import", "title": "How to provide error handling in MS Access for an Excel spreadsheet import", "body": "<p>I'm trying to import a whole bunch of Excel files separated by the name of a client for the year to date. Now, these files contain many records, and there is a different worksheet for each day of a month. Each individual part of the code seems to work. I've tested it individually before. However, there is no spreadsheet if the day is a weekend or holiday. I handled the weekends. But the On Error Resume Next doesn't seem to be dealing with the holidays correctly. Can anyone point me in the right directions?</p>\n\n<p>Notes: Client and path will be hard-coded for...reasons. The extraneous message boxes are for testing purposes. Naming conventions for spreadsheets is _#. If you know a better way to do any of this, please feel free to let me know.</p>\n\n<pre><code>Public Function importer()\nDim file As String, path As String, i As Integer, datevar As Date, month As     Integer, fDate As Variant\n\npath = \"path\"\nfile = Dir(path &amp; \"*client*\")\n\nDoCmd.RunSQL (\"DELETE * FROM [table]\")\n\n\nDo While file &lt;&gt; \"\"\n\n\n    If file Like \"*2018*\" Then\n        month = GetMonth(file)\n        MsgBox (path &amp; file)\n\n        For i = 1 To 31\n        If IsDate(month &amp; \"/\" &amp; i &amp; \"/2018\") = True Then\n        datevar = CDate(month &amp; \"/\" &amp; i &amp; \"/2018\")\n            If IsDate(datevar) = True And datevar &lt; CDate(\"8/8/2018\") Then\n                fDate = Weekday(month &amp; \"/\" &amp; i &amp; \"/2018\", vbMonday)\n                If fDate &lt; 5 Then\n                    On Error Resume Next\n                    DoCmd.TransferSpreadsheet acImport, , \"table\", path &amp; file, True, \"_\" &amp; i\n                End If\n             End If\n        End If\n        Next i\n\n     Else\n        MsgBox (\"No\")\n    End If\n    file = Dir\nLoop\n\n\nEnd Function\n\nPublic Function GetMonth(file) As Variant\n    Dim monthnumberx As Integer\n        Select Case True\n            Case file Like \"*January*\"\n            monthnumberx = 1\n            Case file Like \"*February*\"\n            monthnumberx = 2\n            Case file Like \"*March*\"\n            monthnumberx = 3\n            Case file Like \"*April*\"\n            monthnumberx = 4\n            Case file Like \"*May*\"\n            monthnumberx = 5\n            Case file Like \"*June*\"\n            monthnumberx = 6\n            Case file Like \"*July*\"\n            monthnumberx = 7\n            Case file Like \"*August*\"\n            monthnumberx = 8\n            Case file Like \"*September*\"\n            monthnumberx = 9\n            Case file Like \"*October*\"\n            monthnumberx = 10\n            Case file Like \"*November*\"\n            monthnumberx = 11\n            Case file Like \"*December*\"\n            monthnumberx = 12\n            End Select\n     GetMonth = monthnumberx\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1534979182, "post_id": 51975570, "comment_id": 90902876, "body": "It&#39;s difficult to provide an answer without seeing the data. Firstly, why declare <code>TopR</code> and <code>LastR</code> as type <b>Double</b>? These should be type <b>Long</b>. But for the data issues, place this line right above your <code>If...Then</code> statement and see what you are looking at in the debugger is what you expect that data to be: <code>Debug.Print &quot;Value1=[&quot; &amp; Cells(j + 1, 1) &amp; &quot;] &lt;&gt; Value2=[&quot; &amp; Cells(j + 2, 1) &amp; &quot;]... Value3=[&quot; &amp; Cells(j + 2, 1) &amp; &quot;] &lt;&gt; 0&quot;</code>"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1534979359, "post_id": 51975570, "comment_id": 90902913, "body": "Also, you should add <code>Option Explicit</code> to the top of the module, you never declared your <code>j</code> variable, which should also be of type <b>Long</b>."}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1534995002, "post_id": 51975570, "comment_id": 90905705, "body": "Your <code>If</code> statement is working. You don&#39;t need to declare <code>TopR</code>; since you select <code>B1</code> and then assign <code>TopR</code> to B1&#39;s row number, you are performing a run-a-round to declare <code>1</code>, so <code>For J = 1 To 100</code> would be easier to understand. I don&#39;t see where you are using <code>LastR</code>. When inserting rows you need to loop from the bottom to the top, or you will just keep inserting blank rows after the first time your <code>If</code> statement is <code>True</code>."}, {"owner": {"reputation": 3, "user_id": 10261841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2334d4e2cf7b78e16386733655b5b9cf?s=128&d=identicon&r=PG&f=1", "display_name": "muzikman", "link": "https://stackoverflow.com/users/10261841/muzikman"}, "edited": false, "score": 0, "creation_date": 1535391331, "post_id": 51975570, "comment_id": 91039545, "body": "I don&#39;t believe I have to loop from the bottom as I&#39;m re-designating j as j +2 at the end of the if statement to account for the two inserted rows. I have updated my code to have j = long and For j = 1 To 100. However, this hasn&#39;t seemed to resolve the issue, as no rows are being inserted when a new value is hit in column B, which is why I think my if statement is just incorrect."}], "owner": {"reputation": 3, "user_id": 10261841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2334d4e2cf7b78e16386733655b5b9cf?s=128&d=identicon&r=PG&f=1", "display_name": "muzikman", "link": "https://stackoverflow.com/users/10261841/muzikman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594078533, "creation_date": 1534974219, "last_edit_date": 1594078533, "question_id": 51975570, "link": "https://stackoverflow.com/questions/51975570/vba-inserting-row-within-if-then-statement-within-for-loop", "title": "VBA: Inserting Row within IF/Then Statement within For Loop", "body": "<p>I'm trying to insert two rows and copy &amp; paste the top row (header) every time a value changes within a column (This is a smaller task within a much larger macro in which I'm formatting data and pasting that data into outlook emails). For some reason, it appears my \"if\" statement is not being satisfied so none of the \"then\" code is being executed (i.e. no rows are being inserted), although the data is showing clear differences in values between \"j+1\" and \"j+2\" so rows should be inserted in between them. Per the below, do you see any reason as to why my if statement is flawed?</p>\n\n<pre><code>Function RangetoHtml(rng As Range)\n\nDim fso As Object\nDim ts As Object\nDim TempFile As String\nDim TempWB As Workbook\nDim TopR As Double\nDim j As Long\nDim LastR As Double\n\nTempFile = Environ$(\"temp\") &amp; \"/\" &amp; Format(Now, \"dd-mm-yy h-mm-ss\") &amp; \".htm\"\n\n\nrng.Copy\nSet TempWB = Workbooks.Add(1)\nWith TempWB.Sheets(1)\n    .Cells(1).PasteSpecial Paste:=8\n    .Cells(1).PasteSpecial xlPasteValues, , False, False\n    .Cells(1).PasteSpecial xlPasteFormats, , False, False\n        Range(\"B1\").Select\n\n        For j = 1 To 100\n            If Cells(j + 1, 1).Value &lt;&gt; Cells(j + 2, 1).Value And Cells(j + 2, 1) &lt;&gt; 0 Then\n            Rows(j + 2).Resize(2).EntireRow.Insert\n            Rows(\"1\").Copy\n            Rows(j + 3).PasteSpecial xlPasteFormats\n            Rows(j + 3).PasteSpecial xlPasteValues              \n            j = j + 2\n            End If\n        Next\n</code></pre>\n\n<p>I've added this below code for a dummy sheet I made to test my code and it's doing exactly what I want. I don't really see a difference between my code above and the code below, which doesn't seem to make sense at all:</p>\n\n<pre><code>Sheets(\"Sheet1\").Select\nRange(\"E1\").Select\n    For j = 1 To 100\n        If Cells(j + 1, 1).Value &lt;&gt; Cells(j + 2, 1).Value And Cells(j + 2, 1) &lt;&gt; 0 Then\n        Rows(j + 2).Resize(2).EntireRow.Insert\n        Rows(\"1\").Copy\n        Rows(j + 3).PasteSpecial xlPasteFormats\n        Rows(j + 3).PasteSpecial xlPasteValues\n        j = j + 2\n        End If\n    Next\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1534973933, "post_id": 51975456, "comment_id": 90901445, "body": "You&#39;re writing the query definition (<code>qryTemp</code>) but exporting <code>Orders</code> every time thru the loop."}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1534974270, "post_id": 51975456, "comment_id": 90901565, "body": "I updated the code and now I&#39;m getting this: &#39;Error 31532: Microsoft Access was unable to export the data.&#39;  Using: DoCmd.TransferText acExportDelim, , &quot;qryTemp&quot;, &quot;C:\\Test\\&quot; &amp; rsThis.Fields(&quot;dValue&quot;).Value &amp; &quot;.csv&quot;, True"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1534974734, "post_id": 51975456, "comment_id": 90901743, "body": "I&#39;m not familiar with that error.  So shotgunning ... when you hit that error and go into break mode ... Does <code>qryTemp</code> open without error in the query designer and return data?  Does the file <code>&quot;C:\\Test\\&quot; &amp; rsThis.Fields(&quot;dValue&quot;).Value &amp; &quot;.csv&quot;</code> already exist?  Can you write any file to <code>&quot;C:\\Test\\&quot;</code>?"}, {"owner": {"reputation": 1018, "user_id": 9706678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fj42a.png?s=128&g=1", "display_name": "Jiggles32", "link": "https://stackoverflow.com/users/9706678/jiggles32"}, "edited": false, "score": 0, "creation_date": 1534978006, "post_id": 51975456, "comment_id": 90902642, "body": "Just out of curisity here, why are you exporting &quot;Orders&quot; after going through all the effort to create that <code>qdfNew</code> QueryDef?"}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "edited": false, "score": 0, "creation_date": 1534979236, "post_id": 51975456, "comment_id": 90902891, "body": "@ HansUp: no, I can&#39;t write any file.  That&#39;s the problem.  @ Jiggles32 19: I just thought that&#39;s how you do it.  You definitely need to pass in some parameters to the &#39;DoCmd.TransferText&#39;."}], "answers": [{"comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1535028677, "post_id": 51985957, "comment_id": 90921845, "body": "<code>qryTemp = qdfNew.SQL</code> is unnecessary and makes your code a lot more confusing than it should be."}], "tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 1, "last_activity_date": 1535027722, "creation_date": 1535027722, "answer_id": 51985957, "question_id": 51975456, "link": "https://stackoverflow.com/questions/51975456/trying-to-export-each-record-in-an-access-table-as-a-separate-csv-file/51985957#51985957", "title": "Trying to Export Each Record in an Access Table as a Separate CSV File", "body": "<p>Ah, now I see what the problem is.  I had quotes around a numeric field.  Yes quotes are needed for text, but not for numbers.  Here is the working solution if you are filtering on a numeric field.</p>\n\n<pre><code>Set dbThis = CurrentDb()\n\nSet rsThis = dbThis.OpenRecordset(\"Select Distinct OrderID as dValue from Orders where OrderID is not null\", dbOpenSnapshot)\n\nDo While Not rsThis.EOF\n    Debug.Print rsThis.Fields(\"dValue\").Value\n    Set qdfNew = New QueryDef\n    qdfNew.SQL = \"select * from Orders where OrderID = \" &amp; rsThis.Fields(\"dValue\").Value &amp; \"\"\n    qdfNew.Name = \"qryTemp\"\n    dbThis.QueryDefs.Delete \"qryTemp\"\n    dbThis.QueryDefs.Append qdfNew\n    qryTemp = qdfNew.SQL\n    DoCmd.TransferText acExportDelim, , \"qryTemp\", \"C:\\Test\\\" &amp; rsThis.Fields(\"dValue\").Value &amp; \".csv\", True\n    rsThis.MoveNext\nLoop\nrsThis.Close\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 188, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1594630624, "creation_date": 1534973624, "last_edit_date": 1594630624, "question_id": 51975456, "link": "https://stackoverflow.com/questions/51975456/trying-to-export-each-record-in-an-access-table-as-a-separate-csv-file", "title": "Trying to Export Each Record in an Access Table as a Separate CSV File", "body": "<p>I put together some code that seems like ti should be working, to export each unique record in a table as a separate CSV file, but it is actually exporting ALL records as a CSV file.  This must be close, but something is off, and I can't tell what it is.</p>\n\n<pre><code>Private Sub Command0_Click()\n\nDim dbThis As Database\nDim rsThis As Recordset\nDim qdfNew As QueryDef\n\nSet dbThis = CurrentDb()\n\nSet rsThis = dbThis.OpenRecordset(\"Select Distinct OrderID as dValue from Orders where OrderID is not null\", dbOpenSnapshot)\n\nDo While Not rsThis.EOF\n    Debug.Print rsThis.Fields(\"dValue\").Value\n    Set qdfNew = New QueryDef\n    qdfNew.SQL = \"select * from Orders where OrderID = '\" &amp; rsThis.Fields(\"dValue\").Value &amp; \"'\"\n    qdfNew.Name = \"qryTemp\"\n    dbThis.QueryDefs.Append qdfNew\n    DoCmd.TransferText acExportDelim, , \"Orders\", \"C:\\Test\\\" &amp; rsThis.Fields(\"dValue\").Value &amp; \".csv\", True\n    dbThis.QueryDefs.Delete \"qryTemp\"\n    rsThis.MoveNext\nLoop\nrsThis.Close\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "csv", "excel-2010"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 7458883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a42d46011b1de9ddc776879841ab7d9?s=128&d=identicon&r=PG&f=1", "display_name": "lex", "link": "https://stackoverflow.com/users/7458883/lex"}, "edited": false, "score": 0, "creation_date": 1535035443, "post_id": 51976308, "comment_id": 90926457, "body": "Hey L8n, I&#39;ve updated my question with your edits. Thank you so much! Vielen Dank! I am not looking for something in the file. Just wish to preform the same macro on all files in a folder regardless or name or contents."}, {"owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "reply_to_user": {"reputation": 23, "user_id": 7458883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a42d46011b1de9ddc776879841ab7d9?s=128&d=identicon&r=PG&f=1", "display_name": "lex", "link": "https://stackoverflow.com/users/7458883/lex"}, "edited": false, "score": 0, "creation_date": 1535068679, "post_id": 51976308, "comment_id": 90940914, "body": "@lex Bittesehr, updated my answer with the needed code, you can just use the code above inside the <code>for each</code> clause"}], "tags": [], "owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "is_accepted": true, "score": 0, "last_activity_date": 1535068489, "last_edit_date": 1535068489, "creation_date": 1534979080, "answer_id": 51976308, "question_id": 51975418, "link": "https://stackoverflow.com/questions/51975418/vba-for-excel-csv-looping-through-files-to-get-row-then-appending-rows-into/51976308#51976308", "title": "VBA For Excel (CSV), Looping through files to get row, then appending rows into one List", "body": "<p>I don't know exactly what you are trying to do, the code you have does the following:</p>\n\n<p><code>file = Dir(\"C:\\Users\\me\\Desktop\\test\")</code> writes the filename to <code>file</code> if the file \"test\" exists, if you use <code>Dir(\"C:\\Users\\me\\Desktop\\test\\\")</code> the function will return the name of the first file it finds.<br>\nOn subsequent runs it will return the next file in the folder, keep in mind that this is a global call, so if you call the function somewhere else it may interfere. Using the Microsoft Scripting Engine Runtime is preferable in most cases apart from quick checks if a file exists.</p>\n\n<p><code>If InStr(file, \"test\") &gt; 0 Then</code> You test if \"test\" is a part of the filename, so far so good, but keep in mind to tell InStr how it should compare the two strings. InStr accepts four parameters (all of them optional), be sure to pass the proper ones. The <a href=\"https://docs.microsoft.com/en-us/office/vba/Language/Reference/User-Interface-Help/instr-function\" rel=\"nofollow noreferrer\">microsoft documentation</a> is actually quite decent.</p>\n\n<p>Is this what you wanted? I think you might be looking for something inside the <code>.csv</code> file, if so I can extend the script below.</p>\n\n<p>A simple way to loop though all files in a folder is attached below:</p>\n\n<pre><code>Option Explicit\n\nSub looper()\n    Dim fso As Scripting.FileSystemObject\n    Dim aFolder As Scripting.Folder\n    Dim aFile As Scripting.file\n    Dim aText As Scripting.TextStream\n    Dim targetName As String 'string that identifies files\n    Dim targetWord As String 'string that identifies line inside csv file\n    Dim singleLine As String \n\n    Set fso = New FileSystemObject\n    Set aFolder = fso.GetFolder(\"C:\\Users\\Me\\Desktop\\test\") 'set folder that contains the files\n    targetName = \"someFileName\"\n    targetWord = \"someString\"\n\n    For Each aFile In aFolder.Files 'loops through every file in the top level of the folder\n        If InStr(1, aFile.Name, targetName, vbBinaryCompare) &gt; 0 Then\n            Debug.Print \"Found a matching File: \"; aFile.Name\n            Set aText = fso.OpenTextFile(aFile.Path, ForReading)\n            Do Until aText.AtEndOfStream \n                singleLine = aText.ReadLine 'read line into string, every call advances the line counter by one, this prevents skipping lines\n                If InStr(1, singleLine, targetWord, vbBinaryCompare) &gt; 0 Then Debug.Print singleLine ' in line case, prints line if targer value is found\n            Loop\n        End If\n    Next aFile\n    Debug.Print \"finished\"\nEnd Sub\n</code></pre>\n\n<p>Bonus Info:\nUse option explicit to make sure all variables are declared properly</p>\n\n<hr>\n\n<p><strong>Edit:</strong></p>\n\n<p>Not able to add comments to your post yet, so I'll put the response here.</p>\n\n<p><code>If InStr(1, vbBinaryCompare) &gt; 0 Then</code>  this line is now broken as it will always return 0. If you want to loop through every file just omit the IF-Contitional or set it to <code>If True Then</code>.</p>\n\n<p><code>Range(\"A2:D200210\").Clear</code> is a so called implicit reference, the Range Object refers to the \"Global\" Worksheet. Every time this piece of code is executed, the change happens on the \"Global\" Worksheet, <a href=\"https://stackoverflow.com/questions/51897030/application-cells-vs-application-activesheet-cells/51898006#51898006\">a nice answer by Mathieu Guindon from just recently explains this</a>.</p>\n\n<blockquote>\n  <p>It runs, but it does not seem to implement the changes I want (Range(\"A2:D200210\").Clear ) to each file. Also the string name for my code does not matter, the info in the sheet does not either. My original code was to test if it looped at all.</p>\n</blockquote>\n\n<p>So from what I can see you try to delete everything but the first row inside a .csv file. A .csv file is not a worksheet(even though you can import it into excel), so you can't use the Range property.<br>\nFortunately, there is an even easier way to do this, just use the Microsoft Scripting Runtime to edit the .csv file. </p>\n\n<pre><code>Set aText = aFile.OpenAsTextStream(ForReading) ' open file in read mode\nsingleLine = aText.ReadLine ' read the first line and store it\nSet aText = aFile.OpenAsTextStream(ForWriting) ' open file in write mode\naText.Write (singleLine) 'write the line you saved before\n</code></pre>\n\n<p>Or even more compact:  </p>\n\n<pre><code>aFile.OpenAsTextStream(ForWriting).Write aFile.OpenAsTextStream(ForReading).ReadLine 'overwrites the file with what was written in the first line.\n</code></pre>\n\n<p>The advantage with the longer code is the ability to use the string somewhere else, for example storing it somewhere in your workbook.</p>\n"}], "owner": {"reputation": 23, "user_id": 7458883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a42d46011b1de9ddc776879841ab7d9?s=128&d=identicon&r=PG&f=1", "display_name": "lex", "link": "https://stackoverflow.com/users/7458883/lex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 382, "favorite_count": 0, "accepted_answer_id": 51976308, "answer_count": 1, "score": 2, "last_activity_date": 1535068489, "creation_date": 1534973457, "last_edit_date": 1535035340, "question_id": 51975418, "link": "https://stackoverflow.com/questions/51975418/vba-for-excel-csv-looping-through-files-to-get-row-then-appending-rows-into", "title": "VBA For Excel (CSV), Looping through files to get row, then appending rows into one List", "body": "<p>I am having trouble coding this VBA Macro for a bunch of CSV files (10000). After searching I found/used this for my code:\n<a href=\"https://stackoverflow.com/questions/10380312/loop-through-files-in-a-folder-using-vba?noredirect=1&amp;lq=1\">Loop through files in a folder using VBA?</a> . It doesn't seem to work and I'm not sure why... I have tried the While loop but it is very slow I don't know if it can finish running. </p>\n\n<pre><code>Sub LoopThroughFiles()\nDim MyObj As Object, MySource As Object, file As Variant\nfile = Dir(\"C:\\Users\\me\\Desktop\\test\")\nWhile (file &lt;&gt; \"\")\n  If InStr(file, \"test\") &gt; 0 Then\n        '// my macro code is here\n     Exit Sub\n  End If\n file = Dir\nWend\nEnd Sub\n</code></pre>\n\n<p>What else should I try changing? Where did I go wrong? I have also tried using this code <a href=\"https://www.thespreadsheetguru.com/the-code-vault/2014/4/23/loop-through-all-excel-files-in-a-given-folder\" rel=\"nofollow noreferrer\">https://www.thespreadsheetguru.com/the-code-vault/2014/4/23/loop-through-all-excel-files-in-a-given-folder</a> but am unsure what else to change besides the directory and the <em>'Change First Worksheet's Background Fill Blue</em>. </p>\n\n<p>Also tried this <a href=\"http://www.ozgrid.com/VBA/loop-through.htm\" rel=\"nofollow noreferrer\">http://www.ozgrid.com/VBA/loop-through.htm</a> which seems pretty fool proof but I cant get it to work...</p>\n\n<p><strong>UPDATES FROM L8N</strong></p>\n\n<pre><code>Option Explicit\n\nSub looper()\nDim fso As Scripting.FileSystemObject\nDim aFolder As Scripting.Folder\nDim aFile As Scripting.file\nDim aText As Scripting.TextStreame\nDim singleLine As String\n\nSet fso = New FileSystemObject\nSet aFolder = fso.GetFolder(\"C:\\Users\\ME\\Desktop\\test\") 'set path to the folder that contains the files\n\nFor Each aFile In aFolder.Files 'loops through every file in the top level of the folder\n    If InStr(1, vbBinaryCompare) &gt; 0 Then\n        Range(\"A2:D200210\").Clear   'what i want to happen to every file\n        Set aText = fso.OpenTextFile(aFile.Path, ForReading)\n        Do Until aText.AtEndOfStream\n            singleLine = aText.ReadLine 'read line into string, every call advances the line counter by one, this prevents skipping lines\n            If InStr(1, singleLine, vbBinaryCompare) &gt; 0 Then Debug.Print singleLine ' in line case, prints line if target value is found\n        Loop\n    End If\nNext aFile\nDebug.Print \"finished\"\n</code></pre>\n\n<p>End Sub</p>\n\n<p>It runs, but it does not seem to implement the changes I want (Range(\"A2:D200210\").Clear ) to each file. Also the string name for my code does not matter, the info in the sheet does not either. My original code was to test if it looped at all.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 1, "creation_date": 1534972340, "post_id": 51975113, "comment_id": 90900826, "body": "Which book has the code and which book has the data that is going to be copied to other book? You do not need to <code>.Select</code> anything to <code>Copy&#47;Paste</code>"}, {"owner": {"reputation": 1, "user_id": 10261743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fb14bccae26dd38dd231ed6800c9e96?s=128&d=identicon&r=PG&f=1", "display_name": "yaboySH", "link": "https://stackoverflow.com/users/10261743/yaboysh"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1534973203, "post_id": 51975113, "comment_id": 90901155, "body": "&quot;Comp1.xlsx&quot; is the book with the data. The picture shows the book where it will be pasted. The reason I am using Select is because I want it pasted in a particular format."}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1534973244, "post_id": 51975113, "comment_id": 90901169, "body": "this is not how VBA works, you don&#39;t need to immitate the UI, you can do this easily with VBA, but your question does not say anything specific and it is not clear enough"}, {"owner": {"reputation": 1, "user_id": 10261743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fb14bccae26dd38dd231ed6800c9e96?s=128&d=identicon&r=PG&f=1", "display_name": "yaboySH", "link": "https://stackoverflow.com/users/10261743/yaboysh"}, "edited": false, "score": 0, "creation_date": 1534973508, "post_id": 51975113, "comment_id": 90901280, "body": "Comps Proto hosts the code. I would like the macro to copy ranges with fixed starting points and variable ending points and then paste the selections into the Comps Proto in a particular format. The format is pretty straight forward, but I just want a row to be inserted after each paste."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1534974023, "post_id": 51975113, "comment_id": 90901477, "body": "You can find many answers here on how to find dynamic last row here. All you have to do to leave a blank is offset by 1. See <a href=\"https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba\">here</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 10261743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fb14bccae26dd38dd231ed6800c9e96?s=128&d=identicon&r=PG&f=1", "display_name": "yaboySH", "link": "https://stackoverflow.com/users/10261743/yaboysh"}, "is_accepted": false, "score": 0, "last_activity_date": 1535032307, "creation_date": 1535032307, "answer_id": 51987453, "question_id": 51975113, "link": "https://stackoverflow.com/questions/51975113/dynamic-copy-and-pasting-using-ctrlshiftdown-function-aka-selection-endx1down/51987453#51987453", "title": "Dynamic copy and pasting using ctrl+shift+down function aka Selection.End(x1down)", "body": "<p>The main issue I was trying to resolve was getting the cursor to click off a pasted range, so that I could continue. I found the code below to be helpful. This is the original post on another forum: <a href=\"https://superuser.com/questions/342772/how-do-i-move-the-selection-down-one-row-in-excel-2007/342835\">https://superuser.com/questions/342772/how-do-i-move-the-selection-down-one-row-in-excel-2007/342835</a></p>\n\n<pre><code>Dim ColNumber As Integer\n\nColNumber = Selection.Column\nRange(\"K\" &amp; CStr(ColNumber)).Select 'Click off the pasted values\nActiveCell.End(xlDown).Select 'Equivalent of ctrl+down\nActiveCell.End(xlDown).Select 'Moves down through the range in picture\nActiveCell.Offset(2, 0).Select 'Moves selection to the \"Start\" point in picture above\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "is_accepted": false, "score": 0, "last_activity_date": 1535046595, "creation_date": 1535046595, "answer_id": 51991581, "question_id": 51975113, "link": "https://stackoverflow.com/questions/51975113/dynamic-copy-and-pasting-using-ctrlshiftdown-function-aka-selection-endx1down/51991581#51991581", "title": "Dynamic copy and pasting using ctrl+shift+down function aka Selection.End(x1down)", "body": "<p>Judging by your range location, it has free cells across all borders. This allows to use handy <code>CurrentRegion</code> property. In my code I assume you have 5 such blocks to copy. Feel free to change the place to copy to.</p>\n\n<pre><code>Sub MoveCells()\n    Dim x%, rng As Range\n    Set rng = [E5].CurrentRegion\n    '// Copy 5 blocks of cells\n    Do\n        '// Change target cell to the one you need\n        rng.Copy Sheets(2).Cells(1, x + 1)\n        '// Here we locate last cell in block of cells, offset two cells down\n        '// and select CurrentRegion again\n        Set rng = rng(rng.Cells.Count).Offset(2).CurrentRegion\n        x = x + 1\n    Loop While x &lt;= 5\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10261743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fb14bccae26dd38dd231ed6800c9e96?s=128&d=identicon&r=PG&f=1", "display_name": "yaboySH", "link": "https://stackoverflow.com/users/10261743/yaboysh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1535046595, "creation_date": 1534971920, "last_edit_date": 1534972075, "question_id": 51975113, "link": "https://stackoverflow.com/questions/51975113/dynamic-copy-and-pasting-using-ctrlshiftdown-function-aka-selection-endx1down", "title": "Dynamic copy and pasting using ctrl+shift+down function aka Selection.End(x1down)", "body": "<p>I am attempting to move ranges (of varying lengths) between two workbooks. </p>\n\n<pre><code>Windows(\"Comp1.xlsx\").Activate 'Open sheet to pull data from\nRange(\"E2\").Select 'Starting point is the same every time\nRange(Selection, Selection.End(xlDown)).Select 'Select all data below\nApplication.CutCopyMode = False\nSelection.Copy 'Copy range\nWindows(\"Comps Proto.xlsm\").Activate 'Sheet to be pasted into\nRange(\"K12\").Select\nSelection.PasteSpecial Paste:=xlPasteValuesAndNumberFormats, Operation:= _\n    xlNone, SkipBlanks:=False, Transpose:=False 'Paste data into new sheet\n</code></pre>\n\n<p>In order to repeat this function for the next workbook, I need to move off the pasted selection. I have tried everything, including offset, and <code>Application.CutCopyMode = False</code>. Doesn't work. </p>\n\n<p>See below picture: The first paste cycle ends with that range selected. I want to move to the cell labeled and circled Start. This is where the next range will be pasted in the same fashion as above, rinse and repeat</p>\n\n<p><img src=\"https://i.stack.imgur.com/npyII.png\" alt=\"Picture\"></p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1534971970, "post_id": 51975048, "comment_id": 90900688, "body": "Are you searching to see if the entire record is in tblTeam, or just the unique identifier of EmailAddress?"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1534972287, "post_id": 51975048, "comment_id": 90900808, "body": "Don&#39;t &quot;Loop&quot; through a table. That is an absolute last resort. Instead get a &quot;Set&quot; that matches your definition <code>SELECT tblNew.emailAddress FROM tblNew LEFT OUTER JOIN tblTeam ON tblNew.emailAddress = tblTeam.EmailAddress WHERE tblTeam.EmailAddress IS NULL GROUP BY emailAddress</code> that will give you a list of distinct email address in <code>tblNew</code> that isn&#39;t <code>tblTeam</code> already. Now stick <code>INSERT INTO tblX (emailAddress) &lt;that same SELECT statement&gt;</code> to insert them all at once. No loops and just on SQL statement will do this."}], "answers": [{"tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": false, "score": 2, "last_activity_date": 1534972414, "creation_date": 1534972414, "answer_id": 51975219, "question_id": 51975048, "link": "https://stackoverflow.com/questions/51975048/access-vba-if-record-does-not-exist-then-insert-to-another-table/51975219#51975219", "title": "Access VBA - if record does not exist then insert to another table", "body": "<p>VBA is not necessarily required for this task - it can be quite easily achieved using an <code>INSERT</code> statement (aka Append Query), for example:</p>\n\n<pre><code>INSERT INTO tblX\nSELECT \n    tblNew.*\nFROM    \n    tblNew LEFT JOIN tblTeam ON tblNew.EmailAddress = tblTeam.EmailAddress\nWHERE \n    tblTeam.EmailAddress IS NULL\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 8991313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3be7cd7f98549ad7631a3ee723a671f3?s=128&d=identicon&r=PG&f=1", "display_name": "JBJB", "link": "https://stackoverflow.com/users/8991313/jbjb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1534972414, "creation_date": 1534971586, "question_id": 51975048, "link": "https://stackoverflow.com/questions/51975048/access-vba-if-record-does-not-exist-then-insert-to-another-table", "title": "Access VBA - if record does not exist then insert to another table", "body": "<p>Completely new to Access VBA so please be nice!</p>\n\n<p>I have tblNew and tblTeam. </p>\n\n<p>I want to loop through each record in tblNew to check if it already exists in tblTeam. The identifier is the email address. If the record does not exist then I want to add the record to tblX.</p>\n\n<p>I'm stuck on searching to check if the record exists and how to loop through each record in the tblNew. </p>\n\n<p>Apologies if I've duplicated any questions, I really couldn't understand or find what I was looking for.</p>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 82, "user_id": 1687245, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/20d4818519fc6b422366e322ed03e8fa?s=128&d=identicon&r=PG", "display_name": "ni37osllb", "link": "https://stackoverflow.com/users/1687245/ni37osllb"}, "edited": false, "score": 0, "creation_date": 1534971734, "post_id": 51974956, "comment_id": 90902507, "body": "Have you tried vbBinaryCompare comparisons using InStr(), or Left() and Right()?"}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1534972210, "post_id": 51974956, "comment_id": 90900779, "body": "This is not difficult, you can have many approaches, I would keep them strings all the time, and just format it so if you format 123 as a 6 character it would be 000123 and anything coming from Access can be compared easily so use <code>format(123,&quot;000000&quot;)</code>"}, {"owner": {"reputation": 1, "user_id": 10198732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98cd2f1a213359ed0eb4eca6947e7a4f?s=128&d=identicon&r=PG", "display_name": "JMP883", "link": "https://stackoverflow.com/users/10198732/jmp883"}, "edited": false, "score": 0, "creation_date": 1534972498, "post_id": 51974956, "comment_id": 90900876, "body": "That&#39;s correct if I have the columns formatted for strings, the zeroes cause problems depending on where they are placed.  My &quot;main&quot; table with the error codes is cross referenced with the &quot;key&quot; that describes the fault.  So I download the codes, split them in half, then compare the halves against the key.  My table will show something like &quot;001234&quot; and the key will only show &quot;1234&quot;... with length depending on the number of zeroes.  It could be &quot;000001&quot; vs &quot;1&quot;.  I&#39;ve been keeping everything formatted as numbers for the time being to avoid problems with those zeroes."}], "answers": [{"tags": [], "owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "is_accepted": false, "score": 0, "last_activity_date": 1534972942, "last_edit_date": 1534972942, "creation_date": 1534972603, "answer_id": 51975259, "question_id": 51974956, "link": "https://stackoverflow.com/questions/51974956/comparing-values-with-some-alphanumerics/51975259#51975259", "title": "Comparing values with some alphanumerics", "body": "<p>You have not provided a minimal sample of the data and also the output, also there is no code that I can amend it for you, but the only part that you are having problem is comparing the alphanumeric ones, you should format all of your data as strings and then compare. to make 123 be equal to \"000123\" you need to just format the numeric ones as string as below:</p>\n\n<pre><code>format(123,\"000000\")\n</code></pre>\n\n<p>which will give you <code>\"000123\"</code></p>\n\n<p><strong>Edit</strong></p>\n\n<p>from you comment I learned that the problem is the key that is always or often a number, <code>format</code> will return the proper string for comparison, if it is already a 6-character string it will return itself so there would not be a problem:</p>\n\n<p>do something like this:</p>\n\n<pre><code>if format(key,\"0000000\")=format(code,\"000000\") then\n    'do something\nend if\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10198732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98cd2f1a213359ed0eb4eca6947e7a4f?s=128&d=identicon&r=PG", "display_name": "JMP883", "link": "https://stackoverflow.com/users/10198732/jmp883"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594630665, "creation_date": 1534971172, "last_edit_date": 1594630665, "question_id": 51974956, "link": "https://stackoverflow.com/questions/51974956/comparing-values-with-some-alphanumerics", "title": "Comparing values with some alphanumerics", "body": "<p>I've looked through the forums but couldn't find any questions (with answers) that helped.  Any guidance would be appreciated.</p>\n\n<p>I'm working on an Excel/Access project that cross references error codes.  The codes are twelve digits long, with the first half and second half that need to be sortable.  99% of these codes are entirely numeric, but the 1% that includes letters is really screwing me up.</p>\n\n<p>For example, a common error code might be \"386748000123\".  This would be split into \"386748\" and \"000123\", with the first being the code for the type of system and the second being the type of error.</p>\n\n<p>But then the 1% are something like this: \"0957AB003A41\".  \"0957AB\", and \"003A41\".  </p>\n\n<p>If I format the columns (in Excel and Access) as numbers than the numeric comparisons are far easier, \"000123\" equals \"123\".  If I format the column as strings than I can compare the alphanumeric values but then \"000123\" and \"123\" stop crossing.</p>\n\n<p>The possible solution I've come across is utilizing the Val function inside an Access query to purely compare values but I've never used it and it seems like only a partial fix.  Val ignores the strings, which means \"0957AB\" will have the same value as \"0957XY\" - and that doesn't work for this project.</p>\n\n<p>I'm sure many of you have had similar issues, so I'm hoping to get some ideas on different ways the problem has been approached and resolved.  </p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1534975443, "post_id": 51974916, "comment_id": 90901985, "body": "Try using <code>ReceivedTime</code> filter - Example <a href=\"https://stackoverflow.com/a/43622710/4539709\">stackoverflow.com/a/43622710/4539709</a>"}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1534979010, "post_id": 51974916, "comment_id": 90902840, "body": "Appears  Access code is not needed. If so, edit the question to remove. <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}], "answers": [{"tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": false, "score": 0, "last_activity_date": 1535399883, "creation_date": 1535399883, "answer_id": 52046189, "question_id": 51974916, "link": "https://stackoverflow.com/questions/51974916/loop-thought-my-outlook-inbox-using-vba/52046189#52046189", "title": "Loop thought my Outlook inbox using vba", "body": "<p>There are no apparent errors in your code. So you already know how to loop through a folder.</p>\n\n<p>After dropping the references to Access and extra variables you should find this code is essentially the same but simpler. Try to identify whether the problem is due to the GiftCard mailbox, Access ...</p>\n\n<pre><code>Sub log_folder_SimplerExample()\n\n    Dim myNamespace As Namespace\n    Dim myFolder As Folder\n\n    Dim myMail As Items\n    Dim cMail As mailItem\n\n    Dim iNumMessages As Long\n    Dim i As Long\n\n    Set myNamespace = GetNamespace(\"MAPI\")\n    'put your folders name here\n    'Set myFolder = myNamespace.Folders(\"GiftCard\").Folders(\"Inbox\")\n    'Set myFolder = myNamespace.Folders(\"GiftCard\").Folders(\"Sent Items\")\n    'Set myFolder = myNamespace.Folders(\"GiftCard\").Folders(\"Deleted Items\")\n\n    ' Check other folders for comparison\n    Set myFolder = myNamespace.GetDefaultFolder(olFolderInbox)\n    'Set myFolder = myNamespace.GetDefaultFolder(olFolderSentMail)\n    'Set myFolder = myNamespace.GetDefaultFolder(olFolderDeletedItems)\n\n    Set myMail = myFolder.Items\n\n    MsgBox myMail.count\n\n    ' Use myMail.count since the result is the expected\n    ' Drop possibly extraneous variables\n\n    iNumMessages = myMail.count\n\n    If iNumMessages &gt; 4 Then\n\n        For i = 5 To iNumMessages\n\n            If TypeName(myMail(i)) = \"MailItem\" Then\n\n                Set cMail = myMail(i)\n\n                Debug.Print i &amp; \" - \" &amp; myMail(i).SentOn\n\n                If (CDate(cMail.SentOn) &gt; CDate(\"2017-06-29\") And CDate(cMail.SentOn) &lt; CDate(\"2018-08-22\")) Then\n                    Debug.Print \"   \" &amp; cMail.senderName &amp; vbCr\n                End If\n\n            End If\n\n        Next i\n\n    End If\n\n    Debug.Print \"Done.\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 4435, "user_id": 2581266, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/100001828256469/picture?type=large", "display_name": "Papouche Guinslyzinho", "link": "https://stackoverflow.com/users/2581266/papouche-guinslyzinho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 155, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1592943192, "creation_date": 1534971015, "last_edit_date": 1592943192, "question_id": 51974916, "link": "https://stackoverflow.com/questions/51974916/loop-thought-my-outlook-inbox-using-vba", "title": "Loop thought my Outlook inbox using vba", "body": "<p>Hi I want to retrieve all the email from 2017-06-29 to today but I only get save in MS access from Today to July 31 2018 which represent about the last 23 days. I have over <strong>7345 emails</strong> on that inbox. </p>\n\n<p>My error is that the loop stop after just over the 350th email</p>\n\n<pre><code>Sub log_your_inbox_to_ms_access()\n\n    'our Outlook folder- deifinitions\n    Dim myItem As MailItem\n    Dim myFolder As Folder\n    Dim myNamespace As NameSpace\n    Set myNamespace = Application.GetNamespace(\"MAPI\")\n    'put your folders name here\n    'second is possibly 'inbox folder'\n    Set myFolder = myNamespace.Folders(\"GiftCard\").Folders(\"Inbox\")\n\n    ' Set up DAO objects (uses existing Access \"Email\" table).\n    Dim rst As DAO.Recordset\n    Set rst = CurrentDb.OpenRecordset(\"Email\")\n\n    'Set Up Outlook objects.\n    Dim cMail As Outlook.MailItem\n    Dim cAtch As Outlook.Attachments\n\n\n    Set myMail = myFolder.Items\n    'MsgBox myMail.Count '7345\n\n    Set objProp = myMail\n\n    iNumMessages = objProp.Count\n    If iNumMessages &lt;&gt; 0 Then\n        For i = 5 To iNumMessages\n            If TypeName(objProp(i)) = \"MailItem\" Then\n                Set cMail = objProp(i)\n                Debug.Print cMail.SentOn\n                If (CDate(cMail.SentOn) &gt; CDate(\"2017-06-29\") And CDate(cMail.SentOn) &lt; CDate(\"2018-08-22\")) Then\n                    rst.AddNew\n                    rst!SenderName = cMail.SenderName\n                    rst!Sender = cMail.SenderEmailAddress\n                    rst!SentOn = cMail.SentOn\n                    rst!To = cMail.To\n                    rst!CC = cMail.CC\n                    rst!Subject = cMail.Subject\n                    rst.Update\n                End If\n            End If\n        Next i\n    End If\n\n\n\nEnd Sub\n</code></pre>\n\n<p>When I debug 'i' it seems like it only contains 351 items</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 82, "user_id": 1687245, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/20d4818519fc6b422366e322ed03e8fa?s=128&d=identicon&r=PG", "display_name": "ni37osllb", "link": "https://stackoverflow.com/users/1687245/ni37osllb"}, "is_accepted": false, "score": 0, "last_activity_date": 1534970978, "creation_date": 1534970978, "answer_id": 51974906, "question_id": 51974853, "link": "https://stackoverflow.com/questions/51974853/calling-a-variable-from-outside-module-vba/51974906#51974906", "title": "Calling a variable from outside module (VBA)", "body": "<blockquote>\n  <p>Global pwd As String</p>\n</blockquote>\n\n<p>inside of a module-level module (not a sheet-level module).</p>\n"}, {"comments": [{"owner": {"reputation": 1009, "user_id": 8981066, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HFh7Jm-OT-E/AAAAAAAAAAI/AAAAAAAABl8/oDH6HzC4eFw/photo.jpg?sz=128", "display_name": "Oday Salim", "link": "https://stackoverflow.com/users/8981066/oday-salim"}, "edited": false, "score": 0, "creation_date": 1534979275, "post_id": 51976128, "comment_id": 90902899, "body": "I intend to manipulate it in one or more of the functions in the module. Is constant viable?"}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "reply_to_user": {"reputation": 1009, "user_id": 8981066, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HFh7Jm-OT-E/AAAAAAAAAAI/AAAAAAAABl8/oDH6HzC4eFw/photo.jpg?sz=128", "display_name": "Oday Salim", "link": "https://stackoverflow.com/users/8981066/oday-salim"}, "edited": false, "score": 0, "creation_date": 1534979987, "post_id": 51976128, "comment_id": 90903038, "body": "@OdaySalim a constant is constant ;) Not changeable! I would suggest a property. See answer of <a href=\"https://stackoverflow.com/questions/46772270/excel-vba-global-variable/46772922#46772922\">Mathieu</a>  and have a look at the other related questions as I told you."}], "tags": [], "owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "is_accepted": true, "score": 2, "last_activity_date": 1534977760, "creation_date": 1534977760, "answer_id": 51976128, "question_id": 51974853, "link": "https://stackoverflow.com/questions/51974853/calling-a-variable-from-outside-module-vba/51976128#51976128", "title": "Calling a variable from outside module (VBA)", "body": "<p>Your example is a constant.</p>\n\n\n\n<pre><code>Public Const pwd as String = \"password\"\n</code></pre>\n\n<p>Declare it on top of a standard module.</p>\n\n<p>For other solutions with subs, functions or properties look at the Related-Section on the right side of the page.</p>\n"}], "owner": {"reputation": 1009, "user_id": 8981066, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HFh7Jm-OT-E/AAAAAAAAAAI/AAAAAAAABl8/oDH6HzC4eFw/photo.jpg?sz=128", "display_name": "Oday Salim", "link": "https://stackoverflow.com/users/8981066/oday-salim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 51976128, "answer_count": 2, "score": 0, "last_activity_date": 1534977760, "creation_date": 1534970759, "question_id": 51974853, "link": "https://stackoverflow.com/questions/51974853/calling-a-variable-from-outside-module-vba", "title": "Calling a variable from outside module (VBA)", "body": "<p>Is there a clever way of storing variables globally so that you can call them at any of the modules at anytime?</p>\n\n<p>Example</p>\n\n<pre><code>Dim pwd As String\npwd = \"password\"\n\nPrivate Sub Test()\n    MsgBox (pwd)\nEnd Sub\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1534970459, "post_id": 51974589, "comment_id": 90900072, "body": "When you restart oulook, is your draft saved? Is it possibly the <code>.Save</code> line crashing it?"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1534983315, "post_id": 51974589, "comment_id": 90903619, "body": "set your <code>Objects</code> to <code>Nothing</code>, see if that helps- Example <code>Set ExApp = Nothing</code>"}], "answers": [{"tags": [], "owner": {"reputation": 340, "user_id": 10259066, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vZVBX.png?s=128&g=1", "display_name": "DaanV", "link": "https://stackoverflow.com/users/10259066/daanv"}, "is_accepted": false, "score": 0, "last_activity_date": 1534977725, "creation_date": 1534977725, "answer_id": 51976124, "question_id": 51974589, "link": "https://stackoverflow.com/questions/51974589/calling-excel-macro-from-outlook-freezes-outlook/51976124#51976124", "title": "Calling Excel Macro From Outlook Freezes Outlook", "body": "<p>As far as I can seem from your code is that Outlook is still waiting on excel. and thus will never break out of this: <code>ExWbk.Application.Run \"Module1.BodeFlash\"</code></p>\n\n<p>I would suggest putting on the end of your excel code:</p>\n\n<pre><code>Application.Quit\n</code></pre>\n\n<p>and see if that works. it should quit completly quit the excel application but I have no idea if it closes outlook as well.</p>\n"}], "owner": {"reputation": 11, "user_id": 10261659, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-VmnzukC--Eg/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaMWLcVF-CdPs5JOwEt9lFyI37iuGw/mo/photo.jpg?sz=128", "display_name": "willemvdb7", "link": "https://stackoverflow.com/users/10261659/willemvdb7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 248, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1592943214, "creation_date": 1534969503, "last_edit_date": 1592943214, "question_id": 51974589, "link": "https://stackoverflow.com/questions/51974589/calling-excel-macro-from-outlook-freezes-outlook", "title": "Calling Excel Macro From Outlook Freezes Outlook", "body": "<p>I am having a very difficult time creating an Outlook Macro that opens a file, calls an excel macro, and saves a draft email. </p>\n\n<p>In terms of process--I know it would be much easier just to have an Excel macro send a mail rather than switching between programs, but that is not possible right now due to large files and other constraints that aren't important. </p>\n\n<p>Here is the Outlook Code</p>\n\n<pre><code>Sub bodeemail()\n    Dim ExApp As Excel.Application\n    Dim ExWbk As Workbook\n    Set ExApp = New Excel.Application\n    Set ExWbk = ExApp.Workbooks.Open(\"X:\\Dropbox\\xxxx\\xxxx.xlsm\")\n    ExApp.Visible = False\n\n    ExWbk.Application.Run \"Module1.BodeFlash\"\n\n     ExWbk.Close SaveChanges:=False\n\nEnd Sub\n</code></pre>\n\n<p>Here is the Excel code. </p>\n\n<pre><code>Sub BODEFlash()\n    ThisWorkbook.Sheets(\"Email 2.0\").Activate\n    bode = ActiveSheet.Cells(1, \"AG\")\n    bodetext = Format(bode, \"#,###\")\n\n    Dim OutApp As Object\n    Set OutApp = CreateObject(\"Outlook.Application\")\n    Dim OutMail As Object\n    Set OutMail = OutApp.CreateItem(olMailItem)\n\n    Dim signature As String\n    Dim tstamp As String\n    Dim strBody As String\n\n\n    Application.ScreenUpdating = True\n\n    ' Subject location\n    tstamp = \"Subject \" &amp; Format(Date, \"mm/dd/yyyy\")\n    OutMail.Display\n    signature = OutMail.HTMLBody\n\n    ' Change change email list here\n\n\n    On Error Resume Next\n    With OutMail\n        .To = \"foo@bar.com\" \n        .BCC = \"\"\n        .Subject = tstamp\n        .HTMLBody = \"Flash Approved. \" &amp; bodetext &amp; vbNewLine &amp; signature\n        .Save\n    End With\n\n    'Tidy Up\n\n    Set OutApp = Nothing\n    Set OutMail = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>I have a feeling that this has to do with an Object Library or a DoWhile clause, but haven't been able to pin it down. The macro runs, creates the email, and immediately freezes outlook (have to restart in task manager). </p>\n\n<p>Any advice would be much appreciated. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 1, "creation_date": 1534968557, "post_id": 51974352, "comment_id": 90899174, "body": "&quot;The 8th of the month minus the weekday number of the 4th of that month plus 14 days&quot; Is that right?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1534968755, "post_id": 51974352, "comment_id": 90899264, "body": "Look at <code>DateAdd</code> and <code>DateSerial</code> functions..."}, {"owner": {"reputation": 63, "user_id": 3645000, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9f31e3f747412b9145cdfcf211c0d378?s=128&d=identicon&r=PG&f=1", "display_name": "tharun", "link": "https://stackoverflow.com/users/3645000/tharun"}, "edited": false, "score": 0, "creation_date": 1534968763, "post_id": 51974352, "comment_id": 90899266, "body": "yes @ JNevill, the formula will return the 3rd Wednesday of every month"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1534968808, "post_id": 51974352, "comment_id": 90899293, "body": "Did you try converting it on your own? I&#39;m guessing the down-votes are because of a lack of attempt..."}], "answers": [{"tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": true, "score": 1, "last_activity_date": 1534969062, "creation_date": 1534969062, "answer_id": 51974491, "question_id": 51974352, "link": "https://stackoverflow.com/questions/51974352/excel-convert-excel-date-formula-to-vba/51974491#51974491", "title": "Excel convert excel date formula to VBA", "body": "<p>I think this is true to the math. Seems to be outputting the same thing:</p>\n\n<pre><code>Public Function thirdWednesday(inDate As Date) As Date\n    thirdWednesday = ((inDate - Day(inDate) + 8) - Weekday(inDate - Day(inDate) + 4)) + 14\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 3645000, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9f31e3f747412b9145cdfcf211c0d378?s=128&d=identicon&r=PG&f=1", "display_name": "tharun", "link": "https://stackoverflow.com/users/3645000/tharun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "closed_date": 1594152401, "accepted_answer_id": 51974491, "answer_count": 1, "score": -5, "last_activity_date": 1594152398, "creation_date": 1534968414, "last_edit_date": 1594152398, "question_id": 51974352, "link": "https://stackoverflow.com/questions/51974352/excel-convert-excel-date-formula-to-vba", "closed_reason": "Needs more focus", "title": "Excel convert excel date formula to VBA", "body": "<p>I have this Excel formula below;</p>\n\n<pre><code>=DATE(YEAR(G8),MONTH(G8),8)-WEEKDAY(DATE(YEAR(G8),MONTH(G8),4))+14\n</code></pre>\n\n<p>I would like to convert this Excel formula into a VBA \nIs it possible to do this in Excel VBA? Please help</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": false, "score": 0, "last_activity_date": 1534968306, "creation_date": 1534968306, "answer_id": 51974327, "question_id": 51974035, "link": "https://stackoverflow.com/questions/51974035/vba-transfer-data-from-one-sheet-to-another-based-on-text-and-placing-in-into-a/51974327#51974327", "title": "VBA- Transfer data from one sheet to another based on text and placing in into a specific location in the other sheet", "body": "<p>Your code is working, you just need to re-grab the <code>LRow2</code> value after you paste a new line - otherwise you're always overwriting your first line (and in you case, your last copied line is blank, so it <em>looks</em> like nothing is happening when it actually is).</p>\n\n<p>I've also added <code>Application.CutCopyMode = False</code> to the end, as good practice (that clears the clipboard).</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim ws1 As Worksheet: Set ws1 = ThisWorkbook.Sheets(\"Sheet4\")\nDim ws2 As Worksheet: Set ws2 = ThisWorkbook.Sheets(\"PDH_Handover\")\n\nDim LRow1 As Long, LRow2 As Long, i As Long\nLRow1 = ws1.Range(\"A\" &amp; ws1.Rows.Count).End(xlUp).Row\nLRow2 = ws2.Range(\"A\" &amp; ws2.Rows.Count).End(xlUp).Row\n\nFor i = 2 To LRow1\n    If ws1.Cells(i, 1) = \"PP\" Then\n        ws1.Range(Cells(i, 2), Cells(i, 5)).Copy\n        ws2.Range(\"A\" &amp; LRow2 + 1).PasteSpecial xlPasteValues\n\n        'Get new last row value\n        LRow2 = ws2.Range(\"A\" &amp; ws2.Rows.Count).End(xlUp).Row\n    End If\nNext\n\nApplication.CutCopyMode = False\n\nEnd Sub\n</code></pre>\n\n<p>Rather, let's just get rid of <code>Copy/Paste</code> altogether, as it's best to avoid syntax that relies on <code>ActiveSheet</code>:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim ws1 As Worksheet: Set ws1 = ThisWorkbook.Sheets(\"Sheet4\")\nDim ws2 As Worksheet: Set ws2 = ThisWorkbook.Sheets(\"PDH_Handover\")\n\nDim LRow1 As Long, LRow2 As Long, i As Long\nLRow1 = ws1.Range(\"A\" &amp; ws1.Rows.Count).End(xlUp).Row\nLRow2 = ws2.Range(\"A\" &amp; ws2.Rows.Count).End(xlUp).Row\n\nFor i = 2 To LRow1\n    If ws1.Cells(i, 1) = \"PP\" Then\n        ws2.Range(ws2.Cells(LRow2 + 1, 1), ws2.Cells(LRow2 + 1, 4)).Value = _\n        ws1.Range(ws1.Cells(i, 2), ws1.Cells(i, 5)).Value\n\n        'Get new last row value\n        LRow2 = ws2.Range(\"A\" &amp; ws2.Rows.Count).End(xlUp).Row\n    End If\nNext\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 10251748, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JEKIRJ_wN-Y/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOCYBKRP7MFtzPK3sy2ClvLoXvZHQ/mo/photo.jpg?sz=128", "display_name": "Camilo Matamoros", "link": "https://stackoverflow.com/users/10251748/camilo-matamoros"}, "edited": false, "score": 0, "creation_date": 1535037385, "post_id": 51978767, "comment_id": 90927731, "body": "Any idea how I would make it so that it would start appending onto A:11 vs just starting at A2 like it currently is?"}], "tags": [], "owner": {"reputation": 1676, "user_id": 9992612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef2e5e68dd3a455ba00724f5fdfaf604?s=128&d=identicon&r=PG&f=1", "display_name": "Seiya Su", "link": "https://stackoverflow.com/users/9992612/seiya-su"}, "is_accepted": false, "score": 0, "last_activity_date": 1535001330, "creation_date": 1535001330, "answer_id": 51978767, "question_id": 51974035, "link": "https://stackoverflow.com/questions/51974035/vba-transfer-data-from-one-sheet-to-another-based-on-text-and-placing-in-into-a/51978767#51978767", "title": "VBA- Transfer data from one sheet to another based on text and placing in into a specific location in the other sheet", "body": "<p>If we get the right value of LRow2 in the first time, I prefer to <strong>LRow2 = LRow2 + 1</strong>\nbut not to <strong>End(xlUp).row</strong></p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim ws1 As Worksheet, ws2 As Worksheet\nDim LRow1 As Long, LRow2 As Long, i As Long\n\nSet ws1 = Application.ThisWorkbook.Sheets(\"Sheet4\")\nSet ws2 = Application.ThisWorkbook.Sheets(\"PDH_Handover\")\nLRow1 = ws1.Range(\"A\" &amp; ws1.Rows.Count).End(xlUp).row\nLRow2 = ws2.Range(\"A\" &amp; ws2.Rows.Count).End(xlUp).row\n\nFor i = 2 To LRow1\n    If ws1.Cells(i, 1) = \"PP\" Then\n        ws1.Range(Cells(i, 2), Cells(i, 5)).Copy\n        ws2.Range(\"A\" &amp; LRow2 + 1).PasteSpecial xlPasteValues\n\n        'Get new last row value\n        LRow2 = LRow2 + 1\n    End If\nNext\n</code></pre>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 3, "user_id": 10251748, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JEKIRJ_wN-Y/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOCYBKRP7MFtzPK3sy2ClvLoXvZHQ/mo/photo.jpg?sz=128", "display_name": "Camilo Matamoros", "link": "https://stackoverflow.com/users/10251748/camilo-matamoros"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1535001330, "creation_date": 1534966785, "last_edit_date": 1534967634, "question_id": 51974035, "link": "https://stackoverflow.com/questions/51974035/vba-transfer-data-from-one-sheet-to-another-based-on-text-and-placing-in-into-a", "title": "VBA- Transfer data from one sheet to another based on text and placing in into a specific location in the other sheet", "body": "<p><a href=\"https://i.stack.imgur.com/BZxen.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BZxen.jpg\" alt=\"img1\"></a></p>\n\n<p>This would be the data, I would like to be able to take all the PP from sheet4 and paste them into sheet PDH_Handvoer in a specific range say A11:A22. Then also take the FA and paste them into the same sheet but with range A30:A42 and so one for each of the letters. </p>\n\n<p><a href=\"https://i.stack.imgur.com/ezesD.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ezesD.jpg\" alt=\"img2\"></a></p>\n\n<p>so far this is the code, but it isnt doing what I need it to </p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n\nDim ws1 As Worksheet: Set ws1 = ThisWorkbook.Sheets(\"Sheet4\")\nDim ws2 As Worksheet: Set ws2 = ThisWorkbook.Sheets(\"PDH_Handover\")\n\nDim LRow1 As Long, LRow2 As Long, i As Long\nLRow1 = ws1.Range(\"A\" &amp; ws1.Rows.Count).End(xlUp).Row\nLRow2 = ws2.Range(\"A\" &amp; ws2.Rows.Count).End(xlUp).Row\n\nFor i = 2 To LRow1\n    If ws1.Cells(i, 1) = \"pp\" Then\n        ws1.Range(Cells(i, 2), Cells(i, 5)).Copy\n        ws2.Range(\"A\" &amp; LRow2 + 1).PasteSpecial xlPasteValues\n    End If\nNext\nEnd Sub \n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2007", "copy-paste"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1534966742, "post_id": 51973951, "comment_id": 90898422, "body": "Is the idea that the single value in <code>B</code> is the factor that you multiply each value in <code>A</code> by?"}, {"owner": {"reputation": 3, "user_id": 10240733, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157310432630021/picture?type=large", "display_name": "David Fujii", "link": "https://stackoverflow.com/users/10240733/david-fujii"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1534966948, "post_id": 51973951, "comment_id": 90898506, "body": "Yes. I have re-edit my question to show images of what I want copied to how I want the paste to look like. in this example I want the items to paste 3 times. I&#39;m assuming that if I can do it for one &quot;Floor&quot; I would be able to use a loop? I am not sure what is the best way."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1535034238, "post_id": 51973951, "comment_id": 90925639, "body": "Will there only every be the one value in the copy column? Otherwise I&#39;m not sure how you&#39;d handle this"}, {"owner": {"reputation": 3, "user_id": 10240733, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157310432630021/picture?type=large", "display_name": "David Fujii", "link": "https://stackoverflow.com/users/10240733/david-fujii"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1535042521, "post_id": 51973951, "comment_id": 90930798, "body": "To answer your question simply, yes. Essentially, I have data on 83 building floors (which I would like to treat indiscriminately) and trying to make a forecast visual using Tableau. But in order for Tableau to identify the date as a &quot;dimension&quot; I would need a date field for every floor. So in this case, I am creating a 15 month forecast, which means I need every floor to repeat 15 times. B2 is a reference cell in case I have to add more months to the forecast. Thanks for reaching out!"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1535042691, "post_id": 51973951, "comment_id": 90930880, "body": "Oh okay that makes this nice and easy then, I&#39;ll crank this out right now haha"}, {"owner": {"reputation": 3, "user_id": 10240733, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157310432630021/picture?type=large", "display_name": "David Fujii", "link": "https://stackoverflow.com/users/10240733/david-fujii"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1535588960, "post_id": 51973951, "comment_id": 91125693, "body": "Hello Marucciboy2, thanks for helping me last time. I was wondering if you could help me with a tweak in the code. Is there a way to consolidate the way I am using the code? Currently, I have one code for every column for each floor, but if I were to copy by row (as opposed to cell) that would save me from managing all the macros."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1536168964, "post_id": 51973951, "comment_id": 91331066, "body": "Could you upload a picture of what your source looks like when there are multiple floors or copies or whatever the case is ?"}, {"owner": {"reputation": 3, "user_id": 10240733, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157310432630021/picture?type=large", "display_name": "David Fujii", "link": "https://stackoverflow.com/users/10240733/david-fujii"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1536600500, "post_id": 51973951, "comment_id": 91473248, "body": "Hello Marcucciboy2, I re-edit the question with example image. Thanks again for helping!"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1536604851, "post_id": 51973951, "comment_id": 91475204, "body": "Updated, let me know if it works"}, {"owner": {"reputation": 3, "user_id": 10240733, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157310432630021/picture?type=large", "display_name": "David Fujii", "link": "https://stackoverflow.com/users/10240733/david-fujii"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1536680937, "post_id": 51973951, "comment_id": 91507533, "body": "For the macro that copies the entire row, where would I indicate the two sheets? I pasted it after &quot;Set ws2 = Sheets(2)&quot; from the first macro and nothing happened."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1536683104, "post_id": 51973951, "comment_id": 91508663, "body": "Done. It will delete old copies though, so if you want to keep the new sheet it adds, rename it before running the script a second time"}, {"owner": {"reputation": 3, "user_id": 10240733, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157310432630021/picture?type=large", "display_name": "David Fujii", "link": "https://stackoverflow.com/users/10240733/david-fujii"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1536693388, "post_id": 51973951, "comment_id": 91513734, "body": "Thanks for working on this! I do not want the macro to delete the sheet because i have formulas in the sheet that is going to rely on the pasted in information. Is there any way to make the macro so that it does not delete the sheet? Also, where in the macro would i insert the name of the worksheets? The sheet that is being copied is called &quot;Bcknd&quot; and the sheet that is being pasted onto is called &quot;Migration Plan Data Extract&quot;"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1536695139, "post_id": 51973951, "comment_id": 91514516, "body": "Updated. If you want other changes I&#39;m inclined to tell you to research them or open a new question at this point, sorry"}, {"owner": {"reputation": 3, "user_id": 10240733, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157310432630021/picture?type=large", "display_name": "David Fujii", "link": "https://stackoverflow.com/users/10240733/david-fujii"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1536698911, "post_id": 51973951, "comment_id": 91516163, "body": "Thanks Marcucciboy2! It works and will do!"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1536698950, "post_id": 51973951, "comment_id": 91516180, "body": "good to hear, glad it all worked out"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10240733, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157310432630021/picture?type=large", "display_name": "David Fujii", "link": "https://stackoverflow.com/users/10240733/david-fujii"}, "edited": false, "score": 0, "creation_date": 1535042929, "post_id": 51978215, "comment_id": 90930998, "body": "Thanks Seiyu for taking the time to create the code. I should have given more context. I have a list of 83 building floors that I needed copy pasted. So the msgbox was helpful, but a bit too much clicking for the process. Also, I would like the macro to stop when it gets to the last of the floor or the first blank cell. Thanks again!"}, {"owner": {"reputation": 3, "user_id": 10240733, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157310432630021/picture?type=large", "display_name": "David Fujii", "link": "https://stackoverflow.com/users/10240733/david-fujii"}, "edited": false, "score": 0, "creation_date": 1535043137, "post_id": 51978215, "comment_id": 90931100, "body": "After some research I found that &quot;resizing&quot; as opposed to &quot;pasting&quot; was better. So I landed on the following code. However, the code only pastes the first floor. So I placed a loop code, but it gives me the same result: Sub Test1()       Dim x As Integer       NumRows = Range(&quot;A1&quot;, Range(&quot;A1&quot;).End(xlDown)).Rows.Count       Range(&quot;A1&quot;).Select       For x = 1 To NumRows        Dim y As Long y = Sheets(&quot;Backend&quot;).Range(&quot;D1&quot;).Value Worksheets(&quot;Backend 2&quot;).Range(&quot;A2&quot;).Resize(y).Value = Worksheets(&quot;Backend&quot;).Range(&quot;A1&quot;).Value           ActiveCell.Offset(1, 0).Select       Next    End Sub"}, {"owner": {"reputation": 1676, "user_id": 9992612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef2e5e68dd3a455ba00724f5fdfaf604?s=128&d=identicon&r=PG&f=1", "display_name": "Seiya Su", "link": "https://stackoverflow.com/users/9992612/seiya-su"}, "reply_to_user": {"reputation": 3, "user_id": 10240733, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157310432630021/picture?type=large", "display_name": "David Fujii", "link": "https://stackoverflow.com/users/10240733/david-fujii"}, "edited": false, "score": 0, "creation_date": 1535043698, "post_id": 51978215, "comment_id": 90931411, "body": "My computer don&#39;t have the dev env. I need to test your new context tomorrow. You should update the context to your quesiton but the commnets"}], "tags": [], "owner": {"reputation": 1676, "user_id": 9992612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef2e5e68dd3a455ba00724f5fdfaf604?s=128&d=identicon&r=PG&f=1", "display_name": "Seiya Su", "link": "https://stackoverflow.com/users/9992612/seiya-su"}, "is_accepted": false, "score": 0, "last_activity_date": 1534997611, "creation_date": 1534997611, "answer_id": 51978215, "question_id": 51973951, "link": "https://stackoverflow.com/questions/51973951/copy-paste-item-onto-another-sheet-based-on-a-single-cell-value/51978215#51978215", "title": "Copy/Paste Item onto another sheet based on a single cell value", "body": "<p>Based on my test ,worded code resembles the following. <strong>Modify the soucreSheet and targetWorksheet to yours</strong>:</p>\n\n<pre><code>Sub Test11()\n\nDim rowCount As Long\nDim sourceSheet As Worksheet\nDim targetWorksheet As Worksheet\nDim copyTimes As Integer\n\n  Set sourceSheet = Worksheets(\"Sheet11\")\n  Set targetWorksheet = Worksheets(\"Sheet12\")\n    rowCount = targetWorksheet.Cells(Rows.Count, 1).End(xlUp).row\n\n    copyTimes = CInt(sourceSheet.Cells(2, 2).Value)\n\n    For i = 2 To sourceSheet.UsedRange.Rows.Count\n        MsgBox sourceSheet.Cells(i, 1).Value\n        sourceSheet.Cells(i, 1).Copy\n        For j = 1 To copyTimes\n            targetWorksheet.Activate\n            targetWorksheet.Cells(rowCount + 1, 1).Select\n            targetWorksheet.Paste\n            rowCount = rowCount + 1\n        Next\n\n            sourceSheet.Activate\n    Next\n\n    Application.CutCopyMode = False\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1535044029, "post_id": 51990958, "comment_id": 90931552, "body": "To pick the right sheets for you, just replace the <code>1</code> in <code>sheets(1)</code> with the sheet&#39;s name surrounded by quotes, like this <code>sheets(&quot;sheet name&quot;)</code>"}], "tags": [], "owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "is_accepted": true, "score": 0, "last_activity_date": 1536695213, "last_edit_date": 1536695213, "creation_date": 1535043954, "answer_id": 51990958, "question_id": 51973951, "link": "https://stackoverflow.com/questions/51973951/copy-paste-item-onto-another-sheet-based-on-a-single-cell-value/51990958#51990958", "title": "Copy/Paste Item onto another sheet based on a single cell value", "body": "<p>This should work for you:</p>\n\n<pre><code>Sub floors()\n\n    Dim ws1 As Worksheet\n    Set ws1 = sheets(\"Bcknd\")\n\n    Dim ws2 As Worksheet\n\n    If Not sheetExists(\"Migration Plan Data Extract\") Then\n        sheets.Add After:=ws1\n        Set ws2 = sheets(ws1.index + 1)\n        ws2.name = \"Migration Plan Data Extract\"\n    Else\n        Set ws2 = sheets(\"Migration Plan Data Extract\")\n    End If\n\n    If Len(ws1.Range(\"B2\").Value2) &gt; 0 And IsNumeric(ws1.Range(\"B2\").Value2) Then\n        ws2.Range(\"A1\").Value2 = ws1.Range(\"A1\").Value2\n\n        Dim vals As Variant\n        vals = ws1.Range(\"A2:A\" &amp; ws1.Range(\"A\" &amp; Rows.Count).End(xlUp).Row).Value\n\n        Dim i As Long\n        Dim j As Long: j = 1\n\n        For i = 1 To ws1.Range(\"B2\").Value2 * UBound(vals)\n            ws2.Range(\"A\" &amp; i + 1).Value2 = vals(j, 1)\n\n            If i Mod ws1.Range(\"B2\") = 0 Then\n                j = j + 1\n            End If\n        Next i\n\n    End If\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Alright, this should copy down the entire row :)</p>\n\n<pre><code>Sub floors2()\n\n    Dim ws1 As Worksheet\n    Set ws1 = sheets(\"Bcknd\")\n\n    If Len(ws1.Range(\"L2\")) &gt; 0 And IsNumeric(ws1.Range(\"L2\").Value2) Then\n\n        Dim ws2 As Worksheet\n\n        If Not sheetExists(\"Migration Plan Data Extract\") Then\n            sheets.Add After:=ws1\n            Set ws2 = sheets(ws1.index + 1)\n            ws2.name = \"Migration Plan Data Extract\"\n        Else\n            Set ws2 = sheets(\"Migration Plan Data Extract\")\n        End If\n\n        ws1.Range(\"A1:J1\").copy Destination:=ws2.Range(\"A1:J1\")\n\n        Dim lastRow As Long\n        lastRow = ws1.Range(\"A\" &amp; rows.count).End(xlUp).row\n\n        Dim rng As Range\n        Set rng = ws1.Range(\"A2:J\" &amp; lastRow)\n\n        Dim currentRow As Long: currentRow = 2\n\n        Dim i As Long\n        Dim j As Long\n        For i = 1 To rng.rows.count\n            For j = 1 To ws1.Range(\"L2\").Value2\n                rng.rows(i).copy Destination:=ws2.Range(\"A\" &amp; currentRow)\n                currentRow = currentRow + 1\n            Next j\n        Next i\n\n    End If\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>This sub is used by both to see if the sheet \"Migration Plan Data Extract\" already exists</p>\n\n<pre><code>Function sheetExists(sheetToFind As String) As Boolean\n\n    sheetExists = False\n\n    Dim sheet As Worksheet\n    For Each sheet In Worksheets\n        If sheetToFind = sheet.name Then\n            sheetExists = True\n            Exit Function\n        End If\n    Next sheet\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10240733, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157310432630021/picture?type=large", "display_name": "David Fujii", "link": "https://stackoverflow.com/users/10240733/david-fujii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 51990958, "answer_count": 2, "score": -1, "last_activity_date": 1536695213, "creation_date": 1534966385, "last_edit_date": 1536604243, "question_id": 51973951, "link": "https://stackoverflow.com/questions/51973951/copy-paste-item-onto-another-sheet-based-on-a-single-cell-value", "title": "Copy/Paste Item onto another sheet based on a single cell value", "body": "<p>I am trying to create a macro that loops a copy/paste of items in (Column A) of my \"Backend\" worksheet based on a single cell's value (B2) onto my \"Backend 2\" Worksheet. To give some context, I have forecast data on building floors and trying to reformat my spreadsheet so that Tableau will read the dates as \"dimensions.\" In order to accomplish this I would need a macro that would copy/paste my 83 floors of data 15 times for the 15 months in my forecast. I would also like the reference cell (B2) so that I can add months to the forecast if needed. Thanks!</p>\n\n<p>Copy From:<br>\n<img src=\"https://i.stack.imgur.com/lKiyF.png\" alt=\"enter image description here\"></p>\n\n<p>Paste to:<br>\n<img src=\"https://i.stack.imgur.com/AePcm.png\" alt=\"enter image description here\"></p>\n\n<hr>\n\n<p>The current answer allows me to copy one value type \"floor,\" but I was wondering if I could run a macro that would copy/paste an entire row based on the copy amount. Please refer to the example below. I have 3 unique teams on sheet 1 that I want copied four times based on the cell L2 on sheet 2. </p>\n\n<p>Before (Sheet 1)\n<img src=\"https://i.stack.imgur.com/otj7m.png\" alt=\"enter image description here\"></p>\n\n<p>After (Sheet 2)\n<img src=\"https://i.stack.imgur.com/NKk6S.png\" alt=\"enter image description here\"></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 159, "user_id": 8334526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a950a3ee70d1be61f22b2e4852e148e?s=128&d=identicon&r=PG&f=1", "display_name": "Tamras Merin", "link": "https://stackoverflow.com/users/8334526/tamras-merin"}, "edited": false, "score": 0, "creation_date": 1534967573, "post_id": 51973855, "comment_id": 90898782, "body": "it didn&#39;t work after replacing .Value with .Formula.  The formula was changed to <code>=IFERROR(INDIRECT(&quot;&#39;&quot;&amp;[Item ID&#39;#]&amp;&quot;&#39;!$P$&quot; &amp;  z), &quot;&quot;)</code>"}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 0, "last_activity_date": 1534970430, "last_edit_date": 1534970430, "creation_date": 1534966032, "answer_id": 51973855, "question_id": 51973817, "link": "https://stackoverflow.com/questions/51973817/excel-vba-syntax-error-formula-value/51973855#51973855", "title": "Excel vba syntax error formula value", "body": "<p>Swap <code>Value</code> for <code>Formula</code> like so: <code>Cells(ActiveCell.Row, 2).Formula =</code></p>\n\n<hr>\n\n<p>On a seperate note, none of your <code>Range</code> or <code>Cells</code> objects are qualified with a worksheet. This can be problematic. I highly recomend explicity stating where these objects are. (<code>Sheets(\"x\").Cells(y, 1) = wsName</code>). </p>\n\n<p>Also, you do not need to <code>.Select</code> a cell here as seen below. </p>\n\n<pre><code>Application.AutoCorrect.AutoFillFormulasInLists = False\n\n    If WorksheetFunction.CountA(Range(\"Table35[Item ID'#]\")) = 0 Then\n            For y = 2 To fyrowCount + 1\n              Z = 9 + y\n                Cells(y, 1) = wsName\n                Cells(y, 2).Formula = \"=IFERROR(INDIRECT(\"\"'\"\"&amp;[Item ID'#]&amp;\"\"'!$G$7\"\"), \"\"\"\")\"\n                Cells(y, 3).Formula = \"=IFERROR(INDIRECT(\"\"'\"\"&amp;[Item ID'#]&amp;\"\"'!$G$6\"\"), \"\"\"\")\"\n                Cells(y, 4).Formula = \"=IFERROR(INDIRECT(\"\"'\"\"&amp;[Item ID'#]&amp;\"\"'!$G$8\"\"), \"\"\"\")\"\n                Cells(y, 5).Formula = \"=IFERROR(INDIRECT(\"\"'\"\"&amp;[Item ID'#]&amp;\"\"'!$G$9\"\"), \"\"\"\")\"\n                Cells(y, 6).Formula = \"=IFERROR(INDIRECT(\"\"'\"\"&amp;[Item ID'#]&amp;\"\"'!$P$\"\" &amp; z \"), \"\"\"\")\"\n            Next y\n    End If\n</code></pre>\n"}], "owner": {"reputation": 159, "user_id": 8334526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a950a3ee70d1be61f22b2e4852e148e?s=128&d=identicon&r=PG&f=1", "display_name": "Tamras Merin", "link": "https://stackoverflow.com/users/8334526/tamras-merin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 110, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594152387, "creation_date": 1534965912, "last_edit_date": 1594152387, "question_id": 51973817, "link": "https://stackoverflow.com/questions/51973817/excel-vba-syntax-error-formula-value", "title": "Excel vba syntax error formula value", "body": "<p>I'm trying to populate a table with formula but I could not get the last line to wok. The first row to be completed for column P is 11, then depending on the number of rows (fyrowCount) to be populated, I want it to increase by 1 each time. </p>\n\n<p>If i use the following formula, it works but can't figure out the correct syntax in vba.</p>\n\n<p>Formula <code>=IFERROR(INDIRECT(\"'\"&amp;[Item ID'#]&amp;\"'!$P$\" &amp; 11), \"\")</code></p>\n\n<pre><code>Application.AutoCorrect.AutoFillFormulasInLists = False\n\n    If WorksheetFunction.CountA(Range(\"Table35[Item ID'#]\")) = 0 Then\n        'Range is empty!\n\n            For y = 2 To fyrowCount + 1\n                Range(\"A\" &amp; y).Select\n                Z = 9 + y\n                Cells(ActiveCell.Row, 1) = wsName\n                Cells(ActiveCell.Row, 2).Value = \"=IFERROR(INDIRECT(\"\"'\"\"&amp;[Item ID'#]&amp;\"\"'!$G$7\"\"), \"\"\"\")\"\n                Cells(ActiveCell.Row, 3).Value = \"=IFERROR(INDIRECT(\"\"'\"\"&amp;[Item ID'#]&amp;\"\"'!$G$6\"\"), \"\"\"\")\"\n                Cells(ActiveCell.Row, 4).Value = \"=IFERROR(INDIRECT(\"\"'\"\"&amp;[Item ID'#]&amp;\"\"'!$G$8\"\"), \"\"\"\")\"\n                Cells(ActiveCell.Row, 5).Value = \"=IFERROR(INDIRECT(\"\"'\"\"&amp;[Item ID'#]&amp;\"\"'!$G$9\"\"), \"\"\"\")\"\n                Cells(ActiveCell.Row, 6).Value = \"=IFERROR(INDIRECT(\"\"'\"\"&amp;[Item ID'#]&amp;\"\"'!$P$\"\" &amp; z), \"\"\"\")\"\n\n            Next y\n    End If\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "edited": false, "score": 0, "creation_date": 1534968557, "post_id": 51973777, "comment_id": 90899175, "body": "It is looking for Orphans in sheet1 that are not in sheet2 ??  Or Orphans in sheet2 that are not in sheet1 ??  What is the approx row count of each sheet?"}, {"owner": {"reputation": 9, "user_id": 9673418, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YV2P1.jpg?s=128&g=1", "display_name": "JohnD", "link": "https://stackoverflow.com/users/9673418/johnd"}, "reply_to_user": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "edited": false, "score": 0, "creation_date": 1534969026, "post_id": 51973777, "comment_id": 90899377, "body": "yes it is looking for orphans in sheet1 that are not in sheet2"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1534969388, "post_id": 51973777, "comment_id": 90899563, "body": "<code>=countifs(Sheet2!$A$1:$A$5000, A1, Sheet2!$D$1:$D$5000, D1)&gt;=1</code> Stick that in Sheet1!E1 and copy down and it will give you a true/false output if there is a match. No need for VBA here."}, {"owner": {"reputation": 9, "user_id": 9673418, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YV2P1.jpg?s=128&g=1", "display_name": "JohnD", "link": "https://stackoverflow.com/users/9673418/johnd"}, "edited": false, "score": 0, "creation_date": 1534970082, "post_id": 51973777, "comment_id": 90899887, "body": "i import the database from a csv each week , then check for changes , so did hope to use vba instead of having to add formula. plus i needed orphans from sheet1 saved to another workbook"}], "answers": [{"tags": [], "owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "is_accepted": false, "score": 0, "last_activity_date": 1534972075, "creation_date": 1534972075, "answer_id": 51975149, "question_id": 51973777, "link": "https://stackoverflow.com/questions/51973777/compare-data-from-two-worksheets-based-on-values-of-column-a-column-d/51975149#51975149", "title": "compare data from two worksheets based on values of column a column d", "body": "<p>Try this.  It put the result in Sheet3 of this workbook. >></p>\n\n<pre><code>Option Explicit  '  it is your friend\n\nSub do_FindOrphans()\n\n'   create or find Sheet3, and clear it out\n    If Not Evaluate(\"ISREF('Sheet3'!A1)\") Then\n        Sheets.Add After:=ActiveSheet\n        ActiveSheet.Name = \"Sheet3\"\n    Else\n        Sheets(\"Sheet3\").Activate\n    End If\n    Cells.Select\n    Selection.ClearContents\n\n'   initialize max row#, and copy in column headings\n    Sheets(\"Sheet1\").Select\n    Dim s1row As Long, s1max As Long, s1col As Long, s1endcol As Integer\n    s1max = Sheets(\"Sheet1\").Cells(Rows.Count, 1).End(xlUp).Row\n    Sheets(\"Sheet2\").Select\n    Dim s2row As Long, s2max As Long\n    s2max = Sheets(\"Sheet2\").Cells(Rows.Count, 1).End(xlUp).Row\n    Dim s3row As Long, matched As String\n\n    With ActiveSheet\n        s1endcol = .Cells(1, .Columns.Count).End(xlToLeft).Column\n    End With\n    s3row = 1\n    For s1col = 1 To s1endcol\n        Sheets(\"Sheet3\").Cells(s3row, s1col) = Sheets(\"Sheet1\").Cells(1, s1col)\n    Next s1col\n\n'   step thru sheet1\n    For s1row = 2 To s1max\n        matched = \"N\"\n'       step thru sheet2\n        For s2row = 2 To s2max\n'           Compare the keys\n            If Sheets(\"Sheet1\").Cells(1, s1row) = Sheets(\"Sheet2\").Cells(1, s2row) _\n            And Sheets(\"Sheet1\").Cells(4, s1row) = Sheets(\"Sheet2\").Cells(4, s2row) Then\n                matched = \"Y\"\n                Exit For\n            End If\n        Next s2row\n        If matched = \"N\" Then\n            s3row = s3row + 1\n            For s1col = 1 To s1endcol\n                Sheets(\"Sheet3\").Cells(s3row, s1col) = Sheets(\"Sheet1\").Cells(s1row, s1col)\n            Next s1col\n        End If\n    Next s1row\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 9673418, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YV2P1.jpg?s=128&g=1", "display_name": "JohnD", "link": "https://stackoverflow.com/users/9673418/johnd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1534972075, "creation_date": 1534965740, "question_id": 51973777, "link": "https://stackoverflow.com/questions/51973777/compare-data-from-two-worksheets-based-on-values-of-column-a-column-d", "title": "compare data from two worksheets based on values of column a column d", "body": "<p>i am looking to find a vba code that loops through all rows in sheet1 looking for matches of data based on colmn a and column d values in sheet1 being found matched in column a and column d in sheet2. example column a 1011 column d john. if somewhere in sheet2 column a = 1011 and column d same row = john then match found. I need to save all non matches to a new workbook. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 97, "user_id": 8844080, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-gqYcsX_YKc0/AAAAAAAAAAI/AAAAAAAAANM/XbfnbGGklOw/photo.jpg?sz=128", "display_name": "Steve Bull", "link": "https://stackoverflow.com/users/8844080/steve-bull"}, "edited": false, "score": 0, "creation_date": 1534966621, "post_id": 51973718, "comment_id": 90898364, "body": "The Next Without For error is misleading... you&#39;re seeing that because you have not &quot;ended&quot; your With statement.  Put an End With before the Next and that error will go away."}, {"owner": {"reputation": 17, "user_id": 10251516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dcd0bc45d7ba1b7927f143062238f?s=128&d=identicon&r=PG&f=1", "display_name": "Bryan Marks", "link": "https://stackoverflow.com/users/10251516/bryan-marks"}, "reply_to_user": {"reputation": 97, "user_id": 8844080, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-gqYcsX_YKc0/AAAAAAAAAAI/AAAAAAAAANM/XbfnbGGklOw/photo.jpg?sz=128", "display_name": "Steve Bull", "link": "https://stackoverflow.com/users/8844080/steve-bull"}, "edited": false, "score": 0, "creation_date": 1534967007, "post_id": 51973718, "comment_id": 90898537, "body": "Fantastic!  That fixed the original error, but now I&#39;m getting <b><i>Run time error &#39;1004&#39;: This extension can not be used with the selected file type.  Change the file extension in the File name text box or select a different file type by changing the Save as type.</i></b>  Do I need to something after &quot;.xlsx&quot; to save the workbook as an Excel file?"}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 10251516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dcd0bc45d7ba1b7927f143062238f?s=128&d=identicon&r=PG&f=1", "display_name": "Bryan Marks", "link": "https://stackoverflow.com/users/10251516/bryan-marks"}, "edited": false, "score": 0, "creation_date": 1534967866, "post_id": 51974148, "comment_id": 90898907, "body": "That did the trick, Steve!  One last thing:  I need to move the worksheets to keep them in sequential order.  Is this correct? <code>If DistWS.name Like DistName Then DistWS.Move after:=wbNew.Worksheets(1)</code>?"}, {"owner": {"reputation": 17, "user_id": 10251516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dcd0bc45d7ba1b7927f143062238f?s=128&d=identicon&r=PG&f=1", "display_name": "Bryan Marks", "link": "https://stackoverflow.com/users/10251516/bryan-marks"}, "edited": false, "score": 0, "creation_date": 1534968209, "post_id": 51974148, "comment_id": 90899045, "body": "That did the trick, Steve!  One last thing:  I needed to move the worksheets to keep them in sequential order.  This seems to work. <code>If DistWS.name Like DistName Then DistWS.Move After:=Sheets(WBNew.Sheets.Count)</code>"}, {"owner": {"reputation": 97, "user_id": 8844080, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-gqYcsX_YKc0/AAAAAAAAAAI/AAAAAAAAANM/XbfnbGGklOw/photo.jpg?sz=128", "display_name": "Steve Bull", "link": "https://stackoverflow.com/users/8844080/steve-bull"}, "reply_to_user": {"reputation": 17, "user_id": 10251516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dcd0bc45d7ba1b7927f143062238f?s=128&d=identicon&r=PG&f=1", "display_name": "Bryan Marks", "link": "https://stackoverflow.com/users/10251516/bryan-marks"}, "edited": false, "score": 0, "creation_date": 1534970276, "post_id": 51974148, "comment_id": 90899991, "body": "that is a good approach: using the After:= parameter with sheets count.  you will end up with one empty sheet at the beginning, which you could remove before saving the file using wbNew.worksheets(1).delete I think.  To avoid the warning message Excel may show when deleting a sheet, you can turn off alerts before the macro, using Application.DisplayAlerts = False.  Be sure to set it to True after you&#39;re done"}, {"owner": {"reputation": 17, "user_id": 10251516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dcd0bc45d7ba1b7927f143062238f?s=128&d=identicon&r=PG&f=1", "display_name": "Bryan Marks", "link": "https://stackoverflow.com/users/10251516/bryan-marks"}, "edited": false, "score": 0, "creation_date": 1534970382, "post_id": 51974148, "comment_id": 90900035, "body": "As it turns out, I will need that sheet at the beginning to create a summary worksheet representing the sum of all the other worksheets in the file.  Again, thanks so much!!!"}], "tags": [], "owner": {"reputation": 97, "user_id": 8844080, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-gqYcsX_YKc0/AAAAAAAAAAI/AAAAAAAAANM/XbfnbGGklOw/photo.jpg?sz=128", "display_name": "Steve Bull", "link": "https://stackoverflow.com/users/8844080/steve-bull"}, "is_accepted": true, "score": 0, "last_activity_date": 1534967378, "creation_date": 1534967378, "answer_id": 51974148, "question_id": 51973718, "link": "https://stackoverflow.com/questions/51973718/search-for-worksheets-with-common-prefix-and-move-save-matching-worksheets-to-ne/51974148#51974148", "title": "Search for Worksheets with Common Prefix and Move/Save Matching Worksheets to New Workbook", "body": "<p>You will need to define a workbook variable and assign it before you can move the worksheets to it.  Simply using the .Move function will create a new blank workbook, but that won't automatically get assigned to your workbook object.</p>\n\n<p>Also, it looks like you shouldn't save the workbook until after the loop is finished, assuming there will be more than one matching sheet.</p>\n\n<p>This code should get you closer, but you still may have some variables you need to declare... unless they're declared outside your example code:</p>\n\n<pre><code> Dim DistWS As Worksheet\n Dim DistName As String\n Dim wbNew As Workbook\n\n  DistName = Left(DistrictDSM, 6) &amp; \"*\"\n\n  Set wbNew = Application.Workbooks.Add\n\n  For Each DistWS In wbMaster.Sheets\n    If DistWS.Name Like DistName Then Distws.Move wbNew.Worksheets(1)\n  Next DistWS\n\n  With wbNew\n    .SaveAs \"H:\\Accounting\\Monthend \" &amp; YYYY &amp; \"\\DSM Files\\DSM Master Reports\\\" &amp; DistrictDSM &amp; \".xlsx\"\n  End With\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 10251516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dcd0bc45d7ba1b7927f143062238f?s=128&d=identicon&r=PG&f=1", "display_name": "Bryan Marks", "link": "https://stackoverflow.com/users/10251516/bryan-marks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 51974148, "answer_count": 1, "score": 0, "last_activity_date": 1534967378, "creation_date": 1534965475, "question_id": 51973718, "link": "https://stackoverflow.com/questions/51973718/search-for-worksheets-with-common-prefix-and-move-save-matching-worksheets-to-ne", "title": "Search for Worksheets with Common Prefix and Move/Save Matching Worksheets to New Workbook", "body": "<p>I am trying to (1) search for worksheets that have a common prefix to a district name; that is, where the name of the worksheet is like (matches) the first six characters of the district name, then (2) move the matching files out of my master macro workbook file and into a new workbook file that has the same name as the district name.</p>\n\n<p>I have searched for code to help me do this, but so far am coming up short on making this work.  Here is what I have so far, but I'm getting a <strong><em>Compile Error: Next without For</em></strong> warning.  Any help would be greatly appreciated, of course!</p>\n\n<pre><code>Dim DistWS As Worksheet\nDim DistName As String\n  DistName = Left(DistrictDSM, 6) &amp; \"*\"\n  For Each DistWS In WBMaster.Sheets\n    If DistWS.name Like DistName Then ThisWorkbook.Sheets.Move\n    With WBMaster\n      .SaveAs \"H:\\Accounting\\Monthend \" &amp; YYYY &amp; \"\\DSM Files\\DSM Master Reports\\\" &amp; DistrictDSM &amp; \".xlsx\"\n   Next DistWS\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 3, "creation_date": 1534964214, "post_id": 51973423, "comment_id": 90897273, "body": "Get the ascii value and do some arithmetic. There would be no reason to have an if statement with 26 clauses."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1534964251, "post_id": 51973423, "comment_id": 90897296, "body": "You would set up an array and split the string in a cell to read each letter.  find the letter position in arrayA and output the position."}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1534964309, "post_id": 51973423, "comment_id": 90897316, "body": "I would use a dictionary"}, {"owner": {"reputation": 1009, "user_id": 8981066, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HFh7Jm-OT-E/AAAAAAAAAAI/AAAAAAAABl8/oDH6HzC4eFw/photo.jpg?sz=128", "display_name": "Oday Salim", "link": "https://stackoverflow.com/users/8981066/oday-salim"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1534964315, "post_id": 51973423, "comment_id": 90897319, "body": "@Cyril - can you demo a very simple and quick example please?"}, {"owner": {"reputation": 1009, "user_id": 8981066, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HFh7Jm-OT-E/AAAAAAAAAAI/AAAAAAAABl8/oDH6HzC4eFw/photo.jpg?sz=128", "display_name": "Oday Salim", "link": "https://stackoverflow.com/users/8981066/oday-salim"}, "reply_to_user": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1534964333, "post_id": 51973423, "comment_id": 90897328, "body": "@Ibo - never used a dictionary - please give example?"}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1534964399, "post_id": 51973423, "comment_id": 90897368, "body": "@OdaySalim give us an example, what would be the putput for <code>Hello</code>?"}, {"owner": {"reputation": 1009, "user_id": 8981066, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HFh7Jm-OT-E/AAAAAAAAAAI/AAAAAAAABl8/oDH6HzC4eFw/photo.jpg?sz=128", "display_name": "Oday Salim", "link": "https://stackoverflow.com/users/8981066/oday-salim"}, "reply_to_user": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1534964472, "post_id": 51973423, "comment_id": 90897400, "body": "@Ibo Hello = 8-5-12-12-15 ---&gt; separating numbers with something to identify a single digit from a double or triple digit.."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1534964623, "post_id": 51973423, "comment_id": 90897472, "body": "How is replacing &quot;A&quot; by 1, and &quot;B&quot; by 2, etc. a Caesar shift?"}, {"owner": {"reputation": 1009, "user_id": 8981066, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HFh7Jm-OT-E/AAAAAAAAAAI/AAAAAAAABl8/oDH6HzC4eFw/photo.jpg?sz=128", "display_name": "Oday Salim", "link": "https://stackoverflow.com/users/8981066/oday-salim"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1534964687, "post_id": 51973423, "comment_id": 90897496, "body": "@JohnColeman - ok not technically a ceasar shift, but beyond the question. I did not want to get into complex arithmetic as I am still struggling to map letters to numbers without shifting!"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 3, "creation_date": 1534964719, "post_id": 51973423, "comment_id": 90897509, "body": "Are you aware of the function <code>Asc()</code>?"}, {"owner": {"reputation": 1009, "user_id": 8981066, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HFh7Jm-OT-E/AAAAAAAAAAI/AAAAAAAABl8/oDH6HzC4eFw/photo.jpg?sz=128", "display_name": "Oday Salim", "link": "https://stackoverflow.com/users/8981066/oday-salim"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1534964746, "post_id": 51973423, "comment_id": 90897516, "body": "@JohnColeman - no.."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1534964904, "post_id": 51973423, "comment_id": 90897587, "body": "@JohnColeman wouldn&#39;t you still need to separate the entire string?  From: <a href=\"https://www.techonthenet.com/excel/formulas/asc.php\" rel=\"nofollow noreferrer\">techonthenet.com/excel/formulas/asc.php</a>; <i>The specified character to retrieve the ASCII value for. If there is more than one character, the function will return the ASCII value for the first character and ignore all of the characters after the first.</i>"}], "answers": [{"comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1534965421, "post_id": 51973500, "comment_id": 90897824, "body": "<code>StrConv</code> seems like a natural way to go (+1), although for some reason it doesn&#39;t play well with <code>Join()</code>"}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": true, "score": 3, "last_activity_date": 1534964797, "last_edit_date": 1534964797, "creation_date": 1534964487, "answer_id": 51973500, "question_id": 51973423, "link": "https://stackoverflow.com/questions/51973423/perform-character-substitution-using-excel-vba/51973500#51973500", "title": "Perform character substitution using Excel VBA", "body": "<p>Get the cell's output as a string with Byte array:</p>\n\n<pre><code>Dim brr() As Byte, i As Long, k As String\nbrr() = StrConv(Cells(1, 3), vbFromUnicode)\n</code></pre>\n\n<p>Then assess each letter in the new array against a larger array:</p>\n\n<pre><code>dim arr as variant\narr = array(\"a\", \"b\")\nFor i = 0 To UBound(brr) 'need to start at 0, lbound applies for std array, not byte\n    'match brr value to arr value, output arr location\n    'k will store the final string\n    k = k + 'didn't look up the output for application.match(arr())\nNext i\n</code></pre>\n\n<hr>\n\n<p><strong>Edit1:</strong>  Thanks to JohnColeman, i can add Asc() to the above and it shouldn't need the additional array for A, B, C, etc.</p>\n\n<pre><code>Dim brr() As Byte, i As Long, k As String\nbrr() = StrConv(Cells(1, 3), vbFromUnicode)\nfor i = 0 To UBound(brr) \n    k = k &amp; \" \" &amp; Asc(brr(i)) 'something like that\nnext i\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1534965190, "post_id": 51973607, "comment_id": 90897721, "body": "Updated my answer in response to your comment.  Thanks for the info on Asc(), as that made it a bit easier after separating letter by letter in a byte array."}], "tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": false, "score": 1, "last_activity_date": 1534965034, "creation_date": 1534965034, "answer_id": 51973607, "question_id": 51973423, "link": "https://stackoverflow.com/questions/51973423/perform-character-substitution-using-excel-vba/51973607#51973607", "title": "Perform character substitution using Excel VBA", "body": "<p>This might get you started:</p>\n\n<pre><code>Function StringToNums(s As String) As Variant\n    'assumes that s is in the alphabet A, B, ..., Z\n    Dim nums As Variant\n    Dim i As Long, n As Long\n    n = Len(s)\n    ReDim nums(1 To n)\n    For i = 1 To n\n        nums(i) = Asc(Mid(s, i, 1)) - Asc(\"A\") + 1\n    Next i\n    StringToNums = nums\nEnd Function\n\nSub test()\n    Debug.Print Join(StringToNums(\"HELLO\"), \"-\") 'prints 8-5-12-12-15\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": false, "score": 2, "last_activity_date": 1534967068, "last_edit_date": 1534967068, "creation_date": 1534965535, "answer_id": 51973734, "question_id": 51973423, "link": "https://stackoverflow.com/questions/51973423/perform-character-substitution-using-excel-vba/51973734#51973734", "title": "Perform character substitution using Excel VBA", "body": "<p>Using the Dictionary route, you can build a dictionary which is a list of key, value pairs to hold your cypher. In your case the <code>key</code> of <code>a</code> would have the value <code>1</code> and the <code>key</code> of <code>b</code> would have the <code>value</code> <code>2</code>, and so on. Then you can just bump your word, letter by letter, against the dictionary to build your cipher:</p>\n\n<pre><code>Function caesarCipher(word As String) As String\n\n    'create an array of letters in their position for the cipher (a is 1st, b is 2nd)\n    Dim arrCipher As Variant\n    arrCipher = Split(\"a b c d e f g h i j k l m n o p q r s t u v x y z\", \" \")\n\n    'Create a dictionary from the array with the key being the letter and the item being index + 1\n    Dim dictCipher As Scripting.Dictionary\n    Set dictCipher = New Dictionary\n    For i = 0 To UBound(arrCipher)\n        dictCipher.Add arrCipher(i), i + 1\n    Next\n\n    'Now loop through the word letter by letter\n    For i = 1 To Len(word)\n        'and build the cipher output\n        caesarCipher = caesarCipher &amp; IIf(Len(caesarCipher) = 0, \"\", \" \") &amp; dictCipher(LCase(Mid(word, i, 1)))\n    Next\n\nEnd Function\n</code></pre>\n\n<p>This is a nice way of doing it because you can change your cipher to be whatever you want and you only need monkey with your dictionary. Here I just build a dictionary from an array and use the array's index for the cipher output. </p>\n"}, {"tags": [], "owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "is_accepted": false, "score": 1, "last_activity_date": 1534966055, "creation_date": 1534966055, "answer_id": 51973866, "question_id": 51973423, "link": "https://stackoverflow.com/questions/51973423/perform-character-substitution-using-excel-vba/51973866#51973866", "title": "Perform character substitution using Excel VBA", "body": "<p>All of the answers are good, but this is how you use a dictionary which is simpler and more straight-forward. I defined the dictionary implicitly to make it easier to start, but it is better to define it explicitly by adding <code>runtime scripting</code> from the tools>references in VBE.</p>\n\n<pre><code>Sub Main()\n    Dim i As Integer\n    Dim ciphered As String, str As String\n    Dim dict As Object\n\n    Set dict = CreateObject(\"scripting.Dictionary\")\n    str = \"Hello\"\n\n    For i = 65 To 122\n        dict.Add Chr(i), i - 64\n    Next i\n\n    For i = 1 To Len(str)\n        ciphered = ciphered &amp; \"-\" &amp; dict(Mid(UCase(str), i, 1))\n    Next i\n    ciphered = Right(ciphered, Len(ciphered) - 1)\n\n    Debug.Print ciphered\nEnd Sub\n</code></pre>\n\n<p>if you remove <code>ucase</code> when getting the code from the dictionary it will count for the case meaning that uppercase or lowercase will have different codes. You can change this to a function easily, don't forget to remove <code>str = \"Hello\"</code>. Right now it returns:</p>\n\n<p><strong>Output</strong></p>\n\n<p><code>8-5-12-12-15</code></p>\n"}], "owner": {"reputation": 1009, "user_id": 8981066, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HFh7Jm-OT-E/AAAAAAAAAAI/AAAAAAAABl8/oDH6HzC4eFw/photo.jpg?sz=128", "display_name": "Oday Salim", "link": "https://stackoverflow.com/users/8981066/oday-salim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1243, "favorite_count": 0, "accepted_answer_id": 51973500, "answer_count": 4, "score": 1, "last_activity_date": 1605474119, "creation_date": 1534964093, "last_edit_date": 1605474119, "question_id": 51973423, "link": "https://stackoverflow.com/questions/51973423/perform-character-substitution-using-excel-vba", "title": "Perform character substitution using Excel VBA", "body": "<p>Say you would like to set up a very simple <a href=\"https://en.wikipedia.org/wiki/Caesar_cipher\" rel=\"nofollow noreferrer\">Caesar Cipher</a>, where A --&gt; 1, B --&gt; 2 ... etc.</p>\n<p>Say you have a word &quot;Hello&quot; in a cell that you would like to encrypt. You can set up a very simple For Loop to loop through each word:</p>\n<pre><code>For i = 1 To Len(&quot;Hello&quot;)\n    'perform encryption here\nNext i\n</code></pre>\n<p>Is there a quick an easy way to map values from a pre-defined range? I.e. we know that A = 1, or 1 + 26, or 1 + 2*(26) .. etc...</p>\n<p>Rather than writing IF statement to check for all letters, I wonder if there is an elegant way of doing this to get: &quot;8 5 12 12 15&quot;</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 13431, "user_id": 2169762, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nns8w.png?s=128&g=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/2169762/martin"}, "edited": false, "score": 2, "creation_date": 1534963045, "post_id": 51973072, "comment_id": 90896734, "body": "What actually happens if you try to put this into the cell using your code?  You haven&#39;t told us what&#39;s actually wrong."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1534963129, "post_id": 51973072, "comment_id": 90896769, "body": "Looks like you should build it as a string instead of a formula"}], "answers": [{"tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 0, "last_activity_date": 1534977371, "creation_date": 1534977371, "answer_id": 51976084, "question_id": 51973072, "link": "https://stackoverflow.com/questions/51973072/excel-vba-to-insert-a-formula-into-a-cell/51976084#51976084", "title": "Excel VBA to insert a formula into a cell", "body": "<p>The 'dialogue box saying to update values' issue is resolved if you create the\nReferences worksheet in the active workbook. If you can't do that you will\nhave to discover a few more secrets of your project.</p>\n\n<p>Important things in creating the string containing the formula:\nThe string has to start with an equal sign (=).\nAll quotes have to be replaced with chr(34).\n(In the way Excel uses the CHAR function, VBA uses the Chr function:\n CHAR(34) in Excel is similar to Chr(34) in VBA.)\nThe result is the following code: </p>\n\n<pre><code>Sub TheFormula()\nDim Str1 As String\nDim rRange as Range\nSet rRange = ActiveSheet.Range(\"I8\")\nStr1 = \"=(\"\nStr1 = Str1 &amp; Chr(34) &amp; \"Good \"\nStr1 = Str1 &amp; Chr(34) &amp; \" &amp; $C$2) &amp; CHAR(10) &amp; CHAR(10) &amp; References!C1 &amp;\"\nStr1 = Str1 &amp; \" CHAR(10) &amp; CHAR(10) &amp; \"\nStr1 = Str1 &amp; Chr(34) &amp; \"Service Channel WO#:  \"\nStr1 = Str1 &amp; Chr(34) &amp; \" &amp; $C$4 &amp; CHAR(10) &amp; \"\nStr1 = Str1 &amp; Chr(34) &amp; \"Location:  \"\nStr1 = Str1 &amp; Chr(34) &amp; \" &amp; $C$5 &amp; CHAR(10) &amp; \"\nStr1 = Str1 &amp; Chr(34) &amp; \"SLM Work Order Number:  \"\nStr1 = Str1 &amp; Chr(34) &amp; \" &amp; $C$6 &amp; CHAR(10) &amp; CHAR(10) &amp; References!C2 &amp;\"\nStr1 = Str1 &amp; \" $C$7 &amp; CHAR(10) &amp; CHAR(10) &amp; References!C3 &amp; CHAR(10) &amp;\"\nStr1 = Str1 &amp; \" CHAR(10) &amp; References!C4\"\nrRange.Formula = Str1\nEnd Sub\n</code></pre>\n\n<p>I hope this was useful.</p>\n"}], "owner": {"reputation": 1, "user_id": 9469511, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Chadwick Mittl", "link": "https://stackoverflow.com/users/9469511/chadwick-mittl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 338, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594150976, "creation_date": 1534962612, "last_edit_date": 1594150976, "question_id": 51973072, "link": "https://stackoverflow.com/questions/51973072/excel-vba-to-insert-a-formula-into-a-cell", "title": "Excel VBA to insert a formula into a cell", "body": "<p>****UPDATE****</p>\n\n<p>I managed to get the code to work, however, every time that i try to run it, in another workbook, it pops up with a dialogue box saying to update values.  I don't want it to bring the values from the original sheet.  I want it to use the cells that I have referenced and the sheets that I have referenced in the formula.</p>\n\n<hr>\n\n<p>I am trying to figure out how to put a formula into a certain cell \"I8\" with a VBA code.  I have tried several different ways of doing this.  I researched online and found this code:</p>\n\n<pre><code>Worksheets(\"SheetName\").Range(\"I8\").Formula =\n</code></pre>\n\n<p>I can use this to do basic stuff like the sum of a cell range and stuff like that.  What i need to put in there is extreemly long and it puts strings, new paragraphs, and cell references all in one.  </p>\n\n<p>The formula grabs a bunch of different information and puts it in a nice and neat email format so all I have to do is copy that cell \"I8\" and paste it in the body of an email.</p>\n\n<p>Here is the formula that I have in cell \"I8\" that works.  All I need to do is figure out how to make it work with the VBA code above:</p>\n\n<pre><code>=(\"Good \" &amp; $C$2) &amp; CHAR(10) &amp; CHAR(10) &amp; References!C1 &amp; CHAR(10) &amp; CHAR(10) &amp; \"Service Channel WO#:  \" &amp; $C$4 &amp; CHAR(10) &amp; \"Location:  \" &amp; $C$5 &amp; CHAR(10) &amp; \"SLM Work Order Number:  \" &amp; $C$6 &amp; CHAR(10) &amp; CHAR(10) &amp; References!C2 &amp; $C$7 &amp; CHAR(10) &amp; CHAR(10) &amp; References!C3 &amp; CHAR(10) &amp; CHAR(10) &amp; References!C4\n</code></pre>\n\n<p>Any help is greatly appreciated as this is a very unique formula, and what I have found online isn't much help.</p>\n"}, {"tags": ["excel", "vba", "split", "pivot-table"], "comments": [{"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 3, "creation_date": 1534962581, "post_id": 51972957, "comment_id": 90896539, "body": "welcome to SO, please show us what you have tried yourself?"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1534962761, "post_id": 51972957, "comment_id": 90896611, "body": "You may want to take a look at <a href=\"https://stackoverflow.com/help/how-to-ask\">this</a>, and then <a href=\"https://stackoverflow.com/posts/51972957/edit\">edit</a> you question to add more info."}, {"owner": {"reputation": 33, "user_id": 10261174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6992da3d05b7a8697ec17f34f9f90828?s=128&d=identicon&r=PG&f=1", "display_name": "Yasaman", "link": "https://stackoverflow.com/users/10261174/yasaman"}, "edited": false, "score": 1, "creation_date": 1534965215, "post_id": 51972957, "comment_id": 90897737, "body": "Thank you for your suggestions. I&#39;m new to VBA so I wasn&#39;t sure if it&#39;s better to post what I have or just start from scratch. I updated my question with the code I have right now"}, {"owner": {"reputation": 146, "user_id": 10043754, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hMveNlgcbk8/AAAAAAAAAAI/AAAAAAAAAwk/mCkl_negiSs/photo.jpg?sz=128", "display_name": "Chris Walker", "link": "https://stackoverflow.com/users/10043754/chris-walker"}, "edited": false, "score": 1, "creation_date": 1534968042, "post_id": 51972957, "comment_id": 90898982, "body": "I think it&#39;s always best to start with what you have so far. I would, as a best practice, recommend against having On Error Resume Next and turning off screen updating while debugging at least. The errors can give you a clue where you&#39;re going wrong, and it&#39;s helpful to see what you are doing while stepping through the code (F8)."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 10261174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6992da3d05b7a8697ec17f34f9f90828?s=128&d=identicon&r=PG&f=1", "display_name": "Yasaman", "link": "https://stackoverflow.com/users/10261174/yasaman"}, "edited": false, "score": 0, "creation_date": 1534968818, "post_id": 51974196, "comment_id": 90899295, "body": "Awesome! Thank you so much. I changed my code and it works perfectly."}], "tags": [], "owner": {"reputation": 146, "user_id": 10043754, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hMveNlgcbk8/AAAAAAAAAAI/AAAAAAAAAwk/mCkl_negiSs/photo.jpg?sz=128", "display_name": "Chris Walker", "link": "https://stackoverflow.com/users/10043754/chris-walker"}, "is_accepted": true, "score": 0, "last_activity_date": 1534967632, "creation_date": 1534967632, "answer_id": 51974196, "question_id": 51972957, "link": "https://stackoverflow.com/questions/51972957/loop-through-a-pivot-table-and-save-each-fields-details-in-a-separate-workbook/51974196#51974196", "title": "Loop through a pivot table and save each field&#39;s details in a separate workbook with the field&#39;s name", "body": "<p>Great start! A couple things I noticed. First and foremost, when you move the detail sheet to a new workbook and save as, your workbook with the Pivot table is no longer the active workbook. So selecting the range on the new workbook won't work. You could add</p>\n\n<pre><code>Workbooks(\"[WorkbookName].xlsx\").Activate\nSheets(\"Table\").Activate\n</code></pre>\n\n<p>to the top of your loop. Further, </p>\n\n<pre><code>Sheets(\"Sheet2\").Select\nSheets(\"Sheet2\").Move\nSheets(\"Sheet2\").Select\n</code></pre>\n\n<p>The two Select methods aren't needed, and the Sheet numbers will increment, so it won't always be Sheet2. You could replace the block above with:</p>\n\n<pre><code>ActiveSheet.Move\n</code></pre>\n\n<p>Finally you would have to change the name of the workbook you are saving so it doesn't just overwrite each time. Maybe like:</p>\n\n<pre><code>filename:=\"C:\\Users\\haghigy\\Desktop\\New3\\Book\" &amp; i &amp; \".xlsx\"\n</code></pre>\n\n<p>Then it should work.</p>\n\n<p>*edit: also don't really need the ChDir</p>\n"}], "owner": {"reputation": 33, "user_id": 10261174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6992da3d05b7a8697ec17f34f9f90828?s=128&d=identicon&r=PG&f=1", "display_name": "Yasaman", "link": "https://stackoverflow.com/users/10261174/yasaman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 0, "accepted_answer_id": 51974196, "answer_count": 1, "score": 2, "last_activity_date": 1549397290, "creation_date": 1534962080, "last_edit_date": 1549397290, "question_id": 51972957, "link": "https://stackoverflow.com/questions/51972957/loop-through-a-pivot-table-and-save-each-fields-details-in-a-separate-workbook", "title": "Loop through a pivot table and save each field&#39;s details in a separate workbook with the field&#39;s name", "body": "<p>I'm working on a project in Excel where I have a pivot table with people's name and their associated claims. I need to double click on each name in the table and when the details (claims details) show up in a separate sheet save the sheet as a separate workbook with that person's name in a folder. Is there any way to automate this process in VBA?</p>\n\n<p>I have the code below which works for the first item but it has a few problems:</p>\n\n<p>-The name of the sheet and the workbook are hard coded and therefore only work for the first item. Is there anyway to just select the new sheet instead of selecting it by name? And is there a way to use the item's name instead of Book3.xlsx?</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Sub IndividualReports()\n\nApplication.ScreenUpdating = False\nOn Error Resume Next\n\nDim LastRow As Long\n\nSheets(\"Table\").Select\n\n  With Application.ActiveSheet\n      LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n  End With\n\nFor i = 8 To LastRow\n  Range(\"C\" &amp; i).Select\n  Selection.ShowDetail = True\n  Sheets(\"Sheet2\").Select\n  Sheets(\"Sheet2\").Move\n  Sheets(\"Sheet2\").Select\n  ChDir \"C:\\Users\\haghigy\\Desktop\\New3\"\n  ActiveWorkbook.SaveAs Filename:=\"C:\\Users\\haghigy\\Desktop\\New3\\Book3.xlsx\", _\n      FileFormat:=xlOpenXMLWorkbook, CreateBackup:=False\nNext\n\nEnd Sub\n</code></pre>\n\n<p>Thank you for your help!</p>\n\n<p>*Edit: Here is my code after the solution.</p>\n\n<pre><code>Sub IndividualReports()\n\nDim LastRow As Long\nDim Name As String\nDim Path As String\nDim fldr As FileDialog\n\nSet fldr = Application.FileDialog(msoFileDialogFolderPicker)\nWith fldr\n    .Title = \"Select a Folder\"\n    .AllowMultiSelect = False\n    .InitialFileName = Application.DefaultFilePath\n    If .Show &lt;&gt; -1 Then GoTo NextCode\n    Path = .SelectedItems(1) &amp; \"\\\"\nEnd With\nNextCode:\n    GetFolder = Path\n    Set fldr = Nothing\n\nSheets(\"Table\").Select\n    With Application.ActiveSheet\n        LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    End With\n\nFor i = 6 To LastRow - 1\n\nName = Application.WorksheetFunction.Index(Sheets(\"Table\").Rang(\"A6:A200\"), i - 5)\nRange(\"C\" &amp; i).Select\nSelection.ShowDetail = True\nActiveSheet.Move\nActiveWorkbook.SaveAs Filename:=Path &amp; Name, _\n    FileFormat:=xlOpenXMLWorkbook, CreateBackup:=False\nActiveWorkbook.Close\n\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 37, "user_id": 10256126, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b143fbbef4a024b915edd063710fdf5d?s=128&d=identicon&r=PG&f=1", "display_name": "Tyrone", "link": "https://stackoverflow.com/users/10256126/tyrone"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1534966850, "post_id": 51972908, "comment_id": 90898470, "body": "@HansUp I added it"}, {"owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "edited": false, "score": 0, "creation_date": 1534967424, "post_id": 51972908, "comment_id": 90898728, "body": "Right after removing the trailing AND, display the where as Debug.Print strWhere  and if you don&#39;t see the problem, then paste that string in the above with {}.  The Bureau looks suspect, as it tries to string B=this AND B=that,  when I would think that what was wanted would be B=this OR B=that."}, {"owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "edited": false, "score": 0, "creation_date": 1534967798, "post_id": 51972908, "comment_id": 90898879, "body": "Also StartDate has a trailing single quote that probably is not wanted."}, {"owner": {"reputation": 37, "user_id": 10256126, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b143fbbef4a024b915edd063710fdf5d?s=128&d=identicon&r=PG&f=1", "display_name": "Tyrone", "link": "https://stackoverflow.com/users/10256126/tyrone"}, "reply_to_user": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "edited": false, "score": 0, "creation_date": 1534968293, "post_id": 51972908, "comment_id": 90899077, "body": "@donPablo  I am new to vba , you want me to remove the and from the immediate window?"}, {"owner": {"reputation": 3725, "user_id": 6777839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YYN3g.jpg?s=128&g=1", "display_name": "Wolfgang Kais", "link": "https://stackoverflow.com/users/6777839/wolfgang-kais"}, "edited": false, "score": 0, "creation_date": 1534975554, "post_id": 51972908, "comment_id": 90902019, "body": "Dear @Tyrone, please explain what that <code>1. List item</code> means between the lines of your code."}, {"owner": {"reputation": 37, "user_id": 10256126, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b143fbbef4a024b915edd063710fdf5d?s=128&d=identicon&r=PG&f=1", "display_name": "Tyrone", "link": "https://stackoverflow.com/users/10256126/tyrone"}, "reply_to_user": {"reputation": 3725, "user_id": 6777839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YYN3g.jpg?s=128&g=1", "display_name": "Wolfgang Kais", "link": "https://stackoverflow.com/users/6777839/wolfgang-kais"}, "edited": false, "score": 0, "creation_date": 1535049771, "post_id": 51972908, "comment_id": 90934337, "body": "@WolfgangKais it was a type. I was able to fix the issue.  One column had abbreviations while the other I was connecting to did not"}], "owner": {"reputation": 37, "user_id": 10256126, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b143fbbef4a024b915edd063710fdf5d?s=128&d=identicon&r=PG&f=1", "display_name": "Tyrone", "link": "https://stackoverflow.com/users/10256126/tyrone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1534969047, "creation_date": 1534961893, "last_edit_date": 1534969047, "question_id": 51972908, "link": "https://stackoverflow.com/questions/51972908/vba-access-query-error", "title": "vba access query error", "body": "<p>I am getting a 3075 run time error when I try to filter thru multiple fields. Here is my code:</p>\n\n<pre><code>Private Sub Search_Click()\nDim strWhere As String\nDim i As Variant\nDim varItem As Variant\nDim strDelim As String\n\n\nIf Nz(Me.txtFullName, \"\") &lt;&gt; \"\" Then\n    strWhere = strWhere &amp; \"FullName Like '*\" &amp; Replace(Me.txtFullName, \"'\", \"''\") &amp; \"*' AND \"\nEnd If\n\nIf Nz(Me.txtCivil, \"\") &lt;&gt; \"\" Then\n    strWhere = strWhere &amp; \"CivilService_Status Like '*\" &amp; Replace(Me.txtCivil, \"'\", \"''\") &amp; \"*' AND \"\nEnd If\n\nIf Nz(Me.txtOffice, \"\") &lt;&gt; \"\" Then\n    strWhere = strWhere &amp; \"Office_Title Like '*\" &amp; Replace(Me.txtOffice, \"'\", \"''\") &amp; \"*' AND \"\nEnd If\n\n'If Nz(Me.cboDegree, \"\") &lt;&gt; \"\" Then\n    'strWhere = strWhere &amp; \"[UpdatedBy] = '\" &amp; Me.cboDegree.Value &amp; \"' AND \"\n'End If\n\nFor Each i In Me.lstPosition.ItemsSelected\n    strWhere = strWhere &amp; strDelim &amp; \"Bureau='\" &amp; Me.lstPosition.ItemData(i) &amp; strDelim &amp; \"' AND \"\nNext i\n\nIf Nz(Me.txtStartdate, \"\") &lt;&gt; \"\" Then 'from ,to salary range Dates\n   strWhere = strWhere &amp; \"AgencyStart_Date BETWEEN #\" &amp; Me.txtStartdate &amp; \"# AND #\" &amp; Me.txtTodate &amp; \"# 'AND\"\nEnd If\n\n'If Nz(Me.txtStartdate, \"\") &lt;&gt; \"\" Then 'from ,to salary range Dates\n   ' strWhere = strWhere &amp; \"Request_Date BETWEEN #\" &amp; Me.txtStartdate &amp; \"# AND #\" &amp; Me.txtTo &amp; \"# 'AND\"\n'End If\n\n\nFor Each i In Me.lstBureau.ItemsSelected 'listbox\n'If Not IsNull(i) Then\n    strWhere = strWhere &amp; strDelim &amp; \"Bureau='\" &amp; Me.lstBureau.ItemData(i) &amp; strDelim &amp; \"' AND \"\nNext i\n'End If\n\nIf Nz(Me.txtdivision, \"\") &lt;&gt; \"\" Then\n    strWhere = strWhere &amp; \"Division Like '*\" &amp; Replace(Me.txtdivision, \"'\", \"''\") &amp; \"*' AND \"\nEnd If\n\n\nFor Each i In Me.lstFund.ItemsSelected 'listbox\n   'If Not IsNull(i) Then\n    strWhere = strWhere &amp; strDelim &amp; \"Fund='\" &amp; Me.lstFund.ItemData(i) &amp;        \n\n 1. List item\n\nstrDelim &amp; \"' AND \"\n    'End If\nNext i\n    If Nz(Me.txtSalaryfrom, \"\") &lt;&gt; \"\" Then 'from ,to salary range Dates\n     strWhere = strWhere &amp; \"SumOfAnnualized_Salary BETWEEN #\" &amp;       Me.txtSalaryfrom   \n    &amp; \"# AND #\" &amp; Me.txtSalaryto &amp; \"# 'AND\"\n    End If\n\n\n\n\n    If strWhere &lt;&gt; \"\" Then\n    strWhere = Left(strWhere, Len(strWhere) - 5) 'Remove the extra AND\n    Report_Onboard_summary.Filter = strWhere\n    Report_Onboard_summary.FilterOn = True\n   DoCmd.OpenReport \"Onboard_summary\", acViewPreview, WhereCondition:=strWhere\n   Else\n    Report_Onboard_summary.Filter = \"\"\n   Report_Onboard_summary.FilterOn = False\n    End If\n\n\n\nEnd Sub\n</code></pre>\n\n<p>Any help would be appreciated</p>\n\n<pre><code>CivilService_Title Like '*Scientist*' AND Bureau='Part Time' AND AgencyStart_Date BETWEEN #8/22/2010# AND #12/23/2017#  AND [Fund] = 'CTL' AND SumOfAnnualized_Salary BETWEEN' 65000' AND '100000 ' \n</code></pre>\n\n<p>This pops up now. I was able to fix the syntax mistake but now when the report pops up, the fields are blank</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 5, "creation_date": 1534961746, "post_id": 51972801, "comment_id": 90896186, "body": "Conditional formatting applied to the cells in question, with a formula like <code>=NOT(ISERROR(FIND(CHAR(10),A1)))</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 10210525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4030dd1b1bfea81d3fa842fe92bd2eb?s=128&d=identicon&r=PG&f=1", "display_name": "Valborg", "link": "https://stackoverflow.com/users/10210525/valborg"}, "edited": false, "score": 0, "creation_date": 1534963505, "post_id": 51972947, "comment_id": 90896942, "body": "This is good but it only searches column A, is there a way to get it to search all used columns?"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "reply_to_user": {"reputation": 79, "user_id": 10210525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4030dd1b1bfea81d3fa842fe92bd2eb?s=128&d=identicon&r=PG&f=1", "display_name": "Valborg", "link": "https://stackoverflow.com/users/10210525/valborg"}, "edited": false, "score": 1, "creation_date": 1534963653, "post_id": 51972947, "comment_id": 90897007, "body": "@Valborg you could add an outside loop to go through <code>UsedRange.Columns.Count</code>"}, {"owner": {"reputation": 730, "user_id": 7077298, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1Y0iM.jpg?s=128&g=1", "display_name": "hod", "link": "https://stackoverflow.com/users/7077298/hod"}, "reply_to_user": {"reputation": 79, "user_id": 10210525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4030dd1b1bfea81d3fa842fe92bd2eb?s=128&d=identicon&r=PG&f=1", "display_name": "Valborg", "link": "https://stackoverflow.com/users/10210525/valborg"}, "edited": false, "score": 1, "creation_date": 1534964334, "post_id": 51972947, "comment_id": 90897329, "body": "@Valborg I updated the answer. Try it now. And just so you know you can replace the <code>ActiveSheet</code> with the sheet name, like this <code>Application.Sheets(&quot;Sheet1&quot;).UsedRange</code>"}, {"owner": {"reputation": 730, "user_id": 7077298, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1Y0iM.jpg?s=128&g=1", "display_name": "hod", "link": "https://stackoverflow.com/users/7077298/hod"}, "reply_to_user": {"reputation": 79, "user_id": 10210525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4030dd1b1bfea81d3fa842fe92bd2eb?s=128&d=identicon&r=PG&f=1", "display_name": "Valborg", "link": "https://stackoverflow.com/users/10210525/valborg"}, "edited": false, "score": 1, "creation_date": 1534965218, "post_id": 51972947, "comment_id": 90897742, "body": "@Valborg The reason you&#39;re gettnig an error message is because you are using <code>Range</code> instead of <code>Cells</code> inside your loops. Replace <code>Range(y &amp; i)</code> with <code>Cells (i, y)</code>. You should have this <code>InStr(1, Cells(i, Y), Chr(10))</code> and this <code>Cells(i, y).Interior.ColorIndex = 3</code> Hope this helps!"}], "tags": [], "owner": {"reputation": 730, "user_id": 7077298, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1Y0iM.jpg?s=128&g=1", "display_name": "hod", "link": "https://stackoverflow.com/users/7077298/hod"}, "is_accepted": true, "score": 2, "last_activity_date": 1534966092, "last_edit_date": 1534966092, "creation_date": 1534962034, "answer_id": 51972947, "question_id": 51972801, "link": "https://stackoverflow.com/questions/51972801/highlight-cells-that-contain-chr10/51972947#51972947", "title": "Highlight cells that contain Chr(10)", "body": "<p>This should work:</p>\n\n<pre><code>Sub TestForChr()\n\nDim rng As Range\n\nSet rng = Application.ActiveSheet.UsedRange\n\nFor Each cell In rng\n    If InStr(1, cell, Chr(10)) Then\n        cell.Interior.ColorIndex = 3\n    End If\nNext\n\nEnd Sub\n</code></pre>\n\n<p>If you want to start at specific Row or Column, use this:</p>\n\n<pre><code>Sub AnotherTestForChr()\n\nDim LastRow As Long, LastColumn As Long\nDim i As Long, y As Long\n\n' LastRow = Sheets(\"Sheet1\").Cells(Rows.Count, \"A\").End(xlUp).Row\n' LastColumn = Sheets(\"Sheet1\").Cells(1, Columns.Count).End(xlToLeft).Column\nLastRow = Sheets(\"Sheet1\").UsedRange.Rows.Count\nLastColumn = Sheets(\"Sheet1\").UsedRange.Columns.Count\n\nFor i = 1 To LastRow\n    For y = 1 To LastColumn\n        If InStr(1, Cells(i, y), Chr(10)) Then\n            Cells(i, y).Interior.ColorIndex = 3\n        End If\n    Next\nNext\n\nEnd Sub\n</code></pre>\n\n<p>Hope this helps!</p>\n"}], "owner": {"reputation": 79, "user_id": 10210525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4030dd1b1bfea81d3fa842fe92bd2eb?s=128&d=identicon&r=PG&f=1", "display_name": "Valborg", "link": "https://stackoverflow.com/users/10210525/valborg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "accepted_answer_id": 51972947, "answer_count": 1, "score": 1, "last_activity_date": 1534966092, "creation_date": 1534961447, "question_id": 51972801, "link": "https://stackoverflow.com/questions/51972801/highlight-cells-that-contain-chr10", "title": "Highlight cells that contain Chr(10)", "body": "<p>I am trying to highlight all the cells that contain the \"Alt + Enter\" (aka Chr(10)) character regardless of the other contents of the cell. How can I do this?</p>\n"}, {"tags": ["vba", "ms-access-2010", "dao", "recordset", "findfirst"], "answers": [{"tags": [], "owner": {"reputation": 487, "user_id": 729474, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/a8e32e28c2361f6bf5465e39c0a68987?s=128&d=identicon&r=PG", "display_name": "missscripty", "link": "https://stackoverflow.com/users/729474/missscripty"}, "is_accepted": false, "score": 0, "last_activity_date": 1534967559, "creation_date": 1534967559, "answer_id": 51974182, "question_id": 51972757, "link": "https://stackoverflow.com/questions/51972757/error-with-access-vba-recordset-to-find-first-on-a-different-form/51974182#51974182", "title": "Error with Access VBA Recordset to Find First on a Different Form?", "body": "<p>So I can't find where I found this (lol), but I found this really elegant solution, that seems to work really well:</p>\n\n<pre><code>Private Sub lstRecords_DblClick(Cancel As Integer)\n    Forms!frmMainEntry.Recordset.FindFirst \"[ID] = \" &amp; Forms!frmFindRecords.lstRecords.Column(0)\n    Forms!frmMainEntry.Form.cboJumpToRecord = Forms!frmFindRecords.lstRecords.Column(0)\n    Forms!frmMainEntry.Form.cboJumpToRecord.Requery\n    cmdClose_Click\nEnd Sub\n</code></pre>\n\n<p>No more errors!</p>\n"}], "owner": {"reputation": 487, "user_id": 729474, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/a8e32e28c2361f6bf5465e39c0a68987?s=128&d=identicon&r=PG", "display_name": "missscripty", "link": "https://stackoverflow.com/users/729474/missscripty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 206, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1534967559, "creation_date": 1534961277, "question_id": 51972757, "link": "https://stackoverflow.com/questions/51972757/error-with-access-vba-recordset-to-find-first-on-a-different-form", "title": "Error with Access VBA Recordset to Find First on a Different Form?", "body": "<p>I created a pop-up form in access, to search for a record and go to it on the main entry form.  The pop-up \"find\" form has a listbox with all the records that are in the main entry form, and the first column of that listbox is the ID on the main entry form.  This is a hidden column on the listbox.  </p>\n\n<p>The user can type something into an unbound textbox, which will filter the listbox, and then once they see the record, they want, they should be able to double-click a row of the listbox, and it should take them to that record on the main entry form.  I am getting an error and not sure why.</p>\n\n<p>This is the code for on double-click of the listbox:</p>\n\n<pre><code>Private Sub lstRecords_DblClick(Cancel As Integer)\n    Dim rs As DAO.Recordset\n\n\n    Set rs = Forms!frmMainEntry.Form.RecordsetClone\n    rs.MoveFirst\n    rs.FindFirst \"[ID] = \" &amp; Forms!frmFindRecords.lstRecords.Column(0)\n    If Not (rs.BOF And rs.EOF) Then\n        'Display the found record in the form.\n        Forms!frmMainEntry.Form.Bookmark = rs.Bookmark\n        Forms!frmMainEntry.Form.cboJumpToRecord = Forms!frmFindRecords.lstRecords.Column(0)\n        Forms!frmMainEntry.Form.cboJumpToRecord.Requery\n        cmdClose_Click\n    Else\n        MsgBox \"Weird, I can't find that record. Tell Someone!\"\n    End If\n    Set rs = Nothing\nEnd Sub\n</code></pre>\n\n<p>When I try to select something, I get the following error:\nRun-time error '2473': The expression |2 you entered as the event property setting produced the following error: |1.</p>\n\n<p>It highlights this line, of the above code:</p>\n\n<pre><code>        Forms!frmMainEntry.Form.Bookmark = rs.Bookmark\n</code></pre>\n\n<p>It is like it doesn't hold onto the recordset from the other form. I can see the main form look like it briefly goes to that record, but then I think that form is checking/resetting it's recordset, when it goes to it, because it has to check a toggle button that sets the status of a filter on that form.  </p>\n\n<p>I don't know how to get around it. Any thoughts?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel", "do-while"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1534962081, "post_id": 51972688, "comment_id": 90896321, "body": "FYI <code>Dim FZA, inertia, Rollresist, FSt, FL, T, ifinal, i1, ef1, rdyn, IE, IT, IW, mF, g, fR, ro, cW, A, V, a0, e, c As Double</code> declares <code>c</code> as a <code>Double</code>, and everything else is an implicit <code>Variant</code>."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10261162, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156978535379113/picture?type=large", "display_name": "Marcus Castanho", "link": "https://stackoverflow.com/users/10261162/marcus-castanho"}, "edited": false, "score": 0, "creation_date": 1534968408, "post_id": 51973213, "comment_id": 90899116, "body": "Oh, yes, it is about ax0,  somehow always the last mistakes are the most simple ones, haha thanks"}], "tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 0, "last_activity_date": 1534963208, "creation_date": 1534963208, "answer_id": 51973213, "question_id": 51972688, "link": "https://stackoverflow.com/questions/51972688/program-freezes-after-iterating-loop-excel-vba-for-loop/51973213#51973213", "title": "Program freezes after iterating loop - excel vba for loop", "body": "<p>The ax0 in line 35 looks pretty suspicious</p>\n\n<p><code>e = Sheets(\"FZ,Ex acelera\u00e7ao\").Range(\"L4\") - ax0</code>.</p>\n\n<p>Maybe it should be</p>\n\n<p><code>e = Sheets(\"FZ,Ex acelera\u00e7ao\").Range(\"L4\") - a0</code>.</p>\n\n<p>The code is very unreadable. Do stuff like:</p>\n\n<pre><code>Dim a0 as Double\nConst g as Double = 9.81\nDim shDados as Worksheet    \nSet shDados = Sheets(\"Dados carro.motor.transm\") \nifinal = shDados.range(\"D21\")\n</code></pre>\n\n<p>etc...</p>\n\n<p>I hope this helps you. Keep up the good work.</p>\n"}], "owner": {"reputation": 11, "user_id": 10261162, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156978535379113/picture?type=large", "display_name": "Marcus Castanho", "link": "https://stackoverflow.com/users/10261162/marcus-castanho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1534965072, "creation_date": 1534960956, "last_edit_date": 1534965072, "question_id": 51972688, "link": "https://stackoverflow.com/questions/51972688/program-freezes-after-iterating-loop-excel-vba-for-loop", "title": "Program freezes after iterating loop - excel vba for loop", "body": "<p>I am trying to use iteration to solve an equation of acceleration; </p>\n\n<pre><code>a =((T * IE * i1 * ef1) / rdyn) - ((((IE + IT) * ((ifinal * i1) ^ 2) + \nIW) * a0) / ((rdyn) ^ 2)) - (mF * g * fR * Cos(Atn(0))) - (mF * g * \nSin(Atn(0))) - (0.5 * ro * cW * A * ((V) ^ 2) / ((3.6) ^ 2));\n</code></pre>\n\n<p>in which i am using a0 for the iteration value and a for the future value. I used a do while loop , the program is pretty simple. I found out that it takes about 3 or 4 iterations to converge to a value. The problem is, when it calculates the final value excel freezes. </p>\n\n<p>I cant seem to find the problem. Could anyone spot what might be wrong please?</p>\n\n<pre><code>    Sub IteracaoAceleracao()\n\nDim FZA, inertia, Rollresist, FSt, FL, T, ifinal, i1, ef1, rdyn, IE, IT, IW, mF, g, fR, ro, cW, A, V, a0, e, c As Double\n\na0 = 0\ne = 1\nc = 0\n\nT = Sheets(\"T.Pot x n DADOS\").Range(\"C5\")\nifinal = Sheets(\"Dados carro.motor.transm\").Range(\"D21\")\ni1 = Sheets(\"Dados carro.motor.transm\").Range(\"D16\")\nef1 = Sheets(\"Dados carro.motor.transm\").Range(\"E16\")\nrdyn = Sheets(\"Dados carro.motor.transm\").Range(\"D5\")\nIE = Sheets(\"Dados carro.motor.transm\").Range(\"J4\")\nIT = Sheets(\"Dados carro.motor.transm\").Range(\"J5\")\nIW = Sheets(\"Dados carro.motor.transm\").Range(\"J3\")\nmF = Sheets(\"Dados carro.motor.transm\").Range(\"D2\")\ng = 9.81\nfR = Sheets(\"T.Pot x n DADOS\").Range(\"A36\")\nro = Sheets(\"Dados carro.motor.transm\").Range(\"D25\")\ncW = Sheets(\"Dados carro.motor.transm\").Range(\"D3\")\nA = Sheets(\"Dados carro.motor.transm\").Range(\"D4\")\nV = Sheets(\"T.Pot x n DADOS\").Range(\"A22\")\nFZA = (T * ifinal* i1 * ef1) / rdyn\ninertia = (((IE + IT) * ((ifinal * i1) ^ 2) + IW) * a0) / ((rdyn) ^ 2)\nRollresist = mF * g * fR * Cos(Atn(0))\nFSt = mF * g * Sin(Atn(0))\nFL = 0.5 * ro * cW * A * ((V) ^ 2) / ((3.6) ^ 2)\n\nDo While e &gt; 0.00155\n\n\nSheets(\"FZ,Ex acelera\u00e7\u00e3o\").Range(\"L4\") = (FZA - inertia - Rollresist - FSt - FL) / mF\n\ne = Sheets(\"FZ,Ex acelera\u00e7\u00e3o\").Range(\"L4\") - ax0\ne = Abs(e)\na0 = Sheets(\"FZ,Ex acelera\u00e7\u00e3o\").Range(\"L4\")\n\nLoop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1534961115, "post_id": 51972687, "comment_id": 90895886, "body": "If <code>Originalwks</code> is the <code>Activesheet</code> in <code>ActiveWorkbook</code>, then can&#39;t you just do <code>Dim OriginalWb as Workbook</code> and <code>Set OriginalWb = ActiveWorkbook</code>?"}, {"owner": {"reputation": 203, "user_id": 5436030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2566e3710ac6fbe4cbb218c7fb522238?s=128&d=identicon&r=PG&f=1", "display_name": "Jing Yi", "link": "https://stackoverflow.com/users/5436030/jing-yi"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1534961239, "post_id": 51972687, "comment_id": 90895942, "body": "That means if I am on my new workbook, the ActiveWorkbook will change to the new workbook. How do I call VBA to pull out the original workbook again?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1534961277, "post_id": 51972687, "comment_id": 90895959, "body": "You&#39;ll have a variable <code>OriginalWb</code> - reference that. Although the <code>ActiveWorkbook</code> will change, that variable will always refer to the same workbook - the first one that was active. <code>OriginalWks</code> works the same way - you have a reference to the first active sheet even if <code>ActiveSheet</code> is changing."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1534964958, "post_id": 51972687, "comment_id": 90897609, "body": "<code>ThisWorkbook</code> is always referring to the workbook that&#39;s running the VBA code. If that&#39;s an Excel add-in, then <code>ThisWorkbook</code> is the hidden workbook for that Excel add-in."}, {"owner": {"reputation": 968, "user_id": 5910169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a40180e3fa49fbf4e55145adf54d9?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Ball", "link": "https://stackoverflow.com/users/5910169/frank-ball"}, "edited": false, "score": 0, "creation_date": 1535138077, "post_id": 51972687, "comment_id": 90971812, "body": "Personally, I try to avoid using ActiveWorkbook because it can change at unexpected times.  There are several functions within Excel that create new workbooks on the fly which become the ActiveWorkbook and using ActiveWorkbook can create confusion about which workbook you are really using.  Use variables to hold the workbook you are accessing so that you KNOW you have the right one."}], "answers": [{"tags": [], "owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "is_accepted": true, "score": 3, "last_activity_date": 1535134294, "last_edit_date": 1535134294, "creation_date": 1534963494, "answer_id": 51973292, "question_id": 51972687, "link": "https://stackoverflow.com/questions/51972687/excel-vba-selecting-original-workbook/51973292#51973292", "title": "Excel VBA Selecting Original Workbook", "body": "<p>You are confused about how to use <code>ActiveWorkbook</code> and <code>ThisWorkbook</code> objects. The best approach is always to take the control of all of the elements you are dealing with in your process, in this case you have a workbook that is your original workbook and you want to use its data and path later in your routine. It does not matter if you run your routine from an add-in or from the original workbook itself, or even from another workbook. Your original workbook has a path that you can define it in your code either dynamically or just hard coded. So here are some options you can use:</p>\n\n<p>If the original workbook is open and active then do this to always refer to it and retrieve its path:</p>\n\n<pre><code>Dim WB_Orig As Workbook\nSet WB_Orig = ActiveWorkbook\n</code></pre>\n\n<p>if activeworkbook changes it will not cause a problem. Also, regardless of running the code from add-in or the original workbook itself, <code>activewokbook</code> will be that one (the one you see on your screen), if you run it from add-in <code>ThisWorkbook</code> will refer to the add-in workbook and NOT your original workbook.</p>\n\n<p>If you run the code from the add-in, I would try to locate the original workbook and open it like this and set it to an object at the same time:</p>\n\n<pre><code>Set WB_Orig = Application.Workbooks.Open(\"filename\") 'filename is the path to your original workbook\n</code></pre>\n\n<p>also, there could be a case that the workbook is open so it is better to check all the open workbook names before trying to open it. You can iterate over the open workbooks and check their names and if you had a match simply assign it as the <code>WB_Orig</code>:</p>\n\n<pre><code>Function GetOriginalWorkbook(sFilename As String)\n    Dim WB As Workbook\n    For Each WB In Application.Workbooks\n        If WB.Name = sFilename Then\n            Set GetOriginalWorkbook = WB\n            Exit For\n        End If\n    Next\nEnd Function\n</code></pre>\n\n<p>using the above function in your sub you can easily do:</p>\n\n<pre><code>Set WB_Orig = GetOriginalWorkbook(\"Book1\") 'you need to change Book1 with the name of your origianl workbook.\n</code></pre>\n\n<p>If Original workbook is open then you have it as an object already assigned to <code>WB_Orig</code> otherwise it will be <code>Nothing</code> and you should open it:</p>\n\n<pre><code>Set WB_Orig = GetOriginalWorkbook(\"Book1\")\n\nif WB_Orig is Nothing then\n     Set WB_Orig = Application.Workbooks.Open(\"filename\")\nend if\n</code></pre>\n\n<p>Another trick would be setting <code>on error</code> to <code>resume next</code> before trying to open the original workbook and thensetting it back to <code>goto 0</code>. This way if the original workbook was not open, Excel will open it, if it was open, an error should be thrown, but since you told excel to ignore it, it will resume executing the code and you should be fine. Using <code>on error resume next</code> is tricky and as a  good practice you should always try to foresee and control the errors not ignore them.</p>\n"}], "owner": {"reputation": 203, "user_id": 5436030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2566e3710ac6fbe4cbb218c7fb522238?s=128&d=identicon&r=PG&f=1", "display_name": "Jing Yi", "link": "https://stackoverflow.com/users/5436030/jing-yi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1970, "favorite_count": 0, "accepted_answer_id": 51973292, "answer_count": 1, "score": 0, "last_activity_date": 1535134294, "creation_date": 1534960940, "last_edit_date": 1535010760, "question_id": 51972687, "link": "https://stackoverflow.com/questions/51972687/excel-vba-selecting-original-workbook", "title": "Excel VBA Selecting Original Workbook", "body": "<p>I am working on a Excel VBA script that requires me to copy and paste different details from the original excel workbook into 5 new excel workbooks in an orderly manner. Also, I am adding the Macros into a Add-in so that it can be added into another computer. My only problem is that I am unable to reference the original workbook because: </p>\n\n<p>1) The original workbook's file name will always be changing, therefore I am unable to pull out the workbook based on its name/assign the workbook name to a variable. </p>\n\n<p>2) Excel VBA have ActiveWorkbook/ThisWorkbook property but it does not ActiveWorkbook Property will always be changing, depending on the current workbook that is active. That being said, ActiveWorkbook will not work for me as the creation of new workbooks will overwrite the original workbook. ThisWorkbook property does not work for me because the VBA codes will be stored in an Add-in, but I want to save the new files in the original workbook's location instead (This is when I use ThisWorkbook.Path to identify the location). </p>\n\n<p>Does anyone know if I can make Excel VBA read the original file's location and lock that value into a variable such that I can always call it back again when I need to reference it again? </p>\n\n<p>Below is a sample code that I have. Any help will be greatly appreciated. Thank you! </p>\n\n<pre><code>Option Explicit\n\nSub new()\n\n    Dim createWb As Workbook\n    Dim Originalwks As Worksheet\n    Dim createWbName As String\n\n    Set Originalwks = ActiveWorkbook.ActiveSheet\n\n    createWbName = Left(ActiveWorkbook.Name, Len(ActiveWorkbook.Name) - 4)\n    Set createWb = Workbooks.Add\n    createWb.SaveAs Filename:=ThisWorkbook.Path &amp; Application.PathSeparator &amp; createWbName\n    createWb.Sheets(\"Sheet1\").Name = createWbName\n\n    Originalwks.UsedRange.Copy\n    createWb.Worksheets(createWbName).Range(\"A1\").PasteSpecial xlValues\n\n    'I will still be adding new workbooks by copying values from the original workbook. \n    'But how do I pull out the original workbook again? \n\n    createWb.Close SaveChanges:=True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1534960872, "post_id": 51972651, "comment_id": 90895794, "body": "Share what you have tried. If unsure consider using a dictionary. <a href=\"https://excelmacromastery.com/vba-dictionary/\" rel=\"nofollow noreferrer\">excelmacromastery.com/vba-dictionary</a> . Add one to the value each time the key is encountered again. The keys are the fruit names. We can help with specific programming problems so sharing your attempts is important."}, {"owner": {"reputation": 19, "user_id": 8216451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6e2e99c4a9093dd787729d56d32bfc1?s=128&d=identicon&r=PG&f=1", "display_name": "Ibra22", "link": "https://stackoverflow.com/users/8216451/ibra22"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1534961036, "post_id": 51972651, "comment_id": 90895860, "body": "agreed, but do you know how I can do that if these values are stored in an array?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 2, "creation_date": 1534961125, "post_id": 51972651, "comment_id": 90895891, "body": "What have you tried? You can loop an array and use .Exists method of a dictionary. Without seeing any code I don&#39;t know whether array means the same thing to you as it does to me."}, {"owner": {"reputation": 19, "user_id": 8216451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6e2e99c4a9093dd787729d56d32bfc1?s=128&d=identicon&r=PG&f=1", "display_name": "Ibra22", "link": "https://stackoverflow.com/users/8216451/ibra22"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1534961332, "post_id": 51972651, "comment_id": 90895984, "body": "Thanks for your feedback. i have added a sample of the code I used. Let me know if you need more information. Happy to clarify."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1534961535, "post_id": 51972651, "comment_id": 90896070, "body": "FWIW doing <code>Dim MyArray As Variant</code> and then <code>MyArray = Application.WorksheetFunction.Transpose(ws.Range(&quot;A13&quot;, ws.Range(&quot;A13&quot;).End(xlDown)).Value)</code> would get you a single-dimensional array with all the values, without needing a loop and without needing to read each individual cell values - assuming <code>lRow &gt; 13</code>."}, {"owner": {"reputation": 19, "user_id": 8216451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6e2e99c4a9093dd787729d56d32bfc1?s=128&d=identicon&r=PG&f=1", "display_name": "Ibra22", "link": "https://stackoverflow.com/users/8216451/ibra22"}, "edited": false, "score": 0, "creation_date": 1534961997, "post_id": 51972651, "comment_id": 90896284, "body": "oh thats much easier. Thanks for that Mathieu. Good observation - The dataset does start from A13. Now that I have stored all the value in a single dimensional array, do you know how I can figure what the unique values are and how many times they are repeated in the array?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1534962413, "post_id": 51972651, "comment_id": 90896465, "body": "You need to iterate the array, and somehow keep track of each value and how many of each there are - a <code>Dictionary</code> is perfect for this; key it with the fruit names, and if a key exists, get the value, increment it, then store the new value back at that key. Once you&#39;ve iterated the array the number of keys in the dictionary is the number of unique items; declare a 2D array of that size (2 columns), populate column 1 with the keys and column 2 with the items, return the 2D array, dump it onto a worksheet, done =)"}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 8216451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6e2e99c4a9093dd787729d56d32bfc1?s=128&d=identicon&r=PG&f=1", "display_name": "Ibra22", "link": "https://stackoverflow.com/users/8216451/ibra22"}, "edited": false, "score": 0, "creation_date": 1534962944, "post_id": 51972965, "comment_id": 90896694, "body": "Oh that is amazing. Works like a charm. Honestly, still trying to reverse engineer how you did it but thank you for all the help!"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 19, "user_id": 8216451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6e2e99c4a9093dd787729d56d32bfc1?s=128&d=identicon&r=PG&f=1", "display_name": "Ibra22", "link": "https://stackoverflow.com/users/8216451/ibra22"}, "edited": false, "score": 0, "creation_date": 1534963061, "post_id": 51972965, "comment_id": 90896740, "body": "With the above, is there anything you would like explained it more detail?"}, {"owner": {"reputation": 19, "user_id": 8216451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6e2e99c4a9093dd787729d56d32bfc1?s=128&d=identicon&r=PG&f=1", "display_name": "Ibra22", "link": "https://stackoverflow.com/users/8216451/ibra22"}, "edited": false, "score": 0, "creation_date": 1534964196, "post_id": 51972965, "comment_id": 90897259, "body": "I have never used a dictionary method before and so I will have to do my own research, but will appreciate any high level explanation that you may have that can help me better understand and visualize the concept"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 19, "user_id": 8216451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6e2e99c4a9093dd787729d56d32bfc1?s=128&d=identicon&r=PG&f=1", "display_name": "Ibra22", "link": "https://stackoverflow.com/users/8216451/ibra22"}, "edited": false, "score": 0, "creation_date": 1534965011, "post_id": 51972965, "comment_id": 90897634, "body": "Have a look at the link I gave. Essentially it is a structure that has pairs of keys and values e.g. Key1:Value1, Key2:Value2. Keys must be unique."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 19, "user_id": 8216451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6e2e99c4a9093dd787729d56d32bfc1?s=128&d=identicon&r=PG&f=1", "display_name": "Ibra22", "link": "https://stackoverflow.com/users/8216451/ibra22"}, "edited": false, "score": 0, "creation_date": 1534965046, "post_id": 51972965, "comment_id": 90897655, "body": "I am adding the fruits as the keys e.g.&quot;Apple&quot;:1, &quot;Banana&quot;:1. And the initial value for each key is one (the first time of encountering the fruit). Each time I find the fruit again by matching on the key, I add another 1 to the existing value. So the value, at the end, matches the number of times the fruit is found."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1534962514, "last_edit_date": 1534962514, "creation_date": 1534962112, "answer_id": 51972965, "question_id": 51972651, "link": "https://stackoverflow.com/questions/51972651/how-to-count-repeating-values-in-an-array-vba/51972965#51972965", "title": "How to count repeating values in an array (VBA)?", "body": "<p>Here is a dictionary method. I note you are using column A for finding last row but that your fruits, I believe, are in column K. Each time a key is encountered again in the dictionary 1 is added to the existing value for that key:</p>\n\n<pre><code>fruitDict(.Cells(i + 12, 11).Value) = fruitDict(.Cells(i + 12, 11).Value) + 1\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>Option Explicit\nPublic Sub TEST()\n    Dim MyArray() As Variant, ws As Worksheet, lRow As Long, fruitDict As Object, i As Long\n    Set fruitDict = CreateObject(\"Scripting.Dictionary\")\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n\n    With ws\n        lRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n        Select Case lRow\n        Case Is &lt; 13\n            Exit Sub\n        Case 13\n            ReDim MyArray(1, 1)\n            MyArray = .Range(\"A13\").Value\n        Case Else\n            MyArray = .Range(\"A13:A\" &amp; lRow).Value\n        End Select\n\n        For i = LBound(MyArray, 1) To UBound(MyArray, 1)\n            If Not IsEmpty(.Cells(i + 12, 11)) Then\n                fruitDict(.Cells(i + 12, 11).Value) = fruitDict(.Cells(i + 12, 11).Value) + 1\n            End If\n        Next\n    End With\n\n    With Worksheets(\"Sheet2\")\n        .Range(\"A1\").Resize(fruitDict.Count, 1) = Application.WorksheetFunction.Transpose(fruitDict.keys)\n        .Range(\"B1\").Resize(fruitDict.Count, 1) = Application.WorksheetFunction.Transpose(fruitDict.Items)\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 8216451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6e2e99c4a9093dd787729d56d32bfc1?s=128&d=identicon&r=PG&f=1", "display_name": "Ibra22", "link": "https://stackoverflow.com/users/8216451/ibra22"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 422, "favorite_count": 0, "accepted_answer_id": 51972965, "answer_count": 1, "score": 0, "last_activity_date": 1534962514, "creation_date": 1534960767, "last_edit_date": 1534961287, "question_id": 51972651, "link": "https://stackoverflow.com/questions/51972651/how-to-count-repeating-values-in-an-array-vba", "title": "How to count repeating values in an array (VBA)?", "body": "<p>Assume I have an array that has the following data:</p>\n\n<pre><code>apples\napples\napples\napples\noranges\ngrapes\noranges\napples\noranges\ngrapes\nbananas\n</code></pre>\n\n<p>How can I make the output look like this:</p>\n\n<pre><code>Item        count\napples        5\noranges       3\ngrapes        2\nbananas       1\n</code></pre>\n\n<p>I am not looking for a pivot table solution, but rather a code in VBA.</p>\n\n<p>Thanks in advance for all your help.</p>\n\n<p>Current Code I am using the following:</p>\n\n<pre><code>'Setting Up Dynamic Array to Store Fruit Selections\nDim MyArray() As Variant\n\n\n'Counting # of Rows\nDim lRow As Long\nlRow = ws.Range(\"A13\", ws.Range(\"A13\").End(xlDown)).Rows.Count\n\n\n'Resize Array\nReDim MyArray(lRow)\n\n\nFor i = 1 To lRow\n    MyArray(x) = ws.Cells(i + 12, 11)\n    x = x + 1\nNext\n</code></pre>\n\n<p>Now that I have stored all the fruit values in the array, how can I count the number of unique fruits and their respective count? </p>\n"}, {"tags": ["excel", "vba", "office365"], "comments": [{"owner": {"reputation": 98, "user_id": 10173088, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5iY4Z.jpg?s=128&g=1", "display_name": "Brent", "link": "https://stackoverflow.com/users/10173088/brent"}, "edited": false, "score": 0, "creation_date": 1534960533, "post_id": 51972302, "comment_id": 90895655, "body": "You may be better off controlling what a user can input into the field in the first place, and then doing a clean up to fix what you have. That way you would not need to attempt to account for every possible way someone could mess it up."}, {"owner": {"reputation": 11, "user_id": 10260974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/349a898a60af9ffae82e75bfb1c9d398?s=128&d=identicon&r=PG&f=1", "display_name": "Pstinson1211", "link": "https://stackoverflow.com/users/10260974/pstinson1211"}, "reply_to_user": {"reputation": 98, "user_id": 10173088, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5iY4Z.jpg?s=128&g=1", "display_name": "Brent", "link": "https://stackoverflow.com/users/10173088/brent"}, "edited": false, "score": 0, "creation_date": 1534961587, "post_id": 51972302, "comment_id": 90896099, "body": "The data is being migrated to a new system that will have better field validation behavior. In the mean time though I have to get the existing data cleaned up."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1534963963, "post_id": 51972302, "comment_id": 90897154, "body": "I mean there are definitely strategies that you can take but it&#39;s not gonna be a fun time verifying whether the data that you reformat is correct <a href=\"https://blog.udemy.com/vba-format-date/\" rel=\"nofollow noreferrer\">blog.udemy.com/vba-format-date</a>"}], "answers": [{"tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": false, "score": 1, "last_activity_date": 1534964399, "creation_date": 1534964399, "answer_id": 51973485, "question_id": 51972302, "link": "https://stackoverflow.com/questions/51972302/vba-date-cleanup-reformatting/51973485#51973485", "title": "VBA Date cleanup / reformatting", "body": "<p>This is one of those problems that you could spend a year trying to solve to get a 100% solution. The good news is you can get super lazy and have a nice 60% solution by using the VBA <code>CDATE()</code> function which makes a good guess for whatever you feed it. Tossing <code>Split()</code> at it to peel off extra words and whatnot (that may follow the date with a space or a comma) you can get most of the actual dates covered here. The remaining records are either dates that are so badly formatted that you will have to write code for the edge case, or it's just garbage non-date stuff you can ignore.</p>\n\n<p>Create a new module in VBA and pop this in:</p>\n\n<pre><code>Public Function dateguesser(inDate As String) As Date\n    dateguesser = CDate(Split(Split(inDate, \" \")(0), \",\")(0))\nEnd Function\n</code></pre>\n\n<p>Then in your sheet you can use this as a new function</p>\n\n<pre><code>=dateguesser(A1)\n</code></pre>\n\n<p>And copy down. For your list, you get the following:</p>\n\n<pre><code>+----+---------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n|    |                   A                   |                                                                                                                                B                                                                                                                                |\n+----+---------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n|  1 | 2/2/2018                              | 2/2/2018                                                                                                                                                                                                                                                        |\n|  2 | 8/3/2018                              | 8/3/2018                                                                                                                                                                                                                                                        |\n|  3 | 1996                                  | 6/18/1905                                                                                                                                                                                                                                                       |\n|  4 | 1990-1991                             | #VALUE!                                                                                                                                                                                                                                                         |\n|  5 | 02/29/95                              | #VALUE!                                                                                                                                                                                                                                                         |\n|  6 | 1992-93                               | #VALUE!                                                                                                                                                                                                                                                         |\n|  7 | 05/08/200                             | ############################################################################################################################################################################################################################################################### |\n|  8 | DECLINED                              | #VALUE!                                                                                                                                                                                                                                                         |\n|  9 | 5/1418                                | ############################################################################################################################################################################################################################################################### |\n| 10 | 8/14/2018                             | 8/14/2018                                                                                                                                                                                                                                                       |\n| 11 | 06/09/200                             | ############################################################################################################################################################################################################################################################### |\n| 12 | 1/12/94,  DECLINED CONTRACT  12/01/00 | 1/12/1994                                                                                                                                                                                                                                                       |\n| 13 | EXP CAT I                             | #VALUE!                                                                                                                                                                                                                                                         |\n| 14 | 06/14/23018                           | #VALUE!                                                                                                                                                                                                                                                         |\n| 15 | 1996                                  | 6/18/1905                                                                                                                                                                                                                                                       |\n| 16 | 5-1-1207/07/92                        | #VALUE!                                                                                                                                                                                                                                                         |\n| 17 | 8/3/2018                              | 8/3/2018                                                                                                                                                                                                                                                        |\n| 18 | 3-10-                                 | #VALUE!                                                                                                                                                                                                                                                         |\n| 19 | 1996                                  | 6/18/1905                                                                                                                                                                                                                                                       |\n| 20 | 02/27/187                             | ############################################################################################################################################################################################################################################################### |\n| 21 | 1-29-14                               | 1/29/2014                                                                                                                                                                                                                                                       |\n| 22 | 2/2/2018                              | 2/2/2018                                                                                                                                                                                                                                                        |\n| 23 | 1-4-11                                | 1/4/2011                                                                                                                                                                                                                                                        |\n| 24 | 3.8.99                                | #VALUE!                                                                                                                                                                                                                                                         |\n| 25 | 2-17-12                               | 2/17/2012                                                                                                                                                                                                                                                       |\n| 26 | 10-6-16                               | 10/6/2016                                                                                                                                                                                                                                                       |\n+----+---------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n</code></pre>\n\n<p>Clearly this is just a starting point, but I think it's a good solid starting point. The remaining crap you can start writing edge cases for in your VBA, but the closer you get to 100% the longer it's going to take to get any further and before you know it you'll be  a month into this and wondering what's happened to your life.</p>\n"}], "owner": {"reputation": 11, "user_id": 10260974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/349a898a60af9ffae82e75bfb1c9d398?s=128&d=identicon&r=PG&f=1", "display_name": "Pstinson1211", "link": "https://stackoverflow.com/users/10260974/pstinson1211"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1594152418, "creation_date": 1534959252, "last_edit_date": 1594152418, "question_id": 51972302, "link": "https://stackoverflow.com/questions/51972302/vba-date-cleanup-reformatting", "title": "VBA Date cleanup / reformatting", "body": "<p>I'm relatively new to VBA coding and wanted to get some ideas as to how I could do some data cleanup/reformatting. I have a excel data export from a system that has very little business logic/validation. </p>\n\n<p>As a result I have a Date column that has data integrity issues that I have examples of below. Dates are not formatted the same consistently, there is dates combined with text strings, in some cases only text (in the date field)</p>\n\n<p>Here are examples of the data I have in the Date column:</p>\n\n<pre><code>2/2/2018\n8/3/2018\n1996\n1990-1991\n02/29/95\n1992-93\n05/08/200\nDECLINED\n5/1418\n8/14/2018\n06/09/200\n1/12/94,  DECLINED CONTRACT  12/01/00\nEXP CAT I\n06/14/23018\n1996\n5-1-1207/07/92\n8/3/2018\n3-10-\n1996\n02/27/187\n1-29-14\n2/2/2018\n1-4-11\n3.8.99\n2-17-12\n10-6-16\n</code></pre>\n\n<p>I would like to convert the dates into the <code>MM/DD/YYYY</code> format. I realize where I just have pure text (e.g. 'DECLINED') that there is no way to extract a date, however I'm hoping for the other examples it may be possible to format the date to the above. </p>\n\n<p>Some of the dates are plain no good (e.g. '5/1418' can't determine how to translate this), but I'm hoping for at least the dates formatted with MM-DD-YYYY and MM.DD.YYYY and similar combinations there is a way to convert their formatting, as well as where I just have 1 digit Month and Day (e.g. 2/2/2018 should be 02/02/2018). If just a 4 digit year is provided I want to convert to '01/01/(year)' Any ideas are appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1534959404, "post_id": 51972204, "comment_id": 90895104, "body": "this could be a reference problem, in the immediate window of VBE run this and <code>debug.print Year(Now)</code> see if it returns the right answer"}, {"owner": {"reputation": 1, "user_id": 9795893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac59ec455fa97c295aedb08b46209b4d?s=128&d=identicon&r=PG&f=1", "display_name": "Pokeanerd", "link": "https://stackoverflow.com/users/9795893/pokeanerd"}, "edited": false, "score": 0, "creation_date": 1534962807, "post_id": 51972204, "comment_id": 90896629, "body": "debug.print is also outputting error 13"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1534969505, "post_id": 51972204, "comment_id": 90899612, "body": "What exact line gives the error ?"}, {"owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "edited": false, "score": 1, "creation_date": 1534973108, "post_id": 51972204, "comment_id": 90901111, "body": "The Now() always needs the pair of parens.  Please update and try again.  Try  debug.print Year(Now())"}, {"owner": {"reputation": 1, "user_id": 9795893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac59ec455fa97c295aedb08b46209b4d?s=128&d=identicon&r=PG&f=1", "display_name": "Pokeanerd", "link": "https://stackoverflow.com/users/9795893/pokeanerd"}, "edited": false, "score": 0, "creation_date": 1535024789, "post_id": 51972204, "comment_id": 90919439, "body": "<code>debug.print Year(Now)</code> and <code>debug.print Year(Now())</code> gave the error. <code>Option Explicit</code> on every module does not have an effect."}], "owner": {"reputation": 1, "user_id": 9795893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac59ec455fa97c295aedb08b46209b4d?s=128&d=identicon&r=PG&f=1", "display_name": "Pokeanerd", "link": "https://stackoverflow.com/users/9795893/pokeanerd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1534995518, "creation_date": 1534958847, "last_edit_date": 1534995518, "question_id": 51972204, "link": "https://stackoverflow.com/questions/51972204/vba-error-13-with-microsoft-excel-objects", "title": "vba error 13 with microsoft excel objects", "body": "<p>So this error 13 started today. I have a button that sets the current year. This button is an ActiveX button(I like this over a Form button for organization reasons.) \nThis is the code for the button.</p>\n\n<pre><code>Private Sub CurrentYear_Click()\n        Call StartData\n        Yr = Year(Now)\n        Cells(1, 2).Value = Yr\n        Call UpdateSheets\nEnd Sub\n</code></pre>\n\n<p>StartData is the function I have for setup like <code>public Yr As Integer</code> and <code>Yr = Cells(1, 2).Value</code>. This is done because other data needs setup when if this or other buttons are pressed first. Now I'm getting the error on this line <code>Yr = Year(Now)</code> and I'll point I do not think this is a problem with my variable for these two(on a ActiveX scroll) work.</p>\n\n<pre><code>Private Sub YearChange_SpinDown()\n    Call StartData\n    Yr = Yr - 1\n    Call UpdateSheets\nEnd Sub\nPrivate Sub YearChange_SpinUp()\n    Call StartData\n    Yr = Yr + 1\n    Call UpdateSheets\nEnd Sub\n</code></pre>\n\n<p>Now here is the twist, I put that top function in a module and ran off that and it works, I opened up a new workbook to test it and it works. So while I have workarounds for this I'll to know if I did something and if I can put it back.</p>\n\n<p>Module with StartData </p>\n\n<pre><code>Public Yr As Integer\nPublic MonthNub As Integer\nPublic MonthNm As String\nPublic MonNam As String\nPublic LastMonthNub As Integer\nPublic LastMonthName As String\nPublic NextMonthNub As Integer\nPublic NextMonthName As String\nPublic WkN As Integer\nPublic WkDy As Integer\nPublic EndD As Integer\nPublic LEnD As Integer\nPublic MonthSheet As Worksheet\nPublic Week1 As Worksheet\nPublic Week2 As Worksheet\nPublic Week3 As Worksheet\nPublic Week4 As Worksheet\nPublic Week5 As Worksheet\nPublic Week6 As Worksheet\nPublic Sub StartData()\n    Yr = Cells(1, 2).Value\n    MonthNm = Cells(1, 1).Value\n    MonthNub = Month(DateValue(MonthNm &amp; \" 01 \" &amp; Yr))\n    MonNam = MonthName(MonthNub, True)\n\n    Set MonthSheet = Worksheets(2)\n    Set Week1 = Worksheets(3)\n    Set Week2 = Worksheets(4)\n    Set Week3 = Worksheets(5)\n    Set Week4 = Worksheets(6)\n    Set Week5 = Worksheets(7)\n    Set Week6 = Worksheets(8)\n\n    If MonthNub - 1 &lt; 1 Then\n        LastMonthNub = 12\n    Else\n        LastMonthNub = MonthNub - 1\n    End If\n    LastMonthName = MonthName(LastMonthNub, True)\n\n    If MonthNub + 1 &gt; 12 Then\n        NextMonthNub = 1\n    Else\n        NextMonthNub = MonthNub + 1\n    End If\n    NextMonthName = MonthName(NextMonthNub, True)\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "edited": false, "score": 0, "creation_date": 1535015866, "post_id": 51972177, "comment_id": 90914219, "body": "<code>.Cells(i, 7)</code> was an example of a correct work of the <code>IsNa</code>. In the code you provided the error would occur in the else block - the Match would through it. <code>.Cells(i, 1).value</code> is never an error - it&#39;s a normal string"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "edited": false, "score": 0, "creation_date": 1535036228, "post_id": 51972177, "comment_id": 90926948, "body": "@Ans - You miss the point of using <code>IsError</code> instead of <code>IsNa</code>. What happens if <code>.Cells(i, 1).Value</code> <b><i>is</i></b> an error or is an error other than <code>#N&#47;A</code>?  Solid coding protects itself from those eventualities - I just didn&#39;t want your next question here to be another &quot;crashes with Error 1004&quot; question."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 2, "last_activity_date": 1534958719, "creation_date": 1534958719, "answer_id": 51972177, "question_id": 51972028, "link": "https://stackoverflow.com/questions/51972028/excel-vba-check-if-match-function-returns-na-macro-crashes-runtime-error-1004/51972177#51972177", "title": "Excel vba check if Match function returns NA - macro crashes: Runtime Error 1004 \u201cApplication-defined or Object-defined error\u201d", "body": "<p>You need to test the return value of <code>.Cells(i, 7).Value</code> <strong><em>before</em></strong> you pass it to <code>WorksheetFunction.Match</code>.  I'd also suggest using the VBA function <code>IsError</code> instead of <code>WorksheetFunction.IsNA</code>:</p>\n\n<pre><code>With ThisWorkbook.Worksheets(\"hide_rows\")\n    For i = 2 To 15\n        Dim result As Variant\n\n        result = .Cells(i, 1).Value\n        If IsError(result) Then\n            'Do whatever\n        Else\n            MsgBox (Application.WorksheetFunction.Match(result, _\n                    ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A:A\"), 0))\n        End If\n    Next\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1534958901, "creation_date": 1534958901, "answer_id": 51972219, "question_id": 51972028, "link": "https://stackoverflow.com/questions/51972028/excel-vba-check-if-match-function-returns-na-macro-crashes-runtime-error-1004/51972219#51972219", "title": "Excel vba check if Match function returns NA - macro crashes: Runtime Error 1004 \u201cApplication-defined or Object-defined error\u201d", "body": "<p>With <code>Match</code> you need to check before getting the result if it was successful. You do that by using <code>If Not IsError(Application.Match...</code></p>\n\n<p><strong><em>Modified Code</em></strong></p>\n\n<pre><code>Sub test()\n\nWith ThisWorkbook.Worksheets(\"hide_rows\")\n    For i = 2 To 15\n        If Not IsError(Application.Match(.Cells(i, 1).Value, _\n            ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A:A\"), 0)) Then\n\n            MsgBox (Application.WorksheetFunction.Match(.Cells(i, 1).Value, _\n                ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A:A\"), 0))\n\n        Else    ' Match failed\n            MsgBox \"Row \" &amp; i &amp; \" failed to find a match\", vbCritical, \"Error\"\n        End If\n    Next\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 711, "favorite_count": 0, "accepted_answer_id": 51972219, "answer_count": 2, "score": 0, "last_activity_date": 1534958901, "creation_date": 1534958076, "last_edit_date": 1534958433, "question_id": 51972028, "link": "https://stackoverflow.com/questions/51972028/excel-vba-check-if-match-function-returns-na-macro-crashes-runtime-error-1004", "title": "Excel vba check if Match function returns NA - macro crashes: Runtime Error 1004 \u201cApplication-defined or Object-defined error\u201d", "body": "<p>I use a <code>Match</code> function to find a specific row with data:</p>\n\n<pre><code>Sub test\n\nWith ThisWorkbook.Worksheets(\"hide_rows\")\n For i = 2 To 15\n   MsgBox (Application.WorksheetFunction.Match(.Cells(i, 1).Value, _\n                ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A:A\"), 0)) \n Next\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>From i = 2 to i=14 it works fine. However the string in <code>.Cells(15, 1)</code> excel can't find in a given range which results in  <code>Runtime Error 1004 \u201cApplication-defined or Object-defined error</code> error. I tried to fix it by checking if it's <code>#N/A</code> first:</p>\n\n<pre><code>Sub test\n\nWith ThisWorkbook.Worksheets(\"hide_rows\")\n For i = 2 To 15\n   MsgBox (Application.WorksheetFunction.IsNA(Application.WorksheetFunction.Match(.Cells(i, 1).Value, _\n                ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A:A\")), 0)) \n Next\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>It returns <code>False</code> for rows 2-14 and still crashed for the 15th.</p>\n\n<p>At the same time if I just calculate the <code>Match</code> manually in the sheet and then check if the result is <code>#N/A</code> it works fine:</p>\n\n<pre><code>Sub test()\n\nWith ThisWorkbook.Worksheets(\"hide_rows\")\n For i = 2 To 15\n   MsgBox (Application.WorksheetFunction.IsNA(.Cells(i, 7).Value))\n Next\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 5173, "user_id": 1981088, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1Iicg.png?s=128&g=1", "display_name": "help-info.de", "link": "https://stackoverflow.com/users/1981088/help-info-de"}, "edited": false, "score": 1, "creation_date": 1534958196, "post_id": 51971973, "comment_id": 90894569, "body": "Welcome to Stack Overflow! Please take the <a href=\"https://stackoverflow.com/tour\">tour</a> and read through the <a href=\"http://stackoverflow.com/help\">help center</a>, in particular how to ask. Your best bet here is to do your research, search for related topics on SO, and give it a go. After doing more research and searching, post a <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a> of your attempt and say specifically where you&#39;re stuck, which can help you get better answers."}, {"owner": {"reputation": 582, "user_id": 6896061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bf0230605ac24f5be23ea08c02dbbe5?s=128&d=identicon&r=PG", "display_name": "DavidP", "link": "https://stackoverflow.com/users/6896061/davidp"}, "reply_to_user": {"reputation": 5173, "user_id": 1981088, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1Iicg.png?s=128&g=1", "display_name": "help-info.de", "link": "https://stackoverflow.com/users/1981088/help-info-de"}, "edited": false, "score": 0, "creation_date": 1534966625, "post_id": 51971973, "comment_id": 90898365, "body": "As @help-info.de said, an example would be very helpful. An example of what your current schedule and shift sheets look like would also make it easier to understand what exactly your current formula is doing. If you just need to automatically change the size of the referenced area, check out <a href=\"https://docs.microsoft.com/en-us/office/vba/excel/concepts/cells-and-ranges/refer-to-named-ranges\" rel=\"nofollow noreferrer\">named ranges</a> and <a href=\"https://support.office.com/en-us/article/using-structured-references-with-excel-tables-f5ed2452-2337-4f71-bed3-c8ae6d2b276e\" rel=\"nofollow noreferrer\">structured references to tables</a>."}, {"owner": {"reputation": 1, "user_id": 10260953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a85db2c065d2192072a632ee344c265?s=128&d=identicon&r=PG&f=1", "display_name": "Jess Morrone", "link": "https://stackoverflow.com/users/10260953/jess-morrone"}, "reply_to_user": {"reputation": 582, "user_id": 6896061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bf0230605ac24f5be23ea08c02dbbe5?s=128&d=identicon&r=PG", "display_name": "DavidP", "link": "https://stackoverflow.com/users/6896061/davidp"}, "edited": false, "score": 0, "creation_date": 1534970197, "post_id": 51971973, "comment_id": 90899950, "body": "@DavidP I added pictures of both sheets. We manually type in the hours worked on the shift sheets so I need a way to have excel automatically enter the new employees name in alphabetical order that doesn&#39;t require me to manually insert the row in the correct spot and that keeps the hours already recorded attached to the correct employee. Thanks for your help!"}, {"owner": {"reputation": 582, "user_id": 6896061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bf0230605ac24f5be23ea08c02dbbe5?s=128&d=identicon&r=PG", "display_name": "DavidP", "link": "https://stackoverflow.com/users/6896061/davidp"}, "edited": false, "score": 0, "creation_date": 1535052924, "post_id": 51971973, "comment_id": 90935753, "body": "I&#39;m still having trouble understanding exactly what your formula is doing since your screenshots don&#39;t have the row/column labels and it looks like they don&#39;t cover enough columns of the schedule sheet for me to see what data is being referenced. So when you add a new employee, you insert them into the middle of the schedule sheet so they&#39;re in alphabetical order, then the formula updates the employee list on the shift sheet but doesn&#39;t move the manually entered hours down, is that correct?"}, {"owner": {"reputation": 1, "user_id": 10260953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a85db2c065d2192072a632ee344c265?s=128&d=identicon&r=PG&f=1", "display_name": "Jess Morrone", "link": "https://stackoverflow.com/users/10260953/jess-morrone"}, "reply_to_user": {"reputation": 582, "user_id": 6896061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bf0230605ac24f5be23ea08c02dbbe5?s=128&d=identicon&r=PG", "display_name": "DavidP", "link": "https://stackoverflow.com/users/6896061/davidp"}, "edited": false, "score": 0, "creation_date": 1535053529, "post_id": 51971973, "comment_id": 90936038, "body": "@DavidP yes. It also removes the last name on the list because the range the formula covers doesn&#39;t automatically increase."}], "owner": {"reputation": 1, "user_id": 10260953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a85db2c065d2192072a632ee344c265?s=128&d=identicon&r=PG&f=1", "display_name": "Jess Morrone", "link": "https://stackoverflow.com/users/10260953/jess-morrone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 135, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594152393, "creation_date": 1534957845, "last_edit_date": 1594152393, "question_id": 51971973, "link": "https://stackoverflow.com/questions/51971973/excel-auto-insert-rows-when-data-range-expands", "title": "Excel auto-insert rows when data range expands", "body": "<p>I am trying to create an advanced attendance sheet for my job. We have a sheet for each shift with the names of each employee. We type hours in across the row with the employee name. We have a separate schedule sheet. Currently, I am using the formula </p>\n\n<p><code>=IFERROR(INDEX(Schedule!$A$4:$A$35,SMALL(IF($A$1=Schedule!$I$4:$I$35,ROW(Schedule!$A$4:$A$35)-3,\"\"),ROW()-2)),\"\")</code></p>\n\n<p>to generate the names of the employees who are scheduled on the shift sheets. </p>\n\n<p>As we continue to hire more employees, I need to find a way to have excel automatically insert the new name into the shift sheet in an auto-generated row so that the hours shift down with the employee and the range the formula covers automatically expands so that I do not need to create new rows to expand the bottom to show the full list.</p>\n\n<p>Can anyone help with this?</p>\n\n<p><a href=\"https://i.stack.imgur.com/vPqPo.jpg\" rel=\"nofollow noreferrer\">Shift Sheet</a>\n<a href=\"https://i.stack.imgur.com/I5Sqe.jpg\" rel=\"nofollow noreferrer\">Schedule Sheet</a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1534957063, "post_id": 51971693, "comment_id": 90894013, "body": "<code>findLastRow</code> has a <code>Tabname</code> argument..."}, {"owner": {"reputation": 925, "user_id": 9491208, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vGGz3NCqHUo/AAAAAAAAAAI/AAAAAAAABtU/QLcpa2IbJMw/photo.jpg?sz=128", "display_name": "Simo", "link": "https://stackoverflow.com/users/9491208/simo"}, "edited": false, "score": 3, "creation_date": 1534957070, "post_id": 51971693, "comment_id": 90894016, "body": "Why do you expect the code to pass a string if you didn&#39;t pass anything here? <code>Set Dimensions = findlastrow()</code>"}, {"owner": {"reputation": 925, "user_id": 9491208, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vGGz3NCqHUo/AAAAAAAAAAI/AAAAAAAABtU/QLcpa2IbJMw/photo.jpg?sz=128", "display_name": "Simo", "link": "https://stackoverflow.com/users/9491208/simo"}, "edited": false, "score": 0, "creation_date": 1534957150, "post_id": 51971693, "comment_id": 90894059, "body": "the solution could be:  <code>Function findlastrow(Optional ByVal Tabname as String) As Collection</code> By the way, to know the last row or last column you can use: <code>xlWorksheet.UsedRange.Rows.Count</code>  or <code>xlWorksheet.UsedRange.Columns.Count</code>"}, {"owner": {"reputation": 103, "user_id": 1033891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fd89420b3648e68be9a4f96b8976a70?s=128&d=identicon&r=PG", "display_name": "tengee", "link": "https://stackoverflow.com/users/1033891/tengee"}, "edited": false, "score": 0, "creation_date": 1534957259, "post_id": 51971693, "comment_id": 90894115, "body": "Couldnt really find how to do that, tried putting in the tabname variable in but did not work"}, {"owner": {"reputation": 103, "user_id": 1033891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fd89420b3648e68be9a4f96b8976a70?s=128&d=identicon&r=PG", "display_name": "tengee", "link": "https://stackoverflow.com/users/1033891/tengee"}, "reply_to_user": {"reputation": 925, "user_id": 9491208, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vGGz3NCqHUo/AAAAAAAAAAI/AAAAAAAABtU/QLcpa2IbJMw/photo.jpg?sz=128", "display_name": "Simo", "link": "https://stackoverflow.com/users/9491208/simo"}, "edited": false, "score": 0, "creation_date": 1534958988, "post_id": 51971693, "comment_id": 90894916, "body": "@simo was trying to avoid ByVal usage."}], "answers": [{"comments": [{"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1534957650, "post_id": 51971876, "comment_id": 90894319, "body": "@BigBen just noticed it and fixed it"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1534957928, "post_id": 51971876, "comment_id": 90894450, "body": "That <i>duplicate declaration</i> was going to be OP&#39;s next compile error =)"}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1534957977, "post_id": 51971876, "comment_id": 90894470, "body": "@MathieuGuindon the sub does not have <code>end sub</code> too, LOL"}, {"owner": {"reputation": 103, "user_id": 1033891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fd89420b3648e68be9a4f96b8976a70?s=128&d=identicon&r=PG", "display_name": "tengee", "link": "https://stackoverflow.com/users/1033891/tengee"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1534958257, "post_id": 51971876, "comment_id": 90894601, "body": "@MathieuGuindon if you mean the &quot;tabname as string&quot; in the function? fixed, if not can you please elaborate?"}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "reply_to_user": {"reputation": 103, "user_id": 1033891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fd89420b3648e68be9a4f96b8976a70?s=128&d=identicon&r=PG", "display_name": "tengee", "link": "https://stackoverflow.com/users/1033891/tengee"}, "edited": false, "score": 0, "creation_date": 1534958388, "post_id": 51971876, "comment_id": 90894653, "body": "@tengee I tried the code and it is working fine, you can select it as the correct answer if you don&#39;t mind"}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "reply_to_user": {"reputation": 103, "user_id": 1033891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fd89420b3648e68be9a4f96b8976a70?s=128&d=identicon&r=PG", "display_name": "tengee", "link": "https://stackoverflow.com/users/1033891/tengee"}, "edited": false, "score": 0, "creation_date": 1534958437, "post_id": 51971876, "comment_id": 90894672, "body": "@tengee I guess you don&#39;t need this line too since you are passing the sheet name to your function and there is no need to select it to make it work <code>Sheets(Tabname).Select</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 103, "user_id": 1033891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fd89420b3648e68be9a4f96b8976a70?s=128&d=identicon&r=PG", "display_name": "tengee", "link": "https://stackoverflow.com/users/1033891/tengee"}, "edited": false, "score": 1, "creation_date": 1534958772, "post_id": 51971876, "comment_id": 90894816, "body": "@tengee I mean the compiler starts at the top and chokes on the first compile error it encounters - in your case a parameterless procedure call against a procedure requiring a parameter. The next compile error was going to be the duplicate declaration of <code>Tabname</code> in the scope of <code>findLastrow</code>, which this answer fixes."}, {"owner": {"reputation": 103, "user_id": 1033891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fd89420b3648e68be9a4f96b8976a70?s=128&d=identicon&r=PG", "display_name": "tengee", "link": "https://stackoverflow.com/users/1033891/tengee"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1534958856, "post_id": 51971876, "comment_id": 90894854, "body": "@MathieuGuindon yes it makes sense. I figured whats wrong with your conments. Thank you very much for taking the time to explain!"}], "tags": [], "owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "is_accepted": true, "score": 4, "last_activity_date": 1534958841, "last_edit_date": 1534958841, "creation_date": 1534957443, "answer_id": 51971876, "question_id": 51971693, "link": "https://stackoverflow.com/questions/51971693/passing-string-values-to-function-and-returning-a-collection-object-vba/51971876#51971876", "title": "Passing string values to function and returning a collection object VBA", "body": "<p>you have defined <code>Tabname</code> as the argument for your <code>findlastrow</code> function and you have tried to define it again inside the function, you cannot do that, so </p>\n\n<p>remove this line: <code>Tabname As String</code></p>\n\n<p>and amend the sub as explained below:</p>\n\n<pre><code>Sub SheetCopier()\n\n    Dim TargetlRow As Long\n    Dim TargetlCol As Long\n    Dim Tabname As String\n\n    Dim Dimensions As Collection\n'this line is the problem since you are not passing a worksheet to the function\n    'Set Dimensions = findlastrow()\n\n TargetControlTab = \"tab1\"\n Tabname = TargetControlTab\n\n\n set Dimensions=findlastrow(Tabname) \n\n MsgBox \"Last Row: \" &amp; Dimensions.Item(1) &amp; vbNewLine &amp; \"Last Column: \" &amp; Dimensions.Item(2)\nend sub\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 1033891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fd89420b3648e68be9a4f96b8976a70?s=128&d=identicon&r=PG", "display_name": "tengee", "link": "https://stackoverflow.com/users/1033891/tengee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 483, "favorite_count": 0, "accepted_answer_id": 51971876, "answer_count": 1, "score": 2, "last_activity_date": 1534960770, "creation_date": 1534956782, "last_edit_date": 1534960770, "question_id": 51971693, "link": "https://stackoverflow.com/questions/51971693/passing-string-values-to-function-and-returning-a-collection-object-vba", "title": "Passing string values to function and returning a collection object VBA", "body": "<p>For some reason the following code is not passing a string to the function but returning the collection very well if string variables are hardcoded to the function.</p>\n\n<p>I get following error </p>\n\n<blockquote>\n  <p>Compile error: Argument not optional</p>\n</blockquote>\n\n<p>pointing to the findlastrow() in</p>\n\n<pre><code>Set Dimensions = findlastrow()  --line 8\n</code></pre>\n\n<p>Here is the code.</p>\n\n<p><strong>The main sub:</strong></p>\n\n<pre><code>Sub SheetCopier()\n\nDim TargetlRow As Long\nDim TargetlCol As Long\nDim Tabname As String\n\nDim Dimensions As Collection\nSet Dimensions = findlastrow()\n\nTargetControlTab = \"tab1\"\nTabname = TargetControlTab\n\n\nCall findlastrow(Tabname)\n\nMsgBox \"Last Row: \" &amp; Dimensions.Item(1) &amp; vbNewLine &amp; \"Last Column: \" &amp; Dimensions.Item(2)\n\nEnd Sub\n</code></pre>\n\n<p><strong>The function:</strong></p>\n\n<pre><code>   Function findlastrow(Tabname As String) As Collection\n   'Finds the last non-blank cell in a single row or column\n\n    Dim FilledDimensions As Collection\n    Set FilledDimensions = New Collection\n\n\n     Sheets(Tabname).Select\n    'Find the last non-blank cell in column A(1)\n    TargetlRow = Cells(Rows.Count, 1).End(xlUp).Row\n\n    'Find the last non-blank cell in row 1\n    TargetlCol = Cells(1, Columns.Count).End(xlToLeft).Column\n\n    FilledDimensions.Add TargetlRow\n    FilledDimensions.Add TargetlCol\n\n    Set findlastrow = FilledDimensions\n\n    End Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1534956342, "post_id": 51971514, "comment_id": 90893650, "body": "You need to set the target range or you will be in an infinite loop.<code>if target.address=&quot;$B$7&quot; then</code>"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1534956481, "post_id": 51971514, "comment_id": 90893724, "body": "Turn events off first - <code>Application.EnableEvents = False</code>, and then set it back to <code>True</code> at the end."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1534956753, "post_id": 51971514, "comment_id": 90893850, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/13860894/why-ms-excel-crashes-and-closes-during-worksheet-change-sub-procedure\">Why MS Excel crashes and closes during worksheet change sub procedure</a>"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1534957166, "post_id": 51971514, "comment_id": 90894068, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/a/50868969/6706419\">Bug on Worksheet Change</a>. #SelfPromotion"}], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 0, "last_activity_date": 1534958003, "creation_date": 1534958003, "answer_id": 51972011, "question_id": 51971514, "link": "https://stackoverflow.com/questions/51971514/clear-cell-content/51972011#51972011", "title": "Clear Cell Content", "body": "<p>Try the code below, explanations inside the code's notes:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nApplication.EnableEvents = False\n\n' make sure the cell changed is \"B7\"\nIf Not Application.Intersect(Target, Range(\"B7\")) Is Nothing Then\n    If Target.Value2 = \"Pass\" Then\n        Range(\"B8:B9\").ClearContents\n        Rows(\"8:9\").EntireRow.Hidden = True\n    Else\n        Rows(\"8:9\").EntireRow.Hidden = False\n    End If\nEnd If\n\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 5982308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/377b3335832d64b0239102d3b8f2429d?s=128&d=identicon&r=PG&f=1", "display_name": "Ultra GC", "link": "https://stackoverflow.com/users/5982308/ultra-gc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "accepted_answer_id": 51972011, "answer_count": 1, "score": 0, "last_activity_date": 1609722725, "creation_date": 1534956075, "last_edit_date": 1609722725, "question_id": 51971514, "link": "https://stackoverflow.com/questions/51971514/clear-cell-content", "title": "Clear Cell Content", "body": "<p>I have the VBA code in an Excel 2013 worksheet to hide two rows (B8:B9) when B7 selection is set to 'Pass'.  That part works.</p>\n<p><code>ClearContents</code> closes Excel without any reason.</p>\n<p>I want to clear those cell contents before/after the rows are hidden or unhidden.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Range(&quot;B7&quot;).Value &lt;&gt; &quot;Pass&quot; Then\n        Range(&quot;B8:B9&quot;).ClearContents\n        Rows(&quot;8:9&quot;).EntireRow.Hidden = True\n    Else\n        Rows(&quot;8:9&quot;).EntireRow.Hidden = False\n    End If\nEnd Sub\n</code></pre>\n<p>The B8:B9 cells are Data Validation List.</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1534956695, "post_id": 51971503, "comment_id": 90893825, "body": "If you&#39;re looking for max date and time, wouldn&#39;t it be easiest to sort descending on date, then time, then supplier, then terminal?  Then the first line of each unique entry would be your max"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1534956749, "post_id": 51971503, "comment_id": 90893848, "body": "Which, as it happens, lines up perfectly with your provided sample data which appears to be already sorted as such."}, {"owner": {"reputation": 227, "user_id": 987332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/159a2e83b2aef8a6d892bdef43901343?s=128&d=identicon&r=PG", "display_name": "Lars Hovden", "link": "https://stackoverflow.com/users/987332/lars-hovden"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1534965333, "post_id": 51971503, "comment_id": 90897788, "body": "Would it help if I share my file in Zoho Reports so you can see it?"}], "owner": {"reputation": 227, "user_id": 987332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/159a2e83b2aef8a6d892bdef43901343?s=128&d=identicon&r=PG", "display_name": "Lars Hovden", "link": "https://stackoverflow.com/users/987332/lars-hovden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594152413, "creation_date": 1534956016, "last_edit_date": 1594152413, "question_id": 51971503, "link": "https://stackoverflow.com/questions/51971503/find-max-with-multiple-criteria", "title": "Find Max with multiple criteria", "body": "<p>I am trying to either filter or create another column to return the max date so I can filter on that column. There are 4 columns I am trying to use as criteria. My data looks like this.</p>\n\n<pre><code>Date      Time     Supplier     Terminal     Cost\n8/21/18   1800        43           4         2.35\n8/21/18   1030         3           5         2.27 \n8/21/18   1045        43           4         2.25\n8/20/18   1800         3           4         2.30\n8/20/18   1800         3           5         2.37\n</code></pre>\n\n<p>I think the best way to filter is to create another column to return the max date and time for each supplier terminal combo. I want the data to be return like this. This was I can filter on True</p>\n\n<pre><code> Date      Time     Supplier     Terminal     Cost     MaxValue\n8/21/18   1800        43           4         2.35        True\n8/21/18   1030         3           5         2.27        True\n8/21/18   1045        43           4         2.25        False\n8/20/18   1800         3           4         2.30        True\n8/20/18   1800         3           5         2.37        False\n</code></pre>\n\n<p>Is something like this possible? Or could it be done using VBA?\nThanks in advance!</p>\n\n<p>Update: Here is a link to the excel data that can be copied an pasted into excel </p>\n\n<p><a href=\"https://ethercalc.org/9xyxloijh5y9.html\" rel=\"nofollow noreferrer\">https://ethercalc.org/9xyxloijh5y9.html</a></p>\n\n<p>The order in which I'm looking to match and find Max is a follows: Terminal>Product>Date>Time</p>\n\n<p>With that I will have the latest date/cost for each supplier for each product per terminal. Hopefully seeing the data will help.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 1, "creation_date": 1534956020, "post_id": 51971468, "comment_id": 90893485, "body": "Please, post only the piece of code with error - no need for all the code..."}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1534956151, "post_id": 51971468, "comment_id": 90893544, "body": "Which line errors out?"}, {"owner": {"reputation": 1, "user_id": 10048570, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3aRl0-72Ns4/AAAAAAAAAAI/AAAAAAAAAJg/90-r4SaK4uY/photo.jpg?sz=128", "display_name": "Talha Rasheed", "link": "https://stackoverflow.com/users/10048570/talha-rasheed"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1534956202, "post_id": 51971468, "comment_id": 90893569, "body": "@JohnyL It&#39;s Line 144 Col 1"}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1534956248, "post_id": 51971468, "comment_id": 90893593, "body": "<i>Line 144</i> You want us to count the lines? :)"}, {"owner": {"reputation": 1, "user_id": 10048570, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3aRl0-72Ns4/AAAAAAAAAAI/AAAAAAAAAJg/90-r4SaK4uY/photo.jpg?sz=128", "display_name": "Talha Rasheed", "link": "https://stackoverflow.com/users/10048570/talha-rasheed"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1534956427, "post_id": 51971468, "comment_id": 90893695, "body": "@JohnyL Sorry:)"}, {"owner": {"reputation": 1, "user_id": 10048570, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3aRl0-72Ns4/AAAAAAAAAAI/AAAAAAAAAJg/90-r4SaK4uY/photo.jpg?sz=128", "display_name": "Talha Rasheed", "link": "https://stackoverflow.com/users/10048570/talha-rasheed"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1534956442, "post_id": 51971468, "comment_id": 90893703, "body": "@JohnyL Description of Line 144: &quot;wsW.Cells(c, wc).Value = wsD.Cells(var.Row, dc).Value&quot;"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1534956852, "post_id": 51971468, "comment_id": 90893899, "body": "What happens if you can&#39;t find the value you&#39;re looking for when you set <code>var</code>?  I&#39;m going to bet that when you get that error, if you did <code>debug.print var.address</code> before that line, you&#39;ll error because <code>var</code> didn&#39;t find a match."}, {"owner": {"reputation": 1, "user_id": 10048570, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3aRl0-72Ns4/AAAAAAAAAAI/AAAAAAAAAJg/90-r4SaK4uY/photo.jpg?sz=128", "display_name": "Talha Rasheed", "link": "https://stackoverflow.com/users/10048570/talha-rasheed"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1534957609, "post_id": 51971468, "comment_id": 90894300, "body": "@BruceWayne can you please edit the code in the Answer?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1534957740, "post_id": 51971468, "comment_id": 90894372, "body": "What answer? I am suggesting a way to add that to your current code to test it."}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1534957750, "post_id": 51971468, "comment_id": 90894376, "body": "You set <code>var</code> variable, but do not check whether it&#39;s <code>Nothing</code> or not. Check in debug mode whether it is so."}], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1534958229, "creation_date": 1534958229, "answer_id": 51972068, "question_id": 51971468, "link": "https://stackoverflow.com/questions/51971468/object-variable-or-with-block-variable-not-set-error-coming/51972068#51972068", "title": "\u201cObject variable or with block variable not set\u201d Error coming", "body": "<p>What @BruceWayne was suggesting, is you need to verify <code>Find</code> function was successful before using it later on.</p>\n\n<pre><code>Set Var = wsD.Range(\"A3\").CurrentRegion.Columns(1).Find(ws.Range(col &amp; w).Offset(0, 1), , xlValues, xlPart, , , False)\n\nIf Not Var Is Nothing Then ' &lt;-- make sure Find function was able to find a match\n    ' rest of your code goes here\n\nElse\n    ' raise an error message\n    MsgBox \"Unable to find \" &amp; ws.Range(col &amp; w).Offset(0, 1) &amp; \" in the range specified\", vbCritical, \"Error!\"\nEnd If\n</code></pre>\n\n<hr>\n\n<p>Also, you can change your multiple <code>If</code> with <code>And</code> to <code>If</code> and <code>Select Case</code>, like in the code below:</p>\n\n<pre><code>If wbW.Name = ws.Range(\"A2\") &amp; \".xlsx\" Then\n\n    Select Case WbD.Name ' using Select case can clear and simpify your code\n        Case ws.Range(\"A4\") &amp; \".xlsx\"\n            col = \"D\"\n\n        Case ws.Range(\"A5\") &amp; \".xlsx\"\n            col = \"G\"\n\n        Case ws.Range(\"A6\") &amp; \".xlsx\"\n            col = \"J\"\n\n        Case ws.Range(\"A7\") &amp; \".xlsx\"\n            col = \"MD\"\n\n        Case ws.Range(\"A8\") &amp; \".xlsx\"\n            col = \"P\"\n\n    End Select\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10048570, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3aRl0-72Ns4/AAAAAAAAAAI/AAAAAAAAAJg/90-r4SaK4uY/photo.jpg?sz=128", "display_name": "Talha Rasheed", "link": "https://stackoverflow.com/users/10048570/talha-rasheed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594152432, "creation_date": 1534955921, "last_edit_date": 1594152432, "question_id": 51971468, "link": "https://stackoverflow.com/questions/51971468/object-variable-or-with-block-variable-not-set-error-coming", "title": "\u201cObject variable or with block variable not set\u201d Error coming", "body": "<p><strong>I'm running my code to find data from a workbook and synchronizing it with another workbook and upon running macro, I am receiving this error. Can anyone please help? Thanks</strong></p>\n\n<p>I'm running my code to find data from a workbook and synchronizing it with another workbook and upon running macro, I am receiving this error. Can anyone please help? Thanks</p>\n\n<p>I'm running my code to find data from a workbook and synchronizing it with another workbook and upon running macro, I am receiving this error. Can anyone please help? Thanks</p>\n\n<p><img src=\"https://i.stack.imgur.com/RVbuY.jpg\" alt=\"IMG1\"></p>\n\n<pre><code>Sub FindData(wbW As Workbook, WbD As Workbook, ByVal dCol As Long)\n    Dim wSh As Long\n    Dim dSh As Long\n    Dim w As Long, d As Long, c As Long\n    Dim col As String\n    Dim co As String\n    Dim ws As Worksheet\n    Dim var As Range, coCl As Range\n    Dim lastColD As Long, lastColW As Long, lastRowW\n    Dim wsW As Worksheet, wsD As Worksheet\n    Dim dc As Long, wc As Long\n    Set ws = ThisWorkbook.Worksheets(1)\n    Debug.Print WbD.Name\n    Debug.Print wbW.Name\n    If wbW.Name = ws.Range(\"A2\") &amp; \".xlsx\" And WbD.Name = ws.Range(\"A4\") &amp; \".xlsx\" Then\n      col = \"D\"\n    Else\n      If wbW.Name = ws.Range(\"A2\") &amp; \".xlsx\" And WbD.Name = ws.Range(\"A5\") &amp; \".xlsx\" Then\n        col = \"G\"\n      Else\n        If wbW.Name = ws.Range(\"A2\") &amp; \".xlsx\" And WbD.Name = ws.Range(\"A6\") &amp; \".xlsx\" Then\n          col = \"J\"\n        Else\n          If wbW.Name = ws.Range(\"A3\") &amp; \".xlsx\" And WbD.Name = ws.Range(\"A7\") &amp; \".xlsx\" Then\n            col = \"M\"\n          Else\n            If wbW.Name = ws.Range(\"A3\") &amp; \".xlsx\" And WbD.Name = ws.Range(\"A8\") &amp; \".xlsx\" Then\n              col = \"P\"\n            End If\n          End If\n        End If\n      End If\n    End If\n    wSh = ws.Range(col &amp; 1).End(xlDown).Row\n    dSh = WbD.Worksheets.Count\n    For w = 3 To wSh        'Working file sheets listed in macro workbook Sheet1\n      Set wsW = wbW.Worksheets(ws.Range(col &amp; w).Value)\n      lastColW = wsW.Cells(2, wsW.Columns.Count).End(xlToLeft).Column\n      lastRowW = wsW.Cells(wsW.Rows.Count, 2).End(xlUp).Row\n      For c = 5 To lastRowW       'Companies in working file\n        co = wsW.Range(\"B\" &amp; c)\n        For d = 1 To dSh    'Data worksheet\n          Set coCl = Nothing\n          Set wsD = WbD.Worksheets(d)\n          If wsD.Range(\"A1\") = co Then\n             Set coCl = wsD.Range(\"A1\")\n          Else\n            If wsD.Range(\"A2\") = co Then\n              Set coCl = wsD.Range(\"A2\")\n            End If\n          End If\n          If Not coCl Is Nothing Then\n            lastColD = wsD.Cells(coCl.Offset(1, 0).Row, wsD.Columns.Count).End(xlToLeft).Column\n    '        If WbD.Name = \"2005-2010.xlsx\" Then\n    '          yr = \"5-10\"\n    '        End If\n            If lastColD = 1 Then\n              lastColD = wsD.Cells(coCl.Offset(2, 0).Row, wsD.Columns.Count).End(xlToLeft).Column\n              Set coCl = coCl.Offset(1, 0)\n            End If\n            Set var = wsD.Range(\"A3\").CurrentRegion.Columns(1).Find(ws.Range(col &amp; w).Offset(0, 1), , xlValues, xlPart, , , False)\n            'Debug.Print wsD.Name\n            For dc = 2 To lastColD\n              For wc = 5 To lastColW\n                'Debug.Print wsD.Cells(coCl.Offset(1, 0).Row, dc).Value\n                'Debug.Print wsW.Cells(2, wc).Value\n                If wsD.Cells(coCl.Offset(1, 0).Row, dc).Value = wsW.Cells(2, wc).Value Then\n                'wsD.Range(wsD.Cells(var.Row, 2), wsD.Cells(var.Row, lastColD)).Copy Destination:=wsW.Cells(c, dCol)\n    '              Debug.Print wsD.Name\n    '              Debug.Print wsD.Cells(var.Row, dc).Value\n                  wsW.Cells(c, wc).Value = wsD.Cells(var.Row, dc).Value\n                End If\n              Next\n            Next\n            Exit For\n          End If\n\n        Next\n      Next\n    Next\n    'Debug.Print WbD.Name\n    'Debug.Print wbW.Name\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 3, "creation_date": 1534956606, "post_id": 51971348, "comment_id": 90893785, "body": "FYI, VBA has the built-in <code>ISNUMERIC()</code> function. No need for the worksheetfunction <code>ISNUMBER()</code>."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1534956794, "post_id": 51971348, "comment_id": 90893873, "body": "It is also applied in the sheet as an array formula no? So not sure if that means you need to treat it differently in the above."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 3, "creation_date": 1534956821, "post_id": 51971348, "comment_id": 90893888, "body": "@BruceWayne <a href=\"https://stackoverflow.com/q/51549786/1188513\">they don&#39;t do the same thing at all though</a>"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1534957107, "post_id": 51971348, "comment_id": 90894031, "body": "@MathieuGuindon - Oh!  Woah! I didn&#39;t know that, thanks so much for pointing that out."}, {"owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1534958265, "post_id": 51971348, "comment_id": 90894606, "body": "@QHarr What do you mean? I  don&#39;t use array formulas here. All I use is the given code."}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1534959049, "post_id": 51971348, "comment_id": 90894948, "body": "@Ans why do you want to use worksheet functions or formulas if you are going to use VBA already? maybe if you explain what your final goal is we can come up with better ideas"}, {"owner": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "edited": false, "score": 0, "creation_date": 1534963591, "post_id": 51971348, "comment_id": 90896981, "body": "Just thought I&#39;d mention that INDEX/ISNUMBER/SEARCH actually returns an array, and that INDEX is used in this case simply to allow the formula to be confirmed with just ENTER, instead of CTRL+SHIFT+ENTER."}], "answers": [{"tags": [], "owner": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "is_accepted": false, "score": 1, "last_activity_date": 1534962987, "creation_date": 1534962987, "answer_id": 51973169, "question_id": 51971348, "link": "https://stackoverflow.com/questions/51971348/application-worksheetfunction-search-and-isnumber-dont-work-in-vba-type-misma/51973169#51973169", "title": "Application.WorksheetFunction.Search and .IsNumber don&#39;t work in VBA: type mismatch error; fixing match function character limit", "body": "<p><code>WorksheetFunction</code> produces a breaking error when an error occurs.  Instead, use the Match method of the Application object.  Actually, you can avoid <code>WorksheetFunction</code> altogether.</p>\n\n<pre><code>Sub test()\n\n    Dim KEY_CONTRACT_ROW As Variant\n    Dim rngSearchRange As Range\n\n    'Define the search range as to avoid a whole column reference\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n        Set rngSearchRange = Application.Intersect(.UsedRange, .Range(\"A:A\"))\n    End With\n\n    'Search for the specified search string\n    With Application\n        KEY_CONTRACT_ROW = .Match(True, .IsNumber(.Search(\"testing string\", rngSearchRange)), 0)\n    End With\n\n    'Check whether a match was found\n    If IsError(KEY_CONTRACT_ROW) Then\n        MsgBox \"Match not found!\", vbExclamation\n    Else\n        MsgBox \"Match found!\", vbExclamation\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 681, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1534962987, "creation_date": 1534955398, "last_edit_date": 1534955916, "question_id": 51971348, "link": "https://stackoverflow.com/questions/51971348/application-worksheetfunction-search-and-isnumber-dont-work-in-vba-type-misma", "title": "Application.WorksheetFunction.Search and .IsNumber don&#39;t work in VBA: type mismatch error; fixing match function character limit", "body": "<p>I'm trying to work around the <code>MATCH</code>'s function's character limit using <a href=\"https://stackoverflow.com/a/20504620\">this answer</a>:</p>\n\n<blockquote>\n  <p>=MATCH(TRUE,INDEX(ISNUMBER(SEARCH(A2,Dict!A:A)),0),0))</p>\n</blockquote>\n\n<p>I tried the full version:</p>\n\n<pre><code>Sub test\n\n  Dim KEY_CONTRACT_ROW As Variant\n  KEY_CONTRACT_ROW = _\n            Application.WorksheetFunction.Match(True, _\nApplication.WorksheetFunction.Index(Application.WorksheetFunction.IsNumber(Application.WorksheetFunction.Search(\"testing string\", _\n                ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A:A\"))), 0), 0)\n\nEnd Sub\n</code></pre>\n\n<p>It didn't work - <code>Type mismatch error</code>.</p>\n\n<p>So I tried the shorter version:</p>\n\n<pre><code>Sub test\n\n  MsgBox (Application.WorksheetFunction.IsNumber(Application.WorksheetFunction.Search(\"testing string\", _\n                ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A:A\"))))\n\nEnd Sub\n</code></pre>\n\n<p>To the same result. At the same time when I use this formula manually on worksheet it works fine.</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1534955900, "post_id": 51971257, "comment_id": 90893413, "body": "You can sum everything and then subtract the exclusions that you want"}], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 10210525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4030dd1b1bfea81d3fa842fe92bd2eb?s=128&d=identicon&r=PG&f=1", "display_name": "Valborg", "link": "https://stackoverflow.com/users/10210525/valborg"}, "edited": false, "score": 0, "creation_date": 1534956758, "post_id": 51971518, "comment_id": 90893855, "body": "This is just giving me the value of the last row and the last column from &quot;Wage&quot;, I need to sum the total of everything from c2 to the end of the data."}, {"owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "reply_to_user": {"reputation": 79, "user_id": 10210525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4030dd1b1bfea81d3fa842fe92bd2eb?s=128&d=identicon&r=PG&f=1", "display_name": "Valborg", "link": "https://stackoverflow.com/users/10210525/valborg"}, "edited": false, "score": 0, "creation_date": 1534957233, "post_id": 51971518, "comment_id": 90894101, "body": "@Valborg My bad just realized my mistake, the answer is updated"}], "tags": [], "owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "is_accepted": true, "score": 1, "last_activity_date": 1534957701, "last_edit_date": 1534957701, "creation_date": 1534956099, "answer_id": 51971518, "question_id": 51971257, "link": "https://stackoverflow.com/questions/51971257/sum-a-range-from-another-worksheet/51971518#51971518", "title": "Sum a range from another worksheet", "body": "<p>Check out this link <a href=\"https://stackoverflow.com/questions/37491625/using-sum-in-vba\">Using SUM() in VBA</a></p>\n\n<p>You can use that idea to change your code to:</p>\n\n<pre><code>Dim lastCol As Long\nDim lastRow As Long\n\nlastCol = Sheets(\"Wage\").Cells(1, Sheets(\"Wage\").Columns.Count).End(xlToLeft).Column\nlastRow = Sheets(\"Wage\").Cells(Sheets(\"Wage\").Rows.Count, 1).End(xlUp).Row\n\nRange(\"A1\").Value = \"Wage Totals\"\nRange(\"A2\").Value = WorksheetFunction.Sum(Sheets(\"Wage\").Range(Sheets(\"Wage\").Cells(2, 3), Sheets(\"Wage\").Cells(lastRow, lastCol))) \n</code></pre>\n\n<p>This is pretty naive solution tho becuase it assumes the usedrange limits can be found by looking for last used row on Col \"A\" and last used col on Row 1. You can change that method of finding the limits.</p>\n"}], "owner": {"reputation": 79, "user_id": 10210525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4030dd1b1bfea81d3fa842fe92bd2eb?s=128&d=identicon&r=PG&f=1", "display_name": "Valborg", "link": "https://stackoverflow.com/users/10210525/valborg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 51971518, "answer_count": 1, "score": 0, "last_activity_date": 1534957701, "creation_date": 1534955116, "last_edit_date": 1534955865, "question_id": 51971257, "link": "https://stackoverflow.com/questions/51971257/sum-a-range-from-another-worksheet", "title": "Sum a range from another worksheet", "body": "<p>I'm trying to get this cell to total a range from another worksheet but I keep getting stuck. The range rows and columns vary but the starting point is always C2. I need to total from C2 to the rest of the used range (aka exclude columns A and B as well as row 1 but include everything else).</p>\n\n<p>Please help if you can.</p>\n\n<pre><code>Range(\"A1\").Formula = \"Wage Totals\"\nRange(\"A2\").Formula = \"=SUM(\" &amp; ActiveWorkbook.Sheets(\"Wage\").Range(Cells(2, 3), Cells.SpecialCells(xlCellTypeLastCell)).Address(False, False) &amp; \")\"\n</code></pre>\n"}, {"tags": ["sql", "ms-access", "vba"], "comments": [{"owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 0, "creation_date": 1534957203, "post_id": 51971063, "comment_id": 90894087, "body": "The database update doesn&#39;t take place until the active record on the form changes, right? Can you add VBA that updates all the other fields in your SQL statement <i>on the form</i> (not in the database, yet) and then allow the form manager to actually update the underlying record at the correct time?"}, {"owner": {"reputation": 5, "user_id": 10255424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d0174ab7055b503bb61019707077e0c?s=128&d=identicon&r=PG&f=1", "display_name": "Jared H", "link": "https://stackoverflow.com/users/10255424/jared-h"}, "reply_to_user": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 1, "creation_date": 1534959597, "post_id": 51971063, "comment_id": 90895200, "body": "I&#39;ve been toying with that idea, but I&#39;m not sure how that would look. Like I said VBA is not my strong suit. So far I&#39;ve gotten away with using SQL language in VBA, but this seems like it would be structured differently. Am I wrong in this assumption?"}, {"owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 0, "creation_date": 1534959699, "post_id": 51971063, "comment_id": 90895246, "body": "You need to learn VBA if you want a robust front-end. I have many desktop apps running in Access and there&#39;s no way to avoid writing some code. Lots of code."}, {"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1534967802, "post_id": 51971063, "comment_id": 90898880, "body": "why do you want to  update the table again? your form does this automatically for you?"}, {"owner": {"reputation": 5, "user_id": 10255424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d0174ab7055b503bb61019707077e0c?s=128&d=identicon&r=PG&f=1", "display_name": "Jared H", "link": "https://stackoverflow.com/users/10255424/jared-h"}, "edited": false, "score": 0, "creation_date": 1534968608, "post_id": 51971063, "comment_id": 90899203, "body": "The field that I am wanting to update is meant to be automatically calculated and populated when the user enters a  high value item in the &#39;Cost&#39; field. The query I wrote worked just with a write conflict. nicomp sparked a thought though and I figured out the solution. I needed to add &#39;me.dirty = false&#39; prior to the update statement to get access to ignore the first update and take the second. After I did this it runs perfectly."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 1, "creation_date": 1534975580, "post_id": 51971063, "comment_id": 90902027, "body": "If <code>Capitolasset</code>is not changed later, you can just calculate it in the forms query. <code>SELECT Cost &gt;= 5000 as Capitolasset, COST  FROM dbo_Purchasing</code> or use a table trigger (<code>dbo_</code>suggest that Sql Server is used) . if you store the treshold (5000) in a table or constant it is easy to change for all occurencies."}, {"owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "reply_to_user": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1534978009, "post_id": 51971063, "comment_id": 90902644, "body": "@computerVersteher , yep, it&#39;s a normalization problem. Good catch."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 10255424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d0174ab7055b503bb61019707077e0c?s=128&d=identicon&r=PG&f=1", "display_name": "Jared H", "link": "https://stackoverflow.com/users/10255424/jared-h"}, "edited": false, "score": 0, "creation_date": 1535035978, "post_id": 51975966, "comment_id": 90926801, "body": "This is a great solution, and much less clunky than using the &#39;me.dirty&#39; command in front of my SQL script thank you!"}], "tags": [], "owner": {"reputation": 3725, "user_id": 6777839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YYN3g.jpg?s=128&g=1", "display_name": "Wolfgang Kais", "link": "https://stackoverflow.com/users/6777839/wolfgang-kais"}, "is_accepted": true, "score": 0, "last_activity_date": 1534976623, "creation_date": 1534976623, "answer_id": 51975966, "question_id": 51971063, "link": "https://stackoverflow.com/questions/51971063/how-to-make-a-field-in-access-show-the-current-value-in-the-table-and-accept-in/51975966#51975966", "title": "How to make a field in access show the current value in the table, and accept input, but not update the table", "body": "<p>It seems that you are trying to set the <code>Capitolasset</code> flag of the current record to <code>-1</code> if the <code>Cost</code> entered is <code>&gt;= 5000</code>. If so, you don't need to run an extra query, just update the <code>Capitolasset</code> value according to the <code>Cost</code> entered:</p>\n\n<pre><code>Private Sub Cost_AfterUpdate()\n\n    If IsNumeric(Me.Cost) Then\n        If Me.Cost &gt;= 5000 Then\n            Me.Capitolasset = -1\n        Else\n            Me.Capitolasset = 0\n        End If\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>This will update the field before the record is saved.</p>\n"}], "owner": {"reputation": 5, "user_id": 10255424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d0174ab7055b503bb61019707077e0c?s=128&d=identicon&r=PG&f=1", "display_name": "Jared H", "link": "https://stackoverflow.com/users/10255424/jared-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 236, "favorite_count": 0, "accepted_answer_id": 51975966, "answer_count": 1, "score": 0, "last_activity_date": 1534976623, "creation_date": 1534954421, "last_edit_date": 1534954894, "question_id": 51971063, "link": "https://stackoverflow.com/questions/51971063/how-to-make-a-field-in-access-show-the-current-value-in-the-table-and-accept-in", "title": "How to make a field in access show the current value in the table, and accept input, but not update the table", "body": "<p>I have been tasked with designing an Access front end for a SQL database I built. Unfortunately my VBA and Access knowledge are not as strong as they should be and I have run into a roadblock. </p>\n\n<p>Currently I'm working on a script that will identify and flag high dollar assets that are entered into the database through the form. I have the update code written, but when I enter in a high value in the field the act of updating the value in the form and the update script itself clash and there is a 'Write Conflict'. </p>\n\n<p>I can unbind the field in the form and that resoles the write conflict, but then the user first browsing to the record won't see the current value in the table. </p>\n\n<p><strong>My question</strong>: is there a way to have a field in a form show the value in a table, accept input, but not write the input to the table and leave the writing to the update query. If it helps I have included the update action I have written.</p>\n\n<pre><code>Private Sub Cost_AfterUpdate()\n\n    Dim CostCheck As String\n    CostCheck = \"Update dbo_Purchasing SET Capitolasset =  -1, COST = \" &amp;       Me.Cost &amp; \" \" &amp; _\n                \"Where itemMaster = \" &amp; Me.ItemMaster &amp; \" and \" &amp; Me.Cost &amp; \" &gt;= \" &amp; 5000 &amp; \"\"\n\n    DoCmd.RunSQL CostCheck\n    Me.Refresh\nEnd Sub\n</code></pre>\n"}, {"tags": ["php", "vba", "excel", "shell", "command-line-arguments"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1534954921, "post_id": 51971040, "comment_id": 90892864, "body": "How does php.exe know where to find those two files? You might consider passing the full paths (and don&#39;t for get the quote the paths if they might contain spaces)"}, {"owner": {"reputation": 20643, "user_id": 3684882, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ff8NL.jpg?s=128&g=1", "display_name": "ArtisticPhoenix", "link": "https://stackoverflow.com/users/3684882/artisticphoenix"}, "edited": false, "score": 0, "creation_date": 1534954931, "post_id": 51971040, "comment_id": 90892873, "body": "set your PHP path environmental value, then you can just call php without the path.  That probably wont solve the problem but it will make life easier."}, {"owner": {"reputation": 17, "user_id": 10256290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e1508ff7b0132ef6e1eea39bd5dbdeb?s=128&d=identicon&r=PG&f=1", "display_name": "Learner04390", "link": "https://stackoverflow.com/users/10256290/learner04390"}, "edited": false, "score": 0, "creation_date": 1534955046, "post_id": 51971040, "comment_id": 90892932, "body": "@TimWilliams- they are all located within the same directory. How would I include the full paths? Sorry, I&#39;m very very new to this."}, {"owner": {"reputation": 17, "user_id": 10256290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e1508ff7b0132ef6e1eea39bd5dbdeb?s=128&d=identicon&r=PG&f=1", "display_name": "Learner04390", "link": "https://stackoverflow.com/users/10256290/learner04390"}, "reply_to_user": {"reputation": 20643, "user_id": 3684882, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ff8NL.jpg?s=128&g=1", "display_name": "ArtisticPhoenix", "link": "https://stackoverflow.com/users/3684882/artisticphoenix"}, "edited": false, "score": 0, "creation_date": 1534955555, "post_id": 51971040, "comment_id": 90893218, "body": "@ArtisticPhoenix - At the moment, I don&#39;t have admin access to this computer, so I can&#39;t change those values."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1534955602, "post_id": 51971040, "comment_id": 90893246, "body": "&quot;same directory&quot; as what - the executable, or your workbook?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1534955648, "post_id": 51971040, "comment_id": 90893271, "body": "Also - you need a space before the &quot;/G&quot; switch"}, {"owner": {"reputation": 17, "user_id": 10256290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e1508ff7b0132ef6e1eea39bd5dbdeb?s=128&d=identicon&r=PG&f=1", "display_name": "Learner04390", "link": "https://stackoverflow.com/users/10256290/learner04390"}, "edited": false, "score": 0, "creation_date": 1534955663, "post_id": 51971040, "comment_id": 90893285, "body": "The executable. I&#39;ve added the space."}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1534956453, "post_id": 51971040, "comment_id": 90893713, "body": "Why not host the PHP online, run the VBA and add a GET parameter at the end of the PHP filename, then in the PHP program you use the GET to read the Json file?"}, {"owner": {"reputation": 17, "user_id": 10256290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e1508ff7b0132ef6e1eea39bd5dbdeb?s=128&d=identicon&r=PG&f=1", "display_name": "Learner04390", "link": "https://stackoverflow.com/users/10256290/learner04390"}, "reply_to_user": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1534957687, "post_id": 51971040, "comment_id": 90894342, "body": "@Andreas I appreciate the suggestion but that is far beyond my skill level."}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1534958692, "post_id": 51971040, "comment_id": 90894787, "body": "As far as I can see it looks like a simpler solution than your current. Do you have a place on the web to host? Using GET is as simple adding <code>?key=value</code> at the end of the url."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 10256290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e1508ff7b0132ef6e1eea39bd5dbdeb?s=128&d=identicon&r=PG&f=1", "display_name": "Learner04390", "link": "https://stackoverflow.com/users/10256290/learner04390"}, "edited": false, "score": 0, "creation_date": 1534957578, "post_id": 51971555, "comment_id": 90894291, "body": "Incredible, I am in awe of your skills. That worked perfectly. My only concern now is to include a loop that will cycle through each value in column G, beginning with 2, until the value is blank. I tried coding it in myself but I ended up creating an infinite loop. How would I do that using your method? Thank you so much!"}, {"owner": {"reputation": 17, "user_id": 10256290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e1508ff7b0132ef6e1eea39bd5dbdeb?s=128&d=identicon&r=PG&f=1", "display_name": "Learner04390", "link": "https://stackoverflow.com/users/10256290/learner04390"}, "edited": false, "score": 0, "creation_date": 1534960846, "post_id": 51971555, "comment_id": 90895782, "body": "Nevermind, I figured it out myself. I had just coded the end value improperly. Thanks again, I will mark your answer correct."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 17, "user_id": 10256290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e1508ff7b0132ef6e1eea39bd5dbdeb?s=128&d=identicon&r=PG&f=1", "display_name": "Learner04390", "link": "https://stackoverflow.com/users/10256290/learner04390"}, "edited": false, "score": 0, "creation_date": 1534963736, "post_id": 51971555, "comment_id": 90897046, "body": "FYI there are good libraries for parsing JSON in VBA.  E.g this one is very easy to use:  <a href=\"https://github.com/VBA-tools/VBA-JSON\" rel=\"nofollow noreferrer\">github.com/VBA-tools/VBA-JSON</a>"}, {"owner": {"reputation": 17, "user_id": 10256290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e1508ff7b0132ef6e1eea39bd5dbdeb?s=128&d=identicon&r=PG&f=1", "display_name": "Learner04390", "link": "https://stackoverflow.com/users/10256290/learner04390"}, "edited": false, "score": 0, "creation_date": 1534965119, "post_id": 51971555, "comment_id": 90897694, "body": "Thanks! I&#39;ll look into it when I have a chance."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1534956228, "creation_date": 1534956228, "answer_id": 51971555, "question_id": 51971040, "link": "https://stackoverflow.com/questions/51971040/how-to-write-a-vba-shell-script-to-run-a-php-script-on-variable-files/51971555#51971555", "title": "How to Write a VBA Shell Script to Run a PHP Script on Variable Files", "body": "<p>Here's how I'd do this:</p>\n\n<pre><code>Const PHP_PATH As String = \"C:\\Users\\myusername\\Desktop\\XAMPP\\php\\\"\nDim strProg As Variant\n\nstrProg = \"\"\"{pth}php.exe\"\" \"\"{pth}transcript.php\"\" \"\"{pth}\" &amp; _\n          Range(\"G2\").Value &amp; \"\"\" \\G\"\n\nstrProg = Replace(strProg, \"{pth}\", PHP_PATH)\nDebug.Print strProg '&lt;&lt; pass this to Shell\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 10256290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e1508ff7b0132ef6e1eea39bd5dbdeb?s=128&d=identicon&r=PG&f=1", "display_name": "Learner04390", "link": "https://stackoverflow.com/users/10256290/learner04390"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 980, "favorite_count": 0, "accepted_answer_id": 51971555, "answer_count": 1, "score": 0, "last_activity_date": 1534956228, "creation_date": 1534954346, "last_edit_date": 1534954781, "question_id": 51971040, "link": "https://stackoverflow.com/questions/51971040/how-to-write-a-vba-shell-script-to-run-a-php-script-on-variable-files", "title": "How to Write a VBA Shell Script to Run a PHP Script on Variable Files", "body": "<p>I'm trying to write a shell script that will run a PHP script on a number of files at once (this requires using an exe file and a php file on a json file). The json file is the only one that is variable in this situation.</p>\n\n<p>If I were using the command prompt manually, here's the command I would need to input to achieve the desired result-</p>\n\n<pre><code>C:/Users/myusername/Desktop/XAMPP/php/php.exe transcript.php transcribedfile.json\n</code></pre>\n\n<p>Cell G2 of my worksheet contains the json filename, so that's why I've activated it in the second line. Once I can get the shell script to work I will code in a loop that will cycle through all values in the G column, beginning with G2, until the ActiveCell value is \"\".</p>\n\n<p>Here's what I've tried-</p>\n\n<pre><code>Sub Shell()\nRange(\"G2\").Activate\nDim strProgramName As String\nDim strArgument As String\n\nstrProgramName = \"C:\\Users\\myusername\\Desktop\\XAMPP\\php\\php.exe transcript.php \" &amp; ActiveCell.Value\nstrArgument = \"/G\"\n\nCall Shell(\"\"\"\" &amp; strProgramName &amp; \"\"\" \"\"\" &amp; strArgument &amp; \"\"\"\", vbNormalFocus)\n\nEnd Sub\n</code></pre>\n\n<p>When I run the sub I get a \"File Not Found\" error. I tested strProgramName and found that I could get php.exe to run if I cut the code off at that point, but I would need it to recognize the whole string.</p>\n\n<p>Any ideas would be welcome. Thank you in advance.</p>\n"}, {"tags": ["excel", "vba", "vbscript"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 9671441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dba1f76c5710c6833de8b28ba50dbf5?s=128&d=identicon&r=PG&f=1", "display_name": "JoCee Porter", "link": "https://stackoverflow.com/users/9671441/jocee-porter"}, "is_accepted": true, "score": 0, "last_activity_date": 1534955605, "creation_date": 1534955605, "answer_id": 51971392, "question_id": 51970833, "link": "https://stackoverflow.com/questions/51970833/running-excel-macro-from-vbscript-subscript-out-of-range/51971392#51971392", "title": "Running Excel Macro from VBScript Subscript out of range", "body": "<p>I found this work around to open the workbook so that the sheet existed and wasn't out of range </p>\n\n<pre><code>dim xlApp, xlBook\nSet xlApp = CreateObject(\"Excel.Application\")\n\nset xlBook = xlApp.Workbooks.open(\"C:\\Users\\jporter8\\Documents\\dashboard\\testing.xlsm\", 0, true)\nxlApp.Run \"Module1.print_Test\"\nxlApp.DisplayAlerts = True\nwscript.echo \"Printed\"\nxlBook.Close\nxlApp.Quit\nset xlApp = Nothing\nset xlBook = Nothing\nwscript.echo \"Finished\"\nwscript.Quit\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9671441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dba1f76c5710c6833de8b28ba50dbf5?s=128&d=identicon&r=PG&f=1", "display_name": "JoCee Porter", "link": "https://stackoverflow.com/users/9671441/jocee-porter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 51971392, "answer_count": 1, "score": 0, "last_activity_date": 1594152305, "creation_date": 1534953617, "last_edit_date": 1594152305, "question_id": 51970833, "link": "https://stackoverflow.com/questions/51970833/running-excel-macro-from-vbscript-subscript-out-of-range", "title": "Running Excel Macro from VBScript Subscript out of range", "body": "<p>I am trying to print a file from a vbs script, and I am getting a subscript out of range. The macro works great when ran from excel.</p>\n\n<p>The VBS script is:</p>\n\n<pre><code>   dim xlApp    \n    Set xlApp = CreateObject(\"Excel.Application\")   \n    xlApp.Application.Run \"'C:\\Users\\jporter8\\Documents\\dashboard\\testing.xlsm'!Module1.print_Test\"     \n    xlApp.DisplayAlerts = True     \n    xlApp.Application.quit  \n    set xlApp = Nothing\n</code></pre>\n\n<p>and the excel macro is:</p>\n\n<pre><code>Sub print_Test()\n     Sheets(\"two\").PrintOut Copies:=1, Collate:=True, IgnorePrintAreas:=False\n    MsgBox \"Print successful\"\nEnd Sub\n</code></pre>\n\n<p>And the sheet I am trying to print is named \"two\"</p>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 1, "creation_date": 1534953741, "post_id": 51970818, "comment_id": 90892143, "body": "It sounds to me like you should instead run this inside of Excel and just query the Access database to get the filenames"}, {"owner": {"reputation": 1, "user_id": 10260649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8e83bed654e4f6b94d215c5a7ac4b4c?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/10260649/chris"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1534954377, "post_id": 51970818, "comment_id": 90892518, "body": "I want to be able to kick everything off with one task in task scheduler.  Depending on the report, some might be run daily, weekly, or just monthly."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 1, "creation_date": 1534954496, "post_id": 51970818, "comment_id": 90892586, "body": "I think I would still recommend Excel be the &#39;main&#39; application for this, but here&#39;s some reading to consider for task scheduling macros <a href=\"https://stackoverflow.com/questions/22771185/how-to-set-recurring-schedule-for-xlsm-file-using-windows-task-scheduler\" title=\"how to set recurring schedule for xlsm file using windows task scheduler\">stackoverflow.com/questions/22771185/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 10260649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8e83bed654e4f6b94d215c5a7ac4b4c?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/10260649/chris"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1534955923, "post_id": 51970818, "comment_id": 90893433, "body": "thanks. i&#39;ll keep that in mind.  I have over 50 different reports and a variety of different versions as well that I need to run and they vary with regards to which days they need to run. Trying to avoid setting up a large amount of tasks to complete this. Will be harder to manage 100 or so reports eventually."}], "owner": {"reputation": 1, "user_id": 10260649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8e83bed654e4f6b94d215c5a7ac4b4c?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/10260649/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594630685, "creation_date": 1534953551, "last_edit_date": 1594630685, "question_id": 51970818, "link": "https://stackoverflow.com/questions/51970818/getting-file-path-in-access-to-open-and-for-the-report-contained-within-to-run", "title": "getting file path in access to open and for the report contained within to run", "body": "<p>I have an access database where I have multiple records that have different file paths that are linked to individual reports that are in excel.  I need to have Access open, then for each report/file path to open in excel and for the code within the excel spreadsheet to run.  I know that I can use task manager to get Access to open but how do I get access to open each excel file, allow for the excel file to run the code, close, go on to the next and continue until all the reports have run and then finally close Access?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 1, "creation_date": 1534953928, "post_id": 51970710, "comment_id": 90892254, "body": "Welcome to StackOverflow - this is actually a really common question, so I would recommend you research around on google to find what you&#39;re looking for. Here&#39;s a start <a href=\"https://www.rondebruin.nl/win/s9/win005.htm\" rel=\"nofollow noreferrer\">rondebruin.nl/win/s9/win005.htm</a>"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 10260603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b393f295af4311795df4dce647e8a84?s=128&d=identicon&r=PG&f=1", "display_name": "Lucas Wayne", "link": "https://stackoverflow.com/users/10260603/lucas-wayne"}, "edited": false, "score": 0, "creation_date": 1535040165, "post_id": 51982457, "comment_id": 90929449, "body": "Thats really really good Smartini! Really appreciate your help! One extra thing, the data from which the cells will be copied changes everytime, i.e. I can&#39;t save the macro there, if I saved it in the Personal Macro Workbook, is there a way to set the first workbook as whichever workbook from which the macro has been run?"}, {"owner": {"reputation": 170, "user_id": 9121235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e481ddd5d81db5e202bde36a65652d21?s=128&d=identicon&r=PG&f=1", "display_name": "smartini", "link": "https://stackoverflow.com/users/9121235/smartini"}, "reply_to_user": {"reputation": 21, "user_id": 10260603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b393f295af4311795df4dce647e8a84?s=128&d=identicon&r=PG&f=1", "display_name": "Lucas Wayne", "link": "https://stackoverflow.com/users/10260603/lucas-wayne"}, "edited": false, "score": 0, "creation_date": 1535104358, "post_id": 51982457, "comment_id": 90952781, "body": "I don&#39;t quite get your question. You can add this code into your personal workbooks in excel, which opens (hidden) automatically after starting Excel each time - you mean that, right? the VBA code will copy all the date from the activesheet. you can open whatever Source Excel you have, in the background the Personal xlsb is opened as well, and you can switch to the source Excel, run the macro and everything will be copied to the Excel Workbook writting in the Code. You can also add a &quot;FilePicker&quot; if you do not want the Destination to be fixed."}], "tags": [], "owner": {"reputation": 170, "user_id": 9121235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e481ddd5d81db5e202bde36a65652d21?s=128&d=identicon&r=PG&f=1", "display_name": "smartini", "link": "https://stackoverflow.com/users/9121235/smartini"}, "is_accepted": false, "score": 0, "last_activity_date": 1535016308, "creation_date": 1535016308, "answer_id": 51982457, "question_id": 51970710, "link": "https://stackoverflow.com/questions/51970710/copy-cells-from-open-workbook-into-another/51982457#51982457", "title": "Copy cells from open workbook into another", "body": "<p>Paste this Code into a new Module in the VBA Editor of the Workbook which has the Source Data (Open VBA Editor: ALT+F11) and run the Macro \"CopyToAnotherWorkbook\".</p>\n\n<p>before running, specify the Destination Workbook Path, hint is in the code.</p>\n\n<pre><code>Sub CopyToAnotherWorkbook()\n\nApplication.ScreenUpdating = False\n\nDim wb As Workbook: Set wb = ThisWorkbook\nDim ws As Worksheet: Set ws = wb.ActiveSheet\nDim LastRow_wb%: LastRow_wb = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row\nDim arr() As Variant\nReDim arr(0 To LastRow_wb - 1)\n\nFor i = 1 To LastRow_wb\n    arr(i - 1) = ws.Cells(i, 1)\nNext i\n\nDim wb2 As Workbook: Set wb2 = Workbooks.Open(\"C:\\Book2.xlsx\") ' &lt;- Paste your Link to the Workbook here!\n\nDim ws2 As Worksheet: Set ws2 = wb2.Sheets(1)\nDim LastRow_wb2%: LastRow_wb2 = ws2.Cells(ws2.Rows.Count, \"A\").End(xlUp).Row + 1\n\nIf LastRow_wb2 = 2 Then\n    LastRow_wb2 = 1\nEnd If\n\nws2.Range(\"A\" &amp; LastRow_wb2 &amp; \":A\" &amp; LastRow_wb2 + UBound(arr)).Value = WorksheetFunction.Transpose(arr)\n\nApplication.ScreenUpdating = True\nwb2.Close True\nSet ws2 = Nothing\nSet wb2 = Nothing\nSet ws = Nothing\nSet wb = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 10260603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b393f295af4311795df4dce647e8a84?s=128&d=identicon&r=PG&f=1", "display_name": "Lucas Wayne", "link": "https://stackoverflow.com/users/10260603/lucas-wayne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 341, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1597669926, "creation_date": 1534953214, "last_edit_date": 1597669926, "question_id": 51970710, "link": "https://stackoverflow.com/questions/51970710/copy-cells-from-open-workbook-into-another", "title": "Copy cells from open workbook into another", "body": "<p>In my first active workbook, column A has a list of numbers, starting in cell A1, and listing down a varied number of rows each time.</p>\n<p>I would like to copy all of the column A cells containing information into another workbook (if the second workbook could remain closed during the process that would be preferable).</p>\n<p>My desired paste location in the second workbook would be column A in the first empty row available. i.e. I want this second workbook to be a list of all of the data column A of the first workbook has ever had.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1534953257, "post_id": 51970633, "comment_id": 90891845, "body": "Lrow will just be a number, not the row.  SO you need to say <code>Worksheets(&quot;MainDataBase&quot;).row(lrow)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": true, "score": 1, "last_activity_date": 1534953271, "creation_date": 1534953271, "answer_id": 51970726, "question_id": 51970633, "link": "https://stackoverflow.com/questions/51970633/last-row-and-offset-combination/51970726#51970726", "title": "Last Row and Offset Combination", "body": "<pre><code>With MDB\n    .Range(\"A\" &amp; LRow).Offset(1, 0).Value = \n    .Range(\"A\" &amp; LRow).Offset(0, 1).Value =\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1534953640, "creation_date": 1534953640, "answer_id": 51970844, "question_id": 51970633, "link": "https://stackoverflow.com/questions/51970633/last-row-and-offset-combination/51970844#51970844", "title": "Last Row and Offset Combination", "body": "<p>Lrow will just be a number, not the row. SO you need to say <code>Worksheets(\"MainDataBase\").row(lrow)</code></p>\n"}], "owner": {"reputation": 83, "user_id": 8505098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c0fef8d3bc3416d1f92817b306ea3d1?s=128&d=identicon&r=PG&f=1", "display_name": "Khazar", "link": "https://stackoverflow.com/users/8505098/khazar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 51970726, "answer_count": 2, "score": 0, "last_activity_date": 1534953640, "creation_date": 1534952965, "last_edit_date": 1534953199, "question_id": 51970633, "link": "https://stackoverflow.com/questions/51970633/last-row-and-offset-combination", "title": "Last Row and Offset Combination", "body": "<p>I cant find out what is problem with this code. when I run it I got compile error for LRow. I would be grateful if you help. Thanks in advance.</p>\n\n<pre><code>Dim NameTxb As String\nDim DateTxb As Date\nDim WYSTxb As Date\nDim WYETxb As Date\nDim DivCmb As String\nDim PosCmb As String\nDim VacCmb As Integer\nDim Add1Cmb As Integer\nDim Add2Cmb As Integer\nDim MDB As Worksheet:                   Set MDB = ThisWorkbook.Worksheets(\"MainDataBase\")\nDim LRow As Long:                       LRow = MDB.Cells(MDB.Rows.Count, \"A\").End(xlUp).Row\n\nWith Worksheets(\"MainDataBase\").LRow\n        LRow.Offset(1, 0).Value = AddWorker.NameTxb.Value\n        LRow.Offset(0, 1).Value = AddWorker.DivCmb.Value\n        LRow.Offset(0, 2).Value = AddWorker.PosCmb.Value\n        LRow.Offset(0, 3).Value = AddWorker.DateTxb.Value\n        LRow.Offset(0, 4).Value = AddWorker.WYSTxb.Value\n        LRow.Offset(0, 5).Value = AddWorker.WYETxb.Value\n        LRow.Offset(0, 6).Value = AddWorker.VacCmb.Value\n        LRow.Offset(0, 7).Value = AddWorker.Add1Cmb.Value\n        LRow.Offset(0, 7).Value = AddWorker.Add2Cmb.Value\n</code></pre>\n\n<p>End With\nEnd sub</p>\n"}, {"tags": ["database", "ms-access", "vba", "ms-access-2016", "ms-access-forms"], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 10167297, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-zKP6vp1SfOI/AAAAAAAAAAI/AAAAAAAAAFQ/7HrKOqiPNgY/photo.jpg?sz=128", "display_name": "BoatHouse", "link": "https://stackoverflow.com/users/10167297/boathouse"}, "edited": false, "score": 0, "creation_date": 1534960497, "post_id": 51970695, "comment_id": 90895632, "body": "Thanks for answering my question. as for your question: I tried having a set list of values I entered and updating the list every time it said &quot;This value is not in the list, would you like to update the list items?&quot;. I am not very good with access or VBA as I just started using them  I also tried your code and it didn&#39;t seem to change the organization list table. My current table has &quot;N/A&quot; as its one and only value (because it is the default). after typing &quot;test&quot; the only value in the table was &quot;N/A&quot;"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 57, "user_id": 10167297, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-zKP6vp1SfOI/AAAAAAAAAAI/AAAAAAAAAFQ/7HrKOqiPNgY/photo.jpg?sz=128", "display_name": "BoatHouse", "link": "https://stackoverflow.com/users/10167297/boathouse"}, "edited": false, "score": 0, "creation_date": 1535013631, "post_id": 51970695, "comment_id": 90912840, "body": "I guess the first thing to check is whether the code actually executes - put a break point in the code by clicking in the border to the left of the line of code you&#39;re breaking on (a dot should appear in the border with the line of code highlighted).  If the code fires it will pause on that line - press F8 to step through the code line by line.  Hover your cursor over the <code>NewData</code> variable - does it show the value you entered?"}, {"owner": {"reputation": 57, "user_id": 10167297, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-zKP6vp1SfOI/AAAAAAAAAAI/AAAAAAAAAFQ/7HrKOqiPNgY/photo.jpg?sz=128", "display_name": "BoatHouse", "link": "https://stackoverflow.com/users/10167297/boathouse"}, "edited": false, "score": 0, "creation_date": 1535045394, "post_id": 51970695, "comment_id": 90932194, "body": "Should the window with the code appear when I have a breakpoint? when adding a unique value, the code window does not appear"}, {"owner": {"reputation": 57, "user_id": 10167297, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-zKP6vp1SfOI/AAAAAAAAAAI/AAAAAAAAAFQ/7HrKOqiPNgY/photo.jpg?sz=128", "display_name": "BoatHouse", "link": "https://stackoverflow.com/users/10167297/boathouse"}, "edited": false, "score": 0, "creation_date": 1535046635, "post_id": 51970695, "comment_id": 90932841, "body": "I made a mistake. I forget to change the limit to list to &quot;Yes&quot;. After doing that, the code breaks at &quot;.SetWarnings False&quot; what could be wrong here? I do have the breakpoint set at .RunSQL &quot;INSERT INTO [Organization list](Organizations) VALUES (&#39;&quot; &amp; NewData &amp; &quot;&#39;)&quot; the error box says &quot;Run-time error &#39;424&#39;: Object required"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 57, "user_id": 10167297, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-zKP6vp1SfOI/AAAAAAAAAAI/AAAAAAAAAFQ/7HrKOqiPNgY/photo.jpg?sz=128", "display_name": "BoatHouse", "link": "https://stackoverflow.com/users/10167297/boathouse"}, "edited": false, "score": 0, "creation_date": 1535049698, "post_id": 51970695, "comment_id": 90934300, "body": "Not at my computer so can&#39;t test. You do have the <code>With DoCmd</code> before it? Try commenting out the two <code>.SetWarnings</code> lines (add a <code>&#39;</code> at the start of the line). They just stop the query confirmation messages from appearing.  Hopefully the value gets added then we can worry about the warnings."}, {"owner": {"reputation": 57, "user_id": 10167297, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-zKP6vp1SfOI/AAAAAAAAAAI/AAAAAAAAAFQ/7HrKOqiPNgY/photo.jpg?sz=128", "display_name": "BoatHouse", "link": "https://stackoverflow.com/users/10167297/boathouse"}, "edited": false, "score": 1, "creation_date": 1535049940, "post_id": 51970695, "comment_id": 90934399, "body": "Good lord, I spelled &quot;Do&quot; as &quot;Co&quot;. The value does show up in the table now. Thank you"}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 0, "last_activity_date": 1534953179, "creation_date": 1534953179, "answer_id": 51970695, "question_id": 51970544, "link": "https://stackoverflow.com/questions/51970544/how-to-populate-a-table-of-lookups-using-not-in-list/51970695#51970695", "title": "how to populate a table of lookups using &quot;Not in list&quot;", "body": "<p>Make sure the <code>Limit To List</code> property of the combo-box is set to <code>Yes</code>.  </p>\n\n<p>Add a <code>On Not In List</code> event to insert the value to your source table when a new value appears:  </p>\n\n<pre><code>Private Sub MyComboBox_NotInList(NewData As String, Response As Integer)\n\n    With DoCmd\n        .SetWarnings False\n        .RunSQL \"INSERT INTO [Organization List](Organizations) VALUES ('\" &amp; NewData &amp; \"')\"\n        Response = acDataErrAdded\n        .SetWarnings True\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Edit... nearly forgot... before I answer, what have you tried? :)  </p>\n\n<p>Edit 2... the example given is for a string value.  Remove the <code>'</code> from either side of <code>New Data</code> if it's a numeric value (but probably not if it's an organisation name).  </p>\n\n<p>Edit 3... The <code>INSERT</code> SQL is just one way of putting data into a table.  You may prefer the <code>RecordSet.Add</code> and <code>.Update</code> methods.</p>\n"}], "owner": {"reputation": 57, "user_id": 10167297, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-zKP6vp1SfOI/AAAAAAAAAAI/AAAAAAAAAFQ/7HrKOqiPNgY/photo.jpg?sz=128", "display_name": "BoatHouse", "link": "https://stackoverflow.com/users/10167297/boathouse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 51970695, "answer_count": 1, "score": 0, "last_activity_date": 1534953179, "creation_date": 1534952669, "question_id": 51970544, "link": "https://stackoverflow.com/questions/51970544/how-to-populate-a-table-of-lookups-using-not-in-list", "title": "how to populate a table of lookups using &quot;Not in list&quot;", "body": "<p>Table 1: My general information table</p>\n\n<ul>\n<li>Organization: A lookup/relationship field that defaults to \"N/A\" but pulls values from...</li>\n</ul>\n\n<p>Table 2: Organization List</p>\n\n<ul>\n<li>No ID field, just the names of the organizations in the order which they were added</li>\n</ul>\n\n<p>My data entry form has a combo box for organization and I would like it to update when I add an organization that hasn't been added before. I know I am supposed to use the \"Not in List\" event, but I don't know how to update the Organization list using this event. How do I do this?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 0, "creation_date": 1534952444, "post_id": 51970397, "comment_id": 90891338, "body": "have a look at <a href=\"https://stackoverflow.com/questions/51093274/range-vs-cells-vs-range-cells\">SO: Range() vs Cells() vs Range.Cells()</a> as there are answers on there that may help"}, {"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 0, "creation_date": 1534952491, "post_id": 51970397, "comment_id": 90891366, "body": "also see <a href=\"https://www.makeuseof.com/tag/excel-cells-vs-range-functions-vba/\" rel=\"nofollow noreferrer\">Understanding Excel Cells vs. Range Functions in VBA</a>"}, {"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 0, "creation_date": 1534952525, "post_id": 51970397, "comment_id": 90891391, "body": "Possible duplicate of  <a href=\"https://stackoverflow.com/questions/51093274/range-vs-cells-vs-range-cells\">SO: Range() vs Cells() vs Range.Cells()</a>"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1534952859, "post_id": 51970397, "comment_id": 90891605, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/25879619/whats-the-difference-between-range-item-and-range-cells\">What&#39;s the difference between Range.Item and Range.Cells?</a>"}, {"owner": {"reputation": 283, "user_id": 10239691, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lqDop.jpg?s=128&g=1", "display_name": "GeekyFreaky", "link": "https://stackoverflow.com/users/10239691/geekyfreaky"}, "edited": false, "score": 0, "creation_date": 1534953670, "post_id": 51970397, "comment_id": 90892094, "body": "Thanks, everyone, but none of the articles clarified it for me. Is there anyone who can just answer the questions I asked with Yes or No - and then explain? LOL"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1534954209, "post_id": 51970397, "comment_id": 90892419, "body": "No. <code>Range.Item(x, y)</code> returns a <code>Variant</code>. If you need a <code>Range</code>, use <code>Cells</code> so it doesn&#39;t need to be un-boxed into an object."}], "answers": [{"comments": [{"owner": {"reputation": 283, "user_id": 10239691, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lqDop.jpg?s=128&g=1", "display_name": "GeekyFreaky", "link": "https://stackoverflow.com/users/10239691/geekyfreaky"}, "edited": false, "score": 0, "creation_date": 1534955763, "post_id": 51971058, "comment_id": 90893349, "body": "OMG, thank you for this wonderful explanation. I get it! Mathieu, you rock. You answered my last question too.^^"}, {"owner": {"reputation": 283, "user_id": 10239691, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lqDop.jpg?s=128&g=1", "display_name": "GeekyFreaky", "link": "https://stackoverflow.com/users/10239691/geekyfreaky"}, "edited": false, "score": 0, "creation_date": 1534965007, "post_id": 51971058, "comment_id": 90897632, "body": "foo = Sheet1.Range(&quot;A1:A10&quot;)(1) - is that not supposed to have a period before (1)?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 283, "user_id": 10239691, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lqDop.jpg?s=128&g=1", "display_name": "GeekyFreaky", "link": "https://stackoverflow.com/users/10239691/geekyfreaky"}, "edited": false, "score": 1, "creation_date": 1534965154, "post_id": 51971058, "comment_id": 90897706, "body": "@GeekyFreaky no, because the dot (aka dereferencing oeprator) would warrant an explicit member call immediately after it. Since the member call is implicit, there&#39;s no dot. With the dot that would be <code>Sheet1.Range(&quot;A1:A10&quot;).Item(1)</code>, or <code>.Cells(1)</code>. <code>Sheet1.Range(&quot;A1:A10&quot;)</code> returns a <code>Range</code> object, so you can legally make an implicit default member call directly against it. Now whether that&#39;s a good idea is another story ;-)"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 5, "last_activity_date": 1534955597, "last_edit_date": 1534955597, "creation_date": 1534954402, "answer_id": 51971058, "question_id": 51970397, "link": "https://stackoverflow.com/questions/51970397/trying-to-understand-the-difference-between-the-use-of-item-property-and-cells-p/51971058#51971058", "title": "Trying to understand the difference between the use of Item property and Cells property on a Range object", "body": "<p><code>Range</code> is a <em>class</em>. Classes are <em>blueprints</em> for <em>objects</em> - an object is an <em>instance</em> of a class.</p>\n\n<p>Now, classes in VBA can have a <em>default property</em>. If you export a class module, you can give them <em>member attributes</em>. The <code>VB_UserMemId</code> attribute, with a value of <code>0</code>, identifies a member as that class' <em>default member</em> - you can't edit member attributes directly in the VBE, but you can export the module, add the attribute, and re-import the module into the project.</p>\n\n<p>A <em>default property</em> might look something like this:</p>\n\n<pre><code>Option Explicit\nPrivate mFoo As Bar\n\nPublic Property Get Foo() As Bar\n    Attribute Foo.VB_UserMemId = 0\n    Set Foo = mFoo\nEnd Property\n</code></pre>\n\n<p>There are a number of possible <code>VB_UserMemId</code> values you can use, but only one member of a class can have any given value - <code>0</code> makes it that class' default member.</p>\n\n<p>Default members allow you to write <em>implicit code</em> - whether that's a good thing or not is a judgement call.</p>\n\n<p>For example when you want to access the item at index <code>i</code> of a <code>Collection</code>, you can do this:</p>\n\n<pre><code>foo = myCollection.Item(i)\n</code></pre>\n\n<p>But since <code>Item</code> is the <em>default property</em> of the <code>Collection</code> class, you can also do this:</p>\n\n<pre><code>foo = myCollection(i)\n</code></pre>\n\n<p>And the result is exactly the same.</p>\n\n<p>The <code>Range</code> class is... a <em>special</em> animal. If you look at its definition in the <em>Object Browser</em>, you'll find that its <em>default property</em> is a hidden property named <code>_Default</code>, which is commonly inferred to return <code>Range.Value</code> - because this implicit default member call:</p>\n\n<pre><code>foo = Sheet1.Range(\"A1\")\n</code></pre>\n\n<p>Is equivalent to this explicit code:</p>\n\n<pre><code>foo = Sheet1.Range(\"A1\").Value\n</code></pre>\n\n<p>The <code>Item</code> property of the <code>Range</code> class is <em>not</em> the default member. However if you look at the definition of that hidden <code>_Default</code> property, you'll see that it accepts two optional parameters:</p>\n\n<p><img src=\"https://i.stack.imgur.com/Z3uE7.png\" alt=\"Property _Default({RowIndex},{ColumnIndex})\"></p>\n\n<p>So this is also legal:</p>\n\n<pre><code>foo = Sheet1.Range(\"A1:A10\")(1)\n</code></pre>\n\n<p>And equivalent to this:</p>\n\n<pre><code>foo = Sheet1.Range(\"A1:A10\").Item(1).Value\n</code></pre>\n\n<p>Basically, the <code>Range</code> class' default property is implemented in such a way that it does one thing if no parameters are specified (gives you the <code>Value</code>.. which itself returns either the cell's value, or a 2D variant array if the range contains multiple cells), and another thing if parameters <em>are</em> specified (gives you the <code>Item</code> at the specified row/column within that range).</p>\n\n<p>So this is why <code>Range(\"A1:A10\").Cells</code> (without parameters) is redundant: it yields the exact same cells as <code>Range(\"A1:A10\")</code> does.</p>\n\n<p>The <code>Cells</code> property isn't parameterized:</p>\n\n<p><img src=\"https://i.stack.imgur.com/WIbfv.png\" alt=\"Property Cells As Range\"></p>\n\n<p>So VBA programmers invoking <code>Range.Cells</code> with parameters, are in fact invoking <code>Range._Default</code> with these parameters, against the range returned by <code>Cells</code>... which means <code>Range(\"A1:A10\").Cells(1)</code> is effectively <code>Range(\"A1:A10\").Cells.Item(1)</code>... which involves a redundant call to <code>Cells</code>.</p>\n\n<p>The parameterized <code>Cells[._Default][.Item](1)</code> syntax is therefore a mere convenience; it's mostly a readability thing... and then there's <em>IntelliSense</em>: <code>Item</code> returns a <code>Variant</code>, which means you don't get that nice little dropdown of available members when you type the <code>.</code> dot/dereferencing operator after it (the call is \"late-bound\", i.e. the type involved is resolved at run-time) - but you do when you invoke <code>Cells</code>, because <code>Cells</code> returns an early-bound <code>Range</code> object (i.e. resolved at compile-time).</p>\n\n<p>Best-practice is to <em>write code that does what it says, and says what it does</em> - so you will <em>generally</em> want to <em>avoid</em> implicit default member calls. However in the case of a <code>Range</code> this conflicts with another best-practice, i.e. <em>write compile-time validated, early-bound code whenever possible</em> - using <code>Cells</code> instead of <code>Item</code> gives you that.</p>\n"}], "owner": {"reputation": 283, "user_id": 10239691, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lqDop.jpg?s=128&g=1", "display_name": "GeekyFreaky", "link": "https://stackoverflow.com/users/10239691/geekyfreaky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 51971058, "answer_count": 1, "score": 1, "last_activity_date": 1534957520, "creation_date": 1534952217, "last_edit_date": 1534957520, "question_id": 51970397, "link": "https://stackoverflow.com/questions/51970397/trying-to-understand-the-difference-between-the-use-of-item-property-and-cells-p", "title": "Trying to understand the difference between the use of Item property and Cells property on a Range object", "body": "<p>I understand:</p>\n\n<ul>\n<li><p><code>Range.Item</code> <em>returns a Range object that represents a range at an offset to the specified range</em>.</p></li>\n<li><p><code>Range.Cells</code> <em>returns a Range object that represents the cells in the specified range</em>.</p></li>\n</ul>\n\n<p>However, the confusion sets in when I read that <em>\"Item is a default property of the <code>Range</code> object\"</em>. </p>\n\n<p>This leads me to ask:</p>\n\n<p>Is <code>Range(\"A1:D5\").Cells(1,1)</code> really a simplified version of\n<code>Range(\"A1:D5\").Cells.Item(1,1)</code>?</p>\n\n<p>And why not just use <code>Range(\"A1:D5\").Item(1,1)</code> in any case?</p>\n\n<p>Why does it seem that VBA programmers use the <code>Cells</code> property to reference ranges instead of the <code>Item</code> property? Is it \"best practice\" to just omit the <code>Item</code> default property in favor of <code>Cells</code>?</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 3, "creation_date": 1534952080, "post_id": 51970204, "comment_id": 90891152, "body": "What is <code>olApp</code>? Your code is in <code>ThisOutlookSession</code>, but that line&#39;s syntax reflects how you would reference a folder if you were working an instance of Outlook (<code>olApp</code>) from Excel VBA, for example."}, {"owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "edited": false, "score": 0, "creation_date": 1534959757, "post_id": 51970204, "comment_id": 90895272, "body": "Not sure if you do, but If you have admin priviledges you can achieve this via setting a rule on owa"}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1538243323, "post_id": 51970204, "comment_id": 92078615, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/9076634/get-reference-to-additional-inbox\">Get reference to additional Inbox</a>"}], "owner": {"reputation": 239, "user_id": 8150532, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/89dec06313f6bbc60ebe2f35b6fd0608?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/8150532/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1592943236, "creation_date": 1534951567, "last_edit_date": 1592943236, "question_id": 51970204, "link": "https://stackoverflow.com/questions/51970204/vba-script-to-move-messages-with-certain-subject-in-outlook-shared-mailbox-recei", "title": "Vba script to move messages with certain subject in outlook shared mailbox receives error &#39;Object required&#39;", "body": "<p>I am trying to write a macro that moves any incoming message with a certain subject (\"test\" in this case) to a different folder. The whole thing is supposed to happen in a shared mailbox.</p>\n\n<p>I am receiving an 'object required' error on this line : </p>\n\n<pre><code>Set objDestFolder = olApp.GetNamespace(\"MAPI\").Folders(\"Digital Office\").Folders(\"Inbox\").Folders(moveFolder) '\n</code></pre>\n\n<p>What I have so far: </p>\n\n<p><strong>First off saved in a module this is to find a folder in a non default mailbox:</strong></p>\n\n<pre><code>' Use the GetFolderPath function to find a folder in non-default mailboxes\nFunction GetFolderPath(ByVal FolderPath As String) As Outlook.Folder\n    Dim oFolder As Outlook.Folder\n    Dim FoldersArray As Variant\n    Dim i As Integer\n\n    On Error GoTo GetFolderPath_Error\n    If Left(FolderPath, 2) = \"\\\\\" Then\n        FolderPath = Right(FolderPath, Len(FolderPath) - 2)\n    End If\n    'Convert folderpath to array\n    FoldersArray = Split(FolderPath, \"\\\")\n    Set oFolder = Application.Session.Folders.Item(FoldersArray(0))\n    If Not oFolder Is Nothing Then\n        For i = 1 To UBound(FoldersArray, 1)\n            Dim SubFolders As Outlook.Folders\n            Set SubFolders = oFolder.Folders\n            Set oFolder = SubFolders.Item(FoldersArray(i))\n            If oFolder Is Nothing Then\n                Set GetFolderPath = Nothing\n            End If\n        Next\n    End If\n    'Return the oFolder\n    Set GetFolderPath = oFolder\n    Exit Function\n\nGetFolderPath_Error:\n    Set GetFolderPath = Nothing\n    Exit Function\nEnd Function\n</code></pre>\n\n<p><strong>Then I have this code in \"ThisOutlookSession\":</strong></p>\n\n<pre><code>Dim i As Long\nPrivate WithEvents olInboxItems As Items\n\nPrivate Sub Application_Startup()\n  Dim objNS As NameSpace\n  Set objNS = Application.Session\n  Set olInboxItems = GetFolderPath(\"Digital Office\\Inbox\").Items\nSet objNS = Nothing\nEnd Sub\n\nPrivate Sub olInboxItems_ItemAdd(ByVal Item As Object)\n\n    Dim objDestFolder As Outlook.MAPIFolder\n    Dim moveFolder As String\n\n    If Item.Subject = \"test\" Then\n\n\n    moveFolder = \"Test\"\n\n\nSet objDestFolder = olApp.GetNamespace(\"MAPI\").Folders(\"Digital Office\").Folders(\"Inbox\").Folders(moveFolder) ' Destination Folder\n  Item.Move objDestFolder\n        End If\n\n        Err.Clear\n\n Set objDestFolder = Nothing\n End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1, "user_id": 10260473, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0eK4J2cyLR4/AAAAAAAAAAI/AAAAAAAAAOk/bRdBldmXhfI/photo.jpg?sz=128", "display_name": "Krithika Srinivasan", "link": "https://stackoverflow.com/users/10260473/krithika-srinivasan"}, "edited": false, "score": 0, "creation_date": 1534950992, "post_id": 51970004, "comment_id": 90890505, "body": "If the file is not found- I want it to continue with the rest of the list."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1534952599, "post_id": 51970004, "comment_id": 90891441, "body": "Is the list of numbers changing? Are the files always located on your desktop? Is the naming convention for the files alway RGA # &lt;xxx&gt;? Are the file we are talking about alway excel files? I assume because you say the data is located in F10 or F11. How do I know when it&#39;s F10 or F11? So by the numbers of the questions I have I think you should add moire information to your post and maybe it is also a good idea to show what you have tried so far."}], "answers": [{"tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": false, "score": 0, "last_activity_date": 1534953925, "creation_date": 1534953925, "answer_id": 51970915, "question_id": 51970004, "link": "https://stackoverflow.com/questions/51970004/excel-vba-to-extract-data-from-multiple-excel-files/51970915#51970915", "title": "Excel VBA: to extract data from multiple excel files", "body": "<p>I used the following function from <a href=\"http://spreadsheetpage.com/index.php/tip/a_vba_function_to_get_a_value_from_a_closed_file/\" rel=\"nofollow noreferrer\">here</a></p>\n\n<pre><code>Private Function GetValue(path, file, sheet, ref)\n'   Retrieves a value from a closed workbook\nDim arg As String\n    '   Make sure the file exists\n    If Right(path, 1) &lt;&gt; \"\\\" Then path = path &amp; \"\\\"\n    If Dir(path &amp; file) = \"\" Then\n        GetValue = \"File Not Found\"\n        Exit Function\n    End If\n    '   Create the argument\n    arg = \"'\" &amp; path &amp; \"[\" &amp; file &amp; \"]\" &amp; sheet &amp; \"'!\" &amp; _\n          Range(ref).Range(\"A1\").Address(, , xlR1C1)\n    '   Execute an XLM macro\n    GetValue = ExecuteExcel4Macro(arg)\nEnd Function\n</code></pre>\n\n<p>Then I made the following assumptions i) the return numbers are in column A ii) the file naming convention is always RGA # 625.XLSX  iii) the data is alway on sheet1 in F10</p>\n\n<pre><code>Sub GetData_for_ReturnNumbers()\n\nConst DATA_DIR = \"&lt;put your directory here&gt;\"\nConst COL_RETNR = 1\nConst FILE_START = \"RGA # \"\nConst FILE_EXT = \".XLSX\"\nConst SHEET1 = \"Sheet1\"\nDim sngCell As Range\nDim filename As String\nDim rg As Range\n    Set rg = Range(\"A2:A4\")\n\n    For Each sngCell In rg\n        filename = FILE_START &amp; sngCell.Value &amp; FILE_EXT\n        sngCell.Offset(, 1) = GetValue(DATA_DIR, filename, SHEET1, \"F10\")\n    Next\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/pfaV7.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pfaV7.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 10260473, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0eK4J2cyLR4/AAAAAAAAAAI/AAAAAAAAAOk/bRdBldmXhfI/photo.jpg?sz=128", "display_name": "Krithika Srinivasan", "link": "https://stackoverflow.com/users/10260473/krithika-srinivasan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 631, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1594030734, "creation_date": 1534950906, "last_edit_date": 1594030734, "question_id": 51970004, "link": "https://stackoverflow.com/questions/51970004/excel-vba-to-extract-data-from-multiple-excel-files", "title": "Excel VBA: to extract data from multiple excel files", "body": "<p>I have a list of numbers in an excel sheet. These are return numbers and all these have an associated file on my desktop. For example- the number 625 has an excel file RGA # 625 on my desktop. There are 800ish numbers like this; how do I pull one detail for each of these numbers from the respective excel files?</p>\n\n<p>Desired Output\n635  <strong>372883</strong>\n625  <strong>273232</strong>\n743  <strong>323724</strong></p>\n\n<p>The second column should be extracted from the separate excel files. The location of that number will either be F10 or F11 in those files.</p>\n"}, {"tags": ["sql", "ms-access", "vba"], "comments": [{"owner": {"reputation": 433, "user_id": 10164553, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8D4Wn0r0S6M/AAAAAAAAAAI/AAAAAAAAAEg/3MGKwcFTJhI/photo.jpg?sz=128", "display_name": "RazorKillBen", "link": "https://stackoverflow.com/users/10164553/razorkillben"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1534952485, "post_id": 51969985, "comment_id": 90891361, "body": "@Andre I&#39;m not I&#39;m afraid Andre, or I&#39;d have not asked the question! Are you able to elaborate on it&#39;s use in this scenario?"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1534953278, "post_id": 51969985, "comment_id": 90891854, "body": "I don&#39;t understand what you are asking. You have data in a table, and want to edit it. This is usually done with bound forms. No code is necessary."}, {"owner": {"reputation": 433, "user_id": 10164553, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8D4Wn0r0S6M/AAAAAAAAAAI/AAAAAAAAAEg/3MGKwcFTJhI/photo.jpg?sz=128", "display_name": "RazorKillBen", "link": "https://stackoverflow.com/users/10164553/razorkillben"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1534953792, "post_id": 51969985, "comment_id": 90892176, "body": "Sorry, I didn&#39;t mean to use the word edit there; just to clarify this isn&#39;t to edit a record in a table. I need to display the 4 names in 4 separate text boxes that are locked and enabled is set to False. To do this I need a variable assigned to each result in the row."}], "owner": {"reputation": 433, "user_id": 10164553, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8D4Wn0r0S6M/AAAAAAAAAAI/AAAAAAAAAEg/3MGKwcFTJhI/photo.jpg?sz=128", "display_name": "RazorKillBen", "link": "https://stackoverflow.com/users/10164553/razorkillben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1534950833, "creation_date": 1534950833, "question_id": 51969985, "link": "https://stackoverflow.com/questions/51969985/set-multiple-access-sql-results-as-variables", "title": "Set multiple Access SQL results as variables", "body": "<p>I have a SQL query that returns a list of 4 results (the AutoNumber ID and the names of 4 employees) like the below:</p>\n\n<pre><code>DB_ID |DB_AdjName|\n------|----------|\n97    |John      |\n98    |Mark      |\n99    |Tim       |\n100   |Paul      |\n</code></pre>\n\n<p>I need to return the 4 results into an Access Form so they can be 'edited'. To do so, I need to store the 4 names as variables (such as var1, var2, var3 etc) so that they can be then input back into the text boxes on the form.</p>\n\n<p>Is there anyway I can have the VBA loop this to set up the variables with each result?</p>\n\n<p>The workaround I have at the moment, involves adding +1 to the AutoNumber and DLookup returning the name, which feels inefficient, as well as 'line-heavy', but also leaves it open to issues if the ID numbers aren't in a linear pattern.</p>\n\n<p>Any help greatly appreciated!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 5, "creation_date": 1534949831, "post_id": 51969654, "comment_id": 90889795, "body": "Welcome to Stack Overflow! We are here to help with specific programming questions you have, once you&#39;ve made an honest effort and are stuck. I&#39;d start with the macro recorder or research other questions here on SO, try modifying the code, and if you&#39;re stuck come back with your specific issue."}, {"owner": {"reputation": 1, "user_id": 10260369, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uzdrBk29uAQ/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPN4B3i8zWlNqhOAQ3Xy4AR00K5qA/mo/photo.jpg?sz=128", "display_name": "Tim", "link": "https://stackoverflow.com/users/10260369/tim"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1534951168, "post_id": 51969654, "comment_id": 90890609, "body": "It works as long as I stay on the same workbook and sheet. But I want it to be universal so I can paste the range in the active sheet I have open.  I know it has something to do with the &quot;Personal.xlbs&quot; but that&#39;s where I get stuck"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 4, "creation_date": 1534951310, "post_id": 51969654, "comment_id": 90890695, "body": "You can actually <a href=\"https://stackoverflow.com/posts/51969654/edit\">edit</a> your post with that code, as opposed to posting it in a comment."}, {"owner": {"reputation": 3887, "user_id": 7914637, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-x_BhuHcC8Ww/AAAAAAAAAAI/AAAAAAAAABg/hiPWIjRXbhI/photo.jpg?sz=128", "display_name": "Alexander", "link": "https://stackoverflow.com/users/7914637/alexander"}, "edited": false, "score": 0, "creation_date": 1534957244, "post_id": 51969654, "comment_id": 90894105, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/19351832/copy-from-one-workbook-and-paste-into-another\">Copy from one workbook and paste into another</a>"}, {"owner": {"reputation": 5173, "user_id": 1981088, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1Iicg.png?s=128&g=1", "display_name": "help-info.de", "link": "https://stackoverflow.com/users/1981088/help-info-de"}, "edited": false, "score": 0, "creation_date": 1534958530, "post_id": 51969654, "comment_id": 90894725, "body": "Welcome to Stack Overflow! Please take the <a href=\"https://stackoverflow.com/tour\">tour</a> and read through the <a href=\"http://stackoverflow.com/help\">help center</a>, in particular how to ask. Your best bet here is to do your research, search for related topics on SO, and give it a go. After doing more research and searching, post a <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a> of your attempt and say specifically where you&#39;re stuck, which can help you get better answers."}], "answers": [{"tags": [], "owner": {"reputation": 135, "user_id": 9822961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/849bd735abfe339d76b530f9322bcc20?s=128&d=identicon&r=PG&f=1", "display_name": "Black_Raven", "link": "https://stackoverflow.com/users/9822961/black-raven"}, "is_accepted": false, "score": 0, "last_activity_date": 1534950408, "creation_date": 1534950408, "answer_id": 51969860, "question_id": 51969654, "link": "https://stackoverflow.com/questions/51969654/copy-a-range-from-a-workbook-sheet-to-another-workbook/51969860#51969860", "title": "Copy a range from a workbook sheet to another workbook", "body": "<p>Hope this will help you</p>\n\n<pre><code>Sheets(\"Sheet2\").Range(\"A2:BG2\").Copy Destination:=Sheets(\"Sheet3\").Range(\"A1:BG1\")\n</code></pre>\n\n<p>Or \nyou can use</p>\n\n<pre><code>    'Copy the data\n    Sheets(\"Sheet2\").Range(\"A2:BG2\").Copy\n    'Activate the destination worksheet\n    Sheets(\"Sheet3\").Activate\n    'Select the target range\n    Range(\"A1:BG1\").Select\n    'Paste in the target destination\n    ActiveSheet.Paste       \n    Application.CutCopyMode = False\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10260369, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uzdrBk29uAQ/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPN4B3i8zWlNqhOAQ3Xy4AR00K5qA/mo/photo.jpg?sz=128", "display_name": "Tim", "link": "https://stackoverflow.com/users/10260369/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1558275816, "creation_date": 1534949715, "last_edit_date": 1558275816, "question_id": 51969654, "link": "https://stackoverflow.com/questions/51969654/copy-a-range-from-a-workbook-sheet-to-another-workbook", "title": "Copy a range from a workbook sheet to another workbook", "body": "<p>I want to copy cell range (A2:BG2) from Workbook A, Sheet 2 to Active Workbook B, Active Sheet 3 range (A1:BG1).</p>\n\n<p>This is what I came up with. </p>\n\n<pre><code>Sub Macro6()\n'\n' Macro6 Macro\n'\n\n'\n    ActiveCell.Rows(\"1:1\").EntireRow.Select\n    Windows(\"Bollore - kopregels importeren Bollore invoice soorten.xlsx\").Activate\n    ActiveCell.Offset(-11, 0).Rows(\"1:1\").EntireRow.Select\n    ActiveCell.Offset(-11, -4).Range(\"A1\").Activate\n    Selection.Copy\n    Windows(\"Personal.xlsb\").Activate\n    Selection.Insert Shift:=xlDown\n    ActiveCell.Offset(5, 12).Range(\"A1\").Select\n    ActiveWindow.ScrollColumn = 2\n    ActiveWindow.ScrollColumn = 3\n    ActiveWindow.ScrollColumn = 4\n</code></pre>\n"}, {"tags": ["vba", "excel", "xlsx"], "comments": [{"owner": {"reputation": 5468, "user_id": 2107722, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OvhXm.jpg?s=128&g=1", "display_name": "Our Man in Bananas", "link": "https://stackoverflow.com/users/2107722/our-man-in-bananas"}, "edited": false, "score": 2, "creation_date": 1534950402, "post_id": 51969625, "comment_id": 90890137, "body": "this is a spelling error I think <code>Filename = Dir(Pathname &amp; &quot;.iqy&quot;)</code> - maybe it should be <code>Filename = Dir(Pathname &amp; &quot;\\*.iqy&quot;)</code> using the wildcard?"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1534953163, "post_id": 51969625, "comment_id": 90891790, "body": "Better still, put the ` \\ ` at the end of the <code>Pathname</code>, because it&#39;ll need it to open and save the files."}, {"owner": {"reputation": 73, "user_id": 9830552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3a2a6ff94d3e659adf24315a8f2c98d?s=128&d=identicon&r=PG&f=1", "display_name": "jordan23", "link": "https://stackoverflow.com/users/9830552/jordan23"}, "edited": false, "score": 0, "creation_date": 1534964525, "post_id": 51969625, "comment_id": 90897424, "body": "thanks that helped"}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 9830552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3a2a6ff94d3e659adf24315a8f2c98d?s=128&d=identicon&r=PG&f=1", "display_name": "jordan23", "link": "https://stackoverflow.com/users/9830552/jordan23"}, "edited": false, "score": 0, "creation_date": 1534964602, "post_id": 51970766, "comment_id": 90897457, "body": "wow perfect, only thing is when they get saved I get an import data prompt and have to press ok. Do you know if theres a way of automating that? @CLR"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "reply_to_user": {"reputation": 73, "user_id": 9830552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3a2a6ff94d3e659adf24315a8f2c98d?s=128&d=identicon&r=PG&f=1", "display_name": "jordan23", "link": "https://stackoverflow.com/users/9830552/jordan23"}, "edited": false, "score": 0, "creation_date": 1535019591, "post_id": 51970766, "comment_id": 90916396, "body": "You could try <code>Application.DisplayAlerts = False</code> before the loop, making sure you set it back to <code>True</code> at the end? I&#39;m not sure as I can&#39;t test it here."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "reply_to_user": {"reputation": 73, "user_id": 9830552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3a2a6ff94d3e659adf24315a8f2c98d?s=128&d=identicon&r=PG&f=1", "display_name": "jordan23", "link": "https://stackoverflow.com/users/9830552/jordan23"}, "edited": false, "score": 0, "creation_date": 1535019668, "post_id": 51970766, "comment_id": 90916443, "body": "If not, record a macro of yourself manually importing the file and see what code you get from that."}], "tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": true, "score": 2, "last_activity_date": 1534953377, "creation_date": 1534953377, "answer_id": 51970766, "question_id": 51969625, "link": "https://stackoverflow.com/questions/51969625/converting-from-iqy-to-xlsx-with-vba/51970766#51970766", "title": "Converting from IQy to XLSX with VBA", "body": "<p>You need to include a wildcard in order to find your iqy files and your pathname will need an additional folder separator to allow the Open and SaveAs to work:</p>\n\n<pre><code>Sub ConvertFiles()\n    Dim Filename, Pathname As String\n    Dim wb As Workbook\n\n    Pathname = \"C:\\Users\\CHI86786\\Downloads\\\"\n    Filename = Dir(Pathname &amp; \"*.iqy\")\n    Do While Filename &lt;&gt; \"\"\n        Set wb = Workbooks.Open(Pathname &amp; Filename)\n        wb.SaveAs Pathname &amp; Filename &amp; \".xlsx\", FileFormat:=xlOpenXMLWorkbook\n        wb.Close\n        Filename = Dir()\n    Loop\nEnd Sub\n</code></pre>\n\n<p>Lastly, to be sure it saves correctly, set the <code>FileFormat</code> parameter when using <code>SaveAs</code>.</p>\n"}], "owner": {"reputation": 73, "user_id": 9830552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3a2a6ff94d3e659adf24315a8f2c98d?s=128&d=identicon&r=PG&f=1", "display_name": "jordan23", "link": "https://stackoverflow.com/users/9830552/jordan23"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1388, "favorite_count": 0, "accepted_answer_id": 51970766, "answer_count": 1, "score": 0, "last_activity_date": 1534963799, "creation_date": 1534949635, "last_edit_date": 1534963799, "question_id": 51969625, "link": "https://stackoverflow.com/questions/51969625/converting-from-iqy-to-xlsx-with-vba", "title": "Converting from IQy to XLSX with VBA", "body": "<p>I have a about 40 files that are IQy files that I can open with Excel and I'm trying to go through all of them and save them as xlsx files. What I have so far in VBA is this</p>\n\n<pre><code>Sub ConvertFiles()\n    Dim Filename, Pathname As String\n    Dim wb As Workbook\n\n    Pathname = \"C:\\Users\\CHI\\Downloads\"\n    Filename = Dir(Pathname &amp; \".iqy\")\n    Do While Filename &lt;&gt; \"\"\n        Set wb = Workbooks.Open(Pathname &amp; Filename)\n        wb.SaveAs Pathname &amp; Filename &amp; \".xlsx\"\n        wb.Close\n        Filename = Dir()\n    Loop\nEnd Sub\n</code></pre>\n\n<p>To my understanding this loops through my download file where the iqy files are stored and then saveas in xlsx format. When I run it nothing happens.</p>\n\n<p>UPDATE</p>\n\n<pre><code>Sub ConvertFiles()\n    Dim Filename, Pathname As String\n    Dim wb As Workbook\n\n    Pathname = \"C:\\Users\\CHI\\Downloads\\\"\n    Filename = Dir(Pathname &amp; \"*.iqy\")\n    Application.DisplayAlerts = False\n    Do While Filename &lt;&gt; \"\"\n        Set wb = Workbooks.Open(Pathname &amp; Filename)\n        wb.SaveAs Pathname &amp; Filename &amp; \".xlsx\", FileFormat:=51\n        wb.Close\n        Filename = Dir()\n    Loop\nEnd Sub\n</code></pre>\n\n<p>This is what worked for me, the only problem I have now is after it changes every file I get a prompt to import data and all I have to press is ok. Is there a way to automate this part so that I can import the data using the table option.</p>\n\n<p><a href=\"https://i.stack.imgur.com/5JN3i.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5JN3i.png\" alt=\"Import Data prompt\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 3, "creation_date": 1534950383, "post_id": 51969606, "comment_id": 90890125, "body": "Remove the error handler at the beginning <b>On Error GoTo errHandler</b> and let us know what is the error code and message when you run it."}, {"owner": {"reputation": 495, "user_id": 179562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/869eabd9b53ca463cd92670d0ba2e7db?s=128&d=identicon&r=PG", "display_name": "klausnrooster", "link": "https://stackoverflow.com/users/179562/klausnrooster"}, "reply_to_user": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1534951437, "post_id": 51969606, "comment_id": 90890764, "body": "When ctrl.update is not commented out, Update Method of OLEObject Failed. But I just dropped that bit in thinking it would help - it was not in the original code that ran well. I should figure out how to do it right, maybe it would help. Note there is no sheet protection on to get in the way."}, {"owner": {"reputation": 495, "user_id": 179562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/869eabd9b53ca463cd92670d0ba2e7db?s=128&d=identicon&r=PG", "display_name": "klausnrooster", "link": "https://stackoverflow.com/users/179562/klausnrooster"}, "reply_to_user": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1534952660, "post_id": 51969606, "comment_id": 90891479, "body": "Doing ctrl.activate instead actually works to print correctly. Horribly inefficient in a way but no worse than putting a 3 second delay in. I&#39;ll do this but I&#39;m not happy about it."}, {"owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1534955922, "post_id": 51969606, "comment_id": 90893431, "body": "Can you Activate Sheet8 before the With Sheet8 section and try the ctrl.Update ? there is a possibility that the control will not update if the sheet is not active. Just a guess."}, {"owner": {"reputation": 495, "user_id": 179562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/869eabd9b53ca463cd92670d0ba2e7db?s=128&d=identicon&r=PG", "display_name": "klausnrooster", "link": "https://stackoverflow.com/users/179562/klausnrooster"}, "reply_to_user": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1535044377, "post_id": 51969606, "comment_id": 90931708, "body": "@RicardoA, Thanks, I tried. Still errs. Compiles, but at run time errs. I can live with my workaround. Curious what may be going on under the hood to cause behavior to change. My guess is it is unintended consequence of some improvement."}], "owner": {"reputation": 495, "user_id": 179562, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/869eabd9b53ca463cd92670d0ba2e7db?s=128&d=identicon&r=PG", "display_name": "klausnrooster", "link": "https://stackoverflow.com/users/179562/klausnrooster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 166, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1534949590, "creation_date": 1534949590, "question_id": 51969606, "link": "https://stackoverflow.com/questions/51969606/how-to-fix-excel-2016-not-running-excel-2010-vba-code-for-printing-correctly", "title": "How to fix Excel-2016 not running Excel-2010 VBA code for printing correctly?", "body": "<p>This loop runs typically 4 to 8 times. It updates 30+ textboxes and prints. Has been working great. But we updated from office 2010 to 2016 (and to Office 365), so now it runs but all the textboxes on the printed pages have the same value from iteration 1. Happens on all printers including PDFcreator. But afterwards the sheet is in the state I expect for the last iteration. It's like the code outruns the printer. But adding a delay of even 10 sec does not help. Oddly, as I try different things I see on the first iter that the textboxes update (from the previous runs last iter). Seems like it should update every iter.</p>\n\n<pre><code>Sub printParamSheets()\nOn Error GoTo errHandler\nDim Bin1_Matl, Bin1_Parts 'Declaring types won't help or speed up\nDim iCond, conditions\n\nApplication.EnableEvents = True 'Is not helping with issue\n\nFor iCond = 1 To conditions\n\n    With Sheet2\n        'Assign from sheet2 to variables\n        Bin1_Matl = .Range(\"A64\").Offset(0, iCond * 2).Value2\n        Bin1_Parts = .Range(\"B64\").Offset(0, iCond * 2).Value2\n        'about 30 more of these\n    End With\n\n    With Sheet8 'Assign Sheet8 named ranges from variables above. \n            'Could skip intermed vars but nice for debugging.\n            'ALL LINKED TO ACTIVEX TEXT BOXES on Sheet8, atop an image.\n        .Range(\"Bin1Matl\").Value2 = Bin1_Matl\n        .Range(\"Bin1Parts\").Value2 = Bin1_Parts\n        'about 30 more of them\n        .Calculate  'Is not helping with issue\n\n        Dim ctrl As OLEObject  'Is not helping with issue\n        For Each ctrl In .OLEObjects\n            If TypeName(ctrl.Object) = \"TextBox\" Then\n                'ctrl.Update    'error, but was not in 2010 anyway\n            End If              \n        Next ctrl\n\n        Application.Wait (Now + TimeValue(\"00:00:05\"))  'Is not helping \n        Application.ScreenUpdating = True 'Never toggled off , no help\n        DoEvents    'Is not helping with issue\n\n        .PrintOut from:=1, To:=1, Copies:=1, Collate:=True\n    End With\nNext iCond\n\nExit Sub\nerrHandler:\nApplication.EnableEvents = True 'Don't need but cannot hurt\nResume Next\nEnd Sub\n</code></pre>\n\n<p>I will try skipping the extra intermediate assignments, going straight from sheet2 to the textboxes. But I'd like to know the cause because I have other code 'in the wild' that doesn't necessarily use any activex objects that may be affected. Hoping the symptom is not unique to our site and so others may benefit from an answer.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 343, "user_id": 9626171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9587856742de2015aec848c7749c4b15?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/9626171/jordan"}, "is_accepted": false, "score": 0, "last_activity_date": 1534950223, "creation_date": 1534950223, "answer_id": 51969809, "question_id": 51969579, "link": "https://stackoverflow.com/questions/51969579/pasting-text-from-excel-to-word-in-specific-locations-vba/51969809#51969809", "title": "Pasting Text From Excel to Word in Specific Locations VBA", "body": "<p>I found an answer to my own question eventually</p>\n\n<p>First define your variables then use the following code</p>\n\n<pre><code>'Places the QN# in the Word Document\nwordDoc.Application.Selection.Find.Execute \"Complaint Description:\" '***Places after a specfic word\nwordApp.Selection.MoveDown Unit:=wdLine, Count:=-1, Extend:=wdMove '***Moves the placement up a line\nwordApp.Selection.TypeText (QN_number)\n</code></pre>\n"}], "owner": {"reputation": 343, "user_id": 9626171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9587856742de2015aec848c7749c4b15?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/9626171/jordan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 642, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1594152459, "creation_date": 1534949498, "last_edit_date": 1594152459, "question_id": 51969579, "link": "https://stackoverflow.com/questions/51969579/pasting-text-from-excel-to-word-in-specific-locations-vba", "title": "Pasting Text From Excel to Word in Specific Locations VBA", "body": "<p>I am trying to place variables that I have already established (In this case the variable is QN_number) into a word document in specific locations, I have done this in the past except I placed an entire table into word so the code was different. I have not been able to find a way to past using the variable names directly which would be preferred instead having to reference a range each time. Also the method I am using now is not working well as it does paste in the proper location, but it pastes the words associated with the variable as a selection box that can be moved and resized. I would like is pasted just like any other text in the document. Here is the code that I am using right now. Does anyone have any suggestions?</p>\n\n<pre><code>Sub Export_Excel_To_Word()\n\n'Connect to M-Word\nDim wordApp As Word.Application\nSet wordApp = New Word.Application\nwordApp.Visible = True\nDim wordDoc As Word.Document\n\ni = 0\n\n'Exits loop when QN#s are finished\nDo\nIf Cells(i + 2, 2) = \"\" Then\nExit Do\nElse: End If\n\n\n'Opens the Template Word Document For Discus Complaints\nSet wordDoc = wordApp.Documents.Open(File_Name)\n\n\n 'Places the QN# in the Word Document\n With Worksheets(\"Data\").Cells(i + 2, 2)\n .Copy\nwordDoc.Application.Selection.Find.Execute \"Complaint Description:\" '***Places after a specfic word\nwordApp.Selection.MoveDown Unit:=wdLine, Count:=-1, Extend:=wdMove '***Moves the placement up a line\nwordApp.Selection.TypeParagraph\n'wordDoc.Paragraphs.Add\nwordApp.Selection.Paste\nEnd With\nend sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1534949693, "post_id": 51969538, "comment_id": 90889695, "body": "What is <code>start</code>?"}, {"owner": {"reputation": 271, "user_id": 9569786, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "MTT", "link": "https://stackoverflow.com/users/9569786/mtt"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1534949858, "post_id": 51969538, "comment_id": 90889806, "body": "@BigBen A range. But I already made sure that all 6 values initialized above are integers and they have the expected values, so that should not be the problem!! Something is wrong with the syntax of the last row setting the column width"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1534950178, "post_id": 51969538, "comment_id": 90889988, "body": "<code>Columns</code> takes a column letter or index as its argument, not a <code>Range</code>."}], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": false, "score": 1, "last_activity_date": 1534951200, "creation_date": 1534951200, "answer_id": 51970094, "question_id": 51969538, "link": "https://stackoverflow.com/questions/51969538/application-defined-or-object-defined-error-in-setting-column-width/51970094#51970094", "title": "Application-defined or object-defined error in setting column width", "body": "<p><a href=\"https://docs.microsoft.com/en-us/office/vba/api/Excel.Worksheet.Columns\" rel=\"nofollow noreferrer\"><code>Worksheet.Columns</code></a> takes column letter(s) or index as its argument.</p>\n\n<p>So <code>Sheets(\"Tree\").Columns(\"A:B\").ColumnWidth = 4</code>, or <code>Sheets(\"Tree\").Columns(2).ColumnWidth = 4</code> are examples of the correct syntax. But you have <code>Range</code> arguments here. </p>\n\n<p>If you change <code>Columns</code> to <code>Range</code>, and all of your variables have the expected values, the last line should work.</p>\n\n<p>A couple recommendations:</p>\n\n<ul>\n<li>Change the <code>Integer</code>s to <code>Long</code> - Excel has more rows than <code>Integer</code> can handle, and there's no real benefit to using <code>Integer</code>.</li>\n<li>With variable declaration, you need to explicitly state the type for each variable and not just at the end - <code>Dim firstRow as Long, firstCol as Long</code>. With <code>Dim firstRow, firstCol as Long</code>, <code>firstRow</code> is actually a <code>Variant</code></li>\n<li>Since a <code>Range</code> already has <code>Row</code> and <code>Column</code> properties, it's preferable to avoid using those terms as variables.</li>\n</ul>\n"}], "owner": {"reputation": 271, "user_id": 9569786, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "MTT", "link": "https://stackoverflow.com/users/9569786/mtt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1534951200, "creation_date": 1534949376, "question_id": 51969538, "link": "https://stackoverflow.com/questions/51969538/application-defined-or-object-defined-error-in-setting-column-width", "title": "Application-defined or object-defined error in setting column width", "body": "<p>I am trying to run this code snippet to set the column width from the firstcolumn to the last one to 4. </p>\n\n<p>I am getting the error saying: Application-defined or object-defined error</p>\n\n<pre><code>Dim firstRow, firstCol As Integer\nDim lastRow, lastCol As Integer\nDim row, column As Integer\n\nfirstRow = start.row\nfirstCol = start.column\nlastRow = iMax\nlastCol = jMax\n\n'Set column width to 4\nSheets(\"Tree\").Columns(Cells(firstRow, firstCol).EntireColumn, Cells(firstRow, lastCol - 1).EntireColumn).ColumnWidth = 4\n</code></pre>\n\n<p>Where jMax and iMax are 2 integers. Any help? Thanks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1534949727, "post_id": 51969500, "comment_id": 90889719, "body": "Right before <code>results.copy</code>, add <code>Debug.Print results.address</code>. Is the address showing in the Immediate Window (press CTRL+G in the VBE) the range you&#39;re expecting?"}, {"owner": {"reputation": 1, "user_id": 10255685, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-KExKEMzQwTo/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaNDaoTN2uOuF-DbpTwnD1eZsoLg3Q/mo/photo.jpg?sz=128", "display_name": "Colin Wagner", "link": "https://stackoverflow.com/users/10255685/colin-wagner"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1534954045, "post_id": 51969500, "comment_id": 90892322, "body": "@BruceWayne Thank you for your help. The address remains the one I initially Set before the loop. It appears that I unintentionally fixed the range, or I have not properly modified it as I was trying to in the loop. How do I initialize the results Range so that I can append cells at will?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1534955324, "post_id": 51969500, "comment_id": 90893089, "body": "Try doing <code>set results = Union(results, row_pull)</code>?  Also, right before and after, do the <code>Debug.Print results.address</code> to check if it&#39;s being updated correctly each iteration.  Also, <b><i>please</i></b> don&#39;t use an <i>entire</i> column as the range to go through as it can cause headaches and slow your macro down. I&#39;d go from first to last cell (e.g. <code>Set category = all_data.Range(&quot;C1:C1000&quot;)</code>."}], "owner": {"reputation": 1, "user_id": 10255685, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-KExKEMzQwTo/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaNDaoTN2uOuF-DbpTwnD1eZsoLg3Q/mo/photo.jpg?sz=128", "display_name": "Colin Wagner", "link": "https://stackoverflow.com/users/10255685/colin-wagner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 19, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1534949242, "creation_date": 1534949242, "question_id": 51969500, "link": "https://stackoverflow.com/questions/51969500/why-does-this-category-search-routine-using-ranges-output-nothing", "title": "Why does this category search routine using ranges output nothing?", "body": "<p>This is my first excel VBA program. Its purpose is to search through a column for a specific string, in this particular case 'Popular Journalism'. If it finds the string, it adds the entire corresponding row to a results range. At the end of the search, the results range is copied to an existing blank worksheet.</p>\n\n<p>It compiles and runs without issue. However, though I have created a test database with the correct string in Column 'C', the search always returns a blank results page.</p>\n\n<p>What facet of VBA am I misunderstanding in this code?</p>\n\n<p>Source:</p>\n\n<pre><code>Sub search_popularjournalism()\n\n'Clear the previous results from the 'Results' worksheet\nWorksheets(\"Results\").UsedRange.ClearContents\n\n'Variable Declarations\nDim cell As Variant 'Search FOR loop will iterate through each cell\nDim all_data As Range 'All data in database exluding unused cells\nDim category As Range 'This range is only the column containing categories\nDim results As Range 'The results of the category search\nDim row As Integer 'This counter will tell which row of data to add to results\nDim row_pull As Range 'This is the row to be added to results, conforms with Set protocol\n\n'Initialize Variables and pull data into array\nrow = 1\nSet results = Worksheets(\"Results\").Range(\"A1\")\nSet all_data = Worksheets(\"Database\").UsedRange\nSet category = all_data.Columns(\"C\")\n\n'This for loop goes through each row of the 'Category' column.\n'If the 'Category' column contains the correct category, the entire row\n'is placed in the results range.\nFor Each cell In category\n    If cell.Text = \"Popular Journalism\" Then\n        row_pull = Rows(row).Cells\n        results = Union(results, row_pull)\n    End If\n    row = row + 1\nNext cell\n\n'This line copies the entire results range into the 'Results' Worksheet\nresults.Copy Worksheets(\"Results\").Range(\"A1\")\n\nMsgBox \"Search Routine Complete\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["string", "vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 17346, "user_id": 1693085, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/89d96f4a92f0053e9f2c9a8b06c011a0?s=128&d=identicon&r=PG", "display_name": "John Bustos", "link": "https://stackoverflow.com/users/1693085/john-bustos"}, "edited": false, "score": 0, "creation_date": 1534949699, "post_id": 51969489, "comment_id": 90889702, "body": "What happens when you look in cell <code>D4</code> after running that line of code? What&#39;s the issue you&#39;re seeing?"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 2, "creation_date": 1534949706, "post_id": 51969489, "comment_id": 90889708, "body": "It looks OK to me. The only think I&#39;m wondering about (And I don&#39;t know for sure) is if VBA is ok with internationalization. Again, I&#39;m totally not certain that has anything to do with it, but maybe try switching those semicolons over to commas and see if it makes it happy. I&#39;ll be surprised if that works, but I feel like it&#39;s worth a shot."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 17346, "user_id": 1693085, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/89d96f4a92f0053e9f2c9a8b06c011a0?s=128&d=identicon&r=PG", "display_name": "John Bustos", "link": "https://stackoverflow.com/users/1693085/john-bustos"}, "edited": false, "score": 2, "creation_date": 1534949815, "post_id": 51969489, "comment_id": 90889784, "body": "Also. You just say <code>Range(&quot;D4&quot;).Formula</code> but you don&#39;t say which sheet. Perhaps this formula is being written out to a sheet you don&#39;t expect it to be written to. Instead something like <code>Sheet1.Range(&quot;D4&quot;).Formula()</code>. To @JohnBustos point though, it&#39;s not clear if you are getting an error, or the formula being written is incorrect or you just aren&#39;t finding it after running the code."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 10260233, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DrSQ3kVY9RI/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOYZtQggqSZeaCNNs5Q2z_fZRw93g/mo/photo.jpg?sz=128", "display_name": "Blake", "link": "https://stackoverflow.com/users/10260233/blake"}, "is_accepted": false, "score": 1, "last_activity_date": 1534961888, "last_edit_date": 1534961888, "creation_date": 1534950859, "answer_id": 51969995, "question_id": 51969489, "link": "https://stackoverflow.com/questions/51969489/why-cant-i-write-a-formula-with-vba/51969995#51969995", "title": "Why can&#39;t I write a formula with VBA?", "body": "<p><a href=\"https://stackoverflow.com/users/2221001/jnevill\">JNevill</a> you were right the problem was <code>;</code> should be a <code>,</code>.</p>\n\n<p>The error message I was getting was this:</p>\n\n<p><img src=\"https://i.stack.imgur.com/RTkLX.png\" alt=\"this\">.</p>\n\n<p>If anyone needs to use it, passing a variable (named data) would be:</p>\n\n<pre><code>Range(\"D4\").Formula = \"= \"\"Range: ( \"\" &amp; FIXED(MIN(\" + data + \"),2) &amp; \"\" - \"\" &amp; FIXED(MAX(\" + data + \"),2) &amp; \"\" )\"\"\"\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10260233, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DrSQ3kVY9RI/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOYZtQggqSZeaCNNs5Q2z_fZRw93g/mo/photo.jpg?sz=128", "display_name": "Blake", "link": "https://stackoverflow.com/users/10260233/blake"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "closed_date": 1534981558, "answer_count": 1, "score": 0, "last_activity_date": 1534961888, "creation_date": 1534949197, "last_edit_date": 1534961838, "question_id": 51969489, "link": "https://stackoverflow.com/questions/51969489/why-cant-i-write-a-formula-with-vba", "closed_reason": "Not suitable for this site", "title": "Why can&#39;t I write a formula with VBA?", "body": "<p>I've tried to write this Excel formula:</p>\n\n<pre><code> =\"Range: ( \"&amp;FIXED(MIN('Group2'!$K$10:$K$595);2)&amp;\" - \"&amp;FIXED(MAX('Group2'!$K$10:$K$595);2)&amp;\" )\"\n</code></pre>\n\n<p>And it's working perfectly, but when I try to write it with VBA macro, nothing I've been able to find online is working. For example, I've tried with double quotes:</p>\n\n<pre><code>Range(\"D4\").formula = \"= \"\"Range: ( \"\" &amp; FIXED(MIN('Group2'!$K$10:$K$595);2) &amp; \"\" - \"\" &amp; FIXED(MAX('Group2'!$K$10:$K$595);2) &amp; \"\" )\"\"\"\n</code></pre>\n\n<p>I would like it so I can change the range passing it as a variable.</p>\n"}, {"tags": ["excel", "vba", "variables"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1534949162, "post_id": 51969401, "comment_id": 90889365, "body": "First guess would be that the value in AA4 is not between 0 and 100."}, {"owner": {"reputation": 3, "user_id": 3609746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/342168ce6077843997c41d519dcaaf18?s=128&d=identicon&r=PG&f=1", "display_name": "user3609746", "link": "https://stackoverflow.com/users/3609746/user3609746"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1534949419, "post_id": 51969401, "comment_id": 90889525, "body": "I ran a msgbox to output ServiceLevel, the output was 95."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1534949564, "post_id": 51969401, "comment_id": 90889620, "body": "<code>Add Debug.Print ServiceLevel</code> before <code>Application.Run</code> - what is the output in the Immediate Window? Also, what <code>Worksheet</code> is <code>Range(&quot;AA4&quot;)</code> on? You should fully qualify it, otherwise <code>ActiveSheet</code> is implied, which might not be the sheet you expect."}, {"owner": {"reputation": 3, "user_id": 3609746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/342168ce6077843997c41d519dcaaf18?s=128&d=identicon&r=PG&f=1", "display_name": "user3609746", "link": "https://stackoverflow.com/users/3609746/user3609746"}, "edited": false, "score": 0, "creation_date": 1534954525, "post_id": 51969401, "comment_id": 90892611, "body": "Nothing changed by adding Debug.Print ServiceLevel.  There is only 1 worksheet, so it does not need to be qualified in this case."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1534956321, "post_id": 51969401, "comment_id": 90893637, "body": "And if you hit Ctrl+G within the VB editor to bring up the Immediate Window, the output is 95? I cannot replicate your error."}, {"owner": {"reputation": 3, "user_id": 3609746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/342168ce6077843997c41d519dcaaf18?s=128&d=identicon&r=PG&f=1", "display_name": "user3609746", "link": "https://stackoverflow.com/users/3609746/user3609746"}, "edited": false, "score": 0, "creation_date": 1534956969, "post_id": 51969401, "comment_id": 90893955, "body": "Yes.  This makes no sense."}, {"owner": {"reputation": 3, "user_id": 3609746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/342168ce6077843997c41d519dcaaf18?s=128&d=identicon&r=PG&f=1", "display_name": "user3609746", "link": "https://stackoverflow.com/users/3609746/user3609746"}, "edited": false, "score": 0, "creation_date": 1534957590, "post_id": 51969401, "comment_id": 90894294, "body": "Ben, so here&#39;s a weird point.  When I run Debug.Print in it&#39;s own Sub, I get 95 in the Immediate Window; however, if Debug.Print is placed before Application.Run, the Immediate Window is blank.  I tried &quot;0&quot; &amp; ServiceLevel in Application.Run line of code and it ran the regression at 0 confidence level.  So ServiceLevel variable is not being recognized.  Hopefully this will help narrow down the issue."}, {"owner": {"reputation": 3, "user_id": 3609746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/342168ce6077843997c41d519dcaaf18?s=128&d=identicon&r=PG&f=1", "display_name": "user3609746", "link": "https://stackoverflow.com/users/3609746/user3609746"}, "edited": false, "score": 0, "creation_date": 1534960456, "post_id": 51969401, "comment_id": 90895611, "body": "Resolved.  Qualified the sheet and it worked."}], "owner": {"reputation": 3, "user_id": 3609746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/342168ce6077843997c41d519dcaaf18?s=128&d=identicon&r=PG&f=1", "display_name": "user3609746", "link": "https://stackoverflow.com/users/3609746/user3609746"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594150981, "creation_date": 1534948938, "last_edit_date": 1594150981, "question_id": 51969401, "link": "https://stackoverflow.com/questions/51969401/error-when-setting-variable-in-an-excel-vba-application", "title": "Error when setting variable in an Excel VBA Application", "body": "<p>I've created a working macro that runs linear regression statistical analysis on a data set.  The final piece is to have a variable service level (# between 0 and 100) that the user can enter, then that value will be used in the VBA code.</p>\n\n<p>Here's the working code with a standard service level set at 90:</p>\n\n<pre><code>' Run Regression Application\nDim LastRow As Long\n    LastRow = Cells(Rows.Count, 1).End(xlUp).Row\n    Application.Run \"ATPVBAEN.XLAM!Regress\", ActiveSheet.Range(\"$A$1:$A\" &amp; LastRow), _\n        ActiveSheet.Range(\"$B$1:$B$\" &amp; LastRow), False, True, 90, ActiveSheet.Range(\"$D:$BK\") _\n        , True, True, True, True, , False\n</code></pre>\n\n<p>When I added ServiceLevel as a var:</p>\n\n<pre><code>' Run Regression Application\nDim LastRow As Long\nDim ServiceLevel As Long\n    LastRow = Cells(Rows.Count, 1).End(xlUp).Row\n    ServiceLevel = Range(\"AA4\").Value\n     Application.Run \"ATPVBAEN.XLAM!Regress\", ActiveSheet.Range(\"$A$1:$A\" &amp; LastRow), _\n        ActiveSheet.Range(\"$B$1:$B$\" &amp; LastRow), False, True, ServiceLevel, ActiveSheet.Range(\"$D:$BK\") _\n        , True, True, True, True, , False\n</code></pre>\n\n<p>And I get this error:\nRegression - Confidence must be a number between 0 and 100</p>\n"}, {"tags": ["excel", "vba", "gpib"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1534949624, "post_id": 51969325, "comment_id": 90889658, "body": "What have you tried? Do you just need to add the library?"}, {"owner": {"reputation": 1, "user_id": 10260002, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-X-q2lTwPKo4/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPJgy_rE5jLmjVqzuwMvv7Kurot2w/mo/photo.jpg?sz=128", "display_name": "Nicolas Bouchard", "link": "https://stackoverflow.com/users/10260002/nicolas-bouchard"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1534950414, "post_id": 51969325, "comment_id": 90890143, "body": "I am precisely asking if those NI 488.2 commands require a library to use them in VBA. (And if so, wich one?) I looked on the web without any useful results. I am new to GPIB communication and VBA."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10260002, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-X-q2lTwPKo4/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPJgy_rE5jLmjVqzuwMvv7Kurot2w/mo/photo.jpg?sz=128", "display_name": "Nicolas Bouchard", "link": "https://stackoverflow.com/users/10260002/nicolas-bouchard"}, "edited": false, "score": 0, "creation_date": 1534956049, "post_id": 51971310, "comment_id": 90893494, "body": "My problem for now (Maybe others will come and thanks for forseeing them) is that the code won&#39;t compile. The functions from the NI-488.2 standard are not recognized by VBA by default, thus giving the &#39;&#39;Sub or Function not defined&#39;&#39;. error. I edited the question again because your answers help me being more precise."}, {"owner": {"reputation": 106, "user_id": 4514373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/160dd1e0ba52567014b4e5e9d016a78c?s=128&d=identicon&r=PG&f=1", "display_name": "Zircatron", "link": "https://stackoverflow.com/users/4514373/zircatron"}, "reply_to_user": {"reputation": 1, "user_id": 10260002, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-X-q2lTwPKo4/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPJgy_rE5jLmjVqzuwMvv7Kurot2w/mo/photo.jpg?sz=128", "display_name": "Nicolas Bouchard", "link": "https://stackoverflow.com/users/10260002/nicolas-bouchard"}, "edited": false, "score": 0, "creation_date": 1534957574, "post_id": 51971310, "comment_id": 90894288, "body": "I haven&#39;t used the NI drivers this much to know if these files will appear in the references. Locate the following files and make note of their location. These files will be used during the development process of a Visual Basic program.  a.  Niglobal.bas  b.  Vbib-32.bas"}, {"owner": {"reputation": 106, "user_id": 4514373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/160dd1e0ba52567014b4e5e9d016a78c?s=128&d=identicon&r=PG&f=1", "display_name": "Zircatron", "link": "https://stackoverflow.com/users/4514373/zircatron"}, "reply_to_user": {"reputation": 1, "user_id": 10260002, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-X-q2lTwPKo4/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPJgy_rE5jLmjVqzuwMvv7Kurot2w/mo/photo.jpg?sz=128", "display_name": "Nicolas Bouchard", "link": "https://stackoverflow.com/users/10260002/nicolas-bouchard"}, "edited": false, "score": 0, "creation_date": 1534957738, "post_id": 51971310, "comment_id": 90894370, "body": "Personally, I would go back to using the VISA COM libraries, you shouldn&#39;t have any problems with these and they&#39;re much more convenient to use."}], "tags": [], "owner": {"reputation": 106, "user_id": 4514373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/160dd1e0ba52567014b4e5e9d016a78c?s=128&d=identicon&r=PG&f=1", "display_name": "Zircatron", "link": "https://stackoverflow.com/users/4514373/zircatron"}, "is_accepted": false, "score": 0, "last_activity_date": 1534955289, "creation_date": 1534955289, "answer_id": 51971310, "question_id": 51969325, "link": "https://stackoverflow.com/questions/51969325/how-to-query-files-csv-bmp-using-ni-488-2-from-a-gpib-port-in-vba-excel/51971310#51971310", "title": "How to query files (csv, bmp) using NI-488.2 from a GPIB port in VBA (Excel)", "body": "<p>Now we have the code... you have now edited out the useful bits... I'm going to backtrack a bit and say that even if you get direct calls to work you\u2019re still going to have a problem extracting the files.</p>\n\n<p>I\u2019m going to guess you\u2019re getting \"Undefined header\" errors if you query the OSA with \"SYST:ERR:ALL?\" and this is quite possibly because the query command for the data is invalid.</p>\n\n<p>I\u2019ve notice you\u2019re using including the data type your command:</p>\n\n<pre><code>\":mmem:data? \"\"test.bmp\"\",int\"\n</code></pre>\n\n<p>\"test.bmp\",int,0 is what you might see if you query the directory, however, it is not needed when extracting the file.</p>\n\n<p>try using:</p>\n\n<pre><code>\":mmem:data? \"\"test.bmp\"\"\"\n</code></pre>\n\n<p>(The number of quotations are to include them in the string)</p>\n\n<p>If not, what is the GPIB error?</p>\n"}], "owner": {"reputation": 1, "user_id": 10260002, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-X-q2lTwPKo4/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPJgy_rE5jLmjVqzuwMvv7Kurot2w/mo/photo.jpg?sz=128", "display_name": "Nicolas Bouchard", "link": "https://stackoverflow.com/users/10260002/nicolas-bouchard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 206, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1534955459, "creation_date": 1534948677, "last_edit_date": 1534955459, "question_id": 51969325, "link": "https://stackoverflow.com/questions/51969325/how-to-query-files-csv-bmp-using-ni-488-2-from-a-gpib-port-in-vba-excel", "title": "How to query files (csv, bmp) using NI-488.2 from a GPIB port in VBA (Excel)", "body": "<p>Using VBA, I tried to use the NI-488.2 calls directly, instead of using VISA COM. However, when I try to use NI-488.2 commands in VBA, I get the following error message : </p>\n\n<blockquote>\n  <p>''Sub or Function not defined''. </p>\n</blockquote>\n\n<p>That is, when calling <code>Call SendIFC(BOARD_ID)</code> or <code>Call EnableRemote(BOARD_ID, intAddrList())</code>,  <code>Call SendGPIB(osa, \":mmem:stor:grap color,bmp,\"\"test\"\",int\")</code>, <code>= RecieveBinaryGPIB(osa, byteData())</code>, etc...</p>\n\n<p>My first guess would be that I am simply missing the correct library. (Or is there any deeper issue here?). For now, I added the VISA COM 3.0 Type Library and the VISA COM 488.2 Formatted I/O 1.0 to the Excel references.</p>\n\n<p>Here is a sample code from YOKOGAWA (slightly edited) that can be found online and applies to Visual Basics, but that I could not run in VBA. I removed most of the code for clarity purpose. It simply saves a screenshot in internal memory.</p>\n\n<p>Private Sub SaveImage()</p>\n\n<pre><code>Const BOARD_ID = 0 'GP-IB Interface card Address\nConst osa = 1 'OSA GP-IB Address\n\nDim intAddrList(31) As Integer\n\n'----- GP-IB Interface setting\n' send IFC\n Call SendIFC(BOARD_ID)\n\n' assert th REN GPIB line\nintAddrList(0) = NOADDR\nCall EnableRemote(BOARD_ID, intAddrList())\n\n' GPIB time out setting\nCall ibtmo(BOARD_ID, T30s) 'Time out = 30sec\n\n'----- send command to OSA\nCall SendGPIB(osa, \"CFORM1\") ' Command mode set(AQ637X mode)\nCall SendGPIB(osa, \":mmem:stor:grap color,bmp,\"\"test\"\",int\")\n\n'----- Disconnect\nCall EnableLocal(BOARD_ID, intAddrList())\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["sql", "ms-access", "vba"], "comments": [{"owner": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "edited": false, "score": 1, "creation_date": 1534948547, "post_id": 51969270, "comment_id": 90888915, "body": "Why is the last value 0 but the second 1?  You are probably better off doing this in VBA.  Although possible in MS Access, the query is way harder than it would be in other databases."}, {"owner": {"reputation": 604, "user_id": 3683930, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DPmwN.png?s=128&g=1", "display_name": "Leroy", "link": "https://stackoverflow.com/users/3683930/leroy"}, "reply_to_user": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "edited": false, "score": 0, "creation_date": 1534948600, "post_id": 51969270, "comment_id": 90888957, "body": "the last value is 0 because as soon as they have a week with no fails then it resets to 0. Hope that makes sense"}, {"owner": {"reputation": 604, "user_id": 3683930, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DPmwN.png?s=128&g=1", "display_name": "Leroy", "link": "https://stackoverflow.com/users/3683930/leroy"}, "reply_to_user": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "edited": false, "score": 0, "creation_date": 1534948668, "post_id": 51969270, "comment_id": 90889017, "body": "The second value is 1 because the first two records are for the same person on the same day and there is at least one fail. Unfortunately, Access is the only DB I have available atm"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1534948921, "post_id": 51969270, "comment_id": 90889187, "body": "Your question and comments is mixing &quot;days / date&quot; and &quot;weeks&quot;, that is a bit confusing."}, {"owner": {"reputation": 604, "user_id": 3683930, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DPmwN.png?s=128&g=1", "display_name": "Leroy", "link": "https://stackoverflow.com/users/3683930/leroy"}, "edited": false, "score": 0, "creation_date": 1534948986, "post_id": 51969270, "comment_id": 90889239, "body": "Oh yes, Sorry, I just meant days"}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1534949037, "post_id": 51969270, "comment_id": 90889274, "body": "The first two rows of your sample could be swapped. How do you know which comes first ?"}, {"owner": {"reputation": 604, "user_id": 3683930, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DPmwN.png?s=128&g=1", "display_name": "Leroy", "link": "https://stackoverflow.com/users/3683930/leroy"}, "edited": false, "score": 0, "creation_date": 1534949103, "post_id": 51969270, "comment_id": 90889321, "body": "That is correct. If there is at least one fail on that day then all records for that person on that day should have the same number in the consecFailDays"}, {"owner": {"reputation": 1018, "user_id": 9706678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fj42a.png?s=128&g=1", "display_name": "Jiggles32", "link": "https://stackoverflow.com/users/9706678/jiggles32"}, "edited": false, "score": 0, "creation_date": 1534952405, "post_id": 51969270, "comment_id": 90891319, "body": "Is there an <code>ID</code> column that you left off for the purposes of the example, or does the table not have a primary key?"}, {"owner": {"reputation": 604, "user_id": 3683930, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DPmwN.png?s=128&g=1", "display_name": "Leroy", "link": "https://stackoverflow.com/users/3683930/leroy"}, "edited": false, "score": 0, "creation_date": 1534952581, "post_id": 51969270, "comment_id": 90891430, "body": "Yes, there is an autonumber column in the table. Sorry, should&#39;ve mentioned that"}], "answers": [{"comments": [{"owner": {"reputation": 604, "user_id": 3683930, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DPmwN.png?s=128&g=1", "display_name": "Leroy", "link": "https://stackoverflow.com/users/3683930/leroy"}, "edited": false, "score": 0, "creation_date": 1535010567, "post_id": 51975671, "comment_id": 90911173, "body": "When everybody else said it couldn&#39;t be done, one man wouldn&#39;t take no for an answer. ComputerVersteher you are truly a god amongst men!"}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 1, "creation_date": 1535011776, "post_id": 51975671, "comment_id": 90911860, "body": "I&#39;m quite sure my solution can be improved (this was my first more complex subquery exercise), but this is the wrong place. If you need optimized sql code, post my sql at <a href=\"https://dba.stackexchange.com/\">dba.stackexchange.com</a> with proper sample data. That&#39;s where the database pro&#39;s hang around;)"}], "tags": [], "owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "is_accepted": true, "score": 2, "last_activity_date": 1534978547, "last_edit_date": 1534978547, "creation_date": 1534974675, "answer_id": 51975671, "question_id": 51969270, "link": "https://stackoverflow.com/questions/51969270/access-sql-count-consecutive-weeks-with-a-fail/51975671#51975671", "title": "Access SQL - Count consecutive weeks with a fail", "body": "<p>You need several subqueries to get the last date with a passed test and no fail, then count the days between this date and testDate:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT t1.ID\n    ,t1.testDate\n    ,t1.Person\n    ,t1.[Pass?]\n    ,(\n        SELECT count(testDate)\n        FROM (\n            SELECT DISTINCT testDate\n                ,Person\n                ,[Pass?]\n            FROM yourTable\n            ) AS t2\n        WHERE t2.[Pass?] = false\n            AND t2.Person = t1.Person\n            AND t2.testDate &gt;= Nz((\n                            SELECT max(t3.testDate)\n                            FROM (\n                                SELECT t4.testDate\n                                    ,t4.Person\n                                FROM yourTable AS t4\n                                WHERE (\n                                        ((t4.[Pass?]) = True)\n                                        AND (\n                                            (\n                                                (\n                                                    SELECT count(*) AS failed\n                                                    FROM yourTable AS t5\n                                                    WHERE t5.testDate = t4.testDate\n                                                        AND t5.Person = t4.Person\n                                                        AND t5.[Pass?] = false\n                                                    )\n                                                ) = 0\n                                            )\n                                        )\n                                ) AS t3\n                            WHERE t1.Person = t3.Person\n                                AND t3.testDate &lt;= [t1].[testDate]\n                            GROUP BY Person\n                            ))\n                AND t2.testDate &lt;= t1.testDate\n        ) AS ConsecFailDays\nFROM yourTable AS t1;\n</code></pre>\n\n<p>Where t2 counts the distinct days (you can drop <code>DISTINCT</code> if just one fail per day is posible to speed up).</p>\n\n<p>t3 are the days with passed tests and no fail.</p>\n\n<p>t4 are the days with passed tests (and maybe failed tests).</p>\n\n<p>t5 counts the failed tests on a day with a passed test.</p>\n\n<p>As you wanted an <code>Update-Query</code> you can use:</p>\n\n<pre><code>UPDATE yourTable SET ConsecFailDays = DLookUp(\"ConsecFailDays\",\"newQuery\",\"ID = \" &amp; yourTable.ID)\n</code></pre>\n\n<p>but you should try the <code>Select-Query</code> with indices first. If performance is too poor you can use the update, but you have to run it every time your data changes.</p>\n\n<p><strong>Suggestions:</strong> </p>\n\n<ul>\n<li><p>Don't use specialchars like <code>?</code> in <code>Pass?</code> for column or table names to avoid being forced to use square brackets.</p></li>\n<li><p>Person should be a foreign-key to table persons as persons can have equal names (e.g John Smith).</p></li>\n<li>[Pass?] should be boolean (true/false). If you want to stay on string you have to replace <code>[Pass?] = false</code> with <code>[Pass?] = 'Fail'</code> and <code>[Pass?] = true</code> with \n<code>[Pass?] = 'Pass'</code></li>\n<li>there should be an index for <code>testDate</code>, <code>Person</code> and a combined index for <code>testDate, Person</code> to increase query performance.</li>\n</ul>\n"}], "owner": {"reputation": 604, "user_id": 3683930, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DPmwN.png?s=128&g=1", "display_name": "Leroy", "link": "https://stackoverflow.com/users/3683930/leroy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 51975671, "answer_count": 1, "score": 4, "last_activity_date": 1534978547, "creation_date": 1534948504, "last_edit_date": 1534953233, "question_id": 51969270, "link": "https://stackoverflow.com/questions/51969270/access-sql-count-consecutive-weeks-with-a-fail", "title": "Access SQL - Count consecutive weeks with a fail", "body": "<p>I have a table in Access that has a record of test results for each person for each day. Some people may have taken more than one test on the same day. I have shown a simplified version of this table below:</p>\n\n<pre><code>|  ID | testDate  |  Person   |   Pass? | ConsecFailDays |\n----------------------------------------------------------\n|  01 |  01/08/18 |  John     |  Fail   |                |\n|  02 |  01/08/18 |  John     |  Pass   |                |\n|  03 |  03/08/18 |  John     |  Fail   |                |\n|  04 |  01/08/18 |  Mark     |  Fail   |                |\n|  05 |  02/08/18 |  Mark     |  Pass   |                |\n</code></pre>\n\n<p>I have tried to write an SQL UPDATE query that will update the last column with the number of consecutive days that that person has failed at least one test (not necessarily consecutive calender days, just the days that they actually did a test). The final result should look like this...</p>\n\n<pre><code>|  ID | testDate  |  Person   |   Pass? | ConsecFailDays |\n----------------------------------------------------------\n|  01 |  01/08/18 |  John     |  Fail   |       1        |\n|  02 |  01/08/18 |  John     |  Pass   |       1        |\n|  03 |  03/08/18 |  John     |  Fail   |       2        |\n|  04 |  01/08/18 |  Mark     |  Fail   |       1        |\n|  05 |  02/08/18 |  Mark     |  Pass   |       0        |\n</code></pre>\n\n<p>I was really struggling to get this to work and in the end I resorted to using VBA to create a recordset of each unique person and then loop through each day for that person to check if they had a fail on that day. My dataset is quite large and it is taking hours to run. </p>\n\n<p>I expect that a query that operates on the entire set of data would be much quicker. Does anyone know if there is an SQL solution to this after all?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 10249099, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Qb1m5Nr1Njw/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPcUHZA3qqBnpoWjdGb5dkIj0U1GQ/mo/photo.jpg?sz=128", "display_name": "Gong", "link": "https://stackoverflow.com/users/10249099/gong"}, "edited": false, "score": 0, "creation_date": 1534948921, "post_id": 51969201, "comment_id": 90889188, "body": "Thanks! It works. I&#39;ve realized that it&#39;s such a simple question."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 4, "last_activity_date": 1534948282, "creation_date": 1534948282, "answer_id": 51969201, "question_id": 51969167, "link": "https://stackoverflow.com/questions/51969167/duplicate-code-in-if-then-else-statement/51969201#51969201", "title": "Duplicate code in if then ... else statement", "body": "<p>Try:</p>\n\n<pre><code>If \"Condition A\" Then\n   \"Action A\"\nEnd If\n\n\"Action B\" ' &lt;-- take this outside the If\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 10249099, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Qb1m5Nr1Njw/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPcUHZA3qqBnpoWjdGb5dkIj0U1GQ/mo/photo.jpg?sz=128", "display_name": "Gong", "link": "https://stackoverflow.com/users/10249099/gong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 51969201, "answer_count": 1, "score": 0, "last_activity_date": 1534948350, "creation_date": 1534948152, "question_id": 51969167, "link": "https://stackoverflow.com/questions/51969167/duplicate-code-in-if-then-else-statement", "title": "Duplicate code in if then ... else statement", "body": "<p>I intend to perform two actions by clicking a button. let's say Action A and Action B. Following is the code:</p>\n\n<pre><code>Private Sub CommandButton2_Click()\n  If \"Condition A\" Then\n    \"Action A\"\n    \"Action B\"\n  Else\n    \"Action B\"\n  End If\n</code></pre>\n\n<p>In my code, the Action B part is duplicated before and after \"Else\" statement. I am wondering if there is a way to make the code slimmer.</p>\n"}, {"tags": ["arrays", "vba", "list", "loops", "matching"], "comments": [{"owner": {"reputation": 89, "user_id": 8517515, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e455b59239d6aea71e8a009719a92e98?s=128&d=identicon&r=PG&f=1", "display_name": "learningthisstuff", "link": "https://stackoverflow.com/users/8517515/learningthisstuff"}, "edited": false, "score": 0, "creation_date": 1534959452, "post_id": 51969100, "comment_id": 90895127, "body": "Tried adding them by including them as a range (rng, rng1, rng2) but that did not work either.  Hoping someone can help, I am stumped."}, {"owner": {"reputation": 89, "user_id": 8517515, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e455b59239d6aea71e8a009719a92e98?s=128&d=identicon&r=PG&f=1", "display_name": "learningthisstuff", "link": "https://stackoverflow.com/users/8517515/learningthisstuff"}, "edited": false, "score": 0, "creation_date": 1534967737, "post_id": 51969100, "comment_id": 90898854, "body": "Anyone?  14 views, I know there are some (many) people on here who know this better than I do!"}, {"owner": {"reputation": 89, "user_id": 8517515, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e455b59239d6aea71e8a009719a92e98?s=128&d=identicon&r=PG&f=1", "display_name": "learningthisstuff", "link": "https://stackoverflow.com/users/8517515/learningthisstuff"}, "edited": false, "score": 0, "creation_date": 1535046356, "post_id": 51969100, "comment_id": 90932702, "body": "Still stuck here, please help."}, {"owner": {"reputation": 89, "user_id": 8517515, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e455b59239d6aea71e8a009719a92e98?s=128&d=identicon&r=PG&f=1", "display_name": "learningthisstuff", "link": "https://stackoverflow.com/users/8517515/learningthisstuff"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1535050752, "post_id": 51969100, "comment_id": 90934799, "body": "I get it, but it works...I just need help in pulling the other fields in so I can place them in the array table."}, {"owner": {"reputation": 89, "user_id": 8517515, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e455b59239d6aea71e8a009719a92e98?s=128&d=identicon&r=PG&f=1", "display_name": "learningthisstuff", "link": "https://stackoverflow.com/users/8517515/learningthisstuff"}, "edited": false, "score": 0, "creation_date": 1536261442, "post_id": 51969100, "comment_id": 91371000, "body": "Hoping @mathieu guindon may have a suggestion as he has helped explain some items to me before.  I am still stuck on this."}], "owner": {"reputation": 89, "user_id": 8517515, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e455b59239d6aea71e8a009719a92e98?s=128&d=identicon&r=PG&f=1", "display_name": "learningthisstuff", "link": "https://stackoverflow.com/users/8517515/learningthisstuff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1535391526, "creation_date": 1534947954, "last_edit_date": 1535391526, "question_id": 51969100, "link": "https://stackoverflow.com/questions/51969100/add-cell-values-to-lists", "title": "Add Cell Values to Lists", "body": "<p>I have a macro that runs through two lists, matching up one column against another.  It then takes these items and computes various pieces of data, placing the results in a table array for evaluation by users.  <a href=\"https://i.stack.imgur.com/vLbBR.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vLbBR.jpg\" alt=\"Sample Data\"></a></p>\n\n<p>The above data is checked based on a match of ID1 to ID2.  The resulting array is below:\n<a href=\"https://i.stack.imgur.com/Ns2tq.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ns2tq.jpg\" alt=\"Table\"></a></p>\n\n<p>So equal matches are instances where there are both matches in each list AND there are equal quantity of instances (perfect).  Unequal matches means there are matches, but one may show up in a list more times than the other list.  The next column notes how many there are in list1 vs list2.  You get the idea I hope.  </p>\n\n<p>This works perfectly but now the users have asked me to also pull in Last1 and Last2 to the table.  So they would have the associated last names with the IDs.  Below is the portion of code that runs the matching and creates the lists.  I have been having trouble adding those cells to the lists.  Normally I would do the offset method but I cannot figure this piece out.  Hoping someone smarter than me has an idea.</p>\n\n<p>In the 'Select Case' section, that tells the code where to put the results for the table array.</p>\n\n<p>Thanks, please help!</p>\n\n<pre><code>Dim rng As Range, Dn As Range, n As Long\nDim oVal As Variant, CC As Long, ccc As Long, cccc As Long\nDim Q As Variant, K As Variant, c As Long, rng1 As Range\nDim List1 As Long, List2 As Long, oMax As Long\nSet rng = Range(Range(\"C2\"), Range(\"C\" &amp; Rows.Count).End(xlUp))\nSet rng1 = Range(Range(\"H2\"), Range(\"H\" &amp; Rows.Count).End(xlUp))\n    Range(\"j:m\").Clear\nWith CreateObject(\"scripting.dictionary\")\n.CompareMode = vbTextCompare\n oVal = Array(rng, rng1)\nFor n = 0 To 1\n    For Each Dn In oVal(n)\n        List1 = 0: List2 = 0\n        If Not .Exists(Dn.Value) Then\n            If n = 0 Then List1 = 1 Else List2 = 1\n            .Add Dn.Value, Array(List1, List2)\n        Else\n            Q = .Item(Dn.Value)\n                If n = 0 Then Q(0) = Q(0) + 1 Else Q(1) = Q(1) + 1\n            .Item(Dn.Value) = Q\n        End If\nNext Dn\nNext n\nc = 1: CC = 1: ccc = 1: cccc = 1\nFor Each K In .keys\n    Select Case True\n        Case .Item(K)(0) = .Item(K)(1)\n            c = c + 1\n         Cells(c, \"J\") = K\n         Cells(c, \"K\") = .Item(K)(O)\n        Case .Item(K)(0) = 0\n            ccc = ccc + 1\n            Cells(ccc, \"N\") = K\n            Cells(ccc, \"O\") = .Item(K)(1)\n        Case .Item(K)(1) = 0\n            cccc = cccc + 1\n            Cells(cccc, \"P\") = K\n            Cells(cccc, \"Q\") = .Item(K)(0)\n        Case .Item(K)(0) &lt;&gt; .Item(K)(1)\n            CC = CC + 1\n            Cells(CC, \"L\") = K\n            Cells(CC, \"M\") = .Item(K)(0) &amp; \", \" &amp; .Item(K)(1)\n    End Select\nNext K\nEnd With\noMax = Application.Max(c, CC, ccc, cccc)\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1534947214, "post_id": 51968774, "comment_id": 90887977, "body": "<code>If &quot;123456&quot; Like &quot;123?56&quot; Then</code>? <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/like-operator\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/language/reference/&hellip;</a>"}, {"owner": {"reputation": 258, "user_id": 7474480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/--kFa93-PpXw/AAAAAAAAAAI/AAAAAAAAADw/yJStAXpOXqw/photo.jpg?sz=128", "display_name": "Howard P", "link": "https://stackoverflow.com/users/7474480/howard-p"}, "edited": false, "score": 2, "creation_date": 1534947302, "post_id": 51968774, "comment_id": 90888031, "body": "Check out RegEx. It&#39;s very commonly used for this application. <a href=\"https://blog.udemy.com/vba-regex/\" rel=\"nofollow noreferrer\">blog.udemy.com/vba-regex</a>"}, {"owner": {"reputation": 85, "user_id": 9755070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2c8ee2c00f21fc240066af0756cc985?s=128&d=identicon&r=PG&f=1", "display_name": "a1a1a1a1a1", "link": "https://stackoverflow.com/users/9755070/a1a1a1a1a1"}, "edited": false, "score": 0, "creation_date": 1534950267, "post_id": 51968774, "comment_id": 90890052, "body": "Like oprator made it. Thanks all !"}], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 9755070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2c8ee2c00f21fc240066af0756cc985?s=128&d=identicon&r=PG&f=1", "display_name": "a1a1a1a1a1", "link": "https://stackoverflow.com/users/9755070/a1a1a1a1a1"}, "edited": false, "score": 0, "creation_date": 1534950208, "post_id": 51968918, "comment_id": 90890005, "body": "Many thanks. How could I not know this operator.   Sub test() Dim i As Integer, j As Integer, count As Integer i = 1: j = 1: count = 2  Dim lastrow As Integer lastrow = Cells(1000000, 1).End(xlUp).Row   For i = 1 To lastrow count = 2     For j = 1 To lastrow         If Cells(i, 1).Value Like Cells(j, 1).Value Then             Cells(i, count).Value = j &amp; &quot;fits in &quot; &amp; i             count = count + 1         End If     Next j Next i  End Sub  This made it."}], "tags": [], "owner": {"reputation": 5010, "user_id": 1666276, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c2ece7e507cc4c22f1a584f135ac660d?s=128&d=identicon&r=PG", "display_name": "Richard Hansell", "link": "https://stackoverflow.com/users/1666276/richard-hansell"}, "is_accepted": false, "score": 0, "last_activity_date": 1534947446, "creation_date": 1534947446, "answer_id": 51968918, "question_id": 51968774, "link": "https://stackoverflow.com/questions/51968774/vba-check-if-a-fits-in-b-but/51968918#51968918", "title": "VBA check if A fits in B but", "body": "<p>Here's some very simple code to get you started:</p>\n\n<pre><code>Sub CheckStrings()\n\n    Dim string1 As String\n    Dim string2 As String\n    Dim string3 As String\n    Dim string4 As String        \n\n    string1 = \"123?56\"\n    string2 = \"123456\"\n    string3 = \"123B56\"\n    string4 = \"notamatch\"\n\n    If string2 Like string1 Then\n        Cells(1, 1) = \"Match\"\n    Else\n        Cells(1, 1) = \"No Match\"\n    End If\n\n    If string3 Like string1 Then\n        Cells(1, 2) = \"Match\"\n    Else\n        Cells(1, 2) = \"No Match\"\n    End If\n\n    If string4 Like string1 Then\n        Cells(1, 3) = \"Match\"\n    Else\n        Cells(1, 3) = \"No Match\"\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>When I run that it puts Match Match No Match into the top corner of my current worksheet.  Hopefully that's enough to adapt to a proper solution?</p>\n"}], "owner": {"reputation": 85, "user_id": 9755070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2c8ee2c00f21fc240066af0756cc985?s=128&d=identicon&r=PG&f=1", "display_name": "a1a1a1a1a1", "link": "https://stackoverflow.com/users/9755070/a1a1a1a1a1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1534947446, "creation_date": 1534947031, "last_edit_date": 1534947150, "question_id": 51968774, "link": "https://stackoverflow.com/questions/51968774/vba-check-if-a-fits-in-b-but", "title": "VBA check if A fits in B but", "body": "<p>I'm not sure how to explain that so I will just give you straight an example.</p>\n\n<p>I have some strings such as: <code>123?56</code> (the <code>?</code> means any character). I want to check if a string can fit in another.</p>\n\n<p>Example:</p>\n\n<ul>\n<li><code>123456</code> fits in <code>123?56</code></li>\n<li><code>123B56</code> fits in <code>123?56</code> too.</li>\n</ul>\n\n<p>You get the principle.</p>\n\n<p>Now, there are actually longer strings more like <code>1234?9ZZ9???72?</code> and what I want to do is to check if any of the other string present in the column where I have all my data fits in any other string from the same column.</p>\n\n<p>Ideally it would return me every groups of \"same numbers\", but that part I'm confident I can do it. I just don't know how to approach the <code>?</code> char.</p>\n\n<p>The size is rarely more than 4-10K row long.</p>\n"}, {"tags": ["vba", "excel"], "owner": {"reputation": 11, "user_id": 10260031, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210079346700533/picture?type=large", "display_name": "Trey", "link": "https://stackoverflow.com/users/10260031/trey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 238, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1534947251, "creation_date": 1534946429, "last_edit_date": 1534947251, "question_id": 51968596, "link": "https://stackoverflow.com/questions/51968596/vba-copy-and-paste-array-formulas", "title": "VBA Copy and Paste Array Formulas", "body": "<p>I have an array formula that fills down over 2,000 rows, so of course it slows down the worksheet. </p>\n\n<p>My goal is to write a macro that copies and pastes values as it fills down. </p>\n\n<p>Currently the macro fills down the formula then copies and pastes, which is still taking too long.</p>\n\n<p>This is my current code below:</p>\n\n<pre><code>Sub ArrayFillDown()\n    Selection.FormulaArray = \"=VLOOKUP(INDEX(keys,MATCH(TRUE,ISNUMBER(SEARCH(keys,RC[2])),0)),KEY!C:C[1],2,0)\"\n    Range(\"A2\").AutoFill Destination:=Range(\"A2:A\" &amp; Cells(Rows.Count, \"B\").End(xlUp).Row)\n    Range(\"A2\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Selection.Value = Selection.Value\nEnd Sub\n</code></pre>\n\n<p>If you have any recommendations please let me know.</p>\n"}, {"tags": ["arrays", "excel", "vba", "loops"], "comments": [{"owner": {"reputation": 528, "user_id": 8381665, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g7T0D.png?s=128&g=1", "display_name": "Slaqr", "link": "https://stackoverflow.com/users/8381665/slaqr"}, "edited": false, "score": 0, "creation_date": 1534947033, "post_id": 51968530, "comment_id": 90887862, "body": "I might be overlooking something.. but why are you using a nested for loop in this case?"}, {"owner": {"reputation": 71, "user_id": 10031203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5913fe1a1c0c1cd1161c29c87a665b9?s=128&d=identicon&r=PG&f=1", "display_name": "Waimea", "link": "https://stackoverflow.com/users/10031203/waimea"}, "reply_to_user": {"reputation": 528, "user_id": 8381665, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g7T0D.png?s=128&g=1", "display_name": "Slaqr", "link": "https://stackoverflow.com/users/8381665/slaqr"}, "edited": false, "score": 0, "creation_date": 1534947144, "post_id": 51968530, "comment_id": 90887932, "body": "Thank you for your reply! I am iterating through 4 ComboBoxes, the for loop loops through 26 items in ComboBox3 and ComboBox4."}, {"owner": {"reputation": 528, "user_id": 8381665, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g7T0D.png?s=128&g=1", "display_name": "Slaqr", "link": "https://stackoverflow.com/users/8381665/slaqr"}, "edited": false, "score": 0, "creation_date": 1534947452, "post_id": 51968530, "comment_id": 90888129, "body": "In the code above you are putting values (l or n) into the comboboxes&#39; Listindex, so a different item in the list will be selected.. Is it the selected item values you want to store to an array?"}, {"owner": {"reputation": 528, "user_id": 8381665, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g7T0D.png?s=128&g=1", "display_name": "Slaqr", "link": "https://stackoverflow.com/users/8381665/slaqr"}, "edited": false, "score": 0, "creation_date": 1534947560, "post_id": 51968530, "comment_id": 90888212, "body": "Also, the lines that copy values from one sheet to another are included in a 25x25 nested loop, but there aren&#39;t any variables in these lines. Is the data to be copied dependent on the value of the comboboxes? (Just trying to clarify the situation before coming up with a possible solution)"}, {"owner": {"reputation": 71, "user_id": 10031203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5913fe1a1c0c1cd1161c29c87a665b9?s=128&d=identicon&r=PG&f=1", "display_name": "Waimea", "link": "https://stackoverflow.com/users/10031203/waimea"}, "reply_to_user": {"reputation": 528, "user_id": 8381665, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g7T0D.png?s=128&g=1", "display_name": "Slaqr", "link": "https://stackoverflow.com/users/8381665/slaqr"}, "edited": false, "score": 0, "creation_date": 1534947812, "post_id": 51968530, "comment_id": 90888371, "body": "I attached an image with some of the output of my code. The output is dependent on the ComboBoxes and everytime I change the value of the comboboxes the values to be copied changes. L&#228;n1 = ComboBox1, Kommun1 = ComboBox3, L&#228;n2 = ComboBox2, Kommun2 = ComboBox4. In the best case scenario I would like to change the n-dimension of the array to add or remove variables!"}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 10031203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5913fe1a1c0c1cd1161c29c87a665b9?s=128&d=identicon&r=PG&f=1", "display_name": "Waimea", "link": "https://stackoverflow.com/users/10031203/waimea"}, "edited": false, "score": 0, "creation_date": 1534958834, "post_id": 51971946, "comment_id": 90894848, "body": "Thank you very much for your reply and for your code learnAsWeGo! This works very fast on my computer and I am going to follow your example and look at the locals window to visualize the arrays."}, {"owner": {"reputation": 2207, "user_id": 3088510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WDADX.png?s=128&g=1", "display_name": "learnAsWeGo", "link": "https://stackoverflow.com/users/3088510/learnaswego"}, "reply_to_user": {"reputation": 71, "user_id": 10031203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5913fe1a1c0c1cd1161c29c87a665b9?s=128&d=identicon&r=PG&f=1", "display_name": "Waimea", "link": "https://stackoverflow.com/users/10031203/waimea"}, "edited": false, "score": 0, "creation_date": 1534965135, "post_id": 51971946, "comment_id": 90897698, "body": "@Waimea glad to hear it!!"}, {"owner": {"reputation": 71, "user_id": 10031203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5913fe1a1c0c1cd1161c29c87a665b9?s=128&d=identicon&r=PG&f=1", "display_name": "Waimea", "link": "https://stackoverflow.com/users/10031203/waimea"}, "edited": false, "score": 0, "creation_date": 1534971209, "post_id": 51971946, "comment_id": 90900366, "body": "Would it be possible to get the output of your code to match the way the data is arranged in my image? :)"}, {"owner": {"reputation": 2207, "user_id": 3088510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WDADX.png?s=128&g=1", "display_name": "learnAsWeGo", "link": "https://stackoverflow.com/users/3088510/learnaswego"}, "reply_to_user": {"reputation": 71, "user_id": 10031203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5913fe1a1c0c1cd1161c29c87a665b9?s=128&d=identicon&r=PG&f=1", "display_name": "Waimea", "link": "https://stackoverflow.com/users/10031203/waimea"}, "edited": false, "score": 0, "creation_date": 1534999579, "post_id": 51971946, "comment_id": 90906617, "body": "@Waimea if i get a chance i will try!"}], "tags": [], "owner": {"reputation": 2207, "user_id": 3088510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WDADX.png?s=128&g=1", "display_name": "learnAsWeGo", "link": "https://stackoverflow.com/users/3088510/learnaswego"}, "is_accepted": true, "score": 2, "last_activity_date": 1534958562, "last_edit_date": 1534958562, "creation_date": 1534957758, "answer_id": 51971946, "question_id": 51968530, "link": "https://stackoverflow.com/questions/51968530/excel-vba-using-an-array-to-speed-up-code/51971946#51971946", "title": "Excel VBA using an array to speed up code", "body": "<p>This code goes through each <code>combobox</code> in a given <code>worksheet</code>, generates an <code>array</code> that contains the list values for each <code>comobox</code> list, then prints all of the contents into that first column. myArray only has a single dimension. Its contents are other <code>arrays</code>.  If the <code>comoboxes</code> have different list lengths, a <code>jagged array</code> is created. </p>\n\n<p>To help visualize the <code>arrays</code>, enable the <code>Locals Window</code> by going to view in the menu bar and then selecting <code>Locals Window</code>. See pic below the code.</p>\n\n<pre><code>Option Explicit\nSub main()\nDim ws                                                 As Worksheet\nDim mainArray()                                          As Variant\nDim ctrl                                               As Object\nDim numComboBoxes                                      As Long\n\n    Set ws = ActiveSheet\n\n    numComboBoxes = GetNumberOfComboBoxesInSheet(ws)\n    mainArray = GenerateJaggedArrayComboBoxListValues(ws, numComboBoxes)\n    PrintArray ws, mainArray\nEnd Sub\n\nFunction GetNumberOfComboBoxesInSheet(ByRef ws As Worksheet) As Long\nDim ctrl As Object\n    For Each ctrl In ws.OLEObjects\n        If TypeName(ctrl.Object) = \"ComboBox\" Then\n            GetNumberOfComboBoxesInSheet = GetNumberOfComboBoxesInSheet + 1\n        End If\n    Next ctrl\nEnd Function\n\nFunction GenerateJaggedArrayComboBoxListValues(ByRef ws As Worksheet, ByVal numComboBoxes As Long) As Variant()\nDim ctrl                                                As Object\nDim tempPrimaryArray()                                  As Variant\nDim tempArray()                                         As Variant\nDim x                                                   As Long\nDim y                                                   As Long\nDim listNum                                             As Long\n\n   ReDim tempPrimaryArray(0 To numComboBoxes - 1)\n    x = 0\n    For Each ctrl In ws.OLEObjects\n        If TypeName(ctrl.Object) = \"ComboBox\" Then\n            y = 0\n            For listNum = 0 To ctrl.Object.ListCount - 1\n                ReDim Preserve tempArray(0, 0 To y)\n                tempArray(0, y) = ctrl.Object.List(listNum, 0)\n                y = y + 1\n            Next listNum\n            tempPrimaryArray(x) = tempArray\n            Erase tempArray\n            x = x + 1\n        End If\n    Next ctrl\nGenerateJaggedArrayComboBoxListValues = tempPrimaryArray()\nEnd Function\n\nSub PrintArray(ByRef ws As Worksheet, ByRef mainArray As Variant)\nDim counter                                             As Long\nDim x                                                   As Long\nDim y                                                   As Long\nDim tempArray()                                         As Variant\n\n    counter = 1\n    For x = LBound(mainArray, 1) To UBound(mainArray, 1)\n        tempArray = mainArray(x)\n        For y = LBound(tempArray, 2) To UBound(tempArray, 2)\n            ws.Range(\"A\" &amp; counter) = tempArray(0, y)\n            counter = counter + 1\n        Next y\n    Next x\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/kwobf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kwobf.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 71, "user_id": 10031203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5913fe1a1c0c1cd1161c29c87a665b9?s=128&d=identicon&r=PG&f=1", "display_name": "Waimea", "link": "https://stackoverflow.com/users/10031203/waimea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 0, "accepted_answer_id": 51971946, "answer_count": 1, "score": 1, "last_activity_date": 1536399776, "creation_date": 1534946197, "last_edit_date": 1536399776, "question_id": 51968530, "link": "https://stackoverflow.com/questions/51968530/excel-vba-using-an-array-to-speed-up-code", "title": "Excel VBA using an array to speed up code", "body": "<p>I am trying to create an array, store values in the array and then write the values of the array to a spreadsheet in VBA. This codes takes 1+ hour to run on my computer and I think that an array could really speed up the code.</p>\n\n<p>However, I need help with creating the array, populating the array from the comboboxes and finally write the values of the array to the worksheet.</p>\n\n<ol>\n<li>Create an n-dimensional array</li>\n<li>Fill the n-dimensional array with the values of the ComboBoxes.</li>\n<li>Iterate through all ComboBoxes.</li>\n<li>Store values in the array</li>\n<li><p>Write values from the array to the spreadsheet</p>\n\n<p>Sub WantToUseArray()</p>\n\n<pre><code>Dim k As Integer\nDim l As Integer\n\nSheets(\"Test\").ComboBox1.ListIndex = 0\n\nFor l = 0 To 25\nSheets(\"Test\").ComboBox3.ListIndex = l\n\nSheets(\"Test\").ComboBox2.ListIndex = 0\n\nFor n = 0 To 25\nSheets(\"Test\").ComboBox4.ListIndex = n\n\nSheets(\"Points\").Select\n\nDim LR As Long\nLR = Cells(Rows.Count, 1).End(xlUp).Row + 1\n\nCells(LR, \"A\").Value = Sheets(\"Test\").Range(\"G5\").Value\nCells(LR, \"B\").Value = Sheets(\"Test\").Range(\"G6\").Value\n\nCells(LR, \"C\").Value = Sheets(\"Test\").Range(\"O5\").Value\nCells(LR, \"D\").Value = Sheets(\"Test\").Range(\"O6\").Value\n\nCells(LR, \"E\").Value = Sheets(\"Test\").Range(\"X5\").Value\nCells(LR, \"F\").Value = Sheets(\"Test\").Range(\"X6\").Value\n\nCells(LR, \"G\").Value = Sheets(\"Test\").Range(\"G6\").Value + Sheets(\"Test\").Range(\"X6\").Value\n\nCells(LR, \"H\").Value = Sheets(\"Test\").Range(\"X6\").Value + Sheets(\"Test\").Range(\"G6\").Value\n\nCells(LR, \"I\").Value = Sheets(\"Test\").Range(\"K40\").Value\nCells(LR, \"J\").Value = Sheets(\"Test\").Range(\"K41\").Value\n\nCells(LR, \"K\").Value = Sheets(\"Test\").Range(\"K51\").Value\nCells(LR, \"L\").Value = Sheets(\"Test\").Range(\"K52\").Value\n\n\n\nNext\nNext\n\nEnd Sub\n</code></pre></li>\n</ol>\n"}, {"tags": ["vba", "excel", "ms-access"], "comments": [{"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1534945505, "post_id": 51968202, "comment_id": 90886841, "body": "Yes, it is possible. As a first step I would recommend to search for &quot;Excel vba connect ADODB access database run query&quot; This should get you starting."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1534945534, "post_id": 51968202, "comment_id": 90886865, "body": "Which version of Excel do you have? You should be able to link directly to the Access query and return it as a table to a worksheet, using either MSQuery or Get and Transform (a.k.a. Power Query). Then all you need to is use the Refresh button to update it."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1534945920, "post_id": 51968202, "comment_id": 90887138, "body": "@Rory: Right, this is probably the better and easier way to go for the OP"}, {"owner": {"reputation": 1254, "user_id": 3559353, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/8111e0c939979d430cf928c00ddc59cd?s=128&d=identicon&r=PG", "display_name": "Suplanus", "link": "https://stackoverflow.com/users/3559353/suplanus"}, "edited": false, "score": 0, "creation_date": 1534946091, "post_id": 51968202, "comment_id": 90887256, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/16221766/vba-excel-update-record-in-access\">VBA Excel - UPDATE record in ACCESS</a>"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1535548695, "post_id": 51968202, "comment_id": 91106800, "body": "Sorry but what are you doing. If you use VBA and write soimething like that <code>Set sQuery = &quot;Select * From Customer;&quot;</code> and sQuery is a string then you have not understood the basics.  Also <code>GetSqlServerData(sQuery, sRange) </code> cannot work. Again, you make basic errors here. My expectations were higher. Please have a look <a href=\"https://www.homeandlearn.org/\" rel=\"nofollow noreferrer\">here</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2071, "user_id": 9990662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8262X.jpg?s=128&g=1", "display_name": "Zack", "link": "https://stackoverflow.com/users/9990662/zack"}, "edited": false, "score": 1, "creation_date": 1535547478, "post_id": 51968534, "comment_id": 91105897, "body": "Although if the query is in Access, it might be easier to use <code>DAO</code> rather than <code>ADO</code>."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 2071, "user_id": 9990662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8262X.jpg?s=128&g=1", "display_name": "Zack", "link": "https://stackoverflow.com/users/9990662/zack"}, "edited": false, "score": 0, "creation_date": 1535550332, "post_id": 51968534, "comment_id": 91107924, "body": "@Zack: Feel free to add an answer with code for DAO."}], "tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": true, "score": 0, "last_activity_date": 1534946214, "creation_date": 1534946214, "answer_id": 51968534, "question_id": 51968202, "link": "https://stackoverflow.com/questions/51968202/creating-a-button-in-excel-that-calls-upon-a-created-access-query/51968534#51968534", "title": "Creating a Button in Excel, that calls upon a created Access query", "body": "<p>As an example for a solution with VBA using ADODB one could use the following function to connect to the database. </p>\n\n<pre><code>Function ConnectToDB(ByVal fileName As String)\n\nDim conn As New ADODB.Connection\n\n    If Dir(fileName) = \"\" Then\n        MsgBox \"Could not find file \" &amp; fileName\n        Exit Function\n    End If\n\n    Dim connectionString As String\n\n    ' https://www.connectionstrings.com/access/\n    connectionString = \"Provider=Microsoft.ACE.OLEDB.12.0; Data Source=\" _\n                       &amp; fileName &amp; \";Persist Security Info=False;\"\n\n    conn.Open connectionString\n\n    Set ConnectToDB = conn\n\nEnd Function\n</code></pre>\n\n<p>And if you want to copy data from the database one could use the following code. You need to have a sheet with the codename shRepAllRecords</p>\n\n<pre><code>Option Explicit\n\nSub ReadFromDB()\n\n    ' Get datbase name\n    Dim dbName As String\n    dbName = &lt;fule filename of the database&gt;\n\n    ' Connect to the databse\n    Dim conn As ADODB.Connection\n    Set conn = ConnectToDB(dbName)\n\n    ' read the data\n    Dim rs As New ADODB.Recordset\n    Dim query As String\n\n    ' First example to use an SQL statement\n    ' query = \"SELECT * From CUSTOMER\"\n\n    ' Second example to use a query name defined in the database itself\n    query = \"qryCustomer\"\n\n    rs.Open query, conn\n\n    ' shRepAllRecords is the codename of the sheet where the \n    ' data is written to\n\n    ' Write header\n    Dim i As Long\n    For i = 0 To rs.Fields.Count - 1\n        'shRepAllRecords.Cells(1, i + 1).Value = rs.Fields(i).Name\n        shRepAllRecords.Range(\"A1\").Offset(0, i) = rs.Fields(i).Name\n    Next i\n\n    ' Write Data\n    shRepAllRecords.Range(\"A2\").CopyFromRecordset rs\n    shRepAllRecords.Activate\n\n\n    ' clean up\n    conn.Close\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 433, "user_id": 10164553, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8D4Wn0r0S6M/AAAAAAAAAAI/AAAAAAAAAEg/3MGKwcFTJhI/photo.jpg?sz=128", "display_name": "RazorKillBen", "link": "https://stackoverflow.com/users/10164553/razorkillben"}, "is_accepted": false, "score": 1, "last_activity_date": 1534947459, "creation_date": 1534947459, "answer_id": 51968927, "question_id": 51968202, "link": "https://stackoverflow.com/questions/51968202/creating-a-button-in-excel-that-calls-upon-a-created-access-query/51968927#51968927", "title": "Creating a Button in Excel, that calls upon a created Access query", "body": "<p>Dependent on your requirements, you could have this without VBA in a quicker and more reliable way, to have a table that is pointed at your query, that updates when you click Refresh.</p>\n\n<p>To do so, in Excel navigate to Data > From Access.</p>\n\n<p>From here, navigate to your database with the saved query, and when asked to select a table, you can select the query instead.</p>\n\n<p>You can also write your own SQL query for Excel to execute against the database instead.</p>\n\n<p>You can edit the connection properties to refresh when the workbook is opened, or refresh when every 60 minutes for example, or you could turn it all off, and allow the user to hit 'Refresh' in Excel itself.</p>\n\n<p>Alternatively, you could setup a button that runs the refresh table command against the linked table, and this would do the same</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n     ActiveWorkbook.RefreshAll\nEnd Sub\n</code></pre>\n\n<p>Good luck.</p>\n"}, {"comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1535561083, "post_id": 52081204, "comment_id": 91115108, "body": "You enclose a function&#39;s arguments in parentheses when you want to capture the function&#39;s return value.  However, your function does not return a value, so nothing to capture, which means you don&#39;t need parentheses and then don&#39;t need <code>Call</code> to eliminate the error from parentheses.  Just call your function like this: <code>GetSqlServerData sQuery, sRange</code>"}], "tags": [], "owner": {"reputation": 3, "user_id": 10259964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8792905b5c64a2d984a19d51d7e3998?s=128&d=identicon&r=PG&f=1", "display_name": "Vicroyneptune", "link": "https://stackoverflow.com/users/10259964/vicroyneptune"}, "is_accepted": false, "score": 0, "last_activity_date": 1535556611, "creation_date": 1535556611, "answer_id": 52081204, "question_id": 51968202, "link": "https://stackoverflow.com/questions/51968202/creating-a-button-in-excel-that-calls-upon-a-created-access-query/52081204#52081204", "title": "Creating a Button in Excel, that calls upon a created Access query", "body": "<p>So I was finally able to figure out the issue. I was not putting \"Call\" in front of the function call. Once I did that, it accepted it. Thanks for all the assistance! The final answer was close to what Storax gave above. So I credited him with the answer. Thanks again!</p>\n"}], "owner": {"reputation": 3, "user_id": 10259964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8792905b5c64a2d984a19d51d7e3998?s=128&d=identicon&r=PG&f=1", "display_name": "Vicroyneptune", "link": "https://stackoverflow.com/users/10259964/vicroyneptune"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 51968534, "answer_count": 3, "score": 0, "last_activity_date": 1535556611, "creation_date": 1534945101, "last_edit_date": 1535546024, "question_id": 51968202, "link": "https://stackoverflow.com/questions/51968202/creating-a-button-in-excel-that-calls-upon-a-created-access-query", "title": "Creating a Button in Excel, that calls upon a created Access query", "body": "<p>Is there a way to create a button in Excel that runs a query, that is already created, in Access, and then updates the excel spreadsheet using the data from the query? I've searched the web for directions on how to do this, but have only found answers that create a button in Excel, that only runs a query in Excel, not Access. I am assuming this will be done by coding, upon click, in VBA, but have yet to find anything that does this. So... Is it possible? If so, how? </p>\n\n<p>Okay, so I have kind of updated this with question, because I sort of used both options made. So I first created a Function in a Standard Module (Because we may use this later for another sheet in the workbook, and we didn't want to duplicate work): </p>\n\n<pre><code>Function GetSqlServerData(sQuery As String, sRange As Range)\n\n    Dim conn As ADODB.Connection\n    Dim rs As ADODB.Recordset\n    Dim sConnString As String\n\n    ' Create the connection string.\n    sConnString = \"NMS\"\n\n    ' Create the Connection and Recordset objects.\n    Set conn = New ADODB.Connection\n    Set rs = New ADODB.Recordset\n\n    ' Open the connection and execute.\n    conn.Open sConnString\n    Set rs = conn.Execute(sQuery)\n\n    ' Check we have data.\n    If Not rs.EOF Then\n        ' Transfer result.\n        Sheets(3).Range(\"A2\").CopyFromRecordset rs\n    ' Close the recordset\n        rs.Close\n    Else\n        MsgBox \"Error: No records returned.\", vbCritical\n    End If\n    ' Clean up\n    If CBool(conn.State And adStateOpen) Then conn.Close\n    Set conn = Nothing\n    Set rs = Nothing\n\nEnd Function\n</code></pre>\n\n<p>Then I tried to use said function: </p>\n\n<pre><code>Sub GetPermits()\n    Dim sQuery As String\n    Dim sRange As Range\n\n    Set sQuery = \"Select * From Customer;\"\n    Set sRange = Sheets(3).Range(\"A2\")\n\n    GetSqlServerData(sQuery, sRange)\n\nEnd Sub\n</code></pre>\n\n<p>But it gives me an error right at the spot where is actually use the function. I don't need it to go to a MsgBox, and I don't need it to print it out, all I need is for it to put in the data into the sheet noted on the function call. BTW, the function needs some tweeking, I know. Right now, I just need it to call the darn thing, lol. </p>\n\n<p>Here is a Screen Shot of the error message: If you cant see it, it says, \"Compile Error: Expected:=\" and it highlights the \"GetSqlServerData(sQuery, sRange)\" in red. So it must have something to do with that. I just can't figure out what it is. </p>\n\n<p><a href=\"https://i.stack.imgur.com/mF0R8.jpg\" rel=\"nofollow noreferrer\">Screenshot of the error message</a></p>\n"}, {"tags": ["excel", "vba", "launcher"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1534945579, "post_id": 51967861, "comment_id": 90886907, "body": "Why not move the <code>close</code> call until after the <code>Call importe</code>?"}, {"owner": {"reputation": 1, "user_id": 9247287, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212629343225802/picture?type=large", "display_name": "Mario Villarreal", "link": "https://stackoverflow.com/users/9247287/mario-villarreal"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1534946535, "post_id": 51967861, "comment_id": 90887524, "body": "In any place, stop the macros, in any workbooks. Its a problem with the stack, I think."}, {"owner": {"reputation": 1, "user_id": 9247287, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212629343225802/picture?type=large", "display_name": "Mario Villarreal", "link": "https://stackoverflow.com/users/9247287/mario-villarreal"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1534951847, "post_id": 51967861, "comment_id": 90891008, "body": "I&#39;m thinking in a script in VBS, perhaps, it could close the launcher and run the second worbook..."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1534952562, "post_id": 51967861, "comment_id": 90891422, "body": "You could alternatively place the macros in the Personal.xlsb and call from there, no?"}, {"owner": {"reputation": 1, "user_id": 9247287, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212629343225802/picture?type=large", "display_name": "Mario Villarreal", "link": "https://stackoverflow.com/users/9247287/mario-villarreal"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1534955544, "post_id": 51967861, "comment_id": 90893209, "body": "All this macros run in many share folders of a server. Its code its many complex for me!. But, VBS until now, its working! When the operator click a button, I generate and save a code. Its close the &quot;launcher&quot; and excute the autorun macro in another workbook!."}], "owner": {"reputation": 1, "user_id": 9247287, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212629343225802/picture?type=large", "display_name": "Mario Villarreal", "link": "https://stackoverflow.com/users/9247287/mario-villarreal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 120, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1534944895, "creation_date": 1534943978, "last_edit_date": 1534944895, "question_id": 51967861, "link": "https://stackoverflow.com/questions/51967861/vba-launcher-workbooks", "title": "vba launcher workbooks", "body": "<p>I have a \"launcher\" workbook, with a userform with buttons. Each button, open an \"x\" workbook. Which autoexecute a macro when it's open (<code>Private Sub Workbook_Open()</code>), but, if I close the \"launcher\" workbook in any macro on this \"x\"  workbook, stop the macro.  </p>\n\n<p>Example: Code in the userform of \"Launcher\"  </p>\n\n<pre><code>Private Sub PRG01_Click()  \nUnload launcher 'my userform  \nWorkbooks.Open ThisWorkbook.Path &amp; \"\\MyMacros1.xlsm\"  \nThisWorkbook.Close False  \nEnd Sub  \n\nPrivate Sub PRG02_Click()  \nUnload launcher 'my userform  \nWorkbooks.Open ThisWorkbook.Path &amp; \"\\MyMacros2.xlsm\"  \nThisWorkbook.Close False  \nEnd Sub  \n</code></pre>\n\n<p>.........................................................................<br>\nCode in MyMacros1.xlsm  </p>\n\n<pre><code>Private Sub Workbook_Open()  \nWorkbooks(\"Launcher.xlsm\").close false' Here Macro Stop  \nCall importe 'then, this code not run...  \nEnd Sub  \n</code></pre>\n\n<p>I want to close the launcher and follow the execution of macro... What can I do?\nThanks! </p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1534943834, "post_id": 51967743, "comment_id": 90885664, "body": "Can you not just set Outlook to not check for new mail so often, in Options? ...or, set it programmatically to not check the mail at all when the sub starts, and change back at the end of the sub?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1534943961, "post_id": 51967743, "comment_id": 90885754, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/12257985/outlook-vba-run-a-code-every-half-an-hour\">Outlook VBA - Run a code every half an hour</a>"}, {"owner": {"reputation": 31, "user_id": 10226074, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-txchk9zObgw/AAAAAAAAAAI/AAAAAAAAHXI/B0Ho4df_6Vg/photo.jpg?sz=128", "display_name": "Wagner Braga", "link": "https://stackoverflow.com/users/10226074/wagner-braga"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1534944736, "post_id": 51967743, "comment_id": 90886328, "body": "@ashleedawg I like the idea of having it not check for new mail until the sub is done/ExitSave procedure is finished. I believe that is the metaphorical &#39;pause&#39; I am looking for. Do you have a link or code sample that handles that by chance?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1534945131, "post_id": 51967743, "comment_id": 90886597, "body": "I may have a suggestion but I need to undertsand as to what do you do after opening the workbook."}, {"owner": {"reputation": 31, "user_id": 10226074, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-txchk9zObgw/AAAAAAAAAAI/AAAAAAAAHXI/B0Ho4df_6Vg/photo.jpg?sz=128", "display_name": "Wagner Braga", "link": "https://stackoverflow.com/users/10226074/wagner-braga"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1534945469, "post_id": 51967743, "comment_id": 90886815, "body": "@SiddharthRout once the workbook is open I select a case based on which keyword was found in the subject and then insert a &#39;recievedtime&#39; timestamp into an appropriate cell location. After the timestamp is entered I save, close, and quit excel. Issue is if more mail comes in before it saves and quits the workbook will be open still and the code will throw errors and leaves the workbook open."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1534945560, "post_id": 51967743, "comment_id": 90886887, "body": "If you do not mind, can you update the quesiton with the exact code?"}, {"owner": {"reputation": 31, "user_id": 10226074, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-txchk9zObgw/AAAAAAAAAAI/AAAAAAAAHXI/B0Ho4df_6Vg/photo.jpg?sz=128", "display_name": "Wagner Braga", "link": "https://stackoverflow.com/users/10226074/wagner-braga"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1534953548, "post_id": 51967743, "comment_id": 90892016, "body": "@SiddharthRout, sure I&#39;ll upload now"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1534954485, "post_id": 51967743, "comment_id": 90892574, "body": "Thank you, Before I even suggest you what I have in my mind. Let me first try it out :D"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1534958502, "post_id": 51967743, "comment_id": 90894707, "body": "Can you share what are the column headers for Col A - F?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1534963572, "post_id": 51967743, "comment_id": 90896972, "body": "Ok do not share but put it in the code that I posted below"}], "answers": [{"tags": [], "owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "is_accepted": false, "score": 0, "last_activity_date": 1534944652, "creation_date": 1534944652, "answer_id": 51968048, "question_id": 51967743, "link": "https://stackoverflow.com/questions/51967743/error-when-outlook-vba-macro-runs-too-frequently/51968048#51968048", "title": "Error when Outlook VBA macro runs too frequently", "body": "<p>I'm not used manipulating Excel from Outlook, so this code will probably need some adjustment. The Sub <code>Main</code> will keep checking a specific workbook, until it's opened and not read-only. After doing code, it then closes the workbook and exits the loop. The only downside of this, is that the code will keep running until it has access to the workbook. You could add a counter to keep track of the number of attempts and exit once a specific number has been reached.</p>\n\n<p>Functions <code>ExtractName</code> and <code>WorkbookIsOpen</code> are support functions included below <code>Main</code>.</p>\n\n<pre><code>Public Function Main(wbkLoc As String) As Boolean\n    Dim wbk As Workbook\n\n    Do While Not WorkbookIsOpen(ExtractName(wbkLoc)) Then\n        Set wbk = Workbooks.Open(wbkLoc)\n\n        'Will open read-only if shared file is already open on another computer\n        If wbk.ReadOnly Then\n            wbk.Close SaveChanges:=False\n        Else\n            'ExcelConnection code\n            wbk.Close SaveChanges:=True\n            Exit Do\n        End If\n        DoEvents\n    Loop\n\n    Set wbk = Nothing\nEnd Function\n\n'Allows use of location variable in Main without hardcoding workbook name\nPrivate Function ExtractName(longName As String) As String\n    Dim lastDash As Integer\n    Dim extension As Integer\n\n    extension = InStr(1, StrReverse(longName), \".\")\n    lastDash = InStr(1, StrReverse(longName), \"\\\")\n    ExtractName = StrReverse(Mid(StrReverse(longName), extension + 1, lastDash - extension - 1))\nEnd Function\n\n' Returns true if workbook is already open on same computer\nPrivate Function WorkbookIsOpen(rsWbkName As String) As Boolean\n    On Error Resume Next\n    WorkbookIsOpen = CBool(Len(Workbooks(rsWbkName).Name) &gt; 0)\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 10226074, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-txchk9zObgw/AAAAAAAAAAI/AAAAAAAAHXI/B0Ho4df_6Vg/photo.jpg?sz=128", "display_name": "Wagner Braga", "link": "https://stackoverflow.com/users/10226074/wagner-braga"}, "edited": false, "score": 0, "creation_date": 1534966996, "post_id": 51973303, "comment_id": 90898529, "body": "Hey thanks for this effort, I like the idea you have to try and shorten the process time, definitely something I thought of but didn&#39;t know what avenue to go down. So I&#39;m debugging it now because it&#39;s throwing me an error. when this line runs <code>objRecordset.Open &quot;Select * FROM [&quot; &amp; SheetName &amp; &quot;$] WHERE &quot; &amp; Col_A &amp; &quot;=&#39;&quot; &amp; jobnum &amp; &quot;&#39;&quot;, _     objConnection, adOpenDynamic, adLockOptimistic, adCmdText</code> I get this in my error handler.  &quot;  -2147217900 - Syntax error in date in query expression &#39;CRM #=&#39;2345678&quot;  &quot; where CRM # is the col name and 2345678 is the jobnum"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 31, "user_id": 10226074, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-txchk9zObgw/AAAAAAAAAAI/AAAAAAAAHXI/B0Ho4df_6Vg/photo.jpg?sz=128", "display_name": "Wagner Braga", "link": "https://stackoverflow.com/users/10226074/wagner-braga"}, "edited": false, "score": 0, "creation_date": 1534997354, "post_id": 51973303, "comment_id": 90906176, "body": "Just fr testing purpose can you chnage the column heading to <code>CRM</code> instead of <code>CRM #</code>?"}, {"owner": {"reputation": 31, "user_id": 10226074, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-txchk9zObgw/AAAAAAAAAAI/AAAAAAAAHXI/B0Ho4df_6Vg/photo.jpg?sz=128", "display_name": "Wagner Braga", "link": "https://stackoverflow.com/users/10226074/wagner-braga"}, "edited": false, "score": 0, "creation_date": 1535031991, "post_id": 51973303, "comment_id": 90924116, "body": "So I made some slight changes to your code, namely changing that line that was throwing an error to this <code>objRecordset.Open &quot;Select * FROM [&quot; &amp; SheetName &amp; &quot;$]&quot;, _     objConnection, adOpenDynamic, adLockOptimistic, adCmdText</code> from my understanding your code looked for the record matching the jobnum, however there will be many cases where the jobnum doesnt exist yet and a new record will have to be created. So after that line I have your <code>if objrecordset.record count &gt; 0</code> qualifier and an <code>objrecordset.find</code> that looks for a row with the jobnum. The line with the Len(Trim... returns empty now"}, {"owner": {"reputation": 31, "user_id": 10226074, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-txchk9zObgw/AAAAAAAAAAI/AAAAAAAAHXI/B0Ho4df_6Vg/photo.jpg?sz=128", "display_name": "Wagner Braga", "link": "https://stackoverflow.com/users/10226074/wagner-braga"}, "edited": false, "score": 0, "creation_date": 1535032178, "post_id": 51973303, "comment_id": 90924241, "body": "And yes I can change the header to just CRM, which I did but was no longer the issue after the changes I made above. Btw, I ran out of space on the previous comment but the Len(Trim... line says expression is not defined in context so I&#39;m not sure if I have to somehow select the record after I find it for it to know what field/item to look at or whats going on. I haven&#39;t used ADODB for VBA before this haha"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 0, "last_activity_date": 1534964034, "last_edit_date": 1534964034, "creation_date": 1534963547, "answer_id": 51973303, "question_id": 51967743, "link": "https://stackoverflow.com/questions/51967743/error-when-outlook-vba-macro-runs-too-frequently/51973303#51973303", "title": "Error when Outlook VBA macro runs too frequently", "body": "<p>In outlook the minimum automatic send and receive can be set to 1 minute as shown below.</p>\n\n<p><a href=\"https://i.stack.imgur.com/osRSP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/osRSP.png\" alt=\"enter image description here\"></a></p>\n\n<p>Yes if your process takes 1 minute or so then you can increase this to 5 mins or to whatever you want but this may not keep you updated with latest emails. Mine is set to <strong>1 Minute</strong>. You may call me paranoid <strong>0_0</strong>!</p>\n\n<p>So when you are paranoid like me then what is the alternative? If there was a way which ran your code not in <strong>1 minute or so</strong> but in <strong>1 second or so</strong> then your problem should be solved. Right? :)</p>\n\n<p>Use <code>OLEDB</code> to write to the Excel file. This code finds the job number and writes to that row if the relevant cell is empty and then saves the files in less than <strong>2 seconds</strong></p>\n\n<pre><code>Const FName As String = \"T:\\Capstone Proj\\TimeStampsOnly.xlsx\"\nConst SheetName As String = \"TimeStamps\"\n\nConst adUseClient = 3\nConst adOpenDynamic = 2\nConst adLockOptimistic = 3\nConst adCmdText = &amp;H1\n\nConst Col_A As String = \"Put Column A header here\"\nConst Col_B As String = \"Put Column B header here\"\nConst Col_C As String = \"Put Column C header here\"\nConst Col_D As String = \"Put Column D header here\"\nConst Col_E As String = \"Put Column E header here\"\nConst Col_F As String = \"Put Column F header here\"\n\nPublic Sub ExcelConnect(msg As Outlook.MailItem, LType As String)\n    Dim ReceivedTime As String, jobnum As String\n    Dim conString As String\n\n    Dim objRecordset As Object, objConnection As Object\n\n    ReceivedTime = msg.ReceivedTime\n    jobnum = Trim(Right(Split(msg.Subject, \"-\", 2)(0), 8))\n\n    conString = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp; _\n                FName &amp; _\n                \";Extended Properties=\"\"Excel 12.0;HDR=Yes\"\"\"\n\n    Set objConnection = CreateObject(\"ADODB.Connection\")\n    Set objRecordset = CreateObject(\"ADODB.Recordset\")\n\n    objConnection.Open conString\n\n    objRecordset.CursorLocation = adUseClient\n    objRecordset.Open \"Select * FROM [\" &amp; SheetName &amp; \"$] WHERE \" &amp; Col_A &amp; \" ='\" &amp; jobnum &amp; \"'\", _\n    objConnection, adOpenDynamic, adLockOptimistic, adCmdText\n\n    If objRecordset.RecordCount &gt; 0 Then\n        With objRecordset\n            Select Case LType\n                Case \"MDIQE\"\n                    If Len(Trim(.Fields.Item(Col_C).Value)) = 0 Then\n                        .Fields.Item(Col_B).Value = ReceivedTime\n                        .Fields.Item(Col_C).Value = ReceivedTime\n                        .Update\n                    End If\n                Case \"MDIQ\"\n                    If Len(Trim(.Fields.Item(Col_B).Value)) = 0 Then\n                        .Fields.Item(Col_B).Value = ReceivedTime\n                        .Update\n                    End If\n                Case \"MDIE\"\n                    If Len(Trim(.Fields.Item(Col_C).Value)) = 0 Then\n                        .Fields.Item(Col_C).Value = ReceivedTime\n                        .Update\n                    End If\n                Case \"MDIR\"\n                    If Len(Trim(.Fields.Item(Col_D).Value)) = 0 Then\n                        .Fields.Item(Col_D).Value = ReceivedTime\n                        .Update\n                    End If\n                Case \"MDIP\"\n                    If Len(Trim(.Fields.Item(Col_E).Value)) = 0 Then\n                        .Fields.Item(Col_E).Value = ReceivedTime\n                        .Update\n                    End If\n                Case \"MDIF\"\n                    If Len(Trim(.Fields.Item(Col_F).Value)) = 0 Then\n                        .Fields.Item(Col_G).Value = ReceivedTime\n                        .Update\n                    End If\n            End Select\n        End With\n    End If\n\n    objConnection.Close\nEnd Sub\n</code></pre>\n\n<p>The above code is tried and tested with my excel file. If you face any problem then let me know and we will try and fix it.</p>\n"}], "owner": {"reputation": 31, "user_id": 10226074, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-txchk9zObgw/AAAAAAAAAAI/AAAAAAAAHXI/B0Ho4df_6Vg/photo.jpg?sz=128", "display_name": "Wagner Braga", "link": "https://stackoverflow.com/users/10226074/wagner-braga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1592947057, "creation_date": 1534943636, "last_edit_date": 1592947057, "question_id": 51967743, "link": "https://stackoverflow.com/questions/51967743/error-when-outlook-vba-macro-runs-too-frequently", "title": "Error when Outlook VBA macro runs too frequently", "body": "<p>Let me start with a brief description of what my project accomplishes currently. I have 3 subroutines in 'ThisOutlookSession'. One checks the last ~30 unread mail items and sends the subject to a sub that checks it's contents for a key word, the other does the same thing but handling the Items_ItemAdd event (new incoming mail) and the last sub I alluded to already checks the subject line and if a keyword is found calls a module I named 'ExcelConnection' which is where the issue stems from.</p>\n\n<p>In the 'ExcelConnection' module I have this code that opens a workbook:</p>\n\n<pre><code>Dim oXL As Object\nDim oWS As Object\nDim lngRow As Long\n\nSet oXL = CreateObject(\"Excel.Application\")\noXL.Workbooks.Open FileName:=\"T:\\Capstone Proj\\TimeStampsOnly.xlsx\", AddTOMRU:=False, UpdateLinks:=False\n\n'// Change sheet name to suit\nSet oWS = oXL.Sheets(\"TimeStamps\")\n</code></pre>\n\n<p><strong>The issue is</strong>: This process takes about a minute or so to complete and then it goes through an ExitSave point where the workbook is saved, closed, and the application 'quits', BUT if another piece of mail comes in before it finished running and \"ExitSaving\" it gives an error saying I cant open the workbook since it's already open. This also stops the initial instance and the result is the workbook stays open in the background where I can't close it manually and I cant edit it either since it keeps saying it's being modified by 'Another User' (Outlook). </p>\n\n<p>Is there any way to tell the macro to wait until the everything is done running before it runs again? This only happens when two pieces of mail with keywords come in within a minute or so of each other.</p>\n\n<p>If you have any questions or need more code samples please let me know! Thank you. </p>\n\n<hr>\n\n<p><strong>Edit:</strong>\nThis is the code for the 'ExcelConnection' module that is triggered by a keyword in subject line of email.</p>\n\n<pre><code>    Public Sub ExcelConnect(msg As Outlook.MailItem, LType As String)\n'// Declare all variables needed for excel functionality and open appropriate document\n    Dim oXL As Object\n    Dim oWS As Object\n    Dim lngRow As Long\n\nSet oXL = CreateObject(\"Excel.Application\")\noXL.Workbooks.Open FileName:=\"T:\\Capstone Proj\\TimeStampsOnly.xlsx\", AddTOMRU:=False, UpdateLinks:=False\n\n'// Change sheet name to suit\nSet oWS = oXL.Sheets(\"TimeStamps\")\nlngRow = oWS.Range(\"A\" &amp; oXL.Rows.Count).End(-4162).Offset(1).Row '// -4162 = xlUp. not available late bound\n\nDim subArray() As String\nDim jRow As Long\nDim jobnum As Variant\n\n\nsubArray = Split(msg.Subject, \"-\", 2)   '// Need the hypen to end the standardized subject line\njobnum = Trim(Right(subArray(0), 8))\njRow = IsExist(jobnum, lngRow, oWS)\n\n\nSelect Case LType '// Choose actions based on proccess step\n\n    Case \"MDIQE\"\n    If oWS.cells(jRow, 3).Value &lt;&gt; 0 Then\n    GoTo ExitSave\n    Else\n        With oWS\n            .cells(jRow, 1).Value = jobnum\n            .cells(jRow, 2).Value = msg.ReceivedTime\n            .cells(jRow, 3).Value = msg.ReceivedTime\n        End With\n    End If\n'-------------------------------------------------------------\n        Case \"MDIQ\"\n        If oWS.cells(jRow, 2).Value &lt;&gt; 0 Then\n        GoTo ExitSave\n        Else\n            With oWS\n                .cells(jRow, 1).Value = jobnum\n                .cells(jRow, 2).Value = msg.ReceivedTime\n            End With\n        End If\n'-------------------------------------------------------------\n        Case \"MDIE\"\n        If oWS.cells(jRow, 3).Value &lt;&gt; 0 Then\n        GoTo ExitSave\n        Else\n            With oWS\n                .cells(jRow, 1).Value = jobnum\n                .cells(jRow, 3).Value = msg.ReceivedTime\n            End With\n        End If\n'-------------------------------------------------------------\n        Case \"MDIR\"\n        If oWS.cells(jRow, 4).Value &lt;&gt; 0 Then\n        GoTo ExitSave\n        Else\n            With oWS\n                .cells(jRow, 1).Value = jobnum\n                .cells(jRow, 4).Value = msg.ReceivedTime\n            End With\n        End If\n'-------------------------------------------------------------\n        Case \"MDIP\"\n        If oWS.cells(jRow, 5).Value &lt;&gt; 0 Then\n        GoTo ExitSave\n        Else\n            With oWS\n                .cells(jRow, 1).Value = jobnum\n                .cells(jRow, 5).Value = msg.ReceivedTime\n            End With\n        End If\n'-------------------------------------------------------------\n        Case \"MDIF\"\n        If oWS.cells(jRow, 6).Value &lt;&gt; 0 Then\n        GoTo ExitSave\n        Else\n            With oWS\n                .cells(jRow, 1).Value = jobnum\n                .cells(jRow, 6).Value = msg.ReceivedTime\n            End With\n        End If\n\n    End Select\n\nExitSave:\n    With oXL\n        .activeworkbook.Save\n        .activeworkbook.Close SaveChanges:=1   '// 2 = xlDoNotSaveChanges but not availabe late bound\n        .Application.Quit\n    End With\n\n    Set oXL = Nothing\n    Set oWS = Nothing\nEnd Sub\nFunction IsExist(jobnum As Variant, upper As Long, oWS As Object) As Long\n    Dim i As Integer, ValueToFind As Variant\n    ValueToFind = jobnum\n    For i = (upper - 1) To 1 Step -1\n        If CStr(oWS.cells(i, 1).Value) = ValueToFind Then\n            IsExist = i\n            Exit Function\n        End If\n    Next i\nIsExist = upper 'If found nothing\nEnd Function\n</code></pre>\n\n<p>Thanks for all the help everyone.</p>\n"}, {"tags": ["vba", "excel", "copy", "copy-paste", "paste"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1534943194, "post_id": 51967516, "comment_id": 90885247, "body": "Please check out <b>how to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a></b>, to include only the minimal amount - but all of - the code required to produce the problem.  (Plus, often the process of <i>creating</i> the <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> leads to a solution.)  Also you could try using [F8] to step through your code to determine exactly where the problem lies... more on that in: <a href=\"http://www.cpearson.com/excel/DebuggingVBA.aspx\" rel=\"nofollow noreferrer\"><b>Debugging VBA</b></a> from Chip Pearson.  After that, it would be helpful if you remove extra spacing from the code but indent properly; this is another way that bugs can often be spotted."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 2, "creation_date": 1534943671, "post_id": 51967516, "comment_id": 90885537, "body": "side note, instead of <code>goto LastLine</code>, just use <code>Exit Sub</code>.  Also the very last line that currently says <code>Exxit Sub</code> is unnecessary since the sub is finished anyway.  And one more recommended post to read: <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>"}], "answers": [{"tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 1, "last_activity_date": 1534950997, "last_edit_date": 1534950997, "creation_date": 1534948059, "answer_id": 51969134, "question_id": 51967516, "link": "https://stackoverflow.com/questions/51967516/vba-code-is-duplicating-paste-into-column-not-specified-in-code/51969134#51969134", "title": "VBA - Code is duplicating paste into column not specified in code", "body": "<p>You can try this. Notice that you do not need to <code>.Select</code> a cell to copy it. It defeats the purpose of <code>VBA</code>! Just get right to the point: State the range and copy it. No need to select. </p>\n\n<p>Also, no need for <code>GoTo</code> as mentioned by the infamous @ashleedawg, just <code>Exit Sub</code> when needed. </p>\n\n<pre><code>Sub ImportWriteOffs()\n\nDim ws As Worksheet: Set ws = ThisWorkbook.Sheets(\"Input - Write offs\")\n\nDim filter As String, caption As String, combinedFilename As String\nDim combinedWorkbook As Workbook, ws2 as Worksheet\n\nMsgBox (\"Select 'SRMF0035 BRAM Pre Repurchase'\")\n    filter = \"Text files (*.*),*.*\"\n    caption = \"Select 'SRMF0035 BRAM Pre Repurchase'\"\n    combinedFilename = Application.GetOpenFilename(filter, , caption)\n\nIf combinedFilename &lt;&gt; \"False\" Then\n    Set combinedWorkbook = Application.Workbooks.Open(combinedFilename)\n    Set ws2 = combinedWorkbook.Sheets(\"Tabular Version\")\nElse\n    MsgBox \"No file was uploaded\", vbExclamation\n    Exit Sub\nEnd If\n\nIf combinedWorkbook.Worksheets(1).Range(\"D7\") = \"Periodic Insurance\" Then\n    ws2.Range(\"B10:B\" &amp; ws2.Range(\"B\" &amp; ws.Rows.Count).End(xlUp).Row - 1).Copy\n        ws.Range(\"B10\").PasteSpecial xlPasteValues\n        ws.Range(\"B10\").PasteSpecial xlPasteFormats\n            combinedWorkbook.Close False\nElse\n    MsgBox \"Incorrect File Selected\"\n    combinedWorkbook.Close False\n End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 91, "user_id": 4638010, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-zU9SMZUvpdI/AAAAAAAAAAI/AAAAAAAAAEU/QLl-vrx2-54/photo.jpg?sz=128", "display_name": "Michael Foster", "link": "https://stackoverflow.com/users/4638010/michael-foster"}, "is_accepted": false, "score": 0, "last_activity_date": 1534948472, "creation_date": 1534948472, "answer_id": 51969259, "question_id": 51967516, "link": "https://stackoverflow.com/questions/51967516/vba-code-is-duplicating-paste-into-column-not-specified-in-code/51969259#51969259", "title": "VBA - Code is duplicating paste into column not specified in code", "body": "<p>This is happening because the select is actually using a relative reference. But it would be clearer what you want to do if you used <code>Cells</code> instead:</p>\n\n<pre><code>For r = 10 to 10000\n  ActiveWorkbook.Worksheets(\"Input - Write-offs\").Cells(r, 2) = combinedWorkbook.Worksheets(\"Tabular Version\").Cells(r, 2)\nNext\n</code></pre>\n\n<p>You can implement something similar for deleting the last row, if you are so inclined.</p>\n"}], "owner": {"reputation": 59, "user_id": 9479664, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rodge95", "link": "https://stackoverflow.com/users/9479664/rodge95"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1534950997, "creation_date": 1534942887, "last_edit_date": 1534943548, "question_id": 51967516, "link": "https://stackoverflow.com/questions/51967516/vba-code-is-duplicating-paste-into-column-not-specified-in-code", "title": "VBA - Code is duplicating paste into column not specified in code", "body": "<p>I'm using the below code to copy column B in combinedWorkbook to column B in ThisWorkbook but when running the macro it seems to paste column B into column C of ThisWorkbook as well as pasting into column B. I've stepped through the code and it works fine. This seems very strange and would be grataeful with any help on why it's also pasting into column C in ThisWorkbook.</p>\n\n<pre><code>Sub ImportWriteOffs()\n    Dim filter As String\n    Dim caption As String\n    Dim combinedFilename As String\n    Dim combinedWorkbook As Workbook\n    ' Open BRAM Report Source Data\n    MsgBox (\"Select 'SRMF0035 BRAM Pre Repurchase'\")\n    filter = \"Text files (*.*),*.*\"\n    caption = \"Select 'SRMF0035 BRAM Pre Repurchase'\"\n    combinedFilename = Application.GetOpenFilename(filter, , caption)\n    If combinedFilename &lt;&gt; \"False\" Then\n        Set combinedWorkbook = Application.Workbooks.Open(combinedFilename)\n    Else\n        MsgBox \"No file was uploaded\", vbExclamation\n        GoTo LastLine\n    End If\n    If combinedWorkbook.Worksheets(1).Range(\"D7\").Value = \"Periodic Insurance\" Then\n        ' Copy and Paste into working file\n        Sheets(\"Tabular Version\").Select\n        Range(\"B10:B100000\").Select\n        Selection.Copy\n        ThisWorkbook.Activate\n        Sheets(\"Input - Write offs\").Select\n        Range(\"B10:B100000\").Select\n        ActiveSheet.Paste\n        Application.CutCopyMode = False\n        combinedWorkbook.Close False\n        ' Delete last row\n        ThisWorkbook.Activate\n        Sheets(\"Input - Write offs\").Select\n        Range(\"B10\").Select\n        Selection.End(xlDown).Select\n        Selection.EntireRow.Delete\n    Else\n        MsgBox \"Incorrect File Selected\"\n        combinedWorkbook.Close False\n        Exit Sub\n    End If\nLastLine:\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9892231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f95ca5d0c037963982adc1e4f358517?s=128&d=identicon&r=PG&f=1", "display_name": "Harris92", "link": "https://stackoverflow.com/users/9892231/harris92"}, "edited": false, "score": 0, "creation_date": 1534949259, "post_id": 51967672, "comment_id": 90889433, "body": "Thank you so much !! works perfectly apart from the stoprunning part which I&#39;ve setup as you specified.  I declared it as a global variable at the top of the AutoOn Module would this need to be elsewhere?  I tried to post the code as a comment but it didn&#39;t format correctly so the comment was deleted.  Thanks again !"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 11, "user_id": 9892231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f95ca5d0c037963982adc1e4f358517?s=128&d=identicon&r=PG&f=1", "display_name": "Harris92", "link": "https://stackoverflow.com/users/9892231/harris92"}, "edited": false, "score": 0, "creation_date": 1534949328, "post_id": 51967672, "comment_id": 90889477, "body": "You can stick it in any module or sheet code or <code>thisworkbook</code> code. You can refer to it by its full path like <code>AutoOn.StopRunning</code> as well, this way you&#39;ll know where to find it when you debug this 2 years from now."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 11, "user_id": 9892231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f95ca5d0c037963982adc1e4f358517?s=128&d=identicon&r=PG&f=1", "display_name": "Harris92", "link": "https://stackoverflow.com/users/9892231/harris92"}, "edited": false, "score": 0, "creation_date": 1535038758, "post_id": 51967672, "comment_id": 90928633, "body": "@Harris92 Please either edit your question to include the update, try to make it more succinct to fit here as a comment, or create a new question. I did see the edit though, so we can continue the conversation without any further action. To troubleshoot, place a breakpoint on the <code>If Not StopRunning...</code> line (click the line and hit <code>F9</code> and it will highlight dark red. Now insure that the scheduler is running and hit your &quot;Stop Running&quot; button. Wait for the next schedule to run and the program will stop on that highlighted line. Hover over &quot;StopRunning&quot; and see what it&#39;s set to."}, {"owner": {"reputation": 11, "user_id": 9892231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f95ca5d0c037963982adc1e4f358517?s=128&d=identicon&r=PG&f=1", "display_name": "Harris92", "link": "https://stackoverflow.com/users/9892231/harris92"}, "edited": false, "score": 0, "creation_date": 1535119249, "post_id": 51967672, "comment_id": 90962019, "body": "<a href=\"https://stackoverflow.com/questions/52006102/vba-stop-application-ontime-method\">new question link</a> tried that and the StopRunning value is always false. posted it as a new question so everyone can see the code. Thanks again JNevill you really are a legend !"}], "tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": false, "score": 0, "last_activity_date": 1534943370, "creation_date": 1534943370, "answer_id": 51967672, "question_id": 51967512, "link": "https://stackoverflow.com/questions/51967512/run-numerous-macros-every-hour-and-stop-on-button-press-vba/51967672#51967672", "title": "Run numerous macros every hour and stop on button press vba", "body": "<p>The timer counts down to 10 seconds from now and triggers the macro and then that's it. </p>\n\n<p>Instead after running your three macro's you'll have to set the timer again with <code>Application.OnTime Now + TimeValue(\"00:00:10\"), \"AutoOn\"</code> or by calling <code>Call AutoOnBtn_Click</code> to set it up again. Like:</p>\n\n<pre><code>Sub AutoOn()\n\n  call macro1\n  call macro2\n  call macro3\n\n  If Not StopRunning Then Application.OnTime Now + TimeValue(\"00:00:10\"), \"AutoOn\"\n\nend sub\n</code></pre>\n\n<p>As for stopping it... you can set up a global variable called \"Stoprunning\" </p>\n\n<p>(above any subs or functions):</p>\n\n<pre><code>Public StopRunning as Boolean\n</code></pre>\n\n<p>Then for your button click to stop the running of the schedule:</p>\n\n<pre><code>Sub somebutton_click()\n    StopRunning = True\nEnd Sub\n</code></pre>\n\n<p>And lastly, in your <code>AutoOn()</code> when you set up the next run you can test for that value:</p>\n\n<pre><code>Sub AutoOn()\n\n  call macro1\n  call macro2\n  call macro3\n\n  If Not StopRunning Then Application.OnTime Now + TimeValue(\"00:00:10\"), \"AutoOn\"\n\nend sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9892231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f95ca5d0c037963982adc1e4f358517?s=128&d=identicon&r=PG&f=1", "display_name": "Harris92", "link": "https://stackoverflow.com/users/9892231/harris92"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 290, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1534943370, "creation_date": 1534942876, "question_id": 51967512, "link": "https://stackoverflow.com/questions/51967512/run-numerous-macros-every-hour-and-stop-on-button-press-vba", "title": "Run numerous macros every hour and stop on button press vba", "body": "<p>I've ran into 2 issues with my code.</p>\n\n<p>When a button is pressed I want it to call 3 separate macros in order e.g.</p>\n\n<pre><code>Sub AutoOn()\n\ncall macro1\ncall macro2\ncall macro3\n\nend sub\n</code></pre>\n\n<p>I've tried the following code:</p>\n\n<pre><code>Private sub AutoOnBtn_Click()\n\nAutoOnCheck.Value = True\nApplication.OnTime Now + TimeValue(\"00:00:10\"), \"AutoOn\"\n\nEnd Sub\n</code></pre>\n\n<p>The above example should run every 10 seconds but after testing, it only runs the one time - what am I missing?</p>\n\n<p>Also how would I stop the macros running when a button is pressed, currently I'm just using:</p>\n\n<pre><code>end \n</code></pre>\n\n<p>which closes everything including the form but would prefer it to keep the form open and just stop the macros. Any assistance would be greatly appreciated.</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": false, "score": 1, "last_activity_date": 1534944763, "last_edit_date": 1534944763, "creation_date": 1534944389, "answer_id": 51967981, "question_id": 51967343, "link": "https://stackoverflow.com/questions/51967343/vba-code-not-limited-to-designated-columns/51967981#51967981", "title": "VBA code not limited to designated columns", "body": "<p>You have code duplicated both inside your test for <code>INTERSECT</code> and later outside that test. There are some tests for column outside, so I'm not sure why it's triggering anyway... There also seems to be an extra <code>End If</code> I can't figure out so I'm not sure how it was even executing.</p>\n\n<p>I've rewritten removing superfluous nested Ifs and whatnot. I've added comments mostly just to help me out while I was rewriting, but they may serve useful for future edits.</p>\n\n<p>This code runs only for cells of type <code>xlCellTypeAllValidation</code> in columns 6 and 7. If you don't need to limit to just <code>xlCellTypeAllValidation</code> cells, then remove that from the main <code>If</code> test.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\n    Dim rngDV As Range\n    Dim oldVal As String\n    Dim newVal As String\n    Dim lOld As Long\n\n    'Exit routine if more than one cell was changed\n    If Target.Count &gt; 1 Then GoTo exitHandler\u00a0\n\n    'Shut off errors, and attempt to grab xlCellTypeAllValidation cells\n    'If no cells are of type xlCellTypeAllValidation then exit routine\n    On Error Resume Next\n    Set rngDV = Cells.SpecialCells(xlCellTypeAllValidation)\n    If rngDV Is Nothing Then GoTo exitHandler   \u00a0\n\n    'If the cell changed is xlCellTypeAllValidation AND in columns 6 or 7 Then run code\n    If Not Intersect(Target, rngDV) Is Nothing AND (Target.Column = 6 OR Target.Column = 7) Then\n\n        'Shut off events\n        Application.EnableEvents = False\n\n        'Capture old and new values to variables\n        newVal = Target.Value\n        Application.Undo\n        oldVal = Target.Value\n\n        'undo the undo\n        Target.Value = newVal\n\n        'If the cell used to hold a value and it was changed to a new value (not null)\n        If oldVal &lt;&gt; \"\" AND newVal &lt;&gt; \"\" Then       \n\n        \u00a0\u00a0\u00a0\u00a0'Test to see if the change didn't affect the contents of the cell\n            lOld = Len(oldVal)\n            If Left(newVal, lOld) = oldVal Then\n                Target.Value = newVal\n            Else 'They've truly changed the content, so bring in the old content and append the new with a comma\n                Target.Value = oldVal &amp; \", \" &amp; newVal\n            End If\n    \u00a0\u00a0\u00a0\u00a0\n        End If      \n    End If\n\nexitHandler:\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6217340"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1534944763, "creation_date": 1534942352, "last_edit_date": 1534943812, "question_id": 51967343, "link": "https://stackoverflow.com/questions/51967343/vba-code-not-limited-to-designated-columns", "title": "VBA code not limited to designated columns", "body": "<p>I'm trying to limit the following code to only columns 6 and 7, but it works for the entire sheet.     </p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\n    Dim rngDV As Range\n    Dim oldVal As String\n    Dim newVal As String\n    Dim lOld As Long\n\n    If Target.Count &gt; 1 Then GoTo exitHandler\u00a0\n\n    On Error Resume Next\n\n    Set rngDV = Cells.SpecialCells(xlCellTypeAllValidation)\n\n    On Error GoTo exitHandler\u00a0\n\n    If rngDV Is Nothing Then GoTo exitHandler   \u00a0\n\n    If Intersect(Target, rngDV) Is Nothing Then\n\n    \u00a0\u00a0 'do nothing\n\n    Else\n\n    \u00a0 Application.EnableEvents = False\n\n    \u00a0 newVal = Target.Value\n\n    \u00a0 Application.Undo\n\n    \u00a0 oldVal = Target.Value\n\n    \u00a0 Target.Value = newVal\n\n    \u00a0 If Target.Column = 6 _\n    \u00a0\u00a0\u00a0\u00a0\u00a0 Or Target.Column = 7 Then\n    \u00a0\u00a0\u00a0 If oldVal = \"\" Then\n    \u00a0\u00a0\u00a0\u00a0\u00a0 'do nothing\n    \u00a0\u00a0\u00a0 Else\n    \u00a0\u00a0\u00a0\u00a0\u00a0 If newVal = \"\" Then\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 'do nothing\n    \u00a0\u00a0\u00a0\u00a0\u00a0 Else\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 lOld = Len(oldVal)\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 If Left(newVal, lOld) = oldVal Then\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Target.Value = newVal\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Else\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Target.Value = oldVal _\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 &amp; \", \" &amp; newVal\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 End If\n    \u00a0\u00a0\u00a0\u00a0\u00a0 End If\n    \u00a0\u00a0\u00a0 End If\n    \u00a0 End If\n    End If\n\n    If newVal = \"\" Then\n    \u00a0 'do nothing\n    Else\n\n    lOld = Len(oldVal)\n\n    If Left(newVal, lOld) = oldVal Then\n\u00a0\u00a0\u00a0     Target.Value = newVal\n\u00a0   Else\n\u00a0\u00a0\u00a0\u00a0    Target.Value = oldVal _\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 &amp; \", \" &amp; newVal\n\u00a0   End If\n\n    End If\nexitHandler:\n\n\u00a0 Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "pivot-table"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1534943236, "post_id": 51967261, "comment_id": 90885266, "body": "Your code works for me. ok try this. Replace <code>Set cache = ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:=prange)</code> with this line and check if you still get the error? <code>Set cache = ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:=data.Cells(1, 1).Resize(lastrow, lastcol))</code>"}, {"owner": {"reputation": 79, "user_id": 10075275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/107333275ee3414da0aef131cdd8ced0?s=128&d=identicon&r=PG&f=1", "display_name": "Ibrahim", "link": "https://stackoverflow.com/users/10075275/ibrahim"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1534943383, "post_id": 51967261, "comment_id": 90885354, "body": "same error @SiddharthRout"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1534943464, "post_id": 51967261, "comment_id": 90885409, "body": "Which excel version are you using?"}, {"owner": {"reputation": 79, "user_id": 10075275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/107333275ee3414da0aef131cdd8ced0?s=128&d=identicon&r=PG&f=1", "display_name": "Ibrahim", "link": "https://stackoverflow.com/users/10075275/ibrahim"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1534943505, "post_id": 51967261, "comment_id": 90885432, "body": "I&#39;m using Excel 2013"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1534943579, "post_id": 51967261, "comment_id": 90885477, "body": "What is the exact error message that you are getting? 13 is for type mismatch"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1534943787, "post_id": 51967261, "comment_id": 90885630, "body": "Also for testing purpose can you try this as well? <code>Set cache = ActiveWorkbook.PivotCaches.Create(xlDatabase, &quot;&#39;&quot; &amp; Data.Name &amp; &quot;&#39;!&quot; &amp; prange.Address)</code>"}, {"owner": {"reputation": 79, "user_id": 10075275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/107333275ee3414da0aef131cdd8ced0?s=128&d=identicon&r=PG&f=1", "display_name": "Ibrahim", "link": "https://stackoverflow.com/users/10075275/ibrahim"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1534943966, "post_id": 51967261, "comment_id": 90885761, "body": "it&#39;s working. can you explain the <b><code>&quot;&#39;&quot; &amp; Data.Name &amp; &quot;&#39;!&quot;</code></b>"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1534944164, "post_id": 51967261, "comment_id": 90885903, "body": "<a href=\"https://docs.microsoft.com/en-us/office/vba/api/Excel.PivotCaches.Create\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/api/&hellip;</a> Inspite of that excel sometime creates a problem so I am passing it as a string For example <code>&#39;Data&#39;!A1:A10</code>"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1534944891, "post_id": 51967261, "comment_id": 90886436, "body": "I remember suggesting someone the same thing so I was saerching for it. And <a href=\"https://stackoverflow.com/questions/19659224/pivotcaches-add-errors-out\">THIS</a> is what I got. :D"}, {"owner": {"reputation": 79, "user_id": 10075275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/107333275ee3414da0aef131cdd8ced0?s=128&d=identicon&r=PG&f=1", "display_name": "Ibrahim", "link": "https://stackoverflow.com/users/10075275/ibrahim"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1534945484, "post_id": 51967261, "comment_id": 90886828, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/178540/discussion-between-ibrahim-atto-and-siddharth-rout\">continue this discussion in chat</a>."}, {"owner": {"reputation": 79, "user_id": 10075275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/107333275ee3414da0aef131cdd8ced0?s=128&d=identicon&r=PG&f=1", "display_name": "Ibrahim", "link": "https://stackoverflow.com/users/10075275/ibrahim"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1534946630, "post_id": 51967261, "comment_id": 90887593, "body": "How can i bypass the pivotfields method? it&#39;s not working <code>With ActiveSheet.PivotTables(&quot;Terminator&quot;).PivotFields(&quot;Evt F&quot;)           .Orientation = xlColumnField           .Position = 1     End With</code>"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1534946972, "post_id": 51967261, "comment_id": 90887832, "body": "@Ibrahimatto see my answer below"}], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 10075275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/107333275ee3414da0aef131cdd8ced0?s=128&d=identicon&r=PG&f=1", "display_name": "Ibrahim", "link": "https://stackoverflow.com/users/10075275/ibrahim"}, "edited": false, "score": 0, "creation_date": 1535004433, "post_id": 51968649, "comment_id": 90908196, "body": "It&#39;s working. Do you think <code>Table.AddDataField graphe_clos.PivotTables _     (&quot;Terminator&quot;).PivotFields(&quot;Descriptifs&quot;), &quot;Nombre de Descriptifs&quot;, xlCount</code>is the best way to add a data field or you have something much efficient"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1534946592, "creation_date": 1534946592, "answer_id": 51968649, "question_id": 51967261, "link": "https://stackoverflow.com/questions/51967261/error-13-while-creating-a-pivottable/51968649#51968649", "title": "Error 13 While creating a PivotTable", "body": "<p>The safer way to assign <code>SourceData</code> to your <code>PivotCache</code> is by using the following line </p>\n\n<pre><code>Set Cache = ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:=pRange.Address(False, False, xlA1, xlExternal))\n</code></pre>\n\n<p>adding the fourth parameter <code>xlExternal</code> verifies that the range is also pulling the worksheet's name.</p>\n\n<p>See more explanation inside the code's comments.</p>\n\n<p>Modified Code</p>\n\n<pre><code>Sub tracer()\n\nDim Cache As PivotCache\nDim Table As PivotTable\nDim pRange As Range\nDim LastRow As Long\nDim LastCol As Long\n\n' use With statement to shorten and fully qualify all your nested objects\nWith Data\n    LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    LastCol = 15\n\n    ' set the Range of the Pivot's data\n    Set pRange = .Range(.Cells(1, 1), .Cells(LastRow, LastCol))\n\n    ' graphe_clos.Select '&lt;-- you don't need to \"Select\" the sheet in order to create the Pivot-Table\nEnd With\n\n' set the Pivot Cache\nSet Cache = ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:=pRange.Address(False, False, xlA1, xlExternal))\n\n' set the Pivot Table\nSet Table = Cache.CreatePivotTable(TableDestination:=graphe_clos.Cells(1, 1), TableName:=\"Terminator\")\n\nEnd Sub\n</code></pre>\n\n<p>Regarding your latest question, modify:</p>\n\n<pre><code>With ActiveSheet.PivotTables(\"Terminator\").PivotFields(\"Evt F\") \n</code></pre>\n\n<p>With</p>\n\n<pre><code>With Table.PivotFields(\"Evt F\")\n</code></pre>\n\n<p>since you already set your <code>PivotTable</code> object to <code>Table</code>. </p>\n"}], "owner": {"reputation": 79, "user_id": 10075275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/107333275ee3414da0aef131cdd8ced0?s=128&d=identicon&r=PG&f=1", "display_name": "Ibrahim", "link": "https://stackoverflow.com/users/10075275/ibrahim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "accepted_answer_id": 51968649, "answer_count": 1, "score": 1, "last_activity_date": 1534946934, "creation_date": 1534942104, "last_edit_date": 1534946934, "question_id": 51967261, "link": "https://stackoverflow.com/questions/51967261/error-13-while-creating-a-pivottable", "title": "Error 13 While creating a PivotTable", "body": "<p>I keep having the same error \"13\" \"type incompatibility\" while doing a pivot table.</p>\n\n<pre><code>Sub tracer()\n\nDim cache As PivotCache\nDim table As PivotTable\nDim prange As range\nDim lastrow As Long\nDim lastcol As Long\n\nlastrow = data.Cells(data.Rows.count, \"A\").End(xlUp).Row\nlastcol = 15\n\nSet prange = data.Cells(1, 1).Resize(lastrow, lastcol)\ngraphe_clos.Select\n\nSet cache = ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:=prange)\nSet table = cache.CreatePivotTable(TableDestination:=graphe_clos.Cells(1, 1), TableName:=\"Terminator\")        \n\nEnd Sub\n</code></pre>\n\n<p>Thank you for Help</p>\n"}, {"tags": ["excel", "vba", "filtering", "multiple-columns"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1534944107, "post_id": 51967226, "comment_id": 90885857, "body": "Try replacing <code>wks.Columns(1).AdvancedFilter</code> with <code>wks.Range(&quot;A:B&quot;).AdvancedFilter</code>"}, {"owner": {"reputation": 11, "user_id": 10259732, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-FgALjTy5p_o/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaM1Pniw_yt_wlkiAAOtFHMHAX6Mwg/mo/photo.jpg?sz=128", "display_name": "chels2015", "link": "https://stackoverflow.com/users/10259732/chels2015"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1534944819, "post_id": 51967226, "comment_id": 90886398, "body": "I did try that and it copies the first two columns onto the temporary worksheet, which is great, but it still only filters based off of the values in the first column."}, {"owner": {"reputation": 11, "user_id": 10259732, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-FgALjTy5p_o/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaM1Pniw_yt_wlkiAAOtFHMHAX6Mwg/mo/photo.jpg?sz=128", "display_name": "chels2015", "link": "https://stackoverflow.com/users/10259732/chels2015"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 1, "creation_date": 1534969588, "post_id": 51967226, "comment_id": 90899657, "body": "For anyone else searching for an answer, edited the above looping section to the below and it worked: <code>Dim iLoop As Integer  &#39;looping With wks     For iLoop = 2 To 65         .UsedRange.AutoFilter Field:=1, Criteria1:=TempWks.Cells(iLoop, 1).Value         .UsedRange.AutoFilter Field:=2, Criteria1:=TempWks.Cells(iLoop, 2).Value         .PrintOut Preview:=True      Next iLoop End With      Application.DisplayAlerts = False     TempWks.Delete    &#39;deletes temporary worksheet     Application.DisplayAlerts = True  End Sub</code>"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1534970297, "post_id": 51967226, "comment_id": 90900002, "body": "you can actually add an answer to your own question. This is preferred for future users to more easily find what fixed your problem :)"}, {"owner": {"reputation": 11, "user_id": 10259732, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-FgALjTy5p_o/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaM1Pniw_yt_wlkiAAOtFHMHAX6Mwg/mo/photo.jpg?sz=128", "display_name": "chels2015", "link": "https://stackoverflow.com/users/10259732/chels2015"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1535058199, "post_id": 51967226, "comment_id": 90938181, "body": "ah! thank you - new to this, any help is appreciated!!"}], "answers": [{"tags": [], "owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "is_accepted": true, "score": 0, "last_activity_date": 1535027378, "creation_date": 1535027378, "answer_id": 51985840, "question_id": 51967226, "link": "https://stackoverflow.com/questions/51967226/filter-multiple-columns-in-table/51985840#51985840", "title": "Filter multiple columns in table", "body": "<p>For anyone else searching for an answer, edited the above looping section to the below and it worked: </p>\n\n<pre><code>   ...\n\n    Dim iLoop As Integer\n\n    'looping\n    With wks\n        For iLoop = 2 To 65\n            .UsedRange.AutoFilter Field:=1, Criteria1:=TempWks.Cells(iLoop, 1).Value\n            .UsedRange.AutoFilter Field:=2, Criteria1:=TempWks.Cells(iLoop, 2).Value\n            .PrintOut Preview:=True\n        Next iLoop\n    End With\n\n    Application.DisplayAlerts = False\n    TempWks.Delete    'deletes temporary worksheet\n    Application.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10259732, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-FgALjTy5p_o/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaM1Pniw_yt_wlkiAAOtFHMHAX6Mwg/mo/photo.jpg?sz=128", "display_name": "chels2015", "link": "https://stackoverflow.com/users/10259732/chels2015"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 615, "favorite_count": 0, "accepted_answer_id": 51985840, "answer_count": 1, "score": 1, "last_activity_date": 1610626088, "creation_date": 1534941974, "last_edit_date": 1610626088, "question_id": 51967226, "link": "https://stackoverflow.com/questions/51967226/filter-multiple-columns-in-table", "title": "Filter multiple columns in table", "body": "<p>My code filters one column then prints.</p>\n<p>I need to filter based on two columns and then print. I.e. filter based on engineer name (column 1) and route (column 2). Right now, it filters on engineer name (column 1).</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\nSub filterandprint()\n\n    Dim TempWks As Worksheet\n    Dim wks As Worksheet\n\n    Dim myRng As Range\n    Dim myCell As Range\n                \n    'change to match your worksheet name\n    Set wks = Worksheets(&quot;Table&quot;)\n        \n    Set TempWks = Worksheets.Add      'creates temporary worksheet\n\n    wks.AutoFilterMode = False 'remove the arrows\n\n    'assumes headers only in row 1, columns(1) will be the number of the column you base your filtering\n    'this copies the unique filtering and pastes it on a new temp worksheet\n    wks.Columns(1).AdvancedFilter Action:=xlFilterCopy, _\n      CopyToRange:=TempWks.Range(&quot;A1&quot;), Unique:=True\n\n    With TempWks\n        Set myRng = .Range(&quot;a2&quot;, .Cells(.Rows.Count, &quot;A&quot;).End(xlUp))\n    End With\n\n    'looping\n    With wks\n        For Each myCell In myRng.Cells\n            .UsedRange.AutoFilter Field:=1, Criteria1:=myCell.Value\n            '.UsedRange.AutoFilter Field:=2, Criteria1:=myCell.Value\n            .PrintOut Preview:=True\n        Next myCell\n    End With\n\n    Application.DisplayAlerts = False\n    TempWks.Delete    'deletes temporary worksheet\n    Application.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1534941382, "post_id": 51966867, "comment_id": 90883993, "body": "You could just send <code>ActiveSheet</code> as an input parameter to <code>AddEntry</code> and perform your filter check in <code>AddEntry</code>. This would mean that in <code>CommandButton1_Click1</code> should just have <code>AddEntry</code> call. Although, as a teaser, there is a solution with <b><code>class</code></b> (which I am working on at the moment) which potentially can catch click of any Activex button and call <code>AddEntry</code> UDF"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1534941484, "post_id": 51966867, "comment_id": 90884071, "body": "The first step towards an elegant solution is organizing the data better so you <b>don&#39;t</b> have 20 structurally identical sheets with 20 buttons.  If there is similar data across all the sheets, it&#39;s best kept on one worksheet, and then display whatever the user needs to see at that moment with the help of filters, perhaps a drop-down, maybe a listbox, or <b>a</b> button, etc...That many sheets are clunky, awkward, and hard to maintain, prone to issues... and, imo, <i>not</i> elegant.  As a rule of thumb, there should never be identical &quot;anythings&quot; in the programming/data world."}, {"owner": {"reputation": 279, "user_id": 3545063, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/14439b722ec69898933a092cbf58be1b?s=128&d=identicon&r=PG&f=1", "display_name": "user3545063", "link": "https://stackoverflow.com/users/3545063/user3545063"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1534941691, "post_id": 51966867, "comment_id": 90884194, "body": "@Zac yeah, you&#39;re right about the filter check, I realized that when I copied the code on here. I am definitely curious about your class solution!"}, {"owner": {"reputation": 279, "user_id": 3545063, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/14439b722ec69898933a092cbf58be1b?s=128&d=identicon&r=PG&f=1", "display_name": "user3545063", "link": "https://stackoverflow.com/users/3545063/user3545063"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1534941698, "post_id": 51966867, "comment_id": 90884201, "body": "@ashleedawg true, but the decision to separate the sheets was definitely not coming from my side."}], "answers": [{"tags": [], "owner": {"reputation": 351, "user_id": 10117882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64b0785e48cf991cbdce327c31018405?s=128&d=identicon&r=PG&f=1", "display_name": "Phantom Lord", "link": "https://stackoverflow.com/users/10117882/phantom-lord"}, "is_accepted": false, "score": 0, "last_activity_date": 1534948036, "creation_date": 1534948036, "answer_id": 51969127, "question_id": 51966867, "link": "https://stackoverflow.com/questions/51966867/access-to-event-command-button-event-handlers-in-modules/51969127#51969127", "title": "Access to event command button event handlers in modules", "body": "<p>instead of putting a command button in every sheet, just put only one button on the toolbar of excel</p>\n"}], "owner": {"reputation": 279, "user_id": 3545063, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/14439b722ec69898933a092cbf58be1b?s=128&d=identicon&r=PG&f=1", "display_name": "user3545063", "link": "https://stackoverflow.com/users/3545063/user3545063"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1534948036, "creation_date": 1534940748, "question_id": 51966867, "link": "https://stackoverflow.com/questions/51966867/access-to-event-command-button-event-handlers-in-modules", "title": "Access to event command button event handlers in modules", "body": "<p>I have a work book with about 20 different work sheets, each sheet structurally identical to each other. Now, I've added a command button in each of the sheets and I am calling a sub on each of the different sheets when the respective button is clicked. \nIt works fine, but it's obviously terrible programming practice as I have 20 different sheets containing the following code:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nIf ActiveSheet.FilterMode &lt;&gt; True Then\n    Call AddEntry\nElse\n    MsgBox \"bla bla.\"\nEnd If\nEnd Sub\n</code></pre>\n\n<p>So my question, as an inexperienced VBA dev - what is the most elegant solution to call my sub on a button click? Ideally writing the code once in a module e.g.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1968, "user_id": 7393973, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/527fd7a80369379d54890cf7021d093b?s=128&d=identicon&r=PG&f=1", "display_name": "user7393973", "link": "https://stackoverflow.com/users/7393973/user7393973"}, "edited": false, "score": 0, "creation_date": 1534941300, "post_id": 51966814, "comment_id": 90883947, "body": "Have you tried using a <a href=\"https://en.wikipedia.org/wiki/Data_source_name\" rel=\"nofollow noreferrer\">DSN</a> and also restrict the server to only allow the operations you need to have access?"}, {"owner": {"reputation": 1009, "user_id": 8981066, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HFh7Jm-OT-E/AAAAAAAAAAI/AAAAAAAABl8/oDH6HzC4eFw/photo.jpg?sz=128", "display_name": "Oday Salim", "link": "https://stackoverflow.com/users/8981066/oday-salim"}, "reply_to_user": {"reputation": 1968, "user_id": 7393973, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/527fd7a80369379d54890cf7021d093b?s=128&d=identicon&r=PG&f=1", "display_name": "user7393973", "link": "https://stackoverflow.com/users/7393973/user7393973"}, "edited": false, "score": 0, "creation_date": 1534942558, "post_id": 51966814, "comment_id": 90884781, "body": "@user7393973 - no. Can you please provide me with an example how DSN is used in VBA?"}, {"owner": {"reputation": 1968, "user_id": 7393973, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/527fd7a80369379d54890cf7021d093b?s=128&d=identicon&r=PG&f=1", "display_name": "user7393973", "link": "https://stackoverflow.com/users/7393973/user7393973"}, "edited": false, "score": 0, "creation_date": 1534943526, "post_id": 51966814, "comment_id": 90885446, "body": "Search for ODBC Data Source to setup the DSN and then use the name only  when you open the ADODB connection."}, {"owner": {"reputation": 1009, "user_id": 8981066, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HFh7Jm-OT-E/AAAAAAAAAAI/AAAAAAAABl8/oDH6HzC4eFw/photo.jpg?sz=128", "display_name": "Oday Salim", "link": "https://stackoverflow.com/users/8981066/oday-salim"}, "reply_to_user": {"reputation": 1968, "user_id": 7393973, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/527fd7a80369379d54890cf7021d093b?s=128&d=identicon&r=PG&f=1", "display_name": "user7393973", "link": "https://stackoverflow.com/users/7393973/user7393973"}, "edited": false, "score": 0, "creation_date": 1534946771, "post_id": 51966814, "comment_id": 90887692, "body": "Quick question - will users have to install this ODBC on their machines before using the app?"}, {"owner": {"reputation": 1968, "user_id": 7393973, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/527fd7a80369379d54890cf7021d093b?s=128&d=identicon&r=PG&f=1", "display_name": "user7393973", "link": "https://stackoverflow.com/users/7393973/user7393973"}, "edited": false, "score": 0, "creation_date": 1534946919, "post_id": 51966814, "comment_id": 90887798, "body": "If I&#39;m not mistaken it comes with Windows. Try searching &quot;ODBC Data Source&quot; in the menu/file system."}], "owner": {"reputation": 1009, "user_id": 8981066, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HFh7Jm-OT-E/AAAAAAAAAAI/AAAAAAAABl8/oDH6HzC4eFw/photo.jpg?sz=128", "display_name": "Oday Salim", "link": "https://stackoverflow.com/users/8981066/oday-salim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 233, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1534940512, "creation_date": 1534940512, "question_id": 51966814, "link": "https://stackoverflow.com/questions/51966814/vba-adodb-connection-sqlconnectionstringbuilder-class", "title": "VBA ADODB Connection - SqlConnectionStringBuilder Class", "body": "<p><strong>Background</strong></p>\n\n<p>I have an Excel application that connects to SQL Server using <code>ADODB Connection</code> via VBA. This ADODB Connection contains credentials that are hard coded. I know this is not best practice.</p>\n\n<p><strong>Issue</strong></p>\n\n<p>It has come to my attention that there are some users that are using <a href=\"https://stackoverflow.com/questions/1026483/is-there-a-way-to-crack-the-password-on-an-excel-vba-project/31005696#31005696\">this method</a> to access password protected VBA modules, and retrieve connection credentials. Which they use it to access the server. </p>\n\n<p><strong>Possible Solution?</strong></p>\n\n<p>I am considering possible solutions to hide the connection string from VBA <strong>or</strong> set up a secure connection string using <a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.data.sqlclient.sqlconnectionstringbuilder?view=netframework-4.7.2\" rel=\"nofollow noreferrer\">this method</a>.</p>\n\n<p>I wonder if it is possible to build this class with the credentials built in, so that in the VBA we do not hard code the credentials, rather just refer to this connection class?</p>\n\n<p>Anyone here has experience with this?</p>\n\n<p>I have looked at <a href=\"https://stackoverflow.com/questions/3217014/how-to-securely-store-connection-string-details-in-vba\">this solution</a>. However, I am using a 2017 version of Visual Basic and I am unable to follow the step-by-step guide. In particular, I was unable to find the activeX reference.</p>\n\n<p>I would really appreciate any help with this. </p>\n\n<p>Many thanks.</p>\n"}, {"tags": ["excel", "vba", "formatting"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10259618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4d70762b17d38c49bb589086aed4950?s=128&d=identicon&r=PG&f=1", "display_name": "DPC", "link": "https://stackoverflow.com/users/10259618/dpc"}, "edited": false, "score": 0, "creation_date": 1534951691, "post_id": 51968895, "comment_id": 90890911, "body": "Thank you very much for your help. It does answer my question, and the way you took me through step by step was incredibly helpful! Thank you again!"}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 0, "last_activity_date": 1534947847, "last_edit_date": 1534947847, "creation_date": 1534947389, "answer_id": 51968895, "question_id": 51966791, "link": "https://stackoverflow.com/questions/51966791/apply-format-to-part-of-a-cell-based-on-contents-of-another-cell/51968895#51968895", "title": "Apply format to part of a cell based on contents of another cell", "body": "<p>Okay, so if understood correctly and based on your text <em>\"So to summarise, I want individual SKU's within a string in column F on sheet 1 to be bold , based on the presence of that SKU in column D on sheet 2\"</em> you want to:</p>\n\n<ul>\n<li>Loop through the rows in column D on Sheets(2).</li>\n<li>Find any match in column F on Sheets(1).</li>\n<li>Highlight (Bold text) that number in the string.</li>\n</ul>\n\n<p>I'll try get you in the right direction:</p>\n\n<p><strong>1).</strong> First things first, you want to loop through all rows in column D on Sheets(2) dynamically. Many ways to do this but personally I like to use <code>.UsedRange</code>. For example:</p>\n\n<pre><code>Dim CL As Range\nFor Each CL In Sheets(2).UsedRange.Columns(4).Rows\n    'Your code Part 2\nNext CL\n</code></pre>\n\n<p><strong>2).</strong> Now you have to find a match of these values within column F on Sheets(1). A smart/quick way to do so is to make use of <code>.FindNext</code> looking at value parts. In action this would look like something like this:</p>\n\n<pre><code>Dim CLL as Range\nDim FirstAddress as String\nWith Sheets(1).Columns(6)\n    Set CLL = .Find(What:=CL.Value, LookIn:=xlValues, Lookat:=xlPart)\n    If Not CLL Is Nothing Then\n        FirstAddress = CLL.Address\n        Do\n            'You code Part 3\n            Set CLL = .FindNext(CLL)\n        Loop While Not CLL Is Nothing And CLL.Address &lt;&gt; FirstAddress\n    End If\nEnd With\n</code></pre>\n\n<p><strong>3).</strong> Now we are finding the appropriate cells that contain the values we are looking for we need to determine the position of our value in the whole string. We can use something handy for this called <code>.InStr</code>. What this function does is determine the position of the first character of our value within the whole string. In practice it would look like this:</p>\n\n<pre><code>Dim POS as Long\nPOS = InStr(1, CLL.Value, CL.Value)\n</code></pre>\n\n<p>The \"1\" indicates from what position in the string we want to start our search. CLL.Value is whole string we looking in, making CL.Value our searchvalue.</p>\n\n<p><strong>4).</strong> Now we are able to indicate where our string starts AND we want to know the length of our searchvalue which we can use the <code>.Len</code> function for resulting in a numeric value.</p>\n\n<pre><code>=Len(CL.Value)\n</code></pre>\n\n<p><strong>5).</strong> Almost there right? Just need to make the characters bold using <code>.Characters</code>. There is a <code>Bold</code> setting we can set to <code>True</code>. It's quite nice and is used like so:</p>\n\n<pre><code>CLL.Characters(POS, Len(CL.Value)).Font.Bold = True\n</code></pre>\n\n<p><code>POS</code> here functions as our starting location while <code>LEn(CL.Value)</code> obviously is the length of what we need in bold.</p>\n\n<p><strong>6).</strong> Here we are. If we would piece all of this together:</p>\n\n<pre><code>Sub CreateBold()\n\nDim CL As Range, CLL As Range\nDim FirstAddress As String\nDim POS As Long\n\nFor Each CL In Sheets(2).UsedRange.Columns(4).Rows\n    With Sheets(1).Columns(6)\n        Set CLL = .Find(What:=CL.Value, LookIn:=xlValues, Lookat:=xlPart)\n        If Not CLL Is Nothing Then\n            FirstAddress = CLL.Address\n            Do\n                POS = InStr(1, CLL.Value, CL.Value)\n                CLL.Characters(POS, Len(CL.Value)).Font.Bold = True\n                Set CLL = .FindNext(CLL)\n            Loop While Not CLL Is Nothing And CLL.Address &lt;&gt; FirstAddress\n        End If\n    End With\nNext CL\n\nEnd Sub\n</code></pre>\n\n<p>Hopefully this DOES answer your question and has been clear enough to understand.</p>\n"}], "owner": {"reputation": 3, "user_id": 10259618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4d70762b17d38c49bb589086aed4950?s=128&d=identicon&r=PG&f=1", "display_name": "DPC", "link": "https://stackoverflow.com/users/10259618/dpc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 51968895, "answer_count": 1, "score": 0, "last_activity_date": 1534947847, "creation_date": 1534940448, "last_edit_date": 1534943642, "question_id": 51966791, "link": "https://stackoverflow.com/questions/51966791/apply-format-to-part-of-a-cell-based-on-contents-of-another-cell", "title": "Apply format to part of a cell based on contents of another cell", "body": "<p>I'm trying to apply a specific format to a portion of a cell, based on the contents of another cell.</p>\n\n<p>I'm a VBA beginner, and have been able to apply different formats to certain parts of a cell, based on position in a string, but can't get further than that.</p>\n\n<p>Sheet 1, column F has strings of SKU's (separated by commas). I want to make Individual SKU's bold once a check has been performed on that product.\nI'm importing data to sheet 2, where column D contains SKU's of products that have been checked. </p>\n\n<p>So to summarise,  I want individual SKU's within a string in column F on sheet 1 to be bold , based on the presence of that SKU in column D on sheet 2</p>\n\n<p>Can anyone assist with the VBA code necessary? I would be most grateful for any assistance.</p>\n\n<p>(I have searched many forums and haven't found the answer so far)</p>\n\n<p>Edit:\nI've found the following, and can work with it. It's based on set variables though,not dynamic:</p>\n\n<pre><code>Sub test()\n\n    For row_num = 1 To 13\n\n        'Cell contents\n        cell_text = Cells(row_num, 1)\n\n        'Same contents split into three parts and saved in an array\n        text_array = Split(cell_text, \" \")\n\n        'Length of part 1\n        length_1 = Len(text_array(0))\n\n        'Length of part 2\n        length_2 = Len(text_array(1))\n\n        'Set ITALICS for Part 1\n        Cells(row_num, 1).Characters(1, length_1).Font.Color = vbGreen\n\n        'Set BOLD for Part 2\n        Cells(row_num, 1).Characters(length_1 + 2, length_2).Font.Bold = \n        True\n\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>It's still a hypothetical issue, but a very small example of the contents of the two columns is in the following file</p>\n\n<p><a href=\"http://www.filedropper.com/partialcellformatting\" rel=\"nofollow noreferrer\">Example data</a></p>\n"}, {"tags": ["vba", "excel", "outlook", "office-2013"], "comments": [{"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1534959276, "post_id": 51966768, "comment_id": 90895059, "body": "Do both scripts run on the same machine? What happens if you type &quot;Doe, John&quot; in the To edit box in Outlook and hit Ctrl+K?"}, {"owner": {"reputation": 199, "user_id": 1509937, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a4c86af9c437803f642322aedc848702?s=128&d=identicon&r=PG", "display_name": "Chaosbydesign", "link": "https://stackoverflow.com/users/1509937/chaosbydesign"}, "reply_to_user": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1535087195, "post_id": 51966768, "comment_id": 90944738, "body": "@DmitryStreblechenko On the same machine, only the Outlook script will run and Outlook itself can resolve the name without issue.  Excel for whatever reason cannot process this script."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1535088990, "post_id": 51966768, "comment_id": 90945239, "body": "Are you sure you end up using the same profile? What is the value of the Application.Session.CurrentProfile property?"}, {"owner": {"reputation": 199, "user_id": 1509937, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a4c86af9c437803f642322aedc848702?s=128&d=identicon&r=PG", "display_name": "Chaosbydesign", "link": "https://stackoverflow.com/users/1509937/chaosbydesign"}, "reply_to_user": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1535382134, "post_id": 51966768, "comment_id": 91034893, "body": "@DmitryStreblechenko Both have &quot;Outlook&quot; for that value."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1535382372, "post_id": 51966768, "comment_id": 91035055, "body": "When you run your code from Excel, is Outlook running?"}, {"owner": {"reputation": 199, "user_id": 1509937, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a4c86af9c437803f642322aedc848702?s=128&d=identicon&r=PG", "display_name": "Chaosbydesign", "link": "https://stackoverflow.com/users/1509937/chaosbydesign"}, "reply_to_user": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1535443266, "post_id": 51966768, "comment_id": 91055922, "body": "@DmitryStreblechenko yes, Outlook is running when Excel is trying to run the script."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1535468221, "post_id": 51966768, "comment_id": 91071943, "body": "Does olRec.Name return the name?"}, {"owner": {"reputation": 199, "user_id": 1509937, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a4c86af9c437803f642322aedc848702?s=128&d=identicon&r=PG", "display_name": "Chaosbydesign", "link": "https://stackoverflow.com/users/1509937/chaosbydesign"}, "reply_to_user": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1539850373, "post_id": 51966768, "comment_id": 92652917, "body": "<code>Set olRec = olApp.Session.CreateRecipient(&quot;Doe, John&quot;)</code> does not assign <code>Doe, John</code> to <code>olRec.name</code> when it&#39;s run in Excel.  Outlook defines this property."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1539878438, "post_id": 51966768, "comment_id": 92669633, "body": "What do you mean by &quot;does not assign Doe, John to olRec.name&quot;? Do you get a different name back? Or some kind of an error?"}, {"owner": {"reputation": 199, "user_id": 1509937, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a4c86af9c437803f642322aedc848702?s=128&d=identicon&r=PG", "display_name": "Chaosbydesign", "link": "https://stackoverflow.com/users/1509937/chaosbydesign"}, "reply_to_user": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1541155191, "post_id": 51966768, "comment_id": 93128330, "body": "After <code>Set olRec = olApp.Session.CreateRecipient(&quot;Doe, John&quot;)</code> is processed, if you look at <code>olRec</code> in the Locals window before <code>olRec.Resolve</code> is processed, the Name field is empty.  In Outlook, that field will show <code>&quot;Doe, John&quot;</code>."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1541179965, "post_id": 51966768, "comment_id": 93141343, "body": "Why do you care what it is before calling Resolve? Nothing is guaranteed to be available before that, you need to access the object only after calling Resolve."}, {"owner": {"reputation": 199, "user_id": 1509937, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a4c86af9c437803f642322aedc848702?s=128&d=identicon&r=PG", "display_name": "Chaosbydesign", "link": "https://stackoverflow.com/users/1509937/chaosbydesign"}, "reply_to_user": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1541274681, "post_id": 51966768, "comment_id": 93163127, "body": "Well, seeing as how it&#39;s the resolve that&#39;s failing, it would make sense to look at what the recipient is providing for the resolve to process."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1541309373, "post_id": 51966768, "comment_id": 93168657, "body": "But you are the one who is providing the name when you call CreateRecipient, so yoi do know what the (unresolved) name is."}], "owner": {"reputation": 199, "user_id": 1509937, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a4c86af9c437803f642322aedc848702?s=128&d=identicon&r=PG", "display_name": "Chaosbydesign", "link": "https://stackoverflow.com/users/1509937/chaosbydesign"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 229, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1534940383, "creation_date": 1534940383, "question_id": 51966768, "link": "https://stackoverflow.com/questions/51966768/excel-2013-cannot-resolve-outlook-recipient", "title": "Excel 2013 cannot resolve Outlook Recipient", "body": "<p>I'm attempting to write a snippet of vba code for Excel 2013 that will find an email address from Outlook.  I have <code>Microsoft Outlook 15.0 Object Library</code> checked in my References window.</p>\n\n<p>Here is what I'm using in Excel:</p>\n\n<pre><code>Function GetInfo()\n    Dim olApp As Outlook.Application\n    Dim olRec As Outlook.Recipient\n    Set olApp = GetObject(, \"Outlook.Application\")\n    Set olRec = olApp.Session.CreateRecipient(\"Doe, John\")\n    olRec.Resolve\n    Debug.Print olRec.AddressEntry.GetExchangeUser.PrimarySmtpAddress\nEnd Function\n</code></pre>\n\n<p>Whenever I attempt to run this code, I get a Runtime Error 287 thrown at <code>olRec.Resolve</code>.</p>\n\n<p>However, when I put the (more or less) same bit of code into Outlook:</p>\n\n<pre><code>Function GetInfo()\n    Set olRec = Application.Session.CreateRecipient(\"Doe, John\")\n    olRec.Resolve\n    Debug.Print olRec.AddressEntry.GetExchangeUser.PrimarySmtpAddress\nEnd Function\n</code></pre>\n\n<p>The code executes without issue and spits out <code>john.doe@example.com</code> in my immediate window.</p>\n\n<p>What am I doing wrong with the Excel VBA that is leading to the runtime error?</p>\n"}, {"tags": ["vba", "excel", "pivot-table"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1534940103, "post_id": 51966267, "comment_id": 90883173, "body": "I can&#39;t test on your data but I think if you right click the pivot &gt; Pivot Table Options &gt;  Totals and Filters tab &gt; <code>Allow multiple filter per field</code> ... then you could filter or group it differently.  See also <a href=\"https://support.office.com/article/group-or-ungroup-data-in-a-pivottable-c9d1ddd0-6580-47d1-82bc-c84a5a340725\" rel=\"nofollow noreferrer\">Group or Ungroup Data in a Pivot Table</a>. I assume you&#39;ve played with the subtotals in Field Options.  If the months are static, maybe you could add them with a calculated field."}, {"owner": {"reputation": 13, "user_id": 10046006, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Q_huE2jDnNo/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7ptXMFsFu79nw0lWhbLEMftQKvk1A/mo/photo.jpg?sz=128", "display_name": "Slynny", "link": "https://stackoverflow.com/users/10046006/slynny"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1535015079, "post_id": 51966267, "comment_id": 90913701, "body": "Hey @ashleedawg, thanks for the comment. The problem is that the table stores large amount of data, thus calculated fields always crash excel file and I can&#39;t use them, I used <code>Allow multiple filter per field</code> you mentioned and grouped the months into by years and got something like this: <a href=\"https://imgur.com/a/KVLlKhc\" rel=\"nofollow noreferrer\">link</a> Now I can sort by the field sum Y2, but I can&#39;t have those visible here in the table, as from what I read you can&#39;t move the subtotals to the end of the table, and this is where i need to have them. Maybe you know if there is a way to sort by fields that aren&#39;t visible?"}, {"owner": {"reputation": 13, "user_id": 10046006, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Q_huE2jDnNo/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7ptXMFsFu79nw0lWhbLEMftQKvk1A/mo/photo.jpg?sz=128", "display_name": "Slynny", "link": "https://stackoverflow.com/users/10046006/slynny"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1535016297, "post_id": 51966267, "comment_id": 90914453, "body": "@ashleedawg First thing I thought of is just hiding those columns, but I would really prefer if they were not in the table at all."}], "owner": {"reputation": 13, "user_id": 10046006, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Q_huE2jDnNo/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7ptXMFsFu79nw0lWhbLEMftQKvk1A/mo/photo.jpg?sz=128", "display_name": "Slynny", "link": "https://stackoverflow.com/users/10046006/slynny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 780, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1534966870, "creation_date": 1534938780, "last_edit_date": 1534966870, "question_id": 51966267, "link": "https://stackoverflow.com/questions/51966267/pivottable-sort-by-sum-of-specific-columns", "title": "PivotTable - sort by sum of specific columns", "body": "<p>I have a certain problem with sorting my pivot table.<br>\nI need to sort it by the sum of values from specific columns.<br>\nI want to sort \"Marka G\u0142\u00f3wna\" by the sum of months for Year2, it looks like on the screen below, selected columns are the ones which make the sum I need to sort by.</p>\n\n<p>Here is the screen shot:</p>\n\n<p><a href=\"https://i.stack.imgur.com/8Fw7D.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8Fw7D.png\" alt=\"img\"></a></p>\n\n<p>Is this doable? I cannot have subtotals for each year visible in the table, can it be done with sorting by subtotal in that situation?</p>\n"}, {"tags": ["vba", "excel", "internet-explorer", "iframe"], "comments": [{"owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "edited": false, "score": 0, "creation_date": 1534938511, "post_id": 51965795, "comment_id": 90882079, "body": "Have you declared <code>htmlelements</code> as an object?"}, {"owner": {"reputation": 23, "user_id": 9413719, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "John Louie Gonzales", "link": "https://stackoverflow.com/users/9413719/john-louie-gonzales"}, "reply_to_user": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "edited": false, "score": 0, "creation_date": 1534938632, "post_id": 51965795, "comment_id": 90882143, "body": "yes i did, i have declaration in all my variable. What i post here is just a part of my code."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1534939059, "post_id": 51965795, "comment_id": 90882451, "body": "Is there an URL you can share? And can you show some of the relevant html please as well as more of your code. Also, give the full error message please along with any error number."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1534940441, "post_id": 51965795, "comment_id": 90883396, "body": "@ashleedawg Kinda snowed down with work but did just spot this rather tardily. It&#39;s a SQL day at work......."}, {"owner": {"reputation": 23, "user_id": 9413719, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "John Louie Gonzales", "link": "https://stackoverflow.com/users/9413719/john-louie-gonzales"}, "edited": false, "score": 0, "creation_date": 1534941561, "post_id": 51965795, "comment_id": 90884121, "body": "<a href=\"http://www.anterior.banxico.org.mx/portal-mercado-cambiario/foreign-exchange-markets--exc.html\" rel=\"nofollow noreferrer\">this is the url</a>  what i need to do is click the &quot;More information&quot; and get the rates. Also the error that i&#39;m getting is &quot;automation error or Error 404&quot;"}, {"owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "edited": false, "score": 0, "creation_date": 1534942323, "post_id": 51965795, "comment_id": 90884604, "body": "@JohnLouieGonzales As QHarr mentioned, if you could provide the URL or some of the HTML that would help a lot... the entire code (redacted if needed) would be great"}, {"owner": {"reputation": 23, "user_id": 9413719, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "John Louie Gonzales", "link": "https://stackoverflow.com/users/9413719/john-louie-gonzales"}, "edited": false, "score": 0, "creation_date": 1534942724, "post_id": 51965795, "comment_id": 90884892, "body": "I already provided the URL... for the code i think that is all i need to provide... that is the code that i use to click a label and pull out a data. the rest of my code is to create the IE and visit the URL"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1534942960, "post_id": 51965795, "comment_id": 90885079, "body": "We can&#39;t see if you are using InternetExplorer or InternetExplorerMedium in the code above for examle. Have you tried with both?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1534943147, "post_id": 51965795, "comment_id": 90885212, "body": "And is the page always so slow loading for you? It may be that it times out."}, {"owner": {"reputation": 23, "user_id": 9413719, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "John Louie Gonzales", "link": "https://stackoverflow.com/users/9413719/john-louie-gonzales"}, "edited": false, "score": 0, "creation_date": 1534943613, "post_id": 51965795, "comment_id": 90885503, "body": "i use internet explorer references in vba... for the loading i dont know why it is slow"}], "owner": {"reputation": 23, "user_id": 9413719, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "John Louie Gonzales", "link": "https://stackoverflow.com/users/9413719/john-louie-gonzales"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 131, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1534937066, "creation_date": 1534937066, "question_id": 51965795, "link": "https://stackoverflow.com/questions/51965795/vba-internet-explorer-automation-getting-automation-error-on-iframe", "title": "VBA Internet Explorer Automation: getting automation error on iframe", "body": "<p>I am currently automating a website to pull some data. Before, my code is working fine and i was able to pull the needed data properly. But for some reasons when I test my code again I am getting an \"automation error\" on the part where I set the my object variable to get the \"iframe\".</p>\n\n<pre><code>Set html = IE.Document\n' This is the line where i get my \"automation error\"\nSet htmlelements = html.getElementsByTagName(\"iframe\")(0).contentDocument.getElementsByTagName(\"a\")(0)\n\nhtmlelement.Click\n\nSet htmlelements2 = html.getElementsByTagName(\"iframe\")(0).contentDocument.getElementsByTagName(\"tr\")\n\nFor Each htmlelement2 In htmlelements2\n    Data = htmlelement2.Children(2).textContent\nend for\n</code></pre>\n\n<p>is it possible for the website to prevent vbscript from pulling their own data. I can't share the website link because it is confidential. Needed desperate help for this one, hoping someone could help me.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1534933401, "post_id": 51964507, "comment_id": 90879359, "body": "If it&#39;s assigned to <code>wb</code> it&#39;s not clear why you&#39;re &quot;struggling to identify the file&quot;? <code>wb</code> can point to only one file. But I believe part of your problem is that you never turn the error handling back on, so you&#39;re not seeing error messages that could help you. I believe you need to <code>Set wb =...</code> to get the workbook object the code addresses with <code>Get Object</code>. That would be a start, anyway."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1534934086, "post_id": 51964507, "comment_id": 90879731, "body": "Also, a loop may be of assistance, with the loop number public, so when V=10, file will be &quot;File10.csv&quot; and the number 10 will be able to be used elsewhere?"}], "answers": [{"tags": [], "owner": {"reputation": 4162, "user_id": 362712, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yWcUr.jpg?s=128&g=1", "display_name": "Nigel Heffernan", "link": "https://stackoverflow.com/users/362712/nigel-heffernan"}, "is_accepted": false, "score": 1, "last_activity_date": 1534935074, "creation_date": 1534935074, "answer_id": 51965222, "question_id": 51964507, "link": "https://stackoverflow.com/questions/51964507/check-which-file-is-open-vba/51965222#51965222", "title": "Check which file is open VBA", "body": "<p>Don't try to match the path: mapped drives and aliases will spoof your matches.</p>\n\n<p>Your match term is the file name, with the extension, and you can iterate the Excel workbooks collection to see if there's a matching name:</p>\n\n<pre><code>Option Explicit\n\nPublic Function WorkbookIsOpen(WorkBookName As String) As Boolean\n' Returns TRUE if a workbook (or csv file open in Excel) is open\n\nDim wbk As Excel.Workbook\n\nWorkbookIsOpen = False\n\n\nIf IsError(WorkBookName) Then\n    WorkbookIsOpen = False\nElseIf WorkBookName = \"\" Then\n    WorkbookIsOpen = False\nElse\n\n    For Each wbk In Application.Workbooks\n        If wbk.Name = WorkBookName Then\n            WorkbookIsOpen = True\n            Exit For\n        End If\n    Next wbk\n\nEnd If\n\nEnd Function\n\nPublic Function FileName(FilePath As String) As String\n\n' Returns the last element of a network path\n' This is usually the file name, but it mat be a folder name if FilePath is a folder path:\n\n' FileName(\"C:\\Temp\\Readme.txt\")  returns \"ReadMe.txt\"\n' ?FileName(\"C:\\Temp\")            returns \"Temp\"\n' FileName(\"C:\\Temp\\\")            returns \"\"\n\n\n' This function does not perform any file checking - the file need not exist, the path\n' can be invali or inaccessible. All we're doing is String-handling.\n\nDim arr() As String\nDim i     As Integer\n\nIf IsError(FilePath) Then\n    FileName = \"#ERROR\"\nElseIf FilePath = \"\" Then\n    FileName = \"\"\nElse\n    arr = Split(Trim(FilePath), \"\\\")\n    i = UBound(arr)\n    FileName = arr(i)\n    Erase arr\nEnd If\n\nEnd Function\n</code></pre>\n\n<p>Then it's just a matter of checking if the open workbook is open read-only:</p>\n\n<pre><code>Dim bReadOnly As Boolean\n\nIf WorkbookIsOpen(\"C:Temp\\Brian.csv\") Then\n    bReadOnly = Application.WorkBooks(FileName(\"C:Temp\\Brian.csv\")).ReadOnly\nEnd If\n</code></pre>\n\n<p>Things get a lot more interesting if you need to check that the file isn't open in another session of Excel, or another application: this code won't test that for you.</p>\n\n<p>I need to answer the other point in your question: <strong>opening the file</strong> in Excel if it isn't already open in this session.</p>\n\n<p>I would recommend using <code>Application.Workbooks.Open(FileName)</code> for that, as it's smarter than <code>GetObject()</code> and will open the file - csv, xml, xls, xlsx - in Excel, as a workbook, with Excel guessing the necessary format parameters. Also,the native 'open' function allows you to specify additional parameters, like Read-Only.</p>\n"}], "owner": {"reputation": 167, "user_id": 9630197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31d5cd6a208cf541aea4da0c87ac2e3e?s=128&d=identicon&r=PG&f=1", "display_name": "SB999", "link": "https://stackoverflow.com/users/9630197/sb999"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1534935074, "creation_date": 1534932473, "question_id": 51964507, "link": "https://stackoverflow.com/questions/51964507/check-which-file-is-open-vba", "title": "Check which file is open VBA", "body": "<p>All, </p>\n\n<p>I have a large module which in the earlier part checks whether a files is in use (Readonly) format and if it is in use to open the next file. I.e. if file one is in use open file two etc.. </p>\n\n<p>In a later part of the module I wish to use the file which has been opened. However I am struggling to identify the file which is opened in the earlier part of the automation and set is as WB.</p>\n\n<p>The code I am currently using is;</p>\n\n<pre><code>  Dim wb As Object\n  On Error Resume Next\n  Workbooks(\"\\\\Csdatg04\\psproject\\Robot\\Project Preload\\Transactions\\Transactions1.csv\").Activate\n  If Err.Number = 0 Then\n  wb = GetObject(\"\\\\Csdatg04\\psproject\\Robot\\Project Preload\\Transactions\\Transactions1.csv\")\n  GoTo skipline\n  End If\n\nOn Error GoTo 0\nOn Error Resume Next\nWorkbooks(\"\\\\Csdatg04\\psproject\\Robot\\Project Preload\\Transactions\\Transactions2.csv\").Activate\nIf Err.Number = 0 Then\nwb = GetObject(\"\\\\Csdatg04\\psproject\\Robot\\Project Preload\\Transactions\\Transactions2.csv\")\nGoTo skipline\nEnd If\n\n On Error GoTo 0\n On Error Resume Next\n Workbooks(\"\\\\Csdatg04\\psproject\\Robot\\Project Preload\\Transactions\\Transactions3.csv\").Activate\n If Err.Number = 0 Then\n wb = GetObject(\"\\\\Csdatg04\\psproject\\Robot\\Project Preload\\Transactions\\Transactions3.csv\")\n GoTo skipline\n End If\n\nOn Error GoTo 0\nOn Error Resume Next\nWorkbooks(\"\\\\Csdatg04\\psproject\\Robot\\Project Preload\\Transactions\\Transactions4.csv\").Activate\nIf Err.Number = 0 Then\nwb = GetObject(\"\\\\Csdatg04\\psproject\\Robot\\Project Preload\\Transactions\\Transactions4.csv\")\nGoTo skipline\nEnd If\n\nskipline:\nOn Error GoTo 0\n</code></pre>\n\n<p>Can anyone recommend how I can identify which file is open and set is as WB</p>\n\n<p>Any help would be much appreciated. </p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "is_accepted": true, "score": 1, "last_activity_date": 1534934545, "creation_date": 1534934545, "answer_id": 51965054, "question_id": 51964186, "link": "https://stackoverflow.com/questions/51964186/save-records-selected-in-a-multi-select-listbox/51965054#51965054", "title": "Save records selected in a multi-select listbox", "body": "<p>You set the variables for </p>\n\n<pre><code>strUsedNumber = lstTest.Column(0, iCurrRow)\nstrUsedAddress = lstTest.Column(1, iCurrRow)\nstrUsedPosition = lstTest.Column(2, iCurrRow)\n</code></pre>\n\n<p>Outside the loop, hence they never change.</p>\n"}], "owner": {"reputation": 185, "user_id": 9869721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36d06e5b7bfa4d20b1270ad54dc8f467?s=128&d=identicon&r=PG&f=1", "display_name": "veckorevyn", "link": "https://stackoverflow.com/users/9869721/veckorevyn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 51965054, "answer_count": 1, "score": 0, "last_activity_date": 1534934545, "creation_date": 1534931516, "question_id": 51964186, "link": "https://stackoverflow.com/questions/51964186/save-records-selected-in-a-multi-select-listbox", "title": "Save records selected in a multi-select listbox", "body": "<p>I'm trying to write code for a save button, which is supposed to save data from all rows selected in a multi-select listbox. This is my code:</p>\n\n<pre><code>Dim strID As String, strFullName As String, strUsedNumber As String, strUsedAddress As String, strUsedPosition As String\nDim iCurrRow As Integer\nstrID = txtID\nstrFullName = txtFullName\nstrUsedNumber = lstTest.Column(0, iCurrRow)\nstrUsedAddress = lstTest.Column(1, iCurrRow)\nstrUsedPosition = lstTest.Column(2, iCurrRow)\n\niCurrRow = 0\nDo While (iCurrRow &lt; lstTest.ListCount)\n    If lstTest.Selected(iCurrRow) Then\n        IO_TestData.saveInfoUsedInTestData strID, strFullName, strUsedNumber, strUsedAddress, strUsedPosition\n    End If\n    iCurrRow = iCurrRow + 1\nLoop\n</code></pre>\n\n<p>Currently it saves only the first row of the listbox - if you select i.e. three rows from the list, it tries to save the first row three times. Could someone help me with this?</p>\n"}, {"tags": ["ms-access", "vba", "formatting", "html-email"], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 8843765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d0ea063b53cf04faf6dd293c96ecf0d?s=128&d=identicon&r=PG&f=1", "display_name": "pirloe", "link": "https://stackoverflow.com/users/8843765/pirloe"}, "edited": false, "score": 0, "creation_date": 1534938894, "post_id": 51964454, "comment_id": 90882331, "body": "Do you perhaps have a link to a good template? This is a great method but i&#39;m not sure where to begin with creating the HTML file. I found this answer <a href=\"https://stackoverflow.com/a/30742862/8843765\">link</a> very useful as it does what i&#39;d like it to but is probably not as flexible as what you&#39;re suggesting."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 67, "user_id": 8843765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d0ea063b53cf04faf6dd293c96ecf0d?s=128&d=identicon&r=PG&f=1", "display_name": "pirloe", "link": "https://stackoverflow.com/users/8843765/pirloe"}, "edited": false, "score": 0, "creation_date": 1534941074, "post_id": 51964454, "comment_id": 90883822, "body": "You simply compose the HTML mail in Outlook as you would do with any other mail. Enter the variables as normal text, either inline for single words or values, or between empty paragraphs for the table. Then File - Save as - oft. @go995"}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 0, "last_activity_date": 1534932290, "creation_date": 1534932290, "answer_id": 51964454, "question_id": 51963817, "link": "https://stackoverflow.com/questions/51963817/write-multi-line-email-by-looping-query-and-format-into-columns-in-vba-access/51964454#51964454", "title": "Write multi-line email by looping query and format into columns in VBA Access", "body": "<p>I do this with HTML mails.</p>\n\n<p>I have a HTML mail template saved as .oft file, and create the mail item like this:</p>\n\n<pre><code>Dim oItem As Outlook.MailItem\nSet oItem = oOutlook.CreateItemFromTemplate(TemplatePath)\n</code></pre>\n\n<p>The mail template contains variables like <code>$TableGoesHere$</code> which are replaced by the variable data when creating the mail, e.g.</p>\n\n<pre><code>Set Tem = MyDB.OpenRecordset(\"TestQuery\", dbOpenForwardOnly)\nstrTbl = OutlookHtmlTableFromRS(Tem)\n\noItem.HtmlBody = Replace(oItem.HtmlBody, \"$TableGoesHere$\", strTbl)\n</code></pre>\n\n<p>with the function:</p>\n\n<pre><code>' Create HTML table from a recordset, with all columns except those in &lt;sExcl&gt;\n' Returns HTML string to insert into HTML mail\nPublic Function OutlookHtmlTableFromRS(RS As Recordset, Optional sExcl As String = \"\") As String\n\n    Dim fld As DAO.Field\n    Dim S As String\n\n    ' Table heading row\n    S = \"&lt;table cellpadding='5' style='text-align:left; border: 1px solid gray; border-collapse:collapse; font-family:Calibri, Helvetica, sans-serif; font-size:11pt;'&gt;\" &amp; _\n        \"&lt;tr style='padding:5px;border: 1px solid gray;'&gt;\"\n\n    For Each fld In RS.Fields\n        If InStr(sExcl, fld.Name) = 0 Then\n            S = S &amp; \"&lt;th style='border: 1px solid gray;'&gt;\" &amp; fld.Name &amp; \"&lt;/th&gt;\"\n        End If\n    Next fld\n    S = S &amp; \"&lt;/tr&gt;\"\n\n    ' Data rows\n    Do While Not RS.EOF\n        S = S &amp; \"&lt;tr style='padding:5px;'&gt;\"\n\n        For Each fld In RS.Fields\n            If InStr(sExcl, fld.Name) = 0 Then\n                S = S &amp; \"&lt;td style='border: 1px solid gray;'&gt;\" &amp; fld.Value &amp; \"&lt;/td&gt;\"\n            End If\n        Next fld\n\n        S = S &amp; \"&lt;/tr&gt;\"\n        RS.MoveNext\n    Loop\n\n    S = S &amp; \"&lt;/table&gt;\"\n\n    RS.Close\n\n    OutlookHtmlTableFromRS = S\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 1197809, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35d7dc68177d82dac843aeca6579fd5e?s=128&d=identicon&r=PG", "display_name": "irockyoursocks", "link": "https://stackoverflow.com/users/1197809/irockyoursocks"}, "is_accepted": false, "score": 0, "last_activity_date": 1537567364, "creation_date": 1537567364, "answer_id": 52451524, "question_id": 51963817, "link": "https://stackoverflow.com/questions/51963817/write-multi-line-email-by-looping-query-and-format-into-columns-in-vba-access/52451524#52451524", "title": "Write multi-line email by looping query and format into columns in VBA Access", "body": "<p>Yes, HTML is the best way! :) With HTML you can create tables in Outlook and have formatting too! And HTML is pretty easy. For any formatting you want, just google it. For example, if you wanted some of the data to be right aligned, you might google \"html table right align\". There are many helpful websites out there for HTML.</p>\n\n<p>The below VBA code is what I used to put the contents of an Access query into the body of an Outlook email.</p>\n\n<p>While it may look long, it works and it's the best way to copy a query or table into an email.</p>\n\n<p>I love this! My email looks really good!</p>\n\n<pre><code>Private Sub btnEmail_Click()\n'This will open an email in your Outlook and compose it for you. You review and click send.\n'This macro requires the reference \"Microsoft Outlook 16.0 Object Library\" to be enabled.\n\nDim f As Long, c As Long  \nDim sTable As String\nDim rs As DAO.Recordset\nDim olApp As Outlook.Application\nDim olMsg As Outlook.MailItem\nDim olRecip As Recipient\nDim Recipients As Recipients\nDim qField(1 To 4)  'array\n\n\n''Table Header\nqField(1) = \"Group Number\"\nqField(2) = \"Group Name\"\nqField(3) = \"PTD\"\nqField(4) = \"Term Date\"\nsTable = \"&lt;table border=0 cellspacing=0 style='padding:0in 5.5pt 0in 5.5pt'&gt;&lt;tbody&gt;\"\nsTable = sTable &amp; \"&lt;tr bgcolor=\"\"#70ad47\"\"&gt;&lt;font color=\"\"white\"\"&gt;&lt;b&gt;&lt;td&gt;Group#&lt;/td&gt;\"  'white font, bold, green fill\nsTable = sTable &amp; \"&lt;td&gt;Group Name&lt;/td&gt;\"\nsTable = sTable &amp; \"&lt;td&gt;PTD&lt;/td&gt;\"\nsTable = sTable &amp; \"&lt;td&gt;Term Date&lt;/td&gt;&lt;/b&gt;&lt;/font&gt;&lt;/tr&gt;\"\n\n''Rows\nSet rs = CurrentDb.OpenRecordset(\"TestQuery\")\nDo Until rs.EOF\n    c = c + 1   'counter for the every other row light green\n    If c Mod 2 = 0 Then   'every other row light green\n        sTable = sTable &amp; \"&lt;tr style=\"\"background: #e2efd9\"\"&gt;\"\n    Else\n        sTable = sTable &amp; \"&lt;tr&gt;\"   'open row\n    End If\n\n    For f = 1 To 4        'cells\n        sTable = sTable &amp; \"&lt;td&gt;\" &amp; rs.Fields(qField(f)) &amp; \"&lt;/td&gt;\"\n    Next\n    sTable = sTable &amp; \"&lt;/tr&gt;\"   'close row\n    rs.MoveNext\nLoop\nsTable = sTable &amp; \"&lt;/tbody&gt;&lt;/table&gt;\"   'close table\nrs.Close\nSet rs = Nothing\n\n''Compose Email\nSet olApp = CreateObject(\"Outlook.Application\")\nSet olMsg = olApp.CreateItem(olMailItem)\nolMsg.To = \"test@abc.com\"\nFor Each olRecip In olMsg.Recipients\n  olRecip.Resolve\nNext\nolMsg.Subject = \"Test \" &amp; Format(Date, \"Medium Date\")\nolMsg.Display   'This must go before the .HTMLBody line b/c that is the only way to capture the existing default signature.\nolMsg.HTMLBody = \"&lt;Body&gt;&lt;div&gt;Hello,&lt;br&gt;\" &amp; _\n  \"Please see report below.&lt;br&gt;&lt;br&gt;\" &amp; sTable &amp; olMsg.HTMLBody\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 8843765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d0ea063b53cf04faf6dd293c96ecf0d?s=128&d=identicon&r=PG&f=1", "display_name": "pirloe", "link": "https://stackoverflow.com/users/8843765/pirloe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 495, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1537567364, "creation_date": 1534930326, "last_edit_date": 1534933331, "question_id": 51963817, "link": "https://stackoverflow.com/questions/51963817/write-multi-line-email-by-looping-query-and-format-into-columns-in-vba-access", "title": "Write multi-line email by looping query and format into columns in VBA Access", "body": "<p>I have an access query which I aim to loop through and write the contents to the email body of an outlook email. The below code does the job, however if there are a  lot of lines, it doesn't look great and becomes very busy, visually. </p>\n\n<p>I'd like to either, add some formatting rules which will align each variable into a \"column\", or make each variable a fixed length so that the pipes (\"|\") align (and of course making the variable fixed length would probably mean filling some with \" \" spaces from the left. </p>\n\n<p>Alternatively, I could try sort this issue out using HTML or something? though I have no experience with that, but if this is the way to go, any advise would be greatly appreciated. </p>\n\n<pre><code>Public Sub Test()\n\nOn Error GoTo Error_Handler\n\nDim strbody, DateStamp\nstrbody = \"\"\nDateStamp = Format(Date, \"Medium Date\")\n\nDim MyDB As DAO.Database\nDim Tem As DAO.Recordset\nSet MyDB = CurrentDb()\nSet Tem = MyDB.OpenRecordset(\"TestQuery\", dbOpenForwardOnly)\nWith Tem\n    Do While Not .EOF\n        strbody = strbody + (CStr(![Num]) + \" | \" + CStr(Format(![TDate], \"Medium Date\")) + \" | \" + CStr(Format(![VDate], \"Medium Date\")) + \" | \" + CStr(Format(![QTY], \"Standard\")) + \" | \" + ![Name] &amp; vbNewLine)\n        .MoveNext\n    Loop\nEnd With\nTem.Close\nSet Tem = Nothing\n\nDim OutApp As Object\nDim OutMail As Object\n\nDim objOutlook As Outlook.Application\nDim objEmail As Outlook.MailItem\n\nSet objOutlook = CreateObject(\"Outlook.application\")\nSet objEmail = objOutlook.CreateItem(olMailItem)\n\nWith objEmail\n    .To = \"test@abc.com\"\n    .subject = \"Test\" &amp; \" \" &amp; DateStamp\n    .Body = strbody\n    .Display\nEnd With\n\nExit_Here:\n    Set objOutlook = Nothing\n    Exit Sub\n\nError_Handler:\n    MsgBox Err &amp; \": \" &amp; Err.Description\n    Resume Exit_Here\n\nEnd Sub\n</code></pre>\n\n<p>Currently, the output in the email looks a bit like this:</p>\n\n<pre><code>1234 | 22-Aug-18 | 23-Aug-18 | 1,000.00 | testname 123 \n5678 | 21-Aug-18 | 22-Aug-18 | 50,000.00 | second testname of different length\n</code></pre>\n\n<p>The more lines the messier it gets, in addition to missing column names.</p>\n\n<p>Again, any help is greatly appreciated. Thank you.</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1534932934, "post_id": 51963527, "comment_id": 90879098, "body": "This is because a table cell contains two characters that are responsible for the internal cell structures, behind the scenes: a Chr(13) and a Chr(7). These need to be &quot;trimmed&quot; from the text (<code>Name_1</code>). See this: <a href=\"https://stackoverflow.com/a/49533912/3077495\">stackoverflow.com/a/49533912/3077495</a>"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1534932961, "post_id": 51963527, "comment_id": 90879115, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/49532952/reading-date-from-table-in-word-without-additional-characters\">Reading date from table in Word without additional characters</a>"}], "answers": [{"comments": [{"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "reply_to_user": {"reputation": 31, "user_id": 10247198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/221950853a85c466a11c1fa62efc5b17?s=128&d=identicon&r=PG&f=1", "display_name": "Viktor Kolman", "link": "https://stackoverflow.com/users/10247198/viktor-kolman"}, "edited": false, "score": 0, "creation_date": 1534974863, "post_id": 51967203, "comment_id": 90901786, "body": "Either works. If you&#39;re getting a Type mismatch, that&#39;s because of other errors in your code."}, {"owner": {"reputation": 31, "user_id": 10247198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/221950853a85c466a11c1fa62efc5b17?s=128&d=identicon&r=PG&f=1", "display_name": "Viktor Kolman", "link": "https://stackoverflow.com/users/10247198/viktor-kolman"}, "edited": false, "score": 0, "creation_date": 1535007227, "post_id": 51967203, "comment_id": 90909429, "body": "Super, second code works. Many thanks for your help."}], "tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": false, "score": 0, "last_activity_date": 1535010101, "last_edit_date": 1535010101, "creation_date": 1534941886, "answer_id": 51967203, "question_id": 51963527, "link": "https://stackoverflow.com/questions/51963527/vba-replace-text-from-word-table/51967203#51967203", "title": "VBA - replace text from word table", "body": "<p>Try:</p>\n\n<pre><code>Name_1 = Split(ActiveDocument.Tables(1).Cell(1, 2).Range.Text, vbCr)(0)\n</code></pre>\n\n<p>or, if there may be more than one paragraph in the cell:</p>\n\n<pre><code>Name_1 = ActiveDocument.Tables(1).Cell(1, 2).Range.Text\nName_1 = Left(Name_1, Len(Name_1)-2)\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 10247198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/221950853a85c466a11c1fa62efc5b17?s=128&d=identicon&r=PG&f=1", "display_name": "Viktor Kolman", "link": "https://stackoverflow.com/users/10247198/viktor-kolman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1535010101, "creation_date": 1534929401, "last_edit_date": 1534966915, "question_id": 51963527, "link": "https://stackoverflow.com/questions/51963527/vba-replace-text-from-word-table", "title": "VBA - replace text from word table", "body": "<p>I try to copy the text from the table in Word to the text, but after the text is overwritten, it appears in the text \"black\" dot. Please, can you tell me where I am wrong?</p>\n\n<pre><code>Dim rngStory   As Range    \n    Name_1 = ActiveDocument.Tables(1).Cell(1, 2)        \n    For Each rngStory In ActiveDocument.StoryRanges    \n      With rngStory.Find    \n      .Text = \"&lt;&lt;name&gt;&gt;\"    \n        .Replacement.Text = Name_1    \n        .Wrap = wdFindContinue    \n      .Execute Replace:=wdReplaceAll    \n      End With        \n  Next rngStory\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/vZ3OL.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vZ3OL.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1534937605, "post_id": 51963157, "comment_id": 90881583, "body": "just as a note: <code>x1Down</code> should be <code>xlDown</code>"}, {"owner": {"reputation": 101, "user_id": 10206926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1abcb91b73a358b0458351b1b4fe0c8e?s=128&d=identicon&r=PG&f=1", "display_name": "sant", "link": "https://stackoverflow.com/users/10206926/sant"}, "reply_to_user": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1534938916, "post_id": 51963157, "comment_id": 90882347, "body": "Thank you. I have changed this and I can only get a new row above the old row but the updation is happening only in the old row and new row is just empty."}], "owner": {"reputation": 101, "user_id": 10206926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1abcb91b73a358b0458351b1b4fe0c8e?s=128&d=identicon&r=PG&f=1", "display_name": "sant", "link": "https://stackoverflow.com/users/10206926/sant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1534937506, "creation_date": 1534928108, "last_edit_date": 1534937506, "question_id": 51963157, "link": "https://stackoverflow.com/questions/51963157/how-to-move-the-updated-data-to-the-new-rowbelow-the-old-data-by-keeping-the-o", "title": "How to move the updated data to the new row(below the old data) by keeping the old data constant with the help of Userform?", "body": "<p>I need some help with updating the data in the Excelsheet using Userform. I was successful in searching the data with a unique Id by creating a search button on the userform and updating the data.</p>\n\n<p>But my problem is after I modify the data w.r.t unique ID it should get updated in my worksheet in a new row below the old data with the same unique id selected.</p>\n\n<p>For more clarity i have attached a sample Image how it should look.</p>\n\n<p>Below is my Code which I tried to create a new row but not able to Keep the old data unchanged.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim WB As Workbook\n    Set WB = Workbooks.Open(\"C:\\Desktop\\Process.xlsx\")\n    Set ssheet = WB.Worksheets(\"Process1\")\n    Dim totalrow As Long\n    totalrow = ssheet.Range(\"A1\").CurrentRegion.Rows.Count\n    For currentrow = 2 To totalrow\n        If Trim(tbsno) = Trim(Cells(currentrow, 1)) Then\n            tbaxalant = Cells(currentrow, 2)\n            tbrequest = Cells(currentrow, 3)\n        End If\n    Next currentrow\nEnd Sub\n\nPrivate Sub CommandButton2_Click()\n\n    Dim WB As Workbook\n    Set WB = Workbooks.Open(\"C:\\Desktop\\Process.xlsx\")\n    Set ssheet = WB.Worksheets(\"Process1\")\nssheet.Range(\"A4\").Select\n    ActiveCell.EntireRow.Insert Shift:=x1Down\n    Dim fvalue As Range\n    Set fvalue = ssheet.Range(\"A:A\").Find(What:=Me.tbsno.Value, LookIn:=xlFormulas, LookAt:=xlWhole)\n    fvalue.Value = Me.tbsno\n    fvalue.Offset(0, 1).Value = Me.tbaxalant\n    fvalue.Offset(0, 2).Value = Me.tbrequest\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/ErJu4.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ErJu4.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 1, "last_activity_date": 1534932150, "creation_date": 1534932150, "answer_id": 51964407, "question_id": 51963153, "link": "https://stackoverflow.com/questions/51963153/vba-exit-function-not-working-success-on-first-call-of-function-failure-on-sub/51964407#51964407", "title": "VBA Exit Function not working? Success on first call of function, failure on subsequent calls", "body": "<p>It's because you're calling the function recursively - calling it from within itself (in the <code>For i = 0 to numFolders - 1</code> loop). </p>\n\n<p>If you tell it to exit while it's calling itself from within the For loop it will return to execution in the For loop.</p>\n\n<p>Instead of using <code>Exit Function</code> in this position, declare a Boolean variable and set it to True, here. Use <code>Do While...Loop</code> instead of the out-dated <code>While...Wend</code> construct then you can use <code>Exit Do</code> to leave that loop. </p>\n\n<p>Finally, check in the <code>For</code> loop whether the Boolean is True and exit that loop. Since that's at the end of the Function, the function will end normally. More like:</p>\n\n<pre><code>Function FindFilePath(ByRef FolderPath As String, ByVal v As String) As String\n    Dim bMatchFound as Boolean\n    Dim FileName As String, fullFilePath As String, numFolders As Long, Folders() As String, i As Long\n    Dim objFSO As Object, f As Object\n\n    If Right(FolderPath, 1) &lt;&gt; \"\\\" Then FolderPath = FolderPath &amp; \"\\\"\n    FileName = Dir(FolderPath &amp; \"*.*\", vbDirectory)\n\n    Do While Len(FileName) &lt;&gt; 0    \n        If Left(FileName, 1) &lt;&gt; \".\" Then   \n            fullFilePath = FolderPath &amp; FileName   \n            If (GetAttr(fullFilePath) And vbDirectory) = vbDirectory Then    \n                ReDim Preserve Folders(0 To numFolders) As String\n                Folders(numFolders) = fullFilePath\n                numFolders = numFolders + 1    \n            Else  \n                If InStr(fullFilePath, v) &gt; 0 Then                               \n                    FindFilePath = fullFilePath                                 \n                    bMatchFound = True\n                    Exit Do\n                End If       \n            End If          \n        End If              \n\n        FileName = Dir()    \n    Loop                        \n\n    For i = 0 To numFolders - 1\n        If bMatchFound Then Exit For\n        FindFilePath Folders(i), v\n    Next i\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 140, "user_id": 3876634, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kOdGm.jpg?s=128&g=1", "display_name": "forrestedw", "link": "https://stackoverflow.com/users/3876634/forrestedw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 422, "favorite_count": 0, "accepted_answer_id": 51964407, "answer_count": 1, "score": 1, "last_activity_date": 1534932150, "creation_date": 1534928081, "last_edit_date": 1534931211, "question_id": 51963153, "link": "https://stackoverflow.com/questions/51963153/vba-exit-function-not-working-success-on-first-call-of-function-failure-on-sub", "title": "VBA Exit Function not working? Success on first call of function, failure on subsequent calls", "body": "<p>I have two functions. The first loops through a range in excel, the second finds a file based on a search string that you provide it with and passes it back to the first.</p>\n\n<p>The second function works by exiting the function when it gets the first match on the search string. However, it's only exiting on the first run through the function, not for any subsequent runs. Instead it jumps to <code>Next i</code>.</p>\n\n<p>I have stepped through using F8 and I can see it hit <code>Exit Function</code> but it just keeps on running the function regardless. </p>\n\n<p>What have I done wrong? </p>\n\n<p>Function 1:</p>\n\n<pre><code>Function GrabQuestionnaireLocations()\n\n    Dim a As Range, b As Range, N As Long, qPath As String\n\n    N = Cells(Rows.Count, \"A\").End(xlUp).Row\n\n    Set a = Range(\"A2:A\" &amp; N)\n\n    For Each b In a.Rows\n\n        qPath = FindFilePath(_ROOT_PATH_, b.Value)\n\n        If Len(qPath) &gt; 0 Then\n            Cells(b.Row, \"C\").Value = qPath\n        Else\n            Cells(b.Row, \"C\").Value = \"Questionnaire not found\"\n        End If\n\n        'MsgBox qPath\n\n    Next\n\n\nEnd Function\n</code></pre>\n\n<p>Function 2:</p>\n\n<pre><code>Function FindFilePath(ByRef FolderPath As String, ByVal v As String) As String\n\n    Dim FileName As String, fullFilePath As String, numFolders As Long, Folders() As String, i As Long\n    Dim objFSO As Object, f As Object\n\n    If Right(FolderPath, 1) &lt;&gt; \"\\\" Then FolderPath = FolderPath &amp; \"\\\"\n    FileName = Dir(FolderPath &amp; \"*.*\", vbDirectory)\n\n    While Len(FileName) &lt;&gt; 0\n\n        If Left(FileName, 1) &lt;&gt; \".\" Then\n\n            fullFilePath = FolderPath &amp; FileName\n\n            If (GetAttr(fullFilePath) And vbDirectory) = vbDirectory Then\n\n                ReDim Preserve Folders(0 To numFolders) As String\n                Folders(numFolders) = fullFilePath\n                numFolders = numFolders + 1\n\n            Else\n\n                If InStr(fullFilePath, v) &gt; 0 Then                           \n\n                    FindFilePath = fullFilePath                                 \n                    Exit Function                                               \n\n                End If       \n\n            End If      \n\n        End If              \n\n        FileName = Dir()\n\n    Wend                        \n\n    For i = 0 To numFolders - 1\n        FindFilePath Folders(i), v\n    Next i\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1534927056, "post_id": 51962767, "comment_id": 90875867, "body": "I don&#39;t think you can do this simply using Data Validation. You would have to use a ComboBox"}, {"owner": {"reputation": 11, "user_id": 9161555, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CXTGBbEyoIU/AAAAAAAAAAI/AAAAAAAABE0/Oj7pmaX9L5c/photo.jpg?sz=128", "display_name": "srivardhan kandike", "link": "https://stackoverflow.com/users/9161555/srivardhan-kandike"}, "reply_to_user": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1534927321, "post_id": 51962767, "comment_id": 90876006, "body": "Any other ways do like that i mean using formulas"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1534939639, "post_id": 51962767, "comment_id": 90882831, "body": "Data validation does not have autocomplete"}], "owner": {"reputation": 11, "user_id": 9161555, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CXTGBbEyoIU/AAAAAAAAAAI/AAAAAAAABE0/Oj7pmaX9L5c/photo.jpg?sz=128", "display_name": "srivardhan kandike", "link": "https://stackoverflow.com/users/9161555/srivardhan-kandike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594152470, "creation_date": 1534926710, "last_edit_date": 1594152470, "question_id": 51962767, "link": "https://stackoverflow.com/questions/51962767/how-do-i-search-number-in-data-validation-list", "title": "How do i search number in data-validation list?", "body": "<p>I have data in v column the data look like 24/25,25/26...up to 100/101 using data validation I put them in a list so now whenever I type 24 in data validation cell it should show me the 24/25 so how do I do that?</p>\n"}, {"tags": ["python", "excel", "vba", "pywin32"], "comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1534927179, "post_id": 51962723, "comment_id": 90875929, "body": "What can&#39;t VBA do?"}, {"owner": {"reputation": 1063, "user_id": 8019379, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ZcQhe.png?s=128&g=1", "display_name": "Lucas Raphael Pianegonda", "link": "https://stackoverflow.com/users/8019379/lucas-raphael-pianegonda"}, "reply_to_user": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1534927357, "post_id": 51962723, "comment_id": 90876032, "body": "@Tom When calling python script above the VBA program above does not print the output from the python script. This way one is completely blind of what is going wrong on the python side. Is that a better explaination?"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1534927446, "post_id": 51962723, "comment_id": 90876083, "body": "Sorry I meant - Why are you passing it over to Python. What can&#39;t VBA do that you&#39;re using Python for instead"}, {"owner": {"reputation": 1063, "user_id": 8019379, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ZcQhe.png?s=128&g=1", "display_name": "Lucas Raphael Pianegonda", "link": "https://stackoverflow.com/users/8019379/lucas-raphael-pianegonda"}, "reply_to_user": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1534927630, "post_id": 51962723, "comment_id": 90876172, "body": "@Tom Ahhh.. gotcha: Scipy.LSQUnivariateSpline is the method I couldn&#39;t find for VBA and I decided rather to implement a python VBA interface instead of coding the LSQUnivarianteSpline in VBA by myself."}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 2, "creation_date": 1534928257, "post_id": 51962723, "comment_id": 90876497, "body": "ah fair enough. Have you thought about using something like <a href=\"https://www.xlwings.org/\" rel=\"nofollow noreferrer\">xlWings</a> so that it can all be done in Excel instead of passing it to an eternal application?"}, {"owner": {"reputation": 43423, "user_id": 1011724, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/2JAXi.jpg?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/1011724/dan"}, "edited": false, "score": 0, "creation_date": 1534929635, "post_id": 51962723, "comment_id": 90877254, "body": "Have you tried using <code>pdb</code>? Do you see the <code>&#39;Hello User!&#39;</code> getting printed?"}, {"owner": {"reputation": 1063, "user_id": 8019379, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ZcQhe.png?s=128&g=1", "display_name": "Lucas Raphael Pianegonda", "link": "https://stackoverflow.com/users/8019379/lucas-raphael-pianegonda"}, "reply_to_user": {"reputation": 43423, "user_id": 1011724, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/2JAXi.jpg?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/1011724/dan"}, "edited": false, "score": 0, "creation_date": 1534930543, "post_id": 51962723, "comment_id": 90877797, "body": "@Dan No I don&#39;t see the &#39;Hello User!&#39;. I am trying to make it work but no success until now.."}, {"owner": {"reputation": 43423, "user_id": 1011724, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/2JAXi.jpg?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/1011724/dan"}, "edited": false, "score": 0, "creation_date": 1534931169, "post_id": 51962723, "comment_id": 90878156, "body": "@LucasRaphaelPianegonda does you command prompt window stay open long enough to see what is output? Instead of <code>Debug.Assert 0 = oShell.Run(&quot;&lt;FullpathtoScript&gt;.py&quot;, 0, True)</code>, see if <code>ret_val = Shell(&quot;&lt;FullpathtoScript&gt;.py&quot;, vbNormalFocus)</code> works any better"}, {"owner": {"reputation": 1063, "user_id": 8019379, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ZcQhe.png?s=128&g=1", "display_name": "Lucas Raphael Pianegonda", "link": "https://stackoverflow.com/users/8019379/lucas-raphael-pianegonda"}, "reply_to_user": {"reputation": 43423, "user_id": 1011724, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/2JAXi.jpg?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/1011724/dan"}, "edited": false, "score": 0, "creation_date": 1534933442, "post_id": 51962723, "comment_id": 90879383, "body": "@Dan Well that doesn&#39;t solve it completly but I see the shell now since I use pdb.set_trace and I see the &#39;Hello User!&#39;. After the error the shell closes and VBA continues. It doesn&#39;t solve the error in the python script but I have hope now."}, {"owner": {"reputation": 43423, "user_id": 1011724, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/2JAXi.jpg?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/1011724/dan"}, "edited": false, "score": 0, "creation_date": 1534933553, "post_id": 51962723, "comment_id": 90879437, "body": "@LucasRaphaelPianegonda but can you read the error now? If you can&#39;t, worst case, print something at every second line so you can at least find exactly which line is erroring"}, {"owner": {"reputation": 1063, "user_id": 8019379, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ZcQhe.png?s=128&g=1", "display_name": "Lucas Raphael Pianegonda", "link": "https://stackoverflow.com/users/8019379/lucas-raphael-pianegonda"}, "reply_to_user": {"reputation": 43423, "user_id": 1011724, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/2JAXi.jpg?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/1011724/dan"}, "edited": false, "score": 1, "creation_date": 1534945179, "post_id": 51962723, "comment_id": 90886624, "body": "@Dan I implemented the second solution from this post: <a href=\"https://stackoverflow.com/questions/45105388/moving-numpy-arrays-from-vba-to-python-and-back\" title=\"moving numpy arrays from vba to python and back\">stackoverflow.com/questions/45105388/&hellip;</a> This works like a charm and prints the errormessages into a VBA errormessage. This solves the issue then."}, {"owner": {"reputation": 1063, "user_id": 8019379, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ZcQhe.png?s=128&g=1", "display_name": "Lucas Raphael Pianegonda", "link": "https://stackoverflow.com/users/8019379/lucas-raphael-pianegonda"}, "edited": false, "score": 2, "creation_date": 1534945289, "post_id": 51962723, "comment_id": 90886710, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/45105388/moving-numpy-arrays-from-vba-to-python-and-back\">Moving numpy arrays from VBA to Python and back</a>"}], "owner": {"reputation": 1063, "user_id": 8019379, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ZcQhe.png?s=128&g=1", "display_name": "Lucas Raphael Pianegonda", "link": "https://stackoverflow.com/users/8019379/lucas-raphael-pianegonda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 304, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594152464, "creation_date": 1534926553, "last_edit_date": 1594152464, "question_id": 51962723, "link": "https://stackoverflow.com/questions/51962723/how-to-debug-python-script-called-from-an-excel-vba-script", "title": "How to debug Python Script called from an Excel VBA script?", "body": "<p>I call a python script from VBA to do a fit that excel cannot do and scipy has a convenient function for it. So I use this code to call the function and get and set data in VBA:</p>\n\n<pre><code>Public Function GetData()\n  GetData = Cache\n  Cache = Empty\nEnd Function\n\nPublic Sub SetData(data)\n  Dim ok As Boolean\n  Cache = data\nEnd Sub\n\nSub LSQCBSplineIO(targetrng As Range)\nDim oShell As Object\nDim OutputArr() As Double\nDim InputArr() As Double\nDim ok As Boolean\n\nCall getinputarray(targetrng, InputArr) ' This works, tested it\nSet oShell = VBA.CreateObject(\"WScript.Shell\")\n\n' Make the data available via GetData()'\nCache = InputArr\n\nDebug.Assert 0 = oShell.Run(\"&lt;FullpathtoScript&gt;.py\", 0, True)\n\n' Handle the returned data '\ntargetrng = Cache\n\nEnd Sub\n</code></pre>\n\n<p>This does work according to the answer to <a href=\"https://stackoverflow.com/questions/45105388/moving-numpy-arrays-from-vba-to-python-and-back\">this</a> question.</p>\n\n<p>The python code I call is the following:</p>\n\n<pre><code>import win32com.client\nimport numpy as np\nimport os\nimport matplotlib.pyplot as plt\nimport win32com.client\nfrom scipy.interpolate import LSQUnivariateSpline, UnivariateSpline\n\nprint \"Hello, User!\"\n\n# get the running instance of Excel\napp = win32com.client.GetObject(Class=\"Excel.Application\")\n\n# get some data from Excel\ndata = app.Run(\"GetData\")\nssc=np.array(data)\n\n# do fitting ...\n&lt;insert fitting code here&gt;\n\n# return some data to excel\napp.run(\"SetData\")\n</code></pre>\n\n<p>The program is basically this:</p>\n\n<ul>\n<li><p>VBA calls Python</p></li>\n<li><p>Python calls VBA and gets data</p></li>\n<li><p>Python does stuff</p></li>\n<li><p>Python calls VBA and sets data</p></li>\n<li><p>Python is done and VBA takes over again</p></li>\n</ul>\n\n<p>If now Python has an error VBA will get stuck. VBA doesn't get an errormessage and hangs in there forever, causing excel to crash. So a bug in python means that I need to forcequit excel afterwards. The python script above is made to be called from VBA because only then the required data is at the right place for it to be gathered. </p>\n\n<p><strong>The problem is now: That this cannot be debugged in python and not in VBA.</strong></p>\n\n<p>In python the program doesn't work because it is not meant to work like that and in VBA I get no errormessage and the program gets stuck. </p>\n\n<p><strong>So how does one debug something like this?</strong> </p>\n\n<p><em>OR even better</em></p>\n\n<p><strong>Is there a smarter way to move data between python and VBA?</strong></p>\n\n<p>Footnote: I initially used .txt files to intermediately, so python would have a input.txt and an output.txt. This was slow though and had issues running at full speed. See my <a href=\"https://stackoverflow.com/questions/51942083/how-does-one-deal-with-refresh-delay-when-calling-python-from-vba-using-txt-as\">other question</a>.</p>\n"}, {"tags": ["vba", "excel", "formatting"], "comments": [{"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1534946321, "post_id": 51962491, "comment_id": 90887395, "body": "What is the value of your variable valuestore. Range(&quot;Z&quot; &amp; i).Value = valuestore does not set the variables&#39; value, it puts the valuestore value into the range."}, {"owner": {"reputation": 59, "user_id": 6316529, "user_type": "registered", "profile_image": "https://graph.facebook.com/761439921356/picture?type=large", "display_name": "Kyle Cranfill", "link": "https://stackoverflow.com/users/6316529/kyle-cranfill"}, "reply_to_user": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1535350038, "post_id": 51962491, "comment_id": 91016873, "body": "Good Catch.  thanks....after like 400 lines of code my brain was fried and I input that backwards!"}], "answers": [{"tags": [], "owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "is_accepted": false, "score": 1, "last_activity_date": 1534927587, "creation_date": 1534927587, "answer_id": 51963000, "question_id": 51962491, "link": "https://stackoverflow.com/questions/51962491/checking-if-cell-is-blank-if-it-is-fill-it-then-compare-result-to-old-value/51963000#51963000", "title": "Checking if cell is blank, if it is, fill it, then compare result to old value &amp; if different, highlight using VBA?", "body": "<p>For a blank cell <code>Range(\"Z\" &amp; i).Value = \"\"\"\"</code> will always return <code>FALSE</code></p>\n\n<p><code>Range(\"Z\" &amp; i).Value = \"\"</code> will return <code>TRUE</code></p>\n\n<p><code>Range(\"Z\" &amp; i).Value = vbNullString</code> is possibly a more specific test.</p>\n"}], "owner": {"reputation": 59, "user_id": 6316529, "user_type": "registered", "profile_image": "https://graph.facebook.com/761439921356/picture?type=large", "display_name": "Kyle Cranfill", "link": "https://stackoverflow.com/users/6316529/kyle-cranfill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 188, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1534927587, "creation_date": 1534925560, "question_id": 51962491, "link": "https://stackoverflow.com/questions/51962491/checking-if-cell-is-blank-if-it-is-fill-it-then-compare-result-to-old-value", "title": "Checking if cell is blank, if it is, fill it, then compare result to old value &amp; if different, highlight using VBA?", "body": "<p>Im trying to have this function loop through a range of values in column Z from rows 6 to the number stored in the OS_PLs variable.  I want it to check to see if there is already an invoice number in the cell...and if there is, to move on to the next cell....however if there is not, to put this match formula in to see if it can find a corresponding invoice number on the ARbalance sheet.  Then, if it placed something other than the original value in the cell, to highlight the cell in orange with black hash marks.</p>\n\n<p>To accomplish this I have tried to first store the initial value in a variable \"valuestore\"</p>\n\n<p>Next I tried to make sure to clear any cells that only contain \"\" from the last time I ran this function (later in the macro it copys the range and pastes as values to get rid of the formulas) so that the \"isempty\" check will work properly.</p>\n\n<p>Next I have it check if the cell is empty and if it is not, it should just move on to the next i but if it is empty, then it should input the match formula</p>\n\n<p>Finally, assuming the cell was empty in the last step, it should compare the new value to the old value and if it is different, then it should highlight the cell.</p>\n\n<p>For whatever reason this seems to be clearing each cell, it seems to always show nothing as the value of the valuestore variable, and it is inputting the formula in every cell.  the only thing it seems to do (kind of) correctly is to highlight the cells which end up with values at the end and not highlight the cells which remain \"\".  However, it is also highlighting the cells which originally contained invoice numbers that it has deleted and since overwritten.</p>\n\n<p>Anyone have any ideas?</p>\n\n<p>Thanks</p>\n\n<pre><code>For i = 6 To OS_PLs\n\n   Dim valuestore As String\n   Range(\"Z\" &amp; i).Value = valuestore\n   MsgBox (valuestore)\n\n    If Range(\"Z\" &amp; i).Value = \"\"\"\" Then\n        Range(\"Z\" &amp; i).Clear\n    End If\n\n    If IsEmpty(Range(\"Z\" &amp; i)) Then\n        Range(\"Z\" &amp; i).Select\n            ActiveCell.FormulaR1C1 = _\n                \"=IFERROR(IF(LEFT(INDEX('AR balance.xlsx'!AR_Invoice_Nums,MATCH(RC[-20],'AR balance.xlsx'!AR_PL_Nums,0)),5)=\"\"CMSHK\"\",\"\"\"\",INDEX('AR balance.xlsx'!AR_Invoice_Nums,MATCH(RC[-20],'AR balance.xlsx'!AR_PL_Nums,0))),\"\"\"\")\"\n\n        If Not (Range(\"Z\" &amp; i)) = \"\"\"\" Then\n            If Not (Range(\"Z\" &amp; i)) = valuestore Then\n                With Selection.Interior\n                .Pattern = xlUp\n                .PatternColorIndex = xlAutomatic\n                .Color = 49407\n                .TintAndShade = 0\n                .PatternTintAndShade = 0\n                End With\n            End If\n        End If\n    Else\n    End If\nNext i\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1534928316, "post_id": 51962460, "comment_id": 90876526, "body": "Could you please edit your question to include the code for <code>GoToClient</code> and <code>SaveClient</code> just in case they are causing the problem?"}, {"owner": {"reputation": 599, "user_id": 1584623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1413dd74054bdbbdd541fa5a0b694f15?s=128&d=identicon&r=PG", "display_name": "subdeveloper", "link": "https://stackoverflow.com/users/1584623/subdeveloper"}, "edited": false, "score": 0, "creation_date": 1534928498, "post_id": 51962460, "comment_id": 90876634, "body": "Also if possible, can you share the sample worksheet/data for this? BTW most probably its the check &quot;If Range(&quot;A&quot; &amp; d).Value &lt; ValueDate&quot; that is failing. A quick way to diagnose is put a separate values for M and N.. i.e. say <b>&#39;x&#39;</b> for M and <b>&#39;y&#39;</b> for N.So that you can double confirm the flow."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1534929565, "post_id": 51962460, "comment_id": 90877209, "body": "Without diving into your code to much there are a few things I would do differently. You could offcourse have your reasoning, but most likely you can avoid using <code>.select</code>. How?, see <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">here</a>. Furtermore I would either declare your different sheets in a variable or something different like index numbering of sheets, like so <code>Sheets(1).Cells(....</code>. You won&#39;t need to activate any sheet first either. Maybe something is lost in all of this making your value ending up in an unintended place."}], "owner": {"reputation": 11, "user_id": 10258556, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9H3CEA-MfnQ/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOKxJ-rxOpyiOKjxY0w4gcl7wJcng/mo/photo.jpg?sz=128", "display_name": "Daniel ", "link": "https://stackoverflow.com/users/10258556/daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1534925475, "creation_date": 1534925475, "question_id": 51962460, "link": "https://stackoverflow.com/questions/51962460/macro-filling-wrong-column-with-value", "title": "Macro filling wrong column with value?", "body": "<p>Morning guys,</p>\n\n<p>I have recently been tasked with being the person to update and monitor any VBA issues my currently company has, as the previous employee who was doing such has no left and there are no immediate plans to hire a replacement. Unfortunately my excel and VBA skills are rudimentary put politely, and youtube has only been able to help so much.</p>\n\n<p>There is a macro used in one of the spreadsheets which checks and overwrites certain month end figures. This part of the macro runs fine, and when completed for each client an X should be input to column M (Labelled done) to signify this is done. The column N (labelled skip) is already filled with an X for those that should be skipped due to individual client technicalities.</p>\n\n<p>The macro however appears to be filling in column N with the value x for when a client check is done. Have any of you ever encountered a similar issue with values being incorrectly assigned to the adjacent column?</p>\n\n<pre><code>Sub Values()\n\nApplication.ScreenUpdating = False\n\nDim EndRow As Integer\nDim i As Integer\nDim ValueDate As Date\nDim Cash As Double\nDim Value As Double\nDim APXRef As String\nDim d As Integer\nDim Overwrite As Boolean\n\n\n\nOverwrite = Worksheets(\"Summary\").Range(\"Y2\").Value ' from checkboxes\nEndRow = Range(\"J2\").End(xlDown).Row\nValueDate = Range(\"P6\").Value\n\nIf MsgBox(\"You are uploading with the following date: \" &amp; ValueDate &amp; \", do \nyou want to continue?\", vbYesNo) = vbNo Then Exit Sub\n\nFor i = 2 To EndRow\nAPXRef = Range(\"J\" &amp; i).Value\nValue = Range(\"L\" &amp; i).Value\n\nIf Range(\"M\" &amp; i) = \"\" And Range(\"N\" &amp; i) = \"\" Then\n\nWorksheets(\"Summary\").Activate\nr = Range(\"A:A\").Find(APXRef).Row\nRange(\"B\" &amp; r).Select\nCall GoToClient\nd = Range(\"A10\").End(xlDown).Row\n\nIf Range(\"A\" &amp; d).Value &lt; ValueDate Then\n\nRange(\"A\" &amp; d + 1).Value = ValueDate\nRange(\"B\" &amp; d + 1).Value = Value\nRange(\"D\" &amp; d + 1).FormulaR1C1 = \"=((RC[-2]/(R[-1]C[-2]+RC[-1]))-1)*100\"\nRange(\"E\" &amp; d + 1).FormulaR1C1 = \"=((((R[-1]C)*(RC[-1]))/100)+R[-1]C)\"\nRange(\"H\" &amp; d + 1).Value = Range(\"H\" &amp; d).Value\n\n\n'Save client\nIf Overwrite = True Then\nCall SaveClient\nEnd If\n\n'Return to Flow Tab\nWorksheets(\"Flows\").Activate\nRange(\"M\" &amp; i).Value = \"x\"\n\n\nElse\n'skip\nWorksheets(\"Flows\").Activate\nRange(\"N\" &amp; i).Value = \"x\"\nEnd If\n\n\n\nEnd If\n\nApplication.StatusBar = TabRef &amp; \"    \" &amp; Round(((i - 1) / (EndRow - 1)) * \n100, 1) &amp; \"% Complete\"\n\nNext i\nApplication.StatusBar = \"Value Update Complete\"\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10258573, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bO_0cAkoGJ8/AAAAAAAAAAI/AAAAAAAAATo/lS_iUYpKpzY/photo.jpg?sz=128", "display_name": "John Ainge", "link": "https://stackoverflow.com/users/10258573/john-ainge"}, "edited": false, "score": 0, "creation_date": 1534927196, "post_id": 51962753, "comment_id": 90875943, "body": "Appreciate this! Thank you so much :)"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "reply_to_user": {"reputation": 13, "user_id": 10258573, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bO_0cAkoGJ8/AAAAAAAAAAI/AAAAAAAAATo/lS_iUYpKpzY/photo.jpg?sz=128", "display_name": "John Ainge", "link": "https://stackoverflow.com/users/10258573/john-ainge"}, "edited": false, "score": 0, "creation_date": 1534930705, "post_id": 51962753, "comment_id": 90877871, "body": "Glad to help, @JohnAinge . Please, if this answer solved your problem, mark it as correct, so the question will be closed :)"}], "tags": [], "owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "is_accepted": true, "score": 0, "last_activity_date": 1535627157, "last_edit_date": 1535627157, "creation_date": 1534926647, "answer_id": 51962753, "question_id": 51962448, "link": "https://stackoverflow.com/questions/51962448/how-to-make-some-of-the-text-in-a-cell-bold/51962753#51962753", "title": "How to make some of the text in a cell bold?", "body": "<p>Welcome to SO. As you are new, please, check out the <a href=\"https://stackoverflow.com/tour\">tour</a>, and more good information at <a href=\"https://stackoverflow.com/help/on-topic\">\"help center\".</a></p>\n\n<p>About your question, try something like this:</p>\n\n<pre><code>Sub MAKE_IT_BOLD(ByVal ThisRange As Range)\n\nDim rng As Range\nDim Pos As Integer\n\nFor Each Rng In ThisRange\n    Pos = InStr(1, Rng.Value, \"-\", vbTextCompare) - 1\n    If Pos &gt; 0 Then Rng.Characters(1, Pos).Font.Bold = True\nNext Rng\n\nEnd Sub\n</code></pre>\n\n<p>This sub will check every cell in <code>ThisRange</code> and will find the position of the first <code>-</code> in string. If that position is found, then it will make bold all characters from 1 to the position of <code>-</code>.</p>\n\n<p>I hope you can adapt this code to your needs.</p>\n"}], "owner": {"reputation": 13, "user_id": 10258573, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bO_0cAkoGJ8/AAAAAAAAAAI/AAAAAAAAATo/lS_iUYpKpzY/photo.jpg?sz=128", "display_name": "John Ainge", "link": "https://stackoverflow.com/users/10258573/john-ainge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 51962753, "answer_count": 1, "score": 1, "last_activity_date": 1574520713, "creation_date": 1534925434, "last_edit_date": 1574520713, "question_id": 51962448, "link": "https://stackoverflow.com/questions/51962448/how-to-make-some-of-the-text-in-a-cell-bold", "title": "How to make some of the text in a cell bold?", "body": "<p>How do I make the words before \" - \" bold?</p>\n\n<p><a href=\"https://i.stack.imgur.com/mi91T.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mi91T.png\" alt=\"Image of spreadsheet\"></a></p>\n"}, {"tags": ["excel", "vba", "excel-formula", "ms-office"], "comments": [{"owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "edited": false, "score": 0, "creation_date": 1534923607, "post_id": 51961692, "comment_id": 90874090, "body": "What conditional formatting formula have you tried so far?"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1534923838, "post_id": 51961692, "comment_id": 90874195, "body": "Your question is not clear. Do you want to format all times between 12 - 13 as blue? Or do you want the format to relate to the NOW() time stamp? Please edit your question and provide a better example. Then post a comment to alert the followers of the question."}, {"owner": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "edited": false, "score": 0, "creation_date": 1534924261, "post_id": 51961692, "comment_id": 90874391, "body": "Also a similar question was already asked: <a href=\"https://superuser.com/questions/826773/conditional-formatting-if-one-time-is-greater-than-the-other\" title=\"conditional formatting if one time is greater than the other\">superuser.com/questions/826773/&hellip;</a>"}, {"owner": {"reputation": 3, "user_id": 10258285, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ypFlGo2ZiM8/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPE3CXEZtuYg-EVcb4tRzHkZF6hQQ/mo/photo.jpg?sz=128", "display_name": "Rookie", "link": "https://stackoverflow.com/users/10258285/rookie"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1534925644, "post_id": 51961692, "comment_id": 90875118, "body": "@teylyn format should relate to NOW()"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 1, "creation_date": 1534926140, "post_id": 51961692, "comment_id": 90875389, "body": "Please edit your question and add clarification there. If you can&#39;t follow these simple instructions, then you won&#39;t get much out of this site. Use your reading skills, take the <a href=\"https://stackoverflow.com/tour\">tour</a> and follow the advice you see in comments."}, {"owner": {"reputation": 3, "user_id": 10258285, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ypFlGo2ZiM8/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPE3CXEZtuYg-EVcb4tRzHkZF6hQQ/mo/photo.jpg?sz=128", "display_name": "Rookie", "link": "https://stackoverflow.com/users/10258285/rookie"}, "reply_to_user": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "edited": false, "score": 0, "creation_date": 1534958960, "post_id": 51961692, "comment_id": 90894903, "body": "@Olly@Pierre44@teylyn Please find the edited question."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10258285, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ypFlGo2ZiM8/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPE3CXEZtuYg-EVcb4tRzHkZF6hQQ/mo/photo.jpg?sz=128", "display_name": "Rookie", "link": "https://stackoverflow.com/users/10258285/rookie"}, "edited": false, "score": 0, "creation_date": 1534924485, "post_id": 51962105, "comment_id": 90874514, "body": "almost like I wanted it to, can we add minutes too ? i.e. I wanted the cells to be dynamically update colors with time."}, {"owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "reply_to_user": {"reputation": 3, "user_id": 10258285, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ypFlGo2ZiM8/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPE3CXEZtuYg-EVcb4tRzHkZF6hQQ/mo/photo.jpg?sz=128", "display_name": "Rookie", "link": "https://stackoverflow.com/users/10258285/rookie"}, "edited": false, "score": 0, "creation_date": 1534924609, "post_id": 51962105, "comment_id": 90874576, "body": "You need to <a href=\"https://stackoverflow.com/posts/51962105/edit\">edit</a> your original question to make your requirement much clearer, with examples of your exact input / expected output, what you have already tried, and the problem you are having."}, {"owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "reply_to_user": {"reputation": 3, "user_id": 10258285, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ypFlGo2ZiM8/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPE3CXEZtuYg-EVcb4tRzHkZF6hQQ/mo/photo.jpg?sz=128", "display_name": "Rookie", "link": "https://stackoverflow.com/users/10258285/rookie"}, "edited": false, "score": 0, "creation_date": 1534959873, "post_id": 51962105, "comment_id": 90895318, "body": "As has the answer"}, {"owner": {"reputation": 3, "user_id": 10258285, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ypFlGo2ZiM8/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPE3CXEZtuYg-EVcb4tRzHkZF6hQQ/mo/photo.jpg?sz=128", "display_name": "Rookie", "link": "https://stackoverflow.com/users/10258285/rookie"}, "edited": false, "score": 0, "creation_date": 1534961261, "post_id": 51962105, "comment_id": 90895951, "body": "the formatting is taking different colors when selecting F:H full column range, like the first formula selects all cells except specified cells, second formula fills orange to first row and green is absent even after applying third formula."}, {"owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "reply_to_user": {"reputation": 3, "user_id": 10258285, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ypFlGo2ZiM8/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPE3CXEZtuYg-EVcb4tRzHkZF6hQQ/mo/photo.jpg?sz=128", "display_name": "Rookie", "link": "https://stackoverflow.com/users/10258285/rookie"}, "edited": false, "score": 0, "creation_date": 1534963123, "post_id": 51962105, "comment_id": 90896767, "body": "Think carefully about the formula you use, and the cell references in the formula. The formulas in my answer work for the data range in your question (F3:H3) - if you&#39;re changing the range that the formatting applies to, then you&#39;ll need to change the formulas accordingly."}, {"owner": {"reputation": 3, "user_id": 10258285, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ypFlGo2ZiM8/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPE3CXEZtuYg-EVcb4tRzHkZF6hQQ/mo/photo.jpg?sz=128", "display_name": "Rookie", "link": "https://stackoverflow.com/users/10258285/rookie"}, "edited": false, "score": 0, "creation_date": 1535048609, "post_id": 51962105, "comment_id": 90933737, "body": "Thanks, this was exactly what I was looking for, got the correct formatting after applying formulas in the right way."}], "tags": [], "owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "is_accepted": true, "score": 1, "last_activity_date": 1534963192, "last_edit_date": 1592644375, "creation_date": 1534924092, "answer_id": 51962105, "question_id": 51961692, "link": "https://stackoverflow.com/questions/51961692/how-to-do-conditional-formatting-with-time-in-excel/51962105#51962105", "title": "How to do conditional formatting with time in excel?", "body": "<h2>Answer edited, as question clarified:</h2>\n<p>You could try the following conditional formatting formulae:</p>\n<p>Yellow:</p>\n<pre><code>=AND($F3&lt;NOW()-TODAY(),$H3&lt;NOW()-TODAY())\n</code></pre>\n<p>Orange:</p>\n<pre><code>=AND($F3&lt;NOW()-TODAY(),$H3&gt;NOW()-TODAY())\n</code></pre>\n<p>Green:</p>\n<pre><code>=AND($F3&gt;NOW()-TODAY(),$H3&gt;NOW()-TODAY())\n</code></pre>\n<p>Apply each formula to range F3:H6, and format to suit.</p>\n<p><a href=\"https://i.stack.imgur.com/SxWA3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SxWA3.png\" alt=\"enter image description here\" /></a></p>\n"}], "owner": {"reputation": 3, "user_id": 10258285, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ypFlGo2ZiM8/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPE3CXEZtuYg-EVcb4tRzHkZF6hQQ/mo/photo.jpg?sz=128", "display_name": "Rookie", "link": "https://stackoverflow.com/users/10258285/rookie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 999, "favorite_count": 0, "accepted_answer_id": 51962105, "answer_count": 1, "score": -3, "last_activity_date": 1594152423, "creation_date": 1534922527, "last_edit_date": 1594152423, "question_id": 51961692, "link": "https://stackoverflow.com/questions/51961692/how-to-do-conditional-formatting-with-time-in-excel", "title": "How to do conditional formatting with time in excel?", "body": "<p>I am trying to do conditional formatting with time, in one column I have present time i.e. using <code>=NOW()</code>, in other columns I have a set of time between 0-24 Hrs. All the columns have time in <code>HH:MM::SS</code> format. </p>\n\n<p>When I use conditional formatting on the set of time values such that if present time is between start time and end time, the cells should turn to orange color, if start time and end time was before present time then the cell should be in yellow color, if start time and end time is later than present time the cell should be in green color. Applying conditional formatting works only once but I want the sheet to be dynamic i.e. the cells should change their colors according to real time values.</p>\n\n<p>Please find the following example image</p>\n\n<p><img src=\"https://i.stack.imgur.com/eYWGG.jpg\" alt=\"Excel columns\"></p>\n"}, {"tags": ["vba", "image", "excel", "shape"], "comments": [{"owner": {"reputation": 1063, "user_id": 8019379, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ZcQhe.png?s=128&g=1", "display_name": "Lucas Raphael Pianegonda", "link": "https://stackoverflow.com/users/8019379/lucas-raphael-pianegonda"}, "edited": false, "score": 0, "creation_date": 1534924380, "post_id": 51961623, "comment_id": 90874458, "body": "So what your trying to do is insert a picture with locked aspect ratio, right?"}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "reply_to_user": {"reputation": 1063, "user_id": 8019379, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ZcQhe.png?s=128&g=1", "display_name": "Lucas Raphael Pianegonda", "link": "https://stackoverflow.com/users/8019379/lucas-raphael-pianegonda"}, "edited": false, "score": 0, "creation_date": 1534924514, "post_id": 51961623, "comment_id": 90874528, "body": "@Lucas Raphael Pianegonda, Yes, right you are."}], "answers": [{"comments": [{"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1534926562, "post_id": 51962705, "comment_id": 90875596, "body": "Will surely get back to you with any feedback. Thanks a lot @FunThomas."}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1534927940, "post_id": 51962705, "comment_id": 90876324, "body": "If I download the picture, how can I insert them right next to the concerning cell. Your second suggestion works for other links. The pictures are no longer fatty. However, they do not fit to the cell either (very small in size now). Provided plus one. Thanks."}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "reply_to_user": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1534928802, "post_id": 51962705, "comment_id": 90876807, "body": "When you have downloaded a pic, just use <code>Pictures.Insert</code>, but instead of the url, give the file name of your stored image file as parameter"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "reply_to_user": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 1, "creation_date": 1534929026, "post_id": 51962705, "comment_id": 90876938, "body": "For the image size: You have to make up your mind how you want to display the image. I see three possibilities: <b>(1)</b> Resize image so that it fits into cell <b>(2)</b> Resize Cell <b>(3)</b> Dont resize image or keep a minimum size, but live with the fact that the images may overlap."}], "tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": true, "score": 1, "last_activity_date": 1534926442, "creation_date": 1534926442, "answer_id": 51962705, "question_id": 51961623, "link": "https://stackoverflow.com/questions/51961623/cant-insert-picture-in-a-spreadsheet-using-a-link/51962705#51962705", "title": "Can&#39;t insert picture in a spreadsheet using a link", "body": "<p><strong>(1)</strong> It seems that it is not possible to copy an image from amazon server with <code>.picures.insert</code> - this is probably because of Amazon, not Excel. However, downloading it as ADODB.Stream works, so that may be a work around. I made a test with the code from <a href=\"https://stackoverflow.com/a/17877390/7599798\">This answer</a> and it worked.</p>\n\n<p><strong>(2)</strong> You explicitly set position and size of the image to an Excel cell and demands that the <em>AspectRatio</em> is not to be kept. If you set this to <code>True</code>, Excel automatically keeps the ratio between width and height - so changing the width will automatically also change the heigth (or vice versa).</p>\n\n<p>If you want to keep the original size of the image, remove the lines that sets width and hight of the image:</p>\n\n<pre><code>With ActiveSheet.Pictures.Insert(pics)\n   .ShapeRange.LockAspectRatio = msoTrue\n   .Top = Rows(cel.Row).Top\n   .Left = Columns(cel.Column).Left\nEnd With\n</code></pre>\n\n<p>If you want to resize the image so that it fits into the cell:</p>\n\n<pre><code>With ActiveSheet.Pictures.Insert(pics)\n    .ShapeRange.LockAspectRatio = msoTrue\n    .Top = Rows(cel.Row).Top\n    .Left = Columns(cel.Column).Left\n    If .Width / .Height &gt; cel.Width / cel.Height Then\n        .Width = cel.Width\n    Else\n        .Height = cel.Height\n    End If\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "accepted_answer_id": 51962705, "answer_count": 1, "score": 1, "last_activity_date": 1535100987, "creation_date": 1534922312, "last_edit_date": 1535100987, "question_id": 51961623, "link": "https://stackoverflow.com/questions/51961623/cant-insert-picture-in-a-spreadsheet-using-a-link", "title": "Can&#39;t insert picture in a spreadsheet using a link", "body": "<p>I've written a script in vba which uses <code>Url</code> in <code>column b</code> and insert the image in <code>column c</code> right next to the url. The script works when I use this <a href=\"http://www.india-forums.com//images/celebrity/m_2684.jpg\" rel=\"nofollow noreferrer\">image link</a> but it fails when I use this <a href=\"https://images-na.ssl-images-amazon.com/images/I/51c4wH-24hL._SL100_SS100_.jpg\" rel=\"nofollow noreferrer\">image link</a>. How can make my script do the trick even when I use the second link? </p>\n\n<p>This is my try so far:</p>\n\n<pre><code>Sub InsertImages()\n    Dim pics$, myPics As Shape, PicExists As Boolean, cel As Range\n\n    For Each cel In Range(\"C2\", Range(\"B2\").End(xlDown).Offset(0, 1))\n        PicExists = False\n        pics = cel.Offset(0, -1)\n\n        For Each myPics In ActiveSheet.Shapes\n            If myPics.TopLeftCell.Row = cel.Row Then PicExists = True: Exit For\n        Next myPics\n\n        If Not PicExists Then\n            With ActiveSheet.Pictures.Insert(pics)\n                .ShapeRange.LockAspectRatio = msoFalse\n                .Width = cel.Width\n                .Height = cel.Height\n                .Top = Rows(cel.Row).Top\n                .Left = Columns(cel.Column).Left\n            End With\n        End If\n    Next cel\nEnd Sub\n</code></pre>\n\n<p>Post script: Although my above script can insert picture making use of the first link, the image looks quite different from the source. <strong><em>To be clearer: the image becomes fatty.</em></strong></p>\n"}, {"tags": ["ms-access", "batch-file", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1534921348, "post_id": 51961248, "comment_id": 90872990, "body": "You mean by pressing a button on a form? Or?"}, {"owner": {"reputation": 25, "user_id": 10234429, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-04LGgTno7mw/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oViXq3frhTvWrTss7Zg8VvE3Fq9w/mo/photo.jpg?sz=128", "display_name": "Sushil Sharma", "link": "https://stackoverflow.com/users/10234429/sushil-sharma"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1534921538, "post_id": 51961248, "comment_id": 90873065, "body": "No not from a button on form. I want the macro to run automatically whilst the database is running from .bat file"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1534921655, "post_id": 51961248, "comment_id": 90873111, "body": "Then use a <code>Form_Timer</code>."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1534922649, "post_id": 51961248, "comment_id": 90873585, "body": "If you mean &quot;at certain intervals&quot;, use the <i>timer event</i> of a form, you keep open, to call the macro."}], "answers": [{"tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 1, "last_activity_date": 1534922646, "last_edit_date": 1534922646, "creation_date": 1534922261, "answer_id": 51961611, "question_id": 51961248, "link": "https://stackoverflow.com/questions/51961248/running-access-macro-whilst-open-using-batch-file/51961611#51961611", "title": "Running Access Macro whilst open using Batch file", "body": "<p>You can use the /x \"macroname\" command line indicator to run a macro (not a VBA sub or function, a macro):</p>\n\n<pre><code>echo off\nstart \"C:\\Program Files (x86)\\Microsoft Office\\Office\\MSACCESS.EXE\" \"S:\\DB NEW\\Report.accdb\" /x MyMacroName\n</code></pre>\n\n<p>Read more: <a href=\"https://support.office.com/en-us/article/command-line-switches-for-microsoft-office-products-079164cd-4ef5-4178-b235-441737deb3a6#ID0EAABAAA=Access\" rel=\"nofollow noreferrer\">Command-line switches for office</a>.</p>\n\n<p>Alternatively, you can read commands passed using the /cmd switch from VBA. You could use an auto-starting form that reads a command and executes a VBA function on load, or a predeclared class that reads and executes the command on initialize.</p>\n\n<p>For more advanced functionality, I recommend switching to either PowerShell or VBScript. That way you can hook into running Access Application objects and get them to execute code.</p>\n"}], "owner": {"reputation": 25, "user_id": 10234429, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-04LGgTno7mw/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oViXq3frhTvWrTss7Zg8VvE3Fq9w/mo/photo.jpg?sz=128", "display_name": "Sushil Sharma", "link": "https://stackoverflow.com/users/10234429/sushil-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4406, "favorite_count": 0, "accepted_answer_id": 51961611, "answer_count": 1, "score": 1, "last_activity_date": 1594630706, "creation_date": 1534920865, "last_edit_date": 1594630706, "question_id": 51961248, "link": "https://stackoverflow.com/questions/51961248/running-access-macro-whilst-open-using-batch-file", "title": "Running Access Macro whilst open using Batch file", "body": "<p>I have a batch file which contains a path to the access database. When clicked it opens up the desired database however I want the batch file to run the macro.</p>\n\n<p>I can do this by creating a AutoExec macro to run when you open up the database but I also want the macro to run whilst the database is running.</p>\n\n<p>Here is what I have on my batch file at the moment:</p>\n\n<pre><code>echo off\nstart \"C:\\Program Files (x86)\\Microsoft Office\\Office\\MSACCESS.EXE\" \"S:\\DB NEW\\Report.accdb\"\n</code></pre>\n\n<p>How do I do this?</p>\n"}, {"tags": ["excel", "vba", "text", "split", "export-to-excel"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1534921870, "post_id": 51960686, "comment_id": 90873212, "body": "<i>Welcome to <a href=\"https://stackoverflow.com\">Stack Overflow</a>!</i>  Before your next question (or if my answer below doesn&#39;t solve your issue) please check out the <a href=\"https://stackoverflow.com/tour\">tour</a> (you&#39;ll earn your first badge!) as well as &#39;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&#39; and <b>how to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a></b>.  Also <a href=\"https://codeblog.jonskeet.uk/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">here</a> is a handy checklist from the site&#39;s top user."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1534930785, "post_id": 51960686, "comment_id": 90877913, "body": "The question could have included more information (see links above).. but <b>+1 anyway</b> for generating some conversation and multiple answers with varying methods to solve an issue like this. This is my favourite part of <a href=\"https://stackoverflow.com\">Stack Overflow</a> since I learn from others, while I&#39;m helping.  :-)"}], "answers": [{"comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1534922002, "post_id": 51961328, "comment_id": 90873278, "body": "honestly for something like this, with only 3 million lines of code (3 worksheets), if it&#39;s not something that needs to be done frequently and automatically, I&#39;d probably just open the text file in Excel manually (or paste in the data) and do the 6 click manually to move part of the set to different sheets.... but it&#39;s good coding practice.  :-)"}, {"owner": {"reputation": 873, "user_id": 5103224, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d7d1ca72bbff93c0a014b5b770482a53?s=128&d=identicon&r=PG&f=1", "display_name": "Lowpar", "link": "https://stackoverflow.com/users/5103224/lowpar"}, "edited": false, "score": 0, "creation_date": 1534923843, "post_id": 51961328, "comment_id": 90874197, "body": "apologise for my ignorance, but I thought that the maximum load for Excel was ~1,400,000 rows? As a result, you could not load 3m rows. I have a .bat workaround that splits the txt file, that works quite efficiently."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 873, "user_id": 5103224, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d7d1ca72bbff93c0a014b5b770482a53?s=128&d=identicon&r=PG&f=1", "display_name": "Lowpar", "link": "https://stackoverflow.com/users/5103224/lowpar"}, "edited": false, "score": 1, "creation_date": 1534928886, "post_id": 51961328, "comment_id": 90876850, "body": "@Lowpar - ah you&#39;re correct, I hadn&#39;t considered the <a href=\"https://support.office.com/article/excel-specifications-and-limits-1672b34d-7043-467e-8e27-269d656771c3\" rel=\"nofollow noreferrer\">maximum</a> of 1,048,576 rows in Excel 2016; in that case if I was doing it manually I would paste into Notepad++ and go from there -- but only if it was an occasionally required task.  Nothing wrong with coding and as I said, a simple procedure like this is an excellent way to begin learning the basics of VBA...."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 873, "user_id": 5103224, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d7d1ca72bbff93c0a014b5b770482a53?s=128&d=identicon&r=PG&f=1", "display_name": "Lowpar", "link": "https://stackoverflow.com/users/5103224/lowpar"}, "edited": false, "score": 0, "creation_date": 1534929016, "post_id": 51961328, "comment_id": 90876929, "body": "Also I&#39;m confused, @Lowpar, are you the same person that asked the question, or do you both happen to be splitting 3million-row text files?"}, {"owner": {"reputation": 873, "user_id": 5103224, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d7d1ca72bbff93c0a014b5b770482a53?s=128&d=identicon&r=PG&f=1", "display_name": "Lowpar", "link": "https://stackoverflow.com/users/5103224/lowpar"}, "edited": false, "score": 0, "creation_date": 1534929313, "post_id": 51961328, "comment_id": 90877099, "body": "ashleedawg, I did not ask the question. I just have experience of doing this in Excel, or at least finding solutions that circumvent the file not loaded completely in Excel."}, {"owner": {"reputation": 13, "user_id": 10258040, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u9Yqq.jpg?s=128&g=1", "display_name": "Cepreu", "link": "https://stackoverflow.com/users/10258040/cepreu"}, "edited": false, "score": 0, "creation_date": 1534945076, "post_id": 51961328, "comment_id": 90886556, "body": "@ashleedawg,Thank u. I could not attach txt, because it contains personal data. The code works, thanks pointed out my mistakes, I&#39;m just starting to learn VBA so as the automation of great help in the work."}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 2, "last_activity_date": 1534921711, "last_edit_date": 1592644375, "creation_date": 1534921165, "answer_id": 51961328, "question_id": 51960686, "link": "https://stackoverflow.com/questions/51960686/3-million-lines-of-port-data-in-excel-from-txt/51961328#51961328", "title": "3 million lines of port data in Excel from txt", "body": "<p>Perhaps something like this would be better.  I couldn't test it since you didn't include same data and I don't know what <code>port data</code> is, but it should work.</p>\n<p>If there's a problem with it (or anytime you have a code problem) try using <kbd>F8</kbd> to <strong>step through the code</strong> to find out exactly what's happening on each line.  (More on that from Chip Pearson <a href=\"http://www.cpearson.com/excel/DebuggingVBA.aspx\" rel=\"nofollow noreferrer\">here</a>.)</p>\n<pre><code>Option Explicit\n\nSub ReadFile()\n    Const fName = &quot;\\\\bla.bla.bla\\Desktop\\vsr.txt&quot;\n    Dim rowNum As Long, shtNum As Long, myString As String\n    \n    Open fName For Input As #1\n    shtNum = 1\n    Do While Not EOF(1)\n        rowNum = rowNum + 1\n        Line Input #1, myString\n        Sheets(&quot;LIST&quot; &amp; shtNum).Cells(rowNum, 1) = myString\n        If rowNum = 1000000 Then\n            shtNum = shtNum + 1\n            rowNum = 0\n        End If\n    Loop\n    Close #1\nEnd Sub\n</code></pre>\n<h2>Some notes:</h2>\n<ul>\n<li>Use <code>'Option Explicit</code> at the top of [every] module [always] to help locate variables that are not properly declared or handled. (ie., <code>MyString</code> was undeclared)</li>\n<li>Personally, I try to avoid using common words like <code>File</code> for variables as it may or may not be a &quot;reserved word&quot; (ie., a constant or function name built-in to Excel)</li>\n<li>Personally, I usually make the first letter of my variable <em>lowercase</em>, to help differentiate my variables from built-in keywords, at a glance.</li>\n<li>Avoid using meaningless variables like <code>I</code> and <code>J</code> (especially when posting code for help from others).  A couple extra characters make the code a lot easier to understand and to modify/debug later.</li>\n<li>When declaring a variable, specify a data type whenever possible.</li>\n<li>You didn't mention anything about creating worksheets, and your code doesn't attempt it, so this code assumes all the required output worksheets <em>exist</em> and are <em>blank</em>.</li>\n<li>An alternative to using <code>shtNum</code> (or <code>J</code> in your example) would be to use <code>Int(rowNum/1000000)+1</code> to get the sheet number.  This formula returns <code>1</code> for 0 to 999999, <code>2</code> for 1000000 to 1999999, etc.</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1534930246, "post_id": 51962371, "comment_id": 90877621, "body": "Good thinking +1 ...and further to your point, it <i>might</i> be even more efficient to read the entire file at once, for example with <code>Set objFSO = CreateObject(&quot;Scripting.FileSystemObject&quot;) : Set objTF = objFSO.OpenTextFile(fName, 1) : strIn = objTF.ReadAll</code> ...etc, and then using <code>Split</code> to get each of the 3 sets of data. I tested with a 3.5m line JSON file and it took a really long time for all of these methods (however my lines are &quot;full&quot;)... If time/performance is an issue @cepreu, it might be best to stick with the batch file that you were using... just call it from VBA with <code>Shell</code>."}, {"owner": {"reputation": 13, "user_id": 10258040, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u9Yqq.jpg?s=128&g=1", "display_name": "Cepreu", "link": "https://stackoverflow.com/users/10258040/cepreu"}, "edited": false, "score": 0, "creation_date": 1534948378, "post_id": 51962371, "comment_id": 90888793, "body": "@L8n, Thanks for ur help too, I use ur code and the data is inserted only 16960 cells, and up to 1000000 all cells come with the value # N / D, And this is repeated on each sheet"}, {"owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "reply_to_user": {"reputation": 13, "user_id": 10258040, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u9Yqq.jpg?s=128&g=1", "display_name": "Cepreu", "link": "https://stackoverflow.com/users/10258040/cepreu"}, "edited": false, "score": 0, "creation_date": 1534949505, "post_id": 51962371, "comment_id": 90889584, "body": "@Cepreu I assume the <code>transpose</code> function is the culprit here, I&#39;ll update as soon as I know more"}], "tags": [], "owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "is_accepted": true, "score": 1, "last_activity_date": 1534957270, "last_edit_date": 1534957270, "creation_date": 1534925101, "answer_id": 51962371, "question_id": 51960686, "link": "https://stackoverflow.com/questions/51960686/3-million-lines-of-port-data-in-excel-from-txt/51962371#51962371", "title": "3 million lines of port data in Excel from txt", "body": "<p>@ashleedawg already wrote most of the important stuff, hover ever I would make another correction to the code.</p>\n\n<p>The way you handle the data now means you look up line in the vsr.txt file, then copy it to a string and finally write it into a cell. This takes up a lot of processing power and will be quite slow (especially the part where you access the cells. It would be way more efficient to copy all the text into a array and then paste it all at once.  </p>\n\n<p>The <code>WorksheetFunction.Transpose()</code> is necessary since arrays in excel use Columns as the first dimensions.<br>\nInserting the Code every 10'000 Lines prevents the Transpose function from running into Issues. I assume since it is part of the WorksheetFunction Code it may relay on some older code or even be specifically made this way to run lagacy code (lenght of the return value must be array of lenght Integer or something).<br>\nUsing <code>myWb</code> is there to make the Range modifiers fully qualified, not really necessary but can save you a lot of trouble down the line.<br>\nWith GROUPSIZE you can adjust the size of the Array-Block you want to import at once, a bigger number may give you faster processing speeds. </p>\n\n<pre><code>Option Explicit\n\nSub ReadFile()\n\n    Const GROUPSIZE As Long = 10000 'ENTRIESPERPAGE must be divisible by this without rest to fit exactly \n    Const ENTRIESPERPAGE As Long = 1000000 \n    Const fName As String = \"\\\\bla.bla.bla\\Desktop\\vsr.txt\"\n\n    Dim rowNum As Long\n    Dim rowOffset As Long\n    Dim shtNum As Long\n    Dim myString(1 To GROUPSIZE) As String\n    Dim myWB As Workbook\n    Dim Range2Fill As String\n\n    Set myWB = ThisWorkbook\n\n    Open fName For Input As #1\n    shtNum = 1\n    rowNum = 0\n    rowOffset = 0\n    Do While Not EOF(1)\n        rowNum = rowNum + 1\n        Line Input #1, myString(rowNum)\n\n        If rowNum = GROUPSIZE Then\n            Range2Fill = \"A\" &amp; rowOffset + 1 &amp; \":A\" &amp; rowOffset + rowNum\n            myWB.Worksheets(shtNum).Range(Range2Fill) = WorksheetFunction.Transpose(myString)\n            Debug.Print \"Sheet: \" &amp; shtNum, \"Offset: \" &amp; rowOffset\n\n            If rowOffset &gt;= ENTRIESPERPAGE - rowNum Then\n                rowOffset = 0\n                shtNum = shtNum + 1\n            Else\n                rowOffset = rowOffset + GROUPSIZE\n            End If\n\n            rowNum = 0\n        End If\n    Loop\n\n    'writes the last set of data in case there are not an exact multiple of 1M values\n    Range2Fill = \"A\" &amp; rowOffset + 1 &amp; \":A\" &amp; rowOffset + rowNum\n    myWB.Worksheets(shtNum).Range(Range2Fill) = WorksheetFunction.Transpose(myString)\n    Close #1\n\nEnd Sub\n</code></pre>\n\n<p>Additional notes:</p>\n\n<ul>\n<li>Excel supports up to 1,048,576 Rows per worksheet, but expect performance to drop drastically on so many datapoints, especially if you start calculating them or using them in graphs.</li>\n<li>There are better options for working on huge datasets like this, Origin, MatLab, and DIAdem are a few that I know of and have used so far, a free phyton based alternative would be Spyder.</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1534930553, "post_id": 51963474, "comment_id": 90877801, "body": "nice PS; I&#39;ll steal that for my own purposes, but the OP said they are <a href=\"https://stackoverflow.com/questions/51960686/3-million-lines-of-port-data-in-excel-from-txt/51961328?noredirect=1#comment90874197_51961328\">already using a batch file</a> to split into multiple files; I think the goal here is to get the split data <b>into Excel</b> (using VBA)."}], "tags": [], "owner": {"reputation": 873, "user_id": 5103224, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d7d1ca72bbff93c0a014b5b770482a53?s=128&d=identicon&r=PG&f=1", "display_name": "Lowpar", "link": "https://stackoverflow.com/users/5103224/lowpar"}, "is_accepted": false, "score": -1, "last_activity_date": 1534929587, "last_edit_date": 1534929587, "creation_date": 1534929221, "answer_id": 51963474, "question_id": 51960686, "link": "https://stackoverflow.com/questions/51960686/3-million-lines-of-port-data-in-excel-from-txt/51963474#51963474", "title": "3 million lines of port data in Excel from txt", "body": "<p>Here is an alternative solution - save this code as a bat file and it will split your file in the amount of mbs you select, this will enable you to modify the data in Excel and create 3 * 1m worksheets:</p>\n\n<p>@REM Using <a href=\"https://stackoverflow.com/questions/19335004/how-to-run-a-powershell-script-from-a-batch-file\">How to run a PowerShell script from a batch file</a>\n@REM and <a href=\"https://stackoverflow.com/questions/1001776/how-can-i-split-a-text-file-using-powershell\">How can I split a text file using PowerShell?</a></p>\n\n<pre><code>@PowerShell  ^\n\n$upperBound =  100MB;  ^\n$rootName = 'ENTER YOUR FILE PATH HERE. csv file';  ^\n$from = $rootName;  ^\n$fromFile = [io.file]::OpenRead($from);  ^\n$buff = new-object byte[] $upperBound;  ^\n$count = $idx = 0;  ^\ntry {  ^\n    do {  ^\n        'Reading ' + $upperBound;  ^\n        $count = $fromFile.Read($buff, 0, $buff.Length);  ^\n        if ($count -gt 0) {  ^\n            $to = '{0}.{1}' -f ($rootName, $idx);  ^\n            $toFile = [io.file]::OpenWrite($to);  ^\n            try {  ^\n                'Writing ' + $count + ' to ' + $to;  ^\n                $tofile.Write($buff, 0, $count);  ^\n            } finally {  ^\n                $tofile.Close();  ^\n            }  ^\n        }  ^\n        $idx ++;  ^\n    } while ($count -gt 0);  ^\n}  ^\nfinally {  ^\n    $fromFile.Close();  ^\n}  ^\n%End PowerShell%\n</code></pre>\n\n<p>Note the code will split the data within cells, thus you will need to fix the first and last row of each of the files that are produced. I understand this not a VBA workaround, but it will work... Modify the upperbound to change the file size, i.e.,  50mb, etc.</p>\n"}], "owner": {"reputation": 13, "user_id": 10258040, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u9Yqq.jpg?s=128&g=1", "display_name": "Cepreu", "link": "https://stackoverflow.com/users/10258040/cepreu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 332, "favorite_count": 0, "accepted_answer_id": 51962371, "answer_count": 3, "score": 1, "last_activity_date": 1594055195, "creation_date": 1534917975, "last_edit_date": 1594055195, "question_id": 51960686, "link": "https://stackoverflow.com/questions/51960686/3-million-lines-of-port-data-in-excel-from-txt", "title": "3 million lines of port data in Excel from txt", "body": "<p>I need from a text file with the 3 million lines of port data in Excel, every 1 million lines portation to start a new list. What's wrong with the code, tell me?</p>\n\n<pre><code>    Sub ReadFile()\n  Dim I, J\n  I = 1\n  J = 1\n  File = \"\\\\bla.bla.bla\\Desktop\\vsr.txt\"\n  Open File For Input As #1\n  Do While Not EOF(1)\n    Line Input #1, MyString\n    Sheets(\"LIST\" &amp; J).Cells(I, 1) = MyString\n    If I = 1000000 Then\n      I = 1\n      J = J + 1\n    Else\n      I = I + 1\n    End If\n  Loop\n  Close #1\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1534922150, "post_id": 51960618, "comment_id": 90873332, "body": "<i>Welcome to <a href=\"https://stackoverflow.com\">Stack Overflow</a>!</i>  Your question is a little unclear. Please check out the <a href=\"https://stackoverflow.com/tour\">tour</a> (you&#39;ll earn your first badge!) as well as &#39;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&#39; and <b>how to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a></b>.  Also <a href=\"https://codeblog.jonskeet.uk/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">here</a> is a handy checklist from the site&#39;s top user.  You can <a href=\"https://stackoverflow.com/posts/51960618/edit\">edit</a> your question to provide more information so that others can help you."}], "answers": [{"tags": [], "owner": {"reputation": 181, "user_id": 7398924, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uF3-0rZE7iE/AAAAAAAAAAI/AAAAAAAARNQ/mnS_OgRO0H0/photo.jpg?sz=128", "display_name": "Nirostar", "link": "https://stackoverflow.com/users/7398924/nirostar"}, "is_accepted": false, "score": 0, "last_activity_date": 1534936746, "creation_date": 1534936746, "answer_id": 51965698, "question_id": 51960618, "link": "https://stackoverflow.com/questions/51960618/reference-workbook-not-in-collection/51965698#51965698", "title": "Reference workbook not in collection", "body": "<p>welcome to Stackoverflow!</p>\n\n<p>Maybe you opened another instance of Excel. Try to close one of the workbooks and then open it again with the File/Open command from the other Workbook. Maybe this helps.</p>\n\n<p>Kind Regards\nNirostar</p>\n"}], "owner": {"reputation": 1, "user_id": 10163953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f2040b6b6883b57f0d1b94673175513?s=128&d=identicon&r=PG&f=1", "display_name": "Chenj", "link": "https://stackoverflow.com/users/10163953/chenj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594150987, "creation_date": 1534917532, "last_edit_date": 1594150987, "question_id": 51960618, "link": "https://stackoverflow.com/questions/51960618/reference-workbook-not-in-collection", "title": "Reference workbook not in collection", "body": "<p>So i have 2 windows/excel opened. my code is written in for example <code>workbook1</code> in reference to <code>workbook2</code>. However in the developer mode <code>workbook2</code> isnt showing up in the properties. </p>\n\n<p>Is there a way i could reference <code>workbook2</code>? I've tried the <code>workbooks(\"workbook2\").activate</code> but it wont recognize workbook is open because its not in the properties window of the opened workbooks. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 1, "creation_date": 1534919864, "post_id": 51960614, "comment_id": 90872322, "body": "sum of 3 and 3 is 9?"}, {"owner": {"reputation": 8310, "user_id": 5061000, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh4.googleusercontent.com/-NVdzP6tqqbw/AAAAAAAAAAI/AAAAAAAAACM/u8-ZLaPIX94/photo.jpg?sz=128", "display_name": "Takit Isy", "link": "https://stackoverflow.com/users/5061000/takit-isy"}, "edited": false, "score": 2, "creation_date": 1534920787, "post_id": 51960614, "comment_id": 90872725, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/11707888/sum-function-in-vba\">Sum function in VBA</a>"}, {"owner": {"reputation": 1, "user_id": 10250862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67585de3ad463d9ef5540a08e792527a?s=128&d=identicon&r=PG&f=1", "display_name": "HamburgerPatty", "link": "https://stackoverflow.com/users/10250862/hamburgerpatty"}, "edited": false, "score": 0, "creation_date": 1534928808, "post_id": 51960614, "comment_id": 90876812, "body": "Sorry, was a quick one, was meant to be sum of 3*3"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10250862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67585de3ad463d9ef5540a08e792527a?s=128&d=identicon&r=PG&f=1", "display_name": "HamburgerPatty", "link": "https://stackoverflow.com/users/10250862/hamburgerpatty"}, "edited": false, "score": 0, "creation_date": 1534928875, "post_id": 51960708, "comment_id": 90876844, "body": "Thank you for all the replies so far, what If i created my own function called CapFloor, could I call it in VBA using &quot;Application.worksheetFunction.Product&quot;"}, {"owner": {"reputation": 1, "user_id": 10250862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67585de3ad463d9ef5540a08e792527a?s=128&d=identicon&r=PG&f=1", "display_name": "HamburgerPatty", "link": "https://stackoverflow.com/users/10250862/hamburgerpatty"}, "edited": false, "score": 0, "creation_date": 1534928924, "post_id": 51960708, "comment_id": 90876869, "body": "The main question I asked was on this link: <a href=\"https://stackoverflow.com/questions/51951655/how-to-parse-cell-values-into-a-created-function-in-vba\" title=\"how to parse cell values into a created function in vba\">stackoverflow.com/questions/51951655/&hellip;</a> It will give you a more granular understanding of what I am trying to do."}, {"owner": {"reputation": 1, "user_id": 10250862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67585de3ad463d9ef5540a08e792527a?s=128&d=identicon&r=PG&f=1", "display_name": "HamburgerPatty", "link": "https://stackoverflow.com/users/10250862/hamburgerpatty"}, "edited": false, "score": 0, "creation_date": 1534930215, "post_id": 51960708, "comment_id": 90877594, "body": "I agree with what you are saying with the application.run, it says the first condition is called macro and I have no idea what they are referring to."}, {"owner": {"reputation": 1, "user_id": 10250862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67585de3ad463d9ef5540a08e792527a?s=128&d=identicon&r=PG&f=1", "display_name": "HamburgerPatty", "link": "https://stackoverflow.com/users/10250862/hamburgerpatty"}, "edited": false, "score": 0, "creation_date": 1534930328, "post_id": 51960708, "comment_id": 90877677, "body": "Having said this, the function was created by a dev team so when I open up excel I have a function called CapFloor which was created and I can call it manually by typing in a cell &quot;=CapFloor()&quot; , it requires 16 Inputs, if you go to this link....you will see what my main issue was, I was just not getting any traction with it so posted this one to get an idea of how to call in a function into vba etc. the link is <a href=\"https://stackoverflow.com/questions/51951655/how-to-parse-cell-values-into-a-created-function-in-vba\" title=\"how to parse cell values into a created function in vba\">stackoverflow.com/questions/51951655/&hellip;</a>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 1, "user_id": 10250862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67585de3ad463d9ef5540a08e792527a?s=128&d=identicon&r=PG&f=1", "display_name": "HamburgerPatty", "link": "https://stackoverflow.com/users/10250862/hamburgerpatty"}, "edited": false, "score": 0, "creation_date": 1534930975, "post_id": 51960708, "comment_id": 90878039, "body": "Hi, I am answering the question you have posed above rather than your other question. For the product of numbers (9 in this case) use the syntax as I have shown at the bottom. For the Application.Run scenario there must be a macro by the name referenced as the first argument present in your workbook. If your dev team developed a macro called Sum then you need to look to this. I would say 1) don&#39;t call it Sum that confuses things given it is an existing function 2) don&#39;t call it Sum when the operation is multiplication. This is misleading at best."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 1, "user_id": 10250862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67585de3ad463d9ef5540a08e792527a?s=128&d=identicon&r=PG&f=1", "display_name": "HamburgerPatty", "link": "https://stackoverflow.com/users/10250862/hamburgerpatty"}, "edited": false, "score": 0, "creation_date": 1534931275, "post_id": 51960708, "comment_id": 90878206, "body": "If they have a procedure/function called Sum that you need to include that in the above but to be honest, I would use syntax above unless there is something really important and different going on in their function/sub."}, {"owner": {"reputation": 1, "user_id": 10250862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67585de3ad463d9ef5540a08e792527a?s=128&d=identicon&r=PG&f=1", "display_name": "HamburgerPatty", "link": "https://stackoverflow.com/users/10250862/hamburgerpatty"}, "edited": false, "score": 0, "creation_date": 1534944300, "post_id": 51960708, "comment_id": 90886002, "body": "Thank you for the reply, I am trying to call in a .net function created by the dev team called CapFloor, I am using sum as an analogy as it works similarly in the sense of me having to type =CapFloor(x,x,x,x,x,x) in order to access it, the &#39;x&#39; are the inputs, the .net function requires 16 of them. I have 16 values in row7 across 16 columns, where i point each cell into the function where I am using this formula of temp=application.run(&quot;CapFloor&quot;,temp1,temp2,temp3,temp4.....&zwnj;&#8203;temp16) where the temp1=cell A7  temp2=cell B7 and so forth..when I run the macro using the formula above it gives"}, {"owner": {"reputation": 1, "user_id": 10250862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67585de3ad463d9ef5540a08e792527a?s=128&d=identicon&r=PG&f=1", "display_name": "HamburgerPatty", "link": "https://stackoverflow.com/users/10250862/hamburgerpatty"}, "edited": false, "score": 0, "creation_date": 1534944379, "post_id": 51960708, "comment_id": 90886059, "body": "an error, but when i run it manually by pasting in the formula and its paramter values, it works...I am wondering if my application.run (&quot;CapFloor&quot;,temp1,temp2) etc is wrong to use as when i hover over the temp1 and temp 2 etc, it is giving me the correct values, i am just thinking perhaps I am using the wrong syntax."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 2, "last_activity_date": 1534924751, "last_edit_date": 1534924751, "creation_date": 1534918081, "answer_id": 51960708, "question_id": 51960614, "link": "https://stackoverflow.com/questions/51960614/how-to-create-a-sum-function-in-vba/51960708#51960708", "title": "How to create a sum function in VBA", "body": "<p>Use </p>\n\n<pre><code>Application.WorksheetFunction.Sum(Range(\"A1\"),Range(\"A2\"))\n</code></pre>\n\n<p>Be aware that if you don't state the worksheet name in front then it will implicitly use the current <code>Activesheet</code> which may not always be what you want.</p>\n\n<p>You could use a <code>With</code> statement to give the parent sheet reference e.g.</p>\n\n<pre><code>With ThisWorkbook.Worksheets(\"Sheet1\")\n  temp = Application.WorksheetFunction.Sum(.Range(\"A1\"),.Range(\"A2\"))\nEnd With\n</code></pre>\n\n<p>As it seems you note in your prior question: 3+3 is 6.</p>\n\n<p>If you want multiplication then do:</p>\n\n<pre><code>temp = .Range(\"A1\") * .Range(\"A2\")\n</code></pre>\n\n<p>or,</p>\n\n<pre><code>temp = Application.WorksheetFunction.Product(.Range(\"A1\") ,.Range(\"A2\"))\n</code></pre>\n\n<hr>\n\n<p><a href=\"https://docs.microsoft.com/en-gb/office/vba/api/Excel.Application.Run\" rel=\"nofollow noreferrer\">Application.Run</a> is for running macros by their name and passing the required arguments. Unless you have a macro called <code>\"Sum\"</code>, I am surprised that line compiled. I also don't like macros being named after functions. It is confusing. Using the <code>WorksheetFunction</code> method as shown above is nice and clear.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 10250862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67585de3ad463d9ef5540a08e792527a?s=128&d=identicon&r=PG&f=1", "display_name": "HamburgerPatty", "link": "https://stackoverflow.com/users/10250862/hamburgerpatty"}, "edited": false, "score": 0, "creation_date": 1534928948, "post_id": 51960896, "comment_id": 90876888, "body": "Thank you s much for the reply, A more granular question i was asking is on this link: <a href=\"https://stackoverflow.com/questions/51951655/how-to-parse-cell-values-into-a-created-function-in-vba\" title=\"how to parse cell values into a created function in vba\">stackoverflow.com/questions/51951655/&hellip;</a>"}], "tags": [], "owner": {"reputation": 71, "user_id": 10013699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e57662b1d5719ca476b5c0e31dee499a?s=128&d=identicon&r=PG&f=1", "display_name": "Bhushan", "link": "https://stackoverflow.com/users/10013699/bhushan"}, "is_accepted": false, "score": 0, "last_activity_date": 1534920210, "last_edit_date": 1534920210, "creation_date": 1534919082, "answer_id": 51960896, "question_id": 51960614, "link": "https://stackoverflow.com/questions/51960614/how-to-create-a-sum-function-in-vba/51960896#51960896", "title": "How to create a sum function in VBA", "body": "<p>You can also try this.</p>\n\n<pre><code>Sub Sum_num()\n Dim temp As Integer\n temp = Range(\"A1\") + Range(\"A2\")\n MsgBox temp\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 10250862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67585de3ad463d9ef5540a08e792527a?s=128&d=identicon&r=PG&f=1", "display_name": "HamburgerPatty", "link": "https://stackoverflow.com/users/10250862/hamburgerpatty"}, "edited": false, "score": 0, "creation_date": 1534930015, "post_id": 51963541, "comment_id": 90877463, "body": "The test works, But not for the function I created, Please can you go to this link <a href=\"https://stackoverflow.com/questions/51951655/how-to-parse-cell-values-into-a-created-function-in-vba\" title=\"how to parse cell values into a created function in vba\">stackoverflow.com/questions/51951655/&hellip;</a> you will see what I mean as I created a function of my own, but wont work in the same manner as you described above."}], "tags": [], "owner": {"reputation": 208, "user_id": 10062262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41486435301afe7d1ac37b98a2fb4871?s=128&d=identicon&r=PG&f=1", "display_name": "Yuki", "link": "https://stackoverflow.com/users/10062262/yuki"}, "is_accepted": false, "score": 0, "last_activity_date": 1534929448, "creation_date": 1534929448, "answer_id": 51963541, "question_id": 51960614, "link": "https://stackoverflow.com/questions/51960614/how-to-create-a-sum-function-in-vba/51963541#51963541", "title": "How to create a sum function in VBA", "body": "<p>Base on my test, please try the VBA code as below:</p>\n\n<pre><code>Sub sum()\n    Dim myRange As Range\n    Dim tmp As Long\n    Set myRange = Worksheets(\"Sheet1\").Range(\"A1:A2\")\n    tmp = Application.WorksheetFunction.sum(myRange)\n    Worksheets(\"Sheet1\").Range(\"A3\") = tmp\nEnd Sub\n</code></pre>\n\n<p>For more information, please have a look: <a href=\"https://docs.microsoft.com/zh-cn/office/vba/api/Excel.WorksheetFunction.Sum\" rel=\"nofollow noreferrer\">WorksheetFunction.Sum Method</a></p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 10250862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67585de3ad463d9ef5540a08e792527a?s=128&d=identicon&r=PG&f=1", "display_name": "HamburgerPatty", "link": "https://stackoverflow.com/users/10250862/hamburgerpatty"}, "edited": false, "score": 0, "creation_date": 1534930367, "post_id": 51963709, "comment_id": 90877701, "body": "Please can you click on this link to see exactly what I am getting at: <a href=\"https://stackoverflow.com/questions/51951655/how-to-parse-cell-values-into-a-created-function-in-vba\" title=\"how to parse cell values into a created function in vba\">stackoverflow.com/questions/51951655/&hellip;</a>"}], "tags": [], "owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "is_accepted": false, "score": 0, "last_activity_date": 1534930022, "creation_date": 1534930022, "answer_id": 51963709, "question_id": 51960614, "link": "https://stackoverflow.com/questions/51960614/how-to-create-a-sum-function-in-vba/51963709#51963709", "title": "How to create a sum function in VBA", "body": "<blockquote>\n  <p>Sorry, was a quick one, was meant to be sum of 3*3</p>\n</blockquote>\n\n<p>So you don't want the sum, but the product of the cells. </p>\n\n<p>Use the <code>WorksheetFunction.Product(Range, Range2,.....)</code> instead of sum, the function allows for multiple ranges as parameters. </p>\n"}], "owner": {"reputation": 1, "user_id": 10250862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67585de3ad463d9ef5540a08e792527a?s=128&d=identicon&r=PG&f=1", "display_name": "HamburgerPatty", "link": "https://stackoverflow.com/users/10250862/hamburgerpatty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 672, "favorite_count": 0, "accepted_answer_id": 51960708, "answer_count": 4, "score": 0, "last_activity_date": 1574277150, "creation_date": 1534917499, "last_edit_date": 1574277150, "question_id": 51960614, "link": "https://stackoverflow.com/questions/51960614/how-to-create-a-sum-function-in-vba", "title": "How to create a sum function in VBA", "body": "<p>How can one use a sum function in VBA, i am trying the below piece but does not seem to work.</p>\n\n<pre><code>temp=Application.run(\"Sum\",range(\"A1\").value,range(\"A2\").value)\nRange(\"A1\").value=temp\n</code></pre>\n\n<p>i.e\nIf A1=3 and A2=3\nI want the end value to be 9.</p>\n"}]