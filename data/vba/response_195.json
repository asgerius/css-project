[{"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1538611574, "post_id": 52637099, "comment_id": 92207452, "body": "You&#39;re invoking <code>Dir</code> inside the loop, for one specific file name; the <code>tmp = Dir</code> will repeat for that specific file, and return an empty string, which is your exit condition - the code loops correctly, exactly as written. If you mean to delete <code>*.txt</code> files, then <code>tmp</code> has the file you want to delete - remove the <code>If Len(Dir(...))</code> condition."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1538611653, "post_id": 52637099, "comment_id": 92207462, "body": "See <a href=\"https://stackoverflow.com/questions/10380312/loop-through-files-in-a-folder-using-vba\">Loop through files in a folder using VBA?</a>."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1538611674, "post_id": 52637099, "comment_id": 92207471, "body": "Why are you killing one specific file instead of <code>tmp</code>, and expecting it to <code>Kill</code> all .txt files in the folder?"}], "answers": [{"comments": [{"owner": {"reputation": 534, "user_id": 2398630, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/423e9611f4212cb6f66cd30c9da6410f?s=128&d=identicon&r=PG", "display_name": "Siyon DP", "link": "https://stackoverflow.com/users/2398630/siyon-dp"}, "reply_to_user": {"reputation": 5, "user_id": 10453859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c808da240fcfa4129219fc35a6ba00c?s=128&d=identicon&r=PG&f=1", "display_name": "Calhoun", "link": "https://stackoverflow.com/users/10453859/calhoun"}, "edited": false, "score": 0, "creation_date": 1538900862, "post_id": 52643655, "comment_id": 92300750, "body": "Please mark my answare as correct, just press the green v in the left of the answare, so as everyone will see your question is answared, thanks."}], "tags": [], "owner": {"reputation": 534, "user_id": 2398630, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/423e9611f4212cb6f66cd30c9da6410f?s=128&d=identicon&r=PG", "display_name": "Siyon DP", "link": "https://stackoverflow.com/users/2398630/siyon-dp"}, "is_accepted": true, "score": 0, "last_activity_date": 1538646300, "creation_date": 1538646300, "answer_id": 52643655, "question_id": 52637099, "link": "https://stackoverflow.com/questions/52637099/vba-code-to-re-name-a-text-file-execute-a-macro-then-repeat-for-all-files-in/52643655#52643655", "title": "VBA code to re-name a text file, execute a macro, then repeat (for all files in the folder)", "body": "<p>Your Adhok solution is  </p>\n\n<pre><code>Function process()\n'    \n    Dim tmp As String\n    tmp = Dir(\"C:\\Users\\Calhoun\\Documents\\REPORTING\\Correspondence\\*.txt\")\n    Do While tmp &gt; \"\"\non error resume next    \n        Kill \"C:\\Users\\Calhoun\\Documents\\REPORTING\\Correspondence\\STATIC_FILE_NAME.txt\"\nOn Error Goto 0    \n        Name \"C:\\Users\\Calhoun\\Documents\\REPORTING\\Correspondence\\\" &amp; tmp As \"C:\\Users\\Calhoun\\Documents\\REPORTING\\Correspondence\\STATIC_FILE_NAME.txt\"\n\n        DoCmd.RunMacro \"RunQueries\"\n\n        tmp = Dir\n   Loop\nEnd Function\n</code></pre>\n\n<p>Using <code>Dir</code> inside the loop breaks the <code>Dir</code> outside the loop as Mathieu Guindon mentiond in comment  </p>\n"}], "owner": {"reputation": 5, "user_id": 10453859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c808da240fcfa4129219fc35a6ba00c?s=128&d=identicon&r=PG&f=1", "display_name": "Calhoun", "link": "https://stackoverflow.com/users/10453859/calhoun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 1, "accepted_answer_id": 52643655, "answer_count": 1, "score": -1, "last_activity_date": 1594627923, "creation_date": 1538610566, "last_edit_date": 1594627923, "question_id": 52637099, "link": "https://stackoverflow.com/questions/52637099/vba-code-to-re-name-a-text-file-execute-a-macro-then-repeat-for-all-files-in", "title": "VBA code to re-name a text file, execute a macro, then repeat (for all files in the folder)", "body": "<p>I am very new to VBA, so please be patient. I need to to re-name .txt files in a folder to a file name that never changes (it is linked as a table in Access). Run a macro that scrapes data into another table, then repeat the process for all the files in the folder (loop). The code below renames the 1st file and runs the macro, but that is as far as I get. It does not loop correctly. Any help is greatly appreciated!</p>\n\n<pre><code>Function process()\n\nDim tmp As String\ntmp = Dir(\"C:\\Users\\Calhoun\\Documents\\REPORTING\\Correspondence\\*.txt\")\nDo While tmp &gt; \"\"\n    If Len(Dir(\"C:\\Users\\Calhoun\\Documents\\REPORTING\\Correspondence\\STATIC_FILE_NAME.txt\")) &lt;&gt; 0 Then\n        Kill \"C:\\Users\\Calhoun\\Documents\\REPORTING\\Correspondence\\STATIC_FILE_NAME.txt\"\n    End If\n    Name \"C:\\Users\\Calhoun\\Documents\\REPORTING\\Correspondence\\\" &amp; tmp As \"C:\\Users\\Calhoun\\Documents\\REPORTING\\Correspondence\\STATIC_FILE_NAME.txt\"\n\nDoCmd.RunMacro \"RunQueries\"\n\ntmp = Dir\nLoop\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1472, "user_id": 1726522, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0DUTN.gif?s=128&g=1", "display_name": "CMArg", "link": "https://stackoverflow.com/users/1726522/cmarg"}, "edited": false, "score": 0, "creation_date": 1538607517, "post_id": 52636747, "comment_id": 92206588, "body": "Thats it! I thought the previous <code>CodesSheet.Range</code> was enought. I&#39;ve been dealing with this silliness for hours, before posting here. Thanks a lot."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 1472, "user_id": 1726522, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0DUTN.gif?s=128&g=1", "display_name": "CMArg", "link": "https://stackoverflow.com/users/1726522/cmarg"}, "edited": false, "score": 0, "creation_date": 1538607553, "post_id": 52636747, "comment_id": 92206598, "body": "Simple enough fix, glad to help."}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 1, "last_activity_date": 1538607249, "creation_date": 1538607249, "answer_id": 52636747, "question_id": 52636679, "link": "https://stackoverflow.com/questions/52636679/error-when-running-form-code-from-different-sheet/52636747#52636747", "title": "Error when running form code from different sheet", "body": "<p><code>Cells</code> without a <code>Worksheet</code> reference means <code>ActiveSheet</code> is assumed.</p>\n\n<p>Use a <code>With...End With</code> block to fully qualify the <code>Worksheet</code> - note the periods.</p>\n\n<pre><code>With CodesSheet\n    For each rCell in .Range(.Cells(2, 12), .Cells(LastRowCodes, 12))\n        ....\n    Next rCell\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 1472, "user_id": 1726522, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0DUTN.gif?s=128&g=1", "display_name": "CMArg", "link": "https://stackoverflow.com/users/1726522/cmarg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23, "favorite_count": 0, "closed_date": 1593592856, "accepted_answer_id": 52636747, "answer_count": 1, "score": 0, "last_activity_date": 1593591871, "creation_date": 1538606737, "last_edit_date": 1593591871, "question_id": 52636679, "link": "https://stackoverflow.com/questions/52636679/error-when-running-form-code-from-different-sheet", "closed_reason": "Duplicate", "title": "Error when running form code from different sheet", "body": "<p>I have a Form with many Subs. Workbook has many sheets. When I start the Form when the active sheet is <code>CodesSheet</code>, using any of the <code>For Each rCell</code> in the code below work OK. When I start the code from a different sheet, code runs OK when using the second line -<code>.Range(\"L2:L4125\")</code>-, but fails with the first one -<code>.Range(Cells(2, 12), Cells(LastRowCodes, 12))</code>.</p>\n\n<p>Message is <code>Run time error 1004 - Method Range of object _worksheet failed</code>. But on debug, mouse over <code>LastRowCodes</code> shows the proper value (4125).</p>\n\n<p>Anyone can spot the error?</p>\n\n<pre><code>For Each rCell In CodesSheet.Range(Cells(2, 12), Cells(LastRowCodes, 12)) '--&gt;Error here, although LastRowCodes is correct\n'For Each rCell In CodesSheet.Range(\"L2:L4125\") '--&gt; If using this instead of the above, no error\n\n    'Do Stuff\n\nNext rCell\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1538608380, "post_id": 52636672, "comment_id": 92206785, "body": "If you <code>Debug.Print attArray(0)</code> is the path correct?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1538609763, "post_id": 52636672, "comment_id": 92207109, "body": "It&#39;s <a href=\"https://docs.microsoft.com/en-us/office/vba/api/outlook.attachment.saveasfile\" rel=\"nofollow noreferrer\">SaveAsFile</a>, not <code>SaveAs</code>."}, {"owner": {"reputation": 13, "user_id": 5982704, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df96532273143f0e46bb839f1fa8438d?s=128&d=identicon&r=PG", "display_name": "tyler p", "link": "https://stackoverflow.com/users/5982704/tyler-p"}, "edited": false, "score": 0, "creation_date": 1538688395, "post_id": 52636672, "comment_id": 92242056, "body": "Thanks Comintern, I used the solution you and Evanzheng suggested and was successful with a few other tweaks."}, {"owner": {"reputation": 13, "user_id": 5982704, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df96532273143f0e46bb839f1fa8438d?s=128&d=identicon&r=PG", "display_name": "tyler p", "link": "https://stackoverflow.com/users/5982704/tyler-p"}, "edited": false, "score": 0, "creation_date": 1538688414, "post_id": 52636672, "comment_id": 92242062, "body": "Tim Williams, yes the path was correct upon testing - but thank you - it was smart to check to be safe."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5982704, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df96532273143f0e46bb839f1fa8438d?s=128&d=identicon&r=PG", "display_name": "tyler p", "link": "https://stackoverflow.com/users/5982704/tyler-p"}, "edited": false, "score": 0, "creation_date": 1538663728, "post_id": 52639557, "comment_id": 92230584, "body": "Thank you Evanzheng, so there is no way to save it as the array?  If I save it as a file, is there a workaround to get it back into the new email, and then delete the saved file as to not cause glut in the tempLoc?"}, {"owner": {"reputation": 161, "user_id": 10308648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e9afe6ea28d5466be955d0ec36da547?s=128&d=identicon&r=PG&f=1", "display_name": "Evanzheng", "link": "https://stackoverflow.com/users/10308648/evanzheng"}, "reply_to_user": {"reputation": 13, "user_id": 5982704, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df96532273143f0e46bb839f1fa8438d?s=128&d=identicon&r=PG", "display_name": "tyler p", "link": "https://stackoverflow.com/users/5982704/tyler-p"}, "edited": false, "score": 0, "creation_date": 1538736317, "post_id": 52639557, "comment_id": 92257572, "body": "You can add a mail item as an attachment to a new message. You can refer to the following link:<a href=\"https://docs.microsoft.com/en-us/office/vba/outlook/concepts/attachments/attach-an-outlook-contact-item-to-an-email-message\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/outlook/concepts/&hellip;</a>"}], "tags": [], "owner": {"reputation": 161, "user_id": 10308648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e9afe6ea28d5466be955d0ec36da547?s=128&d=identicon&r=PG&f=1", "display_name": "Evanzheng", "link": "https://stackoverflow.com/users/10308648/evanzheng"}, "is_accepted": true, "score": 0, "last_activity_date": 1538702312, "last_edit_date": 1538702312, "creation_date": 1538630677, "answer_id": 52639557, "question_id": 52636672, "link": "https://stackoverflow.com/questions/52636672/saveas-on-attachment-object-generates-error-438-object-doesnt-support-this-pr/52639557#52639557", "title": "SaveAs on attachment object generates Error 438 - Object doesn&#39;t support this property or method", "body": "<p>I can confirm that the attachment object does not contain the SaveAs method.</p>\n\n<p>You can try using the SaveAsFile method.</p>\n\n<p>For more information, please see the following link:</p>\n\n<p><a href=\"https://docs.microsoft.com/en-us/office/vba/api/outlook.attachment.saveasfile\" rel=\"nofollow noreferrer\">Attachment.SaveAsFile Method</a></p>\n"}], "owner": {"reputation": 13, "user_id": 5982704, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df96532273143f0e46bb839f1fa8438d?s=128&d=identicon&r=PG", "display_name": "tyler p", "link": "https://stackoverflow.com/users/5982704/tyler-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 332, "favorite_count": 0, "accepted_answer_id": 52639557, "answer_count": 1, "score": 0, "last_activity_date": 1592901115, "creation_date": 1538606667, "last_edit_date": 1592901115, "question_id": 52636672, "link": "https://stackoverflow.com/questions/52636672/saveas-on-attachment-object-generates-error-438-object-doesnt-support-this-pr", "title": "SaveAs on attachment object generates Error 438 - Object doesn&#39;t support this property or method", "body": "<p>I am running a modified macro to perform the following tasks on an email in an inbox.</p>\n\n<ol>\n<li>Isolate the attachments from the email</li>\n<li>Open a new email to mimic exactly the previous email body to new recipient, without adding the forward information and signature etc.</li>\n<li>Attach the attachments from the original email to the new email</li>\n<li>Send the new email to the new recipient</li>\n</ol>\n\n<p>In the steps to isolate the attachment, I am trying to save to an array as a temp location and then kill the attachment after completing adding to the new email. </p>\n\n<p>At the line where the attachment would be saved to the array, I receive </p>\n\n<blockquote>\n  <p>Run-time error '438': Object doesn't support this property or method</p>\n</blockquote>\n\n<p>Code as follows for this segment:</p>\n\n<pre><code>Set myOriginal = olFolder.Items(itemNum)\nSet myForward = Application.CreateItem(olMailItem)\nSet myAttachments = myForward.Attachments\n\nFor Each olAttachment In myOriginal.Attachments\n\n    If InStr(1, myOriginal.HTMLBody, olAttachment.FileName, vbTextCompare) &lt; 1 Then\n\n        ReDim attArray(0 To 0)\n        attArray(0) = tempLoc &amp; \"Original Attachment\" &amp; olAttachment.FileName\n        olAttachment.SaveAs attArray(0)\n\n        With myForward\n\n            'Make sure the attachments are in array format\n            If Not IsMissing(attachmentArray) Then\n\n                If IsArray(attachmentArray) Then\n                    For i = 0 To UBound(attachmentArray)\n                        .Attachments.Add attachmentArray(i)\n                    Next i\n                End If\n\n            End If\n\n        End With\n\n        Kill attArray(0)\n\n    End If\n\nNext olAttachment\n\nmyForward.Subject = myOriginal.Subject\n</code></pre>\n\n<p>The error occurs on line</p>\n\n<pre><code>olAttachment.SaveAs attArray(0)\n</code></pre>\n"}, {"tags": ["excel", "vba", "automation", "gmail", "tracking"], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1538614377, "creation_date": 1538614377, "answer_id": 52637512, "question_id": 52636041, "link": "https://stackoverflow.com/questions/52636041/email-automation-and-open-tracking-with-vba/52637512#52637512", "title": "email automation and open tracking with VBA", "body": "<p>Well, in Outlook, it would be done like this.</p>\n\n<pre><code>With OutMail\n.ReadReceiptRequested = True\nEnd With\n</code></pre>\n\n<p>With Gmail, all I can think of is that you need to check 'Request return receipt'.  I don't think you can do that with VBA...that seems to be waayyyy outside the realm of what VBA is capable of.  I think Google will handle this for you though.  See the link below for more info.</p>\n\n<p><a href=\"https://www.everettcc.edu/files/administration/college-services/information-technology/google/gmail-return-receipt.pdf\" rel=\"nofollow noreferrer\">https://www.everettcc.edu/files/administration/college-services/information-technology/google/gmail-return-receipt.pdf</a></p>\n"}], "owner": {"reputation": 1, "user_id": 10453569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cf0c69289d5766b0c320bda344fef08?s=128&d=identicon&r=PG&f=1", "display_name": "hamza", "link": "https://stackoverflow.com/users/10453569/hamza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593591855, "creation_date": 1538602710, "last_edit_date": 1593591855, "question_id": 52636041, "link": "https://stackoverflow.com/questions/52636041/email-automation-and-open-tracking-with-vba", "title": "email automation and open tracking with VBA", "body": "<p>I wrote a VBA macro that can send email automatically with a Gmail account and it's working perfectly, but I want also to add open tracking, meaning I want to know when the receiver opens the Email, how can I do that? and if it's not possible with VBA what other method can I use? </p>\n"}, {"tags": ["vba", "excel-2013"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1538600867, "post_id": 52635624, "comment_id": 92204625, "body": "Are you copying a table that <i>spans the entire row</i> into cell <i>B1</i> on the Master sheet? Because that is impossible."}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 8935823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be5728fe714d2f06c514fb50dfed53c3?s=128&d=identicon&r=PG&f=1", "display_name": "H Foucault", "link": "https://stackoverflow.com/users/8935823/h-foucault"}, "edited": false, "score": 0, "creation_date": 1538686650, "post_id": 52642499, "comment_id": 92241422, "body": "Thanks. I am using Find for the last row in trg ( the destination sheet ) . I was having trouble dealing with SpecialCells requires the same column to be the longest one. My data is malformed (blanks all over the place ) and sometime column B has the last bit of data and sometimes column A. I was going to autofill then use specialCells, but I will &quot;fill in the blanks&quot; on the destination sheet."}], "tags": [], "owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "is_accepted": true, "score": 0, "last_activity_date": 1538642399, "creation_date": 1538642399, "answer_id": 52642499, "question_id": 52635624, "link": "https://stackoverflow.com/questions/52635624/finding-the-address-of-a-table-range-using-vba/52642499#52642499", "title": "Finding the address of a table range using vba", "body": "<p>That funny range is obviously there. What you can do is to control the size of the data to be copied. If you can set a meaningful maximum value for table width then you can limit size like this: </p>\n\n<pre><code>const MAXWID = 1000\nDim r As Range\n\nIf tbl.Range.Columns.Count &gt; MAXWID Then\n    Set r = tbl.Range.Resize(, MAXWID)\nElse\n    Set r = tbl.Range\nEnd If\n\nr.Copy Destination:=trg.Range(\"B1\")\n</code></pre>\n\n<p>Funny things can happen to the height of the table(s), too, so you may want to implement this for the other dimension. For appending the tables you need to know where the first empty row is: </p>\n\n<pre><code>FirstEmptyRow = trg.Range(\"B1\").SpecialCells(xlCellTypeLastCell).Row + 1\nr.Copy Destination:=trg.Cells(FirstEmptyRow, \"B\")\n</code></pre>\n\n<p>For sheet manipulation you need to use <code>On Error ...</code> like this:</p>\n\n<pre><code>Application.DisplayAlerts = False\nOn Error Resume Next\nSet trg = wrk.Sheets(\"Master\")\nIf Err.Number = 0 Then    ' sheet exists\n    trg.Usedrange.Delete  ' delete all existing data -&gt; have a clean sheet\nElse   ' sheet doesn't exist, Add new worksheet as the first worksheet\n    Set trg = wrk.Worksheets.Add(Before:=wrk.Worksheets(1))\n    If Err.Number &lt;&gt; 0 Then &lt;  sheet is not added, handle error...&gt;\n    trg.Name = \"Master\"\nEnd If\nOn Error Goto 0\nApplication.DisplayAlerts = True\n</code></pre>\n\n<p>It's worth taking the time to learn how error handling works in VBA. </p>\n\n<p>And finally: use <code>Option Explicit</code>. It pays. </p>\n"}], "owner": {"reputation": 37, "user_id": 8935823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be5728fe714d2f06c514fb50dfed53c3?s=128&d=identicon&r=PG&f=1", "display_name": "H Foucault", "link": "https://stackoverflow.com/users/8935823/h-foucault"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1817, "favorite_count": 0, "accepted_answer_id": 52642499, "answer_count": 1, "score": 0, "last_activity_date": 1538642399, "creation_date": 1538600405, "question_id": 52635624, "link": "https://stackoverflow.com/questions/52635624/finding-the-address-of-a-table-range-using-vba", "title": "Finding the address of a table range using vba", "body": "<p>I am working with an excel sheet that has a bunch of sheets with data in tables. I am trying to consolidate the sheets. I do not want the copied data to be in tables. I am able to find the tables range address for all the sheets except one, which is retunring an address of $1:$104. All the other ranged are like this \"$A$1:$J$43\" . When I try to copy this table using the address it returns , I get the runtime error \"1004\". For now , the code rewrite all the tables in the same place,  but I will be changing the code to copy the tables into different places in the destination sheet. \nHere is my code:</p>\n\n<pre><code>  Sub mergeWorksheets()\n   Dim wrk As Workbook 'Workbook object - Always good to work with \n object variables\n   Dim sht As Worksheet 'Object for handling worksheets in loop\n   Dim trg As Worksheet 'Master Worksheet\n   Dim rng As Range 'Range object\n   Dim colCount As Integer 'Column count in tables in the worksheets\n   Dim mLastRow As Integer\n   Dim LastRow As Integer\n   Dim rngFound As Range\n   Dim i As Integer\n\nSet wrk = ActiveWorkbook 'Working in active workbook\n\n'We don't want screen updating\nApplication.ScreenUpdating = False\n\n' would rather not do a loop but using a function to check and delete sheet renders error\nFor Each Sheet In ActiveWorkbook.Worksheets\n If Sheet.Name = \"Master\" Then\n    Application.DisplayAlerts = False\n    Sheets(\"Master\").Delete\n    Application.DisplayAlerts = True\n End If\nNext Sheet\n ' Add new worksheet as the last worksheet\n  Set trg = wrk.Worksheets.Add(Before:=wrk.Worksheets(1))\n ' Rename the new worksheet\n  trg.Name = \"Master\"\n\n 'We can start loop\n For Each sht In wrk.Worksheets\n    'If worksheet in loop is the last one, stop execution (it is Master worksheet)\n    If sht.Name Like \"*Attri*\" Then\n           Debug.Print sht.Name\n           'Find the last row of the master sheet\n           Set rngFound = trg.UsedRange.Find(\"*\", searchorder:=xlByRows, searchdirection:=xlPrevious)\n           If Not rngFound Is Nothing Then\n           'you found the value - do something\n               mLastRow = rngFound.Row\n               Debug.Print \"Last row of master \" &amp; rngFound.Address, mLastRow\n           Else\n           ' you didn't find anything becasue sheet is empty - first pass\n              mLastRow = 0\n           End If\n           For Each tbl In sht.ListObjects\n               'Do something to all the tables...\n                Debug.Print tbl.Name\n                Debug.Print tbl.Range.Address\n                'Put data into the Master worksheet\n                    tbl.Range.Copy Destination:=trg.Range(\"B1\")\n                 Next tbl\n\n       '    trg.Cells(mLastRow + 1, 1).Value = \"Tab Name\"\n        '   trg.Cells(mLastRow + 1, 1).Font.Bold = \"True\"\n         '  trg.Range(\"A\" &amp; mLastRow + 1).Value = sht.Name\n\n        Debug.Print \"-------\"\n        Else\n           ' Debug.Print \"error \" &amp; sht.Name &amp; \" is missing header \"\n        End If\n\nNext sht\n</code></pre>\n"}, {"tags": ["excel", "vba", "worksheet", "printers", "page-setup"], "comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1538600657, "post_id": 52635458, "comment_id": 92204526, "body": "I can&#39;t replicate the problem, I copied the code and put it in a blank workbook, and had no errors. If you are referring that you need a printer installed, then yes, that could be an issue."}, {"owner": {"reputation": 1024, "user_id": 6040823, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/DDCAB.jpg?s=128&g=1", "display_name": "Jason Brady", "link": "https://stackoverflow.com/users/6040823/jason-brady"}, "edited": false, "score": 0, "creation_date": 1538601552, "post_id": 52635458, "comment_id": 92204859, "body": "Updated question with more information"}], "answers": [{"comments": [{"owner": {"reputation": 1024, "user_id": 6040823, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/DDCAB.jpg?s=128&g=1", "display_name": "Jason Brady", "link": "https://stackoverflow.com/users/6040823/jason-brady"}, "edited": false, "score": 0, "creation_date": 1538613672, "post_id": 52637233, "comment_id": 92207848, "body": "same problem, sorry. But thank you for the suggestion"}], "tags": [], "owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "is_accepted": false, "score": 0, "last_activity_date": 1538611892, "creation_date": 1538611892, "answer_id": 52637233, "question_id": 52635458, "link": "https://stackoverflow.com/questions/52635458/change-orientation-to-xllandscape-without-first-print-preview/52637233#52637233", "title": "Change Orientation to xlLandscape without first print preview", "body": "<p>Try turning off <a href=\"https://docs.microsoft.com/en-gb/office/vba/api/excel.application.printcommunication\" rel=\"nofollow noreferrer\">Application.PrintCommunication</a> before you work with page setup and then turn it back on afterwards. Like this:</p>\n\n<pre><code>Application.PrintCommunication = False\n\nWith ws.PageSetup\n    .Orientation = xlLandscape\nEnd With\n\nApplication.PrintCommunication = True\n</code></pre>\n\n<p>That might just move the error on to the line where you turn print communication back on, though</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8475936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00320a0683818c73db1a35a4cb161916?s=128&d=identicon&r=PG&f=1", "display_name": "Tantan", "link": "https://stackoverflow.com/users/8475936/tantan"}, "is_accepted": false, "score": 0, "last_activity_date": 1543213571, "creation_date": 1543213571, "answer_id": 53475738, "question_id": 52635458, "link": "https://stackoverflow.com/questions/52635458/change-orientation-to-xllandscape-without-first-print-preview/53475738#53475738", "title": "Change Orientation to xlLandscape without first print preview", "body": "<p>You can try to replace xlLandscape by value 2.\nTake a look at <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.xlpageorientation\" rel=\"nofollow noreferrer\">xlPageOrientation enumeration (Excel)</a></p>\n"}], "owner": {"reputation": 1024, "user_id": 6040823, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/DDCAB.jpg?s=128&g=1", "display_name": "Jason Brady", "link": "https://stackoverflow.com/users/6040823/jason-brady"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 578, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1545844168, "creation_date": 1538599671, "last_edit_date": 1592644375, "question_id": 52635458, "link": "https://stackoverflow.com/questions/52635458/change-orientation-to-xllandscape-without-first-print-preview", "title": "Change Orientation to xlLandscape without first print preview", "body": "<p>I have code that includes changing some of the .PageSetup variables.</p>\n<p>I'm having issues where I use this code</p>\n<pre><code>Sub Test()\n\n    Dim ws as Worksheet\n    \n    Set ws = ActiveSheet\n    \n    With ws.PageSetup\n        .Orientation = xlLandscape\n    End With\n\nEnd Sub\n</code></pre>\n<p>This will error out, but if I pause the code before running <code>.Orientation</code> and go to Print Preview, then try running it, everything works fine.</p>\n<p>It seems the .PageSetup features need to have the printer settings loaded before being able to execute. I don't know how to do this with VBA.</p>\n<p>I am running this from Access DB VBA. It exports a table that I then create a new Excel Application to open it with using</p>\n<pre><code>Dim xlApp as Excel.Application\nset xlApp = New Excel.Application\n</code></pre>\n<p>Historically, as long as I have the Excel Reference Library loaded, any VBA I write here works the same in Access as it would in Excel.</p>\n<p>But just to compare, I've also had this issue when inside of an Excel file running the VBA, its just not consistent, so I've never figured out what the issue could be. But any time I do have the problem, the solution is always just select Print Preview first.</p>\n<p>This is the error code I get on my specific macro:</p>\n<blockquote>\n<p>Error Number: 1004</p>\n<p>Error Description: Unable to set the Orientation property of the PageSetup class</p>\n</blockquote>\n<p>The macro does a ton of queries and table updates before it gets to the Excel export. Also, the error message seems to be fairly generic with the 1004 number.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 2, "creation_date": 1538599310, "post_id": 52635304, "comment_id": 92203974, "body": "on which line is the error? What is the value of lrw and what is the value of i when failing if failing inside the For. You can inspect variables using the locals window to check dimensions."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1538599514, "post_id": 52635304, "comment_id": 92204063, "body": "@JNevill You are correct in principle, but unqualified <code>Rows.Count</code> applies to the entire sheet, and total row count is the same on all sheets."}, {"owner": {"reputation": 23, "user_id": 10453446, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Qqac_BltV3o/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DXy1nfx2yH-Lx5_Gw8FcHux3SCQ6g/mo/photo.jpg?sz=128", "display_name": "loriiii", "link": "https://stackoverflow.com/users/10453446/loriiii"}, "edited": false, "score": 0, "creation_date": 1538600565, "post_id": 52635304, "comment_id": 92204479, "body": "This line was showing error -object doesn&#39;t support this property or method <code>PTarray = wkbNPI.wksPT.Range(&quot;A7:AG&quot; &amp; lrw2).Value</code>"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1538601005, "post_id": 52635304, "comment_id": 92204678, "body": "That&#39;s a rather different error to &quot;subscript out of range&quot;. It happens because <code>wksPT</code> is your variable containing a sheet, not a part of the <code>Workbook</code> class definition, even though the sheet instance referenced by that variable belongs to the <code>Sheets</code> collection of the workbook referenced by the <code>wkbNPI</code> variable. You&#39;re supposed to use it on its own, <code>wksPT.Range(&quot;A7:AG&quot; &amp; lrw).Value</code>."}, {"owner": {"reputation": 23, "user_id": 10453446, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Qqac_BltV3o/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DXy1nfx2yH-Lx5_Gw8FcHux3SCQ6g/mo/photo.jpg?sz=128", "display_name": "loriiii", "link": "https://stackoverflow.com/users/10453446/loriiii"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1538602089, "post_id": 52635304, "comment_id": 92205034, "body": "@GSerg I have changed to your code and it still gives a different run-time error 1004- Method &#39;Range of object&#39; _worksheet&#39; failed"}, {"owner": {"reputation": 865, "user_id": 10361731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8873db235bacaa9d53de9c31a0b8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Jchang43", "link": "https://stackoverflow.com/users/10361731/jchang43"}, "edited": false, "score": 0, "creation_date": 1538604151, "post_id": 52635304, "comment_id": 92205740, "body": "is lrw zero by any chance? I&#39;ve never seen anything like <code>Cells(Rows.Count, &quot;AE&quot;)</code>; usually I see <code>Range(&quot;AE&quot; &amp; Rows.Count)</code> or <code>Cells(Rows.Count, 31)</code>. Not sure if that&#39;ll solve the problem though."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "reply_to_user": {"reputation": 865, "user_id": 10361731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8873db235bacaa9d53de9c31a0b8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Jchang43", "link": "https://stackoverflow.com/users/10361731/jchang43"}, "edited": false, "score": 4, "creation_date": 1538605136, "post_id": 52635304, "comment_id": 92205995, "body": "@Brotato <code>Cells(Rows.Count, &quot;AE&quot;)</code> is valid syntax and the ability to specify columns with a number or a String is part of why I prefer using it whenever possible"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 10453446, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Qqac_BltV3o/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DXy1nfx2yH-Lx5_Gw8FcHux3SCQ6g/mo/photo.jpg?sz=128", "display_name": "loriiii", "link": "https://stackoverflow.com/users/10453446/loriiii"}, "edited": false, "score": 0, "creation_date": 1538739450, "post_id": 52638381, "comment_id": 92259311, "body": "I have tried you code but it still gives a run-time error 1004- Method &#39;Range of object&#39; _worksheet&#39; failed"}], "tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": false, "score": 1, "last_activity_date": 1538622407, "creation_date": 1538622407, "answer_id": 52638381, "question_id": 52635304, "link": "https://stackoverflow.com/questions/52635304/array-variant-subscript-out-of-range/52638381#52638381", "title": "array variant subscript out of range", "body": "<p>Define sheet objects and workbook objects separately.</p>\n\n<p>Try like this.</p>\n\n<pre><code>Sub test()\nDim wkbNPI As Workbook\nDim wksPT As Worksheet\nDim wksFU As Worksheet\n\nDim lrw As Long\n\nSet wkbNPI = ActiveWorkbook\nSet wksPT = wkbNPI.Sheets(\"Packaging tracking\") '&lt;~~ set sheet with workbook\nSet wksFU = wkbNPI.Sheets(\"FollowUpMaterial\") '&lt;~~ set sheet with workbook\n\nlrw = wksPT.Cells(Rows.Count, \"AE\").End(xlUp).Row\nDim wf As WorksheetFunction\nSet wf = Application.WorksheetFunction\n\nDim PTarray As Variant\nPTarray = wksPT.Range(\"A7:AG\" &amp; lrw) '&lt; remove workbook\n\nDim i As Long, j As Long\n\nFor i = 7 To UBound(PTarray)\n    If PTarray(i, 31) &lt;&gt; 0 Then\n        PTarray(i, 32) = wf.IfError(wf.VLookup(PTarray(i, 31), wksFU.Range(\"B:R\"), 13, False), \"\")                    'vlookup follow up material\n        PTarray(i, 33) = wf.IfError(wf.VLookup(PTarray(i, 31), wksFU.Range(\"B:R\"), 17, False), \"\")                      'vlookup follow up material effective out date\n    End If\nNext i\n\nOn Error Resume Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 10453446, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Qqac_BltV3o/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DXy1nfx2yH-Lx5_Gw8FcHux3SCQ6g/mo/photo.jpg?sz=128", "display_name": "loriiii", "link": "https://stackoverflow.com/users/10453446/loriiii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1538622407, "creation_date": 1538599014, "last_edit_date": 1538600662, "question_id": 52635304, "link": "https://stackoverflow.com/questions/52635304/array-variant-subscript-out-of-range", "title": "array variant subscript out of range", "body": "<p>I was trying to define an array variant, but while running always meet run-time error 9-subscript out of range. Could anyone please help?\nFollowing is my code</p>\n\n<pre><code>Dim wkbNPI As Workbook\nDim wksPT As Worksheet\nDim wksFU As Worksheet\n\nDim lrw As Long\n\nSet wkbNPI = ActiveWorkbook\nSet wksPT = Sheets(\"Packaging tracking\")\nSet wksFU = Sheets(\"FollowUpMaterial\")\n\nlrw = wksPT.Cells(Rows.Count, \"AE\").End(xlUp).row\nDim wf As WorksheetFunction\nSet wf = Application.WorksheetFunction\n\nDim PTarray As Variant\nPTarray = wkbNPI.wksPT.Range(\"A7:AG\" &amp; lrw).Value\n\nDim i As Long, j As Long\n\nFor i = 7 To UBound(PTarray)\n    If PTarray(i, 31) &lt;&gt; 0 Then\n        PTarray(i, 32) = wf.IfError(wf.VLookup(PTarray(i, 31), wksFU.Range(\"B:R\"), 13, False), \"\")                    'vlookup follow up material\n        PTarray(i, 33) = wf.IfError(wf.VLookup(PTarray(i, 31), wksFU.Range(\"B:R\"), 17, False), \"\")                      'vlookup follow up material effective out date\n    End If\nNext i\n\nOn Error Resume Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 343, "user_id": 9626171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9587856742de2015aec848c7749c4b15?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/9626171/jordan"}, "edited": false, "score": 0, "creation_date": 1538596897, "post_id": 52634772, "comment_id": 92202882, "body": "The reason that I am using this particular function is that I have 3 values that I need. I need to top 3 greatest value cell addresses. So I use the large function to adjust for 1st, 2nd, and 3rd highest values."}, {"owner": {"reputation": 7517, "user_id": 3314095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nJlbV.png?s=128&g=1", "display_name": "XOR LX", "link": "https://stackoverflow.com/users/3314095/xor-lx"}, "reply_to_user": {"reputation": 343, "user_id": 9626171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9587856742de2015aec848c7749c4b15?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/9626171/jordan"}, "edited": false, "score": 2, "creation_date": 1538597038, "post_id": 52634772, "comment_id": 92202944, "body": "Then replace MAX with LARGE with the required parameter within the construction I posted. That doesn&#39;t change the point I made about obtaining the cell address being unnecessary."}], "tags": [], "owner": {"reputation": 7517, "user_id": 3314095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nJlbV.png?s=128&g=1", "display_name": "XOR LX", "link": "https://stackoverflow.com/users/3314095/xor-lx"}, "is_accepted": false, "score": 1, "last_activity_date": 1538596668, "creation_date": 1538596668, "answer_id": 52634772, "question_id": 52634646, "link": "https://stackoverflow.com/questions/52634646/offsetting-a-range-that-is-found-manually/52634772#52634772", "title": "Offsetting a range that is found manually", "body": "<p>Obtaining the cell address in this case is not necessary. What's more, <code>CELL</code> is a <strong>volatile</strong> function, and so should be avoided if possible.</p>\n\n<p>Simply:</p>\n\n<p><code>=INDEX(J10:W10,MATCH(MAX(J61:W61),J61:W61,0))</code></p>\n\n<p>Regards</p>\n"}, {"tags": [], "owner": {"reputation": 343, "user_id": 9626171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9587856742de2015aec848c7749c4b15?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/9626171/jordan"}, "is_accepted": false, "score": 0, "last_activity_date": 1538596940, "creation_date": 1538596940, "answer_id": 52634833, "question_id": 52634646, "link": "https://stackoverflow.com/questions/52634646/offsetting-a-range-that-is-found-manually/52634833#52634833", "title": "Offsetting a range that is found manually", "body": "<p>I ended up finding a way to use vba to do what I need</p>\n\n<pre><code>Sub Top_3_Problems()\n\nFirst_Address = Range(\"D62\")\nSecond_Address = Range(\"D63\")\nThird_Address = Range(\"D64\")\n\n\nFirst_problem = Range(First_Address).Offset(-51)\nSecond_problem = Range(Second_Address).Offset(-51)\nThird_problem = Range(Third_Address).Offset(-51)\n\nRange(\"B40\") = First_problem\nRange(\"B41\") = Second_problem\nRange(\"B42\") = Third_problem\n\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 0, "last_activity_date": 1538596984, "creation_date": 1538596984, "answer_id": 52634847, "question_id": 52634646, "link": "https://stackoverflow.com/questions/52634646/offsetting-a-range-that-is-found-manually/52634847#52634847", "title": "Offsetting a range that is found manually", "body": "<p>Quick example of how to do this in <code>VBA</code></p>\n\n<p>This is just a simple example. If implemented, objects need to be properly qualifed with a worksheet and the <code>Find</code> method needs to have options added</p>\n\n<pre><code>Option Explicit\n\nSub MaxHeader()\n\nDim Found As Range, SearchRange As Range\n\nSet SearchRange = Range(\"J61:W61\")\nSet Found = SearchRange.Find(WorksheetFunction.Max(SearchRange))\n\nIf Not Found Is Nothing Then MsgBox Cells(10, Found.Column)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 343, "user_id": 9626171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9587856742de2015aec848c7749c4b15?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/9626171/jordan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1594024622, "creation_date": 1538596059, "last_edit_date": 1594024622, "question_id": 52634646, "link": "https://stackoverflow.com/questions/52634646/offsetting-a-range-that-is-found-manually", "title": "Offsetting a range that is found manually", "body": "<p>I have a situation where I am using these equations </p>\n\n<pre><code>=CELL(\"address\",INDEX(J61:W61,MATCH(LARGE((J61:W61),1),J61:W61,0)))\n</code></pre>\n\n<p>To find the cell address of the largest value cell in that range. </p>\n\n<p>For example, it gives me this as a result. $T$61 (which contains the highest value).\nI now want to use that information and offset it upwards 51 rows to extract the title for this column. How can I use this information and a formula, or VBA to find the content of $T$10 in this case?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 3, "creation_date": 1538595550, "post_id": 52634485, "comment_id": 92202280, "body": "Please see <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> to help write a question in line with the site&#39;s guidelines. We&#39;d love to help but need to see what you have tried and where you are stuck."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1538595885, "post_id": 52634485, "comment_id": 92202437, "body": "<code>SUMIFS()</code>. That&#39;s all you should need, assuming those are two separate columns."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10453242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123c89e646380fb233df62cf73524420?s=128&d=identicon&r=PG&f=1", "display_name": "Neji", "link": "https://stackoverflow.com/users/10453242/neji"}, "edited": false, "score": 0, "creation_date": 1538660476, "post_id": 52634973, "comment_id": 92228233, "body": "thanks I tried sumif as mentioned above but it didn&#39;t work. This one worked like charm. Thanks again."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 0, "last_activity_date": 1538601585, "last_edit_date": 1538601585, "creation_date": 1538597537, "answer_id": 52634973, "question_id": 52634485, "link": "https://stackoverflow.com/questions/52634485/how-to-calucate-the-sum-through-vba-in-excel-based-on-variable-column/52634973#52634973", "title": "How to calucate the sum through VBA in excel based on variable column?", "body": "<p>In the worksheet, use:</p>\n\n<pre><code>=SUMPRODUCT((A2:A5=\"Indirect\")*(B2:B5))\n=SUMPRODUCT((A2:A5=\"Direct\")*(B2:B5))\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/BJOUa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BJOUa.png\" alt=\"enter image description here\"></a></p>\n\n<p>So with VBA:</p>\n\n<pre><code>Sub Equivalent()\n    x = Evaluate(\"SUMPRODUCT((A2:A5=\"\"Indirect\"\")*(B2:B5))\")\n    y = Evaluate(\"SUMPRODUCT((A2:A5=\"\"Direct\"\")*(B2:B5))\")\nEnd Sub\n</code></pre>\n\n<p><strong>Note:</strong></p>\n\n<p>In VBA we double-up the double quotes.</p>\n"}], "owner": {"reputation": 11, "user_id": 10453242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123c89e646380fb233df62cf73524420?s=128&d=identicon&r=PG&f=1", "display_name": "Neji", "link": "https://stackoverflow.com/users/10453242/neji"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "closed_date": 1538655092, "accepted_answer_id": 52634973, "answer_count": 1, "score": -1, "last_activity_date": 1538604042, "creation_date": 1538595417, "last_edit_date": 1538604042, "question_id": 52634485, "link": "https://stackoverflow.com/questions/52634485/how-to-calucate-the-sum-through-vba-in-excel-based-on-variable-column", "closed_reason": "Needs more focus", "title": "How to calucate the sum through VBA in excel based on variable column?", "body": "<p>I have an excel file where the tables is generated through macro script something like this.</p>\n\n\n<b>Type Cost</b><br>\nIndirect 44<br>\nDirect 68<br>\nDirect 33<br>\nIndirect 120<br>\n\n\n<p>I want to generate sum of all the indirect and direct cost separately in two different columnn.</p>\n"}, {"tags": ["excel", "vba", "range", "cell", "target"], "answers": [{"tags": [], "owner": {"reputation": 33, "user_id": 10311743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8e91fcedafb230991bc14e629812e95?s=128&d=identicon&r=PG&f=1", "display_name": "ehdgur", "link": "https://stackoverflow.com/users/10311743/ehdgur"}, "is_accepted": false, "score": 0, "last_activity_date": 1538596558, "creation_date": 1538596558, "answer_id": 52634749, "question_id": 52634433, "link": "https://stackoverflow.com/questions/52634433/target-range-end-with-blanks/52634749#52634749", "title": "Target Range.End with blanks", "body": "<p>Got it working after many possibilities.\nSolution:</p>\n\n<p>Cells(1, target.Column)</p>\n"}], "owner": {"reputation": 33, "user_id": 10311743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8e91fcedafb230991bc14e629812e95?s=128&d=identicon&r=PG&f=1", "display_name": "ehdgur", "link": "https://stackoverflow.com/users/10311743/ehdgur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1538604091, "creation_date": 1538595206, "last_edit_date": 1538604091, "question_id": 52634433, "link": "https://stackoverflow.com/questions/52634433/target-range-end-with-blanks", "title": "Target Range.End with blanks", "body": "<p>I know this is a common question but i tried multiple solutions but none worked as my need.</p>\n\n<p>I need to store the first cell of a column with a few blank rows using Target as my code is used for Worksheet_Change, for example:</p>\n\n<p>Column</p>\n\n<p><strong>1</strong></p>\n\n<p>(blank)</p>\n\n<p>2</p>\n\n<p>3</p>\n\n<p>(blank)</p>\n\n<p>4</p>\n\n<p>5(My Target)</p>\n\n<p>In this example I need to store  number 1 in variable.(Nfirst =1)</p>\n\n<p>At first i tried Target.End(xlUp) but because of blank cells it does not return 1.\nMy guess is I need to use Target.Column.. something but tried in many different ways and none worked.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 129, "user_id": 5152870, "user_type": "registered", "profile_image": "https://graph.facebook.com/911424418923526/picture?type=large", "display_name": "Geoffrey Fernandez", "link": "https://stackoverflow.com/users/5152870/geoffrey-fernandez"}, "edited": false, "score": 0, "creation_date": 1538599513, "post_id": 52634425, "comment_id": 92204062, "body": "If I remember correctly, you can use &quot;.resize&quot;. This method belongs to a selection object and the arguments I think are #rows, #columns. Try playing with that."}, {"owner": {"reputation": 1, "user_id": 10453177, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-D-ZqNUGZdo0/AAAAAAAAAAI/AAAAAAAAFeU/IiTbir_wVw0/photo.jpg?sz=128", "display_name": "Ravi", "link": "https://stackoverflow.com/users/10453177/ravi"}, "reply_to_user": {"reputation": 129, "user_id": 5152870, "user_type": "registered", "profile_image": "https://graph.facebook.com/911424418923526/picture?type=large", "display_name": "Geoffrey Fernandez", "link": "https://stackoverflow.com/users/5152870/geoffrey-fernandez"}, "edited": false, "score": 0, "creation_date": 1538610292, "post_id": 52634425, "comment_id": 92207203, "body": "I am basically looking for a code where the number of rows selected and copied depends on a cell value..for example, if a cell value C3=5, i want 5 rows selected, if C3=9, I want 9 rows selected."}, {"owner": {"reputation": 1, "user_id": 10453177, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-D-ZqNUGZdo0/AAAAAAAAAAI/AAAAAAAAFeU/IiTbir_wVw0/photo.jpg?sz=128", "display_name": "Ravi", "link": "https://stackoverflow.com/users/10453177/ravi"}, "reply_to_user": {"reputation": 129, "user_id": 5152870, "user_type": "registered", "profile_image": "https://graph.facebook.com/911424418923526/picture?type=large", "display_name": "Geoffrey Fernandez", "link": "https://stackoverflow.com/users/5152870/geoffrey-fernandez"}, "edited": false, "score": 0, "creation_date": 1538610322, "post_id": 52634425, "comment_id": 92207209, "body": "How do I pass a cell value as argument in Range or Cell functions?"}, {"owner": {"reputation": 129, "user_id": 5152870, "user_type": "registered", "profile_image": "https://graph.facebook.com/911424418923526/picture?type=large", "display_name": "Geoffrey Fernandez", "link": "https://stackoverflow.com/users/5152870/geoffrey-fernandez"}, "edited": false, "score": 0, "creation_date": 1538665362, "post_id": 52634425, "comment_id": 92231625, "body": "something like cell.value"}], "owner": {"reputation": 1, "user_id": 10453177, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-D-ZqNUGZdo0/AAAAAAAAAAI/AAAAAAAAFeU/IiTbir_wVw0/photo.jpg?sz=128", "display_name": "Ravi", "link": "https://stackoverflow.com/users/10453177/ravi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 150, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1538599559, "creation_date": 1538595174, "last_edit_date": 1538599294, "question_id": 52634425, "link": "https://stackoverflow.com/questions/52634425/excel-vba-select-and-copy-number-of-rows-based-on-dynamic-cell-value-in-a-differ", "title": "Excel VBA Select and copy number of rows based on dynamic cell value in a different sheet", "body": "<p>In sheet 1, in Cell C3, numeric values keep changing. I want the number of rows in Sheet2 to be selected based on the cell value C3 in sheet 1. For example, Sheet2 has 100 rows and 7 columns. In sheet1, If C2=X and C3=5, I want vba to loop through sheet2 column A to find the first matching cell for X, and then select the C3 number of rows from the first match, and copy them to sheet3.</p>\n\n<pre><code>                  Sheet1   Sheet2  Sheet3 (final result)\n                  C2=X     A1=a    A3 row\n                  C3=5     A2=b    A4 row\n                           A3=X    A5 row\n                           A4=X    A6 row\n                           A5=X    A7 row\n                           A6=X\n                           A7=X\n                           A8=X\n</code></pre>\n\n<p>Here's the code I'm using:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Worksheets(\"Sheet2\").Activate\n    a = Worksheets(\"Sheet2\").Cells(Rows.Count, 1).End(xlUp).Row\n    Worksheets(\"sheet1\").Activate\n    b = Worksheets(\"sheet1\").Cells(Rows.Count, 1).End(xlUp).Row\n\n    For i = 2 To a\n        For j = 2 To b\n            If Worksheets(\"Sheet2\").Cells(i, 1).Value = Worksheets(\"Sheet1\").Cells(j, 1).Value Then\n                If Worksheets(\"Sheet1\").Cells(j, 3).Value &gt; Worksheets(\"Sheet1\").Cells(j, 5).Value Then\n                    'THE CODE I NEED HELP WITH\n                End If\n            End If\n        Next j\n    Next i\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1538593216, "post_id": 52633921, "comment_id": 92201192, "body": "What is the value of <code>r</code> when it fails?"}, {"owner": {"reputation": 136, "user_id": 1241641, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dd9033e318eef86e67d5446aa76e8690?s=128&d=identicon&r=PG", "display_name": "dgibbons82", "link": "https://stackoverflow.com/users/1241641/dgibbons82"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1538593323, "post_id": 52633921, "comment_id": 92201247, "body": "How do I find that out?  It&#39;s my understanding that r is a variable that is set to the sheet name (OUTPUT1_TEST_MACRO) and the column where the comma separated values might exist (column D)"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1538594136, "post_id": 52633921, "comment_id": 92201637, "body": "Here\u2019s a guide to help you better use the VBA editor <a href=\"http://www.cpearson.com/excel/debuggingvba.aspx\" rel=\"nofollow noreferrer\">cpearson.com/excel/debuggingvba.aspx</a>"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1538594474, "post_id": 52633921, "comment_id": 92201793, "body": "Further to what Tim said, put a watch on <code>r</code>, and when your code breaks on error look at the <code>Value</code> property"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1538596639, "post_id": 52633921, "comment_id": 92202768, "body": "When the code is stopped and the problem line highlighted in yellow, go the the VB editor Immediate window (Ctrl+G), type <code>? r.Value</code> and press Enter"}, {"owner": {"reputation": 136, "user_id": 1241641, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dd9033e318eef86e67d5446aa76e8690?s=128&d=identicon&r=PG", "display_name": "dgibbons82", "link": "https://stackoverflow.com/users/1241641/dgibbons82"}, "edited": false, "score": 0, "creation_date": 1538597295, "post_id": 52633921, "comment_id": 92203072, "body": "Thanks, Tim.   Here are the results of &quot;? r.Value&quot;: Error 2042"}, {"owner": {"reputation": 136, "user_id": 1241641, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dd9033e318eef86e67d5446aa76e8690?s=128&d=identicon&r=PG", "display_name": "dgibbons82", "link": "https://stackoverflow.com/users/1241641/dgibbons82"}, "edited": false, "score": 0, "creation_date": 1538598726, "post_id": 52633921, "comment_id": 92203719, "body": "What&#39;s interesting is that if I select the entire Column D before running the macro, it does exactly what I need it to do for the last 6 lines, but then stops when it hits an #N/A value.  I&#39;m going to try hiding them and seeing if that makes a difference"}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1538599108, "post_id": 52633921, "comment_id": 92203879, "body": "The code you show in your post works perfectly for me, given your test data. Weird."}, {"owner": {"reputation": 136, "user_id": 1241641, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dd9033e318eef86e67d5446aa76e8690?s=128&d=identicon&r=PG", "display_name": "dgibbons82", "link": "https://stackoverflow.com/users/1241641/dgibbons82"}, "edited": false, "score": 0, "creation_date": 1538599350, "post_id": 52633921, "comment_id": 92203991, "body": "I think it was the #N/A value.  Not every value in my vlookup was found so it resulted in an N/A.  I&#39;m working with about 690,000 rows.  I replaced all #N/A&#39;s with blanks and it seems to be working now.  Or it may have crashed.  Can&#39;t tell.  It&#39;s running though and not erroring out so that&#39;s a good sign!"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1538611753, "post_id": 52633921, "comment_id": 92207489, "body": "It definitely is related to the #N/A error.  The target of the <code>Split</code> function needs to be a string.  An error is not a string.  You can see this if you change that line to split the <code>.Text</code> property to force it to a string:  <code>ar = Split(r.Value, &quot;,&quot;)</code>"}, {"owner": {"reputation": 136, "user_id": 1241641, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dd9033e318eef86e67d5446aa76e8690?s=128&d=identicon&r=PG", "display_name": "dgibbons82", "link": "https://stackoverflow.com/users/1241641/dgibbons82"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1538655980, "post_id": 52633921, "comment_id": 92225248, "body": "Just wanted to follow-up...  The macro worked fine once I removed the N/A.   @TimWilliam, feel free to post the VB editor Immediate window tip as an answer and I&#39;ll select it as answer.  That was the most helpful response that allowed me to find the root issue."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1538668744, "creation_date": 1538668744, "answer_id": 52651019, "question_id": 52633921, "link": "https://stackoverflow.com/questions/52633921/split-cells-into-multiple-rows-type-mismatch-error/52651019#52651019", "title": "Split cells into multiple rows - type mismatch error", "body": "<p>When the code is stopped and the problem line highlighted in yellow, go the the VB editor Immediate window (Ctrl+G), type </p>\n\n<pre><code>? r.Value \n</code></pre>\n\n<p>and press Enter.  </p>\n\n<p>It's possible your data contains error values which will need checking for/replacing.</p>\n"}], "owner": {"reputation": 136, "user_id": 1241641, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dd9033e318eef86e67d5446aa76e8690?s=128&d=identicon&r=PG", "display_name": "dgibbons82", "link": "https://stackoverflow.com/users/1241641/dgibbons82"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 52651019, "answer_count": 1, "score": -1, "last_activity_date": 1538668744, "creation_date": 1538592920, "last_edit_date": 1538593155, "question_id": 52633921, "link": "https://stackoverflow.com/questions/52633921/split-cells-into-multiple-rows-type-mismatch-error", "title": "Split cells into multiple rows - type mismatch error", "body": "<p>For reference, I attempted to use the selected answer from <a href=\"https://stackoverflow.com/questions/42425208/vba-split-cell-values-into-multiple-rows-and-keep-other-data\">this Stack Overflow question</a>, but I get <strong>Runtime Error 13: Type Mismatch</strong> error when I run the macro.  </p>\n\n<p>My data is setup similarly to the data in the previous question:</p>\n\n<pre><code>ColA    ColB    ColC    ColD\n1001    Red     Apple   A,B\n1002    Blue    Pear    C\n1003    Green   Plumb   D,E\n</code></pre>\n\n<p>What I need is output to look like this:</p>\n\n<pre><code>ColA    ColB   ColC     ColD\n1001    Red    Apple    A\n1001    Red    Apple    B\n1002    Blue   Pear     C\n1003    Green  Plumb    D\n1003    Green  Plumb    E  \n</code></pre>\n\n<p>I adjusted the macro to look like this (using the range as D999999, and modifying the name of my workbook):</p>\n\n<pre><code>Sub SplitMultipleUDC()\n    Dim r As Range, i As Long, ar\n    Set r = Worksheets(\"OUTPUT1_TEST_MACRO\").Range(\"D999999\").End(xlUp) ' The line I changed\n    Do While r.Row &gt; 1\n        ar = Split(r.Value, \",\")\n        If UBound(ar) &gt;= 0 Then r.Value = ar(0)\n            For i = UBound(ar) To 1 Step -1\n            r.EntireRow.Copy\n            r.Offset(1).EntireRow.Insert\n            r.Offset(1).Value = ar(i)\n        Next\n        Set r = r.Offset(-1)\n    Loop\nEnd Sub\n</code></pre>\n\n<p>The error line in question points to:</p>\n\n<pre><code>ar = Split(r.Value, \",\")\n</code></pre>\n\n<p>I can't figure out why this would be considered a data type mismatch.  I used a vlookup for the values in column D, but copy/pasted each formula result as a value.  When the macro didn't work the first time, I then converted each value to text format.  Not sure what else could be wrong.  Thanks for any help someone might be willing to offer.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1538592883, "post_id": 52633817, "comment_id": 92201024, "body": "If you export the #Occupants sheet by itself does the full content get included?"}, {"owner": {"reputation": 1162, "user_id": 610133, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/60ca8e998835b0d9d622564760d2b475?s=128&d=identicon&r=PG", "display_name": "Bob Stout", "link": "https://stackoverflow.com/users/610133/bob-stout"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1538595024, "post_id": 52633817, "comment_id": 92202063, "body": "@TimWilliams:  No, it still cuts it off when it&#39;s by itself."}, {"owner": {"reputation": 1162, "user_id": 610133, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/60ca8e998835b0d9d622564760d2b475?s=128&d=identicon&r=PG", "display_name": "Bob Stout", "link": "https://stackoverflow.com/users/610133/bob-stout"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1538595998, "post_id": 52633817, "comment_id": 92202495, "body": "I found it.  When I looked at it in View -&gt; Page Break Preview, the page didn&#39;t include the cut-off part.  Adjusted the page break and it worked."}], "owner": {"reputation": 1162, "user_id": 610133, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/60ca8e998835b0d9d622564760d2b475?s=128&d=identicon&r=PG", "display_name": "Bob Stout", "link": "https://stackoverflow.com/users/610133/bob-stout"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 108, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593592050, "creation_date": 1538592432, "last_edit_date": 1593592050, "question_id": 52633817, "link": "https://stackoverflow.com/questions/52633817/exportasfixedformat-cutting-second-page-off", "title": "ExportAsFixedFormat cutting second page off", "body": "<p>I'm saving sheets of an Excel workbook as a pdf.  The first sheet of the 2nd pdf (\"#Occupants\") is 2 pages when printed.  However, the .pdf file cuts off the second page.</p>\n\n<p>What am I missing here?</p>\n\n<pre><code>Sub SavePDF()\n    saveCensus = \"\\Census \" &amp; Format(Now(), \"mm-dd-yy\") &amp; \".pdf\"\n    Sheets(Array(\"A BLDG\", \"B BLDG\", \"C BLDG\", \"SUMMARY\")).Select\n    ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:=ActiveWorkbook.Path &amp; saveCensus, IgnorePrintAreas:=False\n\n    saveSnapshot = \"\\Snapshot \" &amp; Format(Now(), \"mm-dd-yy\") &amp; \".pdf\"\n    Sheets(Array(\"#Occupants\", \"Snapshot\")).Select\n    ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:=ActiveWorkbook.Path &amp; saveSnapshot, IgnorePrintAreas:=False\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "ms-access-2013", "sendkeys", "fax"], "comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 1, "creation_date": 1538592221, "post_id": 52633531, "comment_id": 92200699, "body": "Where is your code? A printscreen of the dialog box, what exactly do you want to enter, how is that data stored. Etc.. Also see <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 1, "user_id": 10452952, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-W3V-Lu4GTBc/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DV0eLiRp64bTdBu28p4h0y0WRcfIA/mo/photo.jpg?sz=128", "display_name": "Phil", "link": "https://stackoverflow.com/users/10452952/phil"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1538592638, "post_id": 52633531, "comment_id": 92200907, "body": "The codes in question starts at line 4 &quot;DoCmd.PrintOut...&quot; I added comments with a single quote right after it.  Basically, on the &quot;Send fax&quot; dialog box, I want to automate Alt-F to go to the fax box and put in the custom fax number as defined by rst![Fax] and then Alt-D to enter dialing prefix of &#39;99&#39; and then hit enter."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 2, "creation_date": 1538592659, "post_id": 52633531, "comment_id": 92200918, "body": "As you&#39;ve discovered, <code>SendKeys</code> is unreliable and should generally be avoided. Fax machines are still around, eh? Does your computer even still have a fax modem? Does it work manually? Don&#39;t these people have email? You could brush the dust off these old instructions/code from Microsoft that use the VBA reference library <b>&quot;Microsoft Fax Service Extended COM Type Library&quot;</b> for faxing to <a href=\"https://docs.microsoft.com/previous-versions/windows/desktop/fax/-mfax-sending-a-fax\" rel=\"nofollow noreferrer\">one</a> or <a href=\"https://docs.microsoft.com/previous-versions/windows/desktop/fax/-mfax-broadcasting-a-fax\" rel=\"nofollow noreferrer\">several</a> recipients."}, {"owner": {"reputation": 1, "user_id": 10452952, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-W3V-Lu4GTBc/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DV0eLiRp64bTdBu28p4h0y0WRcfIA/mo/photo.jpg?sz=128", "display_name": "Phil", "link": "https://stackoverflow.com/users/10452952/phil"}, "edited": false, "score": 0, "creation_date": 1538593052, "post_id": 52633531, "comment_id": 92201097, "body": "So is a network fax/printer (\\\\networkpath\\faxprintername ) considered a fax server?  Working from home today so unable to test..."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1538600704, "post_id": 52633531, "comment_id": 92204547, "body": "I can&#39;t say for sure but believe the Windows service used by that library works with both fax servers and local fax machines. More info in <a href=\"https://social.msdn.microsoft.com/Forums/en-US/a7006eb1-a3a3-409c-aedd-855683f3d21b/vba-code-to-send-a-fax\" rel=\"nofollow noreferrer\">this post</a> (there&#39;s some back &amp; forth so skim to the bottom). While tempted to heckle you for using faxes, I just learned that in many cases <a href=\"https://enterprise.efax.com/blog/the-top-10-reasons-companies-continue-to-fax-in-2017\" rel=\"nofollow noreferrer\">fax usage increased last year</a> although <a href=\"https://data.stackexchange.com/stackoverflow/query/906708/?tagName=fax\" rel=\"nofollow noreferrer\">not here</a>."}, {"owner": {"reputation": 1, "user_id": 10452952, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-W3V-Lu4GTBc/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DV0eLiRp64bTdBu28p4h0y0WRcfIA/mo/photo.jpg?sz=128", "display_name": "Phil", "link": "https://stackoverflow.com/users/10452952/phil"}, "edited": false, "score": 0, "creation_date": 1538753049, "post_id": 52633531, "comment_id": 92267484, "body": "No go... I guess the Lexmark MX520 multifunction is not considered as either a fax modem nor a fax server on my network, so unable to install as part of MS Fax."}], "owner": {"reputation": 1, "user_id": 10452952, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-W3V-Lu4GTBc/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DV0eLiRp64bTdBu28p4h0y0WRcfIA/mo/photo.jpg?sz=128", "display_name": "Phil", "link": "https://stackoverflow.com/users/10452952/phil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 182, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1538599682, "creation_date": 1538591273, "last_edit_date": 1538599682, "question_id": 52633531, "link": "https://stackoverflow.com/questions/52633531/ms-access-vba-appactivate-send-fax-and-sendkeys", "title": "MS Access VBA AppActivate &quot;Send fax&quot; and SendKeys", "body": "<p>I am sending a series of Access Report to the multifunction fax/printer.  Each report is customized and need to go to a specific phone number.  I want to automate but it keeps getting stuck at the point where the script should input the number and proceed.</p>\n\n<pre><code>DoCmd.PrintOut 'This works fine to print to the Fax\n</code></pre>\n\n<hr>\n\n<pre><code>AppActivate \"Send fax\" 'This works as the window focus changes from MS Access to the Send fax dialog box\n</code></pre>\n\n<hr>\n\n<pre><code>SendKeys \"%f\" &amp; rst![Fax] 'This does not work and when I move the mouse around, I get a pointer when on the Send fax dialog box but a busy spinning circle when I move the mouse away from the dialog box.  It seems the process is hung up at AppActivate and not letting this part work.\n</code></pre>\n\n<hr>\n\n<pre><code>SendKeys \"%d99\" 'This part would thus not work also\n</code></pre>\n\n<hr>\n\n<pre><code>SendKeys \"{Enter} 'This part would thus not work also\n</code></pre>\n"}, {"tags": ["vba", "ms-project"], "answers": [{"tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": false, "score": 3, "last_activity_date": 1538593260, "creation_date": 1538593260, "answer_id": 52633997, "question_id": 52633528, "link": "https://stackoverflow.com/questions/52633528/return-a-list-of-overdue-non-summary-tasks-from-a-project-using-vba/52633997#52633997", "title": "Return a list of overdue non-summary tasks from a project using VBA", "body": "<p>You're basically looking for a group of the overdue tasks. So make a <code>Collection</code>.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub TestFindOverdue()\n    Dim overdueTasks As Collection\n    Set overdueTasks = GetOverdueTasks\n\n    '--- do something with the overdue tasks here\nEnd Sub\n\nPrivate Function GetOverdueTasks() As Collection\n    Dim ProjTasks As Tasks\n    Dim ProjTask As Task\n    Dim overdueTasks As Collection\n\n    Set ProjTasks = ActiveProject.Tasks\n    For Each ProjTask In ProjTasks\n        If Not (ProjTask Is Nothing) Then\n            If ProjTask.Summary = False Then\n                If ProjTask.PercentComplete &lt;&gt; 100 And ProjTask.Finish &lt; Now() Then\n                    overdueTasks.Add ProjTask, ProjTask.UniqueID\n                End If\n            End If\n        End If\n    Next ProjTask\n    Set GetOverdueTasks = overdueTasks\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 2824, "user_id": 562155, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0431ea2b011b644d1574e2b11ffa75ea?s=128&d=identicon&r=PG", "display_name": "Karthick S", "link": "https://stackoverflow.com/users/562155/karthick-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593558584, "creation_date": 1538591246, "last_edit_date": 1593558584, "question_id": 52633528, "link": "https://stackoverflow.com/questions/52633528/return-a-list-of-overdue-non-summary-tasks-from-a-project-using-vba", "title": "Return a list of overdue non-summary tasks from a project using VBA", "body": "<p>I am trying to extract the list of overdue non-summary tasks from a project using VBA. Till now I have this code:</p>\n\n<pre><code>Function GetOverdueTasks() As Tasks\n    Dim ProjTasks As Tasks\n    Dim ProjTask As Task\n    Dim OverdueTasks As Tasks\n\n    Set ProjTasks = ActiveProject.Tasks\n    For Each ProjTask In ProjTasks\n        If Not (ProjTask Is Nothing) Then\n            If ProjTask.Summary = False Then\n                If ProjTask.PercentComplete &lt;&gt; 100 And ProjTask.Finish &lt; Now() Then\n                    OverdueTasks.Add (Task)\n                End If\n            End If\n        End If\n    Next ProjTask\n    Set GetOverdueTasks = OverdueTasks\nEnd Function\n</code></pre>\n\n<p>However, this fails in the line <code>OverdueTasks.Add (Task)</code> because the <code>Tasks</code> object <code>OverdueTasks</code> is not initialized. However, I am not able to find how to initialize the <code>Tasks</code> object. I tried using </p>\n\n<pre><code>Set OverdueTasks = New Tasks\n</code></pre>\n\n<p>But that fails with the Compile error \"Invalid use of New keyword\".</p>\n\n<p>Any suggestions on this would be very helpful.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 865, "user_id": 10361731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8873db235bacaa9d53de9c31a0b8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Jchang43", "link": "https://stackoverflow.com/users/10361731/jchang43"}, "edited": false, "score": 0, "creation_date": 1538589880, "post_id": 52633139, "comment_id": 92199563, "body": "If you&#39;ve found the address of the first match, you could alter the range of Match for the second one to start one cell after the location of the first"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1538590521, "post_id": 52633139, "comment_id": 92199880, "body": "What if there were <b>3</b> or <b>4</b> equivalent values ??"}, {"owner": {"reputation": 865, "user_id": 10361731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8873db235bacaa9d53de9c31a0b8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Jchang43", "link": "https://stackoverflow.com/users/10361731/jchang43"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1538591584, "post_id": 52633139, "comment_id": 92200350, "body": "@Gary&#39;sStudent You might have to do it within VBA and loop until the MATCH doesn&#39;t return a value. To determine how many cells you would have to reserve for each you could run a <code>countif(Range, &quot;=&quot; &amp; LARGE((J60:W60),1))</code>"}], "answers": [{"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 1, "last_activity_date": 1538592320, "last_edit_date": 1538592320, "creation_date": 1538592018, "answer_id": 52633727, "question_id": 52633139, "link": "https://stackoverflow.com/questions/52633139/how-to-find-adress-of-cells-for-1st-2nd-and-3rd-highest-values-when-values-cou/52633727#52633727", "title": "How to find adress of cells for 1st, 2nd, and 3rd highest values when values could be equal 1st=2nd", "body": "<p>You can use this type of formula to return an address:</p>\n\n<pre><code>=IFERROR(ADDRESS(ROW(lookupRow),AGGREGATE(14,6,1/(lookupRow&gt;=LARGE(lookupRow,limitRank))*COLUMN(lookupRow),ROWS($1:1))),\"\")\n</code></pre>\n\n<p>The named ranges should be obvious.\nEnter this in some cell and fill down until you see blanks.</p>\n\n<p>Not sure what you want to do with this information, but here is what this formula returns:</p>\n\n<p><a href=\"https://i.stack.imgur.com/sk8i2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sk8i2.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 343, "user_id": 9626171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9587856742de2015aec848c7749c4b15?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/9626171/jordan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594024628, "creation_date": 1538589711, "last_edit_date": 1594024628, "question_id": 52633139, "link": "https://stackoverflow.com/questions/52633139/how-to-find-adress-of-cells-for-1st-2nd-and-3rd-highest-values-when-values-cou", "title": "How to find adress of cells for 1st, 2nd, and 3rd highest values when values could be equal 1st=2nd", "body": "<p>I have situation where I need to search through a row of values, and use the cell address the top 3 largest of these values to reference the title cells above that particular cell. </p>\n\n<p>I have created this formula to find the top 3 highest value cell addresses, but when there are 2 equivalent values (like there are two top values of 25) it gives me the same cell reference twice. I understand they are equivalent, but I need to get the cell address of the second top value as well. Does anyone know how I can tweak this equation or possibly use vba to do this?</p>\n\n<pre><code>=CELL(\"address\",INDEX(J60:W60,MATCH(LARGE((J60:W60),1),J60:W60,0)))\n=CELL(\"address\",INDEX(J60:W60,MATCH(LARGE((J60:W60),2),J60:W60,0)))\n=CELL(\"address\",INDEX(J60:W60,MATCH(LARGE((J60:W60),3),J60:W60,0)))\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 2, "creation_date": 1538589761, "post_id": 52633069, "comment_id": 92199513, "body": "If there is an error, you will execute the <b>MsgBox</b>.  If there is no error, you will still execute the <b>MsgBox</b>"}], "answers": [{"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 1, "last_activity_date": 1538590034, "creation_date": 1538590034, "answer_id": 52633228, "question_id": 52633069, "link": "https://stackoverflow.com/questions/52633069/why-automatic-error-execution-on-excel-vba/52633228#52633228", "title": "Why automatic error execution on Excel VBA?", "body": "<p>Just because you have a \"Goto\" line defined, doesn't mean it will run only if called.  Add an <code>Exit Sub</code> before you define the error block, so the code will exit before then.</p>\n\n<p>You likely want something like:</p>\n\n<pre><code>Function aaaaaa() As Boolean\nIf [SOMETHING] Then \n    GoTo Error1\nElse\n    aaaaaa = True\nEnd If    \nExit Function\nError1:\n    MsgBox \"hi guys\"\n    Exit Function\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 9410048, "user_type": "registered", "profile_image": "https://graph.facebook.com/990260100984145/picture?type=large", "display_name": "Stefano", "link": "https://stackoverflow.com/users/9410048/stefano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 52633228, "answer_count": 1, "score": -3, "last_activity_date": 1594024636, "creation_date": 1538589500, "last_edit_date": 1594024636, "question_id": 52633069, "link": "https://stackoverflow.com/questions/52633069/why-automatic-error-execution-on-excel-vba", "title": "Why automatic error execution on Excel VBA?", "body": "<p>Why the execution of this function is giving me the error?</p>\n\n<pre><code>Function aaaaaa() As Boolean\n\nError1:\n    MsgBox \"hi guys\"\n    Exit Function\n\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/0iMzR.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0iMzR.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1538588261, "post_id": 52632535, "comment_id": 92198735, "body": "How about a &quot;null&quot; list, when the 1st dropdown is blank?"}, {"owner": {"reputation": 57, "user_id": 9145814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/089c6b34291f4fed4b5127791ad678f6?s=128&d=identicon&r=PG&f=1", "display_name": "Mr Halili", "link": "https://stackoverflow.com/users/9145814/mr-halili"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1538634661, "post_id": 52632535, "comment_id": 92213093, "body": "Thank you for your answer. If you mean a list with the name &quot;null&quot;, it cannot be done, since the list name is dependent on the value of the previous list."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1538656671, "post_id": 52632535, "comment_id": 92225683, "body": "I was thinking more of <code>if target=&quot;&quot; then: your data list =something else</code>"}, {"owner": {"reputation": 57, "user_id": 9145814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/089c6b34291f4fed4b5127791ad678f6?s=128&d=identicon&r=PG&f=1", "display_name": "Mr Halili", "link": "https://stackoverflow.com/users/9145814/mr-halili"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1538657319, "post_id": 52632535, "comment_id": 92226101, "body": "Thank you, I was managed to find a solution. Pls see my own answer to the post."}], "answers": [{"comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1538656547, "post_id": 52641251, "comment_id": 92225608, "body": "Good for you, nice find :) Does it always grab the first non-null value like you wanted?"}, {"owner": {"reputation": 57, "user_id": 9145814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/089c6b34291f4fed4b5127791ad678f6?s=128&d=identicon&r=PG&f=1", "display_name": "Mr Halili", "link": "https://stackoverflow.com/users/9145814/mr-halili"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1538657249, "post_id": 52641251, "comment_id": 92226051, "body": "It grabs the first row in the list even if it&#39;s a null. So If you want the second item which is not null, you should change it to (2,1)."}], "tags": [], "owner": {"reputation": 57, "user_id": 9145814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/089c6b34291f4fed4b5127791ad678f6?s=128&d=identicon&r=PG&f=1", "display_name": "Mr Halili", "link": "https://stackoverflow.com/users/9145814/mr-halili"}, "is_accepted": false, "score": 1, "last_activity_date": 1538638004, "creation_date": 1538638004, "answer_id": 52641251, "question_id": 52632535, "link": "https://stackoverflow.com/questions/52632535/how-to-populate-a-drop-down-list-by-vba-code/52641251#52641251", "title": "How to populate a drop down list by VBA code?", "body": "<p>I have found a solution in this forum. It should be:</p>\n\n<pre><code> = ThisWorkbook.Names(\"myNamedRange\").RefersToRange(1,1)\n</code></pre>\n\n<p>To get the value from the first cell in the named range \"myNamedRange\"</p>\n\n<p>link to the origin post: \n<a href=\"https://stackoverflow.com/questions/26242960/getting-a-value-from-a-named-range-in-vba\">Getting a value from a named range in VBA</a></p>\n\n<p>Thank you!</p>\n"}, {"tags": [], "owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "is_accepted": false, "score": 1, "last_activity_date": 1538658999, "creation_date": 1538658999, "answer_id": 52647731, "question_id": 52632535, "link": "https://stackoverflow.com/questions/52632535/how-to-populate-a-drop-down-list-by-vba-code/52647731#52647731", "title": "How to populate a drop down list by VBA code?", "body": "<p>just wanted to add a little bit to the answer you found so that you know how to grab the first non-blank value from that named range.</p>\n\n<pre><code>Sub FirstFilledInNamedRange()\n\n    Dim rng As Range\n    Set rng = ThisWorkbook.Names(\"myNamedRange\").RefersToRange\n\n    Dim val As String\n    val = rng.Find(What:=\"*\", After:=rng(rng.rows.count, rng.Columns.count)).Value2\n\n    MsgBox val\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 9145814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/089c6b34291f4fed4b5127791ad678f6?s=128&d=identicon&r=PG&f=1", "display_name": "Mr Halili", "link": "https://stackoverflow.com/users/9145814/mr-halili"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1002, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1591099170, "creation_date": 1538587438, "last_edit_date": 1591099170, "question_id": 52632535, "link": "https://stackoverflow.com/questions/52632535/how-to-populate-a-drop-down-list-by-vba-code", "title": "How to populate a drop down list by VBA code?", "body": "<p>The Target.Offset cell in the excel worksheet is a dynamic data validation drop down list (i.e. dependent on another drop down list). I want it to be populated with the first, or maybe the second item of its list, instead of Null. </p>\n\n<p>Any idea of a simple code?</p>\n\n<pre><code>     Target.Offset(0, 1).MergeArea.Value = Null \n</code></pre>\n"}, {"tags": ["excel", "vba", "formula"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 1, "creation_date": 1538587145, "post_id": 52632413, "comment_id": 92198156, "body": "I can see from your public profile that you have not taken the <a href=\"https://stackoverflow.com/\">tour</a> yet. I suggest you do so and also take the time to read <a href=\"https://stackoverflow.com/help/how-to-ask\">this</a>. Then come back and <a href=\"https://stackoverflow.com/posts/52632413/edit\">edit</a> your question to let us know what you&#39;ve tried so far and where the problem is, exactly."}], "answers": [{"tags": [], "owner": {"reputation": 540, "user_id": 7747667, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6XJn7.jpg?s=128&g=1", "display_name": "oxwilder", "link": "https://stackoverflow.com/users/7747667/oxwilder"}, "is_accepted": false, "score": 1, "last_activity_date": 1538588483, "creation_date": 1538588483, "answer_id": 52632817, "question_id": 52632413, "link": "https://stackoverflow.com/questions/52632413/vba-insert-a-formula-to-add-value-of-cell-to-another/52632817#52632817", "title": "VBA insert a formula to add value of cell to another", "body": "<p>This code would do that, you just need to have your command button run this sub:</p>\n\n<pre><code>Sub pasteLast()\n\nDim lrowG, lrowi As Integer\n\nlrowG = Cells(Rows.Count, 7).End(xlUp).Row\nlrowi = Cells(Rows.Count, 9).End(xlUp).Row\n\nCells(lrowi, 9).offset(1,0) = Range(\"s2\") + Cells(lrowG, 7)\n\nEnd Sub\n</code></pre>\n\n<p>just be careful because every time you click the button, it will add a value to column I whether it's unique or not. This would be better handled with a </p>\n\n<pre><code>Sub Worksheet_Change\n</code></pre>\n\n<p>event, where anytime S2 was changed it would add its value to column I.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 6035229, "user_type": "registered", "profile_image": "https://graph.facebook.com/10101722345338491/picture?type=large", "display_name": "Brett Rosequist", "link": "https://stackoverflow.com/users/6035229/brett-rosequist"}, "is_accepted": false, "score": 0, "last_activity_date": 1538589513, "creation_date": 1538589513, "answer_id": 52633073, "question_id": 52632413, "link": "https://stackoverflow.com/questions/52632413/vba-insert-a-formula-to-add-value-of-cell-to-another/52633073#52633073", "title": "VBA insert a formula to add value of cell to another", "body": "<p>Sounds like you need to find the last cell reference in column G, then go to 1 row past the last cell reference in column I, and as the cell reference in column G to S2.</p>\n\n<p>This should work:</p>\n\n<p>Sub addToI()</p>\n\n<pre><code>Dim gTarget As String\n\nRange(\"G1\").Select\nSelection.End(xlDown).Select\ngTarget = Selection.Address(ReferenceStyle:=xlR1C1)\n\nRange(\"I1\").Select\nSelection.End(xlDown).Select\nSelection.Offset(1, 0).Select\n\nActiveCell.FormulaR1C1 = \"=\" &amp; gTarget &amp; \"+R2C19\"\n</code></pre>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 41, "user_id": 10452634, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-oPdhWl4fmXQ/AAAAAAAAAAI/AAAAAAAAABk/dCQwc9Wa7UA/photo.jpg?sz=128", "display_name": "Cincinnati Kid", "link": "https://stackoverflow.com/users/10452634/cincinnati-kid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 422, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1538767504, "creation_date": 1538586971, "question_id": 52632413, "link": "https://stackoverflow.com/questions/52632413/vba-insert-a-formula-to-add-value-of-cell-to-another", "title": "VBA insert a formula to add value of cell to another", "body": "<p>Im trying and failing to create a VBA formula for a command button which will take the value of cell S2 and add it with the value of the last cell of column G (this column is constantly being added to therefor making the row different each time). I want to place the result in the last cell of column I (again it is always being added to).</p>\n\n<p>Help would be gratefully received, many thanks</p>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1538588452, "post_id": 52632357, "comment_id": 92198819, "body": "<code>Set SrchRng = wks.Cells(&quot;C2:AF&quot; &amp; Lrow)</code> should be <code>Set SrchRng = wks.Range(&quot;C2:AF&quot; &amp; Lrow)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 8543970, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Bag0e.jpg?s=128&g=1", "display_name": "Lando", "link": "https://stackoverflow.com/users/8543970/lando"}, "edited": false, "score": 0, "creation_date": 1538587642, "post_id": 52632471, "comment_id": 92198410, "body": "I might be missing something. I followed your example and closed with &quot;End if&quot; and &quot;Next&quot; statements but I get Error5: Invalid procedure call or argument."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 85, "user_id": 8543970, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Bag0e.jpg?s=128&g=1", "display_name": "Lando", "link": "https://stackoverflow.com/users/8543970/lando"}, "edited": false, "score": 0, "creation_date": 1538587783, "post_id": 52632471, "comment_id": 92198477, "body": "On which line ?"}, {"owner": {"reputation": 85, "user_id": 8543970, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Bag0e.jpg?s=128&g=1", "display_name": "Lando", "link": "https://stackoverflow.com/users/8543970/lando"}, "edited": false, "score": 0, "creation_date": 1538588067, "post_id": 52632471, "comment_id": 92198621, "body": "First line. wks.Cells(&quot;C2:AF&quot; &amp; Lrow) = &lt;Invalid procedure call or argument&gt;"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 85, "user_id": 8543970, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Bag0e.jpg?s=128&g=1", "display_name": "Lando", "link": "https://stackoverflow.com/users/8543970/lando"}, "edited": false, "score": 0, "creation_date": 1538588145, "post_id": 52632471, "comment_id": 92198673, "body": "That is directly from your original post: I only addressed the part you siad you were having a problem with.  If you&#39;re having a problem with other parts then you need to post the rest of your code."}, {"owner": {"reputation": 85, "user_id": 8543970, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Bag0e.jpg?s=128&g=1", "display_name": "Lando", "link": "https://stackoverflow.com/users/8543970/lando"}, "edited": false, "score": 0, "creation_date": 1538588195, "post_id": 52632471, "comment_id": 92198698, "body": "I use that same line throughout my code with no issues. I&#39;ll post the rest of my code. Thanks Tim."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 85, "user_id": 8543970, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Bag0e.jpg?s=128&g=1", "display_name": "Lando", "link": "https://stackoverflow.com/users/8543970/lando"}, "edited": false, "score": 0, "creation_date": 1538588253, "post_id": 52632471, "comment_id": 92198728, "body": "Should be <code>wks.Range(&quot;C2:AF&quot; &amp; Lrow)</code>"}, {"owner": {"reputation": 85, "user_id": 8543970, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Bag0e.jpg?s=128&g=1", "display_name": "Lando", "link": "https://stackoverflow.com/users/8543970/lando"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1538588643, "post_id": 52632471, "comment_id": 92198916, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/181241/discussion-between-lando-and-tim-williams\">continue this discussion in chat</a>."}, {"owner": {"reputation": 85, "user_id": 8543970, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Bag0e.jpg?s=128&g=1", "display_name": "Lando", "link": "https://stackoverflow.com/users/8543970/lando"}, "edited": false, "score": 0, "creation_date": 1538590490, "post_id": 52632471, "comment_id": 92199871, "body": "Ok, sorry the site recommended I do that. I get error1004: &#39;Range&#39; of object &#39;_Worksheet&#39; failed I posted my entire code for you to see.I use wks.Cells elsewhere without issue. It&#39;s only here."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 85, "user_id": 8543970, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Bag0e.jpg?s=128&g=1", "display_name": "Lando", "link": "https://stackoverflow.com/users/8543970/lando"}, "edited": false, "score": 0, "creation_date": 1538591672, "post_id": 52632471, "comment_id": 92200387, "body": "You can&#39;t use <code>Cells</code> like that with a single string argument."}, {"owner": {"reputation": 85, "user_id": 8543970, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Bag0e.jpg?s=128&g=1", "display_name": "Lando", "link": "https://stackoverflow.com/users/8543970/lando"}, "edited": false, "score": 0, "creation_date": 1538593276, "post_id": 52632471, "comment_id": 92201228, "body": "Then I&#39;m sorry. I&#39;m not sure how to qualify the object. How do I dim the object?"}, {"owner": {"reputation": 85, "user_id": 8543970, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Bag0e.jpg?s=128&g=1", "display_name": "Lando", "link": "https://stackoverflow.com/users/8543970/lando"}, "edited": false, "score": 0, "creation_date": 1538798257, "post_id": 52632471, "comment_id": 92280494, "body": "It took me forever to figure this out, but I finally got it to work by removing the &quot;.Address&quot; from the end of the statement corrected &quot;Cell.Column&quot; to &quot;Cel.Column&quot; I got it working though!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1538802945, "last_edit_date": 1538802945, "creation_date": 1538587172, "answer_id": 52632471, "question_id": 52632357, "link": "https://stackoverflow.com/questions/52632357/in-srchrng-if-cell-contains-data-paste-formula-to-the-right/52632471#52632471", "title": "In SrchRng, If Cell Contains Data, Paste Formula To The Right", "body": "<p>You need to set the <code>Formula</code> property, and the formula needs to be parseable </p>\n\n<p>Something like this:</p>\n\n<pre><code>Dim SrchRng As Range, Cel As Range\nDim wks As Excel.Worksheet\nSet SrchRng = wks.Range(\"C2:AF\" &amp; Lrow).Cells 'edit: \"Cells()\" &gt;&gt; \"Range()\"\nFor Each Cel In SrchRng\n     If Cel.Value &lt;&gt; \"\" Then\n          Cel.Offset(0,1).Formula = _\n              \"=\" &amp; Cel.Address &amp; \"/\" &amp; wks.Cells(Lrow +1, Cel.Column).address\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 8543970, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Bag0e.jpg?s=128&g=1", "display_name": "Lando", "link": "https://stackoverflow.com/users/8543970/lando"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 52632471, "answer_count": 1, "score": 0, "last_activity_date": 1594627771, "creation_date": 1538586765, "last_edit_date": 1594627771, "question_id": 52632357, "link": "https://stackoverflow.com/questions/52632357/in-srchrng-if-cell-contains-data-paste-formula-to-the-right", "title": "In SrchRng, If Cell Contains Data, Paste Formula To The Right", "body": "<p>I'm working on a VBA function in Access to output a spreadsheet. Unfortunately, I'm not finding any resources online that can help with what I would like to do. </p>\n\n<p>My information is output in columns (\"A2:AF\" &amp; Lrow). \"Lrow\" defines the last row of the information. \"Lrow +1\" is where I have a formula totaling everything in each column. </p>\n\n<p>I'd like to search (\"C2:AF\" &amp; Lrow) for cells that &lt;> \"\" and paste a formula (Offset 0,1) to divide that cell by the total in \"Lrow +1\". For example, in my picture, there is data (225.060) in C4. I am trying to paste a formula in D4 to divide C4 by C11 (or Lrow +1 since Lrow changes each time I output a spreadsheet)</p>\n\n<p>Here is the code I have so far, but I'm stuck on the formula part:</p>\n\n<pre><code>Dim SrchRng As Range, Cel As Range\nDim wks As Excel.Worksheet\nSet SrchRng = wks.Cells(\"C2:AF\" &amp; Lrow)\nFor Each Cel In SrchRng\n     If Cel.Value &lt;&gt; \"\" Then\n          Cel.Offset(0,1).Value = \"=Cel.Value/(???)\"\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/87E1j.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/87E1j.png\" alt=\"enter image description here\"></a></p>\n\n<p>Tim Williams suggested I add my entire code because I'm getting an error with the first line of his answer. I get Error5: Invalid procedure call or argument.</p>\n\n<pre><code>Private Sub Command19_Click()\n'Export to Excel\nDim rs1 As DAO.Recordset, rs2 As DAO.Recordset, rs3 As DAO.Recordset, rs4 \nAs DAO.Recordset\nDim qdf As DAO.QueryDef\nDim prm As DAO.Parameter\nDim cnt As Integer\nDim SrchRng As Range, Cel As Range\nDim Lrow As Long, Lrow1 As Long\n\nDim appExcel As Excel.Application\nDim wbk As Excel.Workbook\nDim wks As Excel.Worksheet\nDim rng, rng1 As Excel.Range\n\nSet db = CurrentDb\nSet appExcel = Excel.Application\nSet wbk = appExcel.Workbooks.Add\nSet wks = wbk.Worksheets(1)\nSet rng = wks.Range(\"A2\")\n\nappExcel.Visible = False\n\ncnt = 1\n\nSet qdf = CurrentDb.QueryDefs(\"qry_Comparison_Bulk\")\nFor Each prm In qdf.Parameters\nprm.Value = Eval(prm.Name)\nNext\n\nSet rs1 = qdf.OpenRecordset()\n\nFor Each fld In rs1.Fields\n    wks.Cells(1, cnt).Value = fld.Name\n    cnt = cnt + 1\nNext fld\nCall rng.CopyFromRecordset(rs1, 4000, 26)\n\nqdf.Close\nrs1.Close\nSet rs1 = Nothing\nSet qdf = Nothing\n\nFor Colx = 4 To 26 Step 2\nColumns(Colx).Insert Shift:=xlToRight\nNext\n\nSet SrchRng = wks.Cells(\"C2:AF\" &amp; Lrow)\nFor Each Cel In SrchRng\nIf Cel.Value &lt;&gt; \"\" Then\n    Cel.Offset(0, 1).Formula = \"=\" &amp; Cel.Address &amp; \"/\" &amp; wks.Cells(Lrow +1, Cell.Column).Address\nEnd If\nNext\n\n'Identifies the last row and row beneath it\n\nLrow = wks.Cells(Rows.Count, \"A\").End(xlUp).Row\nLrow1 = wks.Cells(Rows.Count, \"A\").End(xlUp).Row + 1\n\n'Everything below is formatting\n\nWith wks.Range(\"A\" &amp; Lrow1, \"AF\" &amp; Lrow1)\n.Font.Bold = True\n.Font.ColorIndex = 2\n.Interior.ColorIndex = 16\n.HorizontalAlignment = xlRight\nEnd With\n\nWith wks.Range(\"C2:AE\" &amp; Lrow)\n.NumberFormat = \"0.000\"\nEnd With\n\nwks.Cells(Lrow1, \"C\").Formula = \"=SUM(C2:C\" &amp; Lrow &amp; \")\"\nwks.Cells(Lrow1, \"E\").Formula = \"=SUM(E2:E\" &amp; Lrow &amp; \")\"\nwks.Cells(Lrow1, \"G\").Formula = \"=SUM(G2:G\" &amp; Lrow &amp; \")\"\nwks.Cells(Lrow1, \"I\").Formula = \"=SUM(I2:I\" &amp; Lrow &amp; \")\"\nwks.Cells(Lrow1, \"K\").Formula = \"=SUM(K2:K\" &amp; Lrow &amp; \")\"\nwks.Cells(Lrow1, \"M\").Formula = \"=SUM(M2:M\" &amp; Lrow &amp; \")\"\nwks.Cells(Lrow1, \"O\").Formula = \"=SUM(O2:O\" &amp; Lrow &amp; \")\"\nwks.Cells(Lrow1, \"Q\").Formula = \"=SUM(Q2:Q\" &amp; Lrow &amp; \")\"\nwks.Cells(Lrow1, \"S\").Formula = \"=SUM(S2:S\" &amp; Lrow &amp; \")\"\nwks.Cells(Lrow1, \"U\").Formula = \"=SUM(U2:U\" &amp; Lrow &amp; \")\"\nwks.Cells(Lrow1, \"W\").Formula = \"=SUM(W2:W\" &amp; Lrow &amp; \")\"\nwks.Cells(Lrow1, \"Y\").Formula = \"=SUM(Y2:Y\" &amp; Lrow &amp; \")\"\nwks.Cells(Lrow1, \"AA\").Formula = \"=SUM(AA2:AA\" &amp; Lrow &amp; \")\"\nwks.Cells(Lrow1, \"AC\").Formula = \"=SUM(AC2:AC\" &amp; Lrow &amp; \")\"\nwks.Cells(Lrow1, \"AE\").Formula = \"=SUM(AE2:AE\" &amp; Lrow &amp; \")\"\nwks.Cells(Lrow1, \"B\").Formula = \"TOTAL (MG)\"\n\nWith wks.Range(\"A1:AF1\")\n.Font.Bold = True\n.Font.ColorIndex = 2\n.Interior.ColorIndex = 16\n.NumberFormat = \"@\"\n.HorizontalAlignment = xlCenter\n.EntireColumn.AutoFit\nEnd With\n\nappExcel.Visible = True\n\n\nEnd Sub\n</code></pre>\n\n<p>enter code here</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 4, "creation_date": 1538586751, "post_id": 52632310, "comment_id": 92197939, "body": "<code>ActiveSheet</code> should only be used when absolutely necessary, and that is <i>rarely</i> the case. Use this instead. <code>Set DestSh = ThisWorkbook.Worksheets(&quot;Consolidated Tracker&quot;)</code>"}, {"owner": {"reputation": 267, "user_id": 9686961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ce1a2d5f072b7ccfff3be94f74e5bbb?s=128&d=identicon&r=PG&f=1", "display_name": "L23P", "link": "https://stackoverflow.com/users/9686961/l23p"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1538589616, "post_id": 52632310, "comment_id": 92199432, "body": "Thanks for the advice @ScottHoltzman I might be being dumb now (it&#39;s been a long day) but I&#39;m trying what you&#39;ve said with <code>.Range(&quot;B4&quot;)</code> added to the end as I want the data pasted in cell B4 after all but I&#39;m getting a type mismatch error I think because I&#39;m trying to use a cell reference with <code>DestSh</code> when it&#39;s been set as a Worksheet. I thought .Range would append the cell reference without interacting with the parent variable. Can I never use <code>DestSh</code> to specify a cell because it&#39;s set as a worksheet?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 2, "creation_date": 1538592335, "post_id": 52632310, "comment_id": 92200754, "body": "You cannot set a worksheet variable to a range object. you need to set a range variable for that. But you can write <code>DestSh.Range(&quot;B4&quot;)</code> directly in the code."}, {"owner": {"reputation": 267, "user_id": 9686961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ce1a2d5f072b7ccfff3be94f74e5bbb?s=128&d=identicon&r=PG&f=1", "display_name": "L23P", "link": "https://stackoverflow.com/users/9686961/l23p"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1538595132, "post_id": 52632310, "comment_id": 92202114, "body": "I&#39;ve used <code>ThisWorkbook.ActiveSheet.Range(&quot;B4&quot;).Resize(.Rows.Count, .Columns.Count) = .Value</code> elsewhere and it work however I get an invalid use of property error when trying <code>Set DestSh.Range(&quot;B4&quot;) = ThisWorkbook.Worksheets(&quot;Consolidated Tracker&quot;)</code> thoughts?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1538595393, "post_id": 52632310, "comment_id": 92202223, "body": "Leave <code>Set DestSh =  ThisWorkbook.Worksheets(&quot;Consolidated Tracker&quot;)</code> alone. When you want to refer to <code>B4</code> in the code write <code>DestSh.Range(&quot;B4&quot;)</code>. For example, ``DestSh.Range(&quot;B4&quot;).Value = &quot;AValue&quot;` or <code>Set myRange = DestSh.Range(&quot;B4&quot;)</code>"}, {"owner": {"reputation": 267, "user_id": 9686961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ce1a2d5f072b7ccfff3be94f74e5bbb?s=128&d=identicon&r=PG&f=1", "display_name": "L23P", "link": "https://stackoverflow.com/users/9686961/l23p"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1538606321, "post_id": 52632310, "comment_id": 92206318, "body": "@ScottHoltzman spent some time playing around, I&#39;ve updated the OP. It&#39;s now sort of working, just nothing is copying over from <code>Set CopyRng = sh.Range(&quot;B4:B50&quot;)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 1, "last_activity_date": 1538661134, "creation_date": 1538661134, "answer_id": 52648501, "question_id": 52632310, "link": "https://stackoverflow.com/questions/52632310/copying-consolidating-data-from-multiple-worksheets-into-activeworksheet/52648501#52648501", "title": "Copying Consolidating Data from Multiple Worksheets into .ActiveWorksheet", "body": "<p>The issue is that the code never actually execute any type of command to move the data. The code only sets variables.</p>\n\n<p>Look at the modified code below, specifically the last line before the End With.</p>\n\n<pre><code>' Specify the range to place the data.\nSet CopyRng = sh.Range(\"B4:B50\")\n\n' This statement copies values\nWith CopyRng\n    Set DestSh = ThisWorkbook.Worksheets(\"Consolidated Tracker\")\n    DestSh.Range(\"B4\").Resize(CopyRng.Rows.Count,1).Value = CopyRng.Value\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 267, "user_id": 9686961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ce1a2d5f072b7ccfff3be94f74e5bbb?s=128&d=identicon&r=PG&f=1", "display_name": "L23P", "link": "https://stackoverflow.com/users/9686961/l23p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 52648501, "answer_count": 1, "score": 0, "last_activity_date": 1538661134, "creation_date": 1538586570, "last_edit_date": 1538606257, "question_id": 52632310, "link": "https://stackoverflow.com/questions/52632310/copying-consolidating-data-from-multiple-worksheets-into-activeworksheet", "title": "Copying Consolidating Data from Multiple Worksheets into .ActiveWorksheet", "body": "<p>I've been working from <a href=\"https://docs.microsoft.com/en-us/previous-versions/office/developer/office-2007/cc793964(v=office.12)\" rel=\"nofollow noreferrer\">this</a> article to try and consolidate data from multiple worksheets into a single summary worksheet. I've nearly got it working but I'm struggling to alter the destination worksheet.</p>\n\n<p>I'm trying to have the consolidated data appear into cell <code>B4</code> on the <code>Consolidated Tracker</code> sheet.</p>\n\n<pre><code> With CopyRng\n\n         Set DestSh = ThisWorkbook.Worksheets(\"Consolidated Tracker\")\n         Set myRange = DestSh.Range(\"B4\")\n\n End With\n</code></pre>\n\n<p>Problem is myRange is always empty and nothing is copied over.</p>\n\n<p>No error, seems to execute <code>f8</code> as expected without copying anything over.</p>\n\n<hr>\n\n<p>Full Code for reference:</p>\n\n<pre><code>Sub CopyRangeFromMultiWorksheets()\n\n    Dim sh As Worksheet\n    Dim DestSh As Worksheet\n    Dim Last As Long\n    Dim CopyRng As Range\n\n    With Application\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n\n    ' Loop through all worksheets and copy the data to the\n    ' summary worksheet.\n    For Each sh In ActiveWorkbook.Worksheets\n\n            ' Find the last row with data on the summary worksheet.\n            Last = LastRow(DestSh)\n\n            ' Specify the range to place the data.\n            Set CopyRng = sh.Range(\"B4:B50\")\n\n            ' This statement copies values\n            With CopyRng\n                 Set DestSh = ThisWorkbook.Worksheets(\"Consolidated Tracker\")\n                 Set myRange = DestSh.Range(\"B4\")\n            End With\n\n        'End If\n    Next\n\nExitTheSub:\n\n    Application.Goto DestSh.Cells(4, 2)\n\n    ' AutoFit the column width in the summary sheet.\n    DestSh.Columns.AutoFit\n\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n    End With\nEnd Sub    \n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1538586890, "post_id": 52632191, "comment_id": 92198009, "body": "Explicitly give the <code>Range</code> objects a worksheet, otherwise it&#39;s going to use the <code>Range()</code> on the <code>ActiveSheet</code>, whatever that may be.  So, I assume your ranges are all on the sheet &quot;Tab Names&quot; - add <code>Worksheets(&quot;Tab Names&quot;).</code> before each <code>Range()</code> call:  <code>Worksheets(&quot;Tab Names&quot;).Range(Worksheets(&quot;Tab Names&quot;).Range(&quot;A1&quot;), Worksheets(&quot;Tab Names&quot;).Range(&quot;A1&quot;)...</code>  (You can of course use a <code>With</code> statement to make that shorter)"}, {"owner": {"reputation": 15, "user_id": 10452607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af55dcb192a91b52f7d6aabf38486cc8?s=128&d=identicon&r=PG&f=1", "display_name": "Hoganator", "link": "https://stackoverflow.com/users/10452607/hoganator"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1538591922, "post_id": 52632191, "comment_id": 92200534, "body": "Thanks so much that makes sense"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 10452607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af55dcb192a91b52f7d6aabf38486cc8?s=128&d=identicon&r=PG&f=1", "display_name": "Hoganator", "link": "https://stackoverflow.com/users/10452607/hoganator"}, "edited": false, "score": 0, "creation_date": 1538591912, "post_id": 52632437, "comment_id": 92200525, "body": "Thank you! There are over 300 tabs on here, not counting the ones that I would need to bring over so it would be a lot to cycle through all the tabs. This is great to know for those cases that I would need that"}], "tags": [], "owner": {"reputation": 968, "user_id": 5910169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a40180e3fa49fbf4e55145adf54d9?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Ball", "link": "https://stackoverflow.com/users/5910169/frank-ball"}, "is_accepted": false, "score": 0, "last_activity_date": 1538587066, "creation_date": 1538587066, "answer_id": 52632437, "question_id": 52632191, "link": "https://stackoverflow.com/questions/52632191/looping-through-a-list-and-changing-data-into-tables/52632437#52632437", "title": "Looping through a list and changing data into tables", "body": "<p>Try this:</p>\n\n<pre><code>Sub TabstoTables()\nDim sht As Worksheet\nDim tbl As ListObject\nDim rng As Range\n\nOn Error GoTo Err\n    Application.ScreenUpdating = False\n    For Each sht In ActiveWorkbook.Sheets\n        rng = sht.UsedRange\n        Set tbl = ActiveSheet.ListObjects.Add(xlSrcRange, rng, , xlYes)\n        tbl.TableStyle = \"TableStyleMedium15\"\n    Next sht\n    Application.ScreenUpdating = True\n    Exit Sub\nErr:\n    Application.ScreenUpdating = True\n    MsgBox \"There was an error\"\nEnd Sub\n</code></pre>\n\n<p>You can iterate through the Sheets themselves and not have to have the list of sheet names.</p>\n\n<p>Also, notice the \"On Error\" and the code following \"Err:\".  This handles resetting Application.ScreenUpdating = True if there is an error in your process.  With the way your code is currently written, if it failed somewhere along the line, your ScreenUpdating would be stuck at False and now you're in a really bad state.</p>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 10452607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af55dcb192a91b52f7d6aabf38486cc8?s=128&d=identicon&r=PG&f=1", "display_name": "Hoganator", "link": "https://stackoverflow.com/users/10452607/hoganator"}, "edited": false, "score": 0, "creation_date": 1538591966, "post_id": 52632443, "comment_id": 92200564, "body": "This worked like a charm, appreciate all the help! I was having the error that BruceWayne mentioned above..just needed it to reference the actual sheet I wanted. Appreciate it"}, {"owner": {"reputation": 15, "user_id": 10452607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af55dcb192a91b52f7d6aabf38486cc8?s=128&d=identicon&r=PG&f=1", "display_name": "Hoganator", "link": "https://stackoverflow.com/users/10452607/hoganator"}, "edited": false, "score": 0, "creation_date": 1539019805, "post_id": 52632443, "comment_id": 92340946, "body": "Hello, I am trying to use this on the full range and am getting &quot;subscript out of range&quot; error for line: Set TargetSheet = Worksheets(CStr(tablename)). Any idea on how to fix this?? Thank you!"}], "tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": true, "score": 0, "last_activity_date": 1538587081, "creation_date": 1538587081, "answer_id": 52632443, "question_id": 52632191, "link": "https://stackoverflow.com/questions/52632191/looping-through-a-list-and-changing-data-into-tables/52632443#52632443", "title": "Looping through a list and changing data into tables", "body": "<p>Here is your code with a few changes:</p>\n\n<pre><code>Sub TabstoTables()\n\n    Dim tablename As Variant\n    Dim TargetSheet As Worksheet\n    Dim tbl As ListObject\n    Dim rng As Range       \n\n    For Each tablename In Sheets(\"Tab Names\").Range(\"A1:A2\")\n        Set TargetSheet = Worksheets(CStr(tablename))\n        Set rng = Range(TargetSheet.Range(\"A1\"), TargetSheet.Range(\"A1\").SpecialCells(xlLastCell))\n        Set tbl = TargetSheet.ListObjects.Add(xlSrcRange, rng, , xlYes)\n        tbl.TableStyle = \"TableStyleMedium15\"     \n    Next tablename\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 10452607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af55dcb192a91b52f7d6aabf38486cc8?s=128&d=identicon&r=PG&f=1", "display_name": "Hoganator", "link": "https://stackoverflow.com/users/10452607/hoganator"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 52632443, "answer_count": 2, "score": 0, "last_activity_date": 1538587081, "creation_date": 1538586090, "last_edit_date": 1538586458, "question_id": 52632191, "link": "https://stackoverflow.com/questions/52632191/looping-through-a-list-and-changing-data-into-tables", "title": "Looping through a list and changing data into tables", "body": "<p>Beginner VBA here. As part of a larger macro, I am bringing in sheets from another workbook after an earlier process is done (I have finished this part), but I then want to change the data brought in into tables. Because there are hundreds of tabs in this workbook, I think having a list of tab names to do a loop through would be the easiest option. I have the below but cannot seem to get it to work. I think the only thing I am missing is to activate whatever sheet it is selecting. (There will be more than A1:A2, I am just using a smaller range to test):</p>\n\n<pre><code>Sub TabstoTables()\n\n    Dim tablename As Range\n    Dim tbl As ListObject\n    Dim rng As Range\n\n    Application.ScreenUpdating = False\n\n    For Each tablename In Sheets(\"Tab Names\").Range(\"A1:A2\")\n\n        Set rng = Range(Range(\"A1\"), Range(\"A1\").SpecialCells(xlLastCell))\n        Set tbl = ActiveSheet.ListObjects.Add(xlSrcRange, rng, , xlYes)\n        tbl.TableStyle = \"TableStyleMedium15\"\n\n    Next tablename\nEnd Sub\n</code></pre>\n\n<p>Appreciate any help!! Thanks so much </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1538586156, "post_id": 52632173, "comment_id": 92197645, "body": "can you please indent your code properly and repost. it&#39;s not fun to try and read it as presented."}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1538586238, "post_id": 52632173, "comment_id": 92197685, "body": "Try changing <code>UBound(arrFlight)</code> to <code>UBound(arrFlight, 1)</code>. If that fixes it, I&#39;ll post an explanation on why."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1538586250, "post_id": 52632173, "comment_id": 92197695, "body": "You get RTE because your code never reaches <code>ReDim Preserve arrFlight(j)</code>"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1538586342, "post_id": 52632173, "comment_id": 92197745, "body": "move <code>j = j + 1</code> after <code>arrFlight(j) = WS.Cells(i + 10, 3).Value</code>, as is you are never setting the <code>0</code> value of the array. Array&#39;s are zero-based in VBA by default unless you explicitly instruction <code>Option Base 1</code>. That may not solve your issue, but will help you not have another one :) Also, it will ensure there are no emtpy values in arrFlights. Also, does the code do you as you expect if you run through it line-by-line? If you have not done this, please do so. You&#39;ll surely find your issue that way."}, {"owner": {"reputation": 1, "user_id": 7743712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4335166e9f36e8226c71cfc36098f5dd?s=128&d=identicon&r=PG&f=1", "display_name": "TT052", "link": "https://stackoverflow.com/users/7743712/tt052"}, "reply_to_user": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1538632585, "post_id": 52632173, "comment_id": 92212179, "body": "@Mistella: that doesn&#39;t work, actually if i leave out the UBound(arrFlight) the sub will work as normally"}, {"owner": {"reputation": 1, "user_id": 7743712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4335166e9f36e8226c71cfc36098f5dd?s=128&d=identicon&r=PG&f=1", "display_name": "TT052", "link": "https://stackoverflow.com/users/7743712/tt052"}, "reply_to_user": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1538632758, "post_id": 52632173, "comment_id": 92212244, "body": "@Storax i think my code reaches the Redim, but there is something in the looping making the msgBox fail"}, {"owner": {"reputation": 1, "user_id": 7743712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4335166e9f36e8226c71cfc36098f5dd?s=128&d=identicon&r=PG&f=1", "display_name": "TT052", "link": "https://stackoverflow.com/users/7743712/tt052"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1538632825, "post_id": 52632173, "comment_id": 92212263, "body": "@ScottHoltzman could you instruct me how to complete that? as a newbie i am really amateur in coding"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1538633059, "post_id": 52632173, "comment_id": 92212367, "body": "@TT052: I&#39;d suggest to add a <a href=\"https://www.thespreadsheetguru.com/blog/2014/4/8/debugging-vba-code-adding-breakpoints\" rel=\"nofollow noreferrer\">breakpoint</a> in the line <code>ReDim Preserve arrFlight(j)</code> and I&#39;d also suggest to use my function. I am quite sure the array has not been allocated and the reason is that your code never reaches the line above."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1538660842, "post_id": 52632173, "comment_id": 92228509, "body": "@TT052 - <a href=\"https://www.excel-easy.com/vba/examples/debugging.html\" rel=\"nofollow noreferrer\">how to debug VBA code</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7743712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4335166e9f36e8226c71cfc36098f5dd?s=128&d=identicon&r=PG&f=1", "display_name": "TT052", "link": "https://stackoverflow.com/users/7743712/tt052"}, "edited": false, "score": 0, "creation_date": 1538668773, "post_id": 52632331, "comment_id": 92233784, "body": "what do you meaning by saying that the array has not been allocated? i actually do not understand the logic behinds this"}], "tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": false, "score": 0, "last_activity_date": 1538669184, "last_edit_date": 1538669184, "creation_date": 1538586666, "answer_id": 52632331, "question_id": 52632173, "link": "https://stackoverflow.com/questions/52632173/subscript-out-of-range-in-looping-vba/52632331#52632331", "title": "subscript out of range in looping vba", "body": "<p>For preventing run time error 9 you could check if the array has been allocated and show the MsgBox if that is the case</p>\n\n<pre><code>If IsArrayAllocated(arrFlight) Then\n    MsgBox UBound(arrFlight)    ' &lt;&lt;---SCRIPT OUT OF RANGE EMERGED HERE**\nEnd If\n</code></pre>\n\n<p>I used the function IsArrayAllocated found <a href=\"http://www.cpearson.com/excel/isarrayallocated.aspx\" rel=\"nofollow noreferrer\">here</a></p>\n\n<pre><code>Function IsArrayAllocated(Arr As Variant) As Boolean\n    On Error Resume Next\n    IsArrayAllocated = IsArray(Arr) And _\n                       Not IsError(LBound(Arr, 1)) And _\n                       LBound(Arr, 1) &lt;= UBound(Arr, 1)\nEnd Function\n</code></pre>\n\n<p><strong>Update</strong> Quote from link provided above to explain <em>alloacted</em>  </p>\n\n<blockquote>\n  <p>There are two types of arrays: static arrays, in which the dimensions\n  of the array are set in the Dim statement, and dynamic arrays, in\n  which the array is allocated and dimensioned with the ReDim statement.\n  An array is said to be allocated if it consumes memory, has valid\n  lower and upper bounds, and contains data (even if that data is the\n  default values for the data type of the array, such as empty strings\n  of an array of String type variables). A static array is by definition\n  always allocated. You can never resize, reallocate, deallocate, or\n  release the memory consumed by a static array. With a dynamic array,\n  however, you can resizse, reallocate, deallocate, and release the\n  memory of the array. (A Varaint type variable that contains an array\n  always contains a dynamic array.)</p>\n</blockquote>\n"}], "owner": {"reputation": 1, "user_id": 7743712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4335166e9f36e8226c71cfc36098f5dd?s=128&d=identicon&r=PG&f=1", "display_name": "TT052", "link": "https://stackoverflow.com/users/7743712/tt052"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 229, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1538669184, "creation_date": 1538586024, "last_edit_date": 1538594536, "question_id": 52632173, "link": "https://stackoverflow.com/questions/52632173/subscript-out-of-range-in-looping-vba", "title": "subscript out of range in looping vba", "body": "<p>could you help me out to deal with this issue, \nIf the excel worksheet has date value then whenever i want call Ubound or Lbound of an array that i defined, there is an error called \"Subscript out of range\". The specific code that i wrote in VBA is like this:</p>\n\n<pre><code>Sub conditiondate()\n    Dim i As Integer\n    Dim WS As Worksheet\n    Dim WB As Workbook\n\n    Dim Proinv As Workbook\n    Dim ProinvPath As String\n    Dim Proinvtemp As Workbook\n    Dim arrFlight() As Variant\n\n    Dim NewArray2 As Variant\n    Dim lngIndex2 As Integer\n    Dim lngNItems2 As Integer\n\n    Dim n As Integer\n    'Dim newarr As Variant\n    Dim j As Integer\n\n    Set WB = Application.ActiveWorkbook\n\n\n    startingdate = Worksheets(1).Range(\"C3\")     'From\n    endingdate = Worksheets(1).Range(\"C4\")       'To\n\n\n    For Each WS In Worksheets\n        i = 1\n        j = 0\n        Do\n            i = i + 1\n            j = j + 1\n            If WS.Cells(i + 10, 3) &gt;= startingdate And WS.Cells(i + 10, 3) &lt;= endingdate Then\n\n                WS.Cells(i + 10, 3).Font.Color = vbRed\n\n                WS.Cells(i + 10, 3).Offset(0, 13) = \"issued\"\n\n                ReDim Preserve arrFlight(j)\n\n                arrFlight(j) = WS.Cells(i + 10, 3).Value\n            Else\n\n                WS.Cells(i + 10, 3).Font.Color = vbBlue\n\n            End If\n\n        Loop Until i = 200\n\n        MsgBox UBound(arrFlight)                 ' &lt;&lt;---SCRIPT OUT OF RANGE EMERGED HERE**\n    Next WS\n\nend Sub\n</code></pre>\n\n<p>thanks for your help</p>\n"}, {"tags": ["vba", "excel-2010", "activex"], "comments": [{"owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 1, "creation_date": 1538585597, "post_id": 52632028, "comment_id": 92197376, "body": "Try adding Application.EnableEvents = False at the start of the function and then setting it back to true at the end.  Setting it back to true is <i>very</i> important!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 0, "creation_date": 1538588819, "post_id": 52632028, "comment_id": 92199003, "body": "@sous2817 <code>Application.EnableEvents</code> controls Excel <code>Worksheet</code> and <code>Workbook</code> events, it has no bearing on ActiveX handlers for a listbox."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1538589087, "post_id": 52632028, "comment_id": 92199122, "body": "Where&#39;s the <code>MsgBox</code> prompt?"}, {"owner": {"reputation": 355, "user_id": 9841207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc5da3d361f6c331926b8f161bb67d9c?s=128&d=identicon&r=PG&f=1", "display_name": "User", "link": "https://stackoverflow.com/users/9841207/user"}, "edited": false, "score": 0, "creation_date": 1538589665, "post_id": 52632028, "comment_id": 92199464, "body": "I have a function called checkChangeQuestion inside of question_click. checkChangeQuestion will prompt the user check if I should be giving the user the warning or not then handling yes or no."}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1538588754, "post_id": 52632358, "comment_id": 92198971, "body": "I would strongly advise against invoking event handlers like this. Event handlers are invoked by an event source, period. Extract a method out of it, make the handler invoke that method, and then call <i>that extracted method</i> instead. Don&#39;t invoke event handlers. Event handlers handle events, they&#39;re implementation details, not public interface. Also the parentheses are superfluous, and actually harmful if there are arguments to pass."}, {"owner": {"reputation": 355, "user_id": 9841207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc5da3d361f6c331926b8f161bb67d9c?s=128&d=identicon&r=PG&f=1", "display_name": "User", "link": "https://stackoverflow.com/users/9841207/user"}, "edited": false, "score": 0, "creation_date": 1538591352, "post_id": 52632358, "comment_id": 92200253, "body": "The issue though is I am not calling the click event. It seems to be getting called when I set the selection on the listbox"}, {"owner": {"reputation": 355, "user_id": 9841207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc5da3d361f6c331926b8f161bb67d9c?s=128&d=identicon&r=PG&f=1", "display_name": "User", "link": "https://stackoverflow.com/users/9841207/user"}, "edited": false, "score": 0, "creation_date": 1538591431, "post_id": 52632358, "comment_id": 92200287, "body": "&quot;lsBox.Selected(I) = True&quot; This is what seems to be triggering my click event"}], "tags": [], "owner": {"reputation": 2630, "user_id": 5749062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/72aMs.png?s=128&g=1", "display_name": "Bill Hileman", "link": "https://stackoverflow.com/users/5749062/bill-hileman"}, "is_accepted": true, "score": 1, "last_activity_date": 1538588532, "last_edit_date": 1538588532, "creation_date": 1538586767, "answer_id": 52632358, "question_id": 52632028, "link": "https://stackoverflow.com/questions/52632028/vba-how-to-programaticly-select-an-item-in-a-listbox-without-triggering-the-on-c/52632358#52632358", "title": "VBA How to programaticly select an item in a listbox without triggering the on click event", "body": "<p>The way I do this with my VB6 projects is to define a module-scope variable</p>\n\n<pre><code>Private blnChangingInCode As Boolean\n</code></pre>\n\n<p>Then, when I need to utilize it, I set it to true, call the even/sub, set it back to false.</p>\n\n<pre><code>blnChangingInCode = True\nbtnLogin_Click()\nblnChangingInCode = False\n</code></pre>\n\n<p>Inside the affected subs/events I start with</p>\n\n<pre><code>If blnChangingInCode Then\n    Exit Sub ' or Exit Function\nEnd if\n</code></pre>\n\n<p>This might not be elegant, but it works, and I don't need to do it very often.</p>\n"}], "owner": {"reputation": 355, "user_id": 9841207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc5da3d361f6c331926b8f161bb67d9c?s=128&d=identicon&r=PG&f=1", "display_name": "User", "link": "https://stackoverflow.com/users/9841207/user"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 649, "favorite_count": 0, "accepted_answer_id": 52632358, "answer_count": 1, "score": 0, "last_activity_date": 1538591504, "creation_date": 1538585523, "last_edit_date": 1538591504, "question_id": 52632028, "link": "https://stackoverflow.com/questions/52632028/vba-how-to-programaticly-select-an-item-in-a-listbox-without-triggering-the-on-c", "title": "VBA How to programaticly select an item in a listbox without triggering the on click event", "body": "<p>I am using Excel 2010, Windows 10, with VBA. I have a function which runs upon clicking an item in an ActiveX <code>ListBox</code> control. The issue is that if you click the list box I ask if they are sure if they want to change the selection. If you click \"yes\" I continue, but if you say \"no\" I set the selection back to what it previously was.</p>\n\n<p>So the issue is that when I programmatically set the list box selection back to the previous selection my function will re-run the code that runs if a user clicks an item in the list box ...which is what I don't want.</p>\n\n<p>Does anyone have a better way to stop a list box selection and change it back to the old one without causing the on list box selection event to trigger?</p>\n\n<p>Function prototype for on click of the list box</p>\n\n<pre><code>lsQuestions_Click()\n</code></pre>\n\n<p>Code for setting the list box selection</p>\n\n<pre><code>'Prototype: setListBoxSelection(query As String, listBoxName As String) As Boolean\n'  Purpose: Set listbox selection based on text\nPublic Function setListBoxSelection(query As String, listBoxName As String) As Boolean\n  Dim lsBox As MSForms.listBox\n  Set lsBox = Workbooks(mainFile).Worksheets(entrySheet).OLEObjects(listBoxName).Object\n\n  Dim I As Integer\n\n  For I = 0 To lsBox.ListCount - 1\n      If lsBox.List(I) = query Then\n          lsBox.Selected(I) = True\n          setListBoxSelection = True\n          Exit Function\n      End If\n  Next I\n\n  setListBoxSelection = False\nEnd Function\n</code></pre>\n\n<p>Please note that I think the line of code below is what is triggering my click event which is what I don't want.</p>\n\n<pre><code>lsBox.Selected(I) = True\n</code></pre>\n"}, {"tags": ["excel", "vba", "listbox", "userform"], "comments": [{"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1538599311, "post_id": 52631755, "comment_id": 92203975, "body": "Added two approaches with a concrete solution. Enjoy it :-)"}], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 9606526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea2f62df748e278e9178b1d76ec7a869?s=128&d=identicon&r=PG&f=1", "display_name": "First Last", "link": "https://stackoverflow.com/users/9606526/first-last"}, "edited": false, "score": 0, "creation_date": 1538637299, "post_id": 52632093, "comment_id": 92214438, "body": "Hi FreeMan! Thank you for the time you left, but the explanation is very general. Thanks for giving friends advice if you add the complete code."}], "tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": false, "score": 1, "last_activity_date": 1538588062, "last_edit_date": 1538588062, "creation_date": 1538585742, "answer_id": 52632093, "question_id": 52631755, "link": "https://stackoverflow.com/questions/52631755/link-listbox-and-sheets-in-excel-for-delete-vba/52632093#52632093", "title": "Link Listbox and sheets in excel for delete - VBA", "body": "<p>Before removing the item from the <code>ListBox</code> you need to use the located value at the <code>ListBox.Selected</code> to find and remove the item from your \"database\".</p>\n\n<p>Something like this:</p>\n\n<pre><code>Private Sub CommandButton2_Click()\n  For lItem = Me.ListBox1.ListCount - 1 To 0 Step -1\n    If ListBox1.Selected(lItem) Then\n        DeleteItemFromDatabase ListBox1.Selected(lItem).Value\n        ListBox1.RemoveItem lItem\n        If Me.ListBox1.MultiSelect = fmMultiSelectSingle Then\n          Exit For\n        End If\n    End If\n  Next\nEnd Sub\n</code></pre>\n\n<p>Then your <code>Sub DeleteItemFromDatabase(ByVal itemToDelete As [type])</code> would find <code>itemToDelete</code> in your \"database\" and remove it.</p>\n\n<p>As an additional note, you may want to consider using Access as your database since it's actually designed to be one. I realize this isn't always possible, but thought I'd throw it out there as a thought for you.</p>\n"}, {"comments": [{"owner": {"reputation": 121, "user_id": 9606526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea2f62df748e278e9178b1d76ec7a869?s=128&d=identicon&r=PG&f=1", "display_name": "First Last", "link": "https://stackoverflow.com/users/9606526/first-last"}, "edited": false, "score": 0, "creation_date": 1538636889, "post_id": 52635197, "comment_id": 92214233, "body": "Hi T.M.! Thank you for your description. But your codes do not work. For example, Error in the line &quot;rng.Offset (indx) .Resize (1, rng.Columns.Count) .Delete xlShiftUp&quot;. Or &quot;Option Explicit&quot;. Please send the completed code (not scattered) to understand."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "reply_to_user": {"reputation": 121, "user_id": 9606526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea2f62df748e278e9178b1d76ec7a869?s=128&d=identicon&r=PG&f=1", "display_name": "First Last", "link": "https://stackoverflow.com/users/9606526/first-last"}, "edited": false, "score": 0, "creation_date": 1538637944, "post_id": 52635197, "comment_id": 92214780, "body": "In order to avoid possible error 91, you have only to remove or outcomment the declaration <code>Dim rng As Range</code> in \u25ba**<code>UserForm_Initialize</code>** as <i>now</i> it should be defined in the declaration head of your userform module as mentioned: @FirstLast"}, {"owner": {"reputation": 121, "user_id": 9606526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea2f62df748e278e9178b1d76ec7a869?s=128&d=identicon&r=PG&f=1", "display_name": "First Last", "link": "https://stackoverflow.com/users/9606526/first-last"}, "edited": false, "score": 0, "creation_date": 1538638571, "post_id": 52635197, "comment_id": 92215094, "body": "Where should I put these two lines below? [Option Explicit               &#39; declaration head of the UserForm module] [Dim rng as Range              &#39; ONE database declaration only!]"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "reply_to_user": {"reputation": 121, "user_id": 9606526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea2f62df748e278e9178b1d76ec7a869?s=128&d=identicon&r=PG&f=1", "display_name": "First Last", "link": "https://stackoverflow.com/users/9606526/first-last"}, "edited": false, "score": 0, "creation_date": 1538638790, "post_id": 52635197, "comment_id": 92215227, "body": "These are the <i>very</i> FIRST two code lines on top of your UserForm code module - @FirstLast"}, {"owner": {"reputation": 121, "user_id": 9606526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea2f62df748e278e9178b1d76ec7a869?s=128&d=identicon&r=PG&f=1", "display_name": "First Last", "link": "https://stackoverflow.com/users/9606526/first-last"}, "edited": false, "score": 0, "creation_date": 1538644173, "post_id": 52635197, "comment_id": 92218217, "body": "Please download and test the following link file: <a href=\"https://www.dropbox.com/s/np9ci7rsl4r7fjf/Link%20Listbox%20and%20sheets%20in%20excel%20for%20delete%20-%20VBA.xlsm?dl=0\" rel=\"nofollow noreferrer\">dropbox.com/s/np9ci7rsl4r7fjf/&hellip;</a>"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "reply_to_user": {"reputation": 121, "user_id": 9606526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea2f62df748e278e9178b1d76ec7a869?s=128&d=identicon&r=PG&f=1", "display_name": "First Last", "link": "https://stackoverflow.com/users/9606526/first-last"}, "edited": false, "score": 0, "creation_date": 1538649047, "post_id": 52635197, "comment_id": 92221090, "body": "It&#39;s as I told already - insert these starting code lines <code>Option Explicit</code> and <code>Dim rng As Range</code> BEFORE your regular procedures on TOP of your UserForm code module and not inside the <code>UserForm_Initialize</code> procedure, so the variable <code>rng</code> gets known in all UserForm procedures without need to redeclare it again. Then you can run it without problems. C.f. my edit, too. - @FirstLast"}, {"owner": {"reputation": 121, "user_id": 9606526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea2f62df748e278e9178b1d76ec7a869?s=128&d=identicon&r=PG&f=1", "display_name": "First Last", "link": "https://stackoverflow.com/users/9606526/first-last"}, "edited": false, "score": 1, "creation_date": 1538661383, "post_id": 52635197, "comment_id": 92228971, "body": "The solution provided by you worked. I really appreciate your guidance. Very accurate. &quot;Good luck&quot;."}], "tags": [], "owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "is_accepted": true, "score": 1, "last_activity_date": 1538650501, "last_edit_date": 1538650501, "creation_date": 1538598560, "answer_id": 52635197, "question_id": 52631755, "link": "https://stackoverflow.com/questions/52631755/link-listbox-and-sheets-in-excel-for-delete-vba/52635197#52635197", "title": "Link Listbox and sheets in excel for delete - VBA", "body": "<p><strong>How do I delete the values in the sheet \"database\"?</strong></p>\n\n<p>As you assign database items via the array method (not using <code>ControlSource</code>), you want to know how to synchronize listbox items with your data base after manual deletion. </p>\n\n<p><strong>Approach A) - Write the entire <code>Listbox1.List</code></strong></p>\n\n<p>If you want a mirror image of the listbox items after the <code>For</code>- <code>Next</code> loop, you could simply write these items back to a given range (of course you should clear 'surplus rows', too) via the following <em>one liner</em></p>\n\n<pre><code>    rng.Resize(Me.ListBox1.ListCount, 2) = Me.ListBox1.List\n</code></pre>\n\n<p>Instead of reduplicating the data range declaration in <code>CommandButton2_Click</code>, I'd suggest to declare it ONCE in the declaration head of the Userform code module (and <strong>omit</strong> it in <code>Userform_Initialize</code>):</p>\n\n<p><strong>Thus the complete code would be as follows:</strong></p>\n\n<blockquote>\n  <p>\u25ba<em>Additional notes due to comment</em></p>\n</blockquote>\n\n<p>Insert these two code lines on <strong>top</strong> of your UserForm code module (and <strong>before</strong> any procedures). </p>\n\n<p><code>Option Explicit</code> is strictly recommended in any code to force the declaration of variable types (but you can't use this statement within a <code>Sub</code> as you did). The declaration <code>Dim rng As Range</code> OUTSIDE the other procedures (i.e. on top) allows that any procedure within this code module <em>knows</em> the <code>rng</code> variable.</p>\n\n<pre><code>Option Explicit               ' declaration head of the UserForm module\nDim rng as Range              ' ONE database declaration only!\n                              ' &lt;&lt; OUTSIDE of following procedures \n' &lt;&lt; Start of regular procedures                              \nPrivate Sub UserForm_Initialize()\nDim ws      As Worksheet\n' Dim rng   As Range    ' &lt;&lt; not needed here, see top declaration\nDim MyArray\nSet ws = Sheets(\"Database\")\nSet rng = ws.Range(\"K2:L\" &amp; ws.Range(\"K\" &amp; ws.Rows.Count).End(xlUp).Row)\nWith Me.ListBox1\n    .Clear\n    .ColumnHeads = False\n    .ColumnCount = rng.Columns.Count\n\n     MyArray = rng\n\n    .List = MyArray\n    .ColumnWidths = \"90;90\"\n    .TopIndex = 0\nEnd With\nEnd Sub\n\nPrivate Sub CommandButton3_Click()   \nDim lItem&amp;\nFor lItem = Me.ListBox1.ListCount - 1 To 0 Step -1\n    If ListBox1.Selected(lItem) Then\n        ListBox1.RemoveItem lItem           ' remove item from listbox\n        If Me.ListBox1.MultiSelect = fmMultiSelectSingle Then\n            Exit For\n        End If\n    End If\nNext\n\nrng.Offset(Me.ListBox1.ListCount, 0).Resize(rng.Rows.Count, 2) = \"\" ' clear rows\nrng.Resize(Me.ListBox1.ListCount, 2) = Me.ListBox1.List             ' write list back\n\nEnd Sub\n</code></pre>\n\n<p><em>Note</em> that no rows are deleted physically, the resulting listbox items in the two target columns <code>K:L</code> are shifted up only <em>(approach B allows to delete entire rows as well)</em>.</p>\n\n<p><strong>Approach B) - Help procedure within main loop</strong></p>\n\n<p>Using the <em>same</em> data range declaration in the declaration head of the UserForm \u25ba as shown above (i.e. OUTSIDE the procedures as Subs or Functions), you could use a help procedure <code>DelData</code> allowing to distinguish between two principal cases:</p>\n\n<ul>\n<li>[1] Shift up deleted cells in your database</li>\n<li>[2] Delete the entire row</li>\n</ul>\n\n<p><strong>Event procedure</strong> <code>CommandButton2_Click</code></p>\n\n<pre><code>Private Sub CommandButton2_Click()\n' Purpose: delete items both from database and listbox\nDim lItem&amp;\nFor lItem = Me.ListBox1.ListCount - 1 To 0 Step -1\n    If ListBox1.Selected(lItem) Then\n        DelData lItem, True     ' [1] True=delete items and shift up\n       'DelData lItem, False    ' [2] False=delete entire row\n\n        ListBox1.RemoveItem lItem           ' remove item from listbox\n        If Me.ListBox1.MultiSelect = fmMultiSelectSingle Then\n           Exit For                ' do it once in single select case\n        End If\n    End If\nNext\nEnd Sub\n</code></pre>\n\n<p><strong>Help procedure <code>DelData</code></strong></p>\n\n<pre><code>Sub DelData(ByVal indx&amp;, Optional ByVal bShiftUp As Boolean = True)\n' Purpose: delete indicated row items in database\n' Note:    data set in OP includes header\n    If bShiftUp Then    ' [1] bShiftUp = True: delete row items and shift up\n       rng.Offset(indx).Resize(1, rng.Columns.Count).Delete xlShiftUp\n    Else                ' [2] bShiftUp = False: delete entire row of indicated items\n       rng.Offset(indx).Resize(1, rng.Columns.Count).EntireRow.Delete\n    End If\nEnd Sub\n</code></pre>\n\n<p><strong>Side note</strong></p>\n\n<p>It's recommended to fully qualify range references to avoid getting data from wrong workbooks, so I'd suggest the following statement in your <code>UserForm_Initialize</code> procedure:</p>\n\n<p><code>Set ws = ThisWorkbook.Worksheets(\"Database\")</code></p>\n\n<p>Enjoy it :-)</p>\n"}], "owner": {"reputation": 121, "user_id": 9606526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea2f62df748e278e9178b1d76ec7a869?s=128&d=identicon&r=PG&f=1", "display_name": "First Last", "link": "https://stackoverflow.com/users/9606526/first-last"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 870, "favorite_count": 0, "accepted_answer_id": 52635197, "answer_count": 2, "score": 1, "last_activity_date": 1538650501, "creation_date": 1538584295, "last_edit_date": 1538628153, "question_id": 52631755, "link": "https://stackoverflow.com/questions/52631755/link-listbox-and-sheets-in-excel-for-delete-vba", "title": "Link Listbox and sheets in excel for delete - VBA", "body": "<p>I create listbox in excel with VBA userform. Its values are obtained from the Sheet in Excel.\nHow can I delete the values in the sheet \"database\"  while deleting the box list item?\nplease help me.</p>\n\n<pre><code>Private Sub UserForm_Initialize()\nDim ws      As Worksheet\nDim rng     As Range\n\nDim MyArray \nSet ws = Sheets(\"Database\")\n\nSet rng = ws.Range(\"K2:L\" &amp; ws.Range(\"K\" &amp; ws.Rows.Count).End(xlUp).Row)\n\nWith Me.ListBox1\n.Clear\n.ColumnHeads = False\n.ColumnCount = rng.Columns.Count\n\n MyArray = rng\n\n.List = MyArray\n\n.ColumnWidths = \"90;90\"\n.TopIndex = 0\nEnd With\nEnd Sub\n\nPrivate Sub CommandButton2_Click()\nFor lItem = Me.ListBox1.ListCount - 1 To 0 Step -1\n    If ListBox1.Selected(lItem) Then\n        ListBox1.RemoveItem lItem\n        If Me.ListBox1.MultiSelect = fmMultiSelectSingle Then\n            Exit For\n        End If\n    End If\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "autofilter"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1538585419, "post_id": 52631545, "comment_id": 92197285, "body": "Do you only need the filtered data? If so, copy that first elsewhere then into an array and re-arrange the columns in a loop  dumping to the sheet per column or into another array then back to sheet as possibilities."}, {"owner": {"reputation": 1, "user_id": 10452110, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-LNMF2hYH8HM/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVB3gxgLkBxzbKPal0cLZEc_H3TQw/mo/photo.jpg?sz=128", "display_name": "Newbie Fluke", "link": "https://stackoverflow.com/users/10452110/newbie-fluke"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1538593936, "post_id": 52631545, "comment_id": 92201514, "body": "Thanks for responding.  No, I need to keep ALL data in individual columns as well as the filter for each of the columns when I re-order them.  This is part of a larger macro, for which re-ordering filtered columns is just one part.  Seems that accessing a single column&#39;s filter values is really uncommon (or really easy) and therefore not a common topic of discussion."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1538594101, "post_id": 52631545, "comment_id": 92201614, "body": "There are a couple of SO questions and answers I have seen on storing filters and restoring them."}, {"owner": {"reputation": 1, "user_id": 10452110, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-LNMF2hYH8HM/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVB3gxgLkBxzbKPal0cLZEc_H3TQw/mo/photo.jpg?sz=128", "display_name": "Newbie Fluke", "link": "https://stackoverflow.com/users/10452110/newbie-fluke"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1538597183, "post_id": 52631545, "comment_id": 92203022, "body": "The ones I have seen all involve iterating over the .AutoFilter object (?) and storing each existing filter in an array.  Then, you run your macro, and then you iterate back over the array to restore.  Using this approach, I can&#39;t figure out how to determine a filter&#39;s old column and then apply it to a different, new column that didn&#39;t previously exist in the array."}], "owner": {"reputation": 1, "user_id": 10452110, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-LNMF2hYH8HM/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVB3gxgLkBxzbKPal0cLZEc_H3TQw/mo/photo.jpg?sz=128", "display_name": "Newbie Fluke", "link": "https://stackoverflow.com/users/10452110/newbie-fluke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1538583503, "creation_date": 1538583503, "question_id": 52631545, "link": "https://stackoverflow.com/questions/52631545/vba-copy-single-column-filter-to-another-column-in-same-sheet", "title": "vba copy SINGLE column filter to another column in same sheet", "body": "<p>I want to move Column F to Column S (re-order columns) in a sheet and retain Column F's filters.  I can copy/paste or move Column F values into Column S, but I don't see a way to carry over the filter. The .AutoFilter method may be my only choice, but it seems difficult to use when applying to a new column that doesn't already have a filter.</p>\n\n<p>Am I taking completely the wrong approach?</p>\n\n<p>Is there no straightforward method to grabbing one column's filter info and applying it to a new column that doesn't currently have a filter?  Do you have to activate the new column's filter first?  If so, does this require saving all column filter info, turning off .AutoFilterMode, turning it back on, and then re-applying all filters while extending the range to include the new column?</p>\n\n<p>I can't even get the autofilter to reset (results in 400 error):</p>\n\n<pre><code>Sub extend_autofilter()\n\nDim ws As Worksheet\nSet ws = ActiveSheet\n\nIf ws.AutoFilterMode = True Then\n\n    With ws\n        .Range(\"B2:S20\").AutoFilter\n        .Range(\"B2:S20\").AutoFilter\n    End With\nElse\n    With ws\n        .Range(\"B2:S20\").AutoFilter\n    End With\nEnd If End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "match", "sequential"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1538583053, "post_id": 52631401, "comment_id": 92196094, "body": "Always helps to explain what you already tried, and what problems you had.  Also, it would help to explain exactly what &quot;gap in delivery&quot; looks like."}, {"owner": {"reputation": 167, "user_id": 5725420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/017faecd3978c1585fe0ca21a2b76f40?s=128&d=identicon&r=PG&f=1", "display_name": "C.A.R.", "link": "https://stackoverflow.com/users/5725420/c-a-r"}, "edited": false, "score": 0, "creation_date": 1538585317, "post_id": 52631401, "comment_id": 92197219, "body": "Yeah, just a bit too much to guess on here. For instance, on the Analysis tab, do you expect <code>Item 876A</code> with <code>Supplier A</code> to really show up 11 times? If so, what is the expected logic or output with 11 entries?"}, {"owner": {"reputation": 3, "user_id": 10451947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ce249f8055c215849be2e6d46db551d?s=128&d=identicon&r=PG&f=1", "display_name": "JosephA", "link": "https://stackoverflow.com/users/10451947/josepha"}, "edited": false, "score": 0, "creation_date": 1538587296, "post_id": 52631401, "comment_id": 92198235, "body": "Tim W. - Gap in delivery occurs when the list of year/weeks are not sequential for a given Item and Supplier."}, {"owner": {"reputation": 3, "user_id": 10451947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ce249f8055c215849be2e6d46db551d?s=128&d=identicon&r=PG&f=1", "display_name": "JosephA", "link": "https://stackoverflow.com/users/10451947/josepha"}, "edited": false, "score": 0, "creation_date": 1538588242, "post_id": 52631401, "comment_id": 92198722, "body": "C.A.R - You are correct, there should only be one line for each Item Desc/ Supplier in the Analysis tab.   The goal is to input data from &quot;Raw Data: column A&quot; into the Analysis Column A and B that match Column C and D.     Analysis column B should look at the matching data from Raw columns B and C, then select the oldest entry in the most recent sequence.     Analysis Column A should look at the matching data from Raw columns B and C, then select the next year/week after the sequence ends."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10451947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ce249f8055c215849be2e6d46db551d?s=128&d=identicon&r=PG&f=1", "display_name": "JosephA", "link": "https://stackoverflow.com/users/10451947/josepha"}, "edited": false, "score": 0, "creation_date": 1538674527, "post_id": 52636492, "comment_id": 92236659, "body": "Shelty:  This worked fantastic!  I have tested it several ways and it is quite effective and perfect for my needs.  You have taught me some new ways of using VBA that I had not realized were possible.  Thank you very much!"}], "tags": [], "owner": {"reputation": 296, "user_id": 10297628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/451ff84ef23bae11a9746ec65cf1c284?s=128&d=identicon&r=PG&f=1", "display_name": "Shelty", "link": "https://stackoverflow.com/users/10297628/shelty"}, "is_accepted": true, "score": 0, "last_activity_date": 1538606839, "last_edit_date": 1538606839, "creation_date": 1538605278, "answer_id": 52636492, "question_id": 52631401, "link": "https://stackoverflow.com/questions/52631401/excel-vba-to-match-2-criteria-extracting-last-match-in-sequence-and-first-match/52636492#52636492", "title": "Excel/VBA to match 2 criteria, extracting last match in sequence and first match after broken sequence", "body": "<p>This code should do what you want but check if it doesn't make mistakes. \nI didn't check it too much so it may produce errors.\nRun it in a copy of workbook.</p>\n\n<p>You should put this into class module and call it 'CItem':</p>\n\n<pre><code>Public pItemDescription As String\nPublic pSupplier As String\nPublic pDateDelivery As Collection\n</code></pre>\n\n<p><a href=\"https://excelmacromastery.com/vba-class-modules/\" rel=\"nofollow noreferrer\">https://excelmacromastery.com/vba-class-modules/</a></p>\n\n<p>That table in 'Analysis' should be empty.</p>\n\n<p>Then this into regular module: </p>\n\n<pre><code>Option Explicit\n\nSub SortCheck()\n\n    Dim aSht As Worksheet\n    Dim bSht As Worksheet\n\n    Dim tempItemDescription As String\n    Dim tempSupplier As String\n    Dim tempDateDelivery As String\n\n\n    Dim xItemsAll As Collection\n    Dim xItem As CItem\n    Dim xI As Variant\n    Dim flag As Boolean\n\n    Dim xTemp As Variant\n    Dim i As Long\n    Dim j As Long\n    Dim k As Long\n    Dim Row As Long\n\n    Set xItemsAll = New Collection\n    Set xItem = New CItem\n\n    Set aSht = Worksheets(\"Raw Data\")\n    Set bSht = Worksheets(\"Analysis\")\n\n    Row = 2\n\n    flag = True\n\n    Do\n        ' If the cell is empty, stop populating the collection\n        If aSht.Cells(Row, 2).Value = \"\" Then Exit Do\n\n        ' ---\n        tempDateDelivery = aSht.Cells(Row, 1).Value\n        tempItemDescription = aSht.Cells(Row, 2).Value\n        tempSupplier = aSht.Cells(Row, 3).Value\n\n        'If xItemsAll contains some records, check wheter similar records exist\n        If xItemsAll.Count &gt; 0 Then\n\n            For Each xI In xItemsAll\n\n                If tempItemDescription = xI.pItemDescription And tempSupplier = xI.pSupplier Then\n\n                    Set xItem = New CItem\n                    Set xItem = xI\n                    xItem.pDateDelivery.Add tempDateDelivery\n                    Set xItem = Nothing\n                    flag = False\n                    Exit For\n\n                Else\n\n                    flag = True\n\n                End If\n\n            Next xI\n\n        End If\n\n        ' If the first pass or no element in collection yet, create new record\n\n        If flag = True Then\n\n            Set xItem = New CItem\n\n            With xItem\n                .pItemDescription = tempItemDescription\n                .pSupplier = tempSupplier\n\n                Set .pDateDelivery = New Collection\n                .pDateDelivery.Add tempDateDelivery\n            End With\n\n            xItemsAll.Add xItem\n\n            Set xItem = Nothing\n\n            flag = False\n\n        End If\n\n        Row = Row + 1\n\n    Loop\n\n\n    'Sort the collection - Item Description in order\n    For i = 1 To xItemsAll.Count - 1\n        For j = i + 1 To xItemsAll.Count\n            If xItemsAll(i).pItemDescription &gt; xItemsAll(j).pItemDescription Then\n\n                Set xItem = New CItem\n                Set xItem = xItemsAll(j)\n\n                xItemsAll.Remove j\n                If j &lt;&gt; xItemsAll.Count + 1 Then\n                    xItemsAll.Add xItemsAll(i), , j\n                Else\n                    xItemsAll.Add xItemsAll(i), , , j - 1\n                End If\n\n                xItemsAll.Remove i\n                If i &lt;&gt; xItemsAll.Count + 1 Then\n                    xItemsAll.Add xItem, , i\n                Else\n                    xItemsAll.Add xItem, , , i - 1\n                End If\n\n                Set xItem = Nothing\n\n            End If\n        Next j\n    Next i\n\n    'Sort the collection - Suplier in order\n    For i = 1 To xItemsAll.Count - 1\n        For j = i + 1 To xItemsAll.Count\n            If xItemsAll(i).pItemDescription = xItemsAll(j).pItemDescription Then\n                If xItemsAll(i).pSupplier &gt; xItemsAll(j).pSupplier Then\n\n                    Set xItem = New CItem\n                    Set xItem = xItemsAll(j)\n\n                    xItemsAll.Remove j\n                    If j &lt;&gt; xItemsAll.Count + 1 Then\n                        xItemsAll.Add xItemsAll(i), , j\n                    Else\n                        xItemsAll.Add xItemsAll(i), , , j - 1\n                    End If\n\n                    xItemsAll.Remove i\n                    If i &lt;&gt; xItemsAll.Count + 1 Then\n                        xItemsAll.Add xItem, , i\n                    Else\n                        xItemsAll.Add xItem, , , i - 1\n                    End If\n\n                    Set xItem = Nothing\n\n                End If\n            End If\n        Next j\n    Next i\n\n    'Sort the collection - Dates in order\n    For k = 1 To xItemsAll.Count\n        For i = 1 To xItemsAll(k).pDateDelivery.Count - 1\n            For j = i + 1 To xItemsAll(k).pDateDelivery.Count\n                If xItemsAll(k).pItemDescription = xItemsAll(k).pItemDescription Then\n                    If xItemsAll(k).pSupplier = xItemsAll(k).pSupplier Then\n                        If xItemsAll(k).pDateDelivery(i) &gt; xItemsAll(k).pDateDelivery(j) Then\n\n                            xTemp = xItemsAll(k).pDateDelivery(j)\n\n                            xItemsAll(k).pDateDelivery.Remove j\n                            If j &lt;&gt; xItemsAll(k).pDateDelivery.Count + 1 Then\n                                xItemsAll(k).pDateDelivery.Add xItemsAll(k).pDateDelivery(i), , j\n                            Else\n                                xItemsAll(k).pDateDelivery.Add xItemsAll(k).pDateDelivery(i), , , j - 1\n                            End If\n\n                            xItemsAll(k).pDateDelivery.Remove i\n                            If i &lt;&gt; xItemsAll(k).pDateDelivery.Count + 1 Then\n                                xItemsAll(k).pDateDelivery.Add xTemp, , i\n                            Else\n                                xItemsAll(k).pDateDelivery.Add xTemp, , , i - 1\n                            End If\n\n                        End If\n                    End If\n                End If\n            Next j\n        Next i\n    Next k\n\n\n    Row = 2\n\n    For i = 1 To xItemsAll.Count\n        For j = 1 To xItemsAll(i).pDateDelivery.Count - 1\n            If CLng(Mid(xItemsAll(i).pDateDelivery(j + 1), 5)) &lt;&gt; (CLng(Mid(xItemsAll(i).pDateDelivery(j), 5)) + 1) Then\n\n                bSht.Cells(Row, 1).Value = xItemsAll(i).pDateDelivery(j + 1)\n\n                bSht.Cells(Row, 2).Value = xItemsAll(i).pDateDelivery(j)\n\n                bSht.Cells(Row, 3).Value = xItemsAll(i).pItemDescription\n\n                bSht.Cells(Row, 4).Value = xItemsAll(i).pSupplier\n\n                Row = Row + 1\n\n            End If\n        Next j\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p>For the code to work corectly it has to be 201801, 201805, etc. not 20181, 20185, etc. So if you have it different you would have to modify it with functions or vba.</p>\n"}], "owner": {"reputation": 3, "user_id": 10451947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ce249f8055c215849be2e6d46db551d?s=128&d=identicon&r=PG&f=1", "display_name": "JosephA", "link": "https://stackoverflow.com/users/10451947/josepha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 1, "accepted_answer_id": 52636492, "answer_count": 1, "score": -3, "last_activity_date": 1538606839, "creation_date": 1538582917, "last_edit_date": 1538589635, "question_id": 52631401, "link": "https://stackoverflow.com/questions/52631401/excel-vba-to-match-2-criteria-extracting-last-match-in-sequence-and-first-match", "title": "Excel/VBA to match 2 criteria, extracting last match in sequence and first match after broken sequence", "body": "<p>I am starting to use VBA programing and am stumped on how to extract what I need from non-sequential data.\nI have tried using excel functions such as \"VLookup\",  \"INDEX(Match(\",  \"MAX(If\", \"MIN(If\" but can only find the first or last match and nothing around where the sequence breaks.  I don't think it is possible with Excel functions which is why I am trying to figure out how to do this in VBA.  Maybe \"If, Else, Loop\" but not sure.</p>\n\n<p>Criteria: Must have matching \"Item desc\" and \"Supplier\".<br>\nOutput1: Find Year/Week after gap in delivery.<br>\nOutput2: Find Year/Week prior to gap in delivery.    </p>\n\n<p>Below is a sample image of Excel layout of the raw data on sheet1 and the analysis on sheet2.</p>\n\n<p><a href=\"https://i.stack.imgur.com/VUvgp.jpg\" rel=\"nofollow noreferrer\">Image of Excel issue:</a></p>\n"}, {"tags": ["excel", "vba", "range"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 5652051, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qU_aBlRVlQY/AAAAAAAAAAI/AAAAAAAAAHw/-Nw2ZpLGshs/photo.jpg?sz=128", "display_name": "Agustin", "link": "https://stackoverflow.com/users/5652051/agustin"}, "edited": false, "score": 0, "creation_date": 1538583058, "post_id": 52631357, "comment_id": 92196097, "body": "Thanks for the swift reply: The above code returns run time error 1004 - Application-defined or object-defined error."}], "tags": [], "owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "is_accepted": true, "score": 0, "last_activity_date": 1538582784, "creation_date": 1538582784, "answer_id": 52631357, "question_id": 52631273, "link": "https://stackoverflow.com/questions/52631273/vba-return-the-address-name-of-a-user-selected-range/52631357#52631357", "title": "VBA - Return the address/name of a user selected range", "body": "<p>Like so:</p>\n\n<pre><code>Range(\"E3\").FormulaR1C1 = _\n\"=VLOOKUP(RC[-4],\" &amp; v1.Address(RowAbsolute:=True, ColumnAbsolute:=True, ReferenceStyle:=xlR1C1, external:=True) &amp; \",5,0)\"\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 5652051, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qU_aBlRVlQY/AAAAAAAAAAI/AAAAAAAAAHw/-Nw2ZpLGshs/photo.jpg?sz=128", "display_name": "Agustin", "link": "https://stackoverflow.com/users/5652051/agustin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 52631357, "answer_count": 1, "score": 0, "last_activity_date": 1538582784, "creation_date": 1538582483, "question_id": 52631273, "link": "https://stackoverflow.com/questions/52631273/vba-return-the-address-name-of-a-user-selected-range", "title": "VBA - Return the address/name of a user selected range", "body": "<p>This might be too simple and I don\u00b4t know how to express it exactly. </p>\n\n<p>I have an Input box to select a range from an external xslx file:</p>\n\n<pre><code>Set v1 = Application.InputBox(prompt:=\"Select table\", Type:=8)\n</code></pre>\n\n<p>What I am trying to do, is to make the VBA return as string the \"selected range\" to be input later in a formula, e.g.</p>\n\n<pre><code>'[File1.xlsx]Sheet1'!$A$1:$K$24\n</code></pre>\n\n<p>this should go inside a formula, e.g.:</p>\n\n<pre><code>Range(\"E3\").Select\nActiveCell.FormulaR1C1 = _\n\"=VLOOKUP(RC[-4],\" &amp; v1 &amp; \",5,0)\"\n</code></pre>\n\n<p>Many thanks for any help you can give me!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1538581685, "post_id": 52630943, "comment_id": 92195296, "body": "Max of what? You&#39;re getting a single row number."}, {"owner": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "edited": false, "score": 0, "creation_date": 1538581825, "post_id": 52630943, "comment_id": 92195382, "body": "@Jeeped , it is getting the last row of column M + 1. I am doing this because I want to paste to after the last row of M."}, {"owner": {"reputation": 865, "user_id": 10361731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8873db235bacaa9d53de9c31a0b8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Jchang43", "link": "https://stackoverflow.com/users/10361731/jchang43"}, "edited": false, "score": 0, "creation_date": 1538582034, "post_id": 52630943, "comment_id": 92195502, "body": "@excelguy, @Jeeped is referencing your call to <code>WorksheetFunction.Max(...</code> and I agree, it doesn&#39;t make sense to take the max of a single number"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1538582072, "post_id": 52630943, "comment_id": 92195523, "body": "<code>busdates</code> is a range (or array) so it doesn&#39;t make sense to loop from <code>2 to busdates</code>."}, {"owner": {"reputation": 865, "user_id": 10361731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8873db235bacaa9d53de9c31a0b8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Jchang43", "link": "https://stackoverflow.com/users/10361731/jchang43"}, "edited": false, "score": 0, "creation_date": 1538585190, "post_id": 52630943, "comment_id": 92197151, "body": "Are you just trying to copy all of the data from <code>F2:K &amp; lastrow</code> without including the actual <code>M</code> column, or are you trying to only copy values that are not currently included within the <code>M</code> column"}, {"owner": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "edited": false, "score": 0, "creation_date": 1538585481, "post_id": 52630943, "comment_id": 92197318, "body": "Trying to copy the values that are not included within the column M. So column F and M are dates. Where the dates are alike, i dont want to copy the data over to M3:M &amp; Lastrow"}], "answers": [{"comments": [{"owner": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "edited": false, "score": 0, "creation_date": 1538582652, "post_id": 52630996, "comment_id": 92195845, "body": "Thanks. However I dont want to include the same values between column F and busdates. Don&#39;t I need an if statement to exclude them?"}, {"owner": {"reputation": 865, "user_id": 10361731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8873db235bacaa9d53de9c31a0b8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Jchang43", "link": "https://stackoverflow.com/users/10361731/jchang43"}, "edited": false, "score": 0, "creation_date": 1538583556, "post_id": 52630996, "comment_id": 92196349, "body": "You don&#39;t seem to use the <code>d</code> within your for loop, it seems like it would be sufficient to just execute the copy and paste code once."}, {"owner": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "reply_to_user": {"reputation": 865, "user_id": 10361731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8873db235bacaa9d53de9c31a0b8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Jchang43", "link": "https://stackoverflow.com/users/10361731/jchang43"}, "edited": false, "score": 0, "creation_date": 1538583949, "post_id": 52630996, "comment_id": 92196537, "body": "@Brotato but i want to loop through to find the dates between col F and busdates"}, {"owner": {"reputation": 865, "user_id": 10361731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8873db235bacaa9d53de9c31a0b8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Jchang43", "link": "https://stackoverflow.com/users/10361731/jchang43"}, "reply_to_user": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "edited": false, "score": 0, "creation_date": 1538584519, "post_id": 52630996, "comment_id": 92196823, "body": "@excelguy if there is no reference to <code>d</code> within any of the functions called, the functions are essentially running over and over again. In this case, you would just be pasting the same values into the same range over and over again."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 2, "last_activity_date": 1538582258, "last_edit_date": 1538582258, "creation_date": 1538581600, "answer_id": 52630996, "question_id": 52630943, "link": "https://stackoverflow.com/questions/52630943/vba-define-range-with-lastrow/52630996#52630996", "title": "VBA, define range with LastRow", "body": "<p>The range to be copied here <code>ActiveSheet.Range(\"F2:K\").Copy</code> is not completely defined. There is a row for the <code>K</code> column missing.</p>\n\n<hr>\n\n<p>Gessing that <code>busdates</code> is inteded to be a range, then it should be assigned as such:</p>\n\n<pre><code>Dim busDates As Range\nSet busDates = Sheets(\"stack\").Range(\"M3:M\" &amp; lastRow - 1)\n</code></pre>\n\n<p>And looping through the rows of a range is a bit meaningless, if the <code>d</code> variable is not used in the loop, but still:</p>\n\n<pre><code>For d = 2 To busDates.Rows.Count + 2\n    ActiveSheet.Range(\"F2:K\" &amp; lastRow).Copy\n    ActiveSheet.Range(\"M\" &amp; lastRow).PasteSpecial Paste:=xlPasteValues\n    Application.CutCopyMode = False\nNext\n</code></pre>\n\n<p>Probably looping through <code>busDates</code> could be done like this:</p>\n\n<pre><code>Dim myCell As Range\n\nFor Each myCell In busDates\n    If myCell.Row &gt; 2 Then\n        'some cut and copy here\n    End If\nNext myCell\n</code></pre>\n\n<p>Last but not least, the <code>ActiveSheet</code> is to be avoided in VBA, but in this case it is probably harmless -  <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>.</p>\n\n<p>The whole code that works somehow is here:</p>\n\n<pre><code>Sub TestMe()\n\n    Dim lastRow As Long\n    lastRow = WorksheetFunction.Max(Sheets(\"stack\").Cells(Rows.Count, \"M\").End(xlUp).Row)\n    lastRow = lastRow + 1\n\n    Dim busDates As Range\n    Set busDates = Sheets(\"stack\").Range(\"M3:M\" &amp; lastRow - 1)\n\n    Dim d As Long\n    For d = 2 To busDates.Rows.Count + 2\n        ActiveSheet.Range(\"F2:K\" &amp; lastRow).Copy\n        ActiveSheet.Range(\"M\" &amp; lastRow).PasteSpecial Paste:=xlPasteValues\n        Application.CutCopyMode = False\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "edited": false, "score": 0, "creation_date": 1538658875, "post_id": 52636678, "comment_id": 92227125, "body": "Thanks Brotato, I get subscript out of range <code>ElseIf Cell2 Like BusDates(UBound(BusDates)) Then</code>  , seems like its referring to this part, <code>BusDates(UBound(BusDates))</code> . Maybe busdates is not being defined properly?"}, {"owner": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "edited": false, "score": 0, "creation_date": 1538667931, "post_id": 52636678, "comment_id": 92233332, "body": "Works nicely! however I forgot to mention I have some data in column A, that is the highest row. I think lastrow is using that as the line to paste. However the column with pasting is correct."}, {"owner": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "edited": false, "score": 0, "creation_date": 1538670734, "post_id": 52636678, "comment_id": 92234812, "body": "Was able to fix the correct column. However when pasting F2 is being repeated many times then going to F3.. Do you know why this is?"}, {"owner": {"reputation": 865, "user_id": 10361731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8873db235bacaa9d53de9c31a0b8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Jchang43", "link": "https://stackoverflow.com/users/10361731/jchang43"}, "reply_to_user": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "edited": false, "score": 0, "creation_date": 1538673044, "post_id": 52636678, "comment_id": 92235976, "body": "@excelguy No sorry, I&#39;m not sure. Try debugging it line by line and watching the paste array. There&#39;s only one paste operation at the end of the code, so it would have to be added on to the array."}, {"owner": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "edited": false, "score": 0, "creation_date": 1539112210, "post_id": 52636678, "comment_id": 92380826, "body": "hey, any reason as to why this pastes dates in a different format? format changes from some from dd-mm-yyyy to mm-dd-yyyy"}, {"owner": {"reputation": 865, "user_id": 10361731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8873db235bacaa9d53de9c31a0b8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Jchang43", "link": "https://stackoverflow.com/users/10361731/jchang43"}, "reply_to_user": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "edited": false, "score": 0, "creation_date": 1539116841, "post_id": 52636678, "comment_id": 92382837, "body": "<a href=\"https://www.bluepecantraining.com/portfolio/excel-vba-formatting-cells-and-values/\" rel=\"nofollow noreferrer\">Here</a> is a short page describing how to alter some of the text properties. Try reformatting it to how you want."}, {"owner": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "edited": false, "score": 0, "creation_date": 1539117031, "post_id": 52636678, "comment_id": 92382911, "body": "But doesnt the number formatting have to be done when putting items in the array, not on the output or pasting?"}, {"owner": {"reputation": 865, "user_id": 10361731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8873db235bacaa9d53de9c31a0b8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Jchang43", "link": "https://stackoverflow.com/users/10361731/jchang43"}, "reply_to_user": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "edited": false, "score": 0, "creation_date": 1539118143, "post_id": 52636678, "comment_id": 92383332, "body": "If it&#39;s pasting the values, it should be pasting as a number which is formatted as a date. I believe the number is equal to the number of days since January 1900."}], "tags": [], "owner": {"reputation": 865, "user_id": 10361731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8873db235bacaa9d53de9c31a0b8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Jchang43", "link": "https://stackoverflow.com/users/10361731/jchang43"}, "is_accepted": false, "score": 1, "last_activity_date": 1538667484, "last_edit_date": 1538667484, "creation_date": 1538606712, "answer_id": 52636678, "question_id": 52630943, "link": "https://stackoverflow.com/questions/52630943/vba-define-range-with-lastrow/52636678#52636678", "title": "VBA, define range with LastRow", "body": "<p>I haven't tested this with any data yet, but you might be able to adapt something like this</p>\n\n<pre><code>Option Explicit\n\nSub test()\n    Dim DataArr() As Variant\n    Dim BusDates() As Variant\n    Dim PasteArr() As Variant\n    Dim LastRow As Long\n    Dim Cell1 As Variant\n    Dim Cell2 As Variant\n    Dim index As Long\n    Dim Matched As Boolean\n    Dim subcount As Long\n\n\n    LastRow = Worksheets(\"stacks\").Cells.Find(\"*\", searchorder:=xlByRows, searchdirection:=xlPrevious).Row\n    DataArr() = Worksheets(\"stacks\").Range(\"F2:K\" &amp; Worksheets(\"stacks\").Cells(Rows.Count, \"F\").End(xlUp).Row).Value\n    BusDates() = Worksheets(\"stacks\").Range(\"M3:M\" &amp; LastRow).Value\n\n    ReDim PasteArr(1 To 1, 1 To 6)\n    subcount = 1\n\n    For Cell1 = 1 To UBound(DataArr(), 1)\n        For Each Cell2 In BusDates()\n            If DataArr(Cell1, 1) Like Cell2 Then\n                Matched = True\n                Exit For                                      'if it matches it will exit\n            ElseIf Cell2 Like BusDates(UBound(BusDates), 1) Then 'if it gets to the end, it's truly unique and needs to be added\n\n                For index = 1 To 6\n                    PasteArr(subcount, index) = DataArr(Cell1, index)\n                Next index\n\n                subcount = subcount + 1\n\n                PasteArr = Application.Transpose(PasteArr)\n                ReDim Preserve PasteArr(1 To 6, 1 To subcount)\n                PasteArr = Application.Transpose(PasteArr)\n\n                Matched = False\n\n            End If\n        Next Cell2\n\n        If Matched = False Then\n            BusDates = Application.Transpose(BusDates)\n            ReDim Preserve BusDates(1 To UBound(BusDates) + 1)\n            BusDates = Application.Transpose(BusDates)\n            BusDates(UBound(BusDates), 1) = DataArr(Cell1, 1)\n        End If\n\n    Next Cell1\n    Worksheets(\"stacks\").Range(\"M\" &amp; LastRow + 1 &amp; \":\" &amp; Cells(LastRow + UBound(PasteArr, 1) - 1, 18).Address).Value = PasteArr\nEnd Sub\n</code></pre>\n\n<p>You need two for loops so that you can iterate through each date in the data array and compare it to every date in the M column to ensure that it's truly unique. The exit for speeds it up a little bit by skipping the rest of comparisons once it gets a match.</p>\n\n<p>EDIT: I've tested it a little and made some changes but this seems to work. It's worth noting that the <code>LastRow</code> will screw up if your data isn't in a square or rectangular shape because it might end up adding an null character or something to the compare array and you'll get a type mismatch when comparing <code>Cell2</code></p>\n"}], "owner": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1951, "favorite_count": 0, "accepted_answer_id": 52630996, "answer_count": 2, "score": 1, "last_activity_date": 1538667484, "creation_date": 1538581466, "last_edit_date": 1538581677, "question_id": 52630943, "link": "https://stackoverflow.com/questions/52630943/vba-define-range-with-lastrow", "title": "VBA, define range with LastRow", "body": "<p>I am having trouble defining my variable with my last row variable. Getting error: </p>\n\n<blockquote>\n  <p>application-defined or object defined error</p>\n</blockquote>\n\n<pre><code>LastRow = WorksheetFunction.Max(Sheets(\"stack\").Cells(Rows.Count, \"M\").End(xlUp).Row + 1)\nbusdates = Sheets(\"stack\").Range(\"M3\" &amp; \":\" &amp; \"M &amp; LastRow - 1\")\n</code></pre>\n\n<p>I know it is something to do with my range. Can someone help with the format of this? Trying to get the range of M3 to M Last row.</p>\n\n<p>then I'm trying to loop through <code>busdates</code> like so,</p>\n\n<pre><code>For d = 2 To busdates\n    If ActiveSheet.Range(\"F\") &lt;&gt; busdates Then\n        ActiveSheet.Range(\"F2:K\").Copy\n        ActiveSheet.Range(\"M\" &amp; LastRow).PasteSpecial Paste:=xlPasteValues\n    End If\nNext\n</code></pre>\n"}, {"tags": ["excel", "vba", "userform", "multipage"], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 9820399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/923290cf5b50bed328f4ec68eb815090?s=128&d=identicon&r=PG&f=1", "display_name": "jeux", "link": "https://stackoverflow.com/users/9820399/jeux"}, "edited": false, "score": 0, "creation_date": 1538587998, "post_id": 52631763, "comment_id": 92198579, "body": "Thanks for introducing me to &#39;SelectedItems&#39; .  This information was used right away.  Also thanks for the link to the multipage tutorial."}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": true, "score": 1, "last_activity_date": 1538584326, "creation_date": 1538584326, "answer_id": 52631763, "question_id": 52630751, "link": "https://stackoverflow.com/questions/52630751/if-userform-multipage-sheet-is-active-then-execute-function/52631763#52631763", "title": "If Userform Multipage Sheet Is active, then execute function", "body": "<p>Consider using the caption of <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/selecteditem-property\" rel=\"nofollow noreferrer\"><code>SelectedItem</code></a> property to get the name of the active page:</p>\n\n<pre><code>If MultiPage1.SelectedItem.Caption = \"myPageName\" Then\n   x.Cells(nextRow, 4) = \"needed value\"\nEnd IF\n</code></pre>\n\n<p>Or succinctly if you want cell value to point to current multipage name:</p>\n\n<pre><code>x.Cells(nextRow, 4) = MultiPage1.SelectedItem.Caption\n</code></pre>\n\n<p>See this informative <a href=\"https://www.ozgrid.com/Excel//free-training/ExcelVBA2/excelvba2lesson8.htm\" rel=\"nofollow noreferrer\">tutorial</a> on the MultiPages object.</p>\n"}], "owner": {"reputation": 17, "user_id": 9820399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/923290cf5b50bed328f4ec68eb815090?s=128&d=identicon&r=PG&f=1", "display_name": "jeux", "link": "https://stackoverflow.com/users/9820399/jeux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 402, "favorite_count": 0, "accepted_answer_id": 52631763, "answer_count": 1, "score": 0, "last_activity_date": 1538584326, "creation_date": 1538580843, "last_edit_date": 1538584167, "question_id": 52630751, "link": "https://stackoverflow.com/questions/52630751/if-userform-multipage-sheet-is-active-then-execute-function", "title": "If Userform Multipage Sheet Is active, then execute function", "body": "<p>I'm trying to have a Userform pull the name of the Active multipage sheet to a specific column in my workbook.   There are 4 pages in the userform which  contain option buttons that feed into the workbook.  The option button data already submits correctly. </p>\n\n<p>I need the name of the page so I can categorize the option button results. Here are some of the ways I've tried.  </p>\n\n<ol>\n<li><pre><code>If Page1.Page.Value = 0 Then\n   x.Cells(nextRow, 4) = \"Category 1\"\nEnd IF\n</code></pre></li>\n<li><pre><code>If Page1.Value = True Then\n   x.Cells(nextRow, 4) = \"Category 1\"\nEnd IF\n</code></pre></li>\n<li><pre><code>If Page1.Value = True Then\n   x.Cells(nextRow, 4) = Me.Page1.Caption\nEnd IF\n</code></pre></li>\n</ol>\n\n<p>Any suggestions?  </p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1538599352, "post_id": 52630600, "comment_id": 92203992, "body": "Please tell us which part of your code is highlighted when you get that error message."}, {"owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 0, "creation_date": 1538646982, "post_id": 52630600, "comment_id": 92219944, "body": "What is AddToWhere ? It looks like it&#39;s possibly a function? Where did you get this code from? Add Option Explicit to the top of all your code modules and try compiling it."}], "answers": [{"tags": [], "owner": {"reputation": 23, "user_id": 10264984, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tK0fFyaY7rU/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaMZofCZVCfehn_bVvwyfq7yo_Vusw/mo/photo.jpg?sz=128", "display_name": "Eric Hutchins", "link": "https://stackoverflow.com/users/10264984/eric-hutchins"}, "is_accepted": false, "score": -1, "last_activity_date": 1538585322, "creation_date": 1538585322, "answer_id": 52631985, "question_id": 52630600, "link": "https://stackoverflow.com/questions/52630600/how-can-i-solve-this-search-button-problem/52631985#52631985", "title": "How can i solve this search button problem?", "body": "<p>Can you see what line is causing the error?  Just looking at your code I see your <code>On Error GoTo cmdSearchErrorTrap</code>statement but the corresponding statement at the bottom is <code>btnSearchErrorTrap</code>.  Fixing that so they are both prefixed with cmd or btn might be all you need (doesn't matter which as long as they're the same).</p>\n"}], "owner": {"reputation": 1, "user_id": 10386230, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eaZct5U5Sd4/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaNNhNQC_ESXn86JvPlAG9qTfdPUIg/mo/photo.jpg?sz=128", "display_name": "Dom", "link": "https://stackoverflow.com/users/10386230/dom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1538599315, "creation_date": 1538580444, "last_edit_date": 1538599315, "question_id": 52630600, "link": "https://stackoverflow.com/questions/52630600/how-can-i-solve-this-search-button-problem", "title": "How can i solve this search button problem?", "body": "<p>I'm newbie to Access VBA. I have a problem to execute this function for button SEARCH. When I execute the code, this error will appear on my screen:</p>\n\n<p><img src=\"https://i.stack.imgur.com/pYtAx.png\" alt=\"popup\"></p>\n\n<pre><code>Private Sub btnSearch_Click()   \nOn Error GoTo cmdSearchErrorTrap\nDim MySQL As String, MyCriteria As String, MyRecordSource As String\nDim ArgCount As Integer\nDim Tmp As Variant\nArgCount = 0\nMySQL = \"Select * from [Incoming] where \"\nMyCriteria = \"\"\nAddToWhere [Title], \"[Title]\", MyCriteria, ArgCount\nAddToWhere [RefenrenceNum], \"[RefenrenceNum]\", MyCriteria, ArgCount\nAddToWhere [LetterNumber], \"[LetterNumber]\", MyCriteria, ArgCount\n\nIf MyCriteria = \"\" Then\nMyCriteria = \"True\"\nEnd If\nMyRecordSource = MySQL &amp; MyCriteria\nMe!frmEmpInf.Form.RecordSource = MyRecordSource\nIf Me!frmEmpInf.Form.RecordsetClone.RecordCount = 0 Then\nMsgBox \"No records match the criteria you entered.\", 48, \"No Records Found\"\nMe!cmdClear.SetFocus\nElse\n'Tmp = EnableControls(\"Detail\", True)\nMe!frmEmpInf.SetFocus\nEnd If\nbtnSearchResume:\nExit Sub\nbtnSearchErrorTrap:\nMsgBox Error$\nResume btnSearchResume\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1538585107, "post_id": 52630524, "comment_id": 92197109, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/16113876/inserting-an-online-picture-to-excel-with-vba\">Inserting an Online Picture to Excel with VBA</a>."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1538585276, "post_id": 52630524, "comment_id": 92197198, "body": "<code>v = (&quot;B&quot; &amp; i)</code> - so <code>ActiveSheet.Pictures.Insert(v)</code>.... is equivalent to <code>ActiveSheet.Pictures.Insert(&quot;B1&quot;)</code>, <code>&quot;B2&quot;</code> and so on. <code>&quot;B1&quot;</code> is not a reference to a <code>Range</code>, but <code>Range(&quot;B1&quot;)</code> is."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 2007830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/928198ae715344c247b0986881434612?s=128&d=identicon&r=PG", "display_name": "Stuart O", "link": "https://stackoverflow.com/users/2007830/stuart-o"}, "edited": false, "score": 0, "creation_date": 1538634967, "post_id": 52632605, "comment_id": 92213266, "body": "Unfortunately this returns the error &quot;Run-time error 1004. Unable to get the Insert property of the Pictures class&quot; as before."}, {"owner": {"reputation": 13, "user_id": 2007830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/928198ae715344c247b0986881434612?s=128&d=identicon&r=PG", "display_name": "Stuart O", "link": "https://stackoverflow.com/users/2007830/stuart-o"}, "edited": false, "score": 0, "creation_date": 1538635802, "post_id": 52632605, "comment_id": 92213722, "body": "I&#39;ve followed the link at the top of this question and the code there work well enough for me to modify for my need. Thanks, I did search before posting but failed to find that answer."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1538587731, "creation_date": 1538587731, "answer_id": 52632605, "question_id": 52630524, "link": "https://stackoverflow.com/questions/52630524/how-can-i-insert-pictures-into-my-excel-workbok-from-a-list-of-urls/52632605#52632605", "title": "How can I insert pictures into my Excel workbok from a list of URLs?", "body": "<p>Untested:</p>\n\n<pre><code>Sub Insert_picture_from_URL()\n'\n' Insert_picture_from_URL Macro\n'\n    Dim i As Long, v As String, w As String\n        For i = 1 To 200\n            With ActiveSheet.Pictures.Insert(Cells(i, 2).Value)\n                .Top = Cells(i, 1).Top\n                .Left = Cells(i, 1).Left\n            End With\n        Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 2007830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/928198ae715344c247b0986881434612?s=128&d=identicon&r=PG", "display_name": "Stuart O", "link": "https://stackoverflow.com/users/2007830/stuart-o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1538587731, "creation_date": 1538580230, "last_edit_date": 1538580324, "question_id": 52630524, "link": "https://stackoverflow.com/questions/52630524/how-can-i-insert-pictures-into-my-excel-workbok-from-a-list-of-urls", "title": "How can I insert pictures into my Excel workbok from a list of URLs?", "body": "<p>I have an Excel workbook (Excel 2013, Windows 10) containing a column of paths to jpg files on my computer (column \"B\") and I'd like to have a macro which will work through all of the rows inserting a thumbnail of the picture into the cell to the left of the path, ie in column \"A\".</p>\n\n<p>I'm no macro VBA coder and usually record macros close to what I want and then edit the code it records for me. So I know that I can write a macro which simply records me doing this and the macro runs. However when I try to generalise it, I get an error, although the error is on the same line as ran fine previously.</p>\n\n<p>So, this macro works -</p>\n\n<pre><code>Sub Macro1()\n'\n' Macro1 Macro\n'\n    Range(\"A4\").Select\n    ActiveSheet.Pictures.Insert(\"D:\\My Documents HDD\\...(path)...\\Filename.jpg\").Select\nEnd Sub\n</code></pre>\n\n<p>However this doesn't work -</p>\n\n<pre><code>Sub Insert_picture_from_URL()\n'\n' Insert_picture_from_URL Macro\n'\n    Dim i As Long, v As String, w As String\n        For i = 1 To 200\n            v = (\"B\" &amp; i)\n            w = (\"A\" &amp; i)\n            Range(w).Select\n            ActiveSheet.Pictures.Insert(v).Select\n        Next i\nEnd Sub\n</code></pre>\n\n<p>I get \"Run-time error '1004': Unable to get the Insert property of the Pictures class\" </p>\n\n<p>Please can you tell me where I'm going wrong? I realise I'll need to add code to resize the thumbnails to a reasonable size, but I need to get this to work first.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1538580627, "post_id": 52630462, "comment_id": 92194668, "body": "Change <code>wsDst.Range(1 &amp; lLastColumn).Value</code> to <code>wsDst.Cells(1,lLastColumn).Value</code> because the way you have it written is not correcty syntax."}, {"owner": {"reputation": 103, "user_id": 10327178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d795576bc6af57a1b001634ff9750aff?s=128&d=identicon&r=PG&f=1", "display_name": "Piccinin", "link": "https://stackoverflow.com/users/10327178/piccinin"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1538580994, "post_id": 52630462, "comment_id": 92194909, "body": "That works, thanks Scott. The only problem is, it is only filling the first row because it&#39;s the blank one which i think is because of the following line:      lLastRow = wsDst.UsedRange.Rows(wsDst.UsedRange.Rows.Count).Row + 1"}, {"owner": {"reputation": 103, "user_id": 10327178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d795576bc6af57a1b001634ff9750aff?s=128&d=identicon&r=PG&f=1", "display_name": "Piccinin", "link": "https://stackoverflow.com/users/10327178/piccinin"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1538581048, "post_id": 52630462, "comment_id": 92194945, "body": "And i only want to show the file name next to each row that is copied"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1538581112, "post_id": 52630462, "comment_id": 92194978, "body": "So, you can either edit your question to ask about the new error or make a new question. This question as is stands to be closed bc it was only a syntax issue."}, {"owner": {"reputation": 103, "user_id": 10327178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d795576bc6af57a1b001634ff9750aff?s=128&d=identicon&r=PG&f=1", "display_name": "Piccinin", "link": "https://stackoverflow.com/users/10327178/piccinin"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1538582090, "post_id": 52630462, "comment_id": 92195536, "body": "Thanks for the help on this one.. I have edited the question."}], "answers": [{"comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 103, "user_id": 10327178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d795576bc6af57a1b001634ff9750aff?s=128&d=identicon&r=PG&f=1", "display_name": "Piccinin", "link": "https://stackoverflow.com/users/10327178/piccinin"}, "edited": false, "score": 0, "creation_date": 1538583799, "post_id": 52631361, "comment_id": 92196466, "body": "I kind of thought so @Piccinin :)"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 0, "last_activity_date": 1538582797, "creation_date": 1538582797, "answer_id": 52631361, "question_id": 52630462, "link": "https://stackoverflow.com/questions/52630462/getting-an-error-in-putting-the-name-of-the-file-from-a-folder-after-the-last-fi/52631361#52631361", "title": "Getting an error in putting the name of the file from a folder after the last filled column", "body": "<p>Try this:</p>\n\n<pre><code>wsDst.Cells(1,lLastColumn).Resize(wsSrc.UsedRange.Rows.Count,1).Value = wbDst.FullName\n</code></pre>\n\n<p>The code itself should be explanatory enough as to what it's doing.</p>\n\n<p>Or this, because I am not 100% sure exactly what you want.</p>\n\n<pre><code>wsDst.Range(\"A\" &amp; lLastRow).Resize(wsSrc.UsedRange.Rows.Count,1).Value = wbDst.FullName\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 10327178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d795576bc6af57a1b001634ff9750aff?s=128&d=identicon&r=PG&f=1", "display_name": "Piccinin", "link": "https://stackoverflow.com/users/10327178/piccinin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 52631361, "answer_count": 1, "score": 0, "last_activity_date": 1538582797, "creation_date": 1538580057, "last_edit_date": 1538582074, "question_id": 52630462, "link": "https://stackoverflow.com/questions/52630462/getting-an-error-in-putting-the-name-of-the-file-from-a-folder-after-the-last-fi", "title": "Getting an error in putting the name of the file from a folder after the last filled column", "body": "<p>Previous question regarding the syntax has been solved by Scott for putting in the name of the file to the master workbook. Slightly modified new question</p>\n\n<p>Essentially, i have hundreds of files in a folder and i am copying all the data from those files to a master workbook to the tabs where both the source and destination tab names match. Everything runs fine except putting in the name of the file next to the data that has been copied and the problem is, it is only filling the first row because it's the blank one which i think is because of the following line: </p>\n\n<pre><code>lLastRow = wsDst.UsedRange.Rows(wsDst.UsedRange.Rows.Count).Row + 1 \n</code></pre>\n\n<p>Here is the code. I am pretty sure there's a easy way of going on about doing this</p>\n\n<pre><code>Sub ProjectMacro()\nDim wbDst As Workbook\nDim wsDst As Worksheet\nDim wbSrc As Workbook\nDim wsSrc As Worksheet\nDim MyPath As String\nDim strFilename As String\nDim lLastRow As Long\nDim lLastColumn As Long\nDim LC As Long\nDim s As Worksheet, t As String\nDim i As Long, K As Long\nK = Sheets.Count\n\n\nApplication.DisplayAlerts = False\nApplication.EnableEvents = False\nApplication.ScreenUpdating = False\n\n\nSet wbDst = ThisWorkbook\nMyPath = \"C:\\Users\\tomhardy\\Desktop\\787 files\\\"\nstrFilename = Dir(MyPath &amp; \"*.xls*\", vbNormal)\n\nDo While strFilename &lt;&gt; \"\"\n'loop through each worksheet in the source file\nFor Each wsSrc In wbSrc.Worksheets\n    'Find the corresponding worksheet in the destination with \nthe same name as the source\n  On Error Resume Next\nSet wsDst = wbDst.Worksheets(wsSrc.Name)\n    On Error GoTo 0\nIf wsDst.Name = wsSrc.Name Then\nlLastRow = \n wsDst.UsedRange.Rows(wsDst.UsedRange.Rows.Count).Row + 1    \n lLastColumn =wsDst.UsedRange.Columns(wsDst.UsedRange.Columns.Count).Column + 1\n  wsSrc.UsedRange.Copy\n wsDst.Range(\"A\" &amp; lLastRow).PasteSpecial xlPasteValues\n wsDst.Cells(1,lLastColumn).Value = wbDst.FullName\n End If\n Application.CutCopyMode = False\nNext wsSrc\n\n\nwbSrc.Close False\nstrFilename = Dir()\nLoop\n\nApplication.DisplayAlerts = False\nApplication.EnableEvents = False\nApplication.ScreenUpdating = False\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "optimization", "outlook"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1538581703, "post_id": 52630327, "comment_id": 92195307, "body": "Consider eyeballing <a href=\"https://codereview.stackexchange.com\">Code Review</a>&#39;s <code>&#47;help&#47;how-to-ask</code> and <code>&#47;help&#47;on-topic</code> pages; code reviews are typically off-topic on Stack Overflow."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10452048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b877260e42603f5d162b9b5458ae9b5?s=128&d=identicon&r=PG&f=1", "display_name": "KyleB", "link": "https://stackoverflow.com/users/10452048/kyleb"}, "edited": false, "score": 0, "creation_date": 1538595507, "post_id": 52630455, "comment_id": 92202264, "body": "Perfect, Items.Restrict got it running in reasonable time."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": true, "score": 2, "last_activity_date": 1538595703, "last_edit_date": 1538595703, "creation_date": 1538580045, "answer_id": 52630455, "question_id": 52630327, "link": "https://stackoverflow.com/questions/52630327/code-optimization-looping-through-outlook-subfolders-to-import-emails-into-exc/52630455#52630455", "title": "Code Optimization - Looping through Outlook subfolders to import emails into Excel", "body": "<p>Firstly, never loop through all item in a folder. Use <code>Items.Find/FindNext</code> or <code>Items.Restrict</code> with a query like <code>[ReceivedTime] &gt; '2018-09-01'</code>.</p>\n\n<p>Secondly (if you do use a loop), do not continuously evaluate expressions inside the loop that never change. In your case, they are <code>Range(\"From_date\").Value</code>, <code>Range(\"eMail_subject\")</code>, <code>Range(\"eMail_date\")</code>, <code>Range(\"eMail_sender\")</code>. Evaluate these expressions before starting the loop, store the returned values in variables, and use them inside the loop.</p>\n"}], "owner": {"reputation": 3, "user_id": 10452048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b877260e42603f5d162b9b5458ae9b5?s=128&d=identicon&r=PG&f=1", "display_name": "KyleB", "link": "https://stackoverflow.com/users/10452048/kyleb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 1, "accepted_answer_id": 52630455, "answer_count": 1, "score": 0, "last_activity_date": 1538595703, "creation_date": 1538579688, "question_id": 52630327, "link": "https://stackoverflow.com/questions/52630327/code-optimization-looping-through-outlook-subfolders-to-import-emails-into-exc", "title": "Code Optimization - Looping through Outlook subfolders to import emails into Excel", "body": "<p>I have a macro which loops through 2 Outlook subfolders and imports some email information (sender, subject, date) into an Excel worksheet. There are not many emails in the subfolders (if you search across an entire month there would be maybe 100-200 emails in total). However, the macro seems to be taking an excessive amount of time to run (~3 minutes). </p>\n\n<p>Any advice on getting the macro to run faster?</p>\n\n<p>FYI - new to vba</p>\n\n<pre><code>Sub OptimizeCode_Begin()\n\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\nApplication.Calculation = xlCalculationManual\nActiveSheet.DisplayPageBreaks = False\n\nEnd Sub\n\n_____\n\nSub OptimizeCode_End()\n\nActiveSheet.DisplayPageBreaks = True\nApplication.Calculation = xlCalculationAutomatic\nApplication.EnableEvents = True\nApplication.ScreenUpdating = True\n\nEnd Sub\n\n______\n\nSub GetFromOutlook()\n\nDim OutlookApp As Outlook.Application\nDim OutlookNamespace As Namespace\nDim Folder As MAPIFolder\nDim OutlookMail As Variant\nDim i As Long\nDim j As Long\n\n\nCall OptimizeCode_Begin\n\nSet OutlookApp = New Outlook.Application\nSet OutlookNamespace = OutlookApp.GetNamespace(\"MAPI\")\nSet Folder = OutlookNamespace.GetDefaultFolder(olFolderInbox).Folders(\"Individual Lot Inspections\")\nSet Folder2 = OutlookNamespace.GetDefaultFolder(olFolderInbox).Folders(\"Construction Site Inspections\")\n\ni = 1\n\nFor Each OutlookMail In Folder.Items\n    If OutlookMail.ReceivedTime &gt;= Range(\"From_date\").Value Then\n        Range(\"eMail_subject\").Offset(i, 0).Value = OutlookMail.Subject\n        Range(\"eMail_date\").Offset(i, 0).Value = OutlookMail.ReceivedTime\n        Range(\"eMail_sender\").Offset(i, 0).Value = OutlookMail.SenderName\n        ' Range(\"eMail_text\").Offset(i, 0).Value = OutlookMail.Body\n\n        i = i + 1\n    End If\nNext OutlookMail\n\nj = i + 1\n\nFor Each OutlookMail In Folder2.Items\n    If OutlookMail.ReceivedTime &gt;= Range(\"From_date\").Value Then\n        Range(\"eMail_subject\").Offset(j, 0).Value = OutlookMail.Subject\n        Range(\"eMail_date\").Offset(j, 0).Value = OutlookMail.ReceivedTime\n        Range(\"eMail_sender\").Offset(j, 0).Value = OutlookMail.SenderName\n\n        j = j + 1\n    End If\nNext OutlookMail\n\nSet Folder = Nothing\nSet Folder2 = Nothing\nSet OutlookNamespace = Nothing\nSet OutlookApp = Nothing\n\nCall OptimizeCode_End\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["excel", "vba", "excel-2013"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1538580221, "post_id": 52630192, "comment_id": 92194413, "body": "Do you need the same row value from the other named range as where you find the X in the first? If so you can use the .Row where found. If relative positioning then index perhaps."}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1538580445, "post_id": 52630192, "comment_id": 92194557, "body": "Correct.  If &quot;X&quot; is a cell in the the first named range then i would need the corresponding value from the other named range (from image 1).  Im still a novice when it comes to VBA, so would you be able to provide a code example for me please?"}], "answers": [{"comments": [{"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1538582657, "post_id": 52630786, "comment_id": 92195852, "body": "Thank you.  I used that example to change my code, but now im stuck on how to get the values from <code>InelCode.Cells(counter)</code> to show up in cell I46. like the example in image 2."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1538582762, "post_id": 52630786, "comment_id": 92195923, "body": "If they are in the same sheet  Range(&quot;I46&quot;) = b.Cells(counter)  . Otherwise put the sheet name in front. Worksheets(&quot;mySheet&quot;).Range(&quot;I46&quot;) = b.Cells(counter) You should really always use the parent sheet reference."}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1538582982, "post_id": 52630786, "comment_id": 92196051, "body": "I set the <code>wspGen.Range(&quot;I46&quot;) = InelCode.Cells(counter)</code> but it only shows the last value in range 2 that has an &quot;X&quot; in Range 1.  In this case it would be &quot;P&quot;."}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1538583155, "post_id": 52630786, "comment_id": 92196141, "body": "Since there may be multiple values from range 2 displayed in &quot;I46&quot;, I need all the values from Range 2 that have an &quot;X&quot; in range 1."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1538583194, "post_id": 52630786, "comment_id": 92196163, "body": "That&#39;s easy. You want as a space separated list? See edit."}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1538583765, "post_id": 52630786, "comment_id": 92196445, "body": "Thank you so much for your patience with me and help with this.  It is very much appreciated!"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1538583793, "post_id": 52630786, "comment_id": 92196464, "body": "It&#39;s not a problem. Welcome to SO."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 2, "last_activity_date": 1538583304, "last_edit_date": 1538583304, "creation_date": 1538580961, "answer_id": 52630786, "question_id": 52630192, "link": "https://stackoverflow.com/questions/52630192/for-loop-to-capture-values-in-different-named-ranges/52630786#52630786", "title": "For loop to capture values in different named ranges", "body": "<p>This is a simple example using a counter variable assuming both ranges are single column and aligned. It counts how many cells down the first named range \n (set in variable a) it is before x is found and retrieves the value at the same position in the named range b. Note I am using implicit active sheet references and you should specify the sheet name before the named ranges.</p>\n\n<pre><code>Option Explicit\nPublic Sub test()\n    Dim a As Range, b As Range, rng As Range, counter As Long\n    Set a = Range(\"range1\"): Set b = Range(\"range2\")\n    For Each rng In a\n        counter = counter + 1\n        If rng = \"x\" Then\n            Range(\"I46\") = b.Cells(counter)\n            Exit For\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>Space separated list of all matches:</p>\n\n<pre><code>Option Explicit\nPublic Sub test()\n    Dim a As Range, b As Range, rng As Range, counter As Long, outputString As String\n    Set a = Range(\"range1\"): Set b = Range(\"range2\")\n    For Each rng In a\n        counter = counter + 1\n        If rng = \"x\" Then\n            outputString = outputString &amp; Chr$(32) &amp; b.Cells(counter)\n        End If\n    Next\n    wspGen.Range(\"I46\")  = Trim$(outputString) ' wspGen.Range(\"I46\")  is defined in your code. This is illustrative.\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 52630786, "answer_count": 1, "score": 1, "last_activity_date": 1538583304, "creation_date": 1538579311, "last_edit_date": 1538581024, "question_id": 52630192, "link": "https://stackoverflow.com/questions/52630192/for-loop-to-capture-values-in-different-named-ranges", "title": "For loop to capture values in different named ranges", "body": "<p>I have been looking through multiple posts on looping through multiple named ranges and returning values to another cell. Unfortunately, I am getting stuck on how to loop through two named ranges to return the value from one named range if a cell in another named range is \"X\".</p>\n\n<p>Below are images of the named ranges with values and the intended result in cell I46.  Please note there is no formula in I46.\n<br><br><br>Named Ranges:<br> Range1 &nbsp;&nbsp;&nbsp;Range2</p>\n\n<p><a href=\"https://i.stack.imgur.com/mGvYx.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mGvYx.gif\" alt=\"Named Ranges to loop through\"></a><br><br>Desired result from macro aftter loop is complete: <br>\n<a href=\"https://i.stack.imgur.com/wSn7c.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wSn7c.gif\" alt=\"Result\"></a></p>\n\n<p>Code: <br></p>\n\n<pre><code>    For Each Cell In wspGen.Range(\"Ineligible\")\n    If Cell.Value = vbNullString Then\n        LP.zPledge.Value = \"Y\"\n        wspGen.Range(\"A46\") = \"-\"\n        wspGen.Range(\"AG55\").Value = \"X\"\n    Else\n        If Cell.Value = \"X\" Then\n            wspGen.Range(\"AG55\").Value = vbNullString\n            wspGen.Range(\"A45\").Value = \"N\"\n            LP.zPledge.Value = \"N\"\n            'Copies the corresponding value from range (\"IneligibilityCode\")\n            'if there is an \"X\" in any of the cells in range (\"Ineligible\")\n            'to I46.  This could be multiple combinations of values in range (\"IneligibilityCode\")\n        End If\n    End If\nNext Cell\n</code></pre>\n\n<p><br>\nThank you all for your assistance.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 2, "creation_date": 1538578779, "post_id": 52629965, "comment_id": 92193418, "body": "Welcome to StackOverflow - just so you know, your code (not a picture of the code) needs to be in the question otherwise you will not find many people willing to help."}, {"owner": {"reputation": 19, "user_id": 10443011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e4fae16588cbd920ac1ebd8787de8c0?s=128&d=identicon&r=PG&f=1", "display_name": "AIRShaheen", "link": "https://stackoverflow.com/users/10443011/airshaheen"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 1, "creation_date": 1538579403, "post_id": 52629965, "comment_id": 92193850, "body": "Thanks Sam. Updated."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1538581504, "post_id": 52629965, "comment_id": 92195179, "body": "Is this an actual Excel table?"}], "answers": [{"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 1, "last_activity_date": 1538585902, "creation_date": 1538585902, "answer_id": 52632139, "question_id": 52629965, "link": "https://stackoverflow.com/questions/52629965/vba-if-else-statement-to-copy-and-paste-data-based-on-count-of-column/52632139#52632139", "title": "VBA If/Else Statement to Copy and Paste Data Based on Count of Column", "body": "<p>This will work. You really just need to check if <code>A3</code> has data.</p>\n\n<pre><code>With Worksheets(\"Sheet1\")\n\n    Dim source as Range\n    If Len(.Range(\"A3\")) then \n       Set source = .Range(.Range(\"A2\"),.Range(\"A2\").End(xlDown))\n    Else\n       Set source = .Range(\"A2\")\n    End If\n\nEnd With\n\nDim dest as Range\nSet dest = Worksheets(\"QA\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1)\n\ndest.Resize(source.Rows.Count,1).Value = source.Value\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 10443011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e4fae16588cbd920ac1ebd8787de8c0?s=128&d=identicon&r=PG&f=1", "display_name": "AIRShaheen", "link": "https://stackoverflow.com/users/10443011/airshaheen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1538585902, "creation_date": 1538578635, "last_edit_date": 1538579578, "question_id": 52629965, "link": "https://stackoverflow.com/questions/52629965/vba-if-else-statement-to-copy-and-paste-data-based-on-count-of-column", "title": "VBA If/Else Statement to Copy and Paste Data Based on Count of Column", "body": "<p>I am trying to copy and paste data from the same column (A) in multiple sheets into a single column of a data in a final sheet.</p>\n\n<p>The code I have used so far works perfectly if there is more than one row of data beneath the header row.</p>\n\n<p>The sheet is formatted to include a table beneath the data and if there is only one row of data on the sheet the existing code will copy data from cell A2 to the first cell in the table with data (essentially performing ctrl+shift+down).</p>\n\n<p>I need an if statement to count a range of data (could be A2:A3) and if the count is greater than 1 it would copy all the data down the column to first empty row. Then paste it to the first empty row in Column A of another sheet. Else copy cell A2 and then paste it to the first empty row in column A of another sheet.</p>\n\n<pre><code>Sheets(\"Sheet1\").Select\nIf Range(\"A2:A3\").Count &gt; 1 Then\n    Range(\"A2\",Range(\"A2\").End(xlDown)).Copy Destination:=Sheets(\"QA\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1)  \nElseIf Range(\"A2:A3\").Count = 1 Then\n    Range(\"A2\").Copy  Destination:=Sheets(\"QA\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1)\nEnd If\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1538578454, "post_id": 52629692, "comment_id": 92193183, "body": "Your <code>If</code> statement is incomplete. See <a href=\"https://www.thecodingguys.net/tutorials/visualbasic/vb-if-statement\" rel=\"nofollow noreferrer\">thecodingguys.net/tutorials/visualbasic/vb-if-statement</a> and <a href=\"https://excelmacromastery.com/vba-if/\" rel=\"nofollow noreferrer\">excelmacromastery.com/vba-if</a> and <a href=\"https://docs.microsoft.com/office/vba/language/reference/user-interface-help/ifthenelse-statement\" rel=\"nofollow noreferrer\">docs.microsoft.com/office/vba/language/reference/&hellip;</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1538578557, "post_id": 52629692, "comment_id": 92193260, "body": "VBA&#39;s Today is <code>Date</code> so <code>If cell.Value = Date Then</code>"}, {"owner": {"reputation": 107, "user_id": 10184122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e63fd7c95540ae1f01eed033377722ac?s=128&d=identicon&r=PG&f=1", "display_name": "slomo", "link": "https://stackoverflow.com/users/10184122/slomo"}, "edited": false, "score": 0, "creation_date": 1538578853, "post_id": 52629692, "comment_id": 92193455, "body": "Thanks for the willingness to help, I do not see what&#39;s wrong with me, I do not really understand"}], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 10184122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e63fd7c95540ae1f01eed033377722ac?s=128&d=identicon&r=PG&f=1", "display_name": "slomo", "link": "https://stackoverflow.com/users/10184122/slomo"}, "edited": false, "score": 0, "creation_date": 1538582015, "post_id": 52630360, "comment_id": 92195491, "body": "Your code looks great! But it does not work for me Do I need to paste in the module? Sorry for the trouble"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 107, "user_id": 10184122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e63fd7c95540ae1f01eed033377722ac?s=128&d=identicon&r=PG&f=1", "display_name": "slomo", "link": "https://stackoverflow.com/users/10184122/slomo"}, "edited": false, "score": 0, "creation_date": 1538582701, "post_id": 52630360, "comment_id": 92195882, "body": "@slomo  See my <b>EDIT#1</b>"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 2, "last_activity_date": 1538582642, "last_edit_date": 1538582642, "creation_date": 1538579780, "answer_id": 52630360, "question_id": 52629692, "link": "https://stackoverflow.com/questions/52629692/macro-displays-a-pop-up-message-if-the-date-in-the-cell-applies-today/52630360#52630360", "title": "Macro Displays a pop-up message if the date in the cell applies today", "body": "<p>This sample has a worksheet named <strong><em>list</em></strong>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/mvSok.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mvSok.png\" alt=\"enter image description here\"></a></p>\n\n<p>This code:</p>\n\n<pre><code>Private Sub Workbook_Open()\n    For Each cell In Sheets(\"list\").Range(\"A4:A500\")\n        If cell.Value = Date Then\n            MsgBox cell.Offset(0, 1).Value\n        End If\n    Next cell\nEnd Sub\n</code></pre>\n\n<p>will show <strong><em>gold</em></strong></p>\n\n<p><strong>Note:</strong></p>\n\n<ul>\n<li>we use <code>Date()</code> rather than <code>Today()</code></li>\n<li>we specify the worksheet to examine</li>\n<li>we use <code>Offset</code> to get the column <strong>B</strong> contents</li>\n</ul>\n\n<p><strong>EDIT#1:</strong></p>\n\n<p>Because it is workbook code, it is very easy to install and use:</p>\n\n<ol>\n<li>right-click <code>ThisWorkbook</code> in the left-hand pane of the VBE</li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/Z24J8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Z24J8.png\" alt=\"enter image description here\"></a></p>\n\n<ol start=\"2\">\n<li>select View Code</li>\n<li>paste the stuff in and close the VBE window</li>\n</ol>\n\n<p>If you save the workbook, the macro will be saved with it.\nIf you are using a version of Excel later then 2003, you must save\nthe file as .xlsm rather than .xlsx</p>\n\n<p>To remove the macro:</p>\n\n<ol>\n<li>bring up the VBE windows as above</li>\n<li>clear the code out</li>\n<li>close the VBE window</li>\n</ol>\n\n<p>To learn more about macros in general, see:</p>\n\n<p><a href=\"http://www.mvps.org/dmcritchie/excel/getstarted.htm\" rel=\"nofollow noreferrer\">http://www.mvps.org/dmcritchie/excel/getstarted.htm</a></p>\n\n<p>and</p>\n\n<p><a href=\"http://msdn.microsoft.com/en-us/library/ee814735(v=office.14).aspx\" rel=\"nofollow noreferrer\">http://msdn.microsoft.com/en-us/library/ee814735(v=office.14).aspx</a></p>\n\n<p>To learn more about Event Macros (workbook code), see:</p>\n\n<p><a href=\"http://www.mvps.org/dmcritchie/excel/event.htm\" rel=\"nofollow noreferrer\">http://www.mvps.org/dmcritchie/excel/event.htm</a></p>\n\n<p><strong>Macros must be enabled for this to work!</strong></p>\n"}, {"tags": [], "owner": {"reputation": 355, "user_id": 5965427, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/392fe3505cf5e083f439182bdb518eff?s=128&d=identicon&r=PG&f=1", "display_name": "Senor Penguin", "link": "https://stackoverflow.com/users/5965427/senor-penguin"}, "is_accepted": false, "score": 0, "last_activity_date": 1538579837, "creation_date": 1538579837, "answer_id": 52630375, "question_id": 52629692, "link": "https://stackoverflow.com/questions/52629692/macro-displays-a-pop-up-message-if-the-date-in-the-cell-applies-today/52630375#52630375", "title": "Macro Displays a pop-up message if the date in the cell applies today", "body": "<pre><code>Sub Test()\n\nTodayD = Date\n\n'define sheet\nWith Worksheets(1).Range(\"A4:A500\")\n    Set c = .Find(Date, LookIn:=xlValues)\n    If Not c Is Nothing Then\n        firstAddress = c.Address\n        Do\n            MsgBox \"Here should be the text in column B: \" &amp; firstAddress\n            Set c = .FindNext(c)\n        Loop While Not c Is Nothing And c.Address &lt;&gt; firstAddress\n    End If\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 0, "last_activity_date": 1538583238, "last_edit_date": 1538583238, "creation_date": 1538581890, "answer_id": 52631089, "question_id": 52629692, "link": "https://stackoverflow.com/questions/52629692/macro-displays-a-pop-up-message-if-the-date-in-the-cell-applies-today/52631089#52631089", "title": "Macro Displays a pop-up message if the date in the cell applies today", "body": "<h2>Better late than never</h2>\n\n<pre><code>Option Explicit\nSub TodaysTasks()\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n'Description\n  'In a specified worksheet or the ActiveSheet, searches a specified one column\n  'range and looks for today's date values and when found writes the values of\n  'the next adjacent column to a string and finally outputs the string to a\n  'MsgBox and to the Immediate window.\n'Arguments as constants\n  'cStrWorksheetName\n    'The name of the worksheet. If \"\" then the ActiveSheet object is used.\n  'cStrRange\n    'The range where to search.\n  'cStrTitle\n    'The title of the resulting string\n'Results\n  'A string containing the title and the matching values of the second column.\n\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n'Customize BEGIN -----------------------\n  Const cStrWorksheetName = \"\" 'Worksheet name. If \"\" then ActiveSheet.\n  Const cStrRange = \"A4:A500\"\n  Const cStrTitle = \"My today's tasks\"\n'Customize END -------------------------\n\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n  Dim oWb As Workbook\n  Dim oWs As Worksheet\n  Dim rRng As Range\n  Dim loF1 As Long 'Rows Counter\n  Dim strTasks As String\n\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n  Set oWb = ActiveWorkbook\n  If cStrWorksheetName = \"\" Then\n    Set oWs = oWb.ActiveSheet\n   Else\n    Set oWs = oWb.Worksheets(cStrWorksheetName)\n  End If\n  Set rRng = oWs.Range(cStrRange)\n  'Set the title\n  strTasks = cStrTitle &amp; vbCrLf\n\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n  'Loop through all cells (rows) in first column.\n  For loF1 = 1 To oWs.Range(cStrRange).Rows.Count\n  'Check if value in first column is todays date.\n    If rRng(loF1, 1).Value = Date Then 'It is today's date.\n      'Write value in second column to the string.\n      strTasks = strTasks &amp; vbCrLf &amp; rRng(loF1, 2).Value\n'     Else 'It is not today's date.\n      'skip the row\n    End If\n  Next\n\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n  MsgBox strTasks\n  Debug.Print strTasks\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 10184122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e63fd7c95540ae1f01eed033377722ac?s=128&d=identicon&r=PG&f=1", "display_name": "slomo", "link": "https://stackoverflow.com/users/10184122/slomo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 675, "favorite_count": 0, "accepted_answer_id": 52630360, "answer_count": 3, "score": 0, "last_activity_date": 1538583238, "creation_date": 1538577852, "last_edit_date": 1538578163, "question_id": 52629692, "link": "https://stackoverflow.com/questions/52629692/macro-displays-a-pop-up-message-if-the-date-in-the-cell-applies-today", "title": "Macro Displays a pop-up message if the date in the cell applies today", "body": "<p>I have a list of tasks in Excel, I want every time I open the file, and there is a cell with a date that applies today, will pop a message with the contents of the task that applies today</p>\n\n<p>I tried to do this code, but it did not work</p>\n\n<pre><code>Private Sub Workbook_Open()\n    For Each cell In Range(\"A4:A500\")\n        If cell.Value - today Then\n            MsgBox \"Here should be the text in column B\"\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>I would appreciate any help</p>\n"}, {"tags": ["xml", "vba", "ms-access", "import", "stylesheet"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1538673819, "post_id": 52629603, "comment_id": 92236344, "body": "<i>MS Access brings in the Errors as a separate table</i> - not sure what this means. Is <code>Errors</code> your import XML data? Or does this refer to error messages / import errors?"}, {"owner": {"reputation": 11, "user_id": 10297290, "user_type": "registered", "profile_image": "https://graph.facebook.com/1817253541663683/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/10297290/mark"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1539092913, "post_id": 52629603, "comment_id": 92370576, "body": "The wizard creates Errors as the child table which it is since there can be more than one error posted. THe XML document has &quot;Errors&quot; and &quot;Error&quot; tags/nodes."}], "owner": {"reputation": 11, "user_id": 10297290, "user_type": "registered", "profile_image": "https://graph.facebook.com/1817253541663683/picture?type=large", "display_name": "Mark", "link": "https://stackoverflow.com/users/10297290/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1538673673, "creation_date": 1538577590, "last_edit_date": 1538673673, "question_id": 52629603, "link": "https://stackoverflow.com/questions/52629603/importing-xml-data-into-ms-access-runtime-error", "title": "Importing XML data into MS Access runtime error", "body": "<p>When importing using the MS Access wizard, all goes well. I specify the XML and XSLT files that create the two tables. Saving the import steps and trying to run that fails. Here is an example XML and XSLT files, respectively. MS Access brings in the Errors as a separate table using the PWSID and VIOID values as the key.</p>\n\n<pre><code>    &lt;?xml version=\"1.0\"?&gt;\n    &lt;Violations&gt;\n     &lt;Violation&gt;\n      &lt;ViolationDetail&gt;\n       &lt;PWSID&gt;TX9999999&lt;/PWSID&gt;\n       &lt;VIOID&gt;123456789&lt;/VIOID&gt;\n       &lt;DATAORIGINCODE&gt;S&lt;/DATAORIGINCODE&gt;\n       &lt;CCODE&gt;7500&lt;/CCODE&gt;\n       &lt;VCODE&gt;75&lt;/VCODE&gt;\n       &lt;BEGINDATE&gt;2015-04-28&lt;/BEGINDATE&gt;\n       &lt;Errors&gt;\n          &lt;Error&gt;\n            &lt;ErrorDescription&gt;\n                Error description here\n            &lt;/ErrorDescription&gt;\n            &lt;ErrorCode&gt;ERR0037&lt;/ErrorCode&gt;\n            &lt;/Error&gt;\n       &lt;/Errors&gt;\n      &lt;/ViolationDetail&gt;\n     &lt;/Violation&gt;\n     &lt;Violation&gt;\n      &lt;ViolationDetail&gt;\n       &lt;PWSID&gt;TX9999999&lt;/PWSID&gt;\n       &lt;VIOID&gt;234567890&lt;/VIOID&gt;\n       &lt;DATAORIGINCODE&gt;S&lt;/DATAORIGINCODE&gt;\n       &lt;CCODE&gt;7500&lt;/CCODE&gt;\n       &lt;VCODE&gt;71&lt;/VCODE&gt;\n       &lt;BEGINDATE&gt;2015-05-15&lt;/BEGINDATE&gt;\n       &lt;Errors&gt;\n          &lt;Error&gt;\n            &lt;ErrorDescription&gt;\n                Error description here\n            &lt;/ErrorDescription&gt;\n            &lt;ErrorCode&gt;ERR0048&lt;/ErrorCode&gt;\n            &lt;/Error&gt;\n       &lt;/Errors&gt;\n      &lt;/ViolationDetail&gt;\n     &lt;/Violation&gt;\n    &lt;/Violations&gt;\n\n    &lt;xsl:stylesheet version=\"1.0\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\"&gt;\n        &lt;xsl:output indent=\"yes\"/&gt;\n        &lt;xsl:strip-space elements=\"*\"/&gt;\n\n        &lt;xsl:template match=\"/\"&gt;\n            &lt;dataroot&gt;\n                &lt;xsl:apply-templates select=\"@*|node()\"/&gt;\n            &lt;/dataroot&gt;\n        &lt;/xsl:template&gt;\n\n        &lt;xsl:template match=\"@*|node()\"&gt;\n            &lt;xsl:copy&gt;\n                &lt;xsl:apply-templates select=\"@*|node()\"/&gt;\n            &lt;/xsl:copy&gt;\n        &lt;/xsl:template&gt;\n\n        &lt;xsl:template match=\"ERRORS\"&gt;\n            &lt;xsl:apply-templates select=\"@*|node()\"/&gt;\n        &lt;/xsl:template&gt;\n\n        &lt;xsl:template match=\"ERROR\"&gt;\n            &lt;ERROR&gt;\n                &lt;PWSID&gt;&lt;xsl:value-of select=\"../../PWSID\"/&gt;&lt;/PWSID&gt;\n                &lt;xsl:apply-templates select=\"@*|node()\"/&gt;\n                &lt;VIOID&gt;&lt;xsl:value-of select=\"../../VIOID\"/&gt;&lt;/VIOID&gt;\n                &lt;xsl:apply-templates select=\"@*|node()\"/&gt;\n            &lt;/ERROR&gt;\n        &lt;/xsl:template&gt;\n\n    &lt;/xsl:stylesheet&gt;\n</code></pre>\n\n<p>My attempt at the VBA code is this which I modified from a solution found thru searches:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Sub importErrorFiles()\n    ' REFERENCE MS XML, v6.0\n    Dim xmlDoc As New MSXML2.DOMDocument60\n    Dim xslDoc As New MSXML2.DOMDocument60\n    Dim newDoc As New MSXML2.DOMDocument60\n\n    Dim strFileXML As String, strFileXSL As String\n    Dim strPathXML As String, strPathXSL As String\n\n    strPathXSL = CurrentProject.Path &amp; \"\\xslSheets\\\"\n    strPathXML = CurrentProject.Path &amp; \"\\workingReports\\\"\n    strFileXML = Dir(strPathXML &amp; \"*.xml\")\n\n    While strFileXML &lt;&gt; \"\"\n        ' REINITIALIZE DOM OBJECTS\n        Set xslDoc = New MSXML2.DOMDocument60\n        Set xmlDoc = New MSXML2.DOMDocument60\n        Set newDoc = New MSXML2.DOMDocument60\n\n        strFileXSL = strPathXSL &amp; Replace(strFileXML, \"xml\", \"xslt\")\n\n        If fileExists(strFileXSL) Then\n\n            ' LOAD XML SOURCE\n            xmlDoc.Load strPathXML &amp; strFileXML\n\n            ' LOAD XSL FILE\n            xslDoc.Load strPathXSL &amp; strFileXSL\n\n            ' TRANSFORM SOURCE\n            xmlDoc.transformNodeToObject xslDoc, newDoc\n            newDoc.Save strPathXML &amp; \"temp.xml\"\n\n            ' APPEND TO TABLES\n            Application.ImportXML strPathXML &amp; \"temp.xml\", acAppendData\n            strFile = Dir()\n        End If\n    Wend\n\n   ' RELEASE DOM OBJECTS\n    Set xmlDoc = Nothing: Set xslDoc = Nothing: Set newDoc = Nothing\nEnd Sub\n</code></pre>\n\n<p>The error occurs on the <code>transformNodeToObject</code> line: </p>\n\n<blockquote>\n  <p>The Stylesheet does not contain a document element. The stylesheet appears to be empty, or it may not be a well formed XML document.</p>\n</blockquote>\n\n<p>Oh and <code>fileExists</code> is a boolean function that does work.\nThanks for any help.</p>\n"}, {"tags": ["vba", "excel", "dictionary"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1538577458, "post_id": 52629442, "comment_id": 92192451, "body": "Why would you use a variable called Key to iterate through the dictionary&#39;s Keys? Have you tried swapping out Key for k? e.g. dim k as variant, for each k in reportDict, etc."}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 2, "creation_date": 1538577621, "post_id": 52629442, "comment_id": 92192578, "body": "If you&#39;re getting past the statement previous to your error line, which says <code>Set myInsert = reportDict.Item(Key)</code>, that indicates the problem is not necessarily with your dictionary. Can you create a <code>ListObject</code> variable and assign your table to it, in order to guarantee you have a valid table on the sheet?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1538578173, "post_id": 52629442, "comment_id": 92192975, "body": "<code>wkBook</code> is redundant, it&#39;s <code>ThisWorkbook</code>, which means you&#39;re referring to <i>the workbook that&#39;s executing this code</i>, which means <code>wkSheet</code> is likely redundant as well - give it a <i>code name</i> (F4 and edit its <code>(Name)</code> property, e.g. <code>MasterSheet</code>) and use that identifier instead: <code>MasterSheet.Range(...)</code> becomes legal code, and you just removed the need to dereference a compile-time existing worksheet at run-time."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1538578430, "post_id": 52629442, "comment_id": 92193168, "body": "Also, and probably more relevant to the issue at hand, the way you&#39;re populating your dictionary is ambiguous: <code>reportDict.Add Cells(4, startColumn + i), Cells(startRow, startColumn + i)</code> - is this adding the <code>Range</code> object reference for that cell, or is it adding that cell&#39;s <code>Value</code>? If you mean to add the <code>Value</code>, <i>be explicit about it</i>. If <code>IsObject(myInsert)</code> is <code>True</code>, then you&#39;re storing object references, not values. <a href=\"http://rubberduckvba.com\" rel=\"nofollow noreferrer\">Rubberduck</a> would flag a bunch of implicit default member calls... and could help you keep your indentation more consistent."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1538580185, "post_id": 52629442, "comment_id": 92194393, "body": "Your code can&#39;t possibly run as-is. <code>DeleteTableRows (ThisWorkbook.Worksheets(&quot;Master&quot;).ListObjects(&quot;MasterSheet&quot;&zwnj;&#8203;))</code> is a compile-time type mismatch error."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1538577916, "creation_date": 1538577916, "answer_id": 52629712, "question_id": 52629442, "link": "https://stackoverflow.com/questions/52629442/object-or-with-variable-not-set/52629712#52629712", "title": "Object or With Variable Not Set", "body": "<p>You need to iterate through the dictionary's Keys collection.</p>\n\n<pre><code>dim k as variant, myInsert As Variant\n\nfor each k in reportDict.keys\n    debug.print reportDict.Item(k)\nnext k\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 241, "user_id": 6654790, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9019a96fdfbf926d154a20a696611015?s=128&d=identicon&r=PG&f=1", "display_name": "bdpolinsky", "link": "https://stackoverflow.com/users/6654790/bdpolinsky"}, "edited": false, "score": 0, "creation_date": 1538596454, "post_id": 52630397, "comment_id": 92202688, "body": "Hi yes thank you. It turns out that while yes it was a problem, the problem is that I really didn&#39;t have any ideas about  how tables in excel work. So I was trying to add information to a table which did not have any rows, even though those rows were visually displayed on my spreadsheet."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 241, "user_id": 6654790, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9019a96fdfbf926d154a20a696611015?s=128&d=identicon&r=PG&f=1", "display_name": "bdpolinsky", "link": "https://stackoverflow.com/users/6654790/bdpolinsky"}, "edited": false, "score": 0, "creation_date": 1538596681, "post_id": 52630397, "comment_id": 92202788, "body": "In the future please make sure the code you&#39;re posting actually reproduces the problem you&#39;re asking about. See <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> for more information."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 2, "last_activity_date": 1538579884, "creation_date": 1538579884, "answer_id": 52630397, "question_id": 52629442, "link": "https://stackoverflow.com/questions/52629442/object-or-with-variable-not-set/52630397#52630397", "title": "Object or With Variable Not Set", "body": "<p>Implicit default member calls are plaguing your code all over.</p>\n\n<pre><code>reportDict.Add Cells(4, startColumn + i), Cells(startRow, startColumn + i)\n</code></pre>\n\n<p>That's implicitly accessing <code>Range.[_Default]</code> off whatever worksheet is currently the <code>ActiveSheet</code> (did you mean that to be <code>wkSheet.Cells</code>?), to get the <code>Key</code> - since the <code>Key</code> parameter is a <code>String</code>, <code>Range.[_Default]</code> is implicitly coerced into one, and you have a string key. The actual dictionary item at that key though, isn't as lucky.</p>\n\n<p>Here's a MCVE:</p>\n\n<pre><code>Public Sub Test()\n    Dim d As Dictionary\n    Set d = New Dictionary\n    d.Add \"A1\", Cells(1, 1)\n    Debug.Print IsObject(d(\"A1\"))\nEnd Sub\n</code></pre>\n\n<p>This procedure prints <code>True</code> to the debug pane (Ctrl+G): what you're storing in your dictionary isn't a bunch of string values, but a bunch of <code>Range</code> object references.</p>\n\n<p>So when you do this:</p>\n\n<pre><code>Dim myInsert As Variant\nSet myInsert = reportDict.Item(Key)\n</code></pre>\n\n<p>You might as well have declared <code>myInsert As Range</code>, for it is one.</p>\n\n<p>This is where things get interesting:</p>\n\n<pre><code>MsgBox (myInsert)\n</code></pre>\n\n<p>Nevermind the superfluous parentheses that force-evaluate the object's default member and pass it <code>ByVal</code> to the <code>MsgBox</code> function - here you're implicitly converting <code>Range.[_Default]</code> into a <code>String</code>. That probably works.</p>\n\n<p>So why is this failing then?</p>\n\n<pre><code>wkSheet.ListObjects(1).DataBodyRange(2, 1) = reportDict.Item(Key)\n</code></pre>\n\n<p>Normally, it wouldn't. VBA would happily do this:</p>\n\n<pre><code>wkSheet.ListObjects(1).DataBodyRange.Cells(2, 1).[_Default] = reportDict.Item(Key).[_Default]\n</code></pre>\n\n<p>And write the value in the <code>DataBodyRange</code> of the <code>ListObject</code> at the specified location.</p>\n\n<p><strong>I think that's all just red herring. Write explicit code: if you mean to store the <code>Value</code> of a cell, <em>store the <code>Value</code> of a cell</em>. If you mean to assign the <code>Value</code> of a cell, <em>assign the <code>Value</code> of a cell</em></strong>.</p>\n\n<p>I can't replicate error 91 with this setup.</p>\n\n<p>This, however:</p>\n\n<pre><code>DeleteTableRows (ThisWorkbook.Worksheets(\"Master\").ListObjects(\"MasterSheet\"))\n</code></pre>\n\n<p>...is <em>also</em> force-evaluating a <code>ListObject</code>'s default member - so <code>DeleteTableRows</code> isn't receiving a <code>ListObject</code>, it's getting a <code>String</code> that contains the name of the object you've just dereferenced... but <code>DeleteTableRows</code> takes a <code>ListObject</code> parameter, so there's no way that code can even <em>get</em> to run <code>FillTableRows</code> - it has to blow up with a <em>type mismatch</em> before <code>DeleteTableRows</code> even gets to enter. In fact, <strong>it's a compile-time error</strong>.</p>\n\n<p>So this is a rather long answer that doesn't get to the reason for error 91 on that specific line (I can't reproduce it), but highlights a metric ton of serious problems with your code that <em>very likely</em> <strong>are</strong> related to this error you're getting. Hope it helps.</p>\n"}], "owner": {"reputation": 241, "user_id": 6654790, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9019a96fdfbf926d154a20a696611015?s=128&d=identicon&r=PG&f=1", "display_name": "bdpolinsky", "link": "https://stackoverflow.com/users/6654790/bdpolinsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1538579884, "creation_date": 1538577162, "question_id": 52629442, "link": "https://stackoverflow.com/questions/52629442/object-or-with-variable-not-set", "title": "Object or With Variable Not Set", "body": "<pre><code>Option Explicit\nPublic Sub consolidateList()\n\n    DeleteTableRows (ThisWorkbook.Worksheets(\"Master\").ListObjects(\"MasterSheet\"))\n\n    FillTableRows\n\nEnd Sub\n\nPrivate Sub FillTableRows()\n\n    'set up worksheet objects\n    Dim wkSheet As Worksheet\n    Dim wkBook As Workbook\n    Dim wkBookPath As String\n    Set wkBook = ThisWorkbook\n    wkBookPath = wkBook.Path\n\n\n    Set wkSheet = wkBook.Worksheets(\"Master\")\n\n    'set up file system objects\n    Dim oFile As Object\n    Dim oFSO As Object\n    Dim oFolder As Object\n    Dim oFiles As Object\n\n    Set oFSO = CreateObject(\"Scripting.FileSystemObject\")\n    Set oFolder = oFSO.GetFolder(wkBookPath)\n    Set oFiles = oFolder.Files\n\n\n    'set up loop\n\n    Dim checkBook As Excel.Workbook\n    Dim reportDict As Dictionary\n\n    Application.ScreenUpdating = False\n\n\n\n    'initial coordinates\n    Dim startRow As Long\n    Dim startColumn As Long\n\n\n    startColumn = 3\n\n    Dim i As Long 'tracks within the row of the sheet where information is being pulled from\n    Dim k As Long 'tracks the row where data is output on\n    Dim j As Long 'tracks within the row of the sheet where the data is output on\n\n    Dim Key As Variant\n\n    j = 1\n    k = wkSheet.Range(\"a65536\").End(xlUp).Row + 1\n\n\n    Dim l As Long\n\n\n    'look t Set checkBook = Workbooks.Open(oFile.Path)hrough folder and then save it to temp memory\n    On Error GoTo debuger\n\n        For Each oFile In oFiles\n            startRow = 8\n\n\n            'is it not the master sheet? check for duplicate entries\n            'oFile.name is the name of the file being scanned\n\n\n                'is it an excel file?\n                If Mid(oFile.Name, Len(oFile.Name) - 3, 4) = \".xls\" Or Mid(oFile.Name, Len(oFile.Name) - 3, 4) = \".xlsx\" Then\n\n                    Set checkBook = Workbooks.Open(oFile.Path)\n\n                    For l = startRow To 600\n\n                        If Not (IsEmpty(Cells(startRow, startColumn))) Then\n\n\n                            'if it is, time do some calculations\n\n                            Set reportDict = New Dictionary\n\n                            'add items of the payment\n\n                            For i = 0 To 33\n                                If Not IsEmpty(Cells(startRow, startColumn + i)) Then\n                                    reportDict.Add Cells(4, startColumn + i), Cells(startRow, startColumn + i)\n                                End If\n                            Next i\n\n\n                            For i = startRow To 0 Step -1\n\n                                    If Not IsEmpty(Cells(i, startColumn - 1)) Then\n                                         reportDict.Add \"Consumer Name\", Cells(i, startColumn - 1)\n                                         Exit For\n                                    End If\n                            Next i\n\n\n                                'key is added\n                                For Each Key In reportDict\n                                    'wkSheet.Cells(k, j) = reportDict.Item(Key)\n\n\n                                    Dim myInsert As Variant\n                                    Set myInsert = reportDict.Item(Key)\n\n                                    MsgBox (myInsert)\n\n                                    wkSheet.ListObjects(1).DataBodyRange(2, 1) = reportDict.Item(Key)\n                                    j = j + 1\n\n                                Next Key\n                                    wkSheet.Cells(k, j) = wkSheet.Cells(k, 9) / 4\n                                    wkSheet.Cells(k, j + 1) = oFile.Name\n    '\n                            k = k + 1\n\n                         '   Set reportDict = Nothing\n                            j = 1\n                        Else\n                            l = l + 1\n\n                        End If\n                        startRow = startRow + 1\n\n                   Next l\n\n                   checkBook.Close\n                End If\n        '        Exit For\n\n        Next oFile\n\n\nExit Sub\ndebuger:\n    MsgBox (\"Error on: \" &amp; Err.Source &amp; \" in file \" &amp; oFile.Name &amp; \", error is \" &amp; Err.Description)\n\n\n\nEnd Sub\n\n\nSub DeleteTableRows(ByRef Table As ListObject)\n    On Error Resume Next\n    '~~&gt; Clear Header Row `IF` it exists\n    Table.DataBodyRange.ClearContents\n    '~~&gt; Delete all the other rows `IF `they exist\n    Table.DataBodyRange.Offset(1, 0).Resize(Table.DataBodyRange.Rows.count - 1, _\n    Table.DataBodyRange.Columns.count).Rows.Delete\n    On Error GoTo 0\nEnd Sub\n</code></pre>\n\n<p>Greetings. The above code consolidates a folder of data that's held on excel spreadsheets into one master excel spreadsheet. The goal is to run a macro on Excel Spreadsheet named master on the worksheet named master which opens up other excel workbooks in the folder, takes the information, and puts it into a table in the worksheet \"master\". After which point, it becomes easy to see the information; so instead of it being held on hundreds of worksheets, the records are held on one worksheet.</p>\n\n<p>The code uses a dictionary (reportDict) to temporarily store the information that is needed from the individual workbooks. The goal then is to take that information and place it in the master table at the bottom row, and then obviously add a new row either after a successful placement or before an attempted placement of data. </p>\n\n<p>The code fails at the following line:</p>\n\n<pre><code>wkSheet.ListObjects(1).DataBodyRange(2, 1) = reportDict.Item(Key)\n</code></pre>\n\n<p>The failure description is \"object or with variable not set\" and so the issue is with the reportDict.Item(Key). My guess is that somehow VBA is not recognizing the dictionary item as stable, but I don't know how to correct this. Eventually the goal is to have code which does:</p>\n\n<pre><code>for each key in reportDict\n  - place the item which is mapped to the key at a unique row,column in the master table\n  - expand the table to accomodate necessary data\nnext key\n</code></pre>\n"}, {"tags": ["vba", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10451426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0ac9fedfb6aab4448a7fa1388190f8a?s=128&d=identicon&r=PG&f=1", "display_name": "Lena Kire", "link": "https://stackoverflow.com/users/10451426/lena-kire"}, "edited": false, "score": 0, "creation_date": 1538579835, "post_id": 52629300, "comment_id": 92194157, "body": "Thanks, Steve! The first code works perfect!  But the 2nd has the same error as before, just for info. Don&#39;t know why."}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "reply_to_user": {"reputation": 3, "user_id": 10451426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0ac9fedfb6aab4448a7fa1388190f8a?s=128&d=identicon&r=PG&f=1", "display_name": "Lena Kire", "link": "https://stackoverflow.com/users/10451426/lena-kire"}, "edited": false, "score": 0, "creation_date": 1538669259, "post_id": 52629300, "comment_id": 92234069, "body": "@LenaKire Glad it&#39;s working (at least the one method). But I just tried the other again here and it works. Odd!"}], "tags": [], "owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "is_accepted": true, "score": 0, "last_activity_date": 1538576746, "creation_date": 1538576746, "answer_id": 52629300, "question_id": 52628906, "link": "https://stackoverflow.com/questions/52628906/vba-powerpoint-objectsgroup-issue-integer-out-of-range/52629300#52629300", "title": "VBA PowerPoint &quot;ObjectsGroup&quot; issue &quot;Integer out of range&quot;", "body": "<p>Grouping via CommandBars.ExecuteMso requires that the shapes to be grouped be selected. Creating a shaperange doesn't implicitly select the shapes in the range.</p>\n\n<p>Try this instead:</p>\n\n<pre><code>Sub Test2()\nDim sld As Slide\nDim shp1 As Shape\nDim shp2 As Shape\nDim oshpR As ShapeRange\n\nSet sld = Application.ActiveWindow.View.Slide\nSet shp1 = ActivePresentation.Slides(1).Shapes.AddShape(msoShapeOval, 300, 100, 50, 50)\nSet shp2 = ActivePresentation.Slides(1).Shapes.AddShape(msoShapePie, 300, 100, 50, 50)\n'Set oshpR = sld.Shapes.Range(Array(shp1.ZOrderPosition, shp2.ZOrderPosition))\n' msoTrue forces a new selection\nshp1.Select msoTrue\n' msoFalse adds the shape to the current selection\nshp2.Select msoFalse\nCommandBars.ExecuteMso (\"ObjectsGroup\")\nEnd Sub\n</code></pre>\n\n<p>You could also just select the shaperange you've defined:</p>\n\n<pre><code>Set oshpR = sld.Shapes.Range(Array(shp1.ZOrderPosition, shp2.ZOrderPosition))\noshpR.Select msoTrue\nCommandBars.ExecuteMso (\"ObjectsGroup\")\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10451426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0ac9fedfb6aab4448a7fa1388190f8a?s=128&d=identicon&r=PG&f=1", "display_name": "Lena Kire", "link": "https://stackoverflow.com/users/10451426/lena-kire"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 343, "favorite_count": 0, "accepted_answer_id": 52629300, "answer_count": 1, "score": 0, "last_activity_date": 1538576746, "creation_date": 1538575671, "question_id": 52628906, "link": "https://stackoverflow.com/questions/52628906/vba-powerpoint-objectsgroup-issue-integer-out-of-range", "title": "VBA PowerPoint &quot;ObjectsGroup&quot; issue &quot;Integer out of range&quot;", "body": "<p>I found a code how to make <a href=\"https://stackoverflow.com/questions/29863568/powerpoint-vba-harvey-balls\">Powerpoint VBA Harvey balls</a>\nand I changed the last line to <code>CommandBars.ExecuteMso (\"ObjectsGroup\")</code> instead of <code>CommandBars.ExecuteMso (\"ShapesCombine\")</code>.\nThe first run of macro went fine, but when I run again (the first harvey ball was on slide) I had the error </p>\n\n<blockquote>\n  <p><em>Shapes (unknow member): Integer out of range. [#]is not in the valid\n  range of [#] to [#]</em></p>\n</blockquote>\n\n<p>on the line <code>Set oshpR = sld.Shapes.Range(Array(shp1.ZOrderPosition, shp2.ZOrderPosition))</code></p>\n\n<p>If the shapes combined into one - there is no error. It appears with the group set only. I need this shapes as the group set on one slide. And there could be multiple sets on the slide. </p>\n\n<p>Can you, please, tell me who to fix it? I assume it could be a problem, because it can be a lot of another groups sets (not harvey balls) on the slide.</p>\n\n<p>Thanks,\nLena</p>\n\n<p><pre>Sub Test2()\nDim sld As Slide\nDim shp1 As Shape\nDim shp2 As Shape\nDim oshpR As ShapeRange</p>\n\n<code>Set sld = Application.ActiveWindow.View.Slide\nSet shp1 = ActivePresentation.Slides(1).Shapes.AddShape(msoShapeOval, 300, 100, 50, 50)\nSet shp2 = ActivePresentation.Slides(1).Shapes.AddShape(msoShapePie, 300, 100, 50, 50)\nSet oshpR = sld.Shapes.Range(Array(shp1.ZOrderPosition, shp2.ZOrderPosition))\nCommandBars.ExecuteMso (\"ObjectsGroup\") End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "macos", "xmlhttprequest", "msxml2"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1538579581, "post_id": 52628834, "comment_id": 92193977, "body": "Not sure  but mac web answers I have seen leverge libc.dylib / cURL. A POST example that may have worked: <a href=\"https://stackoverflow.com/a/34003425/6241235\">stackoverflow.com/a/34003425/6241235</a> . GET is easier and you have a variety of methods available e.g. <a href=\"http://www.agentjim.com/MVP/Excel/WebQueryHowTo.html\" rel=\"nofollow noreferrer\">agentjim.com/MVP/Excel/WebQueryHowTo.html</a>"}, {"owner": {"reputation": 6046, "user_id": 1501285, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/b742182dd480420da7e0e9fe357b2c04?s=128&d=identicon&r=PG", "display_name": "Bob van Luijt", "link": "https://stackoverflow.com/users/1501285/bob-van-luijt"}, "edited": false, "score": 0, "creation_date": 1562790523, "post_id": 52628834, "comment_id": 100492377, "body": "Any updates? Did you get it to work?"}], "owner": {"reputation": 29, "user_id": 10451723, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-K4ZCiCax-mQ/AAAAAAAAAAI/AAAAAAAACwA/MqKkw-0sNG4/photo.jpg?sz=128", "display_name": "Dennys Lopes", "link": "https://stackoverflow.com/users/10451723/dennys-lopes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1858, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1538640449, "creation_date": 1538575416, "last_edit_date": 1538640449, "question_id": 52628834, "link": "https://stackoverflow.com/questions/52628834/web-services-in-vba-using-msxml-serverxmlhttp-on-mac", "title": "Web Services in VBA using MSXML.ServerXMLHTTP on Mac", "body": "<p>I have an Add-In for Excel that, at one point, I need to send and receive data via Web Services using the Microsoft XML DLLs. </p>\n\n<p>The problem is that now <strong>I need to make this Add-in available for Mac</strong>.</p>\n\n<p>Right from the outset I came across a problem, <code>MSXML2.XMLHTTP</code> is not available for Mac.</p>\n\n<pre><code>Public Function PostWebservice(ByVal AsmxUrl As String, ByVal SoapActionUrl _\n        As String, ByVal XmlBody As String, sPOST As String) As String\n\n    Dim objDom As Object, objXmlHttp As Object, strRet As String\n    Dim intPos1 As Integer, intPos2 As Integer\n    Set objDom = CreateObject(\"MSXML2.DOMDocument\") 'Create DOMDocument/XMLHTTP\n    Set objXmlHttp = CreateObject(\"MSXML2.XMLHTTP\")\n    objDom.async = False 'Load XML\n    objDom.LoadXML XmlBody\n\n    If (sPOST = \"\") Then\n        objXmlHttp.Open \"GET\", AsmxUrl, False 'Open the webservice\n        objXmlHttp.setRequestHeader \"Content-Type\", _\n            \"text/xml; charset=utf-8\" 'Create headings\n        objXmlHttp.setRequestHeader \"SOAPAction\", SoapActionUrl\n        objXmlHttp.setRequestHeader \"Accept\", \"application/vnd.hmrc.1.0+json\"\n        objXmlHttp.send objDom.XML 'Send XML command\n    Else\n        objXmlHttp.Open \"POST\", AsmxUrl, False\n        objXmlHttp.setRequestHeader \"Content-Type\", _\n            \"application/x-www-form-urlencoded\"\n        objXmlHttp.send sPOST\n    End If\n\n    strRet = objXmlHttp.ResponseText 'Get all response text from webservice\n    Set objXmlHttp = Nothing 'Close object\n    intPos1 = InStr(strRet, \"Result&gt;\") + 7 'Extract result\n    intPos2 = InStr(strRet, \"&lt;!--\")\n\n    If intPos1 &gt; 7 And intPos2 &gt; 0 Then\n        strRet = Mid(strRet, intPos1, intPos2 - intPos1)\n    End If\n    PostWebservice = strRet 'Return result\n    Debug.Print strRet\n    Exit Function\n\nErr_PW:\n    PostWebservice = \"Error: \" &amp; Err.Number &amp; \" - \" &amp; Err.Description\nEnd Function\n</code></pre>\n\n<p>Does anyone know of any way to send and receive data via WebService (<code>GET</code> and <code>POST</code>) using VBA but that is compatible with Mac ??</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 1, "creation_date": 1538574623, "post_id": 52628517, "comment_id": 92190660, "body": "The cell could be empty or of a different type of value. Add a check for <code>IsEmpty(cell.Value)</code> and possibly <code>IsNumeric(cell.Value)</code>."}, {"owner": {"reputation": 37, "user_id": 10451617, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7285fe17456b3be2ac20711c813c17d2?s=128&d=identicon&r=PG&f=1", "display_name": "user10451617", "link": "https://stackoverflow.com/users/10451617/user10451617"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1538575448, "post_id": 52628517, "comment_id": 92191157, "body": "Hey Peter, thanks for the comment! The cells not empty and is a numeric value so don&#39;t think that&#39;s the problem!"}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 1, "creation_date": 1538575790, "post_id": 52628517, "comment_id": 92191376, "body": "Try putting a temporary debug statement in your loop to check your values, perhaps <code>Debug.Print &quot;cell=&quot; &amp; cell.Value &amp; &quot;, v=&quot; &amp; v</code>. Clearly some type mismatch is occurring."}, {"owner": {"reputation": 968, "user_id": 5910169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a40180e3fa49fbf4e55145adf54d9?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Ball", "link": "https://stackoverflow.com/users/5910169/frank-ball"}, "edited": false, "score": 0, "creation_date": 1538578015, "post_id": 52628517, "comment_id": 92192863, "body": "Just a quick observation: Avoid using reserved terms like &quot;row&quot; and &quot;column&quot; as variable names.  It can create confusion in your code.  Using variable names that are somewhat descriptive can help to provide you with a bit of self-documentation.  For example using &quot;foundRow&quot; instead of &quot;row&quot; makes it very clear to anyone else looking at your code what the variable&#39;s purpose is."}, {"owner": {"reputation": 968, "user_id": 5910169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a40180e3fa49fbf4e55145adf54d9?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Ball", "link": "https://stackoverflow.com/users/5910169/frank-ball"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1538578282, "post_id": 52628517, "comment_id": 92193048, "body": "If v is numeric, then declare it as such, instead of using &quot;Variant&quot;.  By using &quot;Variant&quot;, you never know what your datatype will be.  Also, as @PeterT said, you should still check to confirm that the value in Sheets(&quot;WIP&quot;).Range(&quot;AC77&quot;).Value is truly a numeric value.  Since you can have values that appear to be numeric, but are actually text, checking for the validity of the data is critical."}, {"owner": {"reputation": 37, "user_id": 10451617, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7285fe17456b3be2ac20711c813c17d2?s=128&d=identicon&r=PG&f=1", "display_name": "user10451617", "link": "https://stackoverflow.com/users/10451617/user10451617"}, "edited": false, "score": 0, "creation_date": 1538579424, "post_id": 52628517, "comment_id": 92193866, "body": "Thanks for the advice Frank, I am very new to VBA so it is all very appreciated! I have put the data in to that cell myself though and have double checked, definitely numeric!"}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1538581674, "post_id": 52628517, "comment_id": 92195288, "body": "You can type values into a cell and it can show a number, but still be formatted as text. If you don&#39;t want to perform a check in your VBA code, then you can visually check by looking at the <i>Number</i> group on the <i>Home</i> ribbon menu. That will show the format of the cell. Bottom line is though, we&#39;re not getting enough information about your situation to help you solve the problem. Did you try the <code>Debug</code> statements and was it helpful?"}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 10224846, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JDvlcTAA5jU/AAAAAAAAAAI/AAAAAAAAABI/zwAH16SF9Hw/photo.jpg?sz=128", "display_name": "geoff cahill", "link": "https://stackoverflow.com/users/10224846/geoff-cahill"}, "is_accepted": true, "score": 0, "last_activity_date": 1538581678, "creation_date": 1538581678, "answer_id": 52631020, "question_id": 52628517, "link": "https://stackoverflow.com/questions/52628517/how-to-search-specific-column-within-range-in-vba/52631020#52631020", "title": "How to search specific column within range in VBA", "body": "<p>The '.Cells' property needs to be specified for the range object in the second example:</p>\n\n<pre><code>Sub B()\n\n    Dim rng As Range\n    Dim v As Variant\n    Dim x As Variant\n    Dim row As Long\n\n    Set rng = Range(\"A2:BT72\")\n    v = Sheets(\"WIP\").Range(\"AC77\").Value\n    x = Sheets(\"WIP\").Range(\"AF77\").Value\n\n    For Each cell In rng.Columns(x - 25).Cells\n        If cell.Value &gt; v Then\n            row = cell.row\n            Exit For\n        End If\n    Next\n    Sheets(\"WIP\").Range(\"AG77\").Value = row + 25\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 10451617, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7285fe17456b3be2ac20711c813c17d2?s=128&d=identicon&r=PG&f=1", "display_name": "user10451617", "link": "https://stackoverflow.com/users/10451617/user10451617"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "accepted_answer_id": 52631020, "answer_count": 1, "score": 0, "last_activity_date": 1538581678, "creation_date": 1538574414, "question_id": 52628517, "link": "https://stackoverflow.com/questions/52628517/how-to-search-specific-column-within-range-in-vba", "title": "How to search specific column within range in VBA", "body": "<p>Hello and thank you for taking the time to read this and thank you for any advice!</p>\n\n<p>I'm using VBA to search for the first value within an array which is greater than a value specified elsewhere in a cell, and outputting the column and row number to new cells.</p>\n\n<p>The code I am using is:</p>\n\n<pre><code>Sub A()\n\nDim rng As Range\nDim v As Variant\nDim colnum As Long\nDim row As Long\n\nSet rng = Range(\"B2:BT72\")\nv = Sheets(\"WIP\").Range(\"AC76\").Value\nFor Each cll In rng\nIf cll.Value &gt; v Then\n    colnum = cll.Column\n    row = cll.row\nExit For\nEnd If\nNext\nSheets(\"WIP\").Range(\"AF76\").Value = colnum + 25\nSheets(\"WIP\").Range(\"AG76\").Value = row + 25\n\nEnd Sub\n</code></pre>\n\n<p>And that works fine. However I now need to only search a certain column and just output the row value. The column I need to search is also specified in a specific cell. I've modified the code to:</p>\n\n<pre><code>Sub B()\n\nDim rng As Range\nDim v As Variant\nDim x As Variant\nDim row As Long\n\nSet rng = Range(\"A2:BT72\")\nv = Sheets(\"WIP\").Range(\"AC77\").Value\nx = Sheets(\"WIP\").Range(\"AF77\").Value\n\nFor Each cell In rng.Columns(x - 25)\nIf cell.Value &gt; v Then\n    row = cell.row\nExit For\nEnd If\nNext\nSheets(\"WIP\").Range(\"AG77\").Value = row + 25\n\nEnd Sub\n</code></pre>\n\n<p>This time I'm getting an error message type mismatch on the line \"If cell.value > V Then\"\nCan anybody spot why?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 10360381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc9d0f9aacee7fc7c6c5ec7935a43bec?s=128&d=identicon&r=PG&f=1", "display_name": "Derek Harden", "link": "https://stackoverflow.com/users/10360381/derek-harden"}, "edited": false, "score": 0, "creation_date": 1538580070, "post_id": 52628849, "comment_id": 92194319, "body": "thanks for the assist! The script hides the columns to the left beautifully, however it does not seem to be hiding the columns to the right as needed. Would this have something to do with lastCol using xlToLeft in the With Statement? Also, I will have the active column plus 9 additional columns of information to the right that I will need to keep visible. Everything to the right of these 10 columns will need to be hidden. I changed the (workingCol +1) to (workingCol +9). I tried both, however neither will hide the columns to the right. Thanks!"}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "reply_to_user": {"reputation": 41, "user_id": 10360381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc9d0f9aacee7fc7c6c5ec7935a43bec?s=128&d=identicon&r=PG&f=1", "display_name": "Derek Harden", "link": "https://stackoverflow.com/users/10360381/derek-harden"}, "edited": false, "score": 0, "creation_date": 1538582004, "post_id": 52628849, "comment_id": 92195486, "body": "I made a slight update to the answer above, to check if your nine columns are at the far right of your data. But I can tell you that the code above is hiding everything to the left and right of the nine columns for me."}, {"owner": {"reputation": 41, "user_id": 10360381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc9d0f9aacee7fc7c6c5ec7935a43bec?s=128&d=identicon&r=PG&f=1", "display_name": "Derek Harden", "link": "https://stackoverflow.com/users/10360381/derek-harden"}, "edited": false, "score": 0, "creation_date": 1538584005, "post_id": 52628849, "comment_id": 92196567, "body": "thanks again! You&#39;ve been a major help and the code is up and running. I don&#39;t know why, however the script did not work on my end. Hiding to the right only selected the data I was wanting to keep. I was able to make some adjustments and get it to where I need it to be (for hiding data on the right):                                 Sheets(&quot;ACD&quot;).Cells(workingcol).Offset(0, 9).Select         Selection.range(.Cells(1, Selection + 1), .Cells(1, lastcol)).EntireColumn.Hidden = True     End With              Thanks again!!"}], "tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": true, "score": 1, "last_activity_date": 1538581949, "last_edit_date": 1538581949, "creation_date": 1538575470, "answer_id": 52628849, "question_id": 52628512, "link": "https://stackoverflow.com/questions/52628512/selecting-multiple-columns-to-hide-at-once/52628849#52628849", "title": "Selecting Multiple Columns to hide at once", "body": "<p>Here's an example on how to hide multiple columns, based on your situation:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub HideMonthColumns()\n    Dim workingDate As Date                      'filled in from your form?\n    workingDate = #10/1/2018#                    'set for testing here\n\n    Dim ws As Worksheet\n    Set ws = ThisWorkbook.Sheets(\"ACD\")\n\n    Dim lastCol As Long\n    Dim workingCol As Long\n    Dim i As Long\n\n    With ws\n        lastCol = .Cells(1, .Columns.Count).End(xlToLeft).Column\n        For i = 1 To lastCol\n            If .Cells(1, i) = workingDate Then\n                workingCol = i\n                Exit For\n            End If\n        Next i\n\n        '--- hide all the columns to the left and right of the working column\n        .Range(.Cells(1, 1), .Cells(1, workingCol - 1)).EntireColumn.Hidden = True\n\n        '--- ... and hide all the columns to the right, checking for the edge\n        If (workingCol + 9) &lt; lastCol Then\n            .Range(.Cells(1, workingCol + 9), _\n                   .Cells(1, lastCol)).EntireColumn.Hidden = True\n        End If\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 10360381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc9d0f9aacee7fc7c6c5ec7935a43bec?s=128&d=identicon&r=PG&f=1", "display_name": "Derek Harden", "link": "https://stackoverflow.com/users/10360381/derek-harden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 294, "favorite_count": 0, "accepted_answer_id": 52628849, "answer_count": 1, "score": 1, "last_activity_date": 1538581949, "creation_date": 1538574397, "question_id": 52628512, "link": "https://stackoverflow.com/questions/52628512/selecting-multiple-columns-to-hide-at-once", "title": "Selecting Multiple Columns to hide at once", "body": "<p>I am running a report in which has multiple columns that compares numbers throughout the fiscal year. For example, July to August, August to September, etc. Unfortunately, when I do this manually, I have to unhide all columns and rehide columns not used to complete. I am automating this report. At this moment, I have all of the columns visible. Due to being in middle of the fiscal year, my report will have columns on both the left and right sides of the needed data. I am trying to have these unneeded columns hidden.</p>\n\n<p>I have created a reference row (row 1) with JAN, FEB, MAR, etc for reference purposes only for my code as I have created a userform that detects these entries. </p>\n\n<p>For the data I need this month, I have selected the referenced cell and offset it by one to get the first column selected that I will need hidden. How would I select all of the columns from my selected column to the column A in my script? Below is the code of where I am:</p>\n\n<pre><code>With Worksheets(\"ACD\")\n For counter = 1 To 200\n    Set curcell = Worksheets(\"ACD\").Cells(1, counter)\n    If curcell.Value = FormMonth Then\n    curcell.Offset(0, -1).EntireColumn.Select\n    End If\n  Next counter\nEnd With\n</code></pre>\n\n<p>Thanks for you help!</p>\n"}, {"tags": ["excel", "vba", "replace"], "comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 2, "creation_date": 1538575138, "post_id": 52628509, "comment_id": 92190977, "body": "Hello and welcome to <a href=\"https://stackoverflow.com\">Stack Overflow</a>! Please take the <a href=\"https://stackoverflow.com/tour\">tour</a> and read through the <a href=\"https://stackoverflow.com/help\">help center</a> to learn what we&#39;ll do to help you. TL;DR: this isn&#39;t a code writing service so you&#39;ll have to provide your best shot at it and indicate where you&#39;re stuck, then someone will help you fix that specific issue."}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1538576606, "post_id": 52628509, "comment_id": 92191889, "body": "Post the code you have so far and we&#39;ll be happy to take a look."}, {"owner": {"reputation": 5038, "user_id": 4552529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7dff9245051269e55748c81670088e8?s=128&d=identicon&r=PG&f=1", "display_name": "Wizhi", "link": "https://stackoverflow.com/users/4552529/wizhi"}, "edited": false, "score": 0, "creation_date": 1538593530, "post_id": 52628509, "comment_id": 92201336, "body": "Should the yellow highlighted values in Sheet2 be removed too?"}, {"owner": {"reputation": 13, "user_id": 10451039, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-PcJPIYyMwq0/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWDTAEmdpIFVDNMPye6DcOTmF-9Dw/mo/photo.jpg?sz=128", "display_name": "Ross Nelson", "link": "https://stackoverflow.com/users/10451039/ross-nelson"}, "edited": false, "score": 0, "creation_date": 1538596616, "post_id": 52628509, "comment_id": 92202754, "body": "Hi Wiz, No they shouldn&#39;t, I was just trying to make them standout for reference."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10451039, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-PcJPIYyMwq0/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWDTAEmdpIFVDNMPye6DcOTmF-9Dw/mo/photo.jpg?sz=128", "display_name": "Ross Nelson", "link": "https://stackoverflow.com/users/10451039/ross-nelson"}, "edited": false, "score": 0, "creation_date": 1538745530, "post_id": 52653390, "comment_id": 92262733, "body": "Thank you Wizhi, this is working beautifully.  I did have one follow up question though.  In an effort to keep Sheet 2 as maintainable as possible we shorten everything to 4 characters.  If the items in column N remain at 6 characters how do I get them to match?  I tried to Dim a new String that would take only the left 4 characters of str(k) but that did not work."}, {"owner": {"reputation": 13, "user_id": 10451039, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-PcJPIYyMwq0/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWDTAEmdpIFVDNMPye6DcOTmF-9Dw/mo/photo.jpg?sz=128", "display_name": "Ross Nelson", "link": "https://stackoverflow.com/users/10451039/ross-nelson"}, "edited": false, "score": 0, "creation_date": 1538746971, "post_id": 52653390, "comment_id": 92263738, "body": "I Think I figured it out.  I introduced the new string in the wrong spot.  Wizhi I am marking your post as the answer.  Thank you again!"}, {"owner": {"reputation": 5038, "user_id": 4552529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7dff9245051269e55748c81670088e8?s=128&d=identicon&r=PG&f=1", "display_name": "Wizhi", "link": "https://stackoverflow.com/users/4552529/wizhi"}, "reply_to_user": {"reputation": 13, "user_id": 10451039, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-PcJPIYyMwq0/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWDTAEmdpIFVDNMPye6DcOTmF-9Dw/mo/photo.jpg?sz=128", "display_name": "Ross Nelson", "link": "https://stackoverflow.com/users/10451039/ross-nelson"}, "edited": false, "score": 0, "creation_date": 1538753323, "post_id": 52653390, "comment_id": 92267617, "body": "Thank you. Feel free to ask. it was really fun to create it :). Nice, that&#39;s sounds like a great way to do it. An alternative could be to use <code>&amp; &quot;*&quot;</code> after the <code>ValLookup</code> value, so: <code>ValLookup &amp; &quot;*&quot;</code>. This would tell you to take the first part of the value (ex. AJ1700 and then search for the rest as a wildcard)... So without testing I think it would look like: <code>If str(k) = ValLookup Then &amp; &quot;*&quot;</code> I use that logic when I compare Tundra 4x2 against Tundra... in: <code>If LookupvalueA1 &amp; LookupvalueB1 Like LookupvalueA2 &amp; &quot;*&quot; &amp; LookupvalueB2 &amp; &quot;*&quot; Then</code>"}, {"owner": {"reputation": 5038, "user_id": 4552529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7dff9245051269e55748c81670088e8?s=128&d=identicon&r=PG&f=1", "display_name": "Wizhi", "link": "https://stackoverflow.com/users/4552529/wizhi"}, "reply_to_user": {"reputation": 13, "user_id": 10451039, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-PcJPIYyMwq0/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWDTAEmdpIFVDNMPye6DcOTmF-9Dw/mo/photo.jpg?sz=128", "display_name": "Ross Nelson", "link": "https://stackoverflow.com/users/10451039/ross-nelson"}, "edited": false, "score": 0, "creation_date": 1538753330, "post_id": 52653390, "comment_id": 92267621, "body": "If you want you could write how you changed the character from 6 to 4 (example) and I can try to modify the code :)"}, {"owner": {"reputation": 13, "user_id": 10451039, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-PcJPIYyMwq0/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWDTAEmdpIFVDNMPye6DcOTmF-9Dw/mo/photo.jpg?sz=128", "display_name": "Ross Nelson", "link": "https://stackoverflow.com/users/10451039/ross-nelson"}, "edited": false, "score": 0, "creation_date": 1538766838, "post_id": 52653390, "comment_id": 92273751, "body": "Thanks Wizhi, I edited the question and inserted the final code I used.  I think I was on the same track as you using the * wildcard but I&#39;m not sure what I did incorrectly.  I actually left it in there as a remnant of my incompetence."}, {"owner": {"reputation": 5038, "user_id": 4552529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7dff9245051269e55748c81670088e8?s=128&d=identicon&r=PG&f=1", "display_name": "Wizhi", "link": "https://stackoverflow.com/users/4552529/wizhi"}, "reply_to_user": {"reputation": 13, "user_id": 10451039, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-PcJPIYyMwq0/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWDTAEmdpIFVDNMPye6DcOTmF-9Dw/mo/photo.jpg?sz=128", "display_name": "Ross Nelson", "link": "https://stackoverflow.com/users/10451039/ross-nelson"}, "edited": false, "score": 0, "creation_date": 1538772511, "post_id": 52653390, "comment_id": 92275911, "body": "You&#39;re welcome Ross! :). Good for future reference. I was curious so I updated code in a new answer regarding your desire of 4 character match. You&#39;re really close and actually, if you have blank cell in the middle of a column (if cell A9 has been blank for example) in Sheet 2 your code will work but my added code will not work. I don&#39;t agree with &quot;incompetence&quot; :). I think is good that we can help each other and give an idea/hint where to start. The code is yours and you modify it to suits your need. Then I think you did a good job and also learn a lot :) And we had a lot of fun. Take care!!"}], "tags": [], "owner": {"reputation": 5038, "user_id": 4552529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7dff9245051269e55748c81670088e8?s=128&d=identicon&r=PG&f=1", "display_name": "Wizhi", "link": "https://stackoverflow.com/users/4552529/wizhi"}, "is_accepted": false, "score": 0, "last_activity_date": 1538824859, "last_edit_date": 1538824859, "creation_date": 1538679253, "answer_id": 52653390, "question_id": 52628509, "link": "https://stackoverflow.com/questions/52628509/vba-search-a-string-for-a-value-from-an-array-and-delete-the-value/52653390#52653390", "title": "VBA - Search a string for a value from an array and delete the value", "body": "<p>I think this could solve your problem. I have set up the code after your example. The worksheet name I have used are \"Sheet1\" and \"Sheet2\".\nSo what does the code do? </p>\n\n<ul>\n<li>It combine the values in column D and M for Sheet1. </li>\n<li>Then search for that combination in Sheet 2 (Row 1 and 2) and locates\nwhich column the combination is found. When the combination is found\nit split the \"words\" in Sheet1, column N.    </li>\n<li>Then check all the values in the column previously found.</li>\n<li>When Value is found it replaces it with <code>n//a</code> in Sheet1. Finally it\nreplaces <code>n//a</code> with \"nothing\".</li>\n</ul>\n\n<p>Code:</p>\n\n<pre><code>Sub FindAndRemoveValues()\nDim LookupvalueA1 As String\nDim LookupvalueB1 As String\nDim LookupvalueA2 As String\nDim LookupvalueB2 As String\n\nDim LLAB1 As String 'Dummy variable for Sheet1\nDim LLAB2 As String 'Dummy variable for Sheet2\n\nDim str() As String 'Name of Array\nDim k As Long 'Array index number\n\nDim lrow As String 'Not used, but can define last row for column A in Sheet 1\n\nDim ValLookup As String 'Define the Lookup Value for Row \"m\" in Column \"j\" for Sheet 1. This will define the value for the cell that contain the cell value for the package\nDim RemoveVal As String 'Create a dummy word that will replace the value in the ORIG_PIO_STRING that you check.\n\nSRESNM_lrow = Cells(Rows.Count, 4).End(xlUp).Row 'Find the last row for column SRES_NM\nFor i = 2 To SRESNM_lrow 'Loop trough column SRES_NM\nLookupvalueA1 = ThisWorkbook.Worksheets(\"Sheet1\").Cells(i, 4).Value 'Define the value in column SRES_NM to check againt in Sheet2, Row 1\nLookupvalueB1 = ThisWorkbook.Worksheets(\"Sheet1\").Cells(i, 13).Value 'Define the value in column NEW_PIC to check againt in Sheet2, Row2\nLLAB1 = LookupvalueA1 &amp; LookupvalueB1 'Dummy variable. It shows which value from Sheet1 that will be compared in Sheet2 row 1 and 2\n\n    For j = 1 To 12 'The first row from column 1 (A) to Column 12 (L)\n    LookupvalueA2 = ThisWorkbook.Worksheets(\"Sheet2\").Cells(1, j).Value 'For Sheet1 loop through row 1 for column j\n    LookupvalueB2 = ThisWorkbook.Worksheets(\"Sheet2\").Cells(2, j).Value 'For Sheet1 loop through row 2 for column j\n    LLAB2 = LookupvalueA2 &amp; LookupvalueB2 'Dummy variable2. It shows which value from Sheet2 row 1 and 2 that will be compared to the value in Sheet 1\n\n        If LookupvalueA1 &amp; LookupvalueB1 Like LookupvalueA2 &amp; \"*\" &amp; LookupvalueB2 &amp; \"*\" Then 'Compare the the values between Sheet 1 and Sheet 2\n        'If LLAB1 Like LLAB2 &amp; \"*\" Then 'Test dummy logic\n\n\n            Worksheets(\"Sheet1\").Activate 'Go to Sheet1\n            str = VBA.Split(Cells(i, 14)) 'Split the values by space. Then the values are stored as an Array for row i in column ORIG_PIO_STRING. These values will be compared to all the columns in the Sheet1.\n            'Cells(1, 20).Resize(1, UBound(str) + 1) = str 'Dummy to print the array variables\n\n\n                For k = LBound(str) To UBound(str) 'loop through Array index k. Start from Lowerbound k = 0 to Upperbound k = nr of values in row i for column ORIG_PIO_STRING\n                    Worksheets(\"Sheet2\").Activate 'Activate Sheet2\n                    'lrow = Cells(Rows.Count, j).End(xlUp).Row 'Not used, but can define last row for column \"j\", where j is between 1 and 12 in Sheet 1\n\n                        For m = 4 To 46 'Here one can use the lrow, or define how many rows that should be looked through in the Sheet2\n                        ValLookup = ThisWorkbook.Worksheets(\"Sheet2\").Cells(m, j).Value 'This value will be compared to the Array values.\n\n                            If str(k) = ValLookup Then 'If index value (k) in array match a cell value from the column j in Sheet 1 then do:\n\n                                If str(k) = ValLookup Then 'If index value (k) is equal to the value found in Sheet1 then replace that index value with \"n//a\"\n                                str(k) = \"n//a\" 'Instead of removing the value from the Array, we override it with a dummy variable\n                                RemoveVal = \"n//a\" 'Dummy variable to write the dummy word: n//a\n                                End If\n\n                                    Worksheets(\"Sheet1\").Activate 'Activate Sheet1\n                                    Range(Cells(i, 14), Cells(i, 14)) = Join(str, \" \") 'Overwrite the old value in ORIG_PIO_STRING with the dummy variable\n                                    'Range(Cells(i, 23), Cells(i, 23)) = Join(str, \" \")\n                                    'Range(Cells(i, 23), Cells(i, 23)).Value = RemoveVal 'Test for writing the dummy variable: n//a\n\n                            End If\n\n                        Next m\n\n                Next k\n\n        End If\n\n    Next j\n\nNext i\n\n'The last part removes the dummy variable that has replaced all the values that should be removed in column ORIG_PIO_STRING\nWorksheets(\"Sheet1\").Activate 'Activate Sheet1\n    Replace_Dummy_Variable_lastrow = Cells(Rows.Count, 14).End(xlUp).Row 'Find last row in column ORIG_PIO_STRING\n    Range(Cells(2, 14), Cells(Replace_Dummy_Variable_lastrow, 14)).Select 'Define the range to replace the dummy variables\n        Selection.Replace What:=\"n//a \", Replacement:=\"\", LookAt:=xlPart, _\n        SearchOrder:=xlByRows, MatchCase:=False 'Find all dummy variables \"n//a \" (including a space character) and replace it with nothing\n\nEnd\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 10451039, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-PcJPIYyMwq0/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWDTAEmdpIFVDNMPye6DcOTmF-9Dw/mo/photo.jpg?sz=128", "display_name": "Ross Nelson", "link": "https://stackoverflow.com/users/10451039/ross-nelson"}, "edited": false, "score": 1, "creation_date": 1538781041, "post_id": 52673007, "comment_id": 92278125, "body": "Hey Wizhi, I do like the idea of using lrow to make the list on sheet2 dynamic.  Looking at your comments in the code, wouldn&#39;t lrow be limited by the length of column A?  So if any other column has more items they would not be counted.  I appreciate all your help on this."}, {"owner": {"reputation": 5038, "user_id": 4552529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7dff9245051269e55748c81670088e8?s=128&d=identicon&r=PG&f=1", "display_name": "Wizhi", "link": "https://stackoverflow.com/users/4552529/wizhi"}, "reply_to_user": {"reputation": 13, "user_id": 10451039, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-PcJPIYyMwq0/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWDTAEmdpIFVDNMPye6DcOTmF-9Dw/mo/photo.jpg?sz=128", "display_name": "Ross Nelson", "link": "https://stackoverflow.com/users/10451039/ross-nelson"}, "edited": false, "score": 0, "creation_date": 1538824664, "post_id": 52673007, "comment_id": 92285763, "body": "You&#39;re right, good spot! It would only depend on column A, because I did a mistake. I changed <code>1</code> to <code>j</code> in my adjusted code above. It should be <code>lrow = Cells(Rows.Count, j).End(xlUp).Row</code>. Becuase then lrow depends on which column in sheet2 to look at, i.e. <code>For j = 1 To 12</code>. So when <code>j = 1</code> then we check column A. <code>j = 2</code> is column B etc. So if the values match (example: Tundra XX14) for both sheet 1 and sheet 2, we know which column we need to loop through (column 10). The lrow will then take the last row of this particular column (j = 10).  It&#39;s just fun :)"}, {"owner": {"reputation": 13, "user_id": 10451039, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-PcJPIYyMwq0/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWDTAEmdpIFVDNMPye6DcOTmF-9Dw/mo/photo.jpg?sz=128", "display_name": "Ross Nelson", "link": "https://stackoverflow.com/users/10451039/ross-nelson"}, "edited": false, "score": 0, "creation_date": 1538852365, "post_id": 52673007, "comment_id": 92292891, "body": "I plugged your code inline with the rest of my sub and everything is working fantastically, I think we have a winner here.  Thanks again Wizhi, I learned a lot from your suggestions and your comments are extremely helpful."}, {"owner": {"reputation": 5038, "user_id": 4552529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7dff9245051269e55748c81670088e8?s=128&d=identicon&r=PG&f=1", "display_name": "Wizhi", "link": "https://stackoverflow.com/users/4552529/wizhi"}, "reply_to_user": {"reputation": 13, "user_id": 10451039, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-PcJPIYyMwq0/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWDTAEmdpIFVDNMPye6DcOTmF-9Dw/mo/photo.jpg?sz=128", "display_name": "Ross Nelson", "link": "https://stackoverflow.com/users/10451039/ross-nelson"}, "edited": false, "score": 0, "creation_date": 1538903321, "post_id": 52673007, "comment_id": 92301300, "body": "Nice to hear :)!!! Np, I think it was a fun challenge to solve. Take care."}], "tags": [], "owner": {"reputation": 5038, "user_id": 4552529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7dff9245051269e55748c81670088e8?s=128&d=identicon&r=PG&f=1", "display_name": "Wizhi", "link": "https://stackoverflow.com/users/4552529/wizhi"}, "is_accepted": true, "score": 0, "last_activity_date": 1538824947, "last_edit_date": 1538824947, "creation_date": 1538771917, "answer_id": 52673007, "question_id": 52628509, "link": "https://stackoverflow.com/questions/52628509/vba-search-a-string-for-a-value-from-an-array-and-delete-the-value/52673007#52673007", "title": "VBA - Search a string for a value from an array and delete the value", "body": "<p>I think this should work for you, I tested :). This assumes that values in Sheet 2 become 4 letter instead of 6. (AC1000 -> AC10, AC1700 -> AC17 etc).</p>\n\n<p>I modify the following parts of the code:</p>\n\n<p><code>Shortstr = Left(str(k), 4)</code> -> made comment instead of run code</p>\n\n<p>Here is where we make the wildcard possible. Wildcard will not work when we trying to match for example \"MC2000\" from Sheet 1 with BLANK VALUES on sheet 2 (because we loop thru row <code>m = 4 to 40</code>). It will accept those values (say its true, i.e. \"MC2000\" = \"Blank cell\", is true..) and we don't want that. Therefore we only loop through the to the last row. <em>So no empty cell is allowed in the middle of the column.</em></p>\n\n<p><code>lrow = Cells(Rows.Count, j).End(xlUp).Row</code> -> Activated code, was comment before</p>\n\n<p><code>For m = 4 To 40</code> -> <code>For m = 4 To lrow</code></p>\n\n<p><code>ValLookupShort = ValLookup &amp; \"*\"</code>  -> made comment instead of run code</p>\n\n<p><code>If Shortstr Like ValLookup Then</code> -> <code>If str(k) Like ValLookup &amp; \"*\"</code> -Both places</p>\n\n<p>Total code should look like: </p>\n\n<pre><code>Dim LookupvalueA1 As String\nDim LookupvalueB1 As String\nDim LookupvalueA2 As String\nDim LookupvalueB2 As String\nDim Shortstr As String\n\nDim LLAB1 As String 'Dummy variable for Sheet1\nDim LLAB2 As String 'Dummy variable for Sheet2\n\nDim str() As String 'Name of Array\nDim k As Long 'Array index number\n\nDim lRow As String 'Not used, but can define last row for column A in Sheet 1\n\nDim ValLookup As String 'Define the Lookup Value for Row \"m\" in Column \"j\" for Sheet 1. This will define the value for the cell that contain the cell value for the package\nDim RemoveVal As String 'Create a dummy word that will replace the value in the ORIG_PIO_STRING that you check.\n\nSRESNM_lrow = Cells(Rows.Count, 4).End(xlUp).Row 'Find the last row for column SRES_NM\nFor i = 2 To SRESNM_lrow 'Loop trough column SRES_NM\nLookupvalueA1 = ThisWorkbook.Worksheets(\"Acczn Results\").Cells(i, 4).Value 'Define the value in column SRES_NM to check againt in Sheet2, Row 1\nLookupvalueB1 = ThisWorkbook.Worksheets(\"Acczn Results\").Cells(i, 13).Value 'Define the value in column NEW_PIC to check againt in Sheet2, Row2\n'LLAB1 = LookupvalueA1 &amp; LookupvalueB1 'Dummy variable 1. It shows which value from Sheet1 that will be compared in Sheet2 row 1 and 2\n\nFor j = 1 To 12 'The first row from column 1 (A) to Column 12 (L)\nLookupvalueA2 = ThisWorkbook.Worksheets(\"Conflicts\").Cells(1, j).Value 'For Sheet1 loop through row 1 for column j\nLookupvalueB2 = ThisWorkbook.Worksheets(\"Conflicts\").Cells(2, j).Value 'For Sheet1 loop through row 2 for column j\n'LLAB2 = LookupvalueA2 &amp; LookupvalueB2 'Dummy variable 2. It shows which value from Sheet2 row 1 and 2 that will be compared to the value in Sheet 1\n\n    If LookupvalueA1 &amp; LookupvalueB1 Like LookupvalueA2 &amp; \"*\" &amp; LookupvalueB2 &amp; \"*\" Then 'Compare the the values between Sheet 1 and Sheet 2\n    'If LLAB1 Like LLAB2 &amp; \"*\" Then 'Test dummy variable 1 &amp; 2 logic\n\n\n        Worksheets(\"Acczn Results\").Activate 'Go to Sheet1\n        str = VBA.Split(Cells(i, 14)) 'Split the values by space. Then the values are stored as an Array for row i in column ORIG_PIO_STRING. These values will be compared to all the columns in the Sheet1.\n                    'Cells(1, 20).Resize(1, UBound(str) + 1) = str 'Dummy to print the array variables\n\n\n            For k = LBound(str) To UBound(str) 'loop through Array index k. Start from Lowerbound k = 0 to Upperbound k = nr of values in row i for column ORIG_PIO_STRING\n                'Shortstr = Left(str(k), 4)\n                Worksheets(\"Conflicts\").Activate 'Activate Sheet2\n                lrow = Cells(Rows.Count, j).End(xlUp).Row 'Not used, but can define last row for column \"j\", where j is between 1 and 12 in Sheet 1\n\n                    For m = 4 To lrow 'Here one can use the lrow, or define how many rows that should be looked through in the Sheet2\n                    ValLookup = ThisWorkbook.Worksheets(\"Conflicts\").Cells(m, j).Value 'This value will be compared to the Array values.\n                    'ValLookupShort = ValLookup &amp; \"*\"\n                        If str(k) Like ValLookup &amp; \"*\" Then 'If index value (k) in array match a cell value from the column j in Sheet 1 then do:\n\n                            If str(k) Like ValLookup &amp; \"*\" Then 'If index value (k) is equal to the value found in Sheet1 then replace that index value with \"n//a\"\n                            str(k) = \"n//a\" 'Instead of removing the value from the Array, we override it with a dummy variable\n                            RemoveVal = \"n//a\" 'Dummy variable to write the dummy word: n//a\n                            End If\n\n                                Worksheets(\"Acczn Results\").Activate 'Activate Sheet1\n                                Range(Cells(i, 14), Cells(i, 14)) = Join(str, \" \") 'Overwrite the old value in ORIG_PIO_STRING with the dummy variable\n                                'Range(Cells(i, 23), Cells(i, 23)) = Join(str, \" \")\n                                'Range(Cells(i, 23), Cells(i, 23)).Value = RemoveVal 'Test for writing the dummy variable: n//a\n\n                        End If\n\n                    Next m\n\n            Next k\n\n    End If\n\nNext j\nNext i\n'The last part removes the dummy variable that has replaced all the values that should be removed in column ORIG_PIO_STRING\nWorksheets(\"Acczn Results\").Activate 'Activate Sheet1\nReplace_Dummy_Variable_lastrow = Cells(Rows.Count, 14).End(xlUp).Row 'Find last row in column ORIG_PIO_STRING\nRange(Cells(2, 14), Cells(Replace_Dummy_Variable_lastrow, 14)).Select 'Define the range to replace the dummy variables\n    Selection.Replace What:=\"n//a \", Replacement:=\"\", LookAt:=xlPart, _\n    SearchOrder:=xlByRows, MatchCase:=False 'Find all dummy variables \"n//a \" (including a space character) and replace it with nothing\nEnd\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10451039, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-PcJPIYyMwq0/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWDTAEmdpIFVDNMPye6DcOTmF-9Dw/mo/photo.jpg?sz=128", "display_name": "Ross Nelson", "link": "https://stackoverflow.com/users/10451039/ross-nelson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 204, "favorite_count": 1, "accepted_answer_id": 52673007, "answer_count": 2, "score": 0, "last_activity_date": 1538824947, "creation_date": 1538574391, "last_edit_date": 1538766690, "question_id": 52628509, "link": "https://stackoverflow.com/questions/52628509/vba-search-a-string-for-a-value-from-an-array-and-delete-the-value", "title": "VBA - Search a string for a value from an array and delete the value", "body": "<p>I need some help creating VBA code that will accomplish a very repetitive task.</p>\n\n<p>I have 2 sheets of data (see attached); I need to compare Sheet 1 to a specific range on Sheet 2 and where a value from that range on Sheet 2 appears in column N it needs to be removed from the string.</p>\n\n<p>On sheet 2 there are 3 rows of headers that denote the series, code and description, these are for reference only and should not be checked against.  Sheet2 Dimensions are 12 Columns wide by 46 rows long.</p>\n\n<p>The challenge I have is Columns 1 and 2 on Sheet 1 need to be used as a reference for which list of values to check against on sheet 2. Column 2 is always 6 characters in length but the comparison only needs to be done against the first 4 characters since that is the layout on Sheet 2.  In the attachments below I've highlighted the values that should be removed.</p>\n\n<p>Sheet1:\n<img src=\"https://i.stack.imgur.com/PXKhC.jpg\" alt=\"Sheet1\"></p>\n\n<p>Sheet2:\n<img src=\"https://i.stack.imgur.com/8cnmF.jpg\" alt=\"Sheet2\"></p>\n\n<p>In this example, Row 2 on Sheet 1 would be compared to Column A on Sheet 2 because Sheet1 D2=Sheet2 A1 and Sheet1 M2=Sheet2 A2. The result would be that on Row 2 RB5220 should be removed from the string on Sheet1.  The same logic would be applied to Rows 3 &amp; 4 on Sheet1.  Rows 5-8 would receive no action.</p>\n\n<p>I hope this comes across clearly, I am happy to clarify further if needed.</p>\n\n<p>As always, thank you in advance for your help.</p>\n\n<p>I've been working on this for a bit and have not come up with a satisfactory solution as of yet.  The only method I have so far invokes the autofilter function based on the criteria from sheet 2 and then a replace function for each item in the column.  Not the most efficient way and it requires manual maintenance if the list were to change.  Here is an example:</p>\n\n<pre><code>    With rng\n    .AutoFilter Field:=4, Criteria1:=\"=*Tac*\"\n    .AutoFilter Field:=13, Criteria1:=\"=XX14*\"\nEnd With\n\n'Replace JB with Blank in Column N\n    Sheets(\"Acczn Results\").Columns(\"N\").Replace _\n      What:=\"JB????\", Replacement:=\"\", _\n      SearchOrder:=xlByColumns, MatchCase:=True\n\n    'Replace AA with Blank in Column N\n        Sheets(\"Acczn Results\").Columns(\"N\").Replace _\n      What:=\"AA????\", Replacement:=\"\", _\n      SearchOrder:=xlByColumns, MatchCase:=True\n</code></pre>\n\n<p>Final code: Acczn Results = Sheet1; Conflicts = Sheet2; Added Shortstr = Left(str(k), 4).</p>\n\n<pre><code>Dim LookupvalueA1 As String\nDim LookupvalueB1 As String\nDim LookupvalueA2 As String\nDim LookupvalueB2 As String\nDim Shortstr As String\n\nDim LLAB1 As String 'Dummy variable for Sheet1\nDim LLAB2 As String 'Dummy variable for Sheet2\n\nDim str() As String 'Name of Array\nDim k As Long 'Array index number\n\nDim lRow As String 'Not used, but can define last row for column A in Sheet 1\n\nDim ValLookup As String 'Define the Lookup Value for Row \"m\" in Column \"j\" for Sheet 1. This will define the value for the cell that contain the cell value for the package\nDim RemoveVal As String 'Create a dummy word that will replace the value in the ORIG_PIO_STRING that you check.\n\nSRESNM_lrow = Cells(Rows.Count, 4).End(xlUp).Row 'Find the last row for column SRES_NM\nFor i = 2 To SRESNM_lrow 'Loop trough column SRES_NM\nLookupvalueA1 = ThisWorkbook.Worksheets(\"Acczn Results\").Cells(i, 4).Value 'Define the value in column SRES_NM to check againt in Sheet2, Row 1\nLookupvalueB1 = ThisWorkbook.Worksheets(\"Acczn Results\").Cells(i, 13).Value 'Define the value in column NEW_PIC to check againt in Sheet2, Row2\nLLAB1 = LookupvalueA1 &amp; LookupvalueB1 'Dummy variable. It shows which value from Sheet1 that will be compared in Sheet2 row 1 and 2\n\nFor j = 1 To 12 'The first row from column 1 (A) to Column 12 (L)\nLookupvalueA2 = ThisWorkbook.Worksheets(\"Conflicts\").Cells(1, j).Value 'For Sheet1 loop through row 1 for column j\nLookupvalueB2 = ThisWorkbook.Worksheets(\"Conflicts\").Cells(2, j).Value 'For Sheet1 loop through row 2 for column j\nLLAB2 = LookupvalueA2 &amp; LookupvalueB2 'Dummy variable2. It shows which value from Sheet2 row 1 and 2 that will be compared to the value in Sheet 1\n\n    If LookupvalueA1 &amp; LookupvalueB1 Like LookupvalueA2 &amp; \"*\" &amp; LookupvalueB2 &amp; \"*\" Then 'Compare the the values between Sheet 1 and Sheet 2\n    'If LLAB1 Like LLAB2 &amp; \"*\" Then 'Test dummy logic\n\n\n        Worksheets(\"Acczn Results\").Activate 'Go to Sheet1\n        str = VBA.Split(Cells(i, 14)) 'Split the values by space. Then the values are stored as an Array for row i in column ORIG_PIO_STRING. These values will be compared to all the columns in the Sheet1.\n                    'Cells(1, 20).Resize(1, UBound(str) + 1) = str 'Dummy to print the array variables\n\n\n            For k = LBound(str) To UBound(str) 'loop through Array index k. Start from Lowerbound k = 0 to Upperbound k = nr of values in row i for column ORIG_PIO_STRING\n                Shortstr = Left(str(k), 4)\n                Worksheets(\"Conflicts\").Activate 'Activate Sheet2\n                'lrow = Cells(Rows.Count, 1).End(xlUp).Row 'Not used, but can define last row for column A in Sheet 1\n\n                    For m = 4 To 40 'Here one can use the lrow, or define how many rows that should be looked through in the Sheet2\n                    ValLookup = ThisWorkbook.Worksheets(\"Conflicts\").Cells(m, j).Value 'This value will be compared to the Array values.\n                    ValLookupShort = ValLookup &amp; \"*\"\n                        If Shortstr Like ValLookup Then 'If index value (k) in array match a cell value from the column j in Sheet 1 then do:\n\n                            If Shortstr Like ValLookup Then 'If index value (k) is equal to the value found in Sheet1 then replace that index value with \"n//a\"\n                            str(k) = \"n//a\" 'Instead of removing the value from the Array, we override it with a dummy variable\n                            RemoveVal = \"n//a\" 'Dummy variable to write the dummy word: n//a\n                            End If\n\n                                Worksheets(\"Acczn Results\").Activate 'Activate Sheet1\n                                Range(Cells(i, 14), Cells(i, 14)) = Join(str, \" \") 'Overwrite the old value in ORIG_PIO_STRING with the dummy variable\n                                'Range(Cells(i, 23), Cells(i, 23)) = Join(str, \" \")\n                                'Range(Cells(i, 23), Cells(i, 23)).Value = RemoveVal 'Test for writing the dummy variable: n//a\n\n                        End If\n\n                    Next m\n\n            Next k\n\n    End If\n\nNext j\n\nNext i\n\n'The last part removes the dummy variable that has replaced all the values that should be removed in column ORIG_PIO_STRING\nWorksheets(\"Acczn Results\").Activate 'Activate Sheet1\nReplace_Dummy_Variable_lastrow = Cells(Rows.Count, 14).End(xlUp).Row 'Find last row in column ORIG_PIO_STRING\nRange(Cells(2, 14), Cells(Replace_Dummy_Variable_lastrow, 14)).Select 'Define the range to replace the dummy variables\n    Selection.Replace What:=\"n//a \", Replacement:=\"\", LookAt:=xlPart, _\n    SearchOrder:=xlByRows, MatchCase:=False 'Find all dummy variables \"n//a \" (including a space character) and replace it with nothing\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 24193, "user_id": 5811078, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NlknE.png?s=128&g=1", "display_name": "zipa", "link": "https://stackoverflow.com/users/5811078/zipa"}, "edited": false, "score": 2, "creation_date": 1538574012, "post_id": 52628282, "comment_id": 92190242, "body": "Well this might be useful <a href=\"https://stackoverflow.com/a/19365070/5811078\">stackoverflow.com/a/19365070/5811078</a>"}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 1, "creation_date": 1538574129, "post_id": 52628282, "comment_id": 92190302, "body": "With <code>x = Left(a, b)</code> both <code>x</code> and <code>a</code> are variants compared to <code>Left$()</code> where both are <code>string</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 3, "creation_date": 1538574433, "post_id": 52628282, "comment_id": 92190527, "body": "The $ variety (e.g. Left$, Mid$, etc) are measurably faster that their non-$ equivalents. Worth pursuing if you are doing hundreds of thousands of iterations or calculations."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1538575460, "post_id": 52628282, "comment_id": 92191163, "body": "@ScottCraner My bad - I was looking at the accepted answer (which doesn&#39;t answer the question)."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1538577164, "post_id": 52628282, "comment_id": 92192254, "body": "@ScottCraner the linked duplicate has a highly-voted answer that is all about <i>type hints</i>, which have absolutely nothing to do with <code>Left</code>/<code>Left$</code> function aliases."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1538582649, "post_id": 52628282, "comment_id": 92195843, "body": "@MathieuGuindon but the other answers all say the same thing as the accepted answer below. And anyone that disagrees can certainly vote to reopen."}], "answers": [{"comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1538574735, "post_id": 52628438, "comment_id": 92190728, "body": "But this works too: <code>x = Left$(123, 2)</code> (result = <code>12</code>). That means that <code>123</code> is implicitely converted to string. Can you confirm?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1538576916, "post_id": 52628438, "comment_id": 92192084, "body": "@Jabberwocky VBA does type coercion / implicit type conversions liberally. <code>123</code> is definitely implicitly converted to a <code>String</code>, <i>it has to be</i>, for the signature of <code>Left$</code> takes a <code>String</code> parameter."}], "tags": [], "owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "is_accepted": false, "score": 3, "last_activity_date": 1538574176, "creation_date": 1538574176, "answer_id": 52628438, "question_id": 52628282, "link": "https://stackoverflow.com/questions/52628282/builtin-string-functions-with/52628438#52628438", "title": "Builtin string functions with $", "body": "<p>Left$() wants a string as argument but Left() expects a variant. Therefore using Left$() is faster if you know you will always pass it a string.</p>\n"}, {"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1538577065, "post_id": 52628447, "comment_id": 92192186, "body": "Worth noting that while the string function is <i>usually</i> preferable, <code>Left$</code> will blow up with a type mismatch given a <code>Null</code>, whereas <code>Left</code> will happily take it (well, and then blow up with another error because obviously you can&#39;t get the N left-most characters of a <code>Null</code> value, but consider <code>UCase</code>/<code>UCase$</code> then) - <code>Null</code> would only be relevant in a very limited number of scenarios outside of MS-Access."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 5, "last_activity_date": 1538574203, "creation_date": 1538574203, "answer_id": 52628447, "question_id": 52628282, "link": "https://stackoverflow.com/questions/52628282/builtin-string-functions-with/52628447#52628447", "title": "Builtin string functions with $", "body": "<p>The typed functions (those ending with a <code>$</code>) return a <code>String</code>. The un-typed versions return a <code>Variant</code>. Internally, these are handled by a pair of different functions (in the case of <code>Left</code>, it is <code>_B_str_Left</code> and <code>_B_var_Left</code>).</p>\n\n<p>If you are assigning the return value to a <code>String</code> or a parameter expecting a <code>String</code>, using the typed version (<code>Left$</code>) avoids an implicit cast to a <code>Variant</code>. Similarly, if you're assigning to a <code>Variant</code>, using the un-typed version avoids a cast.</p>\n"}], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "closed_date": 1538574195, "accepted_answer_id": 52628447, "answer_count": 2, "score": 1, "last_activity_date": 1538574203, "creation_date": 1538573729, "question_id": 52628282, "link": "https://stackoverflow.com/questions/52628282/builtin-string-functions-with", "closed_reason": "Duplicate", "title": "Builtin string functions with $", "body": "<p>Is there any difference between using a builtin function returning a string such as <code>Left</code> or using the same function with a <code>$</code> appended (<code>Left$</code>)?</p>\n\n<p>The output of this:</p>\n\n<pre><code>Debug.Print Left(\"Foo\", 2)\nDebug.Print Left$(\"Foo\", 2)\n</code></pre>\n\n<p>is always</p>\n\n<pre><code>Fo\nFo\n</code></pre>\n\n<p>I suspect that it's strictly the same thing and that the <code>$</code> versions exist only for some compatibility reasons.</p>\n"}, {"tags": ["sql", "vba", "excel", "dao"], "comments": [{"owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "edited": false, "score": 0, "creation_date": 1538573402, "post_id": 52627991, "comment_id": 92189818, "body": "What error do yuu get?"}, {"owner": {"reputation": 517, "user_id": 8099673, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a45bb1bd39c6698a527b945ee6427de1?s=128&d=identicon&r=PG&f=1", "display_name": "Glenn G", "link": "https://stackoverflow.com/users/8099673/glenn-g"}, "reply_to_user": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "edited": false, "score": 0, "creation_date": 1538573897, "post_id": 52627991, "comment_id": 92190169, "body": "@Kubie - on the line <code>Set RS = DB2.OpenRecordSet (sSQL)</code>  I get the following error &quot;Run-time error &#39;3067&#39;: Query input must contain at least one table or query.&quot;"}, {"owner": {"reputation": 517, "user_id": 8099673, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a45bb1bd39c6698a527b945ee6427de1?s=128&d=identicon&r=PG&f=1", "display_name": "Glenn G", "link": "https://stackoverflow.com/users/8099673/glenn-g"}, "reply_to_user": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "edited": false, "score": 0, "creation_date": 1538586824, "post_id": 52627991, "comment_id": 92197983, "body": "I have also tried changing the line <code>Set RS = DB2.OpenRecordset (sSQL)</code> to <code>DB2.Execute sSQL</code> and still receive the same error :/"}, {"owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "edited": false, "score": 0, "creation_date": 1538587670, "post_id": 52627991, "comment_id": 92198423, "body": "Have you considered trying ADODB instead of DAO? We also heavily use mainframe here and ADODB works pretty well for me."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1538588531, "post_id": 52627991, "comment_id": 92198865, "body": "Your setup is not clear. <i>I have a database which is stored on the mainframe</i> ... this mostly means IBM&#39;s DB2. How does MS Access fit into this? Do you have linked tables to DB2 inside MS Access."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1538589487, "post_id": 52627991, "comment_id": 92199366, "body": "What is <code>DBPath = Interaction.GetSetting()</code>? How does it relate to <i>LocalDBPath</i>?"}, {"owner": {"reputation": 517, "user_id": 8099673, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a45bb1bd39c6698a527b945ee6427de1?s=128&d=identicon&r=PG&f=1", "display_name": "Glenn G", "link": "https://stackoverflow.com/users/8099673/glenn-g"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1538593536, "post_id": 52627991, "comment_id": 92201338, "body": "@Parfait - I&#39;ve updated my original question to clarify my setup.  <code>DBPath = Interaction.GetSetting()</code> pulls the location of the network database file (the one with the linked tables) from a registry setting.  LocalDBPath is the path of the database which will have the relevant data set created by the <code>Select .... Into...In</code> SQL statement.  Those tables will be named the same as the linked tables but will not be linked"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1538596314, "post_id": 52627991, "comment_id": 92202622, "body": "Why are you using the linked table network database file? Just use the local copy per my answer below."}, {"owner": {"reputation": 517, "user_id": 8099673, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a45bb1bd39c6698a527b945ee6427de1?s=128&d=identicon&r=PG&f=1", "display_name": "Glenn G", "link": "https://stackoverflow.com/users/8099673/glenn-g"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1538597067, "post_id": 52627991, "comment_id": 92202958, "body": "@Parfait - I want to use the local copy, but the local copy needs to be populated with the relevant data set from the network/linked tables.   Additionally, to keep from having to rewrite a ton of code, the table names in the local copy must be the same as the linked tables in the network copy.  The networked copy of the database uses the IBM Client Access ODBC driver to handle the AS/400 login requirements."}, {"owner": {"reputation": 295, "user_id": 8027318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46c8e79c3752d84c30234b8469d1cd0e?s=128&d=identicon&r=PG&f=1", "display_name": "NicC", "link": "https://stackoverflow.com/users/8027318/nicc"}, "edited": false, "score": 0, "creation_date": 1538622071, "post_id": 52627991, "comment_id": 92209479, "body": "An AS/400 is not a mainframe. This should be tagged with AS400 or I-series whichever exists for i-series/AS?400 topics."}], "answers": [{"comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1538598998, "post_id": 52633672, "comment_id": 92203837, "body": "So local copy of database does not exist prior to running this code?"}, {"owner": {"reputation": 517, "user_id": 8099673, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a45bb1bd39c6698a527b945ee6427de1?s=128&d=identicon&r=PG&f=1", "display_name": "Glenn G", "link": "https://stackoverflow.com/users/8099673/glenn-g"}, "edited": false, "score": 0, "creation_date": 1538599596, "post_id": 52633672, "comment_id": 92204102, "body": "if the local copy exists, the tables in it will be deleted and recreated to refresh the data."}, {"owner": {"reputation": 517, "user_id": 8099673, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a45bb1bd39c6698a527b945ee6427de1?s=128&d=identicon&r=PG&f=1", "display_name": "Glenn G", "link": "https://stackoverflow.com/users/8099673/glenn-g"}, "edited": false, "score": 0, "creation_date": 1538599761, "post_id": 52633672, "comment_id": 92204158, "body": "Parfait - I&#39;ve marked this as the answer.  I realized that <code>&amp; DBPath &amp;</code> in my SQL statement should have been <code>&amp; LocalDBPath &amp;</code>.  Once I made that change, then my SQL functioned perfectly using the <code>db.Execute</code> method that you suggested"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 517, "user_id": 8099673, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a45bb1bd39c6698a527b945ee6427de1?s=128&d=identicon&r=PG&f=1", "display_name": "Glenn G", "link": "https://stackoverflow.com/users/8099673/glenn-g"}, "edited": false, "score": 0, "creation_date": 1538600063, "post_id": 52633672, "comment_id": 92204290, "body": "Great to hear! Glad to help. I use DB2 on a Linux desktop. Would be cool to run on a mainframe!"}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": true, "score": 1, "last_activity_date": 1538591823, "creation_date": 1538591823, "answer_id": 52633672, "question_id": 52627991, "link": "https://stackoverflow.com/questions/52627991/in-excel-vba-run-sql-select-into-in-statement/52633672#52633672", "title": "In Excel VBA run SQL &quot;SELECT ... INTO ... IN ....&quot; Statement", "body": "<p>You cannot assign an action query like a make-table query (i.e., <code>SELECT</code> with <code>INTO</code> call) to a recordset. Consider executing your <code>DROP</code> and <code>SELECT ... INTO</code> action queries prior to opening recordset on the local table. Also, it is unclear why you are opening a second database or what the path points to. Below opens a recordset on the mainframe data:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Set DB = OpenDatabase(LocalDBPath, False, False)\n\nDB.Execute \"DROP TABLE DB2_TABLEA\", dbFailOnError\nDB.Execute sSQL, dbFailOnError\n\nSet RS = DB.OpenRecordset(\"SELECT * FROM DB2_TABLEA\")\n</code></pre>\n\n<hr>\n\n<p>Furthermore, the <code>IN</code> clause in your make-table query is unnecessary as you are currently connected to the very database you are running the action on. Simply remove it (<strike>'\" &amp; LocalDBPath &amp; \"'</strike>). Also, <code>LIKE</code> expressions without wildcards and on numbers should be replaced with <code>=</code></p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT \n    DB1_TABLEA.FIELD1, \n    DB1_TABLEA.FIELD2, \n    DB1_TABLEA.FIELD3, \n    DB1_TABLEA.FIELD4, \n    DB1_TABLEA.FIELD5, \n    DB1_TABLEA.FIELD6, \n    DB1_TABLEA.FIELD7, \n    DB1_TABLEA.FIELD8 \nINTO \n    DB2_TABLEA \nFROM \n    DB1_TABLEA\nWHERE \n    (\n        ((DB1_TABLEA.FIELD4) = 99999) \n        AND \n        ((DB1_TABLEA.FIELD6)='02' OR (DB1_TABLEA.FIELD6)='22')\n    )\n;\n</code></pre>\n\n<p>In fact, consider saving the query inside the MS Access database  (Ribbon -> Create -> Query Design -> SQL View) and call it as a named object and avoid any long SQL in VBA.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>DB.Execute \"DROP TABLE DB2_TABLEA\", dbFailOnError\nDB.Execute \"mySavedQuery\", dbFailOnError\n\nSet RS = DB.OpenRecordset(\"SELECT * FROM DB2_TABLEA\")\n</code></pre>\n"}], "owner": {"reputation": 517, "user_id": 8099673, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a45bb1bd39c6698a527b945ee6427de1?s=128&d=identicon&r=PG&f=1", "display_name": "Glenn G", "link": "https://stackoverflow.com/users/8099673/glenn-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1391, "favorite_count": 0, "accepted_answer_id": 52633672, "answer_count": 1, "score": 1, "last_activity_date": 1538623839, "creation_date": 1538572780, "last_edit_date": 1538623839, "question_id": 52627991, "link": "https://stackoverflow.com/questions/52627991/in-excel-vba-run-sql-select-into-in-statement", "title": "In Excel VBA run SQL &quot;SELECT ... INTO ... IN ....&quot; Statement", "body": "<p>I can't seem to find any good reference or example of how to get this to work.  I have a database which is stored on an AS/400 (my local MS Access database [stored on a network drive] has linked tables to the 400, using ODBC/DSN).  My utility works just fine passing SQL statements to through Access to retrieve data from the 400 using the linked tables.  The problem is that with some of the larger reports and the fact that the 400 is several states away, it can take several hours to run the reports.  The settled on solution to this is to create a local \"copy\" of the tables needed with just the data set that is relevant to the reports, which is a considerably smaller data set.  Obviously this has the down side of not being \"live\" data but I can live with that.  Ultimately what I want to do is gather the relevant  data from the linked table and save it to separate database that is local to the client so that it could be used if offsite/offline and to increase the speed of the report.</p>\n\n<p>network location stored database = DB1 (Tabled linked to AS/400)\nlocal client stored database = DB2 (relevant data set created by below SQL, non-linked tables named the same as the linked tables)</p>\n\n<p>Below is the SQL statement that I'm trying to get to work using VBA &amp; DAO</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT \n    DB1_TABLEA.FIELD1, \n    DB1_TABLEA.FIELD2, \n    DB1_TABLEA.FIELD3, \n    DB1_TABLEA.FIELD4, \n    DB1_TABLEA.FIELD5, \n    DB1_TABLEA.FIELD6, \n    DB1_TABLEA.FIELD7, \n    DB1_TABLEA.FIELD8 \nINTO \n    DB1_TABLEA IN 'Local_DB_Copy.accdb'    &lt;== Creating non-linked copy \nFROM \n    DB1_TABLEA\nWHERE \n    (\n        ((DB1_TABLEA.FIELD4) Like 99999) \n        AND \n        ((DB1_TABLEA.FIELD6)=\"02\" Or (DB1_TABLEA.FIELD6)=\"22\")\n    )\n;\n</code></pre>\n\n<p>I already have my program working fine and returning/processing data from the AS/400 DB.  I just need to be able to get the above to work so that people have the option to run a local copy that will process much faster.</p>\n\n<p>Below is the code that I tried, but of course it fails or I wouldn't be here.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub gCreateLocalDBTables()\n    Dim DBPath As String\n    Dim LocalDBPath As String\n    Dim sSQL As String\n    Dim DB As DAO.Database\n    Dim DB2 As DAO.Database\n    Dim RS As DAO.Recordset\n        LocalDBPath = \"AS400_Local.accdb\"\n        sSQL = \"SELECT DB1_TABLEA.FIELD1, DB1_TABLEA.FIELD2, DB1_TABLEA.FIELD3, DB1_TABLEA.FIELD4, DB1_TABLEA.FIELD5, DB1_TABLEA.FIELD6, DB1_TABLEA.FIELD7, DB1_TABLEA.FIELD8 INTO DB2_TABLEA IN '\" &amp; LocalDBPath &amp; \"' FROM DB1_TABLEA WHERE (((DB1_TABLEA.FIELD4) Like 99999) AND ((DB1_TABLEA.FIELD6)='02' Or (DB1_TABLEA.FIELD6)='22'));\"\n        Set DB = OpenDatabase(LocalDBPath, False, False)\n        DB.TableDefs.Delete (\"DB2_TABLEA\")\n        DB.Close\n        DBPath = Interaction.GetSetting(\"Cust_Tools\", \"Settings\\Report_Planning\", \"400DB_Location\")\n        Set DB2 = OpenDatabase(DBPath, False, False)\n        Set RS = DB2.OpenRecordset(sSQL)\n        RS.Close\n        DB2.Close\n        Set RS = Nothing\n        Set DB = Nothing\n        Set DB2 = Nothing\nEnd Sub\n</code></pre>\n\n<p>I know the SQL works as I have tested it from inside MS Access.  I just can't find info on how to get it to work being passed from Excel VBA </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 1, "creation_date": 1538570508, "post_id": 52627186, "comment_id": 92187918, "body": "Your two <code>Set ws = ...</code> lines are redundant. Eliminate the first one, as the second is more specific."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1538570590, "post_id": 52627186, "comment_id": 92187978, "body": "Also, you&#39;ll find your answer in the accepted answer to <a href=\"https://stackoverflow.com/questions/17359835/what-is-the-difference-between-text-value-and-value2\">this question</a> about the difference between <code>.text</code>, <code>.value</code> and <code>.value2</code>."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1538578699, "post_id": 52627186, "comment_id": 92193354, "body": "If <code>Construction HOC register.xlsm</code> is the file containing the code you can change it to <code>ThisWorkbook.Worksheets(&quot;hocregister&quot;)</code>.  - <code>ThisWorkbook</code> is <i>always</i> the file containing the code that&#39;s running (so you can change the name of your file without the whole thing breaking)."}], "answers": [{"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1538578607, "creation_date": 1538578607, "answer_id": 52629952, "question_id": 52627186, "link": "https://stackoverflow.com/questions/52627186/date-values-inserted-to-excel-cells-change-their-format/52629952#52629952", "title": "Date values inserted to Excel cells change their format", "body": "<p>Your form doesn't know the format of the values entered into a textbox, so you need to make it explicit when you copy the value to your sheet.</p>\n\n<p>Change to <code>ws.Cells(iRow, 2).Value = CDATE(Me.txthocdate.Value)</code> to convert the value in <em>txthocdate</em> to a date.</p>\n"}], "owner": {"reputation": 1, "user_id": 10451220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a18a7c9a959a7a3c62cc93283b3066f?s=128&d=identicon&r=PG&f=1", "display_name": "catalindemidov", "link": "https://stackoverflow.com/users/10451220/catalindemidov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1538579052, "creation_date": 1538570152, "last_edit_date": 1538579052, "question_id": 52627186, "link": "https://stackoverflow.com/questions/52627186/date-values-inserted-to-excel-cells-change-their-format", "title": "Date values inserted to Excel cells change their format", "body": "<p>I'm new in VBA, And I need help in a problem regarding the date format when is transferred from textbox to the cells is changing from dd/mm/yyyy to mm/dd/yyyy.</p>\n\n<p>This is the program that I create using a user form as interface in insert the data. My problem if I can not maintain the dd/mm/yyyy format when I transfer to the cells.</p>\n\n<pre><code>Private Sub cmdAdd_Click()\n\nDim iRow As Long\nDim ws As Worksheet\nSet ws = Worksheets(\"hocregister\")\nSet ws = Workbooks(\"Construction HOC register.xlsm\").Worksheets(\"hocregister\")\n\n\n'revised code to avoid problems with Excel tables in newer versions\niRow = ws.Cells.Find(What:=\"*\", SearchOrder:=xlRows, _\nSearchDirection:=xlPrevious, LookIn:=xlValues).Row + 1\n\n\n\n'copy the data to the database\nws.Cells(iRow, 2).Value = Me.txthocdate.Value\n</code></pre>\n"}, {"tags": ["html", "excel", "vba", "web-scraping"], "comments": [{"owner": {"reputation": 9489, "user_id": 185565, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e47ed0b05ec5411f11fc1b19908717a7?s=128&d=identicon&r=PG", "display_name": "Whome", "link": "https://stackoverflow.com/users/185565/whome"}, "edited": false, "score": 0, "creation_date": 1538569718, "post_id": 52626986, "comment_id": 92187351, "body": "If I use wget commanline to store an url it does not have <code>daysTips</code> element anywhere. Is it a dynamic runtime element or removed from the web page?"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10451188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6fdeb2d98a8654ef792a124e237ba3c?s=128&d=identicon&r=PG&f=1", "display_name": "A P1", "link": "https://stackoverflow.com/users/10451188/a-p1"}, "edited": false, "score": 1, "creation_date": 1538724961, "post_id": 52627080, "comment_id": 92251305, "body": "You beauty! thank you soooo much, that&#39;s been bugging me for ages. Really appreciate your input."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 13, "user_id": 10451188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6fdeb2d98a8654ef792a124e237ba3c?s=128&d=identicon&r=PG&f=1", "display_name": "A P1", "link": "https://stackoverflow.com/users/10451188/a-p1"}, "edited": false, "score": 0, "creation_date": 1538725021, "post_id": 52627080, "comment_id": 92251335, "body": "It was a cool problem. Took me a moment to realise what was going on with the element in question!"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1538571328, "last_edit_date": 1538571328, "creation_date": 1538569813, "answer_id": 52627080, "question_id": 52626986, "link": "https://stackoverflow.com/questions/52626986/scrape-info-from-nested-div-excel-vba/52627080#52627080", "title": "scrape info from nested div excel vba", "body": "<p>You need to do the click first on the down chevron</p>\n\n<p><a href=\"https://i.stack.imgur.com/ff0VD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ff0VD.png\" alt=\"enter image description here\"></a></p>\n\n<p>HTML:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ADWtu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ADWtu.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<pre><code>Option Explicit\nPublic Sub GetInfo()\n    Dim IE As New InternetExplorer\n    With IE\n        .Visible = True\n        .navigate \"https://pcsupport.lenovo.com/gb/en/products/laptops-and-netbooks/thinkpad-x-series-laptops/thinkpad-x280-type-20kf-20ke/20ke/20kes5sd09/pc0x5yhz/warranty\"\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n        IE.document.querySelector(\".icon.icon-s-down\").Click\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n        Debug.Print IE.document.querySelector(\".daysTips span\").innerText\n        .Quit \n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10451188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6fdeb2d98a8654ef792a124e237ba3c?s=128&d=identicon&r=PG&f=1", "display_name": "A P1", "link": "https://stackoverflow.com/users/10451188/a-p1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 344, "favorite_count": 0, "accepted_answer_id": 52627080, "answer_count": 1, "score": 1, "last_activity_date": 1538725048, "creation_date": 1538569451, "last_edit_date": 1538725048, "question_id": 52626986, "link": "https://stackoverflow.com/questions/52626986/scrape-info-from-nested-div-excel-vba", "title": "scrape info from nested div excel vba", "body": "<p>I'm trying to extract the start date from the following, but my code cant seem to see the 'nested\" div \"daysTips\" any help would be great. Thank you.</p>\n\n<p><strong>HTML Screen Shot:</strong>\n<a href=\"https://i.stack.imgur.com/4fej8.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4fej8.jpg\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub warranty2()\n\nDim elements As IHTMLElementCollection\nDim IE As New InternetExplorer\nDim Doc As HTMLDocument\n\nIE.Visible = True\nIE.navigate \"https://pcsupport.lenovo.com/gb/en/products/laptops-and-netbooks/thinkpad-x-series-laptops/thinkpad-x280-type-20kf-20ke/20ke/20kes5sd09/pc0x5yhz/warranty\"\n\nDo\n DoEvents\nLoop Until IE.readyState = READYSTATE_COMPLETE\n\nSet Doc = IE.document\nSet elements = Doc.getElementsByClassName(\"daysTips\")\n\nFor i = 0 To elements.Length - 1\n Sheet1.Range(\"G\" &amp; (i + 1)) = elements(i).innerText\nNext i\n\nIE.Quit\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "merge", "powerquery"], "comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1538569939, "post_id": 52626867, "comment_id": 92187522, "body": "Hello and welcome to <a href=\"https://stackoverflow.com\">Stack Overflow</a>! Please take the <a href=\"https://stackoverflow.com/tour\">tour</a> and read through the <a href=\"https://stackoverflow.com/help\">help center</a> to learn what we&#39;ll do to help you. TL;DR: This isn&#39;t a code writing service so you&#39;ll have to provide your best shot at it and indicate where you&#39;re stuck, then someone will help you fix that specific issue. As you&#39;ve written your question, nobody but you would even have the slightest idea where to start to help you..."}, {"owner": {"reputation": 167, "user_id": 5725420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/017faecd3978c1585fe0ca21a2b76f40?s=128&d=identicon&r=PG&f=1", "display_name": "C.A.R.", "link": "https://stackoverflow.com/users/5725420/c-a-r"}, "edited": false, "score": 0, "creation_date": 1538572408, "post_id": 52626867, "comment_id": 92189177, "body": "FreeMan is right - without showing us some data, or the macro code, we&#39;ll have no idea where to start helping you."}, {"owner": {"reputation": 3648, "user_id": 7346922, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/272fd618206744f794467b795bea29f1?s=128&d=identicon&r=PG&f=1", "display_name": "Marc Pincince", "link": "https://stackoverflow.com/users/7346922/marc-pincince"}, "edited": false, "score": 0, "creation_date": 1538766504, "post_id": 52626867, "comment_id": 92273608, "body": "I think you&#39;re trying something similar to <a href=\"https://stackoverflow.com/questions/50860598/values-hard-coded-after-power-query-runs-is-dislocated-when-data-source-updates/50861832#50861832\">what this person was</a>. See @MarcelBeug&#39;s answer to <a href=\"https://stackoverflow.com/questions/40653178/inserting-text-manually-in-a-custom-column-and-should-be-visible-on-refresh-of-t/40656881#406568\">this earlier posted question</a>. He includes this <a href=\"https://www.youtube.com/watch?v=duNYHfvP_8U&amp;feature=youtu.be\" rel=\"nofollow noreferrer\">link to a good video</a> that he made to show how it&#39;s done."}, {"owner": {"reputation": 21, "user_id": 8843367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae5d630e09f55f7a82c216e94869cdfb?s=128&d=identicon&r=PG&f=1", "display_name": "Tucker Black", "link": "https://stackoverflow.com/users/8843367/tucker-black"}, "edited": false, "score": 0, "creation_date": 1538779410, "post_id": 52626867, "comment_id": 92277764, "body": "Marc Pincince that is exactly what I was looking for.  Thank you."}], "owner": {"reputation": 21, "user_id": 8843367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae5d630e09f55f7a82c216e94869cdfb?s=128&d=identicon&r=PG&f=1", "display_name": "Tucker Black", "link": "https://stackoverflow.com/users/8843367/tucker-black"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 234, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1538569027, "creation_date": 1538569027, "question_id": 52626867, "link": "https://stackoverflow.com/questions/52626867/excel-power-query-and-manual-entry", "title": "Excel Power Query and manual entry", "body": "<p>In Excel, I have created a table through a series of queries that shows all the equipment awaiting calibration in my lab.  And then through VBA assigned technicians to certain equipment. That part works GREAT.  The part that I need help with is when that table refreshes.  It is set to refresh every hour, but when it does it clears out my \"Assigned Technician\" column.  If I run the VBA macro again, it will assign items differently than before.</p>\n\n<p>So I want the table to refresh, but I want it to not overwrite the \"Assigned Technician\" column with a null value (which it keeps doing). I've creating a copy of the first table which will hold on to the manually entered Tech names, and then merging the \"Assigned Tech\" column back into the original after the refresh, but it is not working right.  I am guessing because the second table is a reference of the first, so I cant merge a dependent table back into the parent table.  Is there a way that I can do this without creating a ridiculous amount of tables and queries that I am just going to hide from the user in the end?</p>\n\n<p>I am sorry if I am not using the right jargon or verbiage.  I don't use this skill set that often. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "edited": false, "score": 1, "creation_date": 1538569187, "post_id": 52626828, "comment_id": 92187016, "body": "what do you mean by &quot;multiple row of number&quot; ?"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1538569335, "post_id": 52626828, "comment_id": 92187121, "body": "Why not just <code>Filter</code> Column A on <code>2265174</code>, and <code>Delete</code> the results?"}, {"owner": {"reputation": 11, "user_id": 10450222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/115bd9de5e4995b37b21d5770c5963a5?s=128&d=identicon&r=PG&f=1", "display_name": "J.Joe", "link": "https://stackoverflow.com/users/10450222/j-joe"}, "edited": false, "score": 0, "creation_date": 1538569686, "post_id": 52626828, "comment_id": 92187333, "body": "I mean that I want to filter after 150BL then delete few row like &quot;2265174&quot; and &quot;1545478&quot; and so on"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 1, "creation_date": 1538569715, "post_id": 52626828, "comment_id": 92187348, "body": "When deleting rows, it&#39;s recommended to start at the bottom and work your way up. Also, you may what to try @Chronocidal&#39;s suggestion, or you can use <code>.Find()</code> to find and delete each row with your (no longer) desired text."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1538569763, "post_id": 52626828, "comment_id": 92187387, "body": "Change <code>If Sheet1.Cells(rad, 1).Value = &quot;2265174&quot; Then</code> to <code>If Sheet1.Cells(rad, 1).Value = &quot;2265174&quot; Or Sheet1.Cells(rad,1).Value = &quot;other value&quot; Then</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1538570321, "post_id": 52626828, "comment_id": 92187789, "body": "btw&#178;, <code>Sheet1</code> is very likely the codename of your first worksheet. You shouldn&#39;t use it as a variable."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1538570532, "post_id": 52626828, "comment_id": 92187937, "body": "btw&#179;, you might be interested in a very fast row deletion method detailed <a href=\"https://stackoverflow.com/questions/52578570\">here</a>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1538570591, "post_id": 52626828, "comment_id": 92187979, "body": "btw, <code>&quot;2265174&quot;</code> is not the same as <code>2265174</code>. If you have true numbers on your worksheet, they will <b>not</b> be equal to a string that looks like them."}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 3, "last_activity_date": 1538573165, "creation_date": 1538573165, "answer_id": 52628104, "question_id": 52626828, "link": "https://stackoverflow.com/questions/52626828/vba-delete-multiple-row-in-excel/52628104#52628104", "title": "VBA delete multiple row in excel", "body": "<p>Consider:</p>\n\n<pre><code>Sub remove_rows()\n\n    Dim rad As Long, rrad As Long\n    Dim Sheet1 As Worksheet\n\n    Set Sheet1 = Worksheets(\"Export Worksheet\")\n\n    Application.ScreenUpdating = False\n\n    'Which row do u want to start with?\n    rrad = Sheet1.Cells(Rows.Count, 1).End(xlUp).Row\n\n    'Loop row that delete all row in Sheet1 that contain number 2265174\n\n    For rad = rrad To 1 Step -1\n        If Sheet1.Cells(rad, 1).Text = \"2265174\" Then\n            Rows(rad).Delete\n        End If\n    Next rad\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p><strong>Note:</strong></p>\n\n<ul>\n<li>use <code>Long</code> rather than <code>Integer</code></li>\n<li>run the loop <strong>backwards</strong></li>\n<li>use <code>.Text</code> to catch both numeric and text values</li>\n</ul>\n"}], "owner": {"reputation": 11, "user_id": 10450222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/115bd9de5e4995b37b21d5770c5963a5?s=128&d=identicon&r=PG&f=1", "display_name": "J.Joe", "link": "https://stackoverflow.com/users/10450222/j-joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1538573165, "creation_date": 1538568881, "last_edit_date": 1538569254, "question_id": 52626828, "link": "https://stackoverflow.com/questions/52626828/vba-delete-multiple-row-in-excel", "title": "VBA delete multiple row in excel", "body": "<p>I need help with this code, how can I make it do delete multiple row of number? Should I use \"And\" function ? </p>\n\n<p>Thanks </p>\n\n<pre><code>Sub remove_rows()\n\n    Dim rad As Integer\n    Dim Sheet1 As Worksheet\n\n    Set Sheet1 = Worksheets(\"Export Worksheet\")\n\n    Application.ScreenUpdating = False\n\n    'Which row do u want to start with?\n    rad = 1\n\n    'Loop row that delete all row in Sheet1 that contain number 2265174\n\n    Do Until IsEmpty(Sheet1.Cells(rad, 1)) = True\n        If Sheet1.Cells(rad, 1).Value = \"2265174\" Then\n            Rows(rad).Delete\n            rad = rad - 1\n        End If\n        rad = rad + 1\n\n    Loop\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "validation", "excel-formula"], "comments": [{"owner": {"reputation": 167, "user_id": 5725420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/017faecd3978c1585fe0ca21a2b76f40?s=128&d=identicon&r=PG&f=1", "display_name": "C.A.R.", "link": "https://stackoverflow.com/users/5725420/c-a-r"}, "edited": false, "score": 1, "creation_date": 1538572477, "post_id": 52626786, "comment_id": 92189208, "body": "Please give us some examples of data and anything that you&#39;ve already tried."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10451160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7e58feac84b7a91f5df8708c29423f1?s=128&d=identicon&r=PG&f=1", "display_name": "FrederikIMEX", "link": "https://stackoverflow.com/users/10451160/frederikimex"}, "edited": false, "score": 0, "creation_date": 1538658705, "post_id": 52628472, "comment_id": 92227019, "body": "A variation of this worked, thanks."}], "tags": [], "owner": {"reputation": 540, "user_id": 7747667, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6XJn7.jpg?s=128&g=1", "display_name": "oxwilder", "link": "https://stackoverflow.com/users/7747667/oxwilder"}, "is_accepted": true, "score": 1, "last_activity_date": 1538574268, "creation_date": 1538574268, "answer_id": 52628472, "question_id": 52626786, "link": "https://stackoverflow.com/questions/52626786/cell-value-change-based-on-other-cell/52628472#52628472", "title": "Cell value change based on other cell", "body": "<p>I'm assuming you have drop-down lists assigned for each cell in the \"Status\" column. This code assumes that column's range is c1:c7, which you should change to whatever your range is.</p>\n\n<pre><code>Sub Worksheet_Change(ByVal responses As Range)\n\n\nSet responses = Range(\"c1:c7\")\n\nFor Each r In responses.Rows\n    If Cells(r.Row, 3).Value = \"Failed\" Then\n        For i = r.Row To responses.Rows.Count\n            If Cells(i, 3) = \"To Do\" Then\n                Cells(i, 3) = \"Incomplete\"\n            End If\n        Next i\n    End If\n Next r\n\nEnd Sub\n</code></pre>\n\n<p>Good luck</p>\n"}], "owner": {"reputation": 3, "user_id": 10451160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7e58feac84b7a91f5df8708c29423f1?s=128&d=identicon&r=PG&f=1", "display_name": "FrederikIMEX", "link": "https://stackoverflow.com/users/10451160/frederikimex"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "closed_date": 1538579312, "accepted_answer_id": 52628472, "answer_count": 1, "score": -2, "last_activity_date": 1594024653, "creation_date": 1538568733, "last_edit_date": 1594024653, "question_id": 52626786, "link": "https://stackoverflow.com/questions/52626786/cell-value-change-based-on-other-cell", "closed_reason": "Needs more focus", "title": "Cell value change based on other cell", "body": "<p>for testcase purposes I have created an excel with test steps.\nFor every test step there is a 'status' cell, possible values are 'To Do,Passed, Failed, Incomplete'. \nWhat I want to do is when I select 'Failed' for a step, the following steps below with value 'To Do' are automatically changed to 'Incomplete'. \nI don't know why I can't find a clear solution for this so sorry if it's easier than the general level of questions asked here. </p>\n"}, {"tags": ["vba", "excel", "rgb"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 7, "creation_date": 1538568663, "post_id": 52626712, "comment_id": 92186689, "body": "The <code>Sub</code> is <i>named</i> RGB. Just change it to something else."}, {"owner": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "edited": false, "score": 0, "creation_date": 1538569511, "post_id": 52626712, "comment_id": 92187227, "body": "Is it resolved with Comintern&#39;s comment  ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1538569918, "post_id": 52626712, "comment_id": 92187507, "body": "To add to @Comintern&#39;s response, your own RGB sub has no arguments and you are trying to shove in three. Change your sub to RgB and see how the RGB function below changes."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1538570030, "post_id": 52626712, "comment_id": 92187580, "body": "To sum up the comments so far, change your <code>Sub</code> name from <code>RGB</code> to <code>SetInteriorColor</code> and watch magic happen."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1538570366, "post_id": 52626712, "comment_id": 92187824, "body": "I take offense at &quot;for dummies type language&quot;. Understanding how member hiding and identifier resolution works in this dummy language should be simple enough."}], "answers": [{"tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": true, "score": 1, "last_activity_date": 1538575125, "last_edit_date": 1538575125, "creation_date": 1538574770, "answer_id": 52628625, "question_id": 52626712, "link": "https://stackoverflow.com/questions/52626712/vba-rbg-wrong-number-of-arguments-or-invalid-property-argument/52628625#52628625", "title": "VBA RBG - &quot;Wrong number of arguments or invalid property argument&quot;", "body": "<p>In case the comments haven't explained it fully.. you state in your question:</p>\n\n<blockquote>\n  <p>earlier today, I wrote a macro in a different (now closed\n  spreadsheet), where I used the initials \"rgb\" as a variant name.</p>\n</blockquote>\n\n<p>However, in the example you provide, you've actually called the Subroutine you're calling RGB as well. <strong><em>This</em></strong> is the cause of the issue. Renaming it would fix it but while I'm here I can share with you some other points:</p>\n\n<hr>\n\n<p>This would work:</p>\n\n<pre><code>Option Explicit\n\nSub Set_G20_RGB()\n    Dim wb As Workbook\n    Dim ws As Worksheet\n    Set wb = ThisWorkbook\n    Set ws = Sheets(\"Sheet1\")   ' should really be Set ws = wb.Sheets(\"Sheet1\")\n    ws.Range(\"G20\").Interior.Color = RGB(255, 51, 204)\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>However, to make it a little more useful, you might want to use something like:</p>\n\n<pre><code>Option Explicit\n\nSub Set_RGB(clr_rng As Range, red_value As Integer, grn_value As Integer, blu_value As Integer)\n    clr_rng.Interior.Color = RGB(red_value, grn_value, blu_value)\nEnd Sub\n</code></pre>\n\n<p>Which could be called like so:</p>\n\n<pre><code>Set_RGB ThisWorkbook.Sheets(\"Sheet1\").Range(\"G20\"), 255, 51, 204\n</code></pre>\n\n<p>or..</p>\n\n<pre><code>Dim wb As Workbook\nDim ws As Worksheet\nSet wb = ThisWorkbook\nSet ws = wb.Sheets(\"Sheet1\")\n\nSet_RGB ws.Range(\"G20\"), 255, 51, 204\n</code></pre>\n"}], "owner": {"reputation": 297, "user_id": 6078710, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/26d98bf3153a211b4b308b6660e78ae1?s=128&d=identicon&r=PG&f=1", "display_name": "Statsanalyst", "link": "https://stackoverflow.com/users/6078710/statsanalyst"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 251, "favorite_count": 0, "accepted_answer_id": 52628625, "answer_count": 1, "score": -1, "last_activity_date": 1538576419, "creation_date": 1538568488, "last_edit_date": 1538576419, "question_id": 52626712, "link": "https://stackoverflow.com/questions/52626712/vba-rbg-wrong-number-of-arguments-or-invalid-property-argument", "title": "VBA RBG - &quot;Wrong number of arguments or invalid property argument&quot;", "body": "<p>I know there are other questions which deal with the \"Wrong number of arguments or invalid property assignment\", but none which deal with this error being generated on a basic line assigning an RGB colour to a cell interior.  </p>\n\n<p>This error is generating on line 6 of the below.  I don't understand how this is possible, as RGB clearly has three arguments.  </p>\n\n<p>The only thing I can think of is that, earlier today, I wrote a macro in a different (now closed spreadsheet), where I used the initials \"rgb\" as a variant name.  I know that, in R, it's possible to redefine a base function accidentally by replacing it with a UDF, and I'm wondering whether perhaps I've now unwittingly changed \"rgb\" to be something other than the function in the VBA base code.  But that doesn't sound plausible - I've never heard of that happening in VBA, and it's more of a \"for dummies\" type language which I wouldn't have thought would give users that optionality.  </p>\n\n<p><strong>EDIT</strong> Yes - this issue is resolved by changing the name of the macro, which is a stupid error.  However, I would point out that this error is also happening in a different subroutine, which I have not named in such a stupid fashion.  I will need to investigate why it's happening in that sub too.  </p>\n\n<pre><code>Option Explicit\nSub RGB()\nDim wb As Workbook\nDim ws As Worksheet\nSet wb = ThisWorkbook\nSet ws = Sheets(\"Sheet1\")\n\nws.Range(\"G20\").Interior.Color = RGB(255, 51, 204)\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 96, "user_id": 10351957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FhPLN.jpg?s=128&g=1", "display_name": "Hamed", "link": "https://stackoverflow.com/users/10351957/hamed"}, "is_accepted": false, "score": 0, "last_activity_date": 1538565460, "creation_date": 1538565460, "answer_id": 52625878, "question_id": 52625522, "link": "https://stackoverflow.com/questions/52625522/vba-to-paste-from-one-column-to-another/52625878#52625878", "title": "VBA to paste from one column to another?", "body": "<p>Note that in excel you can copy from filtered area, but when you are pasting, data will not paste on filtered(visible) cells, instead pasted continuously. There is 2 way to do your task:</p>\n\n<p>1: Use loop</p>\n\n<pre><code>Sub MyCopyPaste()\n    Dim RngCnt As Range\n    Dim LastRow As Long\n    LastRow = Range(\"AM\" &amp; Rows.Count).End(xlUp).Row\n    For Each RngCnt In Range(\"AM1:AM\" &amp; LastRow).SpecialCells(xlCellTypeVisible)\n        Range(\"AG\" &amp; RngCnt.Row).Value = Range(\"AM\" &amp; RngCnt.Row).Value\n    Next\nEnd Sub\n</code></pre>\n\n<p>2: Without Loop</p>\n\n<p>If in some case you don't want use loop or vba, you should create another column and put an ID number into it. This column will used to sort the worksheet to retain rows order to original. Then create another column with name custom_Order and after filtering, put numbers into it, then show all data and sort worksheet based on custom_order and then filter it. In this case all your expected rows will be filter and come continuously and you can easily copy and paste.</p>\n"}, {"comments": [{"owner": {"reputation": 3306, "user_id": 4229796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x9p0l.jpg?s=128&g=1", "display_name": "Dipali Shah", "link": "https://stackoverflow.com/users/4229796/dipali-shah"}, "edited": false, "score": 1, "creation_date": 1538567367, "post_id": 52625959, "comment_id": 92185997, "body": "While this may answer the question, try to add some explanation for better understanding."}], "tags": [], "owner": {"reputation": 364, "user_id": 5229863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab9106274e202c226490fa7f85b069f9?s=128&d=identicon&r=PG&f=1", "display_name": "Wouter", "link": "https://stackoverflow.com/users/5229863/wouter"}, "is_accepted": false, "score": 0, "last_activity_date": 1538573938, "last_edit_date": 1538573938, "creation_date": 1538565751, "answer_id": 52625959, "question_id": 52625522, "link": "https://stackoverflow.com/questions/52625522/vba-to-paste-from-one-column-to-another/52625959#52625959", "title": "VBA to paste from one column to another?", "body": "<pre><code>Sub sample48()\n\n Range(\"A1:AQ1\").AutoFilter Field:=33, Criteria1:=\"COD*\"\n Range(\"AG:AG\").Copy\n Range(\"AM:AM\").PasteSpecial\n\nEnd Sub\n</code></pre>\n\n<p>This does quite literaly what you asked:</p>\n\n<ul>\n<li>filter your range</li>\n<li>copy colmun AG (because it is filtered, only filtered values are copied)</li>\n<li>paste filtered values in AM</li>\n</ul>\n\n<p>you can not use an equation on a range for an entire range. Also, judging by your description, I assume your equation had to be the other way around.</p>\n"}], "owner": {"reputation": 13, "user_id": 10389185, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Fq-Y-zI8LwU/AAAAAAAAAAI/AAAAAAAACnI/Z9hfiWkqp7M/photo.jpg?sz=128", "display_name": "Revathi kannan", "link": "https://stackoverflow.com/users/10389185/revathi-kannan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 610, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1538613661, "creation_date": 1538564201, "last_edit_date": 1538613661, "question_id": 52625522, "link": "https://stackoverflow.com/questions/52625522/vba-to-paste-from-one-column-to-another", "title": "VBA to paste from one column to another?", "body": "<p>I need code for the below requirement, wherein the below code is not working:</p>\n\n<pre><code>Sub sample48()\nWorksheets(\"Sheet\").Select\n Range(\"AG1\").Select\n    Range(\"A1:AQ1\").Autofilter Field:=33, Criteria1:=\"COD*\"\n  Range(\"AG:AG\").Value = Range(\"AM:AM\").Value\nEnd Sub\n</code></pre>\n\n<p>I need to filter a word called <code>**COD**</code> in column AG, and then I need to copy and paste values from Column AG to Column AM only for the those filtered line items.</p>\n"}, {"tags": ["database", "vba", "ms-access", "seed"], "answers": [{"tags": [], "owner": {"reputation": 179, "user_id": 7985048, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212776808360059/picture?type=large", "display_name": "Simon Curtis", "link": "https://stackoverflow.com/users/7985048/simon-curtis"}, "is_accepted": true, "score": 0, "last_activity_date": 1540484437, "creation_date": 1540484437, "answer_id": 52993944, "question_id": 52625421, "link": "https://stackoverflow.com/questions/52625421/tableadapter-insert-into-access-db-get-current-seed-value-for-id/52993944#52993944", "title": "TableAdapter.Insert (into ACCESS DB) get current Seed value for ID", "body": "<p>If you want to use table adapters for ease, just created a \"Select Max(ID) From myTable\" scalar query then just call it to get the last value. </p>\n\n<pre><code>int resultID = myTableAdapter.GetLastID();\n</code></pre>\n"}], "owner": {"reputation": 725, "user_id": 1937012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/178d02fdce471914ea8aa35149b05e82?s=128&d=identicon&r=PG", "display_name": "user1937012", "link": "https://stackoverflow.com/users/1937012/user1937012"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 52993944, "answer_count": 1, "score": -1, "last_activity_date": 1593955301, "creation_date": 1538563764, "last_edit_date": 1593955301, "question_id": 52625421, "link": "https://stackoverflow.com/questions/52625421/tableadapter-insert-into-access-db-get-current-seed-value-for-id", "title": "TableAdapter.Insert (into ACCESS DB) get current Seed value for ID", "body": "<p>I am trying to alter an existing programm in VB , I am not experienced in this language , but unfortunately I cannot convert it for now.</p>\n\n<p>I created the DB Connections with the Designer , which automatically created the BindingSource, TableAdapter , DataSet .</p>\n\n<p>I insert something into this table like this :</p>\n\n<pre><code>Me.Validate()\n\nmyBindingSource.EndEdit()\n\nmyTableAdapter.Insert(1, 1, \"test\", 100, Now, 1, Now)\n</code></pre>\n\n<p>I would now like to get CURRENT_SEED valuer for the ID field ( which is Autoincrement ) \ncan I do it somehow here without making some extra connection , is it returned somewhere ?</p>\n\n<p>Regards\nRobert</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 2, "creation_date": 1538563202, "post_id": 52625117, "comment_id": 92183632, "body": "Why don&#39;t you just make your new project open a workbook with these functions in as a hidden book? This type of thing could be used in PERSONAL.xlsb but I had so many problems with it that I just created my own workbook with classes of my own functions in. Each project I create refers to this workbook."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1538563216, "post_id": 52625117, "comment_id": 92183641, "body": "There are no built-in functions or single-line methods for those three tasks, however if you&#39;re using 100 lines to do them, I bet your code could be compressed considerably (if you were to post it)"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 1, "creation_date": 1538563390, "post_id": 52625117, "comment_id": 92183738, "body": "@jamheadart - i assume you mean &quot;hidden worksheet&quot;?  Interesing to hear your feedback on <code>personal.xlb</code>. An alternative is to create a workbook with your custom functions, and save it as a <code>.xlam</code> <b>add-in</b>, and then add the add-in to Excel and then the functions will be available to all workbooks... (Disclaimer: I couldn&#39;t get this working myself - although I gave up pretty fast. I think my issue was that there&#39;s possibly a difference between worksheet add-ins and VBA add-ins..?)"}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1538563550, "post_id": 52625117, "comment_id": 92183837, "body": "No I mean a workbook you can open in a hidden window. Much like the default PERSONAL.xlsb that would be created when recording macros. I had quite a few issues with this back on 2010/2013 and particularly when opening Excel via .Net applications with the Excel.Interops functions."}, {"owner": {"reputation": 56, "user_id": 9108451, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ryxpzg8OnAM/AAAAAAAAAAI/AAAAAAAAAC8/rFKjRo11ttg/photo.jpg?sz=128", "display_name": "TheSmizen", "link": "https://stackoverflow.com/users/9108451/thesmizen"}, "reply_to_user": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1538566210, "post_id": 52625117, "comment_id": 92185317, "body": "@jamheadart the scripts are often distributed elsewhere - a personal or add-on workbook wouldn&#39;t really work. I&#39;m looking specifically for a library which does this."}, {"owner": {"reputation": 56, "user_id": 9108451, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ryxpzg8OnAM/AAAAAAAAAAI/AAAAAAAAAC8/rFKjRo11ttg/photo.jpg?sz=128", "display_name": "TheSmizen", "link": "https://stackoverflow.com/users/9108451/thesmizen"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1538566267, "post_id": 52625117, "comment_id": 92185358, "body": "@ashleedawg thanks, but it was just an estimate and those were an example few. They usually only take about 2 to 10 lines each incl. Error handling."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1538569041, "post_id": 52625117, "comment_id": 92186932, "body": "It might be easier to answer this if we understood what you are doing. How could there be a library to do all of the little checks you want to do like &quot;Other random handy functions that I like to use.dll&quot;?"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1538570319, "post_id": 52625117, "comment_id": 92187786, "body": "Totally beside the point, but really you could do all of these including function definitions in about 11 lines of code. For instance: <code>fncArrayEmpty = Len(Join(arr, &quot;&quot;)) = 0</code> or <code>fncItemInArray = InStr(1, &quot;|&quot; &amp; Join(arr, &quot;|&quot;) &amp; &quot;|&quot;, &quot;|&quot; &amp; item &amp; &quot;|&quot;) &gt; 0</code> and the <code>fncSheetExists</code> can be done in about three lines."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1538571223, "post_id": 52625117, "comment_id": 92188397, "body": "I got that <code>fncSheetExists</code> down to one line (cheating though): <code>On Error Resume Next: fncSheetExists = ThisWorkbook.Worksheets(sheetname).Name = sheetname</code> Totally going to use that in some future vba monstrosity."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1538571722, "post_id": 52625117, "comment_id": 92188721, "body": "A couple of other options here: <a href=\"http://www.geeksengine.com/article/create-dll.html\" rel=\"nofollow noreferrer\">Roll your own dll</a> which would be pretty simple and you can use the excel interop library in C# to work with the Excel application (just like VBA really). You could also just export your module or class and reimport it into each project. I do this with some database classes I wrote for ADODB. It pulls hundreds of lines of code in, but so what? It&#39;s in it&#39;s own class module and works 100% and all I have to do is import the thing each time I need it."}, {"owner": {"reputation": 56, "user_id": 9108451, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ryxpzg8OnAM/AAAAAAAAAAI/AAAAAAAAAC8/rFKjRo11ttg/photo.jpg?sz=128", "display_name": "TheSmizen", "link": "https://stackoverflow.com/users/9108451/thesmizen"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1538571737, "post_id": 52625117, "comment_id": 92188730, "body": "@JNevill I like this suggestion - cheers. That&#39;s a definite thing I&#39;ll tinker with.  On the writing things in one line issue: that&#39;s not the important bit, it&#39;s just that I have to write it for each project that&#39;s the issue :) Was hoping there was a standard &#39;vba tools&#39; library I was just totally missing"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1538571883, "post_id": 52625117, "comment_id": 92188825, "body": "I think the real trick here is that you probably distribute these workbooks to other folks. If the code is hiding in a seperate workbook (hidden, personal, etc) then it won&#39;t be available for the other computers. The same is true with rolling your own DLL and using Tools&gt;&gt;References. However if you have a shared drive then maybe you could skirt around that (of course then you hit the &quot;Trusted locations&quot; issue and walking a user through that is about the most painful experience in the world...) caveats everywhere you turn. Anyway, export/import module is probably the way I would go. No Fuss."}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 1, "creation_date": 1538574609, "post_id": 52625117, "comment_id": 92190649, "body": "1. <code>Personal.xlsb</code> is made specifically for this purpose when operating only on your own computer. 2. In case you need to share this across multiple colleagues or whatever, saving as <code>xlam</code> and providing them the add-in would be the best option. 3. To answer the question &quot;Is there a kind of toolset library which exists and comes with ms Office which already does these things&quot; - No, but this is the premise for option 2 (<code>xlam</code> / add-in)  DLL is an option, like writing add-in using interop in C#/vb.net. The sharing issue will remain. Basically - someone add an answer please :)"}], "owner": {"reputation": 56, "user_id": 9108451, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ryxpzg8OnAM/AAAAAAAAAAI/AAAAAAAAAC8/rFKjRo11ttg/photo.jpg?sz=128", "display_name": "TheSmizen", "link": "https://stackoverflow.com/users/9108451/thesmizen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1538562799, "creation_date": 1538562799, "question_id": 52625117, "link": "https://stackoverflow.com/questions/52625117/excel-vba-extended-toolset", "title": "Excel VBA extended toolset", "body": "<p>Whenever I start a new excel VBA project, I always need to create myself some new functionality such as these Boolean functions to check if things exist, are empty, etc:</p>\n\n<pre><code> fncSheetExists(ByVal sheetname) as Boolean\n fncArrayEmpty(ByRef array) as Boolean\n fncItemInArray(ByVal item, ByRef array) as Boolean\n</code></pre>\n\n<p>It adds a hundred or so lines to each new project. Is there a kind of toolset library which exists and comes with ms Office which already does these things? I feel I'm writing redundant code.</p>\n\n<p>Cheers for the help in advance.</p>\n"}, {"tags": ["excel", "vba", "excel-2013", "custom-formatting"], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 3493112, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/cNhpu.jpg?s=128&g=1", "display_name": "botakelymg", "link": "https://stackoverflow.com/users/3493112/botakelymg"}, "edited": false, "score": 0, "creation_date": 1538672383, "post_id": 52635862, "comment_id": 92235641, "body": "&#39;&gt;&gt;&gt; ATTENTION si Ajout de Colonnes &lt;&lt;&lt;   ReInvoicingWBook.Sheets(G_sheetNameREINVOICinG).Range(&quot;U&quot; &amp;  iNoLine2Write).FormulaR1C1 = &quot;=fG_ReFormattingInvoiceNumber(RC[-19],3)&quot;     ReInvoicingWBook.Sheets(G_sheetNameREINVOICinG).Range(&quot;U&quot; &amp; iNoLine2Write).Calculate    &#39;&gt;&gt;&gt; And I use Option Explicit in the monitoring application.  But it does not work... Once again, the formula is just pasted."}], "tags": [], "owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "is_accepted": true, "score": 0, "last_activity_date": 1538601689, "creation_date": 1538601689, "answer_id": 52635862, "question_id": 52624971, "link": "https://stackoverflow.com/questions/52624971/excel-vba-2013-customised-sub-only-pasted-not-executed-in-cell-with-use-of-formu/52635862#52635862", "title": "Excel VBA 2013 Customised Sub only Pasted not executed in cell with use of FormulaR1C1", "body": "<p>You can force a calculation of cells by using <code>.Calculate</code>.</p>\n\n<pre><code>Sub Macro3()\n    Range(\"F5\").FormulaR1C1 = \"=fG_ReFormattingInvoiceNumber(RC[-3],3)\"\n    Range(\"F5\").Calculate\n    ActiveWorkbook.Save\nEnd Sub\n</code></pre>\n\n<p>As a general rule, <strong>always</strong> use <code>Option Explicit</code>, avoid using <code>.Select</code> and <code>.Activate</code>. Also, fully qualify your ranges (which is something I have not done in the example above because I have no context).</p>\n"}, {"tags": [], "owner": {"reputation": 53, "user_id": 3493112, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/cNhpu.jpg?s=128&g=1", "display_name": "botakelymg", "link": "https://stackoverflow.com/users/3493112/botakelymg"}, "is_accepted": false, "score": 0, "last_activity_date": 1538684067, "creation_date": 1538684067, "answer_id": 52654485, "question_id": 52624971, "link": "https://stackoverflow.com/questions/52624971/excel-vba-2013-customised-sub-only-pasted-not-executed-in-cell-with-use-of-formu/52654485#52654485", "title": "Excel VBA 2013 Customised Sub only Pasted not executed in cell with use of FormulaR1C1", "body": "<p>I found the reason why it doesn't work : the cell was formatted in Text whereas it must be as General. It's fine now.</p>\n"}], "owner": {"reputation": 53, "user_id": 3493112, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/cNhpu.jpg?s=128&g=1", "display_name": "botakelymg", "link": "https://stackoverflow.com/users/3493112/botakelymg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 52635862, "answer_count": 2, "score": 0, "last_activity_date": 1538684067, "creation_date": 1538562356, "last_edit_date": 1538562652, "question_id": 52624971, "link": "https://stackoverflow.com/questions/52624971/excel-vba-2013-customised-sub-only-pasted-not-executed-in-cell-with-use-of-formu", "title": "Excel VBA 2013 Customised Sub only Pasted not executed in cell with use of FormulaR1C1", "body": "<p>I've written a specific sub for formatting data from another cell.</p>\n\n<pre><code>Sub Macro3()\n    '&gt;&gt; First record to get the original code in Testing.xlsm &lt;&lt;\n    Range(\"F5\").Select\n    ActiveCell.FormulaR1C1 = \"=fG_ReFormattingInvoiceNumber(RC[-3],3)\"\n    Range(\"H5\").Select\n    ActiveWorkbook.Save\n\n    '&gt;&gt;&gt; I wrote in my application this line =&gt; ReInvoicingWBook.Sheets _\n    '    (G_sheetNameREINVOICinG).Range(\"U5\").FormulaR1C1 = _\n    '    \"=fG_ReFormattingInvoiceNumber(RC[-19],3)\"\nEnd Sub\n</code></pre>\n\n<p>The problem is that <code>ReInvoicingWBook.Sheets(G_sheetNameREINVOICinG).Range(\"U5\")</code> Cell is just filled with the formula but it is not executed. </p>\n\n<p><code>ReInvoicingWBook</code> is a file opened by the Excel application I'm developing and writing inside it.</p>\n\n<p>Yet, calling to <code>fG_ReFormattingInvoiceNumber()</code> works nice in the original file <code>Testing.xlsm</code>/ Sub <code>Macro3</code>  where I captured VBA lines.</p>\n\n<p>The 1st thing I see is the fact that <code>ReInvoicingWBook</code> is a pointer to a file XLSM that is monitored by my application. Perhaps, it's a reason...</p>\n\n<p>Any solution or help from you are appreciated.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 721, "user_id": 7889129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0oYIA.jpg?s=128&g=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7889129/maddy"}, "edited": false, "score": 4, "creation_date": 1538560566, "post_id": 52624283, "comment_id": 92182105, "body": "What you tried so far? where you stuck Or getting problem?"}, {"owner": {"reputation": 67, "user_id": 9139573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c49628b16c5a4dfa7e26868a23cec863?s=128&d=identicon&r=PG&f=1", "display_name": "MelBee", "link": "https://stackoverflow.com/users/9139573/melbee"}, "reply_to_user": {"reputation": 721, "user_id": 7889129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0oYIA.jpg?s=128&g=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7889129/maddy"}, "edited": false, "score": 0, "creation_date": 1538620618, "post_id": 52624283, "comment_id": 92209209, "body": "Since the question was not well placed, I did an edit on the questions and placed some of what I did in it. Hopefully it helps."}, {"owner": {"reputation": 67, "user_id": 9139573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c49628b16c5a4dfa7e26868a23cec863?s=128&d=identicon&r=PG&f=1", "display_name": "MelBee", "link": "https://stackoverflow.com/users/9139573/melbee"}, "reply_to_user": {"reputation": 721, "user_id": 7889129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0oYIA.jpg?s=128&g=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7889129/maddy"}, "edited": false, "score": 0, "creation_date": 1538621017, "post_id": 52624283, "comment_id": 92209277, "body": "The error occurs in the If Statement where I try to handle the #N/A values. How do I deal with them?"}, {"owner": {"reputation": 721, "user_id": 7889129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0oYIA.jpg?s=128&g=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7889129/maddy"}, "edited": false, "score": 0, "creation_date": 1538636796, "post_id": 52624283, "comment_id": 92214178, "body": "Please check my answer"}], "answers": [{"tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": -1, "last_activity_date": 1538562396, "creation_date": 1538562396, "answer_id": 52624989, "question_id": 52624283, "link": "https://stackoverflow.com/questions/52624283/calculating-new-cells-containing-true-false-outputs-from-cells-also-containing/52624989#52624989", "title": "Calculating new cells containing True/False outputs from cells also containing #N/A values using VBA", "body": "<p>Assuming there isn't a reason you actually <em>need</em> to do this in VBA (since you haven't included any code with your question) all you need is a simple worksheet formula.</p>\n\n<p>If Columns <code>A</code> and <code>B</code> contain the data you need to compare, starting on row <code>3</code> (like your example implies), enter this formula in Cell <code>C3</code>:</p>\n\n<pre><code>=IF(A3&amp;B3=\"\",\"\",A3=B3)\n</code></pre>\n\n<p>...then copy/paste (of \"fill down\") the formula as far as necessary.</p>\n\n<p>If the concatenated values of columns A &amp; B are <em>blank</em> it returns an empty string (<code>\"\"</code>) otherwise it returns the comparison of columns A &amp; B (<code>TRUE</code> or <code>FALSE</code>).</p>\n\n<hr>\n\n<p>Incidentally if not for the requirement to \"return nothing if blank\" then the formula would have been about as simple as they get:</p>\n\n<p><code>=A3=B3</code></p>\n"}, {"comments": [{"owner": {"reputation": 67, "user_id": 9139573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c49628b16c5a4dfa7e26868a23cec863?s=128&d=identicon&r=PG&f=1", "display_name": "MelBee", "link": "https://stackoverflow.com/users/9139573/melbee"}, "edited": false, "score": 0, "creation_date": 1538638925, "post_id": 52640931, "comment_id": 92215289, "body": "I still get an error on the if statement line. The error says &quot;Type mismatch&quot;."}], "tags": [], "owner": {"reputation": 721, "user_id": 7889129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0oYIA.jpg?s=128&g=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7889129/maddy"}, "is_accepted": false, "score": 0, "last_activity_date": 1538636854, "creation_date": 1538636854, "answer_id": 52640931, "question_id": 52624283, "link": "https://stackoverflow.com/questions/52624283/calculating-new-cells-containing-true-false-outputs-from-cells-also-containing/52640931#52640931", "title": "Calculating new cells containing True/False outputs from cells also containing #N/A values using VBA", "body": "<p>Try using <code>IsEmpty</code> and <code>IsError</code> </p>\n\n<pre><code>    For i = 1 To loopNum\n    If IsEmpty(Range(\"A\" &amp; i)) Or IsEmpty(Range(\"B\" &amp; i)) Or IsError(Range(\"A\" &amp; i)) Or IsError(Range(\"B\" &amp; i)) Then\n            Range(\"C\" &amp; i).Value = \"#N/A\"\n    Else\n        If Range(\"A\" &amp; i).Value = Range(\"B\" &amp; i).Value Then\n            Range(\"C\" &amp; i).Value = True\n        Else\n            Range(\"C\" &amp; i).Value = False\n        End If\n    End If\n    Next i\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1538781945, "post_id": 52658161, "comment_id": 92278279, "body": "<a href=\"https://stackoverflow.com/users/2164931/vincent-maury\">Vincent Maury</a> gave a great answer to handling VBA errors answering the question <a href=\"https://stackoverflow.com/questions/15526784/why-am-i-getting-error-2042-in-vba-match/15526912#15526912\">Why am I getting Error 2042 in VBA Match?</a> which pointed me to Microsoft&#39;s <a href=\"https://docs.microsoft.com/en-us/office/vba/excel/Concepts/Cells-and-Ranges/cell-error-values\" rel=\"nofollow noreferrer\">Cell Error Values</a>."}, {"owner": {"reputation": 67, "user_id": 9139573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c49628b16c5a4dfa7e26868a23cec863?s=128&d=identicon&r=PG&f=1", "display_name": "MelBee", "link": "https://stackoverflow.com/users/9139573/melbee"}, "edited": false, "score": 0, "creation_date": 1538966687, "post_id": 52658161, "comment_id": 92316026, "body": "A very detailed solution which took me awhile to ingest before I got it to work for my data. Thank you for taking the time to write such neat and organized code. I appreciate it very much!"}], "tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": true, "score": 0, "last_activity_date": 1538783977, "last_edit_date": 1538783977, "creation_date": 1538711846, "answer_id": 52658161, "question_id": 52624283, "link": "https://stackoverflow.com/questions/52624283/calculating-new-cells-containing-true-false-outputs-from-cells-also-containing/52658161#52658161", "title": "Calculating new cells containing True/False outputs from cells also containing #N/A values using VBA", "body": "<h2>Handling the infamous VBA Errors (2042) successfully!?</h2>\n\n<p>Before using this code be sure you have studied at least the customize section carefully or you might lose data.<br>\nMost importantly the second column must always be adjacent to the right of the first column, otherwise this code couldn't have been done with the 'array copy-paste version'.<br>\n@Melbee: I am assuming you have your initial data in columns A\n<code>ciFirstCol</code>\n and B <code>iSecondCol = ciFirstCol + 1</code> and the result should be in column C <code>cCOff 'if 1 then first column next to the second column</code>. If not make changes in the customize section.  </p>\n\n<pre><code>Option Explicit\n'-------------------------------------------------------------------------------\nSub XthColumnResult()\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n'Description\n  'In an Excel worksheet uses two adjacent columns of initial data as arguments\n  'for a function whose result is pasted into a third column anywhere to the\n  'right of the two initial columns.\n  '(In short: 2 cols of data, perform calculation, result in third column)\n'Arguments as constants\n  'cWbName\n    'The path of the workbook, if \"\" then ActiveWorkbook\n  'cWsName\n    'Name of the worksheet, if \"\" then ActiveSheet\n  'cloFirstRow\n    'First row of data\n  'ciFirstCol\n    'First column of data\n  'cCOff\n    'Column offset, where to paste the results into.\n'Returns\n  'The resulting data in a new column to the right of the two initial adjacent\n  'columns of data.\n\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n'-- CUSTOMIZE BEGIN --------------------\n  Const cWbName As String = \"\" 'Workbook Path (e.g. \"C:\\MyExcelVBA\\Data.xls\")\n  Const cWsName As String = \"\" 'Worksheet Name (e.g. \"Sheet1\", \"Data\",... etc.\n  Const cloFirstRow As Long = 3 'First Row of Data\n\n  'Const cloLastRow as Long = Unknown &gt;therefore&gt; Dim loRow as Long\n\n  Const ciFirstCol As Integer = 1 'First Column of Data (1 for A, 2 for B etc.\n\n  'Second column of data must be adjacent to the right of first column.\n  'See iSecondCol. Therefore Dim iSecondCol As Integer\n\n  'Column offset where to paste the results into. Default is 1 i.e. the first\n  'column next to the second column.\n  Const cCOff As Integer = 1\n'-- CUSTOMIZE END ----------------------\n\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n  'Variables\n  Const cStrVBAError As String = \"Error 20\" 'Debug VBA Error Variable\n  Const cStrVBAErrorMessage As String = \"Not Possible.\" 'Debug VBA Error Message\n  Dim oWb As Workbook\n  Dim oWs As Worksheet\n  Dim oRng As Range\n  Dim TheArray() As Variant\n  Dim SmallArray() As Variant\n  Dim loRow As Long 'Last Row of Data\n  Dim iSecondCol As Integer 'Second Column of Data\n  Dim iF1 As Integer 'Column Counter\n  Dim loArr As Long 'Array Row Counter\n  Dim iArr As Integer 'Array Column Counter\n  Dim str1 As String 'Debug String\n  Dim str2 As String 'Debug Helper String\n  Dim varArr As Variant 'Helper Variable for the Array\n\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n  'Determine workbook and worksheet\n  If cWbName = \"\" Then\n    Set oWb = ActiveWorkbook\n   Else\n    Set oWb = Workbooks(cWbName)\n  End If\n  If cWsName = \"\" Then\n    Set oWs = oWb.ActiveSheet\n   Else\n    Set oWs = oWb.Worksheets(cWsName)\n  End If\n\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n  'Calculate second column of data\n  iSecondCol = ciFirstCol + 1\n  'Calculate last row of data (the greatest row of all columns)\n  loRow = 0\n  'Trying to translate the code to English:\n  'For each column go to the last cell and press crtl+up which is the last\n  'cell used in that column and use the row property...\n  For iF1 = ciFirstCol To iSecondCol\n    '...and check if it is greater than loRow.\n    If loRow &lt; oWs.Cells(Rows.Count, ciFirstCol + iF1 - 1).End(xlUp).Row Then\n      'Assign the row to loRow (if it is greater than loRow).\n      loRow = oWs.Cells(Rows.Count, ciFirstCol + iF1 - 1).End(xlUp).Row\n    End If\n  Next\n\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n  'Status\n    'The last row of data has been calculated. Additionally the first row, the\n    'first column and the second column will be the arguments of the following\n    'range (to be assigned to an array).\n  'Remarks\n    'When performing calculation, objects like workbooks, worksheets, ranges are\n    'usually very slow. To speed up, an array is introduced to hold the data\n    'and to calculate from there which is dozens of times faster.\n\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n  'Assign the range of data to an array.\n  TheArray = oWs.Range(Cells(cloFirstRow, ciFirstCol), Cells(loRow, iSecondCol))\n\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n  'Status\n    'All data is now in TheArray ready for calculation.\n\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n\n'  str1 = \"Initial Contents in TheArray\"\n'  For loArr = LBound(TheArray, 1) To UBound(TheArray, 1)\n'    For iArr = LBound(TheArray, 2) To UBound(TheArray, 2)\n'      If iArr &gt; 1 Then\n'        str1 = str1 &amp; Chr(9) 'Next Column\n'       Else 'First run-though.\n'        str1 = str1 &amp; vbCrLf 'Next Row\n'      End If\n'      If Not IsError(TheArray(loArr, iArr)) Then\n'        str1 = str1 &amp; TheArray(loArr, iArr)\n'       Else\n'        str1 = str1 &amp; VbaErrorString(TheArray(loArr, iArr))\n'      End If\n'    Next\n'  Next\n'  Debug.Print str1\n'  str1 = \"\"\n\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n  'Remarks\n    'A one-based array is needed to be pasted into the worksheet via range.\n\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n  'Create a new array for the resulting column.\n  ReDim SmallArray(LBound(TheArray) To UBound(TheArray), 1 To 1)\n\n  'Calculate values of the resulting column.\n  For loArr = LBound(TheArray, 1) To UBound(TheArray, 1)\n    'Read values from TheArray and calculate.\n    If IsError(TheArray(loArr, 1)) Then 'First column error\n      'VBA Error Handling, the result if both columns contain an error.\n      varArr = VbaErrorString(TheArray(loArr, 1))\n     Else\n      If IsError(TheArray(loArr, 2)) Then 'Second column error\n        'VBA Error Handling\n        varArr = VbaErrorString(TheArray(loArr, 2))\n       Else\n        If TheArray(loArr, 1) = \"\" Or TheArray(loArr, 2) = \"\" Then '\"\"\n           varArr = \"#N/A\"\n         Else\n          Select Case TheArray(loArr, 1) 'Equal\n            Case TheArray(loArr, 2)\n              varArr = True\n            Case Is &lt;&gt; TheArray(loArr, 2) 'Not equal\n              varArr = False\n            Case Else\n              varArr = \"UNKNOWN ERROR\" 'Should never happen.\n          End Select\n        End If\n      End If\n    End If\n    'Write the results to SmallArray.\n    SmallArray(loArr, 1) = varArr\n  Next\n\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n  'Status\n    'The resulting column containing the results has been written to SmallArray.\n\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n\n'  str1 = \"Resulting Contents in SmallArray\"\n'  For loArr = LBound(SmallArray, 1) To UBound(SmallArray, 1)\n'    If Not IsError(SmallArray(loArr, 1)) Then\n'      str1 = str1 &amp; vbCrLf &amp; SmallArray(loArr, 1)\n'     Else\n'      'VBA Error Handling\n'      str1 = str1 &amp; vbCrLf &amp; VbaErrorString(SmallArray(loArr, 1))\n'    End If\n'  Next\n'  Debug.Print str1\n\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n  'Calculate the range where to paste the data,\n  Set oRng = oWs.Range(Cells(cloFirstRow, iSecondCol + 1), _\n    Cells(loRow, iSecondCol + 1))\n  'Paste the resulting column to worksheet.\n  oRng = SmallArray\n\n'  str1 = \"Results of the Range\"\n'  For loArr = 1 To oRng.Rows.Count\n'    If Not IsError(oRng.Cells(loArr, 1)) Then\n'      str2 = oRng.Cells(loArr, 1)\n'     Else\n'      'VBA Error Handling\n'      str2 = VbaErrorCell(oRng.Cells(loArr, 1))\n'    End If\n'    str1 = str1 &amp; vbCrLf &amp; str2\n'  Next\n'  Debug.Print str1\n\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n  'Status\n    'The resulting data has been pasted from SmallArray to the resulting\n    'column in the worksheet.\n\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n\nEnd Sub\n'-------------------------------------------------------------------------------\nFunction VbaErrorCell(rCell As Range) As String\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n'Description\n  'Converts a VBA error (variant) IN A RANGE to an Excel error value (string).\n'Arguments\n  'rCell\n    'A cell range with a possible VBA error.\n      'If cell range contains more than one cell, the first cell is used.\n'Returns\n  'An Excel error value (string) if the cell contains an error value, \"\" if not.\n\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n  Const cVErrLeft As String = \"Error 20\" 'Debug VBA Error Variable\n  Const cStrNewError As String = \"New Error. Update this Function!\"\n  Const cStrNoError As String = \"\"\n\n''''''''''''''''''''''''''''''''''''''''\n  Dim strCStr As String 'The rCell Value Converted to a String\n  Dim strRes As String 'One of the Excel Cell Error Values\n\n''''''''''''''''''''''''''''''''''''''''\n  strCStr = Left(CStr(rCell(1, 1)), Len(cVErrLeft))\n  If strCStr = cVErrLeft Then\n    Select Case Right(CStr(rCell), 2)\n      Case \"00\": strRes = \"#NULL!\"\n      Case \"07\": strRes = \"#DIV/0!\"\n      Case \"15\": strRes = \"#VALUE!\"\n      Case \"23\": strRes = \"#REF!\"\n      Case \"29\": strRes = \"#NAME?\"\n      Case \"36\": strRes = \"#NUM!\"\n      Case \"42\": strRes = \"#N/A\"\n      Case Else: strRes = cStrNewError 'New Error.\n    End Select\n   Else\n     strRes = cStrNoError 'Not a VBA Error\n  End If\n  VbaErrorCell = strRes\n\n''''''''''''''''''''''''''''''''''''''''\nEnd Function\n'-------------------------------------------------------------------------------\nFunction VbaErrorString(strString As Variant) As String\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n'Description\n  'Converts a VBA error (variant) IN A STRING to an Excel error value (string).\n'Arguments\n  'strString\n    'A string with a possible VBA Error.\n'Returns\n  'An Excel error value (string) if the cell contains an error value, \"\" if not.\n\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n  Const cVErrLeft As String = \"Error 20\" 'Debug VBA Error Variable\n  Const cStrNewError As String = \"New Error. Update this Function!\"\n  Const cStrNoError As String = \"\"\n\n''''''''''''''''''''''''''''''''''''''''\n  Dim strCStr As String 'The strString Value Converted to a String\n  Dim strRes As String 'One of the Excel Cell Error Values\n\n''''''''''''''''''''''''''''''''''''''''\n  strCStr = Left(CStr(strString), Len(cVErrLeft))\n  If strCStr = cVErrLeft Then\n    Select Case Right(CStr(strString), 2)\n      Case \"00\": strRes = \"#NULL!\"\n      Case \"07\": strRes = \"#DIV/0!\"\n      Case \"15\": strRes = \"#VALUE!\"\n      Case \"23\": strRes = \"#REF!\"\n      Case \"29\": strRes = \"#NAME?\"\n      Case \"36\": strRes = \"#NUM!\"\n      Case \"42\": strRes = \"#N/A\"\n      Case Else: strRes = cStrNewError 'New Error.\n    End Select\n   Else\n     strRes = cStrNoError 'Not a VBA Error\n  End If\n  VbaErrorString = strRes\n\n''''''''''''''''''''''''''''''''''''''''\nEnd Function\n'-------------------------------------------------------------------------------\n</code></pre>\n\n<p>Additionally in view of automation to update the cells automatically, you might want to put the following code into the sheets code window:</p>\n\n<pre><code>Option Explicit\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n  XthColumnResult\nEnd Sub\n</code></pre>\n\n<p>The ideal solution should be with the Change event, but it throws the 'Run-time error 28: Out of stack space', so I used the SelectionChange event instead.<br>\nThe only drawback I could find was that when you delete a cell with 'del' the value in the third column isn't updated before you move out of the cell.<br>\nAs always sorry for the 'overcommenting'.</p>\n"}], "owner": {"reputation": 67, "user_id": 9139573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c49628b16c5a4dfa7e26868a23cec863?s=128&d=identicon&r=PG&f=1", "display_name": "MelBee", "link": "https://stackoverflow.com/users/9139573/melbee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 1, "accepted_answer_id": 52658161, "answer_count": 3, "score": -6, "last_activity_date": 1538848987, "creation_date": 1538560211, "last_edit_date": 1538848987, "question_id": 52624283, "link": "https://stackoverflow.com/questions/52624283/calculating-new-cells-containing-true-false-outputs-from-cells-also-containing", "title": "Calculating new cells containing True/False outputs from cells also containing #N/A values using VBA", "body": "<p>In an Excel worksheet there is a title in the first row and there are titles of each column in the second row. The columns titled '<strong>A</strong>' and '<strong>B</strong>' contain the initial data, and the column titled '<strong>TF</strong>' will contain the resulting data (Excel columns <strong>A</strong>, <strong>B</strong> and <strong>C</strong> respectively).<br>\nIn the following code, the numbers from 1 to 5 on the left are just <strong>row headers</strong> and are <strong>not</strong> data in the worksheet.</p>\n\n<pre><code>1  Table\n2  A    B   TF\n3  ABC  ABC TRUE\n4  ABC  BAC FALSE\n5  #N/A ABC #N/A\n</code></pre>\n\n<p>What I have tried.</p>\n\n<pre><code>Sub Compare2Col()\nDim colAnum As Integer, colBnum As Integer, loopNum As Integer, i As Integer\n    Dim holder As Variant\ncolAnum = Worksheets(\"Sheet1\").Range(\"A1048576\").End(xlUp).Row\ncolBnum = Worksheets(\"Sheet1\").Range(\"B1048576\").End(xlUp).Row\nIf colAnum &gt; colBnum Then\n    loopNum = colAnum\nElse\n    loopNum = colBnum\nEnd If\nFor i = 3 To loopNum\nIf Range(\"A\" &amp; i).Value = \"\" Or Range(\"B\" &amp; i).Value = \"\" Or Range(\"A\" &amp; i).Value = \"#N/A\" Or Range(\"B\" &amp; i).Value = \"#N/A\" Then\n        Range(\"C\" &amp; i).Value = \"#N/A\"\nElse\n    If Range(\"A\" &amp; i).Value = Range(\"B\" &amp; i).Value Then\n        Range(\"C\" &amp; i).Value = True\n    Else\n        Range(\"C\" &amp; i).Value = False\n    End If\nEnd If\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>This is the code I am trying to work with currently. In some cells I will be having these \"#N/A\" values. How do I have an if statement so that when it is true, it just places the same \"#N/A\" value into the third column.</p>\n\n<p>I read that these #N/A values are errors. So in VBA I placed a #N/A value into a variable in the following way:</p>\n\n<pre><code>holder = Range(\"A\" &amp; 5).Value\n</code></pre>\n\n<p>The result of the 'holder' variable was '<strong>Error 2042</strong>'.</p>\n\n<p>Thanks in advance. Really appreciate any help!</p>\n"}, {"tags": ["vba", "excel", "data-processing"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1538554325, "post_id": 52622404, "comment_id": 92178664, "body": "You&#39;ve offered no indication on how you could prophesize the expected target workbook name. You aren&#39;t opening the workbooks in your loop or passing the filename into SplitData. Perhaps once you&#39;ve actually opened a file you can determine the target workbook filename(s) and if they exist run MergeData, if not run SplitData."}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1538554833, "post_id": 52622404, "comment_id": 92178936, "body": "@Danni  .... Where is the <code>SplitData</code> Macro ? Can you add code from that macro as well ?"}, {"owner": {"reputation": 99, "user_id": 8645552, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jzU1lmqnDq8/AAAAAAAAAAI/AAAAAAAAAVM/I9fTqjN8PTE/photo.jpg?sz=128", "display_name": "Danni", "link": "https://stackoverflow.com/users/8645552/danni"}, "edited": false, "score": 0, "creation_date": 1538554878, "post_id": 52622404, "comment_id": 92178953, "body": "@Jeeped Thanks for you reply. Perhaps I wasn&#39;t being clear, the output three workbooks&#39; names are already decided and cannot be changed. The overall process is actually splitting original workbooks based on one column, which has 3 different values <code>N1 N2 N3</code>, and then merging each extracted three workbooks into three big ones."}, {"owner": {"reputation": 99, "user_id": 8645552, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jzU1lmqnDq8/AAAAAAAAAAI/AAAAAAAAAVM/I9fTqjN8PTE/photo.jpg?sz=128", "display_name": "Danni", "link": "https://stackoverflow.com/users/8645552/danni"}, "reply_to_user": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1538555216, "post_id": 52622404, "comment_id": 92179127, "body": "@MohitBansal Please refer to the updated the question:)"}, {"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 1, "creation_date": 1538562003, "post_id": 52622404, "comment_id": 92182948, "body": "<code>On Error Resume Next</code> may be masking an error."}], "answers": [{"comments": [{"owner": {"reputation": 968, "user_id": 5910169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a40180e3fa49fbf4e55145adf54d9?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Ball", "link": "https://stackoverflow.com/users/5910169/frank-ball"}, "edited": false, "score": 1, "creation_date": 1538577670, "post_id": 52628702, "comment_id": 92192608, "body": "Using this demands that you use good error-handling.   If you turn off alerts and then your code fails at some point prior to the alerts being switched back on, you end with Excel in a very bad state.  Read Chip Pearson&#39;s excellent article on this - <a href=\"http://www.cpearson.com/excel/errorhandling.htm\" rel=\"nofollow noreferrer\">cpearson.com/excel/errorhandling.htm</a>"}, {"owner": {"reputation": 99, "user_id": 8645552, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jzU1lmqnDq8/AAAAAAAAAAI/AAAAAAAAAVM/I9fTqjN8PTE/photo.jpg?sz=128", "display_name": "Danni", "link": "https://stackoverflow.com/users/8645552/danni"}, "edited": false, "score": 0, "creation_date": 1538617343, "post_id": 52628702, "comment_id": 92208563, "body": "@oxwilder Thanks for your reply. But one more question, after the alert is disabled, my first two extracted workbook keeps updating same result from the first workbook that I started extraction while the third one trapped in a loop, adding same result from the starting workbook. I assume there&#39;s something wrong with my loop but cannot find it, could you please help me check?"}, {"owner": {"reputation": 540, "user_id": 7747667, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6XJn7.jpg?s=128&g=1", "display_name": "oxwilder", "link": "https://stackoverflow.com/users/7747667/oxwilder"}, "reply_to_user": {"reputation": 99, "user_id": 8645552, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jzU1lmqnDq8/AAAAAAAAAAI/AAAAAAAAAVM/I9fTqjN8PTE/photo.jpg?sz=128", "display_name": "Danni", "link": "https://stackoverflow.com/users/8645552/danni"}, "edited": false, "score": 0, "creation_date": 1538656315, "post_id": 52628702, "comment_id": 92225461, "body": "@Danni I&#39;d be happy to help as may many others here, but you might want to mark this particular question as answered and post a new question stating your next requirement."}], "tags": [], "owner": {"reputation": 540, "user_id": 7747667, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6XJn7.jpg?s=128&g=1", "display_name": "oxwilder", "link": "https://stackoverflow.com/users/7747667/oxwilder"}, "is_accepted": true, "score": 0, "last_activity_date": 1538575029, "creation_date": 1538575029, "answer_id": 52628702, "question_id": 52622404, "link": "https://stackoverflow.com/questions/52622404/merge-if-output-workbook-name-already-exists/52628702#52628702", "title": "Merge if output workbook name already exists", "body": "<p>Assuming you have set the filename you want in the path you have in the script, change </p>\n\n<pre><code>Application.DisplayAlerts = True\n</code></pre>\n\n<p>to </p>\n\n<pre><code>Application.DisplayAlerts = false \n</code></pre>\n\n<p>to avoid getting the overwrite warning.</p>\n\n<p>Change it back to true after it's saved to prevent problems elsewhere.</p>\n\n<p>Hope it helps</p>\n"}], "owner": {"reputation": 99, "user_id": 8645552, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jzU1lmqnDq8/AAAAAAAAAAI/AAAAAAAAAVM/I9fTqjN8PTE/photo.jpg?sz=128", "display_name": "Danni", "link": "https://stackoverflow.com/users/8645552/danni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "accepted_answer_id": 52628702, "answer_count": 1, "score": 0, "last_activity_date": 1538575029, "creation_date": 1538553589, "last_edit_date": 1538555154, "question_id": 52622404, "link": "https://stackoverflow.com/questions/52622404/merge-if-output-workbook-name-already-exists", "title": "Merge if output workbook name already exists", "body": "<p>I'm have about 100 <code>.xls</code> files under one folder and I have a Macro script to loop through each one to do some data processing. The objective is to split each workbook into three with name <code>N1</code>, <code>N2</code>, <code>N3</code> respectively. So far my <code>SplitData</code> Macro worked fine but I have issue with extracted workbooks. </p>\n\n<p>I want to merge newly extracted three workbooks to already existed ones instead of getting alerts like \"File N1 already exists.\" every time. I wonder if there's anyway to achieve this in VBA script? Or any other solutions?</p>\n\n<p>Thanks!</p>\n\n<p>This is my code to loop through folder:</p>\n\n<pre><code>Sub OpenFiles()\n    Dim xStrPath As String\n    Dim xFileDialog As FileDialog\n    Dim xFile As String\n    On Error Resume Next\n    Set xFileDialog = Application.FileDialog(msoFileDialogFolderPicker)\n    xFileDialog.AllowMultiSelect = False\n    xFileDialog.Title = \"Select a folder\"\n    If xFileDialog.Show = -1 Then\n        xStrPath = xFileDialog.SelectedItems(1)\n    End If\n    If xStrPath = \"\" Then Exit Sub\n    xFile = Dir(xStrPath &amp; \"\\*.xls\")\n\n    Do While xFile &lt;&gt; \"\"\n        Call SplitData\n    Loop\nEnd Sub\n</code></pre>\n\n<p>This is SplitData Macro:</p>\n\n<pre><code>Sub SplitData()\n ' 1. Fill every cells in merged columns for future steps\n            Dim cell As Range, joinedCells As Range\n\n            For Each cell In Range(\"E4:I60\")\n                If cell.MergeCells Then\n                    Set joinedCells = cell.MergeArea\n                    cell.MergeCells = False\n                    joinedCells.Value = cell.Value\n                End If\n            Next\n\n\n            ' 2. Split original sheet into three based on one col value \n            ' loop through selected column to check if has different values\n            Const NameCol = \"B\"\n            Const HeaderRow = 3\n            Const FirstRow = 4\n            Dim SrcSheet As Worksheet\n            Dim TrgSheet As Worksheet\n            Dim SrcRow As Long\n            Dim LastRow As Long\n            Dim TrgRow As Long\n            Dim Student As String\n            Application.ScreenUpdating = False\n            Set SrcSheet = ActiveSheet\n            LastRow = SrcSheet.Cells(SrcSheet.Rows.Count, NameCol).End(xlUp).Row\n            For SrcRow = FirstRow To LastRow\n                Student = SrcSheet.Cells(SrcRow, NameCol).Value\n                Set TrgSheet = Nothing\n                On Error Resume Next\n                Set TrgSheet = Worksheets(Student)\n                On Error GoTo 0\n                If TrgSheet Is Nothing Then\n                    Set TrgSheet = Worksheets.Add(After:=Worksheets(Worksheets.Count))\n                    TrgSheet.Name = Student\n                    SrcSheet.Rows(HeaderRow).Copy Destination:=TrgSheet.Rows(HeaderRow)\n                End If\n            TrgRow = TrgSheet.Cells(TrgSheet.Rows.Count, NameCol).End(xlUp).Row + 1\n            SrcSheet.Rows(SrcRow).Copy Destination:=TrgSheet.Rows(TrgRow)\n            Next SrcRow\n            Application.ScreenUpdating = True\n\n\n            ' 3. Extract three new worksheets into three workbooks \n            Dim Pointer As Long\n\n            Set MainWorkBook = ActiveWorkbook\n            Range(\"E4\").Value = MainWorkBook.Sheets.Count\n\n            Application.ScreenUpdating = False   'enhance the performance\n            For Pointer = 2 To MainWorkBook.Sheets.Count\n                Set NewWorkbook = Workbooks.Add\n                MainWorkBook.Sheets(Pointer).Copy After:=NewWorkbook.Sheets(1)\n                Application.DisplayAlerts = False\n                NewWorkbook.Sheets(1).Delete\n                Application.DisplayAlerts = True\n                With NewWorkbook\n                    .SaveAs Filename:=\"D:\\***\\Inventory\\\" &amp; MainWorkBook.Sheets(Pointer).Name &amp; \".xls\"\n                End With\n                NewWorkbook.Close SaveChanges:=True\n            Next Pointer\n\n            Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "runtime-error"], "comments": [{"owner": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "edited": false, "score": 3, "creation_date": 1538553335, "post_id": 52622196, "comment_id": 92178142, "body": "Probably the value that you&#39;re trying to find doesn&#39;t exist in the range A2:G126."}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1538553423, "post_id": 52622196, "comment_id": 92178174, "body": "You could try to use <code>debug.print(FindMe)</code> in between the <code>Set FindMe</code> and <code>Range(&quot;L8&quot;)..</code> lines to see the value of <code>FindMe</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10427053"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1538553738, "post_id": 52622196, "comment_id": 92178350, "body": "@Luuklag sorry, i cant get the idea. can you show it to me?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10427053"}, "reply_to_user": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "edited": false, "score": 0, "creation_date": 1538553773, "post_id": 52622196, "comment_id": 92178373, "body": "@ImranMalek i already put data in the range A2:G126."}, {"owner": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "edited": false, "score": 0, "creation_date": 1538553965, "post_id": 52622196, "comment_id": 92178464, "body": "@Ayra Are you able to find those values manually with Ctrl+F ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10427053"}, "reply_to_user": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "edited": false, "score": 0, "creation_date": 1538554131, "post_id": 52622196, "comment_id": 92178575, "body": "@ImranMalek yes."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10427053"}, "edited": false, "score": 0, "creation_date": 1538553889, "post_id": 52622442, "comment_id": 92178425, "body": "Sorry, but still have the same error even I&#39;m using your coding."}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1538553912, "post_id": 52622442, "comment_id": 92178436, "body": "You are still trying to assign the value of FindMe to cell L8. Propper indentation from OP would have helped here. I&#39;ve gone about and edited that in your code."}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1538553961, "post_id": 52622442, "comment_id": 92178461, "body": "@ayra, I corrected a mistake in the code, try again."}, {"owner": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1538554107, "post_id": 52622442, "comment_id": 92178549, "body": "@Luuklag Thanks for the edit , I completely missed that ! :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10427053"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1538554321, "post_id": 52622442, "comment_id": 92178660, "body": "@Luuklag thankyou. it works. but, can I ask -- why it said no value found even though I already have data? did you have any idea about this?"}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1538554902, "post_id": 52622442, "comment_id": 92178968, "body": "Your data is probably not a good match, but impossible to say without seeing the data."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10427053"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1538554962, "post_id": 52622442, "comment_id": 92178998, "body": "Oh okay, ill try to figure out by myself. Thanks ya! @Luuklag"}], "tags": [], "owner": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "is_accepted": true, "score": 2, "last_activity_date": 1538553944, "last_edit_date": 1538553944, "creation_date": 1538553708, "answer_id": 52622442, "question_id": 52622196, "link": "https://stackoverflow.com/questions/52622196/why-does-it-come-out-variable-not-set/52622442#52622442", "title": "Why does it come out variable not set?", "body": "<p>The value that you're trying to find doesn't exist in the range.</p>\n\n<p>Try to wrap your code around If condition to check if find returns anything or not !</p>\n\n<pre><code>Sub test()\n    Set Searchme = Range(\"L9\")\n    Set FindMe = Range(\"A2:G126\").Find(What:=\"Searchme\", LookIn:=xlValues, LookAt _\n        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\n        False, SearchFormat:=False)\n\n\n\nIf FindMe Is Nothing Then\n    MsgBox \"No value found.\"\n    'or you can negate the condition like \"If Not\" if you want to continue and remove the else part.\nElse\n  Range(\"L8\").Value = Cells(2, FindMe.Column)\n  Range(\"A1:G126\").AdvancedFilter Action:=xlFilterCopy, CriteriaRange:=Range( _\n        \"L8:L9\"), CopyToRange:=Range(\"N8:T8\"), Unique:=False\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10427053"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 52622442, "answer_count": 1, "score": 0, "last_activity_date": 1538554881, "creation_date": 1538552819, "last_edit_date": 1538554881, "question_id": 52622196, "link": "https://stackoverflow.com/questions/52622196/why-does-it-come-out-variable-not-set", "title": "Why does it come out variable not set?", "body": "<p>I have a problem, when I try to debug this coding it will appear </p>\n\n<blockquote>\n  <p>RUNTIME ERROR 91; OBJECT VARIABLE OR WITH BLOCK VARIABLE NOT SET</p>\n</blockquote>\n\n<p>and it also will highlight at this line</p>\n\n<p><code>Range(\"L8\").Value = Cells(2, FindMe.Column)</code>.</p>\n\n<p>May I know what is the error?</p>\n\n<pre><code>Sub Macro1()\n'\n' Macro1 Macro\n'\n' Keyboard Shortcut: Ctrl+Shift+A\n'\n    Set Searchme = Range(\"L9\")\n    Set FindMe = Range(\"A2:G126\").Find(What:=\"Searchme\", LookIn:=xlValues, LookAt _\n        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\n        False, SearchFormat:=False)\n        Range(\"L8\").Value = Cells(2, FindMe.Column)\n\n    Range(\"A1:G126\").AdvancedFilter Action:=xlFilterCopy, CriteriaRange:=Range( _\n        \"L8:L9\"), CopyToRange:=Range(\"N8:T8\"), Unique:=False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "catia"], "comments": [{"owner": {"reputation": 788, "user_id": 997088, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/354c6358174c3e539ca9fe427d25391c?s=128&d=identicon&r=PG", "display_name": "GisMofx", "link": "https://stackoverflow.com/users/997088/gismofx"}, "edited": false, "score": 0, "creation_date": 1538616318, "post_id": 52621883, "comment_id": 92208375, "body": "What\u2019s the error message?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7755666"}, "reply_to_user": {"reputation": 788, "user_id": 997088, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/354c6358174c3e539ca9fe427d25391c?s=128&d=identicon&r=PG", "display_name": "GisMofx", "link": "https://stackoverflow.com/users/997088/gismofx"}, "edited": false, "score": 0, "creation_date": 1538637499, "post_id": 52621883, "comment_id": 92214569, "body": "There is no error , the solution works only for one point and I want to modify the other points so I need to create a loop through other point so I can modify them"}, {"owner": {"reputation": 788, "user_id": 997088, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/354c6358174c3e539ca9fe427d25391c?s=128&d=identicon&r=PG", "display_name": "GisMofx", "link": "https://stackoverflow.com/users/997088/gismofx"}, "edited": false, "score": 0, "creation_date": 1538655137, "post_id": 52621883, "comment_id": 92224688, "body": "Have you just tried to use a nested for loop through both the texts collection and then the leaders collection?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7755666"}, "reply_to_user": {"reputation": 788, "user_id": 997088, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/354c6358174c3e539ca9fe427d25391c?s=128&d=identicon&r=PG", "display_name": "GisMofx", "link": "https://stackoverflow.com/users/997088/gismofx"}, "edited": false, "score": 0, "creation_date": 1538655462, "post_id": 52621883, "comment_id": 92224893, "body": "nested ? what do you mean, can provide an example ?if you  mean like tested it , I don&#39;t knwo wich part that needs to be modified for the loop in order to add the variable for incrementation"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7755666"}, "edited": false, "score": 1, "creation_date": 1538722323, "post_id": 52647282, "comment_id": 92249889, "body": "I got an error in doing this but I will try again by changing some lines and I will let you know"}, {"owner": {"reputation": 788, "user_id": 997088, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/354c6358174c3e539ca9fe427d25391c?s=128&d=identicon&r=PG", "display_name": "GisMofx", "link": "https://stackoverflow.com/users/997088/gismofx"}, "edited": false, "score": 0, "creation_date": 1538749975, "post_id": 52647282, "comment_id": 92265598, "body": "@POLOSTutorials What error and where? Maybe you can update your question with the revised code and a more direct question with regards to the error"}], "tags": [], "owner": {"reputation": 788, "user_id": 997088, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/354c6358174c3e539ca9fe427d25391c?s=128&d=identicon&r=PG", "display_name": "GisMofx", "link": "https://stackoverflow.com/users/997088/gismofx"}, "is_accepted": false, "score": 0, "last_activity_date": 1538657707, "creation_date": 1538657707, "answer_id": 52647282, "question_id": 52621883, "link": "https://stackoverflow.com/questions/52621883/catia-vba-modify-point-property/52647282#52647282", "title": "CATIA /VBA- modify Point property", "body": "<p>You might want something like this:</p>\n\n<pre><code>Dim myview As DrawingView\n\n  Set myview = CATIA.ActiveDocument.Sheets.ActiveSheet.Views.ActiveView\n\n  Dim mytext As DrawingText\n  Dim myleader As DrawingLeader\n\n\n  For Each mytext In myview.Texts\n\n    For Each myleader In dText.Leaders\n\n        myleader.HeadSymbol = 0\n\n    Next\n\n  Next\n</code></pre>\n\n<p>The above code is untested, but should be a start for you.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7755666"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 338, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1538657707, "creation_date": 1538551663, "last_edit_date": 1538553648, "question_id": 52621883, "link": "https://stackoverflow.com/questions/52621883/catia-vba-modify-point-property", "title": "CATIA /VBA- modify Point property", "body": "<p>I created a macro That modify property of balloon object in CAT drawing but the problem I cant modify the Point property and it's line (see below )</p>\n\n<p><a href=\"https://i.stack.imgur.com/6TObU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6TObU.png\" alt=\"enter image description here\"></a>\nMy code  : </p>\n\n<pre><code>    myBalloon.Text = Right(myBalloon.Text, 3)\n    myBalloon.SetFontSize 0, 0, 2.5\n    myBalloon.FrameType = 0\n</code></pre>\n\n<p>Solution that I tried : </p>\n\n<pre><code>  Dim myview As DrawingView\n\n  Set myview = CATIA.ActiveDocument.Sheets.ActiveSheet.Views.ActiveView\n\n  Dim mytext As DrawingText\n\n  Set mytext = myview.Texts.Item(1)\n  Dim myleader As DrawingLeader\n\n  Set myleader = mytext.Leaders.Item(1)\n  myleader.HeadSymbol = 0\n</code></pre>\n\n<p>This works only for 1 point  is there  away to modify the other points in that Activeview\nAnyone Can light me on this ?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1538551662, "post_id": 52621772, "comment_id": 92177333, "body": "What do you exactly mean with the default property. There is no such notion in the docs for <code>TypeName()</code> <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/typename-function\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/language/reference/&hellip;</a>"}, {"owner": {"reputation": 405, "user_id": 5688192, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/356000506a529f11d9bb8b4d92e96dc4?s=128&d=identicon&r=PG", "display_name": "anqooqie", "link": "https://stackoverflow.com/users/5688192/anqooqie"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1538553472, "post_id": 52621772, "comment_id": 92178204, "body": "The default property is also called as the default member. I am not sure whether these terms are officially used ones, but I can find <a href=\"https://stackoverflow.com/questions/32996772/is-value-actually-the-default-property-of-the-range-object\">some uses of the terms in SO</a>. In some situations, the default property will be implicitly inserted into the code. For example, <code>Range</code> type has <code>_Default</code> property as the default property, so <code>Dim a As Range: Set a = Range(&quot;A1&quot;): a = 42</code> is the same as <code>Dim a As Range: Set a = Range(&quot;A1&quot;): a.[_Default] = 42</code>."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1538556171, "post_id": 52621772, "comment_id": 92179629, "body": "Basically what determines if a default member call is made."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1538567392, "post_id": 52621772, "comment_id": 92186011, "body": "As was answered below, what determines whether a default member call is made depends on the types involved (watch for <code>Variant</code>). It&#39;s indeed confusing, and exactly why writing explicit code (i.e. use <code>Range.Value</code>/<code>.Value2</code> when you mean to get a cell&#39;s value) avoids this confusion."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1538569272, "post_id": 52621772, "comment_id": 92187078, "body": "This is described in sections <a href=\"https://msdn.microsoft.com/en-us/library/ee156824.aspx\" rel=\"nofollow noreferrer\">5.6.2</a> and <a href=\"https://msdn.microsoft.com/en-us/library/ee199435.aspx\" rel=\"nofollow noreferrer\">5.6.3</a> of the VBA language spec."}], "answers": [{"comments": [{"owner": {"reputation": 405, "user_id": 5688192, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/356000506a529f11d9bb8b4d92e96dc4?s=128&d=identicon&r=PG", "display_name": "anqooqie", "link": "https://stackoverflow.com/users/5688192/anqooqie"}, "edited": false, "score": 0, "creation_date": 1538555198, "post_id": 52622424, "comment_id": 92179110, "body": "How can I know whether a function expects a data value? Is there a way to programmatically check that, or all I can do is to read the documents one by one?"}, {"owner": {"reputation": 405, "user_id": 5688192, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/356000506a529f11d9bb8b4d92e96dc4?s=128&d=identicon&r=PG", "display_name": "anqooqie", "link": "https://stackoverflow.com/users/5688192/anqooqie"}, "edited": false, "score": 0, "creation_date": 1538555825, "post_id": 52622424, "comment_id": 92179440, "body": "More specifically speaking, is there some kind of attribute to indicate whether the function expects a data value?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 405, "user_id": 5688192, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/356000506a529f11d9bb8b4d92e96dc4?s=128&d=identicon&r=PG", "display_name": "anqooqie", "link": "https://stackoverflow.com/users/5688192/anqooqie"}, "edited": false, "score": 0, "creation_date": 1538556922, "post_id": 52622424, "comment_id": 92179984, "body": "@anqooqie No, you&#39;d have to read documentation, although it&#39;s typically fairly self-evident based on what the function does. Better yet, specify a property if you want a property."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1538570276, "post_id": 52622424, "comment_id": 92187746, "body": "I don&#39;t think this is correct. Take the procedure <code>Sub Test(arg As Variant): Debug.Print TypeName(arg): End Sub</code> and call it with <code>Test Range(&quot;A1&quot;)</code>. There is coercion occurring, but it is to a <code>Variant</code> and the default member is <i>not</i> called (<code>TypeName</code> outputs &quot;Range&quot;). The signature of the parameter list is identical, so there&#39;s no reason to think that the argument is coerced differently for <code>IsEmpty</code>. If there&#39;s a default member call, it&#39;s done internally in the <code>IsEmpty</code> function."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1538570785, "post_id": 52622424, "comment_id": 92188106, "body": "@Comintern that&#39;s what I thought I said? I wasn&#39;t suggesting that the coercion occurred <i>prior</i> to the variable being passed to the function."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1538572345, "post_id": 52622424, "comment_id": 92189127, "body": "Variant arguments are not let-coerced. See <a href=\"https://msdn.microsoft.com/en-us/library/ee156838.aspx\" rel=\"nofollow noreferrer\">5.3.1.11</a>: &quot;If the declared type of the parameter is Variant, a reference parameter binding is defined within the procedure being invoked, with the same name as the parameter, referring to the variable referenced by the argument\u2019s expression. This reference parameter binding is treated as having a declared type of Variant, except when used as the &lt;l-expression&gt; within Let-assignment or Set-assignment, in which case it is treated as having the declared type of the argument\u2019s referenced variable.&quot;"}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 1, "last_activity_date": 1538553676, "creation_date": 1538553676, "answer_id": 52622424, "question_id": 52621772, "link": "https://stackoverflow.com/questions/52621772/how-does-vba-determine-whether-the-default-property-is-implicitly-used-or-not/52622424#52622424", "title": "How does VBA determine whether the default property is implicitly used or not?", "body": "<p><code>IsEmpty</code> expects a data value, not an object type, so you get implicit Let-coercion, which will call the default property to try and get a simple data value.</p>\n"}], "owner": {"reputation": 405, "user_id": 5688192, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/356000506a529f11d9bb8b4d92e96dc4?s=128&d=identicon&r=PG", "display_name": "anqooqie", "link": "https://stackoverflow.com/users/5688192/anqooqie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 1, "accepted_answer_id": 52622424, "answer_count": 1, "score": 2, "last_activity_date": 1538553676, "creation_date": 1538551284, "question_id": 52621772, "link": "https://stackoverflow.com/questions/52621772/how-does-vba-determine-whether-the-default-property-is-implicitly-used-or-not", "title": "How does VBA determine whether the default property is implicitly used or not?", "body": "<p>VBA determines that <code>IsEmpty(Range(\"A1\"))</code> implicitly uses the default property, so the expression is the same as <code>IsEmpty(Range(\"A1\").[_Default])</code>.\nOn the other hand, VBA determines that <code>TypeName(Range(\"A1\"))</code> does not use the default property, so the expression is different from <code>TypeName(Range(\"A1\").[_Default])</code>.</p>\n\n<h1>Question</h1>\n\n<p>How does VBA determine whether the default property is implicitly used or not?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1538550330, "post_id": 52621401, "comment_id": 92176621, "body": "As a minimum all these type  of comparisons If Yr = Sheet3.Cells(2, j) And Mnth = Sheet3.Cells(1, j)    can be done using an array. Looping the array will be faster than the additional overhead of touching the sheet. <a href=\"http://www.cpearson.com/excel/ArraysAndRanges.aspx\" rel=\"nofollow noreferrer\">cpearson.com/excel/ArraysAndRanges.aspx</a> You can use 3 different range variables and Union to combine your copy ranges and paste in one go to each sheet based on your If. You should be able to get Yr and Mnth from initial array as well."}, {"owner": {"reputation": 37, "user_id": 8903653, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b10a93fa65ee8c38e48e94dac56e76d4?s=128&d=identicon&r=PG&f=1", "display_name": "Damian M", "link": "https://stackoverflow.com/users/8903653/damian-m"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1538550853, "post_id": 52621401, "comment_id": 92176891, "body": "Thanks QHarr, I will make a copy code and have a play around.  The link you kindly provided looks informative.  Cheers"}, {"owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "edited": false, "score": 0, "creation_date": 1538557007, "post_id": 52621401, "comment_id": 92180028, "body": "Also, you could set <code>Applcation.EnableEvents</code> to <code>False</code>."}], "answers": [{"tags": [], "owner": {"reputation": 397, "user_id": 7950833, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/407c76d0b44d62e6ff0159337f2ecac9?s=128&d=identicon&r=PG&f=1", "display_name": "kulapo", "link": "https://stackoverflow.com/users/7950833/kulapo"}, "is_accepted": false, "score": 1, "last_activity_date": 1538562885, "creation_date": 1538562885, "answer_id": 52625152, "question_id": 52621401, "link": "https://stackoverflow.com/questions/52621401/assistance-with-slow-vba/52625152#52625152", "title": "Assistance with slow VBA", "body": "<p>Aside from <code>ScreenUpdating</code> and <code>EnableEvents</code>, you can also set the <code>Calculation</code> to manual before running your code. Normally, Excel will automatically recalculate a cell or a range of cells when that cell's or range's precedents have changed.</p>\n\n<pre><code>Application.Calculation = xlCalculationManual\n</code></pre>\n\n<p>Then once the loop is done, turn it on again:</p>\n\n<pre><code>Calculate\nApplication.Calculation = xlAutomatic\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 37, "user_id": 8903653, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b10a93fa65ee8c38e48e94dac56e76d4?s=128&d=identicon&r=PG&f=1", "display_name": "Damian M", "link": "https://stackoverflow.com/users/8903653/damian-m"}, "edited": false, "score": 0, "creation_date": 1538613260, "post_id": 52627757, "comment_id": 92207753, "body": "Thank you for taking the time to adjust my code, And also spotting the missing &#39;j = j + 1&#39; which was also likely sending my code in to an endless loop.  This now took, with Kalapo&#39;s comment approx. 2 mins.  Awesome thanks you.  I didn&#39;t have time to change into arrays as I need to study this a little more but looking forwards to increasing my understanding of arrays.  Many thansk"}], "tags": [], "owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "is_accepted": true, "score": 1, "last_activity_date": 1538572059, "creation_date": 1538572059, "answer_id": 52627757, "question_id": 52621401, "link": "https://stackoverflow.com/questions/52621401/assistance-with-slow-vba/52627757#52627757", "title": "Assistance with slow VBA", "body": "<p>Refactoring a bit: </p>\n\n<pre><code>Dim YrToCompare2 As Long, YrToCompare4 As Long, YrToCompare5 As Long\nDim MnthToCompare as Long\nDim LastRow2 As Long, LastRow4 As Long, LastRow5 As Long\n\nLastRow2 = Sheet2.Cells(Rows.Count, 1).End(xlUp).Row\nLastRow4 = Sheet4.Cells(Rows.Count, 1).End(xlUp).Row\nLastRow5 = Sheet5.Cells(Rows.Count, 1).End(xlUp).Row\n\nDo Until j = 14\n\n    MnthToCompare = Sheet3.Cells(1, j)\n    YrToCompare2 = Sheet3.Cells(2, j)\n    YrToCompare4 = Sheet3.Cells(3, j)\n    YrToCompare5 = Sheet3.Cells(4, j)\n\n    For i = 4 To LastRowMain\n\n    'Sheet1 column(1) is Date format in 1/2 hour intervasls, i.e. 48 rows per day\n       Yr = Year(Sheet1.Cells(i, 1))\n       Mnth = Month(Sheet1.Cells(i, 1))\n\n       If Yr = YrToCompare2 And Mnth = MnthToCompare Then 'If the Date in Sheet1.column(1) matches the date and month in the table, Then\n           LastRow2 = LastRow2 + 1\n           Sheet1.Range(Sheet1.Cells(i, 1), Sheet1.Cells(i, 8)).Copy Sheet2.Cells(LastRow2, 1) 'Copy that row and put in in to the output sheet below the lastrow\n       End If\n\n       If Yr = YrToCompare4 And Mnth = MnthToCompare Then 'If the Date in Sheet1.column(1) matches the date and month in the table, Then\n           LastRow4 = LastRow4 + 1\n           Sheet1.Range(Sheet1.Cells(i, 1), Sheet1.Cells(i, 8)).Copy Sheet4.Cells(LastRow4, 1) 'Copy that row and put in in to the output sheet below the lastrow\n       End If\n\n       If Yr = YrToCompare5 And Mnth = MnthToCompare Then 'If the Date in Sheet1.column(1) matches the date and month in the table, Then\n            LastRow5 = LastRow5 + 1\n            Sheet1.Range(Sheet1.Cells(i, 1), Sheet1.Cells(i, 8)).Copy Sheet5.Cells(LastRow5, 1) 'Copy that row and put in in to the output sheet below the lastrow\n      End If\n\n   Next i\n\n   j = j + 1\n\nLoop 'Go to the next set of dates in the table and loop through the rows again\n</code></pre>\n\n<p>The concept is to reduce VBA - Excel interactions by storing relatively fixed values in variables instead of reading them from Excel 12*500K times, and also counting last rows instead of finding them in every loop. However, you can expect significant improvement by implementing @QHarr's advise on using arrays. </p>\n"}], "owner": {"reputation": 37, "user_id": 8903653, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b10a93fa65ee8c38e48e94dac56e76d4?s=128&d=identicon&r=PG&f=1", "display_name": "Damian M", "link": "https://stackoverflow.com/users/8903653/damian-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 52627757, "answer_count": 2, "score": 0, "last_activity_date": 1538572059, "creation_date": 1538550000, "last_edit_date": 1538556921, "question_id": 52621401, "link": "https://stackoverflow.com/questions/52621401/assistance-with-slow-vba", "title": "Assistance with slow VBA", "body": "<p>This code has taken a couple of hours so far and less than 10% complete, please advise how I can make this faster? </p>\n\n<p>I have tried to explain the code by using comments in the code</p>\n\n<p>Sheet1 has nearly 500k rows on dates, from 1 July 1990 to 30/6/2017 in 30 minute intervals, i.e. 48 rows per day.</p>\n\n<p>I have a table on a different worksheet with a row of 12 columns displaying months 7 to 6, then below the month number in 3 rows are 3 different years</p>\n\n<pre><code>Sub Test2()\n\nApplication.ScreenUpdating = False\n\n'Sheet1 contains the main data set\n'Sheet3 contains a table with 12 columns and 3 rows\n'Sheet2 is an output sheet\n'Sheet4 is an output sheet\n'Sheet5 is an output sheet\n\nDim i As Long 'main sheet rows (Sheet1 473,379 rows)\nDim j As Long 'Columns (Table of dates with 12 columns on sheet3)\nDim LastRowMain As Long 'Last row of sheet 1\nDim LastRowStitch As Long 'Lastrow of the applicable output sheet\n\nDim Yr As Integer\nDim Mnth As Integer\n\nLastRowMain = Sheet1.Cells(Rows.Count, 1).End(xlUp).Row '473,379 rows\n\nj = 3 'First data column in the table\n\nDo Until j = 14\n\n    For i = 4 To LastRowMain\n\n        'Sheet1 column(1) is Date format in 1/2 hour intervasls, i.e. 48 rows per day\n        Yr = Year(Sheet1.Cells(i, 1))\n        Mnth = Month(Sheet1.Cells(i, 1))\n\n        If Yr = Sheet3.Cells(2, j) And Mnth = Sheet3.Cells(1, j) Then 'If the Date in Sheet1.column(1) matches the date and month in the table, Then\n            LastRowStitch = Sheet2.Cells(Rows.Count, 1).End(xlUp).Row\n            Sheet1.Range(Sheet1.Cells(i, 1), Sheet1.Cells(i, 8)).Copy Sheet2.Cells(LastRowStitch + 1, 1) 'Copy that row and put in in to the output sheet below the lastrow\n        End If\n\n        If Yr = Sheet3.Cells(3, j) And Mnth = Sheet3.Cells(1, j) Then 'If the Date in Sheet1.column(1) matches the date and month in the table, Then\n            LastRowStitch = Sheet4.Cells(Rows.Count, 1).End(xlUp).Row\n            Sheet1.Range(Sheet1.Cells(i, 1), Sheet1.Cells(i, 8)).Copy Sheet4.Cells(LastRowStitch + 1, 1) 'Copy that row and put in in to the output sheet below the lastrow\n        End If\n\n        If Yr = Sheet3.Cells(4, j) And Mnth = Sheet3.Cells(1, j) Then 'If the Date in Sheet1.column(1) matches the date and month in the table, Then\n            LastRowStitch = Sheet5.Cells(Rows.Count, 1).End(xlUp).Row\n            Sheet1.Range(Sheet1.Cells(i, 1), Sheet1.Cells(i, 8)).Copy Sheet5.Cells(LastRowStitch + 1, 1) 'Copy that row and put in in to the output sheet below the lastrow\n        End If\n\n    Next i\n\nLoop 'Go to the next set of dates in the table and loop through the rows again\n\n\nApplication.ScreenUpdating = True\n\nMsgBox \"Done\"\n\nEnd Sub\n</code></pre>\n\n<p>Many thanks</p>\n"}, {"tags": ["vba", "excel", "time", "sum"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1538550416, "post_id": 52621381, "comment_id": 92176657, "body": "does <i>&#39;in different ways&#39;</i> include [hh]:mm ?"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1538550703, "creation_date": 1538550703, "answer_id": 52621601, "question_id": 52621381, "link": "https://stackoverflow.com/questions/52621381/excel-sum-formula-doesnt-work-for-hours-from-vba/52621601#52621601", "title": "Excel SUM formula doesn&#39;t work for hours from VBA", "body": "<p>You are putting text-that-looks-like-time into the cells. Use real time.</p>\n\n<pre><code>Dim Start As DOUBLE, RunTime As DOUBLE\nDim ElapsedTime As DOUBLE\n\n...\n\nStart = Timer    ' Set start time.\n\n...\n\n    DoEvents    ' Yield to other processes.\n    RunTime = Timer    ' current elapsed time\n    ElapsedTime = (RunTime - Start) / 86400\n\n    Range(\"Y14\").Value = ElapsedTime\n    Range(\"Y14\").numberformat = \"[hh]:mm:ss\"\n</code></pre>\n\n<p>Remember to be careful about a start and end that cross midnight. Timer resets at midnight and Excel doesn't like negative time.</p>\n"}], "owner": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "accepted_answer_id": 52621601, "answer_count": 1, "score": 2, "last_activity_date": 1538633203, "creation_date": 1538549922, "last_edit_date": 1538633203, "question_id": 52621381, "link": "https://stackoverflow.com/questions/52621381/excel-sum-formula-doesnt-work-for-hours-from-vba", "title": "Excel SUM formula doesn&#39;t work for hours from VBA", "body": "<p>I have VBA that counts time spent on the project and after user is pressing STOP button it enters time into other sheet. Everything is working fine expect for SUM formula to calculate total amount of hours spent. Formula <code>=SUM(A2:A15290)</code> gives value of 00:00:00 (zero) in cell A1. I have tried to \"Format cell\" in different ways but nothing works. If I enter time manually to cells, then everything works fine. Maybe problem is in my VBA that is entering counted time to cells?</p>\n\n<p>Here is the macro I am using:</p>\n\n<pre><code>Option Explicit\n\nSub StartTimer()\n\n    Dim Start As Single, RunTime As Single\n    Dim ElapsedTime As String\n\n    'Set the control cell to 0 and make it green\n    Range(\"Y18\").Value = 0\n    Range(\"Y14\").Interior.Color = 5296274 'Green\n\n    Start = Timer    ' Set start time.\n    Debug.Print Start\n    Do While Range(\"Y18\").Value = 0\n\n        DoEvents    ' Yield to other processes.\n        RunTime = Timer    ' current elapsed time\n        ElapsedTime = Format((RunTime - Start) / 86400, \"h:mm:ss\")\n        'Display currently elapsed time in A1\n        Range(\"Y14\").Value = ElapsedTime\n        Application.StatusBar = ElapsedTime\n\n    Loop\n\n    Range(\"Y14\").Value = ElapsedTime\n    Range(\"Y14\").Interior.Color = 192 'Dark red\n    Application.StatusBar = False\n\nEnd Sub\n\nSub StopTimer()\nApplication.ScreenUpdating = False\nDim copySheet As Worksheet\nDim pasteSheet As Worksheet\n    'Set the control cell to 1\n    Range(\"Y18\").Value = 1\n\nSet copySheet = Worksheets(\"MAIN\")\nSet pasteSheet = Worksheets(\"Time Spent\")\n\ncopySheet.Range(\"Y14\").Copy\npasteSheet.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues\nApplication.CutCopyMode = False\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1538549740, "post_id": 52621231, "comment_id": 92176334, "body": "a) Are you checking <b>any</b> cell on the worksheet or should target be restricted to a range? b) what is the point of setting a range var if you just exit the sub immediately after?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10449666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873cac851668b82646eee7c901370f31?s=128&d=identicon&r=PG&f=1", "display_name": "JMourning", "link": "https://stackoverflow.com/users/10449666/jmourning"}, "edited": false, "score": 0, "creation_date": 1538593222, "post_id": 52621382, "comment_id": 92201195, "body": "Thank you for your excellent suggestions.  As it turns out, I have found my problem is elsewhere.  In other code Del dosen&#39;t change the target value to null and the code works fine.  I believe now a setting  of mine somewhere is causing the problem.  Your suggestions are still helpful top someone learning and seeing them for the first time,  Regards John"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1538549933, "creation_date": 1538549933, "answer_id": 52621382, "question_id": 52621231, "link": "https://stackoverflow.com/questions/52621231/delete-in-change-event-produces-error-28-stack-overflow/52621382#52621382", "title": "Delete in change event produces error 28 stack overflow", "body": "<p>I keep saying the same three things over and over.</p>\n\n<ol>\n<li>Disable events if you are going to make changes to the worksheet or the worksheet_change will try to run on top of itself.</li>\n<li>Handle situations where Target is more than a single cell.</li>\n<li>Add some error control; at least enough to re-enable event handling.</li>\n</ol>\n\n<p>Code rewrite:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    Dim t as range, KeyCells As Range  \n\n    on error goto safe_exit\n    for each t in target  \n        If t.Value = \"\" Then \n            application.enableevents = false   \n            t.Value = 0        \n        End If\n        MsgBox (t.Value)  \n    next t   \n\n    Set KeyCells = Range(\"C3:C10\")\n\nsafe_exit:\n    application.enableevents = true\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10449666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873cac851668b82646eee7c901370f31?s=128&d=identicon&r=PG&f=1", "display_name": "JMourning", "link": "https://stackoverflow.com/users/10449666/jmourning"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1538550026, "creation_date": 1538549400, "last_edit_date": 1538550026, "question_id": 52621231, "link": "https://stackoverflow.com/questions/52621231/delete-in-change-event-produces-error-28-stack-overflow", "title": "Delete in change event produces error 28 stack overflow", "body": "<p>Without the If construct to change a null value produced by deleting the value in a cell in the range to 0, the following code produces an error 28 Stack overflow.</p>\n\n<p>The explanations I have found for the worksheet change event indicate, that delete will trigger the change event; however, they do not indicate that DEL will produce a null target.value and result in the error.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    Dim KeyCells As Range    \n    If Target.Value = \"\" Then    \n        Target.Value = 0        \n    End If\n\n    MsgBox (Target.Value)  \n\n    Set KeyCells = Range(\"C3:C10\") ' Error occurs here\nEnd Sub\n</code></pre>\n\n<p>What is the most efficient way to ensure that deleting a value in the Range will not result in a null value and produce this error?</p>\n"}, {"tags": ["vba", "excel", "dll", "crash"], "comments": [{"owner": {"reputation": 98, "user_id": 3230453, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/COYUq.jpg?s=128&g=1", "display_name": "Ricky", "link": "https://stackoverflow.com/users/3230453/ricky"}, "edited": false, "score": 0, "creation_date": 1538548239, "post_id": 52620831, "comment_id": 92175568, "body": "What type of computer are you using and what MS excel did you download 32 bit or 64bit?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10039288"}, "edited": false, "score": 0, "creation_date": 1538548306, "post_id": 52620831, "comment_id": 92175602, "body": "What antivirus are you using? If you say Bitdefender then we&#39;re in business."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10039288"}, "edited": false, "score": 0, "creation_date": 1538548393, "post_id": 52620831, "comment_id": 92175663, "body": "Also, try deleting your temp files. Sometimes the macro&#39;s will get stuck especially after a crash."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10039288"}, "edited": false, "score": 0, "creation_date": 1538548634, "post_id": 52620831, "comment_id": 92175778, "body": "Have you tried running in safe mode? If not, try that, if it works then it&#39;s an issue related to an add-in."}, {"owner": {"reputation": 98, "user_id": 3230453, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/COYUq.jpg?s=128&g=1", "display_name": "Ricky", "link": "https://stackoverflow.com/users/3230453/ricky"}, "edited": false, "score": 0, "creation_date": 1538549453, "post_id": 52620831, "comment_id": 92176190, "body": "Have you tried to update MS Office? Make sure is completely finishes updating."}, {"owner": {"reputation": 21, "user_id": 5111154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/821dbaf4a89b23dacbad41c8068772c7?s=128&d=identicon&r=PG&f=1", "display_name": "Ces", "link": "https://stackoverflow.com/users/5111154/ces"}, "edited": false, "score": 0, "creation_date": 1538558183, "post_id": 52620831, "comment_id": 92180692, "body": "Ricky, I have a Dell Vostro 15, 5000 Series and 32bit installation."}, {"owner": {"reputation": 21, "user_id": 5111154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/821dbaf4a89b23dacbad41c8068772c7?s=128&d=identicon&r=PG&f=1", "display_name": "Ces", "link": "https://stackoverflow.com/users/5111154/ces"}, "edited": false, "score": 0, "creation_date": 1538558226, "post_id": 52620831, "comment_id": 92180715, "body": "xTwisteDx, I had AVG which has since been uninstalled."}, {"owner": {"reputation": 1159, "user_id": 516678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60504aa3c3322361bce7fa726efa5a01?s=128&d=identicon&r=PG", "display_name": "Matt Roy", "link": "https://stackoverflow.com/users/516678/matt-roy"}, "edited": false, "score": 0, "creation_date": 1568216769, "post_id": 52620831, "comment_id": 102206797, "body": "Try adding more registry keys (CompileOnDemand and ForceVBALoadFromSource) described in the forum: <a href=\"https://social.technet.microsoft.com/Forums/windowsserver/en-US/c9044eea-f01d-47af-ae8e-731f80e347ee/excel-crashes-in-vbe7dll-running-or-enabling-macro?forum=excel\" rel=\"nofollow noreferrer\">social.technet.microsoft.com/Forums/windowsserver/en-US/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 5111154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/821dbaf4a89b23dacbad41c8068772c7?s=128&d=identicon&r=PG&f=1", "display_name": "Ces", "link": "https://stackoverflow.com/users/5111154/ces"}, "edited": false, "score": 0, "creation_date": 1538558102, "post_id": 52621027, "comment_id": 92180651, "body": "Thanks xTwisteDx. I&#39;ve tried both and still no luck unfortunately."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10039288"}, "is_accepted": false, "score": 0, "last_activity_date": 1538584564, "last_edit_date": 1538584564, "creation_date": 1538548555, "answer_id": 52621027, "question_id": 52620831, "link": "https://stackoverflow.com/questions/52620831/excel-crashes-after-attempting-anything-vba-related/52621027#52621027", "title": "Excel crashes after attempting anything VBA related", "body": "<h1>Suggestion #1</h1>\n\n<p>Try deleting your temp files. </p>\n\n<pre><code>1. Close all programs.\n2. Window+R keys to open RUN.\n3. Type %temp% and Enter.\n4. Hit Ctrl+A, then Delete.\n</code></pre>\n\n<p>Restart PC</p>\n\n<h1>Suggestion #2</h1>\n\n<p>Launch it in safe mode, if it works then the issue is related to an add-in. </p>\n\n<pre><code>1. Close all programs.\n2. Windows+R keys to open RUN.\n3. Type excel.exe /safe then enter. \n4. Profit?\n</code></pre>\n\n<h1>Suggestion #3</h1>\n\n<p><code>Options=&gt;Advanced=&gt;(unchecked)Extend Data Range Formats and Formulas.</code></p>\n"}], "owner": {"reputation": 21, "user_id": 5111154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/821dbaf4a89b23dacbad41c8068772c7?s=128&d=identicon&r=PG&f=1", "display_name": "Ces", "link": "https://stackoverflow.com/users/5111154/ces"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1988, "favorite_count": 0, "closed_date": 1538558769, "answer_count": 1, "score": 2, "last_activity_date": 1538584564, "creation_date": 1538547622, "last_edit_date": 1538557361, "question_id": 52620831, "link": "https://stackoverflow.com/questions/52620831/excel-crashes-after-attempting-anything-vba-related", "closed_reason": "Not suitable for this site", "title": "Excel crashes after attempting anything VBA related", "body": "<p>Could someone please help with this visual basic related crash issue. I have an Office 365 Business installation, version 1808 (Build 10730.20102 Click-to-Run) on a Windows 10 system. Whenever I try to edit, create or record a macro (even from a blank, plain xlsx file) my Excel just crashes and restarts. I've been in contact with Office 365 support and we've tried the following:</p>\n\n<ul>\n<li>We turned antivirus off</li>\n<li>We tried Excel in safe mode</li>\n<li>We disabled COM Add-Ins and checked the \"Compile on Demand\" is turned off: <a href=\"https://blogs.technet.microsoft.com/the_microsoft_excel_support_team_blog/2012/09/07/excel-crashes-in-vbe7-dll-running-or-enabling-macro/\" rel=\"nofollow noreferrer\">https://blogs.technet.microsoft.com/the_microsoft_excel_support_team_blog/2012/09/07/excel-crashes-in-vbe7-dll-running-or-enabling-macro/</a></li>\n<li>We updated device drivers</li>\n<li>We ran the repair tool for Office apps</li>\n<li>We created a new Windows profile</li>\n<li>We added a registry key for the VBE7.DLL error we found in session log: <a href=\"https://blogs.technet.microsoft.com/the_microsoft_excel_support_team_blog/2012/09/07/excel-crashes-in-vbe7-dll-running-or-enabling-macro/\" rel=\"nofollow noreferrer\">https://blogs.technet.microsoft.com/the_microsoft_excel_support_team_blog/2012/09/07/excel-crashes-in-vbe7-dll-running-or-enabling-macro/</a></li>\n<li>Uninstalled and reinstalled Office apps</li>\n</ul>\n\n<p>Still the issue persists. Any other ideas would be greatly appreciated.</p>\n"}, {"tags": ["excel", "vba", "email", "hyperlink"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 1, "creation_date": 1538549051, "post_id": 52620649, "comment_id": 92175996, "body": "<code>strbody = &quot;&lt;A HREF=&#39;mailto:z@zzz.com&#39;&gt;&quot; &amp; Range(&quot;A1&quot;).Text &amp; &quot;&lt;&#47;A&gt;&quot;</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10039288"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1538549119, "post_id": 52620649, "comment_id": 92176030, "body": "@VincentG you should add that as an answer with some text to clarify what you&#39;re doing to accomplish what the OP is asking. I&#39;m curious to know as well."}, {"owner": {"reputation": 49, "user_id": 4299209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/911a39c8f807a4a7c0a30eb36c0edea8?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/4299209/robert"}, "edited": false, "score": 0, "creation_date": 1538575111, "post_id": 52620649, "comment_id": 92190958, "body": "Worked perfectly - many thanks. Just a final question,  what if i have a table, i.e. Range(&quot;A1:B4&quot;)?"}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 4299209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/911a39c8f807a4a7c0a30eb36c0edea8?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/4299209/robert"}, "edited": false, "score": 0, "creation_date": 1538998879, "post_id": 52621205, "comment_id": 92329342, "body": "Many thanks -work fine. Do you happen to know how I can include a range? So instead of range(&quot;A1&quot;) I would like range(&quot;A1:B4&quot;)?"}, {"owner": {"reputation": 398, "user_id": 10357142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cd4607c975eed4e21873ba7f6c0939a?s=128&d=identicon&r=PG&f=1", "display_name": "Mr ML", "link": "https://stackoverflow.com/users/10357142/mr-ml"}, "reply_to_user": {"reputation": 49, "user_id": 4299209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/911a39c8f807a4a7c0a30eb36c0edea8?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/4299209/robert"}, "edited": false, "score": 0, "creation_date": 1538999911, "post_id": 52621205, "comment_id": 92329966, "body": "That depends on what type of data you have in the range and whether it should be concatenated with or without a separator. Can you give an example?"}, {"owner": {"reputation": 49, "user_id": 4299209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/911a39c8f807a4a7c0a30eb36c0edea8?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/4299209/robert"}, "edited": false, "score": 0, "creation_date": 1539001547, "post_id": 52621205, "comment_id": 92330980, "body": "@ Mr ML - values are simple fixed numeric values and these values should be in table format. Therefore a white space between values and a new line for each row in the table. I was hoping changing range(&quot;A1&quot;) to range (&quot;A1:B4&quot;) would do the job but get a Type Mismatch."}, {"owner": {"reputation": 398, "user_id": 10357142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cd4607c975eed4e21873ba7f6c0939a?s=128&d=identicon&r=PG&f=1", "display_name": "Mr ML", "link": "https://stackoverflow.com/users/10357142/mr-ml"}, "reply_to_user": {"reputation": 49, "user_id": 4299209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/911a39c8f807a4a7c0a30eb36c0edea8?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/4299209/robert"}, "edited": false, "score": 0, "creation_date": 1539002365, "post_id": 52621205, "comment_id": 92331481, "body": "That is not a simple task. You could do it the easy way and concatenate the line 1 by 1. (Range(&quot;A1&quot;) &amp; Range(&quot;A2&quot;) &amp; .. &amp; Range(&quot;B4&quot;)). Else this function is what your seeking. <a href=\"https://stackoverflow.com/questions/31453759/how-to-paste-excel-data-table-into-outlook-through-vba\" title=\"how to paste excel data table into outlook through vba\">stackoverflow.com/questions/31453759/&hellip;</a>"}], "tags": [], "owner": {"reputation": 398, "user_id": 10357142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cd4607c975eed4e21873ba7f6c0939a?s=128&d=identicon&r=PG&f=1", "display_name": "Mr ML", "link": "https://stackoverflow.com/users/10357142/mr-ml"}, "is_accepted": false, "score": 0, "last_activity_date": 1538549269, "creation_date": 1538549269, "answer_id": 52621205, "question_id": 52620649, "link": "https://stackoverflow.com/questions/52620649/how-can-i-refer-a-hyperlink-to-a-cell-value-in-the-body-of-an-email/52621205#52621205", "title": "How can I refer a hyperlink to a cell value in the body of an email?", "body": "<p>I think concatenation would work.</p>\n\n<pre><code>strbody = \"&lt;A HREF='mailto:z@zzz.com'&gt;\" &amp; range(\"a1\") &amp; \"&lt;/A&gt;\"\n</code></pre>\n\n<p>\"&amp;\" is used in VBA to concatenate text and variables/ranges/etc</p>\n"}, {"tags": [], "owner": {"reputation": 49, "user_id": 4299209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/911a39c8f807a4a7c0a30eb36c0edea8?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/4299209/robert"}, "is_accepted": false, "score": 0, "last_activity_date": 1539004677, "creation_date": 1539004677, "answer_id": 52703231, "question_id": 52620649, "link": "https://stackoverflow.com/questions/52620649/how-can-i-refer-a-hyperlink-to-a-cell-value-in-the-body-of-an-email/52703231#52703231", "title": "How can I refer a hyperlink to a cell value in the body of an email?", "body": "<p>Actually managed to get a fairly ugly solution myself so open for improvement:</p>\n\n<p>Sub SendHyperlinkEmail()</p>\n\n<pre><code>Dim outApp As Object\nDim OutMail As Object\nDim strbody As String\n\n    Set outApp = CreateObject(\"Outlook.Application\")\n    Set OutMail = outApp.CreateItem(0)\n\nstrbody = \"&lt;table&gt;\" &amp; \"&lt;tr&gt;\" &amp; \"&lt;A \nHREF='mailto:mailto:z@zzz.com?subject=Enquiry&amp;Body=I would \nlike to'&gt;\" _\n&amp; range(\"B2\") &amp; \"&amp;nbsp;\" &amp; range(\"C2\") &amp; \"&lt;/A&gt;\" &amp; \"&lt;/tr&gt;\" &amp; \n _ \"&lt;tr&gt;\" &amp; \"&lt;A HREF='mailto:mailto:z@zzz.com \n  subject=Enquiry&amp;Body=I would like to'&gt;\" _\n &amp; range(\"B3\") &amp; \"&amp;nbsp;\" &amp; range(\"C3\") &amp; \"&lt;/A&gt;\" &amp; \"&lt;/tr&gt;\" &amp; _\n    \"&lt;tr&gt;\" &amp; \"&lt;A HREF='mailto:mailto:z@zzz.com?subject=Enquiry&amp;Body=I would like to'&gt;\" _\n    &amp; range(\"B4\") &amp; \"&amp;nbsp;\" &amp; range(\"C4\") &amp; \"&lt;/A&gt;\" &amp; \"&lt;/tr&gt;\" &amp; _\n    \"&lt;/table&gt;\"On Error Resume Next\n    With OutMail\n        .To = \"\"\n        .CC = \"\"\n        .BCC = \"\"\n        .Subject = Test\n        .HTMLBody = strbody\n        .Send\n    End With\n    On Error GoTo 0\n\n    Set OutMail = Nothing\n    Set outApp = Nothing\n</code></pre>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 49, "user_id": 4299209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/911a39c8f807a4a7c0a30eb36c0edea8?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/4299209/robert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1539004677, "creation_date": 1538546741, "last_edit_date": 1538553176, "question_id": 52620649, "link": "https://stackoverflow.com/questions/52620649/how-can-i-refer-a-hyperlink-to-a-cell-value-in-the-body-of-an-email", "title": "How can I refer a hyperlink to a cell value in the body of an email?", "body": "<p>I would like to hyperlink a cell and have the value of that cell be the hyperlink in the body of the email.</p>\n\n<p>So in below's code instead of \"Hello\" it should refer to value of a cell. Say if Range(\"A1\") equals 100, the hyperlink in the body of the email should say 100. If I change Range(\"A1\") to 101, the hyperlink in the email should change to 101. </p>\n\n<p>Thanks for your help!</p>\n\n<p>My code:</p>\n\n<pre><code>Sub SendHyperlinkEmail()\n\n    Dim outApp As Object\n    Dim OutMail As Object\n    Dim strbody As String\n\n        Set outApp = CreateObject(\"Outlook.Application\")\n        Set OutMail = outApp.CreateItem(0)\n\n        strbody = \"&lt;A HREF='mailto:z@zzz.com'&gt;Hello&lt;/A&gt;\"\n\n\n        On Error Resume Next\n        With OutMail\n            .To = \"\"\n            .CC = \"\"\n            .BCC = \"\"\n            .Subject = Test\n            .HTMLBody = strbody\n            .Send\n        End With\n        On Error GoTo 0\n\n        Set OutMail = Nothing\n        Set outApp = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "macos", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 0, "last_activity_date": 1538558962, "creation_date": 1538558962, "answer_id": 52623911, "question_id": 52620644, "link": "https://stackoverflow.com/questions/52620644/open-word-doc-with-excel-2016-button-on-mac/52623911#52623911", "title": "open word doc with excel 2016 button on mac", "body": "<p>I can reproduce the behaviour. This appears to be a known issue with Mac VBA - since more than a year, as confirmed by Microsoft:</p>\n\n<p><a href=\"https://answers.microsoft.com/en-us/msoffice/forum/msoffice_officeinsider-mso_mac-msoinsider_excel/trying-to-open-word-from-excel-vba-results-in-run/856d9a54-cc92-4ad8-9f49-cae38e7335b7\" rel=\"nofollow noreferrer\">https://answers.microsoft.com/en-us/msoffice/forum/msoffice_officeinsider-mso_mac-msoinsider_excel/trying-to-open-word-from-excel-vba-results-in-run/856d9a54-cc92-4ad8-9f49-cae38e7335b7</a></p>\n"}], "owner": {"reputation": 11, "user_id": 8897904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7517f696c1ec1b71de8ea9f522ff2e35?s=128&d=identicon&r=PG&f=1", "display_name": "chris", "link": "https://stackoverflow.com/users/8897904/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 135, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1592988395, "creation_date": 1538546723, "last_edit_date": 1592988395, "question_id": 52620644, "link": "https://stackoverflow.com/questions/52620644/open-word-doc-with-excel-2016-button-on-mac", "title": "open word doc with excel 2016 button on mac", "body": "<p>I am trying to use this code with a button to open a word doc in excel 2106 on a mac running high sierra: </p>\n\n<pre><code>Sub buttontest1()\nDim objdoc As Object\n\nFileName = \"/Volumes/256SSD/word docs/shortcut keys.docx\"\n\nWith CreateObject(\"word.application\")\n\nSet objdoc = .documents.open(FileName)\nEnd With\n\nSet objdoc = Nothing\nEnd Sub\n</code></pre>\n\n<p>The first time I run this, it works fine. I then close the word doc (command q) and run it again but I get a runtime error\n-2146959355 (80080005)\nand a blank word doc opens. I click \"End\" in the runtime error box and quit the word doc and run the code again and the word doc opens correctly.\nI quit the doc and run again and get the run time error.</p>\n\n<p>Can someone help please?</p>\n\n<p>PS I have tried using : instead of / in the file path but that gives a different error</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1538545247, "post_id": 52620326, "comment_id": 92174404, "body": "Are these actual tables in Excel or simply look like tables? If actual tables then work with <a href=\"https://www.thespreadsheetguru.com/blog/2014/6/20/the-vba-guide-to-listobject-excel-tables\" rel=\"nofollow noreferrer\">list objects</a> and loop the list objects and the data body range rows of those list  objects."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1538549157, "post_id": 52620326, "comment_id": 92176053, "body": "&quot;Code below works good, but it needs modernization.&quot; Best on <a href=\"https://codereview.stackexchange.com/\">Code Review</a>"}, {"owner": {"reputation": 61, "user_id": 8140603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6aff579ce44d617367bbd693049e3f23?s=128&d=identicon&r=PG&f=1", "display_name": "BenGoodman", "link": "https://stackoverflow.com/users/8140603/bengoodman"}, "edited": false, "score": 0, "creation_date": 1538566615, "post_id": 52620326, "comment_id": 92185543, "body": "What is a difference between Stack and Code Review?"}], "answers": [{"tags": [], "owner": {"reputation": 96, "user_id": 10351957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FhPLN.jpg?s=128&g=1", "display_name": "Hamed", "link": "https://stackoverflow.com/users/10351957/hamed"}, "is_accepted": false, "score": 0, "last_activity_date": 1538545827, "creation_date": 1538545827, "answer_id": 52620465, "question_id": 52620326, "link": "https://stackoverflow.com/questions/52620326/loop-in-different-ranges-vba/52620465#52620465", "title": "Loop in different ranges VBA", "body": "<p>Try this:</p>\n\n<pre><code>Sub Test()\n\n    '... Define your variables ....\n\n    Dim LastRow As Long\n    LastRow = Range(\"E\" &amp; Rows.Count).End(xlUp).Row\n\n    name1 = \"A\"\n    name2 = \"B\"\n    audit = \"C\"\n    currenc = \"Dollars\"\n\n    ifrom = 2\n    Do\n        ito = Range(\"E\" &amp; ifrom).End(xlDown).Row ' find the row above the 1st blank cell in column E\n\n        For i = ifrom To ito\n            '... Your code comes here ...\n        Next i\n        ifrom = Range(\"E\" &amp; ifrom).End(xlDown).Row ' find top of next table, if no table return last row of worksheet\n    Loop While ifrom &lt; LastRow\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 61, "user_id": 8140603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6aff579ce44d617367bbd693049e3f23?s=128&d=identicon&r=PG&f=1", "display_name": "BenGoodman", "link": "https://stackoverflow.com/users/8140603/bengoodman"}, "edited": false, "score": 0, "creation_date": 1538566457, "post_id": 52620543, "comment_id": 92185464, "body": "Code works, but has mistake (debug) in part below:     <i>score1 = Int(Range(&quot;B&quot; &amp; i).Value)     score2 = Int(Range(&quot;C&quot; &amp; i).Value)     score3 = Int(Abs(Range(&quot;D&quot; &amp; i).Value))</i>        First cell of next table is a <b>String</b>, and variables can&#39;t convert string to integer. Code gives Debug in this part. (As I understood reason of Debug). How to write condition &quot;jump to next cell below when cell is a string?"}, {"owner": {"reputation": 96, "user_id": 10351957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FhPLN.jpg?s=128&g=1", "display_name": "Hamed", "link": "https://stackoverflow.com/users/10351957/hamed"}, "reply_to_user": {"reputation": 61, "user_id": 8140603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6aff579ce44d617367bbd693049e3f23?s=128&d=identicon&r=PG&f=1", "display_name": "BenGoodman", "link": "https://stackoverflow.com/users/8140603/bengoodman"}, "edited": false, "score": 0, "creation_date": 1538567283, "post_id": 52620543, "comment_id": 92185948, "body": "In that case change If condition as bellow:    If Not IsNumeric(range(&quot;E&quot; &amp; i).value) Then"}, {"owner": {"reputation": 61, "user_id": 8140603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6aff579ce44d617367bbd693049e3f23?s=128&d=identicon&r=PG&f=1", "display_name": "BenGoodman", "link": "https://stackoverflow.com/users/8140603/bengoodman"}, "edited": false, "score": 0, "creation_date": 1538568392, "post_id": 52620543, "comment_id": 92186541, "body": "Changed but the same mistake. Maybe we have to write : not equal to string ?"}, {"owner": {"reputation": 96, "user_id": 10351957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FhPLN.jpg?s=128&g=1", "display_name": "Hamed", "link": "https://stackoverflow.com/users/10351957/hamed"}, "reply_to_user": {"reputation": 61, "user_id": 8140603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6aff579ce44d617367bbd693049e3f23?s=128&d=identicon&r=PG&f=1", "display_name": "BenGoodman", "link": "https://stackoverflow.com/users/8140603/bengoodman"}, "edited": false, "score": 0, "creation_date": 1538802394, "post_id": 52620543, "comment_id": 92281059, "body": "Sorry for mistake:If should be :   IF IsNumeric(Range(&quot;E&quot; &amp; i).Value) Then"}], "tags": [], "owner": {"reputation": 96, "user_id": 10351957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FhPLN.jpg?s=128&g=1", "display_name": "Hamed", "link": "https://stackoverflow.com/users/10351957/hamed"}, "is_accepted": true, "score": 0, "last_activity_date": 1538546262, "creation_date": 1538546262, "answer_id": 52620543, "question_id": 52620326, "link": "https://stackoverflow.com/questions/52620326/loop-in-different-ranges-vba/52620543#52620543", "title": "Loop in different ranges VBA", "body": "<p>Also because your formulas are related just to same row you can try following which is more simple:</p>\n\n<pre><code>Sub Test()\n    Dim score1 As Double, score2 As Double, score3 As Double, result As String, text As String\n\n    Dim ifrom As Long, ito As Long\n    Dim i As Long\n\n    ifrom = 2\n    ito = Range(\"E\" &amp; Rows.Count).End(xlUp).Row 'This row changed\n\n    name1 = \"A\"\n    name2 = \"B\"\n    audit = \"C\"\n    currenc = \"Dollars\"\n\n    For i = ifrom To ito\n        If Range(\"E\" &amp; i).Value &lt;&gt; \"\" Then\n            '.... Your code goes here\n        End If\n    Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 8140603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6aff579ce44d617367bbd693049e3f23?s=128&d=identicon&r=PG&f=1", "display_name": "BenGoodman", "link": "https://stackoverflow.com/users/8140603/bengoodman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 402, "favorite_count": 0, "accepted_answer_id": 52620543, "answer_count": 2, "score": 1, "last_activity_date": 1538546262, "creation_date": 1538545075, "question_id": 52620326, "link": "https://stackoverflow.com/questions/52620326/loop-in-different-ranges-vba", "title": "Loop in different ranges VBA", "body": "<p>Code below works good, but it needs modernization.\nThis code for one table, it works until the end of table. But I added addition table at the same page below actual (exist) table. I need jumping i (loop) through 3 empty cells and start code for next table below. In another words, to find next table below and implement code there too.\nHow to implement (realize) that?</p>\n\n<pre><code>Sub Test()\nDim score1 As Double, score2 As Double, score3 As Double, result As String, text As String\n\nDim ifrom As Long, ito As Long\nDim i As Long\n\nifrom = 2\nito = Range(\"E2\").End(xlDown).Row ' find the row above the 1st blank cell in column E\n\nname1 = \"A\"       \nname2 = \"B\"    \naudit = \"C\"      \ncurrenc = \"Dollars\"       \n\n\nFor i = ifrom To ito\n\n    text = Range(\"E\" &amp; i).Value\n    score1 = Int(Range(\"B\" &amp; i).Value)\n    score2 = Int(Range(\"C\" &amp; i).Value)\n    score3 = Int(Abs(Range(\"D\" &amp; i).Value))\n\n\nIf score1 = 0 And score2 = 0 Then\n    result = text + ......\n\nElseIf score1 = score2 Then\n    result = text +........\n\nElseIf score1 &gt; score2 And score2 &lt;&gt; 0 Then\n    result = text + ............\n\nElseIf score1 &lt; score2 And score1 &lt;&gt; 0 Then\n    result = text +......\n\nElse\n    result = text + \" 00000000\"\n\nEnd If\n\nRange(\"H\" &amp; i).Value = result\nNext i\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1538543830, "post_id": 52620079, "comment_id": 92173970, "body": "You&#39;ll need to show the code you have so far, indicating where you&#39;re having the problem."}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1538543847, "post_id": 52620079, "comment_id": 92173977, "body": "Can you paste in your current code sample?"}, {"owner": {"reputation": 1, "user_id": 10449182, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Mv0bEVigOVc/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVJVFuSEAEoQrOCMm-PFDDbpJs9Eg/mo/photo.jpg?sz=128", "display_name": "Chua Ricky", "link": "https://stackoverflow.com/users/10449182/chua-ricky"}, "edited": false, "score": 0, "creation_date": 1538544607, "post_id": 52620079, "comment_id": 92174215, "body": "I want to paste the formula to the right of wherever I am typing. For example, if now I am typing at A7, I will run the macro and then the formula will be pasted as values in B7."}, {"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1538544873, "post_id": 52620079, "comment_id": 92174291, "body": "When you are asked to post your code, it needs to be added to the original question and formatted correctly. Not dumped in a comment."}, {"owner": {"reputation": 1, "user_id": 10449182, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Mv0bEVigOVc/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVJVFuSEAEoQrOCMm-PFDDbpJs9Eg/mo/photo.jpg?sz=128", "display_name": "Chua Ricky", "link": "https://stackoverflow.com/users/10449182/chua-ricky"}, "edited": false, "score": 0, "creation_date": 1538545154, "post_id": 52620079, "comment_id": 92174374, "body": "Oh sorry Mike.. First time posting here. Sorry for the inconvenience caused."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10449182, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Mv0bEVigOVc/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVJVFuSEAEoQrOCMm-PFDDbpJs9Eg/mo/photo.jpg?sz=128", "display_name": "Chua Ricky", "link": "https://stackoverflow.com/users/10449182/chua-ricky"}, "edited": false, "score": 0, "creation_date": 1538548170, "post_id": 52620588, "comment_id": 92175536, "body": "Which line of my code should i replace this line with?"}], "tags": [], "owner": {"reputation": 96, "user_id": 10351957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FhPLN.jpg?s=128&g=1", "display_name": "Hamed", "link": "https://stackoverflow.com/users/10351957/hamed"}, "is_accepted": false, "score": 0, "last_activity_date": 1538546457, "creation_date": 1538546457, "answer_id": 52620588, "question_id": 52620079, "link": "https://stackoverflow.com/questions/52620079/macros-for-copy-and-paste/52620588#52620588", "title": "Macros for copy and paste", "body": "<p>try this:</p>\n\n<pre><code>ActiveCell.Value=ActiveCell.Value\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10449182, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Mv0bEVigOVc/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVJVFuSEAEoQrOCMm-PFDDbpJs9Eg/mo/photo.jpg?sz=128", "display_name": "Chua Ricky", "link": "https://stackoverflow.com/users/10449182/chua-ricky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1538546517, "creation_date": 1538543631, "last_edit_date": 1538546517, "question_id": 52620079, "link": "https://stackoverflow.com/questions/52620079/macros-for-copy-and-paste", "title": "Macros for copy and paste", "body": "<p>Need help with a Excel Macro. I need to do a macro where i am able to copy and paste as values a formula in the same row. \nI tried to do a macro but it is pasting in the wrong location. Can anyone help please!</p>\n\n<p>E.g; I want to paste the formula to the right of wherever I am typing. For example, if now I am typing at A7, I will run the macro and then the formula will be pasted as values in B7</p>\n\n<p>Code currently used:</p>\n\n<pre><code>Sub Macro1()\n'\n' Macro1 Macro\n'\n' Keyboard Shortcut: Ctrl+d\n'\n    ActiveCell.FormulaR1C1 = \"=NOW()\"\n   ActiveCell.Select\n    Selection.Copy\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Application.CutCopyMode = False\nEnd Sub\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/jHvH6.png\" alt=\"Image shown here.\"></p>\n"}, {"tags": ["vba", "function", "user-defined-functions"], "comments": [{"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1538542791, "post_id": 52619892, "comment_id": 92173721, "body": "This isn&#39;t an answer to specific question but can you not just type in &quot;D1&quot; <code>=ComplexCircle(A1,B1)</code> ? Or what&#39;s wrong with good old-fashioned <code>=A1*B1</code> - why do you use the named ranges?"}, {"owner": {"reputation": 145, "user_id": 8293266, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c1c85ad790c4239e3b253b8e54613532?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent", "link": "https://stackoverflow.com/users/8293266/vincent"}, "reply_to_user": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1538542956, "post_id": 52619892, "comment_id": 92173753, "body": "nope. this is just a simple and shortened formula of my current project. the real formula contains 10parameters of double/integers/string which are not namedrange, just a plain single cell value. The problem with that one is, if i will change the range of my namedrange, the old fashioned way is not applicable in a big project"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1538543727, "post_id": 52619892, "comment_id": 92173944, "body": "I think you&#39;ve quite possibly over-simplified your <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, and removed the bug doing so: there&#39;s no reason for <i>this code</i> to blow up <i>under the circumstances you&#39;re talking about</i>, especially if you tried explicit parameter types."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1538543928, "post_id": 52619892, "comment_id": 92174002, "body": "Perhaps the function is not located in a public (&quot;regular&quot;) module?"}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1538543998, "post_id": 52619892, "comment_id": 92174023, "body": "I was a bit confused by this, I saw my version trying to evaluate $A1:$A1*$B1:$B1 - (which on a sheet works ok but not when parameters are variants or left undefined) but when the function is changed to use <code>double</code> it works fine - maybe the problem is located somewhere else in the more complex formula"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1538544038, "post_id": 52619892, "comment_id": 92174032, "body": "also, if you&#39;re entering <code>=ComplexCircle(myRadius,myConstant)</code> that implies that you have named ranges called <code>myRadius</code> and <code>myConstant</code>.  If this is a question about basic usage of Excel then this may not be the right place for it. See the <a href=\"https://stackoverflow.com/help/on-topic\">help center</a> for more information about what&#39;s on-topic on this site."}], "owner": {"reputation": 145, "user_id": 8293266, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c1c85ad790c4239e3b253b8e54613532?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent", "link": "https://stackoverflow.com/users/8293266/vincent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1538543379, "creation_date": 1538542301, "question_id": 52619892, "link": "https://stackoverflow.com/questions/52619892/passing-exceldefined-named-range-in-udf-in-vba", "title": "passing excelDefined named range in UDF in VBA", "body": "<p>In my excel sheet my entire column(A) i named it \"myRadius\" and in \"A1\" the cell value is 15.25. My entire column(B) i named it \"myConstant\" and the cell value for \"B1\" is 5. Then in \"C1\" i type some formulas which is \"=myRadius*myConstant\" and the result is 76.25. But when i create a VBA Function(UDF) for cleaner code and type it in \"D1\" the result is \"#VALUE!\". Here is my UDF.</p>\n\n<pre><code>Function ComplexCircle(myRad As Variant, myCons As Variant)\nComplexCircle = myRad * myCons\nEnd Function\n</code></pre>\n\n<p>In \"D1\" i type \"=ComplexCircle(myRadius,myConstant)\"\nDo i missing something? I did try variant/double/range parameter but it doesn't work</p>\n"}, {"tags": ["excel", "vba", "sorting"], "comments": [{"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1538541454, "post_id": 52619676, "comment_id": 92173413, "body": "What value does <code>myline</code> have when you&#39;re calling this?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1538542055, "post_id": 52619676, "comment_id": 92173532, "body": "Was here a specific reason for passing the <i>myLine</i> (aka <i>lastRow</i>) in as a string? Is it needed at all?"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 2, "last_activity_date": 1538542010, "creation_date": 1538542010, "answer_id": 52619851, "question_id": 52619676, "link": "https://stackoverflow.com/questions/52619676/sort-multiple-columns-excel-vba/52619851#52619851", "title": "sort multiple columns excel VBA", "body": "<p>You are trying to include columns D and J as secondary sorting criteria but excluding them from the sorted range. Additionally, The <code>Range(\"xn\")</code> do not necessarily belong to the Result-Inactive worksheet without being syntaxed as <code>.Range(\"xn\")</code>.Try the alternate VBA sort instead of the method produced by the 'macro' recorder.</p>\n\n<pre><code>Sub SortMultipleColumns()\n\n    With Worksheets(\"Result-Inactive\")\n        with .cells(1, \"A\").currentregion\n            .Cells.Sort Key1:=.Range(\"A1\"), Order1:=xlAscending, _\n                        Key2:=.Range(\"D1\"), Order2:=xlAscending, _\n                        Key3:=.Range(\"J1\"), Order3:=xlAscending, _\n                        Orientation:=xlTopToBottom, Header:=xlYes\n        end with\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "is_accepted": true, "score": 9, "last_activity_date": 1538542520, "creation_date": 1538542520, "answer_id": 52619930, "question_id": 52619676, "link": "https://stackoverflow.com/questions/52619676/sort-multiple-columns-excel-vba/52619930#52619930", "title": "sort multiple columns excel VBA", "body": "<p>Just reiterating Jeeped's answer here but with a slightly different take:</p>\n\n<p>1) <code>myline</code> should really be defined as a Long or Integer</p>\n\n<p>2) The ranges declared with <code>Key:=Range(\"A1\")</code> should be defined as the same worksheet</p>\n\n<p>3) The keys for <code>D</code> and <code>J</code> are outside of the <code>.setRange</code> which again, should be defined as being on the same worksheet also</p>\n\n<p>I've stuck with your same code but added the <code>ws</code> worksheet definition to all ranges, and changed your set range to include up to column <code>J</code></p>\n\n<pre><code>Sub SortMultipleColumns(myline As Long)\n\nDim ws As Worksheet: Set ws = ThisWorkbook.Worksheets(\"Result-Inactive\")\n\n    With ws.Sort\n        .SortFields.Clear\n        .SortFields.Add Key:=ws.Range(\"A1\"), Order:=xlAscending\n        .SortFields.Add Key:=ws.Range(\"D1\"), Order:=xlAscending\n        .SortFields.Add Key:=ws.Range(\"J1\"), Order:=xlAscending\n        .SetRange ws.Range(\"A1:J\" &amp; myline)\n        .Header = xlYes\n        .Apply\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>I'm assuming <code>myline</code> is there because sometimes you only want to sort the top set of a range of data. I also added a line to <code>clear</code> all the sortfields, just in case you run many different sorters on this sheet.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 14719534, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/0d5ad527f272d695b4afa2156d01894b?s=128&d=identicon&r=PG", "display_name": "A7V", "link": "https://stackoverflow.com/users/14719534/a7v"}, "is_accepted": false, "score": 0, "last_activity_date": 1606489947, "last_edit_date": 1606489947, "creation_date": 1606481172, "answer_id": 65037613, "question_id": 52619676, "link": "https://stackoverflow.com/questions/52619676/sort-multiple-columns-excel-vba/65037613#65037613", "title": "sort multiple columns excel VBA", "body": "<p>Try this:</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Sub SortingColumnsInRange\n    ' Selecting range\n    Range(&quot;A:X&quot;).Select\n\n    ' Sort column C, after column N and after column P\n    Selection.Columns.Sort key1:=Columns(&quot;C&quot;), Order1:=xlAscending, Key2:=Columns(&quot;N&quot;), Order2:=xlAscending, key3:=Columns(&quot;P&quot;), Order3:=xlAscending, Header:=xlYes\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 7247091, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153072147051971/picture?type=large", "display_name": "Natalia Fontiveros", "link": "https://stackoverflow.com/users/7247091/natalia-fontiveros"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40307, "favorite_count": 2, "accepted_answer_id": 52619930, "answer_count": 3, "score": 2, "last_activity_date": 1606489947, "creation_date": 1538540740, "last_edit_date": 1538547153, "question_id": 52619676, "link": "https://stackoverflow.com/questions/52619676/sort-multiple-columns-excel-vba", "title": "sort multiple columns excel VBA", "body": "<p>this is my code </p>\n\n<pre><code>Sub SortMultipleColumns(myline As String)\n\n    With Worksheets(\"Result-Inactive\").Sort\n        .SortFields.Add Key:=Range(\"A1\"), Order:=xlAscending\n        .SortFields.Add Key:=Range(\"D1\"), Order:=xlAscending\n        .SortFields.Add Key:=Range(\"J1\"), Order:=xlAscending\n        .SetRange Range(\"A1:C\" &amp; myline)\n        .Header = xlYes\n        .Apply\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>I get the following error and I dont undertsand why \"Run time error '1004' the sort reference is not valid. MAke sure that it is within the daya you want to sort, and then first Sort by Box isnt the same or blank. when I click debug. The .apply gets higlighted </p>\n\n<p>any suggestions?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1538539041, "post_id": 52619330, "comment_id": 92172924, "body": "It depends what &quot;transfer many different tasks&quot; means. Are tasks rows on a sheet and you re copying them elsewhere? The only rollback feature that I&#39;m aware of is CTRL-Z - maybe you can script that. A better approach may be to ensure that your process can be rerun in any state without creating duplicates"}, {"owner": {"reputation": 25, "user_id": 10147437, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_l9YYa1V07g/AAAAAAAAAAI/AAAAAAAAOfs/M-n0wuB20Ns/photo.jpg?sz=128", "display_name": "Christine Cordero", "link": "https://stackoverflow.com/users/10147437/christine-cordero"}, "reply_to_user": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1538540606, "post_id": 52619330, "comment_id": 92173240, "body": "That is what I am preventing the duplicates. Let&#39;s just say the user won&#39;t remember what other task it does hence will not be able to retrieve and manually delete all of it."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 10147437, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_l9YYa1V07g/AAAAAAAAAAI/AAAAAAAAOfs/M-n0wuB20Ns/photo.jpg?sz=128", "display_name": "Christine Cordero", "link": "https://stackoverflow.com/users/10147437/christine-cordero"}, "edited": false, "score": 0, "creation_date": 1538540748, "post_id": 52619383, "comment_id": 92173269, "body": "you mean, something like at the beginning the code will save the current file and on error recall that file again?"}, {"owner": {"reputation": 25, "user_id": 10147437, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_l9YYa1V07g/AAAAAAAAAAI/AAAAAAAAOfs/M-n0wuB20Ns/photo.jpg?sz=128", "display_name": "Christine Cordero", "link": "https://stackoverflow.com/users/10147437/christine-cordero"}, "edited": false, "score": 0, "creation_date": 1538540789, "post_id": 52619383, "comment_id": 92173281, "body": "i recall that excel can recall the last cell occupied on a sheet may be I&#39;ll try around that. Thanks for the idea."}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 3, "creation_date": 1538541252, "post_id": 52619383, "comment_id": 92173366, "body": "You can find the last cell changed or whatever but to undo all changes it would be much simpler to just save a temporary copy of the book at the start of a routine. There&#39;s no magic in-built functions to create a &quot;restore&quot; point of some sort, which basically would do the exact same thing anyway, and ctrl+z doesn&#39;t work with events shot from vba. This answer is really the best option."}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1538602568, "post_id": 52619383, "comment_id": 92205213, "body": "There are other ways to do this, I have in the past done this when I was writing to the database I would write out to a sheet (log) the lines of data as I wrote them to the database, if I needed to reverse what I did because the user interrupted it with esc or if the process failed, it would run a cleanup process which would del from the database anything I had in that log. Doesn&#39;t sound like this will work in your scenario as you are writing to sheets but it would be simple to tag each new line with an identifier then delete the tag on successful completion or delete the rows on failure."}], "tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": true, "score": 2, "last_activity_date": 1538538184, "creation_date": 1538538184, "answer_id": 52619383, "question_id": 52619330, "link": "https://stackoverflow.com/questions/52619330/stop-vba-code-and-void-or-cancel-all-it-has-already-processed/52619383#52619383", "title": "Stop VBA code and void or cancel all it has already processed?", "body": "<p>Save a copy of the workbook to a backup as it starts the code, on error rename the current workbook to something else, restore the backup over the original then close the renamed one you are in.</p>\n\n<p>Open the file again and it will be exactly as it was before you ran the macro.</p>\n\n<p>NOTE, THIS WILL BE SAVING YOUR FILE WHEN IT RUNS, Make sure you have a backup somewhere else when doing your testing.</p>\n"}], "owner": {"reputation": 25, "user_id": 10147437, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_l9YYa1V07g/AAAAAAAAAAI/AAAAAAAAOfs/M-n0wuB20Ns/photo.jpg?sz=128", "display_name": "Christine Cordero", "link": "https://stackoverflow.com/users/10147437/christine-cordero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 52619383, "answer_count": 1, "score": 0, "last_activity_date": 1538538184, "creation_date": 1538537761, "question_id": 52619330, "link": "https://stackoverflow.com/questions/52619330/stop-vba-code-and-void-or-cancel-all-it-has-already-processed", "title": "Stop VBA code and void or cancel all it has already processed?", "body": "<p>I understand that an \"on error\" code can be used if an error occurs. However, I wonder if it is possible to void all that had been processed by that macro? Perhaps recalling the last memory? </p>\n\n<p>For example, I have a code that runs to transfer many different tasks. Is there a code that can be used to undo what it has done other than manually going to those sheets or files and delete them manually?</p>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["vba", "excel", "comparison"], "comments": [{"owner": {"reputation": 575, "user_id": 7951002, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155077501585446/picture?type=large", "display_name": "MT32", "link": "https://stackoverflow.com/users/7951002/mt32"}, "edited": false, "score": 0, "creation_date": 1538539261, "post_id": 52619318, "comment_id": 92172966, "body": "So, if MyCell.Value &lt;&gt; Worksheets(&quot;Sheet2&quot;).Range(&quot;C2&quot;).Value Then you want to copy the value in Sheet1 and paste it in Sheet2? From what I see I think you&#39;re searching for the value of C2 FROM Sheet2 in Sheet1, row 1... and  leave a note saying it&#39;s incorrect.... it&#39;s kinda confusing for me because you&#39;re looking for only row A....  Can you state out what you want so I can try to find a way to help you"}, {"owner": {"reputation": 23, "user_id": 10449168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7be0e1c25fdeb5648feb1f4b1c96c7bb?s=128&d=identicon&r=PG&f=1", "display_name": "Edward Gesmundo Vicente", "link": "https://stackoverflow.com/users/10449168/edward-gesmundo-vicente"}, "reply_to_user": {"reputation": 575, "user_id": 7951002, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155077501585446/picture?type=large", "display_name": "MT32", "link": "https://stackoverflow.com/users/7951002/mt32"}, "edited": false, "score": 0, "creation_date": 1538539372, "post_id": 52619318, "comment_id": 92172993, "body": "@MT32 If the value for 2 cell are not equal. I will paste it to sheet 3 and with comment beside it &quot;Incorrect values&quot;"}, {"owner": {"reputation": 575, "user_id": 7951002, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155077501585446/picture?type=large", "display_name": "MT32", "link": "https://stackoverflow.com/users/7951002/mt32"}, "edited": false, "score": 0, "creation_date": 1538539650, "post_id": 52619318, "comment_id": 92173040, "body": "So, sheet 1 and sheet2 will have the same number of rows and column right?"}, {"owner": {"reputation": 23, "user_id": 10449168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7be0e1c25fdeb5648feb1f4b1c96c7bb?s=128&d=identicon&r=PG&f=1", "display_name": "Edward Gesmundo Vicente", "link": "https://stackoverflow.com/users/10449168/edward-gesmundo-vicente"}, "reply_to_user": {"reputation": 575, "user_id": 7951002, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155077501585446/picture?type=large", "display_name": "MT32", "link": "https://stackoverflow.com/users/7951002/mt32"}, "edited": false, "score": 0, "creation_date": 1538539779, "post_id": 52619318, "comment_id": 92173068, "body": "@MT32, No. Sheet1 and Sheet2 has a column wherein value should be the same or equal. Example. Sheet1 Column A2 should be equal to Sheet2 B2"}, {"owner": {"reputation": 575, "user_id": 7951002, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155077501585446/picture?type=large", "display_name": "MT32", "link": "https://stackoverflow.com/users/7951002/mt32"}, "edited": false, "score": 0, "creation_date": 1538540073, "post_id": 52619318, "comment_id": 92173119, "body": "Okay. Then Sheet3 is already created, so I dont have to create sheet3 in the code right?"}, {"owner": {"reputation": 575, "user_id": 7951002, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155077501585446/picture?type=large", "display_name": "MT32", "link": "https://stackoverflow.com/users/7951002/mt32"}, "edited": false, "score": 0, "creation_date": 1538540129, "post_id": 52619318, "comment_id": 92173134, "body": "Also, when you said Sheet1 A2 should equal Sheet2 B2. If they are not equal, you will copy WHICH value to sheet 3?"}, {"owner": {"reputation": 575, "user_id": 7951002, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155077501585446/picture?type=large", "display_name": "MT32", "link": "https://stackoverflow.com/users/7951002/mt32"}, "edited": false, "score": 0, "creation_date": 1538540643, "post_id": 52619318, "comment_id": 92173247, "body": "please let me know what you wnat to copy. Im almost done with the solution but I have to go for a quick lunch lolll"}, {"owner": {"reputation": 23, "user_id": 10449168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7be0e1c25fdeb5648feb1f4b1c96c7bb?s=128&d=identicon&r=PG&f=1", "display_name": "Edward Gesmundo Vicente", "link": "https://stackoverflow.com/users/10449168/edward-gesmundo-vicente"}, "reply_to_user": {"reputation": 575, "user_id": 7951002, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155077501585446/picture?type=large", "display_name": "MT32", "link": "https://stackoverflow.com/users/7951002/mt32"}, "edited": false, "score": 0, "creation_date": 1538541120, "post_id": 52619318, "comment_id": 92173343, "body": "In sheet3 A2, B2 of sheet2 should be paste and with comment on B2 of sheet3 &quot;Incorrect value&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": false, "score": 0, "last_activity_date": 1538542027, "last_edit_date": 1538542027, "creation_date": 1538541668, "answer_id": 52619804, "question_id": 52619318, "link": "https://stackoverflow.com/questions/52619318/how-to-check-if-cells-in-different-sheets-are-equal/52619804#52619804", "title": "How to check if cells in different sheets are equal?", "body": "<p>You only need to set the last row for sheet1 and sheet3. run a loop from 2 to the lastrow and compare <code>Sheet1.columnB</code> with <code>Sheet2.columnC</code> if &lt;> then copy the value in <code>Sheet1</code> to <code>Sheet3</code>, offset 1 cell to the right and paste your text. You add +1 to the last row in <code>Sheet3</code> so you don't keep writing over the same cell...</p>\n\n<pre><code>Dim i As Long\nDim lRow As Long\nlRow = Sheet1.Cells(Rows.Count, \"B\").End(xlUp).Row\n\nDim lRow3 As Long\nlRow3 = Sheet3.Cells(Rows.Count, \"A\").End(xlUp).Row\n\n    For i = 2 To lRow\n        If Sheet1.Cells(i, \"B\").Value &lt;&gt; Sheet2.Cells(i, \"C\").Value Then\n            Sheet3.Cells(lRow3, \"A\").Value = Sheet1.Cells(i, \"B\").Value\n            Sheet3.Cells(lRow3, \"A\").Offset(, 1).Value = \"Incorrect Value.\"\n        End If\n        lRow3 = lRow3 + 1\n    Next i\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 575, "user_id": 7951002, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155077501585446/picture?type=large", "display_name": "MT32", "link": "https://stackoverflow.com/users/7951002/mt32"}, "is_accepted": true, "score": 1, "last_activity_date": 1538617208, "last_edit_date": 1538617208, "creation_date": 1538543723, "answer_id": 52620089, "question_id": 52619318, "link": "https://stackoverflow.com/questions/52619318/how-to-check-if-cells-in-different-sheets-are-equal/52620089#52620089", "title": "How to check if cells in different sheets are equal?", "body": "<p>I've added in some extra message box if the number of rows of sheet 1 and 2 are not the same.</p>\n\n<p>Try this:</p>\n\n<pre><code>Sub Messagecode()\n\nDim ws As Worksheet\nDim ws2 As Worksheet\nDim lastrow1 As Integer\nDim lastrow2 As Integer\ndim lastrow3 as integer\nDim i As Integer\n\nSet ws1 = Worksheets(\"Sheet1\")\nSet ws2 = Worksheets(\"Sheet2\")\nws1.Activate\nlastrow1 = Cells(Rows.Count, 2).End(xlUp).Row\nws2.Activate\nlastrow2 = Cells(Rows.Count, 3).End(xlUp).Row\n\nIf lastrow1 &lt;&gt; lastrow2 Then\nMsgBox (\"number of rows in Sheet1 is not equal to number of rows in Sheet2\")\nEnd If\n\nFor i = 2 To lastrow1\nIf ws1.Cells(i, 2) &lt;&gt; ws2.Cells(i, 3) Then\nws2.Cells(i, 3).Copy\nWorksheets(\"Sheet3\").Activate\n\nlastrow3 = Cells(Rows.Count, 1).End(xlUp).Row\nCells(lastrow3, 1).Offset(1, 0).Activate\nActiveSheet.Paste\nCells(lastrow3, 1).Offset(1, 1) = \"incorrect value\"\n\n\nEnd If\nws1.Activate\n\nNext i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 10449168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7be0e1c25fdeb5648feb1f4b1c96c7bb?s=128&d=identicon&r=PG&f=1", "display_name": "Edward Gesmundo Vicente", "link": "https://stackoverflow.com/users/10449168/edward-gesmundo-vicente"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 52620089, "answer_count": 2, "score": 2, "last_activity_date": 1538617208, "creation_date": 1538537618, "last_edit_date": 1538546210, "question_id": 52619318, "link": "https://stackoverflow.com/questions/52619318/how-to-check-if-cells-in-different-sheets-are-equal", "title": "How to check if cells in different sheets are equal?", "body": "<p>Scenario: -There are 2 sheets being compared. Range for Sheet1 is B2:B and for Sheet2 is C2:C. </p>\n\n<p>Requirement: </p>\n\n<ul>\n<li>Sheet1 B2 = Sheet2 C2</li>\n<li>Sheet1 B3 = Sheet2 C3 and so on...</li>\n</ul>\n\n<p>See my existing code below:</p>\n\n<pre><code>Sub MessageCode()\n\n    Dim FoundBlank1 As Range\n    Dim ws As Worksheet: Set ws = ThisWorkbook.Sheets(\"Sheet1\")\n    Dim ws2 As Worksheet: Set ws2 = ThisWorkbook.Sheets(\"Sheet2\")\n    Dim MyRange As Range, MyCell As Range, MyRange2 As Range, MyCell2 As Range\n\n    Set MyRange = ws.Range(\"B2:B\" &amp; ws.Range(\"B\" &amp; ws.Rows.Count).End(xlUp).Row)\n    Set MyRange2 = ws2.Range(\"C2:C\" &amp; ws2.Range(\"C\" &amp; ws2.Rows.Count).End(xlUp).Row)\n    Set MyCell2 = MyRange2\n\n\n    For Each MyCell In MyRange\n\n       If MyCell.Value &lt;&gt; Worksheets(\"Sheet2\").Range(\"C2\").Value Then\n\n            MyCell.Copy\n            Worksheets(\"Sheet3\").Select\n            Set FoundBlank1 = Range(\"A1:A1000\").Find(What:=\"\", lookat:=xlWhole)\n            FoundBlank1.Select\n            Selection.PasteSpecial xlPasteValues\n\n            ActiveCell.Offset(0, 1).Value = \"Incorrect Value.\"\n\n        End If\n\n    Next MyCell\n\n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1538537520, "post_id": 52619286, "comment_id": 92172646, "body": "Is this all internal? If so, why aren&#39;t you using UNC paths?  If not, what do you expect them to open in if <i>not</i> the browser?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 2, "creation_date": 1538537536, "post_id": 52619286, "comment_id": 92172651, "body": "What does the <code>linkPath</code> actually look like? Does it begin with <code>file</code>? Is it a valid UNC path? Also, you may not be able to control how the recipient&#39;s email program handles hyperlinks, or what default programs they have associated with hyperlinks."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1538537601, "post_id": 52619286, "comment_id": 92172660, "body": "<a href=\"https://docs.microsoft.com/en-us/dotnet/standard/io/file-path-formats#unc-paths\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/dotnet/standard/io/&hellip;</a>"}, {"owner": {"reputation": 18, "user_id": 3193921, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mwupr.jpg?s=128&g=1", "display_name": "Spitfire", "link": "https://stackoverflow.com/users/3193921/spitfire"}, "edited": false, "score": 0, "creation_date": 1538549549, "post_id": 52619286, "comment_id": 92176229, "body": "Thanks! I reviewed the linked docs and arrived to a similar solution in the answer below. I also added a <code>file&#47;&#47;&#47;</code> tag in order to force it to be recognized as a hyperlink to file/folder"}], "answers": [{"tags": [], "owner": {"reputation": 96, "user_id": 10351957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FhPLN.jpg?s=128&g=1", "display_name": "Hamed", "link": "https://stackoverflow.com/users/10351957/hamed"}, "is_accepted": true, "score": 0, "last_activity_date": 1538545051, "creation_date": 1538545051, "answer_id": 52620321, "question_id": 52619286, "link": "https://stackoverflow.com/questions/52619286/file-path-link-opens-in-browser/52620321#52620321", "title": "File path link opens in browser", "body": "<p>Put \"\\\\\" at the first of address and try it again.</p>\n\n<pre><code>&lt;a href = \\\\\" &amp; linkPath &amp; \"&gt;\n</code></pre>\n"}], "owner": {"reputation": 18, "user_id": 3193921, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mwupr.jpg?s=128&g=1", "display_name": "Spitfire", "link": "https://stackoverflow.com/users/3193921/spitfire"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 52620321, "answer_count": 1, "score": 0, "last_activity_date": 1538545051, "creation_date": 1538537214, "last_edit_date": 1538542485, "question_id": 52619286, "link": "https://stackoverflow.com/questions/52619286/file-path-link-opens-in-browser", "title": "File path link opens in browser", "body": "<p>I created a macro in excel to generate an email in MS Outlook. The contents of the email include hyperlinks to paths to file servers and network drives.</p>\n\n<p>I am having a problem when the link has an ip address (e.g. 10.72.144.73, etc.).\nThere is no problem when the mail is generated in Outlook. I can open the path just fine. However, when the mail is sent and opened by the receiver, the link will open on the internet browser instead.</p>\n\n<p>Here is the code so far. It is being formatted in HTML:</p>\n\n<pre><code>linkPath = Replace(linePath, \" \", \"%20\")\n\nstrbody1 = \"&lt;font face=Calibri&gt;Good day! &lt;br&gt;&lt;br&gt;\" &amp; _\n          \"The following QA item/s have been added to &lt;b&gt;\" &amp; bookName &amp; \"&lt;/b&gt; file.\" &amp; _\n          \" Kindly confirm. Thank you very much. &lt;br/&gt;\" &amp; _\n          \"&amp;nbsp;&amp;nbsp;&amp;nbsp;  &lt;b&gt;PATH:&lt;/b&gt; &lt;a href = \" &amp; linkPath &amp; \"&gt;\" &amp; linePath &amp; \"&lt;/a&gt;&lt;br&gt;\"\n</code></pre>\n\n<p>Thank you in advance!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1538533904, "post_id": 52618822, "comment_id": 92171873, "body": "Did you try that code?  What you say you want is what it does."}, {"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "edited": false, "score": 0, "creation_date": 1538535319, "post_id": 52618822, "comment_id": 92172172, "body": "<i>&quot;I do not actually need the range to be saved as a separate file, I just want the range selected to be published as a PDF that opens up&quot;</i> ... Um... so what you&#39;re saying is that you CAN get the PDF to display as expected, but you don&#39;t want to keep the file &#39;Export.pdf&#39;? I think your only play is to create the file then delete it when you&#39;re done with it...see here: <a href=\"https://stackoverflow.com/q/67835/3451115\">stackoverflow.com/q/67835/3451115</a>"}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1538537370, "post_id": 52618822, "comment_id": 92172612, "body": "You cannot publish straight to a PDF Viewer, as the other comments have also explained the file needs to be saved then opened, if you don&#39;t want it permanently then delete it after the <code>End With</code> you can do so by putting this there: <code>kill(&quot;C:\\Users\\tjb1\\Desktop\\Export.pdf&quot;)</code> or alternatively use some of the other methods like the FileSystemObject method listed here: <a href=\"https://stackoverflow.com/questions/67835/deleting-a-file-in-vba\">stackoverflow.com/questions/67835/deleting-a-file-in-vba</a>"}, {"owner": {"reputation": 147, "user_id": 5450121, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c4c620970c5e639ac1a3fb7059756144?s=128&d=identicon&r=PG&f=1", "display_name": "premiumcopypaper", "link": "https://stackoverflow.com/users/5450121/premiumcopypaper"}, "edited": false, "score": 0, "creation_date": 1538563210, "post_id": 52618822, "comment_id": 92183637, "body": "The issue is that this excel file will be used by multiple users, so the FileName path will be different for every user"}, {"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "edited": false, "score": 0, "creation_date": 1538608137, "post_id": 52618822, "comment_id": 92206731, "body": "So save it to a network share that everyone can use...?"}, {"owner": {"reputation": 968, "user_id": 5910169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a40180e3fa49fbf4e55145adf54d9?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Ball", "link": "https://stackoverflow.com/users/5910169/frank-ball"}, "edited": false, "score": 0, "creation_date": 1538680253, "post_id": 52618822, "comment_id": 92238607, "body": "You could simply install a PDF Printer like CutePDF (or any one of a number of PDF printers) and have it handle the whole process."}], "answers": [{"comments": [{"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 2, "creation_date": 1538537516, "post_id": 52619067, "comment_id": 92172644, "body": "But the VBA code already opens the file here: <code>OpenAfterPublish:=True</code>"}], "tags": [], "owner": {"reputation": 540, "user_id": 7747667, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6XJn7.jpg?s=128&g=1", "display_name": "oxwilder", "link": "https://stackoverflow.com/users/7747667/oxwilder"}, "is_accepted": false, "score": 1, "last_activity_date": 1538535282, "creation_date": 1538535282, "answer_id": 52619067, "question_id": 52618822, "link": "https://stackoverflow.com/questions/52618822/export-range-to-pdf-without-saving/52619067#52619067", "title": "Export range to PDF without saving", "body": "<p>After the</p>\n\n<pre><code>End With\n</code></pre>\n\n<p>in your code, you can add</p>\n\n<pre><code>CreateObject(\"Shell.Application\").Open (\"C:\\Users\\tjb1\\Desktop\\Export.pdf\")\n</code></pre>\n\n<p>That code worked for me.</p>\n\n<p>Good luck!</p>\n"}, {"tags": [], "owner": {"reputation": 147, "user_id": 5450121, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c4c620970c5e639ac1a3fb7059756144?s=128&d=identicon&r=PG&f=1", "display_name": "premiumcopypaper", "link": "https://stackoverflow.com/users/5450121/premiumcopypaper"}, "is_accepted": false, "score": 0, "last_activity_date": 1538674775, "creation_date": 1538674775, "answer_id": 52652548, "question_id": 52618822, "link": "https://stackoverflow.com/questions/52618822/export-range-to-pdf-without-saving/52652548#52652548", "title": "Export range to PDF without saving", "body": "<p>In order to export to PDF, a file must be saved to a drive. For a spreadsheet that will be used by multiple users, the <code>FileName</code> in the VBA script must be a generic drive all users have access to.</p>\n"}], "owner": {"reputation": 147, "user_id": 5450121, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c4c620970c5e639ac1a3fb7059756144?s=128&d=identicon&r=PG&f=1", "display_name": "premiumcopypaper", "link": "https://stackoverflow.com/users/5450121/premiumcopypaper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1103, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1538674775, "creation_date": 1538533139, "last_edit_date": 1538674666, "question_id": 52618822, "link": "https://stackoverflow.com/questions/52618822/export-range-to-pdf-without-saving", "title": "Export range to PDF without saving", "body": "<p>I've found a bit of VBA script that works:</p>\n\n<pre><code>Sub ExportToPDF()\n\n    With Sheets(\"Results\").Range(\"B10:J100\")\n        .ExportAsFixedFormat _\n            Type:=xlTypePDF, _\n            FileName:=\"C:\\Export.pdf\", _\n            Quality:=xlQualityStandard, _\n            IncludeDocProperties:=True, _\n            IgnorePrintAreas:=False, _\n            OpenAfterPublish:=True\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>I'm still learning VBA, I do not actually need the range to be saved as a separate file, I just want the range selected to be published as a PDF that opens up.</p>\n\n<p>I am not sure how to amend the above code</p>\n"}, {"tags": ["ms-access", "url", "web-scraping", "vba"], "comments": [{"owner": {"reputation": 2071, "user_id": 9990662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8262X.jpg?s=128&g=1", "display_name": "Zack", "link": "https://stackoverflow.com/users/9990662/zack"}, "edited": false, "score": 0, "creation_date": 1538576750, "post_id": 52618357, "comment_id": 92191972, "body": "Question: Would you be able and willing to use a different service? Rather than trying to scrape websites, another option might be the <a href=\"https://npiregistry.cms.hhs.gov/\" rel=\"nofollow noreferrer\">CMS NPPES NPI registry</a>. You can search for providers by state and taxonomy (so, for example, you could look for special hospitals in NJ). They also provide a <a href=\"https://npiregistry.cms.hhs.gov/registry/help-api\" rel=\"nofollow noreferrer\">free API</a> that&#39;s pretty easy to use. Results are returned in JSON, so you&#39;ll have to parse that (I would recommend <a href=\"https://github.com/VBA-tools/VBA-JSON\" rel=\"nofollow noreferrer\">this library</a>)."}, {"owner": {"reputation": 391, "user_id": 453116, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/bbV9X.jpg?s=128&g=1", "display_name": "lalachka", "link": "https://stackoverflow.com/users/453116/lalachka"}, "reply_to_user": {"reputation": 2071, "user_id": 9990662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8262X.jpg?s=128&g=1", "display_name": "Zack", "link": "https://stackoverflow.com/users/9990662/zack"}, "edited": false, "score": 0, "creation_date": 1538661312, "post_id": 52618357, "comment_id": 92228910, "body": "lol interesting. i do work with that file, i&#39;m afraid it doesn&#39;t have the data i&#39;m looking for and i know how to parse it :) someone helped me write a piece in python. i will check if it has it, thank you for the idea!"}, {"owner": {"reputation": 391, "user_id": 453116, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/bbV9X.jpg?s=128&g=1", "display_name": "lalachka", "link": "https://stackoverflow.com/users/453116/lalachka"}, "reply_to_user": {"reputation": 2071, "user_id": 9990662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8262X.jpg?s=128&g=1", "display_name": "Zack", "link": "https://stackoverflow.com/users/9990662/zack"}, "edited": false, "score": 0, "creation_date": 1538661744, "post_id": 52618357, "comment_id": 92229199, "body": "nope, it doesn&#39;t have it."}], "answers": [{"comments": [{"owner": {"reputation": 391, "user_id": 453116, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/bbV9X.jpg?s=128&g=1", "display_name": "lalachka", "link": "https://stackoverflow.com/users/453116/lalachka"}, "edited": false, "score": 0, "creation_date": 1538666559, "post_id": 52649923, "comment_id": 92232449, "body": "2nd version works perfect!! 1st highlight this line .Document.parentWindow.execScript col.Item(i).  It doesn&#39;t really matter, 2nd one seems to do what i need. do i accept the answer now or do i wait until i can do the bounty? thank you again!!!!"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 391, "user_id": 453116, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/bbV9X.jpg?s=128&g=1", "display_name": "lalachka", "link": "https://stackoverflow.com/users/453116/lalachka"}, "edited": false, "score": 0, "creation_date": 1538666806, "post_id": 52649923, "comment_id": 92232621, "body": "It&#39;s up to you. You can save yourself rep points by not offering a bounty. If you offer a bounty you may get better answers. You can always upvote if helpful. Accept if you wish. You have plenty of choices. The important thing is to get something you feel will deliver what you require reliably."}, {"owner": {"reputation": 391, "user_id": 453116, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/bbV9X.jpg?s=128&g=1", "display_name": "lalachka", "link": "https://stackoverflow.com/users/453116/lalachka"}, "edited": false, "score": 0, "creation_date": 1538666952, "post_id": 52649923, "comment_id": 92232706, "body": "i&#39;m happy with the answer, i just wanted to give up some points for it, this is a very useful thing!! one more dumb question, how do i get the source for the page your&#39;e looping through? i&#39;m playing around with my old code now, to plug it in, but figured i&#39;d ask :)"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 391, "user_id": 453116, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/bbV9X.jpg?s=128&g=1", "display_name": "lalachka", "link": "https://stackoverflow.com/users/453116/lalachka"}, "edited": false, "score": 0, "creation_date": 1538667009, "post_id": 52649923, "comment_id": 92232751, "body": "The innerHTML should be .document.body.innerHTML  if that is what you mean?"}, {"owner": {"reputation": 391, "user_id": 453116, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/bbV9X.jpg?s=128&g=1", "display_name": "lalachka", "link": "https://stackoverflow.com/users/453116/lalachka"}, "edited": false, "score": 0, "creation_date": 1538667259, "post_id": 52649923, "comment_id": 92232940, "body": "yes!! you&#39;re amazing. so how do i give up the points now? once i can post the bounty, will it add points to you? i don&#39;t know this site that well"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 391, "user_id": 453116, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/bbV9X.jpg?s=128&g=1", "display_name": "lalachka", "link": "https://stackoverflow.com/users/453116/lalachka"}, "edited": false, "score": 0, "creation_date": 1538667412, "post_id": 52649923, "comment_id": 92233022, "body": "Bounties are designed to attract interest to questions that don&#39;t have an answer after a day or two I think. So, you don&#39;t really need to offer a bounty if you get an answer sooner than the point at which you can offer one."}, {"owner": {"reputation": 391, "user_id": 453116, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/bbV9X.jpg?s=128&g=1", "display_name": "lalachka", "link": "https://stackoverflow.com/users/453116/lalachka"}, "edited": false, "score": 0, "creation_date": 1538667450, "post_id": 52649923, "comment_id": 92233043, "body": "got it, i was hoping i can add it to reward an answer. i really appreciate you doing this :)"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 391, "user_id": 453116, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/bbV9X.jpg?s=128&g=1", "display_name": "lalachka", "link": "https://stackoverflow.com/users/453116/lalachka"}, "edited": false, "score": 0, "creation_date": 1538667510, "post_id": 52649923, "comment_id": 92233073, "body": "Were you offered the possibility to put a bounty on? I thought it required a day or two."}, {"owner": {"reputation": 391, "user_id": 453116, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/bbV9X.jpg?s=128&g=1", "display_name": "lalachka", "link": "https://stackoverflow.com/users/453116/lalachka"}, "edited": false, "score": 0, "creation_date": 1538667599, "post_id": 52649923, "comment_id": 92233125, "body": "no lol, i have to wait another 10 hours. otherwise i would&#39;ve added it before i asked you for help :)"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 391, "user_id": 453116, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/bbV9X.jpg?s=128&g=1", "display_name": "lalachka", "link": "https://stackoverflow.com/users/453116/lalachka"}, "edited": false, "score": 0, "creation_date": 1538667684, "post_id": 52649923, "comment_id": 92233175, "body": "I thought so. The fact that you accepted is appreciated and that you are grateful is wonderful! I post a lot of web-scraping answers that OPs don&#39;t bother to accept even though they use."}, {"owner": {"reputation": 391, "user_id": 453116, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/bbV9X.jpg?s=128&g=1", "display_name": "lalachka", "link": "https://stackoverflow.com/users/453116/lalachka"}, "edited": false, "score": 0, "creation_date": 1538777384, "post_id": 52649923, "comment_id": 92277348, "body": "sorry, can i ask for your help one more time? same project, having issues searching the source.  <a href=\"https://stackoverflow.com/questions/52673819/using-instr-to-search-for-quotes-spaces-colons-etc\" title=\"using instr to search for quotes spaces colons etc\">stackoverflow.com/questions/52673819/&hellip;</a>"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1538668905, "last_edit_date": 1538668905, "creation_date": 1538665315, "answer_id": 52649923, "question_id": 52618357, "link": "https://stackoverflow.com/questions/52618357/scrape-data-from-web-page-source-where-url-doesnt-change/52649923#52649923", "title": "scrape data from web page source where url doesn&#39;t change", "body": "<p>It navigates to each result page, and back to homepage in between so as to leverage the postBack links through clicks.</p>\n\n<pre><code>Option Explicit\nPublic Sub VisitPages()\n    Dim IE As New InternetExplorer\n    With IE\n        .Visible = True\n        .navigate \"http://healthapps.state.nj.us/facilities/acSetSearch.aspx?by=county\"\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n        With .document\n            .querySelector(\"#middleContent_cbType_5\").Click\n            .querySelector(\"#middleContent_cbType_12\").Click\n            .querySelector(\"#middleContent_btnGetList\").Click\n        End With\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n        Dim list As Object, i  As Long\n        Set list = .document.querySelectorAll(\"#main_table [href*=doPostBack]\")\n        For i = 0 To list.Length - 1\n            list.item(i).Click\n\n            While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n            Application.Wait Now + TimeSerial(0, 0, 3) '&lt;== Delete me later. This is just to demo page changes\n            'do stuff with new page\n            .Navigate2 .document.URL             '&lt;== back to homepage\n            While .Busy Or .readyState &lt; 4: DoEvents: Wend\n            Set list = .document.querySelectorAll(\"#main_table [href*=doPostBack]\") 'reset list (often required in these scenarios)\n        Next\n        Stop                                     '&lt;== Delete me later\n        '.Quit '&lt;== Remember to quit application\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Same thing with executing the postBacks</p>\n\n<pre><code>Option Explicit\nPublic Sub VisitPages()\n    Dim IE As New InternetExplorer\n    With IE\n        .Visible = True\n        .navigate \"http://healthapps.state.nj.us/facilities/acSetSearch.aspx?by=county\"\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n        With .document\n            .querySelector(\"#middleContent_cbType_5\").Click\n            .querySelector(\"#middleContent_cbType_12\").Click\n            .querySelector(\"#middleContent_btnGetList\").Click\n        End With\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n        Dim list As Object, i  As Long, col As Collection\n        Set col = New Collection\n        Set list = .document.querySelectorAll(\"#main_table [href*=doPostBack]\")\n        For i = 0 To list.Length - 1\n           col.Add CStr(list.item(i))\n        Next\n        For i = 1 To col.Count\n            .document.parentWindow.execScript col.item(i)\n             While .Busy Or .readyState &lt; 4: DoEvents: Wend\n            'Do stuff with page\n            .Navigate2 .document.URL\n            While .Busy Or .readyState &lt; 4: DoEvents: Wend\n        Next\n        Stop                                     '&lt;== Delete me later\n        '.Quit '&lt;== Remember to quit application\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 391, "user_id": 453116, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/bbV9X.jpg?s=128&g=1", "display_name": "lalachka", "link": "https://stackoverflow.com/users/453116/lalachka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 362, "favorite_count": 0, "accepted_answer_id": 52649923, "answer_count": 1, "score": 1, "last_activity_date": 1594627892, "creation_date": 1538528948, "last_edit_date": 1594627892, "question_id": 52618357, "link": "https://stackoverflow.com/questions/52618357/scrape-data-from-web-page-source-where-url-doesnt-change", "title": "scrape data from web page source where url doesn&#39;t change", "body": "<p>I need to do the following</p>\n\n<ul>\n<li><p>Go to\n<a href=\"http://healthapps.state.nj.us/facilities/acSetSearch.aspx?by=county\" rel=\"nofollow noreferrer\">http://healthapps.state.nj.us/facilities/acSetSearch.aspx?by=county</a></p></li>\n<li><p>Select \"<strong>Special Hospital</strong>\" and \"<strong>All Ambulatory Care Facilities **NOTE #2</strong>\" </p></li>\n<li>Click <strong>SEARCH</strong> </li>\n<li>Loop through all the hospitals in the list </li>\n<li>Click on each hospital </li>\n<li>Get some data from the hospital page</li>\n</ul>\n\n<p>I have 2 problems</p>\n\n<ol>\n<li>I don't know how to select the \"<strong>Special Hospital</strong>\" and \"<strong>All Ambulatory Care Facilities **NOTE #2</strong>\" </li>\n<li>When I manually select those 2 types and then click on some of the hospitals, the URL doesn't become selection specific. \nIt becomes <a href=\"http://healthapps.state.nj.us/facilities/acFacilityList.aspx\" rel=\"nofollow noreferrer\">http://healthapps.state.nj.us/facilities/acFacilityList.aspx</a> after I select the 2 types, then stays that way when I click on the hospitals.\nTherefore, I'm not able to write the code that will scrape those pages because I don't know how to specify the URL for each hospital.</li>\n</ol>\n\n<p>I apologize, this has to be a very basic question but I wasn't able to google anything useful on it for Access VBA</p>\n\n<p>here's the code that pulls data from a page, i didn't do the loops yet, so this is just a basic pull of the source data behind a page</p>\n\n<pre><code>Public Function btnGetWebData_Click() \n    Dim strURL\n    Dim HTML_Content As HTMLDocument\n    Dim dados As Object\n\n    'Create HTMLFile Object\n    Set HTML_Content = New HTMLDocument\n\n    'Get the WebPage Content to HTMLFile Object\n    With CreateObject(\"msxml2.xmlhttp\")\n        .Open \"GET\", \"http://healthapps.state.nj.us/facilities/acFacilityList.aspx\", False\n        'http://healthapps.state.nj.us/facilities/acFacilityList.aspx\n        .Send\n        HTML_Content.Body.innerHTML = .responseText\n        Debug.Print .responseText\n        Debug.Print HTML_Content.Body.innerHTML\n    End With\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba", "newtons-method"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 1, "creation_date": 1538531550, "post_id": 52618059, "comment_id": 92171398, "body": "Is this a math problem or a coding problem? What does the code do right now? Wrong output? Error?"}, {"owner": {"reputation": 11, "user_id": 9717543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3a95368225d1e8f685e6f0ddc695222?s=128&d=identicon&r=PG&f=1", "display_name": "Zak", "link": "https://stackoverflow.com/users/9717543/zak"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 1, "creation_date": 1538557543, "post_id": 52618059, "comment_id": 92180314, "body": "The code does execute without any error. However, once the &#39;if&#39; condition is met, the code doesn&#39;t stop and continues to iterate. The output is also incorrect. As I mentioned, I expect the output to be approx 0.78. The whole idea is to assume a value of Y. Use it in &#39;DensityFunction&#39; such that &#39;DensityFunction&#39; ~ 0. If not, assume another value of Y (&#39;Ynext&#39;) and then use &#39;Ynext&#39; into &#39;DensityFunction&#39;"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 1, "creation_date": 1538558125, "post_id": 52618059, "comment_id": 92180664, "body": "<i>the code doesn&#39;t stop and continues to iterate</i>. To stop the iteration, you can use <code>Exit For</code>. Read more about it here: <a href=\"https://stackoverflow.com/a/9415163/9199828\">stackoverflow.com/a/9415163/9199828</a>"}, {"owner": {"reputation": 11, "user_id": 9717543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3a95368225d1e8f685e6f0ddc695222?s=128&d=identicon&r=PG&f=1", "display_name": "Zak", "link": "https://stackoverflow.com/users/9717543/zak"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1538585601, "post_id": 52618059, "comment_id": 92197377, "body": "@FoxfireAndBurnsAndBurns thanks and it works. As for the incorrect output, there was an error in one of the formulas I was using."}], "owner": {"reputation": 11, "user_id": 9717543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3a95368225d1e8f685e6f0ddc695222?s=128&d=identicon&r=PG&f=1", "display_name": "Zak", "link": "https://stackoverflow.com/users/9717543/zak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1768, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593592092, "creation_date": 1538525798, "last_edit_date": 1593592092, "question_id": 52618059, "link": "https://stackoverflow.com/questions/52618059/newton-raphson-in-excel-vba", "title": "Newton-Raphson in Excel VBA", "body": "<p>I want to make Newton-Raphson iteration but stuck on how to incorporate changing Y into the function of interest. For the values of Tpr and Ppr varibles in my code, I expect to have value of Z approx 0.78. My code as below: </p>\n\n<pre><code>Sub Z_Factor()\n\nDim Z As Double\nDim t As Double\nDim Tpr As Double\nDim Ppr As Double\nDim X1 As Double\nDim X2 As Double\nDim X3 As Double\nDim X4 As Double\nDim Y As Single\nDim Ynext As Single\nDim DensityFunction As Double\nDim DensityFunctionPrime As Double\nDim i As Integer\n\nTpr = 1.52\nPpr = 2.99\nt = 1 / Tpr\nX1 = -0.06125 * Ppr * t * Exp(-1.2 * (1 - t) ^ 2)\nX2 = 14.76 * t - 9.76 * t ^ 2 + 4.58 * t ^ 3\nX3 = 90.7 * t - 242.2 * t ^ 2 + 42.4 * t ^ 3\nX4 = 21.8 + 2.82 * t\n\n' starting guess of Y is calculated as: \nY = 0.0125 * Ppr * t * Exp(-1.2 * (1 - t) ^ 2)\n\nFor i = 1 To 100\n\n    DensityFunction = X1 + ((Y + Y ^ 2 + Y ^ 3 + Y ^ 4) / (1 - Y) ^ 3) - X2 * Y ^ 2 + X3 * Y ^ X4\n\n    ' derivative of DensityFunction\n    DensityFunctionPrime = ((1 + 4 * Y + 4 * Y ^ 2 - 4 * Y ^ 3 + Y ^ 4) / (1 - Y) ^ 4 - 2 * X2 * Y + X3 * X4 * Y ^ (X4 - 1))\n\n    Ynext = Y - DensityFunction / DensityFunctionPrime\n\n    If Abs(Ynext - Y) &lt;= 0.000000000001 Then\n    Z = ((0.06125 * Ppr * t) / Y) * Exp(-1.2 * (1 - t) ^ 2)\n\n    Else\n    Y = Ynext\n    End If\n\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1538526769, "post_id": 52618052, "comment_id": 92170389, "body": "The form is modeless, so I&#39;m confused as to what you mean by &quot;parent window&quot;. Is it just an issue with positioning the form?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1538526872, "post_id": 52618052, "comment_id": 92170413, "body": "what does &quot;and behaves like it&#39;s (sic) parent is the other workbook&quot; mean exactly? Also that <code>With</code> block is bloody misleading, once you realize that <code>With New</code> witholds an object reference that gets destroyed at <code>End With</code> (i.e. if you change your code to <code>With New</code>, form will be destroyed as soon as it&#39;s shown)."}, {"owner": {"reputation": 21, "user_id": 10448357, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rNrO1gVRr6M/AAAAAAAAAAI/AAAAAAAAAQs/3_lm2Ix6e0I/photo.jpg?sz=128", "display_name": "Mathew Stewart", "link": "https://stackoverflow.com/users/10448357/mathew-stewart"}, "edited": false, "score": 0, "creation_date": 1538527419, "post_id": 52618052, "comment_id": 92170510, "body": "No, not an issue with positioning the form.  If you click the &#39;other workbook&#39; on the task bar, the secondary userform gets focus.  I should click my workbook on the taskbar and the secondary userform should get focus. It goes like this: Open my userform on monitor 2&gt; Open other workbook on monitor 1&gt; Click a cell on monitor 1 workbook&gt; Now click button to open secondary userform on monitor 2&gt; Secondary userform will open on monitor 1 instead of monitor 2&gt; Clicking the other workbook on the task bar will give secondary userform focus indicating that its parent is the other userform"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1538527528, "post_id": 52618052, "comment_id": 92170529, "body": "Feel free to <a href=\"https://stackoverflow.com/posts/52618052/edit\">edit</a> your original question to clarify :)"}, {"owner": {"reputation": 21, "user_id": 10448357, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rNrO1gVRr6M/AAAAAAAAAAI/AAAAAAAAAQs/3_lm2Ix6e0I/photo.jpg?sz=128", "display_name": "Mathew Stewart", "link": "https://stackoverflow.com/users/10448357/mathew-stewart"}, "edited": false, "score": 0, "creation_date": 1538527774, "post_id": 52618052, "comment_id": 92170572, "body": "I&#39;m currently at home with no access to dual monitors otherwise I could maybe do a screen recording to show what I mean.  I apologize :("}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1538528080, "post_id": 52618052, "comment_id": 92170641, "body": "I think I replicated the behavior you&#39;re talking about. Do you have a reference to the correct workbook available when the form is being shown?"}, {"owner": {"reputation": 21, "user_id": 10448357, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rNrO1gVRr6M/AAAAAAAAAAI/AAAAAAAAAQs/3_lm2Ix6e0I/photo.jpg?sz=128", "display_name": "Mathew Stewart", "link": "https://stackoverflow.com/users/10448357/mathew-stewart"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1538528231, "post_id": 52618052, "comment_id": 92170673, "body": "Thanks @Comintern  I created a simple workbook with 2 userforms just for an example.  Userform1 has a button to open Userform2.  Follow the steps in my first comment and you should be able to recreate it."}, {"owner": {"reputation": 21, "user_id": 10448357, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rNrO1gVRr6M/AAAAAAAAAAI/AAAAAAAAAQs/3_lm2Ix6e0I/photo.jpg?sz=128", "display_name": "Mathew Stewart", "link": "https://stackoverflow.com/users/10448357/mathew-stewart"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1538528354, "post_id": 52618052, "comment_id": 92170698, "body": "@Comintern I&#39;m not entirely sure what you mean. I have tried this:     ThisWorkBook.Activiate  inside the with statement"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1538528397, "post_id": 52618052, "comment_id": 92170703, "body": "Right, but the question was whether you have the correct <code>Workbook</code> object available when you call <code>CommandButton1_Click()</code>. Like <code>Public theWBImTalkingAbout As Workbook</code>."}, {"owner": {"reputation": 21, "user_id": 10448357, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rNrO1gVRr6M/AAAAAAAAAAI/AAAAAAAAAQs/3_lm2Ix6e0I/photo.jpg?sz=128", "display_name": "Mathew Stewart", "link": "https://stackoverflow.com/users/10448357/mathew-stewart"}, "edited": false, "score": 0, "creation_date": 1538528504, "post_id": 52618052, "comment_id": 92170726, "body": "I do have a global variable called g_workbook that references my workbook but how do I use that when showing a userform?"}, {"owner": {"reputation": 21, "user_id": 10448357, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rNrO1gVRr6M/AAAAAAAAAAI/AAAAAAAAAQs/3_lm2Ix6e0I/photo.jpg?sz=128", "display_name": "Mathew Stewart", "link": "https://stackoverflow.com/users/10448357/mathew-stewart"}, "edited": false, "score": 0, "creation_date": 1538528793, "post_id": 52618052, "comment_id": 92170785, "body": "My apologies to everyone again.  It&#39;s very hard to explain with just text and the userform works great regardless.  It&#39;s just gives the appearance of being unprofessional when the user has windows popping up across random monitors."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1538529203, "post_id": 52618052, "comment_id": 92170874, "body": "No worries - if it&#39;s any consolation, half the time my Remote Desktop session authenticates on one monitor, and opens on the other. It&#39;s not sloppy coding on your part."}, {"owner": {"reputation": 156, "user_id": 8628774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g9985.jpg?s=128&g=1", "display_name": "JohnDunsmuir", "link": "https://stackoverflow.com/users/8628774/johndunsmuir"}, "edited": false, "score": 0, "creation_date": 1605882645, "post_id": 52618052, "comment_id": 114796399, "body": "I was having a similar problem and found this post. It was somewhat helpful. Some testing revealed that the controls in a modeless UserForm refer to the currently ActiveWorkbook  and not the Workbook that created the modeless UF. Including a &quot;ThisWorkbook.Activate&quot; at the top of the CommandButton event handler changed the focus back to the workbook that created the modeless UF and drew the UF in that sheet.  I hope this helps. Yes, this is hard to explain."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 10448357, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rNrO1gVRr6M/AAAAAAAAAAI/AAAAAAAAAQs/3_lm2Ix6e0I/photo.jpg?sz=128", "display_name": "Mathew Stewart", "link": "https://stackoverflow.com/users/10448357/mathew-stewart"}, "edited": false, "score": 0, "creation_date": 1538531061, "post_id": 52618556, "comment_id": 92171275, "body": "Thanks @Comintern  This looks interesting.  I will try it tomorrow when I get to my desk and accept this answer if I can get this to work.  Thank you all for your time and if anyone else has some suggestions they are very welcome."}, {"owner": {"reputation": 21, "user_id": 10448357, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rNrO1gVRr6M/AAAAAAAAAAI/AAAAAAAAAQs/3_lm2Ix6e0I/photo.jpg?sz=128", "display_name": "Mathew Stewart", "link": "https://stackoverflow.com/users/10448357/mathew-stewart"}, "edited": false, "score": 0, "creation_date": 1538562382, "post_id": 52618556, "comment_id": 92183177, "body": "This worked but with some strange side effects.  None of the comboboxes on the secondary userform will populate (the code to populate the comboboxes runs but nothing updates on the window).  Gonna play around with this idea a bit more."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 1, "last_activity_date": 1538530670, "creation_date": 1538530670, "answer_id": 52618556, "question_id": 52618052, "link": "https://stackoverflow.com/questions/52618052/userform-opening-on-wrong-workbook/52618556#52618556", "title": "Userform opening on wrong workbook", "body": "<p>If you have a reference to the <code>Workbook</code> that you want to set the form's parent to, you only need the two window handles to pass to <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/winuser/nf-winuser-setparent\" rel=\"nofollow noreferrer\"><code>SetParent</code></a>.  For the <code>Workbook</code>, you can simply use your <code>g_workbook</code> variable to get it's <code>Window</code>, which exposes an <code>Hwnd</code> property.</p>\n\n<p>For the <code>UserForm</code>, you'll need to use a second API call (<a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/winuser/nf-winuser-findwindowa\" rel=\"nofollow noreferrer\"><code>FindWindow</code></a>). Just pass it the caption of your window (and optionally the class if you're worried about it not being unique) and it returns its window handle. Put this in the declarations at the top of the module:</p>\n\n<pre><code>#If VBA7 Then\n    Private Declare PtrSafe Function SetParent Lib \"user32\" ( _\n        ByVal hWndChild As Long, _\n        ByVal hWndNewParent As Long) As Long\n\n    Private Declare PtrSafe Function FindWindow Lib \"user32\" Alias \"FindWindowA\" _\n        (ByVal lpClassName As String, _\n        ByVal lpWindowName As String) As Long\n#Else\n    Private Declare Function SetParent Lib \"user32\" ( _\n        ByVal hWndChild As Long, _\n        ByVal hWndNewParent As Long) As Long\n\n    Private Declare Function FindWindow Lib \"user32\" Alias \"FindWindowA\" _\n        (ByVal lpClassName As String, _\n        ByVal lpWindowName As String) As Long\n#End If\n</code></pre>\n\n<p>Then, make the call to <code>SetParent</code> before you show the form:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    With New UserForm2\n        .StartUpPosition = 0\n\n        Dim host As Window\n        Set host = g_workbook.Windows(1)\n        'You can also calculate these on the host position if you want.\n        .Left = Application.Left + (0.5 * Application.Width) - (0.5 * .Width)\n        .Top = Application.Top + (0.5 * Application.Height) - (0.5 * .Height)\n\n        Dim handle As Long\n        handle = FindWindow(vbNullString, .Caption)\n        SetParent handle, host.Hwnd\n\n        .Show vbModeless\n    End With\nEnd Sub\n</code></pre>\n\n<p>As you speculated in the question, this seems to work at sorting the focus out. Whether or not it is <em>stable</em> is a different question - it's conceivable that if you set the parent to the wrong workbook that closing the new parent workbook could cause unintended behavior. </p>\n"}], "owner": {"reputation": 21, "user_id": 10448357, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rNrO1gVRr6M/AAAAAAAAAAI/AAAAAAAAAQs/3_lm2Ix6e0I/photo.jpg?sz=128", "display_name": "Mathew Stewart", "link": "https://stackoverflow.com/users/10448357/mathew-stewart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 653, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1538530670, "creation_date": 1538525733, "question_id": 52618052, "link": "https://stackoverflow.com/questions/52618052/userform-opening-on-wrong-workbook", "title": "Userform opening on wrong workbook", "body": "<p>I have a userform that has a command button to open another userform.  This works well most of the time but there is a particular scenario where it does not work at all.  </p>\n\n<p>The users of said userforms typically work on multiple monitors and also have multiple workbooks open. These other workbooks are not associated with my workbook.</p>\n\n<p>If the user is working in another workbook on monitor 1 and then clicks the button to open the secondary userform on monitor 2, the secondary userform opens on monitor 1 and behaves like it's parent is the other workbook.  To correct this behavior, the user needs to click a cell on monitor 2's workbook and then click the button to open the secondary userform.  So it seems to be a workbook activation issue but this is not the case. </p>\n\n<p>I have tried different methods of activating the correct workbook before showing the secondary userform with code to no avail.</p>\n\n<p>Here's the basic code I use to launch the secondary userform when the button is clicked:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    With UserForm2\n        .StartUpPosition = 0\n        .Left = Application.Left + (0.5 * Application.Width) - (0.5 * .Width)\n        .Top = Application.Top + (0.5 * Application.Height) - (0.5 * .Height)\n        .Show vbModeless\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>I found this thinking I just need to explicitly set the userforms parent window before showing it but the userform will not open at all with this code:\n<a href=\"http://www.cpearson.com/excel/SetParent.aspx\" rel=\"nofollow noreferrer\">http://www.cpearson.com/excel/SetParent.aspx</a></p>\n\n<p>I hope this makes sense.  It's kind of hard to explain.</p>\n"}, {"tags": ["excel", "vba", "sap-gui"], "comments": [{"owner": {"reputation": 98, "user_id": 3230453, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/COYUq.jpg?s=128&g=1", "display_name": "Ricky", "link": "https://stackoverflow.com/users/3230453/ricky"}, "edited": false, "score": 1, "creation_date": 1538552022, "post_id": 52617995, "comment_id": 92177524, "body": "Look into properly using &quot;Declare Sub Sleep Lib &quot;kernel32&quot; (ByVal dwMilliseconds As Long)&quot; alond with &quot;DoEvents&quot;.  Always a life saver for me."}, {"owner": {"reputation": 47, "user_id": 9469075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62d1d83deccfdeb85342c0b6b860dd48?s=128&d=identicon&r=PG&f=1", "display_name": "RK144", "link": "https://stackoverflow.com/users/9469075/rk144"}, "reply_to_user": {"reputation": 98, "user_id": 3230453, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/COYUq.jpg?s=128&g=1", "display_name": "Ricky", "link": "https://stackoverflow.com/users/3230453/ricky"}, "edited": false, "score": 0, "creation_date": 1538585320, "post_id": 52617995, "comment_id": 92197222, "body": "Hi Ricky, Thanks for help. I am not expert in VBA. Could you please explain how can resolve this with your solution."}, {"owner": {"reputation": 98, "user_id": 3230453, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/COYUq.jpg?s=128&g=1", "display_name": "Ricky", "link": "https://stackoverflow.com/users/3230453/ricky"}, "edited": false, "score": 0, "creation_date": 1538636045, "post_id": 52617995, "comment_id": 92213838, "body": "I have updated your code but it says it is under peer review until it post. If it does not update by tomorrow i will figure a new route. I gave you a good head start but i did not do all the leg work.  That is the fun part of learning.  I hope it gets posted soon.  Have a great evening!"}, {"owner": {"reputation": 47, "user_id": 9469075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62d1d83deccfdeb85342c0b6b860dd48?s=128&d=identicon&r=PG&f=1", "display_name": "RK144", "link": "https://stackoverflow.com/users/9469075/rk144"}, "reply_to_user": {"reputation": 98, "user_id": 3230453, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/COYUq.jpg?s=128&g=1", "display_name": "Ricky", "link": "https://stackoverflow.com/users/3230453/ricky"}, "edited": false, "score": 0, "creation_date": 1538662652, "post_id": 52617995, "comment_id": 92229829, "body": "Hi Ricky,Sorry for that, I tried with whatever you said in first comment, but still i am getting issue. It may because of wrong placement. So that i asked you. thanks for help. I am waiting for updated code. Hope it will post soon."}, {"owner": {"reputation": 98, "user_id": 3230453, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/COYUq.jpg?s=128&g=1", "display_name": "Ricky", "link": "https://stackoverflow.com/users/3230453/ricky"}, "edited": false, "score": 0, "creation_date": 1538670988, "post_id": 52617995, "comment_id": 92234935, "body": "Your biggest issue is the simple one actually.  You have turned off everything and not turned it back on. at the bottom of your code add the following but change false to true     With Application                                                                      .ScreenUpdating = True    .DisplayAlerts = True    .AskToUpdateLinks = True                                                                        end with"}, {"owner": {"reputation": 47, "user_id": 9469075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62d1d83deccfdeb85342c0b6b860dd48?s=128&d=identicon&r=PG&f=1", "display_name": "RK144", "link": "https://stackoverflow.com/users/9469075/rk144"}, "reply_to_user": {"reputation": 98, "user_id": 3230453, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/COYUq.jpg?s=128&g=1", "display_name": "Ricky", "link": "https://stackoverflow.com/users/3230453/ricky"}, "edited": false, "score": 0, "creation_date": 1538672157, "post_id": 52617995, "comment_id": 92235548, "body": "Great!!!Thank you so much.. i forgot to do that.. and i included your sugessions (Kernel32 and Do events).. now it is working fine.once again thank you very much."}], "answers": [{"tags": [], "owner": {"reputation": 98, "user_id": 3230453, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/COYUq.jpg?s=128&g=1", "display_name": "Ricky", "link": "https://stackoverflow.com/users/3230453/ricky"}, "is_accepted": false, "score": 0, "last_activity_date": 1538672466, "creation_date": 1538672466, "answer_id": 52652005, "question_id": 52617995, "link": "https://stackoverflow.com/questions/52617995/macro-code-is-not-waiting-until-file-load-from-sap/52652005#52652005", "title": "Macro code is not waiting until file load from SAP", "body": "<p>I will just make an example.  Since i guess my edit a little over board and i respect this site is here to teach not just have people do all the work for someone. More so guide them so they actually learn what all the changes i made mean and why i did them.</p>\n\n<pre><code>'This is the fun stuff using your computer to sleep in milliseconds. Since we are teaching and i am not going to assume anything. Here is the code for both versions of excel.\n\n'Declare PtrSafe Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As LongPtr)' API Call for 64bit excel\nDeclare Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As Long) ' API Call for 32bit excel\n\n' This is turning off all your screen update functions\n\nWith Application\n     .ScreenUpdating = False\n     .DisplayAlerts = False\n     .AskToUpdateLinks = False\nEnd with\n\n' Add Code here\n' You can remove your application.wait and try\n\nSleep 100  ' this is milliseconds so you may have to fine tune it by adding more time or less\nDoevents ' Doevents lets the macro keep running and will keep \"Not Responding\" from showing up at the top of your workbook.\n\nBeforeExit: ' I always add a BeforeExit: So i Don't forget to turn my settings back on to see my hard work\n\nSet objShell = nothing ' It is good practice to always release your objects as well\n\nWith Application\n     .ScreenUpdating = true\n     .DisplayAlerts = true\n     .AskToUpdateLinks = true\nEnd with\n</code></pre>\n\n<p>Can you explain to me a little about SAP?  I see your code and i see your calling keys which i am not sure if that is for SAP or excel.  It is not good practice if you can avoid it to ever call keyboard functions.</p>\n"}], "owner": {"reputation": 47, "user_id": 9469075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62d1d83deccfdeb85342c0b6b860dd48?s=128&d=identicon&r=PG&f=1", "display_name": "RK144", "link": "https://stackoverflow.com/users/9469075/rk144"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 929, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1602928192, "creation_date": 1538525155, "last_edit_date": 1602928192, "question_id": 52617995, "link": "https://stackoverflow.com/questions/52617995/macro-code-is-not-waiting-until-file-load-from-sap", "title": "Macro code is not waiting until file load from SAP", "body": "<p>I am trying to get export from SAP. Once export done, i need to close the export file.I have written below code to execute the same thing, but my problem is that code is not waiting until file gets load and it is skipping the export file close. kindly help me to sort out this problem.</p>\n\n<pre><code>   Sub FBL5N()\n\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n    Application.AskToUpdateLinks = False\n\n    Dim sApplication\n    Dim session\n    Dim file As String\n    Dim objShell As Object\n    Dim strFolder As String\n    Dim wb As Workbook\n    Dim wbk As Workbook\n    Dim ws As Worksheet\n    Dim lrw As Integer\n    Dim Wshell As Object\n\n    Set objShell = CreateObject(\"Wscript.Shell\")\n    strFolder = objShell.SpecialFolders(\"mydocuments\") &amp; \"\\Temp\\\"\n\n    file = strFolder &amp; \"\\ARREPORT.xlsx\"\n    If FileExists(file) Then 'See above\n     SetAttr file, vbNormal\n     On Error Resume Next\n        Kill file\n        On Error Resume Next\n    End If\n\n\n    If Not IsObject(sApplication) Then\n       Set SapGuiAuto = GetObject(\"SAPGUI\")\n       Set sApplication = SapGuiAuto.GetScriptingEngine\n    End If\n\n    If Not IsObject(Connection) Then\n       Set Connection = sApplication.Children(0)\n    End If\n    If Not IsObject(session) Then\n       Set session = Connection.Children(0)\n    End If\n    If IsObject(wscript) Then\n       wscript.ConnectObject session, \"on\"\n       wscript.ConnectObject sApplication, \"on\"\n    End If\n\n    session.findById(\"wnd[0]/tbar[0]/okcd\").Text = \"/nFBL5N\"\n    session.findById(\"wnd[0]\").sendVKey 0\n    session.findById(\"wnd[0]/usr/ctxtDD_KUNNR-LOW\").Text = ThisWorkbook.Sheets(\"Formulated\").Range(\"R9\")\n    session.findById(\"wnd[0]/usr/ctxtDD_KUNNR-HIGH\").Text = ThisWorkbook.Sheets(\"Formulated\").Range(\"R10\")\n    session.findById(\"wnd[0]/usr/ctxtDD_BUKRS-LOW\").Text = ThisWorkbook.Sheets(\"Formulated\").Range(\"R8\")\n    session.findById(\"wnd[0]/usr/ctxtPA_STIDA\").Text = ThisWorkbook.Sheets(\"Formulated\").Range(\"R11\")\n    session.findById(\"wnd[0]/usr/ctxtPA_VARI\").Text = ThisWorkbook.Sheets(\"Formulated\").Range(\"R12\")\n    session.findById(\"wnd[0]/usr/ctxtPA_VARI\").SetFocus\n    session.findById(\"wnd[0]/usr/ctxtPA_VARI\").caretPosition = 12\n    session.findById(\"wnd[0]/mbar/menu[0]/menu[0]\").Select\n    session.findById(\"wnd[0]/mbar/menu[0]/menu[3]/menu[1]\").Select\n    session.findById(\"wnd[1]/usr/ctxtDY_PATH\").Text = strFolder\n    session.findById(\"wnd[1]/usr/ctxtDY_FILENAME\").Text = \"export.xlsx\"\n    session.findById(\"wnd[1]\").sendVKey 0\n    Application.Wait Now() + TimeValue(\"00:00:01\")\n\n    For Each wb In Application.Workbooks\n    If wb.Name = \"export.xlsx\" Then\n    wb.Close\n     End If\n     Next wb\n     End Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 704, "user_id": 4999393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae8b5ed2ea0bdebd8989c9122f6c7c22?s=128&d=identicon&r=PG&f=1", "display_name": "Jericho Johnson", "link": "https://stackoverflow.com/users/4999393/jericho-johnson"}, "edited": false, "score": 0, "creation_date": 1538530616, "post_id": 52617970, "comment_id": 92171162, "body": "Please provide more information and clarity. Please see <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>. Please provide the code that is having the problem, indicate which line of code is getting an error, and include the error number and full description.  The hWnd of a Form or Report will not change unless it is closed and reopened.  More details please and we might be able to help you."}, {"owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 0, "creation_date": 1538565425, "post_id": 52617970, "comment_id": 92184877, "body": "Have you used the inbuilt navigation controls to build your form? If so they silently &quot;unload&quot; any pages not being displayed, so you would lose your form references."}, {"owner": {"reputation": 61, "user_id": 1057008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a47a3ace619f463786616bf653f59a8?s=128&d=identicon&r=PG", "display_name": "tbk", "link": "https://stackoverflow.com/users/1057008/tbk"}, "edited": false, "score": 0, "creation_date": 1538613217, "post_id": 52617970, "comment_id": 92207744, "body": "I know that the description may not entire help. I cant provide a code example right now but I replicated the  problem. I built a single form with just two child controls that loads a &quot;sidebar&quot; form and a subreport. When I apply a filter to the subreport both child contols reload an new instance of themselves with a new Hwnd. I assume that this is native acces behavior. Thus I dont understand why it reloads all child controls instead of only the one the filter is applied. I just used an another approach with queries instead of applying filters to get rid of this behavior."}], "owner": {"reputation": 61, "user_id": 1057008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a47a3ace619f463786616bf653f59a8?s=128&d=identicon&r=PG", "display_name": "tbk", "link": "https://stackoverflow.com/users/1057008/tbk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594627983, "creation_date": 1538524878, "last_edit_date": 1594627983, "question_id": 52617970, "link": "https://stackoverflow.com/questions/52617970/ms-access-subform-hwnd-reference", "title": "MS Access Subform HWnd Reference", "body": "<p>Iam building a basic database for a friend oriented to have a simple and intuitive GUI.\nFor this purpose I have a main form with a Tab control in which each page has two subform controls.\nIn the first subform a single form with buttons is loaded to serve as a sidebar while in the second subform loads a requested continuous form or report.\nI have noticed that when I load a report to the second subform and apply a filter to it I cannot reference functions that reside within the single form that serves as a sidebar.\nThis is reflected also to a textbox control on the sidebar included for search purposes that loses its value in the time the filter is applied.\nWhat I have managed to track down is that when the filter is applied to the subreport the subform control with the sidebar Hwnd property changes.</p>\n\n<p>Any ideas why this happens ?</p>\n"}, {"tags": ["excel", "vba", "combobox"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1538524034, "post_id": 52617822, "comment_id": 92169842, "body": "<code>Range.Value</code> returns a 2D array, try to <code>Application.Transpose</code> that 2D array before you assign it to <code>ComboBox.List</code>. Or, <code>Set</code> the <code>.ListSource</code> to the <code>.Range</code> itself (rather than its value)."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1538525086, "post_id": 52617822, "comment_id": 92170058, "body": "Why are you not setting the <code>.Text</code> and <code>.List</code> inside the <code>With</code> block anyway?"}], "owner": {"reputation": 33, "user_id": 8502702, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-UyQ9Sb9EjWU/AAAAAAAAAAI/AAAAAAAACZY/gHsA3B6YY-U/photo.jpg?sz=128", "display_name": "suresh LakshmiNarayanan", "link": "https://stackoverflow.com/users/8502702/suresh-lakshminarayanan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1538523806, "creation_date": 1538523535, "last_edit_date": 1538523806, "question_id": 52617822, "link": "https://stackoverflow.com/questions/52617822/how-to-text-and-list-properties-for-a-dynamic-combo-box-together-in-excel-vba", "title": "How to text and list properties for a dynamic combo box together in excel VBA", "body": "<p>I am creating dynamic combo boxes in excel VBA. I tried to add a range of cells as list for these dynamic combo boxes and it was working fine.</p>\n\n<p>when I tried to keep combobox.text as some value and use the above range as list, the selected value  is getting displayed. but the list is not getting populated in the combobox</p>\n\n<pre><code>For i = 1 To 10 \n\n        Set Cmb = Me.Controls.Add(\"Forms.combobox.1\")\n        With Cmb\n            .Name = \"Combobox\" &amp; i\n            .Left = 166\n            .Width = 136\n            If i = 1 Then\n                .Top = 134\n            Else\n                .Top = 134 + (24 * (i - 1))\n            End If\n        End With\n        Me.Controls(\"ComboBox\" &amp; i).Text = \"some value\"      \nMe.Controls(\"ComboBox\" &amp; i).List = wb1.Worksheets(\"Sheet1\").Range(\"B2:B110\").Value\n\nNext i\n</code></pre>\n"}, {"tags": ["vba", "excel", "dictionary", "global-variables"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1538522179, "post_id": 52617620, "comment_id": 92169455, "body": "?Set Dict as New Dictionary"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1538522225, "post_id": 52617620, "comment_id": 92169471, "body": "The variable can be global, but the initialization can&#39;t - that has to be inside a procedure. I&#39;d suggest a private <code>Function</code> that <i>returns</i> the filled <code>Dictionary</code> if the initialization is always the same."}, {"owner": {"reputation": 608, "user_id": 10359850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/314f9e3843a501691b71bcea4d44e4b9?s=128&d=identicon&r=PG&f=1", "display_name": "R. Arctor", "link": "https://stackoverflow.com/users/10359850/r-arctor"}, "edited": false, "score": 0, "creation_date": 1538522941, "post_id": 52617620, "comment_id": 92169624, "body": "Ah that makes sense! Follow up question, if the private function returns the filled dictionary I need to call it inside the sub where I need the dictionary right? Or would running it once be enough to initialize the global variable?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1538523828, "post_id": 52617620, "comment_id": 92169802, "body": "@Jeeped It was based on this sentence in the question that implied the OP was trying to use <code>Dict.Add</code> outside a procedure: &quot;Just putting Dict.Add before any of the subs doesn&#39;t seem to work, I get a compile error: Invalid outside procedure.&quot;  Based on that, it&#39;s absolutely correct."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1538523866, "post_id": 52617620, "comment_id": 92169813, "body": "@Comintern, Ah yes, I get it now. My bad."}], "answers": [{"comments": [{"owner": {"reputation": 608, "user_id": 10359850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/314f9e3843a501691b71bcea4d44e4b9?s=128&d=identicon&r=PG&f=1", "display_name": "R. Arctor", "link": "https://stackoverflow.com/users/10359850/r-arctor"}, "edited": false, "score": 0, "creation_date": 1538523438, "post_id": 52617732, "comment_id": 92169723, "body": "I need vbTextCompare for some comparisons that aren&#39;t dictionary related so your first answer seems to work fine. I probably shouldn&#39;t have included it in the question to avoid confusion.  I&#39;m not overly experienced using VBA, one of the commenters suggested using a private function which returns the filled dictionary. Is there an advantage to using a Sub instead? Or any particular reason why you used a Sub?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 608, "user_id": 10359850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/314f9e3843a501691b71bcea4d44e4b9?s=128&d=identicon&r=PG&f=1", "display_name": "R. Arctor", "link": "https://stackoverflow.com/users/10359850/r-arctor"}, "edited": false, "score": 0, "creation_date": 1538523587, "post_id": 52617732, "comment_id": 92169754, "body": "I suppose it (sub vs function) is a matter of personal choice. I only use functions when I want to return a calculated value. Using a function to populate a public dictionary without even returning the count seems like more of a job for a sub."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 0, "last_activity_date": 1538523233, "last_edit_date": 1538523233, "creation_date": 1538522917, "answer_id": 52617732, "question_id": 52617620, "link": "https://stackoverflow.com/questions/52617620/declaring-and-filling-a-globel-level-dictionary-variable-in-vba/52617732#52617732", "title": "Declaring and filling a globel level dictionary variable in VBA", "body": "<p>Assuming you've added Microsoft Scripting Runtime to the project references, this should work.</p>\n\n<pre><code>Option Explicit\nOption Compare Text\nPublic Dict As New Scripting.Dictionary\n\nSub d1()\n    Dict.Item(1) = 2\nEnd Sub\n\nSub da()\n    Dict.Item(\"a\") = \"b\"\nEnd Sub\n</code></pre>\n\n<p>However, if you are expecting your public dictionary to have a dict.CompareMode of vbTextCompare, you would be wrong. The CompareMode property would be vbBinaryCompare and the CompareMode can only be set on an empty dictionary.</p>\n\n<p>If you require vbTextCompare for your dictionary, then perhaps something like this.</p>\n\n<pre><code>Option Explicit\nOption Compare Text\nPublic Dict As New Scripting.Dictionary\n\nSub d1()\n    if dict.count = 0 then dict.comparemode = vbtextcompare\n    Dict.Item(1) = 2\nEnd Sub\n\nSub da()\n    if dict.count = 0 then dict.comparemode = vbtextcompare\n    Dict.Item(\"a\") = \"b\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 608, "user_id": 10359850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/314f9e3843a501691b71bcea4d44e4b9?s=128&d=identicon&r=PG&f=1", "display_name": "R. Arctor", "link": "https://stackoverflow.com/users/10359850/r-arctor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 52617732, "answer_count": 1, "score": -1, "last_activity_date": 1538523233, "creation_date": 1538521883, "question_id": 52617620, "link": "https://stackoverflow.com/questions/52617620/declaring-and-filling-a-globel-level-dictionary-variable-in-vba", "title": "Declaring and filling a globel level dictionary variable in VBA", "body": "<p>So I have a dictionary that contains the same keys and values in two different subs in a module. That is to say there's some repeated code in the subs namely: Dim Dict As Scripting.Dictionary and Dict.Add Key, Value to fill it. I thought I should instead make the dictionary a global/module level variable, but am having trouble figuring out how to fill the dictionary at the larger scope.</p>\n\n<p>The start of my module looks like:</p>\n\n<pre><code>Option Explicit\nOption Compare Text ' for some other stuff I need to do\nPublic Dict As Scripting.Dictionary\n</code></pre>\n\n<p>Just putting Dict.Add before any of the subs doesn't seem to work, I get a compile error: Invalid outside procedure.</p>\n\n<p>Any tips or tricks would be much appreciated!</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2016"], "comments": [{"owner": {"reputation": 3725, "user_id": 6777839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YYN3g.jpg?s=128&g=1", "display_name": "Wolfgang Kais", "link": "https://stackoverflow.com/users/6777839/wolfgang-kais"}, "edited": false, "score": 1, "creation_date": 1538526196, "post_id": 52617380, "comment_id": 92170276, "body": "The RecordSource of your form in fact <b>IS</b> a query. And yes, if your form is &quot;complicated&quot; and contains several pages with multiple controls,maybe comboboxes that also have RecordSources, it might take a little time to &quot;load&quot; the form into memory until it can be seen as an <i>object</i> that can be manipulated via vba code."}, {"owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 0, "creation_date": 1538543401, "post_id": 52617380, "comment_id": 92173866, "body": "To further Wolfgang&#39;s comment, you likely cannot determine much more about what&#39;s happening, because (to my knowledge) Access provides no hooks to its internal processes.  The object properties and event handlers are about all you got.  The status bar messages are a bonus that gives you a peak into what it&#39;s doing in the mean time.  The database engine is not like other advanced DBM&#39;s with profilers and tracers.  Likewise, the Access programming interfaces are based on antiquated COM interfaces and automation."}], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1538552229, "creation_date": 1538552229, "answer_id": 52622042, "question_id": 52617380, "link": "https://stackoverflow.com/questions/52617380/docmd-openform-takes-a-long-time-to-trigger-the-form-load-event-says-query-runn/52622042#52622042", "title": "DoCmd.OpenForm takes a long time to trigger the Form_Load Event, says query running (Access 2016)", "body": "<blockquote>\n  <p>The form should ideally leave the DoCmd statement and hit the MAIN\n  Form__Load event immediately. The issue is it takes a few seconds for\n  the code to reach the beginning of MAIN_Load and I am unsure why.</p>\n</blockquote>\n\n<p>No. It should hit the <em>OnOpen</em> immediately, then load the form. Loading the form means reading the record source(s) of the form, its subforms, and controls. </p>\n\n<p>And <em>a few seconds</em> is certainly what to expect for this process.</p>\n"}], "owner": {"reputation": 1, "user_id": 10426992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ada7b71ad5eea5b084ee41cce5e5516?s=128&d=identicon&r=PG&f=1", "display_name": "Jessica Smith", "link": "https://stackoverflow.com/users/10426992/jessica-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1538552229, "creation_date": 1538519883, "last_edit_date": 1538551837, "question_id": 52617380, "link": "https://stackoverflow.com/questions/52617380/docmd-openform-takes-a-long-time-to-trigger-the-form-load-event-says-query-runn", "title": "DoCmd.OpenForm takes a long time to trigger the Form_Load Event, says query running (Access 2016)", "body": "<p>I have a Menu Form. When the User selects the button 'Main' it opens the form 'MAIN' as seen in the code below\nCode:</p>\n\n<pre><code>Private Sub Command0_Click()\n\nDoCmd.OpenForm \"MAIN\"\n\nEnd Sub\n</code></pre>\n\n<p>The form should ideally leave the DoCmd statement and hit the MAIN Form__Load event immediately. The issue is it takes a few seconds for the code to reach the beginning of MAIN_Load and I am unsure why. Inbetween this time the bottom of Access says 'Calculating . . .' and 'Running Query', although there is no code that requires a query to run when this is called. The RecordSource of MAIN is \"SELECT * FROM APN_Status\" which is just a table, no query involved. Does it just take a while cause my form is complicated (navigation control with multiple pages, some with navigation controls themselves.)</p>\n\n<p>How can I figure out what is happening between this event??</p>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1538542156, "post_id": 52616986, "comment_id": 92173555, "body": "Unfortunately, you don&#39;t really ask a question, or describe exactly what the problem is with what you&#39;ve attempted. Could you please use the <a href=\"https://stackoverflow.com/posts/52616986/edit\">edit</a> link to add a description of the result your getting and the result you want."}, {"owner": {"reputation": 45, "user_id": 7663788, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/klPBQ.jpg?s=128&g=1", "display_name": "Richard Barnes", "link": "https://stackoverflow.com/users/7663788/richard-barnes"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1538602502, "post_id": 52616986, "comment_id": 92205189, "body": "I think it is clear (but I have been living this issue), but then you want a question: How do you add several Excel tables to a new Word document (one document) so that each has it&#39;s own page orientation as required by the table?"}, {"owner": {"reputation": 45, "user_id": 7663788, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/klPBQ.jpg?s=128&g=1", "display_name": "Richard Barnes", "link": "https://stackoverflow.com/users/7663788/richard-barnes"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1538606169, "post_id": 52616986, "comment_id": 92206283, "body": "There is an edit to the original text, thank you..."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 7663788, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/klPBQ.jpg?s=128&g=1", "display_name": "Richard Barnes", "link": "https://stackoverflow.com/users/7663788/richard-barnes"}, "edited": false, "score": 0, "creation_date": 1538793746, "post_id": 52667321, "comment_id": 92279903, "body": "Thank you very much. I used your code within the CASE statements as is, I  just added the &quot;rngNewTable.InsertBreak Type:=wdSectionBreakNextPage&quot; statement at the end. I was unfamiliar with the Collapse method so that helped, too. I am sorry that I only uploaded that &quot;short&quot; piece of code, but the rest of the loop was about 40 extra lines. Regardless, you got it right. Now I can concentrate on removing the unnecessary and redundant code which remains."}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 0, "last_activity_date": 1538747975, "creation_date": 1538747975, "answer_id": 52667321, "question_id": 52616986, "link": "https://stackoverflow.com/questions/52616986/set-the-page-orientation-when-exporting-an-excel-table-to-word/52667321#52667321", "title": "Set the page orientation when exporting an Excel table to Word", "body": "<p>Since you haven't provided a [mcve] I'm not able to work directly with your code. Below is my test code - you should be able to adapt it to your exact scenario. There'd be more than one way to approach the task, but I've tried to stay as close to your original approach as possible.</p>\n\n<p>Note that I've added the object variable <code>rngNewTable</code> - a <code>Word.Range</code> object. This helps better track exactly where things need to happen in the document (same as in Excel, really). <code>Document.Content</code> provides a good reference Range, but it's not \"adaptable\" to identify a particular point or area.</p>\n\n<p>I've also added a variable to store the current page orientation. There's no need to repeat certain actions if the orientation is already correct, so this is used to test the current orientation. (Actually, you wouldn't even need separate sections for each table if the orientation doesn't change - but I don't know the complete logic of what's going on, so haven't changed that.)</p>\n\n<p>Pasting the table is now at the end of each loop and could be outside the <code>Select</code>, but I leave that decision to you. You'll also need to replace my <code>For...Next</code> with your own logic.</p>\n\n<p>The way this basically works is to <em>collapse</em> / set the end of the target <code>Range</code> after each insertion (whether of table or section break) so that it's always <em>after</em> the new material.</p>\n\n<pre><code>Sub InsertTableWithPageOrientation()\n    Dim newDoc As Word.Document\n    Dim intDoc(3) As Long, iCounter As Long\n    Dim rngNewTable As Word.Range\n    Dim iCurrPageOrientation As Long\n    Dim wordTbl\n\n    Set newDoc = ActiveDocument\n    With newDoc\n        .ActiveWindow.View.ShowAll = False ' Hide all formatting marks\n        .ActiveWindow.View.ShowHiddenText = False ' Hide all  hidden text\n        Set rngNewTable = newDoc.content\n        rngNewTable.Collapse wdCollapseEnd\n        iCurrPageOrientation = .PageSetup.Orientation\n    End With\n    intDoc(0) = 1\n    intDoc(1) = 2\n    intDoc(2) = 3\n    intDoc(3) = 4\n    For iCounter = LBound(intDoc) To UBound(intDoc)\n        rngNewTable.InsertBreak Type:=wdSectionBreakNextPage   'wdPageBreak\n        rngNewTable.Start = newDoc.content.End\n        Select Case intDoc(iCounter)  ' set the Word pages based on the selected document\n            Case 1, 4, 5, 6 ' Estimate(1), Invoice(4), Scope of Work--&gt;Orientation = wdOrientPortrait\n                ' paste the table into the newDoc and set some options\n                If iCurrPageOrientation &lt;&gt; wdOrientPortrait Then\n                    With rngNewTable.Sections(1).PageSetup\n                        .Orientation = wdOrientPortrait\n                        .RightMargin = Application.InchesToPoints(0.75)\n                        .LeftMargin = Application.InchesToPoints(0.75)\n                        iCurrPageOrientation = wdOrientPortrait\n                    End With\n                End If\n                rngNewTable.PasteExcelTable LinkedToExcel:=false, WordFormatting:=False, RTF:=True\n                rngNewTable.Start = newDoc.content.End\n            Case 2, 3  ' the Detail listing (2), or the Itemized listing(3)--&gt;Orientation = wdOrientLandscape\n                ' paste the table into the newDoc and set some options\n                If iCurrPageOrientation &lt;&gt; wdOrientLandscape Then\n                    With rngNewTable.Sections(1).PageSetup\n                        .Orientation = wdOrientLandscape\n                        .RightMargin = Application.InchesToPoints(0.5)\n                        .LeftMargin = Application.InchesToPoints(0.5)\n                        iCurrPageOrientation = wdOrientLandscape\n                    End With\n                End If\n                rngNewTable.PasteExcelTable LinkedToExcel:=false, WordFormatting:=False, RTF:=True\n                rngNewTable.Start = newDoc.content.End\n        End Select\n    Next\n    ' Autofit the table to the page\n    Set wordTbl = newDoc.Tables(newDoc.Tables.Count)\n    wordTbl.AutoFitBehavior (wdAutoFitWindow)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 7663788, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/klPBQ.jpg?s=128&g=1", "display_name": "Richard Barnes", "link": "https://stackoverflow.com/users/7663788/richard-barnes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 396, "favorite_count": 0, "accepted_answer_id": 52667321, "answer_count": 1, "score": 0, "last_activity_date": 1538747975, "creation_date": 1538517372, "last_edit_date": 1538605766, "question_id": 52616986, "link": "https://stackoverflow.com/questions/52616986/set-the-page-orientation-when-exporting-an-excel-table-to-word", "title": "Set the page orientation when exporting an Excel table to Word", "body": "<p>I have been struggling with the attached VBA code which tries to set the page orientation when exporting an Excel table to Word. It is easy enough to do for one table, but I am trying to export several tables some that should be portrait and others landscape. Switching from one format to the other within the new Word document is the issue. I have tried various ways to add section breaks, but I have failed to do anything close to what I want.</p>\n\n<p>The snippet below is run in a loop that exports each table as the form's control's are checked for a selection.</p>\n\n<p>The code depends on a user's selections on a form so they may differ each time. To be more easily read I have only included the code sections which actually deal with the new Word document (newDoc) formatting. What is shown is the last incarnation of the code, there have been many versions.</p>\n\n<p>What I need is a way to run the loop (and the attached code) so that each table is oriented according to its predetermined needs, either portrait or landscape in the new Word document.</p>\n\n<p><pre><code>Select Case intDoc  ' set the Word pages based on the selected document\n                Case 1, 4, 5, 6 ' Estimate(1), Invoice(4), Scope of Work-->Orientation = wdOrientPortrait\n                    ' paste the table into the newDoc and set some options\n                    With newDoc\n                        .ActiveWindow.View.ShowAll = False ' Hide all formatting marks\n                        .ActiveWindow.View.ShowHiddenText = False ' Hide all  hidden text\n                        .Paragraphs(.Paragraphs.Count).Range.PasteExcelTable LinkedToExcel:=False, WordFormatting:=False, RTF:=True\n                        .Content.InsertParagraphAfter\n                        .Range(.Content.End - 1).InsertBreak Type:=wdSectionBreakNextPage   'wdPageBreak\n                        With .PageSetup\n                            .Orientation = wdOrientPortrait\n                            .RightMargin = Application.InchesToPoints(0.75)\n                            .LeftMargin = Application.InchesToPoints(0.75)\n                        End With\n                     End With\n                    ' Autofit the table to the page\n                     Set wordTbl = newDoc.Tables(newDoc.Tables.Count)\n                     wordTbl.AutoFitBehavior (wdAutoFitWindow)</p>\n\n            Case 2, 3  ' the Detail listing (2), or the Itemized listing(3)--&gt;Orientation = wdOrientLandscape\n                ' paste the table into the newDoc and set some options\n                With newDoc\n                    .ActiveWindow.View.ShowAll = False ' Hide all formatting marks\n                    .ActiveWindow.View.ShowHiddenText = False ' Hide all  hidden text\n                    .Paragraphs(.Paragraphs.Count).Range.PasteExcelTable LinkedToExcel:=False, WordFormatting:=False, RTF:=True\n                    .Content.InsertParagraphAfter\n                    .Range(.Content.End - 1).InsertBreak Type:=wdSectionBreakNextPage   'wdPageBreak\n                    With .PageSetup\n                        .Orientation = wdOrientLandscape\n                        .RightMargin = Application.InchesToPoints(0.5)\n                        .LeftMargin = Application.InchesToPoints(0.5)\n                    End With\n                 End With\n                ' Autofit the table to the page\n                 Set wordTbl = newDoc.Tables(newDoc.Tables.Count)\n                 wordTbl.AutoFitBehavior (wdAutoFitWindow)\n        End Select\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 2, "creation_date": 1538517258, "post_id": 52616856, "comment_id": 92168055, "body": "Have you tried inserting one column at a time?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1538517333, "post_id": 52616856, "comment_id": 92168082, "body": "Do it one at a time and start with the furthest right column and work to the left."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1538521559, "post_id": 52616856, "comment_id": 92169308, "body": "I have to wonder why you declare a workbook var, set it to activeworkbook and then never use it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1538522493, "post_id": 52616856, "comment_id": 92169515, "body": "You don&#39;t have a <i>Ingredient_Forecast_Summary</i> worksheet in the active workbook. Simple as that. Misspelling, leading or trailing space, space instead of the underscore, etc. Perhaps you are confusing ActiveWorkbook with ThisWorkbook. The actual reason the <i>Ingredient_Forecast_Summary</i> worksheet cannot be found is unclear from this side of things. It&#39;s probably one of the above issues but it could be another."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 10355576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19645465905bf88a2cbdcc3ed27d4635?s=128&d=identicon&r=PG&f=1", "display_name": "Luke P", "link": "https://stackoverflow.com/users/10355576/luke-p"}, "edited": false, "score": 0, "creation_date": 1538588626, "post_id": 52618198, "comment_id": 92198906, "body": "Hey VBasic, This makes sense to me, but I&#39;m still running into the 1004 with your code. The sheet is not protected, and not read-only. It still points to the line with the actual insert command as the problem."}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "reply_to_user": {"reputation": 31, "user_id": 10355576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19645465905bf88a2cbdcc3ed27d4635?s=128&d=identicon&r=PG&f=1", "display_name": "Luke P", "link": "https://stackoverflow.com/users/10355576/luke-p"}, "edited": false, "score": 0, "creation_date": 1538599167, "post_id": 52618198, "comment_id": 92203907, "body": "Thx for the points, man, I &#39;ve stumbled upon a 1004 today and cannot solve it. I&#39;ll post a question and see where it gets me. Then I&#39;ll get back to you I guess in a couple of days."}], "tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": true, "score": 0, "last_activity_date": 1538527214, "creation_date": 1538527214, "answer_id": 52618198, "question_id": 52616856, "link": "https://stackoverflow.com/questions/52616856/how-to-insert-columns-separately/52618198#52618198", "title": "How to Insert Columns Separately", "body": "<h2>Fine For Now</h2>\n\n<p>What Jeeped meant was you should do something like this with your code:</p>\n\n<pre><code>Option Explicit\nSub Insert_Multiple_Columns()\n\n  Dim wbFIFA As Workbook\n  Dim wsIFS As Worksheet\n\n  Set wbFIFA = ActiveWorkbook\n  Set wsIFS = wbFIFA.Worksheets(\"Ingredient_Forecast_Summary\")\n  'Remarks\n  '  Now you can use wsIFS instead of:\n  '    ActiveWorkbook.Worksheets (\"Ingredient_Forecast_Summary\")\n  '    wbFIFA.Worksheets (\"Ingredient_Forecast_Summary\")\n\n  wsIFS.Range(\"H:H,K:K,N:N,Q:Q\").EntireColumn.Insert\n  'Remarks\n  '  The previous line has actually inserted the columns from the right to the\n  '  left i.e.\n  '  H:H gives you the H column\n  '  K:K gives you the L column\n  '  N:N gives you the P column\n  '  Q:Q gives you the T column\n\nEnd Sub\n</code></pre>\n\n<p>I created your scenario on my computer, and both codes worked just fine.</p>\n\n<h2>Later</h2>\n\n<p>When I deliberately misspelled the name of your worksheet, the error message was 'Subscript out of range (Error 9)'.</p>\n\n<p>When I opened another workbook which then became the ActiveWorkbook and started the sub, the error message was 'Subscript out of range (Error 9)' again.</p>\n\n<p>Then I changed the attributes of the workbook to read-only (stupid idea), but still only could get 'Error 9'.</p>\n\n<p>And then I stumbled upon a scenario that gave me your 'error 1004', namely I protected the worksheet and when I ran the code you know what happened.</p>\n\n<p>I hope this is the reason for your grief. If not, at least some possible reasons have been eliminated.</p>\n"}], "owner": {"reputation": 31, "user_id": 10355576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19645465905bf88a2cbdcc3ed27d4635?s=128&d=identicon&r=PG&f=1", "display_name": "Luke P", "link": "https://stackoverflow.com/users/10355576/luke-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 52618198, "answer_count": 1, "score": 0, "last_activity_date": 1538633218, "creation_date": 1538516673, "last_edit_date": 1538633218, "question_id": 52616856, "link": "https://stackoverflow.com/questions/52616856/how-to-insert-columns-separately", "title": "How to Insert Columns Separately", "body": "<p>I'm trying to have my macro insert columns after certain columns. From what I have read, I'm doing everything correctly, but I'm getting an </p>\n\n<blockquote>\n  <p>error 1004, </p>\n</blockquote>\n\n<p>and I haven't found anyone who has had the exact setup as me.</p>\n\n<p>From what I've seen, most people are inserting a column range: <code>.Range(\"H:Q\")</code>\nI Need to insert separate columns: <code>.Range(H:H,K:K,N:N,Q:Q)</code></p>\n\n<p>What am I doing wrong?</p>\n\n<pre><code>Option Explicit\n\nSub Insert_Multiple_Columns()\n    Dim FIFA As Workbook\n    Set FIFA = ActiveWorkbook\n\n    'Ingredient_Forecast_Summary is the sheet name.\n    Worksheets(\"Ingredient_Forecast_Summary\").Range(\"H:H,K:K,N:N,Q:Q\").EntireColumn.Insert\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5852, "user_id": 1690392, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/A3DKR.jpg?s=128&g=1", "display_name": "nutsch", "link": "https://stackoverflow.com/users/1690392/nutsch"}, "edited": false, "score": 3, "creation_date": 1538516103, "post_id": 52616658, "comment_id": 92167661, "body": "Have you tried unhiding the sheet in the <code>Worksheet_FollowHyperlink</code> event of the worksheet?"}, {"owner": {"reputation": 25, "user_id": 10416060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67e0d06787f8d0a6046876165c089f21?s=128&d=identicon&r=PG&f=1", "display_name": "Ranger9", "link": "https://stackoverflow.com/users/10416060/ranger9"}, "reply_to_user": {"reputation": 5852, "user_id": 1690392, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/A3DKR.jpg?s=128&g=1", "display_name": "nutsch", "link": "https://stackoverflow.com/users/1690392/nutsch"}, "edited": false, "score": 0, "creation_date": 1538519917, "post_id": 52616658, "comment_id": 92168865, "body": "@nutsch I tried adding a private sub Worksheet_FollowHyperlink (ByVal Target As Hyperlink) but I cant get it to work? Am I doing something obvious incorrectly?"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 10416060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67e0d06787f8d0a6046876165c089f21?s=128&d=identicon&r=PG&f=1", "display_name": "Ranger9", "link": "https://stackoverflow.com/users/10416060/ranger9"}, "edited": false, "score": 0, "creation_date": 1538523218, "post_id": 52617696, "comment_id": 92169674, "body": "thanks @comintern nothing was wrong with your answer I just couldnt figure out what I was doing incorrectly so was searching for more help...  I updated my question with a few changes I made. They have worked for me, unless you or anyone see&#39;s a potential issue with the way i&#39;ve written the script"}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 0, "last_activity_date": 1538522601, "creation_date": 1538522601, "answer_id": 52617696, "question_id": 52616658, "link": "https://stackoverflow.com/questions/52616658/vba-hyperlink-to-existing-sheet-in-workbook-that-is-hidden/52617696#52617696", "title": "VBA- Hyperlink to existing sheet in workbook that is hidden", "body": "<p>As I pointed out in my answer to <a href=\"https://stackoverflow.com/questions/52546805/vba-hyperlink-to-existing-sheet-in-workbook-that-is-hidden/52546913#52546913\">the similar question that you deleted</a>:</p>\n\n<blockquote>\n  <p>Note that you need to explicitly call .Follow if the sheet is hidden.</p>\n</blockquote>\n\n<pre><code>Private Sub Worksheet_FollowHyperlink(ByVal Target As Hyperlink)\n\n    Dim oWs As Worksheet\n    Dim targetString As String, targetSheet As Worksheet\n\n    Set oWs = ActiveWorkbook\n\n    targetString = Target.TextToDisplay\n\n    Set targetSheet = oWs.Sheets(targetString)\n\n    If targetSheet.Visible = False Then\n        targetSheet.Visible = True\n        'If the sheet was hidden, you have to explicitly follow the link again.\n        Application.EnableEvents = False\n        Target.Follow\n        Application.EnableEvents = True\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 10416060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67e0d06787f8d0a6046876165c089f21?s=128&d=identicon&r=PG&f=1", "display_name": "Ranger9", "link": "https://stackoverflow.com/users/10416060/ranger9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 0, "accepted_answer_id": 52617696, "answer_count": 1, "score": 2, "last_activity_date": 1538523290, "creation_date": 1538515681, "last_edit_date": 1538523290, "question_id": 52616658, "link": "https://stackoverflow.com/questions/52616658/vba-hyperlink-to-existing-sheet-in-workbook-that-is-hidden", "title": "VBA- Hyperlink to existing sheet in workbook that is hidden", "body": "<p>Im hyperlinking cells based on their values to existing sheets in my workbook. It runs through Column B and for any instance of the word \"title\" it places a hyperlink in the cell directly under it. The string in the cell directly under it is the same as what the corresponding sheet name would be. The script works perfectly however if the sheet is hidden it wont open it. Can anyone advise how to solve for this?</p>\n\n<p>'Loops through a specified column and when a specified value is found, puts a hyperlink in the cell below</p>\n\n<pre><code>  Const cWsName As String = \"Title Detail\"\n  Const cSearch As String = \"Title\"\n  Const cRow1 As Integer = 1\n  Const cRow2 As Long = 200\n  Const cCol As String = \"B\"\n\n  Dim oWb As Workbook\n  Dim oWs As Worksheet\n  Dim rCell1 As Range\n  Dim rCell2 As Range\n  Dim iR As Integer\n  Dim strText As String\n  Dim strAddr As String\n\n  Set oWb = ActiveWorkbook\n  Set oWs = oWb.Worksheets(cWsName)\n  For iR = cRow1 To cRow2\n    Set rCell1 = oWs.Range(cCol &amp; iR)\n    Set rCell2 = oWs.Range(cCol &amp; iR + 1)\n    strText = rCell2.Text 'What's written in the cell.\n    strAddr = rCell2.Address 'The address e.g. B1, B13 ...\n    If rCell1 = cSearch Then\n      If strText &lt;&gt; \"\" Then\n        'Anchor is the place where to put the hyperlink, cell or object.\n        'Notice the single quotes (') in the SubAddress.\n        rCell2.Hyperlinks.Add _\n        Anchor:=rCell2, _\n        Address:=\"\", _\n        SubAddress:=\"'\" &amp; rCell2 &amp; \"'!\" &amp; \"A1\", _\n        TextToDisplay:=strText 'The same text as requested\n       Else\n        'what to do if the cell below the Title cell is empty.\n        End If\n    End If\n  Next\n\n  'End on Title Detail Sheet\n  oWb.Sheets(\"Title Detail\").Select\n\nEnd Sub\n</code></pre>\n\n<p>Private Sub Worksheet_FollowHyperlink(ByVal Target As Hyperlink)</p>\n\n<pre><code>Dim oWs As Workbook\nDim targetString As String, targetSheet As Worksheet\nSet oWs = ActiveWorkbook \ntargetString = Target.TextToDisplay \nSet targetSheet = oWs.Worksheets(targetString)\nIf targetSheet.Visible = False Then\n    targetSheet.Visible = True\nEnd If\n</code></pre>\n\n<p>'End on Title Detail Sheet\n    targetSheet.Select</p>\n\n<p>End Sub</p>\n"}, {"tags": ["excel", "vba", "class"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1538515213, "post_id": 52616520, "comment_id": 92167321, "body": "How about using a <code>Dictionary</code>?"}, {"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1538515475, "post_id": 52616520, "comment_id": 92167418, "body": "@MathieuGuindon Well, I thought of something like that, but in terms of a case statement. But I don&#39;t understand how to use it for getting and setting the properties. Would you provide a practical and simple example?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1538523086, "post_id": 52616520, "comment_id": 92169648, "body": "Create a dictionary, key it with the column names and store a <code>Boolean</code> indicating whether the column should be included in the report or not? There are literally thousands of <code>Scripting.Dictionary</code> examples out there."}, {"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1538560823, "post_id": 52616520, "comment_id": 92182249, "body": "@MathieuGuindon I&#39;m sorry, but I still don&#39;t understand. I know how to use a dictionary. But I don&#39;t know how to use it to add a value to the correct <code>Property Let</code> and retrieve the value from the correct <code>Property Get</code>. I don&#39;t know if the end user will choose <code>Column1</code>, in which case I would use <code>Public Property Let ColumnOne(Value As String)</code>, or <code>Column2</code>, in which case I would use <code>Public Property Let ColumnTwo(Value As String)</code>. Only rows that meet certain criteria would be added to the collection. How does a dictionary help with this?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1538564315, "post_id": 52616520, "comment_id": 92184264, "body": "It completely removes the need for every single one of these properties? It <i>is</i> the property name/value mapping?"}, {"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1538567297, "post_id": 52616520, "comment_id": 92185959, "body": "Okay. I don&#39;t understand."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1538567821, "post_id": 52616520, "comment_id": 92186226, "body": "If you can <a href=\"https://stackoverflow.com/posts/52616520/edit\">edit</a> your question to better explain what you&#39;re trying to do, with a code block listing what your <code>Issue</code> class looks like, I&#39;d need to make fewer assumptions and thus would be more inclined to explain further. Can&#39;t post a useful answer with just the information that&#39;s in the question right now, it would be guesswork, at best."}, {"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1538569241, "post_id": 52616520, "comment_id": 92187063, "body": "@MathieuGuindon I edited my question. Hopefully, it is more clear now."}, {"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1538572771, "post_id": 52616520, "comment_id": 92189410, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/181221/discussion-between-brian-and-mathieu-guindon\">continue this discussion in chat</a>."}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1538752772, "post_id": 52616520, "comment_id": 92267331, "body": "How does the end user select which properties are to be used and which aren&#39;t? How are the issues themselves filtered to get to the Example value of 72 issues? And finally - if you have 120 cols and say 1000 rows and you just want to summarize them - Isn&#39;t it something that you can do with Pivot Tables and some slicers?"}, {"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "reply_to_user": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1538991921, "post_id": 52616520, "comment_id": 92325430, "body": "@RikSportel They select which properties are to be used by picking the columns they want from a listview control. They are filtered according to the unique values I give them from the column they choose in a different listview control."}, {"owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "edited": false, "score": 0, "creation_date": 1539073651, "post_id": 52616520, "comment_id": 92358403, "body": "Put your Table in an array, You can Filter the rows and columns your end-user want. No need for a class despite the fact that I can really appreciate the use of classes"}], "answers": [{"comments": [{"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "edited": false, "score": 0, "creation_date": 1539079681, "post_id": 52716162, "comment_id": 92362202, "body": "This is definitely &quot;more or less&quot; what I was looking for. Just this morning I began implementing the <code>dictionary</code> in my class. A friend of mine recommended a variation of the above using an array with column names as the dictionary keys and zero-based integers as the value. Then looping through the filtered array values. This is what I couldn&#39;t understand. Thank you for taking the time to do this. Marking as correct and +1."}], "tags": [], "owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "is_accepted": true, "score": 3, "last_activity_date": 1539072371, "creation_date": 1539072371, "answer_id": 52716162, "question_id": 52616520, "link": "https://stackoverflow.com/questions/52616520/object-properties-at-runtime/52716162#52716162", "title": "Object Properties at Runtime", "body": "<p>The core problem:\nCreate only properties in <code>CIssue</code> objects that are selected according to a listview.</p>\n\n<p>For this first issue, I created a Sheet (\"Sheet1\") to which I added an ActiveX <code>ListView</code> (MicroSoft ListView Control, version 6.0) that I populated with the Column headers (or property names) as follows in a regular module:</p>\n\n<pre><code>Option Explicit\nSub PopulateListView()\nDim i As Integer\ni = 1\nWith Worksheets(\"Sheet1\")\n    .TestListView.ListItems.Clear\n    Do While Not IsEmpty(.Cells(1, i))\n        .TestListView.ListItems.Add i, , .Cells(1, i).Value\n        i = i + 1\n    Loop\nEnd With\nEnd Sub\n</code></pre>\n\n<p>I set the following properties: </p>\n\n<ul>\n<li><code>Checkboxes</code> to <code>True</code></li>\n<li><code>MultiSelect</code> to <code>True</code></li>\n</ul>\n\n<p>This will allow us to loop over selected items and create properties in our <code>CIssue</code> class accordingly.</p>\n\n<p>Next, I added a reference to <code>MicroSoft Scripting Runtime</code>, so the <code>Dictionary</code> class is available. This is needed, because with the <code>Collection</code> class there's no easy way to retrieve the \"property\" by \"key\" (or property name, as below).</p>\n\n<p>I created the <code>CIssue</code> class as follows:</p>\n\n<pre><code>Option Explicit\nPrivate p_Properties As Dictionary\nPrivate Sub Class_Initialize()\n    Set p_Properties = New Dictionary\nEnd Sub\nPublic Sub AddProperty(propertyname As String, value As Variant)\n    p_Properties.Add propertyname, value\nEnd Sub\nPublic Function GetProperty(propertyname As Variant) As Variant\n    On Error Resume Next\n        GetProperty = p_Properties.Item(propertyname)\n    On Error GoTo 0\n    If IsEmpty(GetProperty) Then\n        GetProperty = False\n    End If\nEnd Function\nPublic Property Get Properties() As Dictionary\n    Set Properties = p_Properties 'Return the entire collection of properties\nEnd Property\n</code></pre>\n\n<p>This way, you can do the following in a regular module:</p>\n\n<pre><code>Option Explicit\nPublic Issue As CIssue\nPublic Issues As Collection\nPublic lv As ListView\nSub TestCreateIssues()\nDim i As Integer\nDim Item As ListItem\n\nSet lv = Worksheets(\"Sheet1\").TestListView\nSet Issues = New Collection\n\nFor i = 2 To 10 'Or however many rows you filtered, for example those 72.\n    Set Issue = New CIssue\n    For Each Item In lv.ListItems 'Loop over ListItems\n        If Item.Checked = True Then ' If the property is selected\n            Issue.AddProperty Item.Text, Worksheets(\"Sheet1\").Cells(i, Item.Index).value 'Get the property name and value, and add it.\n        End If\n    Next Item\n    Issues.Add Issue\nNext i\nEnd Sub\n</code></pre>\n\n<p>Thereby ending up with a <code>Collection</code> of <code>CIssue</code> objects, that only have the required properties populated. You can retrieve each property by using <code>CIssue.GetProperty( propertyname )</code>. It will return \"False\" if the property doesn't exist, otherwise the value of the property. Since it returns <code>Variant</code> it will cater for Dates, Strings, etc.\nNote that if you want to loop over filtered rows, you can amend the loop above accordingly. Note that the <code>propertyname</code> parameter for the <code>GetProperty</code> method is also a Variant - This allows you to pass in strings as well as the actual <code>Key</code> objects.</p>\n\n<p>To populate another sheet, with whatever you captured this way, you can do something like the following (in either the same or a different module; note that the <code>Sub</code> above needs to be run first, otherwise your Collection of CIssues will not exist.</p>\n\n<pre><code>Sub TestWriteIssues()\nDim i As Integer\nDim j As Integer\nDim Item As ListItem\nDim p As Variant\nDim k As Variant\n\ni = 1\nj = 0\n'To write all the properties from all issues:\nFor Each Issue In Issues\n    i = i + 1\n    For Each p In Issue.Properties.Items\n        j = j + 1\n        Worksheets(\"Sheet2\").Cells(i, j).value = p\n    Next p\n    j = 0\nNext Issue\n\n'And add the column headers:\ni = 0\nFor Each k In Issues.Item(1).Properties.Keys\n    i = i + 1\n    Worksheets(\"Sheet2\").Cells(1, i).value = k\n    'And to access the single property in one of the Issue objects:\n    MsgBox Issues.Item(1).GetProperty(k)\nNext k\nEnd Sub\n</code></pre>\n\n<p>Hope this is more or less what you were after.</p>\n\n<p>N.b. more background on why the choice for <code>Dictionary</code> instead of <code>Collection</code> in  <a href=\"https://stackoverflow.com/questions/5702362/vba-collection-list-of-keys\">this question</a></p>\n"}], "owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 204, "favorite_count": 0, "accepted_answer_id": 52716162, "answer_count": 1, "score": 1, "last_activity_date": 1539072371, "creation_date": 1538514996, "last_edit_date": 1538569204, "question_id": 52616520, "link": "https://stackoverflow.com/questions/52616520/object-properties-at-runtime", "title": "Object Properties at Runtime", "body": "<p>I want to write to custom class properties dynamically. In my use case, I have a table with column headers. The headers are properties of an <code>Issue</code> class. There are over 120 columns per issue. The end user chooses which columns they want included in the report. How do I set the properties of an object when the columns are not known until runtime? I couldn't find anything on Google that helped.</p>\n\n<p><strong>EDITED for clarity</strong></p>\n\n<p>Here is a snippet of my <code>CIssue</code> class:</p>\n\n<pre><code>Option Explicit\n\nPrivate pIncidentNumber As String\nPrivate pIncidentType As String\nPrivate pContent As String\nPrivate pStartDate As Date\nPrivate pEndDate As Date\n\n\nPublic Property Let IncidentNumber(Value As String)\n    pIncidentNumber = Value\nEnd Property\nPublic Property Get IncidentNumber() As String\n    IncidentNumber = pIncidentNumber\nEnd Property\nPublic Property Let IncidentType(Value As String)\n    pIncidentType = Value\nEnd Property\nPublic Property Get IncidentType() As String\n    IncidentType = pIncidentType\nEnd Property\nPublic Property Let Content(Value As String)\n    pContent = Value\nEnd Property\nPublic Property Get Content() As String\n    Content = pContent\nEnd Property\nPublic Property Let StartDate(Value As Date)\n    pStartDate = Value\nEnd Property\nPublic Property Get StartDate() As Date\n    StartDate = pStartDate\nEnd Property\nPublic Property Let EndDate(Value As Date)\n    pEndDate = Value\nEnd Property\nPublic Property Get EndDate() As Date\n    EndDate = pEndDate\nEnd Property\n</code></pre>\n\n<p>It does nothing but help organize my code. I will build a collection class for this, also. If the end user chooses <code>Incident Number</code> and <code>Content</code> columns I want to set the appropriate properties. There could be up to 1,000 rows of data. So I need to set the properties for the rows that fit the criteria. </p>\n\n<p><strong>Example</strong></p>\n\n<p>I might have 72 rows that fit the criteria. Therefore, I need to add to my collection 72 objects of type <code>CIssue</code> with the correct properties set according to the columns the end user chose.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba", "cell", "spreadsheet", "copy-paste"], "comments": [{"owner": {"reputation": 188, "user_id": 6400144, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/226f717105f9cf7442c8f26eaaaadbd7?s=128&d=identicon&r=PG&f=1", "display_name": "fabio.avigo", "link": "https://stackoverflow.com/users/6400144/fabio-avigo"}, "edited": false, "score": 0, "creation_date": 1538514695, "post_id": 52616424, "comment_id": 92167128, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/18968856/vba-paste-range\">VBA paste range</a>"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1538514838, "post_id": 52616424, "comment_id": 92167166, "body": "Just a comment, it&#39;s a little confusing when you switch conventions for the worksheet.  <code>Sheet22.Range()</code> vs <code>Worksheets(&quot;Sheet21&quot;)</code>.  I&#39;d pick one way and stick with that.  That being said, which line throws the error? (Click &quot;Debug&quot; when the error pops up).  Also, are the origin and destination ranges the same size?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1538514849, "post_id": 52616424, "comment_id": 92167178, "body": "<code>Set StartCell = Range(&quot;A1&quot;)</code> I&#39;d fully qualify this line then try again - <code>Set StartCell = Sheet22.Range(&quot;A1&quot;)</code>"}, {"owner": {"reputation": 188, "user_id": 6400144, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/226f717105f9cf7442c8f26eaaaadbd7?s=128&d=identicon&r=PG&f=1", "display_name": "fabio.avigo", "link": "https://stackoverflow.com/users/6400144/fabio-avigo"}, "edited": false, "score": 0, "creation_date": 1538514872, "post_id": 52616424, "comment_id": 92167187, "body": "Hello and welcome to Stack Overflow! This subject has been thoroughly discussed across several other posts on this website. Make sure you are setting the Range object on your destination sheet appropriately. Also, the step-by-step debugger on VBA can help you find the error."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 10448217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f58bd6f7a25179955664017ca0965861?s=128&d=identicon&r=PG&f=1", "display_name": "doututu", "link": "https://stackoverflow.com/users/10448217/doututu"}, "edited": false, "score": 0, "creation_date": 1538583014, "post_id": 52616693, "comment_id": 92196071, "body": "Thanks for your answer! I tried the code, but it shows error at set ws = Thisworkbook.Worksheets(&quot;Sheet22&quot;)"}, {"owner": {"reputation": 865, "user_id": 10361731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8873db235bacaa9d53de9c31a0b8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Jchang43", "link": "https://stackoverflow.com/users/10361731/jchang43"}, "reply_to_user": {"reputation": 23, "user_id": 10448217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f58bd6f7a25179955664017ca0965861?s=128&d=identicon&r=PG&f=1", "display_name": "doututu", "link": "https://stackoverflow.com/users/10448217/doututu"}, "edited": false, "score": 0, "creation_date": 1538583180, "post_id": 52616693, "comment_id": 92196153, "body": "@doututu It&#39;s likely because I forgot to Dim it at the top. I&#39;ve added the line, let me know if that fixed it"}, {"owner": {"reputation": 23, "user_id": 10448217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f58bd6f7a25179955664017ca0965861?s=128&d=identicon&r=PG&f=1", "display_name": "doututu", "link": "https://stackoverflow.com/users/10448217/doututu"}, "edited": false, "score": 0, "creation_date": 1538583699, "post_id": 52616693, "comment_id": 92196420, "body": "Actually you did dim it and now it&#39;s dimmed twice. I just changed the last line of my original code to &quot; Sheet22.Range(StartCell, Sheet22.Cells(i, LastColumn)).Copy Sheet21.Range(&quot;A1&quot;) &quot;, and it works. Wondering here VBA calls sheet22 and sheet21 as object?"}, {"owner": {"reputation": 865, "user_id": 10361731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8873db235bacaa9d53de9c31a0b8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Jchang43", "link": "https://stackoverflow.com/users/10361731/jchang43"}, "reply_to_user": {"reputation": 23, "user_id": 10448217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f58bd6f7a25179955664017ca0965861?s=128&d=identicon&r=PG&f=1", "display_name": "doututu", "link": "https://stackoverflow.com/users/10448217/doututu"}, "edited": false, "score": 0, "creation_date": 1538583913, "post_id": 52616693, "comment_id": 92196517, "body": "Oh, oops. I&#39;m not too sure, I&#39;ve never called a sheet like that myself."}], "tags": [], "owner": {"reputation": 865, "user_id": 10361731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8873db235bacaa9d53de9c31a0b8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Jchang43", "link": "https://stackoverflow.com/users/10361731/jchang43"}, "is_accepted": true, "score": 0, "last_activity_date": 1538583856, "last_edit_date": 1538583856, "creation_date": 1538515857, "answer_id": 52616693, "question_id": 52616424, "link": "https://stackoverflow.com/questions/52616424/paste-cells-to-another-worksheet-in-vba/52616693#52616693", "title": "Paste cells to another worksheet in VBA", "body": "<p>You have to properly call to your sheet. VBA doesn't accept just the name of the sheet as an object. You have to reference to the sheet with <code>Worksheets(\"Sheet22\")</code>, another option would be to set an object to be this:</p>\n\n<pre><code>Dim ws as object\nset ws = Thisworkbook.Worksheets(\"Sheet22\")\n</code></pre>\n\n<p>This way VBA knows you want Sheet22 from the book that the macro is in; otherwise you could specify the workbook with <code>Workbooks(\"YourWorkBookName\").WorkSheets(\"SheetName\")</code>. </p>\n\n<p>From there you could use <code>ws.Range</code> as you were doing with <code>Sheet22</code>. Similarly, <code>StartCell</code> may be a range, but it only acts with the active sheet, so it wouldn't be a bad idea to reference it to a certain sheet and/or book as well. But in this case, I've left it out because it's always <code>A1</code> and that's simple enough to enter.</p>\n\n<p>Later in your code when you're trying to calculate the balance, you also have to use <code>.Value</code> after you call your range so that you actually access the number stored in the cell. But if you're threshold is what you're checking you should be adding the <code>threshold</code> back to itself. However, I've chosen to just use <code>Bal</code> in this case because it made more sense to me.</p>\n\n<pre><code>Sub MatchFRB()\n' find last row and column \nDim LastRow As Long\nDim LastColumn As Long\nDim ws as object\nDim i As Integer\nDim Bal As Double\n\nset ws = Thisworkbook.Worksheets(\"Sheet22\")\n\nLastRow = ws.Cells.Find(\"*\", searchorder:=xlByRows, searchdirection:=xlPrevious).Row\nLastColumn = ws.Cells.Find(\"*\", searchorder:=xlByColumns, searchdirection:=xlPrevious).Column\n\n' Select cells until meets Threshold=5000000000\n\nBal = 0\n\nFor i = 2 To LastRow\n    Bal = Bal + ws.Range(\"AV\" &amp; i).Value\n    If Bal &gt;= 5000000000 Then  \n        Exit For\n    End If\nNext i \n\n' copy cells from Sheet22 and paste to Sheet21\nws.Range(\"A1:\" &amp; Cells(i, LastColumn).Address).Copy Worksheets(\"Sheet21\").Range(\"A1:\", Cells(i, LastColumn).address)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 10448217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f58bd6f7a25179955664017ca0965861?s=128&d=identicon&r=PG&f=1", "display_name": "doututu", "link": "https://stackoverflow.com/users/10448217/doututu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1173, "favorite_count": 0, "accepted_answer_id": 52616693, "answer_count": 1, "score": 2, "last_activity_date": 1538583856, "creation_date": 1538514544, "question_id": 52616424, "link": "https://stackoverflow.com/questions/52616424/paste-cells-to-another-worksheet-in-vba", "title": "Paste cells to another worksheet in VBA", "body": "<p>I want to paste cells across worksheets in VBA. In the code below, I first select the range of cells, and then paste to another worksheet. But it runs error '9\": Subscript out of range. I think the problem is in the last line for copy &amp; paste. Here's my code:</p>\n\n<pre><code>Sub MatchFRB()\n' find last row and column \nDim LastRow As Long\nDim LastColumn As Long\nDim StartCell As Range\nSet StartCell = Range(\"A1\")\nLastRow = Sheet22.Cells(Sheet22.Rows.Count, StartCell.Column).End(xlUp).Row\nLastColumn = Sheet22.Cells(StartCell.Row, Sheet22.Columns.Count).End(xlToLeft).Column\n\n' Select cells until meets Threshold=5000000000\nDim i As Integer\nDim Bal As Double\nThreshold = 0\n\nFor i = 2 To LastRow\nBal = Threshold + Range(\"AV\" &amp; i)\nIf Threshold &gt; 5000000000# Then  \n    Exit For\nEnd If\n    Next i \n\n' copy cells from Sheet22 and paste to Sheet21\nSheet22.Range(StartCell, Sheet22.Cells(i, LastColumn)).Copy Worksheets(\"Sheet21\").Range(StartCell, Sheet21.Cells(i, LastColumn))\n\nEnd Sub\n</code></pre>\n\n<p>Many thanks!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1538514846, "post_id": 52616368, "comment_id": 92167176, "body": "Other than the misplaced spaces (<code>Sheets (&quot;Sheet1&quot;)</code> should be <code>Sheets(&quot;Sheet1&quot;)</code>) and the fact that it&#39;s commented out... it looks fine to me. What does &quot;Doesn&#39;t seem to work&quot; mean? It says (for clarification) if the contents of column E is between column H and K then print &quot;true&quot; in column J. Is that what you want it to do?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1538514923, "post_id": 52616368, "comment_id": 92167209, "body": "...I assume when you&#39;re actually running the code, the lines aren&#39;t commented out?"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1538514924, "post_id": 52616368, "comment_id": 92167210, "body": "Well, try uncommenting the code..."}, {"owner": {"reputation": 53, "user_id": 9755078, "user_type": "registered", "profile_image": "https://graph.facebook.com/1771812006220118/picture?type=large", "display_name": "Ikem Michael", "link": "https://stackoverflow.com/users/9755078/ikem-michael"}, "edited": false, "score": 0, "creation_date": 1538515334, "post_id": 52616368, "comment_id": 92167355, "body": "Yes @ JNevill. @ brucewayne no comments when actually running the code."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1538515547, "post_id": 52616368, "comment_id": 92167443, "body": "I&#39;m not sure we can offer more help here without more information.  Is it erroring, is &quot;True&quot; not showing up. Can you share some sample data and your desired results?"}, {"owner": {"reputation": 53, "user_id": 9755078, "user_type": "registered", "profile_image": "https://graph.facebook.com/1771812006220118/picture?type=large", "display_name": "Ikem Michael", "link": "https://stackoverflow.com/users/9755078/ikem-michael"}, "edited": false, "score": 0, "creation_date": 1538515904, "post_id": 52616368, "comment_id": 92167582, "body": "True shows up on empty rows only"}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1538520454, "post_id": 52616368, "comment_id": 92169029, "body": "Post some sample data from your sheet, give us a few rows from Sheet2 columns A:K and the same number of rows from Sheet 1 columns A:E"}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1538520682, "post_id": 52616368, "comment_id": 92169092, "body": "Also step through your code using F8 and evaluate each of the tests in the debug window so you can see where exactly your results are not what you expect."}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1538520774, "post_id": 52616368, "comment_id": 92169113, "body": "Also don&#39;t do this: <code>For i = 1 to 9999</code> do this instead: <code>For i = 1 to Sheets(&quot;sheet1&quot;).Range(&quot;A&quot; &amp; Rows.count).end(xlup).row</code> No need to keep testing rows where you have no data."}, {"owner": {"reputation": 53, "user_id": 9755078, "user_type": "registered", "profile_image": "https://graph.facebook.com/1771812006220118/picture?type=large", "display_name": "Ikem Michael", "link": "https://stackoverflow.com/users/9755078/ikem-michael"}, "edited": false, "score": 0, "creation_date": 1538557824, "post_id": 52616368, "comment_id": 92180475, "body": "how do i send the sample data? via email?"}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 9755078, "user_type": "registered", "profile_image": "https://graph.facebook.com/1771812006220118/picture?type=large", "display_name": "Ikem Michael", "link": "https://stackoverflow.com/users/9755078/ikem-michael"}, "edited": false, "score": 0, "creation_date": 1539163196, "post_id": 52736626, "comment_id": 92398257, "body": "despite that the code worked i discovered a new problem when i tried to add  an else statement to rather write a string on any cell in sheet1 column J that doesnt meet the condition. i&#39;lld be much grateful if i could get a solution to this new problem."}], "tags": [], "owner": {"reputation": 53, "user_id": 9755078, "user_type": "registered", "profile_image": "https://graph.facebook.com/1771812006220118/picture?type=large", "display_name": "Ikem Michael", "link": "https://stackoverflow.com/users/9755078/ikem-michael"}, "is_accepted": true, "score": 1, "last_activity_date": 1539162733, "creation_date": 1539162733, "answer_id": 52736626, "question_id": 52616368, "link": "https://stackoverflow.com/questions/52616368/comparing-values-from-sheet1-with-sheet2-values/52736626#52736626", "title": "Comparing values from sheet1 with sheet2 values", "body": "<pre><code>Sub workbook_initialize()\n\nDim cell As Excel.Range\n\nDim LastRow As Long\n\n\n\nLastRow = Sheets(\"sheet1\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n\n\nFor Each cell In Sheets(\"sheet1\").Range(\"E1:E\" &amp; LastRow)\nFor i = 1 To Sheets(\"sheet2\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n\nIf cell.Value &gt;= Sheets(\"Sheet2\").Cells(i, 8).Value And cell.Value &lt;= Sheets(\"Sheet2\").Cells(i, 11).Value Then\n\n\nSheets(\"Sheet1\").Cells(cell.Row, 10).Value = Sheets(\"Sheet2\").Cells(i, 3).Value\n\n\n\n\nEnd If\nNext i\nNext\n\n\nEnd Sub\n</code></pre>\n\n<p>I was able to achieve what i wanted with this code. which is to loop through a particular range of cells in sheet1 and if any cell has value greater  than or equal to value in sheet2 column H and at the same time less than or equal to the value of sheet2 column K on same row then make sheet1 column J same value as the corresponding cell in sheet2 column C.</p>\n"}], "owner": {"reputation": 53, "user_id": 9755078, "user_type": "registered", "profile_image": "https://graph.facebook.com/1771812006220118/picture?type=large", "display_name": "Ikem Michael", "link": "https://stackoverflow.com/users/9755078/ikem-michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 52736626, "answer_count": 1, "score": 0, "last_activity_date": 1539162733, "creation_date": 1538514252, "last_edit_date": 1538515500, "question_id": 52616368, "link": "https://stackoverflow.com/questions/52616368/comparing-values-from-sheet1-with-sheet2-values", "title": "Comparing values from sheet1 with sheet2 values", "body": "<p>I have this code</p>\n\n<pre><code>For i = 1 to 9999\n    If sheets (\"sheet1\").cells (i, 5).value &gt;= sheets (\"sheet2\").cells (i, 8).value And sheets (\"sheet1\").cells (i, 5).value &lt;= sheets (\"sheet2\").cells (i, 11).value then\n\n    Sheets (\"sheet1\").cells (i, 10).value = \"true\"\n</code></pre>\n\n<p>What the code is suppose to do is check if value on sheet1 is within a range of values between two figures on sheet2. But it doesn't seem to work. Any help would be much appreciated.</p>\n"}, {"tags": ["excel", "vba", "filter", "combobox", "autocomplete"], "comments": [{"owner": {"reputation": 51, "user_id": 8671544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/806c9327b94a8c442bed3251d2a87070?s=128&d=identicon&r=PG&f=1", "display_name": "dusty_j", "link": "https://stackoverflow.com/users/8671544/dusty-j"}, "edited": false, "score": 0, "creation_date": 1538513771, "post_id": 52616236, "comment_id": 92166782, "body": "I may also add to this that the referenced table for this combobox is ever growing and currently has over 300 entries. so it would be too complicated to somehow look for each item specifically in the code with if/then or case statements"}, {"owner": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "edited": false, "score": 0, "creation_date": 1538514441, "post_id": 52616236, "comment_id": 92167038, "body": "A UserForm is the way to go. You say you can&#39;t use one because you&#39;d have to change the design of your workbook. But how about a small userform which is shown only on a SelectionChange event where the target is the specific cell in question? You could even make that userform detect keypresses other than typing: eg if the user presses a cursor key, the form should close and then select another relevant worksheet cell (same behaviour as keying through cells)."}, {"owner": {"reputation": 51, "user_id": 8671544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/806c9327b94a8c442bed3251d2a87070?s=128&d=identicon&r=PG&f=1", "display_name": "dusty_j", "link": "https://stackoverflow.com/users/8671544/dusty-j"}, "reply_to_user": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "edited": false, "score": 0, "creation_date": 1538568286, "post_id": 52616236, "comment_id": 92186463, "body": "@ChrisMelville i&#39;ll look into this. thanks"}, {"owner": {"reputation": 51, "user_id": 8671544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/806c9327b94a8c442bed3251d2a87070?s=128&d=identicon&r=PG&f=1", "display_name": "dusty_j", "link": "https://stackoverflow.com/users/8671544/dusty-j"}, "reply_to_user": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "edited": false, "score": 0, "creation_date": 1539261967, "post_id": 52616236, "comment_id": 92443853, "body": "@chrismelville I edited my code went with your userform idea. however I&#39;ve hit a roadblock. getting various errors when this runs.. I can&#39;t figure out what I need to set the variable x to. the code I pulled from the web says set to a range on a worksheet but the combobox this is working out of is dependent on another combobox and the rowsource is prefilled before the oem_change event occurs. keep getting error 70 or object reference errors. the dropdown will fill the list with the correct items, but as soon as I start typing in the 2nd combobox (oem) it errors out."}, {"owner": {"reputation": 51, "user_id": 8671544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/806c9327b94a8c442bed3251d2a87070?s=128&d=identicon&r=PG&f=1", "display_name": "dusty_j", "link": "https://stackoverflow.com/users/8671544/dusty-j"}, "reply_to_user": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "edited": false, "score": 0, "creation_date": 1539262843, "post_id": 52616236, "comment_id": 92444415, "body": "so x is supposed to be an array for the ubound property to work, so I guess how do you take whats already in the combobox list and define it as an array, setting the variable &quot;x&quot; to it? or maybe im not on the right track at all im not sure"}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 8671544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/806c9327b94a8c442bed3251d2a87070?s=128&d=identicon&r=PG&f=1", "display_name": "dusty_j", "link": "https://stackoverflow.com/users/8671544/dusty-j"}, "edited": false, "score": 1, "creation_date": 1538568368, "post_id": 52618530, "comment_id": 92186522, "body": "I believe you have posted almost the exact same code I did. you may have found the website I pulled mine from. doesn&#39;t really help me though and this code only filters the list to an exact match of what you typed. I need a modified version that can search a string and return any part of that string"}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "reply_to_user": {"reputation": 51, "user_id": 8671544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/806c9327b94a8c442bed3251d2a87070?s=128&d=identicon&r=PG&f=1", "display_name": "dusty_j", "link": "https://stackoverflow.com/users/8671544/dusty-j"}, "edited": false, "score": 0, "creation_date": 1538576808, "post_id": 52618530, "comment_id": 92192014, "body": "I edited my original answer.  Now, I can&#39;t seem to post the VBA code into the window...very weird...  Anyway, check the link and you &#39;ll get all code from there.  People at this site don&#39;t take favorably to just posting a link, so I listed all steps along with the link.  Good luck."}], "tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1538576644, "last_edit_date": 1538576644, "creation_date": 1538530456, "answer_id": 52618530, "question_id": 52616236, "link": "https://stackoverflow.com/questions/52616236/vba-combobox-with-autocomplete-and-search-as-you-type/52618530#52618530", "title": "VBA combobox with autocomplete and search as you type", "body": "<p>Autocomplete when typing in drop down list with VBA code</p>\n\n<p>Firstly you need to insert a combo box into the worksheet and change its properties, and then running the VBA code to enable the autocomplete.</p>\n\n<ol>\n<li><p>Get into the worksheet which contains the drop down list you want it to be autocompleted.</p></li>\n<li><p>Before inserting the Combo box, you need to enable the Developer tab in the ribbon.</p></li>\n</ol>\n\n<p>1). In Excel 2010 and 2013, click File > Options. And in the Options dialog box, click Customize Ribbon in the right pane, check the Developer box, then click the OK button. See screenshot:</p>\n\n<p>2). In Outlook 2007, click Office button > Excel Options. In the Excel Options dialog box, click Popular in the right bar, then check the Show Developer tabin the Ribbon box, and finally click the OK button.</p>\n\n<ol start=\"3\">\n<li><p>Then click Developer > Insert > Combo Box under ActiveX Controls. See screenshot:</p></li>\n<li><p>Draw the combo box in current opened worksheet and right click it. Select Properties in the right-clicking menu.</p></li>\n<li><p>In the Properties dialog box, you need to:</p></li>\n</ol>\n\n<p>1). Change the name to TempCombo in the Name field;</p>\n\n<p>2). Specify the font you need in the Font field;</p>\n\n<p>3). Scroll down to select 1-fmMatchEntryComplete in the MatchEntry field;</p>\n\n<p>4). Close the Properties dialog box.</p>\n\n<ol start=\"6\">\n<li><p>Turn off the Design Mode with clicking Developer > Design Mode.</p></li>\n<li><p>Right click on the current opened worksheet tab and click View Code. See screenshot:</p></li>\n<li><p>Make sure that the current worksheet code editor is opened, and then copy and paste the below VBA code into it. </p></li>\n</ol>\n\n<p>CAN'T SEEM TO PASTE CODE IN HERE FOR SOME ODD REASON...</p>\n\n<ol start=\"9\">\n<li><p>Click File > Close and Return to Microsoft Excel to close the Microsoft Visual Basic for Application window.</p></li>\n<li><p>Now, just click the cell with drop down list, you can see the drop-down list is displayed as a combo box, then type the first letter into the box, the corresponding word will be completed automatically. See screenshot:</p></li>\n</ol>\n\n<p><a href=\"https://www.extendoffice.com/documents/excel/2401-excel-drop-down-list-autocomplete.html#a1\" rel=\"nofollow noreferrer\">https://www.extendoffice.com/documents/excel/2401-excel-drop-down-list-autocomplete.html#a1</a></p>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 8671544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/806c9327b94a8c442bed3251d2a87070?s=128&d=identicon&r=PG&f=1", "display_name": "dusty_j", "link": "https://stackoverflow.com/users/8671544/dusty-j"}, "is_accepted": false, "score": 1, "last_activity_date": 1539272031, "creation_date": 1539272031, "answer_id": 52763914, "question_id": 52616236, "link": "https://stackoverflow.com/questions/52616236/vba-combobox-with-autocomplete-and-search-as-you-type/52763914#52763914", "title": "VBA combobox with autocomplete and search as you type", "body": "<p>ok guys I figured it out. I dim'ed another variable as \"p\". p = vertical.value, then x = worksheets(\"sheet2\").range(p).value. works perfect. thanks to all for your help</p>\n"}, {"comments": [{"owner": {"reputation": 1042, "user_id": 15070659, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HkdKp.jpg?s=128&g=1", "display_name": "EsTeAa", "link": "https://stackoverflow.com/users/15070659/esteaa"}, "edited": false, "score": 1, "creation_date": 1614264749, "post_id": 66370898, "comment_id": 117337729, "body": "A link to a solution is welcome, but please ensure your answer is useful without it: <a href=\"//meta.stackexchange.com/a/8259\">add context around the link</a> so your fellow users will have some idea what it is and why it\u2019s there, then quote the most relevant part of the page you&#39;re linking to in case the target page is unavailable. <a href=\"/help/deleted-answers\">Answers that are little more than a link may be deleted.</a>"}, {"owner": {"reputation": 1, "user_id": 15283948, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/7522ed1c538a3e33d05f3721818fe23a?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/15283948/alex"}, "reply_to_user": {"reputation": 1042, "user_id": 15070659, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HkdKp.jpg?s=128&g=1", "display_name": "EsTeAa", "link": "https://stackoverflow.com/users/15070659/esteaa"}, "edited": false, "score": 0, "creation_date": 1614265509, "post_id": 66370898, "comment_id": 117338127, "body": "Now modified, please remove -1 downvote."}], "tags": [], "owner": {"reputation": 1, "user_id": 15283948, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/7522ed1c538a3e33d05f3721818fe23a?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/15283948/alex"}, "is_accepted": false, "score": -1, "last_activity_date": 1614265301, "last_edit_date": 1614265301, "creation_date": 1614264693, "answer_id": 66370898, "question_id": 52616236, "link": "https://stackoverflow.com/questions/52616236/vba-combobox-with-autocomplete-and-search-as-you-type/66370898#66370898", "title": "VBA combobox with autocomplete and search as you type", "body": "<p>For anyone trying this with a ComboBox on a VBA form John_w's answer from the below link is a better solution:</p>\n<p><a href=\"https://www.mrexcel.com/board/threads/how-to-use-a-combobox-with-autocomplete-and-search-as-you-type.1098277/\" rel=\"nofollow noreferrer\">https://www.mrexcel.com/board/threads/how-to-use-a-combobox-with-autocomplete-and-search-as-you-type.1098277/</a></p>\n<p>EDIT - Info from the page in case it is ever removed as per SO bot suggestion:</p>\n<p>Try this code. The combo box is an ActiveX Combo Box with the following properties:</p>\n<pre><code>Name = ComboBox1\nListFillRange = blank\nMatchEntry = 2 - fmMatchEntryNone\nMatchRequired = False\n</code></pre>\n<p>The combo box values are in Sheet1 starting at A2 to the last populated cell in column A.</p>\n<p>Put this code in the module of the sheet containing the combo box.</p>\n<pre><code>Option Explicit\n\nPrivate IsArrow As Boolean\n\nPrivate Sub ComboBox1_Change()\n\n    Dim i As Long\n    \n    If Not IsArrow Then\n        With Me.ComboBox1\n            .List = Worksheets(&quot;Sheet1&quot;).Range(&quot;A2&quot;, Worksheets(&quot;Sheet1&quot;).Cells(Rows.Count, &quot;A&quot;).End(xlUp)).Value\n            .ListRows = Application.WorksheetFunction.Min(6, .ListCount)\n            .DropDown\n            If Len(.Text) Then\n                For i = .ListCount - 1 To 0 Step -1\n                    If InStr(1, .List(i), .Text, vbTextCompare) = 0 Then .RemoveItem i\n                Next\n                .DropDown\n            End If\n        End With\n    End If\n    \nEnd Sub\n\n\nPrivate Sub ComboBox1_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)\n    IsArrow = (KeyCode = vbKeyUp) Or (KeyCode = vbKeyDown)\n    If KeyCode = vbKeyReturn Then Me.ComboBox1.List = Worksheets(&quot;Sheet1&quot;).Range(&quot;A2&quot;, Worksheets(&quot;Sheet1&quot;).Cells(Rows.Count, &quot;A&quot;).End(xlUp)).Value\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 8671544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/806c9327b94a8c442bed3251d2a87070?s=128&d=identicon&r=PG&f=1", "display_name": "dusty_j", "link": "https://stackoverflow.com/users/8671544/dusty-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18200, "favorite_count": 1, "answer_count": 3, "score": 3, "last_activity_date": 1614265301, "creation_date": 1538513598, "last_edit_date": 1539266806, "question_id": 52616236, "link": "https://stackoverflow.com/questions/52616236/vba-combobox-with-autocomplete-and-search-as-you-type", "title": "VBA combobox with autocomplete and search as you type", "body": "<p>I have the below code which creates a userform with autocomplete which I copied from another website. I would like to modify this to include a \"search as you type\" feature. for example:</p>\n\n<p>the table the combo box references is 1 column and includes items like this:</p>\n\n<pre><code>chevy truck\nford truck\ntruck\nchevy car\nford car\ncar\n</code></pre>\n\n<p>Currently when the user types \"truck\" the only result and suggestion is \"truck\" and will not show 'chevy truck'</p>\n\n<p>I would want the drop down list to show something like this when the user searches 'truck'</p>\n\n<pre><code>truck\nchevy truck\nford truck\n</code></pre>\n\n<p>or if the user types \"tr\" the list will show:</p>\n\n<pre><code>truck\nchevy truck\nford truck\n</code></pre>\n\n<p>user types 'che'...list shows:</p>\n\n<pre><code>chevy truck\nchevy car\n</code></pre>\n\n<p>etc. </p>\n\n<pre><code>Private Sub OEM_Change()\nDim x, dict\nDim i As Long\nDim str As String\n'x = this is where i need help.\nSet dict = CreateObject(\"scripting.dictionary\")\nstr = Me.OEM.Value\n    If str &lt;&gt; \"\" Then\n        For i = 1 To UBound(x, 1)\n            If InStr(LCase(x(i, 1)), LCase(str)) &gt; 0 Then\n                dict.Item(x(i, 1)) = \"\"\n            End If\n        Next i\n    Me.OEM.List = dict.keys\n    Else\n    Me.OEM.List = x\n    End If\n    Me.OEM.DropDown\n\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\n\nWith Vertical\n     .AddItem \"vertical1\"\n     .AddItem \"vertical2\"\n     .AddItem \"vertical3\"\n     .AddItem \"vertical4\"\n     .AddItem \"vertical5\"\nEnd With\n\nEnd Sub\n\nPrivate Sub Vertical_Change()\n\nDim index As Integer\n index = Vertical.ListIndex\n\nSelect Case index\n     Case Is = 0\n         With OEM\n             .RowSource = \"Namedrange1\"\n         End With\n     Case Is = 1\n         With OEM\n             .RowSource = \"Namedrange2\"\n         End With\n     Case Is = 2\n         With OEM\n            .RowSource = \"Namedrange3\"\n         End With\n    Case Is = 3\n         With OEM\n            .RowSource = \"Namedrange4\"\n         End With\n    Case Is = 4\n         With OEM\n            .RowSource = \"Namedrange5\"\n         End With\n\nEnd Select\n\nEnd Sub\n</code></pre>\n\n<p>for reference: some of this code came from this thread </p>\n\n<p><a href=\"https://stackoverflow.com/questions/44076069/searchable-combo-box-with-a-list-of-sugggestion-on-a-userform?\">searchable combo box with a list of sugggestion on a userform</a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1538513006, "post_id": 52616095, "comment_id": 92166513, "body": "You need to put the <code>_</code> outside the quotes and concatenate so change the <code>_</code> to <code>&quot; &amp; _</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 5, "creation_date": 1538513242, "post_id": 52616095, "comment_id": 92166587, "body": "BTW you can replace that long formula with INDEX/MATCH: <code>&quot;=IF(INDEX(N18:AQ18,MATCH($B$57,$N$17:$AQ$17,0))=&quot;&quot;Mixer_11&quot;&zwnj;&#8203;&quot;,&quot;&quot;&quot;&quot;,FALSE)&quot;</code>"}, {"owner": {"reputation": 188, "user_id": 6400144, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/226f717105f9cf7442c8f26eaaaadbd7?s=128&d=identicon&r=PG&f=1", "display_name": "fabio.avigo", "link": "https://stackoverflow.com/users/6400144/fabio-avigo"}, "edited": false, "score": 2, "creation_date": 1538513263, "post_id": 52616095, "comment_id": 92166594, "body": "All due respect, but I would suggest deleting this mess altogether and starting anew. This code is incomprehensible and very hard to maintain."}, {"owner": {"reputation": 968, "user_id": 5910169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a40180e3fa49fbf4e55145adf54d9?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Ball", "link": "https://stackoverflow.com/users/5910169/frank-ball"}, "edited": false, "score": 0, "creation_date": 1538520961, "post_id": 52616095, "comment_id": 92169162, "body": "A better solution than that enormous mountain of IF statements would to use a SWITCH/CASE  <a href=\"https://www.techonthenet.com/excel/formulas/case.php\" rel=\"nofollow noreferrer\">techonthenet.com/excel/formulas/case.php</a>"}, {"owner": {"reputation": 37, "user_id": 10187439, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ge6nn.jpg?s=128&g=1", "display_name": "LewisThelemon", "link": "https://stackoverflow.com/users/10187439/lewisthelemon"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1538521192, "post_id": 52616095, "comment_id": 92169217, "body": "@ScottCraner Hi Scott, thank you for the advice. The problem with Index match is that the Range N18 to AQ17 is a whole table with the match B57 being the header of that table. I am trying to populate the columns when I select the header name from a different drop down list. I hope I am making sense! I will try the &quot; &amp; _ solution and get back to you!"}, {"owner": {"reputation": 37, "user_id": 10187439, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ge6nn.jpg?s=128&g=1", "display_name": "LewisThelemon", "link": "https://stackoverflow.com/users/10187439/lewisthelemon"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1539022732, "post_id": 52616095, "comment_id": 92342246, "body": "@ScottCraner Hello Scott, I tried the &amp; variation and it works. Thank you for the suggestion."}, {"owner": {"reputation": 37, "user_id": 10187439, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ge6nn.jpg?s=128&g=1", "display_name": "LewisThelemon", "link": "https://stackoverflow.com/users/10187439/lewisthelemon"}, "reply_to_user": {"reputation": 968, "user_id": 5910169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a40180e3fa49fbf4e55145adf54d9?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Ball", "link": "https://stackoverflow.com/users/5910169/frank-ball"}, "edited": false, "score": 0, "creation_date": 1539022823, "post_id": 52616095, "comment_id": 92342280, "body": "@FrankBall Hello Frank, I am trying your solution to check if it will clean my code further and reduce the hard coded portion of the code. Thank you for the suggestion."}], "owner": {"reputation": 37, "user_id": 10187439, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ge6nn.jpg?s=128&g=1", "display_name": "LewisThelemon", "link": "https://stackoverflow.com/users/10187439/lewisthelemon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1538512885, "creation_date": 1538512885, "question_id": 52616095, "link": "https://stackoverflow.com/questions/52616095/why-am-i-getting-an-error-while-breaking-a-formula", "title": "Why am I getting an error while breaking a formula?", "body": "<p>I am trying to generate a code which will give me a drop-down list for my spreadsheet. I have a formula which is long and I tried to use breaks as was shown in various communities but somehow the formula is not working. I am new to VBA coding and below is what I was able to do.\nHelp or suggestions would be appreciated.</p>\n\n<pre><code>Sub Trial()\n'\n' Trial Macro\n'\n\n'\nWith Selection.Validation\n    .Delete\n    .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _\n    xlBetween, Formula1:= _\n    \"= If _ \n    (\"IF($B$57=Sheet1!$N$17,Sheet1!N18,IF($B$57=Sheet1!$O$17,Sheet1!O18, _\n    IF($B$57=Sheet1!$P$17,Sheet1!P18,IF($B$57=Sheet1!$Q$17,Sheet1!Q18, _\n    IF($B$57=Sheet1!$R$17,Sheet1!R18,IF($B$57=Sheet1!$S$17,Sheet1!S18, _\n    IF($B$57=Sheet1!$T$17,Sheet1!T18,IF($B$57=Sheet1!$U$17,Sheet1!U18, _\n    IF($B$57=Sheet1!$V$17,Sheet1!V18,IF($B$57=Sheet1!$W$17,Sheet1!W18, _\n    IF($B$57=Sheet1!$X$17,Sheet1!X18,IF($B$57=Sheet1!$Y$17,Sheet1!Y18, _\n    IF($B$57=Sheet1!$Z$17,Sheet1!Z18,IF($B$57=Sheet1!$AA$17,Sheet1!AA18, _\n    IF($B$57=Sheet1!$AB$17,Sheet1!AB18,IF($B$57=Sheet1!$AC$17,Sheet1!AC18, _\n    IF($B$57=Sheet1!$AD$17,Sheet1!AD18,IF($B$57=Sheet1!$AE$17,Sheet1!AE18, _\n    IF($B$57=Sheet1!$AF$17,Sheet1!AF18,IF($B$57=Sheet1!$AG$17,Sheet1!AG18, _\n    IF($B$57=Sheet1!$AH$17,Sheet1!AH18,IF($B$57=Sheet1!$AI$17,Sheet1!AI18, _\n    IF($B$57=Sheet1!$AJ$17,Sheet1!AJ18,IF($B$57=Sheet1!$AK$17,Sheet1!AK18, _\n    IF($B$57=Sheet1!$AL$17,Sheet1!AL18,IF($B$57=Sheet1!$AM$17,Sheet1!AM18, _\n    IF($B$57=Sheet1!$AN$17,Sheet1!AN18,IF($B$57=Sheet1!$AO$17,Sheet1!AO18, _\n    IF($B$57=Sheet1!$AP$17,Sheet1!AP18, _\n    IF($B$57=Sheet1!$AQ$17,Sheet1!AQ18,\"\")))))))))))))))))))))))))))))) = \"\"Mixer_11\"\",\"\"\"\")\"\n    .IgnoreBlank = True\n    .InCellDropdown = True\n    .InputTitle = \"\"\n    .ErrorTitle = \"\"\n    .InputMessage = \"\"\n    .ErrorMessage = \"\"\n    .ShowInput = True\n    .ShowError = True\nEnd With\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["vba", "excel", "installation", "add-in"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1538513354, "post_id": 52615882, "comment_id": 92166629, "body": "Did you generate a CustomUI.xml file for the XLAM?"}, {"owner": {"reputation": 45, "user_id": 10330978, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nTtrJ7B0gjk/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOGr1ISGWGvL1u1uJwHg9AAwD9-vA/mo/photo.jpg?sz=128", "display_name": "hunter stevens", "link": "https://stackoverflow.com/users/10330978/hunter-stevens"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1538598332, "post_id": 52615882, "comment_id": 92203528, "body": "No I did not, but I can research more into what that exactly means and how to do it. Thank you."}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 1, "creation_date": 1538598479, "post_id": 52615882, "comment_id": 92203601, "body": "You can start <a href=\"http://www.rondebruin.nl/win/s2/win001.htm\" rel=\"nofollow noreferrer\">here</a>"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 10330978, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nTtrJ7B0gjk/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOGr1ISGWGvL1u1uJwHg9AAwD9-vA/mo/photo.jpg?sz=128", "display_name": "hunter stevens", "link": "https://stackoverflow.com/users/10330978/hunter-stevens"}, "edited": false, "score": 0, "creation_date": 1538585336, "post_id": 52618982, "comment_id": 92197235, "body": "This is great. Thank you for your comment and your video. I am somewhat of a novice when it comes to advanced Macro operations like this so I will have to study your answer to see if I can get it to work for me. Thank you."}, {"owner": {"reputation": 45, "user_id": 10330978, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nTtrJ7B0gjk/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOGr1ISGWGvL1u1uJwHg9AAwD9-vA/mo/photo.jpg?sz=128", "display_name": "hunter stevens", "link": "https://stackoverflow.com/users/10330978/hunter-stevens"}, "edited": false, "score": 0, "creation_date": 1539272425, "post_id": 52618982, "comment_id": 92450977, "body": "I was able to use the bat file to copy an XLAM from my AddIns folder to my XLSTART folder. However, when I start Excel, the new Macro is nowhere to be found. How can I get it to show up on the ribbon as yours does? Also, my Excel did not start automatically when I clicked the BAT file as yours did."}, {"owner": {"reputation": 2682, "user_id": 9059424, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ez4b8InqhCI/AAAAAAAAAAI/AAAAAAAAAWE/IY8n6L2OBQk/photo.jpg?sz=128", "display_name": "aduguid", "link": "https://stackoverflow.com/users/9059424/aduguid"}, "reply_to_user": {"reputation": 45, "user_id": 10330978, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nTtrJ7B0gjk/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOGr1ISGWGvL1u1uJwHg9AAwD9-vA/mo/photo.jpg?sz=128", "display_name": "hunter stevens", "link": "https://stackoverflow.com/users/10330978/hunter-stevens"}, "edited": false, "score": 1, "creation_date": 1539289900, "post_id": 52618982, "comment_id": 92459702, "body": "The ribbon in Excel is created with XML. The hyperlinks in the first part of my answer will show you how to create the ribbon. I used a shortcut key to start Excel."}, {"owner": {"reputation": 45, "user_id": 10330978, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nTtrJ7B0gjk/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOGr1ISGWGvL1u1uJwHg9AAwD9-vA/mo/photo.jpg?sz=128", "display_name": "hunter stevens", "link": "https://stackoverflow.com/users/10330978/hunter-stevens"}, "edited": false, "score": 0, "creation_date": 1539348376, "post_id": 52618982, "comment_id": 92481203, "body": "I&#39;ve been able to create my own custom ribbon with working macros using the custom UI editor, but my goal is to streamline the macro addition process for people who are not excel savvy. I like how clicking the BAT file simplifies the process of moving the file for them. But how do I simplify the addition of the macro to the ribbon process for them?"}, {"owner": {"reputation": 2682, "user_id": 9059424, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ez4b8InqhCI/AAAAAAAAAAI/AAAAAAAAAWE/IY8n6L2OBQk/photo.jpg?sz=128", "display_name": "aduguid", "link": "https://stackoverflow.com/users/9059424/aduguid"}, "reply_to_user": {"reputation": 45, "user_id": 10330978, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nTtrJ7B0gjk/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOGr1ISGWGvL1u1uJwHg9AAwD9-vA/mo/photo.jpg?sz=128", "display_name": "hunter stevens", "link": "https://stackoverflow.com/users/10330978/hunter-stevens"}, "edited": false, "score": 1, "creation_date": 1539353265, "post_id": 52618982, "comment_id": 92483966, "body": "Do you want to add buttons to the ribbon with macros? The .bat will overwrite the file on end-user machines if you&#39;re talking about version control."}, {"owner": {"reputation": 2682, "user_id": 9059424, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ez4b8InqhCI/AAAAAAAAAAI/AAAAAAAAAWE/IY8n6L2OBQk/photo.jpg?sz=128", "display_name": "aduguid", "link": "https://stackoverflow.com/users/9059424/aduguid"}, "reply_to_user": {"reputation": 45, "user_id": 10330978, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nTtrJ7B0gjk/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOGr1ISGWGvL1u1uJwHg9AAwD9-vA/mo/photo.jpg?sz=128", "display_name": "hunter stevens", "link": "https://stackoverflow.com/users/10330978/hunter-stevens"}, "edited": false, "score": 1, "creation_date": 1539566417, "post_id": 52618982, "comment_id": 92535237, "body": "@hunterstevens were you able to get the ribbon up and running?"}, {"owner": {"reputation": 45, "user_id": 10330978, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nTtrJ7B0gjk/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOGr1ISGWGvL1u1uJwHg9AAwD9-vA/mo/photo.jpg?sz=128", "display_name": "hunter stevens", "link": "https://stackoverflow.com/users/10330978/hunter-stevens"}, "edited": false, "score": 0, "creation_date": 1539633411, "post_id": 52618982, "comment_id": 92564881, "body": "I would like to others to be able to add a working macro button to the ribbon as simply as possible. Which file does the .bat overwrite, and what do you mean by overwrite?"}, {"owner": {"reputation": 2682, "user_id": 9059424, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ez4b8InqhCI/AAAAAAAAAAI/AAAAAAAAAWE/IY8n6L2OBQk/photo.jpg?sz=128", "display_name": "aduguid", "link": "https://stackoverflow.com/users/9059424/aduguid"}, "reply_to_user": {"reputation": 45, "user_id": 10330978, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nTtrJ7B0gjk/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOGr1ISGWGvL1u1uJwHg9AAwD9-vA/mo/photo.jpg?sz=128", "display_name": "hunter stevens", "link": "https://stackoverflow.com/users/10330978/hunter-stevens"}, "edited": false, "score": 1, "creation_date": 1539635971, "post_id": 52618982, "comment_id": 92566004, "body": "<code>&#47;Y</code> in the .bat file will always copy the source file to the target. I&#39;ll post an example on GitHub for you with the ribbon in about 3 hours."}, {"owner": {"reputation": 2682, "user_id": 9059424, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ez4b8InqhCI/AAAAAAAAAAI/AAAAAAAAAWE/IY8n6L2OBQk/photo.jpg?sz=128", "display_name": "aduguid", "link": "https://stackoverflow.com/users/9059424/aduguid"}, "reply_to_user": {"reputation": 45, "user_id": 10330978, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nTtrJ7B0gjk/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOGr1ISGWGvL1u1uJwHg9AAwD9-vA/mo/photo.jpg?sz=128", "display_name": "hunter stevens", "link": "https://stackoverflow.com/users/10330978/hunter-stevens"}, "edited": false, "score": 1, "creation_date": 1539644353, "post_id": 52618982, "comment_id": 92568359, "body": "Direct link for file <a href=\"https://github.com/StackOverflow-projects/52615882/raw/master/Example.xlsm?raw=true\" rel=\"nofollow noreferrer\">github.com/StackOverflow-projects/52615882/raw/master/&hellip;</a>"}, {"owner": {"reputation": 45, "user_id": 10330978, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nTtrJ7B0gjk/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOGr1ISGWGvL1u1uJwHg9AAwD9-vA/mo/photo.jpg?sz=128", "display_name": "hunter stevens", "link": "https://stackoverflow.com/users/10330978/hunter-stevens"}, "edited": false, "score": 0, "creation_date": 1539694286, "post_id": 52618982, "comment_id": 92587822, "body": "@auguid, Thank you for your help throughout this process. I will review your github link as soon as I can. I have already marked your answer as accepted and just upvoted all of your comments as a thank you."}, {"owner": {"reputation": 2682, "user_id": 9059424, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ez4b8InqhCI/AAAAAAAAAAI/AAAAAAAAAWE/IY8n6L2OBQk/photo.jpg?sz=128", "display_name": "aduguid", "link": "https://stackoverflow.com/users/9059424/aduguid"}, "reply_to_user": {"reputation": 45, "user_id": 10330978, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nTtrJ7B0gjk/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOGr1ISGWGvL1u1uJwHg9AAwD9-vA/mo/photo.jpg?sz=128", "display_name": "hunter stevens", "link": "https://stackoverflow.com/users/10330978/hunter-stevens"}, "edited": false, "score": 1, "creation_date": 1539696025, "post_id": 52618982, "comment_id": 92588959, "body": "No worries mate :)"}], "tags": [], "owner": {"reputation": 2682, "user_id": 9059424, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ez4b8InqhCI/AAAAAAAAAAI/AAAAAAAAAWE/IY8n6L2OBQk/photo.jpg?sz=128", "display_name": "aduguid", "link": "https://stackoverflow.com/users/9059424/aduguid"}, "is_accepted": true, "score": 5, "last_activity_date": 1542678489, "last_edit_date": 1542678489, "creation_date": 1538534424, "answer_id": 52618982, "question_id": 52615882, "link": "https://stackoverflow.com/questions/52615882/how-do-i-automatically-add-custom-macro-add-in-to-toolbar-ribbon-after-adding-it/52618982#52618982", "title": "How do I automatically add custom Macro Add-in to toolbar/ribbon after adding it in?", "body": "<h2>Microsoft Excel Ribbon</h2>\n\n<p>To create create/edit the ribbon in Excel use <a href=\"https://www.rondebruin.nl/win/winfiles/OfficeCustomUIEditorSetup.zip\" rel=\"nofollow noreferrer\">Custom UI Editor Tool</a>. Here are some sources for creating the XML:</p>\n\n<ul>\n<li><a href=\"https://www.rondebruin.nl/win/s2/win001.htm\" rel=\"nofollow noreferrer\">Microsoft Excel Automation</a></li>\n<li><a href=\"https://github.com/Excel-projects\" rel=\"nofollow noreferrer\">Microsoft Excel Automation Examples</a></li>\n<li><a href=\"https://docs.microsoft.com/en-us/visualstudio/vsto/ribbon-xml?view=vs-2017\" rel=\"nofollow noreferrer\">Microsoft Office Ribbon XML</a></li>\n<li><a href=\"https://docs.microsoft.com/en-us/visualstudio/vsto/walkthrough-creating-a-custom-tab-by-using-ribbon-xml?view=vs-2017\" rel=\"nofollow noreferrer\">Walkthrough: Create a custom tab by using Ribbon XML</a></li>\n</ul>\n\n<hr>\n\n<h2>To Install an Excel VBA Add-In</h2>\n\n<p>I use <a href=\"https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/xcopy\" rel=\"nofollow noreferrer\">XCOPY</a> in a .bat file for installing my .xlam files to user machines. I'll setup a folder on a network share e.g. <code>S:\\Addins\\MyFancyMacroAddin</code> and put the .xlam and .bat file in it. Then I distribute a shortcut to the .bat file to the end-users. It copies the file from the current directory to the <a href=\"https://support.office.com/en-us/article/customize-how-excel-starts-6509b9af-2cc8-4fb6-9ef5-cf5f1d292c19\" rel=\"nofollow noreferrer\">XLSTART</a> folder on their machine. </p>\n\n<blockquote>\n  <p>You can click on the animation below to view it a bit easier.</p>\n</blockquote>\n\n<h3>Example:</h3>\n\n<p><a href=\"https://i.stack.imgur.com/x0vvm.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/x0vvm.gif\" alt=\"example\"></a></p>\n\n<h3>Code:</h3>\n\n<pre><code>@ECHO OFF\n\nREM |--------------------------------------------------------------------------------------------------------------------\nREM | Purpose:  Generic Excel Addin Install\nREM |--------------------------------------------------------------------------------------------------------------------\n\n\nREM\nREM     /E   = Copies directories and sub-directories, including empty ones. Same as /S /E. May be used to modify /T. \nREM     /D:m-d-y = Copies files changed on or after the specified date. \nREM        If no date is given, copies only those files whose source time is newer than the destination time. \nREM     /K   = Copies attributes. Normal Xcopy will reset read-only attributes. \nREM     /Q   = Does not display file names while copying. \nREM     /R   = Overwrites read-only files. \nREM     /Y   = Suppresses prompting to confirm you want to overwrite an existing destination file. \nREM\n\nREM Copy the install directory and sub-directories\nREM echo f | XCOPY \".\\MyFancyMacroAddin.xlam\" \"%AppData%\\Microsoft\\AddIns\\MyFancyMacroAddin.xlam\" /E /K /Q /R /Y /D\n    echo f | XCOPY \".\\MyFancyMacroAddin.xlam\" \"%AppData%\\Microsoft\\Excel\\XLSTART\\MyFancyMacroAddin.xlam\" /E /K /Q /R /Y /D\nREM echo f | XCOPY \".\\MyFancyMacroAddin.xlam\" \"%AppData%\\Roaming\\Microsoft\\Excel\\XLSTART\\MyFancyMacroAddin.xlam\" /E /K /Q /R /Y /D\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 10330978, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nTtrJ7B0gjk/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOGr1ISGWGvL1u1uJwHg9AAwD9-vA/mo/photo.jpg?sz=128", "display_name": "hunter stevens", "link": "https://stackoverflow.com/users/10330978/hunter-stevens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3328, "favorite_count": 4, "accepted_answer_id": 52618982, "answer_count": 1, "score": 2, "last_activity_date": 1542678489, "creation_date": 1538511828, "last_edit_date": 1538633363, "question_id": 52615882, "link": "https://stackoverflow.com/questions/52615882/how-do-i-automatically-add-custom-macro-add-in-to-toolbar-ribbon-after-adding-it", "title": "How do I automatically add custom Macro Add-in to toolbar/ribbon after adding it in?", "body": "<p>How do I make adding in a custom Macro XLAM file as quick and simple as possible?</p>\n\n<p>I have a macro saved as a XLAM file. I want other non-Excel-savvy people I work to be able to download the XLAM file, add it in like you would with any other add-in (e.g. Solver) and have it be a simple fool-proof process.</p>\n\n<p>However, currently it involves adding it in, then going to the <em>file > options > customize ribbon > Macros > MyFancyMacroAddin</em>. Then clicking on the add in, then creating a new tab and sub group, to which the add-in can me moved from the left column to the right column. This is a long, error-prone process. Whenever I add in something like Solver, it just pops up in my toolbar after adding it in. However, it requires more steps it seems when doing a custom XLAM.</p>\n\n<p>Any input would be greatly appreciated. </p>\n"}, {"tags": ["excel", "vba", "excel-formula", "excel-2007"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 5, "creation_date": 1538511895, "post_id": 52615858, "comment_id": 92166038, "body": "Did you try sumifs()?"}, {"owner": {"reputation": 11, "user_id": 8515831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10997713073089d6406ca4d68ef79eeb?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/8515831/daniel"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1538512597, "post_id": 52615858, "comment_id": 92166350, "body": "I already tried using countif. I don&#39;t know how to make a universal formula that&#39;d compare each row&#39;s &quot;type&quot; column and count the &quot;amount&quot; only if the type fit the criteria. If you know how to do so, please share it with me."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1538513080, "post_id": 52615858, "comment_id": 92166538, "body": "Per your own words, you need &quot;the sum of the &#39;amount&#39; for all &#39;ranged&#39; cards&quot; - that&#39;s <i>precisely</i> what <code>SUMIF</code>/<code>SUMIFS</code> does. <i>Did you try it?</i>"}, {"owner": {"reputation": 865, "user_id": 10361731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8873db235bacaa9d53de9c31a0b8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Jchang43", "link": "https://stackoverflow.com/users/10361731/jchang43"}, "edited": false, "score": 0, "creation_date": 1538513186, "post_id": 52615858, "comment_id": 92166574, "body": "Sumif() would add the values of the cards as you specified in your question, not just count the number of cells. You can check out the documentation <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheetfunction.sumif\" rel=\"nofollow noreferrer\">here</a> and <a href=\"https://www.techrepublic.com/blog/microsoft-office/use-wildcards-with-sumif-to-create-a-powerful-excel-function/\" rel=\"nofollow noreferrer\">this</a> explains how to combine the function with wildcards"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1538513708, "post_id": 52615858, "comment_id": 92166760, "body": "I&#39;m voting to close as &quot;unclear&quot;, since the title is about <i>multiplying</i>, the body is about <i>counting</i>, and the apparent requirement everybody understands is about <i>adding</i>. Please <a href=\"https://stackoverflow.com/posts/52615858/edit\">edit</a> to clarify - also note, vertical=column, horizontal=row."}, {"owner": {"reputation": 11, "user_id": 8515831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10997713073089d6406ca4d68ef79eeb?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/8515831/daniel"}, "edited": false, "score": 0, "creation_date": 1538513830, "post_id": 52615858, "comment_id": 92166804, "body": "Added additional clarification at the end. I need to compare individual entries. How can I compare two arrays, with only the entries in the same row being compared?"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1538514043, "post_id": 52615858, "comment_id": 92166893, "body": "@Daniel please don&#39;t use comments but <a href=\"https://stackoverflow.com/questions/52615858/how-to-multiply-values-in-the-same-column#\">edit your question</a> if you want to add more info. And please answer the people who asked you if you tried <code>SUMIF</code>."}, {"owner": {"reputation": 11, "user_id": 8515831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10997713073089d6406ca4d68ef79eeb?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/8515831/daniel"}, "edited": false, "score": 0, "creation_date": 1538514398, "post_id": 52615858, "comment_id": 92167022, "body": "I apologize, as I am very bad at asking questions in text form. But In the table example, If I wanted to count the number of &quot;ranged&quot; cards, the result should be 6, as I have 1 &quot;Archgriffins,&quot; 3 &quot;Barghests&quot; and 2 &quot;Bruxae&quot; How can I achieve this with a formula, is what I am asking. Is it clear? I swear, this happenes every time I post on here."}, {"owner": {"reputation": 11, "user_id": 8515831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10997713073089d6406ca4d68ef79eeb?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/8515831/daniel"}, "edited": false, "score": 0, "creation_date": 1538515584, "post_id": 52615858, "comment_id": 92167457, "body": "Is it okay to reformat and repost this question? I don&#39;t know how spam rules work on this site."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8515831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10997713073089d6406ca4d68ef79eeb?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/8515831/daniel"}, "edited": false, "score": 0, "creation_date": 1538517259, "post_id": 52616880, "comment_id": 92168057, "body": "Thanks! This seemingly works! I am using a different localization, so for me it&#39;s semicolons, not commas."}, {"owner": {"reputation": 657, "user_id": 2390974, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/GNH1d.jpg?s=128&g=1", "display_name": "dsutherland", "link": "https://stackoverflow.com/users/2390974/dsutherland"}, "edited": false, "score": 0, "creation_date": 1583786694, "post_id": 52616880, "comment_id": 107226425, "body": "Thank you! Solved my problem.  Whoever down voted this was clearly confused"}], "tags": [], "owner": {"reputation": 341, "user_id": 6581671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2a9d63e8f02894d76620754c080f16c?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher", "link": "https://stackoverflow.com/users/6581671/christopher"}, "is_accepted": true, "score": 0, "last_activity_date": 1538516809, "creation_date": 1538516809, "answer_id": 52616880, "question_id": 52615858, "link": "https://stackoverflow.com/questions/52615858/how-to-sum-values-in-the-same-column-based-on-other-values-in-the-same-row/52616880#52616880", "title": "How to sum values in the same column based on other values in the same row", "body": "<p>Most of your problems with the function could be solved by looking at the documentation of the <code>SUMIFS</code> function <a href=\"https://support.office.com/en-us/article/sum-values-based-on-multiple-conditions-e610ae0f-4d27-480c-9119-eb644f1e847e\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>Your sumifs statement above is using the wrong syntax. You should be using commas, not semicolons, your equal sign sould also be a comma, and you should not use an asterisk infront of \"ranged\". Then your formula would work just fine.</p>\n\n<p>If the above image showed Columns A, B and C, it would be someting like this </p>\n\n<pre><code> =SUMIFS(C:C,B:B,\"ranged\")\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8515831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10997713073089d6406ca4d68ef79eeb?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/8515831/daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1542, "favorite_count": 0, "accepted_answer_id": 52616880, "answer_count": 1, "score": -2, "last_activity_date": 1538516934, "creation_date": 1538511722, "last_edit_date": 1538516934, "question_id": 52615858, "link": "https://stackoverflow.com/questions/52615858/how-to-sum-values-in-the-same-column-based-on-other-values-in-the-same-row", "title": "How to sum values in the same column based on other values in the same row", "body": "<p>I have three columns in an Excel spreadsheet: name, type and amount. (I have more, but the others aren't relevant to this problem). Each row contains the name of a playing card, its type and the number of copies included in the deck as such:</p>\n\n<p><img src=\"https://i.stack.imgur.com/K609O.jpg\" alt=\"Table example image\"></p>\n\n<p>In other cells outside this table, I have the total amount of cards. For example, the total amount of cards with the type \"ranged\".</p>\n\n<pre><code>=COUNTIF(D2:D70; \"*ranged*\")\n</code></pre>\n\n<p>What this shows me is only how many distinct cards there are with the type \"ranged,\" but not how many cards with \"ranged\" would actually be included in the deck.</p>\n\n<p>What I would like is a way to count the number of \"ranged\" cards. Meaning, the sum of the \"amount\" of all \"ranged\" cards.</p>\n\n<p>In a for loop, this would be: If Type in row 2 = \"ranged,\" add Amount in row 2 to the total, then repeat this operation for all rows.</p>\n\n<p>I already did this with VBA, however, I have to update it manually. Also, I cannot have multiple different values in the \"type\" column, because x has to be 100% equal to the content of the cell in order to register it.</p>\n\n<pre><code>Sub Cardtypetotal()\n result = 0\n x = InputBox(\"SortBy\", \"Enter_Info\")\n  For i = 2 To 63\n   If Cells(i, 3).value = x Then\n    result = result + Cells(i, 5).value\n   End If\n  Next\n ActiveCell.value = result\nEnd Sub\n</code></pre>\n\n<p>Is there a way to do this with excel formulas? Thank you.</p>\n\n<p>I tried using:</p>\n\n<pre><code>=SUMIF(E2:E63; D2:D63 = \"*ranged*\")\n</code></pre>\n\n<p>But obviously, this counts nothing, as I need to compare individual cells, not arrays.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 188, "user_id": 6400144, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/226f717105f9cf7442c8f26eaaaadbd7?s=128&d=identicon&r=PG&f=1", "display_name": "fabio.avigo", "link": "https://stackoverflow.com/users/6400144/fabio-avigo"}, "edited": false, "score": 2, "creation_date": 1538513045, "post_id": 52615824, "comment_id": 92166525, "body": "On what line does the error occur? It might be because of an incompatibility between versions. Keep in mind that recorded macros are a resource mostly used when learning VBA and its syntax. In order to reuse your code, it&#39;s best to refactor it."}, {"owner": {"reputation": 21, "user_id": 10424685, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YDhyv8xAj6I/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVxd2Dw7bA1dM-qIGk-vYfl8dKF4g/mo/photo.jpg?sz=128", "display_name": "Wade Proudlock", "link": "https://stackoverflow.com/users/10424685/wade-proudlock"}, "reply_to_user": {"reputation": 188, "user_id": 6400144, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/226f717105f9cf7442c8f26eaaaadbd7?s=128&d=identicon&r=PG&f=1", "display_name": "fabio.avigo", "link": "https://stackoverflow.com/users/6400144/fabio-avigo"}, "edited": false, "score": 0, "creation_date": 1538576999, "post_id": 52615824, "comment_id": 92192146, "body": "If fails here;    <code>ActiveWorkbook.Worksheets(&quot;Open Orders&quot;).ListObjects(&quot;Table2&quot;).Sort.SortFields. _         Add2 Key:=Range(&quot;Table2[Customer No.]&quot;), SortOn:=xlSortOnValues, Order:= _         xlAscending, DataOption:=xlSortNormal</code>"}], "answers": [{"comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 21, "user_id": 10424685, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YDhyv8xAj6I/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVxd2Dw7bA1dM-qIGk-vYfl8dKF4g/mo/photo.jpg?sz=128", "display_name": "Wade Proudlock", "link": "https://stackoverflow.com/users/10424685/wade-proudlock"}, "edited": false, "score": 0, "creation_date": 1538580464, "post_id": 52616536, "comment_id": 92194568, "body": "@WadeProudlock - on what line? I suspect it may be the lines that define the sort range. Try this instead: <code>myTable.ListColumns(&quot;Customer No.&quot;).DataBodyRange</code> or you may need to reference the entire range including header."}, {"owner": {"reputation": 21, "user_id": 10424685, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YDhyv8xAj6I/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVxd2Dw7bA1dM-qIGk-vYfl8dKF4g/mo/photo.jpg?sz=128", "display_name": "Wade Proudlock", "link": "https://stackoverflow.com/users/10424685/wade-proudlock"}, "edited": false, "score": 0, "creation_date": 1538595550, "post_id": 52616536, "comment_id": 92202281, "body": "You were right. This is now working with the <code>.DataBodyRange</code> edit.  <code>.Add Key:=myTable.ListColumns(&quot;Customer No.&quot;).DataBodyRange, SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal .Add Key:=myTable.ListColumns(&quot;PO #&quot;).DataBodyRange, SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal</code>  Thank you so much for your help!"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 2, "last_activity_date": 1538603610, "last_edit_date": 1538603610, "creation_date": 1538515068, "answer_id": 52616536, "question_id": 52615824, "link": "https://stackoverflow.com/questions/52615824/sort-recorded-in-2016-generates-error-438-object-doesnt-support-this-property/52616536#52616536", "title": "Sort recorded in 2016 generates &quot;Error 438. Object doesn&#39;t support this property or method&quot; in 2010", "body": "<p>The code you have doesn't look like it would bomb on either version of Excel, but refactoring it for better coding practices will surely help (as fabio alluded to).</p>\n\n<p>Try this:</p>\n\n<pre><code>Dim myTable as ListObject\nSet myTable = ThisWorkbook.Worksheets(\"Open Orders\").ListObjects(\"Table2\")\n\nWith myTable.Sort\n\n    With .SortFields\n         .Clear\n         .Add Key:=myTable.ListColumns(\"Customer No.\").DataBodyRange, SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n         .Add Key:=myTable.ListColumns(\"PO '#\").DataBodyRange, SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n    End With\n\n   .Header = xlYes\n   .MatchCase = False\n   .Orientation = xlTopToBottom\n   .SortMethod = xlPinYin\n   .Apply\n\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 10424685, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YDhyv8xAj6I/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVxd2Dw7bA1dM-qIGk-vYfl8dKF4g/mo/photo.jpg?sz=128", "display_name": "Wade Proudlock", "link": "https://stackoverflow.com/users/10424685/wade-proudlock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 411, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1549836044, "creation_date": 1538511563, "last_edit_date": 1549836044, "question_id": 52615824, "link": "https://stackoverflow.com/questions/52615824/sort-recorded-in-2016-generates-error-438-object-doesnt-support-this-property", "title": "Sort recorded in 2016 generates &quot;Error 438. Object doesn&#39;t support this property or method&quot; in 2010", "body": "<p>I recorded a macro for a 2 column sort, that works, on Excel 2016.</p>\n\n<p>I get the following error on Excel 2010.</p>\n\n<blockquote>\n  <p>Error 438. Object doesn't support this property or method.</p>\n</blockquote>\n\n<p>What is not acceptable for the 2010 version of Excel?</p>\n\n<pre><code>Sub SortOpenOrder()\n'\n' Macro1 Macro\n'\n\n'\n    Range(\"Table2[[#Headers],[Customer No.]]\").Select\n    Range(Selection, Selection.End(xlToRight)).Select\n    Range(Selection, Selection.End(xlDown)).Select\n    ActiveWorkbook.Worksheets(\"Open Orders\").ListObjects(\"Table2\").Sort.SortFields. _\n        Clear\n    ActiveWorkbook.Worksheets(\"Open Orders\").ListObjects(\"Table2\").Sort.SortFields. _\n        Add2 Key:=Range(\"Table2[Customer No.]\"), SortOn:=xlSortOnValues, Order:= _\n        xlAscending, DataOption:=xlSortNormal\n    ActiveWorkbook.Worksheets(\"Open Orders\").ListObjects(\"Table2\").Sort.SortFields. _\n        Add2 Key:=Range(\"Table2[PO '#]\"), SortOn:=xlSortOnValues, Order:= _\n        xlAscending, DataOption:=xlSortNormal\n    With ActiveWorkbook.Worksheets(\"Open Orders\").ListObjects(\"Table2\").Sort\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n    Range(\"Table2[[#Headers],[Customer No.]]\").Select\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 3, "creation_date": 1538511780, "post_id": 52615816, "comment_id": 92165989, "body": "What have you tried so far? Even if it didn&#39;t work, it&#39;s worth <a href=\"https://stackoverflow.com/posts/52615816/edit\">editing your question</a> and posting it as it will save us going over already covered ground."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1538512599, "post_id": 52615816, "comment_id": 92166352, "body": "Are you having trouble filtering the list, or converting the results into the image?"}, {"owner": {"reputation": 2041, "user_id": 5040775, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10207130495004756/picture?type=large", "display_name": "Jun Jang", "link": "https://stackoverflow.com/users/5040775/jun-jang"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1538512631, "post_id": 52615816, "comment_id": 92166361, "body": "@Comintern I am having trouble writing the code that filters the list.. not converting the result into the image."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 4, "creation_date": 1538514695, "post_id": 52615816, "comment_id": 92167129, "body": "Please read <a href=\"https://meta.stackoverflow.com/q/284236/1188513\"><i>Why is \u201cCan someone help me?\u201d not an actual question?</i></a>"}], "answers": [{"comments": [{"owner": {"reputation": 5038, "user_id": 4552529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7dff9245051269e55748c81670088e8?s=128&d=identicon&r=PG&f=1", "display_name": "Wizhi", "link": "https://stackoverflow.com/users/4552529/wizhi"}, "edited": false, "score": 0, "creation_date": 1540067389, "post_id": 52906782, "comment_id": 92730391, "body": "If you want to replace your new table with your old at the same column, I would just delete Column A with the old data. Add this to the vba code after <code>Next i</code>: <code>Columns(1).EntireColumn.Delete</code>"}], "tags": [], "owner": {"reputation": 5038, "user_id": 4552529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7dff9245051269e55748c81670088e8?s=128&d=identicon&r=PG&f=1", "display_name": "Wizhi", "link": "https://stackoverflow.com/users/4552529/wizhi"}, "is_accepted": true, "score": 1, "last_activity_date": 1540067576, "last_edit_date": 1540067576, "creation_date": 1540046208, "answer_id": 52906782, "question_id": 52615816, "link": "https://stackoverflow.com/questions/52615816/getting-a-list-of-cells-that-contain-substring-using-vba/52906782#52906782", "title": "Getting a list of cells that contain substring using VBA", "body": "<p>You say generate a list... So I assume you won't override your old data. </p>\n\n<p>This code checks for the two values in worksheet \"Sheet1\". Then compares the two values you define against the cell value in your data (your data is assumed to be in Column A, from row 1 and downwards). If either of defined values exist in the cell (apple or berry, regardless of small/big letters), it's considered a match. If match is found it will copy the value to the first empty row in Column B.</p>\n\n<p><strong>VBA Code:</strong></p>\n\n<pre><code>Sub SearchAndExtract()\n\nDim lrow As Long\nDim lrowNewList As Long\nDim i As Long\nDim lookupValue As String\nDim lookupValue2 As String\nDim currentValue As String\nDim MySheet As Worksheet\nSet MySheet = ActiveWorkbook.Worksheets(\"Sheet1\")\n\nlookupValue = \"*apple*\" 'First name you want to search for. Use * for wildcard\nlookupValue2 = \"*berry*\" 'Second name you want to search for. Use * for wildcard\n\nlrow = MySheet.Cells(Rows.Count, \"A\").End(xlUp).Row 'Find last row in your data column\nlrowNewList = MySheet.Cells(Rows.Count, \"B\").End(xlUp).Row 'Find last row in the column you want to paste to\n\nFor i = 1 To lrow 'From Row 1 to last row in the column where you want to check your data\n    currentValue = MySheet.Cells(i, \"A\").Value 'Define the string value you have in your current cell\n    If LCase$(currentValue) Like LCase$(lookupValue) Or _\n       LCase$(currentValue) Like LCase$(lookupValue2) Then 'LCase for case sensitivity, it check the current cell against the two lookup values. If either of those are find, then\n            MySheet.Cells(lrowNewList, \"B\") = MySheet.Cells(i, \"A\") 'Copy from current cell in column a to last blank cell in column B\n            lrowNewList = lrowNewList + 1\n    End If\nNext i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2041, "user_id": 5040775, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10207130495004756/picture?type=large", "display_name": "Jun Jang", "link": "https://stackoverflow.com/users/5040775/jun-jang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 374, "favorite_count": 0, "accepted_answer_id": 52906782, "answer_count": 1, "score": -1, "last_activity_date": 1540067576, "creation_date": 1538511517, "question_id": 52615816, "link": "https://stackoverflow.com/questions/52615816/getting-a-list-of-cells-that-contain-substring-using-vba", "title": "Getting a list of cells that contain substring using VBA", "body": "<p>I am wondering how I can generate a list of cells in Excel file that contain a given substring using VBA. This should be able to find the cells regardless of the upper/lower case. </p>\n\n<p>An example is:</p>\n\n<p><a href=\"https://i.stack.imgur.com/CGLoI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CGLoI.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/q48XJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/q48XJ.png\" alt=\"enter image description here\"></a></p>\n\n<p>Given the user-defined inputs (apple and berry), it sholud return the second picture.</p>\n\n<p>How do I do this in VBA?</p>\n"}, {"tags": ["xml", "vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1538511579, "post_id": 52615609, "comment_id": 92165867, "body": "Can you share the XML and a the corresponding word along with desired answer?"}, {"owner": {"reputation": 3, "user_id": 10448054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c891a549baa7971e2271ad2e16d4a4?s=128&d=identicon&r=PG&f=1", "display_name": "Luke991", "link": "https://stackoverflow.com/users/10448054/luke991"}, "edited": false, "score": 0, "creation_date": 1538511654, "post_id": 52615609, "comment_id": 92165916, "body": "Sorry. I&#39;m still a bit new here. How can I post the response if it is longer than the given max of characters?"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1538511904, "post_id": 52615609, "comment_id": 92166044, "body": "We only need a sample XML (i.e., the M in <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>). Give us 1-3 repeating XML nodes and cut out the rest, making sure you include root and its end closing tag."}, {"owner": {"reputation": 3, "user_id": 10448054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c891a549baa7971e2271ad2e16d4a4?s=128&d=identicon&r=PG&f=1", "display_name": "Luke991", "link": "https://stackoverflow.com/users/10448054/luke991"}, "edited": false, "score": 0, "creation_date": 1538512508, "post_id": 52615609, "comment_id": 92166309, "body": "Thank you for your fast reply! I just edited the question."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10448054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c891a549baa7971e2271ad2e16d4a4?s=128&d=identicon&r=PG&f=1", "display_name": "Luke991", "link": "https://stackoverflow.com/users/10448054/luke991"}, "edited": false, "score": 0, "creation_date": 1538514937, "post_id": 52616109, "comment_id": 92167214, "body": "Thank you, guys. I was really stuck here. &lt;3"}], "tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": true, "score": 0, "last_activity_date": 1538512980, "creation_date": 1538512980, "answer_id": 52616109, "question_id": 52615609, "link": "https://stackoverflow.com/questions/52615609/extracting-elements-from-xml-file-using-vba/52616109#52616109", "title": "Extracting elements from XML file using VBA", "body": "<p>Here's how you can extract information from the XML response. From here, you can drop the response data into cells or a range or your choice. The key is to step into your response XML and access the attributes for the tag you're searching.</p>\n\n<p>(The hard-coded input uses a word known to respond with a synonym list.)</p>\n\n<pre><code>Option Explicit\n\nSub get_synonym()\n    Dim XMLReq As New MSXML2.XMLHTTP60\n    Dim wort As String\n    Dim ant_wort As String\n\n    wort = \"beginnen\"\n    'wort = InputBox(\"What word would you like to get checked?\")\n\n    'function'\n    XMLReq.Open \"GET\", \"https://www.openthesaurus.de/synonyme/search?q=\" &amp; wort &amp; \"&amp;format=text/xml\", False\n    XMLReq.send\n    If XMLReq.Status &lt;&gt; 200 Then\n        MsgBox (\"Problem\" &amp; vbNewLine &amp; XMLReq.Status &amp; \" - \" &amp; XMLReq.statusText)\n        Exit Sub\n    End If\n\n    Dim xmlNode As MSXML2.IXMLDOMNode\n    For Each xmlNode In XMLReq.responseXML.SelectNodes(\"//matches/synset/term\")\n        Debug.Print xmlNode.Attributes(0).nodeTypedValue\n    Next xmlNode\n    Debug.Print \"done.\"\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 10448054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c891a549baa7971e2271ad2e16d4a4?s=128&d=identicon&r=PG&f=1", "display_name": "Luke991", "link": "https://stackoverflow.com/users/10448054/luke991"}, "edited": false, "score": 0, "creation_date": 1538513571, "post_id": 52616133, "comment_id": 92166700, "body": "Thanks, man, that looks good. However this gives me the following error message: &quot;Automation Error: The data necessary to complete this operation is not yet available.&quot; What can I do about that?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 3, "user_id": 10448054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c891a549baa7971e2271ad2e16d4a4?s=128&d=identicon&r=PG&f=1", "display_name": "Luke991", "link": "https://stackoverflow.com/users/10448054/luke991"}, "edited": false, "score": 0, "creation_date": 1538515613, "post_id": 52616133, "comment_id": 92167470, "body": "Sorry. It worked for me. Try with async = False and let me know."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1538515628, "last_edit_date": 1538515628, "creation_date": 1538513094, "answer_id": 52616133, "question_id": 52615609, "link": "https://stackoverflow.com/questions/52615609/extracting-elements-from-xml-file-using-vba/52616133#52616133", "title": "Extracting elements from XML file using VBA", "body": "<p>This gets attribute term values</p>\n\n<pre><code>Option Explicit\nPublic Sub get_synonym()\n\n    Dim wort As String\n    wort = \"anklagen\"\n    'wort = InputBox(\"What word would you like to get checked?\")\n\n    Dim xmlDoc   As MSXML2.DOMDocument60\n    Set xmlDoc = New MSXML2.DOMDocument60\n    xmlDoc.async = False\n    xmlDoc.validateOnParse = True\n\n    xmlDoc.Load \"https://www.openthesaurus.de/synonyme/search?q=\" &amp; wort &amp; \"&amp;format=text/xml\"\n    If xmlDoc.parseError.ErrorCode &lt;&gt; 0 Then\n        MsgBox \"Error was \" + xmlDoc.parseError.reason\n    End If\n\n    Dim nodes As Object, node As Object\n    Set nodes = xmlDoc.SelectNodes(\"//term\")\n    For Each node In nodes\n        Debug.Print node.Attributes.getNamedItem(\"term\").Text\n    Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10448054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c891a549baa7971e2271ad2e16d4a4?s=128&d=identicon&r=PG&f=1", "display_name": "Luke991", "link": "https://stackoverflow.com/users/10448054/luke991"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 559, "favorite_count": 0, "accepted_answer_id": 52616109, "answer_count": 2, "score": 0, "last_activity_date": 1538515628, "creation_date": 1538510645, "last_edit_date": 1538512147, "question_id": 52615609, "link": "https://stackoverflow.com/questions/52615609/extracting-elements-from-xml-file-using-vba", "title": "Extracting elements from XML file using VBA", "body": "<p>I am currently trying to construct a function that automatically searches for synonyms from an Excel file using VBA. I was able to retrieve an XML file from an API. However, I was not able to extract the synonyms (tagged with \"term\"). How can I extract the synonyms from the XML file?</p>\n\n<p>this is my current code:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nSub get_synonym()\n   Dim XMLReq As New MSXML2.XMLHTTP60\n   Dim ant_wort As String\n\n   wort = InputBox(\"What word would you like to get checked?\")\n\n   'function'\n   XMLReq.Open \"GET\", \"https://www.openthesaurus.de/synonyme/search?q=\" &amp; wort &amp; \"&amp;format=text/xml\", False\n   XMLReq.send\n   If XMLReq.Status &lt;&gt; 200 Then\n       MsgBox (\"Problem\" &amp; vbNewLine &amp; XMLReq.Status &amp; \" - \" &amp; XMLReq.statusText)\n       Exit Sub\n   End If\n\n   ant_wort = XMLReq.responseText\n   Debug.Print ant_wort\n   ' ### I would like to fill an array with the synonyms at this point'\nEnd Sub\n\nthe xml looks like this:\n&lt;matches&gt;&lt;metaData&gt;&lt;apiVersion content='0.1.3'/&gt;&lt;warning content='WARNING -- this XML format may be extended without warning'/&gt;&lt;copyright content='Copyright (C) 2017 Daniel Naber (www.danielnaber.de)'/&gt;&lt;license content='Creative Commons Attribution-ShareAlike 4.0 or GNU LESSER GENERAL PUBLIC LICENSE Version 2.1'/&gt;&lt;source content='http://www.openthesaurus.de'/&gt;&lt;date content='Tue Oct 02 19:08:27 CEST 2018'/&gt;&lt;/metaData&gt;&lt;synset id='29979'&gt;&lt;categories&gt;&lt;category name='Linguistik/Sprache'/&gt;&lt;/categories&gt;&lt;term term='morphologisches Wort'/&gt;&lt;term term='Wort'/&gt;&lt;/synset&gt;&lt;synset id='35385'&gt;&lt;categories&gt;&lt;term term='Wort'/&gt;&lt;/synset&gt;&lt;/matches&gt;\n</code></pre>\n"}, {"tags": ["vba", "getelementsbyclassname"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1538510006, "post_id": 52615348, "comment_id": 92165194, "body": "What error are you getting? &quot;Subscript out of range&quot;? Have you tried verifying how many items are returned by <code>getElementsByClassName</code>? That <code>1</code> is skipping index <code>0</code>, which looks like what you&#39;re after."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1538510377, "post_id": 52615348, "comment_id": 92165350, "body": "There is no button tag element. What are you trying to click on? You have links for My Merchants My Terminals My Templates My Reports Parameter Report and Health Monitor"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1538581841, "post_id": 52615348, "comment_id": 92195390, "body": "Did you get the answer below to work please?"}, {"owner": {"reputation": 1, "user_id": 10043625, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-iYeEVEypM8E/AAAAAAAAAAI/AAAAAAAAANU/EE6DB5VnLBA/photo.jpg?sz=128", "display_name": "Mike Mah", "link": "https://stackoverflow.com/users/10043625/mike-mah"}, "edited": false, "score": 0, "creation_date": 1538597334, "post_id": 52615348, "comment_id": 92203089, "body": "can not locate that object"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1538599208, "post_id": 52615348, "comment_id": 92203925, "body": "The code is updated please check when you have a moment."}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1538510567, "post_id": 52615582, "comment_id": 92165441, "body": "Much cleaner. I&#39;ll just stick to desktop stuff :D"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1538511104, "post_id": 52615582, "comment_id": 92165654, "body": "That is kind. Appreciated."}, {"owner": {"reputation": 1, "user_id": 10043625, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-iYeEVEypM8E/AAAAAAAAAAI/AAAAAAAAANU/EE6DB5VnLBA/photo.jpg?sz=128", "display_name": "Mike Mah", "link": "https://stackoverflow.com/users/10043625/mike-mah"}, "edited": false, "score": 0, "creation_date": 1538597772, "post_id": 52615582, "comment_id": 92203291, "body": "while i used ie.document.querySelector(&quot;title=&#39;My Merchants&#39;&quot;).Click,             it gave error ,&quot; Method &#39; querySelector&#39; of object&#39;JScriptTypeInfo&#39;Failed&quot;   and when i use ie.document.querySelector(&quot;.here&quot;).Click                                                       it gave error, &quot; Object required&quot;..."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1538599270, "post_id": 52615582, "comment_id": 92203960, "body": "Oh..cos the first is missing outers for some reason. Use this ie.document.querySelector(&quot;[title=&#39;My Merchants&#39;]&quot;).Click  as per edit."}, {"owner": {"reputation": 1, "user_id": 10043625, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-iYeEVEypM8E/AAAAAAAAAAI/AAAAAAAAANU/EE6DB5VnLBA/photo.jpg?sz=128", "display_name": "Mike Mah", "link": "https://stackoverflow.com/users/10043625/mike-mah"}, "edited": false, "score": 0, "creation_date": 1538777804, "post_id": 52615582, "comment_id": 92277427, "body": "i had realized it, i putted it back, before i run the test, still the same...no luck...any other suggestion?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1538778216, "post_id": 52615582, "comment_id": 92277523, "body": "What happens now when you run it?"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1538599244, "last_edit_date": 1538599244, "creation_date": 1538510531, "answer_id": 52615582, "question_id": 52615348, "link": "https://stackoverflow.com/questions/52615348/how-vba-click-for-class-and-title-only-button/52615582#52615582", "title": "How vba click for class and title only button", "body": "<p>Assuming no parent frame/iframe you can use an attribute=value CSS selector. This first is more specific.</p>\n\n<pre><code>ie.document.querySelector(\"[title='My Merchants']\").Click\n</code></pre>\n\n<p>Or a class selector of</p>\n\n<pre><code>ie.document.querySelector(\".here\").Click\n</code></pre>\n\n<p>That relies on you wanting the first element with class <code>here</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 10043625, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-iYeEVEypM8E/AAAAAAAAAAI/AAAAAAAAANU/EE6DB5VnLBA/photo.jpg?sz=128", "display_name": "Mike Mah", "link": "https://stackoverflow.com/users/10043625/mike-mah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1358, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1538599244, "creation_date": 1538509468, "last_edit_date": 1538542729, "question_id": 52615348, "link": "https://stackoverflow.com/questions/52615348/how-vba-click-for-class-and-title-only-button", "title": "How vba click for class and title only button", "body": "<p>I found the site with a sidebar, but i can't find a right code to click on it.</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;div class=\"sidebar\"&gt;\n&lt;div id=\"menuTree\"&gt;\n&lt;ul class=\"menu\"&gt;\n    &lt;li class=\"No1\"&gt;&lt;a class=\"here\" title=\"My Merchants\" action=\"../app/rps/merchant/filter_merchant.jsp\" tree_id=\"rps0301\"&gt;My Merchants&lt;/a&gt;&lt;/li&gt;\n    &lt;li class=\"No2\"&gt;&lt;a class=\"\" title=\"My Terminals\" action=\"../app/rps/terminal/filter_terminal.jsp\" tree_id=\"rps0401\"&gt;My Terminals&lt;/a&gt;&lt;/li&gt;\n    &lt;li class=\"No3\"&gt;&lt;a class=\"\" title=\"My Templates\" action=\"../app/rps/template/filter_template.jsp\" tree_id=\"rps1101\"&gt;My Templates&lt;/a&gt;&lt;/li&gt;\n    &lt;li class=\"No4\"&gt;&lt;a class=\"\" title=\"My Reports\"&gt;My Reports&lt;/a&gt;&lt;ul class=\"No_1\" style=\"display: none;\"&gt;\n    &lt;li&gt;&lt;a title=\"Parameter Report\" action=\"../app/rps/myreport/parameter_filter.jsp\" tree_id=\"rps5002\"&gt;Parameter Report&lt;/a&gt;&lt;/li&gt;\n    &lt;li&gt;&lt;a title=\"Health Monitor\" action=\"../app/rps/health/healthmonitoring/filter_health.jsp\" tree_id=\"rps3008\"&gt;Health Monitor&lt;/a&gt;&lt;/li&gt;\n    &lt;li&gt;&lt;a title=\"User Report\" action=\"../app/rps/log_management/log_mng.jsp...\n</code></pre>\n\n<p>i use the class name but still not able to click it.</p>\n\n<pre><code>Dim e\nSet e = ie.document.getElementsByClassName(\"here\")(1)\ne.Click\n</code></pre>\n\n<p>please advise.</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1538523711, "post_id": 52614805, "comment_id": 92169776, "body": "split your <code>startup</code> and <code>for each</code> into 2 <code>subs</code>"}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 5795928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b38486b5f79d89eea103f635410b1536?s=128&d=identicon&r=PG&f=1", "display_name": "Robin A", "link": "https://stackoverflow.com/users/5795928/robin-a"}, "edited": false, "score": 0, "creation_date": 1538857544, "post_id": 52621162, "comment_id": 92294203, "body": "Thank you! Adding a blank Public Sub Application_Quit() routine worked! Any ideas why this is necessary?"}, {"owner": {"reputation": 189, "user_id": 9609148, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Pablo G", "link": "https://stackoverflow.com/users/9609148/pablo-g"}, "edited": false, "score": 0, "creation_date": 1573807739, "post_id": 52621162, "comment_id": 104014363, "body": "Thanks! This has helped me A LOT!"}], "tags": [], "owner": {"reputation": 161, "user_id": 10308648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e9afe6ea28d5466be955d0ec36da547?s=128&d=identicon&r=PG&f=1", "display_name": "Evanzheng", "link": "https://stackoverflow.com/users/10308648/evanzheng"}, "is_accepted": true, "score": 3, "last_activity_date": 1538549093, "creation_date": 1538549093, "answer_id": 52621162, "question_id": 52614805, "link": "https://stackoverflow.com/questions/52614805/application-startup-not-firing/52621162#52621162", "title": "Application_Startup() not firing", "body": "<p>I tested your code and I\u2019ve ran into the same problem.\nI have solved this problem by restarting my PC and adding the Public Sub Application_Quit() method.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10541765, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/162855870c8d663ab016b264e2c8570d?s=128&d=identicon&r=PG", "display_name": "C. Collings", "link": "https://stackoverflow.com/users/10541765/c-collings"}, "is_accepted": false, "score": 0, "last_activity_date": 1540226164, "creation_date": 1540226164, "answer_id": 52933958, "question_id": 52614805, "link": "https://stackoverflow.com/questions/52614805/application-startup-not-firing/52933958#52933958", "title": "Application_Startup() not firing", "body": "<p>Was experiencing same problem with Application_Startup() procedure not firing after a system reload and restore of my VBAProject.   Checked macro settings, digitally signed the project - no luck.   Received no button to Enable VBA during startup, like in Office 2010.  VBA would function, but required me to manually fire the Application_Startup() procedure.</p>\n\n<p>Tried creating a new, temporary \"Private Application_Startup()\" procedure, but no joy.</p>\n\n<p>I deleted \"Public\" statement that preceded the Application_Startup() declaration.  Saved, closed VBA and Outlook.  Re-opened and suddenly it started working.  Have restored the \"Public\", saved, re-opened, and it now seems to work properly.  No explanation.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 12724981, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/00ac78c2b8a33867b1edd8a3d6962106?s=128&d=identicon&r=PG", "display_name": "Sven Norlin", "link": "https://stackoverflow.com/users/12724981/sven-norlin"}, "is_accepted": false, "score": 0, "last_activity_date": 1579181785, "creation_date": 1579181785, "answer_id": 59770853, "question_id": 52614805, "link": "https://stackoverflow.com/questions/52614805/application-startup-not-firing/59770853#59770853", "title": "Application_Startup() not firing", "body": "<p>Had a similar problem. Application_Startup didn't trigger on restarting Outlook and hence my changes in the function didn't load. The reason Application_Startup didn't trigger was because I had another program holding a reference open to Outlook</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 13939180, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/7ae83c2ecf89bedcf8f135a0b5f402f5?s=128&d=identicon&r=PG", "display_name": "Deztructiv", "link": "https://stackoverflow.com/users/13939180/deztructiv"}, "is_accepted": false, "score": 2, "last_activity_date": 1594866055, "creation_date": 1594866055, "answer_id": 62926453, "question_id": 52614805, "link": "https://stackoverflow.com/questions/52614805/application-startup-not-firing/62926453#62926453", "title": "Application_Startup() not firing", "body": "<p>There seems to be a flag in outlook which checks for VBA code. If it can't find any it sets the registry value (HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\XX.0\\Outlook\\LoadMacroProviderOnBoot) to 0 every time it closes. It doesn't seem to be setup so that it detects when code is added by copying the OTM file.\nI have discovered 2 scenarios (there may be more) which cause the flag to be set causing outlook to change the registry value to 1 on close.</p>\n<ol>\n<li>If any macro is run</li>\n<li>The visual basic editor is opened.</li>\n</ol>\n<p>The issue arose in my situation when I try to roll out the VBA code to a new PC with no existing VBA code.</p>\n<p>I use a batch script to roll out my VBA code to other machines and to fix it I simply added a REG ADD command to the bat file after the code is copied to the machine which sets the key to 1.</p>\n<p>REG ADD HKCU\\Software\\Microsoft\\Office\\XX.0\\Outlook /v LoadMacroProviderOnBoot /t REG_DWORD /d 1 /f</p>\n<p>You need to change \u201cXX.0\u201d to the version of office you are dealing with. Check the registry to find out.</p>\n<p>This seems to force Outlook to check for VBA code when it starts.</p>\n<p>(Thanks to Sergik718 on Microsoft TechNet forums for pointing out that changing this registry entry helps.)</p>\n"}], "owner": {"reputation": 65, "user_id": 5795928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b38486b5f79d89eea103f635410b1536?s=128&d=identicon&r=PG&f=1", "display_name": "Robin A", "link": "https://stackoverflow.com/users/5795928/robin-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2502, "favorite_count": 1, "accepted_answer_id": 52621162, "answer_count": 4, "score": 1, "last_activity_date": 1594866055, "creation_date": 1538506939, "last_edit_date": 1592700445, "question_id": 52614805, "link": "https://stackoverflow.com/questions/52614805/application-startup-not-firing", "title": "Application_Startup() not firing", "body": "<p>I've code in the \"ThisOutlookSession\" module.</p>\n\n<p>Application_ItemSend works, events are triggered when sending mail.</p>\n\n<p>Application_Startup runs when I initiate it manually after Outlook has been opened - not upon startup.</p>\n\n<p>Making the sub private makes no difference - neither does making the variables public.</p>\n\n<p>I have macro settings on \"Enable all macros\" in the Trust Center.</p>\n\n<p>I'm on Outlook 2016 on a PC running Windows 10 Enterprise.</p>\n\n<p>I have researched the issue intensively.</p>\n\n<pre><code>Option Explicit\n\nDim add_str As String\n\nPublic Sub Application_Startup()\n\n    Dim olNs As Outlook.NameSpace\n    Dim Folder As Outlook.MAPIFolder\n    Dim SubFolder As Outlook.MAPIFolder\n    Dim Item As Object\n\n    Set olNs = Application.GetNamespace(\"MAPI\")\n    Set Folder = olNs.Folders(\"albrobin@workmail.com\").Folders(\"WORKFLOW\").Folders(\"Reporting\")\n\n    For Each SubFolder In Folder.Folders\n        If SubFolder.items.Restrict(\"[UnRead] = True\").Count &gt; 0 Then\n            For Each Item In SubFolder.items\n                Item.UnRead = False\n            Next\n        End If\n    Next\n\nEnd Sub\n\n\nPublic Sub Application_ItemSend(ByVal Item As Object, Cancel As Boolean)\n\n    If TypeName(Item) &lt;&gt; \"MailItem\" Then\n        Exit Sub\n    End If\n\n    If Item.Subject Like \"RE: *\" _\n        Or Item.Subject Like \"AW: *\" _\n        Or Item.Subject Like \"FW: *\" Then\n        Exit Sub\n    End If\n\n    UserForm1.Show\n\n    If add_str = \"[URGENT] \" Then\n        Item.Importance = olImportanceHigh\n    End If\n\n    Item.Subject = add_str &amp; Item.Subject\n\n    add_str = vbNullString\n\nEnd Sub\n\n\nPublic Sub routine(str_ As String)\n    add_str = Replace(str_, vbCrLf, \" \")\n    add_str = \"[\" &amp; add_str &amp; \"] \"\nEnd Sub\n\n\nSub show_form1()\n    UserForm1.Show\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 1, "creation_date": 1538508306, "post_id": 52614750, "comment_id": 92164472, "body": "Are you switching workbooks/worksheets in there somewhere (maybe in <code>addFormulaTestDataLoop</code>)? Your <code>gFindInColumn</code> function references <code>Columns</code> which looks at the ActiveSheet of the ActiveWorkbook and will blow up on you if you switch to a different worksheet. Maybe pass in the worksheet you&#39;re searching in, just to be sure you&#39;re searching on the right one."}, {"owner": {"reputation": 105, "user_id": 6067718, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh3.googleusercontent.com/-x44fODQx1-U/AAAAAAAAAAI/AAAAAAAACFM/OJpTjoVWzxs/photo.jpg?sz=128", "display_name": "Rick FlyFish", "link": "https://stackoverflow.com/users/6067718/rick-flyfish"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1538508546, "post_id": 52614750, "comment_id": 92164574, "body": "No, not switching because when I step through the code it does come up with the correct value. But good point, I&#39;ll pass in the worksheets and make it explicit"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 1, "creation_date": 1538508659, "post_id": 52614750, "comment_id": 92164620, "body": "You also have an unqualified reference to <code>Cells()</code> in your <code>After:=</code> parameter. May want to clean that up, too."}, {"owner": {"reputation": 105, "user_id": 6067718, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh3.googleusercontent.com/-x44fODQx1-U/AAAAAAAAAAI/AAAAAAAACFM/OJpTjoVWzxs/photo.jpg?sz=128", "display_name": "Rick FlyFish", "link": "https://stackoverflow.com/users/6067718/rick-flyfish"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1538509744, "post_id": 52614750, "comment_id": 92165066, "body": "Not an expert in VB but how would a qualify it, by adding an active sheet?"}, {"owner": {"reputation": 105, "user_id": 6067718, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh3.googleusercontent.com/-x44fODQx1-U/AAAAAAAAAAI/AAAAAAAACFM/OJpTjoVWzxs/photo.jpg?sz=128", "display_name": "Rick FlyFish", "link": "https://stackoverflow.com/users/6067718/rick-flyfish"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1538509813, "post_id": 52614750, "comment_id": 92165109, "body": "I did add wsData.Activate just before i called gFindInColumn but that didn&#39;t help"}], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 6067718, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh3.googleusercontent.com/-x44fODQx1-U/AAAAAAAAAAI/AAAAAAAACFM/OJpTjoVWzxs/photo.jpg?sz=128", "display_name": "Rick FlyFish", "link": "https://stackoverflow.com/users/6067718/rick-flyfish"}, "edited": false, "score": 0, "creation_date": 1538514786, "post_id": 52615698, "comment_id": 92167151, "body": "That looks great but, maybe I&#39;m not understanding the range I&#39;ve called with sRow(1, 1) = gFindInColumn(sStr, &quot;C3:C&quot; &amp; lRow) but it doesn&#39;t even step into the function. Thanks for all the help so far with my OJT on VBA ;-)"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 105, "user_id": 6067718, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh3.googleusercontent.com/-x44fODQx1-U/AAAAAAAAAAI/AAAAAAAACFM/OJpTjoVWzxs/photo.jpg?sz=128", "display_name": "Rick FlyFish", "link": "https://stackoverflow.com/users/6067718/rick-flyfish"}, "edited": false, "score": 0, "creation_date": 1538515807, "post_id": 52615698, "comment_id": 92167543, "body": "<code>gFindInColumn(sStr, Range(&quot;C3:C&quot; &amp; lRow))</code>"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1538511026, "creation_date": 1538511026, "answer_id": 52615698, "question_id": 52614750, "link": "https://stackoverflow.com/questions/52614750/search-function-exits-after-2nd-call/52615698#52615698", "title": "Search function exits after 2nd call", "body": "<p>It seems like you want to find only matches which occur after a specific row number: in that case you need to make sure that Find() hasn't loop back around...</p>\n\n<pre><code>Public Function gFindInColumn(search As Variant, rngCol As Range, _\n                              Optional rowNum As Long = 2) As Long\n    Dim f As Range\n    Set f = rngCol.Find(What:=search, After:=rngCol.Cells(rowNum), _\n                        LookIn:=xlValues, LookAt:=xlWhole, _\n                        SearchOrder:=xlByRows, _\n                        SearchDirection:=xlNext, _\n                        MatchCase:=False, _\n                        SearchFormat:=False)\n\n    If Not f Is Nothing Then\n        'only return non-zero if the found cell is *after* rowNum\n        gFindInColumn = IIf(f.Row &gt; rowNum, f.Row, 0)\n    Else\n        gFindInColumn = 0\n    End If\n\nEnd Function\n</code></pre>\n\n<p>Also switched out your \"search column\" to a Range object so there's no ambiguity about which sheet the Find runs on.</p>\n\n<p>Note also you can handle default values for optional parameters directly in the parameters list.</p>\n"}], "owner": {"reputation": 105, "user_id": 6067718, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh3.googleusercontent.com/-x44fODQx1-U/AAAAAAAAAAI/AAAAAAAACFM/OJpTjoVWzxs/photo.jpg?sz=128", "display_name": "Rick FlyFish", "link": "https://stackoverflow.com/users/6067718/rick-flyfish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 52615698, "answer_count": 1, "score": 0, "last_activity_date": 1538516215, "creation_date": 1538506751, "last_edit_date": 1538516215, "question_id": 52614750, "link": "https://stackoverflow.com/questions/52614750/search-function-exits-after-2nd-call", "title": "Search function exits after 2nd call", "body": "<p>I have a simple search function - <code>addFormulaTestDataLoop</code> - that gets called multiple times to return a row number.</p>\n\n<p>In the first two calls (call 1 and call 2), it finds the beginning and ending rows for the first block. Then I call it two more times (call 3 and call 4) to get the next beginning and ending row numbers. <strong><em>But</em></strong> on the third call (call 3), rather than returning the value, it goes to <code>End Function</code>. However, when I step through the code, the search routine <code>gFindInColumn</code> has the correct line number in it.</p>\n\n<pre><code>Public Function gFindInColumn(search As Variant, columnNum As Double, Optional rowNum As Double) As Double\n\nIf rowNum = 0 Then\n    rowNum = 2\nEnd If\ngFindInColumn = Columns(columnNum).Find(What:=search, _\n                                After:=Cells(rowNum, columnNum), _\n                                LookIn:=xlValues, _\n                                LookAt:=xlWhole, _\n                                SearchOrder:=xlByRows, _\n                                SearchDirection:=xlNext, _\n                                MatchCase:=False, _\n                                SearchFormat:=False).row\n'MsgBox \"value = \" &amp; gFindInColumn, vbExclamation, \"Finished\"\nEnd Function\n</code></pre>\n\n<p>This function is called like so:</p>\n\n<pre><code>dlgSysteEPatchTempDateTime.Show\ntemp = dlgSysteEPatchTempDateTime.txtBPreBaseLineEndTemp.Value\nsStr = dlgSysteEPatchTempDateTime.txtBPreBaselineStartDate.Value &amp; \" \" &amp; dlgSysteEPatchTempDateTime.txtBPreBaselineStartTime.Value\neStr = dlgSysteEPatchTempDateTime.txtBPreBaselineEndDate.Value &amp; \" \" &amp; dlgSysteEPatchTempDateTime.txtBPreBaselineEndTime.Value\n\nsRow(1, 1) = gFindInColumn(sStr, 3)\neRow(1, 1) = gFindInColumn(eStr, 3)\nCall addFormulaTestDataLoop(temp, sRow(1, 1), eRow(1, 1))\n\n'Dur\ntemp = dlgSysteEPatchTempDateTime.txtBDurBaseLineEndTemp.Value\nsStr = dlgSysteEPatchTempDateTime.txtBDurBaselineStartDate.Value &amp; \" \" &amp; dlgSysteEPatchTempDateTime.txtBDurBaselineStartTime.Value\neStr = dlgSysteEPatchTempDateTime.txtBDurBaselineEndtDate.Value &amp; \" \" &amp; dlgSysteEPatchTempDateTime.txtBDurBaselineEndTime.Value\nqtyDur = dlgSysteEPatchTempDateTime.txtDurQty.Value\n\nsRow(2, 2) = gFindInColumn(sStr, 3)\neRow(2, 2) = gFindInColumn(eStr, 3)\nRange(\"A\" &amp; sRow(2, 2)).Value = \"DURING\"\nCall addFormulaTestDataLoop(temp, sRow(2, 2), eRow(2, 2))\n</code></pre>\n\n<p>It fails at <code>sRow(2, 2) = gFindInColumn(sStr, 3)</code>, but works on the first two calls?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 1, "creation_date": 1538506803, "post_id": 52614627, "comment_id": 92163814, "body": "You need to specify which sheet the range is on. Try <code>WS.Range(&quot;A1:V104&quot;).Copy</code>"}], "answers": [{"comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 1, "creation_date": 1538507150, "post_id": 52614763, "comment_id": 92163976, "body": "This answer is correct. The <i>reason</i> is that the unqualified <code>Range</code> in the OP works on the ActiveSheet, exactly as OP noted. That is the danger of using unqualified references and why they need to be avoided in <i>almost</i> all cases."}, {"owner": {"reputation": 431, "user_id": 5969893, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/c6c5d6a1321f7055e2fff7a3f6736d9b?s=128&d=identicon&r=PG&f=1", "display_name": "AlmostThere", "link": "https://stackoverflow.com/users/5969893/almostthere"}, "edited": false, "score": 0, "creation_date": 1538508152, "post_id": 52614763, "comment_id": 92164390, "body": "I tried that and got a run time error.  I tried adding <code>WS.Select</code> after <code>For Each WS In Worksheets</code> section and did not put the <code>WS</code> in front of the <code>Range(&quot;A1:V104&quot;).Select</code> and it started to work."}], "tags": [], "owner": {"reputation": 344, "user_id": 7915175, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fff6640a70932cf34a7f78a9faf5a208?s=128&d=identicon&r=PG&f=1", "display_name": "aozk", "link": "https://stackoverflow.com/users/7915175/aozk"}, "is_accepted": false, "score": 1, "last_activity_date": 1538506802, "creation_date": 1538506802, "answer_id": 52614763, "question_id": 52614627, "link": "https://stackoverflow.com/questions/52614627/vba-to-copy-and-paste-values-for-each-sheet-in-workbook/52614763#52614763", "title": "VBA to copy and paste values for each sheet in workbook", "body": "<p>Try <code>WS.Range(\"A1:V104\").Select</code> instead of <code>Range(\"A1:V104\").Select</code></p>\n"}, {"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 2, "last_activity_date": 1538508804, "creation_date": 1538508804, "answer_id": 52615211, "question_id": 52614627, "link": "https://stackoverflow.com/questions/52614627/vba-to-copy-and-paste-values-for-each-sheet-in-workbook/52615211#52615211", "title": "VBA to copy and paste values for each sheet in workbook", "body": "<p>Avoiding Select <em>and</em> copy/paste:</p>\n\n<pre><code>Sub Paste_Values()\n    Dim WS As Worksheet\n    Application.ScreenUpdating = False\n\n    For Each WS In Worksheets\n        With WS.Range(\"A1:V104\")\n            .Value = .Value\n        End With\n    Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 431, "user_id": 5969893, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/c6c5d6a1321f7055e2fff7a3f6736d9b?s=128&d=identicon&r=PG&f=1", "display_name": "AlmostThere", "link": "https://stackoverflow.com/users/5969893/almostthere"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 995, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1538508804, "creation_date": 1538506273, "question_id": 52614627, "link": "https://stackoverflow.com/questions/52614627/vba-to-copy-and-paste-values-for-each-sheet-in-workbook", "title": "VBA to copy and paste values for each sheet in workbook", "body": "<p>I have the following code but it is only working on the active worksheet instead of looping through all of the work sheets.  I am not sure why it is not lopping as I have used the looping syntax below before.</p>\n\n<pre><code>Sub Paste_Values()\n\nApplication.ScreenUpdating = False\n\n\n\nDim WS As Worksheet\n\n\n\nFor Each WS In Worksheets\n      Range(\"A1:V104\").Select\n\n    Selection.Copy\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\nNext\n\nEnd Sub\n</code></pre>\n"}]