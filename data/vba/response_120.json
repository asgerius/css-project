[{"tags": ["vba", "indexing", "split", "match", "explode"], "comments": [{"owner": {"reputation": 620, "user_id": 3119180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cc7a56a59ab84634ee6cb37a7131ed2?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Holton", "link": "https://stackoverflow.com/users/3119180/rich-holton"}, "edited": false, "score": 0, "creation_date": 1493250585, "post_id": 43646356, "comment_id": 74341032, "body": "It&#39;s not clear what you want to accomplish. Could you show the results you&#39;d like?"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 5725102, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-ip3eJ8wQbYM/AAAAAAAAAAI/AAAAAAAAt7M/HLTrfYWU0WE/photo.jpg?sz=128", "display_name": "Russ Rosenlof", "link": "https://stackoverflow.com/users/5725102/russ-rosenlof"}, "edited": false, "score": 0, "creation_date": 1493300552, "post_id": 43646482, "comment_id": 74366332, "body": "Thanks, that&#39;s exactly what I needed!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1493251344, "creation_date": 1493251344, "answer_id": 43646482, "question_id": 43646356, "link": "https://stackoverflow.com/questions/43646356/vba-function-for-pulling-multiple-values-from-single-cell-and-index-matching-the/43646482#43646482", "title": "VBA function for pulling multiple values from single cell and index/matching them to values", "body": "<pre><code>Public Function RoleToName(role, roles_rng, names_rng) As String\n    Dim result As String\n    Dim s As Variant, m, sep As String\n\n    For Each s In Split(role, \"/\")\n        'Trim each value in case of extra spaces...\n        m = Application.Match(Trim(s), roles_rng, 0)\n        If Not IsError(m) Then\n            result = result &amp; sep &amp; names_rng.Cells(m).Value\n        Else\n            result = result &amp; sep &amp; \"??\" '&lt;&lt; role not found...\n        End If\n        sep = \",\"\n    Next s\n    RoleToName = result\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1493251480, "creation_date": 1493251480, "answer_id": 43646499, "question_id": 43646356, "link": "https://stackoverflow.com/questions/43646356/vba-function-for-pulling-multiple-values-from-single-cell-and-index-matching-the/43646499#43646499", "title": "VBA function for pulling multiple values from single cell and index/matching them to values", "body": "<p>Try it as,</p>\n\n<pre><code>Function udf_CollateNames(roles As String, tbl As Range, _\n                          Optional roleSplit As String = \"/\", _\n                          Optional delim As String = \",\")\n    Dim v As Long, vVALs As Variant\n\n    vVALs = Split(roles, roleSplit)\n\n    For v = LBound(vVALs) To UBound(vVALs)\n        If Not IsError(Application.Match(Trim(vVALs(v)), tbl.Columns(1), 0)) Then _\n            udf_CollateNames = udf_CollateNames &amp; delim &amp; Application.VLookup(Trim(vVALs(v)), tbl, 2, False)\n    Next v\n\n    udf_CollateNames = Mid(udf_CollateNames, Len(delim) + 1)\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/twhRq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/twhRq.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 25, "user_id": 5725102, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-ip3eJ8wQbYM/AAAAAAAAAAI/AAAAAAAAt7M/HLTrfYWU0WE/photo.jpg?sz=128", "display_name": "Russ Rosenlof", "link": "https://stackoverflow.com/users/5725102/russ-rosenlof"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 43646482, "answer_count": 2, "score": 0, "last_activity_date": 1493251480, "creation_date": 1493250454, "question_id": 43646356, "link": "https://stackoverflow.com/questions/43646356/vba-function-for-pulling-multiple-values-from-single-cell-and-index-matching-the", "title": "VBA function for pulling multiple values from single cell and index/matching them to values", "body": "<p>I'm having trouble with a user defined function to explode a single cell string into multiple values, then match each of those values in an index/match fashion, returning a single cell with a string for the matched values separated by commas.</p>\n\n<p>Example:</p>\n\n<pre><code>Roles             Names           Role      Name\nrole1/role2       name1,name2     role1     name1\nrole1             name1           role2     name2\nrole2/role3       name2,name3     role3     name3\nrole1/role4       name1,name4     role4     name4\nrole3/role5       name3,name5     role5     name5\n</code></pre>\n\n<p>I want to get a function that generates the \"names\" column from the Roles, Role, and Name columns.</p>\n\n<p>Here's my VBA code so far:</p>\n\n<pre><code>Public Function RoleToName(role, roles_rng, names_rng) As String\n    Dim result As String\n    Dim s As Variant\n\n    For Each s In Split(role, \"/\")\n        ???\n    Next s\nEnd Function\n</code></pre>\n\n<p>Thanks.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1493248962, "post_id": 43646102, "comment_id": 74340603, "body": "Why not use VLOOKUP ?  That&#39;s simpler than index/match"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1493249500, "post_id": 43646102, "comment_id": 74340748, "body": "Also, if the user isn&#39;t capable of learning <code>Index&#47;Match</code> (or <code>VLOOKUP()</code>), I&#39;m not sure if a UDF/Macro is a good idea. Sure, it may be &quot;simpler&quot;, but then they&#39;ll have to enable macros all the time which may not be a good habit for such a novice to get in to.  Plus, it&#39;s <i>incredibly useful</i> to learn <code>Index&#47;Match</code>/<code>VLOOKUP()</code> for a multitude of reasons, so perhaps consider using it, and just educating the user?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1493250227, "post_id": 43646102, "comment_id": 74340939, "body": "Give a user a UDF instead of teaching them INDEX/MATCH. Hmmm... sounds like giving a handgun to someone who cannot light a match."}, {"owner": {"reputation": 444, "user_id": 5288052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18674173651edb1c2fbf8b7a5a29dfa7?s=128&d=identicon&r=PG&f=1", "display_name": "Stefano Spinucci", "link": "https://stackoverflow.com/users/5288052/stefano-spinucci"}, "edited": false, "score": 0, "creation_date": 1493250936, "post_id": 43646102, "comment_id": 74341124, "body": "Ok, I&#39;ll try to explain INDEX/MATCH or VLOOKUP, but how to write a simple formula to return a summed value if  there are more than one values corresponding in the searched column? Despite INDEX/MATCH is standard and a UDF is... an UDF, &quot;SearchValInCol2&quot; is undoubtedly more concise and readable."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1493251845, "post_id": 43646102, "comment_id": 74341365, "body": "For that you would use sumifs()"}, {"owner": {"reputation": 444, "user_id": 5288052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18674173651edb1c2fbf8b7a5a29dfa7?s=128&d=identicon&r=PG&f=1", "display_name": "Stefano Spinucci", "link": "https://stackoverflow.com/users/5288052/stefano-spinucci"}, "edited": false, "score": 0, "creation_date": 1493252691, "post_id": 43646102, "comment_id": 74341566, "body": "sumifs() will return zero if the column to read contains strings; the UDF instead will return the first value for strings or the summed value for numbers."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1493254088, "post_id": 43646102, "comment_id": 74341882, "body": "re: &#39;<i>the UDF instead will ...</i>&#39; What UDF? I see no UDF code or any code for that matter."}], "answers": [{"tags": [], "owner": {"reputation": 444, "user_id": 5288052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18674173651edb1c2fbf8b7a5a29dfa7?s=128&d=identicon&r=PG&f=1", "display_name": "Stefano Spinucci", "link": "https://stackoverflow.com/users/5288052/stefano-spinucci"}, "is_accepted": false, "score": 0, "last_activity_date": 1493249554, "last_edit_date": 1493249554, "creation_date": 1493248751, "answer_id": 43646103, "question_id": 43646102, "link": "https://stackoverflow.com/questions/43646102/index-match-vba-alternative-to-search-inside-a-table-and-its-columns/43646103#43646103", "title": "Index/Match VBA alternative to search inside a table and its columns", "body": "<p>I didn't find any simple/elegant formula to do this (other than the Index/Match combination), then I wrote the following VBA code.</p>\n\n<p>As a bonus, the function automatically sum values from the column to read if there are more than one corresponding rows matching.</p>\n\n<pre><code>' return a value taken from a column searching for a value in another column;\n' the function works in the same way as Index(Match());\n' if the column ColNameToRead contains number values, and if ValueToSearch is found more then one time in the column ColNameToSearch, then the returned value\n' is the sum of all occurrence found.\nPublic Function SearchValInCol(TabName As String, ColNameToSearch As String, ValueToSearch As Variant, ColNameToRead As String)\n\n    Application.Volatile (True)   ' see \"Excel Recalculation\"  https://msdn.microsoft.com/en-us/library/office/bb687891.aspx\n\n    SearchValInCol = \"Error, value not found!\"\n\n    ' search table in all Worksheets; exit if not found\n    Dim foundTable\n    Dim objSheet\n    Dim objTable\n    foundTable = 0\n    For Each objSheet In ActiveWorkbook.Sheets\n        For Each objTable In objSheet.ListObjects\n            If objTable.Name = Trim(TabName) Then\n                Set foundTable = objTable\n                Exit For\n            End If\n        Next\n    Next\n    If IsNumeric(foundTable) Then Exit Function  ' exit function if the table is not found\n\n\n    ' search column named ColNameToSearch in table; exit if not found\n    Dim foundColumnToSearch\n    Dim counter\n    foundColumnToSearch = 0\n    For counter = 1 To foundTable.ListColumns.Count\n        If foundTable.HeaderRowRange(counter) = Trim(ColNameToSearch) Then\n            Set foundColumnToSearch = foundTable.ListColumns(counter).DataBodyRange\n            Exit For\n        End If\n    Next counter\n    If IsNumeric(foundColumnToSearch) Then Exit Function ' exit function if the column is not found\n\n\n    ' search column named ColNameToRead in table; exit if not found\n    Dim foundColumnToRead\n    foundColumnToRead = 0\n    For counter = 1 To foundTable.ListColumns.Count\n        If foundTable.HeaderRowRange(counter) = Trim(ColNameToRead) Then\n            Set foundColumnToRead = foundTable.ListColumns(counter).DataBodyRange\n            Exit For\n        End If\n    Next counter\n    If IsNumeric(foundColumnToRead) Then Exit Function ' exit function if the column is not found\n\n\n    ' search value ValueToSearch in column foundColumnToSearch; exit if not found\n    Dim cellVal\n    Dim retVal\n    retVal = 0\n    For counter = 1 To foundColumnToSearch.Rows.Count\n        If foundColumnToSearch.Cells(counter, 1) = ValueToSearch Then\n            ' if the value to search is a number, sum it with the previous value; otherwise return the first occurrence\n            If IsNumeric(foundColumnToRead.Cells(counter, 1)) Then\n                retVal = retVal + foundColumnToRead.Cells(counter, 1)\n            Else\n                retVal = foundColumnToRead.Cells(counter, 1)\n                Exit For\n            End If\n        End If\n    Next counter\n\n    SearchValInCol = retVal\n\nEnd Function\n</code></pre>\n\n<p>To search inside in the following table (Table1) the \"article\" \"vino\" returning a value from the column \"quantity\"</p>\n\n<pre><code>article     quantity\nvino               7\nacqua              8\npatate             5\nvino               7\n</code></pre>\n\n<p>can be used the following formula:</p>\n\n<pre><code>=SearchVal(\"Table1\"; Table1[[#Headers];[article]]; \"vino\"; Table1[[#Headers];[quantity]])\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 444, "user_id": 5288052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18674173651edb1c2fbf8b7a5a29dfa7?s=128&d=identicon&r=PG&f=1", "display_name": "Stefano Spinucci", "link": "https://stackoverflow.com/users/5288052/stefano-spinucci"}, "is_accepted": false, "score": 0, "last_activity_date": 1493250621, "creation_date": 1493250621, "answer_id": 43646366, "question_id": 43646102, "link": "https://stackoverflow.com/questions/43646102/index-match-vba-alternative-to-search-inside-a-table-and-its-columns/43646366#43646366", "title": "Index/Match VBA alternative to search inside a table and its columns", "body": "<p>Another, simpler solution, always with VBA, is the following</p>\n\n<pre><code>' return a value taken from a column searching for a value in another column;\n' the function works in the same way as Index(Match());\n' if the column ColToRead contains number values, and if ValueToSearch is found more then one time in the column ColToSearch, then the returned value\n' is the sum of all occurrence found.\nPublic Function SearchValInCol2(ColToSearch, ValueToSearch As Variant, ColToRead)\n\n    Application.Volatile (True)   ' see \"Excel Recalculation\"  https://msdn.microsoft.com/en-us/library/office/bb687891.aspx\n\n    SearchValInCol2 = \"Error, value not found!\"\n\n    ' search value ValueToSearch in column ColToSearch; exit if not found\n    Dim counter\n    Dim cellVal\n    Dim retVal\n    retVal = 0\n    For counter = 1 To ColToSearch.Rows.Count\n        If ColToSearch.Cells(counter, 1) = ValueToSearch Then\n            ' if the value to search is a number, sum it with the previous value; otherwise return the first occurrence\n            If IsNumeric(ColToRead.Cells(counter, 1)) Then\n                retVal = retVal + ColToRead.Cells(counter, 1)\n            Else\n                retVal = ColToRead.Cells(counter, 1)\n                Exit For\n            End If\n        End If\n    Next counter\n\n    SearchValInCol2 = retVal\n\nEnd Function\n</code></pre>\n\n<p>To search in the following table \"Table1\"</p>\n\n<pre><code>article     quantity\nvino               7\nacqua              8\npatate             5\nvino               7\n</code></pre>\n\n<p>a formula calling the function can be :</p>\n\n<pre><code>=SearchValInCol2(Table1[article];\"vino\";Table1[quantity])\n</code></pre>\n\n<p>that is more concise and readable of the previous solution, and avoid using inside the formula the literal string \"Table1\" that won't be updated if the table name will change.</p>\n"}], "owner": {"reputation": 444, "user_id": 5288052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18674173651edb1c2fbf8b7a5a29dfa7?s=128&d=identicon&r=PG&f=1", "display_name": "Stefano Spinucci", "link": "https://stackoverflow.com/users/5288052/stefano-spinucci"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2257, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1493250621, "creation_date": 1493248751, "question_id": 43646102, "link": "https://stackoverflow.com/questions/43646102/index-match-vba-alternative-to-search-inside-a-table-and-its-columns", "title": "Index/Match VBA alternative to search inside a table and its columns", "body": "<p>I need to search inside a table and its columns (search a value inside column A and return a value from column B) and I dislike using the Index/Match combination because I'm preparing the workbook for a novice user and he is not able to grasp the Index/Match logic.</p>\n"}, {"tags": ["c#", "excel", "vsto", "excel-addins", "vba"], "answers": [{"tags": [], "owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "is_accepted": false, "score": 0, "last_activity_date": 1493296170, "creation_date": 1493296170, "answer_id": 43657857, "question_id": 43645854, "link": "https://stackoverflow.com/questions/43645854/listobject-contains-extra-headers-after-adding/43657857#43657857", "title": "ListObject contains extra headers after adding", "body": "<p>Here it will be probably necessary explicitly say where the <code>Source</code> is located otherwise Excel chooses the closest cells as source by himself. In the following code the <code>Source</code> is set to <code>Range[D3]</code>. Hope this will work with your xml data correctly.</p>\n\n<p>The <code>Add</code> method has some other parameter <code>Destination</code> which seems to be used to specify the upper left cell of the table but I was not able to make it work with source-Type <code>xlSrcXml</code>.  </p>\n\n<pre><code>listObject?.Delete();\nlistObject = sheet.ListObjects.Add(Source: ((Worksheet)sheet).Range[\"D3\"]);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 3082223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/012ac619e3d6180811f12e38d3d42cd3?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Matveev", "link": "https://stackoverflow.com/users/3082223/michael-matveev"}, "is_accepted": false, "score": 1, "last_activity_date": 1493297918, "creation_date": 1493297918, "answer_id": 43658582, "question_id": 43645854, "link": "https://stackoverflow.com/questions/43645854/listobject-contains-extra-headers-after-adding/43658582#43658582", "title": "ListObject contains extra headers after adding", "body": "<p>It turned out that I have to specify both <code>Destination</code> and <code>Source</code> parameters pointed to the same range.</p>\n\n<pre><code>var tableCell = sheet.get_Range(\"D3\");\nlistObject = sheet.ListObjects.Add(SourceType: Excel.XlListObjectSourceType.xlSrcRange, Source: tableCell, Destination: tableCell, XlListObjectHasHeaders: Excel.XlYesNoGuess.xlNo);\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 3082223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/012ac619e3d6180811f12e38d3d42cd3?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Matveev", "link": "https://stackoverflow.com/users/3082223/michael-matveev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 270, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1493297918, "creation_date": 1493247289, "last_edit_date": 1531161705, "question_id": 43645854, "link": "https://stackoverflow.com/questions/43645854/listobject-contains-extra-headers-after-adding", "title": "ListObject contains extra headers after adding", "body": "<p>I add a new ListObject on the worksheet starting from D3 cell and then create columns and bind them with XMLMap. Here is my code:</p>\n\n<pre><code>            Excel.Worksheet sheet = _workbook.Sheets[\"Data1\"];\n            sheet.Activate();\n            sheet.get_Range(\"D3\").Select();\n\n            var xmlMap = _workbook\n                .XmlMaps\n                .Add(collectionDatablock.GetSchema(), NetworkTree.RootName);\n            xmlMap.Name = collectionDatablock.Name;\n\n            var listObject = sheet\n                .ListObjects\n                .Cast&lt;Excel.ListObject&gt;()\n                .SingleOrDefault(l =&gt; l.Name == \"ListName\");\n\n            listObject?.Delete();\n            listObject = sheet.ListObjects.Add();\n\n            listObject.Name = \"ListName\";\n\n            var column = listObject\n                .ListColumns\n                .Cast&lt;Excel.ListColumn&gt;()\n                .First();\n\n            SetColumn(column, xmlMap, \"Col1\", \"/Root/Region/@UniqueName\");\n            var newColumn = listObject.ListColumns.Add();\n            SetColumn(newColumn, xmlMap, f, solution, \"Col2\", \"/Root/Region/@Code\");\n</code></pre>\n\n<p>And SetColumn method:</p>\n\n<pre><code>    private void SetColumn(Excel.ListColumn column, Excel.XmlMap map, string header, string path)\n    {\n        column.Name = GetColumnCaption(header);\n        column.XPath.SetValue(map, path);\n    }\n</code></pre>\n\n<p>This code work as expected on empty worksheet but if there are any data above table (for example D2 cell has a value) then the list table is moved up and D2 becomes the top left corner of table! Further more if D1, D2 and E2 cells have values then an extra column for table is generated, called \"Column2\". Seems Excel try to include all data from range above a table into ListObject. How to prevent it?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1831, "user_id": 2967019, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rnBqX.jpg?s=128&g=1", "display_name": "mrbungle", "link": "https://stackoverflow.com/users/2967019/mrbungle"}, "edited": false, "score": 0, "creation_date": 1493247000, "post_id": 43645783, "comment_id": 74339960, "body": "Without testing I think you need this edit: <code>If Worksheets(i).Name &lt;&gt; &quot;Main&quot; Or Worksheets(i).Name &lt;&gt; &quot;Monthly_Summary&quot; Then</code>"}, {"owner": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "reply_to_user": {"reputation": 1831, "user_id": 2967019, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rnBqX.jpg?s=128&g=1", "display_name": "mrbungle", "link": "https://stackoverflow.com/users/2967019/mrbungle"}, "edited": false, "score": 0, "creation_date": 1493247092, "post_id": 43645783, "comment_id": 74339992, "body": "@mrbungle No tried that as well..It didn&#39;t work"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1493247637, "post_id": 43645783, "comment_id": 74340175, "body": "Note you have a typo, <code>Workseetname</code>. Should it be <code>Worksheetname</code>? Also, you declare <code>ws</code> but never use it. Also are you getting any errors?  Also if you want to <i>hide</i> <code>Main</code> and <code>Monthly_Summary</code>, shouldn&#39;t the logic be <code>If Worksheets(i).Name = &quot;Main&quot; or Worksheets(i).Name = &quot;Monthly_Summary&quot;</code>?"}, {"owner": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1493247834, "post_id": 43645783, "comment_id": 74340245, "body": "@BruceWayne yes, you were right. I just got that and updated the question. Now, how should I generalize to enable all sheets that ends with _Summary and as well as Main sheet."}, {"owner": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "edited": false, "score": 0, "creation_date": 1493248012, "post_id": 43645783, "comment_id": 74340308, "body": "@TimWilliams Thanks sir."}], "answers": [{"comments": [{"owner": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "edited": false, "score": 0, "creation_date": 1493248201, "post_id": 43645962, "comment_id": 74340380, "body": "Thanks Sir. But it doesn&#39;t require the not because it does the exact opposite. Thanks again for the logic :)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "edited": false, "score": 2, "creation_date": 1493248441, "post_id": 43645962, "comment_id": 74340449, "body": "@Sid29 Without the <code>Not</code>, the &quot;Main&quot; and &quot;*_Summary&quot; sheets will be <code>Visible</code> and all the others will be hidden.  Which is the exact opposite to what you ask for in the title (&quot;Hide Worksheet on the basis of the ending part of their name - VBA&quot;) and in the question (&quot;just to hide the Main worksheet and another worksheet that has the name Monthly_Summary&quot;).  So I think you do want the <code>Not</code>."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1493249412, "post_id": 43645962, "comment_id": 74340734, "body": "Man, that&#39;s pretty snazzy the way you do the <code>.Visible = Not(...)</code>. I really need to think more like that with <code>TRUE</code>/<code>FALSE</code> settings."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 4, "last_activity_date": 1493247925, "creation_date": 1493247925, "answer_id": 43645962, "question_id": 43645783, "link": "https://stackoverflow.com/questions/43645783/hide-worksheet-on-the-basis-of-the-ending-part-of-their-name-vba/43645962#43645962", "title": "Hide Worksheet on the basis of the ending part of their name - VBA", "body": "<p>To hide the \"Main\" and \"*_Summary\" worksheets:</p>\n\n<pre><code>Sub tabopen()\n    Application.ScreenUpdating = False\n    Dim i As Long\n    For i = 1 To Worksheets.Count    \n        Worksheets(i).Visible = Not (Worksheets(i).Name = \"Main\" Or _\n                                     Worksheets(i).Name Like \"*_Summary\")\n    Next i\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4350, "user_id": 4187933, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/cT6jj.png?s=128&g=1", "display_name": "lebelinoz", "link": "https://stackoverflow.com/users/4187933/lebelinoz"}, "is_accepted": false, "score": 1, "last_activity_date": 1493248198, "creation_date": 1493248198, "answer_id": 43646010, "question_id": 43645783, "link": "https://stackoverflow.com/questions/43645783/hide-worksheet-on-the-basis-of-the-ending-part-of-their-name-vba/43646010#43646010", "title": "Hide Worksheet on the basis of the ending part of their name - VBA", "body": "<p>The logical part wasn't quite right.  Here is a version which is easy to step through:</p>\n\n<pre><code>Sub tabopen()\n    Dim Worksheetname As String, i As Integer, shouldBeVisible As Boolean\n    For i = 1 To Worksheets.Count\n        Worksheetname = Worksheets(i).Name\n        shouldBeVisible = Worksheets(i).Name = \"Main\" Or Right(Worksheets(i).Name, 8) = \"_Summary\"\n        Sheets(Worksheetname).Visible = shouldBeVisible\n    Next i\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 655, "user_id": 3097981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6776097221ad67f371357aaf72cbc775?s=128&d=identicon&r=PG&f=1", "display_name": "Hila DG", "link": "https://stackoverflow.com/users/3097981/hila-dg"}, "is_accepted": false, "score": 1, "last_activity_date": 1493249341, "last_edit_date": 1493249341, "creation_date": 1493249084, "answer_id": 43646155, "question_id": 43645783, "link": "https://stackoverflow.com/questions/43645783/hide-worksheet-on-the-basis-of-the-ending-part-of-their-name-vba/43646155#43646155", "title": "Hide Worksheet on the basis of the ending part of their name - VBA", "body": "<p>If you've done lots and lots of sheets deletes and creations of new sheets (especially if there were charts as new sheets involved), I wouldn't trust going through the Worksheets by the index, since it is a collection.\nI had issues of Excel crashing on me back in 2002 trying to refer to a Worksheet(i).Name; Excel simply couldn't find the index.<br>\nI know Excel had changed since then.<br>\nEither way, this is the \"safer\" way to iterate through the worksheets:</p>\n\n<pre><code>Sub mySub()\n    Dim Sh1 As Worksheet    \n    For Each Sh1 In ThisWorkbook.Sheets\n        Sh1.Visible = Not (Sh1.Name = \"Main\" Or Sh1.Name Like \"*_Summary\")\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 43645962, "answer_count": 3, "score": 1, "last_activity_date": 1493249341, "creation_date": 1493246840, "last_edit_date": 1493247754, "question_id": 43645783, "link": "https://stackoverflow.com/questions/43645783/hide-worksheet-on-the-basis-of-the-ending-part-of-their-name-vba", "title": "Hide Worksheet on the basis of the ending part of their name - VBA", "body": "<p>I have a large number of worksheets inside my workbook. I only need to make worksheets that has the name \"Main\" and tabs that are ending with \"_Summary\". </p>\n\n<p>[ Note the Underscore before the Summary ]</p>\n\n<p>I tried a basic logic before going to the tough part , just to hide the Main worksheet and another worksheet that has the name Monthly_Summary. I Could get it done for this logic but how to generalize it to check it for sheets ending with _Summary. Here is the Code,</p>\n\n<pre><code>Sub tabopen()\n\nApplication.ScreenUpdating = False\n\nDim ws As Worksheet\n\n    For i = 1 To Worksheets.Count\n\n                Workseetname = Worksheets(i).Name\n\n                If (Workseetname = \"Main\" Or Workseetname = \"Monthly_Summary\") Then\n                    Sheets(Workseetname).Visible = True\n                Else\n                    Sheets(Workseetname).Visible = False\n                End If\n    Next i\n\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>Please advise and share your thoughts. Thanks in advance.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1493248124, "post_id": 43645685, "comment_id": 74340358, "body": "<code>Range(&quot;A4:B36&quot;).Value</code> will give you an array of cell contents.  Instead you need to have some kind of text-based content to add to the Body.  Typically you&#39;d get that by looping over the cells in the range and creating a concatenated version of the cell contents (as shown in your original code)"}], "answers": [{"tags": [], "owner": {"reputation": 178, "user_id": 7797433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1f96c98c332cc99a3f6b6d27761b2c4?s=128&d=identicon&r=PG&f=1", "display_name": "gr8tech", "link": "https://stackoverflow.com/users/7797433/gr8tech"}, "is_accepted": true, "score": 1, "last_activity_date": 1493248598, "creation_date": 1493248598, "answer_id": 43646076, "question_id": 43645685, "link": "https://stackoverflow.com/questions/43645685/get-data-from-multiple-cells/43646076#43646076", "title": "Get data from multiple cells", "body": "<p>You need to loop through the range and combine the values in the range like in the following example;</p>\n\n<pre><code>Dim strbody As String\n\nFor Each cell In sh.Range(\"A1:B2\")\n    strbody = strbody &amp; cell.Value  &amp; vbNewLine\nNext cell\n</code></pre>\n\n<p>Then include the strbody in you outlook with statement</p>\n\n<pre><code>With OutMail\n    .To = sh.Range(\"B1\").Value\n    .CC = \"\"\n    .BCC = \"\"\n    .Subject = \"Monthly Shirt Sales\"\n    .Body = strbody\n    .send   'or use .Display\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 4843363, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155483593100082/picture?type=large", "display_name": "Audrey Marie Meyer", "link": "https://stackoverflow.com/users/4843363/audrey-marie-meyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 257, "favorite_count": 0, "accepted_answer_id": 43646076, "answer_count": 1, "score": 0, "last_activity_date": 1528255048, "creation_date": 1493246382, "last_edit_date": 1528255048, "question_id": 43645685, "link": "https://stackoverflow.com/questions/43645685/get-data-from-multiple-cells", "title": "Get data from multiple cells", "body": "<p>I'm using VBA code from Ron de Bruin that sends every sheet with an email address to the address in a specified cell.  It's meant to send the sheet as an attachment.</p>\n\n<p>I want to get data from multiple cells, to put in the body of the email.</p>\n\n<p>I commented out the parts that send the attachment and sent an email that contained data from one cell in the body of the email.</p>\n\n<p>I cannot get data from multiple cells. The email arrives blank.</p>\n\n<pre><code>Sub Mail_Every_Worksheet()\n'Working in Excel 2000-2016\n'For Tips see: http://www.rondebruin.nl/win/winmail/Outlook/tips.htm\nDim sh As Worksheet\nDim wb As Workbook\nDim FileExtStr As String\nDim FileFormatNum As Long\nDim TempFilePath As String\nDim TempFileName As String\nDim OutApp As Object\nDim OutMail As Object\n\nTempFilePath = Environ$(\"temp\") &amp; \"\\\"\n\nIf Val(Application.Version) &lt; 12 Then\n    'You use Excel 97-2003\n    FileExtStr = \".xls\": FileFormatNum = -4143\nElse\n    'You use Excel 2007-2016\n    FileExtStr = \".xlsm\": FileFormatNum = 52\nEnd If\n\nWith Application\n    .ScreenUpdating = False\n    .EnableEvents = False\nEnd With\n\nSet OutApp = CreateObject(\"Outlook.Application\")\n\nFor Each sh In ThisWorkbook.Worksheets\n    If sh.Range(\"B1\").Value Like \"?*@?*.?*\" Then\n\n        sh.Copy\n        Set wb = ActiveWorkbook\n\n        TempFileName = \"Sheet \" &amp; sh.Name &amp; \" of \" _\n                     &amp; ThisWorkbook.Name &amp; \" \" &amp; Format(Now, \"dd-mmm-yy h-mm-ss\")\n\n        Set OutMail = OutApp.CreateItem(0)\n\n        With wb\n            .SaveAs TempFilePath &amp; TempFileName &amp; FileExtStr, FileFormat:=FileFormatNum\n\n            On Error Resume Next\n            With OutMail\n                .To = sh.Range(\"B1\").Value\n                .CC = \"\"\n                .BCC = \"\"\n                .Subject = \"Monthly Shirt Sales\"\n                Dim cell As Range\n                Dim strbody As String\n                For Each cell In \n                ThisWorkbook.Sheets(\"Sheet1\").Range(\"A4:A36\")\n                strbody = strbody &amp; cell.Value &amp; vbNewLine\n                Next\n                '.Attachments.Add wb.FullName\n                'You can add other files also like this\n                '.Attachments.Add (\"C:\\test.txt\")\n                .Send   'or use .Display\n            End With\n            On Error GoTo 0\n\n            .Close savechanges:=False\n        End With\n\n        Set OutMail = Nothing\n\n        Kill TempFilePath &amp; TempFileName &amp; FileExtStr\n\n    End If\nNext sh\n\nSet OutApp = Nothing\n\nWith Application\n    .ScreenUpdating = True\n    .EnableEvents = True\nEnd With\nEnd Sub\n</code></pre>\n\n<p>It works to send the data from one cell when I replace </p>\n\n<pre><code>Dim cell As Range\nDim strbody As String\nFor Each cell In ThisWorkbook.Sheets(\"Sheet1\").Range(\"A4:A36\")\nstrbody = strbody &amp; cell.Value &amp; vbNewLine\nNext\n</code></pre>\n\n<p>with this:</p>\n\n<pre><code>.Body = sh.Range(\"A4\").Value\n</code></pre>\n\n<p>so I thought that using this would work:</p>\n\n<pre><code>.Body = sh.Range(\"A4:B36\").Value\n</code></pre>\n\n<p>but it also does not get data and sends a blank email.</p>\n\n<p>How do I get data from multiple cells?</p>\n"}, {"tags": ["arrays", "vba", "excel", "indexing"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1493244264, "post_id": 43645241, "comment_id": 74338977, "body": "Possibly completely unrelated to your question but your <code>Counter</code> function will always return <code>1</code>.  (You create a variable called <code>i</code>, which is implicitly initialised to zero.  You then add <code>1</code> to that variable, and then return that incremented value.)  Is that intentional?"}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 1, "creation_date": 1493245984, "post_id": 43645241, "comment_id": 74339615, "body": "Your code is somehow confusing and missing. You need to declare <code>Dim objDiceDict As Object</code>. What is <code>clsDice</code>? Where is this object? <code>GoTo StartGame:</code> statement does not work like that. As YowE3K stated, you need to declare <code>Dim i As Long</code> outside of your sub if you want to increment it. I stopped looking at your code after all of these."}, {"owner": {"reputation": 620, "user_id": 3119180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cc7a56a59ab84634ee6cb37a7131ed2?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Holton", "link": "https://stackoverflow.com/users/3119180/rich-holton"}, "edited": false, "score": 0, "creation_date": 1493246780, "post_id": 43645241, "comment_id": 74339877, "body": "The structure you use to store the data depends one how you want to use it. If you want to create a graph that shows how many times each of the numbers 1 through 6 were rolled, regardless of order, than an array with dimensions 1 to 6 would work, and you add one to the array element for each die roll result. You could use the same technique for rolls of 2 through 12 (using total of two dice). If you want to include a &quot;time&quot; element you could use a collection to store each roll, you could add objDice to the collection after each rollDice."}], "owner": {"user_type": "does_not_exist", "display_name": "user7896918"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 185, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1493244000, "creation_date": 1493244000, "last_edit_date": 1531164843, "question_id": 43645241, "link": "https://stackoverflow.com/questions/43645241/indexing-random-dice-rolls-vba", "title": "Indexing random Dice Rolls (VBA)", "body": "<p>I am building a simulation for the game of craps, below is my code to run through the process of rolling, along with a dice Class that executes the random rolls. I want to be able to graph the distribution of the rolls. For that, I believe I need to but the random rolls into an array, can anyone help I have been stuck for awhile.</p>\n\n<pre><code>Sub SetThePoint()\n    Dim lngRoll As Long\n    Dim lngNextRoll As Long\n    Dim lngThePoint As Long\n    Dim lngCounter As Long\n    Dim boolPointSet As Boolean\n    Dim boolResolved As Boolean\n\n    Set objDiceDict = CreateObject(\"Scripting.Dictionary\")\n    Set objDice = New clsDice\n    'this procedure takes the value the roll dice function and conintiously rolls until a point is set\n'StartGame:\n    Do\n        objDice.RollDice\n        lngRoll = objDice.sumDice\n        'Debug.Print lngRoll\n        Select Case lngRoll\n            Case Is = 2\n                boolPointSet = False\n            Case Is = 3\n                boolPointSet = False\n            Case Is = 4\n                boolPointSet = True\n                lngThePoint = 4\n            Case Is = 5\n                boolPointSet = True\n                lngThePoint = 5\n            Case Is = 6\n                boolPointSet = True\n                lngThePoint = 6\n            Case Is = 7\n                boolPointSet = False\n            Case Is = 8\n                boolPointSet = True\n                lngThePoint = 8\n            Case Is = 9\n                boolPointSet = True\n                lngThePoint = 9\n            Case Is = 10\n                boolPointSet = True\n                lngThePoint = 10\n            Case Is = 11\n                boolPointSet = False\n            Case Is = 12\n                boolPointSet = False\n            Case Else\n                boolPointSet = False\n        End Select\n        'Call PassLineBet(lngRoll)\n    Loop While boolPointSet = False\n\n\n    If boolPointSet = True Then\n        Do Until boolResolved = True\n            Debug.Print \"The current point is a \" &amp; lngThePoint\n            objDice.RollDice\n            lngNextRoll = objDice.sumDice\n            'Debug.Print lngCounter\n            Debug.Print \"You Rolled a \" &amp; lngNextRoll\n                If lngNextRoll = lngThePoint Then\n                    'boolResolved = True\n                    Debug.Print \"You win\"\n                    GoTo StartGame:\n                ElseIf lngNextRoll = 7 Then\n                    boolResolved = True\n                    Debug.Print \"You Lose\"\n                    'Debug.Print \"Roll #: \" &amp; lngCounter\n                    Exit Sub\n                Else\n                    boolResolved = False\n                End If\n        Loop\n    End If\nEnd Sub\n</code></pre>\n\n<p>Break, Class:        </p>\n\n<pre><code>Option Explicit\nPublic diceOne As Long\nPublic diceTwo As Long\nPublic rollNum As Long\nPublic lngRollCounter As Long\nPublic sumDice As Long\nPublic lngPointsMade As Long\nPublic lSum As Long\n\n\n\nPublic Sub RollDice()\n    lngRollCounter = Counter\n    diceOne = Application.WorksheetFunction.RandBetween(1, 6)\n    diceTwo = Application.WorksheetFunction.RandBetween(1, 6)\n    sumDice = diceOne + diceTwo\nEnd Sub\n\nPrivate Sub Class_Initialize()\nEnd Sub\nPublic Function Counter() As Long\n    Dim i As Long\n\n    i = i + 1\n    Counter = i\n\n\nEnd Function\n</code></pre>\n"}, {"tags": ["sql-server", "vba", "ms-access", "subform"], "comments": [{"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1493278849, "post_id": 43645218, "comment_id": 74350525, "body": "CF can really slow down. Remove that and see if it makes a change."}, {"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1493320784, "post_id": 43645218, "comment_id": 74379410, "body": "I find SQL server can be slow to communicate with Access, especially compared to native operations, though that depends on the network speed. Queries on large sets seem exponentially slower than smaller queries. I find if the user is in control though the delay is more acceptable, so consider having the user click a button to get the data, rather than automatically getting the data and then having them wait for the form to load."}, {"owner": {"reputation": 769, "user_id": 4769865, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/oxMAK.gif?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/4769865/mike"}, "edited": false, "score": 0, "creation_date": 1493413470, "post_id": 43645218, "comment_id": 74423931, "body": "I cannot remove the CF, as they apply color to each record and the application is highly dependent on colorization. And I&#39;d rather have the calendar load than open up completely blank and have the users click the refresh button. Either way it will need to load the data."}], "owner": {"reputation": 769, "user_id": 4769865, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/oxMAK.gif?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/4769865/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 182, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1493243877, "creation_date": 1493243877, "question_id": 43645218, "link": "https://stackoverflow.com/questions/43645218/access-form-load-speed-containing-multiple-continuous-subforms", "title": "Access form load speed containing multiple continuous subforms", "body": "<p>I have a form that consists of 14 continuous subforms (calendar format). The subforms start out with no record source, and I have VBA code cycles through the controls and sets the recordset data from SQL Server (through linked tables) through the line <code>Me.RecordSource = [tSQL query string]</code>. Everything runs on the local network. There are about 4000 records in the table and each subform will contain 40 records on average. I also have conditional formatting to change control colors. The form takes about 3-4 seconds to load when I refresh it. Is this normal? Is there a way to speed this up? My goal is to switch to cloud SQL, but if it takes 3 seconds locally, It's not going to be an acceptable speed through the cloud.</p>\n"}, {"tags": ["sql", "vba", "excel", "odbc", "netezza"], "comments": [{"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1493243847, "post_id": 43645049, "comment_id": 74338801, "body": "try <code>servername=servername,portnumber</code>"}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1493244351, "post_id": 43645049, "comment_id": 74339009, "body": "Subtract <code>New</code> from declaration as <code>Dim cmd As ADODB.Command</code> and <code>Dim rs As ADODB.Recordset</code>. And make sure rs is lowercase as <code>Set rs = New ADODB.Recordset</code>."}, {"owner": {"reputation": 558, "user_id": 7927748, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/62bb7763ae9694456113fb6787786e9a?s=128&d=identicon&r=PG&f=1", "display_name": "Torc", "link": "https://stackoverflow.com/users/7927748/torc"}, "reply_to_user": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1493331627, "post_id": 43645049, "comment_id": 74384519, "body": "Driver={NetezzaSQL};servername=myServerAddress;port=myPortNu&zwnj;&#8203;mber; database=myDataBase;username=myUsername;password=myPassword"}, {"owner": {"reputation": 558, "user_id": 7927748, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/62bb7763ae9694456113fb6787786e9a?s=128&d=identicon&r=PG&f=1", "display_name": "Torc", "link": "https://stackoverflow.com/users/7927748/torc"}, "reply_to_user": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1493331760, "post_id": 43645049, "comment_id": 74384558, "body": "The above comment seems to be the proper connection string for Netezza ODBC, so I am led to believe that it is something about how I am defining the dimensions. When I run this code now, I am getting an error that states : &quot;[Microsoft][ODBC Driver Manager] Data source name not found and no default driver specified&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 558, "user_id": 7927748, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/62bb7763ae9694456113fb6787786e9a?s=128&d=identicon&r=PG&f=1", "display_name": "Torc", "link": "https://stackoverflow.com/users/7927748/torc"}, "edited": false, "score": 0, "creation_date": 1496704184, "post_id": 43878974, "comment_id": 75758892, "body": "I have been continuing on this issue and have yet to find a working product like I have for Oracle and Microsoft SQL Server."}], "tags": [], "owner": {"reputation": 573, "user_id": 7174522, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9NycR.gif?s=128&g=1", "display_name": "kltft", "link": "https://stackoverflow.com/users/7174522/kltft"}, "is_accepted": false, "score": 1, "last_activity_date": 1494360811, "last_edit_date": 1494360811, "creation_date": 1494360460, "answer_id": 43878974, "question_id": 43645049, "link": "https://stackoverflow.com/questions/43645049/how-to-connect-to-netezza-puredata-system-for-analytics-via-vba/43878974#43878974", "title": "How to connect to Netezza (PureData System for Analytics) via VBA", "body": "<p>I think your connection string is ok, and yes you should need to open a connection first. </p>\n\n<p>Like this:</p>\n\n<pre><code>AccessConnect = \"Driver={Netezza \" &amp; _\n\"ODBC};servername=servername;port=####;database=database;\" &amp; _\n\"username=username;password=password;\"\n\nDim Conn1 As New adodb.Connection\nConn1.ConnectionString = AccessConnect\nConn1.Open\n</code></pre>\n\n<p>then it would be </p>\n\n<pre><code>Set RS = Conn1.Execute(x) 'where x is your query\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 558, "user_id": 7927748, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/62bb7763ae9694456113fb6787786e9a?s=128&d=identicon&r=PG&f=1", "display_name": "Torc", "link": "https://stackoverflow.com/users/7927748/torc"}, "is_accepted": true, "score": 1, "last_activity_date": 1497358238, "creation_date": 1497358238, "answer_id": 44522061, "question_id": 43645049, "link": "https://stackoverflow.com/questions/43645049/how-to-connect-to-netezza-puredata-system-for-analytics-via-vba/44522061#44522061", "title": "How to connect to Netezza (PureData System for Analytics) via VBA", "body": "<p>I was able to figure out the issue on my own. I found that there is a command line builder in the 'Tools' tab in Aginity, which helped specify the exact connection string I needed to connect to Netezza. Once I had this connection string, I was getting an 'architecture mismatch' error. After downloading the 32-bit ODBC drivers for Netezza, the methodology worked perfectly. Here is the updated code below:</p>\n\n<pre><code>Dim cn As ADODB.Connection\nDim rs As ADODB.Recordset        \nDim iCols As Integer             \nDim DB As String, User As String, PW As String, ConnectionString As String\nDim Server As String, Query As String\nDim SQLTable As Worksheet\n\nSet cn = New ADODB.Connection\nSet rs = New ADODB.Recordset\nSet SQLTable = Sheet1\n\nServer = SQLTable.Cells(2,3).Value\nUser = SQLTable.Cells(2,4).Value\nPW = SQLTable.Cells(2,5).Value\nDB = SQLTable.Cells(2,6).Value\nQuery = SQLTable.Cells(2,7).Value\n\nConnectionString = \"Driver={NetezzaSQL};\" &amp; _\n                   \"server=\" &amp; Server &amp; \";\" &amp; _\n                   \"UserName=\" &amp; User &amp; \";\" &amp; _\n                   \"Password=\" &amp; PW &amp; \";\" &amp; _\n                   \"Database=\" &amp; DB &amp; \";\" &amp; _\n                   \"Query Timeout=120\"\n\ncn.Open (ConnectionString)\nrs.Open (Query), cn\n\nFor iCols = 0 To RS.Fields.count - 1\n    Worksheets(\"Sheet2\").Cells(1, iCols + 1).Value = rs.Fields(iCols).Name\nNext\nWorksheets(\"Sheet2\").Cells(2, \"A\").CopyFromRecordset rs\n\nrs.Close\ncn.Close\n</code></pre>\n\n<p>NB:</p>\n\n<ul>\n<li>\"IBM NETEZZA ODBC DRIVER \u2013 32 BIT\" is what I downloaded</li>\n<li>\"ODBC-DRIVER-FOR-NETEZZA-7-X86\" is what showed up in my software center to install</li>\n<li>\"Name: NetezzaSQL ; Version: 7.00.04.41188 ; Company: www.ibm.com ; File: NSQLODBC.DLL\" is what is shown now in my 32-bit 'ODBC Data Source Administrator' window</li>\n</ul>\n"}], "owner": {"reputation": 558, "user_id": 7927748, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/62bb7763ae9694456113fb6787786e9a?s=128&d=identicon&r=PG&f=1", "display_name": "Torc", "link": "https://stackoverflow.com/users/7927748/torc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2795, "favorite_count": 0, "accepted_answer_id": 44522061, "answer_count": 2, "score": 0, "last_activity_date": 1497358238, "creation_date": 1493243113, "question_id": 43645049, "link": "https://stackoverflow.com/questions/43645049/how-to-connect-to-netezza-puredata-system-for-analytics-via-vba", "title": "How to connect to Netezza (PureData System for Analytics) via VBA", "body": "<p>I am trying to connect to connect to Netezza using VBA. I have enabled the following:</p>\n\n<ul>\n<li>Microsoft Excel 15.0 Object Library</li>\n<li>Microsoft Office 15.0 Object Library</li>\n<li>Microsoft ActiveX Data Objects 6.1 Library</li>\n<li>Visual Basic for Applications</li>\n</ul>\n\n<p>Here is my code:</p>\n\n<pre><code>Sub NZConn()\n\nDim cmd As New ADODB.Command\nDim rs As New ADODB.Recordset\nDim x As Variant\n\nSet cmd = New ADODB.Command\nSet RS = New ADODB.Recordset\n\ncmd.ActiveConnection = \"Driver={Netezza \" &amp; _\n\"ODBC};servername=servername;port=####;database=database;\" &amp; _\n\"username=username;password=password;\"\n\ncmd.ActiveConnection.CursorLocation = adUseClient\ncmd.CommandTimeout = 120\ncmd.CommandType = adCmdText\n\nx = \"Write Query here\"\ncmd.CommandText = x\n\nSet rs = cmd.Execute\nSheet1.Range(\"A1\").CopyFromRecordset rs\n\ncmd.ActiveConnection.Close\n\nEnd Sub\n</code></pre>\n\n<p>I can get the code to run without throwing back an error, but there is nothing that is pasted from the record set, which leads me to believe that is may have something to do with the structure of the connection string. </p>\n\n<p>I have the server, user id, password, database, port, and driver. </p>\n\n<p>Would I need to establish / open an ActiveConnection first?</p>\n"}, {"tags": ["vba", "excel", "out-of-memory"], "comments": [{"owner": {"reputation": 13, "user_id": 7675776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d20d62e5e178a655d41c5a0073a583f3?s=128&d=identicon&r=PG&f=1", "display_name": "haans", "link": "https://stackoverflow.com/users/7675776/haans"}, "reply_to_user": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "edited": false, "score": 0, "creation_date": 1493243561, "post_id": 43644970, "comment_id": 74338674, "body": "No formulas on the workbook with contents to be imported - just data."}, {"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "edited": false, "score": 1, "creation_date": 1493243610, "post_id": 43644970, "comment_id": 74338700, "body": "Your problem comes from the fact that you copy 1048576*16384 cells. You know how big is that? Do you really need to do that? You can only copy the range that has data in it and it&#39;s gonna be much faster and less computationally expensive."}, {"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "edited": false, "score": 0, "creation_date": 1493243683, "post_id": 43644970, "comment_id": 74338732, "body": "Also, when you have no formula consider assigning them to the range instead of copy/paste."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1493244150, "post_id": 43644970, "comment_id": 74338921, "body": "If you&#39;re copy/pasting <i>all the cells</i> in a sheet to another sheet, why not just copy the worksheet itself instead?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1493244874, "post_id": 43644970, "comment_id": 74339235, "body": "@BruceWayne - one possible disadvantage of copying the worksheet is that you would (IIRC) be creating a new worksheet, and <code>Workbooks(F_Home)</code> may have other sheets which have formulas referencing cells in the existing <code>Workbooks(F_Home).Sheets(Sheet1)</code>.  So overwriting the existing data may be the only viable option."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1493246121, "post_id": 43644970, "comment_id": 74339660, "body": "@YowE3K - Ah, good point. With that in mind, is it safe to say it&#39;s better practice to use the sheet name over the <code>Sheet1</code>? I.e. <code>Worksbooks(F_Home).Sheets(&quot;Sheet1&quot;)</code> over <code>...Sheets(Sheet1)</code>? Or is that really dependent on what the user wants to do/how the macro is written and hard to say generally?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1493246879, "post_id": 43644970, "comment_id": 74339907, "body": "@BruceWayne - In order to not crash, <code>Sheet1</code> in the expression <code>Sheets(Sheet1)</code> would have to be a numeric or string variable containing the sheet number or name.  (That variable may, for instance, contain the string &quot;ThisIsMySheet&quot; or the number 5.)  I&#39;m not sure whether the OP actually is using variables called <code>F_Home</code>, <code>F_Source</code>, <code>Sheet1</code>, etc, or whether they have &quot;anonymised&quot; their posted code by placing those &quot;variable names&quot; in there to substitute for hard-coded values in their actual code."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1493247050, "post_id": 43644970, "comment_id": 74339983, "body": "@YowE3K - Ah, duh I knew that...I was thinking <code>Sheets(1)</code> vs <code>Sheets(&quot;Sheet1&quot;)</code>. Don&#39;t mean to derail, so I&#39;ll just research on my own. Thanks though for clarifying and reminding me of that."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1493247621, "post_id": 43644970, "comment_id": 74340171, "body": "@BruceWayne - Re <code>Sheets(1)</code> vs <code>Sheets(&quot;Sheet1&quot;)</code> - I always prefer the latter - it is too easy for a user to change the order of sheets, but they are less likely to change the sheet names.  (Or, at least, if they do change the name then it is easier to search and replace in the code to change the names there as well.)"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7675776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d20d62e5e178a655d41c5a0073a583f3?s=128&d=identicon&r=PG&f=1", "display_name": "haans", "link": "https://stackoverflow.com/users/7675776/haans"}, "edited": false, "score": 0, "creation_date": 1493737205, "post_id": 43645258, "comment_id": 74525240, "body": "Unfortunately, I&#39;ve encountered an issue with copying data using this method. When in debugging mode, the S_Range variable is populated with all the data from the F_Source workbook and copies over data to the F_Home Workbook. However, when calling this function without debugging and stepping through the code, it only copies over 3 rows of data versus the many thousands of row I have in the F_Source workbook."}, {"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "reply_to_user": {"reputation": 13, "user_id": 7675776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d20d62e5e178a655d41c5a0073a583f3?s=128&d=identicon&r=PG&f=1", "display_name": "haans", "link": "https://stackoverflow.com/users/7675776/haans"}, "edited": false, "score": 0, "creation_date": 1493737956, "post_id": 43645258, "comment_id": 74525832, "body": "Please <a href=\"http://stackoverflow.com/posts/43644970/edit\">edit</a> your question and include the exact code you are using. This problem doesn&#39;t have anything with this part of the code. Something else triggers it."}], "tags": [], "owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "is_accepted": true, "score": 0, "last_activity_date": 1506010170, "last_edit_date": 1506010170, "creation_date": 1493244086, "answer_id": 43645258, "question_id": 43644970, "link": "https://stackoverflow.com/questions/43644970/excel-vba-memory-exceeds-limits-on-second-import/43645258#43645258", "title": "Excel VBA: Memory Exceeds Limits on Second Import", "body": "<p>Copy and pasting the whole sheet is not a wise approach. Let's assume you have data from \"A1:Z99999\". You can do this which is going to be much faster.</p>\n\n<pre><code>Set S_Range = Workbooks(F_Source).Sheets(S_Source).Range(\"A1:Z99999\")\nSet H_Range = Workbooks(F_Home).Sheets(Sheet1).Range(\"A1:Z99999\")\n\nH_Range.Value = S_Range.Value\n</code></pre>\n\n<p>Also read <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">why you should avoid selecting and activating in vba</a>.</p>\n"}], "owner": {"reputation": 13, "user_id": 7675776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d20d62e5e178a655d41c5a0073a583f3?s=128&d=identicon&r=PG&f=1", "display_name": "haans", "link": "https://stackoverflow.com/users/7675776/haans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 43645258, "answer_count": 1, "score": 1, "last_activity_date": 1506010170, "creation_date": 1493242832, "last_edit_date": 1493243486, "question_id": 43644970, "link": "https://stackoverflow.com/questions/43644970/excel-vba-memory-exceeds-limits-on-second-import", "title": "Excel VBA: Memory Exceeds Limits on Second Import", "body": "<p>I am using 32-bit 2013 Excel with VBA extensively. I have disabled hardware graphics acceleration and COM add-ins, yet I still struggle with the following problem:</p>\n\n<p>I am importing the contents of another large workbook with formatting on the cells but with no formulas (~3mb Excel file) into the problematic Excel workbook. On the first attempt - when the contents have not been imported yet - the import succeeds. I am importing the content via VBA similar to the following code:</p>\n\n<pre><code> Application.Workbooks(F_Home).Activate\n Workbooks(F_Home).Sheets(Sheet1).Visible = xlSheetVisible\n ...\n Application.Workbooks(F_Source).Activate\n Workbooks(F_Source).Sheets(S_Source).Cells.Copy Destination:=Workbooks(F_Home).Sheets(Sheet1).Cells\n Application.Workbooks(F_Home).Activate\n</code></pre>\n\n<p>F_Home is the problematic Excel workbook and F_Source is the workbook with the content we are importing in. When doing this the first time it works, and then I save the file and close out of it, and reopen the file, and try this a second time. On the second time we attempt to import the contents (when the contents already imported) the F_Home workbook crashes with the Out of Memory Error (There isn't enough memory to complete this action...) on the line that copies F_Source contents to F_Home.</p>\n\n<p>Using Process Explorer I've found that the Excel process usually runs around 600mb - 700mb in virtual memory size, but when we run the VBA script to import the contents a second time, the virtual memory size suddenly jumps to 4gb (this does not happen on the first time around, which stays at the 600mb - 700mb range). How should I fix this? I cannot do a workaround such as saving the file before importing the contents a second time, because the timestamp on the file is used and saving the file through VBA will confuse some users.</p>\n\n<p>Thank you for your help. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1493241708, "post_id": 43644718, "comment_id": 74337858, "body": "Why aren&#39;t you using the built in sort function from the tool bar?"}, {"owner": {"reputation": 25, "user_id": 7855488, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2c59032c4d9b6e603734b05cb990eb01?s=128&d=identicon&r=PG&f=1", "display_name": "walid attia", "link": "https://stackoverflow.com/users/7855488/walid-attia"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1493241784, "post_id": 43644718, "comment_id": 74337896, "body": "@Scott Craner i want to use VBA macro, not manullay"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 4, "creation_date": 1493241822, "post_id": 43644718, "comment_id": 74337917, "body": "Then use the <code>range.sort</code> method."}, {"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "edited": false, "score": 2, "creation_date": 1493242359, "post_id": 43644718, "comment_id": 74338195, "body": "bubble sorting for ranges is not wise when there&#39;s a built in function for that. What you are doing may be applicable for arrays. I personally still experienced that writing to a range within a temp sheet, sorting that range and writing back to the array is also faster."}], "answers": [{"tags": [], "owner": {"reputation": 25, "user_id": 7855488, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2c59032c4d9b6e603734b05cb990eb01?s=128&d=identicon&r=PG&f=1", "display_name": "walid attia", "link": "https://stackoverflow.com/users/7855488/walid-attia"}, "is_accepted": false, "score": 0, "last_activity_date": 1493247637, "creation_date": 1493247637, "answer_id": 43645914, "question_id": 43644718, "link": "https://stackoverflow.com/questions/43644718/faster-method-for-sorting-data-smallest-to-largest-using-vba/43645914#43645914", "title": "faster method for sorting data smallest to largest using VBA", "body": "<pre><code>sub SortDataExample()\n\n 'Building data to sort on the active sheet.\n Range(\"A1\").Value = \"Name\"\n Range(\"A2\").Value = \"Bill\"\n Range(\"A3\").Value = \"Rod\"\n Range(\"A4\").Value = \"John\"\n Range(\"A5\").Value = \"Paddy\"\n Range(\"A6\").Value = \"Kelly\"\n Range(\"A7\").Value = \"William\"\n Range(\"A8\").Value = \"Janet\"\n Range(\"A9\").Value = \"Florence\"\n Range(\"A10\").Value = \"Albert\"\n Range(\"A11\").Value = \"Mary\"\n MsgBox \"The list is out of order. Hit Ok to continue...\", vbInformation\n\n 'Selecting a cell within the range.\n Range(\"A2\").Select\n\n 'Applying sort.\n With ActiveWorkbook.Worksheets(ActiveSheet.Name).Sort\n .SortFields.Clear\n .SortFields.Add Key:=Range(\"A2:A11\"), _\n SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n .SetRange Range(\"A1:A11\")\n .Header = xlYes\n .MatchCase = False\n .Orientation = xlTopToBottom\n .SortMethod = xlPinYin\n .Apply\n End With\n MsgBox \"Sort complete.\", vbInformation\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 7855488, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2c59032c4d9b6e603734b05cb990eb01?s=128&d=identicon&r=PG&f=1", "display_name": "walid attia", "link": "https://stackoverflow.com/users/7855488/walid-attia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3132, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1577406058, "creation_date": 1493241631, "last_edit_date": 1577406058, "question_id": 43644718, "link": "https://stackoverflow.com/questions/43644718/faster-method-for-sorting-data-smallest-to-largest-using-vba", "title": "faster method for sorting data smallest to largest using VBA", "body": "<p>I use the following code to sort the data in worksheet cells ,but for large amount of data ,it takes a lot of time. Is there any other method to do it more faster?</p>\n\n<p>the used code is:</p>\n\n<pre><code>Sub VBA_DataSorting()\nDim i As Integer\nDim j As Integer\nDim temp As Double ' must be double to contain fractional values\nDim rng As Range\nSet rng = Range(\"A1\").CurrentRegion 'Range of data to be sorted\nFor i = 1 To rng.count\n    For j = i + 1 To rng.count\n    If rng.Cells(j) &lt; rng.Cells(i) Then  ' sort smallest to largest\n    'swap numbers\n    temp = rng.Cells(i)\n    rng.Cells(i) = rng.Cells(j)\n    rng.Cells(j) = temp\n    End If\nNext j\nNext i\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1493240965, "post_id": 43644434, "comment_id": 74337529, "body": "If you show us the code you&#39;ve tried and where its failing, we can help you better. Not many are willing to write code for free, especially since it will be part of a larger, already existing code base. See <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask</a> for more on getting the most effective help here."}, {"owner": {"reputation": 15, "user_id": 2600879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c334155bdc611fc832405ba366ba0a2d?s=128&d=identicon&r=PG", "display_name": "Ditchmonkey", "link": "https://stackoverflow.com/users/2600879/ditchmonkey"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1493241071, "post_id": 43644434, "comment_id": 74337574, "body": "Well to clarify my &quot;code base&quot; is currently one line. I&#39;m a complete noob to Excel but I&#39;m trying. And regarding &quot;writing code for free&quot;, also just one line and this forum is full of one liners for free."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1493241312, "post_id": 43644434, "comment_id": 74337674, "body": "If the macro you already have that is removing other unwanted characters is just one line, then post it. We&#39;ll be able to help you better. It&#39;ll save a lot of potential back and forth and questions from you in case any solution provided doesn&#39;t integrate easily with your existing code.."}, {"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 0, "creation_date": 1493260715, "post_id": 43644434, "comment_id": 74343599, "body": "Try putting together the <a href=\"https://msdn.microsoft.com/en-us/library/office/gg251556.aspx\" rel=\"nofollow noreferrer\">Left function</a>, the <a href=\"https://msdn.microsoft.com/en-us/library/office/gg251796.aspx\" rel=\"nofollow noreferrer\">Like operator</a> and the <a href=\"https://msdn.microsoft.com/en-us/library/office/gg251677.aspx\" rel=\"nofollow noreferrer\">Mid function</a> and report back if you get stuck"}], "owner": {"reputation": 15, "user_id": 2600879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c334155bdc611fc832405ba366ba0a2d?s=128&d=identicon&r=PG", "display_name": "Ditchmonkey", "link": "https://stackoverflow.com/users/2600879/ditchmonkey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 248, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1493240430, "creation_date": 1493240430, "last_edit_date": 1531164843, "question_id": 43644434, "link": "https://stackoverflow.com/questions/43644434/excel-use-vba-to-remove-first-two-characters-of-string-if-they-are-a-number-fol", "title": "Excel: Use VBA to remove first two characters of string if they are a number followed by a dash", "body": "<p>I have Excel values where some strings start with a number followed by a dash 6-. I need to remove the number and dash for all strings that start like this. Using VBA because I already have a macro that is removing other unwanted characters.  </p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2016"], "comments": [{"owner": {"reputation": 355, "user_id": 6871823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e9bb4ad1cfdd32e4a47b65ba53432d?s=128&d=identicon&r=PG&f=1", "display_name": "geeFlo", "link": "https://stackoverflow.com/users/6871823/geeflo"}, "edited": false, "score": 0, "creation_date": 1493256947, "post_id": 43644300, "comment_id": 74342596, "body": "Do you need to use the query as your recordsource?   Is your query joining multiple tables, or are you just using the query to filter the recordset?"}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 4594579, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e1e9042af61c04077ab04996c4e3766f?s=128&d=identicon&r=PG&f=1", "display_name": "motifesta", "link": "https://stackoverflow.com/users/4594579/motifesta"}, "edited": false, "score": 0, "creation_date": 1493296905, "post_id": 43651283, "comment_id": 74363531, "body": "Thanks. I didn&#39;t realize I could do this with queries that pulled from multiple tables, but after some work, it achieved exactly what I was looking for."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 2, "last_activity_date": 1493278177, "creation_date": 1493278177, "answer_id": 43651283, "question_id": 43644300, "link": "https://stackoverflow.com/questions/43644300/ms-access-recordsource-selection-error/43651283#43651283", "title": "MS Access RecordSource selection error", "body": "<p>This sounds overly complicated. Just set the <em>Filter</em> property of the form - you can use the combobox to do that:</p>\n\n<pre><code>Me.Filter = \"EmployeeType = '\" &amp; Me!ComboSelectedType.Value \"'\"\nMe.FilterOn = True\n</code></pre>\n\n<p>or, if the value is numeric:</p>\n\n<pre><code>Me.Filter = \"EmployeeType = \" &amp; Me!ComboSelectedType.Value \"\"\nMe.FilterOn = True\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 4594579, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e1e9042af61c04077ab04996c4e3766f?s=128&d=identicon&r=PG&f=1", "display_name": "motifesta", "link": "https://stackoverflow.com/users/4594579/motifesta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "accepted_answer_id": 43651283, "answer_count": 1, "score": 0, "last_activity_date": 1594654386, "creation_date": 1493239906, "last_edit_date": 1594654386, "question_id": 43644300, "link": "https://stackoverflow.com/questions/43644300/ms-access-recordsource-selection-error", "title": "MS Access RecordSource selection error", "body": "<p>I am new to Access and have a form that displays a list of employees that is fetched from a query. It is a continuous list and I have a way to filter by employee type. I wanted to isolate the new record in the continuous form, so I added a button that changes <code>DataEntry = True</code>, however, when changing <code>DataEntry = False</code>, I ran into issues with the filtering working, and they appeared to stem around the <code>RecordSource</code>.</p>\n\n<p>The filtering is done using a <code>combobox</code> that calls a simple 'Requery' 'AfterUpdate()', and the query itself gets the values as criteria from the <code>combobox</code> selection.</p>\n\n<p>In the button to change to <code>DataEntry = False</code>, I have been trying to assign the <code>RecordSource</code> as well. Initially, it seemed to work great, but then Access crashed and now I am getting error <code>3701</code> once the button is pressed.</p>\n\n<p>I have tried various different syntax to try to set the <code>RecordSource</code>.</p>\n\n<p><code>Me.RecordSource = \"qryName\"</code>\n<code>Form.RecordSource = \"qryName</code>\n<code>Forms!frmName.RecordSource = \"qryName</code></p>\n\n<p>and all of the above with <code>\"SELECT * FROM [qryName]\"</code> instead of a simple string.</p>\n\n<p>Each gives me a 3701 error.</p>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["vba", "performance", "excel", "global-variables"], "comments": [{"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "edited": false, "score": 0, "creation_date": 1493240529, "post_id": 43644292, "comment_id": 74337296, "body": "&gt;However, it looks like using .Range(columnCity &amp; l) is notably slower than using .Range(&quot;A&quot; &amp; l). What about a <a href=\"http://stackoverflow.com/documentation/excel-vba/9798/excel-vba-optimization/30180/checking-time-of-execution#t=201704262101472070883\">quick test</a> to see how much slower actually?"}, {"owner": {"reputation": 384, "user_id": 4021742, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/cfccc79ddd782f8d13a88715aebcd061?s=128&d=identicon&r=PG", "display_name": "Tibo", "link": "https://stackoverflow.com/users/4021742/tibo"}, "reply_to_user": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "edited": false, "score": 0, "creation_date": 1493242595, "post_id": 43644292, "comment_id": 74338284, "body": "@Masoud, See Tim&#39;s answer (and my comments). My problem probably comes from <code>.Range</code> vs  <code>.Cells</code> rather than from the global variables."}, {"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "edited": false, "score": 0, "creation_date": 1493243176, "post_id": 43644292, "comment_id": 74338532, "body": "I referred you to the same approach (i.e. compare time of execution)."}], "answers": [{"comments": [{"owner": {"reputation": 384, "user_id": 4021742, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/cfccc79ddd782f8d13a88715aebcd061?s=128&d=identicon&r=PG", "display_name": "Tibo", "link": "https://stackoverflow.com/users/4021742/tibo"}, "edited": false, "score": 0, "creation_date": 1493242409, "post_id": 43644463, "comment_id": 74338222, "body": "Tim posted a answer where he does such a speed comparaison, but also address using <code>.Cells()</code> vs <code>.Range()</code>, which is probably my problem since... I think I indeed spent time changing every <code>.Cells(l, 1)</code> to <code>.Range(columnName &amp; l)</code> when I refactored my code to use the <i>column variable</i>. That would explain why you were not able to reproduce my performance issue... I&#39;ll now update on Tim&#39;s answer, but thanks a lot for your (also) very quick and relevant answer."}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": false, "score": 3, "last_activity_date": 1493240538, "creation_date": 1493240538, "answer_id": 43644463, "question_id": 43644292, "link": "https://stackoverflow.com/questions/43644292/vba-extensive-use-of-global-variables-for-referencing-columns/43644463#43644463", "title": "VBA : extensive use of global variables for referencing columns?", "body": "<p><em>Need an Answer to provide formatting and results, though this is more of a comment.</em></p>\n\n<p>I have found no significant difference between <code>.Range(columnCity &amp; l)</code> and <code>.Range(\"A\" &amp; l)</code>.  Can you provide more insight on how you came to this conclusion?</p>\n\n<p>Here is my code for speed comparison:</p>\n\n<pre><code>Public Const p_sCol As String = \"A\"\n\nSub tgr()\n\n    Dim ws As Worksheet\n    Dim i As Long, l As Long\n    Dim sTemp As String\n    Dim dTimer As Double\n    Dim aResults(1 To 1, 1 To 2) As Double\n\n    Set ws = ActiveWorkbook.ActiveSheet\n    l = 1\n\n    dTimer = Timer\n    For i = 1 To 100000\n        sTemp = vbNullString\n        sTemp = ws.Range(p_sCol &amp; l).Value\n    Next i\n    aResults(1, 1) = Timer - dTimer\n\n    dTimer = Timer\n    For i = 1 To 100000\n        sTemp = vbNullString\n        sTemp = ws.Range(\"A\" &amp; l).Value\n    Next i\n    aResults(1, 2) = Timer - dTimer\n\n    ws.Range(\"C1:D1\").Value = aResults\n\nEnd Sub\n</code></pre>\n\n<p>I ran the test 10 times, and the average result for the public variable concatenation over 100,000 iterations was 0.4375 seconds while the average result for hard coding the column letter was 0.429688 seconds, which is a difference of 0.007813 seconds.  Sure, the hard coded method was slightly faster, but not noticeably and certainly not significantly.</p>\n"}, {"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1493241075, "post_id": 43644472, "comment_id": 74337575, "body": "FWIW - I got 1.4 sec and 0.7 sec on my computer, and then tried using <code>v = .Cells(1, columnName).Value</code> and that was 0.9 sec."}, {"owner": {"reputation": 384, "user_id": 4021742, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/cfccc79ddd782f8d13a88715aebcd061?s=128&d=identicon&r=PG", "display_name": "Tibo", "link": "https://stackoverflow.com/users/4021742/tibo"}, "edited": false, "score": 0, "creation_date": 1493241703, "post_id": 43644472, "comment_id": 74337856, "body": "@Tim. Actually, I think I indeed spent time changing every <code>.Cells(l, 1)</code> to <code>.Range(columnName &amp; 1)</code> when I refactored my code to use the <i>column variable</i>. That means I should probably refactor back to `.Cells(l, colIndexName). Damn ! (I&#39;m now back home, I&#39;ll have a look tomorrow)"}, {"owner": {"reputation": 384, "user_id": 4021742, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/cfccc79ddd782f8d13a88715aebcd061?s=128&d=identicon&r=PG", "display_name": "Tibo", "link": "https://stackoverflow.com/users/4021742/tibo"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1493241910, "post_id": 43644472, "comment_id": 74337966, "body": "@YowE3K. I&#39;m not sure to understand. Can one use the column&#39;s letter in <code>.Cells()</code> (e.g. <code>.Cells(1, &quot;A&quot;)</code>) ?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 384, "user_id": 4021742, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/cfccc79ddd782f8d13a88715aebcd061?s=128&d=identicon&r=PG", "display_name": "Tibo", "link": "https://stackoverflow.com/users/4021742/tibo"}, "edited": false, "score": 2, "creation_date": 1493242175, "post_id": 43644472, "comment_id": 74338097, "body": "@Tibo - yes, you can use a string for the second argument"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 384, "user_id": 4021742, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/cfccc79ddd782f8d13a88715aebcd061?s=128&d=identicon&r=PG", "display_name": "Tibo", "link": "https://stackoverflow.com/users/4021742/tibo"}, "edited": false, "score": 0, "creation_date": 1493242623, "post_id": 43644472, "comment_id": 74338297, "body": "@Tibo - There is a slight performance hit by using strings (I guess VBA has to look up an index table to go from <code>&quot;Z&quot;</code> to <code>26</code>) but it is fairly insignificant."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1493242925, "post_id": 43644472, "comment_id": 74338422, "body": "And again FWIW, you can get a <b>very, very small</b> improvement (0.01 sec in these examples) by using <code>v = .Cells(1 + (colIndexName - 1) * 16384).Value</code>(i.e. hardcoding the number of columns in the sheet so that VBA doesn&#39;t have to do that calculation itself), but replacing the hardcoded number with <code>.Columns.Count</code> gives a noticable performance drop."}, {"owner": {"reputation": 384, "user_id": 4021742, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/cfccc79ddd782f8d13a88715aebcd061?s=128&d=identicon&r=PG", "display_name": "Tibo", "link": "https://stackoverflow.com/users/4021742/tibo"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1493243370, "post_id": 43644472, "comment_id": 74338599, "body": "@YowE3K, I guess there many more options to using <code>.Cells</code>that what I thought. But for sack of readability, I&#39;ll probably not use your last suggestion... ;-)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 384, "user_id": 4021742, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/cfccc79ddd782f8d13a88715aebcd061?s=128&d=identicon&r=PG", "display_name": "Tibo", "link": "https://stackoverflow.com/users/4021742/tibo"}, "edited": false, "score": 0, "creation_date": 1493243603, "post_id": 43644472, "comment_id": 74338694, "body": "@Tibo - LOL - I wouldn&#39;t use my last suggestion either!  I was just interested to see how much time could be saved by explicitly doing what VBA has to implicitly do.  (I wouldn&#39;t have been surprised if it had actually come out slightly slower.)"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 4, "last_activity_date": 1493243118, "last_edit_date": 1493243118, "creation_date": 1493240570, "answer_id": 43644472, "question_id": 43644292, "link": "https://stackoverflow.com/questions/43644292/vba-extensive-use-of-global-variables-for-referencing-columns/43644472#43644472", "title": "VBA : extensive use of global variables for referencing columns?", "body": "<p>There is no \"standard\" way to do this, so you should run some performance tests and figure out the most efficient method if performance is an issue for you.</p>\n\n<p>For example, using a numeric constant and <code>Cells()</code> seems to be about twice as fast as using <code>Range()</code>:</p>\n\n<pre><code>Option Explicit\n\nPublic Const columnName As String = \"A\"\nPublic Const colIndexName As Long = 1\n\nSub Tester()\n\n    Dim l As Long, v, t\n\n    t = Timer\n    With Sheet1\n        For l = 1 To 300000#\n        v = .Range(columnName &amp; 1).Value\n        Next l\n    End With\n    Debug.Print Timer - t   '&gt;&gt; approx. 1.3 sec\n\n\n    t = Timer\n    With Sheet1\n        For l = 1 To 300000#\n        v = .Cells(1, colIndexName).Value\n        Next l\n    End With\n    Debug.Print Timer - t   '&gt;&gt; approx. 0.6 sec\n\nEnd Sub\n</code></pre>\n\n<p>However, it's likely only twice as fast <em>if that's all you're doing</em> - as soon as you add in other tasks that difference may wash out.</p>\n"}], "owner": {"reputation": 384, "user_id": 4021742, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/cfccc79ddd782f8d13a88715aebcd061?s=128&d=identicon&r=PG", "display_name": "Tibo", "link": "https://stackoverflow.com/users/4021742/tibo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 542, "favorite_count": 0, "accepted_answer_id": 43644472, "answer_count": 2, "score": 1, "last_activity_date": 1493243118, "creation_date": 1493239849, "last_edit_date": 1493242843, "question_id": 43644292, "link": "https://stackoverflow.com/questions/43644292/vba-extensive-use-of-global-variables-for-referencing-columns", "title": "VBA : extensive use of global variables for referencing columns?", "body": "<h2>Context</h2>\n\n<p>I have a big macro where I have declared lots of <strong>global constant</strong> in a dedicated module (i.e, a module which contains only <code>Public Const</code> declarations).</p>\n\n<p>About 100 of those global constants are used to assign <strong>columns names</strong> to each column of my main <em>Data worksheet</em> :</p>\n\n<pre><code>Public Const columnName = \"A\"\nPublic Const columnCity = \"B\"\nPublic Const columnPhone = \"C\"\n...\nPublic Const columnColor = \"CX\"\n</code></pre>\n\n<p>This let me <strong>reference to the columns</strong> (of my <em>Data worksheet</em>, from the 10 other modules) using <code>.Range(columnColor &amp; l)</code> instead of using <code>.Range(\"CX\" &amp; l)</code> (where <code>l</code> is obviously the row number) . This is much <strong>easier to code</strong> (I don't need to search for the right column) or to update if I decide to insert a column before \"F\" (I only have to update my <em>const module</em> and not the 10 other code modules).</p>\n\n<p>However, it looks like using <code>.Range(columnCity &amp; l)</code> is notably <strong>slower</strong> than using <code>.Range(\"A\" &amp; l)</code>.  <strong><em>(SEE EDIT BELOW)</em></strong></p>\n\n<p>The most processors intensive tasks are done using big 2D arrays. But I'm still probably calling those <em>global column variables</em> 100 000 times in some subs, since I'm not only checking/updating values/formulas (which I could do on a 2D array) but also dealing with cell's <code>.Interior.Color</code>, <code>.Comment.Text</code> ...</p>\n\n<h2>Question</h2>\n\n<p>How bad an idea is it to use such global variables (<code>Public Const columnName...</code>) to reference columns ?</p>\n\n<p>Is there some <em>standard way</em> of doing so ?</p>\n\n<h2>Edit</h2>\n\n<p>As pointed by Tim, I think I indeed spent time changing every <code>.Cells(l, 1)</code> to <code>.Range(columnName &amp; 1)</code> when I refactored my code to use the <em>column variable</em>. That means that :</p>\n\n<ul>\n<li>My problem probably comes from using <code>.Range</code> vs <code>.Cells</code> rather than from the global variables. </li>\n<li>I should probably refactor back to <code>.Cells(l, colIndexName)</code>.</li>\n</ul>\n"}, {"tags": ["javascript", "vba", "ms-office", "add-in", "office-addins"], "answers": [{"comments": [{"owner": {"reputation": 129, "user_id": 2807274, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/12440262/picture?type=large", "display_name": "Brian Stallter", "link": "https://stackoverflow.com/users/2807274/brian-stallter"}, "edited": false, "score": 0, "creation_date": 1493269165, "post_id": 43646242, "comment_id": 74345869, "body": "I meant Excel and Access.  That seems rather roundabout to have to download to the server, then parse, then update the UI.  Why wouldn&#39;t you be able to access the typical VBA macro type functions?"}, {"owner": {"reputation": 129, "user_id": 2807274, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/12440262/picture?type=large", "display_name": "Brian Stallter", "link": "https://stackoverflow.com/users/2807274/brian-stallter"}, "edited": false, "score": 0, "creation_date": 1493269636, "post_id": 43646242, "comment_id": 74346028, "body": "Can I reliably load an access database or excel spreadsheet, parse, then serve the results to add-in using node.js?"}, {"owner": {"reputation": 5418, "user_id": 519226, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/dSD4J.jpg?s=128&g=1", "display_name": "Eric Legault", "link": "https://stackoverflow.com/users/519226/eric-legault"}, "reply_to_user": {"reputation": 129, "user_id": 2807274, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/12440262/picture?type=large", "display_name": "Brian Stallter", "link": "https://stackoverflow.com/users/2807274/brian-stallter"}, "edited": false, "score": 0, "creation_date": 1493316517, "post_id": 43646242, "comment_id": 74377025, "body": "To be clear, with Word and Excel web add-ins you can read and modify the active document and worksheet when the add-in is launched. But <i>other</i> files need web access or user upload. But I doubt they&#39;ll open up VBA macros for access from a web add-in."}, {"owner": {"reputation": 129, "user_id": 2807274, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/12440262/picture?type=large", "display_name": "Brian Stallter", "link": "https://stackoverflow.com/users/2807274/brian-stallter"}, "edited": false, "score": 0, "creation_date": 1493393458, "post_id": 43646242, "comment_id": 74413721, "body": "Thank you @Eric.  I saw from your profile you are an add-in guru.  Can I upload and download, from and to the server, through the add-in, as I can in a normal browser?"}, {"owner": {"reputation": 5418, "user_id": 519226, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/dSD4J.jpg?s=128&g=1", "display_name": "Eric Legault", "link": "https://stackoverflow.com/users/519226/eric-legault"}, "reply_to_user": {"reputation": 129, "user_id": 2807274, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/12440262/picture?type=large", "display_name": "Brian Stallter", "link": "https://stackoverflow.com/users/2807274/brian-stallter"}, "edited": false, "score": 1, "creation_date": 1493408958, "post_id": 43646242, "comment_id": 74421913, "body": "The add-in is really irrelevant - whatever you can do in any web page you can do in the add-in.  Otherwise the add-in serves as a broker between your code and the document. If you need custom server side processing (e.g. ASP.NET Web API) you have to have a web application on your web server that you can communicate with from your add-in code"}], "tags": [], "owner": {"reputation": 5418, "user_id": 519226, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/dSD4J.jpg?s=128&g=1", "display_name": "Eric Legault", "link": "https://stackoverflow.com/users/519226/eric-legault"}, "is_accepted": true, "score": 1, "last_activity_date": 1493249639, "creation_date": 1493249639, "answer_id": 43646242, "question_id": 43644212, "link": "https://stackoverflow.com/questions/43644212/microsoft-javascript-add-in-read-write-to-excel-access/43646242#43646242", "title": "Microsoft Javascript Add-In: read/write to Excel, Access", "body": "<p>By \"other Microsoft documents\" I'll assume you are talking about any related files the user has stored on their PC.  But these JavaScript for Office add-ins are essentially just web pages running in an embedded browser, and applications running in a browser are sandboxed and just don't have access to the local computer (without installing client helper applications).</p>\n\n<p>So your app will need to prompt the user to upload a file to your web server where you can interact with the file using a relevant API (which would be a completely different topic).  Or you can use web-based APIs to interact with web-based file systems (OneDrive/Graph, Dropbox, etc.).</p>\n"}], "owner": {"reputation": 129, "user_id": 2807274, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/12440262/picture?type=large", "display_name": "Brian Stallter", "link": "https://stackoverflow.com/users/2807274/brian-stallter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 366, "favorite_count": 0, "accepted_answer_id": 43646242, "answer_count": 1, "score": 0, "last_activity_date": 1493249639, "creation_date": 1493239549, "last_edit_date": 1493242661, "question_id": 43644212, "link": "https://stackoverflow.com/questions/43644212/microsoft-javascript-add-in-read-write-to-excel-access", "title": "Microsoft Javascript Add-In: read/write to Excel, Access", "body": "<p>I am trying to create a Microsoft Word Add in.  I would like the javascript Add in to have the ability to read and write to Microsoft Access and Microsoft Excel files.  This is trivial with VBA, but I do not want to divide up the user experience between my Javascript add in and a VBA button in the original Word document.  I would like to be able to read and write from the Javascript add in somehow.</p>\n\n<p>I know I have access to things like Word.run(function (context) {..... from the docs, but example functions have nothing to do with accessing other documents. </p>\n\n<p>What is the right way to access other Microsoft documents from a Javascript add in to read and write?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1493239987, "post_id": 43643899, "comment_id": 74336977, "body": "What row does the region containing cell A6 start on?"}], "answers": [{"comments": [{"owner": {"reputation": 455, "user_id": 1490183, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/cfd85b1c08381799df2f3b2d04384386?s=128&d=identicon&r=PG", "display_name": "Obed Lorisson", "link": "https://stackoverflow.com/users/1490183/obed-lorisson"}, "edited": false, "score": 0, "creation_date": 1493241625, "post_id": 43644572, "comment_id": 74337824, "body": "it&#39;s not working , it keeps writing on the same cell even with your adjustment ."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 455, "user_id": 1490183, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/cfd85b1c08381799df2f3b2d04384386?s=128&d=identicon&r=PG", "display_name": "Obed Lorisson", "link": "https://stackoverflow.com/users/1490183/obed-lorisson"}, "edited": false, "score": 0, "creation_date": 1493241660, "post_id": 43644572, "comment_id": 74337839, "body": "@ObedLorisson - Which row does the region that contains cell A6 start on?  If you don&#39;t know, type <code>?Worksheets(&quot;Sheet3&quot;).Range(&quot;A1&quot;).Offset(5).CurrentRegion.Ad&zwnj;&#8203;dress</code> in the Immediate Window and tell us what range it shows."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 455, "user_id": 1490183, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/cfd85b1c08381799df2f3b2d04384386?s=128&d=identicon&r=PG", "display_name": "Obed Lorisson", "link": "https://stackoverflow.com/users/1490183/obed-lorisson"}, "edited": false, "score": 0, "creation_date": 1493241876, "post_id": 43644572, "comment_id": 74337951, "body": "@ObedLorisson Also, do you want the new row written below the current region, or do you just want to replace what is in the row containing the first blank in column &quot;A&quot;?"}, {"owner": {"reputation": 455, "user_id": 1490183, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/cfd85b1c08381799df2f3b2d04384386?s=128&d=identicon&r=PG", "display_name": "Obed Lorisson", "link": "https://stackoverflow.com/users/1490183/obed-lorisson"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1493242057, "post_id": 43644572, "comment_id": 74338045, "body": "@YowE3K yes i want everyt subsequent entry to be written in the row below the previous one"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1493242398, "post_id": 43644572, "comment_id": 74338217, "body": "I did a quick update to your answer so that it correctly qualified the <code>Range</code> and <code>Rows</code> references.  (Then +1&#39;d the answer)  Revert the change back if you don&#39;t agree with it."}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1493242493, "post_id": 43644572, "comment_id": 74338247, "body": "I saw that after I posted, was going to add it in comment. Thanks for the +1. Appreciate that."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1493243356, "post_id": 43644572, "comment_id": 74338593, "body": "I don&#39;t like the rest of the OP&#39;s code, which is why I posted my own answer - but your answer certainly would fix the issue raised in the question, and does it with the minimum amount of change to the original code (which is always a bonus)."}, {"owner": {"reputation": 455, "user_id": 1490183, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/cfd85b1c08381799df2f3b2d04384386?s=128&d=identicon&r=PG", "display_name": "Obed Lorisson", "link": "https://stackoverflow.com/users/1490183/obed-lorisson"}, "edited": false, "score": 0, "creation_date": 1493260363, "post_id": 43644572, "comment_id": 74343496, "body": "i&#39;m a newbie with vba but both answers , try both ways doesn&#39;t write the data where i need it to be . and it&#39;s not working .Just to be fair some column have a formula in them . i don&#39;t know if that will make a difference"}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1493281636, "post_id": 43644572, "comment_id": 74352381, "body": "Of course it makes a difference. This assignment actually finds the last empty cell&#39;s row number. So if you have formula in your empty looking cells, these cells are considered as non blank cells. You can try and see that both YowE3K&#39;s method and my correction do what you need if you remove your formulas from empty looking cells."}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1493285447, "post_id": 43644572, "comment_id": 74355127, "body": "Sorry I get it wrong. If the formula is somewhere else, it is ok. It doesn&#39;t change what you are trying to do based on your code."}, {"owner": {"reputation": 455, "user_id": 1490183, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/cfd85b1c08381799df2f3b2d04384386?s=128&d=identicon&r=PG", "display_name": "Obed Lorisson", "link": "https://stackoverflow.com/users/1490183/obed-lorisson"}, "edited": false, "score": 0, "creation_date": 1493320984, "post_id": 43644572, "comment_id": 74379512, "body": "I just fix the prob ,was with the merged cell from A1 to A5. for some reasons it was not able to insert the data ."}], "tags": [], "owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "is_accepted": true, "score": 2, "last_activity_date": 1493242353, "last_edit_date": 1493242353, "creation_date": 1493240984, "answer_id": 43644572, "question_id": 43643899, "link": "https://stackoverflow.com/questions/43643899/how-to-make-my-user-form-insert-data-to-the-next-row/43644572#43644572", "title": "how to make my user form insert data to the next row", "body": "<p><strong>Edit:</strong></p>\n\n<p>Simply use this to get the last row:</p>\n\n<pre><code>RowCount =  Worksheets(\"Sheet3\").Range(\"A\" &amp;  Worksheets(\"Sheet3\").Rows.Count).End(xlUp).Row\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 0, "last_activity_date": 1493242308, "creation_date": 1493242308, "answer_id": 43644862, "question_id": 43643899, "link": "https://stackoverflow.com/questions/43643899/how-to-make-my-user-form-insert-data-to-the-next-row/43644862#43644862", "title": "how to make my user form insert data to the next row", "body": "<p>Judging by your screenshot (rather than by what is implied by your current code), I think you want:</p>\n\n<pre><code>Private Sub Commandok_Click()\n    Dim NewRow As Long\n\n    With Worksheets(\"Sheet3\")\n        NewRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row + 1\n        ' Write data to worksheet\n        .Cells(NewRow, \"A\").Value = Me.task_done.Value\n        .Cells(NewRow, \"B\").Value = Me.task_name.Value\n        .Cells(NewRow, \"C\").Value = DateValue(Me.task_date.Value)\n        .Cells(NewRow, \"F\").Value = Me.task_note.Value\n        .Cells(NewRow, \"G\").Value = Me.task_additional.Value\n    End With\nEnd Sub\n</code></pre>\n\n<p>It's usually a bad idea to use <code>CurrentRegion.Rows.Count</code> to work out where to write to, because that will confuse you if your <code>CurrentRegion</code> doesn't start at row 1 and, in your particular case, <code>CurrentRegion</code> looks like it extends quite a long way down the sheet so that your <code>RowCount</code> was probably a largish number.</p>\n"}], "owner": {"reputation": 455, "user_id": 1490183, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/cfd85b1c08381799df2f3b2d04384386?s=128&d=identicon&r=PG", "display_name": "Obed Lorisson", "link": "https://stackoverflow.com/users/1490183/obed-lorisson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 43644572, "answer_count": 2, "score": 0, "last_activity_date": 1493242353, "creation_date": 1493238363, "last_edit_date": 1531164843, "question_id": 43643899, "link": "https://stackoverflow.com/questions/43643899/how-to-make-my-user-form-insert-data-to-the-next-row", "title": "how to make my user form insert data to the next row", "body": "<p>my user form keep overwrite the same row  every time i enter new date in the form.i want the data to be inserted in the row(\"A6\") so forth and so on. The code i'm using to write date in the sheet.</p>\n\n<pre><code>Private Sub Commandok_Click()\nDim RowCount As Long\n\nRowCount = Worksheets(\"Sheet3\").Range(\"A1\").Offset(5).CurrentRegion.Rows.Count\n' Write data to worksheet\n    With Worksheets(\"Sheet3\").Range(\"A1\")\n     .Offset(RowCount, 0).Value = Me.task_done.Value\n     .Offset(RowCount, 1).Value = Me.task_name.Value\n     .Offset(RowCount, 2).Value = DateValue(Me.task_date.Value)\n     .Offset(RowCount, 5).Value = Me.task_note.Value\n     .Offset(RowCount, 6).Value = Me.task_additional.Value\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/g5jEj.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/g5jEj.jpg\" alt=\"Current screenshot \"></a></p>\n"}, {"tags": ["vba", "excel", "date"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1493241084, "post_id": 43643758, "comment_id": 74337578, "body": "which row(s) in column U do you want to test? Also, it&#39;s better to post <i>actual</i> code you have (even if it doesn&#39;t work) as opposed to psuedo-code. Actual code shows us the specific problem more clearly ;)"}, {"owner": {"reputation": 3, "user_id": 7786651, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99109469b75a5b5f60d622f6c4182697?s=128&d=identicon&r=PG&f=1", "display_name": "zach123", "link": "https://stackoverflow.com/users/7786651/zach123"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1493287829, "post_id": 43643758, "comment_id": 74356769, "body": "I am trying to test all the rows that don&#39;t have a current date attached to them already. So, when new data is inserted the system will see that it will need todays date and put it in column U."}], "answers": [{"comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 3, "user_id": 7786651, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99109469b75a5b5f60d622f6c4182697?s=128&d=identicon&r=PG&f=1", "display_name": "zach123", "link": "https://stackoverflow.com/users/7786651/zach123"}, "edited": false, "score": 0, "creation_date": 1493329402, "post_id": 43659866, "comment_id": 74383663, "body": "Great @zach123. Please mark as answered so others know going forward."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 0, "last_activity_date": 1493301097, "creation_date": 1493301097, "answer_id": 43659866, "question_id": 43643758, "link": "https://stackoverflow.com/questions/43643758/static-date-in-the-last-column/43659866#43659866", "title": "Static date in the last column", "body": "<p>First you want to find the range of cells that actually has data, because you don't want to check rows of column U where the entire row itself is empty. So assuming the last possible row of data can be found in column A, you can use this to set the search range.</p>\n\n<pre><code>With Worksheets(\"Sheet1\") 'qualify sheet, change name as needed\n\n    Dim lRow as Long\n    lRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n</code></pre>\n\n<p>Then, you can set the search range to be from Row 1 to <code>lRow</code>, assuming the data is in a contiguous range left-to-right, top-to-bottom starting in A1. (The On Error statements are necessary, since Excel will throw an error if blank cells do not exist in the range).</p>\n\n<pre><code>    Dim rngSearch as Range\n    On Error Resume Next\n    Set rngSearch = .Range(\"U1:U\" &amp; lRow).SpecialCells(xlCellTypeBlanks)\n    On Error GoTo 0\n</code></pre>\n\n<p>If the range is set then you can enter values into the entire range at once (which you had in your code above). </p>\n\n<pre><code>    If Not rngSearch is Nothing Then rngSearch.Value = Format(Now(), \"mm-dd-yyyy\")\n\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7786651, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99109469b75a5b5f60d622f6c4182697?s=128&d=identicon&r=PG&f=1", "display_name": "zach123", "link": "https://stackoverflow.com/users/7786651/zach123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1493301097, "creation_date": 1493237790, "last_edit_date": 1531164843, "question_id": 43643758, "link": "https://stackoverflow.com/questions/43643758/static-date-in-the-last-column", "title": "Static date in the last column", "body": "<p>I am looking to do an IF THEN statement that will help me put a date into the U Column. However, I am not sure how to go about it.</p>\n\n<pre><code>Sub()\n   Dim rng1 As Range\n   Set rng1 = Selection.SpecialCells(\"U\").xlBlanks\n   If Not rng1 Is Nothing Then rng1.Value = Format(Now(), \"mm-dd-yyyy\") \nEnd Sub\n</code></pre>\n\n<p>When I run this code I receive a run-time error '1004'. Can someone help me with this?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1493237947, "post_id": 43643623, "comment_id": 74335893, "body": "A combobox, by design, only ever allows 1 single item to be selected at any given point in time. Also &quot;Issue: This code works!&quot; makes the problem statement rather unclear. Please <a href=\"https://stackoverflow.com/posts/43643623/edit\">edit</a> to clarify."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1493238255, "post_id": 43643623, "comment_id": 74336071, "body": "@Mat&#39;sMug - the HTML select element allows for multiple selections <i>if</i> the source allows it by specifying the <code>multiple</code> attribute."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1493238440, "post_id": 43643623, "comment_id": 74336183, "body": "Once you have a reference to the select element, loop over its options and when you find one with the required value, set it as selected.  You should consider coding this function into a separate Sub e.g <code>Sub SetListByValue(objSelect, theValue)</code>  Or make it a function so you can return True if the value was found in the list."}, {"owner": {"reputation": 65, "user_id": 7595389, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e362864168cec4eb8e87cc6f54920a82?s=128&d=identicon&r=PG&f=1", "display_name": "Vinicius", "link": "https://stackoverflow.com/users/7595389/vinicius"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1493238630, "post_id": 43643623, "comment_id": 74336265, "body": "@MAt&#180;s Mug Is it more clear now?"}], "owner": {"reputation": 65, "user_id": 7595389, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e362864168cec4eb8e87cc6f54920a82?s=128&d=identicon&r=PG&f=1", "display_name": "Vinicius", "link": "https://stackoverflow.com/users/7595389/vinicius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1493238509, "creation_date": 1493237241, "last_edit_date": 1531164843, "question_id": 43643623, "link": "https://stackoverflow.com/questions/43643623/how-am-i-select-more-than-1-item-in-comobox-in-vba-select-3-itens-in-the-time", "title": "How am I select more than 1 item in comobox in VBA? (select 3 itens in the time)", "body": "<p>I am want to select more than 1 item in combobox (in example, I want to be 3 select itens).\n<strong>Issue</strong>: The code below works as I expected (the final result=select 3 itens in the combobox - multiple itens selected).However, if possible, I intend to use a code that select the item by the value and not the index. The list index in the combobox changes with some relevant frequency. </p>\n\n<p>Have anyone any solution?</p>\n\n<pre><code>Sub Vgbl()\n\nDim IE As Object\nDim n, Period1, Period2 As Double\nDim MAPFREVI, VIDASEG, CS, Alianca, Brasilv, MapfreSeg, BrasilPrev, SEGUROS, TODAS, BrasilCap As Variant\n\nSEGUROS = \"54\"\nTODAS = \"Todas\"\nPeriod1 = Sheets(\"Capa\").Cells(4, 3).Value\nPeriod2 = Sheets(\"Capa\").Cells(5, 3).Value\n\nn = Sheets(\"Ramos\").Cells(65, 4).Value\n\nSet IE = CreateObject(\"InternetExplorer.Application\")\n    IE.Navigate \"http://www2.susep.gov.br/menuestatistica/SES/principal.aspx\"\n    IE.Visible = True\n\nWhile IE.Busy\n    DoEvents\nWend\n\nApplication.Wait (Now + TimeValue(\"00:00:02\"))\n    'seleciona as opera\u00e7\u00f5es desejadas\n    IE.document.getElementById(\"ctl00_ContentPlaceHolder1_edSelOp\").Value = SEGUROS\n    IE.document.getElementById(\"ctl00_ContentPlaceHolder1_btnConsultar\").Click\n\n    'seleciona o periodo\n    Application.Wait (Now + TimeValue(\"00:00:02\"))\n    Set ieDoc = IE.document\n        ieDoc.getElementById(\"ctl00_ContentPlaceHolder1_edInicioPer\").Value = Period1\n        ieDoc.getElementById(\"ctl00_ContentPlaceHolder1_edFimPer\").Value = Period2\n\n    'seleciona as empresas\n    IE.document.getElementById(\"ctl00_ContentPlaceHolder1_edEmpresas\").SelectedIndex = TODAS\n\n    'seleciona os ramos\n\n    Set objListbox = IE.document.getElementById(\"ctl00_ContentPlaceHolder1_edRamos\")\n    objListbox.Options(n).Selected = True\n    n = Sheets(\"Ramos\").Cells(66, 4).Value\n    objListbox.Options(n).Selected = True\n    n = Sheets(\"Ramos\").Cells(67, 4).Value\n    objListbox.Options(n).Selected = True\n\nEnd sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 25, "user_id": 5559341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71e9277eacb19466c117c5ea5be82018?s=128&d=identicon&r=PG&f=1", "display_name": "Vince", "link": "https://stackoverflow.com/users/5559341/vince"}, "edited": false, "score": 0, "creation_date": 1493235835, "post_id": 43643213, "comment_id": 74334737, "body": "Please note this is only part of the code."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1493237269, "post_id": 43643213, "comment_id": 74335530, "body": "The code you&#39;re showing us will blow up with run-time error 91, since <code>ws</code> is never assigned. There&#39;s also no need whatsoever to <code>.Select</code> that <code>FileShares</code> sheet."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1493237355, "post_id": 43643213, "comment_id": 74335582, "body": "I&#39;m also quite flabbergasted by <code>Dim k&amp;</code>, given you&#39;re not using <a href=\"http://stackoverflow.com/documentation/vba/877/declaring-variables/2960/type-hints#t=20170426200910747442\">type hints</a> anywhere. Why not give it an explicit, named type like everything else?"}, {"owner": {"reputation": 25, "user_id": 5559341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71e9277eacb19466c117c5ea5be82018?s=128&d=identicon&r=PG&f=1", "display_name": "Vince", "link": "https://stackoverflow.com/users/5559341/vince"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1493238583, "post_id": 43643213, "comment_id": 74336245, "body": "@Mat&#39;sMug       I didn&#39;t post the whole code.  Just posted what was relevant. I&#39;ll keep in mind in the future not to use type hints, since they&#39;re strongly discouraged. Thanks for the suggestion."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 5559341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71e9277eacb19466c117c5ea5be82018?s=128&d=identicon&r=PG&f=1", "display_name": "Vince", "link": "https://stackoverflow.com/users/5559341/vince"}, "edited": false, "score": 0, "creation_date": 1493238415, "post_id": 43643458, "comment_id": 74336167, "body": "Thank you Tim. Your 2 seconds of thinking saved me 5 hours of further headache."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1493239584, "last_edit_date": 1493239584, "creation_date": 1493236647, "answer_id": 43643458, "question_id": 43643213, "link": "https://stackoverflow.com/questions/43643213/vba-copying-cell-value-in-variable-range/43643458#43643458", "title": "VBA: Copying cell value in variable range", "body": "<p>If <code>rngCell</code> is E42 then:</p>\n\n<pre><code>rngCell.EntireRow.Cells(1)    '&gt;&gt;A42\nrngCell.EntireColumn.Cells(2) '&gt;&gt;E2\n</code></pre>\n\n<p>or</p>\n\n<pre><code>ws.Cells(rngCell.Row, 1)      '&gt;&gt;A42\nws.Cells(2, rngCell.Column)   '&gt;&gt;E2\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 5559341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71e9277eacb19466c117c5ea5be82018?s=128&d=identicon&r=PG&f=1", "display_name": "Vince", "link": "https://stackoverflow.com/users/5559341/vince"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 439, "favorite_count": 0, "accepted_answer_id": 43643458, "answer_count": 1, "score": 0, "last_activity_date": 1493239584, "creation_date": 1493235798, "last_edit_date": 1531164843, "question_id": 43643213, "link": "https://stackoverflow.com/questions/43643213/vba-copying-cell-value-in-variable-range", "title": "VBA: Copying cell value in variable range", "body": "<p>In the following code, I'm having the hardest time identifying a specific cell in the variable range \"rngCell\". In the \"If\" statement, I would like to copy a specific cell in that column or row that the rngCell (the active cell is at) instead of the value of rngCell. I've tried using offset but have been failing. Example: If rngCell is at e42, I may need a value from e2 or a42.</p>\n\n<p>Thank you.</p>\n\n<pre><code>Dim rngCell As Range\nDim lngLstRow As Long\nDim ws As Worksheet, resultsWS As Worksheet\n\nlngLstRow = ws.UsedRange.Rows.Count\nWorksheets(\"FileShares\").Select\n\nj = 4\np = 1\nq = 4\ng = 6\n\nDim k&amp;                      \nFor k = 9 To 50\nWith ws\n    For Each rngCell In .Range(.Cells(8, k), .Cells(lngLstRow, k))\n\n        For i = LBound(maxKeywords) To UBound(maxKeywords)\n            If rngCell.Value = maxKeywords(i) And rngCell.Interior.ColorIndex = 3 Then\n                resultsWS.Cells(g, 2).Offset(j + p, 0) = rngCell.Value\n\n            g = g + 1\n\n            j = q + p - 5 'Used to start at row 8 and every row after\n            End If\n        Next i\n    Next rngCell\n\nEnd With\nNext k\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1493243152, "post_id": 43643773, "comment_id": 74338523, "body": "Your code returns Runtime Error 91 when all cells are empty within a sheet. To avoid that you can insert <code>On Error Resume Next</code> before clause starting with LastLine"}], "tags": [], "owner": {"reputation": 305, "user_id": 6317652, "user_type": "registered", "profile_image": "https://graph.facebook.com/1036004296437081/picture?type=large", "display_name": "PedroMVM", "link": "https://stackoverflow.com/users/6317652/pedromvm"}, "is_accepted": false, "score": 0, "last_activity_date": 1493244805, "last_edit_date": 1493244805, "creation_date": 1493237854, "answer_id": 43643773, "question_id": 43643208, "link": "https://stackoverflow.com/questions/43643208/vba-code-to-insert-row-below-specific-text-value/43643773#43643773", "title": "VBA Code to insert row below specific text value", "body": "<p>The following code should do what you need:</p>\n\n<pre><code>    Sub InsertLineAfterGrandTotal()\n    Dim WS          As Integer\n    Dim LastLine    As Long\n    Dim LookingArea As Range\n    Dim FoundCell   As Range\n    For WS = 1 To Application.Sheets.Count\n        Sheets(WS).Activate\n        On Error Resume Next ' To avoid error when all cells are empty\n        LastLine = Sheets(WS).Cells.Find(\"*\", LookIn:=xlFormulas, _\n            SearchOrder:=xlByColumns, SearchDirection:=xlPrevious).Row\n        Set LookingArea = Sheets(WS).Range(Cells(1, 1), Cells(LastLine, 1))\n        Set FoundCell = LookingArea.Find(\"Grand Total\", LookIn:=xlFormulas, _\n            LookAt:=xlWhole, SearchOrder:=xlByColumns)\n        If FoundCell Is Nothing Then\n            MsgBox \"Grand Total not found in sheet \" &amp; Sheets(WS).Name &amp; _\n                \". Press Ok to continue\", vbExclamation + vbOKOnly, \"Not found\"\n        Else\n            FoundCell.Offset(1, 0).EntireRow.Insert\n        End If\n    Next WS\nEnd Sub\n</code></pre>\n\n<p>Explaining:</p>\n\n<p>1) The <code>For</code> looping make it goes throughout all worksheets in your workbook.</p>\n\n<p>2) <code>LastLine</code>, as the name says, gets the last line of active worksheet.</p>\n\n<p>3) <code>LookingArea</code> is the range where the string <code>Grand Total</code> will be searched for.</p>\n\n<p>4) <code>FoundCell</code> will point to the cell where <code>Grand Total</code> is found. If it is not found, a message box will appear, if it is found a new line is inserted above it.</p>\n"}], "owner": {"reputation": 1, "user_id": 7927595, "user_type": "registered", "profile_image": "https://graph.facebook.com/10100346778495175/picture?type=large", "display_name": "Miriam Hawkins", "link": "https://stackoverflow.com/users/7927595/miriam-hawkins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 928, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1493244805, "creation_date": 1493235791, "last_edit_date": 1531164843, "question_id": 43643208, "link": "https://stackoverflow.com/questions/43643208/vba-code-to-insert-row-below-specific-text-value", "title": "VBA Code to insert row below specific text value", "body": "<p>I need insert a row below the text value of \"Grand Total\". I need the code to loop through all active worksheets. It only needs to look through column A. I am new to VBA so the easier the code the better. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1493235877, "post_id": 43643043, "comment_id": 74334760, "body": "I don&#39;t understand your last sentence. This quite obviously is in a workbook, as your code references <code>ReportWbk</code>."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1493236134, "post_id": 43643043, "comment_id": 74334907, "body": "Is the data in your &quot;Date&quot; column stored as dates (formatted in a <code>&quot;mmm-yy&quot;</code> format) or is it just text?"}, {"owner": {"reputation": 174, "user_id": 7799504, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/79bee3a579490c7ad1d2b8c432b6dcc7?s=128&d=identicon&r=PG&f=1", "display_name": "Thelnternet", "link": "https://stackoverflow.com/users/7799504/thelnternet"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1493236243, "post_id": 43643043, "comment_id": 74334951, "body": "@YowE3K &quot;mmm-yy&quot;"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1493236369, "post_id": 43643043, "comment_id": 74335029, "body": "Are they always a particular day of the month (e.g. 1st of the month? last day of the month?) or are they various dates throughout the month (i.e. the <code>SUMIFS</code> needs to select any dates &gt;= 1st of the month and &lt;= last day of the month)?"}, {"owner": {"reputation": 174, "user_id": 7799504, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/79bee3a579490c7ad1d2b8c432b6dcc7?s=128&d=identicon&r=PG&f=1", "display_name": "Thelnternet", "link": "https://stackoverflow.com/users/7799504/thelnternet"}, "edited": false, "score": 0, "creation_date": 1493236447, "post_id": 43643043, "comment_id": 74335076, "body": "Verious dates throughout the month"}], "answers": [{"comments": [{"owner": {"reputation": 174, "user_id": 7799504, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/79bee3a579490c7ad1d2b8c432b6dcc7?s=128&d=identicon&r=PG&f=1", "display_name": "Thelnternet", "link": "https://stackoverflow.com/users/7799504/thelnternet"}, "edited": false, "score": 0, "creation_date": 1493238686, "post_id": 43643687, "comment_id": 74336294, "body": "Ah! <code>Application.WorksheetFunction</code> Everywhere I had looked was just saying <code>.SumIfs(...</code> Thanks a ton!"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 174, "user_id": 7799504, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/79bee3a579490c7ad1d2b8c432b6dcc7?s=128&d=identicon&r=PG&f=1", "display_name": "Thelnternet", "link": "https://stackoverflow.com/users/7799504/thelnternet"}, "edited": false, "score": 1, "creation_date": 1493238734, "post_id": 43643687, "comment_id": 74336316, "body": "@Thelnternet <code>Application.SumIfs(...</code> would also work.  (As would <code>With Application.WorksheetFunction</code> // <code>.SumIfs(...</code> // <code>End With</code>, and <code>With Application</code> // <code>.SumIfs(...</code> // <code>End With</code>)"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 2, "last_activity_date": 1493237496, "creation_date": 1493237496, "answer_id": 43643687, "question_id": 43643043, "link": "https://stackoverflow.com/questions/43643043/trying-to-complete-sumifs-script/43643687#43643687", "title": "Trying to complete sumifs(?) script", "body": "<p>Assuming your \"Team\" is in column A, \"Date\" is in column B, \"Cost\" is in column C, and that your variables <code>cboMonth</code> and <code>cboYear</code> are of type <code>String</code>, you should be able to do:</p>\n\n<pre><code>'Convert input to a date\nDim myDate As Date\nmyDate = DateValue(\"1 \" &amp; cboMonth &amp; \" \" &amp; cboYear)\n'Perform the required SUMIFS\ntxt101 = Application.WorksheetFunction.SumIfs(Range(\"C:C\"), _\n                                              Range(\"A:A\"), \"101\", _\n                                              Range(\"B:B\"), \"&gt;=\" &amp; myDate, _\n                                              Range(\"B:B\"), \"&lt;=\" &amp; DateAdd(\"m\", 1, myDate))\n'txt102 = \n'txt103 = \n'txt104 =\n'txt105 =\n</code></pre>\n\n<p>I'm not clear as to how your data is structured, but that shouldn't be too hard to integrate into your code.</p>\n"}], "owner": {"reputation": 174, "user_id": 7799504, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/79bee3a579490c7ad1d2b8c432b6dcc7?s=128&d=identicon&r=PG&f=1", "display_name": "Thelnternet", "link": "https://stackoverflow.com/users/7799504/thelnternet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 43643687, "answer_count": 1, "score": 2, "last_activity_date": 1580631977, "creation_date": 1493235264, "last_edit_date": 1580631977, "question_id": 43643043, "link": "https://stackoverflow.com/questions/43643043/trying-to-complete-sumifs-script", "title": "Trying to complete sumifs(?) script", "body": "<p>Trying to complete a script that will add together values in C if the date is of the selected month and is in the proper team.\nExample:</p>\n\n<pre><code>|  Team|  Date|  Cost|\n|   102|Mar-17| 13245|\n|   103|Jan-17|  2050|\n|   101|Feb-17|  1245|\n|   104|Jan-17| 12400|\n|   102|Mar-17|  5242|\n|   104|Jan-17|   600|\n|   102|Feb-17| 10240|\n|   102|Jan-17|   450|\n|   102|Mar-17| 12245|\n|   101|Jan-17|  2300|\n</code></pre>\n\n<p>The objective would be for the script to determine if I am looking for january:</p>\n\n<ul>\n<li>101 = 2300</li>\n<li>102 = 450</li>\n<li>103 = 2050 </li>\n<li>104 = 13000</li>\n</ul>\n\n<p>I have been trying to figure this out and feel stuck. In the formula provided, cboMonth is determined from a userform and its combobox as a three letter month. cboYear is determined in a similar manner with 4-digits. The initial plan was to use a loop, but I dont know how to put together a summing function into the mix. This is what I have so far.</p>\n\n<pre><code>Dim rng As Range\nDim lastrow As Long\nDim x As Integer\nDim txt101 As Long\nDim txt102 As Long\nDim txt103 As Long\nDim txt104 As Long\nDim txt105 As Long\n\nlastrow = Cells(Rows.Count, \"A\").End(xlUp).Row\n\n\nReportWbk.Sheets(cboYear).Activate\nApplication.ScreenUpdating = False\nFor Each x In Range(\"D\" &amp; lastrow)\n    If x.Value = \"FG-25\" And x.Offset(, 1).Format(Month(mmm)) = cboMonth Then\n        txt101 =\n        txt102 =\n        txt103 =\n        txt104 =\n        txt105 =\n    End If\nNext x\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "edited": false, "score": 0, "creation_date": 1493235301, "post_id": 43642947, "comment_id": 74334415, "body": "For security reason we prefer not to download data fro an external link. Would you provide a sample of your data as a picture or formatted table."}, {"owner": {"reputation": 33, "user_id": 7866338, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a85723cb68d69d27391309aaf31731be?s=128&d=identicon&r=PG&f=1", "display_name": "Ttrx", "link": "https://stackoverflow.com/users/7866338/ttrx"}, "reply_to_user": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "edited": false, "score": 0, "creation_date": 1493235742, "post_id": 43642947, "comment_id": 74334680, "body": "<a href=\"https://postimg.org/image/f5tqjwied/\" rel=\"nofollow noreferrer\">postimg.org/image/f5tqjwied</a> &lt;- image, but this file which I create on google sheet is just clean data, also added to main question"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 7866338, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a85723cb68d69d27391309aaf31731be?s=128&d=identicon&r=PG&f=1", "display_name": "Ttrx", "link": "https://stackoverflow.com/users/7866338/ttrx"}, "edited": false, "score": 0, "creation_date": 1493237286, "post_id": 43643309, "comment_id": 74335542, "body": "Unfortunately nothing change"}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "reply_to_user": {"reputation": 33, "user_id": 7866338, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a85723cb68d69d27391309aaf31731be?s=128&d=identicon&r=PG&f=1", "display_name": "Ttrx", "link": "https://stackoverflow.com/users/7866338/ttrx"}, "edited": false, "score": 0, "creation_date": 1493237355, "post_id": 43643309, "comment_id": 74335581, "body": "What is your output?"}, {"owner": {"reputation": 33, "user_id": 7866338, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a85723cb68d69d27391309aaf31731be?s=128&d=identicon&r=PG&f=1", "display_name": "Ttrx", "link": "https://stackoverflow.com/users/7866338/ttrx"}, "edited": false, "score": 0, "creation_date": 1493237600, "post_id": 43643309, "comment_id": 74335720, "body": "1483 rows in file but one file have equal value in column B for 2 files but they should be union in one file"}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "reply_to_user": {"reputation": 33, "user_id": 7866338, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a85723cb68d69d27391309aaf31731be?s=128&d=identicon&r=PG&f=1", "display_name": "Ttrx", "link": "https://stackoverflow.com/users/7866338/ttrx"}, "edited": false, "score": 0, "creation_date": 1493239799, "post_id": 43643309, "comment_id": 74336882, "body": "Well if you want to have Rows (2 - 1483) in first file, and Rows (1484 - end)  in second file, the changes above should do that. If they don&#39;t work for you follow these steps. Save your document as a macro free document (Save as Type : Excel Workbook). Close all workbooks. Open your recently saved workbook and copy paste your code in a new module (with the changes I suggested). This should work."}, {"owner": {"reputation": 33, "user_id": 7866338, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a85723cb68d69d27391309aaf31731be?s=128&d=identicon&r=PG&f=1", "display_name": "Ttrx", "link": "https://stackoverflow.com/users/7866338/ttrx"}, "edited": false, "score": 0, "creation_date": 1493244677, "post_id": 43643309, "comment_id": 74339160, "body": "but this isn&#39;t a problem. I believe that is misunderstood. My script works fine if we r talking about split in 1500 row but this file should be split in row 1483 because of loop Do While Cells(j, &quot;b&quot;) = Cells(j - 1, &quot;b&quot;) And _       j &lt; limit And j &lt; last, that mens if i have same equal in following and previous rows then i have to cut in line where they are different, in our example in line 1483"}], "tags": [], "owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "is_accepted": false, "score": 0, "last_activity_date": 1493236134, "creation_date": 1493236134, "answer_id": 43643309, "question_id": 43642947, "link": "https://stackoverflow.com/questions/43642947/vba-excel-split-file-every-x-rows-with-if-statement-equal-value-have-to-be-in-th/43643309#43643309", "title": "VBA/EXCEL Split file every x rows with if statement equal value have to be in the same file", "body": "<p>Try changing these values:</p>\n\n<pre><code>Dim blkSize As Integer:  blkSize = 1483 - hdrSize\nDim maxLimit As Integer: maxLimit = 0\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 7866338, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a85723cb68d69d27391309aaf31731be?s=128&d=identicon&r=PG&f=1", "display_name": "Ttrx", "link": "https://stackoverflow.com/users/7866338/ttrx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 116, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1493236134, "creation_date": 1493234869, "last_edit_date": 1493235813, "question_id": 43642947, "link": "https://stackoverflow.com/questions/43642947/vba-excel-split-file-every-x-rows-with-if-statement-equal-value-have-to-be-in-th", "title": "VBA/EXCEL Split file every x rows with if statement equal value have to be in the same file", "body": "<p>I'm trying split one excel file for several which every will have max. 1500 rows and in row B I have numbers which can be equal but we have to split file if 1501 row have same value as 1500 and cut on the first value.\nHere you can see example of file which i want to split: <a href=\"https://docs.google.com/spreadsheets/d/19SGHZSBrNbteMbCeZYqsq9g9ddsnwFKrdSsHA51olQg/edit#gid=0\" rel=\"nofollow noreferrer\">https://docs.google.com/spreadsheets/d/19SGHZSBrNbteMbCeZYqsq9g9ddsnwFKrdSsHA51olQg/edit#gid=0</a> \nIMAGE: <a href=\"https://postimg.org/image/f5tqjwied/\" rel=\"nofollow noreferrer\">https://postimg.org/image/f5tqjwied/</a><a href=\"https://i.stack.imgur.com/gqo2m.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gqo2m.png\" alt=\"sample data\"></a></p>\n\n<p>Here we should have 2 files first to 1483 row and second from 1484 to end. Of course with header.</p>\n\n<p>Code:</p>\n\n<pre><code>    Option Explicit\n\n\nSub SplitRowsToFiles()\n\n  Dim hdrSize As Integer: hdrSize = 1\n  Dim blkSize As Integer:  blkSize = 1000 - hdrSize\n  Dim maxLimit As Integer: maxLimit = 500\n\n  Dim wb As Workbook\n  Dim wrkSht As Worksheet\n  Dim saveFile As String, name As String\n  Dim WR As Range, header As Range\n\n  Set wrkSht = ActiveSheet\n  Set header = wrkSht.Rows(\"1:\" &amp; hdrSize)\n\n  saveFile = Application.GetSaveAsFilename\n\n  Dim last As Integer\n  With wrkSht.UsedRange\n    last = .Rows.Count\n  End With\n\n  Dim i As Integer, j As Integer\n  Dim limit As Integer, part As Integer\n  part = 0\n  i = hdrSize + 1 ' skip the header\n\n  Do While True\n\n    j = i + blkSize - 1\n    If j &lt;= last Then\n      ' process from blkSize to blkSize+maxLimit rows\n      limit = j + maxLimit\n      Do While Cells(j, \"b\") = Cells(j - 1, \"b\") And _\n      j &lt; limit And j &lt; last\n        j = j + 1\n      Loop\n    Else\n      ' otherwise process up to the last row\n      j = last\n    End If\n\n    Application.ScreenUpdating = True\n    Application.DisplayAlerts = False\n\n     Set wb = Application.Workbooks.Add\n     Set WR = wrkSht.Rows(i &amp; \":\" &amp; j)\n\n     header.Copy wb.Worksheets(1).Rows(\"1:\" &amp; hdrSize)\n     WR.Copy wb.Worksheets(1).Rows(hdrSize + 1)\n\n     part = part + 1\n     name = saveFile &amp; part &amp; \".xls\"\n     wb.SaveAs Filename:=name, FileFormat:=xlExcel8, CreateBackup:=False\n     wb.Close\n\n    Application.DisplayAlerts = True\n    Application.ScreenUpdating = False\n\n    i = j + 1\n    If i &gt; last Then Exit Do\n\n  Loop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "listbox", "selectedindexchanged"], "comments": [{"owner": {"reputation": 11, "user_id": 7794654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc25c2f13659477419974692998298cf?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Wojcik", "link": "https://stackoverflow.com/users/7794654/mike-wojcik"}, "edited": false, "score": 0, "creation_date": 1493240445, "post_id": 43642870, "comment_id": 74337240, "body": "Never mind - I just used the change event and it works just fine"}], "answers": [{"tags": [], "owner": {"reputation": 122, "user_id": 7898651, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73fffefe567111d182394fc89b829ac6?s=128&d=identicon&r=PG&f=1", "display_name": "shakespeare", "link": "https://stackoverflow.com/users/7898651/shakespeare"}, "is_accepted": false, "score": 1, "last_activity_date": 1493282427, "creation_date": 1493282427, "answer_id": 43652789, "question_id": 43642870, "link": "https://stackoverflow.com/questions/43642870/excel-vba-listbox-use-of-selectedindexchanged-event/43652789#43652789", "title": "Excel VBA Listbox use of SelectedIndexChanged event", "body": "<pre><code>Private Sub ListBox1_Change()\n  // Your can do anything with it\n\n  // Looping here\n     For i = 0 To ListBox1.ListCount - 1\n       If ListBox1.Selected(i) Then\n        ListBox1.Selected(i) = False\n       End If\n     Next\n  End Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7794654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc25c2f13659477419974692998298cf?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Wojcik", "link": "https://stackoverflow.com/users/7794654/mike-wojcik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7336, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1493282427, "creation_date": 1493234653, "question_id": 43642870, "link": "https://stackoverflow.com/questions/43642870/excel-vba-listbox-use-of-selectedindexchanged-event", "title": "Excel VBA Listbox use of SelectedIndexChanged event", "body": "<p>I am trying to utilize the Excel VBA Listbox SelectedIndexChanged event to update a textbox on the same userform with the sum of the values in one column of my listbox as the user selects each row in that listbox.</p>\n\n<p>I can not figure out how to get the code for that event handler to execute.  Any suggestions?  I am using Excel VBA with the latest version of excel from office 365 on a windows 10 machine. In fact i don't even see that event listed in the pulldown when i have the code window up for that userform?</p>\n\n<p>Thanks\nMike</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 417, "user_id": 4897271, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AMOHJ.jpg?s=128&g=1", "display_name": "jjjjjjjjjjj", "link": "https://stackoverflow.com/users/4897271/jjjjjjjjjjj"}, "edited": false, "score": 0, "creation_date": 1493236875, "post_id": 43642823, "comment_id": 74335321, "body": "What stops you from creating another for loop for the columns?"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1493237981, "post_id": 43642823, "comment_id": 74335913, "body": "It&#39;s a little unclear exactly what you&#39;re trying to do.  Can you provide some sample data and expected results?"}], "answers": [{"tags": [], "owner": {"reputation": 122, "user_id": 7898651, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73fffefe567111d182394fc89b829ac6?s=128&d=identicon&r=PG&f=1", "display_name": "shakespeare", "link": "https://stackoverflow.com/users/7898651/shakespeare"}, "is_accepted": true, "score": 0, "last_activity_date": 1493282863, "creation_date": 1493282863, "answer_id": 43652940, "question_id": 43642823, "link": "https://stackoverflow.com/questions/43642823/combine-five-do-until-loops-into-one-loop-excel-vba/43652940#43652940", "title": "Combine five Do Until Loops into one loop Excel VBA", "body": "<p>You can use <code>private sub</code> to fire the <code>function</code> everytime </p>\n\n<pre><code>Private Sub autofill() {\n  // Your loop\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4573633, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98a3f8f20669f23fb238b49735b75ee0?s=128&d=identicon&r=PG&f=1", "display_name": "Tokioi", "link": "https://stackoverflow.com/users/4573633/tokioi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "accepted_answer_id": 43652940, "answer_count": 1, "score": 0, "last_activity_date": 1493282863, "creation_date": 1493234493, "question_id": 43642823, "link": "https://stackoverflow.com/questions/43642823/combine-five-do-until-loops-into-one-loop-excel-vba", "title": "Combine five Do Until Loops into one loop Excel VBA", "body": "<p>I am working on some excel VBA code that adds a line to an invoice document for every line of user input and copies each line of user input to that document. I have created 5 identical Do Until loops (I only use one as an example, but they are all the same aside from which column they use). </p>\n\n<p>How can I combine the five loops into one loop that will:</p>\n\n<ol>\n<li>Go through a column and create a line on another sheet for each user inputted item</li>\n<li>Copy that text to the newly generated row </li>\n<li>Once the loop reaches a blank cell in a column, it moves to the next column</li>\n</ol>\n\n<p>Any recommendations on proper code format are also welcome as I am mostly self-taught in VBA. </p>\n\n<p>Below is my code: </p>\n\n<pre><code>Dim Invoice As Worksheet\nSet Invoice = Sheets(\"Generated Invoice\")\nCase1Start = 1\nCheckRow = 20\nBottomRow = 32\n\nDo Until InputForm.Cells(CheckRow, Case1Start) = \"\"\nWorksheets(\"Generated Invoice\").Rows(BottomRow).EntireRow.Select\nSelection.Copy\nSelection.Insert Shift:=xlDown\n\nInvoice.Cells(BottomRow - 1, 2).Value = InputForm.Cells(CheckRow, Case1Start)\nBottomRow = BottomRow + 1\nCheckRow = CheckRow + 1\nLoop\n</code></pre>\n"}, {"tags": ["vba", "excel"], "owner": {"reputation": 212, "user_id": 7916754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Kj9hS.png?s=128&g=1", "display_name": "William C.", "link": "https://stackoverflow.com/users/7916754/william-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 481, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1493233803, "creation_date": 1493233803, "last_edit_date": 1531164843, "question_id": 43642637, "link": "https://stackoverflow.com/questions/43642637/vba-sort-based-on-two-column-values", "title": "VBA Sort Based on Two Column values", "body": "<p>First let me say I have scoured the internet and this site for solutions and have come to no avail. In following the rules of the site, I have tried to develop code to fix my problem and can provide examples to the community for suggestions or help.</p>\n\n<p>Goal: \nI am looking to use two lists of values (each in their own column, columns I &amp; J for example) as an autofilter categories. I want the VBA script to select the first value in Column I and filter my table, then take the first value in column J and filter the table again. Then, the code would execute a command, reset, and restart the filter process over. This time, I want the script to select the first value in Column I again and filter the table, then select the second value in column J and filter. This whole process should repeat until all values in column J have been executed, where the filter should reset, select the second value in column I, then restart on the first value of column J.</p>\n\n<p>I am able to filter my table by values in Column I using this code:</p>\n\n<p><code>Set Rng = ws3.Range(\"i2:i\" &amp; ws3.Cells(Rows.Count, \"i\").End(xlUp).Row)\nRng.Sort Key1:=ws3.Range(\"I1\"), Order1:=xlAscending</code></p>\n\n<p>I am not however able to adapt the code to consider my second list of filter values in Column J following this logic in the proper sort order</p>\n\n<p><code>Set Rng = ws3.Range(\"j2:j\" &amp; ws3.Cells(Rows.Count, \"i\").End(xlUp).Row)\nRng.Sort Key1:=ws3.Range(\"j1\"), Order1:=xlAscending</code></p>\n\n<p>Is there a way to link the steps together following my goal above?</p>\n\n<p>Here is my complete script:</p>\n\n<p>Option Explicit</p>\n\n<pre><code>Sub Loop2()\nDim cell As Range 'loop range\nDim Rng As Range 'range for unique values\n\nDim ws1 As Worksheet\nDim ws2 As Worksheet\nDim ws3 As Worksheet\n\nDim lRow As Long 'last row in Inspection sheet\nDim i As Integer 'counter\n\nSet ws1 = Worksheets(\"Data\")\nSet ws2 = Worksheets(\"Inspection\")\nSet ws3 = Worksheets(\"NamedRange\")\n\nApplication.ScreenUpdating = False\n\n'reset autofilter\nws1.ListObjects(\"Table3\").Range.AutoFilter\n\n'autofilter on Inspection selected\nws1.ListObjects(\"Table3\").Range.AutoFilter Field:=1, Criteria1:=ws2.Range(\"C3\")\n\n'copy Column B in Table3 to NamedRange!I1\nws1.Range(\"B6:B20\").SpecialCells(xlVisible).Copy 'extend range when needed\nws3.Range(\"I1\").PasteSpecial\n\n'Remove duplicates for unique values\nws3.Columns(\"I:I\").RemoveDuplicates Columns:=1, Header:=xlYes\n\n'set range for loop and sort\nSet Rng = ws3.Range(\"i2:i\" &amp; ws3.Cells(Rows.Count, \"i\").End(xlUp).Row)\nRng.Sort Key1:=ws3.Range(\"I1\"), Order1:=xlAscending\n\nlRow = 6 'set current last row for start of ws3 summary sheet\n\n'loop to copy row 3 from ws1 to ws2\n\nFor Each cell In Rng\n\n    'increment last row\n    i = i + 1\n\n    With ws1\n        .ListObjects(\"Table3\").Range.AutoFilter Field:=2, Criteria1:=cell.Value\n        .Range(\"B3:E3\").Copy\n        ws2.Range(\"B\" &amp; lRow + i).PasteSpecial xlPasteValues\n    End With\n\nNext\n\n'goto ws2.Range\nApplication.Goto ws2.Range(\"B6\")\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "loops"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1493234028, "post_id": 43642508, "comment_id": 74333701, "body": "Try <code>... Then Cells(R, C).FormulaR1C1 = &quot;=R[-1]C&quot;</code>."}, {"owner": {"reputation": 41, "user_id": 7550322, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154970086478704/picture?type=large", "display_name": "Benjamin Wann", "link": "https://stackoverflow.com/users/7550322/benjamin-wann"}, "edited": false, "score": 0, "creation_date": 1493234130, "post_id": 43642508, "comment_id": 74333754, "body": "@Jeeped, thanks, I just lucked into the same part myself, but changed the question a little bit."}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 2, "creation_date": 1493234264, "post_id": 43642508, "comment_id": 74333829, "body": "try switching <code>Next C</code> and <code>Next R</code>, and you don&#39;t need to declare <code>R = 18</code> <code>C = 1</code>"}, {"owner": {"reputation": 41, "user_id": 7550322, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154970086478704/picture?type=large", "display_name": "Benjamin Wann", "link": "https://stackoverflow.com/users/7550322/benjamin-wann"}, "edited": false, "score": 0, "creation_date": 1493234340, "post_id": 43642508, "comment_id": 74333867, "body": "Perfect! Works how I wanted it to."}], "owner": {"reputation": 41, "user_id": 7550322, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154970086478704/picture?type=large", "display_name": "Benjamin Wann", "link": "https://stackoverflow.com/users/7550322/benjamin-wann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 12, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1493234239, "creation_date": 1493233336, "last_edit_date": 1493234239, "question_id": 43642508, "link": "https://stackoverflow.com/questions/43642508/loop-to-identify-and-fill-blanks-in-with-r-1c-formula", "title": "Loop to identify and fill blanks in with R-1C formula", "body": "<p>I am trying to run a loop over two rows and 19 columns to pull down the first value of blank cells. Any suggestions? I keep getting a compile error:</p>\n\n<blockquote>\n  <p>invalid Next contrl variable reference.</p>\n</blockquote>\n\n<pre><code>Sub Loop1()\n\n    Dim R As Integer\n    Dim C As Integer\n\n    R = 18\n    C = 1\n\n    For R = 18 To 20\n    For C = 1 To 19\n        If Cells(R, C) = \"\" Then Cells(R, C).Value = \"=R[-1]C\"\n\n    Next R\n    Next C\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1493234559, "post_id": 43642472, "comment_id": 74333998, "body": "This question is begging for sample data with expected results. See <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> for strictures."}, {"owner": {"reputation": 17, "user_id": 7692670, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-N43UD_NFSAY/AAAAAAAAAAI/AAAAAAAAAKw/1wUa0Pkqp8k/photo.jpg?sz=128", "display_name": "joshinaround18", "link": "https://stackoverflow.com/users/7692670/joshinaround18"}, "edited": false, "score": 0, "creation_date": 1493237239, "post_id": 43642472, "comment_id": 74335516, "body": "I put some images in that should hopefully help. I eliminated/hide the data that you do not need. ALL 3 images are separate reports. 1st image is the report template I am working on. 2nd image is a huge data file that contains the identifying number and all items. 3rd image is what there is a shortage of and needs to be identified. Hope that helps"}], "owner": {"reputation": 17, "user_id": 7692670, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-N43UD_NFSAY/AAAAAAAAAAI/AAAAAAAAAKw/1wUa0Pkqp8k/photo.jpg?sz=128", "display_name": "joshinaround18", "link": "https://stackoverflow.com/users/7692670/joshinaround18"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1493237565, "creation_date": 1493233205, "last_edit_date": 1493237565, "question_id": 43642472, "link": "https://stackoverflow.com/questions/43642472/concatenate-matching-on-large-data-set", "title": "Concatenate matching on large data set", "body": "<p>So I have been working on getting a script set up to do 2 things. First is to look for an identifying number and then searching for ALL matches and listing them in a concatenate. After figuring that part out, I built on top of it to create a UDF to then take those matches and list anything that matches. The UDF is below what I have.  There's 2 issues however, which I hope you might be able to help with. </p>\n\n<p>The first being, it looks at ALL matches and returns a blank or a \",\" if I specify it. I want to just make it so it doesn't give anything unless a match is found. </p>\n\n<p>Second, the file runs extremely slow. It's looking over 3 different spreadsheets, 2 of which are big files containing millions of cells worth of data. Do you know if there's a way to clean this file up to run more efficiently? It currently takes about 40-45 minutes to run (and that's just for finding 1 item, not the other 1000 I need to look up).  </p>\n\n<pre><code>    Function DoubleLookUpConcat(ByVal SearchString As String, _\n                      SearchRange As Range, _\n                      ReturnRange As Range, _\n                      SearchRange2 As Range, _\n                      ReturnRange2 As Range, _\n                      Optional Delimiter As String = \" \", _\n                      Optional MatchWhole As Boolean = True, _\n                      Optional UniqueOnly As Boolean = False, _\n                      Optional MatchCase As Boolean = False)\n\n  Dim X As Long, CellVal As String, ReturnVal As String, Result As String\n\n  If (SearchRange.Rows.Count &gt; 1 And SearchRange.Columns.Count &gt; 1) Or _\n     (ReturnRange.Rows.Count &gt; 1 And ReturnRange.Columns.Count &gt; 1) Then\n    DoubleLookUpConcat = CVErr(xlErrRef)\n  Else\n    If Not MatchCase Then SearchString = UCase(SearchString)\n    For X = 1 To SearchRange.Count\n      If MatchCase Then\n        CellVal = SearchRange(X).Value\n      Else\n        CellVal = UCase(SearchRange(X).Value)\n      End If\n      ReturnVal = ReturnRange(X).Value\n      ReturnVal2 = LookUpConcat(ReturnVal, SearchRange2, ReturnRange2, Delimiter, MatchWhole, UniqueOnly, MatchCase)\n\n      If MatchWhole And CellVal = SearchString Then\n        If UniqueOnly And InStr(Result &amp; Delimiter, Delimiter &amp; _\n                ReturnVal &amp; Delimiter) &gt; 0 Then GoTo Continue\n        Result = Result &amp; Delimiter &amp; ReturnVal2\n      ElseIf Not MatchWhole And CellVal Like \"*\" &amp; SearchString &amp; \"*\" Then\n        If UniqueOnly And InStr(Result &amp; Delimiter, Delimiter &amp; _\n                ReturnVal &amp; Delimiter) &gt; 0 Then GoTo Continue\n        Result = Result &amp; Delimiter &amp; ReturnVal2\n      End If\nContinue:\n    Next\n\n    DoubleLookUpConcat = Mid(Result, Len(Delimiter) + 1)\n  End If\n\nEnd Function\n\n------------------------\n\nFunction LookUpConcat(ByVal SearchString As String, _\n                      SearchRange As Range, _\n                      ReturnRange As Range, _\n                      Optional Delimiter As String = \" \", _\n                      Optional MatchWhole As Boolean = True, _\n                      Optional UniqueOnly As Boolean = False, _\n                      Optional MatchCase As Boolean = False)\n\n  Dim X As Long, CellVal As String, ReturnVal As String, Result As String\n\n  If (SearchRange.Rows.Count &gt; 1 And SearchRange.Columns.Count &gt; 1) Or _\n     (ReturnRange.Rows.Count &gt; 1 And ReturnRange.Columns.Count &gt; 1) Then\n    LookUpConcat = CVErr(xlErrRef)\n  Else\n    If Not MatchCase Then SearchString = UCase(SearchString)\n    For X = 1 To SearchRange.Count\n      If MatchCase Then\n        CellVal = SearchRange(X).Value\n      Else\n        CellVal = UCase(SearchRange(X).Value)\n      End If\n      ReturnVal = ReturnRange(X).Value\n      If MatchWhole And CellVal = SearchString Then\n        If UniqueOnly And InStr(Result &amp; Delimiter, Delimiter &amp; _\n                ReturnVal &amp; Delimiter) &gt; 0 Then GoTo Continue\n        Result = Result &amp; Delimiter &amp; ReturnVal\n      ElseIf Not MatchWhole And CellVal Like \"*\" &amp; SearchString &amp; \"*\" Then\n        If UniqueOnly And InStr(Result &amp; Delimiter, Delimiter &amp; _\n                ReturnVal &amp; Delimiter) &gt; 0 Then GoTo Continue\n        Result = Result &amp; Delimiter &amp; ReturnVal\n      End If\nContinue:\n    Next\n\n    LookUpConcat = Mid(Result, Len(Delimiter) + 1)\n  End If\n\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/bNP04.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bNP04.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/4NL2g.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4NL2g.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/hBPWW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hBPWW.png\" alt=\"enter image description here\"></a></p>\n\n<p>The first image is the template I am working on Column B is the identifying number I need to reference to find the 1st set of matches. Column AC is ALL matches concatenated. Column AB is what I need to see (only the one's found on 2nd search). </p>\n\n<p>The 2nd image is the report I use to find the identifying number in column B on the 1st image.  It corresponds to column K. It will find matches on column U to correspond with column B on 1st image. </p>\n\n<p>3rd image is the last report I need to find if there is a match from column U with column A. If ANY matches in the original lookup is found, it will list it. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1, "user_id": 6339520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c47e5396d824da7fbba4b0ad136a4c0b?s=128&d=identicon&r=PG&f=1", "display_name": "Harvin weber", "link": "https://stackoverflow.com/users/6339520/harvin-weber"}, "reply_to_user": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "edited": false, "score": 0, "creation_date": 1493237211, "post_id": 43642172, "comment_id": 74335496, "body": "This question is quite different to what you have suggested"}], "answers": [{"tags": [], "owner": {"reputation": 331, "user_id": 7834321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/147fb04269e2225ecafbcf20dfbbd76d?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Nevins", "link": "https://stackoverflow.com/users/7834321/tim-nevins"}, "is_accepted": false, "score": 0, "last_activity_date": 1493238933, "creation_date": 1493238933, "answer_id": 43644072, "question_id": 43642172, "link": "https://stackoverflow.com/questions/43642172/macro-to-copy-range-based-on-date-and-multiple-criteria-to-another-file/43644072#43644072", "title": "Macro to copy range based on date and multiple criteria to another file", "body": "<p>You can do this with Advanced Filter. In fact, this is a perfect use for it. On the Data ribbon/tab, click Advanced in the Sort &amp; Filter area. Select the data source, the criteria where you want the results (click \"Copy to another location\").</p>\n\n<p>The criteria and your copy location must have the same column headings as on your data table, i.e. if your data table tops the date field with \"MyDate\", the criteria must have the exact same heading (watch for spaces!).</p>\n\n<p>Google Excel Advanced Filter. There are a couple of pages with all the information you could ever want on Advanced filter. Far too much information to recount here.</p>\n"}], "owner": {"reputation": 1, "user_id": 6339520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c47e5396d824da7fbba4b0ad136a4c0b?s=128&d=identicon&r=PG&f=1", "display_name": "Harvin weber", "link": "https://stackoverflow.com/users/6339520/harvin-weber"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 422, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1493238933, "creation_date": 1493232156, "last_edit_date": 1493235420, "question_id": 43642172, "link": "https://stackoverflow.com/questions/43642172/macro-to-copy-range-based-on-date-and-multiple-criteria-to-another-file", "title": "Macro to copy range based on date and multiple criteria to another file", "body": "<p>I am not much aware of VBA coding, i am having to do some manual effort, would really appreciate if you could help with this, I tried searching through but could not find any suitable answers.\nI would like to copy rows based on couple of conditions. </p>\n\n<p>My data is in \u2018Workbook A\u2019 in sheet1, Col A to Col X, Col C has dates and Col W has the list of employee names.\nIn \u2018Workbook B\u2019, i have the criteria  in sheet 1 , cell A1 contains a date (which i would input) and there are around 20 employee names in Col B from B1 to B20 \nWhat i am looking at is The rows from A to X in \u2018Workbook A\u2019 should be copied based on criteria in \u2018Workbook B\u2019 which is date present in cell A1 and IF Col W (in workbook A)contains any of the employee names in B1 to B20 to Workbook B,Sheet 2 (the code/macro  would be in Workbook B)\nrows are being copied from one workbook to another\nThank you in advance</p>\n"}, {"tags": ["excel", "vba", "outlook", "excel-2010", "outlook-2010"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 2, "creation_date": 1493232308, "post_id": 43641700, "comment_id": 74332666, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/25922611/count-followup-emails-using-excel-vba\">Count Followup Emails using Excel VBA</a>"}], "answers": [{"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 0, "last_activity_date": 1518040950, "last_edit_date": 1518040950, "creation_date": 1493860386, "answer_id": 43772304, "question_id": 43641700, "link": "https://stackoverflow.com/questions/43641700/how-do-you-specify-a-flagged-item-in-outlook-with-excel-vba/43772304#43772304", "title": "How do you specify a flagged item in Outlook with Excel VBA?", "body": "<p><em>Work with <strong><a href=\"https://msdn.microsoft.com/en-us/library/office/ff869597.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">Items.Restrict Method (Outlook)</a></strong> to exclude flag Items by <strong><a href=\"https://msdn.microsoft.com/en-us/library/office/ff867646.aspx#String%20Comparisons%20Using%20DASL%20Syntax\" rel=\"nofollow noreferrer\">Filtering Items Using a String Comparison</a></em></strong></p>\n\n<hr>\n\n<pre><code>Filter = \"@SQL=\" &amp; \" Not \" &amp; _\n                   \"http://schemas.microsoft.com/mapi/proptag/0x10900003\" &amp; _\n                   \"\" &amp; \"=1\"\n</code></pre>\n\n<hr>\n\n<p><em>Code Example</em></p>\n\n<pre><code>Option Explicit\nConst olFolderInbox = 6\nSub HowManyEmails()\n    Dim olApp As Object\n    Dim olNs As Object\n    Dim Inbox As Object\n    Dim SubFolder As Object\n    Dim Recip As Object\n    Dim Items As Object\n    Dim Filter As String\n\n    Set olApp = CreateObject(\"Outlook.Application\")\n    Set olNs = olApp.GetNamespace(\"MAPI\")\n    Set Recip = olNs.CreateRecipient(\"0m3r@email.com\") ' Share address\n        Recip.Resolve\n    Set Inbox = olNs.GetSharedDefaultFolder(Recip, olFolderInbox) ' Inbox\n\n    Filter = \"@SQL=\" &amp; \" Not \" &amp; _\n                       \"http://schemas.microsoft.com/mapi/proptag/0x10900003\" &amp; _\n                       \"\" &amp; \"=1\"\n\n    Set Items = Inbox.Items.Restrict(Filter) ' filter inbox items\n\n    '// Print on Immediate Window\n    Debug.Print Inbox.Name &amp; \" Has \" &amp; Items.Count &amp; \" Items \"\n\n    For Each SubFolder In Inbox.Folders\n        Set Items = SubFolder.Items.Restrict(Filter) ' filter sub items\n\n        '// Print on Immediate Window\n        Debug.Print SubFolder.Name &amp; \" Has \" &amp; Items.Count &amp; \" Items \"\n    Next\n\n    Set olApp = Nothing\n    Set olNs = Nothing\n    Set Inbox = Nothing\n    Set SubFolder = Nothing\n    Set Recip = Nothing\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p><em><sub><strong><a href=\"https://msdn.microsoft.com/en-us/library/office/ff869597.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">Items.Restrict Method</a></strong> Applies a filter to the Items collection, returning a new collection containing all of the items from the original that match the filter.<br>\n  The method is an alternative to using the <strong><a href=\"https://msdn.microsoft.com/en-us/library/office/ff869662.aspx\" rel=\"nofollow noreferrer\">Find method</a></strong> or <strong><a href=\"https://msdn.microsoft.com/en-us/library/office/ff869662.aspx\" rel=\"nofollow noreferrer\">FindNext method</a></strong> to iterate over specific items within a collection. The <strong><a href=\"https://msdn.microsoft.com/en-us/library/office/ff869662.aspx\" rel=\"nofollow noreferrer\">Find or FindNext methods</a></strong> are faster than filtering if there are a small number of items. The Restrict method is significantly faster if there is a large number of items in the collection, especially if only a few items in a large collection are expected to be found.</sub></em>\n  _</p>\n  \n  <hr>\n  \n  <p><em><sub><strong><a href=\"https://msdn.microsoft.com/en-us/library/office/ff867646.aspx#String%20Comparisons%20Using%20DASL%20Syntax\" rel=\"nofollow noreferrer\">Filtering Items Using a String Comparison</a></strong> that <strong>DASL</strong> <strong>filters</strong> support includes equivalence, prefix, phrase, and substring matching. Note that when you filter on the Subject property, prefixes such as <strong>\"RE: \"</strong> and <strong>\"FW: \"</strong> are ignored. </sub></em></p>\n  \n  <hr>\n</blockquote>\n"}], "owner": {"reputation": 156, "user_id": 5227322, "user_type": "registered", "accept_rate": 29, "profile_image": "https://graph.facebook.com/10153168692082515/picture?type=large", "display_name": "Mark S", "link": "https://stackoverflow.com/users/5227322/mark-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 572, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1593072824, "creation_date": 1493230653, "last_edit_date": 1593072824, "question_id": 43641700, "link": "https://stackoverflow.com/questions/43641700/how-do-you-specify-a-flagged-item-in-outlook-with-excel-vba", "title": "How do you specify a flagged item in Outlook with Excel VBA?", "body": "<p>I'm trying to get a count of how many emails are in my Outlook folders. The problem is that it is counting the \"Flagged\" items and I need the code to skip any item that is \"Flagged\". </p>\n\n<p>I've tried using the \"olNoFlag\" property on line 18 of the below code but it won't work. Can anyone help me with this? I'm so close!</p>\n\n<pre><code>Sub LoopFoldersInNoctalkSW()\n\nDim ns As Object\nDim objFolder As Object\nDim objSubfolder As Object\nDim lngCounter As Long\nDim olNoFlag As Object\n\nSet ns = GetObject(\"\", \"Outlook.Application\").GetNamespace(\"MAPI\")\nSet objFolder = ns.Folders(\"NoctalkSW\")\n\nFor Each objSubfolder In objFolder.Folders\nOn Error Resume Next\nWith Worksheets(\"Folder Names 2\")\n    lngCounter = lngCounter + 1\n    .Cells(lngCounter, 1) = objSubfolder.Name\n    .Cells(lngCounter, 2) = objSubfolder.Items.Count\n    .Cells(lngCounter, 3) = objSubfolder.Items.GetLast.ReceivedTime\nEnd With\n\nDebug.Print objSubfolder.Name\nDebug.Print objSubfolder.Items.Count\nDebug.Print objSubfolder.Items.GetLast.ReceivedTime\n\nNext objSubfolder\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1493228594, "post_id": 43641069, "comment_id": 74330495, "body": "Use a simple 2 x <code>For</code> loops, with <code>Step 3</code> and read the values to your 2-D array"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 3, "creation_date": 1493228614, "post_id": 43641069, "comment_id": 74330501, "body": "1. Do you want to fill an array with the values from a user-based selection or from a preset stagger/offset collecion of cells? 2. Have you done <b>nothing</b> towards a solution on your own beyond creating a pretty image of sample data that everyone else has to retype?"}, {"owner": {"reputation": 25, "user_id": 7855488, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2c59032c4d9b6e603734b05cb990eb01?s=128&d=identicon&r=PG&f=1", "display_name": "walid attia", "link": "https://stackoverflow.com/users/7855488/walid-attia"}, "edited": false, "score": 0, "creation_date": 1493228976, "post_id": 43641069, "comment_id": 74330682, "body": "not from  user based selection. i made a solution which delete the intermediate rows and columns but for large array (examle of 1000*1000),it takes alot of time that is why i thought in another way to create 2Darray with the above criteria"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1493229331, "post_id": 43641069, "comment_id": 74330861, "body": "Your question is not only <i>too broad</i>, it&#39;s also rather unclear."}, {"owner": {"reputation": 25, "user_id": 7855488, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2c59032c4d9b6e603734b05cb990eb01?s=128&d=identicon&r=PG&f=1", "display_name": "walid attia", "link": "https://stackoverflow.com/users/7855488/walid-attia"}, "edited": false, "score": 0, "creation_date": 1493230462, "post_id": 43641069, "comment_id": 74331536, "body": "@  Mat&#39;s Mug  i reformulated the question"}, {"owner": {"reputation": 25, "user_id": 7855488, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2c59032c4d9b6e603734b05cb990eb01?s=128&d=identicon&r=PG&f=1", "display_name": "walid attia", "link": "https://stackoverflow.com/users/7855488/walid-attia"}, "edited": false, "score": 0, "creation_date": 1493230582, "post_id": 43641069, "comment_id": 74331627, "body": "@  Jeeped  i have reformulated the question with your ask"}], "answers": [{"tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 0, "last_activity_date": 1493231866, "creation_date": 1493231866, "answer_id": 43642087, "question_id": 43641069, "link": "https://stackoverflow.com/questions/43641069/how-to-fill-data-from-worksheet-into-2d-array/43642087#43642087", "title": "how to fill data from worksheet into 2D array", "body": "<p>Something like this should work for you:</p>\n\n<pre><code>Sub tgr()\n\n    Dim ws As Worksheet\n    Dim aData As Variant\n    Dim aResults() As Variant\n    Dim lRow As Long, lCol As Long\n    Dim i As Long, j As Long\n    Dim lRowInterval As Long\n    Dim lColInterval As Long\n\n    Set ws = ActiveWorkbook.ActiveSheet\n    lRowInterval = 3\n    lColInterval = 3\n\n    aData = ws.Range(\"A1\").CurrentRegion\n    ReDim aResults(1 To Int(UBound(aData, 1) / lRowInterval), 1 To Int(UBound(aData, 2) / lColInterval))\n\n    i = 0\n    For lRow = 1 To UBound(aData, 1) Step lRowInterval\n        i = i + 1\n        j = 0\n        For lCol = 1 To UBound(aData, 2) Step lColInterval\n            j = j + 1\n            aResults(i, j) = aData(lRow, lCol)\n        Next lCol\n    Next lRow\n\n    'Do what you want with the array aResults here\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 7855488, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2c59032c4d9b6e603734b05cb990eb01?s=128&d=identicon&r=PG&f=1", "display_name": "walid attia", "link": "https://stackoverflow.com/users/7855488/walid-attia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "accepted_answer_id": 43642087, "answer_count": 1, "score": -1, "last_activity_date": 1493231866, "creation_date": 1493228395, "last_edit_date": 1493230157, "question_id": 43641069, "link": "https://stackoverflow.com/questions/43641069/how-to-fill-data-from-worksheet-into-2d-array", "title": "how to fill data from worksheet into 2D array", "body": "<p>if i have data filled in worksheet like shown in image, i want to create a 2D array and fill it with data in such way of the selected cells in the image, i.e to take the 1st value and skip the next two values and so on till the end of the array and by same way in columns</p>\n\n<p><a href=\"https://i.stack.imgur.com/DAuNI.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DAuNI.gif\" alt=\" (i),\"></a></p>\n\n<p>i made a solution which delete the intermediate rows and columns but for large array (example of 1000*1000),it takes a lot of time that is why i thought in another way to create array with the above criteria.\nthis is the code i used for deleting the intermediate rows and columns:</p>\n\n<pre><code>Sub Sorting() \nDim LastRow As Long\nLastRow = sh.Range(\"A1\", sh.Range(\"A1\").End(xlDown)).rows.count \nFor cntr = 1 To LastRow / 3 \nrows(cntr + 1 &amp; \":\" &amp; cntr + 2).EntireRow.Delete \nNext\nDim LastColumn As Long \nLastColumn = sh.Range(\"A1\").CurrentRegion.Columns.count\nK = LastColumn \nFor cntr = 1 To K / 3 \nColumns(cntr + 1).EntireColumn.Delete\nColumns(cntr + 1).EntireColumn.Delete \nNext\nEnd Sub enter code here \n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1493228758, "post_id": 43640609, "comment_id": 74330577, "body": "Where is the NTMR? Subject line? Or email body?"}, {"owner": {"reputation": 83, "user_id": 7926391, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a8f353e1271ddc2558948f233a308436?s=128&d=identicon&r=PG&f=1", "display_name": "wasimakram101", "link": "https://stackoverflow.com/users/7926391/wasimakram101"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1493230019, "post_id": 43640609, "comment_id": 74331266, "body": "@0m3r subject line"}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 7926391, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a8f353e1271ddc2558948f233a308436?s=128&d=identicon&r=PG&f=1", "display_name": "wasimakram101", "link": "https://stackoverflow.com/users/7926391/wasimakram101"}, "edited": false, "score": 0, "creation_date": 1493251696, "post_id": 43646264, "comment_id": 74341325, "body": "thank you so much.. will the dateFormat work fine in my code?"}, {"owner": {"reputation": 83, "user_id": 7926391, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a8f353e1271ddc2558948f233a308436?s=128&d=identicon&r=PG&f=1", "display_name": "wasimakram101", "link": "https://stackoverflow.com/users/7926391/wasimakram101"}, "edited": false, "score": 0, "creation_date": 1493252042, "post_id": 43646264, "comment_id": 74341408, "body": "how can i make my dateFormat get a month prior to current month?"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "reply_to_user": {"reputation": 83, "user_id": 7926391, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a8f353e1271ddc2558948f233a308436?s=128&d=identicon&r=PG&f=1", "display_name": "wasimakram101", "link": "https://stackoverflow.com/users/7926391/wasimakram101"}, "edited": false, "score": 0, "creation_date": 1493253851, "post_id": 43646264, "comment_id": 74341828, "body": "@wasimakram101 just the month and the year?-"}, {"owner": {"reputation": 83, "user_id": 7926391, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a8f353e1271ddc2558948f233a308436?s=128&d=identicon&r=PG&f=1", "display_name": "wasimakram101", "link": "https://stackoverflow.com/users/7926391/wasimakram101"}, "edited": false, "score": 1, "creation_date": 1493256972, "post_id": 43646264, "comment_id": 74342601, "body": "yes, in YYYYMM format. That&#39;s what im having an issue with. Thank you so much for taking the time out for this."}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": true, "score": 3, "last_activity_date": 1505576846, "last_edit_date": 1505576846, "creation_date": 1493249752, "answer_id": 43646264, "question_id": 43640609, "link": "https://stackoverflow.com/questions/43640609/save-attachment-from-an-email-in-to-a-folder-that-changes-every-month/43646264#43646264", "title": "Save attachment from an email in to a folder that changes every month", "body": "<p><em>Work with <strong><a href=\"https://msdn.microsoft.com/en-us/library/6x627e5f(v=vs.90).aspx\" rel=\"nofollow noreferrer\">MSDN Split Function</a></em></strong></p>\n\n<p><em>Example on your Subject line <strong><code>Here is the NTMR file for you</code></strong> split it by space character <strong><code>(\" \")</code></em></strong></p>\n\n<p><em>Code Example</em></p>\n\n<pre><code>Sub Example()\n    Dim Item As Outlook.mailitem\n\n    Set Item = ActiveExplorer.Selection.Item(1)\n\n    Debug.Print Item.subject ' Print on Immediate Window (Ctrl+G)\n\n    Item.subject = Split(Item.subject, \" \")(3)\n\n    Debug.Print Item.subject ' Print on Immediate Window (Ctrl+G)\n\nEnd Sub\n</code></pre>\n\n<p><em>Your subject = <strong><code>(Here)(1)</code></strong> <strong><code>(is)(2)</code></strong> <strong><code>(the)(3)</code></strong> <strong><code>(NTMR)(4)</code></strong> <strong><code>(file)(5)</code></strong> <strong><code>(for)(6)</code></strong> <strong><code>(you)(7)</code></em></strong></p>\n\n<p><em>Now <strong><code>Split(subject line), \"space\")(3)</code></strong> While assigning to string variable</em></p>\n\n<pre><code>Dim FileName As String\nFileName = Split(Item.subject, \" \")(3)\n</code></pre>\n\n<p><em>Replace <strong><code>objAtt.DisplayName</code></strong> with <strong><code>FileName</code></em></strong></p>\n\n<hr>\n\n<pre><code>Dim FileName As String\nFor Each objAtt In itm.Attachments\n    objAtt.SaveAsFile saveFolder &amp; \"\\\" &amp; _\n                       dateFormat &amp; \"\\\" &amp; _\n                    \"Source Files\" &amp; \"\\\" &amp; FileName &amp; dateFormat\nNext\n</code></pre>\n\n<blockquote>\n  <p><em><sub>By default, or when Limit equals -1, the Split function splits the input string at every occurrence of the delimiter string, and returns the <strong>substrings</strong> in an array. <br>\n  When the Limit parameter is greater than zero, the Split function splits the string at the first <strong>Limit-1</strong> occurrences of the delimiter, and returns an array with the resulting substrings. <br>\n  For example, <strong><code>Split(\"a:b:c\", \":\") returns the array {\"a\", \"b\", \"c\"}</code></strong>, <br>\n  while <strong><code>Split(\"a:b:c\", \":\", 2) returns the array {\"a\", \"b:c\"}</code></strong>.</sub></em></p>\n  \n  <hr>\n</blockquote>\n\n<p><em>To get previous month try <strong><a href=\"https://msdn.microsoft.com/en-us/library/hcxe65wz(v=vs.90).aspx\" rel=\"nofollow noreferrer\">DateAdd Function</a></em></strong></p>\n\n<p><em>Example</em></p>\n\n<pre><code>Option Explicit\nPublic Sub Example()\n    Dim PrevMonth As String\n\n    PrevMonth = Format(DateAdd(\"m\", -1, Date), \"yyyymm\")\n    Debug.Print PrevMonth\nEnd Sub\n</code></pre>\n\n<blockquote>\n  <p><em><sub>\n  Some useful date functions worth exploring in other contexts include <strong><code>DateDiff</code></strong>, <strong><code>DatePart</code></strong>, <strong><code>DateSerial</code></strong>, Day, Month, Year, and <strong><code>IsDate</code></strong>.\n  <strong><code>IsDate</code></strong> (which checks whether a string is a valid date) is particularly useful for things like <code>UserForms</code> where you may want to force the user to type a valid date into a certain textbox.\n  </sub></em></p>\n  \n  <hr>\n</blockquote>\n"}], "owner": {"reputation": 83, "user_id": 7926391, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a8f353e1271ddc2558948f233a308436?s=128&d=identicon&r=PG&f=1", "display_name": "wasimakram101", "link": "https://stackoverflow.com/users/7926391/wasimakram101"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1672, "favorite_count": 0, "accepted_answer_id": 43646264, "answer_count": 1, "score": 2, "last_activity_date": 1592700154, "creation_date": 1493226785, "last_edit_date": 1592700154, "question_id": 43640609, "link": "https://stackoverflow.com/questions/43640609/save-attachment-from-an-email-in-to-a-folder-that-changes-every-month", "title": "Save attachment from an email in to a folder that changes every month", "body": "<p>i 'm trying to get a VBA macro in Outlook that will save an email's attachment to a specific folder (that changes every month) and add the YYYYMM of prior month received to the file name.</p>\n\n<p>The outlook rule identifies that an email header contains 'NTMR' from a person.</p>\n\n<p>And when it does so, it runs the script where it saves the attachment in a folder.</p>\n\n<p>So when the macro identifies the month of the email received, it saves in the folder that is one month behind. For instance:</p>\n\n<p>email received on DD/04/17 as 'Here is the NTMR file for you', it will save the file in a folder within 201703 parent folder as NTMR - 201703</p>\n\n<p>So the path of the file will be C:\\Users\\alitalh\\Downloads\\Test\\201703\\Source Files\\NTMR 201703</p>\n\n<p>I have come up with the follownig macro - please advise as To how i can fix it?</p>\n\n<pre><code>Public Sub saveAttachtoDisk(itm As Outlook.MailItem)\n    Dim objAtt As Outlook.Attachment\n    Dim saveFolder As String\n    Dim dateFormat As String\n    saveFolder = \"C:\\Users\\alitalh\\Downloads\\Test\"\n    dateFormat = Format(Now, \"yyyymm\" - 1, 1)\n\n    For Each objAtt In itm.Attachments\n        objAtt.SaveAsFile saveFolder &amp; \"\\\" &amp; dateFormat &amp; \"\\\" &amp; \"Source Files\" &amp; \"\\\" &amp; objAtt.DisplayName &amp; dateFormat\n        Set objAtt = Nothing\n    Next\nEnd Sub\n</code></pre>\n\n<p>how can i strip out the NTMR from the header and put it in the filename?</p>\n\n<p>I have another macro that sets up the folder prior to the email so we don't need to create another folder</p>\n"}, {"tags": ["excel", "vba", "excel-2010"], "comments": [{"owner": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "edited": false, "score": 1, "creation_date": 1493326639, "post_id": 43640397, "comment_id": 74382446, "body": "My advice is to not worry about the odd downvote. However, if it does bother you, please add a comment, rather than adding voting commentary to your post - it does not belong there. Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 50, "user_id": 1968751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcca9c35d64dde8b75ef2288b6d285d9?s=128&d=identicon&r=PG", "display_name": "scott.se", "link": "https://stackoverflow.com/users/1968751/scott-se"}, "is_accepted": true, "score": 0, "last_activity_date": 1493326581, "last_edit_date": 1493326581, "creation_date": 1493240721, "answer_id": 43644511, "question_id": 43640397, "link": "https://stackoverflow.com/questions/43640397/excel-vba-2010-mimic-user-slicer-interaction/43644511#43644511", "title": "Excel VBA 2010 - Mimic user slicer interaction", "body": "<p>The solution is to work with the pivot table directly:</p>\n\n<pre><code>ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"FIELD\").CurrentPage = Target.Value\n</code></pre>\n"}], "owner": {"reputation": 50, "user_id": 1968751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcca9c35d64dde8b75ef2288b6d285d9?s=128&d=identicon&r=PG", "display_name": "scott.se", "link": "https://stackoverflow.com/users/1968751/scott-se"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 229, "favorite_count": 0, "accepted_answer_id": 43644511, "answer_count": 1, "score": 1, "last_activity_date": 1493326581, "creation_date": 1493226112, "last_edit_date": 1493325823, "question_id": 43640397, "link": "https://stackoverflow.com/questions/43640397/excel-vba-2010-mimic-user-slicer-interaction", "title": "Excel VBA 2010 - Mimic user slicer interaction", "body": "<p>From checking various sites, the only known(?) way to select one item from a slicer is to deselect all other others by iterating through the array of items. When a user clicks an unfiltered slicer, it instantly deslects all other items - is there a way to mimic this behavior with VBA (deselect all except for the item clicked)? Specifically, the number of items to filter is too long and takes takes too long to iterate through, even with calculations off.</p>\n\n<pre><code>ActiveWorkbook.SlicerCaches(\"Slicer_A\").ClearManualFilter\n\nWith ActiveWorkbook.SlicerCaches(\"Slicer_A\")\n    For i = 1 To .SlicerItems.Count\n        If .SlicerItems(i).Caption = Target.Value Then\n        Else\n        .SlicerItems(i).Selected = False\n        End If\n    Next i\nEnd With\n</code></pre>\n\n<p>Edit: To clarify why I am wanting to do this with VBA, I am making a \"drill in\" macro, where I can click on a cell (that is the result of a formula, not a pivot table cell), and it will take me to the appropriate tab and adjust the slicers as necessary to show where that number comes from.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7925225, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/6101bec7ce78d8eda1b722bea520fccf?s=128&d=identicon&r=PG&f=1", "display_name": "samred", "link": "https://stackoverflow.com/users/7925225/samred"}, "edited": false, "score": 0, "creation_date": 1493232852, "post_id": 43641996, "comment_id": 74332976, "body": "I tried using this, except it keeps storing it in the same cell. It stores it all in Sheet NB Load Book B5 and C5. That cell keeps changing with each iteration but I need the values to be stored in the the next row and so on. Like b6 c6 and b7 c7 etc"}, {"owner": {"reputation": 1169, "user_id": 1350263, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/3dxtp.png?s=128&g=1", "display_name": "CaptainABC", "link": "https://stackoverflow.com/users/1350263/captainabc"}, "reply_to_user": {"reputation": 3, "user_id": 7925225, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/6101bec7ce78d8eda1b722bea520fccf?s=128&d=identicon&r=PG&f=1", "display_name": "samred", "link": "https://stackoverflow.com/users/7925225/samred"}, "edited": false, "score": 0, "creation_date": 1493233123, "post_id": 43641996, "comment_id": 74333148, "body": "@samred The code that I&#39;ve posted copies the data from Max Amps B6 &amp; B7 then pastes these values into NB Load Book B5 &amp; C5. In the next iteration it will copy from Max Amps B6 &amp; B7 then pastes into NB .. B6 &amp; C6, and so on.  The copied from values in Max Amps are constant but the NB Load Book values are variable."}, {"owner": {"reputation": 1169, "user_id": 1350263, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/3dxtp.png?s=128&g=1", "display_name": "CaptainABC", "link": "https://stackoverflow.com/users/1350263/captainabc"}, "reply_to_user": {"reputation": 3, "user_id": 7925225, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/6101bec7ce78d8eda1b722bea520fccf?s=128&d=identicon&r=PG&f=1", "display_name": "samred", "link": "https://stackoverflow.com/users/7925225/samred"}, "edited": false, "score": 0, "creation_date": 1493233194, "post_id": 43641996, "comment_id": 74333201, "body": "@samred does the copied values in Max Amps need to be variable and increase the copied from row in each iteration?"}, {"owner": {"reputation": 3, "user_id": 7925225, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/6101bec7ce78d8eda1b722bea520fccf?s=128&d=identicon&r=PG&f=1", "display_name": "samred", "link": "https://stackoverflow.com/users/7925225/samred"}, "edited": false, "score": 0, "creation_date": 1493233494, "post_id": 43641996, "comment_id": 74333380, "body": "Also should myval in the bottom be myRCval?"}, {"owner": {"reputation": 3, "user_id": 7925225, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/6101bec7ce78d8eda1b722bea520fccf?s=128&d=identicon&r=PG&f=1", "display_name": "samred", "link": "https://stackoverflow.com/users/7925225/samred"}, "edited": false, "score": 0, "creation_date": 1493233612, "post_id": 43641996, "comment_id": 74333446, "body": "The copied values in Max Amps changes based on the initial NB Load Book value that is pasted into cell B1. The copied values from Max Amps b6 and b7 are always number/dates respectively, but the actual number or date changes based on what is entered into Max Amps B1."}, {"owner": {"reputation": 1169, "user_id": 1350263, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/3dxtp.png?s=128&g=1", "display_name": "CaptainABC", "link": "https://stackoverflow.com/users/1350263/captainabc"}, "reply_to_user": {"reputation": 3, "user_id": 7925225, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/6101bec7ce78d8eda1b722bea520fccf?s=128&d=identicon&r=PG&f=1", "display_name": "samred", "link": "https://stackoverflow.com/users/7925225/samred"}, "edited": false, "score": 0, "creation_date": 1493233713, "post_id": 43641996, "comment_id": 74333508, "body": "@samred Oh yes, <code>myval</code> should be <code>myRCval</code>. I&#39;ve corrected and updated the code."}, {"owner": {"reputation": 1169, "user_id": 1350263, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/3dxtp.png?s=128&g=1", "display_name": "CaptainABC", "link": "https://stackoverflow.com/users/1350263/captainabc"}, "reply_to_user": {"reputation": 3, "user_id": 7925225, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/6101bec7ce78d8eda1b722bea520fccf?s=128&d=identicon&r=PG&f=1", "display_name": "samred", "link": "https://stackoverflow.com/users/7925225/samred"}, "edited": false, "score": 0, "creation_date": 1493234029, "post_id": 43641996, "comment_id": 74333702, "body": "@samred Can you try again with the updated code and let me know if it works for you?"}, {"owner": {"reputation": 3, "user_id": 7925225, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/6101bec7ce78d8eda1b722bea520fccf?s=128&d=identicon&r=PG&f=1", "display_name": "samred", "link": "https://stackoverflow.com/users/7925225/samred"}, "edited": false, "score": 0, "creation_date": 1493234062, "post_id": 43641996, "comment_id": 74333723, "body": "Not sure what changed but now it&#39;s not calculating. It just populates those fields with &quot;#Value&quot; and the message box pops up. Could you make the first code available?  I&#39;m also making it i = 1 to 3 instead of i = 1 to 153 since each iteration takes about 1 minute  I undo-ed until I got the old code that worked. I changed the variables to myRCval. But now it&#39;s still only populating NB Load Book B5 and C5"}, {"owner": {"reputation": 3, "user_id": 7925225, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/6101bec7ce78d8eda1b722bea520fccf?s=128&d=identicon&r=PG&f=1", "display_name": "samred", "link": "https://stackoverflow.com/users/7925225/samred"}, "edited": false, "score": 0, "creation_date": 1493234359, "post_id": 43641996, "comment_id": 74333877, "body": "Your current code doesn&#39;t work the way it is right now because you still have myval instead of myRCval in your 8th line of code. Regardless, still populating only b5 and c5"}, {"owner": {"reputation": 1169, "user_id": 1350263, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/3dxtp.png?s=128&g=1", "display_name": "CaptainABC", "link": "https://stackoverflow.com/users/1350263/captainabc"}, "reply_to_user": {"reputation": 3, "user_id": 7925225, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/6101bec7ce78d8eda1b722bea520fccf?s=128&d=identicon&r=PG&f=1", "display_name": "samred", "link": "https://stackoverflow.com/users/7925225/samred"}, "edited": false, "score": 0, "creation_date": 1493234760, "post_id": 43641996, "comment_id": 74334112, "body": "@samred updated the code again. Can you please try now?"}, {"owner": {"reputation": 3, "user_id": 7925225, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/6101bec7ce78d8eda1b722bea520fccf?s=128&d=identicon&r=PG&f=1", "display_name": "samred", "link": "https://stackoverflow.com/users/7925225/samred"}, "edited": false, "score": 0, "creation_date": 1493235378, "post_id": 43641996, "comment_id": 74334455, "body": "working, thanks! Last question, how do you learn to do this? I&#39;ve seen tutorialspoint for definitions and stuff but not actually how to put together code like this."}, {"owner": {"reputation": 1169, "user_id": 1350263, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/3dxtp.png?s=128&g=1", "display_name": "CaptainABC", "link": "https://stackoverflow.com/users/1350263/captainabc"}, "reply_to_user": {"reputation": 3, "user_id": 7925225, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/6101bec7ce78d8eda1b722bea520fccf?s=128&d=identicon&r=PG&f=1", "display_name": "samred", "link": "https://stackoverflow.com/users/7925225/samred"}, "edited": false, "score": 0, "creation_date": 1493235629, "post_id": 43641996, "comment_id": 74334609, "body": "@samred you learn by working on solving different problems. Each time you learn something new. I&#39;m sure you learned from this, so next time you need to use a loop, you can probably re-issue this with some level of understanding. Glad the code worked for you. You may please mark my answer as accepted using the green check mark sign."}], "tags": [], "owner": {"reputation": 1169, "user_id": 1350263, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/3dxtp.png?s=128&g=1", "display_name": "CaptainABC", "link": "https://stackoverflow.com/users/1350263/captainabc"}, "is_accepted": true, "score": 0, "last_activity_date": 1493234717, "last_edit_date": 1493234717, "creation_date": 1493231580, "answer_id": 43641996, "question_id": 43640386, "link": "https://stackoverflow.com/questions/43640386/how-to-change-macro-recording-into-vba-for-loop-for-larger-range/43641996#43641996", "title": "How to change macro recording into VBA for loop for larger range?", "body": "<p>The description above your code is inconsistent with your recorded Macro, where as the code shown copies &amp; pastes different from/to different cells than you describe as intended.</p>\n\n<p>In any case, the below should do it:</p>\n\n<pre><code>Sub Macro10()\n\nmyRCval = 4\nmyBval = 5\nmyCval = 5 \n\nFor i = 1 To 153\n\n\nThisWorkbook.Worksheets(\"Max Amps\").Range(\"B1\").ClearContents\nThisWorkbook.Worksheets(\"Max Amps\").Range(\"B1\").NumberFormat = \"General\"\nThisWorkbook.Worksheets(\"Max Amps\").Range(\"B1\").Value = \"='NB Load Book'!R[\" &amp; myRCval &amp; \"]C[-1]\"\nThisWorkbook.Worksheets(\"Max Amps\").Calculate\nThisWorkbook.Worksheets(\"Max Amps\").Range(\"B6\").Copy\nThisWorkbook.Worksheets(\"NB Load Book\").Range(\"B\" &amp; myBval).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n:=False, Transpose:=False\nThisWorkbook.Worksheets(\"Max Amps\").Range(\"B7\").Copy\nThisWorkbook.Worksheets(\"NB Load Book\").Range(\"C\" &amp; myCval).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n:=False, Transpose:=False\n\nmyRCval = myRCval + 1\nmyBval = myBval + 1\nmyCval = myCval + 1\nNext i\n\nApplication.CutCopyMode = False\nMsgBox \"Done\"\n\nEnd Sub\n</code></pre>\n\n<p>You may modify the variables as you see fit.</p>\n"}], "owner": {"reputation": 3, "user_id": 7925225, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/6101bec7ce78d8eda1b722bea520fccf?s=128&d=identicon&r=PG&f=1", "display_name": "samred", "link": "https://stackoverflow.com/users/7925225/samred"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 43641996, "answer_count": 1, "score": 0, "last_activity_date": 1493234717, "creation_date": 1493226080, "last_edit_date": 1531164843, "question_id": 43640386, "link": "https://stackoverflow.com/questions/43640386/how-to-change-macro-recording-into-vba-for-loop-for-larger-range", "title": "How to change macro recording into VBA for loop for larger range?", "body": "<p>Ok So I'm trying to make this easier to follow so I get better help.\nThis is the code I currently have from a recorded macro.\nThis is one iteration and I need 153. What it does: 1. Clears B2 and sets format as general since it automatically changes to number after each iteration. 2. Sheet NB Load Book Cell R[4]C[-1] is referenced and pasted into sheet Max Amps cell B2. 3. Calculate Sheet button is pressed. 4. The values in sheet Max Amps cells B6 and B7 are copied and pasted as a number into sheet NB Load Book cells B5 and C5.</p>\n\n<p>The next iteration for example would use sheet NB Load Book cell R[5]C[-1] and enter into same place and copy same cells and paste as number into Sheet NB Load Book cells B6 and C6.\n Need this all the way until Row 153 ...so until R[152]C[-1].</p>\n\n<pre><code>Sub Macro10()\n    Sheets(\"Max Amps\").Select\n    Range(\"B1\").Select\n    Selection.ClearContents\n    Selection.NumberFormat = \"General\"\n    Range(\"B1\").Select\n    ActiveCell.FormulaR1C1 = \"='NB Load Book'!R[4]C[-1]\"\n    Range(\"B2\").Select\n    ActiveSheet.Calculate\n    Range(\"B6\").Select\n    Selection.Copy\n    Sheets(\"NB Load Book\").Select\n    Range(\"B5\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Sheets(\"Max Amps\").Select\n    Range(\"B7\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"NB Load Book\").Select\n    Range(\"C5\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n</code></pre>\n\n<p>Once again I know this is messy but I'm a beginner. How can I make this code apply to 153 iterations without typing them all out? Thank you for your help. </p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 3, "creation_date": 1493227264, "post_id": 43640305, "comment_id": 74329710, "body": "I guess the real questions is why are there multiple parts tables?"}, {"owner": {"reputation": 3, "user_id": 7835721, "user_type": "registered", "profile_image": "https://graph.facebook.com/1903181783261418/picture?type=large", "display_name": "Alfonso Garcia", "link": "https://stackoverflow.com/users/7835721/alfonso-garcia"}, "reply_to_user": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1493240767, "post_id": 43640305, "comment_id": 74337414, "body": "Now that I think, I guess I can have only one table, and I always can filter or export it to excel to see it by part number.                                                                                  What I am really looking for is for a pass or fail when I enter the results, so every part number have different limits."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 1, "creation_date": 1493248720, "post_id": 43640305, "comment_id": 74340534, "body": "well then you need to ask SQL related questions, as this type of data filtering is what sql is good at"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7835721, "user_type": "registered", "profile_image": "https://graph.facebook.com/1903181783261418/picture?type=large", "display_name": "Alfonso Garcia", "link": "https://stackoverflow.com/users/7835721/alfonso-garcia"}, "edited": false, "score": 0, "creation_date": 1493337355, "post_id": 43664660, "comment_id": 74386283, "body": "Jhonny-  Thank you for taking the time to answer my question. That makes sense to me as to answer my question.  However, I plan to use this database to record 20 tests/day.  Which of the two options would you recommend, so database don&#39;t get slow over the time?"}, {"owner": {"reputation": 8233, "user_id": 2174085, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/oMs90.jpg?s=128&g=1", "display_name": "Johnny Bones", "link": "https://stackoverflow.com/users/2174085/johnny-bones"}, "reply_to_user": {"reputation": 3, "user_id": 7835721, "user_type": "registered", "profile_image": "https://graph.facebook.com/1903181783261418/picture?type=large", "display_name": "Alfonso Garcia", "link": "https://stackoverflow.com/users/7835721/alfonso-garcia"}, "edited": false, "score": 0, "creation_date": 1493383231, "post_id": 43664660, "comment_id": 74406999, "body": "I&#39;ve used Access tables with up to 500,000 records without any issues, as long as the table is properly indexed.  I&#39;d definitely recommend using a normalized table, it just makes life easier.  Then you don&#39;t have to write any extra code to know which table you&#39;re working with.  However, I&#39;d also still recommend using an unbound form, it&#39;s much easier to cancel a record before it&#39;s written than it is when you use a bound form."}], "tags": [], "owner": {"reputation": 8233, "user_id": 2174085, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/oMs90.jpg?s=128&g=1", "display_name": "Johnny Bones", "link": "https://stackoverflow.com/users/2174085/johnny-bones"}, "is_accepted": false, "score": 0, "last_activity_date": 1493315195, "creation_date": 1493315195, "answer_id": 43664660, "question_id": 43640305, "link": "https://stackoverflow.com/questions/43640305/access-2016-how-to-save-form-entry-data-in-a-specific-table-based-on-the-entry/43664660#43664660", "title": "Access 2016: How to save Form entry data in a specific table based on the entry data?", "body": "<p>This is actually really simple to do, however the end result is pretty far from \"normalized\" and so I'd highly suggest you put all data in one table and have a \"PartNum\" field or something so it can be filtered when necessary.</p>\n\n<p>However, to answer your question...  The way you can do this is with an <a href=\"https://msdn.microsoft.com/en-us/library/dd355152.aspx\" rel=\"nofollow noreferrer\">unbound form</a>.  If you do not associate a specific table as the form's source data, it is considered unbound.  Comparatively, if you bind a form to a specific table and then bind the fields to controls, as soon as you enter the data in the form it is immediately written to the table.  Using an unbound form allows you to have full control over what data is written and to which table it's written to.</p>\n\n<p>So, using an unbound form, you can simply put a \"Save\" button on the form and put VBA in the OnClick event of this button.  In the OnClick event of the button you could check the PartNum field and, based on the value, write to the appropriate table.</p>\n\n<p>For instance:</p>\n\n<pre><code>Public Sub btnSave_OnClick()\ndim db as Database\ndim rec as Recordset\n\nSet db = CurrentDb\n'Find out which table to write to\nif Me.PartNum.Text = \"A\" then\n  MyTable = \"PartNumA\"\nelseif Me.PartNum.Text = \"B\" then\n  MyTable = \"PartNumB\"\nelse (etc...)\nend if\n\nSet rec = db.OpenRecordset(\"Select * from \" &amp; MyTable &amp; \"\")\nrec.AddNew\nrec(\"PartNum\") = Me.PartNum.Text\nrec(\"Date\") = Me.Date.Text\nrec(\"Temperature\") = Me.Temperature.Text\netc...\nrec.Update\n\nrec.Close\ndb.Close\nEnd Sub\n</code></pre>\n\n<p>The above is entirely \"aircode\"; completely untested and hypothetical but probably pretty close to what you'd actually write.</p>\n"}], "owner": {"reputation": 3, "user_id": 7835721, "user_type": "registered", "profile_image": "https://graph.facebook.com/1903181783261418/picture?type=large", "display_name": "Alfonso Garcia", "link": "https://stackoverflow.com/users/7835721/alfonso-garcia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1736, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1493315195, "creation_date": 1493225838, "last_edit_date": 1493278294, "question_id": 43640305, "link": "https://stackoverflow.com/questions/43640305/access-2016-how-to-save-form-entry-data-in-a-specific-table-based-on-the-entry", "title": "Access 2016: How to save Form entry data in a specific table based on the entry data?", "body": "<p>I spent about ten minutes trying to find the best question that describes my problem, so it may not be the best one. </p>\n\n<p>I am doing a database from scratch for practice. This is a brief explanation of what I have:</p>\n\n<p>I have tables  A,  B,  C, and D.------         A,B,C,D are part numbers.</p>\n\n<p>Then I have a Form where I have to enter the part number, date, temperature, name, result1, and result2. </p>\n\n<p>Here is what I am trying to do:\n- If I enter part number A, I want to save all the information in the table A.\n- If I enter part number B, I want to save all the information in the Table B.\n- Same with the rest of the part numbers.</p>\n\n<p>What would be the easiest way to do this?</p>\n\n<p>Thanks you all for your comments. </p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "edited": false, "score": 0, "creation_date": 1493229055, "post_id": 43640126, "comment_id": 74330719, "body": "The hidden text has to be visible on the screen to be selected. So you need this in your code: <code>ActiveDocument.ActiveWindow.View.ShowHiddenText = True</code> However, you may be able to not let the user see them by <code>Application.ScreenUpdating = False</code> at the beginning of the code. Not tested though."}, {"owner": {"reputation": 101, "user_id": 7442894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10154475117908918/picture?type=large", "display_name": "Peter Nguyen", "link": "https://stackoverflow.com/users/7442894/peter-nguyen"}, "reply_to_user": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "edited": false, "score": 0, "creation_date": 1493229915, "post_id": 43640126, "comment_id": 74331209, "body": "@masoud adding &#39;ActiveDocument.ActiveWindow.View.ShowHiddenText = True&#39; works! I never thought of that.  I&#39;m not sure about &#39;Application.ScreenUpdating = False&#39; though."}, {"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "edited": false, "score": 0, "creation_date": 1493301014, "post_id": 43640126, "comment_id": 74366713, "body": "<a href=\"https://meta.stackexchange.com/questions/5234/how-does-accepting-an-answer-work/5235#5235\" title=\"how does accepting an answer work\">meta.stackexchange.com/questions/5234/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "is_accepted": true, "score": 1, "last_activity_date": 1493301050, "last_edit_date": 1493301050, "creation_date": 1493231336, "answer_id": 43641916, "question_id": 43640126, "link": "https://stackoverflow.com/questions/43640126/ms-word-how-to-select-hidden-text/43641916#43641916", "title": "MS Word How to select hidden text", "body": "<p>The hidden text has to be visible on the screen to be selected. So you need this in your code. You don't need to un-hide them;</p>\n\n<pre><code>ActiveDocument.ActiveWindow.View.ShowHiddenText = True \n</code></pre>\n\n<p>If you want the user to not see the texts while running this may do the job. However, it is not tested;</p>\n\n<pre><code>Application.ScreenUpdating = False \n</code></pre>\n\n<p>Remember to turn it back on at the end of your code;</p>\n\n<pre><code>Application.ScreenUpdating = True \n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 7442894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10154475117908918/picture?type=large", "display_name": "Peter Nguyen", "link": "https://stackoverflow.com/users/7442894/peter-nguyen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 820, "favorite_count": 0, "accepted_answer_id": 43641916, "answer_count": 1, "score": 1, "last_activity_date": 1493301050, "creation_date": 1493225212, "last_edit_date": 1493275491, "question_id": 43640126, "link": "https://stackoverflow.com/questions/43640126/ms-word-how-to-select-hidden-text", "title": "MS Word How to select hidden text", "body": "<p>So I have a set of code that would select a specific range of text to be hidden and I need to have a macro that would select those hidden text and unhide them.  However, I don't know how to select those hidden text without first displaying them.  Is there a way to select hidden text while they're not displayed.  I'm trying to create a dynamic template where if certain conditions are selected only certain text will appear.  So far this is my code to unhide hidden text.</p>\n\n<pre><code>Sub Macro2()\n'\n' Macro2 Macro\n'\n'\n    Selection.MoveDown Unit:=wdLine, Count:=1\n    Selection.MoveUp Unit:=wdParagraph, Count:=4, Extend:=wdExtend\n    With Selection.Font\n        .NameFarEast = \"+Body Asian\"\n        .NameAscii = \"+Body\"\n        .NameOther = \"+Body\"\n        .Name = \"+Body\"\n        .Size = 11\n        .Bold = False\n        .Italic = False\n        .Underline = wdUnderlineNone\n        .UnderlineColor = wdColorAutomatic\n        .StrikeThrough = False\n        .DoubleStrikeThrough = False\n        .Outline = False\n        .Emboss = False\n        .Shadow = False\n        .Hidden = False\n        .SmallCaps = False\n        .AllCaps = False\n        .Color = wdColorAutomatic\n        .Engrave = False\n        .Superscript = False\n        .Subscript = False\n        .Spacing = 0\n        .Scaling = 100\n        .Position = 0\n        .Kerning = 0\n        .Animation = wdAnimationNone\n        .DisableCharacterSpaceGrid = False\n        .EmphasisMark = wdEmphasisMarkNone\n        .Ligatures = wdLigaturesNone\n        .NumberSpacing = wdNumberSpacingDefault\n        .NumberForm = wdNumberFormDefault\n        .StylisticSet = wdStylisticSetDefault\n        .ContextualAlternates = 0\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1493223957, "post_id": 43639708, "comment_id": 74327768, "body": "Maybe use <code>Range(&quot;G2&quot;).Formula = &quot;=VLOOKUP(H2,Start!$A$2:$B$9,2)&quot;</code> instead?"}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 3070873, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/c8e46e3b1dd6d7b75acfe2e4ffcdc62a?s=128&d=identicon&r=PG&f=1", "display_name": "RickyD", "link": "https://stackoverflow.com/users/3070873/rickyd"}, "edited": false, "score": 0, "creation_date": 1493227387, "post_id": 43639798, "comment_id": 74329782, "body": "This works perfectly. I&#39;ve struggled over this many times.  Thanks!"}], "tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": true, "score": 3, "last_activity_date": 1493224139, "creation_date": 1493224139, "answer_id": 43639798, "question_id": 43639708, "link": "https://stackoverflow.com/questions/43639708/xlpasteall-is-changing-a-fixed-criteria/43639798#43639798", "title": "xlPasteAll is changing a fixed criteria", "body": "<p>You can use <code>$</code> in front of the row or column that should not change, and set all formulas at once:</p>\n\n<pre><code>Range(\"G2:G\" &amp; x).Formula = \"=VLOOKUP(H2,Start!A$2:B$9,2)\"\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 3070873, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/c8e46e3b1dd6d7b75acfe2e4ffcdc62a?s=128&d=identicon&r=PG&f=1", "display_name": "RickyD", "link": "https://stackoverflow.com/users/3070873/rickyd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 239, "favorite_count": 0, "closed_date": 1493225343, "accepted_answer_id": 43639798, "answer_count": 1, "score": -1, "last_activity_date": 1493224139, "creation_date": 1493223810, "question_id": 43639708, "link": "https://stackoverflow.com/questions/43639708/xlpasteall-is-changing-a-fixed-criteria", "closed_reason": "Duplicate", "title": "xlPasteAll is changing a fixed criteria", "body": "<p>Using VBA, I've created a new column and populating it with VLOOKUP to a range in another worksheet.</p>\n\n<p>H2 is a code, and 'Start!A2' is the code, and 'Start!B2' is the corresponding column/value I want.</p>\n\n<pre><code>Range(\"G2\").Formula = \"=VLOOKUP(H2,Start!A2:B9,2)\"\nRange(\"G2\").Copy\nRange(\"G2:G\" &amp; x).PasteSpecial (xlPasteAll)\n</code></pre>\n\n<p>My problem is that the range part of my formula adjusts along with the criteria.</p>\n\n<p>I want the range (Start!A2:B9) to remain static when I paste the formula.</p>\n\n<p>How do I do this?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7926636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f33cf77a1aca1a4acd7b396526e5b908?s=128&d=identicon&r=PG&f=1", "display_name": "user7926636", "link": "https://stackoverflow.com/users/7926636/user7926636"}, "edited": false, "score": 0, "creation_date": 1493225811, "post_id": 43639895, "comment_id": 74328838, "body": "This worked!  The issue was that while I assumed the email only had 1 attachment, the senders email signature had a small picture in it.  The script was saving the attachment as name.xls first, then overwriting it with the picture second.  What do you mean by validation and how would you filter it in such a way that it only downloaded excel file attachments?"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "reply_to_user": {"reputation": 3, "user_id": 7926636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f33cf77a1aca1a4acd7b396526e5b908?s=128&d=identicon&r=PG&f=1", "display_name": "user7926636", "link": "https://stackoverflow.com/users/7926636/user7926636"}, "edited": false, "score": 0, "creation_date": 1493226484, "post_id": 43639895, "comment_id": 74329246, "body": "@user7926636 Use case select to save only specific file type see <a href=\"http://stackoverflow.com/a/43180639/4539709\">stackoverflow.com/a/43180639/4539709</a>"}], "tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": true, "score": 1, "last_activity_date": 1493224421, "creation_date": 1493224421, "answer_id": 43639895, "question_id": 43639596, "link": "https://stackoverflow.com/questions/43639596/saving-and-renaming-an-outlook-attachment-with-static-name/43639895#43639895", "title": "Saving and renaming an Outlook attachment with static name", "body": "<p>If there is more than one attachment, your code might replace the Excel attachment with one of the other attachments.</p>\n\n<p>Try something like this, to find out</p>\n\n<pre><code>Public Sub saveAttachtoDisk(itm As Outlook.MailItem)\n     Dim objAtt As Outlook.Attachment\n     Dim saveFolder As String\n     Dim i as Integer\n\n     i=0\n     saveFolder = \"C:\\Users\\acheng\\Desktop\"\n     For Each objAtt In itm.Attachments\n          i = i + 1\n          objAtt.SaveAsFile saveFolder &amp; \"\\name\" &amp; i &amp; \".xls\"\n          Set objAtt = Nothing\n     Next\nEnd Sub\n</code></pre>\n\n<p>You should add some validation here. Assuming that all attachments are Excel files is a big risk.</p>\n"}], "owner": {"reputation": 3, "user_id": 7926636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f33cf77a1aca1a4acd7b396526e5b908?s=128&d=identicon&r=PG&f=1", "display_name": "user7926636", "link": "https://stackoverflow.com/users/7926636/user7926636"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3125, "favorite_count": 1, "accepted_answer_id": 43639895, "answer_count": 1, "score": 0, "last_activity_date": 1593387537, "creation_date": 1493223446, "last_edit_date": 1593387537, "question_id": 43639596, "link": "https://stackoverflow.com/questions/43639596/saving-and-renaming-an-outlook-attachment-with-static-name", "title": "Saving and renaming an Outlook attachment with static name", "body": "<p>I have this code which saves an attachment to a specific place and renames it to \"name.xls\"</p>\n\n<pre><code>Public Sub saveAttachtoDisk(itm As Outlook.MailItem)\nDim objAtt As Outlook.Attachment\nDim saveFolder As String\nsaveFolder = \"C:\\Users\\acheng\\Desktop\"\n     For Each objAtt In itm.Attachments\n          objAtt.SaveAsFile saveFolder &amp; \"\\name.xls\"\n          Set objAtt = Nothing\n     Next\nEnd Sub\n</code></pre>\n\n<p>A user did something very similar in this thread with .csv files: </p>\n\n<p><a href=\"https://stackoverflow.com/questions/24244636/vba-outlook-rename-attachments-and-save-to-folder\">VBA Outlook - Rename attachments and save to folder</a></p>\n\n<p>I did the same thing, except with a .xls file.  </p>\n\n<p>My script saves and renames the file, but when I try to open the file it says: \"'name.xls' is in a different format than specified by the file extension. Verify that it is not corrupt...\"</p>\n\n<p>Once I hit Yes and it opens, all the data is in weird symbols.  If I replace &amp; '\\name.xls' with '&amp; objAtt.DisplayName' it will properly save the file with it's original name.  </p>\n\n<p>I have double checked that this is a .xls file. Figuring out something more universal (so that the same script works for .xls .xlsx and .xlsm) would also be hugely helpful, but not as big a priority.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 4, "creation_date": 1493223503, "post_id": 43639582, "comment_id": 74327472, "body": "<code>I am attempting to use VBA</code> please include that attempted code in the original post using edit."}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1493229197, "post_id": 43639582, "comment_id": 74330781, "body": "@Jeeped not an exact duplicate because the autofill end is different on each row"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1493229403, "post_id": 43639582, "comment_id": 74330896, "body": "@Slai - The term <b>exact duplicate</b> is misleading. The original should resolve the basic issue of the question marked as duplicate, nothing more. If adding a loop to go through the rows and determine the last column with a value is going to present another problem, then it is a secondary problem and deserves its own question."}], "answers": [{"tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": false, "score": 2, "last_activity_date": 1493230782, "creation_date": 1493230782, "answer_id": 43641737, "question_id": 43639582, "link": "https://stackoverflow.com/questions/43639582/excel-vba-fill-in-cells-between-1st-and-last-value/43641737#43641737", "title": "Excel - VBA fill in cells between 1st and Last value", "body": "<p>You may try something like this...</p>\n\n<pre><code>Sub FillBlanks()\nDim r As Long, lr As Long, lc As Long\nDim cell As Range, FirstCell As Range, LastCell As Range\nlr = Cells(Rows.Count, 1).End(xlUp).Row\nlc = Cells(2, Columns.Count).End(xlToLeft).Column\nFor r = 3 To lr\n    Set FirstCell = Range(Cells(r, 1), Cells(r, lc)).Find(what:=\"*\", after:=Cells(r, 1))\n    If Not FirstCell Is Nothing And FirstCell.Column &gt; 1 Then\n        Set LastCell = Cells(r, Columns.Count).End(xlToLeft)\n        Range(FirstCell, LastCell).SpecialCells(xlCellTypeBlanks).FormulaR1C1 = \"=RC[-1]\"\n        Range(FirstCell, LastCell).Value = Range(FirstCell, LastCell).Value\n    End If\nNext r\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1493231654, "creation_date": 1493231654, "answer_id": 43642023, "question_id": 43639582, "link": "https://stackoverflow.com/questions/43639582/excel-vba-fill-in-cells-between-1st-and-last-value/43642023#43642023", "title": "Excel - VBA fill in cells between 1st and Last value", "body": "<p>Here is one possible that meets your sample data's expectations.</p>\n\n<pre><code>Sub wqewqwew()\n    Dim i As Long, fc As Variant, lc As Long\n\n    'necessary if you do not want to confirm numbers and blanks in any row\n    On Error Resume Next\n\n    With ThisWorkbook.Worksheets(\"Sheet6\")\n        For i = 3 To .Cells(.Rows.Count, \"A\").End(xlUp).Row\n            If CBool(Application.Count(Rows(i))) Then\n                fc = Intersect(.Rows(i), .UsedRange).Offset(0, 1).SpecialCells(xlCellTypeConstants, xlNumbers).Cells(1).Column\n                If Not IsError(fc) Then\n                    lc = Application.Match(9 ^ 99, .Rows(i))\n                    On Error Resume Next\n                    With .Range(.Cells(i, fc), .Cells(i, lc))\n                        .SpecialCells(xlCellTypeBlanks).Cells.FormulaR1C1 = \"=RC[-1]\"\n                        .Value = .Value2\n                    End With\n                End If\n            End If\n        Next i\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": true, "score": 0, "last_activity_date": 1493234464, "last_edit_date": 1493234464, "creation_date": 1493232981, "answer_id": 43642403, "question_id": 43639582, "link": "https://stackoverflow.com/questions/43639582/excel-vba-fill-in-cells-between-1st-and-last-value/43642403#43642403", "title": "Excel - VBA fill in cells between 1st and Last value", "body": "<p>And here is yet another solution (just to give you some variety):</p>\n\n<pre><code>Option Explicit\n\nSub fillInTheBlanks()\n\nDim lngRow As Long\nDim ws As Worksheet\nDim lngColumn As Long\nDim bolStart As Boolean\nDim lngLastColumn As Long\nDim dblTempValue As Double\nDim arrSheetCopy As Variant\n\nSet ws = ThisWorkbook.Worksheets(\"Sheet1\")\narrSheetCopy = ws.Range(ws.Cells(3, 1), ws.Cells(ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row, ws.UsedRange.Columns.Count)).Value2\n\nFor lngRow = LBound(arrSheetCopy, 1) To UBound(arrSheetCopy, 1)\n    bolStart = False\n    lngLastColumn = 0\n    For lngColumn = LBound(arrSheetCopy, 2) To UBound(arrSheetCopy, 2)\n        If Not arrSheetCopy(lngRow, lngColumn) = vbEmpty Then lngLastColumn = lngColumn\n    Next lngColumn\n    For lngColumn = LBound(arrSheetCopy, 2) To lngLastColumn\n        If arrSheetCopy(lngRow, lngColumn) = vbEmpty And bolStart Then\n            arrSheetCopy(lngRow, lngColumn) = dblTempValue\n        Else\n            If Not arrSheetCopy(lngRow, lngColumn) = vbEmpty And IsNumeric(arrSheetCopy(lngRow, lngColumn)) Then\n                bolStart = True\n                dblTempValue = CDbl(arrSheetCopy(lngRow, lngColumn))\n            End If\n        End If\n    Next lngColumn\nNext lngRow\n\nws.Range(\"A3\").Resize(UBound(arrSheetCopy, 1), UBound(arrSheetCopy, 2)).Value2 = arrSheetCopy\n\nEnd Sub\n</code></pre>\n\n<p>This one is probably the fastest solution (even though it seems a bit bulky with much more lines of code when compared to the other solutions). That's due to the fact that this solution is doing most of the work in memory and not on the sheet. The entire sheet is loaded into a variable and then the work is done on the variable before the result (the variable) is written back to the sheet. So, if you have a speed problem then you might want to consider using this solution.</p>\n"}, {"tags": [], "owner": {"reputation": 326, "user_id": 7906655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba759bed6d17f704d40bc4fd96198298?s=128&d=identicon&r=PG&f=1", "display_name": "mangupt", "link": "https://stackoverflow.com/users/7906655/mangupt"}, "is_accepted": false, "score": 0, "last_activity_date": 1493264934, "creation_date": 1493264934, "answer_id": 43648326, "question_id": 43639582, "link": "https://stackoverflow.com/questions/43639582/excel-vba-fill-in-cells-between-1st-and-last-value/43648326#43648326", "title": "Excel - VBA fill in cells between 1st and Last value", "body": "<p>Just another solution:</p>\n\n<p>The following code can help is there you need to auto-fill the previous values between 1st and last cells depending on value of 1st cell as mentioned in question Excel - VBA fill in cells between 1st and Last value</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    Dim i As Long\n    For i = 2 To Target.Column\n        If Cells(Target.Row, i) = \"\" Then\n            If Cells(Target.Row, i - 1) &lt;&gt; \"\" Then\n                Range(Cells(Target.Row, i), Cells(Target.Row, i)).Value = Range(Cells(Target.Row, i - 1), Cells(Target.Row, i - 1)).Value\n            End If\n        End If\n    Next i\nEnd Sub\n</code></pre>\n\n<p>This sub is activated by clicking on any cell. Same cell marks the end of the loop i.e. to stop the loop just click the cell till which you want to fill the blank cells.</p>\n"}], "owner": {"reputation": 25, "user_id": 7926606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d903dca8ba6904dd88dd33f2145366e7?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/7926606/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1866, "favorite_count": 0, "accepted_answer_id": 43642403, "answer_count": 4, "score": 1, "last_activity_date": 1493264934, "creation_date": 1493223400, "last_edit_date": 1495541870, "question_id": 43639582, "link": "https://stackoverflow.com/questions/43639582/excel-vba-fill-in-cells-between-1st-and-last-value", "title": "Excel - VBA fill in cells between 1st and Last value", "body": "<p>I am attempting to use VBA to fill all blank cells in rows with the value to the left, with the exception that I only want to fill the blank cells between the first and last value in the row (not including row 1 and column A, which are identifiers).</p>\n\n<p>I've struggled with getting the loop to stop once the last column with a value has been reached (as this changes with each row), rather than running all the way through the last column on the sheet.</p>\n\n<p>Originally this was marked as duplicate (<a href=\"https://stackoverflow.com/questions/36157561/autofill-when-there-are-blank-values\">Autofill when there are blank values</a>), but this does not solve the mentioned problem. This continues until the sheet ends. As seen in the picture below, the fill should stop when the last value is reached. </p>\n\n<p>I am searching for a solution that will allow me to do this for an entire sheet at once, even though the data ends in different columns throughout the sheet. There are 1000+ rows, so running for each row could be quite tedious.</p>\n\n<p>I've been using this code to fill the data (excluding the 1st row and column). But this is where I am not sure how to get it to stop at the last value in the row.</p>\n\n<pre><code>Sub test()\nWith ThisWorkbook.Sheets(\"Sheet1\").Range(\"A:A\")\n    With Range(.Cells(2, 2), .Cells(.Rows.Count, 36).End(xlUp))\n        With .Offset(0, 1)\n            .Value = .Value\n            On Error Resume Next\n            .SpecialCells(xlCellTypeBlanks).FormulaR1C1 = \"=RC[-1]&amp;\"\"\"\"\"\n            On Error GoTo 0\n            .Value = .Value\n        End With\n    End With\nEnd With\nEnd Sub\n</code></pre>\n\n<p>If my explanation was not clear, This is a sample and the output I am trying to create\n<a href=\"https://i.stack.imgur.com/2iMu9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2iMu9.png\" alt=\"\"></a></p>\n\n<p>Thank you all so much in advance for all your help!</p>\n"}, {"tags": ["ms-access", "internet-explorer", "vba"], "comments": [{"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1493225880, "post_id": 43639337, "comment_id": 74328881, "body": "What is in the <code>Nome</code> and how the <code>IdentificadorElementoHTML </code> is implemented?"}, {"owner": {"reputation": 552, "user_id": 5593502, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/128da5d9d241c75f44a9ba3a1a212641?s=128&d=identicon&r=PG&f=1", "display_name": "tdmsoares", "link": "https://stackoverflow.com/users/5593502/tdmsoares"}, "reply_to_user": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1493229227, "post_id": 43639337, "comment_id": 74330797, "body": "@dee IdentificadorElementoHTML is an Enum that holds some elements, among them Nome (representing an Integer. The purpose is to add more flexibility in code. If the value is Nome, the element is gotten by its name, if the value is Id, the element is gotten by its Id, and so on... It only depends the webpage element identifier..."}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1493231477, "post_id": 43639337, "comment_id": 74332204, "body": "I see, so when I test your code with the given HTML it works fine for <code>Usuario</code> and for <code>Senha</code> names. What value is in <code>loginInputUsu&#225;rio_Name</code> and in <code>loginInputSenha_Name</code>?"}, {"owner": {"reputation": 552, "user_id": 5593502, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/128da5d9d241c75f44a9ba3a1a212641?s=128&d=identicon&r=PG&f=1", "display_name": "tdmsoares", "link": "https://stackoverflow.com/users/5593502/tdmsoares"}, "reply_to_user": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1493232507, "post_id": 43639337, "comment_id": 74332778, "body": "@dee I just edited the code with the constants used in functions. <code>loginInputUsu&#225;rio_Name</code> stands for the Name of element <code>Usuario</code> and <code>loginInputSenha_Name</code> represents the name of html element <code>Senha</code>"}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1493233450, "post_id": 43639337, "comment_id": 74333347, "body": "Well yes, that works. So the code works, the problem could be, that the HTML content you expect to be there is not there when you try to find the input elements. Are you sure, the URL is correct? Are you sure the page is fully loaded? Do you see the page with the inputs on the screen after the code after <code>&#39;Wait for page to load</code> has finished?"}, {"owner": {"reputation": 552, "user_id": 5593502, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/128da5d9d241c75f44a9ba3a1a212641?s=128&d=identicon&r=PG&f=1", "display_name": "tdmsoares", "link": "https://stackoverflow.com/users/5593502/tdmsoares"}, "reply_to_user": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1493234387, "post_id": 43639337, "comment_id": 74333901, "body": "@dee I put a breakpoint for debug on <code>Set iePage = ieApp.Document</code>, the page was fully loaded on IE and typing F12 in IE, the elements are in the code showed by the browser. The URL is &quot;<a href=\"https://gdaenet.edunet.sp.gov.br/index.html\" rel=\"nofollow noreferrer\">gdaenet.edunet.sp.gov.br/index.html</a>&quot; . Is this problem caused because this is a https website?"}], "answers": [{"comments": [{"owner": {"reputation": 552, "user_id": 5593502, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/128da5d9d241c75f44a9ba3a1a212641?s=128&d=identicon&r=PG&f=1", "display_name": "tdmsoares", "link": "https://stackoverflow.com/users/5593502/tdmsoares"}, "edited": false, "score": 0, "creation_date": 1493299043, "post_id": 43645551, "comment_id": 74365167, "body": "Man, you&#39;re great! I didn&#39;t realize there was a frame in that! Thank you!"}], "tags": [], "owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "is_accepted": true, "score": 1, "last_activity_date": 1493246084, "last_edit_date": 1493246084, "creation_date": 1493245728, "answer_id": 43645551, "question_id": 43639337, "link": "https://stackoverflow.com/questions/43639337/vba-internet-explorer-not-able-to-fill-a-webform/43645551#43645551", "title": "VBA Internet Explorer: Not able to fill a WebForm", "body": "<p>The URL provided in the last comment shows the problem. The login form is placed inside of an <code>IFrame</code> therefore the current document doesn't know about the elements because they are not there.</p>\n\n<p>You should slightly modify your code so the document of the <code>IFrame</code> is used for search.</p>\n\n<pre><code>Set iePage = ieApp.document\n\nDim fr As HTMLIFrame\nSet fr = iePage.frames(\"aplicativos\")\n\nDim iframeDoc As HTMLDocument\nSet iframeDoc = iePage.frames(\"aplicativos\").document\n\nfillInputObject iframeDoc, loginSelectSistema_Name, \"jcaa\"\nfillInputObject iframeDoc, loginInputUsu\u00e1rio_Name, USERNAME\nfillInputObject iframeDoc, loginInputSenha_Name, PASSWORD\n\niframeDoc.all.Item(loginInputOk_Name).Click\n</code></pre>\n\n<p>And modify the function <code>fillInputObject</code> so it uses the right <code>Document</code> object.</p>\n\n<pre><code>Private Sub fillInputObject(doc As HTMLDocument, ByVal objectName As String, ByVal Value As String, Optional IdentificadorElemento As IdentificadorElementoHTML = Nome)\n'\n'Preenche o Objeto Input com um determinado valor\n    Dim elementHTML As HTMLObjectElement\n    '\n    If (IdentificadorElemento = Nome) Then\n        Set elementHTML = doc.getElementsByName(objectName).Item\n    End If\n    '\n    If (IdentificadorElemento = ID) Then\n        Set elementHTML = doc.getElementById(objectName)\n    End If\n    '\n    If (IsObject(elementHTML)) Then\n        If (Not (elementHTML Is Nothing)) Then\n            elementHTML.Value = Value\n        End If\n    End If\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/Rn2WY.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Rn2WY.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 552, "user_id": 5593502, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/128da5d9d241c75f44a9ba3a1a212641?s=128&d=identicon&r=PG&f=1", "display_name": "tdmsoares", "link": "https://stackoverflow.com/users/5593502/tdmsoares"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 43645551, "answer_count": 1, "score": 1, "last_activity_date": 1594651152, "creation_date": 1493222698, "last_edit_date": 1594651152, "question_id": 43639337, "link": "https://stackoverflow.com/questions/43639337/vba-internet-explorer-not-able-to-fill-a-webform", "title": "VBA Internet Explorer: Not able to fill a WebForm", "body": "<p>I have the following code to fill a webform, but in this particular website the code is not working:</p>\n\n<pre><code>Const loginSelectSistema_Name = \"url\"\nConst loginInputUsu\u00e1rio_Name = \"Usuario\"\nConst loginInputSenha_Name = \"Senha\"\nConst loginInputOk_Name = \"imageField2\"\n\nConst USERNAME = \"NomeUsu\u00e1rio\"\nConst PASSWORD = \"SenhaAcesso\"\n\nDim ieApp As InternetExplorer\nDim iePage As HTMLDocument\n\nFunction loginPage()\n    '\n    Set ieApp = New InternetExplorer\n    '\n    ieApp.Visible = True\n    ieApp.navigate (loginWebsite)\n    '\n    'Wait for page to load\n    Do Until ieApp.ReadyState = READYSTATE_COMPLETE\n    Loop\n    '\n    '\n    Set iePage = ieApp.Document\n    '\n    fillInputObject loginSelectSistema_Name, \"jcaa\"\n    fillInputObject loginInputUsu\u00e1rio_Name, USERNAME\n    fillInputObject loginInputSenha_Name, PASSWORD\n    '\n    iePage.all.Item(loginInputOk_Name).Click\nEnd Function\n\nPrivate Sub fillInputObject(ByVal objectName As String, ByVal value As String, Optional IdentificadorElemento As IdentificadorElementoHTML = Nome)\n'\n'Preenche o Objeto Input com um determinado valor\n    Dim elementHTML As HTMLObjectElement\n    '\n    If (IdentificadorElemento = Nome) Then\n        Set elementHTML = iePage.getElementsByName(objectName).Item\n    End If\n    '\n    If (IdentificadorElemento = Id) Then\n        Set elementHTML = iePage.getElementById(objectName)\n    End If\n    '\n    If (IsObject(elementHTML)) Then\n        If (Not (elementHTML Is Nothing)) Then\n            elementHTML.value = value\n        End If\n    End If\nEnd Sub\n</code></pre>\n\n<p>When debugging, in Function <code>fillInputObject</code> the line: <code>If (Not (elementHTML Is Nothing)) Then</code> the value is always <em>Nothing</em>, and the webform is not filled.</p>\n\n<p>Below is the page in HTML that I trying to fill the webform:</p>\n\n<pre><code>&lt;table width=\"90%\" cellspacing=\"0\" cellpadding=\"0\" bordercolor=\"#DADADA\" border=\"1\" bgcolor=\"#F7F7F8\" align=\"center\" height=\"110\"&gt;\n    &lt;tbody&gt;&lt;tr height=\"2\"&gt;&lt;td width=\"62\"&gt;&lt;/td&gt;&lt;td width=\"0\"&gt;&lt;/td&gt;&lt;td width=\"592\"&gt;&lt;/td&gt;&lt;td width=\"223\"&gt;&lt;/td&gt;&lt;/tr&gt;\n          &lt;tr height=\"15\"&gt;\n             &lt;td colspan=\"4\" bordercolor=\"#F7F7F8\" style=\"vertical-align:left\"&gt;&lt;strong&gt;Selecione o Sistema:&lt;/strong&gt;&lt;/td&gt;\n          &lt;/tr&gt;\n          &lt;tr height=\"15\"&gt;\n             &lt;td colspan=\"4\" bordercolor=\"#F7F7F8\" style=\"vertical-align:left\"&gt;\n                &lt;font size=\"1px\" face=\"Verdana, Arial, Helvetica, sans-serif\"&gt;\n               &lt;select name=\"url\" class=\"combobox\" style=\"width:180px;\"&gt;\n\n                 &lt;option value=\"jcaa\"&gt;Cadastro de Alunos&lt;/option&gt;\n                 &lt;option value=\"paef\"&gt;Cadastro Funcional&lt;/option&gt;\n                 &lt;option value=\"paec\"&gt;Controle de Freq\u00fc\u00eancia&lt;/option&gt;\n                 &lt;option value=\"papc\"&gt;Desp de Pessoal (SDPE)&lt;/option&gt;\n\n                 &lt;option value=\"jcgo\"&gt;Cargos&lt;/option&gt;\n                 &lt;option value=\"paea\"&gt;Contagem de Tempo&lt;/option&gt;\n                 &lt;option value=\"jata\"&gt;Forma\u00e7\u00e3o Curricular&lt;/option&gt;\n                 &lt;option value=\"jrha\"&gt;Gratifica\u00e7\u00e3o / Promo\u00e7\u00e3o QM&lt;/option&gt;\n                 &lt;option value=\"paex\"&gt;PAEX - Cadastro Funcional&lt;/option&gt;\n               &lt;/select&gt;\n             &lt;/font&gt;\n             &lt;/td&gt;\n          &lt;/tr&gt;\n            &lt;tr height=\"2\"&gt;&lt;td colspan=\"4\" bordercolor=\"#F7F7F8\"&gt;&lt;/td&gt;&lt;/tr&gt;\n            &lt;tr&gt;&lt;td colspan=\"2\" bordercolor=\"#F7F7F8\" align=\"left\"&gt;\n                    &lt;font size=\"1\" face=\"Verdana, Arial, Helvetica, sans-serif\"&gt;\n                        Usu\u00e1rio\n                    &lt;/font&gt;\n                &lt;/td&gt;\n                &lt;td colspan=\"2\" bordercolor=\"#F7F7F8\" align=\"left\"&gt;\n                    &lt;input id=\"Usuario\" name=\"Usuario\" size=\"10\" maxlength=\"10\" value=\"SE0452336A\" type=\"text\"&gt;\n                &lt;/td&gt;&lt;/tr&gt;\n            &lt;tr&gt;&lt;td colspan=\"2\" bordercolor=\"#F7F7F8\" align=\"left\"&gt;\n                    &lt;font size=\"1\" face=\"Verdana, Arial, Helvetica, sans-serif\"&gt;\n                    Senha\n                    &lt;/font&gt;\n                &lt;/td&gt;\n                &lt;td colspan=\"2\" bordercolor=\"#F7F7F8\" align=\"left\"&gt;\n                    &lt;input id=\"Senha\" name=\"Senha\" size=\"14\" maxlength=\"14\" type=\"password\"&gt;\n                &lt;/td&gt;&lt;/tr&gt;\n            &lt;tr&gt;\n                &lt;td colspan=\"2\" bordercolor=\"#F7F7F8\" align=\"left\"&gt;\n                    &lt;font size=\"1\" face=\"Verdana, Arial, Helvetica, sans-serif\"&gt;&amp;nbsp;\n\n                    &lt;/font&gt;\n                &lt;/td&gt;\n                &lt;td colspan=\"2\" bordercolor=\"#F7F7F8\" align=\"left\"&gt;\n                    &lt;input name=\"imageField2\" src=\"images/ok_sen.gif\" width=\"24\" type=\"image\" border=\"0\" height=\"17\"&gt;\n                &lt;/td&gt;&lt;/tr&gt;\n\n        &lt;/tbody&gt;&lt;/table&gt;\n</code></pre>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["vba", "internet-explorer", "xmlhttprequest", "msxml2"], "comments": [{"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 1, "creation_date": 1493223405, "post_id": 43639286, "comment_id": 74327407, "body": "You can have a look at my answer <a href=\"http://stackoverflow.com/questions/43596731/click-js-button-with-vba-when-the-button-has-no-name-id/43597210#43597210\">here</a> to see the usage of MSXML2.XMLHTTP. You can easily convert your code into MSXML2.XMLHTTP with it."}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1493230703, "post_id": 43639286, "comment_id": 74331711, "body": "Web-scraping with XHR allows to achieve higher performance using no DOM methods, thus it significantly differs from IE automation. Especially for AJAX / DHTML."}], "owner": {"reputation": 1, "user_id": 7902214, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa760bc48594f255ca07f1cc694c8aa7?s=128&d=identicon&r=PG&f=1", "display_name": "P McC", "link": "https://stackoverflow.com/users/7902214/p-mcc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1371, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1493222585, "creation_date": 1493222585, "question_id": 43639286, "link": "https://stackoverflow.com/questions/43639286/how-to-speed-up-vba-web-scraper-by-using-msxml2-xmlhttp-instead-of-internetexplo", "title": "How to speed up VBA web scraper by using MSXML2.XMLHTTP instead of InternetExplorer.Application", "body": "<p>I've just started learning VBA a couple of weeks ago so i apologise if my work has any obvious errors. I've written some code that successfully scrapes data from tables on a website, the problem is that it runs very slowly. I am aware that using internetexplorer.application is quite a slow way to scrape websites and that a quicker way is to use MSXML2.XMLHTTP.</p>\n\n<p>So i'm trying to convert my current code to use MSXML2.XMLHTTP instead of internetexplorer.application but i seem to be making a mess of it. I've searched through quite a lot of questions but i seem to be having issues using things like .getElementsByTagName. </p>\n\n<p>Here's my internetexplorer.application code that i want to convert to MSXML2.XMLHTTP</p>\n\n<pre><code>Sub macro6()\n\nDim internet As InternetExplorer\n\nDim internetdata As HTMLDocument\n\nDim internetlink As Object\nDim bbb As Long\nDim internetinnerlink As Object\nDim LR As Long\n    LR = Sheets(\"Sheet1\").Range(\"C\" &amp; Rows.Count).End(xlUp).Row\nDim LR2 As Long\n    LR2 = Sheets(\"Sheet1\").Range(\"H\" &amp; Rows.Count).End(xlUp).Row + 1\nDim LC As Long\n    LC = Sheets(\"Sheet1\").Cells(2, Columns.Count).End(xlToLeft).Column + 1\nDim y As Long\n\n\nFor bbb = 1 To (LR - 1)\nSet internet = CreateObject(\"InternetExplorer.Application\")\n\n\ninternet.Visible = False\n\ninternet.navigate (\"http://data.nowgoal.com/3in1odds/31_\" &amp; Sheets(\"Sheet1\").Range(\"c1\").Offset(bbb, 0)) &amp; \".html\"\n\nDo While internet.Busy\n\n  DoEvents\n\nLoop\n\nDo Until internet.READYSTATE = READYSTATE_COMPLETE\n\n  DoEvents\n\nLoop\n\nSet internetdata = internet.document\nFor y = 2 To 4\n\nhg_blue = internetdata.getElementsByTagName(\"tbody\")(y).getElementsByClassName(\"hg_blue\").Length + 1\nhg_red = internetdata.getElementsByTagName(\"tbody\")(y).getElementsByClassName(\"hg_red\").Length\nhg_green = internetdata.getElementsByTagName(\"tbody\")(y).getElementsByClassName(\"hg_green\").Length\n\nxx = hg_blue + 1\nyy = hg_blue + hg_red\nzz = hg_blue + hg_red + hg_green\n\nIf zz &gt; 1 Then\n\n    Set internetlink = internetdata.getElementsByTagName(\"tbody\")(y).getElementsByTagName(\"tr\")(xx).getElementsByTagName(\"td\")\n    Set internetlink2 = internetdata.getElementsByTagName(\"tbody\")(y).getElementsByTagName(\"tr\")(yy).getElementsByTagName(\"td\")\n    Set internetlink3 = internetdata.getElementsByTagName(\"tbody\")(y).getElementsByTagName(\"tr\")(zz).getElementsByTagName(\"td\")\n\n\n    For Each internetinnerlink In internetlink\n    Sheets(\"Sheet1\").Cells(LR2, LC) = internetinnerlink.innerText\n\n    LC = LC + 1\n    Next internetinnerlink\n\n\n    For Each internetinnerlink In internetlink2\n    Sheets(\"Sheet1\").Cells(LR2, LC) = internetinnerlink.innerText\n\n    LC = LC + 1\n    Next internetinnerlink\n\n\n    For Each internetinnerlink In internetlink3\n    Sheets(\"Sheet1\").Cells(LR2, LC) = internetinnerlink.innerText\n\n    LC = LC + 1\n    Next internetinnerlink\n\nElse\n\n    Set internetlink = internetdata.getElementsByTagName(\"tbody\")(y).getElementsByTagName(\"tr\")(1).getElementsByTagName(\"td\")\n    Set internetlink2 = internetdata.getElementsByTagName(\"tbody\")(y).getElementsByTagName(\"tr\")(1).getElementsByTagName(\"td\")\n    Set internetlink3 = internetdata.getElementsByTagName(\"tbody\")(y).getElementsByTagName(\"tr\")(1).getElementsByTagName(\"td\")\n\n\n    For Each internetinnerlink In internetlink\n    Sheets(\"Sheet1\").Cells(LR2, LC) = \"\"\n\n    LC = LC + 1\n    Next internetinnerlink\n\n\n    For Each internetinnerlink In internetlink2\n    Sheets(\"Sheet1\").Cells(LR2, LC) = \"\"\n\n    LC = LC + 1\n    Next internetinnerlink\n\n\n    For Each internetinnerlink In internetlink3\n    Sheets(\"Sheet1\").Cells(LR2, LC) = \"\"\n\n    LC = LC + 1\n    Next internetinnerlink\n\nEnd If\n\nNext y\nLR2 = LR2 + 1\nLC = Sheets(\"Sheet1\").Cells(LR2, Columns.Count).End(xlToLeft).Column + 1\n\ninternet.Quit\nNext bbb\n\n\nEnd Sub\n</code></pre>\n\n<p>The data in column C are numbers 1274444 in C2, 1274445 in C3, 1274446 in C4 etc.</p>\n\n<p>Is it easier just to start from scratch and write the code again or are there simple changes i can make? Thank you for any help.</p>\n"}, {"tags": ["excel", "computational-geometry", "vba"], "comments": [{"owner": {"reputation": 6498, "user_id": 1004168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c05e808436031bc45a7620adc236e3d?s=128&d=identicon&r=PG", "display_name": "agentp", "link": "https://stackoverflow.com/users/1004168/agentp"}, "edited": false, "score": 1, "creation_date": 1493222731, "post_id": 43639162, "comment_id": 74326943, "body": "deleted mathematica tag. If you think it belongs you should say why."}, {"owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "edited": false, "score": 0, "creation_date": 1493230637, "post_id": 43639162, "comment_id": 74331665, "body": "Seems more appropriate for CodeReview than StackOverflow."}, {"owner": {"reputation": 1, "user_id": 7926505, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TyoJbUu7Zkc/AAAAAAAAAAI/AAAAAAAAALU/kLUpfgqMAg8/photo.jpg?sz=128", "display_name": "EmilyQ", "link": "https://stackoverflow.com/users/7926505/emilyq"}, "edited": false, "score": 0, "creation_date": 1493328287, "post_id": 43639162, "comment_id": 74383217, "body": "Duly noted. Was not aware of it. Thank you xidgel!"}], "answers": [{"tags": [], "owner": {"reputation": 65718, "user_id": 844416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e39c2364935265593d76247ddc6d07c?s=128&d=identicon&r=PG", "display_name": "MBo", "link": "https://stackoverflow.com/users/844416/mbo"}, "is_accepted": false, "score": 0, "last_activity_date": 1493274957, "last_edit_date": 1493274957, "creation_date": 1493274311, "answer_id": 43650091, "question_id": 43639162, "link": "https://stackoverflow.com/questions/43639162/does-a-line-intersect-a-polygon/43650091#43650091", "title": "Does a line intersect a polygon?", "body": "<p>Check whether all polygon vertices lie in the same semi-plane (left or right) relative to the given line using <a href=\"https://en.wikipedia.org/wiki/Cross_product\" rel=\"nofollow noreferrer\">cross product</a>. If yes, line does not intersect polygon.</p>\n\n<pre><code>Side = Sign(CrossProduct(L2-L1, P[i] - L1))\nwhere L1, L2 are points defining the line, P[i] is i-th polygon vertex\n</code></pre>\n\n<p>Algorithm works in linear time O(N) where N is polygon vertex count. Note that for convex polygons result might be deduced in O(logN) time using binary search.</p>\n"}], "owner": {"reputation": 1, "user_id": 7926505, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TyoJbUu7Zkc/AAAAAAAAAAI/AAAAAAAAALU/kLUpfgqMAg8/photo.jpg?sz=128", "display_name": "EmilyQ", "link": "https://stackoverflow.com/users/7926505/emilyq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 284, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1493274957, "creation_date": 1493222188, "last_edit_date": 1531161705, "question_id": 43639162, "link": "https://stackoverflow.com/questions/43639162/does-a-line-intersect-a-polygon", "title": "Does a line intersect a polygon?", "body": "<p>I re-purposed sijipie's code here: <a href=\"https://www.mrexcel.com/forum/excel-questions/713005-does-point-fall-within-polygon-visual-basic-applications-function.html\" rel=\"nofollow noreferrer\">https://www.mrexcel.com/forum/excel-questions/713005-does-point-fall-within-polygon-visual-basic-applications-function.html</a></p>\n\n<p>What I need to do is to decide if a line is within a polygon.</p>\n\n<p>Admittedly, this is a bit lazy as I don't test the intersection of the line with every single side, as I iterate the midpoints of the line and test them for being an interior point. </p>\n\n<p>I was wondering if there's a faster way to do this. </p>\n\n<p>VBA Code below:</p>\n\n<pre><code>Function PolyLineIntersect(lXY As Range, polyXY As Range) As Boolean\n    Dim i As Integer, j As Integer, a As Integer, polySides As Integer\n    Dim Result As Boolean\n    Dim x As Double, y As Double\n    Dim aXY As Variant\n    Dim mXY(1 To 5, 1 To 2) As Integer\n    Dim tXY(1 To 5) As Boolean\n\n    x = lXY.Cells.value2(1, 1)\n    y = lXY.Cells.value2(1, 2)\n    xb = lXY.Cells.value2(1, 3)\n    yb = lXY.Cells.value2(1, 4)\n\n    mXY(1, 1) = x\n    mXY(1, 2) = y\n    mXY(2, 1) = xb\n    mXY(2, 2) = yb\n    mXY(3, 1) = (xb + x) / 2\n    mXY(3, 2) = (yb + y) / 2\n    mXY(4, 1) = (xb + mx1) / 2\n    mXY(4, 2) = (yb + my1) / 2\n    mXY(5, 1) = (xb + mx1) / 2\n    mXY(5, 2) = (yb + my1) / 2\n\n    Result = False\n\n    aXY = polyXY.Value\n\n    polySides = polyXY.Rows.Count\n    j = polySides - 1\n    For a = 1 To 5                \n      x = mXY(a, 1)\n      y = mXY(a, 2)                \n      For i = 1 To polySides                     \n        If (((aXY(i, 2) &lt; y And aXY(j, 2) &gt;= y) _\n         Or (aXY(j, 2) &lt; y And aXY(i, 2) &gt;= y)) _\n         And (aXY(i, 1) &lt;= x Or aXY(j, 1) &lt;= x)) Then                  \n          Result = Result Xor (aXY(i, 1) + (y - aXY(i, 2)) / (aXY(j, 2) - aXY(i, 2)) * (aXY(j, 1) - aXY(i, 1)) &lt; x)                            \n        End If\n        j = i        \n      Next i\n    Next a\n    PolyLineIntersect = Result\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "export-to-pdf"], "comments": [{"owner": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "edited": false, "score": 0, "creation_date": 1493223207, "post_id": 43639079, "comment_id": 74327273, "body": "Is it the sheet where the code is assigned to? Try to copy the sheet in question and check if that behaviour repeats itself on a different sheet with the same data"}, {"owner": {"reputation": 286, "user_id": 2988534, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xbVwr.jpg?s=128&g=1", "display_name": "legendjr", "link": "https://stackoverflow.com/users/2988534/legendjr"}, "reply_to_user": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "edited": false, "score": 0, "creation_date": 1493226379, "post_id": 43639079, "comment_id": 74329166, "body": "I&#39;ve inserted a new sheet and tried to just copy over the formulas/formats/tables in the sheet, the problem still persists."}, {"owner": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "edited": false, "score": 0, "creation_date": 1493237623, "post_id": 43639079, "comment_id": 74335732, "body": "What do you mean by that? Did your code have the same Problem with the additional sheet, or was the problem still only in the original one?"}, {"owner": {"reputation": 286, "user_id": 2988534, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xbVwr.jpg?s=128&g=1", "display_name": "legendjr", "link": "https://stackoverflow.com/users/2988534/legendjr"}, "reply_to_user": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "edited": false, "score": 0, "creation_date": 1493294317, "post_id": 43639079, "comment_id": 74361446, "body": "it seems the exporting PDF will remove the buttons from view on any screen that isn&#39;t the active screen.  <code>Activesheet.Buttons.Count</code> returns an accurate count though."}, {"owner": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "edited": false, "score": 0, "creation_date": 1493294450, "post_id": 43639079, "comment_id": 74361552, "body": "By <i>active screen</i> you mean <i>active sheet</i>? If so, try to set each sheet active before printing it"}, {"owner": {"reputation": 286, "user_id": 2988534, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xbVwr.jpg?s=128&g=1", "display_name": "legendjr", "link": "https://stackoverflow.com/users/2988534/legendjr"}, "reply_to_user": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "edited": false, "score": 0, "creation_date": 1493294510, "post_id": 43639079, "comment_id": 74361592, "body": "trying to save 6 tabs into one pdf, otherwise I would do that."}, {"owner": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "edited": false, "score": 0, "creation_date": 1493294697, "post_id": 43639079, "comment_id": 74361741, "body": "Are you able to print each sheet separately and get the desired result?"}, {"owner": {"reputation": 286, "user_id": 2988534, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xbVwr.jpg?s=128&g=1", "display_name": "legendjr", "link": "https://stackoverflow.com/users/2988534/legendjr"}, "reply_to_user": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "edited": false, "score": 0, "creation_date": 1493294941, "post_id": 43639079, "comment_id": 74361936, "body": "probably, assuming I set each sheet to be active before i print it.  It looks like the buttons are still in memory somewhere.  Closing excel entirely and re-opening the workbook will bring the buttons back."}, {"owner": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "edited": false, "score": 0, "creation_date": 1493295140, "post_id": 43639079, "comment_id": 74362077, "body": "I see. Try to confirm the sheet by sheet print so that we can close in on the reason of the error."}, {"owner": {"reputation": 286, "user_id": 2988534, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xbVwr.jpg?s=128&g=1", "display_name": "legendjr", "link": "https://stackoverflow.com/users/2988534/legendjr"}, "reply_to_user": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "edited": false, "score": 0, "creation_date": 1493295804, "post_id": 43639079, "comment_id": 74362657, "body": "Ran the loop, was able to print each sheet individually without the buttons going missing.  Also, I tested using a FormControl button vs an ActiveX button, and it did not matter.  I&#39;m not sure if it makes a difference but the buttons are set to no print (print object not selected)."}], "owner": {"reputation": 286, "user_id": 2988534, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xbVwr.jpg?s=128&g=1", "display_name": "legendjr", "link": "https://stackoverflow.com/users/2988534/legendjr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 228, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1524067486, "creation_date": 1493221988, "last_edit_date": 1493296043, "question_id": 43639079, "link": "https://stackoverflow.com/questions/43639079/exportasfixedformat-is-deleting-vba-buttons-on-only-one-sheet", "title": "ExportAsFixedFormat is deleting VBA buttons on only one sheet", "body": "<p>So I have a spreadsheet that gets updated frequently throughout the day. For tracking purposes, I want to export a few of the tabs to a PDF.  Simple enough, just select the sheets I want and used <code>Selection.ExportAsFixedFormat</code>.  For some reason, one of those sheets is getting the VBA buttons on there to disappear.  Any ideas what is going on so I can make this stop?</p>\n\n<p>Some details:</p>\n\n<ul>\n<li>When I go to draw on new buttons, unless I make the size massive (15+ columns and rows large), I can't see a button.  And even then, the button font is huge (despite excel saying it's size 10)</li>\n<li><code>Activesheet.Buttons.Count</code> is returning the correct count</li>\n<li>Looping through all buttons on the sheet, visible property is true</li>\n<li>One other sheet being saved in the pdf has buttons on it, they are unaffected</li>\n<li>Stepping through the debugger one line at a time results in the buttons shrinking, running it flat out makes them tiny</li>\n<li>I've tried to loop through all buttons and make them be a fixed size, no help</li>\n</ul>\n\n<p>Code snippet:</p>\n\n<pre><code>ThisWorkbook.Sheets(PrintSheets()).Select\nActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, _\n    fileName:=path &amp; fileName, _\n    Quality:=xlQualityMinimum, _\n    IncludeDocProperties:=True, _\n    IgnorePrintAreas:=False, _\n    OpenAfterPublish:=False\n</code></pre>\n\n<p>Where <code>PrintSheets()</code> returns an array of sheet names (strings), <code>path</code> and <code>fileName</code> are defined above (strings) in the sub using input boxes.</p>\n\n<p>Edit:  Tried saving the tabs as a pdf manually, the smaller button scenario still happened. Seems to be tied to the saving of the button, not so much my macro code.</p>\n\n<p>Edit 2:  Since the exporting a pdf only removed the buttons from that one sheet, I modified my code to activate that sheet before exporting.  This gives me the error where the buttons get smaller, but still visible.  I then put a loop in my code to resize the buttons before finishing.  While this may be a solution to my exact case, I hope there is a true answer out there for this in all cases.</p>\n\n<p>Edit 3:  Including some of the discussion below.  When I loop through each sheet individually, activate it, and export to pdf, the buttons will stay visible on all sheets that have them.  Closing excel completely and re-opening the workbook will bring the buttons back.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1493221373, "post_id": 43638742, "comment_id": 74325985, "body": "<code>Set c = SrchRng.Find(mymonth &amp; &quot; Sales &quot; &amp; myyear, LookIn:=xlValues)</code>. I think you want the <code>&amp;</code> instead of <code>+</code>.  Also, don&#39;t you need to define which <code>myMonth</code> and <code>myYear</code> you want to search each time? After the split, it&#39;s an array.  But, what are you trying to do? Just Delete a row when ...a certain month/year combo is found?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1493221973, "post_id": 43638742, "comment_id": 74326415, "body": "I tried &quot;&amp;&quot; as well, same error. I&#39;m trying to delete all occurrences, for example, April Sales 2014, October Sales 2016, November Sales 2018, etc. It switches all the time. I am trying to define &quot;mymonth&quot; as ANY month, so should I be defining it as a string? A variant? I tried a couple different combos to no avail"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1493222659, "post_id": 43638742, "comment_id": 74326896, "body": "To be clear - you want to delete rows with <code>January Sales 2014</code>, <code>February Sales 2014</code>, ..., <code>December Sales 2014</code>, then do the same loop of all 12 months with 2015, 2016, ..., 2020?"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1493223287, "post_id": 43638742, "comment_id": 74327335, "body": "If you&#39;re deleting <i>every</i> month within those years, why not just look for those years?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1493223391, "post_id": 43638742, "comment_id": 74327399, "body": "@BruceWayne yes, that&#39;s right. And tigeravatar, I need it to be specifically Month + Sales + Year, because sometimes we might have something that ends in &quot;Sales 2017&quot; that I might not want to delete."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1493223430, "post_id": 43638742, "comment_id": 74327426, "body": "fwiw, the correct string concatenation operator in VBA is an ampersand (e.g. <code>&amp;</code>) not a plus sign (e.g. <code>+</code>) but in a pinch, a plus sign <i>can</i> be used when there is no ambiguity with a strictly mathematical operation. It is still not considered &#39;best practice&#39;."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1493223522, "post_id": 43638742, "comment_id": 74327481, "body": "Thank you Jeeped. I do typically use the &quot;&amp;&quot;, this was a bad example of my code."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1493223661, "post_id": 43638742, "comment_id": 74327576, "body": "Final question - I assume you have cells with dates <i>not</i> in your list above? I.e. <code>January Sales 1993</code>, ..., <code>September Sales 2011</code>, etc?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1493223670, "post_id": 43638742, "comment_id": 74327588, "body": "If had an actual date in a column, you could use a custom number format mask of <code>mmmm \\S\\al\\e\\s yyyy</code> to achieve January Sales 2014. After that, finding a year&#39;s worth of dates is easy."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1493223860, "post_id": 43638742, "comment_id": 74327724, "body": "@BruceWayne I don&#39;t have older dates, however I&#39;d like to be able to account for any future dates (beyond 2020, etc.)"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1493223926, "post_id": 43638742, "comment_id": 74327755, "body": "@Jeeped The cells aren&#39;t formatted to anything like a date, it&#39;s just strings of text, so I&#39;m not sure if that would work? Not sure if I&#39;m following..."}], "answers": [{"comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1493223791, "post_id": 43639626, "comment_id": 74327674, "body": "It worked! Thanks for all your work - I was hoping the answer wouldn&#39;t be as difficult as it looks... So using arrays, you looped through all of the variables in aMonths and aYears?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1493224237, "post_id": 43639626, "comment_id": 74327939, "body": "Thanks. I tried using a loop before, but I didn&#39;t include the ranges like you did. Lesson learned"}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 3, "last_activity_date": 1493223515, "creation_date": 1493223515, "answer_id": 43639626, "question_id": 43638742, "link": "https://stackoverflow.com/questions/43638742/trying-to-search-through-a-list-of-months-years-excel-vba/43639626#43639626", "title": "Trying to search through a list of months/years (excel vba)", "body": "<p>Something like this should work for you:</p>\n\n<pre><code>Sub tgr()\n\n    Dim ws As Worksheet\n    Dim rSearch As Range\n    Dim rFound As Range\n    Dim rDel As Range\n    Dim aYears() As Variant\n    Dim aMonths() As Variant\n    Dim vYear As Variant\n    Dim vMonth As Variant\n    Dim sTemp As String\n    Dim sFirst As String\n\n    Set ws = ActiveWorkbook.ActiveSheet\n    Set rSearch = ws.Columns(\"C\").EntireColumn\n    aMonths = Array(\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\")\n    aYears = Array(2014, 2015, 2016, 2017, 2018, 2019, 2020)\n\n    For Each vYear In aYears\n        For Each vMonth In aMonths\n            sTemp = vMonth &amp; \" Sales \" &amp; vYear\n            Set rFound = Nothing\n            Set rFound = rSearch.Find(sTemp, rSearch.Cells(rSearch.Cells.Count), xlValues, xlPart, , xlNext, False)\n            If Not rFound Is Nothing Then\n                sFirst = rFound.Address\n                If rDel Is Nothing Then Set rDel = rFound Else Set rDel = Union(rDel, rFound)\n                Do\n                    Set rDel = Union(rDel, rFound)\n                    Set rFound = rSearch.FindNext(rFound)\n                Loop While rFound.Address &lt;&gt; sFirst\n            End If\n        Next vMonth\n    Next vYear\n\n    If Not rDel Is Nothing Then rDel.EntireRow.Delete\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1493226378, "post_id": 43639888, "comment_id": 74329165, "body": "Interesting, thank you for this solution... I&#39;ll have to test both and see if there are any major differences with speed. One thing I have never liked about Autofilter solutions, though, is that if any of my sheet is protected/locked, it returns an error. Then I have to add extra lines of code to unprotect with my password, and I never like having my password in my code... Have you seen this problem before?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1493226607, "post_id": 43639888, "comment_id": 74329324, "body": "It is going to depend on how many multiple matches you have. If there are typically one (or none) of the majority of month/date combinations then any difference will be small. If speed is an issue, disabling screenupdating, events and calculation will make more of a difference."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1493227193, "post_id": 43639888, "comment_id": 74329663, "body": "Right right. I already have all of those disabled and turning back on at the end, but if this project of mine grows and I have to add other scenarios to the code/the amount of rows I&#39;m checking grows then I&#39;ll definitely be watching for speed. T"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 2, "last_activity_date": 1493224410, "creation_date": 1493224410, "answer_id": 43639888, "question_id": 43638742, "link": "https://stackoverflow.com/questions/43638742/trying-to-search-through-a-list-of-months-years-excel-vba/43639888#43639888", "title": "Trying to search through a list of months/years (excel vba)", "body": "<p>Bulk Autofilter operations are typically much faster then looping through individual Find operations.</p>\n\n<pre><code>Dim iMonth As Long, iYear As Long, sSales As String\n\nWith Worksheets(\"Sheet1\")\n    If .AutoFilterMode Then .AutoFilterMode = False\n    With Intersect(.Columns(\"C\"), .UsedRange)\n        For iYear = 2014 To 2020\n            For iMonth = 1 To 12\n                sSales = Format(DateSerial(iYear, iMonth, 1), \"mmmm \\S\\a\\l\\e\\s yyyy\")\n                .AutoFilter field:=1, Criteria1:=sSales\n                With .Resize(.Rows.Count - 1, 1).Offset(1, 0)\n                    If CBool(Application.Subtotal(103, .Cells)) Then\n                        .EntireRow.Delete\n                    End If\n                End With\n            Next iMonth\n        Next iYear\n    End With\n    If .AutoFilterMode Then .AutoFilterMode = False\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 410, "favorite_count": 0, "accepted_answer_id": 43639626, "answer_count": 2, "score": 1, "last_activity_date": 1493224410, "creation_date": 1493221085, "question_id": 43638742, "link": "https://stackoverflow.com/questions/43638742/trying-to-search-through-a-list-of-months-years-excel-vba", "title": "Trying to search through a list of months/years (excel vba)", "body": "<p>I'm using the following code to try and find all instances of a month + \" Sales \" + year, and then delete the row. However, I get a mismatch error. I don't think my .Find function can take an argument of a list. I tried using a loop WITHIN my loop to cycle through all the variables in my list, but still getting a mismatch error. Any ideas on how I can sort this out? Thanks:</p>\n\n<pre><code>'Add months and years for other possibilities\nDim mymonth() As String\nDim myyear() As String\nmymonth = Split(\"September, October, November, December, January, February, March, April, May, June, July, August\", \",\")\nmyyear = Split(\"2014, 2015, 2016, 2017, 2018, 2019, 2020\", \",\")\n\n'now check\nSet SrchRng = ActiveSheet.Range(\"C1\", ActiveSheet.Range(\"C65536\").End(xlUp))\nDo\n    Set c = SrchRng.Find(mymonth + \" Sales \" + myyear, LookIn:=xlValues)\n    If Not c Is Nothing Then c.EntireRow.Delete\nLoop While Not c Is Nothing\n</code></pre>\n\n<p>Bonus if you can figure out a better way to find any year in yyyy format instead of listing them out manually. I'm sure I could use the date function to achieve this but I'm having a hard enough time getting this to take just a plain list...</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1493226594, "post_id": 43638711, "comment_id": 74329317, "body": "Which line is the error coming from?"}, {"owner": {"reputation": 1, "user_id": 7926503, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-q5FNS0UFIVM/AAAAAAAAAAI/AAAAAAAABkg/QlHJ95I2-sU/photo.jpg?sz=128", "display_name": "Gabriel Arce", "link": "https://stackoverflow.com/users/7926503/gabriel-arce"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1493234320, "post_id": 43638711, "comment_id": 74333854, "body": "Error is on the last line Set sch ...."}, {"owner": {"reputation": 1, "user_id": 7926503, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-q5FNS0UFIVM/AAAAAAAAAAI/AAAAAAAABkg/QlHJ95I2-sU/photo.jpg?sz=128", "display_name": "Gabriel Arce", "link": "https://stackoverflow.com/users/7926503/gabriel-arce"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1493234666, "post_id": 43638711, "comment_id": 74334064, "body": "Also, I wanted to add it is important that the search supports a special character like @"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7926503, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-q5FNS0UFIVM/AAAAAAAAAAI/AAAAAAAABkg/QlHJ95I2-sU/photo.jpg?sz=128", "display_name": "Gabriel Arce", "link": "https://stackoverflow.com/users/7926503/gabriel-arce"}, "edited": false, "score": 0, "creation_date": 1493495652, "post_id": 43643527, "comment_id": 74444766, "body": "What is this macro supposed to do? Nothing happens when I run it. (outlook menu&#39;s freeze)"}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1493236885, "creation_date": 1493236885, "answer_id": 43643527, "question_id": 43638711, "link": "https://stackoverflow.com/questions/43638711/outlook-macro-advanced-search/43643527#43643527", "title": "outlook macro advanced search", "body": "<p>You need to specify a valid scope and search criteria. The scope of the search is the folder path of a folder, not a folder name. It is recommended that the folder path is enclosed within single quotes. Otherwise, the search might not return correct results if the folder path contains special characters including Unicode characters. To specify multiple folder paths, enclose each folder path in single quotes and separate the single quoted folder paths with a comma.</p>\n\n<p>The Filter parameter can be any valid DASL query. For additional information on DASL queries, see <a href=\"https://msdn.microsoft.com/en-us/library/bb147579.aspx\" rel=\"nofollow noreferrer\">Filtering Items</a>.</p>\n\n<p>Note, you can use the <a href=\"https://msdn.microsoft.com/en-us/library/office/gg264465.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">Chr Function</a> to represent any character in the search criteria. </p>\n\n<pre><code>Sub TestSearchForMultipleFolders()\n Dim Scope As String\n Dim Filter As String\n Dim MySearch As Outlook.Search\n Dim MyTable As Outlook.Table\n Dim nextRow As Outlook.Row\n m_SearchComplete = False\n 'Establish scope for multiple folders\n Scope = \"'\" &amp; Application.Session.GetDefaultFolder( _\nolFolderInbox).FolderPath _\n &amp; \"','\" &amp; Application.Session.GetDefaultFolder( _\n olFolderSentMail).FolderPath &amp; \"'\"\n 'Establish filter\n If Application.Session.DefaultStore.IsInstantSearchEnabled Then\n    Filter = Chr(34) &amp; \"urn:schemas:httpmail:subject\" _\n    &amp; Chr(34) &amp; \" ci_phrasematch 'Office'\"\n Else\n    Filter = Chr(34) &amp; \"urn:schemas:httpmail:subject\" _\n    &amp; Chr(34) &amp; \" like '%Office%'\"\n End If\n Set MySearch = Application.AdvancedSearch(Scope, Filter, True, \"MySearch\")\n While m_SearchComplete &lt;&gt; True\n    DoEvents\n Wend\n Set MyTable = MySearch.GetTable\n  Do Until MyTable.EndOfTable\n    Set nextRow = MyTable.GetNextRow()\n    Debug.Print nextRow(\"Subject\")\n Loop\nEnd Sub\n</code></pre>\n\n<p>Also you may find the <a href=\"https://www.add-in-express.com/creating-addins-blog/2012/05/31/outlook-search-csharp-vbnet/\" rel=\"nofollow noreferrer\">Advanced search in Outlook programmatically: C#, VB.NET</a> article helpful. </p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7926503, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-q5FNS0UFIVM/AAAAAAAAAAI/AAAAAAAABkg/QlHJ95I2-sU/photo.jpg?sz=128", "display_name": "Gabriel Arce", "link": "https://stackoverflow.com/users/7926503/gabriel-arce"}, "is_accepted": false, "score": 0, "last_activity_date": 1493620397, "last_edit_date": 1493620397, "creation_date": 1493527728, "answer_id": 43703012, "question_id": 43638711, "link": "https://stackoverflow.com/questions/43638711/outlook-macro-advanced-search/43703012#43703012", "title": "outlook macro advanced search", "body": "<p>Ok, this is what I got to work. </p>\n\n<p>When starting the macro:</p>\n\n<ol>\n<li>It Asks user to enter string</li>\n<li>Performs and advance search and search for string in subject (including special characters like @cris)</li>\n<li>Creates search folder to display search results</li>\n</ol>\n\n<p>In case it helps anybody else. I don't know how to create an output like when doing a manual search. But this works for me.</p>\n\n<pre><code>Sub AdvSearchForStr()\n    On Error GoTo Err_SearchFolderForSender\n    Dim strFrom As String\n    Dim strTo As String\n    Dim strSearch As String\n\n    strSearch = InputBox(\"Enter String to AdvSearch\", \"Advanced Search\")\n\n    strTo = \"Test\"\n\n    Dim strDASLFilter As String\n    strDASLFilter = \"urn:schemas:httpmail:subject LIKE '%\" &amp; strSearch &amp; \"%'\"\n\n    Debug.Print strDASLFilter\n\n    Dim strScope As String\n    strScope = \"'Inbox', 'Sent Items', 'Tasks'\"\n\n    Dim objSearch As Search\n    Set objSearch = Application.AdvancedSearch(Scope:=strScope, Filter:=strDASLFilter, SearchSubFolders:=True, Tag:=\"SearchFolder\")\n\n    'Save the search results to a searchfolder\n    objSearch.Save (strSearch)\n\n    Set objSearch = Nothing\n    Exit Sub\n\nErr_SearchFolderForSender:\n    MsgBox \"Error # \" &amp; Err &amp; \" : \" &amp; Error(Err)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7926503, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-q5FNS0UFIVM/AAAAAAAAAAI/AAAAAAAABkg/QlHJ95I2-sU/photo.jpg?sz=128", "display_name": "Gabriel Arce", "link": "https://stackoverflow.com/users/7926503/gabriel-arce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2803, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1593070542, "creation_date": 1493221007, "last_edit_date": 1593070542, "question_id": 43638711, "link": "https://stackoverflow.com/questions/43638711/outlook-macro-advanced-search", "title": "outlook macro advanced search", "body": "<p>I would like to create a macro to perform an \"Advanced Search\" on tasks subject and optionally tasks body. For instance search for \"@Cris\"</p>\n\n<p>I have copied and modified this code from an example for Excel but it doesnt run. Runtime Error. Appreciate any assistance</p>\n\n<pre><code>Sub AdvancedSearchComplete()\n    Dim rsts As Outlook.Results\n    Dim i As Integer\n    Dim strF As String\n    Dim strS As String\n    strS = \"Tasks\"\n    StrName = InputBox(\"Search String?\")\n    strF = InStr(LCase(\"urn:schemas:tasks:subject\"), StrName)\n\n    Set sch = Application.AdvancedSearch(strS, strF, , \"Search1\")\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1493221224, "post_id": 43638682, "comment_id": 74325876, "body": "Maybe <code>Range(&quot;A&quot; &amp; NextEmptyCol).Value = &quot;New Query&quot;</code>?"}, {"owner": {"reputation": 95, "user_id": 7710018, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/50f4357aa7f73fb1087b8c852d257d2a?s=128&d=identicon&r=PG&f=1", "display_name": "Porkball21", "link": "https://stackoverflow.com/users/7710018/porkball21"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1493221427, "post_id": 43638682, "comment_id": 74326034, "body": "Hmmm that seems to insert the String into cell A80 for some reason... in my spreadsheet the next available cell in the first column that is empty is CB1"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1493221541, "post_id": 43638682, "comment_id": 74326118, "body": "Column <code>CB</code> is the first column in your sheet? Maybe you and I have a different understanding of <i>first column</i>? Could you please elaborate what this term means to you? I had expect it to be column <code>A</code>."}, {"owner": {"reputation": 95, "user_id": 7710018, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/50f4357aa7f73fb1087b8c852d257d2a?s=128&d=identicon&r=PG&f=1", "display_name": "Porkball21", "link": "https://stackoverflow.com/users/7710018/porkball21"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1493221644, "post_id": 43638682, "comment_id": 74326190, "body": "So the first column where cell 1 is empty, sorry if my question was ambiguous"}], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 7710018, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/50f4357aa7f73fb1087b8c852d257d2a?s=128&d=identicon&r=PG&f=1", "display_name": "Porkball21", "link": "https://stackoverflow.com/users/7710018/porkball21"}, "edited": false, "score": 0, "creation_date": 1493221914, "post_id": 43639014, "comment_id": 74326368, "body": "That worked! Thank you. Could you explain the (1, NextEmtpyCol) for me?"}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1493222520, "post_id": 43639014, "comment_id": 74326815, "body": "Cells(row_number, column_number). In this case it is 1st row and whatever number is assigned to NextEmptyCol variable. You can find more info <a href=\"https://msdn.microsoft.com/en-us/library/office/ff194567.aspx\" rel=\"nofollow noreferrer\">here</a>"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1493222654, "post_id": 43639014, "comment_id": 74326891, "body": "If you use <code>Range()</code> then you have to pass the column as a character. If you use <code>Cells()</code> then you have the option to pass the column as a number (so column <code>D</code> = column 4). Hence, I used <code>Cells()</code> instead of <code>Range()</code> because <code>Find()</code> is giving us the <i>next available column</i> as a number."}], "tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": true, "score": 1, "last_activity_date": 1493221812, "creation_date": 1493221812, "answer_id": 43639014, "question_id": 43638682, "link": "https://stackoverflow.com/questions/43638682/how-do-you-insert-a-string-into-the-first-empty-cell-in-the-first-available-colu/43639014#43639014", "title": "How do you insert a String into the first empty cell in the first available column, i.e. C1, F1, AA1", "body": "<p>Maybe this is what you are looking for</p>\n\n<pre><code>Sub CreateNewQuery()\n\nDim NextEmptyCol As Long\n\nSheets(\"Sheet2\").Activate\n\nNextEmptyCol = Cells.Find(\"*\", [A1], , , xlByRows, xlPrevious).Column + 1\n\n'    MsgBox \"Column number \" &amp; NextEmptyCol &amp; vbCr &amp; _\n'           \"Or column letter \"\"\" &amp; Replace(Cells(1, NextEmptyCol).Address(0, 0), 1, \"\") &amp; \"\"\"\", _\n'           vbInformation, \"The Next Empty Column is...\"\n\nCells(1, NextEmptyCol).Value = \"New Query\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 7710018, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/50f4357aa7f73fb1087b8c852d257d2a?s=128&d=identicon&r=PG&f=1", "display_name": "Porkball21", "link": "https://stackoverflow.com/users/7710018/porkball21"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 43639014, "answer_count": 1, "score": 2, "last_activity_date": 1526978293, "creation_date": 1493220913, "last_edit_date": 1526968748, "question_id": 43638682, "link": "https://stackoverflow.com/questions/43638682/how-do-you-insert-a-string-into-the-first-empty-cell-in-the-first-available-colu", "title": "How do you insert a String into the first empty cell in the first available column, i.e. C1, F1, AA1", "body": "<p>I have a sub-routine that searches for the first available cell in the first column that is empty. I would like to insert a String into this cell.</p>\n\n<p>What's the best way to do this? I have tried like this: </p>\n\n<pre><code>Range(NextEmptyCol).Value = \"New Query\"\n</code></pre>\n\n<p>Here is my sub-routine:</p>\n\n<pre><code>Sub CreateNewQuery()\n\nDim NextEmptyCol As Long\n\nSheets(\"DataFeedSheet\").Activate\n\nNextEmptyCol = Cells.Find(\"*\", [A1], , , xlByColumns, xlPrevious).Column + 1\n\n'    MsgBox \"Column number \" &amp; NextEmptyCol &amp; vbCr &amp; _\n'           \"Or column letter \"\"\" &amp; Replace(Cells(1, NextEmptyCol).Address(0, 0), 1, \"\") &amp; \"\"\"\", _\n'           vbInformation, \"The Next Empty Column is...\"\n\nRange(NextEmptyCol).Value = \"New Query\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 1, "creation_date": 1493221286, "post_id": 43638670, "comment_id": 74325919, "body": "Please post the code that generated the first screenshot"}, {"owner": {"reputation": 1, "user_id": 7924917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b3c1e49086de521dd5e0f19d6600e7f?s=128&d=identicon&r=PG&f=1", "display_name": "Prathamesh Deshpande", "link": "https://stackoverflow.com/users/7924917/prathamesh-deshpande"}, "reply_to_user": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1493312304, "post_id": 43638670, "comment_id": 74374596, "body": "yes. updated. Please see"}], "answers": [{"tags": [], "owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "is_accepted": false, "score": 2, "last_activity_date": 1493330988, "last_edit_date": 1493330988, "creation_date": 1493330447, "answer_id": 43668623, "question_id": 43638670, "link": "https://stackoverflow.com/questions/43638670/writing-fixed-width-text-files-from-excel-vba/43668623#43668623", "title": "Writing Fixed width text files from excel vba", "body": "<p>Something like this should work:</p>\n\n<pre><code>x = 9983.54\na = Space(21-Len(CStr(x))) &amp; CStr(x)\n</code></pre>\n\n<p>Then a will be 14 spaces followed by x:</p>\n\n<pre><code>a = \"              9983.54\"\n</code></pre>\n\n<p>Here 21 is the desired column width --- change as necessary. <code>CStr</code> may be unnecessary for non-numeric x.</p>\n\n<p>If you're going to right-justify a lot of different data to different width fields you could write a general purpose function:</p>\n\n<pre><code>Function LeftJust(val As String, width As Integer) As String\n    LeftJust = Space(width - Len(val)) &amp; val\nEnd Function\n</code></pre>\n\n<p>The you call it with <code>LeftJust(CStr(9983.54), 21)</code>.</p>\n\n<p>Also note that VBA's <code>Print #</code> statement has a <code>Spc(n)</code> parameter that you can use to produce fixed-width output, e.g., <code>Print #fNum, Spc(n); a</code>; before this statement you calculate n: <code>n = 21-Len(CStr(a))</code>.</p>\n\n<p>Hope that helps</p>\n"}], "owner": {"reputation": 1, "user_id": 7924917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b3c1e49086de521dd5e0f19d6600e7f?s=128&d=identicon&r=PG&f=1", "display_name": "Prathamesh Deshpande", "link": "https://stackoverflow.com/users/7924917/prathamesh-deshpande"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3359, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1493356495, "creation_date": 1493220875, "last_edit_date": 1531164843, "question_id": 43638670, "link": "https://stackoverflow.com/questions/43638670/writing-fixed-width-text-files-from-excel-vba", "title": "Writing Fixed width text files from excel vba", "body": "<p>This is the output of a program.</p>\n\n<p><img src=\"https://i.stack.imgur.com/yRxtB.png\" alt=\"Current Output of my program\"></p>\n\n<p>I have specified what shall be width of each cell in the program and my program shows correct output. </p>\n\n<p>What I want to do is cell content shall be written from right to left. E.g highlighted figure 9983.54 has width of 21. Text file has used first 7 columns. But I want it to use last 7 columns of text file.</p>\n\n<p>Please see expected output image.</p>\n\n<p><img src=\"https://i.stack.imgur.com/oOUjL.png\" alt=\"Expected output\"></p>\n\n<p>I am not getting any clue how to do this. I am not a very professional programmer but I love coding. This text file is used as input to some other program and i am trying to automate writing text file from excel VBA. </p>\n\n<p>Can anyone suggest a way to get this output format?</p>\n\n<p>Here is the code which gave me first output</p>\n\n<pre><code>Option Explicit\n\nSub CreateFixedWidthFile(strFile As String, ws As Worksheet, s() As Integer)\n    Dim i As Long, j As Long\n    Dim strLine As String, strCell As String\n\n    'get a freefile\n    Dim fNum As Long\n    fNum = FreeFile\n\n    'open the textfile\n    Open strFile For Output As fNum\n    'loop from first to last row\n    'use 2 rather than 1 to ignore header row\n    For i = 1 To ws.Range(\"a65536\").End(xlUp).Row\n        'new line\n        strLine = \"\"\n        'loop through each field\n        For j = 0 To UBound(s)\n            'make sure we only take chars up to length of field (may want to output some sort of error if it is longer than field)\n            strCell = Left$(ws.Cells(i, j + 1).Value, s(j))\n            'add on string of spaces with length equal to the difference in length between field length and value length\n            strLine = strLine &amp; strCell &amp; String$(s(j) - Len(strCell), Chr$(32))\n        Next j\n        'write the line to the file\n        Print #fNum, strLine\n    Next i\n    'close the file\n    Close #fNum\n\nEnd Sub\n</code></pre>\n\n<p>'for example the code could be called using:</p>\n\n<pre><code>Sub CreateFile()\n    Dim sPath As String\n    sPath = Application.GetSaveAsFilename(\"\", \"Text Files,*.txt\")\n    If LCase$(sPath) = \"false\" Then Exit Sub\n    'specify the widths of our fields\n    'the number of columns is the number specified in the line below +1\n    Dim s(6) As Integer\n    'starting at 0 specify the width of each column\n    s(0) = 21\n    s(1) = 9\n    s(2) = 15\n    s(3) = 11\n    s(4) = 12\n    s(5) = 10\n    s(6) = 186\n    'for example to use 3 columns with field of length 5, 10 and 15 you would use:\n    'dim s(2) as Integer\n    's(0)=5\n    's(1)=10\n    's(2)=15\n    'write to file the data from the activesheet\n    CreateFixedWidthFile sPath, ActiveSheet, s\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7925225, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/6101bec7ce78d8eda1b722bea520fccf?s=128&d=identicon&r=PG&f=1", "display_name": "samred", "link": "https://stackoverflow.com/users/7925225/samred"}, "edited": false, "score": 0, "creation_date": 1493224332, "post_id": 43639066, "comment_id": 74327993, "body": "Each iteration pastes to different cells. Like for examlpe first iteration uses value from let&#39;s say Row 1 Column 1 of Load Book sheet and pastes that in Max amps B2. After it calculates the sheet, the value from Max Amps sheet cell B8 and B9 are pasted next to the initial copied value from Row1 Column 1, so Row 1 Column 2 and Column 3"}, {"owner": {"reputation": 3, "user_id": 7925225, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/6101bec7ce78d8eda1b722bea520fccf?s=128&d=identicon&r=PG&f=1", "display_name": "samred", "link": "https://stackoverflow.com/users/7925225/samred"}, "edited": false, "score": 0, "creation_date": 1493224871, "post_id": 43639066, "comment_id": 74328328, "body": "Oops I mean&#39;t B6 and B7 need to be pasted into B8 and C8. But the row changes with each r1c1 that occur. For example, R[7]C[-1] gets copied into Max Amps cell B2. Then Calculate sheet. Then Max Amps Cell B6 and B7 get pasted into Load Book Cell B8 and C8 respectively. This same process has to happen agani for R[8]C[-1] and the results from max Amps get pasted into B9 C9. The way it is i think it only posts it to b8 c8"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 3, "user_id": 7925225, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/6101bec7ce78d8eda1b722bea520fccf?s=128&d=identicon&r=PG&f=1", "display_name": "samred", "link": "https://stackoverflow.com/users/7925225/samred"}, "edited": false, "score": 0, "creation_date": 1493280056, "post_id": 43639066, "comment_id": 74351306, "body": "So, 7 rows down from the active cell and 1 column to the left (<code>R[7]C[-1]</code>) gets copied into cell <code>B2</code> and <code>B1</code> is the active cell in your code - so that&#39;s looking at cell <code>A8</code>?  If you want it to look at row 7, column 1 use <code>R7C1</code>, the square brackets make it a relative reference.  Not exactly sure what you&#39;re after, but maybe you can update the paste cells using the <code>lCounter</code> variable - <code>wrkSht.Cells(8,2) = .Cells(lCounter,2)</code> for example"}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1493221956, "creation_date": 1493221956, "answer_id": 43639066, "question_id": 43638493, "link": "https://stackoverflow.com/questions/43638493/how-can-i-make-this-macro-recording-apply-to-entire-sheet/43639066#43639066", "title": "How can I make this Macro Recording apply to entire sheet?", "body": "<p>Yep, that's very messy and hard to follow.<br>\nI <em>think</em> you're trying to do this:  </p>\n\n<pre><code>Public Sub Test()\n\n    Dim lCounter As Long\n    Dim wrkSht As Worksheet\n\n    Set wrkSht = ThisWorkbook.Worksheets(\"Load Book\")\n\n    With ThisWorkbook.Worksheets(\"Max Amps\")\n        For lCounter = 7 To 10\n\n            'Update the formula in cell B1 to the row indicated by lCounter.\n            .Cells(1, 2).FormulaR1C1 = \"='Load Book'!R\" &amp; lCounter &amp; \"C1\"\n\n            'Copy the value from cells B6 and B7 to cells B8 and C8 on 'Load Book'.\n            wrkSht.Cells(8, 2) = .Cells(6, 2)\n            wrkSht.Cells(8, 3) = .Cells(7, 2)\n\n        Next lCounter\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7925225, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/6101bec7ce78d8eda1b722bea520fccf?s=128&d=identicon&r=PG&f=1", "display_name": "samred", "link": "https://stackoverflow.com/users/7925225/samred"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 19, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1493221956, "creation_date": 1493220497, "last_edit_date": 1531164843, "question_id": 43638493, "link": "https://stackoverflow.com/questions/43638493/how-can-i-make-this-macro-recording-apply-to-entire-sheet", "title": "How can I make this Macro Recording apply to entire sheet?", "body": "<p>This is the code: </p>\n\n<pre><code>Sub Macro11()\n\nSheets(\"Max Amps\").Select\nRange(\"B1\").Select\nApplication.CutCopyMode = False\nSelection.ClearContents\nSelection.NumberFormat = \"General\"\nActiveCell.FormulaR1C1 = \"='Load Book'!R[7]C[-1]\"\nRange(\"B2\").Select\nActiveSheet.Calculate\nRange(\"B6\").Select\nSelection.Copy\nSheets(\"Load Book\").Select\nRange(\"B8\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nSheets(\"Max Amps\").Select\nRange(\"B7\").Select\nApplication.CutCopyMode = False\nSelection.Copy\nSheets(\"Load Book\").Select\nRange(\"C8\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nRange(\"C5:C8\").Select\nApplication.CutCopyMode = False\nSelection.NumberFormat = \"m/d/yyyy\"\nRange(\"B9\").Select\nSheets(\"Max Amps\").Select\nRange(\"B1\").Select\nSelection.ClearContents\nSelection.NumberFormat = \"General\"\nActiveCell.FormulaR1C1 = \"='Load Book'!R[8]C[-1]\"\nRange(\"B2\").Select\nActiveSheet.Calculate\nRange(\"B6\").Select\nSelection.Copy\nSheets(\"Load Book\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nSheets(\"Max Amps\").Select\nRange(\"B7\").Select\nApplication.CutCopyMode = False\nSelection.Copy\nSheets(\"Load Book\").Select\nRange(\"C9\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nRange(\"B10\").Select\nSheets(\"Max Amps\").Select\nRange(\"B1\").Select\nApplication.CutCopyMode = False\nSelection.ClearContents\nSelection.NumberFormat = \"General\"\nActiveCell.FormulaR1C1 = \"='Load Book'!R[9]C[-1]\"\nRange(\"B2\").Select\nActiveSheet.Calculate\nRange(\"B6\").Select\nSelection.Copy\nSheets(\"Load Book\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nRange(\"C10\").Select\nSheets(\"Max Amps\").Select\nRange(\"B7\").Select\nApplication.CutCopyMode = False\nSelection.Copy\nSheets(\"Load Book\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nRange(\"B11\").Select\nSheets(\"Max Amps\").Select\nRange(\"B1\").Select\nApplication.CutCopyMode = False\nRange(\"B1\").Select\nSelection.NumberFormat = \"General\"\nSelection.ClearContents\nActiveCell.FormulaR1C1 = \"='Load Book'!R[10]C[-1]\"\nRange(\"B2\").Select\nActiveSheet.Calculate\nRange(\"B6\").Select\nSelection.Copy\nSheets(\"Load Book\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nSheets(\"Max Amps\").Select\nRange(\"B7\").Select\nApplication.CutCopyMode = False\nSelection.Copy\nSheets(\"Load Book\").Select\nRange(\"C11\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nEnd Sub\n</code></pre>\n\n<p>I know it's very long and messy but it's done through Macro recording since I'm new to VBA. I have about 50-60 rows that I need to do this for but I feel like theres an easier way to automate this...with a for loop somehow. How can I implement this code with a loop instead of a recording for each iteration? The code shown above shows 4 iterations. R[7] through R[10]</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 3, "creation_date": 1493219813, "post_id": 43638062, "comment_id": 74324796, "body": "Side note: If you protect your sheets with <code>.Protect Password:=&quot;HSBC2017&quot;, UserInterfaceOnly:=True</code> once, then you don&#39;t need to unprotect it for any macro actions later. This way the sheet is only protectet from user actions but macros can still run. See <a href=\"http://msdn.microsoft.com/en-us/library/office/ff840611.aspx\" rel=\"nofollow noreferrer\">Worksheet.Protect Method (Excel)</a>."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 3, "creation_date": 1493219817, "post_id": 43638062, "comment_id": 74324798, "body": "I&#39;d suggest  you do the copy immediately before the paste: <code>Sheets(&quot;Tracker&quot;).Rows(trackerRow).EntireRow.Copy</code> directly before <code>.Cells(compRow + 1, 1).PasteSpecial xlPasteValues</code>"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1493219961, "post_id": 43638062, "comment_id": 74324896, "body": "@Rory that would change the row copied as he hasn&#39;t declared it explicitly"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 1, "creation_date": 1493220261, "post_id": 43638062, "comment_id": 74325110, "body": "@Tom From the context, it seems pretty likely that that is the sheet to copy from."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1493220329, "post_id": 43638062, "comment_id": 74325165, "body": "related: <a href=\"http://stackoverflow.com/questions/33833318/should-i-turn-cutcopymode-back-on-before-exiting-my-sub-procedure\">Should I turn .CutCopyMode back on before exiting my sub procedure?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 0, "creation_date": 1493284216, "post_id": 43639461, "comment_id": 74354225, "body": "That explanation makes perfect sense, I will be mindful of this in the future. And thanks to <a href=\"http://stackoverflow.com/users/3219613/peh\">Peh</a> for the the <code>UserInterfaceOnly</code>, something I was not aware of but will be very useful."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 2, "last_activity_date": 1493223077, "last_edit_date": 1495540018, "creation_date": 1493223077, "answer_id": 43639461, "question_id": 43638062, "link": "https://stackoverflow.com/questions/43638062/vba-xlpastevalues-fails-on-2nd-run/43639461#43639461", "title": "VBA xlPasteValues fails on 2nd run", "body": "<p>Each time you crash into a debug, you leave the destination Completed worksheet unprotected. Closing the workbook and reopening it leaves it unprotected.</p>\n\n<p>Unprotecting an unprotected worksheet does not cancel the .CutCopyMode but unprotecting a protected worksheet does.</p>\n\n<p>So in the first run-through with an unprotected destination worksheet there is something on the clipboard (and you have 'dancing ants' on the row-to-copy on the Tracker worksheet). Since everything runs through, the destination Completed worksheet is now protected and a second run-through will cancel the .CutCopyMode when the worksheet is unprotected. You can watch this by stepping through your code with F8 and see the 'dancing ants' disappear from the copy area on the Tracker worksheet as soon as you unprotect the Completed worksheet a second time.</p>\n\n<p>Possible solutions (with a nod to comments from <a href=\"https://stackoverflow.com/users/3219613/peh\">Peh</a> and <a href=\"https://stackoverflow.com/users/3611989/rory\">Rory</a>):</p>\n\n<p>Protect the worksheet with a password and UserInterfaceOnly.</p>\n\n<pre><code>with worksheets(\"Completed\")\n    .Protect Password:=\"HSBC2017\", UserInterfaceOnly:=True\nend with\n</code></pre>\n\n<p>This only has to be done once and you can remove both the .Unprotect and .Protect code from future sub procedure operations. Only actions made manually by the user will be restricted.</p>\n\n<p>Initiate the copy from the source worksheet <strong>after</strong> unprotecting the destination worksheet.</p>\n\n<pre><code>with worksheets(\"Completed\")\n    .Unprotect Password:=\"HSBC2017\"\n    worksheets(\"Tracker\").Rows(trackerRow).EntireRow.Copy\n    .Cells(compRow + 1, 1).PasteSpecial xlPasteValues\n    .Protect Password:=\"HSBC2017\"\nend with\n</code></pre>\n"}], "owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 43639461, "answer_count": 1, "score": 1, "last_activity_date": 1493223077, "creation_date": 1493219316, "last_edit_date": 1531161705, "question_id": 43638062, "link": "https://stackoverflow.com/questions/43638062/vba-xlpastevalues-fails-on-2nd-run", "title": "VBA xlPasteValues fails on 2nd run", "body": "<p>I have a short code that basically copies a selected row to another sheet, and deletes it from the first.</p>\n\n<p>For some reason when I run this, it will run just fine, if I then select a different row, I get a <code>pasteSpecial method of RangeClass failed</code> error.</p>\n\n<pre><code>Sub Completed()\n\nDim trackerRow As Integer, compRow As Integer, answer As Integer\nApplication.ScreenUpdating = False\nApplication.CutCopyMode = False\ntrackerRow = ActiveCell.Row\ncompRow = Sheets(\"Completed\").Cells(Rows.Count, \"B\").End(xlUp).Row\nIf trackerRow &lt; 3 Then Exit Sub\n    If Cells(trackerRow, 2) = \"\" Then\n        MsgBox \"This row is empty, please select the candidate you want to move.\", vbExclamation, \"Empty Row\"\n    Else\n    answer = MsgBox(\"Are you sure you want to move \" &amp; Cells(trackerRow, 3).Value &amp; \"?\", vbYesNo, \"Confirm move?\")\n    If answer = vbYes Then\n        'move row\n        Rows(trackerRow).EntireRow.Copy\n        With ThisWorkbook\n            With .Sheets(\"Completed\")\n                .Activate\n                .Unprotect \"HSBC2017\"\n                .Cells(compRow + 1, 1).PasteSpecial xlPasteValues '**error line**.\n                .Protect \"HSBC2017\"\n            End With\n            With .Sheets(\"Tracker\")\n                .Unprotect \"HSBC2017\"\n                .Rows(trackerRow).EntireRow.Delete\n                .Protect \"HSBC2017\"\n                .Activate\n            End With\n        End With\n    End If\nEnd If\nApplication.ScreenUpdating = True\nApplication.CutCopyMode = False\nEnd Sub\n</code></pre>\n\n<p>I can't work out why when I open the document it will work once, but you have to re-open to run a second time?</p>\n"}, {"tags": ["excel", "vba", "filter", "copy-paste"], "comments": [{"owner": {"reputation": 886, "user_id": 6401734, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/87dbeb33da7c89f7b7a55a8bcf792301?s=128&d=identicon&r=PG&f=1", "display_name": "MattE", "link": "https://stackoverflow.com/users/6401734/matte"}, "edited": false, "score": 0, "creation_date": 1493219976, "post_id": 43637944, "comment_id": 74324911, "body": "Hmm...thinking outside the box---could I not simply sort the rows by #N/A, then filter it by #N/A to get a continuous range and then do a simple copy and paste to avoid a lot of extra work?"}], "answers": [{"comments": [{"owner": {"reputation": 886, "user_id": 6401734, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/87dbeb33da7c89f7b7a55a8bcf792301?s=128&d=identicon&r=PG&f=1", "display_name": "MattE", "link": "https://stackoverflow.com/users/6401734/matte"}, "edited": false, "score": 0, "creation_date": 1493220078, "post_id": 43638310, "comment_id": 74324983, "body": "I believe the method I posted in the comment is a valid one also(it works doing it by hand, at least, so I&#39;d assume it should give the same results in code) ...it needs to be VBA because the data is going to change each day so I want to be able to click a button and make that happen..."}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "reply_to_user": {"reputation": 886, "user_id": 6401734, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/87dbeb33da7c89f7b7a55a8bcf792301?s=128&d=identicon&r=PG&f=1", "display_name": "MattE", "link": "https://stackoverflow.com/users/6401734/matte"}, "edited": false, "score": 0, "creation_date": 1493221794, "post_id": 43638310, "comment_id": 74326293, "body": "I missed your comment while posting the answer, still you don&#39;t need to filter or sort anything. If it is a daily operation please see my edit for vba solution."}, {"owner": {"reputation": 886, "user_id": 6401734, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/87dbeb33da7c89f7b7a55a8bcf792301?s=128&d=identicon&r=PG&f=1", "display_name": "MattE", "link": "https://stackoverflow.com/users/6401734/matte"}, "edited": false, "score": 0, "creation_date": 1493224058, "post_id": 43638310, "comment_id": 74327821, "body": "wouldn&#39;t it be more efficient to simply sort the rows first by #N/A to limit the number of rows than looping through all of them?  I could set up a Do While Loop where the .value = &quot;#N/A&quot; and then set the value2 equal to each other. Once it reaches the last #N/A row the loop ends"}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "reply_to_user": {"reputation": 886, "user_id": 6401734, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/87dbeb33da7c89f7b7a55a8bcf792301?s=128&d=identicon&r=PG&f=1", "display_name": "MattE", "link": "https://stackoverflow.com/users/6401734/matte"}, "edited": false, "score": 0, "creation_date": 1493225843, "post_id": 43638310, "comment_id": 74328857, "body": "It depends on how many #N/A values you have. Out of curiosity I compared two methods for 1000000 rows. I tested them assuming 2/3 of your data is #N/A. These timings may change a little bit each time you run the code but they will be about the same. My method took 14.07031 secs. Then I sorted them which took 1.832031 secs and then copied for the first 666667 cells and it took 12.21094 secs which makes a total of 14.04297 secs. I&#39;d like to remind you that I already have known 666667 rows need to be changed, in your case you need to find out how many rows are #N/a which will result in more time."}, {"owner": {"reputation": 886, "user_id": 6401734, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/87dbeb33da7c89f7b7a55a8bcf792301?s=128&d=identicon&r=PG&f=1", "display_name": "MattE", "link": "https://stackoverflow.com/users/6401734/matte"}, "edited": false, "score": 0, "creation_date": 1493226807, "post_id": 43638310, "comment_id": 74329442, "body": "Try it by sorting the Range and then setting Range.Value2 = Range.Value2...it should be a lot faster than copy and paste I would imagine, at least it has been in my experience"}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "reply_to_user": {"reputation": 886, "user_id": 6401734, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/87dbeb33da7c89f7b7a55a8bcf792301?s=128&d=identicon&r=PG&f=1", "display_name": "MattE", "link": "https://stackoverflow.com/users/6401734/matte"}, "edited": false, "score": 0, "creation_date": 1493232772, "post_id": 43638310, "comment_id": 74332939, "body": "Well @MattE, I&#39;m not planning to try what you want me to try because if you pay attention, what I do is not copy/pasting values.<code>Cells(i, 1)=Cells(i, 2)</code> is the same thing with <code>Range1.Value=Range2.Value</code>. What I tried to show you was just out of curiosity. Above code takes 14 secs to loop within 1 million rows without a need to sort. Do you have more than 1 million rows?Do you really need a time efficient code to run it once a day?So, have any of my solutions met your expectations?If so, you can accept this as an answer and ask &quot;How to improve this working code&quot; as a different question.Thanks"}], "tags": [], "owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "is_accepted": false, "score": 0, "last_activity_date": 1493222151, "last_edit_date": 1493222151, "creation_date": 1493220013, "answer_id": 43638310, "question_id": 43637944, "link": "https://stackoverflow.com/questions/43637944/excel-vba-filtering-a-column-and-then-copying-each-item-in-the-area-collection-t/43638310#43638310", "title": "Excel VBA filtering a column and then copying each item in the area collection to a matching row", "body": "<p>You don't need to filter your table. You have two feasible solutions: </p>\n\n<p><strong>Solution 1 (without VBA):</strong>\nAssuming that Create Date is at A1:</p>\n\n<p>-Insert a new column between Create Date and Last Active Date.</p>\n\n<p>-Insert this function to B2--> =IF(A2=\"\",IFNA(D2,C2),A2)</p>\n\n<p>-Copy paste B2 till end of your column</p>\n\n<p>-Copy all B column and paste them as values.</p>\n\n<p>-Delete Column A</p>\n\n<p><strong>Solution 2 (with VBA):</strong></p>\n\n<p>You can loop through each row and check if the Age cell is #N/A, if true(#N/A), then you do the copy/paste from Last Active Date cell to Create Date Cell.</p>\n\n<p>Solution 1 is much faster and easy. If you are interested in VBA solution let us know.</p>\n\n<p><strong>Edit:</strong> You can always change the following code for different conditions but since you said --> Create date value (which will always be blank for these rows):</p>\n\n<pre><code>Dim i As Long\nFor i = 2 To Range(\"C1\").End(xlDown).Row\n    If IsEmpty(Cells(i, 1).Value) Then\n        Cells(i, 1) = Cells(i, 2)\n    End If\nNext i\n</code></pre>\n"}], "owner": {"reputation": 886, "user_id": 6401734, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/87dbeb33da7c89f7b7a55a8bcf792301?s=128&d=identicon&r=PG&f=1", "display_name": "MattE", "link": "https://stackoverflow.com/users/6401734/matte"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 506, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1493222151, "creation_date": 1493219054, "question_id": 43637944, "link": "https://stackoverflow.com/questions/43637944/excel-vba-filtering-a-column-and-then-copying-each-item-in-the-area-collection-t", "title": "Excel VBA filtering a column and then copying each item in the area collection to a matching row", "body": "<p>I have the following Excel Table:</p>\n\n<pre><code> Create Date          Last Active Date        Age\n 4/12/2017 5:54         4/17/2020 8:54      5 Days\n                        4/19/2017 7:43       #N/A\n                        4/12/2017 20:43      #N/A\n 4/1/2017 23:20         4/3/2017 6:54       10 Days\n                        4/15/2017 22:20      #N/A\n</code></pre>\n\n<p>What I want to do is to filter the Age Column by #N/A, and then copy each Last Active Date value to the same row in Create Date.  Seems easy enough, but I keep running into issues.  I am using the SpecialCells(xlCellTypeVisible) property to then do a for each on each Area in there(non-contiguous rows), but when I go to copy the rows, it either copies the rows starting at Row 1 of the Create Date column, meaning the values get all out of whack OR it throws an error saying the ranges don't match.  Here is the code I have so far that I pulled from another page that talked about how to do this, but it doesn't seem to work for me.</p>\n\n<pre><code>    ActiveSheet.ListObjects(\"Table1\").Range.AutoFilter Field:=8, Criteria1:= _\n        \"#N/A\"\n    Dim lngrow As Long\n    Dim FinalDest As Range\n    Dim Rng As Range\n    lngrow = Sheets(\"Sheet1\").UsedRange.Rows.Count\n    Set FinalDest = Sheets(\"Sheet1\").Range(\"C2:C\" &amp; lngrow)\n    Range(\"F2:F\" &amp; lngrow).Select\n\n    For Each Rng In Cells.SpecialCells(xlCellTypeVisible).Areas\n        Set FinalDest = FinalDest.Offset(Rng.Rows.Count)\n        Rng.Copy Destination:=FinalDest\n    Next Rng\n    Application.CutCopyMode = False\n</code></pre>\n\n<p>How can I accomplish this?  I want to filter it by #N/A, and then for each filtered row that remains, copy the value in Last Active Date to Create Date, (which will always be blank for these rows) and make sure they get copied to the proper rows, ie if Row 3 is the first filtered row, the value gets copied to rows 3 instead of row 2.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 1, "creation_date": 1493219081, "post_id": 43637917, "comment_id": 74324267, "body": "To refer to the first worksheet within the other workbook all you need to do is <code>Workbooks(&quot;WorkbookName&quot;).Sheets(1)</code>. You can use index numbers to refer to the location of the sheet without knowing its name."}, {"owner": {"reputation": 117, "user_id": 4943777, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4358177ca259d3a9bb43d2c8b434cb4d?s=128&d=identicon&r=PG&f=1", "display_name": "Adryan Permana", "link": "https://stackoverflow.com/users/4943777/adryan-permana"}, "reply_to_user": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1493219242, "post_id": 43637917, "comment_id": 74324375, "body": "how can I write it in my code above? where should I add workbooks (&quot;workbookname&quot;).Sheets(1)"}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1493219372, "post_id": 43637917, "comment_id": 74324489, "body": "You need to change how you are passing in the workbook and worksheet argument. A quick fix would be to pass in the worksheet name as `Workbooks(&quot;WorkbookName&quot;).Worksheets(1).Name&quot; but I would have to see how you are using the sub to really refactor it (and doing so would be more appropriate for CodeReview anyways)."}, {"owner": {"reputation": 117, "user_id": 4943777, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4358177ca259d3a9bb43d2c8b434cb4d?s=128&d=identicon&r=PG&f=1", "display_name": "Adryan Permana", "link": "https://stackoverflow.com/users/4943777/adryan-permana"}, "reply_to_user": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1493219722, "post_id": 43637917, "comment_id": 74324732, "body": "I just  revise my code. That is the way I copy  data which I save the workbook in variable. Then I need to write the sheetname &quot;SMRY_SI_PRODUCT_VALUE_crosstab_&quot; and range.  After that I paste to other workbooks with the sheetname &quot;Summary Value Ion Essence&quot; and the range. I don&#39;t  wanna write sheetname &quot;SMRY_SI_PRODUCT_VALUE_crosstab_&quot;. I want to change it to first sheet. How can I do it?"}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1493225179, "post_id": 43637917, "comment_id": 74328491, "body": "Wherever you are using &quot;SMRY_SI_PRODUCT_VALUE_crosstab_&quot; just reference the sheet&#39;s name instead. So for example, if this was the first sheet within the workbook running the code you could do <code>ThisWorkbook.Sheets(1).Name</code>. If it is the second sheet, do <code>Sheets(2)</code> etc."}, {"owner": {"reputation": 117, "user_id": 4943777, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4358177ca259d3a9bb43d2c8b434cb4d?s=128&d=identicon&r=PG&f=1", "display_name": "Adryan Permana", "link": "https://stackoverflow.com/users/4943777/adryan-permana"}, "reply_to_user": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1493225470, "post_id": 43637917, "comment_id": 74328655, "body": "It doesn&#39;t work if I replace sheet name with ThisWorkbook.Sheets(1).Name. I need to write the sheet name so it can work. How can I do it with ThisWorkbook.Sheets(1).Name?"}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1493227391, "post_id": 43637917, "comment_id": 74329788, "body": "Use <code>Debug.Print</code> to ensure that &#39;ThisWorkbook.Sheets(1).Name` is returning a name. I would also encourage you to play around a bit on this. Calling on the <code>Name</code> property should work just fine, but it will depend on what you are trying to do with the name returned."}], "owner": {"reputation": 117, "user_id": 4943777, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4358177ca259d3a9bb43d2c8b434cb4d?s=128&d=identicon&r=PG&f=1", "display_name": "Adryan Permana", "link": "https://stackoverflow.com/users/4943777/adryan-permana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 259, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1493219381, "creation_date": 1493218983, "last_edit_date": 1493219381, "question_id": 43637917, "link": "https://stackoverflow.com/questions/43637917/vba-copy-data-from-other-workbook-without-read-sheetname-on-that-workbook", "title": "VBA copy data from other workbook without read sheetname on that workbook", "body": "<p>I have this code to copy data from one workbook to other workbook in excel. </p>\n\n<pre><code>Option Explicit\n\n\nPublic Sub GetData(SourceFile As Variant, SourceSheet As String, _\n                   SourceRange As String, TargetRange As Range, Header As Boolean, UseHeaderRow As Boolean)\n\n    Dim rsCon As Object\n    Dim rsData As Object\n    Dim szConnect As String\n    Dim szSQL As String\n    Dim lCount As Long\n\n    ' Create the connection string.\n    If Header = False Then\n        If Val(Application.Version) &lt; 12 Then\n            szConnect = \"Provider=Microsoft.ACE.OLEDB.12.0;\" &amp; _\n                        \"Data Source=\" &amp; SourceFile &amp; \";\" &amp; _\n                        \"Extended Properties=\"\"Excel 8.0;HDR=No\"\";\"\n        Else\n            szConnect = \"Provider=Microsoft.ACE.OLEDB.12.0;\" &amp; _\n                        \"Data Source=\" &amp; SourceFile &amp; \";\" &amp; _\n                        \"Extended Properties=\"\"Excel 12.0;HDR=No\"\";\"\n        End If\n    Else\n        If Val(Application.Version) &lt; 12 Then\n            szConnect = \"Provider=Microsoft.ACE.OLEDB.12.0;\" &amp; _\n                        \"Data Source=\" &amp; SourceFile &amp; \";\" &amp; _\n                        \"Extended Properties=\"\"Excel 8.0;HDR=Yes\"\";\"\n        Else\n            szConnect = \"Provider=Microsoft.ACE.OLEDB.12.0;\" &amp; _\n                        \"Data Source=\" &amp; SourceFile &amp; \";\" &amp; _\n                        \"Extended Properties=\"\"Excel 12.0;HDR=Yes\"\";\"\n        End If\n    End If\n\n    If SourceSheet = \"\" Then\n        ' workbook level name\n        szSQL = \"SELECT * FROM \" &amp; SourceRange$ &amp; \";\"\n    Else\n        ' worksheet level name or range\n        szSQL = \"SELECT * FROM [\" &amp; SourceSheet$ &amp; \"$\" &amp; SourceRange$ &amp; \"];\"\n    End If\n\n    On Error GoTo SomethingWrong\n\n    Set rsCon = CreateObject(\"ADODB.Connection\")\n    Set rsData = CreateObject(\"ADODB.Recordset\")\n\n    rsCon.Open szConnect\n    rsData.Open szSQL, rsCon, 0, 1, 1\n\n    ' Check to make sure we received data and copy the data\n    If Not rsData.EOF Then\n\n        If Header = False Then\n            TargetRange.Cells(1, 1).CopyFromRecordset rsData\n        Else\n            'Add the header cell in each column if the last argument is True\n            If UseHeaderRow Then\n                For lCount = 0 To rsData.Fields.Count - 1\n                    TargetRange.Cells(1, 1 + lCount).Value = _\n                    rsData.Fields(lCount).Name\n                Next lCount\n                TargetRange.Cells(2, 1).CopyFromRecordset rsData\n            Else\n                TargetRange.Cells(1, 1).CopyFromRecordset rsData\n            End If\n        End If\n\n    Else\n        MsgBox \"No records returned from : \" &amp; SourceFile, vbCritical\n    End If\n\n    ' Clean up our Recordset object.\n    rsData.Close\n    Set rsData = Nothing\n    rsCon.Close\n    Set rsCon = Nothing\n    Exit Sub\n\nSomethingWrong:\n    MsgBox \"The file name, Sheet name or Range is invalid of : \" &amp; SourceFile, _\n           vbExclamation, \"Error\"\n    On Error GoTo 0\n\nEnd Sub\n\nFunction LastRow(sh As Worksheet)\n    On Error Resume Next\n    LastRow = sh.Cells.Find(What:=\"*\", _\n                            After:=sh.Range(\"A1\"), _\n                            Lookat:=xlPart, _\n                            LookIn:=xlFormulas, _\n                            SearchOrder:=xlByRows, _\n                            SearchDirection:=xlPrevious, _\n                            MatchCase:=False).Row\n    On Error GoTo 0\nEnd Function\n\n\nFunction Array_Sort(ArrayList As Variant) As Variant\n    Dim aCnt As Integer, bCnt As Integer\n    Dim tempStr As String\n\n    For aCnt = LBound(ArrayList) To UBound(ArrayList) - 1\n        For bCnt = aCnt + 1 To UBound(ArrayList)\n            If ArrayList(aCnt) &gt; ArrayList(bCnt) Then\n                tempStr = ArrayList(bCnt)\n                ArrayList(bCnt) = ArrayList(aCnt)\n                ArrayList(aCnt) = tempStr\n            End If\n        Next bCnt\n    Next aCnt\n    Array_Sort = ArrayList\nEnd Function\n</code></pre>\n\n<p>In this code, I need to write sheet name on other workbook where i want to retrieve the data, so the code can work. it will be like this:</p>\n\n<pre><code>Dim IonessencePerProduct As Variant\n\nIonessencePerProduct = \"E:\\Data Kantor\\Amerta Indah Otsuka\\\nProject Sales Progress\\SMRY_SI_PRODUCT_VALUE_crosstab_ionnesence.xlsx\"\n\n        GetData IonessencePerProduct, \"SMRY_SI_PRODUCT_VALUE_crosstab_\", \"C2:O3\", \n    Sheets(\"Summary Value Ion Essence\").Range(\"D18:P19\"), False, False \n</code></pre>\n\n<p>Is there any way to retrive data from other workbook without read sheet name. Let say just select first sheet on that workbook but i need to paste it on certain sheet in the other workbook.\nThank you for the help.</p>\n"}, {"tags": ["excel", "excel-formula", "string-concatenation", "type-mismatch", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1493219103, "post_id": 43637910, "comment_id": 74324277, "body": "the quotes are not needed here <code>RampUp.Offset(0, -&quot;&quot; &amp; app &amp; &quot;&quot; + 1)</code> just do <code>RampUp.Offset(0, - 1 * app  + 1)</code>"}, {"owner": {"reputation": 25, "user_id": 4971625, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10153378436138656/picture?type=large", "display_name": "Sam Mcdonald", "link": "https://stackoverflow.com/users/4971625/sam-mcdonald"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1493219743, "post_id": 43637910, "comment_id": 74324747, "body": "I&#39;m still returning the application defined or object defined error as I was when passing a non-variable integer"}, {"owner": {"reputation": 25, "user_id": 4971625, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10153378436138656/picture?type=large", "display_name": "Sam Mcdonald", "link": "https://stackoverflow.com/users/4971625/sam-mcdonald"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1493220617, "post_id": 43637910, "comment_id": 74325399, "body": "And the code works as intended when I remove the <code>Offset(0, - 1 * app +1)</code>  portion @ScottCraner"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1493220844, "post_id": 43637910, "comment_id": 74325574, "body": "Then <code>app -1</code> is greater than the column number of <code>RampUp</code> and you are trying move off the page.  When it stops, type <code>?RampUp.Address</code> in the immediate window and also <code>?app</code> and see if <code>app - 1</code> is greater than the column number."}, {"owner": {"reputation": 25, "user_id": 4971625, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10153378436138656/picture?type=large", "display_name": "Sam Mcdonald", "link": "https://stackoverflow.com/users/4971625/sam-mcdonald"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1493222456, "post_id": 43637910, "comment_id": 74326764, "body": "Ahh thank you, that was the problem!"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 4971625, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10153378436138656/picture?type=large", "display_name": "Sam Mcdonald", "link": "https://stackoverflow.com/users/4971625/sam-mcdonald"}, "edited": false, "score": 0, "creation_date": 1493220997, "post_id": 43638485, "comment_id": 74325701, "body": "Thanks @GSerg , I had a feeling it was something wrong with my syntax which is why I passed a non-variable integer through. I&#39;m still returning the object defined error as I mentioned above, any idea why including the <code>Offset(0, - 1 * app +1)</code> would cause this?"}], "tags": [], "owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "is_accepted": false, "score": 1, "last_activity_date": 1493220487, "creation_date": 1493220487, "answer_id": 43638485, "question_id": 43637910, "link": "https://stackoverflow.com/questions/43637910/object-defined-or-application-defined-error-formula-string/43638485#43638485", "title": "Object Defined or Application Defined Error, Formula String", "body": "<p>The type mismatch comes from</p>\n\n<pre><code>RampUp.Offset(0, -\"\" &amp; app &amp; \"\" + 1)\n</code></pre>\n\n<p>The second argument you are trying to pass to <code>Offset</code> does not make much sense, and throws because according to operator precedence it's <code>(-\"\") &amp; app &amp; (\"\" + 1)</code>, and neither of the bracketed expressions can be calculated.</p>\n\n<p>Apparently you meant</p>\n\n<pre><code>RampUp.Offset(0, -app + 1)\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 4971625, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10153378436138656/picture?type=large", "display_name": "Sam Mcdonald", "link": "https://stackoverflow.com/users/4971625/sam-mcdonald"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1493220487, "creation_date": 1493218965, "last_edit_date": 1531161705, "question_id": 43637910, "link": "https://stackoverflow.com/questions/43637910/object-defined-or-application-defined-error-formula-string", "title": "Object Defined or Application Defined Error, Formula String", "body": "<p>I seem to be having a type mismatch error in the below formula. <code>Numbering</code>, <code>Approval</code>, <code>PeakShare</code>, and <code>RampUp</code> are all stored as ranges, <code>app</code> as an integer. I believe I have escaped my quotes correctly in trying to include the value of 'app'. But I get a \"Type mismatch\" error in return. I have also tried including a non-variable integer and receive an \"Object defined or application defined error.\" I have read some things about the use of indirect and approval in Excel formulas but haven't found much out there with its use in VBA, is this the problem?</p>\n\n<pre><code>formulaUp = \"=IF(\" &amp; Numbering.Address(True, False) &amp; \"&lt;\" &amp; Approval.Address &amp;    \",\"\"\"\", \" &amp; PeakShare.Address &amp; \" * \" &amp; RampUp.Offset(0, -\"\" &amp; app &amp; \"\" + 1).Address(True, False) &amp; \")\"\n</code></pre>\n"}, {"tags": ["vba", "excel", "cells", "copying"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1493218756, "post_id": 43637637, "comment_id": 74323962, "body": "What does it do instead of work?"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1493218814, "post_id": 43637637, "comment_id": 74324012, "body": "Could you please be a bit more specific? What do you mean when you say that its not working? Is the code running with an error? If so, what&#39;s the error code / message and on which line is the code breaking? Or is the code running (without an error) but merely not doing what you expected it to do? If that&#39;s the case then please share with us what it is doing (instead) and what the expected outcome is / would be. Maybe some screenshots and sample data can help in this respect."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1493218839, "post_id": 43637637, "comment_id": 74324041, "body": "Tempted to down-vote as <b>This is my code but it&#39;s not working</b> doesn&#39;t help us find the problem.  But, saying that - <code>InStr(1, celltxt, &quot;-&quot;)</code> will return the position of <code>-</code> in the string, so try using <code>InStr(1, celltxt, &quot;-&quot;)&gt;0</code>"}, {"owner": {"reputation": 27, "user_id": 7926213, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-rwSthwZG_OM/AAAAAAAAAAI/AAAAAAAABwU/3lezu1mM88Y/photo.jpg?sz=128", "display_name": "Azael Contreras", "link": "https://stackoverflow.com/users/7926213/azael-contreras"}, "edited": false, "score": 0, "creation_date": 1493219889, "post_id": 43637637, "comment_id": 74324847, "body": "I am sorry, I am new to VBA, it does not send any error but it just don&#39;t work, I&#39;ve read a lot trough internet and can&#39;t find a way to fix it.   It is supposed to copy cells &quot;BA5:BB36&quot; if there is a dash (&quot;-&quot;) or a diagonal (&quot;/&quot;) in cell &quot;B14&quot;"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1493220009, "post_id": 43637637, "comment_id": 74324930, "body": "I think you meant to say &quot;BA5:BB36&quot; in your latest comment."}], "answers": [{"comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1493219100, "post_id": 43637873, "comment_id": 74324275, "body": "You might want to reference this post in your answer: <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\" title=\"how to avoid using select in excel vba macros\">stackoverflow.com/questions/10714251/&hellip;</a> It is quite elaborate on how to avoid using <code>Select</code>. Yet, I doubt that this is the real problem here. I am guessing that the OP has &quot;incorrect&quot; code in the sense that it does not do what he / she really wants."}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1493219144, "post_id": 43637873, "comment_id": 74324308, "body": "@Ralph Good point. I used that same reference elsewhere, but didnt think of it here."}], "tags": [], "owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "is_accepted": false, "score": 0, "last_activity_date": 1493219177, "last_edit_date": 1495542357, "creation_date": 1493218880, "answer_id": 43637873, "question_id": 43637637, "link": "https://stackoverflow.com/questions/43637637/copying-to-a-macro-if-there-is-a-in-a-certain-cell-vba/43637873#43637873", "title": "Copying to a Macro if there is a &quot;-&quot; in a certain cell (VBA)", "body": "<p>Here's the refactored and fixed version:</p>\n\n<pre><code>Sub TWB_Copy_columns()\n    'TWB_Copy_columns Macro\n\n    'Range(\"B14\").Select\n    'Selection.End(xlToRight).Select\n    'celltxt = Selection.Text\n\n    ' Use explicit references and avoid select. In this case, you will need to\n    ' qualify the workbook and sheetname of the range you are using. We can then\n    ' directly access the value of that range.\n\n    ' Also, no need to declare a string just to hold onto the value. Directly use the value instead\n    With ThisWorkbook.Sheets(\"Sheetname\")\n        If InStr(1, .Range(\"B14\").End(xlToRight).value, \"-\") &gt; 0 Or InStr(1, .Range(\"B14\").End(xlToRight).value, \"/\") &gt; 0 Then\n            .Range(\"BD5:BB36\").value = .Range(\"BA5:BB36\").value\n        End If\n    End With\nEnd Sub\n</code></pre>\n\n<p>First, always avoid <code>Select</code> and <code>Activate</code>. In this case, I directly assign the values instead of trying to copy, paste, or select. Any time you see <code>Range(\"A5\").Select; Selection.Value</code> you really need <code>Range(\"A5\").Value</code>. Likewise, never have an unqualified range. <code>Range(\"A5\")</code> is the same as saying <code>ActiveSheet.Range(\"A5\")</code> which can complicate things if the wrong sheet is active.</p>\n\n<p>Finally, if you are literally using a variable for one comparison, use the direct value. There's no need to create a variable for just one task (at least in my opinion).</p>\n\n<p>Edit:</p>\n\n<p>As Ralph suggests, consider reading this thread: <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid using Select in Excel VBA macros</a>. Once you learn to avoid <code>Select</code> your abilities will skyrocket.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 0, "last_activity_date": 1493219511, "creation_date": 1493219511, "answer_id": 43638131, "question_id": 43637637, "link": "https://stackoverflow.com/questions/43637637/copying-to-a-macro-if-there-is-a-in-a-certain-cell-vba/43638131#43638131", "title": "Copying to a Macro if there is a &quot;-&quot; in a certain cell (VBA)", "body": "<p>It seems that you are looking at the displayed format of a cell's contents to determine if it is a date or not. There is a native VBA function, <code>IsDate</code> that does this determination quite well  on true dates. If your data does noot contain dates as true dates, well.. they <strong>should</strong> be true dates so that is another problem to be fixed.</p>\n\n<pre><code>with worksheets(\"sheet1\")\n    if isdate(.cells(14, \"B\").end(xltoright)) then\n        .range(\"BA5:BB36\").copy destination:=.range(\"BD5\")\n    end if\nend with\n</code></pre>\n\n<p>It seems to me that this code is only reusable if BA5:BB36 is not static but you've provided no indication on what determines the location. It's probably the last two columns of data in your data block but that is only a guess.</p>\n"}, {"tags": [], "owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "is_accepted": false, "score": 0, "last_activity_date": 1493221015, "creation_date": 1493221015, "answer_id": 43638715, "question_id": 43637637, "link": "https://stackoverflow.com/questions/43637637/copying-to-a-macro-if-there-is-a-in-a-certain-cell-vba/43638715#43638715", "title": "Copying to a Macro if there is a &quot;-&quot; in a certain cell (VBA)", "body": "<p>This does what I think you're looking for (for every \"-\" or \"/\", copy <code>Range(\"BA5:BB36\")</code> and paste it to <code>Range(\"BD5\")</code>, <code>Range(\"BG5\")</code> - leaving a space in your columns):</p>\n\n<pre><code>Sub TWB_Copy_columns()\n'TWB_Copy_columns Macro\nDim celltxt As String\nDim vWords As Variant\nDim rFind As Range\nDim i As Long\n\ncelltxt = Range(\"B14\").Value\ncelltxt = Replace(celltxt, \"-\", \"/\")\n\nvWords = Split(celltxt, \"/\")\n\nRange(\"BA5:BB36\").Copy\nRange(\"BD5\").Activate\n\nFor i = 1 To UBound(vWords)\n    ActiveCell.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n    ActiveCell.Offset(0, 2).Activate\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 7926213, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-rwSthwZG_OM/AAAAAAAAAAI/AAAAAAAABwU/3lezu1mM88Y/photo.jpg?sz=128", "display_name": "Azael Contreras", "link": "https://stackoverflow.com/users/7926213/azael-contreras"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 43638131, "answer_count": 3, "score": 2, "last_activity_date": 1493221015, "creation_date": 1493218357, "last_edit_date": 1493219523, "question_id": 43637637, "link": "https://stackoverflow.com/questions/43637637/copying-to-a-macro-if-there-is-a-in-a-certain-cell-vba", "title": "Copying to a Macro if there is a &quot;-&quot; in a certain cell (VBA)", "body": "<p>I am trying to copy some cells in the same sheet if there's a \"-\" or a \"/\" in a certain cell. </p>\n\n<p>According to the number of \"-\" or \"/\" is the number of times it is going to copy.\nThis is my code but it's not working, can anyone help?</p>\n\n<pre><code>Sub TWB_Copy_columns()\n'TWB_Copy_columns Macro\n\nDim celltxt As String\nRange(\"B14\").Select\nSelection.End(xlToRight).Select\ncelltxt = Selection.Text\nIf InStr(1, celltxt, \"-\") Or InStr(1, celltxt, \"/\") Then\n    Range(\"BA5:BB36\").Select\n    Selection.Copy\n    Range(\"BD5\").Select\n    ActiveSheet.Paste\n    Range(\"BG5\").Select\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 6373889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44b43c6545151479fa713bfe58bfbb76?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando", "link": "https://stackoverflow.com/users/6373889/fernando"}, "edited": false, "score": 0, "creation_date": 1493218538, "post_id": 43637544, "comment_id": 74323752, "body": "I need to know if macro was enable, or if know if the user clicked to the button that is in excel.. To know that if he start the macro."}], "tags": [], "owner": {"reputation": 620, "user_id": 3119180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cc7a56a59ab84634ee6cb37a7131ed2?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Holton", "link": "https://stackoverflow.com/users/3119180/rich-holton"}, "is_accepted": false, "score": 3, "last_activity_date": 1493218119, "creation_date": 1493218119, "answer_id": 43637544, "question_id": 43637435, "link": "https://stackoverflow.com/questions/43637435/how-to-unable-worksheet-change-from-excel-vba-if-macro-is-enabled/43637544#43637544", "title": "How to unable Worksheet_Change from Excel VBA if Macro is enabled", "body": "<p>To disable events, use </p>\n\n<pre><code>Application.EnableEvents = False\n</code></pre>\n\n<p>To enable events again, use</p>\n\n<pre><code>Application.EnableEvents = True\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 19, "user_id": 6373889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44b43c6545151479fa713bfe58bfbb76?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando", "link": "https://stackoverflow.com/users/6373889/fernando"}, "edited": false, "score": 0, "creation_date": 1493225171, "post_id": 43638035, "comment_id": 74328488, "body": "Thank you, well explained. Finally I can :)"}], "tags": [], "owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "is_accepted": true, "score": 0, "last_activity_date": 1493219232, "creation_date": 1493219232, "answer_id": 43638035, "question_id": 43637435, "link": "https://stackoverflow.com/questions/43637435/how-to-unable-worksheet-change-from-excel-vba-if-macro-is-enabled/43638035#43638035", "title": "How to unable Worksheet_Change from Excel VBA if Macro is enabled", "body": "<p>Here's a minimal example of turning the event on or off depending on some button a user can press.</p>\n\n<p>You don't mention in your question what button is pressed - or what code is run - but you should be able to adapt the code below to your circumstances:</p>\n\n<p>You have two buttons on a sheet:\n<a href=\"https://i.stack.imgur.com/Lr7dN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Lr7dN.png\" alt=\"enter image description here\"></a></p>\n\n<p>In in the Sheet1 code module:</p>\n\n<pre><code>Option Explicit\n\nDim blnUserFlag As Boolean\n\nPublic Sub Button1_Click()\n    blnUserFlag = True\nEnd Sub\n\nPublic Sub Button2_Click()\n    blnUserFlag = False\nEnd Sub\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    If blnUserFlag = False Then\n        'do stuff\n        Debug.Print \"change\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>Right click each button and use the Assign Macro option to assign <code>Button1_Click</code> and <code>Button2_Click</code> to the buttons.</p>\n\n<p>The technique is to have a flag (a <code>Boolean</code>) variable - <code>blnUserFlag</code> - outside of the event code that can be turned 'on' or 'off' by the buttons. This then controls whether the code inside the event can run.</p>\n"}], "owner": {"reputation": 19, "user_id": 6373889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44b43c6545151479fa713bfe58bfbb76?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando", "link": "https://stackoverflow.com/users/6373889/fernando"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 664, "favorite_count": 0, "accepted_answer_id": 43638035, "answer_count": 2, "score": 0, "last_activity_date": 1493219232, "creation_date": 1493217843, "last_edit_date": 1493217931, "question_id": 43637435, "link": "https://stackoverflow.com/questions/43637435/how-to-unable-worksheet-change-from-excel-vba-if-macro-is-enabled", "title": "How to unable Worksheet_Change from Excel VBA if Macro is enabled", "body": "<p>well I have a big doubt, actually I'm developing a excel vba application, but I have a problem, I'm using the event of worksheet (<code>Worksheet_Change</code>), but I want that this event doesn't execute if macro is running...</p>\n\n<p>The macro runs or enable when the user press a button, so I want that if the user click the button (active the macro) all the logic or functions that I have in Worksheet_Change can not be executed..</p>\n\n<p>I have this in my worksheet_change:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim aCell As Range, Rng As Range\n    Dim SearchString As String\n    Dim myValue As Variant\n    Set Rng = Range(\"F10:F153\")\n    Dim myList As Object\n    Set myList = CreateObject(\"Scripting.Dictionary\")\n    myList.Add \"1234\", 1\n    myList.Add \"12345\", 2\n    myList.Add \"123456\", 3\n    SearchString = \"Error\"\n\n    For Each aCell In Rng\n        If InStr(1, aCell.Value, SearchString, vbTextCompare) Then\n            MsgBox \"Error encontrado. \"\n            myValue = InputBox(\"Inserte el numero de empleado de algun operador de calidad\")\n            If myList.Exists(myValue) Then\n                MsgBox \"Numero de empleado correcto, verifique su error.\"\n            Else\n            While myList.Exists(myValue) = False\n\n                myValue = InputBox(\"Inserte el numero de empleado de algun miembro de calidad\")\n            Wend\n            MsgBox \"Numero de empleado correcto, verifique su error.\"\n            End If\n        End If\n        Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "email", "outlook"], "comments": [{"owner": {"reputation": 156, "user_id": 5227322, "user_type": "registered", "accept_rate": 29, "profile_image": "https://graph.facebook.com/10153168692082515/picture?type=large", "display_name": "Mark S", "link": "https://stackoverflow.com/users/5227322/mark-s"}, "reply_to_user": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1493218464, "post_id": 43637311, "comment_id": 74323692, "body": "No, that doesn&#39;t help me. I need to specify a nested folder under the &quot;Inbox&quot; folder. I&#39;m asking how you specify the hierarchy of Outlook folders with Excel VBA."}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1493225995, "post_id": 43637311, "comment_id": 74328941, "body": "You have Set objnSpace = Nothing then try to use objnSpace later"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1493339862, "post_id": 43637311, "comment_id": 74387005, "body": "Can you explain little more to what your trying to do in your code?"}, {"owner": {"reputation": 156, "user_id": 5227322, "user_type": "registered", "accept_rate": 29, "profile_image": "https://graph.facebook.com/10153168692082515/picture?type=large", "display_name": "Mark S", "link": "https://stackoverflow.com/users/5227322/mark-s"}, "edited": false, "score": 0, "creation_date": 1493387969, "post_id": 43637311, "comment_id": 74410157, "body": "This line of code works: Set objFolder = <b>objnSpace.Folders(&quot;NoctalkSW&quot;).Folders(&quot;Inbox&quot;)</b> but this line of code does NOT work <b>objnSpace.Folders(&quot;NoctalkSW&quot;).Folders(&quot;Inbox&quot;).Folders(&quot;COM&zwnj;&#8203;PLETED&quot;)</b>. When I try and access a folder lower then the second level of Outlook, the code returns the &quot;No such folder&quot; message. Does that make more sense?"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1493433082, "post_id": 43637311, "comment_id": 74428529, "body": "One more quick question that I forgot to ask, are you working on your default inbox or shared inbox?"}, {"owner": {"reputation": 156, "user_id": 5227322, "user_type": "registered", "accept_rate": 29, "profile_image": "https://graph.facebook.com/10153168692082515/picture?type=large", "display_name": "Mark S", "link": "https://stackoverflow.com/users/5227322/mark-s"}, "edited": false, "score": 0, "creation_date": 1493531859, "post_id": 43637311, "comment_id": 74451455, "body": "I&#39;m working in a Shared Mailbox named NoctalkSW. To simulate what I&#39;m doing here, you can use a Shared Mailbox called &quot;SharedTest1&quot;, then in the &quot;Inbox&quot; of that folder, create another folder called &quot;Completed&quot;. How can we get a count from the &quot;completed&quot; folder? That&#39;s the trouble I&#39;m having. My code accesses the &quot;Inbox&quot; folder, but when I try and access a folder in the &quot;Completed&quot; folder, it comes back with &quot;No such folder&quot;. Hope this makes more sense now."}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1564937279, "post_id": 43637311, "comment_id": 101184631, "body": "If you found Eugene&#39;s answer successful with the removal of <code>Set objNamespace = Nothing</code> consider accepting, to remove the question from unanswered."}], "answers": [{"comments": [{"owner": {"reputation": 156, "user_id": 5227322, "user_type": "registered", "accept_rate": 29, "profile_image": "https://graph.facebook.com/10153168692082515/picture?type=large", "display_name": "Mark S", "link": "https://stackoverflow.com/users/5227322/mark-s"}, "edited": false, "score": 0, "creation_date": 1493294559, "post_id": 43643184, "comment_id": 74361634, "body": "The code does not need to be debugged because it works until I try and specify a folder under the &quot;Inbox&quot; folder. Like I said above, when I try and do that it gives me the &quot;No such folder&quot; message because it doesn&#39;t know what folder I&#39;m talking about. I&#39;ll try this but I have to say that this just looks like you re-pasted my code from up top. What&#39;s the difference here? I don&#39;t see it."}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1493643195, "post_id": 43643184, "comment_id": 74482140, "body": "The first instance of Set objnSpace = Nothing was deleted."}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 1, "last_activity_date": 1493235705, "creation_date": 1493235705, "answer_id": 43643184, "question_id": 43637311, "link": "https://stackoverflow.com/questions/43637311/how-to-specify-nested-folder-in-outlook-using-excel-vba/43643184#43643184", "title": "How to specify nested folder in Outlook using Excel VBA", "body": "<p>Did you try to debug the code? Anyway, try to use the following code:</p>\n\n<pre><code>Option Explicit\n\nSub HowManyEmails() \n Dim objOutlook As Object, objnSpace As Object, objFolder As Object\n Dim EmailCount As Integer\n Set objOutlook = CreateObject(\"Outlook.Application\")\n Set objnSpace = objOutlook.GetNamespace(\"MAPI\")\n\n On Error Resume Next\n Set objFolder = objnSpace.Folders(\"NoctalkSW\").Folders(\"Inbox\")\n If Err.Number &lt;&gt; 0 Then\n  Err.Clear\n  MsgBox \"No such folder.\"\n  Exit Sub\n End If\n\n EmailCount = objFolder.Items.Count\n Set objFolder = Nothing\n Set objOutlook = Nothing\n\n [B2].Value = EmailCount\n\n On Error Resume Next\n Set objFolder = objnSpace.Folders(\"NoctalkSW\").Folders(\"Inbox\").Folders(\"COMPLETED\")\n If Err.Number &lt;&gt; 0 Then\n  Err.Clear\n  MsgBox \"No such folder.\"\n  Exit Sub\n End If\n\n EmailCount = objFolder.Items.Count\n Set objFolder = Nothing\n Set objnSpace = Nothing\n Set objOutlook = Nothing\n\n [B3].Value = EmailCount\nEnd Sub\n</code></pre>\n\n<p>Also you may try to iterate over folders, see <a href=\"https://msdn.microsoft.com/en-us/library/office/ff184607.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">How to: Enumerate Folders</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 156, "user_id": 5227322, "user_type": "registered", "accept_rate": 29, "profile_image": "https://graph.facebook.com/10153168692082515/picture?type=large", "display_name": "Mark S", "link": "https://stackoverflow.com/users/5227322/mark-s"}, "edited": false, "score": 0, "creation_date": 1493927025, "post_id": 43717807, "comment_id": 74623672, "body": "I appreciate your attempt at solving this 0m3r. Your code was unable to execute. It stopped on the line where it says &#39;[B3].Value = SubFolder.Items.Count&#39; with the error message of &quot;Run-time error &#39;-2147221241 (80040107)&#39;: The operation failed.&quot;"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "reply_to_user": {"reputation": 156, "user_id": 5227322, "user_type": "registered", "accept_rate": 29, "profile_image": "https://graph.facebook.com/10153168692082515/picture?type=large", "display_name": "Mark S", "link": "https://stackoverflow.com/users/5227322/mark-s"}, "edited": false, "score": 0, "creation_date": 1493963013, "post_id": 43717807, "comment_id": 74634865, "body": "Nothing wrong with the code @MarkS that error could be the Exchange cached mode \\ or slow connection- Try looking at your advanced additional mailboxes: Cached Exchange mode settings."}, {"owner": {"reputation": 156, "user_id": 5227322, "user_type": "registered", "accept_rate": 29, "profile_image": "https://graph.facebook.com/10153168692082515/picture?type=large", "display_name": "Mark S", "link": "https://stackoverflow.com/users/5227322/mark-s"}, "edited": false, "score": 0, "creation_date": 1494060883, "post_id": 43717807, "comment_id": 74675668, "body": "No, it&#39;s not working. I tried. The solution I&#39;m using is from this page. It pulls over all the email counts from every folder into Excel. Then I pull what I need over from the worksheet with the folder count to the other worksheet I have. See this code: <a href=\"http://stackoverflow.com/a/43613635/5227322\">stackoverflow.com/a/43613635/5227322</a>"}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 1, "last_activity_date": 1493635261, "creation_date": 1493635261, "answer_id": 43717807, "question_id": 43637311, "link": "https://stackoverflow.com/questions/43637311/how-to-specify-nested-folder-in-outlook-using-excel-vba/43717807#43717807", "title": "How to specify nested folder in Outlook using Excel VBA", "body": "<p><em>If you wanna access shared Inbox and subfolder then Work with <strong><a href=\"https://msdn.microsoft.com/en-us/library/office/aa220116%28v=office.11%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">GetSharedDefaultFolder Method</a></em></strong></p>\n\n<blockquote>\n  <p><em><sub><strong><a href=\"https://msdn.microsoft.com/en-us/library/office/aa220116%28v=office.11%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">GetSharedDefaultFolder Method</a></strong> Returns a MAPIFolder object that represents the specified default folder for the specified user. This method is used in a delegation scenario, where one user has delegated access to another user for one or more of their default folders.</sub></em></p>\n  \n  <hr>\n</blockquote>\n\n<p><em>Code Example</em></p>\n\n<pre><code>Option Explicit\nConst olFolderInbox = 6\nSub HowManyEmails()\n    Dim olApp As Object\n    Dim olNs As Object\n    Dim Inbox As Object\n    Dim SubFolder As Object\n    Dim Recip As Object\n\n    Set olApp = CreateObject(\"Outlook.Application\")\n    Set olNs = olApp.GetNamespace(\"MAPI\")\n    Set Recip = olNs.CreateRecipient(\"0m3r@email.com\") ' Share address\n        Recip.Resolve\n    Set Inbox = olNs.GetSharedDefaultFolder(Recip, olFolderInbox) ' Inbox\n\n    [B2].Value = Inbox.Items.Count\n\n    Set SubFolder = Inbox.Folders(\"COMPLETED\") ' subfolder\n\n    [B3].Value = SubFolder.Items.Count\n\n    Set olApp = Nothing\n    Set olNs = Nothing\n    Set Inbox = Nothing\n    Set SubFolder = Nothing\n    Set Recip = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 156, "user_id": 5227322, "user_type": "registered", "accept_rate": 29, "profile_image": "https://graph.facebook.com/10153168692082515/picture?type=large", "display_name": "Mark S", "link": "https://stackoverflow.com/users/5227322/mark-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1585, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1592700303, "creation_date": 1493217479, "last_edit_date": 1592700303, "question_id": 43637311, "link": "https://stackoverflow.com/questions/43637311/how-to-specify-nested-folder-in-outlook-using-excel-vba", "title": "How to specify nested folder in Outlook using Excel VBA", "body": "<p>I need help specifying a nested folder in Outlook using Excel VBA. I will post the code I'm using below. </p>\n\n<p>I'm able to specify the \"Inbox\" folder but when I try and specify a folder that is within the \"Inbox\" folder, the code comes back with the \"No such folder\" message. </p>\n\n<p>Does anyone know why this is happening to me? If so, how can I fix it?</p>\n\n<pre><code>Option Explicit\nSub HowManyEmails()\n    Dim objOutlook As Object, objnSpace As Object, objFolder As Object\n    Dim EmailCount As Integer\n    Set objOutlook = CreateObject(\"Outlook.Application\")\n    Set objnSpace = objOutlook.GetNamespace(\"MAPI\")\n\n    On Error Resume Next\n    Set objFolder = objnSpace.Folders(\"NoctalkSW\").Folders(\"Inbox\")\n    If Err.Number &lt;&gt; 0 Then\n        Err.Clear\n        MsgBox \"No such folder.\"\n        Exit Sub\n    End If\n\n    EmailCount = objFolder.Items.Count\n    Set objFolder = Nothing\n    Set objnSpace = Nothing\n    Set objOutlook = Nothing\n\n    [B2].Value = EmailCount\n\n    On Error Resume Next\n    Set objFolder = \n    objnSpace.Folders(\"NoctalkSW\").Folders(\"Inbox\").Folders(\"COMPLETED\")\n    If Err.Number &lt;&gt; 0 Then\n        Err.Clear\n        MsgBox \"No such folder.\"\n        Exit Sub\n    End If\n\n    EmailCount = objFolder.Items.Count\n    Set objFolder = Nothing\n    Set objnSpace = Nothing\n    Set objOutlook = Nothing\n\n    [B3].Value = EmailCount\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "rtf", "richtext"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1493278938, "post_id": 43637252, "comment_id": 74350590, "body": "For experimenting / debugging, you can add a second textbox to your form, with the same control source, but with TextFormat = Plain Text. This will show the HTML source."}], "answers": [{"comments": [{"owner": {"reputation": 1872, "user_id": 4408787, "user_type": "registered", "accept_rate": 61, "profile_image": "https://lh6.googleusercontent.com/-KbDNZLk5Siw/AAAAAAAAAAI/AAAAAAAAADw/RFrz3xexfHU/photo.jpg?sz=128", "display_name": "Allen Wang", "link": "https://stackoverflow.com/users/4408787/allen-wang"}, "edited": false, "score": 0, "creation_date": 1493223502, "post_id": 43637705, "comment_id": 74327471, "body": "I tried to use normal HTML formatting, assuming that I can replace tags <code>&lt;font face=...&gt;</code> and &lt;..size=..&gt;. Some of these tags are replaced, but there are other areas where the font and size don&#39;t change. I&#39;ve tested on regular strings with HTML tags and those work correctly, but when I pass it into the access function it doesn&#39;t. This makes me suspect that rich text isn&#39;t exactly HTML"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 1872, "user_id": 4408787, "user_type": "registered", "accept_rate": 61, "profile_image": "https://lh6.googleusercontent.com/-KbDNZLk5Siw/AAAAAAAAAAI/AAAAAAAAADw/RFrz3xexfHU/photo.jpg?sz=128", "display_name": "Allen Wang", "link": "https://stackoverflow.com/users/4408787/allen-wang"}, "edited": false, "score": 1, "creation_date": 1493277847, "post_id": 43637705, "comment_id": 74349944, "body": "It is, but it is limited. I&#39;ve added a link to the answer."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 2, "last_activity_date": 1493277804, "last_edit_date": 1493277804, "creation_date": 1493218478, "answer_id": 43637705, "question_id": 43637252, "link": "https://stackoverflow.com/questions/43637252/msaccess-2010-memo-field-formatting-rich-text-specification/43637705#43637705", "title": "msaccess 2010 memo field formatting, rich text specification", "body": "<p>Up to Access 2003, you had a <em>RichText (RTF) OCX Control</em> producing true RTF formatted text.</p>\n\n<p>From Access 2007 \"rich text\" means <em>HTML</em>, thus your control hos nothing to do with true RTF. \"Rich text\" only means that you can store text with HTML formatting.</p>\n\n<p>However, only a <em>subset</em> of HTML is supported:\n<a href=\"https://support.office.com/en-us/article/Insert-or-add-a-rich-text-field-9f86237d-dbbc-4a85-b12c-9d8dca824630?CorrelationId=ac138a5a-af87-4fd3-b3f9-dfdc21b7ac05&amp;ui=en-US&amp;rs=en-US&amp;ad=US&amp;ocmsassetID=HA010014097\" rel=\"nofollow noreferrer\">Insert or add a rich text field</a></p>\n"}], "owner": {"reputation": 1872, "user_id": 4408787, "user_type": "registered", "accept_rate": 61, "profile_image": "https://lh6.googleusercontent.com/-KbDNZLk5Siw/AAAAAAAAAAI/AAAAAAAAADw/RFrz3xexfHU/photo.jpg?sz=128", "display_name": "Allen Wang", "link": "https://stackoverflow.com/users/4408787/allen-wang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 894, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1493277804, "creation_date": 1493217336, "question_id": 43637252, "link": "https://stackoverflow.com/questions/43637252/msaccess-2010-memo-field-formatting-rich-text-specification", "title": "msaccess 2010 memo field formatting, rich text specification", "body": "<p>I am trying to format the font and size of some columns that have the <code>memo, rich text</code> datatype in Access 2010. Currently, users will oftentimes copy paste from different sources, but I want to be able to standardize the formatting without having to manually do it for each cell.</p>\n\n<p>I was unable to find a way to do so via the Access user interface (it appears you can only change plain text formatting), so I attempted a VBA solution using regular expressions. However, it seems that the Microsoft's RTF specification isn't standard html. Some of the tags do seem to change when I pass it through my html parser, but others don't.</p>\n\n<p>First, is there a way to directly view rich text with all of its meta tags? I have tried copying and pasting, but this copies the text as plaintext without tags.</p>\n\n<p>Second, if I can't do this, is there some source that lists the Microsoft specification of rich text tags? I'm not looking to see what kinds of formatting are available, rather I want to know what tags (such as <code>&lt;font face=...&gt;</code>) correspond to font, size, etc.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1493216865, "post_id": 43637023, "comment_id": 74322379, "body": "You just need to set <code>linha_um = linha_inicio</code> before the <code>Do While...</code> because the first time you use <code>Cells</code> then <code>linha_um</code> will be 0."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1493216884, "post_id": 43637023, "comment_id": 74322393, "body": "you are missing the <code>linha_um = linha_um + 1</code> and outer <code>Loop</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1493216977, "post_id": 43637023, "comment_id": 74322483, "body": "1. Don&#39;t try and assign a number to a cell&#39;s .Value2 property, just assign it to the cell; e.g. <code>Cells(linha_um, coluna_um) = preenche_com</code> 2. Qualify the parent worksheet. A With .. End With might be best here. 3. Use <code>Option Explicit</code> and declare your vars (see <a href=\"http://stackoverflow.com/documentation/excel-vba/1107/vba-best-practices/3554/always-use-option-explicit#t=201704261430228061084\">ALWAYS Use &quot;Option Explicit&quot;</a>."}, {"owner": {"reputation": 103, "user_id": 7528751, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/f98ec0b477a1485e9cbde42fd993bd35?s=128&d=identicon&r=PG&f=1", "display_name": "Erick", "link": "https://stackoverflow.com/users/7528751/erick"}, "edited": false, "score": 0, "creation_date": 1493217312, "post_id": 43637023, "comment_id": 74322745, "body": "Scott, yes I do. It was a copy and past mistake. I will correct it but that isn&#39;t the problem"}, {"owner": {"reputation": 103, "user_id": 7528751, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/f98ec0b477a1485e9cbde42fd993bd35?s=128&d=identicon&r=PG&f=1", "display_name": "Erick", "link": "https://stackoverflow.com/users/7528751/erick"}, "edited": false, "score": 0, "creation_date": 1493217408, "post_id": 43637023, "comment_id": 74322815, "body": "Thanks Peh and Jeeped"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1493218525, "post_id": 43637023, "comment_id": 74323740, "body": "If you are trying to prep a worksheet for some other operation like importing into SQL then you need to revert the formulas that return zero-length strings to their underlying values then cycle through each column with TextToColumns, Fixed Width, Finish to create truly blank cells. These will import into SQL."}], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 7528751, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/f98ec0b477a1485e9cbde42fd993bd35?s=128&d=identicon&r=PG&f=1", "display_name": "Erick", "link": "https://stackoverflow.com/users/7528751/erick"}, "edited": false, "score": 0, "creation_date": 1493226031, "post_id": 43637588, "comment_id": 74328960, "body": "Thank you @Jeeped, help me a lot! Why did you put periods in front of most functions?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 103, "user_id": 7528751, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/f98ec0b477a1485e9cbde42fd993bd35?s=128&d=identicon&r=PG&f=1", "display_name": "Erick", "link": "https://stackoverflow.com/users/7528751/erick"}, "edited": false, "score": 0, "creation_date": 1493226401, "post_id": 43637588, "comment_id": 74329190, "body": "... because using <code>with worksheets(&quot;Sheet1&quot;)</code> means that .Range and  .Cells in <code>.range(.cells(5, 2), .cells(101, 16))</code> belong to Sheet1. For the same reason, .Cells, .Rows.Count and .SpecialCells inside <code>with .range(.cells(5, 2), .cells(101, 16))</code> belong to .range(.cells(5, 2), .cells(101, 16))."}, {"owner": {"reputation": 103, "user_id": 7528751, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/f98ec0b477a1485e9cbde42fd993bd35?s=128&d=identicon&r=PG&f=1", "display_name": "Erick", "link": "https://stackoverflow.com/users/7528751/erick"}, "edited": false, "score": 0, "creation_date": 1493238690, "post_id": 43637588, "comment_id": 74336299, "body": "Ok, got it. But then why doesn&#39;t my code work? Why is <code>If IsEmpty(Cells(linha_um, coluna_um)) Then                  Cells(linha_um, coluna_um) = preenche_com             End If </code> wrong?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 103, "user_id": 7528751, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/f98ec0b477a1485e9cbde42fd993bd35?s=128&d=identicon&r=PG&f=1", "display_name": "Erick", "link": "https://stackoverflow.com/users/7528751/erick"}, "edited": false, "score": 0, "creation_date": 1493249992, "post_id": 43637588, "comment_id": 74340872, "body": "I honestly do not know why your code (from the latest edit) does not work. I tried it and even threw a forced <code>#DIV&#47;0!</code> error into the worksheet but <code>IsEmpty</code> skipped over it and completed its task."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1493218216, "creation_date": 1493218216, "answer_id": 43637588, "question_id": 43637023, "link": "https://stackoverflow.com/questions/43637023/vba-function-cells-inside-isempty/43637588#43637588", "title": "VBA: Function Cells inside IsEmpty", "body": "<p>It looks like you are trying to loop through <em>linha</em> (i.e. <em>rows</em>) from 5 to 101 and <em>coluna</em> (i.e. <em>columns</em>) from B to P (2 to 16) and put a zero in any blank cell.</p>\n\n<pre><code>with worksheets(\"Sheet1\")\n    with .range(.cells(5, 2), .cells(101, 16))\n        'make sure that .UsedRange extends at least as far as the extents\n        if isempty(.cells(.rows.count, .columns.count)) then _\n            .cells(.rows.count, .columns.count) = 0\n        'skip over if there are no blank cells\n        on error resume next\n        .specialcells(xlcelltypeblanks) = 0\n        'reset standard error protocol\n        on error goto 0\n    end with\nend with\n</code></pre>\n\n<p>Remember that cells containing zero-length strings (e.g. <code>\"\"</code> or <code>TEXT(,)</code> from a formula) are not truly blank.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 3255262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/116215390489fb0ee26dcc5fc2a6d087?s=128&d=identicon&r=PG&f=1", "display_name": "HappyHead", "link": "https://stackoverflow.com/users/3255262/happyhead"}, "is_accepted": false, "score": 0, "last_activity_date": 1493218946, "creation_date": 1493218946, "answer_id": 43637901, "question_id": 43637023, "link": "https://stackoverflow.com/questions/43637023/vba-function-cells-inside-isempty/43637901#43637901", "title": "VBA: Function Cells inside IsEmpty", "body": "<p>Change to below to get the column number:</p>\n\n<pre><code>coluna_inicio = Columns(\"B\").Column\ncoluna_final = Columns(\"P\").Column\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 7528751, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/f98ec0b477a1485e9cbde42fd993bd35?s=128&d=identicon&r=PG&f=1", "display_name": "Erick", "link": "https://stackoverflow.com/users/7528751/erick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 422, "favorite_count": 0, "accepted_answer_id": 43637588, "answer_count": 2, "score": 2, "last_activity_date": 1493218946, "creation_date": 1493216760, "last_edit_date": 1493218543, "question_id": 43637023, "link": "https://stackoverflow.com/questions/43637023/vba-function-cells-inside-isempty", "title": "VBA: Function Cells inside IsEmpty", "body": "<p>can you help me with this VBA code. I think what is wrong is the Cells function inside the IsEmpty function, that is the line that is Excel is accusing to be wrong. I have made some changes due to the comments, but it still is not running. The problem is with the line that is the IsEmpty function.</p>\n\n<pre><code>    Sub preenche_lacunas()\n\nDim linha_um As Integer\nDim linha_inicio As Integer\nDim linha_final As Integer\nDim coluna_um As Integer\nDim coluna_inicio As Integer\nDim coluna_final As Integer\nDim preenche_com As Integer    \n\n\n    linha_inicio = 5\n    linha_final = 101\n\n    coluna_inicio = 2\n    coluna_final = 16\n\n    preenche_com = 0\n\n    linha_um = linha_inicio\n    Do While (linha_um &lt;= linha_final)\n\n        coluna_um = coluna_inicio\n        Do While (coluna_um &lt;= coluna_final)\n\n            If IsEmpty(Cells(linha_um, coluna_um)) Then\n\n                Cells(linha_um, coluna_um) = preenche_com\n            End If\n\n            coluna_um = coluna_um + 1\n        Loop\n\n        linha_um = linha_um + 1\n    Loop\n\n    End Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 178, "user_id": 7797433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1f96c98c332cc99a3f6b6d27761b2c4?s=128&d=identicon&r=PG&f=1", "display_name": "gr8tech", "link": "https://stackoverflow.com/users/7797433/gr8tech"}, "edited": false, "score": 0, "creation_date": 1493216543, "post_id": 43636887, "comment_id": 74322083, "body": "approximately how big is your data, and how do you decide that row3 should be deleted and not row4?"}, {"owner": {"reputation": 5048, "user_id": 4262057, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e3b73d68ee4019a7d5cc982522310555?s=128&d=identicon&r=PG&f=1", "display_name": "JohnAndrews", "link": "https://stackoverflow.com/users/4262057/johnandrews"}, "reply_to_user": {"reputation": 178, "user_id": 7797433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1f96c98c332cc99a3f6b6d27761b2c4?s=128&d=identicon&r=PG&f=1", "display_name": "gr8tech", "link": "https://stackoverflow.com/users/7797433/gr8tech"}, "edited": false, "score": 0, "creation_date": 1493216643, "post_id": 43636887, "comment_id": 74322175, "body": "I just want the last row to be kept thats the decision. Data somewhere from 1000 to 10000 rows."}, {"owner": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "edited": false, "score": 0, "creation_date": 1493216850, "post_id": 43636887, "comment_id": 74322363, "body": "What is the uniqueness constraint you mentioned in column 1?"}, {"owner": {"reputation": 5048, "user_id": 4262057, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e3b73d68ee4019a7d5cc982522310555?s=128&d=identicon&r=PG&f=1", "display_name": "JohnAndrews", "link": "https://stackoverflow.com/users/4262057/johnandrews"}, "edited": false, "score": 0, "creation_date": 1493217046, "post_id": 43636887, "comment_id": 74322527, "body": "Just that I want the unique values in column A."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1493217236, "post_id": 43636887, "comment_id": 74322680, "body": "Can you reverse the sort order in a way that the top one is kept, if so you can use remove duplicates on the data tab.  But you need to sort it in a manner that the one to keep is the first not the last."}, {"owner": {"reputation": 178, "user_id": 7797433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1f96c98c332cc99a3f6b6d27761b2c4?s=128&d=identicon&r=PG&f=1", "display_name": "gr8tech", "link": "https://stackoverflow.com/users/7797433/gr8tech"}, "edited": false, "score": 0, "creation_date": 1493218515, "post_id": 43636887, "comment_id": 74323734, "body": "Can you also confirm the data is sorted like in the example"}], "answers": [{"tags": [], "owner": {"reputation": 178, "user_id": 7797433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1f96c98c332cc99a3f6b6d27761b2c4?s=128&d=identicon&r=PG&f=1", "display_name": "gr8tech", "link": "https://stackoverflow.com/users/7797433/gr8tech"}, "is_accepted": true, "score": 0, "last_activity_date": 1493219256, "creation_date": 1493219256, "answer_id": 43638046, "question_id": 43636887, "link": "https://stackoverflow.com/questions/43636887/delete-duplicate-rows-based-on-an-uniqueness-constraint-of-a-column-in-vba/43638046#43638046", "title": "Delete duplicate rows based on an uniqueness constraint of a column in VBA", "body": "<p>Try out this code, replace the sheet7 with your worksheet;</p>\n\n<pre><code>Dim x As String 'place holder for column A data\n\nDim rc As Long 'row counter\n\nx = Sheet7.Range(\"A2\").Value 'get 1st value \nrc = 3 'initialize with next row\n\nDo While x &lt;&gt; \"\" 'search until you encounter a blank row\n   If x = Sheet7.Range(\"A\" &amp; rc).Value Then\n        Sheet7.Range(rc &amp; \":\" &amp; rc).Delete\n   Else\n        x = Sheet7.Range(\"A\" &amp; rc)\n        rc = rc + 1\n   End If\nLoop\n</code></pre>\n"}], "owner": {"reputation": 5048, "user_id": 4262057, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e3b73d68ee4019a7d5cc982522310555?s=128&d=identicon&r=PG&f=1", "display_name": "JohnAndrews", "link": "https://stackoverflow.com/users/4262057/johnandrews"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 43638046, "answer_count": 1, "score": 0, "last_activity_date": 1519366274, "creation_date": 1493216405, "last_edit_date": 1493216517, "question_id": 43636887, "link": "https://stackoverflow.com/questions/43636887/delete-duplicate-rows-based-on-an-uniqueness-constraint-of-a-column-in-vba", "title": "Delete duplicate rows based on an uniqueness constraint of a column in VBA", "body": "<p>Given several rows in excel with columns:</p>\n\n<pre><code>row1:   header1 header2 header3\nrow2:   A1      B1      C1\nrow3:   A2      B2      C2\nrow4:   A2      B3      C2\n</code></pre>\n\n<p>How do I delete duplicate rows based on uniqueness constraint for header 1.</p>\n\n<p>I.e. I only want to return the last unique row.</p>\n\n<p>E.g. row3 is deleted and row4 kept</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7925823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f89ad313e9d24670c01b200ee693e38e?s=128&d=identicon&r=PG&f=1", "display_name": "OldGuy", "link": "https://stackoverflow.com/users/7925823/oldguy"}, "edited": false, "score": 0, "creation_date": 1493219339, "post_id": 43637677, "comment_id": 74324460, "body": "This looks great!  Why the stipulation for <b>Office 365 Excel</b>?  Will a full installation of Excel 2013 work?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 13, "user_id": 7925823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f89ad313e9d24670c01b200ee693e38e?s=128&d=identicon&r=PG&f=1", "display_name": "OldGuy", "link": "https://stackoverflow.com/users/7925823/oldguy"}, "edited": false, "score": 0, "creation_date": 1493219514, "post_id": 43637677, "comment_id": 74324579, "body": "maybe, TextJoin was introduce Feb 2016 and is available to Office 365 users.  It may have been added as an addon to Excel 2013.  If not just add the code to a module, it mimics the TextJoin that is native in the newest version of excel.  Then you can use it with the formula I suggested."}, {"owner": {"reputation": 13, "user_id": 7925823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f89ad313e9d24670c01b200ee693e38e?s=128&d=identicon&r=PG&f=1", "display_name": "OldGuy", "link": "https://stackoverflow.com/users/7925823/oldguy"}, "edited": false, "score": 0, "creation_date": 1493221107, "post_id": 43637677, "comment_id": 74325792, "body": "I&#39;ve added the UDF and the formula, adjusted the cell references, but the formula returns a #NAME? error.  Do I have to register the UDF in some way other than saving it in the VBA module?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 13, "user_id": 7925823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f89ad313e9d24670c01b200ee693e38e?s=128&d=identicon&r=PG&f=1", "display_name": "OldGuy", "link": "https://stackoverflow.com/users/7925823/oldguy"}, "edited": false, "score": 0, "creation_date": 1493221188, "post_id": 43637677, "comment_id": 74325847, "body": "Di you put the code in a module?  It cannot go in the worksheet code or ThisWorkbook code.  You must add a module and put the code in that.  The module must be attached to your workbook."}, {"owner": {"reputation": 13, "user_id": 7925823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f89ad313e9d24670c01b200ee693e38e?s=128&d=identicon&r=PG&f=1", "display_name": "OldGuy", "link": "https://stackoverflow.com/users/7925823/oldguy"}, "edited": false, "score": 0, "creation_date": 1493221770, "post_id": 43637677, "comment_id": 74326280, "body": "Well done, sir!  I started with a new workbook and made certain to clean out all of the other UDFs not in use and it worked as advertised.  Thank you so very much."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 13, "user_id": 7925823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f89ad313e9d24670c01b200ee693e38e?s=128&d=identicon&r=PG&f=1", "display_name": "OldGuy", "link": "https://stackoverflow.com/users/7925823/oldguy"}, "edited": false, "score": 0, "creation_date": 1493221939, "post_id": 43637677, "comment_id": 74326389, "body": "@OldGuy please mark as correct by clicking on the check mark by the answer."}, {"owner": {"reputation": 13, "user_id": 7925823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f89ad313e9d24670c01b200ee693e38e?s=128&d=identicon&r=PG&f=1", "display_name": "OldGuy", "link": "https://stackoverflow.com/users/7925823/oldguy"}, "edited": false, "score": 0, "creation_date": 1493232818, "post_id": 43637677, "comment_id": 74332963, "body": "Regrets my Friend.  New to this process and forum. Cheers."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 0, "last_activity_date": 1493218419, "creation_date": 1493218419, "answer_id": 43637677, "question_id": 43636697, "link": "https://stackoverflow.com/questions/43636697/vba-or-excel-formulas-to-concatentate-columnar-data-in-excel-to-linear-comma-sep/43637677#43637677", "title": "VBA or Excel formulas to concatentate columnar data in Excel to linear comma separated data", "body": "<p>For a formula it will require a subscription Office 365 Excel:</p>\n\n<pre><code>=IF(LEFT(B2,4) = \"NOTE\",TEXTJOIN(\" \",TRUE,B2:INDEX(B3:$B$104000,IFERROR(MATCH(\"NOTE*\",B3:$B$104000,0)-1,MATCH(\"ZZZ\",B3:$B$104000)))),\"\")\n</code></pre>\n\n<hr>\n\n<p>If you do not have a Subscription to Office 365 Excel, then add this UDF to a module attached to the workbook and use the formula above:</p>\n\n<pre><code>Function TEXTJOIN(delim As String, skipblank As Boolean, arr)\n    Dim d As Long\n    Dim c As Long\n    Dim arr2()\n    Dim t As Long, y As Long\n    t = -1\n    y = -1\n    If TypeName(arr) = \"Range\" Then\n        arr2 = arr.Value\n    Else\n        arr2 = arr\n    End If\n    On Error Resume Next\n    t = UBound(arr2, 2)\n    y = UBound(arr2, 1)\n    On Error GoTo 0\n\n    If t &gt;= 0 And y &gt;= 0 Then\n        For c = LBound(arr2, 1) To UBound(arr2, 1)\n            For d = LBound(arr2, 1) To UBound(arr2, 2)\n                If arr2(c, d) &lt;&gt; \"\" Or Not skipblank Then\n                    TEXTJOIN = TEXTJOIN &amp; arr2(c, d) &amp; delim\n                End If\n            Next d\n        Next c\n    Else\n        For c = LBound(arr2) To UBound(arr2)\n            If arr2(c) &lt;&gt; \"\" Or Not skipblank Then\n                TEXTJOIN = TEXTJOIN &amp; arr2(c) &amp; delim\n            End If\n        Next c\n    End If\n    TEXTJOIN = Left(TEXTJOIN, Len(TEXTJOIN) - Len(delim))\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/w4crL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/w4crL.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 13, "user_id": 7925823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f89ad313e9d24670c01b200ee693e38e?s=128&d=identicon&r=PG&f=1", "display_name": "OldGuy", "link": "https://stackoverflow.com/users/7925823/oldguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 43637677, "answer_count": 1, "score": 1, "last_activity_date": 1493218487, "creation_date": 1493215963, "last_edit_date": 1531164843, "question_id": 43636697, "link": "https://stackoverflow.com/questions/43636697/vba-or-excel-formulas-to-concatentate-columnar-data-in-excel-to-linear-comma-sep", "title": "VBA or Excel formulas to concatentate columnar data in Excel to linear comma separated data", "body": "<p>I am decomposing an Excel worksheet that made cumbersome use of field merges to organize data. Instead of adding linear fields to each record, the data was organized vertically. Un-merging the fields results in a column of text data with many orphaned values that need to be concatenated into a field in the parent record.  I have added the identifier \"NOTE:\" at the beginning of the text string of the first field in the record.  I would like to use a function that searches the column for the string \"NOTE:\", increments the search down the list concatenating the orphan text strings until it reaches the next \"NOTE: value, where it will repeat the process for the next group of text strings.</p>\n\n<p>I would normally use simple concatentation, but there are 7500 records and 27k notes entries.</p>\n\n<p><a href=\"https://i.stack.imgur.com/x6OFo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/x6OFo.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7924607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64033043865e7e9cbe3e085e848c28fa?s=128&d=identicon&r=PG&f=1", "display_name": "ToofuWarrior", "link": "https://stackoverflow.com/users/7924607/toofuwarrior"}, "edited": false, "score": 0, "creation_date": 1493216172, "post_id": 43636655, "comment_id": 74321771, "body": "Do we have to call it in the 1st Sub? It&#39;s just I have two separate controls buttons for performing these sub-routines? and I&#39;d like to keep them isolated?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 3, "user_id": 7924607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64033043865e7e9cbe3e085e848c28fa?s=128&d=identicon&r=PG&f=1", "display_name": "ToofuWarrior", "link": "https://stackoverflow.com/users/7924607/toofuwarrior"}, "edited": false, "score": 0, "creation_date": 1493216267, "post_id": 43636655, "comment_id": 74321854, "body": "@ToofuWarrior then you can declare <code>wsSht</code> as a <code>Global</code> variable, is it something you want to do ? Do you know how ?"}, {"owner": {"reputation": 3, "user_id": 7924607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64033043865e7e9cbe3e085e848c28fa?s=128&d=identicon&r=PG&f=1", "display_name": "ToofuWarrior", "link": "https://stackoverflow.com/users/7924607/toofuwarrior"}, "edited": false, "score": 0, "creation_date": 1493216410, "post_id": 43636655, "comment_id": 74321979, "body": "I don&#39;t know how to do that, but I also just thought... alternatively, I could just import the sheet and then rename during that import it to the a hard coded value?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 3, "user_id": 7924607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64033043865e7e9cbe3e085e848c28fa?s=128&d=identicon&r=PG&f=1", "display_name": "ToofuWarrior", "link": "https://stackoverflow.com/users/7924607/toofuwarrior"}, "edited": false, "score": 0, "creation_date": 1493216807, "post_id": 43636655, "comment_id": 74322312, "body": "@ToofuWarrior there are many was to implement it, I answered your posr, which titles &quot;How do you pass in the set variable name of a field from one sub-routine to another in VBA?&quot;"}, {"owner": {"reputation": 3, "user_id": 7924607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64033043865e7e9cbe3e085e848c28fa?s=128&d=identicon&r=PG&f=1", "display_name": "ToofuWarrior", "link": "https://stackoverflow.com/users/7924607/toofuwarrior"}, "edited": false, "score": 0, "creation_date": 1493217779, "post_id": 43636655, "comment_id": 74323123, "body": "Aye, you did! Thanks friend"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1493215856, "creation_date": 1493215856, "answer_id": 43636655, "question_id": 43636550, "link": "https://stackoverflow.com/questions/43636550/how-do-you-pass-in-the-set-variable-name-of-a-field-from-one-sub-routine-to-anot/43636655#43636655", "title": "How do you pass in the set variable name of a field from one sub-routine to another in VBA?", "body": "<p>You can sen over the <code>Worksheet</code> itself, no need to use the Sheet's name.</p>\n\n<p>In your 2nd <code>Sub</code>, change to:</p>\n\n<pre><code>Sub DeleteBlankCells(ws As Worksheet)\n\nDim Rng As Range\n\nWith ws\n    Set Rng = .Rows(\"1:1\").Find(What:=\"HIVE_FIELD_TYPE\", after:=.Cells(1, 1), LookIn:=xlValues, LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext)\n    .Columns(Rng.EntireColumn.Address).SpecialCells(xlCellTypeBlanks).EntireRow.Delete\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>And in your 1st <code>Sub</code> call it after:</p>\n\n<pre><code>Set wsSht = .Sheets(sWSName)\n</code></pre>\n\n<p>With:</p>\n\n<pre><code>DeleteBlankCells wsSht\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 459648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8d84d9cea6851bf933259fb94769fcb?s=128&d=identicon&r=PG", "display_name": "royalflight", "link": "https://stackoverflow.com/users/459648/royalflight"}, "is_accepted": false, "score": 0, "last_activity_date": 1493216097, "last_edit_date": 1495542854, "creation_date": 1493216097, "answer_id": 43636750, "question_id": 43636550, "link": "https://stackoverflow.com/questions/43636550/how-do-you-pass-in-the-set-variable-name-of-a-field-from-one-sub-routine-to-anot/43636750#43636750", "title": "How do you pass in the set variable name of a field from one sub-routine to another in VBA?", "body": "<p>Alternatively, perhaps a global variable?  (it is hacky way to accomplish it)</p>\n\n<p><a href=\"https://stackoverflow.com/questions/27576457/how-to-declare-global-variables-in-excel-vba-to-be-visible-across-the-workbook\">How to declare Global Variables in Excel VBA to be visible across the Workbook</a></p>\n"}], "owner": {"reputation": 3, "user_id": 7924607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64033043865e7e9cbe3e085e848c28fa?s=128&d=identicon&r=PG&f=1", "display_name": "ToofuWarrior", "link": "https://stackoverflow.com/users/7924607/toofuwarrior"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 43636655, "answer_count": 2, "score": 0, "last_activity_date": 1493281102, "creation_date": 1493215580, "last_edit_date": 1493281102, "question_id": 43636550, "link": "https://stackoverflow.com/questions/43636550/how-do-you-pass-in-the-set-variable-name-of-a-field-from-one-sub-routine-to-anot", "title": "How do you pass in the set variable name of a field from one sub-routine to another in VBA?", "body": "<p>So, I have two sub-routines.</p>\n\n<p>The 1st is for importing worksheets and the 2nd is for deleting blank rows if a certain condition holds true.</p>\n\n<p>I would like to pass in the name of the sheet that has been imported, to the <code>DeleteBlankCells()</code> sub-routine. I think this is the <code>Set wsSht = .Sheets(sWSName)</code> variable here that we are setting.</p>\n\n<p>In the 2nd sub-routine, you can see the hardcoded sheet value that I would like to replace with the value being passed in from the import.</p>\n\n<p><strong>This is the 1st sub-routine:</strong></p>\n\n<pre><code>Sub ImportSheet()\nDim sImportFile As String, sFile As String\nDim sThisBk As Workbook\nDim vfilename As Variant\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\nSet sThisBk = ActiveWorkbook\nsImportFile = Application.GetOpenFilename( _\nFileFilter:=\"Microsoft Excel Workbooks, *.xls; *.xlsx\", Title:=\"Open Workbook\")\nIf sImportFile = \"False\" Then\n    MsgBox \"No File Selected!\"\n    Exit Sub\n\nElse\n    vfilename = Split(sImportFile, \"\\\")\n    sFile = vfilename(UBound(vfilename))\n    Application.Workbooks.Open Filename:=sImportFile\n    Set wbBk = Workbooks(sFile)\n    With wbBk\n        If SheetExists(sWSName) Then\n            Set wsSht = .Sheets(sWSName)\n            wsSht.Copy after:=sThisBk.Sheets(\"Sheet3\")\n        Else\n            MsgBox \"There is no sheet with name :Raw_Data in:\" &amp; vbCr &amp; .Name\n        End If\n        wbBk.Close SaveChanges:=False\n    End With\nEnd If\nApplication.ScreenUpdating = True\nApplication.DisplayAlerts = True\nSheets(\"Sheet1\").Activate\nEnd Sub\n\nPrivate Function SheetExists(sWSName) As Boolean\nDim ws As Worksheet\nOn Error Resume Next\nsWSName = InputBox(\"Enter sheet name\")\nSet ws = Worksheets(sWSName)\nIf Not ws Is Nothing Then SheetExists = True\nEnd Function\n</code></pre>\n\n<p><strong>and this is the 2nd sub-routine:</strong></p>\n\n<pre><code>Sub DeleteBlankCells()\nDim Rng As Range\n\nSheets(\"HARDCODED SHEET NAME\").Activate\n\nSet Rng = Rows(\"1:1\").Find(What:=\"HIVE_FIELD_TYPE\", after:=Cells(1, 1), LookIn:=xlValues, LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext)\n   Sheets(\"HARDCODED SHEET NAME\").Columns(Rng.EntireColumn.Address).SpecialCells(xlCellTypeBlanks).EntireRow.Delete\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "edited": false, "score": 0, "creation_date": 1493215431, "post_id": 43636431, "comment_id": 74321160, "body": "Welcome to Stack Overflow. SO Is not a &quot;Code for Me&quot;, &quot;Teach me to Code&quot;, or a &quot;Show where to Start&quot; site. It is a place for those with existing code with specific problems to get specific help on overcoming that problem. If you have code that you have tried that is not working please put it in your original post using edit and explain what the code is doing in error. As is, this is too broad for this forum and risks down votes and closure."}, {"owner": {"reputation": 1, "user_id": 7142369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fd6faef6faee60f4e8ce45d6647e367?s=128&d=identicon&r=PG&f=1", "display_name": "ChandraO", "link": "https://stackoverflow.com/users/7142369/chandrao"}, "reply_to_user": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "edited": false, "score": 0, "creation_date": 1493217311, "post_id": 43636431, "comment_id": 74322744, "body": "lOk = FindWindowEx(hwnd, 0&amp;, vbNullString, hwndtext)         j = SendMessage(hwnd, TAB_KEYDOWN, 0&amp;, 0&amp;)         j = PostMessage(hwnd, TAB_KEYDOWN, 0&amp;, 0&amp;)&#39;Cannot post entire code as this is restricted"}, {"owner": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "edited": false, "score": 0, "creation_date": 1493218046, "post_id": 43636431, "comment_id": 74323319, "body": "Thank you for providing the code. Just edit your question (above) and post the relevant parts there."}], "owner": {"reputation": 1, "user_id": 7142369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fd6faef6faee60f4e8ce45d6647e367?s=128&d=identicon&r=PG&f=1", "display_name": "ChandraO", "link": "https://stackoverflow.com/users/7142369/chandrao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 830, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1493218290, "creation_date": 1493215289, "last_edit_date": 1493218290, "question_id": 43636431, "link": "https://stackoverflow.com/questions/43636431/sendmessage-or-postmessage-in-vba", "title": "sendmessage or Postmessage in vba", "body": "<p>I have to mimic key combinations of control and tab, but am unable to getit done. Can any one help me on API postmessage or sendmessage in vba to simulate combination of keys like control and tab</p>\n\n<pre><code>lOk = FindWindowEx(hwnd, 0&amp;, vbNullString, hwndtext) \nj = SendMessage(hwnd, TAB_KEYDOWN, 0&amp;, 0&amp;)\n j = PostMessage(hwnd, TAB_KEYDOWN, 0&amp;, 0&amp;)\n'Cannot post entire code as this is restricted \n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 4, "creation_date": 1493214430, "post_id": 43636006, "comment_id": 74320307, "body": "Start here: <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\" title=\"how to avoid using select in excel vba macros\">stackoverflow.com/questions/10714251/&hellip;</a> ."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 4, "creation_date": 1493214753, "post_id": 43636006, "comment_id": 74320591, "body": "Please edit the title of your question into something that actually reflects the problem you are experiencing."}, {"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "reply_to_user": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1493218818, "post_id": 43636006, "comment_id": 74324018, "body": "@BrandonBarney look at this: <code>ActiveWindow.SmallScroll Down:=-6</code> that&#39;s just a recording. Don&#39;t go to far. Let the OP learn step by step."}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "reply_to_user": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "edited": false, "score": 0, "creation_date": 1493218965, "post_id": 43636006, "comment_id": 74324158, "body": "@Masoud I know it is a recording, which is why I directed him to avoiding &#39;Activate&#39; and &#39;Select&#39;. This is how I learned about my bad habits at least, so I direct others in the same direction."}, {"owner": {"reputation": 3, "user_id": 7925225, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/6101bec7ce78d8eda1b722bea520fccf?s=128&d=identicon&r=PG&f=1", "display_name": "samred", "link": "https://stackoverflow.com/users/7925225/samred"}, "edited": false, "score": 0, "creation_date": 1493219390, "post_id": 43636006, "comment_id": 74324503, "body": "Useful comments, but since I&#39;m a very inexperienced VBA user, I did not understand the link you pointed me to at all."}], "answers": [{"comments": [{"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "edited": false, "score": 0, "creation_date": 1493219001, "post_id": 43637440, "comment_id": 74324188, "body": "This is not an answer to what OP asked. You did nothing except removing unnecessary selection (not even the scrolling part). You did not even <code>dim</code> the sheets to avoid selection of them. I would not even consider this as a bad answer."}], "tags": [], "owner": {"reputation": 1, "user_id": 7781832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b32c007fc043f287c4a7e2e48d0e6df8?s=128&d=identicon&r=PG&f=1", "display_name": "Aleksandr", "link": "https://stackoverflow.com/users/7781832/aleksandr"}, "is_accepted": false, "score": 0, "last_activity_date": 1493217850, "creation_date": 1493217850, "answer_id": 43637440, "question_id": 43636006, "link": "https://stackoverflow.com/questions/43636006/vba-how-to-extend-range-of-macro-to-entire-sheet/43637440#43637440", "title": "VBA How to extend range of macro to entire sheet", "body": "<p>First change the code</p>\n\n<pre><code>     ActiveWindow.SmallScroll Down:=-6\n    Range(\"B1\").NumberFormat = \"General\"\n    Range(\"B1\").FormulaR1C1 = \"='Load Book'!R[2]C[-1]\"\n    Sheets(\"Max Amps\").Select\n    ActiveSheet.Calculate\n    Sheets(\"Load Book\").Select\nRange(\"B3\").NumberFormat = \"0\"\nActiveSheet.Calculate\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7925225, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/6101bec7ce78d8eda1b722bea520fccf?s=128&d=identicon&r=PG&f=1", "display_name": "samred", "link": "https://stackoverflow.com/users/7925225/samred"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 416, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1493217850, "creation_date": 1493214206, "last_edit_date": 1493217267, "question_id": 43636006, "link": "https://stackoverflow.com/questions/43636006/vba-how-to-extend-range-of-macro-to-entire-sheet", "title": "VBA How to extend range of macro to entire sheet", "body": "<p>How can I pass every value from combo box through a sheet and retrieve a single cell that will be stored on a separate sheet?</p>\n\n<p>Sheet 1: Enter a Location from Combo Box (Stored on Sheet 2) and date to retrieve hourly temperature from external database for 90 days starting from date that was inputted. Stores maximum value.\nSheet 3: Need to go through each location and store max value next to Location name,</p>\n\n<p>Right now, My macro for one iteration is: </p>\n\n<pre><code>  ActiveWindow.SmallScroll Down:=-6\n    Range(\"B1\").Select\n    Selection.NumberFormat = \"General\"\n    Range(\"B1\").Select\n    ActiveCell.FormulaR1C1 = \"='Load Book'!R[2]C[-1]\"\n    Range(\"B2\").Select\n    Sheets(\"Max Amps\").Select\n    ActiveSheet.Calculate\n    Sheets(\"Load Book\").Select\nRange(\"B3\").Select\nSelection.NumberFormat = \"0\"\nActiveSheet.Calculate\n</code></pre>\n\n<p>This is only working for whatever is in that one cell. And if I try to record a macro for the next iteration too, the first maximum temperature changes to be whatever is in the second location too. How can I get the max temperature store, then move to next location without first being affected? And how can I apply this to 400 locations?</p>\n"}, {"tags": ["excel", "vba", "events", "triggers", "controls"], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 7790879, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0f1fc185b261a2dbd5ee15a9e8d7c344?s=128&d=identicon&r=PG&f=1", "display_name": "Bezique", "link": "https://stackoverflow.com/users/7790879/bezique"}, "edited": false, "score": 0, "creation_date": 1493216679, "post_id": 43636337, "comment_id": 74322208, "body": "Perfect, thank you. I had a misnomer that assigning macros in the way you describe disables the functionality of the control. I was wrong"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 27, "user_id": 7790879, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0f1fc185b261a2dbd5ee15a9e8d7c344?s=128&d=identicon&r=PG&f=1", "display_name": "Bezique", "link": "https://stackoverflow.com/users/7790879/bezique"}, "edited": false, "score": 0, "creation_date": 1493216976, "post_id": 43636337, "comment_id": 74322480, "body": "@Bezique you might consider accepting this as solution to the question so other users know that it is solved."}, {"owner": {"reputation": 27, "user_id": 7790879, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0f1fc185b261a2dbd5ee15a9e8d7c344?s=128&d=identicon&r=PG&f=1", "display_name": "Bezique", "link": "https://stackoverflow.com/users/7790879/bezique"}, "edited": false, "score": 0, "creation_date": 1493217157, "post_id": 43636337, "comment_id": 74322611, "body": "learning how to do this... I had already clicked the up arrow, but am told I need 15 rep before my votes will be displayed. Is there something else I should have done?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 27, "user_id": 7790879, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0f1fc185b261a2dbd5ee15a9e8d7c344?s=128&d=identicon&r=PG&f=1", "display_name": "Bezique", "link": "https://stackoverflow.com/users/7790879/bezique"}, "edited": false, "score": 0, "creation_date": 1493217297, "post_id": 43636337, "comment_id": 74322728, "body": "@Bezique no problem you can read here how it works: <a href=\"https://meta.stackexchange.com/a/5235/277861\">Accepting Answers: How does it work?</a>"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 0, "last_activity_date": 1493215075, "creation_date": 1493215075, "answer_id": 43636337, "question_id": 43635898, "link": "https://stackoverflow.com/questions/43635898/excel-form-control-macro-updates-another-sheet-worksheet-change-event-does-not/43636337#43636337", "title": "Excel form control macro updates another sheet, Worksheet_Change event does not trigger", "body": "<p>You can assign a macro to the ListBox as <code>ListBox1_Change</code> event (right click \u203a assign macro) which will be executed on change of the ListBox value instead of <code>Worksheet_Change</code> then.</p>\n\n<p>Probably that is why the <code>Worksheet_Change</code> is not triggered anymore when using the ListBox to change the cell value.</p>\n"}], "owner": {"reputation": 27, "user_id": 7790879, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0f1fc185b261a2dbd5ee15a9e8d7c344?s=128&d=identicon&r=PG&f=1", "display_name": "Bezique", "link": "https://stackoverflow.com/users/7790879/bezique"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 250, "favorite_count": 0, "accepted_answer_id": 43636337, "answer_count": 1, "score": 1, "last_activity_date": 1549013494, "creation_date": 1493213920, "last_edit_date": 1549013494, "question_id": 43635898, "link": "https://stackoverflow.com/questions/43635898/excel-form-control-macro-updates-another-sheet-worksheet-change-event-does-not", "title": "Excel form control macro updates another sheet, Worksheet_Change event does not trigger", "body": "<p>I have an Excel ListBox (not ActiveX as these are causing display issues) with an Excel (dialog menu-driven) macro that outputs its value to a named range cell on a different sheet to the Listbox. In that sheet's code I have the below</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Debug.Print \"ping\"\nEnd Sub\n</code></pre>\n\n<p>The macro event does not trigger when I click on the Listbox (therefore updating the named range cell value). I have verified that the macro executes when I directly update that sheet.</p>\n\n<p>I assume the form control macro is circumnavigating the sheet event trigger. Am I right? Does anybody know an efficient workaround for this? I am stumped.</p>\n\n<p>Thanks Kindly</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1493214025, "post_id": 43635891, "comment_id": 74319977, "body": "I think it automatically happens when you copy the worksheet. You could go about this by selecting the original sheet at the end of your sub."}, {"owner": {"reputation": 95, "user_id": 7710018, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/50f4357aa7f73fb1087b8c852d257d2a?s=128&d=identicon&r=PG&f=1", "display_name": "Porkball21", "link": "https://stackoverflow.com/users/7710018/porkball21"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1493214643, "post_id": 43635891, "comment_id": 74320481, "body": "Good idea, it did the job!"}], "answers": [{"tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": true, "score": 1, "last_activity_date": 1493214421, "creation_date": 1493214421, "answer_id": 43636085, "question_id": 43635891, "link": "https://stackoverflow.com/questions/43635891/prevent-workbook-from-switching-to-newly-imported-sheet/43636085#43636085", "title": "Prevent workbook from switching to newly imported sheet", "body": "<p>Add this to your declare block</p>\n\n<pre><code>Dim sThisSht As Worksheet\n</code></pre>\n\n<p>And this where you also set the <code>sThisBk</code></p>\n\n<pre><code>Set sThisSht = ActiveWorksheet\n</code></pre>\n\n<p>And then before you revert <code>ScreenUpdating = True</code>, add this to return to the active sheet set at the start:</p>\n\n<pre><code>sThisSht.Activate\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 7710018, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/50f4357aa7f73fb1087b8c852d257d2a?s=128&d=identicon&r=PG&f=1", "display_name": "Porkball21", "link": "https://stackoverflow.com/users/7710018/porkball21"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "accepted_answer_id": 43636085, "answer_count": 1, "score": 0, "last_activity_date": 1493214421, "creation_date": 1493213906, "question_id": 43635891, "link": "https://stackoverflow.com/questions/43635891/prevent-workbook-from-switching-to-newly-imported-sheet", "title": "Prevent workbook from switching to newly imported sheet", "body": "<p>I have a work book that import a sheet through a control button. Currently the workbook is switching to the newly imported sheet and I would like to prevent that from happening, so that is stays on the sheet with the control button.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Sub ImportSheet()\n    Dim sImportFile As String, sFile As String\n    Dim sThisBk As Workbook\n    Dim vfilename As Variant\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n    Set sThisBk = ActiveWorkbook\n    sImportFile = Application.GetOpenFilename( _\n    FileFilter:=\"Microsoft Excel Workbooks, *.xls; *.xlsx\", Title:=\"Open Workbook\")\nIf sImportFile = \"False\" Then\n    MsgBox \"No File Selected!\"\n    Exit Sub\n\nElse\n    vfilename = Split(sImportFile, \"\\\")\n    sFile = vfilename(UBound(vfilename))\n    Application.Workbooks.Open Filename:=sImportFile\n    Set wbBk = Workbooks(sFile)\n    With wbBk\n        If SheetExists(sWSName) Then\n            Set wsSht = .Sheets(sWSName)\n            wsSht.Copy after:=sThisBk.Sheets(\"Sheet3\")\n        Else\n            MsgBox \"There is no sheet with name :Raw_Data in:\" &amp; vbCr &amp; .Name\n        End If\n        wbBk.Close SaveChanges:=False\n    End With\nEnd If\nApplication.ScreenUpdating = True\nApplication.DisplayAlerts = True\nEnd Sub\n\nPrivate Function SheetExists(sWSName) As Boolean\n    Dim ws As Worksheet\n    On Error Resume Next\n    sWSName = InputBox(\"Enter sheet name\")\n    Set ws = Worksheets(sWSName)\n    If Not ws Is Nothing Then SheetExists = True\nEnd Function\n</code></pre>\n\n<p>I could not work out where in the code it is switching, perhaps I need to put some code in to make it remain static on the import?</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["vba", "excel"], "owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 183, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1493213868, "creation_date": 1493213868, "last_edit_date": 1531164843, "question_id": 43635882, "link": "https://stackoverflow.com/questions/43635882/how-to-only-autofit-row-height-if-cell-is-the-largest", "title": "How to only autofit row height if cell is the largest?", "body": "<p>I have a lot of rows that base on two columns \"A\" &amp; \"I\" that on worksheet event change, will autofit the row. My code works fine on one row/column, but when the other row/column is smaller than the previous, the initial row/column height gets shrink with the last row/column. I need help with if on worksheet event change, if the max height is already there to not autofit.</p>\n\n<pre><code>Sub AutoFitMergedCellRowHeight(Target As String)\n    Dim MergeWidth As Single\n    Dim cM As Range\n    Dim AutoFitRng As Range\n    Dim CWidth As Double\n    Dim NewRowHt As Double\n    Application.ScreenUpdating = False\n    On Error Resume Next\n    Set AutoFitRng = Range(Target)\n\n    With AutoFitRng\n        ActiveSheet.Unprotect Password:=\"410\"\n        .MergeCells = False\n        CWidth = .Cells(1).ColumnWidth\n        MergeWidth = 0\n        For Each cM In AutoFitRng\n            cM.WrapText = True\n            MergeWidth = cM.ColumnWidth + MergeWidth\n        Next\n        'small adjustment to temporary width\n        MergeWidth = MergeWidth + AutoFitRng.Cells.Count * 0.66\n        .Cells(1).ColumnWidth = MergeWidth\n        .EntireRow.AutoFit\n        NewRowHt = .RowHeight\n        .Cells(1).ColumnWidth = CWidth\n        .MergeCells = True\n        .RowHeight = NewRowHt\n        ActiveSheet.Protect Password:=\"410\"\n    End With\n    Application.ScreenUpdating = True\nEnd Sub\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    Dim i As Integer\n\n    For i = 12 To 417\n        If Target.Address = \"$A$\" &amp; i Then\n            Call AutoFitMergedCellRowHeight(Target.MergeArea.Address)\n        End If\n\n        If Target.Address = \"$I$\" &amp; i Then\n            Call AutoFitMergedCellRowHeight(Target.MergeArea.Address)\n        End If\n    Next i\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1493213945, "post_id": 43635785, "comment_id": 74319915, "body": "Use the <code>Match</code> function to test for existence of a value in a range.  Then use <code>MsgBox</code> function to display warning to user and <code>Exit Sub</code> to abort the procedure early. Revise your question when you get stuck, and include the code you&#39;re trying to use and specific problem statement."}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1493213948, "post_id": 43635785, "comment_id": 74319917, "body": "Perhaps you can update your question with more information about where the possible duplicate dates are in the both the existing data and the data you are copying."}], "owner": {"reputation": 87, "user_id": 6920773, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b6426cbb5ebd5e2bcdad8ff82f8ca4f5?s=128&d=identicon&r=PG&f=1", "display_name": "RBC Kyle Bullard", "link": "https://stackoverflow.com/users/6920773/rbc-kyle-bullard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1493213665, "creation_date": 1493213665, "question_id": 43635785, "link": "https://stackoverflow.com/questions/43635785/excel-vba-duplicate-data-transfer-message", "title": "Excel-VBA Duplicate data transfer message", "body": "<p>I have a macro which opens another spreadsheet, copies, and pastes the desired data from spreadsheet a to spreadsheet b.</p>\n\n<p>The first cell of each column is a pasted date.</p>\n\n<pre><code> 'Copy and Pastes Values to Trend Sheet\n b.Sheets(\"SPRAY\").Range(\"BW1:BW56\").Copy\n a.Sheets(\"SPRAY\").Range(\"IIV1\").End(xlToLeft).Offset(, 1).PasteSpecialxlValues\n     Application.CutCopyMode = False  \n</code></pre>\n\n<p>Currently, duplicate data can be transferred.\nHow can I display a message box if the date already exists in spreadsheet b? </p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1493213633, "post_id": 43635447, "comment_id": 74319657, "body": "Something like so <code>int(181&#47;60) + iif(181 mod 60&gt;0,1,0)</code> for 181 minutes or a little simpler <code>int(181&#47;60) + cint(181 mod 60)</code>"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1493214124, "post_id": 43635447, "comment_id": 74320068, "body": "sorry ignore the 2nd idea, I cant edit to update it."}], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1493218210, "creation_date": 1493218210, "answer_id": 43637586, "question_id": 43635447, "link": "https://stackoverflow.com/questions/43635447/calculating-time-difference-and-rounding-in-vba-for-access/43637586#43637586", "title": "Calculating time difference and rounding in VBA for access", "body": "<p>You can do it directly:</p>\n\n<pre><code> Hours = Hour(TimeSerial(Hour([EndTime] - [StartTime]), -Int(-Minute([EndTime] - [StartTime]) / 60) * 60, 0))\n</code></pre>\n"}], "owner": {"reputation": 135, "user_id": 4941977, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0268c5e3b7fbc8a268b345e7b943c3c4?s=128&d=identicon&r=PG&f=1", "display_name": "DotyDot", "link": "https://stackoverflow.com/users/4941977/dotydot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 619, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1493223963, "creation_date": 1493212757, "last_edit_date": 1493223963, "question_id": 43635447, "link": "https://stackoverflow.com/questions/43635447/calculating-time-difference-and-rounding-in-vba-for-access", "title": "Calculating time difference and rounding in VBA for access", "body": "<p><strong>Problem:</strong>\nI am designing a ticket system and we need to track time spent on a task. We have a start time and end time which is a date/time field. I need to calculate the time spent from these two fields and then round it to the nearest hour always rounding up. 121 minutes should be counted as 3 hours. </p>\n\n<p><strong>My attempt:</strong>\nCurrently i am converting the time between the start and end time to minutes and then trying to round that to nearest hour. </p>\n\n<p>Mins field i have is <code>=DateDiff(\"n\",[starttime],[endtime])</code></p>\n\n<p>total time field i have is <code>Me.TotalTime.Value = mins mod 60 + 1</code>\nThis works unless the minutes is exactly 60, 120, 180 etc...</p>\n\n<p>any solution is appreciated </p>\n"}, {"tags": ["vba", "excel", "offset"], "comments": [{"owner": {"reputation": 1595, "user_id": 4837035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfc11c275ff58678c9c6b7fa93d4119?s=128&d=identicon&r=PG&f=1", "display_name": "Zerk", "link": "https://stackoverflow.com/users/4837035/zerk"}, "edited": false, "score": 0, "creation_date": 1493212796, "post_id": 43635392, "comment_id": 74318925, "body": "If A15:A16 are merged then it seems to replicate the undesired behavior."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1493213279, "post_id": 43635501, "comment_id": 74319346, "body": "For merged origin cells, you could use <code>Range(&quot;A15&quot;).Offset(-8, 0).Resize(2, 1)</code>"}], "tags": [], "owner": {"reputation": 31, "user_id": 7925534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/430699ad07d5f662d10ba690d0fa698a?s=128&d=identicon&r=PG&f=1", "display_name": "E den Toom", "link": "https://stackoverflow.com/users/7925534/e-den-toom"}, "is_accepted": false, "score": 2, "last_activity_date": 1493212899, "creation_date": 1493212899, "answer_id": 43635501, "question_id": 43635392, "link": "https://stackoverflow.com/questions/43635392/excel-vba-strange-behavior-of-offset/43635501#43635501", "title": "Excel-VBA: strange behavior of Offset", "body": "<p>I've searched for the answer to this question for days now, and as soon as I posted the question I found the solution. It turned out the cells were merged in sets of 2. The offset only returns the address of the first cell of the merged set.</p>\n"}], "owner": {"reputation": 31, "user_id": 7925534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/430699ad07d5f662d10ba690d0fa698a?s=128&d=identicon&r=PG&f=1", "display_name": "E den Toom", "link": "https://stackoverflow.com/users/7925534/e-den-toom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1493212899, "creation_date": 1493212604, "question_id": 43635392, "link": "https://stackoverflow.com/questions/43635392/excel-vba-strange-behavior-of-offset", "title": "Excel-VBA: strange behavior of Offset", "body": "<p>I'm encountering some strange behavior when I try to offset a range.</p>\n\n<p>In the immediate window in a new document I can do the following:</p>\n\n<pre><code>?Range(\"A15:A16\").Offset(-8).Address\n</code></pre>\n\n<p>which returns:</p>\n\n<pre><code>$A$7:$A$8\n</code></pre>\n\n<p>as it should.</p>\n\n<p>However, in my current workbook, the same code returns just $A$7.\nThe following code does work as it should:</p>\n\n<pre><code>?Range(\"A15,A16\").Offset(-8).Address\n</code></pre>\n\n<p>(returns $A$7,$A$8)</p>\n\n<pre><code>?Range(\"A15:A17\").Offset(-8).Address\n</code></pre>\n\n<p>(returns $A$7:$A$9).</p>\n\n<p>Is there a setting that I'm missing that causes this strange behavior? Especially since it does work properly in a new workbook.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1493211932, "post_id": 43635047, "comment_id": 74318168, "body": "You can set the value of one range equivalent to the value of another. For example <code>ThisWorkbook.Sheets(&quot;Data&quot;).Cells(1, 1).Value = ThisWorkbook.Sheets(&quot;SourceData&quot;).Range(&quot;J5&quot;).Value</code> would take the value in our data sheet from range &quot;J5&quot; and would put it in cell 1,1 on our new sheets (you dont have to use cells. You just have to define the range)."}, {"owner": {"reputation": 307, "user_id": 1892705, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/23cfc5646d6a3104e4177e5da49f89ce?s=128&d=identicon&r=PG", "display_name": "Dustin Burns", "link": "https://stackoverflow.com/users/1892705/dustin-burns"}, "reply_to_user": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1493212051, "post_id": 43635047, "comment_id": 74318270, "body": "That might actually work.  I can do like Cells(1+i, 1) to move to the next row.  I&#39;ll give it a shot, thanks!"}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1493212107, "post_id": 43635047, "comment_id": 74318325, "body": "Not a problem at all. Once you get comfortable with that you may be interested in learning about arrays :)."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1493213278, "post_id": 43635047, "comment_id": 74319344, "body": "You can do <code>cells(i+1, 1)</code>, and you can also do <code>.cells(1, 1).offset(i)</code>"}], "owner": {"reputation": 307, "user_id": 1892705, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/23cfc5646d6a3104e4177e5da49f89ce?s=128&d=identicon&r=PG", "display_name": "Dustin Burns", "link": "https://stackoverflow.com/users/1892705/dustin-burns"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 187, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1493211775, "creation_date": 1493211775, "last_edit_date": 1531164843, "question_id": 43635047, "link": "https://stackoverflow.com/questions/43635047/copy-and-paste-between-workbooks-without-using-range", "title": "Copy and Paste between Workbooks without using Range", "body": "<p>I need a macro that runs through a workbook, copies specific cells, then pastes them into another workbook.  I've seen macros that do this, but they all select ranges to accomplish it.  I'm going to be running through hundreds of rows, so selecting ranges isn't going to work (I might as well do it be hand if I have to code hundreds of ranges).  I'd like to accomplish this by using cell Offsets.</p>\n\n<p>This is the code I have:  I'm only showing the relevant areas.</p>\n\n<pre><code>Workbooks.Open (txtFileName) ' Opens the selected file\nSet wbSource = ActiveWorkbook\nWindows(\"CM activity log referral macro.xlsm\").Activate\nSet wbTarget = ActiveWorkbook\n\n' Begin Populating CM Workbook: Caselist Worksheet\n\n'Set initial rows\nwbSource.Activate\nwbSource.Sheets(\"Contact Log\").Range(\"A4\").Select\nwbTarget.Activate\nwbTarget.Sheets(\"Caselist\").Range(\"A3\").Select\n\n'Populate Caselist from Selected Workbook\nDim i As Long\nFor i = 1 To 200\n    'Copy Date Encountered\n    wbSource.Sheets(\"Contact Log\").ActiveCell.Copy\n    wbTarget.Sheets(\"Caselist\").ActiveCell.PasteSpecial Paste:=xlPasteValues\n    'Copy First and Last Name\n    wbSource.Sheets(\"Contact Log\").ActiveCell.Offset(0, 2).Copy                          \n    wbTarget.Sheets(\"Caselist\").ActiveCell.Offset(0, 1).PasteSpecial \nPaste:=xlPasteValues  \n    wbSource.Sheets(\"Contact Log\").ActiveCell.Offest(0, 1).Copy                          'move to D4\n    wbTarget.Sheets(\"Caselist\").ActiveCell.Offset(0, 1).PasteSpecial \nPaste:=xlPasteValues\n</code></pre>\n\n<p>There's more to copy, and the for loop gets closed properly, but I'm not showing that here.  I know that the problem is that Sheets doesn't support the following .Activecell statement.  I need to know how to write this so I can use offset instead of Range to select the cells to copy and paste to.</p>\n\n<p>Thank you so much for your time.  I appreciate it.</p>\n"}, {"tags": ["vba", "excel", "excel-2013"], "comments": [{"owner": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "edited": false, "score": 0, "creation_date": 1493211934, "post_id": 43635026, "comment_id": 74318174, "body": "Is the header always just <code>employee</code>? Is that the only text in the cell?"}, {"owner": {"reputation": 967, "user_id": 6860396, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2335c5b5ac2454a5b20ba41ab74f95f0?s=128&d=identicon&r=PG&f=1", "display_name": "BellHopByDayAmetuerCoderByNigh", "link": "https://stackoverflow.com/users/6860396/bellhopbydayametuercoderbynigh"}, "reply_to_user": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "edited": false, "score": 0, "creation_date": 1493211965, "post_id": 43635026, "comment_id": 74318202, "body": "@Jordan - yes the header text I need to locate is always employee"}], "answers": [{"tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": false, "score": 1, "last_activity_date": 1493212040, "creation_date": 1493212040, "answer_id": 43635165, "question_id": 43635026, "link": "https://stackoverflow.com/questions/43635026/set-variable-to-header-text-column/43635165#43635165", "title": "Set Variable To Header Text Column", "body": "<p>Use the <code>find</code> method</p>\n\n<pre><code>Cells.Find(\"employee\")\n</code></pre>\n\n<p>This will find the cell in the range specified (here I've used <code>Cells</code> but I'd narrow this down to your range) and it will return the cell that contains the text \"employee\". You can then reference this as a <code>Range</code> object i.e. use <code>.Row</code> to get the row number or <code>.Column</code> to get the column number</p>\n"}, {"tags": [], "owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "is_accepted": true, "score": 3, "last_activity_date": 1493212115, "creation_date": 1493212115, "answer_id": 43635195, "question_id": 43635026, "link": "https://stackoverflow.com/questions/43635026/set-variable-to-header-text-column/43635195#43635195", "title": "Set Variable To Header Text Column", "body": "<p>You can use the <code>Find</code> method and get the column of the cell that <code>employee</code> is found in to use in <code>Cells</code> :</p>\n\n<pre><code>Option Explicit\n\nSub DoThis()\n\n    Dim i As Long\n    Dim lngCol As Long\n\n    With Worksheets(\"Sheet1\") '&lt;-- change to your sheet\n        lngCol = .Rows(1).Find(\"employee\").Column '&lt;-- assumes header in Row 1\n        For i = .Range(\"A\" &amp; .Rows.Count).End(3).Row To 2 Step -1\n            If Not IsEmpty(.Cells(i, lngCol).Value) Then\n                'stuff here\n            End If\n        Next i\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 967, "user_id": 6860396, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2335c5b5ac2454a5b20ba41ab74f95f0?s=128&d=identicon&r=PG&f=1", "display_name": "BellHopByDayAmetuerCoderByNigh", "link": "https://stackoverflow.com/users/6860396/bellhopbydayametuercoderbynigh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 608, "favorite_count": 0, "accepted_answer_id": 43635195, "answer_count": 2, "score": 1, "last_activity_date": 1493212115, "creation_date": 1493211733, "question_id": 43635026, "link": "https://stackoverflow.com/questions/43635026/set-variable-to-header-text-column", "title": "Set Variable To Header Text Column", "body": "<p>I have a workbook that is never received in the same format.  To prevent manual intervention, I need to capture the Column that the text <code>employee</code> is in.  For example, if the text is in column O - I would execute the below, but I would need the <code>Cells(i,\"O\")</code> to be changed based off the cell that contains the text <code>employee</code></p>\n\n<pre><code>Sub DoThis()\nApplication.ScreenUpdating = False\nDim i As Long\nFor i = Range(\"A\" &amp; Rows.Count).End(3).Row To 2 Step -1\n    If Not IsEmpty(Cells(i, \"O\").Value) Then \n        'stuff here\n    End If\nNext i\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "path", "vlookup"], "comments": [{"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1493211413, "post_id": 43634720, "comment_id": 74317721, "body": "The best way to do this would be to just open the workbook, and disable screenupdating. I work with suspicious users as well, but if you warn them in advance they generally don&#39;t mind it. Also, in the case of your code, when you are setting variables like <code>RapportBok = Workbooks(&quot;Rapport kunder&quot;)</code> is this workbook already open? If not (as far as I know) you will get an issue here since the workbook wont be within the workbook collection."}, {"owner": {"reputation": 33, "user_id": 7721167, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158404006290593/picture?type=large", "display_name": "Mille", "link": "https://stackoverflow.com/users/7721167/mille"}, "reply_to_user": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1493211849, "post_id": 43634720, "comment_id": 74318096, "body": "Hi, the Workooks(&quot;Rapport Kunder&quot;) is the book they will be working in so this is open. I don&#39;t want them to touch anything else than the three cell available to them (I2 and C2) so i hope to not have to open the book. could you though show me how to open and the close once the value is added?.. is it that diffcult to retreive the value with it closed? Thank you :)"}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1493212075, "post_id": 43634720, "comment_id": 74318302, "body": "To open just do <code>Workbooks.Open(filepath)&#39; and I would recommend doing it something like </code>Set TargetWorkbook = Workbooks.Open(filepath)<code>. To close once it is set to a variable just do </code>TargetWorkbook.Close(False)<code>. I am not certain how difficult it is to do it with the workbook closed given that it likely is slower, and relies on </code>Application.WorksheetFunction`. I strongly prefer doing it programmatically without relying on the sheets or workbooks. If I can retrieve the value by directly referencing the sheet I do."}, {"owner": {"reputation": 33, "user_id": 7721167, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158404006290593/picture?type=large", "display_name": "Mille", "link": "https://stackoverflow.com/users/7721167/mille"}, "reply_to_user": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1493212700, "post_id": 43634720, "comment_id": 74318849, "body": "thank you. i tried that now and it says &quot;Sorry we couln&#39;t find &#39;F:\\Oppgj&#248;r\\Dagens trades\\Dagens cash[26.04.2017.xlsx]\\Kontantbeholdning Makro&#39;!$L:$N.xlsx .. where is the extra last xlsx coming from? is it something in my macro that adds it again, not just in wbName? I really appreciate your help :)"}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1493212839, "post_id": 43634720, "comment_id": 74318967, "body": "Dont do <code>Workbook.Open</code> on the full cell address. Just do <code>Workbook.Open</code> on the filepath. For example <code>Workbooks.Open(&quot;F:\\Oppgj&#248;r\\Dagens trades\\Dagens cash.xlsx&quot;)</code>"}, {"owner": {"reputation": 33, "user_id": 7721167, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158404006290593/picture?type=large", "display_name": "Mille", "link": "https://stackoverflow.com/users/7721167/mille"}, "reply_to_user": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1493214135, "post_id": 43634720, "comment_id": 74320079, "body": "hi, i treid that, but not working - it can&#39;t find the workbook. the wbName is the workbook. but I feel like giving up :p thank you so much for your help. :)"}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1493214318, "post_id": 43634720, "comment_id": 74320218, "body": "Try <code>debug.print(wbName)</code> to ensure that the name is correct. If it is, try <code>ThisWorkbook.FollowHyperlink(wbName)</code> to see if that works."}], "owner": {"reputation": 33, "user_id": 7721167, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158404006290593/picture?type=large", "display_name": "Mille", "link": "https://stackoverflow.com/users/7721167/mille"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562094218, "creation_date": 1493210931, "last_edit_date": 1562094218, "question_id": 43634720, "link": "https://stackoverflow.com/questions/43634720/get-value-from-closed-worksheet-using-cell-value-as-name", "title": "Get value from closed worksheet using cell value as name", "body": "<p>I have now searched this (and other websites) for a few days and I give up trying on my own.<br>\nMy code does not want to give me values:</p>\n\n<blockquote>\n  <p>Error 1004 unable to get the Vlookup property of the\n  WorksheetFunction class.</p>\n</blockquote>\n\n<p>I don't want to open the other workbook to get the values, because I am making this sheet for others and they will basically freak out if something just pops up.  </p>\n\n<p>The code is as follows:</p>\n\n<pre><code>    Sub CashHoldings()  \n    Dim RapportBok As Workbook  \n    Dim RapportArk As Worksheet  \n    Dim TradeFile As Worksheet  \n\n    Set RapportBok = Workbooks(\"Rapport kunder\")\n    Set RapportArk = RapportBok.Sheets(1)\n    Set TradeFile = Workbooks(\"Trade File Master 1\").Sheets(\"Trade file\")\n\n\n    Dim wbPath As String, wbName As String\n    Dim wsName As String, cellRef As String\n    Dim Ret As String\n    Dim cash As Long\n\n\n    'wbPath = \"F:\\Oppgj\u00f8r\\Dagens trades\\Dagen cash\\\"\n    wbPath = \"F:\\Oppgj\u00f8r\\Dagens trades\\Dagen cash\\\"\n\n    wbName = RapportArk.Range(\"I2\") &amp; \".xlsx\"\n    wsName = \"Kontantbeholdning Makro\"\n    cellRef = \"L:N\"\n\n    Ret = \"'\" &amp; wbPath &amp; \"[\" &amp; wbName &amp; \"]\" &amp; _\n          wsName &amp; \"'!\" &amp; Range(cellRef).Address(True, True)\n\n     MsgBox Ret\n\n    cash = Application.WorksheetFunction.VLookup(RapportArk.Range(\"C2\"), Ret, 2, \n    False)\n\n    End Sub\n</code></pre>\n\n<p>I get the correct name under Ret i.e. : <code>'F:\\Oppgj\u00f8r\\Dagens trades\\Dagens cash\\[26.04.2017.xlsx]\\Kontantbeholdning Makro'!$L:$N</code> </p>\n\n<p>What am I missing??</p>\n\n<p>Thank you in advance :)\nMille</p>\n"}, {"tags": ["sql", "sql-server", "vba", "stored-procedures"], "comments": [{"owner": {"reputation": 13262, "user_id": 6219979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e768deedd6c0ed9a87a26eff0f4c6cbd?s=128&d=identicon&r=PG&f=1", "display_name": "Serg", "link": "https://stackoverflow.com/users/6219979/serg"}, "edited": false, "score": 0, "creation_date": 1493211539, "post_id": 43634392, "comment_id": 74317834, "body": "Probably a better approach could be to try get the final result set needed, and only if it fails then try to detect the reason by more queries."}], "answers": [{"comments": [{"owner": {"reputation": 1553, "user_id": 7806300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/S7U65.jpg?s=128&g=1", "display_name": "addohm", "link": "https://stackoverflow.com/users/7806300/addohm"}, "edited": false, "score": 0, "creation_date": 1493214646, "post_id": 43634875, "comment_id": 74320484, "body": "Something I am considering is combining all my queries into one SP, and executing it once rather than creating multiple queries.  I feel my performance issues may be network speed.  If I only have to query once, the problem may disappear.  Something I realized after I wrote this is these problems could be due to the fact that I am testing from a Virtual Machine connected to the customers network via VPN.  I&#39;d be willing to bet I will see a marked increase in performance if I am local to the server.  What tools are you referring to?"}, {"owner": {"reputation": 1553, "user_id": 7806300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/S7U65.jpg?s=128&g=1", "display_name": "addohm", "link": "https://stackoverflow.com/users/7806300/addohm"}, "edited": false, "score": 0, "creation_date": 1493214772, "post_id": 43634875, "comment_id": 74320611, "body": "If I write an SP with multiple queries, how do I use the results from one query across other queries within the SP?"}, {"owner": {"reputation": 1331, "user_id": 1119305, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/1b190564d275ce2ce026ab8354f940fe?s=128&d=identicon&r=PG", "display_name": "nimdil", "link": "https://stackoverflow.com/users/1119305/nimdil"}, "reply_to_user": {"reputation": 1553, "user_id": 7806300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/S7U65.jpg?s=128&g=1", "display_name": "addohm", "link": "https://stackoverflow.com/users/7806300/addohm"}, "edited": false, "score": 1, "creation_date": 1493215803, "post_id": 43634875, "comment_id": 74321471, "body": "Few options. Easiest to execute would be to result it into temporary table so  if you have a query like SELECT ... FROM .... .... change it into SELECT ... INTO #someName FROM ... .... and then use #someName just like a table wherever you need in the procedure. The temporary would be dropped after sp finishes (practically speaking). So you can i.e. join it with other tables etc."}, {"owner": {"reputation": 1553, "user_id": 7806300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/S7U65.jpg?s=128&g=1", "display_name": "addohm", "link": "https://stackoverflow.com/users/7806300/addohm"}, "edited": false, "score": 0, "creation_date": 1493218178, "post_id": 43634875, "comment_id": 74323415, "body": "Thanks.  Is there an easy way to port my code such that I can set rstA as the second record set, rstB as the third record set, etc?"}, {"owner": {"reputation": 1553, "user_id": 7806300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/S7U65.jpg?s=128&g=1", "display_name": "addohm", "link": "https://stackoverflow.com/users/7806300/addohm"}, "edited": false, "score": 0, "creation_date": 1493218371, "post_id": 43634875, "comment_id": 74323610, "body": "I&#39;ll probably change the letters to numbers and index through a loop."}, {"owner": {"reputation": 1553, "user_id": 7806300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/S7U65.jpg?s=128&g=1", "display_name": "addohm", "link": "https://stackoverflow.com/users/7806300/addohm"}, "edited": false, "score": 0, "creation_date": 1493219919, "post_id": 43634875, "comment_id": 74324873, "body": "I ended up with this and it seems to work.  Will keep posted about performance improvements."}], "tags": [], "owner": {"reputation": 1331, "user_id": 1119305, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/1b190564d275ce2ce026ab8354f940fe?s=128&d=identicon&r=PG", "display_name": "nimdil", "link": "https://stackoverflow.com/users/1119305/nimdil"}, "is_accepted": false, "score": 1, "last_activity_date": 1493211353, "creation_date": 1493211353, "answer_id": 43634875, "question_id": 43634392, "link": "https://stackoverflow.com/questions/43634392/stored-procedure-w-multiple-queries-in-vba/43634875#43634875", "title": "Stored Procedure w/ Multiple Queries in VBA", "body": "<p>That's a bit more complex than you think, I'm afraid.</p>\n\n<p>The performance issue might be due to the queries themselves, not the way they are executed. If you run all the procedures from SSMS, what is the performance? OK, similar to running them from Excel? Perhaps you need to do some tuning - not necessarily easy task, but there are tools to do it automatically. At the display estimated execution plan for individual queries and see if the tool will recommend an index which might help a lot.</p>\n\n<p>You can run a SP returning multiple record sets. Generally you will get one object - RecordSet - normally with the results of the first query. You work with it normally, once you finish you call method NextRecordset and you will get access to the RecordSet of the second query and so on.</p>\n\n<p>Unfortunately the T-SQL part looks like a lot more work than just answering your question.</p>\n"}], "owner": {"reputation": 1553, "user_id": 7806300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/S7U65.jpg?s=128&g=1", "display_name": "addohm", "link": "https://stackoverflow.com/users/7806300/addohm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 407, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1493306508, "creation_date": 1493210151, "last_edit_date": 1493306508, "question_id": 43634392, "link": "https://stackoverflow.com/questions/43634392/stored-procedure-w-multiple-queries-in-vba", "title": "Stored Procedure w/ Multiple Queries in VBA", "body": "<p>Let me start by saying my knowledge of stored procedures is very basic.  I know how to write basic queries and return values in VBA.  I also know that you can basically write programs from within SQL which is where my knowledge breaks down.  I just don't have to do it enough.  Anyway, in VBA, I run a series of queries.  As I feared in the conception phase of this project, it creates some real performance issues to run too many queries from a single routine.  Here is the routine.</p>\n\n<pre><code>Public Sub linePoll()\n\n    errorPosition = \"aofResults.linePoll\"\n    On Error GoTo errorTrap\n    Err.Clear\n\n    Dim rst As ADODB.Recordset\n    Dim rstA As ADODB.Recordset\n    Dim rstB As ADODB.Recordset\n    Dim rstC As ADODB.Recordset\n    Dim rstD As ADODB.Recordset\n    Dim rstE As ADODB.Recordset\n    Dim packQty As Integer\n    Dim m As Integer\n    Dim formFactor As Integer\n\n    m = 0\n    constr = \"Provider=sqloledb;data source=i.p.add.ress;initial catalog=catalog;user id=user;password=password\"\n    Set conn = New ADODB.connection\n    Set cmd = New ADODB.Command\n    conn.Open constr\n    cmd.ActiveConnection = conn\n    LogDiagnosticsMessage \"Getting order quantity\"\n    cmd.CommandText = \"SELECT ISNULL(SUM(lQ.[QUANTITY]), 0) FROM [ROBOTICS_OPTICS_MECHUAT].[dbo].[AOF_ORDER_LINE_QUEUE] AS lQ LEFT JOIN [ROBOTICS_OPTICS_MECHUAT].[dbo].[AOF_ORDER_QUEUE] AS oQ ON lQ.[SALES_ORDER_NUMBER] = oQ.[SALES_ORDER_NUMBER]\"\n    Set rst = cmd.execute                        'Get total order quantity, may change if inventory depletes.\n    If Not rst.EOF = True Then\n        LogDiagnosticsMessage \"Found order quantity as \" &amp; rst(0)\n        Set eTag = ThisDisplay.eGroup.item(\"AOF\\soQuantity\")\n        eTag.value = rst(0)\n    Else\n                LogDiagnosticsMessage \"No order found in line queue DB\"\n    End If\n    If Not rst(0) = 0 Then\n        LogDiagnosticsMessage \"Getting optic order quantity packed\"\n        cmd.CommandText = \"SELECT Count(rL.SERIAL_NUMBER) FROM [ROBOTICS_OPTICS_MECHUAT].[dbo].[AOF_OPTIC_RESULTS] AS rL WHERE EXISTS (SELECT [SO_LINE_NUMBER] FROM [ROBOTICS_OPTICS_MECHUAT].[dbo].[AOF_ORDER_LINE_QUEUE] AS lQ LEFT JOIN [ROBOTICS_OPTICS_MECHUAT].[dbo].[AOF_ORDER_QUEUE] AS oQ ON lQ.[SALES_ORDER_NUMBER] = oQ.SALES_ORDER_NUMBER) AND [REJECT] = 'False'\"\n        Set rst = cmd.execute\n        If Not rst.EOF = True Then\n            LogDiagnosticsMessage \"Found optics order quantity packed as \" &amp; rst(0)\n            Set eTag = ThisDisplay.eGroup.item(\"AOF\\soQuantityPacked\")\n            eTag.value = rst(0)\n        Else\n                    LogDiagnosticsMessage \"No packed optics found in results DB\"\n        End If\n        Set eTag = ThisDisplay.eGroup.item(\"Machine\\itoSettings0\") 'Evaluate packing quantity against machine settings (stored in DB, written to PLC at first startup)\n        LogDiagnosticsMessage \"Evaluating manual pack need\"\n        If rst(0) &lt; eTag.value Then\n            Set eTag = ThisDisplay.eGroup.item(\"AOF\\manualPack\") 'Evaluate packing quantity\n            eTag.value = True\n        Else\n            eTag.value = False\n        End If\n        LogDiagnosticsMessage \"Getting the top line order information\"\n        cmd.CommandText = \"SELECT lQ.[SO_LINE_NUMBER],lQ.[QUANTITY],lQ.[SELECTED],lQ.[FORM_FACTOR_ID], lQ.[FINISHED_PART_NUMBER], ISNULL(lQ.[OEM_PART_NUMBER], ''),ISNULL(lQ.[COMPATIBILITY], ''), oQ.[INDIVIDUAL_PACKAGING], oQ.[SALES_ORDER_NUMBER] FROM [ROBOTICS_OPTICS_MECHUAT].[dbo].[AOF_ORDER_QUEUE] AS oQ LEFT JOIN [ROBOTICS_OPTICS_MECHUAT].[dbo].[AOF_ORDER_LINE_QUEUE] AS lQ ON oQ.[SALES_ORDER_NUMBER] = lQ.[SALES_ORDER_NUMBER] WHERE lQ.[SO_LINE_NUMBER] IS NOT NULL ORDER BY lQ.[SELECTED] DESC,lQ.[COMPLETED] ASC\"\n        Set rstA = cmd.execute()                     'Returns the line orders associated to the sales order\n        If Not rstA.EOF = True Then\n            Set eTag = ThisDisplay.eGroup.item(\"AOF\\SOLineNumber\")\n            If Not eTag.value = rstA(0) Then        '************************************Updates the line order if the line order is different than what's already selected\n                Set eTag = ThisDisplay.eGroup.item(\"AOF\\SOLineNumber\")\n                eTag.value = rstA(0)\n                Set eTag = ThisDisplay.eGroup.item(\"AOF\\QuantityOrdered\")\n                eTag.value = rstA(1)\n                Set eTag = ThisDisplay.eGroup.item(\"AOF\\FinishedPartNumber\")\n                eTag.value = rstA(4)\n                Set eTag = ThisDisplay.eGroup.item(\"AOF\\OEMPartNumber\")\n                eTag.value = rstA(5)\n                Set eTag = ThisDisplay.eGroup.item(\"AOF\\Compatibility\")\n                eTag.value = rstA(6)\n                Set eTag = ThisDisplay.eGroup.item(\"AOF\\IndividualPack\") 'PLC expects \"Double Pack\" true\\false, ITO sends \"Single Pack\" true\\false\n                eTag.value = Not rstA(7)\n            End If                                  '************************************\n            LogDiagnosticsMessage \"Getting the quantity of parts passed for this line order\"\n            cmd.CommandText = \"SELECT COUNT(oL.[SERIAL_NUMBER]) FROM [ROBOTICS_OPTICS_MECHUAT].[dbo].[AOF_ORDER_OPTICS] AS oL WHERE NOT EXISTS ( SELECT [SERIAL_NUMBER] FROM [ROBOTICS_OPTICS_MECHUAT].[dbo].[AOF_OPTIC_RESULTS] rL WHERE oL.[SERIAL_NUMBER] = rL.[SERIAL_NUMBER]) AND oL.[SO_LINE_NUMBER] = \" &amp; rstA(0)\n            Set rstB = cmd.execute()                 'Returns the count of the parts associated to the above line order that passed\n            If Not rstB.EOF = True Then\n                Set eTag = ThisDisplay.eGroup.item(\"AOF\\QuantityPassed\")\n                eTag.value = rstB(0)\n                LogDiagnosticsMessage \"Evaluating parts remaining for this line order as \" &amp; rstB(0)\n                Select Case rstB(0)        'Evaluate Qty left to process in active line order\n                    Case Is = 0                          'Qty Zero (Line order complete)\n                            LogDiagnosticsMessage \"Setting line order as completed\"\n                            cmd.CommandText = \"UPDATE [ROBOTICS_OPTICS_MECHUAT].[dbo].[AOF_ORDER_LINE_QUEUE] SET [SELECTED] = 'False', [COMPLETED] = 'True' WHERE [SO_LINE_NUMBER] = \" &amp; rstA(0)\n                            cmd.execute                      'Unselect the currently index line order and Set order as completed\n                            LogDiagnosticsMessage \"Checking line order quantity against sales order quantity\"\n                            cmd.CommandText = \"SELECT ((SELECT COUNT(lQ.[SO_LINE_NUMBER]) FROM [ROBOTICS_OPTICS_MECHUAT].[dbo].[AOF_ORDER_LINE_QUEUE] AS lQ LEFT JOIN [ROBOTICS_OPTICS_MECHUAT].[dbo].[AOF_ORDER_QUEUE] AS oQ ON oQ.[SALES_ORDER_NUMBER] = lQ.[SALES_ORDER_NUMBER]) - (SELECT COUNT(lQ.[SO_LINE_NUMBER]) FROM [ROBOTICS_OPTICS_MECHUAT].[dbo].[AOF_ORDER_LINE_QUEUE] AS lQ LEFT JOIN [ROBOTICS_OPTICS_MECHUAT].[dbo].[AOF_ORDER_QUEUE] AS oQ ON oQ.[SALES_ORDER_NUMBER] = lQ.[SALES_ORDER_NUMBER] WHERE lQ.[COMPLETED] = 'True'))\"\n                            Set rstD = cmd.execute()         'Check line queue quantity associated to the sales order, count the line orders associated to the current sales order in the queue that are incomplete\n                            'Set the currently indexed line order as selected\n                            If rstD(0) = 0 Then\n                            cmd.CommandText = \"SELECT [ID] FROM [ROBOTICS_OPTICS_MECHUAT].[dbo].[AOF_BOXES] WHERE [SELECTED] = 'True'\"\n                            Set rstE = cmd.execute()\n                                If Not rstE.EOF = False Then\n                                    Set eTag = ThisDisplay.eGroup.item(\"AOF\\soFinished\")\n                                    eTag.value = True\n                                    Set eTag = ThisDisplay.eGroup.item(\"AOF\\PLC_FinishBox\")\n                                    If eTag.value = 1 Then\n                                        LogDiagnosticsMessage \"Checking whether or not the PLC ready to complete the order\"\n                                        Set eTag = ThisDisplay.eGroup.item(\"AOF\\PLC_CompleteOrder\") 'Checks that order fulfillment mode is turned off\n                                        If eTag.value = 1 Then\n                                            boxNum = 0\n                                            LogDiagnosticsMessage \"Unselecting sales order \" &amp; rstA(8) &amp; \", deleting results for this sales order, and setting status to ERP\"\n                                            cmd.CommandText = \"UPDATE [ROBOTICS_OPTICS_MECHUAT].[dbo].[AOF_ORDER_QUEUE] SET [SELECTED] = 'False' WHERE [SALES_ORDER_NUMBER] = '\" &amp; rstA(8) &amp; \"'\"\n                                            cmd.execute          'Set's the current sales order selected bit to off\n                                            cmd.CommandText = \"UPDATE [ROBOTICS_OPTICS_MECHUAT].[dbo].[MACHINE_STATE] SET [STATUS] = 'USER' where [OPERATING_STATE] = 2\"\n                                            cmd.execute          'sets the status back to USER\n                                            cmd.CommandText = \"DELETE FROM [ROBOTICS_OPTICS_MECHUAT].[dbo].[AOF_OPTIC_RESULTS]\"\n                                            cmd.execute\n                                            Set eTag = ThisDisplay.eGroup.item(\"AOF\\orderFulfillmentMode\")\n                                            eTag.value = 0\n                                            Set eTag = ThisDisplay.eGroup.item(\"AOF\\PLC_CompleteOrder\")\n                                            eTag.value = 0\n                                        End If\n                                    End If\n                                End If\n                                rstE.Close\n                            Else\n                                rstA.MoveNext                'Index to the next line order in the record set\n                                LogDiagnosticsMessage \"Indexing to the next order in the list, setting\" &amp; rstA(0) &amp; \" selected.\"\n                                cmd.CommandText = \"UPDATE [ROBOTICS_OPTICS_MECHUAT].[dbo].[AOF_ORDER_LINE_QUEUE] SET [SELECTED] = 'True' WHERE [SO_LINE_NUMBER] = \" &amp; rstA(0)\n                                cmd.execute\n                                rstD.Close\n                            End If\n                    Case Is &gt; 0                          'Qty Remaining &gt; Line Order Qty (Line Order Select)\n                        LogDiagnosticsMessage \"Getting the form factor for this line order\"\n                        cmd.CommandText = \"SELECT fF.[FORM_FACTOR_DESCRIPTION] FROM [ROBOTICS_OPTICS_MECHUAT].[dbo].[FORM_FACTOR] AS fF LEFT JOIN [ROBOTICS_OPTICS_MECHUAT].[dbo].[AOF_ORDER_LINE_QUEUE] AS lQ ON lQ.[FORM_FACTOR_ID] = fF.[FORM_FACTOR_ID] WHERE lQ.[SELECTED] = 'True'\"\n                        Set rstC = cmd.execute()         'Returns the form factor description that is currently selected in the order line queue\n                        If Not rstC.EOF = True Then\n                            Set eTag = ThisDisplay.eGroup.item(\"AOF\\FormFactor\")\n                            eTag.value = rstC(0)\n                            Set eTag = ThisDisplay.eGroup.item(\"AOF\\NextOpticXFP\")\n                            Select Case rstC(0)\n                            Case Is = \"XFP\"\n                                eTag.value = True\n                            Case Is &lt;&gt; \"XFP\"\n                                eTag.value = Not True\n                            End Select\n                        End If\n                        rstC.Close\n                        LogDiagnosticsMessage \"Setting \" &amp; rstA(0) &amp; \" as selected\"\n                        cmd.CommandText = \"UPDATE [ROBOTICS_OPTICS_MECHUAT].[dbo].[AOF_ORDER_LINE_QUEUE] SET [SELECTED] = 'True' WHERE [SO_LINE_NUMBER] = \" &amp; rstA(0)\n                        cmd.execute                      'Set line as selected\n                    Case Else\n                    End Select\n                Else\n                    MsgBox (\"Error: No line orders exist for sales order \" &amp; rstA(4) &amp; \".\")\n                End If\n        ElseIf rstA.EOF = True Then\n            MsgBox (\"Error: No sales order exists or no line orders associated to sales order: \" &amp; rstA(4) &amp; \" exists.\")\n        End If\n    End If\n    Set eTag = ThisDisplay.eGroup.item(\"AOF\\ITO_OpticsReady\")\n    eTag.value = True\n\n    GoTo cleanExit\n\ncleanExit:\n    On Error Resume Next\n    If Not rst Is Nothing Then\n        rst.Close\n    End If\n    If Not rstA Is Nothing Then\n        rstA.Close\n    End If\n    If Not rstB Is Nothing Then\n        rstB.Close\n    End If\n    If Not rstC Is Nothing Then\n        rstC.Close\n    End If\n    If Not rstD Is Nothing Then\n        rstD.Close\n    End If\n    If Not rstE Is Nothing Then\n        rstE.Close\n    End If\n    conn.Close\n    Exit Sub\n\nerrorTrap:\n    LogDiagnosticsMessage \"_Eventwatcher2.gfx, Position: \" &amp; errorPosition &amp; \" , Error Code: [ \" &amp; Hex(Err.number) &amp; \"], Description: \" &amp; Err.Description &amp; \"\"\n    Resume cleanExit\n\nEnd Sub\n</code></pre>\n\n<p>So, my thought here is to put more processing on the server side.  I have created individual stored procedures to encapsulate most of these queries, but it didn't have a strong enough effect on the performance.  My main thought that brings me here now is, can I put all this into a single stored procedure?  If I execute seven queries from a stored procedure, how do I handle that in the VBA code?  How is one query differentiated from the next?  How do I use output from a query as input on another query from within a stored procedure?</p>\n\n<p>Thanks in advance!</p>\n\n<p>Edit: So I am consolidating the queries that I use select statements.  I ended up with the following, which seems to work.</p>\n\n<pre><code>Private Sub Button1_Released() \n\n    Dim rst(1 To 8) As ADODB.Recordset\n\n    errorPosition = \"ThisDisplay.Button1 Test\"\n    On Error GoTo errorTrap\n    Err.Clear\n\n\n    Set conn = New ADODB.Connection\n    Set cmd = New ADODB.Command\n    constr = \"Provider=sqloledb;data source=i.p.add.ress;initial catalog=CATALOG;user id=user;password=pass\"\n    conn.Open constr\n\n    With cmd\n        .ActiveConnection = conn\n        .CommandText = \"rt_test\"\n        .CommandType = adCmdStoredProc\n        .CommandTimeout = 2\n    End With\n\n    Set rst(1) = cmd.Execute()\n    For i = 2 To 8\n        Set rst(i) = rst(i - 1).NextRecordset\n    Next\n    i = 1\n    GoTo cleanExit\n\ncleanExit:\n    On Error Resume Next\n    For i = 1 To 8\n        If Not rst(i) Is Nothing Then\n            rst(i).Close\n        End If\n    Next\n    conn.Close\n\n    Exit Sub\n\nerrorTrap:\n    LogDiagnosticsMessage \"_Eventwatcher2.gfx, Position: \" &amp; errorPosition &amp; \" , Error Code: [ \" &amp; Hex(Err.Number) &amp; \"], Description: \" &amp; Err.Description &amp; \"\"\n    Resume cleanExit\n\nEnd Sub\n</code></pre>\n\n<p>Final Update:</p>\n\n<p>A small change to the above yielded the results I needed.  As it turns out, ADO closes the previous recordset automatically when the NextRecordSet method is called.  So instead I needed to open the recordset, then clone it into the array, then move to the next recordset.\nI added another recordset that acts as a placeholder.</p>\n\n<pre><code>Dim recordSet, rst(1 To 8) As ADODB.recordSet\n</code></pre>\n\n<p>Then modified my code as follows:</p>\n\n<pre><code>conn.CursorLocation = adUseClient 'Needed to index through and clone recordsets\nconn.Open constr\n\nWith cmd 'Run stored procedure\n    .ActiveConnection = conn\n    .CommandText = \"rt_test\"\n    .CommandType = adCmdStoredProc\n    .CommandTimeout = 2\nEnd With\n\nSet recordSet = cmd.execute()\n\nFor i = 1 To 8\n    Set rst(i) = recordSet.Clone\n    Set recordSet = recordSet.NextRecordset\nNext\n...\n...\n...\ncleanExit:\n    On Error Resume Next\n\n    If Not recordSet Is Nothing Then\n        recordSet.Close\n    End If\n\n    For i = 1 To 8\n        If Not rst(i) Is Nothing Then\n            rst(i).Close\n        End If\n    Next\n    conn.Close\n\n    Exit Sub\n\nerrorTrap:\n    LogDiagnosticsMessage \"_Eventwatcher2.gfx, Position: \" &amp; errorPosition &amp; \" , Error Code: [ \" &amp; Hex(Err.number) &amp; \"], Description: \" &amp; Err.Description &amp; \"\"\n    Resume cleanExit\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "compare"], "comments": [{"owner": {"reputation": 620, "user_id": 3119180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cc7a56a59ab84634ee6cb37a7131ed2?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Holton", "link": "https://stackoverflow.com/users/3119180/rich-holton"}, "edited": false, "score": 2, "creation_date": 1493211094, "post_id": 43634353, "comment_id": 74317432, "body": "Don&#39;t you need to specify the Beyond Compare executable file name in the shell command? For example, if the program file is bc.exe and it&#39;s located in C:\\beyond, then you need to specify Shell(&quot;c:\\beyond\\bc.exe &quot; &amp; file1 &amp; &quot; &quot; &amp; file2, vbNormalFocus). Note also that you need full path names included in file1 and file2."}, {"owner": {"reputation": 4220, "user_id": 1353930, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/eb10a7255a6d7fa4a4068d05c53ac0fa?s=128&d=identicon&r=PG", "display_name": "Daniel Alder", "link": "https://stackoverflow.com/users/1353930/daniel-alder"}, "edited": false, "score": 1, "creation_date": 1493211748, "post_id": 43634353, "comment_id": 74318010, "body": "And don&#39;t forget to quote/escape your file names. Otherwise you will have problems with file names containing spaces"}], "owner": {"user_type": "does_not_exist", "display_name": "user7925377"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 285, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1493211402, "creation_date": 1493210057, "last_edit_date": 1531164843, "question_id": 43634353, "link": "https://stackoverflow.com/questions/43634353/vba-executes-beyond-compare-and-opens-two-files", "title": "VBA Executes &#39;Beyond Compare&#39; and Opens Two Files", "body": "<p>I'm creating a program that compares two files, using <a href=\"http://www.scootersoftware.com/features.php?zz=features_focused\" rel=\"nofollow noreferrer\"><em>Beyond Compare</em></a> program by shell command. However I can only open one file. I want both files to be executed together.</p>\n\n<p>Here's the code I used:</p>\n\n<pre><code>Dim Path As String\nDim File1 As String\nDim File2 As String\n\n'[Codes for Other Conditions]\n'...\n\nIf Test &lt;&gt; \"\" Then \n  'Test Variable will trigger opening beyond compare and compares\n  'File1 (on right side) and File2 (Left Side)\n    Path = Shell(\"C:\\Temp\\\" + \" \" + File1  + \" \" + File2, vbNormalFocus)\nend If\n</code></pre>\n\n<p>Thank you in advance!</p>\n"}, {"tags": ["vba", "sorting", "email", "outlook", "directory"], "comments": [{"owner": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "edited": false, "score": 5, "creation_date": 1493209154, "post_id": 43633958, "comment_id": 74315817, "body": "Welcome to StackOverflow. Please note, that this is not a free code-writing service. Yet, we are eager to help fellow programmers (and aspirants) writing their own code. Please read the help topics on <a href=\"http://stackoverflow.com/help/how-to-ask\">How do I Ask a Good Question</a>. Afterwards, please update your question with the VBA code you have written thus far in order to complete the task(s) you wish to achieve. We will be here waiting for you. Ready to assist and help you finalize <i>your code</i>."}, {"owner": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 0, "creation_date": 1493214697, "post_id": 43633958, "comment_id": 74320526, "body": "I formatted your code, but am not 100% sure I got the indentation right to reflect your meaning. Please review and edit if necessary."}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1493231866, "post_id": 43633958, "comment_id": 74332416, "body": "Putting in pseudo-code does not change this from being a code-writing service-type question.    Someone has answered your question, although I don&#39;t think they really should have as it won&#39;t teach you anything.  If your boss is asking you to do this exercise, they probably want you to understand and learn VBA, not to get someone else to write it.  I hope you send some of your salary to Eugene as he just did your job for you, although you failed to learn the knowledge that will help you further your career....(continued)"}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1493232039, "post_id": 43633958, "comment_id": 74332524, "body": "If you had done a google search for &quot;how to get mail in inbox vba stack overflow&quot;, you would have found, <a href=\"http://stackoverflow.com/questions/24321752/outlook-vba-how-to-loop-through-inbox-and-list-from-email-email-address-if-subje\" title=\"outlook vba how to loop through inbox and list from email email address if subje\">stackoverflow.com/questions/24321752/&hellip;</a> among many other good questions which would have started you off and you could have continued googling things until you figured it out or had a problem you couldn&#39;t figure out.  You are, of course, welcome here, but try a little effort first."}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 7925301, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TrjcAnCwsyQ/AAAAAAAAAAI/AAAAAAAAGlU/PPChJxkZfCM/photo.jpg?sz=128", "display_name": "Philip Day", "link": "https://stackoverflow.com/users/7925301/philip-day"}, "edited": false, "score": 0, "creation_date": 1493314858, "post_id": 43641985, "comment_id": 74376103, "body": "Thank you, this looks great. I have done some VBA before and feel confident to take this forward when i get back to work! I&#39;m not sure how to mark this as the answer, but clearly Eugene has indeed come up trumps. I&#39;m sorry that I got it wrong, I didn&#39;t want to put some utter rubbish, but that of course doesn&#39;t excuse a failure to follow the protocol."}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": true, "score": 0, "last_activity_date": 1493231543, "creation_date": 1493231543, "answer_id": 43641985, "question_id": 43633958, "link": "https://stackoverflow.com/questions/43633958/vba-to-move-read-emails-to-specific-folders/43641985#43641985", "title": "VBA to move read emails to specific folders", "body": "<p>Iterating through all items in the Inbox folder is not a good idea. You need to use the <a href=\"http://msdn.microsoft.com/en-us/library/ff869662.aspx\" rel=\"nofollow noreferrer\">Find</a>/<a href=\"http://msdn.microsoft.com/en-us/library/ff862482.aspx\" rel=\"nofollow noreferrer\">FindNext</a> or <a href=\"http://msdn.microsoft.com/en-us/library/ff869597.aspx\" rel=\"nofollow noreferrer\">Restrict</a> methods of the <code>Items</code> class to find all items that correspond to your conditions (read and sender name). Read more about these methods in the following articles:</p>\n\n<ul>\n<li><a href=\"https://www.add-in-express.com/creating-addins-blog/2011/09/20/outlook-find-findnext-retrieve-mail/\" rel=\"nofollow noreferrer\">How To: Use Find and FindNext methods to retrieve Outlook mail items from a folder (C#, VB.NET)</a></li>\n<li><a href=\"https://www.add-in-express.com/creating-addins-blog/2011/09/23/outlook-restrict-method-retrieve-mail/\" rel=\"nofollow noreferrer\">How To: Use Restrict method to retrieve Outlook mail items from a folder</a></li>\n</ul>\n\n<p>Then you can use the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff860683.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">Move</a> method of the MailItem class to move a Microsoft Outlook item to a new folder. For example:</p>\n\n<pre><code>Sub MoveItems() \n Dim myNameSpace As Outlook.NameSpace \n Dim myInbox As Outlook.Folder \n Dim myDestFolder As Outlook.Folder \n Dim myItems As Outlook.Items \n Dim myItem As Object \n\n Set myNameSpace = Application.GetNamespace(\"MAPI\") \n Set myInbox = myNameSpace.GetDefaultFolder(olFolderInbox) \n Set myItems = myInbox.Items \n Set myDestFolder = myInbox.Folders(\"Personal Mail\") \n Set myItem = myItems.Find(\"[SenderName] = 'Eugene Astafiev'\") \n While TypeName(myItem) &lt;&gt; \"Nothing\" \n  myItem.Move myDestFolder \n  Set myItem = myItems.FindNext \n Wend \nEnd Sub\n</code></pre>\n\n<p>You may find the <a href=\"https://msdn.microsoft.com/en-us/library/office/ee814736%28v=office.14%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">Getting Started with VBA in Outlook 2010</a> article helpful. </p>\n"}], "owner": {"reputation": 71, "user_id": 7925301, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TrjcAnCwsyQ/AAAAAAAAAAI/AAAAAAAAGlU/PPChJxkZfCM/photo.jpg?sz=128", "display_name": "Philip Day", "link": "https://stackoverflow.com/users/7925301/philip-day"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1388, "favorite_count": 0, "accepted_answer_id": 43641985, "answer_count": 1, "score": 0, "last_activity_date": 1493231543, "creation_date": 1493208988, "last_edit_date": 1493214665, "question_id": 43633958, "link": "https://stackoverflow.com/questions/43633958/vba-to-move-read-emails-to-specific-folders", "title": "VBA to move read emails to specific folders", "body": "<p>I'm struggling to find a definitive answer to what must be a reasonably common problem?</p>\n\n<p>My boss has folders in their inbox for members of the team, but doesn't want to move the emails there until they have been read out of the inbox. So I am trying to write a macro which follows these logical steps:</p>\n\n<pre><code>For each mailitem in inbox:\n    Check if read\n      Check sender name\n      select case True\n        sender name like existing folder name\n        move item to corresponding folder name\nnext mailitem\n</code></pre>\n\n<p>Can you help me put this together, I'm rather lost at sea on this one!!</p>\n\n<p>Phil</p>\n"}, {"tags": ["excel", "vba", "pivot", "pivot-table"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1493213728, "post_id": 43633785, "comment_id": 74319733, "body": "Please check if your <code>PC</code> has a <code>SourceData</code> add a line <code>Debug.Print PC.SourceData</code>"}], "answers": [{"tags": [], "owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "is_accepted": false, "score": 1, "last_activity_date": 1493237643, "creation_date": 1493237643, "answer_id": 43643718, "question_id": 43633785, "link": "https://stackoverflow.com/questions/43633785/pivot-table-using-data-from-89-workbooks-excel-vba/43643718#43643718", "title": "Pivot table using data from 89 workbooks (Excel VBA)", "body": "<p>The Microsoft JET/ACE Database engine has a hard limit of 50 \u2018UNION ALL\u2019 clauses, which you have exceeded. The only way around it is to create sub-blocks of UNION ALL statements, then stitch them all together with another UNION ALL.\nI demonstrate how to do this at the following link:</p>\n\n<p><a href=\"http://dailydoseofexcel.com/archives/2013/11/19/unpivot-via-sql/\" rel=\"nofollow noreferrer\">http://dailydoseofexcel.com/archives/2013/11/19/unpivot-via-sql/</a></p>\n\n<p>Your other options are to bring the data from all the different workbooks into a master sheet by using VBA and then make a pivottable out of that (which will be much faster than using SQL statements as per the timings I posted at <a href=\"http://dailydoseofexcel.com/archives/2013/11/21/unpivot-shootout/\" rel=\"nofollow noreferrer\">http://dailydoseofexcel.com/archives/2013/11/21/unpivot-shootout/</a> ) or to use PowerQuery, which will be the simplest approach by far. </p>\n"}], "owner": {"reputation": 1, "user_id": 7924231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3240b8bc26103081210b9cc6530b303?s=128&d=identicon&r=PG&f=1", "display_name": "Andrea Szakallova", "link": "https://stackoverflow.com/users/7924231/andrea-szakallova"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1493237643, "creation_date": 1493208536, "last_edit_date": 1493211823, "question_id": 43633785, "link": "https://stackoverflow.com/questions/43633785/pivot-table-using-data-from-89-workbooks-excel-vba", "title": "Pivot table using data from 89 workbooks (Excel VBA)", "body": "<p>I have 89 excel workbooks each contains 2 worksheets. Each work sheet represents one filling station. \nFor the pivot table I would use only one of the two sheets. Front row is the same for each of them, but the number of rows is different-filling stations fill the data after delivery. \nAt the moment there is not that much data (37 column and 100 row in each sheet)</p>\n\n<p>I have set up an additional workbook with excel VBA code to pull the required data into one Pivot table. </p>\n\n<p>Code works if I do not choose all of 89 workbooks. \nWhen I try to select all of them, there is an error message that says:</p>\n\n<blockquote>\n  <p>Run-time error '1004': [Microsoft][ODBC Excel Driver] Query is too complex</p>\n</blockquote>\n\n<p>The debug shows:</p>\n\n<blockquote>\n  <p>Set PT = .CreatePivotTable(TableDestination:=rng(6, 1))</p>\n</blockquote>\n\n<p>Can you please give some tips or advice to solve the problem?\nThank you very much for any help.</p>\n\n<pre><code>Option Explicit\n\nDeclare Function SetCurrentDirectoryA Lib \"kernel32\" (ByVal Path As String) As Long\n\nSub ChDirNet(Path As String)\n    Dim Result As Long\n    Result = SetCurrentDirectoryA(Path)\n    If Result = 0 Then Err.Raise vbObjectError + 1, \"Error changing to new path.\"\nEnd Sub\n\n\n\nSub MergeFiles()\n    Dim PT As PivotTable\n    Dim PC As PivotCache\n    Dim arrFiles As Variant\n    Dim strSheet As String\n    Dim strPath As String\n    Dim strSQL As String\n    Dim strCon As String\n    Dim rng As Range\n    Dim i As Long\n\n    strPath = CurDir\n    ChDirNet ThisWorkbook.Path\n\n    arrFiles = Application.GetOpenFilename(\"Microsoft Excel Macro-Enabled Worksheet (*.xlsm), *.xlsm\", , , , True)\n    strSheet = \"DB\"\n\n    If Not IsArray(arrFiles) Then Exit Sub\n\n    Application.ScreenUpdating = False\n\n    If Val(Application.Version) &gt; 11 Then DeleteConnections_12\n\n    Set rng = ThisWorkbook.Sheets(1).Cells\n    rng.Clear\n    For i = 1 To UBound(arrFiles)\n        If strSQL = \"\" Then\n            strSQL = \"SELECT * FROM [\" &amp; strSheet &amp; \"$]\"\n        Else\n            strSQL = strSQL &amp; \" UNION ALL SELECT * FROM `\" &amp; arrFiles(i) &amp; \"`.[\" &amp; strSheet &amp; \"$]\"\n        End If\n    Next i\n    strCon = _\n        \"ODBC;\" &amp; _\n        \"DSN=Excel Files;\" &amp; _\n        \"DBQ=\" &amp; arrFiles(1) &amp; \";\" &amp; _\n        \"DefaultDir=\" &amp; \"\" &amp; \";\" &amp; _\n        \"Driver={Microsoft Excel Driver (*.xls, *.xlsx, *.xlsm, *.xlsb)};\" &amp; _\n        \"DriverId=1046;\" &amp; _\n        \"MaxBufferSize=2048;\" &amp; _\n        \"PageTimeout=5\"\n\n    Set PC = ThisWorkbook.PivotCaches.Add(SourceType:=xlExternal)\n\n    With PC\n        .Connection = strCon\n        .CommandType = xlCmdSql\n        .CommandText = strSQL\n        Set PT = .CreatePivotTable(TableDestination:=rng(6, 1))\n    End With\n\n    With PT\n        With .PivotFields(1)                            'Date\n            .Orientation = xlRowField\n            .Position = 1\n        End With\n\n        With .PivotFields(2)                            'Product\n            .Orientation = xlRowField\n            .Position = 2\n        End With\n            .AddDataField .PivotFields(32), \"Manko\", xlSum   'Difference N/V L15\n            .AddDataField .PivotFields(9), \"Sum of Dodan\u00e9\", xlSum   'Delivery L15\n        With .PivotFields(16)                            'SPZ\n            .Orientation = xlPageField\n            .Position = 1\n        End With\n        With .PivotFields(18)                            'supply\n            .Orientation = xlPageField\n            .Position = 2\n        End With\n        With .PivotFields(37)                            'Number of FS\n            .Orientation = xlColumnField\n            .Position = 1\n        End With\n\n    End With\n\n    'Clean up\n    Set PT = Nothing\n    Set PC = Nothing\n\n    ChDirNet strPath\n    Application.ScreenUpdating = True\nEnd Sub\n\nPrivate Sub DeleteConnections_12()\n     '*****************************************************************************\n    On Error Resume Next: ThisWorkbook.Connections(1).Delete: On Error GoTo 0\n    '*****************************************************************************\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1493208649, "creation_date": 1493208649, "answer_id": 43633830, "question_id": 43633708, "link": "https://stackoverflow.com/questions/43633708/i-am-trying-to-import-large-data-from-excel-to-sql-server-but-it-is-giving-as/43633830#43633830", "title": "I am trying to import large data from excel to SQL server, but it is giving as &quot;AUTOMATION ERROR&quot;", "body": "<p>I generally use <code>.TransferSpreadsheet</code> to get data from excel into access. <a href=\"https://msdn.microsoft.com/en-us/library/office/ff844793.aspx\" rel=\"nofollow noreferrer\">Here</a> you can find the documentation.</p>\n\n<p>Alternatively you can use the import function of access, generate an import specification that way and use it again later.</p>\n"}], "owner": {"reputation": 99, "user_id": 7408078, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e4fac61351f1a4bebc205e64285818dc?s=128&d=identicon&r=PG&f=1", "display_name": "nick", "link": "https://stackoverflow.com/users/7408078/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1493208649, "creation_date": 1493208314, "last_edit_date": 1531164843, "question_id": 43633708, "link": "https://stackoverflow.com/questions/43633708/i-am-trying-to-import-large-data-from-excel-to-sql-server-but-it-is-giving-as", "title": "I am trying to import large data from excel to SQL server, but it is giving as &quot;AUTOMATION ERROR&quot;", "body": "<p>will this code works for large data ?\nThis code works fine for small data, but for large data it gives automation error, only few lines are getting loaded into database</p>\n\n<pre><code>Sub insertion()\nDim conn As ADODB.Connection\nDim rs As ADODB.Recordset\nDim sConnString As String\nDim rsstring As String\nDim m, nrows As Integer\nDim wb1 As Excel.Workbook\nSet wb1 = Workbooks.Open(\"D:\\MPN-Materials.xlsx\")\nwb1.Sheets(\"sheet1\").Activate\nsConnString = \"Provider=SQLOLEDB;Data Source=PRATEEP-PC\\SQLEXPRESS;\" &amp; _\n              \"Initial Catalog=MDM;\" &amp; _\n              \"Integrated Security=SSPI;\"\nSet conn = New ADODB.Connection\nSet rs = New ADODB.Recordset\nconn.Open sConnString\n    Dim loRH As Excel.ListObject\n    Set loRH = wb1.Sheets(\"MPN Materials\").ListObjects(1)\n    loRH.Parent.Activate\n    loRH.ListColumns(1).DataBodyRange.Select\n    nrows = WorksheetFunction.CountA(Selection)\n For m = 0 To nrows - 1\n rsstring = \"insert into MPN_Materials (MPN_Material, Material_Desc, \n Int_Material_No, MPN, Manufacture_ID,  Material_Grp, Material_Type, \n   Last_Change, UoM) values\" _\n        &amp; \"('\" &amp; loRH.DataBodyRange.Cells(m + 1, 1) &amp; \"', \" _\n        &amp; \"'\" &amp; loRH.DataBodyRange.Cells(m + 1, 2) &amp; \"', \" _\n        &amp; \"'\" &amp; loRH.DataBodyRange.Cells(m + 1, 3) &amp; \"', \" _\n        &amp; \"'\" &amp; loRH.DataBodyRange.Cells(m + 1, 4) &amp; \"', \" _\n        &amp; \"'\" &amp; loRH.DataBodyRange.Cells(m + 1, 5) &amp; \"', \" _\n        &amp; \"'\" &amp; loRH.DataBodyRange.Cells(m + 1, 6) &amp; \"', \" _\n        &amp; \"'\" &amp; loRH.DataBodyRange.Cells(m + 1, 7) &amp; \"', \" _\n        &amp; \"'\" &amp; loRH.DataBodyRange.Cells(m + 1, 8) &amp; \"', \" _\n        &amp; \"'\" &amp; loRH.DataBodyRange.Cells(m + 1, 9) &amp; \"'); \"\n  Set rs = New ADODB.Recordset\n  Set rs = conn.Execute(rsstring)\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 95, "user_id": 7710018, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/50f4357aa7f73fb1087b8c852d257d2a?s=128&d=identicon&r=PG&f=1", "display_name": "Porkball21", "link": "https://stackoverflow.com/users/7710018/porkball21"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1493209877, "post_id": 43633660, "comment_id": 74316423, "body": "Okay, that&#39;s good but how can I get it to do it by locating the name of the column from Cell A1 = &quot;DATA_TYPE&quot; rather than BI?"}], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 7710018, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/50f4357aa7f73fb1087b8c852d257d2a?s=128&d=identicon&r=PG&f=1", "display_name": "Porkball21", "link": "https://stackoverflow.com/users/7710018/porkball21"}, "edited": false, "score": 0, "creation_date": 1493211152, "post_id": 43634473, "comment_id": 74317477, "body": "Hmmm I am getting a debug error - Rng.EntireColumn.Address = &lt;Object variable or With block variable not set&gt;"}, {"owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "reply_to_user": {"reputation": 95, "user_id": 7710018, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/50f4357aa7f73fb1087b8c852d257d2a?s=128&d=identicon&r=PG&f=1", "display_name": "Porkball21", "link": "https://stackoverflow.com/users/7710018/porkball21"}, "edited": false, "score": 0, "creation_date": 1493211538, "post_id": 43634473, "comment_id": 74317833, "body": "@Porkball21 My bad - it&#39;s fixed now"}, {"owner": {"reputation": 95, "user_id": 7710018, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/50f4357aa7f73fb1087b8c852d257d2a?s=128&d=identicon&r=PG&f=1", "display_name": "Porkball21", "link": "https://stackoverflow.com/users/7710018/porkball21"}, "edited": false, "score": 0, "creation_date": 1493213470, "post_id": 43634473, "comment_id": 74319505, "body": "Thank you very much! Works like a charm"}], "tags": [], "owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "is_accepted": true, "score": 0, "last_activity_date": 1493211514, "last_edit_date": 1493211514, "creation_date": 1493210327, "answer_id": 43634473, "question_id": 43633660, "link": "https://stackoverflow.com/questions/43633660/how-to-remove-all-rows-where-cells-are-blank-in-specific-column-name/43634473#43634473", "title": "How to remove all rows where cells are blank in specific column name", "body": "<p>This will do it:</p>\n\n<pre><code>Sub DeletedBlankCells()\nDim Rng As Range\n\nSet Rng = Rows(\"1:1\").Find(What:=\"DATA_TYPE\", After:=Cells(1, 1), LookIn:=xlValues, LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext)\nSheets(\"Sheet1\").Columns(Rng.EntireColumn.Address).SpecialCells(xlCellTypeBlanks).EntireRow.Delete\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 7710018, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/50f4357aa7f73fb1087b8c852d257d2a?s=128&d=identicon&r=PG&f=1", "display_name": "Porkball21", "link": "https://stackoverflow.com/users/7710018/porkball21"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 43634473, "answer_count": 1, "score": 0, "last_activity_date": 1493211514, "creation_date": 1493208184, "last_edit_date": 1531161705, "question_id": 43633660, "link": "https://stackoverflow.com/questions/43633660/how-to-remove-all-rows-where-cells-are-blank-in-specific-column-name", "title": "How to remove all rows where cells are blank in specific column name", "body": "<p>I have some code below which does not currently work. </p>\n\n<p>It is supposed to delete all rows where values are blank in Column BI in Sheet 1. However, I would like it to delete all rows where cells are blank for Column where A1 cell is equal to \"DATA_TYPE\".</p>\n\n<pre><code>Sub RemoveBlanks()\n    Sheets(\"Sheet 1\").Select\n    Columns(\"BI:BI\").Select\n    Selection.SpecialCells(xlCellTypeBlanks).Select\n    Selection.EntireRow.Delete\nEnd Sub\n</code></pre>\n\n<p>How can I change this to do what I am after? At the moment, I am getting some strange output message back stating \"400\" and I have no idea what it means... </p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1493209063, "post_id": 43633109, "comment_id": 74315746, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/43476808/access-2016-create-table-with-field-properties-for-combobox\">Access 2016 create table with field properties for combobox</a>"}, {"owner": {"reputation": 8194, "user_id": 389034, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/be9347a6c005e10abe05abf8caafbba0?s=128&d=identicon&r=PG", "display_name": "Graham Charles", "link": "https://stackoverflow.com/users/389034/graham-charles"}, "edited": false, "score": 0, "creation_date": 1610044014, "post_id": 43633109, "comment_id": 116014953, "body": "FWIW, the type value should be set to <code>dbInteger</code>, not <code>vbLong</code>. They both represent the constant 3, but that&#39;s accidental. So: <code>Set prp = fld.CreateProperty(&quot;DisplayControl&quot;, dbInteger, AcControlType.acComboBox)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 25, "user_id": 4498397, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ygFpuOmO-F0/AAAAAAAAAAI/AAAAAAAAAC4/9_xe4bHfsbg/photo.jpg?sz=128", "display_name": "Ahmed Yousry", "link": "https://stackoverflow.com/users/4498397/ahmed-yousry"}, "is_accepted": false, "score": 1, "last_activity_date": 1493209595, "creation_date": 1493209595, "answer_id": 43634200, "question_id": 43633109, "link": "https://stackoverflow.com/questions/43633109/setting-the-rowsource-property-of-a-field-which-has-a-combobox-display-control-i/43634200#43634200", "title": "Setting the RowSource property of a field which has a ComboBox Display Control in Access VBA", "body": "<p>Ok, I found the answer shortly after I posted the question.\nI'll leave the answer for anyone who might need it.</p>\n\n<pre><code>Set prp = fld.CreateProperty(\"RowSourceType\", dbText, \"Table/Query\")\nfld.Properties.Append prp\nSet prp = fld.CreateProperty(\"RowSource\", dbText, \"SELECT * FROM TBL;\")\nfld.Properties.Append prp\n</code></pre>\n\n<p>You can also add the two properties below to set the column count and the column width.</p>\n\n<pre><code>Set prp = fld.CreateProperty(\"ColumnCount\", dbInteger, 2)\nfld.Properties.Append prp\nSet prp = fld.CreateProperty(\"ColumnWidths\", dbText, \"0;1440\")\nfld.Properties.Append prp\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 4498397, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ygFpuOmO-F0/AAAAAAAAAAI/AAAAAAAAAC4/9_xe4bHfsbg/photo.jpg?sz=128", "display_name": "Ahmed Yousry", "link": "https://stackoverflow.com/users/4498397/ahmed-yousry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 804, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1493209595, "creation_date": 1493206661, "last_edit_date": 1493209073, "question_id": 43633109, "link": "https://stackoverflow.com/questions/43633109/setting-the-rowsource-property-of-a-field-which-has-a-combobox-display-control-i", "title": "Setting the RowSource property of a field which has a ComboBox Display Control in Access VBA", "body": "<p>I'm creating a dynamic temporary table using VBA. The table stores some values in order to be processed and confirmed by the user before being stored to the database.</p>\n\n<p>I managed to display one of the table's fields as a ComboBox using the code below</p>\n\n<pre><code>Set prp = fld.CreateProperty(\"DisplayControl\", vbLong, acComboBox)\nfld.Properties.Append prp\n</code></pre>\n\n<p>However I don't know how to populate the ComboBox displayed field.<br>\nI tried creating another property for the RowSourceType and the RowSource but I don't know how to fill the parameters.</p>\n\n<pre><code>Set prp = fld.CreateProperty(\"RowSourceType\", ?, ?)\n</code></pre>\n"}, {"tags": ["mysql", "sql", "database", "vba", "ms-access"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1493206652, "post_id": 43632979, "comment_id": 74314027, "body": "idea 2 will give you what you already have in  <code>SELECT max([GuestID]) FROM Guest )  </code>"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1493206722, "post_id": 43632979, "comment_id": 74314069, "body": "<code>&#39;SELECT Max([GuestID]) FROM [Guest]&#39;</code> needs to be <code>(SELECT Max([GuestID]) FROM [Guest])</code>"}, {"owner": {"reputation": 3, "user_id": 3259517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdc8ad0314cf6d4be754dd50eb2fe0a0?s=128&d=identicon&r=PG&f=1", "display_name": "user3259517", "link": "https://stackoverflow.com/users/3259517/user3259517"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1493207588, "post_id": 43632979, "comment_id": 74314682, "body": "&#39;&quot; &amp; RoomNum &amp; &quot;&#39;, ( SELECT Max([GuestID]) FROM [Guest] ) );&quot;  is this what you are refering to. because this returns syntax errors."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1493207821, "post_id": 43632979, "comment_id": 74314827, "body": "what are the errors?  Can you show the data types in both tables also."}, {"owner": {"reputation": 3, "user_id": 3259517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdc8ad0314cf6d4be754dd50eb2fe0a0?s=128&d=identicon&r=PG&f=1", "display_name": "user3259517", "link": "https://stackoverflow.com/users/3259517/user3259517"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1493208394, "post_id": 43632979, "comment_id": 74315221, "body": "Query input must contain at least one table or query.                   and the datatype for Guest.GuestID is AutoNumber  ,  and Transaction.GuestID is Number"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1493209981, "post_id": 43632979, "comment_id": 74316504, "body": "what is the sql just the bit from the comma???  show the generated sql pls."}, {"owner": {"reputation": 3, "user_id": 3259517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdc8ad0314cf6d4be754dd50eb2fe0a0?s=128&d=identicon&r=PG&f=1", "display_name": "user3259517", "link": "https://stackoverflow.com/users/3259517/user3259517"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1493218837, "post_id": 43632979, "comment_id": 74324038, "body": "CurrentDb.Execute &quot;INSERT INTO Transaction (CheckInDate,CheckOutDate,[Amount],RoomNumber,GuestID)&quot; _ &amp; &quot; VALUES (#&quot; &amp; Me.CheckIn &amp; &quot;#,#&quot; &amp; Me.CheckIn &amp; &quot;#,&#39;&quot; &amp; Me.total &amp; &quot;&#39;,&#39;&quot; &amp; RoomNum &amp; &quot;&#39;, ( SELECT Max([GuestID]) FROM [Guest] ) );&quot;"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1493219280, "post_id": 43632979, "comment_id": 74324410, "body": "transaction cant be used as a reserved word of sql try [Transaction]"}, {"owner": {"reputation": 3, "user_id": 3259517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdc8ad0314cf6d4be754dd50eb2fe0a0?s=128&d=identicon&r=PG&f=1", "display_name": "user3259517", "link": "https://stackoverflow.com/users/3259517/user3259517"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1493220991, "post_id": 43632979, "comment_id": 74325695, "body": "i have added the Brackets ,however the transaction script does insert the only thing omited is the GuestID"}], "owner": {"reputation": 3, "user_id": 3259517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdc8ad0314cf6d4be754dd50eb2fe0a0?s=128&d=identicon&r=PG&f=1", "display_name": "user3259517", "link": "https://stackoverflow.com/users/3259517/user3259517"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 325, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1493224018, "creation_date": 1493206292, "last_edit_date": 1493224018, "question_id": 43632979, "link": "https://stackoverflow.com/questions/43632979/inserting-id-from-another-table-to-current-table-access-form", "title": "Inserting Id from another table to current table access form", "body": "<p>I have an access form that adds transactions. when you hit the add transaction button. it will create the transaction in the Transactions Table, along with the Guest information in the Guest table.</p>\n\n<p>I want to take that GuestID from Guest and store it in the Transaction.GuestID field. \nlinking the data for each Transaction to the correct Guest.</p>\n\n<p>Idea 1</p>\n\n<pre><code>CurrentDb.Execute \"INSERT INTO Transaction (RoomNumber,GuestID)\" _\n\n&amp; \" VALUES ('\" &amp; RoomNum &amp; \"','SELECT Max([GuestID]) FROM [Guest]' );\"\n</code></pre>\n\n<p>Idea 2</p>\n\n<pre><code>, SELECT GuestID FROM [Guest] WHERE GuestID =( SELECT max([GuestID]) FROM Guest )  ) ;\"\n</code></pre>\n\n<p>currently, Idea1 will create the new data for Transaction and Guest but does now add any value in Transaction/GuestID</p>\n\n<p>Thank you for your time in advance </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "edited": false, "score": 0, "creation_date": 1493206086, "post_id": 43632874, "comment_id": 74313606, "body": "What is the trouble you&#39;re having?  We certainly can&#39;t see where you&#39;ve gone wrong either..."}, {"owner": {"reputation": 93, "user_id": 7286656, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b0975bd5f33d7a8da63bf27e0fb62764?s=128&d=identicon&r=PG&f=1", "display_name": "leon Hill", "link": "https://stackoverflow.com/users/7286656/leon-hill"}, "reply_to_user": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "edited": false, "score": 0, "creation_date": 1493206262, "post_id": 43632874, "comment_id": 74313717, "body": "it keeps saying method range of object_global failed... i dont understand the error"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 2, "creation_date": 1493206434, "post_id": 43632874, "comment_id": 74313866, "body": "The error will actually be in the code in your <code>Userform_Initialize</code> or <code>Userform_Activate</code> events in all likelihood."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 2, "creation_date": 1493207159, "post_id": 43632874, "comment_id": 74314366, "body": "What Rory said. Put a Breakpoint on the <code>UserForm1.Show</code> line and step through (with [F8]) to see where the problem lies."}], "owner": {"reputation": 93, "user_id": 7286656, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b0975bd5f33d7a8da63bf27e0fb62764?s=128&d=identicon&r=PG&f=1", "display_name": "leon Hill", "link": "https://stackoverflow.com/users/7286656/leon-hill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 181, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1493206408, "creation_date": 1493206028, "last_edit_date": 1531164843, "question_id": 43632874, "link": "https://stackoverflow.com/questions/43632874/assigning-a-button-to-a-userform", "title": "Assigning a button to a userform", "body": "<p>I am having trouble assigning a button to open my user form. I have tried for a while but cannot see where I have gone wrong. The user form is called userform1 and the button is called button. Any help would be appreacted. </p>\n\n<pre><code>Private Sub button_Click()\nUserForm1.Show\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1493205939, "post_id": 43632674, "comment_id": 74313482, "body": "You loop through xx, but there is no use of xx in your code?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1493206389, "post_id": 43632674, "comment_id": 74313827, "body": "Why don&#39;t you use <code>Instr</code> instead of <code>Application.Find</code>? It will return 0 if the search string isn&#39;t found, rather than an error value."}], "answers": [{"tags": [], "owner": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1493206175, "last_edit_date": 1525816189, "creation_date": 1493206175, "answer_id": 43632930, "question_id": 43632674, "link": "https://stackoverflow.com/questions/43632674/how-to-use-iferror-goto-next-function/43632930#43632930", "title": "How to use IfError GoTo Next function", "body": "<p>Something like <a href=\"http://www.cpearson.com/excel/errorhandling.htm\" rel=\"nofollow noreferrer\">this</a>?</p>\n\n<pre><code>On Error Goto JumpHere:\ni = 1 / 0 'throws error\ni = 2 'this line is never executed\nJumpHere:\ni = 1 'code resumes here after error in line 2\n</code></pre>\n\n<p>Hope this helps!</p>\n"}, {"tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": false, "score": 1, "last_activity_date": 1493206806, "last_edit_date": 1495540018, "creation_date": 1493206245, "answer_id": 43632954, "question_id": 43632674, "link": "https://stackoverflow.com/questions/43632674/how-to-use-iferror-goto-next-function/43632954#43632954", "title": "How to use IfError GoTo Next function", "body": "<p>The following code answers your question as asked:</p>\n\n<pre><code>For xx = 2 To 15494\n    xword = Cells(s, m)\n\n    If xword &lt;&gt; \"\" Then\n    le = Len(xword)\n    On Error GoTo NextLine\n    sprd = Application.Find(\",\", xword) '' If I am getting Error\n    On Error GoTo 0\n    old_sprd = sprd\n    's = 1\n    Star = 1\n    Do While sprd &lt;&gt; 0\n\n    word = Mid(xword, Star, sprd - 1)\n    xword = Mid(xword, sprd + 1, le)\n    s = s + 1\n    Rows(s).Insert\n    Cells(s, m) = word\n    sprd = Application.Find(\",\", xword)\n    If IsError(sprd) Then sprd = 0\n    If sprd = 0 Then\n    s = s + 1\n    Rows(s).Insert\n    Cells(s, m) = xword\n    End If\n    le = Len(xword)\n\n    Loop\n    End If\nNextLine:\n    s = s + 1 '' My Code supposed to directing divert in This line.\nNext\n</code></pre>\n\n<p>Basically, there are three changes: (1) just before issuing the <code>Application.Find</code> command there is a line telling VBA what to do in case of an error <code>--&gt;</code> it should go to <code>NextLine</code>. <code>NewLine</code> is like a bookmark and can be any name you want. You merely need to tell VBA where this bookmark is. That's the second change in your code: (2) adding a line just before <code>s = s + 1</code> telling VBA that this is the \"bookmark\" called <code>NewLine</code>. The third change is to tell VBA to only use this \"bookmark\" if the error occurs on the line <code>Application.Find</code>. In all other cases VBA should just pass the error back to you (the user). So, (3) directly after the line <code>Application.Find</code> the <a href=\"https://stackoverflow.com/questions/14158901/difference-between-on-error-goto-0-and-on-error-goto-1-vba\">error trapping is being turned off again</a>.</p>\n\n<p>Yet, a better solution would be to use <code>InStr()</code> like so:</p>\n\n<pre><code>For xx = 2 To 15494\n    xword = Cells(s, m)\n    If xword &lt;&gt; \"\" Then\n        le = Len(xword)\n        If InStr(1, xword, \",\", vbTextCompare) Then\n            sprd = Application.Find(\",\", xword)\n            old_sprd = sprd\n            Star = 1\n            Do While sprd &lt;&gt; 0\n                word = Mid(xword, Star, sprd - 1)\n                xword = Mid(xword, sprd + 1, le)\n                s = s + 1\n                Rows(s).Insert\n                Cells(s, m) = word\n                sprd = Application.Find(\",\", xword)\n                If IsError(sprd) Then sprd = 0\n                If sprd = 0 Then\n                    s = s + 1\n                    Rows(s).Insert\n                    Cells(s, m) = xword\n                End If\n                le = Len(xword)\n            Loop\n        End If\n    End If\n    s = s + 1 '' My Code supposed to directing divert in This line.\nNext xx\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 206726, "user_id": 5459839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iehrR.jpg?s=128&g=1", "display_name": "trincot", "link": "https://stackoverflow.com/users/5459839/trincot"}, "is_accepted": true, "score": 1, "last_activity_date": 1493206320, "creation_date": 1493206320, "answer_id": 43632989, "question_id": 43632674, "link": "https://stackoverflow.com/questions/43632674/how-to-use-iferror-goto-next-function/43632989#43632989", "title": "How to use IfError GoTo Next function", "body": "<p>Instead of <code>Application.Find</code> use <code>InStr</code> (and swap the arguments):</p>\n\n<pre><code>sprd = InStr(xword, \",\")\n</code></pre>\n\n<p>That does not produce an error, and is more efficient.</p>\n\n<p>In case no match is found, <em>sprd</em> will be zero, and so your <code>Do While</code> loop will be skipped.</p>\n"}], "owner": {"reputation": 367, "user_id": 7325296, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/53c7dc31dab598186da3730f18197086?s=128&d=identicon&r=PG&f=1", "display_name": "sagar", "link": "https://stackoverflow.com/users/7325296/sagar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 188, "favorite_count": 1, "accepted_answer_id": 43632989, "answer_count": 3, "score": 1, "last_activity_date": 1493206806, "creation_date": 1493205489, "question_id": 43632674, "link": "https://stackoverflow.com/questions/43632674/how-to-use-iferror-goto-next-function", "title": "How to use IfError GoTo Next function", "body": "<p>Please guide me how can I directly resume to <strong>\"s = s + 1\"</strong> if i am getting error in the <strong>sprd = Application.Find(\",\", xword)</strong>. Please guide.</p>\n\n<pre><code>For xx = 2 To 15494\nxword = Cells(s, m)\n\nIf xword &lt;&gt; \"\" Then\nle = Len(xword)\nsprd = Application.Find(\",\", xword)'' If I am getting Error\nold_sprd = sprd\n's = 1\nStar = 1\nDo While sprd &lt;&gt; 0\n\nword = Mid(xword, Star, sprd - 1)\nxword = Mid(xword, sprd + 1, le)\ns = s + 1\nRows(s).Insert\nCells(s, m) = word\nsprd = Application.Find(\",\", xword)\nIf IsError(sprd) Then sprd = 0\nIf sprd = 0 Then\ns = s + 1\nRows(s).Insert\nCells(s, m) = xword\nEnd If\nle = Len(xword)\n\nLoop\nEnd If\n\ns = s + 1 '' My Code supposed to directing divert in This line.\nNext\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1493205706, "post_id": 43632133, "comment_id": 74313295, "body": "Wild guess: copying &amp; moving items messes up <code>filteredItems</code>. Try: (1) in your loop: add the items to a collection, (2) run copy&amp;move on the collection items."}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 1, "creation_date": 1493207260, "post_id": 43632133, "comment_id": 74314427, "body": "Debug the code with F8. When you know what the outer loop does move whatever you want from the outer loop into the inner loop then remove the outer loop."}], "answers": [{"comments": [{"owner": {"reputation": 225, "user_id": 5783057, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/67730c2f730fad68b89c395588c2243e?s=128&d=identicon&r=PG&f=1", "display_name": "wittman", "link": "https://stackoverflow.com/users/5783057/wittman"}, "edited": false, "score": 0, "creation_date": 1493206711, "post_id": 43632740, "comment_id": 74314060, "body": "Hi, it finds the correct number but i must decrease not increase and i have tried i=i-1 but is not helping."}], "tags": [], "owner": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "is_accepted": true, "score": 1, "last_activity_date": 1562102989, "last_edit_date": 1562102989, "creation_date": 1493205669, "answer_id": 43632740, "question_id": 43632133, "link": "https://stackoverflow.com/questions/43632133/copy-found-emails-4-times/43632740#43632740", "title": "Copy found emails 4 times", "body": "<p>After</p>\n\n<pre><code>Else\n    Found = True\n</code></pre>\n\n<p>add the line</p>\n\n<pre><code>Debug.Print filteredItems.Count\n</code></pre>\n\n<p>This is to check the number of items found. This way, you can definitely see if VBA actually finds 40 emails (for whatever reason), or if it just copies it 4 times later on. </p>\n\n<p>Also try Changing</p>\n\n<pre><code>Next i\n</code></pre>\n\n<p>to</p>\n\n<pre><code>i = i + 1\n</code></pre>\n\n<p>Edit:</p>\n\n<p>Cut the</p>\n\n<pre><code>Next itm\n</code></pre>\n\n<p>and move it to the end of this block:</p>\n\n<pre><code>For Each itm In filteredItems\n    If itm.Class = olMail Then\n      Debug.Print itm.Subject\n      Debug.Print itm.ReceivedTime\n    End If\nNext itm 'move it here\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 225, "user_id": 5783057, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/67730c2f730fad68b89c395588c2243e?s=128&d=identicon&r=PG&f=1", "display_name": "wittman", "link": "https://stackoverflow.com/users/5783057/wittman"}, "is_accepted": false, "score": 1, "last_activity_date": 1493209685, "last_edit_date": 1493209685, "creation_date": 1493209280, "answer_id": 43634067, "question_id": 43632133, "link": "https://stackoverflow.com/questions/43632133/copy-found-emails-4-times/43634067#43634067", "title": "Copy found emails 4 times", "body": "<p>For future searchers here is the working code to find all the emails with a given subject in a subfolder - Inbox\\Left Ones - and copy them in another subfolder - Inbox\\TO BE REMOVED - ( note that it will leave out the undelivered notification ) :</p>\n\n<pre><code>        Sub Search_Inbox_Subfolder_Left_Ones()\n\n        Dim objFolder As Outlook.MAPIFolder\n        Dim filteredItems As Outlook.Items\n        Dim itm As Object\n        Dim Found As Boolean\n        Dim strFilter As String\n        Dim subject_to_find As String\n        Dim myDestFolder As Outlook.Folder\n        Dim myCopiedItem As Object\n\n        subject_to_find = \"something to find\"\n\n        Set objFolder = OpenOutlookFolder(\"\\\\Mailbox - ME\\Inbox\\Left Ones\")\n\n        strFilter = \"@SQL=\" &amp; Chr(34) &amp; \"urn:schemas:httpmail:subject\" &amp; Chr(34) &amp; \" like '%\" &amp; subject_to_find &amp; \"%'\"\n\n        Set filteredItems = objFolder.Items.Restrict(strFilter)\n\n        If filteredItems.Count = 0 Then\n\n            Debug.Print \"No emails found\"\n            Found = False\n\n        Else\n            Found = True\n\n     Set myDestFolder = Session.Folders(\"Mailbox - ME\").Folders(\"TO BE REMOVED\")\n\n            For i = filteredItems.Count To 1 Step -1\n\n             If filteredItems(i).Class = olMail Then\n\n                    Set myCopiedItem = filteredItems(i).Copy\n                    myCopiedItem.Move myDestFolder\n\n             End If\n\n            Next i\n\n        End If\n\n        'If the subject isn't found:\n        If Not Found Then\n            'NoResults.Show\n        Else\n           Debug.Print \"Found \" &amp; filteredItems.Count &amp; \" items.\"\n        End If\n\n        Set myOlApp = Nothing\n\n        End Sub\n\nPrivate Function OpenOutlookFolder(strFolderPath As String) As Outlook.MAPIFolder\n    Dim arrFolders As Variant, _\n        varFolder As Variant, _\n        bolBeyondRoot As Boolean\n    On Error Resume Next\n    If strFolderPath = \"\" Then\n        Set OpenOutlookFolder = Nothing\n    Else\n        Do While Left(strFolderPath, 1) = \"\\\"\n            strFolderPath = Right(strFolderPath, Len(strFolderPath) - 1)\n        Loop\n        arrFolders = Split(strFolderPath, \"\\\")\n        For Each varFolder In arrFolders\n            Select Case bolBeyondRoot\n                Case False\n                    Set OpenOutlookFolder = Outlook.Session.Folders(varFolder)\n                    bolBeyondRoot = True\n                Case True\n                    Set OpenOutlookFolder = OpenOutlookFolder.Folders(varFolder)\n            End Select\n            If Err.Number &lt;&gt; 0 Then\n                Set OpenOutlookFolder = Nothing\n                Exit For\n            End If\n        Next\n    End If\n    On Error GoTo 0\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 225, "user_id": 5783057, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/67730c2f730fad68b89c395588c2243e?s=128&d=identicon&r=PG&f=1", "display_name": "wittman", "link": "https://stackoverflow.com/users/5783057/wittman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 43632740, "answer_count": 2, "score": 3, "last_activity_date": 1592693736, "creation_date": 1493204003, "last_edit_date": 1592693736, "question_id": 43632133, "link": "https://stackoverflow.com/questions/43632133/copy-found-emails-4-times", "title": "Copy found emails 4 times", "body": "<p>I have macro that searches for a subject and if found copy the email in another folder. My problem is that it copies the email 4 times instead of only once. If i have 10 emails in the original folder \"Left Ones\" then, after search and copy  i will have 40 emails in the folder \"TO BE REMOVED\" . Any help is welcomed, thank you.</p>\n\n<pre><code>Sub Search_Inbox()\n\nDim myOlApp As New Outlook.Application\nDim objNamespace As Outlook.NameSpace\nDim objFolder As Outlook.MAPIFolder\nDim filteredItems As Outlook.Items\nDim itm As Object\nDim Found As Boolean\nDim strFilter As String\nDim subject_to_find As String\nDim myDestFolder As Outlook.Folder\n\nsubject_to_find = \"something\"\n\nSet objNamespace = myOlApp.GetNamespace(\"MAPI\")\nSet objFolder = OpenOutlookFolder(\"\\\\Mailbox - ME\\Inbox\\Left Ones\")\n\nstrFilter = \"@SQL=\" &amp; Chr(34) &amp; \"urn:schemas:httpmail:subject\" &amp; Chr(34) &amp; \" like '%\" &amp; subject_to_find &amp; \"%'\"\n\nSet filteredItems = objFolder.Items.Restrict(strFilter)\n\nIf filteredItems.Count = 0 Then\n\n    Debug.Print \"No emails found\"\n    Found = False\n\nElse\n    Found = True\n\n    For Each itm In filteredItems\n    If itm.Class = olMail Then\n    Debug.Print itm.Subject\n    Debug.Print itm.ReceivedTime\n    End If\n\n  Set myDestFolder = Session.Folders(\"Mailbox - ME\").Folders(\"TO BE REMOVED\")\n\n    For i = filteredItems.Count To 1 Step -1\n            Dim myCopiedItem As Object\n\n            Set myCopiedItem = filteredItems(i).Copy\n            myCopiedItem.Move myDestFolder\n\n    Next i\n\n    Next itm\n\nEnd If\n\n'If the subject isn't found:\nIf Not Found Then\n    'NoResults.Show\nElse\n   Debug.Print \"Found \" &amp; filteredItems.Count &amp; \" items.\"\nEnd If\n\nSet myOlApp = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1493204156, "post_id": 43631926, "comment_id": 74312200, "body": "What is the name of your <code>Table</code> ?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1493204428, "post_id": 43631926, "comment_id": 74312367, "body": "Can I ask why you would need to know different &quot;last&quot; rows for a table? If the two columns aren&#39;t related, they should really be separate tables."}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1493205751, "post_id": 43631926, "comment_id": 74313322, "body": "You could loop through the rows in column B, from 1 to lastrow of column A, to find the first row that is blank by either evaluating = &quot;&quot; or using an iferror(1/cell)"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1493208752, "post_id": 43631926, "comment_id": 74315513, "body": "Tempted to close as duplicate of <a href=\"http://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba\">this</a> but it didn&#39;t specifically address a Table. The same principles do apply, as @sktneer answers below, though."}], "answers": [{"comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 2, "creation_date": 1493205181, "post_id": 43632365, "comment_id": 74312901, "body": "Listcolumns in the same table will always have the same number of rows."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1493205752, "post_id": 43632365, "comment_id": 74313325, "body": "<code>Tbl.ListColumns(1).Range.Rows.Count</code> represents the row count but not the last row (except for the case that the table starts in row 1 of the sheet)."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 1, "last_activity_date": 1493205627, "last_edit_date": 1493205627, "creation_date": 1493204669, "answer_id": 43632365, "question_id": 43631926, "link": "https://stackoverflow.com/questions/43631926/lastrow-and-excel-table/43632365#43632365", "title": "lastrow and excel table.", "body": "<p>Try the code below to get the last row in Column A and Column B from a Table (<code>ListObject</code>):</p>\n\n<pre><code>Option Explicit\n\nSub LastRowTable()\n\nDim Tbl As ListObject\nDim LastRow2  As Long, LastRow3 As Long\n\n' modify \"Table1\" to your table's Name\nSet Tbl = ThisWorkbook.Worksheets(\"Data\u00d6nskem\u00e5l\").ListObjects(\"Table1\")\n\nLastRow3 = Tbl.ListColumns(1).Range.Rows.Count '&lt;-- last row in Column A in your Table\nLastRow2 = Tbl.ListColumns(2).Range(LastRow3, 1).End(xlUp).Row '&lt;-- last row  with data in Column B in your Table\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "edited": false, "score": 0, "creation_date": 1510696643, "post_id": 43632804, "comment_id": 81543000, "body": "The case of the user filtering the data is fairly easily handled by making sure filters are cleared before doing anything."}], "tags": [], "owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "is_accepted": false, "score": 2, "last_activity_date": 1493206401, "last_edit_date": 1493206401, "creation_date": 1493205840, "answer_id": 43632804, "question_id": 43631926, "link": "https://stackoverflow.com/questions/43631926/lastrow-and-excel-table/43632804#43632804", "title": "lastrow and excel table.", "body": "<p>Finding last rows of tables is a bit fiddly, especially as you often need to cater for the case that a user has filtered the data. A loop with multiple checks might suit you better as you can adjust it to your own needs for the data within the table.</p>\n\n<p>You also don't mention whether you can be certain that the last row is indeed a table.</p>\n\n<p>In view of these points, perhaps the <code>.Find</code> function will suit you as it will find any non-empty cell whether in a table or not and whether hidden or not (though it doesn't cope with a filtered table). (It's not quite true to say \"any non-empty cell\", as a null string, for example, wouldn't be picked up, but maybe these exceptions won't trouble you). Anyhow your code could be:</p>\n\n<pre><code>With Sheet1\n    lastRow1 = .Columns(1).Find(What:=\"*\", _\n                                After:=.Columns(1).Cells(1), _\n                                LookAt:=xlPart, _\n                                LookIn:=xlFormulas, _\n                                SearchOrder:=xlByRows, _\n                                SearchDirection:=xlPrevious, _\n                                MatchCase:=False).Row\n\n    lastRow2 = .Columns(2).Find(What:=\"*\", _\n                                After:=.Columns(2).Cells(1), _\n                                LookAt:=xlPart, _\n                                LookIn:=xlFormulas, _\n                                SearchOrder:=xlByRows, _\n                                SearchDirection:=xlPrevious, _\n                                MatchCase:=False).Row\nEnd With\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1493208887, "post_id": 43633464, "comment_id": 74315609, "body": "<code>ListColumns(_index_).Range</code> is probably better than <code>.Range.Columns(_index_)</code> but both seem to yield the same results."}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1493210482, "post_id": 43633464, "comment_id": 74316916, "body": "I prefer to use it like that. :)"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1493210816, "post_id": 43633464, "comment_id": 74317196, "body": "I do to, unless I think about it lol. .range.columns is easier/familiar."}], "tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": true, "score": 11, "last_activity_date": 1493207639, "creation_date": 1493207639, "answer_id": 43633464, "question_id": 43631926, "link": "https://stackoverflow.com/questions/43631926/lastrow-and-excel-table/43633464#43633464", "title": "lastrow and excel table.", "body": "<p>You will have issue if there is data below the excel table on the sheet. It's always better to refer the table column while finding the last row in an excel table.</p>\n\n<pre><code>Sub FindLastRowInExcelTableColAandB()\nDim lastRow1 As Long, lastRow2 As Long\nDim ws As Worksheet\nSet ws = Sheets(\"Data\u00d6nskem\u00e5l\")\n'Assuming the name of the table is \"Table1\"\nlastRow1 = ws.ListObjects(\"Table1\").Range.Columns(1).Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\nlastRow2 = ws.ListObjects(\"Table1\").Range.Columns(2).Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 122, "user_id": 7898651, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73fffefe567111d182394fc89b829ac6?s=128&d=identicon&r=PG&f=1", "display_name": "shakespeare", "link": "https://stackoverflow.com/users/7898651/shakespeare"}, "is_accepted": false, "score": 0, "last_activity_date": 1493284488, "creation_date": 1493284488, "answer_id": 43653540, "question_id": 43631926, "link": "https://stackoverflow.com/questions/43631926/lastrow-and-excel-table/43653540#43653540", "title": "lastrow and excel table.", "body": "<p>try this</p>\n\n<pre><code> Dim DataRange As Range\n\nSet DataRange = Range(\"A1:M\" &amp; LastRow)\n</code></pre>\n"}], "owner": {"reputation": 181, "user_id": 7494999, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a63802a30fa3b20a36b1843de6adb821?s=128&d=identicon&r=PG&f=1", "display_name": "DL1", "link": "https://stackoverflow.com/users/7494999/dl1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42862, "favorite_count": 3, "accepted_answer_id": 43633464, "answer_count": 4, "score": 4, "last_activity_date": 1493284488, "creation_date": 1493203405, "question_id": 43631926, "link": "https://stackoverflow.com/questions/43631926/lastrow-and-excel-table", "title": "lastrow and excel table.", "body": "<p>I have tried to define a lastrow code that would return the last row value of the last non empty cell in a excel table. (ITS FORMATTED AS A TABLE)</p>\n\n<p>My exceltable have values in COL A from 1 to 1005, COL B from 1 to 414 and in COL C from 414 to 1005. </p>\n\n<p>What i want is to have one lastrow code that returns 414 and one that returns 1005. The problem i get is that because it is in a table. my codes</p>\n\n<pre><code>        lastrow3 = ThisWorkbook.Worksheets(\"Data\u00d6nskem\u00e5l\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n        lastrow2 = ThisWorkbook.Worksheets(\"Data\u00d6nskem\u00e5l\").Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n</code></pre>\n\n<p>Both return 1005. Can i get around this with my table or is it a formating issue of some sort?</p>\n\n<p>Best regards and thanks in advance\n/D</p>\n"}, {"tags": ["excel", "shape", "intersect", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1493204596, "post_id": 43631452, "comment_id": 74312495, "body": "Do you have any data validation dropdowns on your worksheet?"}, {"owner": {"reputation": 113, "user_id": 7924725, "user_type": "registered", "accept_rate": 48, "profile_image": "https://lh6.googleusercontent.com/-3s3dP_MgmEQ/AAAAAAAAAAI/AAAAAAAAABU/VP5EM5DbFr0/photo.jpg?sz=128", "display_name": "Bildircin13", "link": "https://stackoverflow.com/users/7924725/bildircin13"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1493204998, "post_id": 43631452, "comment_id": 74312750, "body": "Actually yes, I have another module to automatically insert a validation to a range for the same sheet. But inside that range of cells, there are no shapes."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1493205135, "post_id": 43631452, "comment_id": 74312853, "body": "See my suggested answer below then."}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 7924725, "user_type": "registered", "accept_rate": 48, "profile_image": "https://lh6.googleusercontent.com/-3s3dP_MgmEQ/AAAAAAAAAAI/AAAAAAAAABU/VP5EM5DbFr0/photo.jpg?sz=128", "display_name": "Bildircin13", "link": "https://stackoverflow.com/users/7924725/bildircin13"}, "edited": false, "score": 0, "creation_date": 1493203995, "post_id": 43631767, "comment_id": 74312105, "body": "Thank you so much for your fast reply. Unfortunately this time I keep getting an error at the &quot;Debug.Pring myShape.TopLeftCell.Address(i, &quot;L&quot;) line. :( It says that &quot;Application-defined or object-defined error for &quot;myShape.TopLeftCell.Row&quot;"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 113, "user_id": 7924725, "user_type": "registered", "accept_rate": 48, "profile_image": "https://lh6.googleusercontent.com/-3s3dP_MgmEQ/AAAAAAAAAAI/AAAAAAAAABU/VP5EM5DbFr0/photo.jpg?sz=128", "display_name": "Bildircin13", "link": "https://stackoverflow.com/users/7924725/bildircin13"}, "edited": false, "score": 0, "creation_date": 1493204595, "post_id": 43631767, "comment_id": 74312493, "body": "Leave the 2 zeroes in the address"}, {"owner": {"reputation": 113, "user_id": 7924725, "user_type": "registered", "accept_rate": 48, "profile_image": "https://lh6.googleusercontent.com/-3s3dP_MgmEQ/AAAAAAAAAAI/AAAAAAAAABU/VP5EM5DbFr0/photo.jpg?sz=128", "display_name": "Bildircin13", "link": "https://stackoverflow.com/users/7924725/bildircin13"}, "edited": false, "score": 0, "creation_date": 1493204751, "post_id": 43631767, "comment_id": 74312584, "body": "With 2 zeros I still get the same error unfortunately. It gives error to this part; {Debug.Print s.TopLeftCell.Address(0, 0)}"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1493203353, "last_edit_date": 1493203353, "creation_date": 1493202992, "answer_id": 43631767, "question_id": 43631452, "link": "https://stackoverflow.com/questions/43631452/delete-row-with-shapes-topleftcell-error/43631767#43631767", "title": "Delete row with shapes.. TopLeftCell Error", "body": "<p>Actually, try something like this:</p>\n\n<pre><code>Sub TestMe()\n\n    Dim myShape As Shape\n\n    For Each myShape In ActiveSheet.Shapes\n        Debug.Print myShape.TopLeftCell.Address(0, 0)\n        Debug.Print myShape.TopLeftCell.row\n    Next myShape\n\nEnd Sub\n</code></pre>\n\n<p>This is a good way to use the topLeftCell. You can even compare the rows explicitly and make your code without the <code>Intersect()</code>. </p>\n\n<p>It would be something like <code>if myShape.TopLeftCell.row &gt;Baslangic</code> or similar.</p>\n\n<p>Your code would <strong>probably</strong> work, if you change it to:</p>\n\n<pre><code>If Not Intersect(s.TopLeftCell, Worksheets(\"Storyboard\").Range(\"L\" &amp; Baslangic &amp; \":\" &amp; \"L\" &amp; Bitis)) Is Nothing Then\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 113, "user_id": 7924725, "user_type": "registered", "accept_rate": 48, "profile_image": "https://lh6.googleusercontent.com/-3s3dP_MgmEQ/AAAAAAAAAAI/AAAAAAAAABU/VP5EM5DbFr0/photo.jpg?sz=128", "display_name": "Bildircin13", "link": "https://stackoverflow.com/users/7924725/bildircin13"}, "edited": false, "score": 0, "creation_date": 1493205314, "post_id": 43632537, "comment_id": 74313002, "body": "Wow, I owe you a big one. This one actually saved me. Thank you so much."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 2, "last_activity_date": 1493205116, "creation_date": 1493205116, "answer_id": 43632537, "question_id": 43631452, "link": "https://stackoverflow.com/questions/43631452/delete-row-with-shapes-topleftcell-error/43632537#43632537", "title": "Delete row with shapes.. TopLeftCell Error", "body": "<p>A data validation (DV) dropdown is a shape, but DV dropdowns don't have a <code>TopLeftCell</code> property. What you can do is loop through the <code>DrawingObjects</code> instead:</p>\n\n<pre><code>For i = Baslangic To Bitis\nDim s As Object\nFor Each s In Worksheets(\"Storyboard\").DrawingObjects\n    If Not Intersect(s.TopLeftCell, Range(\"L\" &amp; Baslangic &amp; \":\" &amp; \"L\" &amp; Bitis)) Is Nothing Then\n        s.Delete\n    End If\nNext s\n\nNext i\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 7924725, "user_type": "registered", "accept_rate": 48, "profile_image": "https://lh6.googleusercontent.com/-3s3dP_MgmEQ/AAAAAAAAAAI/AAAAAAAAABU/VP5EM5DbFr0/photo.jpg?sz=128", "display_name": "Bildircin13", "link": "https://stackoverflow.com/users/7924725/bildircin13"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 752, "favorite_count": 0, "accepted_answer_id": 43632537, "answer_count": 2, "score": 1, "last_activity_date": 1493205116, "creation_date": 1493202191, "last_edit_date": 1531164843, "question_id": 43631452, "link": "https://stackoverflow.com/questions/43631452/delete-row-with-shapes-topleftcell-error", "title": "Delete row with shapes.. TopLeftCell Error", "body": "<p>I am currently making an excel template for other people in company to use.\nI need to delete rows with a single button.\nI believe I've done everything correctly, but I am keep getting an error.</p>\n\n<p>Right below you can see the codes which gives error;</p>\n\n<pre><code>Worksheets(\"Storyboard\").Activate\nWorksheets(\"Storyboard\").Unprotect Password:=\"**$#B'A1313XQ.;**\"\n\nsatirlar = Baslangic &amp; \":\" &amp; Bitis\n\nFor i = Baslangic To Bitis\nDim s As Shape\nFor Each s In Worksheets(\"Storyboard\").Shapes\n    If Not Intersect(s.TopLeftCell, Range(\"L\" &amp; Baslangic &amp; \":\" &amp; \"L\" &amp; Bitis)) Is Nothing Then\n        s.Delete\n    End If\nNext s\n\nNext i\n\nRows(satirlar).Delete Shift:=xlUp\n</code></pre>\n\n<p>I am keep getting an error on the \"s.topleftcell\" part. It says that \"application-defined or object defined error\".</p>\n\n<p>On this code; \"Baslangic\" and \"Bitis\" are predefined with a form.</p>\n\n<p>I can use any possible advise here..</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1493201827, "creation_date": 1493201827, "answer_id": 43631304, "question_id": 43631079, "link": "https://stackoverflow.com/questions/43631079/vba-apply-to-all-except-one-specific/43631304#43631304", "title": "(VBA) apply to all, except one specific", "body": "<p>Your problem can be translated to something like <em>How to loop over all sheets and ignore one of them?</em></p>\n\n<p>This is a good way to do it:</p>\n\n<pre><code>Option Explicit\nOption Private Module\n\nPublic Sub TestMe()\n\n    Dim wks As Worksheet\n\n    For Each wks In ThisWorkbook.Worksheets\n        If wks.name = \"main\" Then\n            Debug.Print \"Do nothing here, this is the active sheet's name\"\n        Else\n            Debug.Print wks.name\n        End If\n\n    Next wks\n\nEnd Sub\n</code></pre>\n\n<p>Pretty sure, that you should be able to fit it in your code. </p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 6866327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f46083d7a2fb70c228e2105081dd7e9?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/6866327/sebastian"}, "edited": false, "score": 0, "creation_date": 1493293813, "post_id": 43632601, "comment_id": 74361043, "body": "Good works like a charm :D  The button can be protected with password to captcha to avoid an accidental use?  Thanks!"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 13, "user_id": 6866327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f46083d7a2fb70c228e2105081dd7e9?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/6866327/sebastian"}, "edited": false, "score": 0, "creation_date": 1493293854, "post_id": 43632601, "comment_id": 74361090, "body": "@Sebastian  you&#39;re welcome, thanks for accepting as answer"}, {"owner": {"reputation": 13, "user_id": 6866327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f46083d7a2fb70c228e2105081dd7e9?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/6866327/sebastian"}, "edited": false, "score": 0, "creation_date": 1493293965, "post_id": 43632601, "comment_id": 74361174, "body": "You can password protect the button for accidental or false execution?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 13, "user_id": 6866327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f46083d7a2fb70c228e2105081dd7e9?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/6866327/sebastian"}, "edited": false, "score": 0, "creation_date": 1493294022, "post_id": 43632601, "comment_id": 74361224, "body": "@Sebastian  sounds like a great new <b>SO</b> post"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 0, "last_activity_date": 1493205285, "creation_date": 1493205285, "answer_id": 43632601, "question_id": 43631079, "link": "https://stackoverflow.com/questions/43631079/vba-apply-to-all-except-one-specific/43632601#43632601", "title": "(VBA) apply to all, except one specific", "body": "<p>Try the code below :</p>\n\n<pre><code>Option Explicit\n\nSub Bot\u00f3n1_Haga_clic_en()\n\nDim wsName As String\nDim ws As Worksheet\n\nwsName = ActiveSheet.Name\n\nFor Each ws In ThisWorkbook.Worksheets\n    If Not ws.Name Like wsName Then '&lt;-- is worksheet's name doesn't equal the ActiveSheet's\n        ApplyCellColors ws ' &lt;-- call you Sub, with the worksheet object\n    End If\nNext ws\n\nEnd Sub\n\n'=======================================================================    \n'apply cells colors from single-cell formula dependencies/links\n\nPrivate Sub ApplyCellColors(ws As Worksheet)\n\n    Dim Cel       As Range\n    Dim RefCel  As Range\n\n    On Error Resume Next\n\n    For Each Cel In ws.UsedRange\n        If Cel.HasFormula Then\n            Set RefCel = Evaluate(Mid(Cel.Formula, 2))\n            Cel.Interior.Color = RefCel.Interior.Color\n        End If\n    Next Cel\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6866327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f46083d7a2fb70c228e2105081dd7e9?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/6866327/sebastian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 0, "accepted_answer_id": 43632601, "answer_count": 2, "score": 1, "last_activity_date": 1493205285, "creation_date": 1493201217, "last_edit_date": 1531161705, "question_id": 43631079, "link": "https://stackoverflow.com/questions/43631079/vba-apply-to-all-except-one-specific", "title": "(VBA) apply to all, except one specific", "body": "<p>Hi everyone i made a button on excel using VBA modules,The code works on the active sheet but what im looking for is to be applied to more sheets, not just the active sheet where the button is placed.</p>\n\n<pre><code>Sub Bot\u00f3n1_Haga_clic_en()\n    Call Worksheet_Calculate\nEnd Sub\n\n\n'apply cells colors from single-cell formula dependencies/links\nPrivate Sub Worksheet_Calculate()\n    Dim Cel       As Range\n    Dim RefCel  As Range\n\n    On Error Resume Next\n\n    For Each Cel In ActiveSheet.UsedRange\n        If Cel.HasFormula Then\n            Set RefCel = Evaluate(Mid(Cel.Formula, 2))\n            Cel.Interior.Color = RefCel.Interior.Color\n        End If\n    Next Cel\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["c++", "vba", "runtime-error", "dllimport"], "comments": [{"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1493200482, "post_id": 43630648, "comment_id": 74309688, "body": "You need to install the VS 2017 redistributable, or use static linking to the runtime."}, {"owner": {"reputation": 49, "user_id": 5658379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ed600149f71bd1691abb54ee3ef3415?s=128&d=identicon&r=PG&f=1", "display_name": "M.Bolzoni", "link": "https://stackoverflow.com/users/5658379/m-bolzoni"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1493200904, "post_id": 43630648, "comment_id": 74309997, "body": "What do you mean with &quot;linking to the run time&quot;?"}, {"owner": {"reputation": 49, "user_id": 5658379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ed600149f71bd1691abb54ee3ef3415?s=128&d=identicon&r=PG&f=1", "display_name": "M.Bolzoni", "link": "https://stackoverflow.com/users/5658379/m-bolzoni"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1493200937, "post_id": 43630648, "comment_id": 74310022, "body": "*Static sorry for the dummy question"}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1493201081, "post_id": 43630648, "comment_id": 74310108, "body": "Er, your DLL needs a runtime. Try some research on that topic."}, {"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 0, "creation_date": 1496833795, "post_id": 43630648, "comment_id": 75820645, "body": "Check my answer on <a href=\"https://stackoverflow.com/questions/35116437/errors-when-linking-to-protobuf-3-on-msvc-2013\">&#91;SO&#93;: Errors when linking to protobuf 3 on MSVC 2013</a> (the paragraph related to <i>Code Generation -&gt; Runtime Library</i>)."}], "owner": {"reputation": 49, "user_id": 5658379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ed600149f71bd1691abb54ee3ef3415?s=128&d=identicon&r=PG&f=1", "display_name": "M.Bolzoni", "link": "https://stackoverflow.com/users/5658379/m-bolzoni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 689, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1493200063, "creation_date": 1493200063, "question_id": 43630648, "link": "https://stackoverflow.com/questions/43630648/run-time-53-error-while-loading-c-dll-in-excel-vba", "title": "Run-Time 53 Error while loading C++ DLL in excel vba", "body": "<p>I compiled with VS2017 on my PC (windows 10) a c++ DLL, that contains some routines. I loaded this file on Excel 2013 with the command </p>\n\n<pre><code>Private Declare Function Myfunc Lib \"[PATH]\\FILE.dll\" (ByVal x As Double) As \nDouble\n</code></pre>\n\n<p>I do not use \"alias\" because I created a .DEF file in project folder. <strong>With these settings and on my PC, the loading works and I can use the DLL.</strong>\nI also tried to move the .dll file in some different directories on my PC, and in any case it works fine.</p>\n\n<p><strong>HOWEVER:</strong></p>\n\n<p><strong>Problem 1:</strong></p>\n\n<p>it arises when I copy this DLL to another PC, which is an old <strong>Windows XP</strong> with Service Pack 3. Of course I already paid attention to compile in VS2017 C++ with \"Platform v141_xp\", SDK version 7.0 and predefined version of /clr. </p>\n\n<p>The old PC contains Windows XP SP3, SDk 7.1, .NET Framework 4, C++ redistributable 2010, Office 2007 (update SP3).</p>\n\n<p>When I try to import this DLL in XP with Office 2007, it returns the error</p>\n\n<p><em>Error Run Time 53\nIt is not possible to find the file \"[PATH]\\File.dll\"</em> </p>\n\n<p><strong>Problem 2:</strong></p>\n\n<p>I try to make the same operation with another PC again. This time this PC is recent with Windows 10, Office 2013, C++ Red 2010, but <strong>not</strong> SDK.</p>\n\n<p>The problem remains.</p>\n\n<p><em>Error Run Time '53' etc...</em> </p>\n\n<p>What am I missing? I would like to use this DLL in any PC... is it possible? </p>\n"}, {"tags": ["vba", "sql-server-2008"], "comments": [{"owner": {"reputation": 5796, "user_id": 328730, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/6f9395f6a8e5bf4970661b80194105b0?s=128&d=identicon&r=PG", "display_name": "Dr Rob Lang", "link": "https://stackoverflow.com/users/328730/dr-rob-lang"}, "edited": false, "score": 0, "creation_date": 1493199952, "post_id": 43630449, "comment_id": 74309302, "body": "Welcome to Stack Overflow. What error do you get? Please update your question."}, {"owner": {"reputation": 29, "user_id": 7924462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91614d375c1b792af74be06a582d6b24?s=128&d=identicon&r=PG&f=1", "display_name": "nikhil pola", "link": "https://stackoverflow.com/users/7924462/nikhil-pola"}, "reply_to_user": {"reputation": 5796, "user_id": 328730, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/6f9395f6a8e5bf4970661b80194105b0?s=128&d=identicon&r=PG", "display_name": "Dr Rob Lang", "link": "https://stackoverflow.com/users/328730/dr-rob-lang"}, "edited": false, "score": 0, "creation_date": 1493200253, "post_id": 43630449, "comment_id": 74309520, "body": "Error as : Script out of range at &quot;Workbooks(&quot;test-vba.xls&quot;).Activate&quot; line"}, {"owner": {"reputation": 5796, "user_id": 328730, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/6f9395f6a8e5bf4970661b80194105b0?s=128&d=identicon&r=PG", "display_name": "Dr Rob Lang", "link": "https://stackoverflow.com/users/328730/dr-rob-lang"}, "edited": false, "score": 0, "creation_date": 1493200304, "post_id": 43630449, "comment_id": 74309560, "body": "Please update your question, not post a comment. Thank you."}, {"owner": {"reputation": 5796, "user_id": 328730, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/6f9395f6a8e5bf4970661b80194105b0?s=128&d=identicon&r=PG", "display_name": "Dr Rob Lang", "link": "https://stackoverflow.com/users/328730/dr-rob-lang"}, "edited": false, "score": 0, "creation_date": 1493200363, "post_id": 43630449, "comment_id": 74309605, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/18193153/vba-run-time-error-9-subscript-out-of-range-trying-to-activate-another-workb\">VBA Run-time error &#39;9&#39;: Subscript out of range; trying to activate another workbook</a>"}], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 1, "last_activity_date": 1500639431, "creation_date": 1500639431, "answer_id": 45237479, "question_id": 43630449, "link": "https://stackoverflow.com/questions/43630449/i-need-to-import-data-from-excel-to-sql-server-using-vba/45237479#45237479", "title": "I need to import data from Excel to SQL Server using VBA", "body": "<p>What does 'doesn't work' mean?  What kind of error do you get?  Maybe one of the solutions below will help . . . </p>\n\n<pre><code>Sub UpdateTable()\n\n    Dim cnn As Object\n    Dim wbkOpen As Workbook\n    Dim objfl As Variant\n    Dim rngName As Range\n    Workbooks.Open \"C:\\your_path_here\\Excel_to_SQL_Server.xls\"\n    Set wbkOpen = ActiveWorkbook\n    Sheets(\"Sheet1\").Select\n    Set rngName = Range(Range(\"A1\"), Range(\"A1\").End(xlToLeft).End(xlDown))\n    rngName.Name = \"TempRange\"\n    strFileName = wbkOpen.FullName\n    Set cnn = CreateObject(\"ADODB.Connection\")\n    cnn.Open \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp; strFileName &amp; \";Extended Properties=\"\"Excel 12.0 Xml;HDR=Yes\"\";\"\n    nSQL = \"INSERT INTO [odbc;Driver={SQL Server};Server=Server_Name;Database=[Your_Database].[dbo].[TBL]]\"\n    nJOIN = \" SELECT * from [TempRange]\"\n    cnn.Execute nSQL &amp; nJOIN\n    MsgBox \"Uploaded Successfully\"\n    wbkOpen.Close\n    Set wbkOpen = Nothing\n\nEnd Sub\n\nSub InsertInto()\n\n'Declare some variables\nDim cnn As adodb.Connection\nDim cmd As adodb.Command\nDim strSQL As String\n\n'Create a new Connection object\nSet cnn = New adodb.Connection\n\n'Set the connection string\ncnn.ConnectionString = \"Server_Name;Database=Your_Database;Trusted_Connection=True;\"\n\n'Create a new Command object\nSet cmd = New adodb.Command\n\n'Open the connection\ncnn.Open\n'Associate the command with the connection\ncmd.ActiveConnection = cnn\n\n'Tell the Command we are giving it a bit of SQL to run, not a stored procedure\ncmd.CommandType = adCmdText\n\n'Create the SQL\nstrSQL = \"UPDATE TBL SET JOIN_DT = 2013-01-13 WHERE EMPID = 2\"\n\n'Pass the SQL to the Command object\ncmd.CommandText = strSQL\n\n'Open the Connection to the database\ncnn.Open\n\n'Execute the bit of SQL to update the database\ncmd.Execute\n\n'Close the connection again\ncnn.Close\n\n'Remove the objects\nSet cmd = Nothing\nSet cnn = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>As an alternative, consider one of the links below.</p>\n\n<p><a href=\"http://www.ozgrid.com/forum/showthread.php?t=169953\" rel=\"nofollow noreferrer\">http://www.ozgrid.com/forum/showthread.php?t=169953</a></p>\n\n<p><a href=\"http://stackoverflow.com/questions/2567150/excel-vba-sql-data\">http://stackoverflow.com/questions/2567150/excel-vba-sql-data</a></p>\n\n<p><a href=\"http://msgroups.net/microsoft.public.excel.programming/vba-to-export-large-tables/61433\" rel=\"nofollow noreferrer\">http://msgroups.net/microsoft.public.excel.programming/vba-to-export-large-tables/61433</a></p>\n\n<p><a href=\"http://www.codeproject.com/Questions/475817/Howplustoplusupdateplussqlplusserverplusdataplusfr\" rel=\"nofollow noreferrer\">http://www.codeproject.com/Questions/475817/Howplustoplusupdateplussqlplusserverplusdataplusfr</a></p>\n\n<p><a href=\"http://www.excelguru.ca/forums/showthread.php?992-SQL-Select-Insert-Update-queries-from-Excel-vba\" rel=\"nofollow noreferrer\">http://www.excelguru.ca/forums/showthread.php?992-SQL-Select-Insert-Update-queries-from-Excel-vba</a></p>\n\n<p><a href=\"http://www.mrexcel.com/forum/excel-questions/617303-updating-records-access-table-using-excel-visual-basic-applications.html\" rel=\"nofollow noreferrer\">http://www.mrexcel.com/forum/excel-questions/617303-updating-records-access-table-using-excel-visual-basic-applications.html</a></p>\n\n<p><a href=\"http://www.excelforum.com/excel-programming-vba-macros/501147-how-to-use-vba-to-update-a-sql-server-table-from-a-spreadsheet.html\" rel=\"nofollow noreferrer\">http://www.excelforum.com/excel-programming-vba-macros/501147-how-to-use-vba-to-update-a-sql-server-table-from-a-spreadsheet.html</a></p>\n"}], "owner": {"reputation": 29, "user_id": 7924462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91614d375c1b792af74be06a582d6b24?s=128&d=identicon&r=PG&f=1", "display_name": "nikhil pola", "link": "https://stackoverflow.com/users/7924462/nikhil-pola"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11831, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1500639431, "creation_date": 1493199595, "last_edit_date": 1493205780, "question_id": 43630449, "link": "https://stackoverflow.com/questions/43630449/i-need-to-import-data-from-excel-to-sql-server-using-vba", "title": "I need to import data from Excel to SQL Server using VBA", "body": "<p>I am trying to import data from another Excel workbook on my PC into SQL Server.  I tried with this code, but it doesn't work:</p>\n\n<pre><code>Sub insertion()\n    Dim conn As ADODB.Connection\n    Dim rs As ADODB.Recordset\n    Dim sConnString As String\n    Dim rsstring As String\n    Dim m, nrows As Integer\n    Dim loRH As Excel.ListObject\n\n    Workbooks(\"test-vba.xls\").Activate\n\n    *connection*\n    Set conn = New ADODB.Connection\n    Set rs = New ADODB.Recordset\n\n    conn.Open sConnString\n    MsgBox \"Start\"\n\n    Set loRH = wkb.ListObjects(1)\n    loRH.ListColumns(1).DataBodyRange.Select\n\n    MsgBox \"Start\"\n    nrows = WorksheetFunction.CountA(Selection)\n\n    For m = 0 To nrows - 1\n        rsstring = \"insert into MPN_Materials values(MPN Material, Material \ndescription, Int. material no.,  MPN,  Manufact.,  Matl Group, Material \nDescription, Last Chg., BUn) values\" _\n        &amp; \"(\"loRH.DataBodyRange.Cells(m + 1, 1) &amp; \"', \n        &amp; loRH.DataBodyRange.Cells(m + 1, 2) &amp; \", \" _\n        &amp; loRH.DataBodyRange.Cells(m + 1, 3) &amp; \", \" _\n        &amp; loRH.DataBodyRange.Cells(m + 1, 4) &amp; \", \" _\n        &amp; loRH.DataBodyRange.Cells(m + 1, 5) &amp; \", \" _\n        &amp; loRH.DataBodyRange.Cells(m + 1, 6) &amp; \", \" _\n        &amp; loRH.DataBodyRange.Cells(m + 1, 7) &amp; \", \" _\n        &amp; loRH.DataBodyRange.Cells(m + 1, 8) &amp; \", \" _\n        &amp; loRH.DataBodyRange.Cells(m + 1, 9) &amp; \"); \"\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1493199541, "post_id": 43630345, "comment_id": 74309016, "body": "Any clue <i>where</i> there error is occurring?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1493199549, "post_id": 43630345, "comment_id": 74309028, "body": "You should have a look into the <a href=\"https://msdn.microsoft.com/en-us/library/aa265347(v=vs.60).aspx\" rel=\"nofollow noreferrer\">OpenTextFile Method Reference</a> you are using it the wrong way."}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1493199566, "post_id": 43630345, "comment_id": 74309037, "body": "You pass a string (stream2) as the 2nd argument to OpenTextFile() - this is not valid."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7581677"}, "reply_to_user": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1493199718, "post_id": 43630345, "comment_id": 74309153, "body": "@Alex K So what is the correct datatype of the argument?"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1493199874, "post_id": 43630345, "comment_id": 74309256, "body": "The second parameter should be either <code>ForAppending</code>, <code>ForReading</code>, or <code>ForWriting</code>"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1493200154, "post_id": 43630345, "comment_id": 74309445, "body": "Your question suggests you want to read from the Impeller_Hub.dat file, yet your code appears to be reading every cell from the&#39; ActiveSheet&#39; and writing a line for each one. What exactly are you trying to do here?"}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 0, "last_activity_date": 1493200704, "last_edit_date": 1493200704, "creation_date": 1493200140, "answer_id": 43630679, "question_id": 43630345, "link": "https://stackoverflow.com/questions/43630345/what-is-wrong-with-the-following-vba-code-for-excel-macros/43630679#43630679", "title": "What is wrong with the following VBA code for Excel macros?", "body": "<p>Something like this works for me (using as much from your code as possible):</p>\n\n<pre><code>Option Explicit\nOption Private Module\n\nPrivate Sub fn_write_to_text_Click()\n\n    Dim FilePath        As String\n    Dim CellData        As String\n    Dim LastCol         As Long\n    Dim LastRow         As Long\n\n    Dim fso             As Object\n    Dim stream          As Object\n    Dim stream2         As String\n\n    Dim i               As Long\n    Dim j               As Long\n\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n\n    LastCol = ActiveSheet.UsedRange.Columns.Count\n    LastRow = ActiveSheet.UsedRange.Rows.Count\n    stream2 = \"C:\\YOURPATH\\Desktop\\aaa.txt\"\n\n    'Uncomment the next line if you do not have the file\n    'Set stream = fso.CreateTextFile(stream2, True)\n    Set stream = fso.OpenTextFile(stream2, 8) '8 is ForAppending\n\n    CellData = \"\"\n\n    For i = 1 To LastRow\n        For j = 1 To LastCol\n            CellData = Trim(ActiveCell(i, j).value)\n            stream.WriteLine \"The Value at location (\" &amp; i &amp; \",\" &amp; j &amp; \")\" &amp; CellData\n        Next j\n    Next i\n\n    stream.Close\n    MsgBox (\"Job Done\")\n\nEnd Sub\n</code></pre>\n\n<p>The code below would work if you have the file <code>aaa.txt</code> on your desktop. If you do not have it write:</p>\n\n<p><code>Set stream = fso.CreateTextFile(stream2, True)</code> to create it and delete the line <code>Set stream = fso.OpenTextFile(stream2,8)</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 99, "user_id": 2991600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c0092bcc4897538f265d62965f670d8?s=128&d=identicon&r=PG&f=1", "display_name": "Kawi42", "link": "https://stackoverflow.com/users/2991600/kawi42"}, "is_accepted": false, "score": 0, "last_activity_date": 1493200382, "creation_date": 1493200382, "answer_id": 43630764, "question_id": 43630345, "link": "https://stackoverflow.com/questions/43630345/what-is-wrong-with-the-following-vba-code-for-excel-macros/43630764#43630764", "title": "What is wrong with the following VBA code for Excel macros?", "body": "<p>If you want to read from file <code>Impeller_hub.dat</code> and to write to file <code>copy_hub.dat</code>, then you need two <code>TextStream</code> variables, and two separate calls of <code>fso.OpenTextFile</code>: one with second argument <code>ForReading</code>, the other with second argument <code>ForWriting</code>.</p>\n\n<p>Or, if you want to add data to the end of file <code>Impeller_hub.dat</code>, then - as CLR already wrote - the second argument for <code>fso.OpenTextFile</code> should be <code>ForAppending</code>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7581677"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 43630679, "answer_count": 2, "score": 1, "last_activity_date": 1493200704, "creation_date": 1493199308, "last_edit_date": 1531161705, "question_id": 43630345, "link": "https://stackoverflow.com/questions/43630345/what-is-wrong-with-the-following-vba-code-for-excel-macros", "title": "What is wrong with the following VBA code for Excel macros?", "body": "<p>The following code is VBA code for an Excel macros. The objective is to read input from the file <code>Impeller_hub.dat</code> and to write it into <code>copy_hub.dat</code>. The error message I received stated that there's a type mismatch, Run-time error '13'. Where is the error and how can it be rectified?</p>\n\n<pre><code>Private Sub fn_write_to_text_Click()\n   Dim FilePath As String\n   Dim CellData As String\n   Dim LastCol As Long\n   Dim LastRow As Long\n\n   Dim fso As FileSystemObject\n   Set fso = New FileSystemObject\n   Dim stream As TextStream\n   Dim stream2 As String\n\n   LastCol = ActiveSheet.UsedRange.Columns.Count\n   LastRow = ActiveSheet.UsedRange.Rows.Count\n    stream2 = \"C:\\Users\\devanandd\\Desktop\\copy_hub.dat\"\n\n   Set stream = fso.OpenTextFile(\"C:\\Users\\devanandd\\Desktop\\Files\\NUMECA\\Impeller_Hub.dat\", stream2, True)\n\n   CellData = \"\"\n\n   For i = 1 To LastRow\n      For j = 1 To LastCol\n         CellData = Trim(ActiveCell(i, j).Value)\n         stream.WriteLine \"The Value at location (\" &amp; i &amp; \",\" &amp; j &amp; \")\" &amp; CellData\n      Next j\n   Next i\n\n   stream.Close\n   MsgBox (\"Job Done\")\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 2, "creation_date": 1493196915, "post_id": 43629254, "comment_id": 74307157, "body": "Just change <code>LookAt:=xlWhole</code> to <code>LookAt:=xlPart</code>..."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1493196932, "post_id": 43629254, "comment_id": 74307176, "body": "Change <code>xlWhole</code> to <code>xlPart</code>.  (Which is easily googled by searching, for instance <code>excel vba find</code> and looking at the first result, and more easily found by using the macro recorder.)"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1493196971, "post_id": 43629254, "comment_id": 74307204, "body": "@YowE3K you&#39;re getting sloppy, Wolfie beat you to it ;)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1493197011, "post_id": 43629254, "comment_id": 74307234, "body": "@ShaiRado - it took me a few seconds to ensure that that google search term would come up with the MSDN entry as the first result"}, {"owner": {"reputation": 23, "user_id": 7924140, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-yQpKP89MEE0/AAAAAAAAAAI/AAAAAAAAACg/REF4M3uO0y0/photo.jpg?sz=128", "display_name": "Ruedi Spring", "link": "https://stackoverflow.com/users/7924140/ruedi-spring"}, "edited": false, "score": 0, "creation_date": 1493197070, "post_id": 43629254, "comment_id": 74307280, "body": "You guys are genious :-) Thanks a lot !"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1493197102, "post_id": 43629254, "comment_id": 74307304, "body": "@RuediSpring - next time, please do some simple research before posting"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1493197268, "post_id": 43629254, "comment_id": 74307425, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/32097383/find-text-which-is-part-of-cell-value-in-find-function-vba-excel\">Find text which is part of cell value in .Find function VBA excel</a>"}], "answers": [{"tags": [], "owner": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1493196987, "creation_date": 1493196987, "answer_id": 43629440, "question_id": 43629254, "link": "https://stackoverflow.com/questions/43629254/find-word-in-part-of-cell-text-return-column-number-excel-vba/43629440#43629440", "title": "Find word in part of cell text, return column number: Excel VBA", "body": "<p>The section</p>\n\n<pre><code>LookAt:=xlWhole\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>LookAt:=xlPart\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "is_accepted": true, "score": 2, "last_activity_date": 1493198263, "last_edit_date": 1493198263, "creation_date": 1493197157, "answer_id": 43629515, "question_id": 43629254, "link": "https://stackoverflow.com/questions/43629254/find-word-in-part-of-cell-text-return-column-number-excel-vba/43629515#43629515", "title": "Find word in part of cell text, return column number: Excel VBA", "body": "<p>Just change <code>LookAt:=xlWhole</code> to <code>LookAt:=xlPart</code></p>\n\n<p>Docs: <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839746.aspx\" rel=\"nofollow noreferrer\">Range.Find Method (Excel)</a></p>\n\n<hr>\n\n<p>You can also use an ampersand (<code>&amp;</code>) to tidy up the returned result, it concatenates strings:</p>\n\n<pre><code>\"Col: \" &amp; rFind.Column &amp; \", Row: \" &amp; rFind.Row\n' For example, gives the string \"Col: 1, Row: 1\" if found in A1\n</code></pre>\n\n<p>You say you want to search in \"every column in a specific row\" but you're looking in \"the first 100 rows in a specific column\"?! Not sure whether that's a typo or if your code is wrong. Either way, you could use the <code>Rows</code> or <code>Columns</code> objects. These should be used with <em>fully qualifying</em> your range, i.e. saying where it is.</p>\n\n<pre><code>ThisWorkbook.Sheets(\"Sheet1\").Rows(1)      ' Range of entire first row\nThisWorkbook.Sheets(\"Sheet1\").Columns(1)   ' Range of entire first column\nThisWorkbook.Sheets(\"Sheet1\").Columns(\"A\") ' Equivalent, range of entire first column\n</code></pre>\n\n<p>Rewrite:</p>\n\n<pre><code>Dim rFind As Range     \nWith ThisWorkbook.Sheets(\"Sheet1\").Columns(\"D\")\n    Set rFind = .Find(What:=TextBox13.Value, LookAt:=xlPart, MatchCase:=False, SearchFormat:=False)\n    If Not rFind Is Nothing Then\n        MsgBox \"Col: \" &amp; rFind.Column &amp; \", Row: \" &amp; rFind.Row\n    End If\nEnd With\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 0, "creation_date": 1493197685, "post_id": 43629602, "comment_id": 74307702, "body": "This is not a good idea, as it will crash if the text isn&#39;t found, because the find will return <code>Nothing</code> and you are requesting the <code>Row</code> of it. This is why the OP (correctly) used the <code>If Not rFind Is Nothing</code> logic."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1493197697, "post_id": 43629602, "comment_id": 74307713, "body": "Anyway, searching twice takes twice the time. Bad idea too!"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1493197782, "post_id": 43629602, "comment_id": 74307774, "body": "And it will only use <code>xlPart</code> if that is what the OP had used on their previous <code>Find</code>.  (It is always best to specify whether the search is on <code>xlPart</code> or <code>xlWhole</code> because Excel remembers the last setting.)"}, {"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 1, "creation_date": 1493198637, "post_id": 43629602, "comment_id": 74308373, "body": "Your edit is an improvement but not great. You&#39;re now potentially still causing an error, but ignoring it. This is worse than handling it properly like the OP has, as already mentioned. Also the &quot;simplest code to do it&quot; now looks more complicated than the original code, which only required 5 characters changing..."}], "tags": [], "owner": {"reputation": 294, "user_id": 5518412, "user_type": "registered", "profile_image": "https://graph.facebook.com/900413473399114/picture?type=large", "display_name": "Praveen Behera", "link": "https://stackoverflow.com/users/5518412/praveen-behera"}, "is_accepted": false, "score": -2, "last_activity_date": 1493198414, "last_edit_date": 1493198414, "creation_date": 1493197372, "answer_id": 43629602, "question_id": 43629254, "link": "https://stackoverflow.com/questions/43629254/find-word-in-part-of-cell-text-return-column-number-excel-vba/43629602#43629602", "title": "Find word in part of cell text, return column number: Excel VBA", "body": "<p>Code updated: For all comments, \n1. xlPart added\n2. Only one search performed,</p>\n\n<p>Now if you could uprate me.</p>\n\n<p>Simplest code to do it -\nAs per your range selected - Range(\"D1:D100\"),  you are only finding row number where the value exists. In order to find the column number as well, expand your range.</p>\n\n<p>This is it -</p>\n\n<pre><code>Sub find_code()\nDim add As String\n\nOn Error Resume Next\nadd = Range(\"D1:D100\").Find(TextBox1.Text, Lookat:=xlPart, MatchCase:=False).AddressLocal\n\nIf Err.Number &lt;&gt; 0 Then\nMsgBox \"Empty Search result\", vbInformation\nExit Sub\nEnd If\n\nMsgBox Range(add).Row\nMsgBox Range(add).Column\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 0, "creation_date": 1493287794, "post_id": 43629744, "comment_id": 74356743, "body": "Couple of notes Jeremy, I don&#39;t think the OP is asking to search for each word in the string, he just said he wanted <code>.Find</code> to work on any word <i>within</i> the string. Also as an aside, you don&#39;t need <code>Set rFind = Nothing</code> since <code>.Find</code> returns <code>Nothing</code> if the string isn&#39;t found anyway :)"}, {"owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "reply_to_user": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 0, "creation_date": 1493291106, "post_id": 43629744, "comment_id": 74359022, "body": "@Wolfie you&#39;re right - I misunderstood what the OP was looking for (hence why i thought the need to set rFind to nothing per iteration)"}, {"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 0, "creation_date": 1493291677, "post_id": 43629744, "comment_id": 74359447, "body": "Even if you&#39;re looping though, setting <code>rFind</code> to <code>Nothing</code> has no effect on your code, since it is changed on the next loop anyway. It doesn&#39;t matter or change the way the code works, just thought I&#39;d try and help.."}, {"owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "reply_to_user": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 0, "creation_date": 1493292019, "post_id": 43629744, "comment_id": 74359730, "body": "@Wolfie but it you didn&#39;t clear the rFind value, the <code>If Not rFind Is Nothing Then...</code> argument wouldn&#39;t be correct as it&#39;d pick up the value form the previous iteration"}, {"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 0, "creation_date": 1493292586, "post_id": 43629744, "comment_id": 74360140, "body": "That&#39;s what I&#39;m trying to point out, it wouldn&#39;t! When you call <code>Set rFind = .Find(...)</code>, you have <code>rFind = Nothing</code> or <code>rFind = some range</code>. The <code>.Find</code> function will <i>always</i> change the value of <code>rFind</code> anyway. Maybe I&#39;m not clear, see the docs (<a href=\"https://msdn.microsoft.com/en-us/library/office/ff839746.aspx\" rel=\"nofollow noreferrer\">here</a>) - &quot;This method returns Nothing if no match is found&quot;"}], "tags": [], "owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "is_accepted": false, "score": -1, "last_activity_date": 1493197740, "creation_date": 1493197740, "answer_id": 43629744, "question_id": 43629254, "link": "https://stackoverflow.com/questions/43629254/find-word-in-part-of-cell-text-return-column-number-excel-vba/43629744#43629744", "title": "Find word in part of cell text, return column number: Excel VBA", "body": "<p>Looks as though you want to check for each word - this will do that:</p>\n\n<pre><code>Sub Check()\nDim vWords As Variant\nDim sCheck As String\nDim rFind As Range\nDim i As Long\n\nsCheck = \"Lorem ipsum, dolor sitamet\" ' TextBox13.Value\nsCheck = Replace(sCheck, \",\", \"\")\n\nvWords = Split(sCheck, \" \")\n\nFor i = 0 To UBound(vWords)\n    With Range(\"D1:D100\")\n        Set rFind = .Find(What:=Trim(vWords(i)), LookAt:=xlPart, MatchCase:=False, SearchFormat:=False)\n        If Not rFind Is Nothing Then\n            MsgBox rFind.Column\n            MsgBox rFind.Row\n        End If\n        Set rFind = Nothing\n    End With\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 7924140, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-yQpKP89MEE0/AAAAAAAAAAI/AAAAAAAAACg/REF4M3uO0y0/photo.jpg?sz=128", "display_name": "Ruedi Spring", "link": "https://stackoverflow.com/users/7924140/ruedi-spring"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5716, "favorite_count": 1, "accepted_answer_id": 43629515, "answer_count": 4, "score": 1, "last_activity_date": 1493198414, "creation_date": 1493196560, "last_edit_date": 1493197543, "question_id": 43629254, "link": "https://stackoverflow.com/questions/43629254/find-word-in-part-of-cell-text-return-column-number-excel-vba", "title": "Find word in part of cell text, return column number: Excel VBA", "body": "<p>My goal is to implement a search function in a user form in Excel.</p>\n\n<p>It should be able to take a word entered in a <code>TextBox</code> and go through every column in a specific row and search for the word. Then it should return the column where it was first discovered. </p>\n\n<p>With my code below, it will look only at exact matches of the cell content. But if the cell value is for example: \"Lorem ipsum, dolor sitamet\" - I want to be able to search for \"dolor\". </p>\n\n<p>Here is my code:</p>\n\n<pre><code>Dim rFind As Range     \nWith Range(\"D1:D100\")\n    Set rFind = .Find(What:=TextBox13.Value, LookAt:=xlWhole, MatchCase:=False, SearchFormat:=False)\n    If Not rFind Is Nothing Then\n        MsgBox rFind.Column\n        MsgBox rFind.Row\n    End If\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "outlook-2010"], "comments": [{"owner": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "edited": false, "score": 0, "creation_date": 1493195926, "post_id": 43628939, "comment_id": 74306459, "body": "Run your code step by step and tell us where the unwanted behaviour occurs, this way we can help you much faster. Define &quot;<b>the emails just kept copying across</b>&quot;."}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1493202053, "post_id": 43628939, "comment_id": 74310773, "body": "I suggest the msg.copy adds to the folder, triggering the ItemAdd code."}, {"owner": {"reputation": 1, "user_id": 7924032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a579b288d10f9d5ba383765097845b33?s=128&d=identicon&r=PG&f=1", "display_name": "jamieee", "link": "https://stackoverflow.com/users/7924032/jamieee"}, "edited": false, "score": 0, "creation_date": 1493278147, "post_id": 43628939, "comment_id": 74350120, "body": "Apologies for late response, I was called out the office all day after posting. Thanks for getting back to me. David - a single iteration of the code causes the expected results, the problem lies in that the code keeps running causing the duplicates. niton - a very good point, I put in the m_cancelAdd piece because it caused an unending amount of copies for a single user but each copy starts it again for each user. Any suggestions?"}, {"owner": {"reputation": 1, "user_id": 7924032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a579b288d10f9d5ba383765097845b33?s=128&d=identicon&r=PG&f=1", "display_name": "jamieee", "link": "https://stackoverflow.com/users/7924032/jamieee"}, "edited": false, "score": 0, "creation_date": 1493278300, "post_id": 43628939, "comment_id": 74350200, "body": "I could do a search to see if an email with the same subject and sent/received time exists in the folder and cancel it but won&#39;t that mean the macro will effectively be constantly running?"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7924032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a579b288d10f9d5ba383765097845b33?s=128&d=identicon&r=PG&f=1", "display_name": "jamieee", "link": "https://stackoverflow.com/users/7924032/jamieee"}, "is_accepted": false, "score": 0, "last_activity_date": 1493797722, "creation_date": 1493797722, "answer_id": 43754176, "question_id": 43628939, "link": "https://stackoverflow.com/questions/43628939/copy-emails-to-another-folder-from-a-shared-mailbox-multiple-users/43754176#43754176", "title": "Copy Emails to Another Folder from a Shared Mailbox - Multiple Users", "body": "<p>I thought I'd post my fix in case anyone else has the same problem. It's quite simple actually and overcomes the issue of duplication for each person who has the code active on the shared mailbox.</p>\n\n<p>The problem was quite simple (after prompting from niton!) whereby each copy triggered the event again so was in an unending loop (which seems a bit barmy to me considering the folder I saved to was outside the inbox but that's by-the-by). The solution was to save the mail item as a .msg file and have my excel wb look up to that location. The only complication was that excel can't read in .msg files so to get the properties (such as .Subject and .Body etc) you have to trick it using <code>oOL.CreateItemFromTemplate(myPath &amp; myMsg)</code>, oOL being <code>Dim oOL As Outlook.Application</code> &amp; <code>Set oOL = CreateObject(\"Outlook.Application\")</code>.</p>\n\n<p>The code below is the complete version of my outlook code in case it helps anybody in the future.</p>\n\n<pre><code>Private Sub olInboxItems_ItemAdd(ByVal Item As Object)\n\nOn Error GoTo ErrorHandler\n\nDim sPath As String\nDim sName As String\nDim rDate As Date\n\nsPath = \"C:\\Example\\\"\n\n    If TypeName(Item) = \"MailItem\" Then\n\n        If Item.Subject Like \"*MSR*\" Then\n\n            rDate = Item.ReceivedTime\n\n            sName = \"In - \" &amp; Mid(Item.Subject, InStr(1, Item.Subject, \"MSR\"), 9) &amp; \" - \" &amp; Format(rDate, \"yyyymmdd\", vbUseSystemDayOfWeek, vbUseSystem) &amp; Format(rDate, \"hhnnss\", vbUseSystemDayOfWeek, vbUseSystem) &amp; \".msg\"\n\n            Item.SaveAs sPath &amp; sName, olMSG\n\n        End If\n\n    End If\n\nProgramExit:\nExit Sub\nErrorHandler:\nMsgBox Err.Number &amp; \" - \" &amp; Err.Description\nResume ProgramExit\nEnd Sub\n</code></pre>\n\n<p>Code is exactly the same for <code>Private Sub olSentItems_ItemAdd(ByVal Item As Object)</code> except I changed the prefix in the name of the file to <code>\"Out - \" &amp; etc</code>. All the other bits of code in the question above remained the same.</p>\n"}], "owner": {"reputation": 1, "user_id": 7924032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a579b288d10f9d5ba383765097845b33?s=128&d=identicon&r=PG&f=1", "display_name": "jamieee", "link": "https://stackoverflow.com/users/7924032/jamieee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1051, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1493797722, "creation_date": 1493195735, "question_id": 43628939, "link": "https://stackoverflow.com/questions/43628939/copy-emails-to-another-folder-from-a-shared-mailbox-multiple-users", "title": "Copy Emails to Another Folder from a Shared Mailbox - Multiple Users", "body": "<p>I have 2 macros that copies emails with a certain term in the subject (1 for inbox, 1 for sent items) from a shared mailbox into a folder within that mailbox. It works fine when on my machine but I need to put the macros on the computers of everyone else in my team to ensure the copies happen when someone isn't in. </p>\n\n<p>I understand that this will (should) lead to a copy of each email for each user who has the macro which is fine because I'm only using this folder to link to an excel sheet which pulls the info in the body of the emails into a workbook and a simple remove duplicates will get rid of the copies.</p>\n\n<p>The problem is I tested it on another machine along with it on mine and the emails just kept copying across, I'm talking around 20 times and I can't understand for the life of me why this might be happening.</p>\n\n<p>I've copied the code in below, if anyone has any ideas why it might be happening or a potential work around I'd be most grateful!</p>\n\n<pre><code>Private WithEvents olInboxItems As Items\nPrivate WithEvents olSentItems As Items\nPrivate m_cancelAdd As Boolean\n\n\nPrivate Sub Application_Startup()\n\n  Dim olApp As Outlook.Application\n  Dim objNS As Outlook.NameSpace\n\n  Set olApp = Outlook.Application\n  Set objNS = olApp.GetNamespace(\"MAPI\")\n  Set olInboxItems = objNS.Folders(\"Merchandise Support\").Folders(\"Inbox\").Items\n  Set olSentItems = objNS.Folders(\"Merchandise Support\").Folders(\"Sent Items\").Items\n\nEnd Sub\n\nPrivate Sub olInboxItems_ItemAdd(ByVal Item As Object)\n\nOn Error GoTo ErrorHandler\n\nIf (m_cancelAdd) Then\nm_cancelAdd = False\n    Exit Sub\nEnd If\n\nDim olApp As Outlook.Application\nDim ns As Outlook.NameSpace\nDim moveToFolder As Outlook.MAPIFolder\nDim Msg As Outlook.MailItem\n\n    If TypeName(Item) = \"MailItem\" Then\n\n        If Item.Subject Like \"*MSR*\" Then\n\n            Set olApp = Outlook.Application\n            Set ns = olApp.GetNamespace(\"MAPI\")\n            Set moveToFolder = ns.Folders(\"Merchandise Support\").Folders(\"Support Requests\")\n            Set Msg = Item\n\n            m_cancelAdd = True\n            Msg.Copy\n            Msg.Move moveToFolder\n\n        End If\n\n    End If\n\nProgramExit:\nExit Sub\nErrorHandler:\nMsgBox Err.Number &amp; \" - \" &amp; Err.Description\nResume ProgramExit\nEnd Sub\n\nPrivate Sub olSentItems_ItemAdd(ByVal Item As Object)\n\nOn Error GoTo ErrorHandler\n\nIf (m_cancelAdd) Then\nm_cancelAdd = False\n    Exit Sub\nEnd If\n\nDim olApp As Outlook.Application\nDim ns As Outlook.NameSpace\nDim moveToFolder As Outlook.MAPIFolder\nDim Msg As Outlook.MailItem\n\n    If TypeName(Item) = \"MailItem\" Then\n\n        If Item.Subject Like \"*MSR*\" Then\n\n            Set olApp = Outlook.Application\n            Set ns = olApp.GetNamespace(\"MAPI\")\n            Set moveToFolder = ns.Folders(\"Merchandise Support\").Folders(\"Support Requests\")\n            Set Msg = Item\n\n            m_cancelAdd = True\n            Msg.Copy\n            Msg.Move moveToFolder\n\n        End If\n\n    End If\n\nProgramExit:\nExit Sub\nErrorHandler:\nMsgBox Err.Number &amp; \" - \" &amp; Err.Description\nResume ProgramExit\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 1, "creation_date": 1493195423, "post_id": 43628721, "comment_id": 74306124, "body": "Try decompiling and compact and repair. Is it a popup form? Maybe it appears on the other monitor? Maybe it is open in design view? I&#39;m guessing this is something banal you are overlooking. Take a break and try again in 30 minutes. :)"}, {"owner": {"reputation": 1, "user_id": 7924060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c81bdb79c4df552f85d54904c5c1356?s=128&d=identicon&r=PG&f=1", "display_name": "bomba94", "link": "https://stackoverflow.com/users/7924060/bomba94"}, "reply_to_user": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1493197079, "post_id": 43628721, "comment_id": 74307287, "body": "I&#39;ve tried to decompile the application and now it&#39;s working. I did not know this function. Thank you very much!"}, {"owner": {"reputation": 1, "user_id": 7924060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c81bdb79c4df552f85d54904c5c1356?s=128&d=identicon&r=PG&f=1", "display_name": "bomba94", "link": "https://stackoverflow.com/users/7924060/bomba94"}, "reply_to_user": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1496828873, "post_id": 43628721, "comment_id": 75817070, "body": "I still have the same problem on another form in my application. The form worked since i add a piece of code in it. Now, also deleting the code it doesn&#39;t work... I&#39;ve also tried to decompile the application but nothing changed..."}], "answers": [{"tags": [], "owner": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1493195555, "creation_date": 1493195555, "answer_id": 43628868, "question_id": 43628721, "link": "https://stackoverflow.com/questions/43628721/vba-access-form-doesnt-show/43628868#43628868", "title": "VBA Access form doesn&#39;t show", "body": "<p>The following function has several arguments for show/hide etc. With the correct parameters you should be able to get that form to be visible:</p>\n\n<pre><code>OpenForm(FormName, View, FilterName, WhereCondition, DataMode, WindowMode, OpenArgs)\n</code></pre>\n\n<p>All the argument options can be found <a href=\"https://msdn.microsoft.com/en-us/library/office/ff820845.aspx\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 1, "user_id": 7924060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c81bdb79c4df552f85d54904c5c1356?s=128&d=identicon&r=PG&f=1", "display_name": "bomba94", "link": "https://stackoverflow.com/users/7924060/bomba94"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 417, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1496829170, "creation_date": 1493195121, "last_edit_date": 1496829170, "question_id": 43628721, "link": "https://stackoverflow.com/questions/43628721/vba-access-form-doesnt-show", "title": "VBA Access form doesn&#39;t show", "body": "<p>I'm developing an application in MS Access, using VBA.</p>\n\n<p>The application already exists but I have to add a button and a piece of code in a form.</p>\n\n<p>The problem is that, when I add the button and try to show the form, I don't receive an error but the form isn't visible.</p>\n\n<p>I'm sure that the form is open, because, if I try to delete it, I receive an error that tells me that is not possible to delete an opened form.</p>\n\n<p>Can anyone tells me the solution?</p>\n\n<p><em>Edit</em>: I still have the same problem on another form in my application. The form worked since i add a piece of code in it. Now, also deleting the code it doesn't work... I've also tried to decompile the application but nothing changed... </p>\n"}, {"tags": ["vba", "types"], "comments": [{"owner": {"reputation": 4346, "user_id": 6375113, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JHg5K.jpg?s=128&g=1", "display_name": "Bugs", "link": "https://stackoverflow.com/users/6375113/bugs"}, "edited": false, "score": 2, "creation_date": 1493194740, "post_id": 43628561, "comment_id": 74305688, "body": "VB.NET, VBA and VBScript are all different. Please <a href=\"https://stackoverflow.com/posts/43628561/edit\">edit</a> and remove the irrelevant tags. Please also see <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and take the <a href=\"https://stackoverflow.com/tour\">tour</a>."}, {"owner": {"reputation": 11, "user_id": 7923875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bbff97571ffe637f03d9023cb0cfea5?s=128&d=identicon&r=PG&f=1", "display_name": "AutoMartin", "link": "https://stackoverflow.com/users/7923875/automartin"}, "reply_to_user": {"reputation": 4346, "user_id": 6375113, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JHg5K.jpg?s=128&g=1", "display_name": "Bugs", "link": "https://stackoverflow.com/users/6375113/bugs"}, "edited": false, "score": 0, "creation_date": 1493195959, "post_id": 43628561, "comment_id": 74306490, "body": "Not sure what you wish me to edit, only &quot;VBA&quot; and &quot;Types&quot; as tags."}, {"owner": {"reputation": 4346, "user_id": 6375113, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JHg5K.jpg?s=128&g=1", "display_name": "Bugs", "link": "https://stackoverflow.com/users/6375113/bugs"}, "edited": false, "score": 0, "creation_date": 1493196034, "post_id": 43628561, "comment_id": 74306535, "body": "It looks to have already been <a href=\"http://stackoverflow.com/posts/43628561/revisions\">done</a> AutoMartin by Lankymart."}], "answers": [{"tags": [], "owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "is_accepted": false, "score": 0, "last_activity_date": 1493199432, "last_edit_date": 1493199432, "creation_date": 1493197930, "answer_id": 43629808, "question_id": 43628561, "link": "https://stackoverflow.com/questions/43628561/vba-forwarding-types-through-sub-routine-call-argument/43629808#43629808", "title": "VBA: forwarding types through sub-routine call argument", "body": "<p>As far as I understand your problem, you could create e.g. <code>Point</code> class and use it in a collection and then pass instance of this collection to the <code>Draw</code> method. HTH</p>\n\n<p><em>Note: The name <code>Point</code> corresponds with the name <code>Properties</code> in your question.</em> </p>\n\n<blockquote>\n  <p>Point Class Module</p>\n</blockquote>\n\n<pre><code>Option Explicit\n\nPrivate m_length As Double\n\nPublic Property Get Length() As Double\n    Length = m_length\nEnd Property\n\nPublic Property Let Length(ByVal vNewValue As Double)\n    m_length = vNewValue\nEnd Property\n\n' Tha same as by lenght for the next properties\n'    keygripp As Double\n'    diameter As Double\n'    tapdiameter As Double\n'    steerlength As Double\n'    distance As Double\n'    plateau As Double\n</code></pre>\n\n<blockquote>\n  <p>Processor Class Module     </p>\n</blockquote>\n\n<pre><code>Option Explicit\n\nPublic Sub Draw(pts As VBA.Collection)\n    Dim p As Point\n    For Each p In pts\n        ' ...\n        ' doCoolStuff p.Length\n        ' doOtherCoolStuff p.keygripp, p.diameter\n        ' ...\n    Next p\nEnd Sub\n</code></pre>\n\n<blockquote>\n  <p>Standard Module</p>\n</blockquote>\n\n<pre><code>Sub Start()\n    Dim pt As Point\n    Set pt = New Point\n    pt.Length = 123\n    ' pt.plateau = ...\n\n    Dim points As VBA.Collection\n    Set points = New VBA.Collection\n    points.Add pt\n\n    Dim proc As Processor\n    Set proc = New Processor\n    proc.Draw points\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>If you wish to stay by the user defined type, then in standard module declare the type and then use it with array (UDT can't be used with <code>VBA.Collection</code>).</p>\n\n<blockquote>\n  <p>Standard Module</p>\n</blockquote>\n\n<pre><code>Type PointType\n    length As Double\n    keygripp As Double\n    diameter As Double\n    tapdiameter As Double\n    steerlength As Double\n    distance As Double\n    plateau As Double\nEnd Type\n\nSub start()\n    Dim pt As PointType\n    pt.length = 555\n\n    Dim pt2 As PointType\n    pt2.length = 666\n\n    Dim pts(1 To 2) As PointType\n    pts(1) = pt\n    pts(2) = pt2\n\n    Dim proc As Processor\n    Set proc = New Processor\n    proc.Draw pts\nEnd Sub\n</code></pre>\n\n<blockquote>\n  <p>Class Processor</p>\n</blockquote>\n\n<pre><code>Public Sub Draw(pts() As PointType)\n' use for-next isnatead of for-each-next here\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7923875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bbff97571ffe637f03d9023cb0cfea5?s=128&d=identicon&r=PG&f=1", "display_name": "AutoMartin", "link": "https://stackoverflow.com/users/7923875/automartin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1493199432, "creation_date": 1493194656, "last_edit_date": 1493195534, "question_id": 43628561, "link": "https://stackoverflow.com/questions/43628561/vba-forwarding-types-through-sub-routine-call-argument", "title": "VBA: forwarding types through sub-routine call argument", "body": "<p>My first entrance here.</p>\n\n<p>Coding VBA, fairly unfamiliar.</p>\n\n<p>=================================================================</p>\n\n<p>Objective: Input coordinates into an object/class.</p>\n\n<p>... means \"and so on\"</p>\n\n<p>Solution now: using array, such as</p>\n\n<p>=================================================================</p>\n\n<p>class1:</p>\n\n<pre><code>sub start()\n    Dim c2 as new Class2\n    Dim points() as Double\n    Redim points(7)\n    point(0) = ...\n    ...\n    point(7) = ...\n    cs.draw points\nend sub\n</code></pre>\n\n<p>class2:</p>\n\n<pre><code>public Sub draw(points() as double)\n    ...\nend sub\n</code></pre>\n\n<p>=================================================================</p>\n\n<p>Problem is: hard keep track witch array-slot represents a particular value of interest.</p>\n\n<p>What I want to do, is something like:</p>\n\n<p>class 1:</p>\n\n<pre><code>Type Properties\n    length As Double\n    keygripp As Double\n    diameter As Double\n    tapdiameter As Double\n    steerlength As Double\n    distance As Double\n\n    plateau As Double\nEnd Type\n\n\nsub start()\n    Dim c2 as new Class2\n    Dim points as Properties\n    point.length = ...\n    ...\n    point.plateau = ...\n    cs.draw points\nend sub\n</code></pre>\n\n<p>class2:</p>\n\n<pre><code>public Sub draw(p as Properties) '&lt;---- Class 2 also need access to properties?\n    ...\n    doCoolStuff(p.length)\n    doOtherCoolStuff(p.keygripp, p.diameter)\n    ...\nend sub\n</code></pre>\n\n<p>do I declare the Type Properties global somehow so that class1 and class2 both will know what it is about?</p>\n\n<p>Regards // Martin</p>\n"}, {"tags": ["vba", "excel", "excel-addins"], "comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1493194683, "post_id": 43628374, "comment_id": 74305640, "body": "Could you not share the servers drive where the files are stored and just do it locally without RDP?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1493194839, "post_id": 43628374, "comment_id": 74305750, "body": "is the button in a ribbon or on the sheet?"}, {"owner": {"reputation": 103, "user_id": 5025995, "user_type": "registered", "accept_rate": 21, "profile_image": "https://lh5.googleusercontent.com/-G32k6Uw1NjM/AAAAAAAAAAI/AAAAAAAAFdA/4LG5kiY3MCM/photo.jpg?sz=128", "display_name": "Scott Davies", "link": "https://stackoverflow.com/users/5025995/scott-davies"}, "reply_to_user": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1493195508, "post_id": 43628374, "comment_id": 74306185, "body": "@Tom, there are multiple permissions and services which the server has which are difficult/impossible to get locally."}, {"owner": {"reputation": 103, "user_id": 5025995, "user_type": "registered", "accept_rate": 21, "profile_image": "https://lh5.googleusercontent.com/-G32k6Uw1NjM/AAAAAAAAAAI/AAAAAAAAFdA/4LG5kiY3MCM/photo.jpg?sz=128", "display_name": "Scott Davies", "link": "https://stackoverflow.com/users/5025995/scott-davies"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1493195529, "post_id": 43628374, "comment_id": 74306198, "body": "@Nathan_Sav the button is on the ribbon."}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1493195610, "post_id": 43628374, "comment_id": 74306248, "body": "What is the addin? is it an <code>xla</code> file? Has it been developed in house or externally?"}, {"owner": {"reputation": 103, "user_id": 5025995, "user_type": "registered", "accept_rate": 21, "profile_image": "https://lh5.googleusercontent.com/-G32k6Uw1NjM/AAAAAAAAAAI/AAAAAAAAFdA/4LG5kiY3MCM/photo.jpg?sz=128", "display_name": "Scott Davies", "link": "https://stackoverflow.com/users/5025995/scott-davies"}, "reply_to_user": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1493196925, "post_id": 43628374, "comment_id": 74307168, "body": "@Tom it was developed externally.  I will add some images of the add-in."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1493198484, "post_id": 43628374, "comment_id": 74308272, "body": "I hate to suggest this (because I don&#39;t like this method) but you could possibly use <code>Sendkeys</code> to emulate the keystrokes necessary to select the items from the menu."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1493199309, "post_id": 43628374, "comment_id": 74308849, "body": "does an approach like <code>Dim x As COMAddIn:Set x = Application.COMAddIns(y)</code> where y is the addin name yield any intelisense on the resultant object <code>x.object</code> for any publicly exposed functions of the addin.  <a href=\"https://msdn.microsoft.com/en-us/library/bb608614.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/bb608614.aspx</a>"}], "answers": [{"comments": [{"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1493198866, "post_id": 43629649, "comment_id": 74308527, "body": "Ah yes, it&#39;s a VSTO. I believe you still write XML to manipulate the ribbon but probably tricky to read it once it&#39;s compiled (if that&#39;s the right word - I don&#39;t use VSTO myself)"}, {"owner": {"reputation": 103, "user_id": 5025995, "user_type": "registered", "accept_rate": 21, "profile_image": "https://lh5.googleusercontent.com/-G32k6Uw1NjM/AAAAAAAAAAI/AAAAAAAAFdA/4LG5kiY3MCM/photo.jpg?sz=128", "display_name": "Scott Davies", "link": "https://stackoverflow.com/users/5025995/scott-davies"}, "edited": false, "score": 0, "creation_date": 1493374531, "post_id": 43629649, "comment_id": 74401207, "body": "Thanks CLR - I haven&#39;t managed to get anything that I could see as usable using this method.  I looked for various keywords to see if maybe one of the other files in there had something usable (outside of customUI.xml) but found nothing unfortunately."}], "tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": false, "score": 0, "last_activity_date": 1493197887, "last_edit_date": 1493197887, "creation_date": 1493197490, "answer_id": 43629649, "question_id": 43628374, "link": "https://stackoverflow.com/questions/43628374/running-an-excel-add-in-function-using-vba-on-remote-desktop/43629649#43629649", "title": "Running an Excel Add-in function using VBA on remote desktop", "body": "<p>You could pry open the xls(m?) file by renaming it to zip, open it in ZIP, navigate to the customUI/customUI.xml and open that in Notepad. Reading that should give you the name of the macro each button added is calling.</p>\n\n<p>eg.</p>\n\n<pre><code> ....size=\"large\" onAction=\"showuserform\" imageMso=\"CreateRepo....\n</code></pre>\n\n<p>where <code>showuserform</code> is the name of the macro being called.</p>\n"}], "owner": {"reputation": 103, "user_id": 5025995, "user_type": "registered", "accept_rate": 21, "profile_image": "https://lh5.googleusercontent.com/-G32k6Uw1NjM/AAAAAAAAAAI/AAAAAAAAFdA/4LG5kiY3MCM/photo.jpg?sz=128", "display_name": "Scott Davies", "link": "https://stackoverflow.com/users/5025995/scott-davies"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 613, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1493197887, "creation_date": 1493194049, "last_edit_date": 1493197262, "question_id": 43628374, "link": "https://stackoverflow.com/questions/43628374/running-an-excel-add-in-function-using-vba-on-remote-desktop", "title": "Running an Excel Add-in function using VBA on remote desktop", "body": "<p>I have a scenario where we need to open a number of spreadsheets on a server, update a number of worksheets on each workbook by means of an add in button.  </p>\n\n<p>So the user opens remote desktop, opens a spreadsheet, goes to sheet x, goes to the add-ins menu and clicks a button.  This button updates the data on the sheet which takes several seconds.  Then they open sheet y and repeat.  Eventually all sheets are updated and the user saves and closes the sheet.  </p>\n\n<p>I am trying to automate this.  My thinking is to have a \"master excel document\" with a button to execute VBA code which will:</p>\n\n<ul>\n<li>Open a specific folder</li>\n<li>Open each workbook in the folder</li>\n<li>Cycle through the sheets and find the ones that need to be updated (as not every sheet needs to be updated)  </li>\n<li>Once completed, save and close the sheet and then repeat for all workbooks and for all folders.  </li>\n</ul>\n\n<p>My major problem right now is that I need to figure out how to execute the Add-in function from my VBA code.  I have researched and found that I need to run it using code like this: APPLICATION.RUN \"ADDIN_NAME.XLA!SUBNAME\"</p>\n\n<p>I think I have the ADDIN_NAME (found this by clicking file, options, add-ins).  But I cannot figure out how to get the subname.  </p>\n\n<p>Using the Macro recorder doesn't work - no code is recorded for clicking the add-in button.  When I hover my mouse over the add-in button, it give me \"Analyst : Refresh Report, Use Current Criteria\".  Any suggestions as to how I could work out what the subname is? \n<a href=\"https://i.stack.imgur.com/wdbsa.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wdbsa.jpg\" alt=\"enter image description here\"></a>\n<a href=\"https://i.stack.imgur.com/cFuRN.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cFuRN.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel", "sharepoint"], "answers": [{"tags": [], "owner": {"reputation": 33, "user_id": 7931400, "user_type": "registered", "profile_image": "https://graph.facebook.com/1404130212959110/picture?type=large", "display_name": "Priyankar Dutta", "link": "https://stackoverflow.com/users/7931400/priyankar-dutta"}, "is_accepted": false, "score": 0, "last_activity_date": 1493302984, "creation_date": 1493302984, "answer_id": 43660553, "question_id": 43628167, "link": "https://stackoverflow.com/questions/43628167/excel-vba-macro-to-download-a-file-automatically-when-its-added-to-a-sharepoint/43660553#43660553", "title": "Excel vba macro to download a file automatically when it&#39;s added to a Sharepoint site", "body": "<p>Assuming that you are using SharePoint 2013 OnPremise you can write an ItemAdded event receiver which will execute your macro (you can do this only if you are allowed to deploy code to SharePoint). </p>\n\n<p>You could also write a Service / Job that will run every 5-10 minutes and check which files have been added in the last 5-10 minutes (this frequency will depend on what is the urgency for executing the macro), download the file and then execute the macro on those. </p>\n\n<p>Irrespective of the environment this code could run directly from your local machine if you have no good place to host it. </p>\n"}], "owner": {"reputation": 403, "user_id": 6667879, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d24125511b2a08c2ed9f433f6412aae4?s=128&d=identicon&r=PG&f=1", "display_name": "JuniorDev", "link": "https://stackoverflow.com/users/6667879/juniordev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 286, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1493302984, "creation_date": 1493193413, "last_edit_date": 1493193497, "question_id": 43628167, "link": "https://stackoverflow.com/questions/43628167/excel-vba-macro-to-download-a-file-automatically-when-its-added-to-a-sharepoint", "title": "Excel vba macro to download a file automatically when it&#39;s added to a Sharepoint site", "body": "<p>I am running an excel macro, it downloads some files from SharePoint. It's working fine but my problem is, Everytime i need to check if the file exists there or no then i download it. </p>\n\n<p>Is there a possibility to add a condition when the file is added on SharePoint then the macro will run automatically. Because the reports are uploaded in different times by other users for example one day at 9 am, another day 11 am, another day at 1pm... and now i am checking everyday many times on the sharepoint site if the report was added or no before i run my macro. </p>\n\n<p>I want to avoid this and link somehow the sharepoint site to my macro. \nFor example for the reports i receive on Outlook i created a macro when i receive an email with attachment containing a specific name it will download automatically. I want something similar on Sharepoint without checking everytime on Sharepoint if the other users uploaded their reports or not.</p>\n\n<p>Any suggestion please ? </p>\n"}, {"tags": ["vba", "excel", "loops", "copy-paste"], "comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1493195581, "post_id": 43628160, "comment_id": 74306229, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/43318867/vba-loop-through-folder-and-subfolders-to-find-specific-sheet-then-copy-and-past\">VBA Loop through folder and subfolders to find specific sheet then Copy and Paste certain data</a>"}, {"owner": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 1, "creation_date": 1493198681, "post_id": 43628160, "comment_id": 74308394, "body": "Hi Luuklag: The link you have supplied is indeed my question. I did accept an answer there and the solution worked. Then the folders evolved and I struggled to amend the code I had received to accommodate more folders . I am relatively new with the site 196 points and i figured creating a new question would get better results than revisiting an old. I hope I have not infringed on the ethics of the site as it has been very good to me thus far."}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 1, "creation_date": 1493199223, "post_id": 43628160, "comment_id": 74308763, "body": "Looks like you just need to add a second level of childfolders"}, {"owner": {"reputation": 524, "user_id": 7648526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b54db50ad2bfd167b85f1686dd47b28d?s=128&d=identicon&r=PG&f=1", "display_name": "SteveES", "link": "https://stackoverflow.com/users/7648526/stevees"}, "edited": false, "score": 1, "creation_date": 1493200068, "post_id": 43628160, "comment_id": 74309385, "body": "If your problem is to do with recursively looking through child subfolders, you might find my <a href=\"http://stackoverflow.com/a/43517300/7648526\">answer to a related question</a> helpful."}, {"owner": {"reputation": 530, "user_id": 5902659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6ed01eb79ca1012c98545e01aaca144?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/5902659/user1"}, "edited": false, "score": 1, "creation_date": 1493202062, "post_id": 43628160, "comment_id": 74310783, "body": "<a href=\"http://stackoverflow.com/questions/41102975/how-can-i-improve-my-function-for-handling-alternative-to-application-filesearch\" title=\"how can i improve my function for handling alternative to application filesearch\">stackoverflow.com/questions/41102975/&hellip;</a> take your time to read through this."}], "owner": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 274, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1493198486, "creation_date": 1493193385, "last_edit_date": 1495540954, "question_id": 43628160, "link": "https://stackoverflow.com/questions/43628160/vba-code-not-looping-completely-through-every-folder", "title": "VBA code not looping completely through every folder", "body": "<p>So my question has been marked as a possible Duplicate of <a href=\"https://stackoverflow.com/questions/43318867/vba-loop-through-folder-and-subfolders-to-find-specific-sheet-then-copy-and-past\">VBA Loop through folder and subfolders to find specific sheet then Copy and Paste certain data</a></p>\n\n<p>This is indeed my question and it is practically the same. The part I am struggling with is getting automation from the first folder through to the rest\nI think the piece of code that is relevant for change is here </p>\n\n<pre><code>For Each ChildFolder In FSO.GetFolder(MyFolder).SubFolders\n        myFile = Dir(MyFolder &amp; ChildFolder.Name &amp; \"\\\")  'DIR gets the first file of the folder\n</code></pre>\n\n<p>I have no desire to upset the ethics of the site. I simply accepted an answer and struggled with the code I had after changes happened in the workplace. </p>\n\n<p><strong>Original Question Below</strong> </p>\n\n<p>I hope you can help. I have a piece of code and its works fine. Essentially it allows a user to click on a command button (see Pic 5) on an Excel Workbook opens a dialog box allows the user to select a folder then once the folder is selected the code loops through the folder for files named <strong>Like \"<em>CustomerExp</em>\"</strong> then copies and pastes information on this <strong>Like \"<em>CustomerExp</em>\"</strong> Excel sheet  to another Excel sheet called rejects in the Workbook where the Command Button is held. \nThe only issue I have is that it still requires some manual input from the user. </p>\n\n<p>The issue I am facing is this: I have a folder <strong>2017</strong> it is stored here <em>X:\\Operations\\Rejections all Markets</em> see Pic 1</p>\n\n<p>Within folder <strong>2017</strong> I have more folders named for months of the year. See Pic 2</p>\n\n<p>Within each monthly folder lets take Jan for example there will be several more folders see Pic 3 </p>\n\n<p>Withing each folder inside the monthly folder there are excel sheets saved see Pic 4</p>\n\n<p>As i said my code does actually work  but what the user has to do is select a monthly folder each time. So the user clicks the command button navigates to Jan folder double clicks on Jan folder and the code works. Then the user has to double click on Feb folder and the code works again and then onto March. </p>\n\n<p>What I want is for the user to click only on folder 2017 and the code will then go through Jan and all its folders find files named <strong>Like \"<em>CustomerExp</em>\"</strong> do the copy and paste then move onto Feb and then March and so forth without any input or double clicking on each monthly folder by the user. I'm looking for full automation from the click on the 2017 folder. </p>\n\n<p>My code is below can it be amended to provide full automation from the 2017 folder. \nAs always any and all help is greatly appreciated. </p>\n\n<p>MY CODE</p>\n\n<pre><code>Sub AllWorkbooks()\n\n    Dim MyFolder As String 'Path collected from the folder picker dialog\n    Dim myFile As String 'Filename obtained by DIR function\n    Dim wbk As Workbook 'Used to loop through each workbook\n    Dim FSO As New FileSystemObject ' Requires \"Windows Script Host Object Model\" in Tools -&gt; References\n    Dim ParentFolder As Object, ChildFolder As Object\n\n\n    Dim wb As Workbook\n    Dim myPath As String\n\n    Dim myExtension As String\n    Dim FldrPicker As FileDialog\n    Dim lRow As Long\n    Dim ws2 As Worksheet\n    Dim y As Workbook\n\n\n    On Error Resume Next\n    Application.ScreenUpdating = False\n\n    'Opens the folder picker dialog to allow user selection\n    With Application.FileDialog(msoFileDialogFolderPicker)\n        .Title = \"Please select a folder\"\n        .Show\n        .AllowMultiSelect = False\n\n        If .SelectedItems.Count = 0 Then 'If no folder is selected, abort\n            MsgBox \"You did not select a folder\"\n            Exit Sub\n        End If\n\n        MyFolder = .SelectedItems(1) &amp; \"\\\" 'Assign selected folder to MyFolder\n    End With\n\n    myFile = Dir(MyFolder) 'DIR gets the first file of the folder\n\n\n    Set y = ThisWorkbook\n    Set ws2 = y.Sheets(\"Rejects\")\n\n    'Loop through all files in a folder until DIR cannot find anymore\n    Do While myFile &lt;&gt; \"\"\n\n    If myFile Like \"*CustomerExp*\" Then\n\n\n\n\n        'Opens the file and assigns to the wbk variable for future use\n        Set wbk = Workbooks.Open(Filename:=MyFolder &amp; myFile)\n        'Replace the line below with the statements you would want your macro to perform\n                With wbk.Sheets(1)\n\n            lRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n            .Range(\"A1:AA\" &amp; lRow).Copy ws2.Range(\"A\" &amp; Rows.Count).End(xlUp)(2)\n        End With\n        ''Application.Wait (Now + TimeValue(\"0:00:05\"))\n        wbk.Close savechanges:=True\n\n        End If\n        myFile = Dir 'DIR gets the next file in the folder\n\n\n\n    Loop\n\n    For Each ChildFolder In FSO.GetFolder(MyFolder).SubFolders\n        myFile = Dir(MyFolder &amp; ChildFolder.Name &amp; \"\\\")  'DIR gets the first file of the folder\n        'Loop through all files in a folder until DIR cannot find anymore\n        Do While myFile &lt;&gt; \"\"\n\n        If myFile Like \"*CustomerExp*\" Then\n\n            'Opens the file and assigns to the wbk variable for future use\n            Set wbk = Workbooks.Open(Filename:=MyFolder &amp; ChildFolder.Name &amp; \"\\\" &amp; myFile)\n            'Replace the line below with the statements you would want your macro to perform\n                            With wbk.Sheets(1)\n            lRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n            .Range(\"A1:AA\" &amp; lRow).Copy ws2.Range(\"A\" &amp; Rows.Count).End(xlUp)(2)\n        End With\n            ''Application.Wait (Now + TimeValue(\"0:00:05\"))\n            wbk.Close savechanges:=True\n            End If\n            myFile = Dir 'DIR gets the next file in the folder\n        Loop\n    Next ChildFolder\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>Pic 1\n<a href=\"https://i.stack.imgur.com/1ieyP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1ieyP.png\" alt=\"enter image description here\"></a></p>\n\n<p>Pic 2</p>\n\n<p><a href=\"https://i.stack.imgur.com/6gRBG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6gRBG.png\" alt=\"enter image description here\"></a></p>\n\n<p>Pic 3</p>\n\n<p><a href=\"https://i.stack.imgur.com/rXhg1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rXhg1.png\" alt=\"enter image description here\"></a></p>\n\n<p>Pic 4 </p>\n\n<p><a href=\"https://i.stack.imgur.com/x1ifO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/x1ifO.png\" alt=\"enter image description here\"></a></p>\n\n<p>Pic 5 </p>\n\n<p><a href=\"https://i.stack.imgur.com/ijArq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ijArq.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1493193586, "post_id": 43628083, "comment_id": 74304978, "body": "where are you getting your error ? what line ?"}, {"owner": {"reputation": 3, "user_id": 7923764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5addea4fea0eba27153bb880b6baa843?s=128&d=identicon&r=PG&f=1", "display_name": "Barun Kumar Jha", "link": "https://stackoverflow.com/users/7923764/barun-kumar-jha"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1493278867, "post_id": 43628083, "comment_id": 74350543, "body": "Hi, I was getting error at ws.Cells(&quot;A2&quot;) = rng1Value  this line, I had mentioned cells value like cell(&quot;A2&quot;), I changed to cells(I,i+1) then it is writing into sheet3., thanks"}], "owner": {"reputation": 3, "user_id": 7923764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5addea4fea0eba27153bb880b6baa843?s=128&d=identicon&r=PG&f=1", "display_name": "Barun Kumar Jha", "link": "https://stackoverflow.com/users/7923764/barun-kumar-jha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1493193177, "creation_date": 1493193103, "last_edit_date": 1531164843, "question_id": 43628083, "link": "https://stackoverflow.com/questions/43628083/invalid-procedure-call-or-argument-in-vbaexcel-while-writing-into-sheet3", "title": "Invalid Procedure Call or argument in vbaExcel while Writing into sheet3", "body": "<pre><code>Sub Duplicate()\n\nDim WorkRng1 As Range, WorkRng2 As Range, Rng1 As Range, Rng2 As Range\n\nSet ws = ThisWorkbook.Sheets(\"Sheet3\")    \nxTitleId = \"KutoolsforExcel\"    \nSet WorkRng1 = Application.InputBox(\"Range A:\", xTitleId, \"\", Type:=8)    \nSet WorkRng2 = Application.InputBox(\"Range B:\", xTitleId, Type:=8)\n\nFor Each Rng1 In WorkRng1    \n    rng1Value = Rng1.Value\n    For Each Rng2 In WorkRng2\n        If rng1Value = Rng2.Value Then\n            MsgBox rng1Value            \n            Rng1.Interior.Color = VBA.RGB(255, 0, 0)\n        Else\n            ws.Cells(\"A2\") = rng1Value            \n            Exit For\n        End If\n    Next\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1493193081, "post_id": 43628041, "comment_id": 74304708, "body": "what is <code>r</code> ? and where did you define ans <code>Set</code> it ? is it suppose to be a <code>Range</code> ?"}, {"owner": {"reputation": 1, "user_id": 7923628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/172ac888c5c287f841d02403a09daac4?s=128&d=identicon&r=PG&f=1", "display_name": "cheng", "link": "https://stackoverflow.com/users/7923628/cheng"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1493194074, "post_id": 43628041, "comment_id": 74305278, "body": "I&#39;m really new at this. This is the code I copied from the link mentioned above. I&#39;m not sure what it&#39;s supposed to mean."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1493194152, "post_id": 43628041, "comment_id": 74305317, "body": "You copied a little bit from one answer and another section from the other answer. What is the value in column &quot;H&quot; you are looking for in ordet to copy it to &quot;Sheet&quot;1"}, {"owner": {"reputation": 396, "user_id": 7796810, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9f8b5deb296124be4aa1e86d92250d66?s=128&d=identicon&r=PG&f=1", "display_name": "Digvijay", "link": "https://stackoverflow.com/users/7796810/digvijay"}, "edited": false, "score": 0, "creation_date": 1493197567, "post_id": 43628041, "comment_id": 74307626, "body": "You want to copy data from sheet1 to sheet2 whenever the value in H column is greater than one. Right ?"}, {"owner": {"reputation": 1, "user_id": 7923628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/172ac888c5c287f841d02403a09daac4?s=128&d=identicon&r=PG&f=1", "display_name": "cheng", "link": "https://stackoverflow.com/users/7923628/cheng"}, "edited": false, "score": 0, "creation_date": 1493198761, "post_id": 43628041, "comment_id": 74308457, "body": "Greater than zero. If the value is 0, the row will not be copied into sheet2 If the value in H is 1, the row of data is copied into sheet2 once. If the value in H is 2, the row of data is copied twice into sheet2."}], "answers": [{"tags": [], "owner": {"reputation": 71, "user_id": 10160606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d2b6b9fc12fdc6f21afd67b1305f10?s=128&d=identicon&r=PG&f=1", "display_name": "court_k", "link": "https://stackoverflow.com/users/10160606/court-k"}, "is_accepted": false, "score": 1, "last_activity_date": 1533909363, "last_edit_date": 1533909363, "creation_date": 1533909032, "answer_id": 51788026, "question_id": 43628041, "link": "https://stackoverflow.com/questions/43628041/duplicate-row-x-number-of-times-based-on-cell-value/51788026#51788026", "title": "duplicate row \u201cx\u201d number of times based on cell value", "body": "<p>I know this question is old but it didn't have an answer so I thought it would be okay to submit one. </p>\n\n<p>I made a new macro I thought would be simpler, easier to read and thus understand. All these things that would make it easier for you to edit if you required changes later. </p>\n\n<p>From my understanding, you have information in column D to column H that you want to duplicate <em>x</em> amount of times; where <em>x</em> is a value in column H. I assumed your sheets were named \"Sheet1\" and \"Sheet2\". I have provided an answer below.</p>\n\n<pre><code>Dim wsc As Worksheet 'worksheet copy\nDim wsd As Worksheet 'worksheet destination\n\nDim lrow As Long 'last row of worksheet copy\nDim crow As Long 'copy row\nDim drow As Long 'destination row\n\nDim multiplier As Integer\nDim i As Integer 'counting variable for the multiplier\n\nSet wsc = Sheets(\"Sheet1\")\nSet wsd = Sheets(\"Sheet2\")\n\nlrow = wsc.Range(\"h\" &amp; wsc.Rows.Count).End(xlUp).row\ndrow = 2\n\nWith wsc\n\n    For crow = 2 To lrow 'starts at 2 because of the header row\n\n        multiplier = .Cells(crow, 8).Value 'copies the value in column h\n\n        For i = 1 To multiplier\n\n            wsd.Cells(drow, 4).Value = .Cells(crow, 4).Value\n            wsd.Cells(drow, 5).Value = .Cells(crow, 5).Value\n            wsd.Cells(drow, 6).Value = .Cells(crow, 6).Value\n            wsd.Cells(drow, 7).Value = .Cells(crow, 7).Value\n            wsd.Cells(drow, 8).Value = .Cells(crow, 8).Value\n\n            drow = drow + 1 'increasing the row in worksheet destination \n\n        Next i\n\n    Next crow\n\nEnd With\n</code></pre>\n\n<p>If there are any ways in which this answer could be improved please let me know! :) </p>\n"}], "owner": {"reputation": 1, "user_id": 7923628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/172ac888c5c287f841d02403a09daac4?s=128&d=identicon&r=PG&f=1", "display_name": "cheng", "link": "https://stackoverflow.com/users/7923628/cheng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1384, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1533909363, "creation_date": 1493192951, "last_edit_date": 1531164843, "question_id": 43628041, "link": "https://stackoverflow.com/questions/43628041/duplicate-row-x-number-of-times-based-on-cell-value", "title": "duplicate row \u201cx\u201d number of times based on cell value", "body": "<p>I'm trying to duplicate rows in sheet 1 based on the value indicated in column H of sheet 1, onto sheet 2.</p>\n\n<p>I found a code that seems to work, but it changes the data in the original worksheet, instead of copying the rows into a different worksheet, say \"Sheet2\".</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Sub CopyData()\r\n'Updateby Extendoffice 20160922\r\n    Dim xRow As Long\r\n    Dim VInSertNum As Variant\r\n    xRow = 1\r\n    Application.ScreenUpdating = False\r\n    Do While (Cells(xRow, \"A\") &lt;&gt; \"\")\r\n        VInSertNum = Cells(xRow, \"H\")\r\n        If ((VInSertNum &gt; 1) And IsNumeric(VInSertNum)) Then\r\n           Range(Cells(xRow, \"A\"), Cells(xRow, \"H\")).Copy\r\n           Range(Cells(xRow + 1, \"A\"), Cells(xRow + VInSertNum - 1, \"H\")).Select\r\n           Selection.Insert Shift:=xlDown\r\n           xRow = xRow + VInSertNum - 1\r\n        End If\r\n        xRow = xRow + 1\r\n    Loop\r\n    Application.ScreenUpdating = False\r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>How do I change this code such that it runs the macro in the original extract worksheet \"Sheet1\" and copies the rows into \"Sheet2\", if the value in column H is more than 0?</p>\n\n<p>Sample data in Sheet1 would be as below. The value in container is in column H, which determines the number of rows to be copied &amp; duplicated into Sheet2.</p>\n\n<pre><code>Supplier    Dest    Code     Quantity Container\nA           US01    10001    1000     2\nA           US02    10002    500      4\nB           UK01    10001    0        0\nC           US01    10004    1300     1\n</code></pre>\n\n<p>The desired result in Sheet2 is as below:</p>\n\n<pre><code>Supplier    Dest    Code     Quantity Container\nA           US01    10001    1000     2\nA           US01    10001    1000     2    \nA           US02    10002    500      4\nA           US02    10002    500      4\nA           US02    10002    500      4\nA           US02    10002    500      4\nC           US01    10004    1300     1  \n</code></pre>\n\n<p>Thank you.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 693, "user_id": 1930374, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/wwGpP.jpg?s=128&g=1", "display_name": "Blenikos", "link": "https://stackoverflow.com/users/1930374/blenikos"}, "edited": false, "score": 0, "creation_date": 1493191799, "post_id": 43627492, "comment_id": 74303855, "body": "When and what triggers the sub you use? Do you have a button or something?"}, {"owner": {"reputation": 197, "user_id": 7923625, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nJQUX2HBQm0/AAAAAAAAAAI/AAAAAAAAA44/qA50Mc6jUsg/photo.jpg?sz=128", "display_name": "Simas", "link": "https://stackoverflow.com/users/7923625/simas"}, "reply_to_user": {"reputation": 693, "user_id": 1930374, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/wwGpP.jpg?s=128&g=1", "display_name": "Blenikos", "link": "https://stackoverflow.com/users/1930374/blenikos"}, "edited": false, "score": 0, "creation_date": 1493280821, "post_id": 43627492, "comment_id": 74351814, "body": "I have created a button, because I do not know how to automate it. If the cell value is changed from &#39;active&#39; to &#39;leaver&#39;"}, {"owner": {"reputation": 693, "user_id": 1930374, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/wwGpP.jpg?s=128&g=1", "display_name": "Blenikos", "link": "https://stackoverflow.com/users/1930374/blenikos"}, "edited": false, "score": 0, "creation_date": 1493282048, "post_id": 43627492, "comment_id": 74352641, "body": "vba is an event driven language. In order to automate something by running some code, you need an event to happen. Here, you do not have a form control, in order for an event to trigger. So, you will need a combobox or something and use one of it&#39;s properties (like on change property) to trigger your function. Otherwise, what you want cannot happen!"}], "answers": [{"tags": [], "owner": {"reputation": 122, "user_id": 7898651, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73fffefe567111d182394fc89b829ac6?s=128&d=identicon&r=PG&f=1", "display_name": "shakespeare", "link": "https://stackoverflow.com/users/7898651/shakespeare"}, "is_accepted": false, "score": 0, "last_activity_date": 1493292877, "creation_date": 1493292877, "answer_id": 43656623, "question_id": 43627492, "link": "https://stackoverflow.com/questions/43627492/how-to-move-entire-row-based-on-text-in-a-single-cell/43656623#43656623", "title": "How to move entire row based on text in a single cell?", "body": "<p>this is the easiest way </p>\n\n<pre><code>  Private Sub imperecheaza_Click()\n   Dim ws As Worksheet\n   Dim Rand As Long\n    Set ws = Worksheets(\"BD_IR\")    \n   Rand = 3\n     Do While ws.Cells(Rand, 4).Value &lt;&gt; \"\" And Rand &lt; 65000\n       If ws.Cells(Rand, 4).Value = gksluri.Value * 1 And ws.Cells(Rand, 5).Value = gksluri.List(gksluri.ListIndex, 1) * 1 Then\n         ws.Rows(Rand) = \"\"    '(here you will delete entire Row)\n         gksluri.RemoveItem gksluri.ListIndex\n         Exit Do\n         End If\n       Rand = Rand + 1\n    Loop\n  End Sub\n</code></pre>\n"}], "owner": {"reputation": 197, "user_id": 7923625, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nJQUX2HBQm0/AAAAAAAAAAI/AAAAAAAAA44/qA50Mc6jUsg/photo.jpg?sz=128", "display_name": "Simas", "link": "https://stackoverflow.com/users/7923625/simas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 116, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1493292877, "creation_date": 1493191198, "last_edit_date": 1493191452, "question_id": 43627492, "link": "https://stackoverflow.com/questions/43627492/how-to-move-entire-row-based-on-text-in-a-single-cell", "title": "How to move entire row based on text in a single cell?", "body": "<p>I have been searching on the internet where to find the most efficient and simple way of the following:</p>\n\n<p>I have a spreadsheet that contains 3 sheets:</p>\n\n<ol>\n<li>information</li>\n<li>training</li>\n<li>Leavers</li>\n</ol>\n\n<p>Within the information sheet, column B contains a validation text that is conditionally formatted. There are two validation options:</p>\n\n<ol>\n<li>Active </li>\n<li>Leaver</li>\n</ol>\n\n<p>I want that once the cell value is changed from 'active' to 'Leaver' that the whole row would be removed from the sheet and moved to 'Leaver's sheet. </p>\n\n<p>I have used the code below, it works, however if there is no Leavers it will transfer the first row of 'active'. Can anyone tell me what is the problem? </p>\n\n<pre><code>Sub AlexR688(x)\n    'For http://www.mrexcel.com/forum/excel-q...ific-text.html\n    'Using autofilter to Copy rows that contain centain text to a sheet called Errors\n    Dim LR As Long\n\n    Range(\"B2\").EntireRow.Insert Shift:=xlDown\n    LR = Sheets(\"Personal Information\").Cells(Rows.Count, \"B\").End(xlUp).Row\n    LR1 = Sheets(\"Leavers\").Cells(Rows.Count, \"B\").End(xlUp).Row + 1\n\n    With Sheets(\"Personal Informaiton\").Range(\"B2:C\" &amp; LR)\n        .AutoFilter\n        .AutoFilter Field:=1, Criteria1:=\"Leaver\", _\n            Operator:=xlOr, Criteria2:=\":Leaver\"\n        .SpecialCells(xlCellTypeVisible).EntireRow.Copy Destination:=Sheets(\"Leavers\").Range(\"A\" &amp; LR1)\n        .SpecialCells(xlCellTypeVisible).EntireRow.Delete\n    End With\nEnd Sub\n</code></pre>\n\n<p>Secondly, I want to make the same in the  'Training' sheet. But in there, column B, contains the same 'Active', 'Leavers' which is referenced from personal information. So, once the Personal information sheet column B is changed from 'active' to 'leaver', training sheet will change as well, but i want the row in the training sheet would be deleted. </p>\n\n<p>Thirdly, if I accidentally moved row from Personal information sheet to Leavers sheet, is it possible that by selecting back to 'active' cell value the row would move back to where it was?</p>\n\n<p>Thank you very much. Hope it is clear enough. </p>\n"}, {"tags": ["sql-server", "vba", "excel"], "comments": [{"owner": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "edited": false, "score": 2, "creation_date": 1493191558, "post_id": 43627480, "comment_id": 74303696, "body": "Is this code working? Is there a specific problem? If yes, describe the problem (what, where, how) and what your code should do instead."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 5, "creation_date": 1493191619, "post_id": 43627480, "comment_id": 74303736, "body": "Please read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>. You even didn&#39;t ask a question. Describe your issue well, what is working already, what is not working, what do you expect. Also see <a href=\"https://meta.stackoverflow.com/questions/284236/why-is-can-someone-help-me-not-an-actual-question\">Why is \u201cCan someone help me?\u201d not an actual question?</a>"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1493210572, "post_id": 43627480, "comment_id": 74316976, "body": "Here is the code <a href=\"http://stackoverflow.com/questions/26743347/faster-way-to-import-excel-spreadsheet-to-array-with-ado/30346959#30346959\">to import a CSV file into an SQL DB</a>. You can easily tweak the code to fit your needs. If you want to import that Excel file only one time then the following solution might be easier / faster: <a href=\"http://stackoverflow.com/questions/39182049/how-can-i-convert-rows-with-three-columns-into-sql-insert-statements/39189289#39189289\" title=\"how can i convert rows with three columns into sql insert statements\">stackoverflow.com/questions/39182049/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1500639278, "creation_date": 1500639278, "answer_id": 45237427, "question_id": 43627480, "link": "https://stackoverflow.com/questions/43627480/i-need-to-insert-data-into-sql-server-from-excel-using-vba/45237427#45237427", "title": "I need to insert data into SQL server from Excel using VBA", "body": "<p>Here are a couple ideas.</p>\n\n<pre><code>Sub UpdateTable()\n\n    Dim cnn As Object\n    Dim wbkOpen As Workbook\n    Dim objfl As Variant\n    Dim rngName As Range\n    Workbooks.Open \"C:\\Users\\Excel\\Desktop\\Excel_to_SQL_Server.xls\"\n    Set wbkOpen = ActiveWorkbook\n    Sheets(\"Sheet1\").Select\n    Set rngName = Range(Range(\"A1\"), Range(\"A1\").End(xlToLeft).End(xlDown))\n    rngName.Name = \"TempRange\"\n    strFileName = wbkOpen.FullName\n    Set cnn = CreateObject(\"ADODB.Connection\")\n    cnn.Open \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp; strFileName &amp; \";Extended Properties=\"\"Excel 12.0 Xml;HDR=Yes\"\";\"\n    nSQL = \"INSERT INTO [odbc;Driver={SQL Server};Server=Server_Name;Database=[Database_Name].[dbo].[TBL]]\"\n    nJOIN = \" SELECT * from [TempRange]\"\n    cnn.Execute nSQL &amp; nJOIN\n    MsgBox \"Uploaded Successfully\"\n    wbkOpen.Close\n    Set wbkOpen = Nothing\n\nEnd Sub\n\nSub InsertInto()\n\n'Declare some variables\nDim cnn As adodb.Connection\nDim cmd As adodb.Command\nDim strSQL As String\n\n'Create a new Connection object\nSet cnn = New adodb.Connection\n\n'Set the connection string\ncnn.ConnectionString = \"Server_Name;Database=Database_Name;Trusted_Connection=True;\"\n\n'Create a new Command object\nSet cmd = New adodb.Command\n\n'Open the connection\ncnn.Open\n'Associate the command with the connection\ncmd.ActiveConnection = cnn\n\n'Tell the Command we are giving it a bit of SQL to run, not a stored procedure\ncmd.CommandType = adCmdText\n\n'Create the SQL\nstrSQL = \"UPDATE TBL SET JOIN_DT = 2013-01-13 WHERE EMPID = 2\"\n\n'Pass the SQL to the Command object\ncmd.CommandText = strSQL\n\n'Open the Connection to the database\ncnn.Open\n\n'Execute the bit of SQL to update the database\ncmd.Execute\n\n'Close the connection again\ncnn.Close\n\n'Remove the objects\nSet cmd = Nothing\nSet cnn = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Here is another idea.</p>\n\n<pre><code>Sub Button_Click()\n'TRUSTED CONNECTION\n    On Error GoTo errH\n\n    Dim con As New ADODB.Connection\n    Dim rs As New ADODB.Recordset\n    Dim strPath As String\n    Dim intImportRow As Integer\n    Dim strFirstName, strLastName As String\n\n    Dim server, username, password, table, database As String\n\n\n    With Sheets(\"Sheet1\")\n\n            server = .TextBox1.Text\n            table = .TextBox4.Text\n            database = .TextBox5.Text\n\n\n            If con.State &lt;&gt; 1 Then\n\n                con.Open \"Provider=SQLOLEDB;Data Source=\" &amp; server &amp; \";Initial Catalog=\" &amp; database &amp; \";Integrated Security=SSPI;\"\n                'con.Open\n\n            End If\n            'this is the TRUSTED connection string\n\n            Set rs.ActiveConnection = con\n\n            'delete all records first if checkbox checked\n            If .CheckBox1 Then\n                con.Execute \"delete from tbl_demo\"\n            End If\n\n            'set first row with records to import\n            'you could also just loop thru a range if you want.\n            intImportRow = 10\n\n            Do Until .Cells(intImportRow, 1) = \"\"\n                strFirstName = .Cells(intImportRow, 1)\n                strLastName = .Cells(intImportRow, 2)\n\n                'insert row into database\n                con.Execute \"insert into tbl_demo (firstname, lastname) values ('\" &amp; strFirstName &amp; \"', '\" &amp; strLastName &amp; \"')\"\n\n                intImportRow = intImportRow + 1\n            Loop\n\n            MsgBox \"Done importing\", vbInformation\n\n            con.Close\n            Set con = Nothing\n\n    End With\n\nExit Sub\n\nerrH:\n    MsgBox Err.Description\nEnd Sub\n</code></pre>\n\n<p>Also, check out the links below.</p>\n\n<p><a href=\"http://www.cnblogs.com/anorthwolf/archive/2012/04/25/2470250.html\" rel=\"nofollow noreferrer\">http://www.cnblogs.com/anorthwolf/archive/2012/04/25/2470250.html</a></p>\n\n<p><a href=\"http://www.excel-sql-server.com/excel-sql-server-import-export-using-vba.htm\" rel=\"nofollow noreferrer\">http://www.excel-sql-server.com/excel-sql-server-import-export-using-vba.htm</a></p>\n"}], "owner": {"reputation": 99, "user_id": 7408078, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e4fac61351f1a4bebc205e64285818dc?s=128&d=identicon&r=PG&f=1", "display_name": "nick", "link": "https://stackoverflow.com/users/7408078/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 6337, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1500639278, "creation_date": 1493191147, "last_edit_date": 1493192132, "question_id": 43627480, "link": "https://stackoverflow.com/questions/43627480/i-need-to-insert-data-into-sql-server-from-excel-using-vba", "title": "I need to insert data into SQL server from Excel using VBA", "body": "<p>I need to insert <code>test-vba.xlsx</code> data into SQL server to the particular database</p>\n\n<pre><code>Sub insertion()\n    Dim conn As ADODB.Connection\n    Dim rs As ADODB.Recordset\n    Dim sConnString As String\n    Dim rsstring As String\n    Dim m, nrows As Integer\n\n    Set wkb = Workbooks(\"test-vba.xlsx\").Worksheets(\"Sheet1\").Activate\n    sConnString = \"Provider=SQLOLEDB;Data Source=PRATEEP-PC\\SQLEXPRESS;\" &amp; _\n                  \"Initial Catalog=PPDS_07Dec_V1_Decomposition;\" &amp; _\n                  \"Integrated Security=SSPI;\"\n    Set conn = New ADODB.Connection\n    Set rs = New ADODB.Recordset\n    conn.Open sConnString\n\n    For m = 0 To nrows - 1\n</code></pre>\n"}, {"tags": ["vba", "excel", "combobox"], "comments": [{"owner": {"reputation": 693, "user_id": 1930374, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/wwGpP.jpg?s=128&g=1", "display_name": "Blenikos", "link": "https://stackoverflow.com/users/1930374/blenikos"}, "edited": false, "score": 0, "creation_date": 1493191560, "post_id": 43627311, "comment_id": 74303699, "body": "Could you please explain a bit more what you want to copy and where to paste it? In your question is not clear enough what you want to do. It feels like information is missing."}, {"owner": {"reputation": 23, "user_id": 7625628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d93ea0839b6f334ff9a0a8ac240028be?s=128&d=identicon&r=PG&f=1", "display_name": "Catherine Jackson", "link": "https://stackoverflow.com/users/7625628/catherine-jackson"}, "reply_to_user": {"reputation": 693, "user_id": 1930374, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/wwGpP.jpg?s=128&g=1", "display_name": "Blenikos", "link": "https://stackoverflow.com/users/1930374/blenikos"}, "edited": false, "score": 0, "creation_date": 1493192703, "post_id": 43627311, "comment_id": 74304470, "body": "I have a masterfile which runs the macros. I receive about 50 subfiles from my friends. I want the details from the subfiles to be copied to the masterfile. The masterfile contains a combobox that has all the dates of Friday&#39;s. The subfiles I receive from my friends have a column with dates for Fridays. What I want is when a date is selected in Masterfile combobox, the macro should look into all the subfiles and when the date is matched the entire row should be copied to the masterfile based on the id of the friend."}, {"owner": {"reputation": 693, "user_id": 1930374, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/wwGpP.jpg?s=128&g=1", "display_name": "Blenikos", "link": "https://stackoverflow.com/users/1930374/blenikos"}, "edited": false, "score": 0, "creation_date": 1493193109, "post_id": 43627311, "comment_id": 74304725, "body": "Ok. It is more clear now. However, it doesn&#39;t match with the description in your question. Please edit and fix your question! Also add where your problem is in the code you gave us (To be honest your code looks ok to me)."}, {"owner": {"reputation": 23, "user_id": 7625628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d93ea0839b6f334ff9a0a8ac240028be?s=128&d=identicon&r=PG&f=1", "display_name": "Catherine Jackson", "link": "https://stackoverflow.com/users/7625628/catherine-jackson"}, "reply_to_user": {"reputation": 693, "user_id": 1930374, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/wwGpP.jpg?s=128&g=1", "display_name": "Blenikos", "link": "https://stackoverflow.com/users/1930374/blenikos"}, "edited": false, "score": 0, "creation_date": 1493193190, "post_id": 43627311, "comment_id": 74304772, "body": "Set finddate = .Range(&quot;A4&quot;, .Range(&quot;A4&quot;).End(xlDown)).Find(Date, lookat:=xlWhole)   Here I am using Date as system time. But I tried passing combobox value there. It didn&#39;t work."}, {"owner": {"reputation": 693, "user_id": 1930374, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/wwGpP.jpg?s=128&g=1", "display_name": "Blenikos", "link": "https://stackoverflow.com/users/1930374/blenikos"}, "edited": false, "score": 0, "creation_date": 1493193335, "post_id": 43627311, "comment_id": 74304843, "body": "So, you want to replace the Date inside the Find() with what the user selected on the combobox, right?"}, {"owner": {"reputation": 23, "user_id": 7625628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d93ea0839b6f334ff9a0a8ac240028be?s=128&d=identicon&r=PG&f=1", "display_name": "Catherine Jackson", "link": "https://stackoverflow.com/users/7625628/catherine-jackson"}, "reply_to_user": {"reputation": 693, "user_id": 1930374, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/wwGpP.jpg?s=128&g=1", "display_name": "Blenikos", "link": "https://stackoverflow.com/users/1930374/blenikos"}, "edited": false, "score": 0, "creation_date": 1493193775, "post_id": 43627311, "comment_id": 74305098, "body": "Yes. Also I was wondering if there was  anyway where all the contents of the comboboxes are displayed when opening the mastersheet? Everytime I open I get only the select date option in the combobox."}, {"owner": {"reputation": 693, "user_id": 1930374, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/wwGpP.jpg?s=128&g=1", "display_name": "Blenikos", "link": "https://stackoverflow.com/users/1930374/blenikos"}, "edited": false, "score": 0, "creation_date": 1493194092, "post_id": 43627311, "comment_id": 74305290, "body": "As far as I know, No, that is not possible."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 7625628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d93ea0839b6f334ff9a0a8ac240028be?s=128&d=identicon&r=PG&f=1", "display_name": "Catherine Jackson", "link": "https://stackoverflow.com/users/7625628/catherine-jackson"}, "edited": false, "score": 0, "creation_date": 1493194311, "post_id": 43628307, "comment_id": 74305411, "body": "I get an error here : selected_date = Activeworkbook.ComboBox1.Value   stating that object doesn&#39;t support this property or method."}, {"owner": {"reputation": 23, "user_id": 7625628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d93ea0839b6f334ff9a0a8ac240028be?s=128&d=identicon&r=PG&f=1", "display_name": "Catherine Jackson", "link": "https://stackoverflow.com/users/7625628/catherine-jackson"}, "edited": false, "score": 0, "creation_date": 1493194452, "post_id": 43628307, "comment_id": 74305493, "body": "<code>Application.ScreenUpdating = False    selected_date = ActiveWorkbook.ComboBox1.Value   Set master = ThisWorkbook.Sheets(&quot;Sheet1&quot;)   lr = master.Range(&quot;B4&quot;).End(xlDown).Row      path = ThisWorkbook.path &amp; &quot;\\&quot;</code>    These are the rest of the contents of my code before for loop"}, {"owner": {"reputation": 693, "user_id": 1930374, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/wwGpP.jpg?s=128&g=1", "display_name": "Blenikos", "link": "https://stackoverflow.com/users/1930374/blenikos"}, "reply_to_user": {"reputation": 23, "user_id": 7625628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d93ea0839b6f334ff9a0a8ac240028be?s=128&d=identicon&r=PG&f=1", "display_name": "Catherine Jackson", "link": "https://stackoverflow.com/users/7625628/catherine-jackson"}, "edited": false, "score": 0, "creation_date": 1493194642, "post_id": 43628307, "comment_id": 74305619, "body": "For the error, my bad, I fixed it now. Please check again. Also add the rest of your code before the for loop in your question!!! It is really difficult to read code in the comments."}], "tags": [], "owner": {"reputation": 693, "user_id": 1930374, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/wwGpP.jpg?s=128&g=1", "display_name": "Blenikos", "link": "https://stackoverflow.com/users/1930374/blenikos"}, "is_accepted": true, "score": 0, "last_activity_date": 1493194532, "last_edit_date": 1493194532, "creation_date": 1493193851, "answer_id": 43628307, "question_id": 43627311, "link": "https://stackoverflow.com/questions/43627311/how-to-pass-data-from-the-combobox-to-commandbutton-in-excel-vba/43628307#43628307", "title": "How to pass data from the combobox to commandbutton in Excel VBA?", "body": "<p>You need to replace the Date function inside the Find function with the value of the combobox.</p>\n\n<p>You have to change the line </p>\n\n<pre><code>Set finddate = .Range(\"A4\", .Range(\"A4\").End(xlDown)).Find(Date, lookat:=xlWhole)\n</code></pre>\n\n<p>and make some modifications in your code:</p>\n\n<pre><code>Dim selected_date as String 'A new variable to store your combobox selection\n\n'Store the selection so you don't have to check for every workbook you open\nselected_date = ActiveWorkbook.Worksheets(1).ComboBox1.Value 'Change the number to the sheet your combobox is\n\n    For Each studentID In master.Range(\"B4:B\" &amp; lr)\n       StrFile = Dir(path &amp; \"timeuti*\" &amp; studentID.Value &amp; \"*.xls*\")\n\n       If Len(StrFile) &gt; 0 Then\n         Set wbtime = Workbooks.Open(path &amp; StrFile, , 1)\n         Set wstime = wbtime.Worksheets(\"Sheet1\")\n\n         With wstime\n\n            'Add here your variable instead of Date\n            Set finddate = .Range(\"A4\", .Range(\"A4\").End(xlDown)). _\n            Find(selected_date, lookat:=xlWhole)\n\n            If Not finddate Is Nothing Then\n                finddate.Offset(, 1).Resize(, 21).Copy studentID.Offset(, 1)\n            End If\n         End With\n         wbtime.Close 0\n       End If\n</code></pre>\n\n<p>If the selection in the combobox is in the same format as dates in the cell of the other workbooks you open and use find on them then it should work. Else check if they are the same format! </p>\n\n<p>If one is in date format and because the other is a String you need to change the format of the date into string in order for this to work.</p>\n"}], "owner": {"reputation": 23, "user_id": 7625628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d93ea0839b6f334ff9a0a8ac240028be?s=128&d=identicon&r=PG&f=1", "display_name": "Catherine Jackson", "link": "https://stackoverflow.com/users/7625628/catherine-jackson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 498, "favorite_count": 0, "accepted_answer_id": 43628307, "answer_count": 1, "score": -1, "last_activity_date": 1493194532, "creation_date": 1493190657, "last_edit_date": 1493190745, "question_id": 43627311, "link": "https://stackoverflow.com/questions/43627311/how-to-pass-data-from-the-combobox-to-commandbutton-in-excel-vba", "title": "How to pass data from the combobox to commandbutton in Excel VBA?", "body": "<p>I have a mastersheet which contains the dates(of every Friday's) in a combobox. In a separate sheet(s) I have the all the dates arranged in rows. I want my mastersheet to read the date from the subsheets and copy all the contents for the matching row.\nCurrently I tried doing it by matching the system date with the date column in the subsheets. But the problem is that I cant run the program on any other day than Friday. So I want to the option to select the date from combobox and then copy the data from the subsheets.</p>\n\n<pre><code>Private Sub ComboBox1_Change()\n  With ComboBox1\n   .AddItem \"Select Date\"\n   .AddItem \"21-Apr-17\"\n   .AddItem \"28-Apr-17\"\n   .AddItem \"5-May-17\"\n   .AddItem \"12-May-17\"\n   .AddItem \"19-May-17\"\n  End With\n End Sub\n</code></pre>\n\n<p>(Content of reconcile button)</p>\n\n<pre><code>For Each studentID In master.Range(\"B4:B\" &amp; lr)\n   StrFile = Dir(path &amp; \"timeuti*\" &amp; studentID.Value &amp; \"*.xls*\")\n   If Len(StrFile) &gt; 0 Then\n     Set wbtime = Workbooks.Open(path &amp; StrFile, , 1)\n     Set wstime = wbtime.Worksheets(\"Sheet1\")\n     With wstime\n        Set finddate = .Range(\"A4\", .Range(\"A4\").End(xlDown)).Find(Date, lookat:=xlWhole)\n        If Not finddate Is Nothing Then\n            finddate.Offset(, 1).Resize(, 21).Copy studentID.Offset(, 1)\n        End If\n    End With\n    wbtime.Close 0\nEnd If\n</code></pre>\n\n<p>MasterSheet: <a href=\"https://i.stack.imgur.com/IvR3J.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IvR3J.jpg\" alt=\"Mastersheet\"></a>\nSubsheets: <a href=\"https://i.stack.imgur.com/JQefc.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JQefc.jpg\" alt=\"Subsheets\"></a></p>\n\n<p>Also is there anyway where all the contents of the comboboxes are displayed when opening the mastersheet? Everytime I open I get only the select date option in the combobox!</p>\n"}, {"tags": ["vba", "excel", "sorting", "match"], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1493309393, "last_edit_date": 1493309393, "creation_date": 1493189009, "answer_id": 43626827, "question_id": 43626584, "link": "https://stackoverflow.com/questions/43626584/set-range-for-sort-function/43626827#43626827", "title": "Set range for sort function", "body": "<p>There's no need to use <code>Select</code> (it only slows down your code run-time), try the code below:</p>\n\n<pre><code>Option Explicit\n\nSub SortRange()\n\nDim v As Variant\nDim Rng As Range\n\nWith Sheet3\n    .Sort.SortFields.Clear\n    v = Application.Match(\"GND\", .Range(\"C:C\"), 0) '&lt;-- make sure Match is not returning an #ERROR\n    Set Rng = .Range(.Range(\"A\" &amp; v &amp; \":K\" &amp; v), .Range(\"A\" &amp; v &amp; \":K\" &amp; v).End(xlDown))\n\n   Rng.Sort Key1:=.Range(\"G\" &amp; v), Order1:=xlDescending, DataOption1:=xlSortNormal\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/IKaG1.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IKaG1.gif\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 239, "user_id": 7789119, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c4b7fad7b429a41386293c7f7bdc43d5?s=128&d=identicon&r=PG&f=1", "display_name": "Rachel Chia", "link": "https://stackoverflow.com/users/7789119/rachel-chia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 499, "favorite_count": 0, "accepted_answer_id": 43626827, "answer_count": 1, "score": 1, "last_activity_date": 1493309393, "creation_date": 1493188135, "last_edit_date": 1493188378, "question_id": 43626584, "link": "https://stackoverflow.com/questions/43626584/set-range-for-sort-function", "title": "Set range for sort function", "body": "<p>I am trying to set the range of the column for the sort function. </p>\n\n<p>However, the range starts from a certain row which i used the match function to find and ends at where ever the cells is empty. How do I go around doing that? </p>\n\n<p>Its on the line: </p>\n\n<pre><code>Sheet3.Sort.SortFields.Add Key:=Range(\"G\" &amp; v &amp; \"G\" &amp; v.End(xlDown)), \n    SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal\n</code></pre>\n\n<p>Thanks for your help in advance!   </p>\n\n<pre><code>Sheet3.Sort.SortFields.Clear\nv = Application.Match(\"GND\", Sheet3.Range(\"C:C\"), 0)\nSheet3.Range(\"A\" &amp; v &amp; \":K\" &amp; v).Select\nSheet3.Range(Selection, Selection.End(xlDown)).Select\nSheet3.Sort.SortFields.Add Key:=Range(\"G\" &amp; v &amp; \"G\" &amp; v.End(xlDown)), \nSortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal\nSheet3.Sort.Apply\n</code></pre>\n"}, {"tags": ["excel", "shape", "vba"], "comments": [{"owner": {"reputation": 7547, "user_id": 6019417, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/nA455.jpg?s=128&g=1", "display_name": "J. Chomel", "link": "https://stackoverflow.com/users/6019417/j-chomel"}, "edited": false, "score": 0, "creation_date": 1493301538, "post_id": 43626073, "comment_id": 74367091, "body": "You should have shown effort before asking. I advise you read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>."}, {"owner": {"reputation": 3, "user_id": 7923312, "user_type": "registered", "profile_image": "https://graph.facebook.com/1518245758209484/picture?type=large", "display_name": "Daniel Avram", "link": "https://stackoverflow.com/users/7923312/daniel-avram"}, "reply_to_user": {"reputation": 7547, "user_id": 6019417, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/nA455.jpg?s=128&g=1", "display_name": "J. Chomel", "link": "https://stackoverflow.com/users/6019417/j-chomel"}, "edited": false, "score": 0, "creation_date": 1493501260, "post_id": 43626073, "comment_id": 74446285, "body": "Sorry, I am not a native english speaker, I would have written this perfect in my language.    Your changes of the text don&#39;t make much sense to me...  Thanks for editing it, and sorry for not paying atention, i was in a hurry."}], "answers": [{"tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": true, "score": 0, "last_activity_date": 1493187444, "creation_date": 1493187444, "answer_id": 43626398, "question_id": 43626073, "link": "https://stackoverflow.com/questions/43626073/move-a-shape-to-the-last-row/43626398#43626398", "title": "Move a shape to the last row", "body": "<p>Place this code on a Standard Module and after writing the data onto the sheet, call this code which will place the button (shape) to the first empty row.\nChange it as per your requirement.</p>\n\n<pre><code>Sub MoveButton()\nDim ws As Worksheet\nDim lr As Long\nDim buttonCell As Range\nDim shp As Shape\nSet ws = Sheets(\"Sheet1\")   'Sheet where shape is inserted\nlr = ws.Cells(Rows.Count, 1).End(xlUp).Row + 1  'first empty row in column A\nSet buttonCell = ws.Cells(lr, \"A\")  'setting the cell where button will be placed\nSet shp = ws.Shapes(\"myShape\")  'name of the shape is \"myShape\", change it as per your requirement\n'set the shape dimensions\nWith shp\n    .Left = buttonCell.Left\n    .Top = buttonCell.Top\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7923312, "user_type": "registered", "profile_image": "https://graph.facebook.com/1518245758209484/picture?type=large", "display_name": "Daniel Avram", "link": "https://stackoverflow.com/users/7923312/daniel-avram"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 806, "favorite_count": 0, "accepted_answer_id": 43626398, "answer_count": 1, "score": 0, "last_activity_date": 1493301538, "creation_date": 1493185970, "last_edit_date": 1531164843, "question_id": 43626073, "link": "https://stackoverflow.com/questions/43626073/move-a-shape-to-the-last-row", "title": "Move a shape to the last row", "body": "<p>I have a macro button assigned to a shape at the end of an Excel table.\nIt opens a user form for adding data to the table.</p>\n\n<p>The problem is that the shape does not move down with every new entry and it eventually comes to be on top of the table.</p>\n\n<p>Shape is set to move with cells, but there are no actual rows inserted, just data added to the end of the table..</p>\n\n<p>How can I make it move with the first empty row with Excel-VBA?</p>\n"}]