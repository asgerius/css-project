[{"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1209, "user_id": 3927703, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/1058356120/picture?type=large", "display_name": "Alex de Jong", "link": "https://stackoverflow.com/users/3927703/alex-de-jong"}, "edited": false, "score": 1, "creation_date": 1521068476, "post_id": 49288950, "comment_id": 85581106, "body": "The answer to your question is: Yes there is! Can you show what you have done so far and where you got stuck?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9494304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94f9528e98c319adb667f90e5b237304?s=128&d=identicon&r=PG", "display_name": "jack", "link": "https://stackoverflow.com/users/9494304/jack"}, "edited": false, "score": 0, "creation_date": 1521108670, "post_id": 49289001, "comment_id": 85595174, "body": "BruceWayne, thank you.  I love it.  Thank you so much! I want to learn VBA, basic things on how to save spreadsheets as pdf, how to print, how to have a bunch of names create the same letters over and over but with different customer.  Any good book you can recommend that can help me with this?  Again thank you."}, {"owner": {"reputation": 3, "user_id": 9494304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94f9528e98c319adb667f90e5b237304?s=128&d=identicon&r=PG", "display_name": "jack", "link": "https://stackoverflow.com/users/9494304/jack"}, "edited": false, "score": 0, "creation_date": 1521836622, "post_id": 49289001, "comment_id": 85918423, "body": "Hello, This macro works great but can I add more to it? for example, I need sheet 2 to be saved as pdf. Then I need another Pdf for sheet 3."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 3, "user_id": 9494304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94f9528e98c319adb667f90e5b237304?s=128&d=identicon&r=PG", "display_name": "jack", "link": "https://stackoverflow.com/users/9494304/jack"}, "edited": false, "score": 0, "creation_date": 1521836815, "post_id": 49289001, "comment_id": 85918522, "body": "@jack - Sorry for the delay in replying to your first comment on the 15th -- Honestly, when I learned (and obviously still am), my &quot;go to tools&quot; are: Macro Recorder in Excel and Google.  I use these to make the best attempts I can, then when I&#39;m stuck I&#39;d come here and ask around. Also there&#39;s <a href=\"http://www.cpearson.com/excel/mainpage.aspx\" rel=\"nofollow noreferrer\">Chip Pearson&#39;s site</a> which I used to frequent."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 3, "user_id": 9494304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94f9528e98c319adb667f90e5b237304?s=128&d=identicon&r=PG", "display_name": "jack", "link": "https://stackoverflow.com/users/9494304/jack"}, "edited": false, "score": 0, "creation_date": 1521836865, "post_id": 49289001, "comment_id": 85918542, "body": "@jack - To your other comment, that&#39;s a new question altogether.  If the macro I posted worked for this specific question, you can mark it as the answer by clicking the check mark left of the post.  If you want to save as PDF, try turning on the macro recorder, saving as PDF, stop the recorder, then check the code it generated."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 0, "last_activity_date": 1521068627, "creation_date": 1521068627, "answer_id": 49289001, "question_id": 49288950, "link": "https://stackoverflow.com/questions/49288950/rename-worksheet-based-on-cell-value/49289001#49289001", "title": "Rename worksheet based on cell value", "body": "<p>Something like this should do the trick (you will need to adjust names as needed):</p>\n\n<pre><code>Sub rename_sheets()\nDim renameCell As Range\nDim mainWS As Worksheet, ws As Worksheet\n\nSet mainWS = Sheets(\"Sheet1\") ' Change as necessary. This is the page with the names you want to use\nSet renameCell = mainWS.Range(\"A1\")\n\n' Change the sheet names below to match the name they are *before* the renaming\nSheets(\"Sheet2\").Name = renameCell.Value &amp; \"-F\"\nSheets(\"Sheet3\").Name = renameCell.Value &amp; \"-E\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9494304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94f9528e98c319adb667f90e5b237304?s=128&d=identicon&r=PG", "display_name": "jack", "link": "https://stackoverflow.com/users/9494304/jack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1959, "favorite_count": 0, "accepted_answer_id": 49289001, "answer_count": 1, "score": -3, "last_activity_date": 1521068627, "creation_date": 1521068273, "last_edit_date": 1531161705, "question_id": 49288950, "link": "https://stackoverflow.com/questions/49288950/rename-worksheet-based-on-cell-value", "title": "Rename worksheet based on cell value", "body": "<p>I have three worksheets in excel which I am using. </p>\n\n<p>First page is where I put all the data so it can populate in sheet 2 and sheet 3. </p>\n\n<p>Sheet 2 and 3 is what I am going to save as pdf. </p>\n\n<p>My question, is there a vba code that will name sheet 2 with the value in cell <code>A1</code> with the letter \"F\" next to it and then page three with the cell value in A1 again but with the letter E next to it? </p>\n\n<p>For e.g. cell <code>A1</code> has Joy Nice, worksheet 2 will be named Joy Nice-F and worksheet 3 will be named Joy Nice-E. And yes I am new to VBA and I love what it can do. Thank you.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1521096088, "post_id": 49288838, "comment_id": 85588456, "body": "you may add a reference to <code>wb</code> as an example, too"}], "tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": false, "score": 0, "last_activity_date": 1521067644, "creation_date": 1521067644, "answer_id": 49288838, "question_id": 49288691, "link": "https://stackoverflow.com/questions/49288691/referencing-data-from-another-workbook-in-an-array/49288838#49288838", "title": "Referencing data from another workbook in an array", "body": "<p>In your first example you are using sheet Code Names, which will reference sheets in the book containing the code, irrespective of if that book is active.</p>\n\n<p>To reference a different workbook, again irrespective of if it's active, create references to the workbook and worksheet objects</p>\n\n<pre><code>Dim MyRangeArray As Variant\nDim wb As Workbook\nDim ws1 As Worksheet\nDim ws2 As Worksheet\n\nSet wb = Application.Workbooks(\"NameOfWorkbook.xlsx\")\nSet ws1 = wb.Worksheets(\"NameOfSheet1\")\nSet ws2 = wb.Worksheets(\"NameOfSheet2\")\nMyRangeArray = Array(ws1.Range(\"RangeAddress1\").Value, ws2.Range(\"RangeAddress2\").Value)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 87, "user_id": 9494250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5cc9d89159bcb0796ac3d917069d025?s=128&d=identicon&r=PG&f=1", "display_name": "Majid", "link": "https://stackoverflow.com/users/9494250/majid"}, "is_accepted": false, "score": 0, "last_activity_date": 1521134384, "creation_date": 1521134384, "answer_id": 49305553, "question_id": 49288691, "link": "https://stackoverflow.com/questions/49288691/referencing-data-from-another-workbook-in-an-array/49305553#49305553", "title": "Referencing data from another workbook in an array", "body": "<p>I resolved the error by doing the following: </p>\n\n<p>Dim r1,r2 as range</p>\n\n<p>r1=ws1.Range(\"RangeAddress1\")\nr2=ws2.Range(\"RangeAddress2\")</p>\n\n<p>Mrangearray=array(r1,r2) </p>\n"}], "owner": {"reputation": 87, "user_id": 9494250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5cc9d89159bcb0796ac3d917069d025?s=128&d=identicon&r=PG&f=1", "display_name": "Majid", "link": "https://stackoverflow.com/users/9494250/majid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 813, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1521134384, "creation_date": 1521066800, "last_edit_date": 1531164843, "question_id": 49288691, "link": "https://stackoverflow.com/questions/49288691/referencing-data-from-another-workbook-in-an-array", "title": "Referencing data from another workbook in an array", "body": "<p>I am currently using the below code to define an array from the active workbook</p>\n\n<pre><code>Dim MyRangeArray As Variant\n\n\nMyRangeArray = Array(Sheet1.Range(\"A4:N19\"), Sheet2.Range(\"A4:N19\"))\n</code></pre>\n\n<p>I want this array to reference data from another workbook instead of the workbook which has the code. The result i am looking for is: </p>\n\n<pre><code>MyRangeArray= Array(Wb1.sheets.RangeX,wb2.sheets.rangeX)\n</code></pre>\n\n<p>Can somebody help? </p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1521068901, "post_id": 49288297, "comment_id": 85581208, "body": "<a href=\"http://www.cpearson.com/Excel/DebuggingVBA.aspx\" rel=\"nofollow noreferrer\">Debug</a> your code. Then you&#39;ll see that Dimensions doesn&#39;t return exactly what you expected. <a href=\"https://www.techonthenet.com/excel/macros/vba_debug2013.php\" rel=\"nofollow noreferrer\">This</a> may help too."}], "answers": [{"comments": [{"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1521071997, "post_id": 49289395, "comment_id": 85582131, "body": "You have tested <code>val(Xdim)</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5326167"}, "reply_to_user": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1521120838, "post_id": 49289395, "comment_id": 85603354, "body": "Yes. Val() function will return 0 for any non-numeric string and will not produce an error."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1521123949, "post_id": 49289395, "comment_id": 85605805, "body": "But doesn&#39;t return expected value (close to <code>On Error Resume Next</code>without thinking). With if condition you know something wrong and you can handle that, so I would prefer that of the two. Did you find his coding error? Then provide this instead as solution."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1521133908, "post_id": 49289395, "comment_id": 85613008, "body": "But didn&#39;t find the error in code. Look at the value of <code>objFile.ExtendedProperty(&quot;Dimensions&quot;) </code> this causes the error (an unexpected character at the beginning). That&#39;s why <code>Xdim</code>is not a number."}, {"owner": {"reputation": 29, "user_id": 9494146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04456e8c55abbffa1f42c2bdb1272e0e?s=128&d=identicon&r=PG&f=1", "display_name": "J Smith", "link": "https://stackoverflow.com/users/9494146/j-smith"}, "edited": false, "score": 0, "creation_date": 1521140457, "post_id": 49289395, "comment_id": 85616680, "body": "I&#39;m not seeing the leading character. When i run it through the built-in debugger, i get the following results...   ImgSize -&gt; &quot;\u202a700 x 932\u202c&quot;  strarray -&gt; (0 To 1) As String  Xdim -&gt; &quot;\u202a700&quot;"}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1521141330, "post_id": 49289395, "comment_id": 85617127, "body": "On <code>Ms-Access</code> I get<code>?700 x 187?</code>for a BMP. What app did you use? Another point for using<code>WIA</code>instead."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5326167"}, "is_accepted": false, "score": 1, "last_activity_date": 1521133012, "last_edit_date": 1521133012, "creation_date": 1521071365, "answer_id": 49289395, "question_id": 49288297, "link": "https://stackoverflow.com/questions/49288297/visual-basic-cint-error/49289395#49289395", "title": "Visual Basic CInt error", "body": "<p>First check if value can be converted to an integer: </p>\n\n<pre><code> If IsNumeric(Trim(Xdim)) then \n   Int1 = CInt(Xdim)\n else\n   'for debug purposes\n   MsgBox (\"XDim non-numeric or empty\")\n End If \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1521141801, "post_id": 49307647, "comment_id": 85617363, "body": "Did you move the mouse over <code>ImgSize</code> when code breaks into error as my links suggested? I have a leading and ending <code>?</code>char that causes the error."}], "tags": [], "owner": {"reputation": 29, "user_id": 9494146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04456e8c55abbffa1f42c2bdb1272e0e?s=128&d=identicon&r=PG&f=1", "display_name": "J Smith", "link": "https://stackoverflow.com/users/9494146/j-smith"}, "is_accepted": false, "score": 0, "last_activity_date": 1521141591, "creation_date": 1521141591, "answer_id": 49307647, "question_id": 49288297, "link": "https://stackoverflow.com/questions/49288297/visual-basic-cint-error/49307647#49307647", "title": "Visual Basic CInt error", "body": "<p>Ok, i couldnt find what character was causing the issue, so i used this loop of code to pull out only numbers, and it seems to work.</p>\n\n<pre><code>For X = 1 To Len(Xdim)\n    If IsNumeric(Mid(Xdim, X, 1)) = True Then\n       holder = holder &amp; Mid(Xdim, X, 1)\n    End If\nNext X\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "is_accepted": false, "score": 0, "last_activity_date": 1521144345, "last_edit_date": 1521144345, "creation_date": 1521143988, "answer_id": 49308213, "question_id": 49288297, "link": "https://stackoverflow.com/questions/49288297/visual-basic-cint-error/49308213#49308213", "title": "Visual Basic CInt error", "body": "<p>Here the <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms630368(v=vs.85).aspx\" rel=\"nofollow noreferrer\">WIA</a> version:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Function ImgXDim(filename As String) As Long        \n     Dim imgWIA as New WIA.ImageFile 'Early Binding needs a reference to Windows Image Aquisition Library in VBA-Ide-&gt;Tools-&gt;References\n    'Dim imgWIA as Object 'Late Bound Version\n    'Set imgWIA = CreateObject(\"WIA.ImageFile\")\n    imgWIA.LoadFile MacroDir &amp; \"\\PICS\\\" &amp; filename\n    ImgXDim = imgWIA.Width ' use .Height for height\nEnd Function\n</code></pre>\n\n<p>As you see, just three lines of code and returns a long, not a string that needs parsing.</p>\n\n<p>Useful functions for <a href=\"https://www.devhut.net/2017/01/18/vba-resize-image/\" rel=\"nofollow noreferrer\">resize</a>, <a href=\"https://www.devhut.net/2017/05/14/vba-wia-rotate-an-image/\" rel=\"nofollow noreferrer\">rotate</a> and more.</p>\n\n<p>Also useful if you want to display Tiffs in a picture control (page by page) and more.</p>\n"}], "owner": {"reputation": 29, "user_id": 9494146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04456e8c55abbffa1f42c2bdb1272e0e?s=128&d=identicon&r=PG&f=1", "display_name": "J Smith", "link": "https://stackoverflow.com/users/9494146/j-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1389, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1521144345, "creation_date": 1521064781, "last_edit_date": 1521096298, "question_id": 49288297, "link": "https://stackoverflow.com/questions/49288297/visual-basic-cint-error", "title": "Visual Basic CInt error", "body": "<p>I am trying to make a function that looks at an image, and return the X pixel value. </p>\n\n<p>When i run the code, it throws an error on the Int1=CInt(Xdim) line, saying \"Type Mismatch (10080)\"</p>\n\n<p>If i hard-code the value i am testing into Xdim, it works fine. </p>\n\n<pre><code>Function ImgXDim(filename As String) As Integer         ' Finds the X dimension in pixels of a loaded image\nDim objShell As Object\nDim objFolder As Object\nDim objFile As Object\nDim ImgSize As String\nDim Int1 As Integer\nDim Xdim As String\nDim strarray() As String\n\nSet objShell = CreateObject(\"Shell.Application\")\n\nSet objFolder = objShell.NameSpace(MacroDir &amp; \"\\PICS\\\")\nSet objFile = objFolder.ParseName(filename)\n\nImgSize = objFile.ExtendedProperty(\"Dimensions\")        ' Returns string of \"700 x 923\"\n\nstrarray = Split(ImgSize, \" x \")                        ' Split into 2 strings of \"700\" and \"923\"\nXdim = CStr(strarray(0))                                ' Force Xdim to be a string of \"700\"\nInt1 = CInt(Xdim)                                       ' Convert Xdim to an integer\nImgXDim = Int1                                          ' Return Integer\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "dictionary", "text"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1521099336, "post_id": 49287919, "comment_id": 85589851, "body": "What is your &#39;dictionary&#39; - a worksheet? You want to export data to a tab delimited text file? Did you consider Excel SaveAs?"}], "answers": [{"comments": [{"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1521066250, "post_id": 49288101, "comment_id": 85580301, "body": "@Koda,  did this solution not work for you?"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 3, "last_activity_date": 1521063838, "creation_date": 1521063838, "answer_id": 49288101, "question_id": 49287919, "link": "https://stackoverflow.com/questions/49287919/print-vba-dictionary-into-text-file/49288101#49288101", "title": "Print VBA dictionary into text file", "body": "<pre><code>'Defining text file variable\nDim FilePath As String\n\n'Text file path\n FilePath = path &amp; \"\\OrderStatus.txt\"\n\nDim key As Variant\n'Open the text file\nOpen FilePath For Output As #1\nWith OrderStatus\n    For Each key In .keys\n        Write #1, key &amp; \u201c,\u201d &amp; .Item(key)\n    Next\nEnd With\nClose #1\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 1, "creation_date": 1521225922, "post_id": 49288312, "comment_id": 85657016, "body": "just FYI, I had to do something similar to this recently with hundreds of thousands of rows and it&#39;s <i>significantly</i> quicker to fill a variant with each line and print to the output just once, i.e. <code>Print #1, Join(v, vbCrLf)</code>."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1521226379, "post_id": 49288312, "comment_id": 85657261, "body": "@CallumDA  ..............that is a super good idea!"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 3, "last_activity_date": 1521069414, "last_edit_date": 1521069414, "creation_date": 1521064837, "answer_id": 49288312, "question_id": 49287919, "link": "https://stackoverflow.com/questions/49287919/print-vba-dictionary-into-text-file/49288312#49288312", "title": "Print VBA dictionary into text file", "body": "<p>Consider:</p>\n\n<pre><code>Sub Webster()\n    Dim dict As Object\n    Set dict = CreateObject(\"Scripting.Dictionary\")\n\n    dict.Add \"winken\", 1\n    dict.Add \"blinken\", 2\n    dict.Add \"nod\", 3\n\n    Close #1\n    Open \"C:\\TestFolder\\TestFile.txt\" For Output As #1\n\n    For Each ky In dict.keys\n        Print #1, ky &amp; \" \" &amp; dict(ky)\n    Next ky\n\n    Close #1\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/Jr0xt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Jr0xt.png\" alt=\"enter image description here\"></a></p>\n\n<p><em>(You can replace the space with a tab if you prefer.)</em></p>\n"}], "owner": {"reputation": 133, "user_id": 5167048, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bac8dafe8045bb40c9d88a4be91e4bcf?s=128&d=identicon&r=PG&f=1", "display_name": "Koda", "link": "https://stackoverflow.com/users/5167048/koda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 878, "favorite_count": 1, "closed_date": 1521103573, "accepted_answer_id": 49288101, "answer_count": 2, "score": 1, "last_activity_date": 1521069414, "creation_date": 1521062956, "last_edit_date": 1531164843, "question_id": 49287919, "link": "https://stackoverflow.com/questions/49287919/print-vba-dictionary-into-text-file", "closed_reason": "Needs more focus", "title": "Print VBA dictionary into text file", "body": "<p>Is there a way to print a dictionary into a text?  I have a dictionary with 100+ keys and would like to print it into a tab delimited text file if possible.  This seems so simple but I cannot figure it out--i.e. I am new VBA user.</p>\n\n<pre><code>'Defining text file variable\nDim FilePath As String\n\n'Text file path\n FilePath = path &amp; \"\\OrderStatus.txt\"\n\n'Open the text file\nOpen FilePath For Output As #1\n'OrderStatus is the dictionary\nWrite #1, OrderStatus\n\nClose #1\n</code></pre>\n"}, {"tags": ["vba", "excel", "ms-word"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 3, "creation_date": 1521063419, "post_id": 49287798, "comment_id": 85579114, "body": "It&#39;s strange how all the scraping questions come in at once. My standard answer: <i>**Welcome to Stack Overlow!</i> &quot;How to scrape web pages?&quot; is one of the most common Excel/VBA questions on this site (close to 1000 questions &amp; answers) and elsewhere. I find it hard to believe that you&#39;ve exhausted all <a href=\"https://stackoverflow.com/search?q=scrape+excel\">options</a> before posting. Please see the <a href=\"https://stackoverflow.com/help/on-topic\">help center</a> and also &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; and <a href=\"https://codeblog.jonskeet.uk/writing-the-perfect-question/\" rel=\"nofollow noreferrer\">these tips</a> and also: <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. If you run into a problem not covered elsewhere, <a href=\"https://stackoverflow.com/posts/49287798/edit\">edit</a> your post.*Good Luck*"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521063541, "post_id": 49287798, "comment_id": 85579177, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/27066963/scraping-data-from-website-using-vba\">Scraping data from website using vba</a>"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521068238, "post_id": 49287798, "comment_id": 85581023, "body": "@ashleedawg looks to me like web scraping is incidental to the Q.  Real Q is about accessing an array with named columns"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1521068386, "post_id": 49287798, "comment_id": 85581077, "body": "@loael your function look ok to me as is.  But if you really want to improve it, look into using a Class.  You could then create a Method that accepts a row number and column name, returns the required data.  Its call might look like <code>strPostalCode = Clients.GetData(1, &quot;Addresses&quot;)</code>"}], "owner": {"reputation": 21, "user_id": 9201539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a16a4fa1cdc4c54efe981df62803cc39?s=128&d=identicon&r=PG&f=1", "display_name": "loael", "link": "https://stackoverflow.com/users/9201539/loael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1530, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521062708, "creation_date": 1521062364, "last_edit_date": 1531164843, "question_id": 49287798, "link": "https://stackoverflow.com/questions/49287798/vba-how-to-refer-to-column-names-in-array", "title": "VBA - How to refer to column names in Array?", "body": "<p>To start, I have a scraping function that scrapes a table from a web page, and stores the data in a 2D array. </p>\n\n<p>The 2D array starts from row 0 to however many rows of data are on the page, and columns 1 to however many columns there are. </p>\n\n<p>Row 0 simply contains all the column names.</p>\n\n<p>My ReDim:</p>\n\n<pre><code>ReDim Addresses(0 To lngTotalRecords, 1 To columns.Count) As String\n</code></pre>\n\n<p>I've then stored this 2D array into a scripting dictionary called dictClients, as there are multiple clients that all have their own entries for the same table on the web page.</p>\n\n<p>So in my dictionary I have something like the following to refer to a particular address table for a particular client: </p>\n\n<pre><code>dictClients(1)(\"Addresses\")\ndictClients(2)(\"Addresses\")\n</code></pre>\n\n<p>I now want to be able to check if a cell in a certain row contains a specific value, however the web page allows the columns to be reorganized so that:</p>\n\n<pre><code>dictClients(1)(\"Addresses\")(1,1) 'row 1 column 1\n</code></pre>\n\n<p>will not always refer to the \"Street Number\" column. The street number column could be the following for someone else for example:</p>\n\n<pre><code>dictClients(1)(\"Addresses\")(1,3) ' row 1 column 3\n</code></pre>\n\n<p>Given that these cells:</p>\n\n<pre><code>dictClients(1)(\"Addresses\")(0,1) '(0,2) (0,3) etc.\n</code></pre>\n\n<p>all refer to the column's names, what's the best way for me to find the position of a particular named column?</p>\n\n<p>Example: I want to get the value of the Postal Code cell in row 1, so I need to look in \n<code>dictClients(1)(\"Addresses\")(1, POSTALCODECOLUMN)</code>, \nwhich isn't always in the same position on the web page.</p>\n\n<p>I was thinking of using the following function:</p>\n\n<pre><code>Public Function column(strArr() As String, strColumnName As String)\nDim i As Long\nFor i = 1 To UBound(strArr, 2)\nIf strArr(0, i) = strColumnName Then column = i\nNext\nEnd Function\n</code></pre>\n\n<p>But it just feels so lengthy calling it like:</p>\n\n<pre><code>strPostalCode = \ndictClients(1)(\"Addresses\")(1,column(dictClients(1)(\"Addresses\"), \"Postal Code\")\n</code></pre>\n\n<p>Is there a better and easier way to do this?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["html", "vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 8397270, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l9Yiz.jpg?s=128&g=1", "display_name": "Boris", "link": "https://stackoverflow.com/users/8397270/boris"}, "is_accepted": false, "score": 0, "last_activity_date": 1521062713, "creation_date": 1521062713, "answer_id": 49287858, "question_id": 49287722, "link": "https://stackoverflow.com/questions/49287722/html-texttext-formatting-in-excel/49287858#49287858", "title": "HTML textText formatting in excel", "body": "<ol>\n<li>Press: Alt + F11</li>\n<li>Press: Control + F</li>\n<li>Select: Current Project</li>\n<li>Find what type: \"sample\"</li>\n</ol>\n\n<p>I hope that works for you. Let me know if it doesn't.</p>\n"}], "owner": {"reputation": 1, "user_id": 9494016, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Niels Anton Friis", "link": "https://stackoverflow.com/users/9494016/niels-anton-friis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521064158, "creation_date": 1521062031, "last_edit_date": 1521064158, "question_id": 49287722, "link": "https://stackoverflow.com/questions/49287722/html-texttext-formatting-in-excel", "title": "HTML textText formatting in excel", "body": "<p>Noob problem here. I needed to format some text some Excel cells containing content pulled from other cells. Thought an easy fix might be HTML. I found this need piece of code in another post (so not mine)</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Sample()\nDim Ie As Object\n\nSet Ie = CreateObject(\"InternetExplorer.Application\")\n\nWith Ie\n    .Visible = False\n\n    .Navigate \"about:blank\"\n\n    .document.body.InnerHTML = Sheets(\"Sheet1\").Range(\"A1\").Value\n\n    .document.body.createtextrange.execCommand \"Copy\"\n    ActiveSheet.Paste Destination:=Sheets(\"Sheet1\").Range(\"A1\")\n\n    .Quit\nEnd With\nEnd Sub\n</code></pre>\n\n<p>It worked super, but I ended up deciding to explore other options. Now, however, the macro is 'stuck in my Excel'. I can't for the love of me figure out where it is hiding, not in the macro list or anywhere that I can find in the VB interface. But it is still working in all sheets I pull up. I hate to have let some little creature loose in my spreadsheets, how do I kill it?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521063706, "post_id": 49287547, "comment_id": 85579251, "body": "<b><i>Welcome to Stack Overlow!!</i> How to scrape web pages?&quot;</b> is one of the most common Excel/VBA questions on this site (close to 1000 questions &amp; answers) and elsewhere. I find it hard to believe that you&#39;ve exhausted all options (<a href=\"https://stackoverflow.com/search?q=scrape+excel\">starting here</a> before posting. Please see the <a href=\"https://stackoverflow.com/help/on-topic\">help center</a> and also &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; and <a href=\"https://codeblog.jonskeet.uk/writing-the-perfect-question/\" rel=\"nofollow noreferrer\">these tips</a> and also: <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. If you run into a problem not covered elsewhere, <a href=\"https://stackoverflow.com/posts/49287547/edit\">edit</a> your post.*Good Luck*"}, {"owner": {"reputation": 1, "user_id": 9493931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bfdfe32e381bff031209ec15587dc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Jyuu", "link": "https://stackoverflow.com/users/9493931/jyuu"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521146312, "post_id": 49287547, "comment_id": 85619737, "body": "Thanks for your reply, i posted this out of a last resort, as you mentioned, there is close to 1000 questions above scraping websites, but very little addresses the crashes behind it, and those that addresses it, i&#39;ve tried them. But advise taken, i&#39;ve cut down unncessary codes and left only the bare bones of code needed to scrape, but still sees crashes from I.E."}], "owner": {"reputation": 1, "user_id": 9493931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bfdfe32e381bff031209ec15587dc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Jyuu", "link": "https://stackoverflow.com/users/9493931/jyuu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521146200, "creation_date": 1521061223, "last_edit_date": 1531164843, "question_id": 49287547, "link": "https://stackoverflow.com/questions/49287547/i-e-kept-crashing-under-excel-vba", "title": "I.E. kept crashing under excel vba", "body": "<p>first time asking questions, so pardon for me if i missed anything obvious. Searched high and low but couldn't find a fix for my problem...</p>\n\n<p>After running the code below for like 15 rows, the IE crashes with an error of this :\n<a href=\"https://i.stack.imgur.com/KeQ2I.png\" rel=\"nofollow noreferrer\">Like this</a></p>\n\n<p>I tried slowing down the script as you can see below multiple times, tried changing to InternetExplorerMedium but still it runs into this problem.\nI haven't tried changing to xmlHttp way of calling internet explorer, just because i don't really want to re-write everything above.</p>\n\n<p>The purpose of this code is to scrape facebook's review ratings (slowly).\nThanks.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n'Import Review\nDim appIE As Object\nSet appIE = New InternetExplorerMedium\n'Set appIE = CreateObject(\"internetexplorer.application\")\n\nlastRow = Range(\"B\" &amp; Rows.Count).End(xlUp).Row\nbenchmarkRating = 4.245 'review benchmark\n\nlastData = Range(\"J\" &amp; Rows.Count).End(xlUp).Row\n\nFor reviewHandle = lastData + 1 To lastRow\n\n    Dim brand As String: brand = ActiveSheet.Cells(reviewHandle, 2)\n    Dim homepage As String: homepage = \"https://www.facebook.com/pg/\"\n    With appIE\n        .navigate homepage &amp; brand &amp; \"/reviews/\"\n        .Visible = False\n        'For i = 0 To 4\n        '   DoEvents\n          ' Application.Wait (Now + TimeValue(\"0:00:01\"))\n        'Next i\n    End With\n\n    Do While appIE.Busy\n       DoEvents\n    Loop\n\n    'Do Calculations.....\n\n    'Application.Wait (Now + TimeValue(\"0:00:\" &amp; Int((6 - 1 + 1) * Rnd + 1)))\nNext reviewHandle\n\n\nActiveSheet.Cells(reviewHandle, 2) = \"Report executed on \" &amp; Now\n\nappIE.Quit\nSet appIE = Nothing\nApplication.StatusBar = \"Extract Complete\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3393, "user_id": 2373410, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/684a479ecdc16beb9c6ddd01073f2fee?s=128&d=identicon&r=PG", "display_name": "Pangu", "link": "https://stackoverflow.com/users/2373410/pangu"}, "edited": false, "score": 0, "creation_date": 1521061376, "post_id": 49287520, "comment_id": 85578138, "body": "I forgot to mention I did attempt to perform <code>Set mySubFrm = subFrm</code> but that also resulted in the same error"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 3393, "user_id": 2373410, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/684a479ecdc16beb9c6ddd01073f2fee?s=128&d=identicon&r=PG", "display_name": "Pangu", "link": "https://stackoverflow.com/users/2373410/pangu"}, "edited": false, "score": 0, "creation_date": 1521061616, "post_id": 49287520, "comment_id": 85578255, "body": "Then provide the code for that attempt, since that shouldn&#39;t generate this error."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 3393, "user_id": 2373410, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/684a479ecdc16beb9c6ddd01073f2fee?s=128&d=identicon&r=PG", "display_name": "Pangu", "link": "https://stackoverflow.com/users/2373410/pangu"}, "edited": false, "score": 0, "creation_date": 1521062330, "post_id": 49287520, "comment_id": 85578614, "body": "@Pangu see my answer for the full explanation. Erik&#39;s answer is correct."}, {"owner": {"reputation": 3393, "user_id": 2373410, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/684a479ecdc16beb9c6ddd01073f2fee?s=128&d=identicon&r=PG", "display_name": "Pangu", "link": "https://stackoverflow.com/users/2373410/pangu"}, "edited": false, "score": 0, "creation_date": 1521062567, "post_id": 49287520, "comment_id": 85578737, "body": "@ErikvonAsmuth <code>Set mySubFrm = subFrm</code> alone as mentioned did result in the same compile error, but I also had to perform <code>Set testSubForm = mySubFrm(&quot;testForm&quot;, &quot;testSubForm&quot;)</code>, your answer pointed me in the right direction..upvoted and marked"}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 2, "last_activity_date": 1521061144, "creation_date": 1521061144, "answer_id": 49287520, "question_id": 49287399, "link": "https://stackoverflow.com/questions/49287399/receiving-invalid-use-of-property-error-when-returning-a-data-type-from-a-func/49287520#49287520", "title": "Receiving &#39;Invalid Use of Property&#39; error when returning a data type from a function in VBA Access?", "body": "<p>You receive the error because you're trying to set an object, but are not using the <code>Set</code> keyword.</p>\n\n<p>Perhaps it should be the following:</p>\n\n<pre><code>Set mySubFrm = subFrm\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>Set mySubFrm = frmDatasheet\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3393, "user_id": 2373410, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/684a479ecdc16beb9c6ddd01073f2fee?s=128&d=identicon&r=PG", "display_name": "Pangu", "link": "https://stackoverflow.com/users/2373410/pangu"}, "edited": false, "score": 0, "creation_date": 1521062618, "post_id": 49287784, "comment_id": 85578755, "body": "thanks for the explanation, Erik did point me in the right direction but voted yours also for the clear explanation"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 3393, "user_id": 2373410, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/684a479ecdc16beb9c6ddd01073f2fee?s=128&d=identicon&r=PG", "display_name": "Pangu", "link": "https://stackoverflow.com/users/2373410/pangu"}, "edited": false, "score": 3, "creation_date": 1521062723, "post_id": 49287784, "comment_id": 85578809, "body": "@Pangu my pleasure. VBA compile errors are easily confusing, with all the implicit voodoo constantly happening. You can find a type&#39;s default property in the object browser (F2) - it&#39;s the property with the little blue dot (in some cases it&#39;s a hidden member!)."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 4, "last_activity_date": 1521077691, "last_edit_date": 1521077691, "creation_date": 1521062305, "answer_id": 49287784, "question_id": 49287399, "link": "https://stackoverflow.com/questions/49287399/receiving-invalid-use-of-property-error-when-returning-a-data-type-from-a-func/49287784#49287784", "title": "Receiving &#39;Invalid Use of Property&#39; error when returning a data type from a function in VBA Access?", "body": "<p>I don't know much Access, but I know VBA pretty well.</p>\n\n<p>Your function is returning an object reference:</p>\n\n<blockquote>\n<pre><code>Public Function mySubFrm(name As String, subformName As String) As SubForm\n</code></pre>\n</blockquote>\n\n<p>As such, its return value <strong>must</strong> be assigned using the <code>Set</code> keyword:</p>\n\n<pre><code>Set mySubFrm = subFrm\n</code></pre>\n\n<p>The reason why you're getting this confusing error, is because of a lovely (not!) thing in VBA called <em>default properties</em>.</p>\n\n<p>See, a form has a <em>default property</em>, most likely its <code>Controls</code> collection - and that property is only exposing a <code>Public Property Get</code> accessor, which makes it read-only.</p>\n\n<p>So when you omit the <code>Set</code> keyword:</p>\n\n<pre><code>mySubFrm = subFrm\n</code></pre>\n\n<p>VBA assumes the code is legal, and so the only thing you could possibly be wanting to do, is to assign that default property - in other words, it's behaving exactly as if you would have written:</p>\n\n<pre><code>mySubFrm.Controls = subFrm\n</code></pre>\n\n<p>But the <code>Controls</code> class' own default property is its <code>Item</code> member, which is also read-only: there's no way the default <code>Controls</code> property can appear on the left-hand side of an assignment.</p>\n\n<p>Hence, <em>invalid use of property</em>.</p>\n\n<p>My open-source project <a href=\"http://rubberduckvba.com\" rel=\"nofollow noreferrer\">Rubberduck</a> will soon have an inspection that will issue a result whenever you're implicitly referring to an object's default property, offering to make the call explicit. Writing code that <em>says what it does, and does what it says</em> is hard when you don't even know you're referring to a default property.</p>\n"}, {"tags": [], "owner": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "is_accepted": false, "score": 1, "last_activity_date": 1521116041, "creation_date": 1521116041, "answer_id": 49299207, "question_id": 49287399, "link": "https://stackoverflow.com/questions/49287399/receiving-invalid-use-of-property-error-when-returning-a-data-type-from-a-func/49299207#49299207", "title": "Receiving &#39;Invalid Use of Property&#39; error when returning a data type from a function in VBA Access?", "body": "<p>I would like to suggest a different approach. Typically when you create a form with a subform, it's quite rare that you actually need the subform to be dynamic. There is almost always a relationship between the parent form and the child form, and I would consider a parent form without its child a broken object in general.</p>\n\n<p>Therefore, when I need to access things that's on the subform, I prefer to use the explicit version:</p>\n\n<pre><code>Dim mySubForm As Access.SubForm\nSet mySubForm = Me.Controls(\"mySubForm\").Form\n\nmySubForm.SomeControlOnMySubForm.Value = 123\n</code></pre>\n\n<p>Yes it's 3 lines now but the advantage is that the reference to a <em>specific</em> form is now made explicit in your parent form. You now can see from the code that the parent form <em>depends</em> on <em>that</em> subform. More importantly, if you delete or rename the control <code>SomeControlOnMySubform</code>, the above form will allow the VBA compiler to warn you that there is no such object on the subform, enabling you to verify your code.</p>\n\n<p>In other words, try your best to convert any potential runtime errors into compile-time errors because compile-time errors are much easier to validate and prevent than runtime errors.</p>\n\n<p>The same principle works in the reverse; when you want to describe your subform as explicitly depending on a parent form, you can do:</p>\n\n<pre><code>Dim myParent As Form_frmParent\nSet myParent = Me.Parent\n</code></pre>\n\n<p>NOTE: The code all assumes that there are code-behinds for all forms involved. If a form has no code-behind, it won't have a VBA class for you to reference. In such case, I set the form's property <code>HasModule</code> (located in the <code>Others</code> tab) to <code>Yes</code> even if there's ultimately no code-behind. (The reason is that it used to be that you could create \"lightweight\" form by creating it with no code-behind but with modern hardware, there is hardly any difference)</p>\n"}], "owner": {"reputation": 3393, "user_id": 2373410, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/684a479ecdc16beb9c6ddd01073f2fee?s=128&d=identicon&r=PG", "display_name": "Pangu", "link": "https://stackoverflow.com/users/2373410/pangu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 329, "favorite_count": 0, "accepted_answer_id": 49287520, "answer_count": 3, "score": 1, "last_activity_date": 1594636684, "creation_date": 1521060644, "last_edit_date": 1594636684, "question_id": 49287399, "link": "https://stackoverflow.com/questions/49287399/receiving-invalid-use-of-property-error-when-returning-a-data-type-from-a-func", "title": "Receiving &#39;Invalid Use of Property&#39; error when returning a data type from a function in VBA Access?", "body": "<p>I've created a function that attempts to return a <code>SubForm</code> data type. This function is used by various parent <code>Forms</code>.</p>\n\n<p>The function looks like this:</p>\n\n<pre><code>Public Function mySubFrm(name As String, subformName As String) As SubForm\n\n    Dim frm As Form\n    Dim subFrm As SubForm\n\n    Set frm = Forms(name)\n    Set subFrm = frm.Controls(subformName)\n\n    mySubFrm = subFrm\n\nEnd Function\n</code></pre>\n\n<p>I've attempted to use it by the following:</p>\n\n<pre><code>Dim testSubForm As SubForm\n\ntestSubForm = mySubFrm(\"testForm\", \"testSubForm\")\n</code></pre>\n\n<p>Immediately, it follows with compile error:</p>\n\n<blockquote>\n  <p>Invalid use of property</p>\n</blockquote>\n\n<p>What I've attempted to do was add a watch at <code>frm.Controls(subformName)</code> and I see its return type is <code>SubForm/SubForm</code>, so I feel as though I am declaring and setting the right data type, but then again I'm not sure?</p>\n\n<p>Can someone assist me with what I'm not doing properly?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel", "class"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1521065792, "post_id": 49287139, "comment_id": 85580130, "body": "It is an interesting question but it would be helpful if you give a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> which illustrates the problem. Include a mock class definition and a calling sub which will allow others to reproduce the problem."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 3, "creation_date": 1521067213, "post_id": 49287139, "comment_id": 85580681, "body": "Have you tried simply <code>CallByName MobClass, TargetData, vbLet, (Value)</code>"}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1521067365, "post_id": 49287139, "comment_id": 85580734, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/49266239/vba-callbyname-wont-accept-variant-arguments\">VBA - CallByName won&#39;t accept variant arguments</a>"}, {"owner": {"reputation": 55, "user_id": 9362561, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-aZD136WAV2c/AAAAAAAAAAI/AAAAAAAAAqk/zgvKTxY019Q/photo.jpg?sz=128", "display_name": "Leo Steeves", "link": "https://stackoverflow.com/users/9362561/leo-steeves"}, "edited": false, "score": 0, "creation_date": 1521079296, "post_id": 49287139, "comment_id": 85583857, "body": "Oh my god. I can&#39;t tell you how many times just putting brackets around something to evaluate it has saved me in VBA. Thanks!"}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1521082378, "post_id": 49287139, "comment_id": 85584550, "body": "@Rory, can you explain why this prevents the error?"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "reply_to_user": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 1, "creation_date": 1521082496, "post_id": 49287139, "comment_id": 85584578, "body": "@ComputerVersteher the brackets force the parameter to be passed <code>ByVal</code> This in turn causes the value to be type cast to the expect type."}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 9362561, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-aZD136WAV2c/AAAAAAAAAAI/AAAAAAAAAqk/zgvKTxY019Q/photo.jpg?sz=128", "display_name": "Leo Steeves", "link": "https://stackoverflow.com/users/9362561/leo-steeves"}, "edited": false, "score": 0, "creation_date": 1521147374, "post_id": 49294712, "comment_id": 85620256, "body": "If I understand this correctly I would have to create a new class for every <code>Let</code> property in my Mob class. This isn&#39;t ideal since I have around 15 different values in the class (although not all of them need to be changed at once). This does answer the question though but my original question was answered by @Rory which I think is a simpler solution."}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 55, "user_id": 9362561, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-aZD136WAV2c/AAAAAAAAAAI/AAAAAAAAAqk/zgvKTxY019Q/photo.jpg?sz=128", "display_name": "Leo Steeves", "link": "https://stackoverflow.com/users/9362561/leo-steeves"}, "edited": false, "score": 0, "creation_date": 1521183996, "post_id": 49294712, "comment_id": 85631257, "body": "@LeoSteeves, you understood correctly. So see edited code to have only one helper class that holds all shared properties between all <code>Mob</code> class instances. Now you have minimal code burden and high flexibity"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 1, "last_activity_date": 1521183892, "last_edit_date": 1521183892, "creation_date": 1521102966, "answer_id": 49294712, "question_id": 49287139, "link": "https://stackoverflow.com/questions/49287139/vba-assign-a-value-to-multiple-classes-at-once-property-let/49294712#49294712", "title": "VBA - Assign a value to multiple classes at once (Property Let)", "body": "<p>EDITED, to reduce needed helper classes to only one that holds all \"main\" class <em>shared</em> properties</p>\n\n<p>Since you're already working with classes, you should go on with such a powerful feature</p>\n\n<p>My understanding is that you want to change some properties for ALL objects of the same class, then the best solution is have to properties as Classes themselves, which will allow you to change them in one shot</p>\n\n<p>Of course, as almost always with Classes, the preparatory work is a bit longer but the reward is worth the effort </p>\n\n<p>So</p>\n\n<ul>\n<li><p><em>Shared</em> Property classes</p>\n\n<p>Set down a <code>Class</code> to hold all the properties to be shared between ALL Mob Class instances</p>\n\n<p>let's name it after <code>MobShareds</code> and its code would simply be:</p>\n\n<pre><code>Public prop1 As Variant ' rename \"prop1\" with whatever name you need\nPublic prop2 As Variant '  \"\"\nPublic prop3 As Variant '  \"\"\nPublic prop4 As Variant '  \"\"\n</code></pre></li>\n<li><p>Mob Class</p>\n\n<p>have your <code>Mob</code> class exploit that <em>shared</em> properties object, so its code would be</p>\n\n<pre><code>Public props As MobShareds\n</code></pre></li>\n<li><p>Now in your main code you have to</p>\n\n<ul>\n<li><p>instantiate one object to hold shared properties</p>\n\n<pre><code>Dim MobClassShareds As New MobShareds\n</code></pre></li>\n<li><p>set each new <code>Mob</code> instance \"shared properties\" property to the same object</p>\n\n<pre><code>MobCollection.Add New Mob\nSet MobCollection(MobCollection.Count).props = MobClassShareds ' set currently added 'Mob' object \"shared\" properties to the object that holds them\n\nMobCollection.Add New Mob\nSet MobCollection(MobCollection.Count).props = MobClassShareds ' set currently added 'Mob' object \"shared\" properties to the object that holds them\n\nMobCollection.Add New Mob\nSet MobCollection(MobCollection.Count).props = MobClassShareds ' set currently added 'Mob' object \"shared\" properties to the object that holds them\n</code></pre></li>\n<li><p>now you're ready to change any wanted shared property across ALL <code>Mob</code> objects with one single statement</p>\n\n<pre><code>MobClassShareds.prop1 = \"a\" ' this will set ALL 'Mob' objects property 1 value to \"a\"\n\nMobClassShared2.Value = 1 ' this will set ALL 'Mob' objects property 2 value to 1\n</code></pre></li>\n</ul></li>\n</ul>\n\n<p>A working code to test what above is the following:</p>\n\n<ul>\n<li><p><code>Mob</code> class</p>\n\n<pre><code>Public props As MobShareds\n</code></pre></li>\n<li><p><code>MobShareds</code> class</p>\n\n<pre><code>Public prop1 As Variant\nPublic prop2 As Variant\nPublic prop3 As Variant\nPublic prop4 As Variant\n</code></pre></li>\n<li><p>Main code</p>\n\n<pre><code>Option Explicit\n\nSub main()\n    Dim MobClass As Mob\n    Dim MobCollection As New Collection\n\n    '-------------------\n    ' declare and instantiate a variable to hold Mob class shared properties\n    Dim MobClassShareds As MobShareds\n    Set MobClassShareds = New MobShareds\n\n\n    '---------------------\n    ' fill your collection of 'Mob' objects and set their \"shared properties\" property to the same 'MobClassShareds' object\n    MobCollection.Add New Mob\n    Set MobCollection(MobCollection.Count).props = MobClassShareds ' set currently added 'Mob' object \"shared\" properties to the object that holds them\n\n    MobCollection.Add New Mob\n    Set MobCollection(MobCollection.Count).props = MobClassShareds ' set currently added 'Mob' object \"shared\" properties to the object that holds them\n\n    MobCollection.Add New Mob\n    Set MobCollection(MobCollection.Count).props = MobClassShareds ' set currently added 'Mob' object \"shared\" properties to the object that holds them\n\n\n    '---------\n    ' set shared properties for ALL classes to some string value\n    MobClassShareds.prop1 = \"a\" ' this will set ALL 'Mob' objects property 1 value to \"a\"\n    MobClassShareds.prop2 = \"b\" ' this will set ALL 'Mob' objects property 2 value to \"b\"\n    MobClassShareds.prop3 = 1 ' this will set ALL 'Mob' objects property 3 value to 1\n    MobClassShareds.prop4 = 2 ' this will set ALL 'Mob' objects property 4 value to 2\n\n\n    'check what stated right above ist true...\n    For Each MobClass In MobCollection\n        Debug.Print MobClass.props.prop1\n        Debug.Print MobClass.props.prop2\n        Debug.Print MobClass.props.prop3\n        Debug.Print MobClass.props.prop4\n    Next MobClass\n\n    '---------\n    ' set shared properties for ALL classes to some numeric value\n    MobClassShareds.prop1 = 1 ' this will set ALL 'Mob' objects property 1 value to 1\n    MobClassShareds.prop2 = 2 ' this will set ALL 'Mob' objects property 2 value to 2\n    MobClassShareds.prop3 = \"a\" ' this will set ALL 'Mob' objects property 3 value to \"a\"\n    MobClassShareds.prop4 = \"b\" ' this will set ALL 'Mob' objects property 4 value to \"b\"\n    '...\n\n    'check what stated right above ist true...\n    For Each MobClass In MobCollection\n        Debug.Print MobClass.props.prop1\n        Debug.Print MobClass.props.prop2\n        Debug.Print MobClass.props.prop3\n        Debug.Print MobClass.props.prop4\n    Next MobClass\n\nEnd Sub\n</code></pre></li>\n</ul>\n"}], "owner": {"reputation": 55, "user_id": 9362561, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-aZD136WAV2c/AAAAAAAAAAI/AAAAAAAAAqk/zgvKTxY019Q/photo.jpg?sz=128", "display_name": "Leo Steeves", "link": "https://stackoverflow.com/users/9362561/leo-steeves"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 738, "favorite_count": 1, "accepted_answer_id": 49294712, "answer_count": 1, "score": 0, "last_activity_date": 1521183892, "creation_date": 1521059516, "last_edit_date": 1531164843, "question_id": 49287139, "link": "https://stackoverflow.com/questions/49287139/vba-assign-a-value-to-multiple-classes-at-once-property-let", "title": "VBA - Assign a value to multiple classes at once (Property Let)", "body": "<p><strong>Solution:</strong> Just put brackets around Value in the CallByName statement to force evaluation of it. Credit goes to Rory. Cheers!</p>\n\n<p>I'm making a general function to set all the values of one variable in all my classes to a given value. It looks something like:</p>\n\n<pre><code>Sub MobClassSetAll(TargetData As String, Value As Variant)\n    For each MobClass in MobCollection\n        CallByName MobClass, TargetData, vbLet, Value\n    Next MobClass\nEnd Sub\n</code></pre>\n\n<p>Where MobCollection is a collection of all my similar Mob classes.</p>\n\n<p>The problem is <code>CallByName</code>. Its fourth argument (Args) throws a type mismatch when <code>Value</code> is initialized as a <code>Variant</code>. I've tested this rigorously and even made a post about it <a href=\"https://stackoverflow.com/questions/49266239/vba-callbyname-wont-accept-variant-arguments\">here</a>, but I have yet to get an answer.</p>\n\n<p>So my new question is: </p>\n\n<p><em>How can I change the value of the same variable in multiple similar classes, where the variable to be changed and the new value are passed to a function (without using <code>CallByName</code>)?</em></p>\n\n<p>Edit: Would overloading the function be a possible solution to this? Just learned about it in class for C++ today and I feel like its possible.</p>\n"}, {"tags": ["vba", "outlook", "runtime-error"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 3839431, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/bcc25b271cff62cd4bc5303849339afb?s=128&d=identicon&r=PG&f=1", "display_name": "duberry", "link": "https://stackoverflow.com/users/3839431/duberry"}, "edited": false, "score": 0, "creation_date": 1521470722, "post_id": 49336471, "comment_id": 85731878, "body": "<code>myReply.Display</code> only displays the .oft, it doesn&#39;t reply to the .msg"}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "reply_to_user": {"reputation": 41, "user_id": 3839431, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/bcc25b271cff62cd4bc5303849339afb?s=128&d=identicon&r=PG&f=1", "display_name": "duberry", "link": "https://stackoverflow.com/users/3839431/duberry"}, "edited": false, "score": 0, "creation_date": 1521471920, "post_id": 49336471, "comment_id": 85732793, "body": "myReply.body = myItem.body"}], "tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": false, "score": 0, "last_activity_date": 1521472679, "last_edit_date": 1521472679, "creation_date": 1521292774, "answer_id": 49336471, "question_id": 49287070, "link": "https://stackoverflow.com/questions/49287070/vba-outlook-run-time-error-could-not-send-the-message/49336471#49336471", "title": "VBA Outlook Run-time Error - Could not send the message", "body": "<p>Typically you would create a reply object like this:</p>\n\n<pre><code>Set myReply = myItem.Reply\n</code></pre>\n\n<p>To start with an oft:</p>\n\n<pre><code>Dim myReply as Outlook.MailItem\nSet myReply = myOlApp.CreateItemFromTemplate(\"L:\\example\\CWO.oft\")\nmyReply.Display\n</code></pre>\n\n<p>Now that there is no error you have myReply to manipulate.</p>\n\n<p>It appears you want this.</p>\n\n<pre><code>Set myItem = myOlApp.CreateItemFromTemplate(\"C:\\example\\temp\\tempEmail.msg\")\nmyReply = myOlApp.CreateItemFromTemplate(\"L:\\example\\CWO.oft\") \nmyReply.body = myItem.body\nUnload templateUserForm\nUnload inputUserForm\nmyReply.Display\n</code></pre>\n\n<p>To make the result look more like a reply:</p>\n\n<pre><code>myReply.body = myReply.body  &amp; vbcr &amp; myItem.reply.body\n</code></pre>\n\n<p>Depending on your templates you may want HTMLbody rather than body.</p>\n"}], "owner": {"reputation": 41, "user_id": 3839431, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/bcc25b271cff62cd4bc5303849339afb?s=128&d=identicon&r=PG&f=1", "display_name": "duberry", "link": "https://stackoverflow.com/users/3839431/duberry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 837, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1608083381, "creation_date": 1521059189, "last_edit_date": 1593040836, "question_id": 49287070, "link": "https://stackoverflow.com/questions/49287070/vba-outlook-run-time-error-could-not-send-the-message", "title": "VBA Outlook Run-time Error - Could not send the message", "body": "<p>The VBA code shown below is for replying to an email with a specific template. The user selects the email that they want to reply to through a file dialog box, the code should then open a new email replying to the selected email. I am receiving the following error:</p>\n\n<blockquote>\n  <p>Run-time error '-2147352567 (80020009)'\n  Could not send the message.</p>\n</blockquote>\n\n<p>When I click the \"Help\" button it takes me here: <a href=\"https://msdn.microsoft.com/en-us/VBA/Outlook-VBA/articles/olkcategory-backcolor-property-outlook\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/VBA/Outlook-VBA/articles/olkcategory-backcolor-property-outlook</a></p>\n\n<p>I can't imagine that link has anything to do with the error though. I have a feeling I'm doing something wrong with adding the reply email. Any help would be appreciated.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Public Sub btnOK_Click()\n\nDim myOlApp As Outlook.Application\nDim myItem As Outlook.MailItem\nDim body As String\nSet myOlApp = CreateObject(\"Outlook.Application\")\n\nSelect Case templateUserForm.templateListBox.Text\n Case \"CWO\"\n    ReplyTo\n    Set myItem = myOlApp.CreateItemFromTemplate(\"C:\\example\\temp\\tempEmail.msg\")\n    myItem.Reply = myOlApp.CreateItemFromTemplate(\"L:\\example\\CWO.oft\") &lt;--- Error occurs on this line\n    body = myItem.body\n    Unload templateUserForm\n    Unload inputUserForm\n    myItem.Display\nEnd Select\nEnd Sub\n\nPublic Sub ReplyTo()\n\nDim fso As Object\nDim xlApp As Object\nSet xlApp = CreateObject(\"Excel.Application\")\nxlApp.Visible = False\n\nDim fd As Office.FileDialog\nSet fd = xlApp.Application.FileDialog(msoFileDialogFilePicker)\nfd.AllowMultiSelect = False\nDim selectedItem As Variant\n\nIf fd.Show = -1 Then\nFor Each selectedItem In fd.SelectedItems\n    Set fso = VBA.CreateObject(\"Scripting.FileSystemObject\")\n    Call fso.CopyFile(fd.SelectedItems.Item(1), \"C:\\example\\temp\\tempEmail.msg\")\nNext\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 0, "last_activity_date": 1521061365, "creation_date": 1521061365, "answer_id": 49287582, "question_id": 49286878, "link": "https://stackoverflow.com/questions/49286878/copy-only-visible-data-entries-in-excel-but-something-is-going-wrong-why/49287582#49287582", "title": "Copy only visible data entries in Excel, but something is going wrong, why?", "body": "<p><em>You will need to use <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-copy-method-excel\" rel=\"nofollow noreferrer\">Range.Copy Method (Excel)</a> on your <a href=\"https://msdn.microsoft.com/en-us/library/office/aa213567(v=office.11).aspx\" rel=\"nofollow noreferrer\">xlCellTypeVisible</a></em></p>\n\n<p><em>Quick Example</em></p>\n\n<pre><code>Option Explicit\nPublic Sub Example()\n    Dim SourceRange As Range\n    Set SourceRange = ThisWorkbook.Worksheets(1).Range(\"B1:B100\") _\n                                                .SpecialCells(xlCellTypeVisible)\n\n    Dim DestRange As Range\n    Set DestRange = ThisWorkbook.Worksheets(2).Range(\"A1\")\n\n        SourceRange.Copy DestRange\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 9493763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2512d614bb0e125c9e2989df2bd5cd92?s=128&d=identicon&r=PG&f=1", "display_name": "L.TK", "link": "https://stackoverflow.com/users/9493763/l-tk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1521061365, "creation_date": 1521058362, "last_edit_date": 1521059073, "question_id": 49286878, "link": "https://stackoverflow.com/questions/49286878/copy-only-visible-data-entries-in-excel-but-something-is-going-wrong-why", "title": "Copy only visible data entries in Excel, but something is going wrong, why?", "body": "<p>I'm looking to create a bit of VBA code that copies two columns of only visible data on all excel workbooks in a file. </p>\n\n<p>For example, I might have this data visible (left number is column A, right is in column 2):</p>\n\n<ul>\n<li>1  2 </li>\n<li>1  3</li>\n<li>1  4</li>\n<li>1  5</li>\n</ul>\n\n<p>but the code I use merely copies 1 2 for this worksheet or, if there is a duplicate, as in</p>\n\n<ul>\n<li>1 2</li>\n<li>1 2</li>\n<li>1 3</li>\n</ul>\n\n<p>then it <em>only</em> copies the first duplicated values. I've posted the code I'm using below. What is going on?</p>\n\n<pre><code>Sub MergeAllWorkbooks()\n    Dim SummarySheet As Worksheet\n    Dim FolderPath As String\n    Dim NRow As Long\n    Dim FileName As String\n    Dim WorkBk As Workbook\n    Dim SourceRange As Range\n    Dim DestRange As Range\n\n    Set SummarySheet = Workbooks.Add(xlWBATWorksheet).Worksheets(1)\n\n    FolderPath = \"This is my folder path\"\n\n    NRow = 1\n\n    FileName = Dir(FolderPath &amp; \"*.xl*\")\n\n    Do While FileName &lt;&gt; \"\"\n        Set WorkBk = Workbooks.Open(FolderPath &amp; FileName)\n\n        SummarySheet.Range(\"A\" &amp; NRow).Value = FileName\n\n        Set SourceRange = WorkBk.Worksheets(1).Range(\"B1:B100\").SpecialCells(xlCellTypeVisible)\n\n        Set DestRange = SummarySheet.Range(\"C\" &amp; NRow)\n        Set DestRange = DestRange.Resize(SourceRange.Rows.Count, _\n           SourceRange.Columns.Count)\n\n        DestRange.Value = SourceRange.Value\n\n        NRow = NRow + DestRange.Rows.Count\n\n        WorkBk.Close savechanges:=False\n\n        FileName = Dir()\n    Loop\n\n    SummarySheet.Columns.AutoFit\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1521058251, "post_id": 49286821, "comment_id": 85576694, "body": "You want to change a cell to be red if it&#39;s value is over 20? Why do you need a &quot;function&quot; for that? I guess maybe I&#39;m not following what you are trying to do here. &quot;A function to act as a result&quot; could use some clarity."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1521058417, "post_id": 49286821, "comment_id": 85576785, "body": "you could apply conditional formatting within the spreadsheet to do this... if you <i>need</i> it to be through vba, see: <a href=\"https://stackoverflow.com/questions/13661965/conditional-formatting-using-excel-vba-code\" title=\"conditional formatting using excel vba code\">stackoverflow.com/questions/13661965/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 9493741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f6a80f79812f02baa82f87f2702081f?s=128&d=identicon&r=PG&f=1", "display_name": "user9493741", "link": "https://stackoverflow.com/users/9493741/user9493741"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1521115469, "post_id": 49286821, "comment_id": 85599634, "body": "@JNevill I need a function so that I may stretch my brains. Conditional formatting is fine if I needed to get this work done in a hurry.  I started playing around with the CountIfs and If statements in Excel and thought it may be possible to change a group of cell&#39;s color within a If statement."}, {"owner": {"reputation": 1, "user_id": 9493741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f6a80f79812f02baa82f87f2702081f?s=128&d=identicon&r=PG&f=1", "display_name": "user9493741", "link": "https://stackoverflow.com/users/9493741/user9493741"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1521115947, "post_id": 49286821, "comment_id": 85599914, "body": "@JNevill  Within the If statement there is a true and untrue result from the conditional logic statement that is shown in the cell the If statement is entered into.  In my CountIfs statement above the &quot;Ok&quot; is the false and the &quot;nOt Ok&quot; is the true."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1521116651, "post_id": 49286821, "comment_id": 85600400, "body": "You can&#39;t change a cells properties through a sheet formula even if it calls a VBA function. So I think conditional formatting is the way to go here."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1521120201, "post_id": 49286821, "comment_id": 85602871, "body": "As an alternative, you could write a VBA subroutine on the Worksheet_Change() event that tracks that cell and changes it (or other cell&#39;s) properties. But it won&#39;t be obvious from the front end what it&#39;s doing."}, {"owner": {"reputation": 1, "user_id": 9493741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f6a80f79812f02baa82f87f2702081f?s=128&d=identicon&r=PG&f=1", "display_name": "user9493741", "link": "https://stackoverflow.com/users/9493741/user9493741"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1521129821, "post_id": 49286821, "comment_id": 85610285, "body": "@JNevil I surmise you are correct.  I am not sure at this point how to do it."}], "owner": {"reputation": 1, "user_id": 9493741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f6a80f79812f02baa82f87f2702081f?s=128&d=identicon&r=PG&f=1", "display_name": "user9493741", "link": "https://stackoverflow.com/users/9493741/user9493741"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 271, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521058181, "creation_date": 1521058124, "last_edit_date": 1531164843, "question_id": 49286821, "link": "https://stackoverflow.com/questions/49286821/change-multiple-cell-interior-colors-with-a-function", "title": "Change Multiple Cell Interior Colors With a Function", "body": "<p>How can I create a function to be used in a conditional logic statement to act as a result? </p>\n\n<p>Conditional logic statement: <code>=IF(COUNTIFS(B10:B147,\"&gt;20\")=0,\"Ok\",function())</code>\nResult2[function()]: Change each cell <code>B10:B147</code> to red if value within cell is over 20.</p>\n"}, {"tags": ["vba", "excel", "checkbox"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1521058576, "post_id": 49286669, "comment_id": 85576862, "body": "Save the name of the current checkbox as a variable, then run the macro from: <a href=\"https://stackoverflow.com/questions/18927684/unselect-all-checkboxes-from-excel-workbook-with-vba-macro\" title=\"unselect all checkboxes from excel workbook with vba macro\">stackoverflow.com/questions/18927684/&hellip;</a> .  After all are unselected, use the saved variable for your current checkbox and check the marker."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521301873, "post_id": 49286669, "comment_id": 85677765, "body": "There&#39;s lots of information about differences between ActiveX controls and Form controls, and how to code with them, at <a href=\"https://stackoverflow.com/a/49263001/8112776\">my answer here</a>."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9493683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dpjI71JV3Cg/AAAAAAAAAAI/AAAAAAAAHy8/Ye2ZsBfUDtw/photo.jpg?sz=128", "display_name": "Steven", "link": "https://stackoverflow.com/users/9493683/steven"}, "edited": false, "score": 0, "creation_date": 1521076005, "post_id": 49287223, "comment_id": 85583117, "body": "Hello Dick, thank you for your reply! I have done very little on VBA coding before so it is very hard when I need it at work. I tried to run your code but I got another error &quot;Run-time error &#39;1004&#39;: Method &#39;CheckBoxes&#39; of object &#39;_Worksheet&#39; failed&quot;. Could you please explain this a little? Thank you very much!!"}, {"owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "reply_to_user": {"reputation": 11, "user_id": 9493683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dpjI71JV3Cg/AAAAAAAAAAI/AAAAAAAAHy8/Ye2ZsBfUDtw/photo.jpg?sz=128", "display_name": "Steven", "link": "https://stackoverflow.com/users/9493683/steven"}, "edited": false, "score": 0, "creation_date": 1521120619, "post_id": 49287223, "comment_id": 85603189, "body": "Select your checkboxes on the worksheet and look in the name box to get the name. If they&#39;re named something other than &quot;Check Box 1&quot; and &quot;Check Box 2&quot;, you&#39;ll have to change those values in the code. Also, my checkboxes were on a worksheet with codename Sheet1. You need to change that part of the code to your worksheet&#39;s codenam (or reference your sheet some other way)."}, {"owner": {"reputation": 11, "user_id": 9493683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dpjI71JV3Cg/AAAAAAAAAAI/AAAAAAAAHy8/Ye2ZsBfUDtw/photo.jpg?sz=128", "display_name": "Steven", "link": "https://stackoverflow.com/users/9493683/steven"}, "edited": false, "score": 0, "creation_date": 1521121614, "post_id": 49287223, "comment_id": 85603961, "body": "The checkboxes names and sheet name are exactly the same with yours. When I debug, it went to this line:            Set chkClicked = Sheet1.CheckBoxes(Application.Caller) I am very sorry to bother you so much, but I couldn&#39;t find other solutions online."}, {"owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "reply_to_user": {"reputation": 11, "user_id": 9493683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dpjI71JV3Cg/AAAAAAAAAAI/AAAAAAAAHy8/Ye2ZsBfUDtw/photo.jpg?sz=128", "display_name": "Steven", "link": "https://stackoverflow.com/users/9493683/steven"}, "edited": false, "score": 0, "creation_date": 1521298029, "post_id": 49287223, "comment_id": 85676571, "body": "Make sure your code is in a standard module and not sheet or other kind of module. Also, what version of Excel and what operating system are you using. <code>Checkboxes</code> is a deprecated method, but it still works - I use it all the time."}, {"owner": {"reputation": 11, "user_id": 9493683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dpjI71JV3Cg/AAAAAAAAAAI/AAAAAAAAHy8/Ye2ZsBfUDtw/photo.jpg?sz=128", "display_name": "Steven", "link": "https://stackoverflow.com/users/9493683/steven"}, "edited": false, "score": 0, "creation_date": 1521467461, "post_id": 49287223, "comment_id": 85729541, "body": "My excel is 2010,operating system is Windows 7. In the VBA, I inserted a Module, put the new code in and run, then an error message came out: &quot;Run-time error &#39;-2147352571 (80020005):&#39;, the item with the specified name wasn&#39;t found&quot;. I assigned the macro to the &quot;Check box 1&quot;, only &quot;Check box 1&quot; can be selected, &quot;Check box 2&quot; cannot. Is it possible that run the code without using Application.Caller? Because when I debug the code, the Application.Caller line became yellow."}, {"owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "reply_to_user": {"reputation": 11, "user_id": 9493683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dpjI71JV3Cg/AAAAAAAAAAI/AAAAAAAAHy8/Ye2ZsBfUDtw/photo.jpg?sz=128", "display_name": "Steven", "link": "https://stackoverflow.com/users/9493683/steven"}, "edited": false, "score": 0, "creation_date": 1521474958, "post_id": 49287223, "comment_id": 85735121, "body": "Yes, if you only care about cb1. See my edits. I&#39;m still not sure why <code>Application.Caller</code> doesn&#39;t work."}], "tags": [], "owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "is_accepted": false, "score": 0, "last_activity_date": 1521474924, "last_edit_date": 1521474924, "creation_date": 1521059864, "answer_id": 49287223, "question_id": 49286669, "link": "https://stackoverflow.com/questions/49286669/deselecting-a-checkbox-when-another-is-checked/49287223#49287223", "title": "Deselecting a checkbox when another is checked", "body": "<p>You say you cannot use ActiveX, but your code is ActiveX events. MSForms.Checkboxes don't have events. With forms controls, you assign a macro to the control. You can assign the same macro to multiple controls and use <code>Application.Caller</code> to determine which control called it.</p>\n\n<pre><code>Sub CheckBoxClicked()\n\n    Dim chkClicked As CheckBox\n    Dim chkOther As CheckBox\n\n    Set chkClicked = Sheet1.CheckBoxes(Application.Caller)\n\n    If chkClicked.Enabled Then\n        If Application.Caller = \"Check Box 1\" Then\n            Set chkOther = Sheet1.CheckBoxes(\"Check Box 2\")\n        Else\n            Set chkOther = Sheet1.CheckBoxes(\"Check Box 1\")\n        End If\n\n        chkOther.Value = False\n        chkOther.Enabled = False\n\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>This goes in a standard module, not the sheet module.</p>\n\n<p><code>Checkbox</code> is deprecated, but still works for me. You can do the same thing using the non-deprecated <code>Shape</code> object.</p>\n\n<pre><code>Sub CheckBoxClicked()\n\n    Dim chkClicked As Shape\n    Dim chkOther As Shape\n\n    Set chkClicked = Sheet1.Shapes(Application.Caller)\n\n    If chkClicked.OLEFormat.Object.Enabled Then\n        If Application.Caller = \"Check Box 1\" Then\n            Set chkOther = Sheet1.Shapes(\"Check Box 2\")\n        Else\n            Set chkOther = Sheet1.Shapes(\"Check Box 1\")\n        End If\n\n        chkOther.OLEFormat.Object.Value = False\n        chkOther.OLEFormat.Object.Enabled = False\n\n    End If\n\nEnd Sub\n</code></pre>\n\n<p><strong>Edit</strong></p>\n\n<p>If you only care about disabling Check Box 2 when Check Box 1 is clicked, the code becomes simpler.</p>\n\n<pre><code>Sub CheckBoxClicked()\n\n    Dim chkClicked As CheckBox\n    Dim chkOther As CheckBox\n\n    Set chkClicked = Sheet1.CheckBoxes(\"Check Box 1\")\n    Set chkOther = Sheet1.CheckBoxes(\"Check Box 2\")\n\n    If chkClicked.Enabled Then\n\n        chkOther.Value = False\n        chkOther.Enabled = False\n\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>You would only assign this macro to Check Box 1.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 9493683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dpjI71JV3Cg/AAAAAAAAAAI/AAAAAAAAHy8/Ye2ZsBfUDtw/photo.jpg?sz=128", "display_name": "Steven", "link": "https://stackoverflow.com/users/9493683/steven"}, "is_accepted": false, "score": 0, "last_activity_date": 1539268620, "creation_date": 1539268620, "answer_id": 52762771, "question_id": 49286669, "link": "https://stackoverflow.com/questions/49286669/deselecting-a-checkbox-when-another-is-checked/52762771#52762771", "title": "Deselecting a checkbox when another is checked", "body": "<p>Please use this code</p>\n\n<pre><code>Private Sub CheckBox1_Click()\nIf Me.CheckBox1.Value = True Then\nMe.CheckBox2.Value = False\nMe.CheckBox2.Enabled = False\nElse\nMe.CheckBox2.Enabled = True\nEnd If\nEnd Sub\n\nPrivate Sub CheckBox2_Click()\nIf Me.CheckBox2.Value = True Then\nMe.CheckBox1.Value = False\nMe.CheckBox1.Enabled = False\nElse\nMe.CheckBox1.Enabled = True\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9493683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dpjI71JV3Cg/AAAAAAAAAAI/AAAAAAAAHy8/Ye2ZsBfUDtw/photo.jpg?sz=128", "display_name": "Steven", "link": "https://stackoverflow.com/users/9493683/steven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2438, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1539268620, "creation_date": 1521057522, "last_edit_date": 1531164843, "question_id": 49286669, "link": "https://stackoverflow.com/questions/49286669/deselecting-a-checkbox-when-another-is-checked", "title": "Deselecting a checkbox when another is checked", "body": "<p>I have two checkboxes, form controls, if I select one, the other one is deselected. I cannot use ActiveX controls because there are many other checkboxes from other sheets are form controls. I cannot use option button because I need to get \"true\" \"false\" value.</p>\n\n<p>I used this code below:</p>\n\n<pre><code>Private Sub CheckBox1_Click()\nIf CheckBox1.Value = True Then\n    CheckBox2.Value = False\n    CheckBox2.Enabled = False\nElse\n    CheckBox2.Enabled = True\nEnd If\nEnd Sub\n\nPrivate Sub CheckBox2_Click()\nIf CheckBox2.Value = True Then\n    CheckBox1.Value = False\n    CheckBox1.Enabled = False\nElse\n    CheckBox1.Enabled = True\nEnd If\nEnd Sub\n</code></pre>\n\n<p>But it shows</p>\n\n<blockquote>\n  <p>Run-time error '424', Object required</p>\n</blockquote>\n\n<p>I am very new to VBA and still learning. I have no idea to fix it, please help me!! Thank you very much!!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1521076318, "post_id": 49286655, "comment_id": 85583192, "body": "What is the relationship between the code you posted and the screenshot?"}, {"owner": {"reputation": 1, "user_id": 9493618, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-zmh0Gu0TO4w/AAAAAAAAAAI/AAAAAAAAALA/M7DszyR-fJo/photo.jpg?sz=128", "display_name": "Brad Goodman", "link": "https://stackoverflow.com/users/9493618/brad-goodman"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1521136517, "post_id": 49286655, "comment_id": 85614586, "body": "None at the moment.  But I saw that the code could be adapted to possibly be close to what I need if I had a single section of info.  Having multiple sections and some with similar tags adds a lot of complexity."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1521144714, "post_id": 49286655, "comment_id": 85618907, "body": "Suggest you adapt it to work for a single section first. Then, with a better idea of what you are doing, we can help you adapt it to work for multiple sections."}], "owner": {"reputation": 1, "user_id": 9493618, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-zmh0Gu0TO4w/AAAAAAAAAAI/AAAAAAAAALA/M7DszyR-fJo/photo.jpg?sz=128", "display_name": "Brad Goodman", "link": "https://stackoverflow.com/users/9493618/brad-goodman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521075394, "creation_date": 1521057453, "last_edit_date": 1521075394, "question_id": 49286655, "link": "https://stackoverflow.com/questions/49286655/importing-multiple-sections-and-sub-data-lines-from-text-into-specific-columns", "title": "Importing multiple sections and sub data lines from text into specific columns", "body": "<p>Found this and it helps but does quite get the complexity that I require. \n <a href=\"https://stackoverflow.com/questions/35826629/how-to-import-specific-text-from-files-in-to-excel\">How to import specific text from files in to excel?</a></p>\n\n<p>What i am doing is scanning a range of IPs with another script which will create a single text file for each server with that server's hardware profile. That script is not the problem and works correctly at this time.</p>\n\n<p>Then I want a script that will loop through all of the files created above and import only specific data into an Excel spreadsheet.</p>\n\n<pre><code>Sub ReadFilesIntoActiveSheet()\nDim fso As FileSystemObject\nDim folder As folder, file As file, FileText As TextStream\nDim TextLine As String\nDim cl As Range\n\nDim num As Long ' numerical part of key, as in \"Ann:\"\nDim col As Long ' target column in Excel sheet\nDim key As String ' Part before \":\"\nDim value As String ' Part after \":\"\n\n' Get a FileSystem object\nSet fso = New FileSystemObject\n\n' Get the directory you want\nSet folder = fso.GetFolder(\"D:\\YourDirectory\\\")\n\n' Set the starting point to write the data to\n' Don't write in first row where titles are\nSet cl = ActiveSheet.Cells(2, 1)\n\n' Loop thru all files in the folder\nFor Each file In folder.Files\n    ' Open the file\n    Set FileText = file.OpenAsTextStream(ForReading)\n\n    ' Read the file one line at a time\n    Do While Not FileText.AtEndOfStream\n\n        TextLine = FileText.ReadLine 'read line\n\n        key = Split(TextLine &amp; \":\", \":\")(0)\n        value = Trim(Mid(TextLine, Len(key)+2))\n        num = Val(Mid(key,2))\n        If num Then key = Replace(key, num, \"\") ' Remove number from key\n        col = 0\n        If key = \"From\" Then col = 1\n        If key = \"Date\" Then col = 2\n        If key = \"A\"    Then col = 2 + num\n        If col Then\n            cl.Offset(, col-1).Value = value ' Fill cell\n        End If\n    Loop\n\n    ' Clean up\n    FileText.Close\n    ' Next row\n    Set cl = cl.Offset(1) \nNext file\nEnd Sub\n</code></pre>\n\n<p>The way I import that file into Excel looks similar to this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/g9IOu.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/g9IOu.jpg\" alt=\"excel clip\"></a></p>\n\n<p>This is a small clip of a long file with lots of sections.  This clip shows clips of 2 sections.  I need this vba script to be able to determine the [] section and then pull a specific line under that.  And there are many sections that may be nearly identical such as <code>[InstanceID: DIMM.Socket.A1]</code> and <code>[InstanceID: DIMM.Socket.A2]</code> and many of the sub lines may be the same as well such as Model may be listed under many different types of components.</p>\n\n<p>How can this script go through and pull the Model from under <code>[InstanceID: DIMM.Socket.A1]</code> but skip all of the rest of the similar sections.  And then pull BIOSReleaseDate and BIOSVersionString lines from the <code>[InstanceID: System.Embedded.1]</code> section.  I assume I can use the rest of the original script to put these data points into specific columns such as <code>Then col = 1</code> or <code>Then col = A</code>.</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1521057392, "post_id": 49286592, "comment_id": 85576183, "body": "Target.Cells.Count &gt; 1  this means if more than one cell sets off then sub is exited."}, {"owner": {"reputation": 1, "user_id": 9493538, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jo&#235;l van Dijk", "link": "https://stackoverflow.com/users/9493538/jo%c3%abl-van-dijk"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1521061781, "post_id": 49286592, "comment_id": 85578344, "body": "Ah ofcourse, so if i delete that, what can i do to make it work properly?"}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1521063017, "creation_date": 1521063017, "answer_id": 49287930, "question_id": 49286592, "link": "https://stackoverflow.com/questions/49286592/clear-contents-of-cells-when-the-cell-left-of-it-changes/49287930#49287930", "title": "Clear contents of cells when the cell left of it changes", "body": "<p>The general pattern to to create an <em>intersection range</em>:</p>\n\n<ol>\n<li>if it is <code>Nothing</code> then do nothing</li>\n<li>otherwise loop over its cells</li>\n</ol>\n\n<p>for example:<br></p>\n\n<pre><code>     Private Sub Worksheet_Change(ByVal Target As Range)\n     Dim rngDV As Range, TheIntersection As Range, r As Range\n\n    '       stuff\n\n    TheIntersection = Intersect(Target, rngDV)\n    If TheIntersection Is Nothing Then\n        '   do nothing\n    Else\n        For Each r In TheIntersection\n            '   do something\n        Next r\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9493538, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jo&#235;l van Dijk", "link": "https://stackoverflow.com/users/9493538/jo%c3%abl-van-dijk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521063868, "creation_date": 1521057148, "last_edit_date": 1521063868, "question_id": 49286592, "link": "https://stackoverflow.com/questions/49286592/clear-contents-of-cells-when-the-cell-left-of-it-changes", "title": "Clear contents of cells when the cell left of it changes", "body": "<p>I'm trying to get a piece of code that, when a cell in column 8 changes it deletes the value of cell next to it(column 9).\nWell... That is the simple version</p>\n\n<p>Column 8 and 9 are both dropdown lists, the dropdown list in column 9 is dependent on column 8. In column 9, multiple answers are necesary so i found a code on the internet that made that possible, but now the value in column 9 doesn't delete automatically when i change the value in column 8.\nThis piece of code below works, but only when i change 1 cell(in column 8) at the time. It doesn't work when i paste multiple Cells in Column 8 or when i select a cell in column 8 and then drag it down(from the lower right corner).</p>\n\n<p>I don't have a lot of experience with coding and just can't seem to find the right solution for this.\nThanks to QHarr i got a bit further.\nThis is my second attempt:</p>\n\n<pre><code>Dim ClearC9 As String\nDim i As Long\nFor i = 2 To 1000\n    If Target.Cells.Count &gt; 1 Then GoTo ClearC9\n    If Not Intersect(Target, Range(\"H\" &amp; i)) Is Nothing Then\n        Range(\"I\" &amp; i).ClearContents\n    End If\n    Next i\n\nexitHandler:\nApplication.EnableEvents = True\n\n  Columns(\"I:I\").EntireColumn.AutoFit\n\nClearC9:\nSelection.Offset(, 1).ClearContents\n</code></pre>\n\n<p>First Attempt:</p>\n\n<pre><code>Dim i As Long\nFor i = 2 To 1000\nIf Target.Cells.Count &gt; 1 Then Exit Sub\nIf Not Intersect(Target, Range(\"H\" &amp; i)) Is Nothing Then\nRange(\"I\" &amp; i).ClearContents\nEnd If\n</code></pre>\n\n<p>This is the entire code:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim rngDV As Range\nDim oldVal As String\nDim newVal As String\nDim lUsed As Long\nIf Target.Count &gt; 1 Then GoTo exitHandler\n\nOn Error Resume Next\nSet rngDV = Cells.SpecialCells(xlCellTypeAllValidation)\nOn Error GoTo exitHandler\n\nIf rngDV Is Nothing Then GoTo exitHandler\n\nIf Intersect(Target, rngDV) Is Nothing Then\n   'do nothing\nElse\n  Application.EnableEvents = False\n  newVal = Target.Value\n  Application.Undo\n  oldVal = Target.Value\n  Target.Value = newVal\n  If Target.Column = 9 Then\n    If oldVal = \"\" Then\n      'do nothing\n      Else\n      If newVal = \"\" Then\n      'do nothing\n      Else\n        lUsed = InStr(1, oldVal, newVal)\n        If lUsed &gt; 0 Then\n            If Right(oldVal, Len(newVal)) = newVal Then\n                Target.Value = Left(oldVal, Len(oldVal) - Len(newVal) - 2)\n            Else\n                Target.Value = Replace(oldVal, newVal &amp; \", \", \"\")\n            End If\n        Else\n            Target.Value = oldVal _\n              &amp; \", \" &amp; newVal\n        End If\n    End If\n    End If\n  End If\nEnd If\nDim i As Long\nFor i = 2 To 1000\nIf Target.Cells.Count &gt; 1 Then Exit Sub\n    If Not Intersect(Target, Range(\"H\" &amp; i)) Is Nothing Then\n        Range(\"I\" &amp; i).ClearContents\n    End If\nNext i\n\nexitHandler:\n  Application.EnableEvents = True\n\n  Columns(\"I:I\").EntireColumn.AutoFit\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "object", "compiler-errors"], "comments": [{"owner": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "edited": false, "score": 0, "creation_date": 1521056788, "post_id": 49286428, "comment_id": 85575823, "body": "There&#39;s a bunch of questions concerned with the same error message. None of those answer your question? If yes, then at least extract a minimal example first, your question is off-topic without it."}], "answers": [{"comments": [{"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 1, "creation_date": 1521057179, "post_id": 49286470, "comment_id": 85576055, "body": "braX you beat me to it. I also noticed that every time you you insert rows you won&#39;t evaluate all your data, since your last row is not incremented.  If you want all the data in your coulmn, you&#39;ll have increment LR = LR +3 when you do the i=i+3 and j=j+3"}, {"owner": {"reputation": 1, "user_id": 7914218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46df4ac0b390b4a03aec58e03d6f14a9?s=128&d=identicon&r=PG&f=1", "display_name": "Omes6797", "link": "https://stackoverflow.com/users/7914218/omes6797"}, "edited": false, "score": 0, "creation_date": 1521133920, "post_id": 49286470, "comment_id": 85613011, "body": "Darn! Such a simple fix. Thanks so much for the help!"}], "tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 1, "last_activity_date": 1521056626, "creation_date": 1521056626, "answer_id": 49286470, "question_id": 49286428, "link": "https://stackoverflow.com/questions/49286428/compile-error-object-required/49286470#49286470", "title": "Compile Error: Object Required", "body": "<p>Only use <code>Set</code> when dealing with object variables. A <code>Long</code> is a number, not an object.</p>\n\n<p>Change this:</p>\n\n<pre><code>Set LR = Cells(Rows.Count, 8).End(xlUp).Row\n</code></pre>\n\n<p>To this:</p>\n\n<pre><code>LR = Cells(Rows.Count, 8).End(xlUp).Row\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7914218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46df4ac0b390b4a03aec58e03d6f14a9?s=128&d=identicon&r=PG&f=1", "display_name": "Omes6797", "link": "https://stackoverflow.com/users/7914218/omes6797"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "closed_date": 1521061071, "answer_count": 1, "score": 0, "last_activity_date": 1521056626, "creation_date": 1521056480, "last_edit_date": 1531164843, "question_id": 49286428, "link": "https://stackoverflow.com/questions/49286428/compile-error-object-required", "closed_reason": "Not suitable for this site", "title": "Compile Error: Object Required", "body": "<p>I'm having an issue with a </p>\n\n<blockquote>\n  <p>Compile error: Object Required</p>\n</blockquote>\n\n<p>I checked similar problems that have been solved on the site, but for some reason I am still having the issue.</p>\n\n<p>The code I am using adds rows in between rows with non-matching cells under Column H (Column 8). It works most of the time, but one data set includes numbers and ends with cells that have letters and numbers in the cell in the cell. Let me know if you see something I am missing.</p>\n\n<pre><code>Sub SepP1()\n\nSheets(\"Format Area (Paste Here)\").Activate\n\nDim LR As Long\nDim j As Integer\nDim i As Integer\n\nSet LR = Cells(Rows.Count, 8).End(xlUp).Row 'I AM GETTING THE ERROR HERE\n\ni = 2\n\nFor j = 2 To LR\n\ni = i + 1\n\nIf Cells(j, \"H\").Value = Cells(i, \"H\") Then\n\nElseIf Cells(j, 8).Value &lt;&gt; Cells(i, 8) Then\n    Application.CutCopyMode = False\n    Rows(i).Insert Shift:=xlShiftDown\n    Rows(i).Insert Shift:=xlShiftDown\n    Rows(i).Insert Shift:=xlShiftDown\n    j = j + 3\n    i = i + 3\n    End If\n\nNext j\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["c#", "excel", "automation", "vba"], "comments": [{"owner": {"reputation": 5909, "user_id": 3562271, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/5522cf83767d944faddd6b36c1de179f?s=128&d=identicon&r=PG&f=1", "display_name": "PhillipH", "link": "https://stackoverflow.com/users/3562271/philliph"}, "edited": false, "score": 0, "creation_date": 1521057393, "post_id": 49286336, "comment_id": 85576184, "body": "What is the value of test.VBE.CommandBars.FindControl(Id: 578) ?"}, {"owner": {"reputation": 2053, "user_id": 1581875, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4c4820fbcdf16fb5aa890353e3198582?s=128&d=identicon&r=PG&f=1", "display_name": "Olorin", "link": "https://stackoverflow.com/users/1581875/olorin"}, "reply_to_user": {"reputation": 5909, "user_id": 3562271, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/5522cf83767d944faddd6b36c1de179f?s=128&d=identicon&r=PG&f=1", "display_name": "PhillipH", "link": "https://stackoverflow.com/users/3562271/philliph"}, "edited": false, "score": 0, "creation_date": 1521059017, "post_id": 49286336, "comment_id": 85577100, "body": "I changed the code a bit : the new problematic line <code>Microsoft.Office.Core.CommandBars listCommandBars = test.VBE.CommandBars;</code> already triggers the <code>{&quot;Error loading type library&#47;DLL. (Exception from HRESULT: 0x80029C4A (TYPE_E_CANTLOADLIBRARY))&quot;}</code> exception."}, {"owner": {"reputation": 2053, "user_id": 1581875, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4c4820fbcdf16fb5aa890353e3198582?s=128&d=identicon&r=PG&f=1", "display_name": "Olorin", "link": "https://stackoverflow.com/users/1581875/olorin"}, "reply_to_user": {"reputation": 5909, "user_id": 3562271, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/5522cf83767d944faddd6b36c1de179f?s=128&d=identicon&r=PG&f=1", "display_name": "PhillipH", "link": "https://stackoverflow.com/users/3562271/philliph"}, "edited": false, "score": 0, "creation_date": 1521059661, "post_id": 49286336, "comment_id": 85577396, "body": "Whereas an <code>oXL.VBE.CommandBars.FindControl(MsoControlType.msoControlBut&zwnj;&#8203;ton, Id: 587).Execute();</code> triggers an <code>Exception thrown at 0x77E6ED6D (ntdll.dll) in XlamAutomation.exe: 0xC0000005: Access violation writing location 0x00000000.</code>"}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1521060437, "post_id": 49286336, "comment_id": 85577718, "body": "What you are trying to do can generally only work from code that runs <i>inside</i> the Office app.  Like VBA does.  But not from an external C# program, the exception is trying to tell you that it does not know how the marshal the call from one process to another.  Something that is hard to do, it needs a type library to pull it off and there isn&#39;t one available.  You can write an Office add-in in C#, then it runs inside."}, {"owner": {"reputation": 2053, "user_id": 1581875, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4c4820fbcdf16fb5aa890353e3198582?s=128&d=identicon&r=PG&f=1", "display_name": "Olorin", "link": "https://stackoverflow.com/users/1581875/olorin"}, "reply_to_user": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1521061984, "post_id": 49286336, "comment_id": 85578430, "body": "@HansPassant Thank you. To be precise, I am generating an xlam file with c#, adding modules to it from .bas files in a folder, and after all of that, I simply want to compile the vba code and save it. I understand your point, but why I can I run macros in the xlam from the c# wherease I can&#39;t compile the code itself from the c# ? What is different between running macros from outside and compiling from outside ?"}, {"owner": {"reputation": 5909, "user_id": 3562271, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/5522cf83767d944faddd6b36c1de179f?s=128&d=identicon&r=PG&f=1", "display_name": "PhillipH", "link": "https://stackoverflow.com/users/3562271/philliph"}, "edited": false, "score": 0, "creation_date": 1521067112, "post_id": 49286336, "comment_id": 85580629, "body": "Because when you run them from outside you are asking Excel to load and compile them on your behalf. You are trying to invert that process."}, {"owner": {"reputation": 2053, "user_id": 1581875, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4c4820fbcdf16fb5aa890353e3198582?s=128&d=identicon&r=PG&f=1", "display_name": "Olorin", "link": "https://stackoverflow.com/users/1581875/olorin"}, "edited": false, "score": 0, "creation_date": 1521195181, "post_id": 49286336, "comment_id": 85637321, "body": "Ok, I am now executing the code from an excel addin, and the same code throws <code>{&quot;Error HRESULT E_FAIL has been returned from a call to a COM component.&quot;} commandbar find control</code> at me. Maybe I should somehow enable the command bar control before doing an execute, but how ?"}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "edited": false, "score": 0, "creation_date": 1527096658, "post_id": 49286336, "comment_id": 88001343, "body": "I have never heard of compiling VBA code, but see the link below for an idea of how to run an Excel Macro from C#.  <a href=\"https://stackoverflow.com/questions/31200130/run-vba-macro-in-excel-sheet-using-external-c-sharp-console-application?rq=1\" title=\"run vba macro in excel sheet using external c sharp console application\">stackoverflow.com/questions/31200130/&hellip;</a>"}], "owner": {"reputation": 2053, "user_id": 1581875, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4c4820fbcdf16fb5aa890353e3198582?s=128&d=identicon&r=PG&f=1", "display_name": "Olorin", "link": "https://stackoverflow.com/users/1581875/olorin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 346, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1521059246, "creation_date": 1521056072, "last_edit_date": 1531164843, "question_id": 49286336, "link": "https://stackoverflow.com/questions/49286336/programatically-compiling-vba-modules-with-c", "title": "Programatically compiling VBA modules with c#", "body": "<p>I have the following code</p>\n\n<pre><code>Microsoft.Office.Interop.Excel.Application oXL = new Microsoft.Office.Interop.Excel.Application();\nWorkbook oWB = oXL.Workbooks.Open(solutionDirectory);\n</code></pre>\n\n<p>where <code>string solutionDirectory</code> contains the path to an Excel <strong>xlam</strong> file. It is and Excel Macro-Enabled Add-In file that is used to add new functions to Excel : if you open it with Excel, you won't have a spreadsheet, but only VBA code. When modified in VBA, this code can be compiled via VBA.</p>\n\n<p>I try to trigger programmatically this compilation with <code>c#</code> :</p>\n\n<pre><code>VBComponents = oWB.VBProject.VBComponents;\nforeach (var module in VBComponents)\n{\n    var test = module as VBComponent;\n    if (test.Type == vbext_ComponentType.vbext_ct_StdModule || test.Type == vbext_ComponentType.vbext_ct_ClassModule)\n    {\n        Microsoft.Office.Core.CommandBars listCommandBars = test.VBE.CommandBars; // first problematic line\n        listCommandBars.FindControl(Id: 578).Execute(); // problematic line\n    }\n}\n</code></pre>\n\n<p>I found inspiration for the \"problematic line\" here :</p>\n\n<p><a href=\"https://www.experts-exchange.com/questions/26424766/Programmatically-check-VBA-compiles-as-part-of-release-procedure.html\" rel=\"nofollow noreferrer\">https://www.experts-exchange.com/questions/26424766/Programmatically-check-VBA-compiles-as-part-of-release-procedure.html</a></p>\n\n<p>and tried to adapt, without success : the problematic line triggers a :</p>\n\n<pre><code>{\"Error loading type library/DLL. (Exception from HRESULT: 0x80029C4A (TYPE_E_CANTLOADLIBRARY))\"}\n</code></pre>\n\n<p>I am wrong on the way to do the compilation, or is the problem of a different nature ? What's the way to achieve programatic compilation of VBA modules with <code>c#</code> ?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 1, "creation_date": 1521055806, "post_id": 49286223, "comment_id": 85575293, "body": "When you get that error you are given the option to click &quot;Debug&quot; button. When you do so, which line is highlighted?"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1521056018, "post_id": 49286223, "comment_id": 85575419, "body": "Do you have a worksheet/tab named &quot;Sheet1&quot;. Does it have data in it? Is that data in A1 or is A1 blank and your data is hiding in a block out at <code>AB6:AV520</code>? Is your workbook saved, or you are trying this on a brand-spanking-new book that hasn&#39;t been saved yet?"}, {"owner": {"reputation": 1, "user_id": 9491226, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PC3PH.jpg?s=128&g=1", "display_name": "moot", "link": "https://stackoverflow.com/users/9491226/moot"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1521063918, "post_id": 49286223, "comment_id": 85579337, "body": "Thanks for taking time to look at this... the Set ExpRng... line gave error. Had &quot;Sheet1&quot;, with data, no hiding, saved. Did put Sub in new WB...and it worked. Renamed my original Sub in my original WB and copied Sub from new WB... now it works!... I have no idea on what was different. I compared my original Sub to the new Sub and could not find ANY difference... just some hick-up? Guess I can move on... Thanks again for your input."}], "owner": {"reputation": 1, "user_id": 9491226, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PC3PH.jpg?s=128&g=1", "display_name": "moot", "link": "https://stackoverflow.com/users/9491226/moot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1398, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521055687, "creation_date": 1521055687, "last_edit_date": 1531164843, "question_id": 49286223, "link": "https://stackoverflow.com/questions/49286223/excel-vba-code-to-save-sheet-as-tab-delimited-text-file", "title": "Excel-VBA code to save sheet as tab-delimited text file", "body": "<p>I used the code from <a href=\"https://stackoverflow.com/questions/43655288/vba-code-to-save-excel-sheet-as-tab-delimited-text-file\">VBA code to save Excel sheet as tab-delimited text file</a> provided by MiguelH.</p>\n\n<pre><code>Sub ExportRange()\nDim ExpRng As Range\nDim myTab As String\nOpen ThisWorkbook.Path &amp; \"\\AllDXL.txt\" For Output As #1\n    Set ExpRng = Worksheets(\"Sheet1\").Range(\"A1\").CurrentRegion\n    FirstCol = ExpRng.Columns(1).Column\n    LastCol = FirstCol + ExpRng.Columns.Count - 1\n    FirstRow = ExpRng.Rows(1).Row\n    LastRow = FirstRow + ExpRng.Rows.Count - 1\n    For r = FirstRow To LastRow\n       Data = \"\"\n       For c = FirstCol To LastCol\n           If c = 1 Then myTab = \"\" Else myTab = vbTab\n        '  data = ExpRng.Cells(r, c).Value\n           Data = Data &amp; myTab &amp; ExpRng.Cells(r, c).Value\n       Next c\n       Print #1, Data\n   Next r\nClose #1\nEnd Sub\n</code></pre>\n\n<p>When I run the code I get Run-time error '9': subscript out of range.</p>\n\n<p>What am I missing? I'm a newbie and would like to understand how the code works... before I try to modify the code to get the results I need.\nFrom what I've found in researching the error it usually seems to mean that the object is missing? i.e., not in catalogue?\nAs I said, I'm new to excel-vba, so please feel free to dumb it down for me.\nps. I wanted to leave a comment in the referenced post...but don't have enough points...  </p>\n"}, {"tags": ["vba", "excel", "printing", "excel-2010"], "comments": [{"owner": {"reputation": 755, "user_id": 5298189, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/TDtv2.png?s=128&g=1", "display_name": "Robby", "link": "https://stackoverflow.com/users/5298189/robby"}, "edited": false, "score": 0, "creation_date": 1521055131, "post_id": 49286003, "comment_id": 85574908, "body": "You said even if you choose colour, it doesn&#39;t print that way. Where did you choose that?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521055280, "post_id": 49286003, "comment_id": 85574983, "body": "Have you tried printing a color document manually?  <b><i>You need to get that working first.</i></b>"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1521055463, "post_id": 49286003, "comment_id": 85575089, "body": "...also you shouldn&#39;t need to set your print properties programmatically.   Your printer has a way to set print defaults (that will &quot;stay set&quot;), and Windows printer settings probably has a related setting-or-two as well.  If you can&#39;t <i>manually</i> print something in color then this is <i>not</i> a programming-related problem. (Perhaps <a href=\"https://superuser.com/\">superuser.com</a> ?)"}, {"owner": {"reputation": 43, "user_id": 9339566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36a05d4fabf9023e715dec36cd86bb8d?s=128&d=identicon&r=PG&f=1", "display_name": "PWJP", "link": "https://stackoverflow.com/users/9339566/pwjp"}, "edited": false, "score": 0, "creation_date": 1521055825, "post_id": 49286003, "comment_id": 85575304, "body": "When &quot;Xerox Black and White&quot; is not selected, it prints in colour. And I have tried printing colour manually."}, {"owner": {"reputation": 43, "user_id": 9339566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36a05d4fabf9023e715dec36cd86bb8d?s=128&d=identicon&r=PG&f=1", "display_name": "PWJP", "link": "https://stackoverflow.com/users/9339566/pwjp"}, "edited": false, "score": 0, "creation_date": 1521055983, "post_id": 49286003, "comment_id": 85575397, "body": "That is true, I can set it as his default setting. I will test it when he comes back to work tomorrow :) Thank you."}], "owner": {"reputation": 43, "user_id": 9339566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36a05d4fabf9023e715dec36cd86bb8d?s=128&d=identicon&r=PG&f=1", "display_name": "PWJP", "link": "https://stackoverflow.com/users/9339566/pwjp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 636, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1521054884, "creation_date": 1521054884, "question_id": 49286003, "link": "https://stackoverflow.com/questions/49286003/i-cannot-print-in-colour-through-vba", "title": "I cannot print in colour through VBA", "body": "<p>I recorded a macro that prints sheets 2 and 3. I am selecting the whole workbook and printing pages 2 and 3 since there seems to be no way to print individual sheets. After recording the macro, I also added popups to select the printer (printer setup dialog) and an inputbox for the number of copies that the user wants to print. The following is the code.</p>\n\n<pre><code>Sub Print_Plan()\n\nApplication.Dialogs(xlDialogPrinterSetup).Show\n\nDim number As String\nnumber = InputBox(\"How many copies do you want\", , 1)\nIf number = \"\" Then Exit Sub\n\nApplication.PrintCommunication = False\nWith ActiveSheet.PageSetup\n    .PrintTitleRows = \"\"\n    .PrintTitleColumns = \"\"\nEnd With\nApplication.PrintCommunication = True\nActiveSheet.PageSetup.PrintArea = \"\"\nApplication.PrintCommunication = False\nWith ActiveSheet.PageSetup\n    .LeftHeader = \"\"\n    .CenterHeader = \"\"\n    .RightHeader = \"\"\n    .LeftFooter = \"\"\n    .CenterFooter = \"\"\n    .RightFooter = \"\"\n    .LeftMargin = Application.InchesToPoints(0)\n    .RightMargin = Application.InchesToPoints(0)\n    .TopMargin = Application.InchesToPoints(0)\n    .BottomMargin = Application.InchesToPoints(0)\n    .HeaderMargin = Application.InchesToPoints(0)\n    .FooterMargin = Application.InchesToPoints(0)\n    .PrintHeadings = False\n    .PrintGridlines = False\n    .PrintComments = xlPrintNoComments\n    .PrintQuality = 600\n    .CenterHorizontally = False\n    .CenterVertically = False\n    .Orientation = xlLandscape\n    .Draft = False\n    .PaperSize = xlPaperLegal\n    .FirstPageNumber = xlAutomatic\n    .Order = xlDownThenOver\n    .BlackAndWhite = False\n    .Zoom = False\n    .FitToPagesWide = 1\n    .FitToPagesTall = 1\n    .PrintErrors = xlPrintErrorsDisplayed\n    .OddAndEvenPagesHeaderFooter = False\n    .DifferentFirstPageHeaderFooter = False\n    .ScaleWithDocHeaderFooter = True\n    .AlignMarginsHeaderFooter = True\n    .EvenPage.LeftHeader.Text = \"\"\n    .EvenPage.CenterHeader.Text = \"\"\n    .EvenPage.RightHeader.Text = \"\"\n    .EvenPage.LeftFooter.Text = \"\"\n    .EvenPage.CenterFooter.Text = \"\"\n    .EvenPage.RightFooter.Text = \"\"\n    .FirstPage.LeftHeader.Text = \"\"\n    .FirstPage.CenterHeader.Text = \"\"\n    .FirstPage.RightHeader.Text = \"\"\n    .FirstPage.LeftFooter.Text = \"\"\n    .FirstPage.CenterFooter.Text = \"\"\n    .FirstPage.RightFooter.Text = \"\"\nEnd With\nApplication.PrintCommunication = True\n\nSheet1.PageSetup.PrintArea = \"$A$1:$BS$50\"\n\nActiveWorkbook.PrintOut From:=2, To:=3, Copies:=number, Collate:=True, _\n    IgnorePrintAreas:=False\n\nEnd Sub\n</code></pre>\n\n<p>The user also wants to print in colour. The problem here is that the colour option can only be selected from the printer properties.<a href=\"https://i.stack.imgur.com/dqaTX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dqaTX.png\" alt=\"Printer Setup and Properties\"></a></p>\n\n<p>I noticed that it is possible to open print properties from the print setup by clicking on the setup button. But even if I choose colour, it doesn't print in colour. Plus, I haven't found a way to open print properties any other way. I have even added <code>black and white = false</code> and yet it prints black and white. </p>\n\n<p>How do I change the code so the user is able to choose colour print?</p>\n"}, {"tags": ["vba", "class", "collections", "drag-and-drop"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521054574, "post_id": 49285844, "comment_id": 85574642, "body": "So, <code>&quot;everything works fine&quot;</code> -- except for the fact that <i>it doesn&#39;t work?</i>  :)  Your option #2 sounds like it&#39;s straightforward.  If you can get it to work then you should do it, because if not, the other optoins are only going to get more complicated."}, {"owner": {"reputation": 1, "user_id": 6296159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a384fac8114fa72c99e879f43d2ec9c?s=128&d=identicon&r=PG&f=1", "display_name": "ak_digital", "link": "https://stackoverflow.com/users/6296159/ak-digital"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521055464, "post_id": 49285844, "comment_id": 85575091, "body": "Well, it DOES work if you want to <i>copy</i> data from one listbox to another or within a listbox... ;-) If there are other options, I don&#39;t mind they get more complicated if they are <i>better</i> / <i>more professional</i> solutions. For example, I read something about a wrapper class for the event handlers, but I couldn&#39;t get my head around it. Myabe you could shine some light on that?"}, {"owner": {"reputation": 1, "user_id": 6296159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a384fac8114fa72c99e879f43d2ec9c?s=128&d=identicon&r=PG&f=1", "display_name": "ak_digital", "link": "https://stackoverflow.com/users/6296159/ak-digital"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521062156, "post_id": 49285844, "comment_id": 85578524, "body": "Fixed it! I went along with the idea of a separate eventhandler class and suddenly I saw the light (hallelujah!). I updated the original post, hopefully my solution is helpful to others. Still, if someone has a better solution I&#39;d be glad to hear it. For now, this works fine for me."}], "owner": {"reputation": 1, "user_id": 6296159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a384fac8114fa72c99e879f43d2ec9c?s=128&d=identicon&r=PG&f=1", "display_name": "ak_digital", "link": "https://stackoverflow.com/users/6296159/ak-digital"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 239, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521065248, "creation_date": 1521054282, "last_edit_date": 1521065248, "question_id": 49285844, "link": "https://stackoverflow.com/questions/49285844/dragdrop-between-listboxes-which-are-classes-in-a-collection", "title": "Drag&amp;drop between listboxes which are classes in a collection", "body": "<p>Being a self-taught VBA programmer I usually search the internet until I find a satisfactory solution for the problems (and the limitations of VBA) I stumble upon. I do not simply copy code of others, I really try to understand it as well, so I can learn from it. Long story short: I used code I found for dragging data from one listbox to another. Originally, the code (for 2 listboxes) was simply put in the form's code module but I wanted to use it in a class module so I don't have to copy/paste the same code for each and every d&amp;d listbox I use on a form. The code I use:</p>\n\n<p>(Code module of the form; just the listbox part)</p>\n\n<pre><code>Option Explicit\nPrivate collection_ListBox As New collection\nPrivate collection_ComboBox As New collection\nPrivate collection_Textbox As New collection\n\nPrivate Sub UserForm_Initialize()\n\nDim frm_control  As Control\n\nSet collection_ListBox = New collection\nSet collection_ComboBox = New collection\nSet collection_Textbox = New collection\n\nFor Each frm_control In Me.Controls\n\n    Select Case TypeName(frm_control)\n\n        Case \"ListBox\"\n\n            Dim obj As CfrwxDragDropList: Set obj = New CfrwxDragDropList\n            Set obj.FRWX_Control = frm_control: obj.Initialize\n            collection_ListBox.Add obj\n\n        Case \"ComboBox\"\n\n        Case \"TextBox\"\n\n    End Select\n\nNext frm_control\n\n'***TEMP for testing purposes***\nListBox1.List = Array(\"Item1\", \"Item2\", \"Item3\", \"Item4\", \"Item5\", \"Item6\", \"Item7\")\n\nEnd Sub\n</code></pre>\n\n<p>(Code module of the class)</p>\n\n<pre><code>Option Explicit\nPrivate WithEvents FRWX_DragDrop As msforms.ListBox\nPrivate Item_Source As msforms.ListBox\n\nPublic Property Get FRWX_Control() As msforms.ListBox\n\nSet FRWX_Control = FRWX_DragDrop\nEnd Property\n\nPublic Property Set FRWX_Control(reg_Control As msforms.ListBox)\n\nSet FRWX_DragDrop = reg_Control\nEnd Property\n\nPublic Sub Initialize()\n\n'Nothing here yet!\n\nEnd Sub\n\nPrivate Sub FRWX_DragDrop_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, _\nByVal X As Single, ByVal Y As Single)\n\nIf FRWX_Control.ListIndex &lt; 0 Then Exit Sub\nIf Button = 1 Then\n\n    Call SetDraggedItem(FRWX_Control)\nEnd If\nEnd Sub\n\nPrivate Sub FRWX_DragDrop_BeforeDragOver(ByVal Cancel As msforms.ReturnBoolean, _\nByVal Data As msforms.DataObject, ByVal X As Single, ByVal Y As Single, _\nByVal DragState As Long, ByVal Effect As msforms.ReturnEffect, _\nByVal Shift As Integer)\n\nCancel = True\nEffect = fmDropEffectMove\nEnd Sub\n\n Private Sub FRWX_DragDrop_BeforeDropOrPaste(ByVal Cancel As msforms.ReturnBoolean, _\nByVal Action As msforms.fmAction, _\nByVal Data As msforms.DataObject, ByVal X As Single, ByVal Y As Single, _\nByVal Effect As msforms.ReturnEffect, ByVal Shift As Integer)\n\nCancel = True\nEffect = fmDropEffectMove\n\nCall AddDroppedItem(FRWX_Control, Data, Y)\nCall DeleteDraggedItem(Item_Source)\nEnd Sub\n\nPrivate Sub SetDraggedItem(lb As msforms.ListBox)\n\nSet Item_Source = lb\n\nDim dataObj As New DataObject\ndataObj.SetText lb.Text\nCall dataObj.StartDrag(fmDropEffectMove)\nEnd Sub\n\nPrivate Sub AddDroppedItem(lb As msforms.ListBox, dataObj As DataObject, Y As Single)\n\nlb.AddItem dataObj.GetText, FixDropIndex(lb, Y)\nEnd Sub\n\nPrivate Sub DeleteDraggedItem(lb As msforms.ListBox)\n\nDim selIndex As Long\n\nWith lb\n\n    selIndex = .ListIndex\n    .Selected(selIndex) = False\n    .RemoveItem selIndex\nEnd With\n\nSet Item_Source = Nothing\nEnd Sub\n\nPrivate Function FixDropIndex(lb As msforms.ListBox, Y As Single) As Long\n\nDim toIndex As Long\n\nWith lb\n\n    toIndex = .TopIndex + Int(Y * 0.85 / .Font.Size)\n\n    If toIndex &lt; 0 Then toIndex = 0\n    If toIndex &gt;= .ListCount Then toIndex = .ListCount\nEnd With\n\nFixDropIndex = toIndex\nEnd Function\n</code></pre>\n\n<p>So far so good; everything works fine except for one tiny little thing: I get an error on </p>\n\n<pre><code>Call DeleteDraggedItem(Item_Source) \n</code></pre>\n\n<p>in the sub FRWX_DragDrop_BeforeDropOrPaste. I know WHY I get this error: when I drop the DataObject in ListBox2, Item_Source in the corresponding instance of the class will be empty for it was filled in the ListBox1 instance of the class. So I need a way to let ListBox2 know the source of the dropped text. I can think of 2 ways of fixing this. </p>\n\n<ol>\n<li>The first one sends shivers down my spine only thinking of it, for it feels almost like blasphemy: I could send it with the DataObject along with the text itself by 'expanding' lb.Text with \"|\" followed by lb.Name and split the string in the receiving instance. It will work, but I don't like this kind of solutions.</li>\n<li>I could pass the name of the source ListBox to the parent (being the form itself) from instance 1, so instance 2 can ask for it there. I haven't tried that solution yet, but I'm sure I'll get it to work.</li>\n</ol>\n\n<p>So now for my questions: \n1. is solution 2 a/the right way to go?\n2. are there other/better solutions I haven't thought of yet?</p>\n\n<p>Any help will be highly appreciated!</p>\n\n<p>***** UPDATE *****\nAs mentioned below, I found another (I think better) fix myself. The events are still triggered from the class instances for each listbox, but I used a separate, single instance of a class that performs the actual actions attached to them. Here's the updated code:</p>\n\n<p>(Code module of the form; just the listbox part)</p>\n\n<pre><code>Option Explicit\nPrivate collection_ListBox As New collection\nPrivate collection_ComboBox As New collection\nPrivate collection_Textbox As New collection\n\nPrivate Sub UserForm_Initialize()\n\nDim frm_control  As Control\n\nSet collection_ListBox = New collection\nSet collection_ComboBox = New collection\nSet collection_Textbox = New collection\n\n Dim handler As CfrwxDragDropList_EventHandler: Set handler = New CfrwxDragDropList_EventHandler\n\nFor Each frm_control In Me.Controls\n\n    Select Case TypeName(frm_control)\n\n        Case \"ListBox\"\n\n            Dim obj As CfrwxDragDropList: Set obj = New CfrwxDragDropList\n            Set obj.FRWX_Control = frm_control: obj.Initialize\n            Set obj.FRWX_EventHandler = handler\n\n            collection_ListBox.Add obj\n\n        Case \"ComboBox\"\n\n        Case \"TextBox\"\n\n    End Select\n\nNext frm_control\n\n'***TEMP for testing purposes***\nListBox1.List = Array(\"Item1\", \"Item2\", \"Item3\", \"Item4\", \"Item5\", \"Item6\", \"Item7\")\n\nEnd Sub\n</code></pre>\n\n<p>(Code module of the listbox class \"CfrwxDragDropList\"</p>\n\n<pre><code>Option Explicit\nPrivate WithEvents FRWX_DragDrop As MSForms.ListBox\nPrivate FRWX_DragDrop_Handler As CfrwxDragDropList_EventHandler\nPrivate Item_Source As MSForms.ListBox\n\nPublic Property Get FRWX_Control() As MSForms.ListBox\n\nSet FRWX_Control = FRWX_DragDrop\nEnd Property\n\nPublic Property Set FRWX_Control(reg_Control As MSForms.ListBox)\n\nSet FRWX_DragDrop = reg_Control\nEnd Property\n\nPublic Property Get FRWX_EventHandler() As CfrwxDragDropList_EventHandler\n\nSet FRWX_EventHandler = FRWX_DragDrop_Handler\nEnd Property\n\nPublic Property Set FRWX_EventHandler(handler As CfrwxDragDropList_EventHandler)\n\nSet FRWX_DragDrop_Handler = handler\nEnd Property\n\nPublic Sub Initialize()\n\n'Nothing here yet!\n\nEnd Sub\n\nPrivate Sub FRWX_DragDrop_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, _\nByVal X As Single, ByVal Y As Single)\n\nIf FRWX_Control.ListIndex &lt; 0 Then Exit Sub\nIf Button = 1 Then\n\n    Call FRWX_DragDrop_Handler.SetDraggedItem(FRWX_Control)\nEnd If\nEnd Sub\n\nPrivate Sub FRWX_DragDrop_BeforeDragOver(ByVal Cancel As MSForms.ReturnBoolean, _\nByVal Data As MSForms.DataObject, ByVal X As Single, ByVal Y As Single, _\nByVal DragState As Long, ByVal Effect As MSForms.ReturnEffect, _\nByVal Shift As Integer)\n\nCancel = True\nEffect = fmDropEffectMove\nEnd Sub\n\nPrivate Sub FRWX_DragDrop_BeforeDropOrPaste(ByVal Cancel As MSForms.ReturnBoolean, _\nByVal Action As MSForms.fmAction, _\nByVal Data As MSForms.DataObject, ByVal X As Single, ByVal Y As Single, _\nByVal Effect As MSForms.ReturnEffect, ByVal Shift As Integer)\n\nCancel = True\nEffect = fmDropEffectMove\n\nCall FRWX_DragDrop_Handler.AddDroppedItem(FRWX_Control, Data, Y)\nCall FRWX_DragDrop_Handler.DeleteDraggedItem\nEnd Sub\n</code></pre>\n\n<p>(Code module of the eventhandler class \"CfrwxDragDropList_EventHandler\"</p>\n\n<pre><code>Option Explicit\nPrivate Item_Source As MSForms.ListBox\n\nPublic Sub SetDraggedItem(lb As MSForms.ListBox)\n\nSet Item_Source = lb\n\nDim dataObj As New DataObject\ndataObj.SetText lb.Text\nCall dataObj.StartDrag(fmDropEffectMove)\nEnd Sub\n\nPublic Sub AddDroppedItem(lb As MSForms.ListBox, dataObj As DataObject, Y As Single)\n\nlb.AddItem dataObj.GetText, FixDropIndex(lb, Y)\nEnd Sub\n\nPublic Sub DeleteDraggedItem()\n\nDim selIndex As Long\n\nWith Item_Source\n\n    selIndex = .ListIndex\n    .Selected(selIndex) = False\n    .RemoveItem selIndex\nEnd With\n\nSet Item_Source = Nothing\nEnd Sub\n\nPrivate Function FixDropIndex(lb As MSForms.ListBox, Y As Single) As Long\n\nDim toIndex As Long\n\nWith lb\n\n    toIndex = .TopIndex + Int(Y * 0.85 / .Font.Size)\n\n    If toIndex &lt; 0 Then toIndex = 0\n    If toIndex &gt;= .ListCount Then toIndex = .ListCount\nEnd With\n\nFixDropIndex = toIndex\nEnd Function\n</code></pre>\n\n<p>That's it! It works between 2 listboxes, but if you want to use more it'll work as well. You can move items between listboxes, but also change the order of items within a listbox.</p>\n"}, {"tags": ["vba", "excel", "filter", "listbox"], "answers": [{"tags": [], "owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "is_accepted": true, "score": 0, "last_activity_date": 1521057052, "creation_date": 1521057052, "answer_id": 49286572, "question_id": 49285823, "link": "https://stackoverflow.com/questions/49285823/populating-2-listbox-with-diferent-rows/49286572#49286572", "title": "Populating 2 listbox with diferent rows", "body": "<p>For the one list box (<code>lbox_done</code>), couldn't you change:</p>\n\n<pre><code>If Cell Like \"*\" &amp; Search_name &amp; \"*\" Then\n</code></pre>\n\n<p>line to this:</p>\n\n<pre><code>If Cell Like \"*\" &amp; Search_name &amp; \"*\" And Worksheets(\"Pedidos\").Range(\"I\" &amp; Row_Counter) = \"NO\" Then\n</code></pre>\n\n<p>And you can then create a duplicate list (i.e. <code>MyList2</code>) with the conditions changed to this:</p>\n\n<pre><code>If Cell Like \"*\" &amp; Search_name &amp; \"*\" And Worksheets(\"Pedidos\").Range(\"I\" &amp; Row_Counter) = \"SI\" Then\n</code></pre>\n\n<p>which you could assign to the other list box -- <code>lbox_por</code>.</p>\n"}], "owner": {"reputation": 61, "user_id": 9070508, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-sMZ_fkLoYA8/AAAAAAAAAAI/AAAAAAAAKvM/rpQRHY_qivw/photo.jpg?sz=128", "display_name": "Juan Hernandez", "link": "https://stackoverflow.com/users/9070508/juan-hernandez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 49286572, "answer_count": 1, "score": 0, "last_activity_date": 1521102252, "creation_date": 1521054191, "last_edit_date": 1521102252, "question_id": 49285823, "link": "https://stackoverflow.com/questions/49285823/populating-2-listbox-with-diferent-rows", "title": "Populating 2 listbox with diferent rows", "body": "<p>i have 1 combobox and 2 listbox on my userform:</p>\n\n<ol>\n<li><code>cbox_rrhh</code></li>\n<li><code>lbox_por</code></li>\n<li><code>lbox_done</code></li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/9dMwS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9dMwS.png\" alt=\"enter image description here\"></a></p>\n\n<p>and a sheet \"Pedidos\" like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/7ar6u.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7ar6u.png\" alt=\"![enter image description here\"></a></p>\n\n<p>I found a way to filter the listbox data following the combobox value which is the one at the \"J\" column ex(roraima,karla,yvonne,sara) but i also need the rows be shown on <code>lbox_por</code> if the column \"J\" matches \"Si\" if is \"NO\" got to load those rows in the <code>lbox_done</code>\".</p>\n\n<p>Code used: </p>\n\n<pre><code>    Private Sub cbo_rrhh_Change()\nDim Cell As Range                   'defining your searcharea\nDim Row_Counter As Integer          'rowno\nDim Pos As Integer                  'rowno in array\nDim MyList() As String              'the array\nDim No_Pos As Integer               'total rows in aray\nDim Search_name As String           'searchvalue in combobox\nDim Real_last_row As Integer        'last row in \"Pedidos\"\n\n'xllastrow is a function\n\nReal_last_row = xlLastRow(\"Pedidos\") 'last row in \"Pedidos\"\n\nSearch_name = cbo_rrhh.Value\n\n'Searching in \"Pedidos\" for matches with searchstring\n\nFor Each Cell In Worksheets(\"Pedidos\").Range(\"J2:J\" &amp; Real_last_row)\n    If Cell Like \"*\" &amp; Search_name &amp; \"*\" Then\n'If a value matches with the searchstring, number of rows of array is + 1\n        No_Pos = No_Pos + 1\n    End If\nNext Cell\n\nRow_Counter = 2                  'start of the nameslist\nPos = 0                          'rowno in array, beginning with zero\nReDim Preserve MyList(No_Pos, 8) 'Redimming of array with total no of rows and 3 columns\n\n'if value isn't in searchstring then rowno is rowno + 1\n'if a match is found the array is filled and the rowno in array is + 1\n\nFor Each Cell In Worksheets(\"Pedidos\").Range(\"J2:J\" &amp; Real_last_row)\n    If Cell Like \"*\" &amp; Search_name &amp; \"*\" Then\n        MyList(Pos, 0) = Worksheets(\"Pedidos\").Range(\"A\" &amp; Row_Counter)\n        MyList(Pos, 1) = Worksheets(\"Pedidos\").Range(\"B\" &amp; Row_Counter)\n        MyList(Pos, 2) = Worksheets(\"Pedidos\").Range(\"C\" &amp; Row_Counter)\n        MyList(Pos, 3) = Worksheets(\"Pedidos\").Range(\"E\" &amp; Row_Counter)\n        MyList(Pos, 4) = Worksheets(\"Pedidos\").Range(\"F\" &amp; Row_Counter)\n        MyList(Pos, 5) = Worksheets(\"Pedidos\").Range(\"G\" &amp; Row_Counter)\n        MyList(Pos, 6) = Worksheets(\"Pedidos\").Range(\"H\" &amp; Row_Counter)\n        MyList(Pos, 7) = Worksheets(\"Pedidos\").Range(\"I\" &amp; Row_Counter)\n        MyList(Pos, 8) = Worksheets(\"Pedidos\").Range(\"J\" &amp; Row_Counter)\n        Pos = Pos + 1\n        Row_Counter = Row_Counter + 1\n    Else\n        Row_Counter = Row_Counter + 1\n    End If\nNext Cell\nApplication.ShowToolTips = True\n\nWith lbox_por\n    .ColumnCount = 10                           'no of columns (0,1,2)\n    .ControlTipText = \"Pedidos pendientes ...\"    'tiptext\n\nEnd With\nWith lbox_done\n    .ColumnCount = 9                           'no of columns (0,1,2)\n    .ControlTipText = \"Pedidos realizados ...\"    'tiptext\n\nEnd With\nlbox_por.List = MyList                          'define the list of listbox1\nlbox_done.List = MyList\n\nEnd Sub\n</code></pre>\n\n<p>and for context:\nFecha: means Date.\nPalabras: Words.\nTasa: Rate.\nMonto: Amount.\nPagado: Paid out.\nRedactor: Writer.</p>\n"}, {"tags": ["excel", "memory-leaks", "vba"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521054925, "post_id": 49285816, "comment_id": 85574806, "body": "Without me pouring through all of your code, I can tell you the most common cause of memory leaks in VBA is <b>improper handling of objects</b>.  Is every object you&#39;re creating being properly cleared and closed when you&#39;re done with it?  Also, make sure you always have <code>Option Explicit</code> at the top of <b>every</b> module (to make sure you&#39;re declaring and manipulating your objects and variables properlly), and no code like <code>on error resume next</code> which will ignore errors."}, {"owner": {"reputation": 11, "user_id": 4574809, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/G3ADN.jpg?s=128&g=1", "display_name": "Son Goku ssj4", "link": "https://stackoverflow.com/users/4574809/son-goku-ssj4"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521059853, "post_id": 49285816, "comment_id": 85577477, "body": "Hi, did you at least read my introductory text? I describe there that the main part that is, I think, leaking, is grabbed from another else. And I don&#39;t understand the code, too complicated for me. I don&#39;t do <code>Private Declare Function</code> stuff nowhere in my own code for example. But the original author does have &quot;Clean up (very important to avoid memory leaks)&quot; comment so I thought it would be ok. But from the moment I started to use the <code>GetStringPixelWidth</code>, it just slows everything down from repeating run to run."}, {"owner": {"reputation": 11, "user_id": 4574809, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/G3ADN.jpg?s=128&g=1", "display_name": "Son Goku ssj4", "link": "https://stackoverflow.com/users/4574809/son-goku-ssj4"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521060657, "post_id": 49285816, "comment_id": 85577824, "body": "And yes. I&#39;m using <code>Option Explicit</code> everywhere and trying to end objects well and do other stuff and that&#39;s the reason, I hope, that my 15 Userforms, 15 Modules, 6 Classes VBA project had no problem till today, when I implemented this Module. (I&#39;m not using on error resume next)"}, {"owner": {"reputation": 11, "user_id": 4574809, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/G3ADN.jpg?s=128&g=1", "display_name": "Son Goku ssj4", "link": "https://stackoverflow.com/users/4574809/son-goku-ssj4"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521063860, "post_id": 49285816, "comment_id": 85579319, "body": "Last note: I&#39;ve just commented the line in my code that is calling the function <code>getLstColumnWidths</code> and what a surprise. The code is fast again. :-)   Sadly, I&#39;m not experienced enough to find the leak or the reason for the code to be so slow and getting progressively slower each run by myself. That&#39;s the reason I&#39;m writing here."}], "owner": {"reputation": 11, "user_id": 4574809, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/G3ADN.jpg?s=128&g=1", "display_name": "Son Goku ssj4", "link": "https://stackoverflow.com/users/4574809/son-goku-ssj4"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 652, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1521054166, "creation_date": 1521054166, "last_edit_date": 1531164843, "question_id": 49285816, "link": "https://stackoverflow.com/questions/49285816/memory-leak-in-excel-vba-module", "title": "Memory leak in Excel VBA module", "body": "<p>I've needed a function that would scan my Array and return <code>ColumnWidths</code> for my <code>ListBox</code> in <code>UserForm</code>. After a while, I've found <a href=\"https://stackoverflow.com/questions/5012465/vb-macro-string-width-in-pixel\">This StackOverflow topic</a>. There was a little mistake that I've fixed and used the code. Works really well! </p>\n\n<p>But I've noticed that when I open and close my UserForm few times (10-20x), the opening is longer and longer. And the Memory usage of the Excel is getting bigger too. Around 1MB for each run.</p>\n\n<p>So I think it is this module. Does anyone has the ability to see if there is a memory leak there?</p>\n\n<p>The code I use is:</p>\n\n<pre><code>Option Explicit\n\n' ==========================================================================\n' SOURCE for this module, slightly modified code from TravelinGuy\n' https://stackoverflow.com/questions/5012465/vb-macro-string-width-in-pixel\n'\n' Adds functions:\n'     GetStringPixelHeight(text:Str, fontName:Str, fontSize:Single, _\n'                          [isBold:Bool=False], [isItalics:Bool=False])\n'     GetStringPixelWidth(text:Str, fontName:Str, fontSize:Single, _\n'                         [isBold:Bool=False], [isItalics:Bool=False]))\n'     GetLabelPixelHeight(label:Str)\n'     GetLabelPixelWidth(label:Str)\n' ==========================================================================\n\n'API Declares\n\nPrivate Declare Function CreateDC Lib \"gdi32.dll\" Alias \"CreateDCA\" (ByVal lpDriverName As String, ByVal lpDeviceName As String, ByVal lpOutput As String, lpInitData As Long) As Long\nPrivate Declare Function CreateCompatibleBitmap Lib \"gdi32.dll\" (ByVal hdc As Long, ByVal nWidth As Long, ByVal nHeight As Long) As Long\nPrivate Declare Function CreateFontIndirect Lib \"gdi32.dll\" Alias \"CreateFontIndirectA\" (lpLogFont As LOGFONT) As Long\nPrivate Declare Function SelectObject Lib \"gdi32.dll\" (ByVal hdc As Long, ByVal hObject As Long) As Long\nPrivate Declare Function DeleteObject Lib \"gdi32.dll\" (ByVal hObject As Long) As Long\nPrivate Declare Function GetTextExtentPoint32 Lib \"gdi32.dll\" Alias \"GetTextExtentPoint32A\" (ByVal hdc As Long, ByVal lpsz As String, ByVal cbString As Long, lpSize As FNTSIZE) As Long\nPrivate Declare Function MulDiv Lib \"kernel32.dll\" (ByVal nNumber As Long, ByVal nNumerator As Long, ByVal nDenominator As Long) As Long\nPrivate Declare Function GetDC Lib \"user32.dll\" (ByVal hwnd As Long) As Long\nPrivate Declare Function GetDeviceCaps Lib \"gdi32.dll\" (ByVal hdc As Long, ByVal nIndex As Long) As Long\nPrivate Declare Function DeleteDC Lib \"gdi32.dll\" (ByVal hdc As Long) As Long\n\nPrivate Const LOGPIXELSY As Long = 90\n\nPrivate Type LOGFONT\n    lfHeight As Long\n    lfWidth As Long\n    lfEscapement As Long\n    lfOrientation As Long\n    lfWeight As Long\n    lfItalic As Byte\n    lfUnderline As Byte\n    lfStrikeOut As Byte\n    lfCharSet As Byte\n    lfOutPrecision As Byte\n    lfClipPrecision As Byte\n    lfQuality As Byte\n    lfPitchAndFamily As Byte\n    lfFaceName As String * 32\nEnd Type\n\nPrivate Type FNTSIZE\n    cx As Long\n    cy As Long\nEnd Type\n\n\nPublic Function GetLabelPixelWidth(label As String) As Integer\n\n    Dim font As New StdFont\n    Dim sz As FNTSIZE\n    font.Name = \"Arial Narrow\"\n    font.size = 9.5\n\n    sz = GetLabelSize(label, font)\n    GetLabelPixelWidth = sz.cx\n\nEnd Function\n\n\nPublic Function GetStringPixelHeight(text As String, fontName As String, fontSize As Single, Optional isBold As Boolean = False, Optional isItalics As Boolean = False) As Integer\n\n    Dim font As New StdFont\n    Dim sz As FNTSIZE\n    font.Name = fontName\n    font.size = fontSize\n    font.Bold = isBold\n    font.Italic = isItalics\n\n    sz = GetLabelSize(text, font)\n    GetStringPixelHeight = sz.cy\n\nEnd Function\n\n\nPublic Function GetStringPixelWidth(text As String, fontName As String, fontSize As Single, Optional isBold As Boolean = False, Optional isItalics As Boolean = False) As Integer\n\n    Dim font As New StdFont\n    Dim sz As FNTSIZE\n    font.Name = fontName\n    font.size = fontSize\n    font.Bold = isBold\n    font.Italic = isItalics\n\n    sz = GetLabelSize(text, font)\n    GetStringPixelWidth = sz.cx\n\nEnd Function\n\n\nPrivate Function GetLabelSize(text As String, font As StdFont) As FNTSIZE\n    Dim tempDC As Long\n    Dim tempBMP As Long\n    Dim f As Long\n    Dim lf As LOGFONT\n    Dim textSize As FNTSIZE\n\n    ' Create a device context and a bitmap that can be used to store a\n    ' temporary font object\n    tempDC = CreateDC(\"DISPLAY\", vbNullString, vbNullString, ByVal 0)\n    tempBMP = CreateCompatibleBitmap(tempDC, 1, 1)\n\n    ' Assign the bitmap to the device context\n    DeleteObject SelectObject(tempDC, tempBMP)\n\n    ' Set up the LOGFONT structure and create the font\n    lf.lfFaceName = font.Name &amp; Chr$(0)\n    lf.lfHeight = -MulDiv(font.size, GetDeviceCaps(GetDC(0), 90), 72) 'LOGPIXELSY\n    lf.lfItalic = font.Italic\n    lf.lfStrikeOut = font.Strikethrough\n    lf.lfUnderline = font.Underline\n    If font.Bold Then lf.lfWeight = 800 Else lf.lfWeight = 400\n    f = CreateFontIndirect(lf)\n\n    ' Assign the font to the device context\n    DeleteObject SelectObject(tempDC, f)\n\n    ' Measure the text, and return it into the textSize SIZE structure\n    GetTextExtentPoint32 tempDC, text, Len(text), textSize\n\n    ' Clean up (very important to avoid memory leaks!)\n    DeleteObject f\n    DeleteObject tempBMP\n    DeleteDC tempDC\n    ' Return the measurements\n    GetLabelSize = textSize\n\nEnd Function\n</code></pre>\n\n<p>And function that is used to construct the <code>ListBox.ColumnWidths</code> string is:</p>\n\n<pre><code>' Return string with column widths from entered myarray values for lstbox.ColumnWidths\n' Example: \"80;40;49;65;30;21;19;65\"\n'---------------------------------------------------------------------------------------\nPublic Function getLstColumnWidths(ByVal myarray As Variant, _\n                                   Optional multiplier As Single = 1) As String\n\n    Dim currentVal As Long\n    Dim longestVal As Long\n\n    ' Get Column Widths from the largest string in column\n    getLstColumnWidths = \"\"\n\n    Dim i As Long\n    Dim j As Long\n    For i = LBound(myarray, 1) To UBound(myarray, 1)\n        longestVal = 0\n        For j = LBound(myarray, 2) To UBound(myarray, 2)\n            Dim strText As String\n            strText = myarray(i, j)\n            ' MEMORY LEAKS?\n            currentVal = GetStringPixelWidth(strText, \"Tahoma\", 8  ' &lt;-- USED HERE\n            longestVal = IIf(currentVal &gt; longestVal, currentVal, longestVal)\n        Next j\n        getLstColumnWidths = getLstColumnWidths &amp; _\n            CStr(Round(longestVal * multiplier, 1)) &amp; \";\"\n    Next i\n    getLstColumnWidths = Left(getLstColumnWidths, Len(getLstColumnWidths) - 1)\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1521055310, "post_id": 49285744, "comment_id": 85575005, "body": "It gives you this error and an option to hit the &quot;Debug&quot; button. When you do so, which line is highlighted?"}, {"owner": {"reputation": 1, "user_id": 9493304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e04b8eebdb76db57a6a2cc3704fa9f8?s=128&d=identicon&r=PG&f=1", "display_name": "Pranav", "link": "https://stackoverflow.com/users/9493304/pranav"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1521056477, "post_id": 49285744, "comment_id": 85575657, "body": "@JNevill  MyFile = Dir(Directory &amp; &quot;*.xlsx&quot;) this line gets highlighted on error"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1521057797, "post_id": 49285744, "comment_id": 85576420, "body": "Are you choosing a local directory or one on a server? Do you have authority to see/read the files in that directory? Are there any special characters in the file names in that folder? DIR can be kind of picky."}, {"owner": {"reputation": 1, "user_id": 9493304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e04b8eebdb76db57a6a2cc3704fa9f8?s=128&d=identicon&r=PG&f=1", "display_name": "Pranav", "link": "https://stackoverflow.com/users/9493304/pranav"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1521058656, "post_id": 49285744, "comment_id": 85576902, "body": "I am choosing local directory. I can read even edit those files. File names contain parentheses &quot;()&quot; and periods(.) . Is that causing an error when selecting a file ?  I tried to download the files and tried access those without changing names. The code worked fine that time."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1521059606, "post_id": 49285744, "comment_id": 85577367, "body": "Probably the Parentheses. Dir is old school and it&#39;s picky. Can you try renaming or pointing at a different directory just to see if your code works, that would narrow it down."}, {"owner": {"reputation": 1, "user_id": 9493304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e04b8eebdb76db57a6a2cc3704fa9f8?s=128&d=identicon&r=PG&f=1", "display_name": "Pranav", "link": "https://stackoverflow.com/users/9493304/pranav"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1521059849, "post_id": 49285744, "comment_id": 85577473, "body": "Yes. I tried changing the directory. Code works fine with other path directory"}, {"owner": {"reputation": 1, "user_id": 9493304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e04b8eebdb76db57a6a2cc3704fa9f8?s=128&d=identicon&r=PG&f=1", "display_name": "Pranav", "link": "https://stackoverflow.com/users/9493304/pranav"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1521063280, "post_id": 49285744, "comment_id": 85579052, "body": "@JNevill I am sorry. I kind of misunderstood you. with directory, I was assuming path directory like &quot;C:\\&quot; etc and not the Dir() function. If possibly you know any, can you please mention, an alternative directory to Dir()? Thank you."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1521122508, "post_id": 49285744, "comment_id": 85604724, "body": "<a href=\"https://stackoverflow.com/questions/43367671/vba-excel-iterating-through-files-in-folder-via-filesystemobject/43369428\">Check out this answer</a> where they use the FSO library. I think that will do what you need."}, {"owner": {"reputation": 1, "user_id": 9493304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e04b8eebdb76db57a6a2cc3704fa9f8?s=128&d=identicon&r=PG&f=1", "display_name": "Pranav", "link": "https://stackoverflow.com/users/9493304/pranav"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1521219131, "post_id": 49285744, "comment_id": 85653231, "body": "@JNevill Thank you for sharing the thread. I was trying different ways and come up with something. Since it&#39;s a mapped network drive, I provided the actual path in With loop instead of &#39;.SelectedItems(1) query. Now code runs fine but gives error randomly Error 1004: File could not be found.  All files are there. Sometimes it picks up the file and sometimes gives an error"}, {"owner": {"reputation": 1, "user_id": 9493304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e04b8eebdb76db57a6a2cc3704fa9f8?s=128&d=identicon&r=PG&f=1", "display_name": "Pranav", "link": "https://stackoverflow.com/users/9493304/pranav"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1521237271, "post_id": 49285744, "comment_id": 85662149, "body": "Ok. So I tried a lot of different ways, went through internet to fix that error but it didn&#39;t help me. Finally, I repaired my MS Office and then the code worked fine after that. Thank you very much @JNevill for all help."}], "owner": {"reputation": 1, "user_id": 9493304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e04b8eebdb76db57a6a2cc3704fa9f8?s=128&d=identicon&r=PG&f=1", "display_name": "Pranav", "link": "https://stackoverflow.com/users/9493304/pranav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521074197, "creation_date": 1521053828, "last_edit_date": 1531164843, "question_id": 49285744, "link": "https://stackoverflow.com/questions/49285744/error-when-importing-files-from-sharepoint", "title": "Error when importing files from sharepoint", "body": "<p>I am new to VBA and this forum has been very helpful to me. I follow the threads posted on this forum to find answers to my questions and I would like to thank you all for providing awesome solutions. </p>\n\n<p>I am currently working on generating a summarysheet from the excel files posted on SharePoint. I have mapped the sharepoint as a network drive. I am trying to open all files from sharepoint folder one after another, copy the required data from different tabs, paste it to summary sheet and close the file. When I try to run the code, it gives me a run time error 52 as 'bad file name or number'.</p>\n\n<p>I have pasted the part of my code here. Any kind of help in this matter is really appreciated.</p>\n\n<p>Thank you,\nPranav</p>\n\n<pre><code>Option Explicit\nSub GenerateSummary()\n\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\n\nDim Directory As String\nDim MyFile As String\nDim SummarySheet As Workbook\n\nSet SummarySheet = Workbooks.Add\n\nWith Application.FileDialog(msoFileDialogFolderPicker)\n    .Title = \"Please select a folder\"\n    .Show\n    .AllowMultiSelect = False\n\n    If .SelectedItems.Count = 0 Then\n        MsgBox (\"You did not select a folder\")\n        Exit Sub\n    End If\n\n    Directory = .SelectedItems(1) &amp; \"\\\"\nEnd With\n\nMyFile = Dir(Directory &amp; \"*.xlsx\")\n\nDo While MyFile &lt;&gt; \"\"\n    Workbooks.Open (Directory &amp; MyFile)\n    Sheets(Array(1, 2)).Select\n    Sheets(1).Activate\n    Sheets(Array(1, 2)).Copy Before:=SummarySheet.Sheets(1)\n    ' Other statistics are calculated and operations are performed here\n\n    MyFile = Dir()\n    ActiveWindow.ActivateNext\n    ActiveWorkbook.Close\nLoop\nApplication.ScreenUpdating = True\nApplication.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "vlookup"], "comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 1, "creation_date": 1521057186, "post_id": 49285663, "comment_id": 85576062, "body": "you need to understand the difference between a single cell and a range. You can&#39;t compare a range like this <code>Range(&quot;E2:E&quot; &amp; LR) = &quot;&quot;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1521055844, "creation_date": 1521055844, "answer_id": 49286271, "question_id": 49285663, "link": "https://stackoverflow.com/questions/49285663/vlookup-a-value-from-multiple-sheets-in-same-workbook/49286271#49286271", "title": "Vlookup a value from multiple sheets in same workbook", "body": "<p>The first argument of a Vlookup must be a single value, not a range </p>\n"}, {"comments": [{"owner": {"reputation": 61, "user_id": 8914879, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/662b72fa1a0c6e98e0144db62ec12685?s=128&d=identicon&r=PG&f=1", "display_name": "user2574", "link": "https://stackoverflow.com/users/8914879/user2574"}, "edited": false, "score": 0, "creation_date": 1521122544, "post_id": 49292789, "comment_id": 85604750, "body": "Awesome !! Thanks a ton :)"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 0, "last_activity_date": 1521095343, "last_edit_date": 1521095343, "creation_date": 1521095023, "answer_id": 49292789, "question_id": 49285663, "link": "https://stackoverflow.com/questions/49285663/vlookup-a-value-from-multiple-sheets-in-same-workbook/49292789#49292789", "title": "Vlookup a value from multiple sheets in same workbook", "body": "<p><strong>First</strong>, as mentioned by @teylyn, the first parameter of <code>Vlookup</code> is a single value, not a <code>Range</code>.</p>\n\n<p><strong>Second</strong>, you can't use <code>Range(\"E2:E\" &amp; LR).Formula</code>, but on the right side use <code>Application.Vlookup</code>. You have 2 options:</p>\n\n<ol>\n<li><p>Use the <code>Value</code>, like <code>Range(\"E2:E\" &amp; LR).Value = Application.Vlookup...</code></p></li>\n<li><p>Use <code>Formula</code>, so you'll need to modify the right side: <code>Range(\"E2:E\" &amp; LR).Formula = \"VLookup(...\"</code> rest of the formula string.</p></li>\n</ol>\n\n<p><strong>Third</strong>, you need to trap the scenario if <code>Application.Vlookup</code> isn't able to find a match, otherwise it will throw you an error. You can do that by using:</p>\n\n<pre><code>If Not IsError(Application.Vlookup(.Range(\"M\" &amp; i).Value, Worksheets(\"WSS\").Range(\"A2:C999999\"), 3, False)) Then\n</code></pre>\n\n<p>Look at the code below, I used the <code>Value</code> option to look in both sheets.</p>\n\n<p><strong><em>Code</em></strong></p>\n\n<pre><code>Option Explicit\n\nSub Vlookup()\n\n' Vlookup Macro\nDim Sht As Worksheet\nDim LR As Long, i As Long\n\n' set the worksheet object\nSet Sht = ThisWorkbook.Worksheets(\"ORD_CS\")\n\nWith Sht\n    LR = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n\n    For i = 2 To LR\n        ' check that Vlookup succesfully found a match\n        If Not IsError(Application.Vlookup(.Range(\"M\" &amp; i).Value, Worksheets(\"WSS\").Range(\"A2:C999999\"), 3, False)) Then\n            .Range(\"E\" &amp; i).Value = Application.Vlookup(.Range(\"M\" &amp; i).Value, Worksheets(\"WSS\").Range(\"A2:C999999\"), 3, False)\n        Else ' Vlookup error\n            .Range(\"E\" &amp; i).Value = \"\"\n        End If\n    Next i\n\n    ' second loop, for empty cells from previous VLookup &gt;&gt; check in the second sheet\n    For i = 2 To LR\n        If .Range(\"E\" &amp; i).Value = \"\" Then\n            ' check that Vlookup succesfully found a match\n            If Not IsError(Application.Vlookup(.Range(\"M\" &amp; i).Value, Worksheets(\"IBC\").Range(\"C2:F999999\"), 3, False)) Then\n                .Range(\"E\" &amp; i).Value = Application.Vlookup(.Range(\"M\" &amp; i).Value, Worksheets(\"IBC\").Range(\"C2:F999999\"), 3, False)\n            Else ' Vlookup error &gt;&gt; raise an Error (like a log-file)\n                .Range(\"E\" &amp; i).Value = \"Couldn't find Value in both sheets!\"\n            End If\n        End If\n    Next i\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 8914879, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/662b72fa1a0c6e98e0144db62ec12685?s=128&d=identicon&r=PG&f=1", "display_name": "user2574", "link": "https://stackoverflow.com/users/8914879/user2574"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 680, "favorite_count": 0, "accepted_answer_id": 49292789, "answer_count": 2, "score": 1, "last_activity_date": 1521095343, "creation_date": 1521053590, "last_edit_date": 1521094980, "question_id": 49285663, "link": "https://stackoverflow.com/questions/49285663/vlookup-a-value-from-multiple-sheets-in-same-workbook", "title": "Vlookup a value from multiple sheets in same workbook", "body": "<p>Trying to lookup a value from multiple sheets. The first code is working. But the code from <code>IF FUNCTION</code> is throwing an error - </p>\n\n<blockquote>\n  <p>Type mismatch runtime error 13</p>\n</blockquote>\n\n<p>after first lookup, for all <code>#NA</code> in the column E, i need to lookup the value in the second sheet. </p>\n\n<pre><code>Sub Vlookup()\n\n' Vlookup Macro\n\n    Worksheets(\"ORD_CS\").Activate\n    Dim LR As Long\n    LR = Worksheets(\"ORD_CS\").UsedRange.Rows.Count\n    Range(\"E2:E\" &amp; LR).Formula = Application.Vlookup(Range(\"M2:M\" &amp; LR), Worksheets(\"WSS\").Range(\"A2:C999999\"), 3, False)\n    If Range(\"E2:E\" &amp; LR) = \"\" Then\n       Range(\"E2:E\" &amp; LR) = Application.Vlookup(Range(\"M2:M\" &amp; LR), Worksheets(\"IBC\").Range(\"C2:F999999\"), 4, False)\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1521052694, "post_id": 49285206, "comment_id": 85573633, "body": "General question - how do you suppose you&#39;re going to add a single cell&#39;s value (<code>C10</code>) to an entire column reference <code>H:H</code>? Do you mean <code>C10 + sum(H:H)</code>?"}, {"owner": {"reputation": 5, "user_id": 2052095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/514301fad1885722118cfd9087c9133b?s=128&d=identicon&r=PG", "display_name": "KD Gordon", "link": "https://stackoverflow.com/users/2052095/kd-gordon"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1521053245, "post_id": 49285206, "comment_id": 85573910, "body": "@BruceWayne - The formula in excel automatically finds the row that is associated with the formula. The formula for example is located in B22, it would add C10 to H22. I need to do that in VBA."}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1521053423, "post_id": 49285206, "comment_id": 85574034, "body": "General Question #2: C10 + H:H, means you want to add the value in C10 to every cell in column H?"}, {"owner": {"reputation": 5, "user_id": 2052095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/514301fad1885722118cfd9087c9133b?s=128&d=identicon&r=PG", "display_name": "KD Gordon", "link": "https://stackoverflow.com/users/2052095/kd-gordon"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1521053936, "post_id": 49285206, "comment_id": 85574317, "body": "@BruceWayne - That is correct. C10 hold current age. The values in column H hold how many year to add to the current age over a 30 year time period. So Year 1 we add age + 0, Year 2 we add age + 1, etc. and so on over said 30 year time frame. I am converting this to a macro so I can run years in 10 year increments. This needs to happen as I stated earlier in a complex if statement that compares age on one worksheet against age on another worksheet. I tried to just use Offset. But that didn&#39;t work."}, {"owner": {"reputation": 5, "user_id": 2052095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/514301fad1885722118cfd9087c9133b?s=128&d=identicon&r=PG", "display_name": "KD Gordon", "link": "https://stackoverflow.com/users/2052095/kd-gordon"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1521054105, "post_id": 49285206, "comment_id": 85574403, "body": "@BruceWayne This is what I originally tried before I realized I need to use an array for column H:  For Each r In rngStandardRate_mbr         If rngYr11 = &quot;Year 11&quot; Then             ElseIf rngTLRates_age = r.Offset(0, 6).Value + rngCalc_30yrMax_age_mbr Then             .                End If     Next r"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1521054114, "post_id": 49285206, "comment_id": 85574407, "body": "&quot;the formula in excel automatically finds the row&quot; - what formula?"}, {"owner": {"reputation": 5, "user_id": 2052095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/514301fad1885722118cfd9087c9133b?s=128&d=identicon&r=PG", "display_name": "KD Gordon", "link": "https://stackoverflow.com/users/2052095/kd-gordon"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1521055698, "post_id": 49285206, "comment_id": 85575218, "body": "@QHarr  - The formula =C10 + H:H. If you have that in cell B22 it will add C10 with H22."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1521057780, "post_id": 49285206, "comment_id": 85576406, "body": "In that circumstance, the formula adds the contents of <code>C10</code> to every cell in column <code>H</code>.  However, it only <b>displays</b>, the result of the addition of <code>C10+H22</code>.  If you examine more closely, you would find a very large array of values in <code>B22</code>"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1521058080, "post_id": 49285206, "comment_id": 85576588, "body": "I think it would be helpful if you clarify, in words, exactly what you are trying to accomplish.  Then provide some examples of data input and desired output.  (Do this by editing your original question, not in the comments which are difficult to format).  I&#39;m sure your name&#39;d ranges are clear to you, but they are confusing for me to follow."}, {"owner": {"reputation": 5, "user_id": 2052095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/514301fad1885722118cfd9087c9133b?s=128&d=identicon&r=PG", "display_name": "KD Gordon", "link": "https://stackoverflow.com/users/2052095/kd-gordon"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1521060307, "post_id": 49285206, "comment_id": 85577668, "body": "@RonRosenfeld - I made the edits you requested to my original request. I am almost certain I need to up these ranges (I.e  Worksheet2!C:C, Worsheet1!H:H, etc.) into arrays. The problem is I don&#39;t know how to then get the information out of the arrays.   I can put the data into an array:       arrCalc_30yrMax_age_annual_incr = ws_Calculator_TL_30yrMaxTerm.Range(&quot;H:H&quot;).Value  I need to know how to then get the data out of the array and add the original age to it."}, {"owner": {"reputation": 5, "user_id": 2052095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/514301fad1885722118cfd9087c9133b?s=128&d=identicon&r=PG", "display_name": "KD Gordon", "link": "https://stackoverflow.com/users/2052095/kd-gordon"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1521060798, "post_id": 49285206, "comment_id": 85577873, "body": "@RonRosenfeld - I also tried to put in a For Loop inside a function: fncCurrentAge_annual_incr = Application.WorksheetFunction.Sum(r.Offset(0, 6).Value, rngCalc_30yrMax_age_mbr) and that didn&#39;t work."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1521061686, "post_id": 49285206, "comment_id": 85578292, "body": "Unfortunately, I am still not clear on what you want to do. I do not see any data input or desired output values in what you have added.  If you want to make the formula <code>=C10+H:H</code> into an array, you will have an array of <code>1,048,576</code> entries which will take forever to set up and calculate in VBA. I don&#39;t believe that is what you want to do, or perhaps you are not understanding exactly what <code>=C10+H:H</code> represents."}, {"owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1521062552, "post_id": 49285206, "comment_id": 85578729, "body": "@ron: the H:H will be reduced to a single cell because Excel will apply implicit intersection in the formula (which is extremely efficient)"}, {"owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1521062719, "post_id": 49285206, "comment_id": 85578806, "body": "@ron: but VBA does not do Implicit Intersect - you need to make the VBA do it explicitly"}, {"owner": {"reputation": 5, "user_id": 2052095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/514301fad1885722118cfd9087c9133b?s=128&d=identicon&r=PG", "display_name": "KD Gordon", "link": "https://stackoverflow.com/users/2052095/kd-gordon"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1521065464, "post_id": 49285206, "comment_id": 85579977, "body": "@RonRosenfeld - I will edit my original comment. Yes, I do understand exactly what =C10+H:H does!"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "edited": false, "score": 0, "creation_date": 1521065480, "post_id": 49285206, "comment_id": 85579985, "body": "@CharlesWilliams I agree with you. But I am having a problem understanding exactly what the poster wants, speaking about needing to turn the formula into an array, and getting information out of them.  If you treat the formula as an array, and apply the <code>SUM</code> function, the result will be  <code>C10*1048576 + SUM(H:H)</code> I doubt that is what he wants, but I can&#39;t figure it out.  And yes, I can relate C10 to the cell that is being calculated (implicit intersection), but I&#39;m having a problem visualizing his data and figuring out how to advise him."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1521065806, "post_id": 49285206, "comment_id": 85580132, "body": "@KDGordon with regard to the formula in your edited post, you can&#39;t compare a single cell to a range in VBA like you can in Excel; you have to either loop through; or use <code>worksheetfunction.match</code> in an array; or use <code>range.find</code> on the worksheet."}, {"owner": {"reputation": 5, "user_id": 2052095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/514301fad1885722118cfd9087c9133b?s=128&d=identicon&r=PG", "display_name": "KD Gordon", "link": "https://stackoverflow.com/users/2052095/kd-gordon"}, "reply_to_user": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "edited": false, "score": 0, "creation_date": 1521066320, "post_id": 49285206, "comment_id": 85580336, "body": "@CharlesWilliams - I did not know that Excel will apply implicit intersection in the formula and VBA can&#39;t. That explains why my VBA code that I tried to do that with didn&#39;t work."}, {"owner": {"reputation": 5, "user_id": 2052095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/514301fad1885722118cfd9087c9133b?s=128&d=identicon&r=PG", "display_name": "KD Gordon", "link": "https://stackoverflow.com/users/2052095/kd-gordon"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1521066585, "post_id": 49285206, "comment_id": 85580436, "body": "@RonRosenfeld - I don&#39;t want to put the entire formula in an array. Just the H:H column. If that is too big (and I concede your point on that) I could condense that to a range such as H20:H1000. I did try a For Loop that I had in my original message, but took out to try to condense my request per your instructions.   I just need to get the data in Worksheet1 in each row of column H and add that to the data in C10 and then compare the result for each row to the data in Worksheet2 in each row of column C."}, {"owner": {"reputation": 5, "user_id": 2052095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/514301fad1885722118cfd9087c9133b?s=128&d=identicon&r=PG", "display_name": "KD Gordon", "link": "https://stackoverflow.com/users/2052095/kd-gordon"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1521067132, "post_id": 49285206, "comment_id": 85580641, "body": "@RonRosenfeld - I added the For Loop in it&#39;s entirety to the original message at the bottom."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 2052095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/514301fad1885722118cfd9087c9133b?s=128&d=identicon&r=PG", "display_name": "KD Gordon", "link": "https://stackoverflow.com/users/2052095/kd-gordon"}, "edited": false, "score": 0, "creation_date": 1521069453, "post_id": 49289043, "comment_id": 85581387, "body": "will try that! I\u2019m trying to calculate insurance rates based on age over a course of x years, 10 years at a time max 30 years."}, {"owner": {"reputation": 5, "user_id": 2052095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/514301fad1885722118cfd9087c9133b?s=128&d=identicon&r=PG", "display_name": "KD Gordon", "link": "https://stackoverflow.com/users/2052095/kd-gordon"}, "edited": false, "score": 0, "creation_date": 1521151224, "post_id": 49289043, "comment_id": 85621868, "body": "Thank you that worked with a few modifications. CHEERS!"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 5, "user_id": 2052095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/514301fad1885722118cfd9087c9133b?s=128&d=identicon&r=PG", "display_name": "KD Gordon", "link": "https://stackoverflow.com/users/2052095/kd-gordon"}, "edited": false, "score": 0, "creation_date": 1521163336, "post_id": 49289043, "comment_id": 85625445, "body": "@KDGordon Glad to help. If you could, I would appreciate it if you would mark my response as the answer. See Help for  <a href=\"https://stackoverflow.com/help/someone-answers\">What should I do when someone answers my question?</a>"}], "tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": true, "score": 0, "last_activity_date": 1521068881, "creation_date": 1521068881, "answer_id": 49289043, "question_id": 49285206, "link": "https://stackoverflow.com/questions/49285206/converting-excel-formula-to-vba-and-use-array/49289043#49289043", "title": "Converting Excel Formula to VBA and use Array", "body": "<p>Absent data and desired results, I remain uncertain as to just what you want. Perhaps this approach will help, if my assumptions are correct. If not, I'll delete it.</p>\n\n<p>I think what you are trying to do (based on your ELSEIF statement above)</p>\n\n<ul>\n<li>examine each value in Column C</li>\n<li>find the value in Column H that is equal to that value +10</li>\n<li>if you find such a value, do something.</li>\n<li>if your comparison is more complicated (eg finding an inexact match, and the values in column H are sorted, a different approach should be used)</li>\n</ul>\n\n<p>Here is one way of doing it. (and there are a number of others, in addition to looping through all the data -- exactly which is best (fastest) depends on the circumstances.</p>\n\n<pre><code>Option Explicit\n\n'Worsheets(\"Sheet2\").Range(\"C:C\") = C10 + Worsheets(\"Sheet1\").Range(\"H:H\")\n\nSub Marine()\n    Dim ws1 As Worksheet, ws2 As Worksheet\n    Dim r1 As Range, r2 As Range\n    Dim vToFind 'declare as a type of value ?date  ?long ?double\n    Dim c1 As Range, c2 As Range\n\nSet ws1 = Worksheets(\"sheet1\")\nSet ws2 = Worksheets(\"sheet2\")\n\n'set ranges to end at the last used cell in the columns\nWith ws1\n    Set r1 = .Range(.Cells(1, \"C\"), .Cells(.Rows.Count, \"C\").End(xlUp))\nEnd With\nWith ws2\n    Set r2 = .Range(.Cells(1, \"H\"), .Cells(.Rows.Count, \"H\").End(xlUp))\nEnd With\n\nFor Each c1 In r1\n    vToFind = c1 - Range(\"c10\")\n        Set c2 = r2.Find(what:=vToFind, after:=r2(1), _\n                        LookIn:=xlValues, searchdirection:=xlNext)\n        If Not c2 Is Nothing Then\n            'do your thing\n            Stop\n        Else\n            MsgBox vToFind &amp; \" not found in target\"\n        End If\nNext c1\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 2052095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/514301fad1885722118cfd9087c9133b?s=128&d=identicon&r=PG", "display_name": "KD Gordon", "link": "https://stackoverflow.com/users/2052095/kd-gordon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 311, "favorite_count": 0, "accepted_answer_id": 49289043, "answer_count": 1, "score": 0, "last_activity_date": 1521068881, "creation_date": 1521052036, "last_edit_date": 1521066942, "question_id": 49285206, "link": "https://stackoverflow.com/questions/49285206/converting-excel-formula-to-vba-and-use-array", "title": "Converting Excel Formula to VBA and use Array", "body": "<p>I need to convert the following excel formula to VBA code:</p>\n\n<pre><code>=C10+H:H\n</code></pre>\n\n<p>UPDATE:\nI want to take the values in column H of Worksheet1 and add them to the value in cell C10. I then want to compare that new value to a range of values in column C in Worksheet 2. I have been using the entire column because the rows that use the data in that column fluctuate. </p>\n\n<p>I want to be able to look at the data a decade at a time. So at 10 years I am using Worksheet1!H20:H30. Then at 20 years I would use Worksheet1!H20:H40 and so on.</p>\n\n<p>I could reasonably for VBA purposes limit the range from the entire column to Worksheet1!H20:H1000 (maybe even less, not sure just yet). The data in column H is what I need to put in an array and then need to be able to add to that data (will probably need to store result in second array) and then compare the result to an additional grouping of data on a separate worksheet (i.e. Worksheet2!C:C). </p>\n\n<p>I need to calculate age based on annual incremental increases. I have my starting age stored in C10. I have the annual increments stored in column H. The way it works in excel is if I have this in cell B22 it add C10 to H22.</p>\n\n<p>This formula is wrapped in a long and daunting if statement. It compares the calculated age to an age range on a different worksheet in lets say column C (i.e. Worksheet2!C:C = C10 + Worksheet1!H:H).</p>\n\n<p>I need to be able to do that in VBA.</p>\n\n<p>I tried in VBA\n    ElseIf Worsheets(\"Sheet2\").Range(\"C:C\") = C10 + Worsheets(\"Sheet1\").Range(\"H:H\")</p>\n\n<p>It throw a match error.</p>\n\n<p>UPDATE: FOR LOOP IN FUNCTION I TRIED TO USE</p>\n\n<pre><code>Function arrCalc_30yrMax_age_annual_incr_stnd_mbr() As Variant\n\n    'SETS THE VARIABLES\n    Dim wb As Workbook\n    Dim ws_Calculator_TL_30yrMaxTerm As Worksheet\n    Dim ws_LVRates As Worksheet\n    Dim ws_TLRates As Worksheet\n    Dim ws_Misc As Worksheet\n    Dim rngCalc_30yrMax_age_mbr As Range\n    Dim rngCalc_30yrMax_age_sp As Range\n    Dim rngCalc_30yrMax_age_annual_incr As Range\n    Dim arrCalc_30yrMax_age_annual_incr As Variant\n    Dim arrAge_Annual_Inc As Variant\n    Dim Row As Long\n    Dim Column As Long\n\n    'SETS RANGE FOR rngCalc_30yrMax_age_annual_incr RANGE\n    Set wb = ThisWorkbook\n    Set ws_Calculator_TL_30yrMaxTerm = Worksheets(\"Calculator_TL_30yrMaxTerm\")\n    Set ws_LVRates = wb.Worksheets(\"LVRates\")\n    Set ws_TLRates = wb.Worksheets(\"TLRates\")\n    Set ws_Misc = wb.Worksheets(\"Misc\")\n    Set rngCalc_30yrMax_age_annual_incr = ws_Calculator_TL_30yrMaxTerm.Range(\"Calc_30yrMax_age_annual_incr\")\n\n    'SETS ARRAY EQUAL TO rngCalc_30yrMax_age_annual_incr\n    arrCalc_30yrMax_age_annual_incr = rngCalc_30yrMax_age_annual_incr\n\n    'LOOP THROUGH THE ARRAY OF WORKSHEET VALUES\n    For Row = 1 To UBound(arrCalc_30yrMax_age_annual_incr, 1) 'First array dimension is rows.\n        For Column = 1 To UBound(arrCalc_30yrMax_age_annual_incr, 1) 'Secong array dimension is columns.\n            arrAge_Annual_Inc = arrCalc_30yrMax_age_annual_incr + rngCalc_30yrMax_age_mbr\n        Next Column\n    Next Row\n\n\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "dictionary"], "answers": [{"comments": [{"owner": {"reputation": 133, "user_id": 5167048, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bac8dafe8045bb40c9d88a4be91e4bcf?s=128&d=identicon&r=PG&f=1", "display_name": "Koda", "link": "https://stackoverflow.com/users/5167048/koda"}, "edited": false, "score": 0, "creation_date": 1521052134, "post_id": 49285203, "comment_id": 85573305, "body": "This throws a 450 error:  wrong number of arguments or invalid property assignment."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1521052344, "post_id": 49285203, "comment_id": 85573421, "body": "dictionary needs a key and a value: <code>orderstatus.Add l.Value, l.Value</code>"}, {"owner": {"reputation": 133, "user_id": 5167048, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bac8dafe8045bb40c9d88a4be91e4bcf?s=128&d=identicon&r=PG&f=1", "display_name": "Koda", "link": "https://stackoverflow.com/users/5167048/koda"}, "edited": false, "score": 0, "creation_date": 1521052705, "post_id": 49285203, "comment_id": 85573638, "body": "How do you define column X values as the key and AX as the value?"}], "tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 0, "last_activity_date": 1521054845, "last_edit_date": 1521054845, "creation_date": 1521052015, "answer_id": 49285203, "question_id": 49285164, "link": "https://stackoverflow.com/questions/49285164/add-separate-columns-into-a-dictionary/49285203#49285203", "title": "Add separate columns into a dictionary", "body": "<p>Change this</p>\n\n<pre><code>orderstatus.Add lastCol.Value\n</code></pre>\n\n<p>to this</p>\n\n<pre><code>orderstatus.Add l.Value, 1\n</code></pre>\n\n<p>This assumes you will have no duplicates because you aren't checking for that and will get an error if you do have duplicates.</p>\n"}, {"comments": [{"owner": {"reputation": 133, "user_id": 5167048, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bac8dafe8045bb40c9d88a4be91e4bcf?s=128&d=identicon&r=PG&f=1", "display_name": "Koda", "link": "https://stackoverflow.com/users/5167048/koda"}, "edited": false, "score": 0, "creation_date": 1521060180, "post_id": 49286120, "comment_id": 85577623, "body": "Is it possible to paste the dictionary into a txt file?"}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 1, "last_activity_date": 1521065920, "last_edit_date": 1521065920, "creation_date": 1521055308, "answer_id": 49286120, "question_id": 49285164, "link": "https://stackoverflow.com/questions/49285164/add-separate-columns-into-a-dictionary/49286120#49286120", "title": "Add separate columns into a dictionary", "body": "<p>I think something like this is what you're looking for:</p>\n\n<pre><code>Sub tgr()\n\n    Dim OrderStatus As Object\n    Dim i As Long\n    Dim Key As Variant\n\n    Set OrderStatus = CreateObject(\"Scripting.Dictionary\")\n\n    With Application\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n\n    With Workbooks.Open(ThisWorkbook.Path &amp; \"\\CENTRAL DIST\\A HEAD - WATER ORDER SUMMARY.xls\").Sheets(\"A HEAD #1\")\n        For i = 5 To .Cells(.Rows.Count, \"X\").End(xlUp).Row\n            If Not OrderStatus.Exists(.Cells(i, \"X\").Value) Then OrderStatus(.Cells(i, \"X\").Value) = .Cells(i, \"AX\").Value\n        Next i\n        .Parent.Close False\n    End With\n\n    'Print dictionary to text file\n    Close #1\n    Open ThisWorkbook.Path &amp; \"\\OrderStatus Output.txt\" For Output As #1\n    Print #1, \"Key\" &amp; vbTab &amp; \"Value\"\n    For Each Key In OrderStatus.Keys\n        Print #1, Key &amp; vbTab &amp; OrderStatus(Key)\n    Next Key\n    Close #1\n\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1521055420, "creation_date": 1521055420, "answer_id": 49286145, "question_id": 49285164, "link": "https://stackoverflow.com/questions/49285164/add-separate-columns-into-a-dictionary/49286145#49286145", "title": "Add separate columns into a dictionary", "body": "<p>you're messing up with <code>Range</code> object and <code>Row</code> index</p>\n\n<p>and you'd better abandon the <code>Activate</code>/<code>ActiveXXX</code> pattern and use fully qualified range references</p>\n\n<p>give this code a try</p>\n\n<pre><code>Option Explicit\n\nPublic Sub Test()\n    'Creates a dictionary object\n    Dim orderstatus As Object\n    Set orderstatus = CreateObject(\"Scripting.Dictionary\")\n\n    'Central District--A Head Water Order Summary\n    Dim app As New Excel.Application, book As Excel.Workbook\n    app.Visible = False\n    Set book = app.Workbooks.Add(ThisWorkbook.path &amp; \"\\CENTRAL DIST\\A HEAD - WATER ORDER SUMMARY.xls\")\n\n    'A Head #1\n    Dim dataRng As Range, r As Range\n    Dim last As Integer\n    With book.Worksheets(\"A HEAD #1\")\n        For Each r In .Range(\"X5\", .Cells(.Rows.Count, \"X\").End(xlUp))\n           orderstatus(r.value) = r.Offset(, 26).value\n        Next\n    End With\nEnd Sub\n</code></pre>\n\n<p>Moreover if you're running this macro from within an Excel session already, you don't need to get another instance of it nor explicitly reference it:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub Test()\n    'Creates a dictionary object\n    Dim orderstatus As Object\n    Set orderstatus = CreateObject(\"Scripting.Dictionary\")\n\n    'Central District--A Head Water Order Summary\n    Dim book As Workbook\n    Set book = Workbooks.Add(ThisWorkbook.path &amp; \"\\CENTRAL DIST\\A HEAD - WATER ORDER SUMMARY.xls\")\n\n    'A Head #1\n    Dim dataRng As Range, r As Range\n    Dim last As Integer\n    With book.Worksheets(\"A HEAD #1\")\n        For Each r In .Range(\"X5\", .Cells(.Rows.Count, \"X\").End(xlUp))\n           orderstatus(r.value) = r.Offset(, 26).value\n        Next\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 5167048, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bac8dafe8045bb40c9d88a4be91e4bcf?s=128&d=identicon&r=PG&f=1", "display_name": "Koda", "link": "https://stackoverflow.com/users/5167048/koda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 49286120, "answer_count": 3, "score": 0, "last_activity_date": 1521065920, "creation_date": 1521051870, "last_edit_date": 1521051899, "question_id": 49285164, "link": "https://stackoverflow.com/questions/49285164/add-separate-columns-into-a-dictionary", "title": "Add separate columns into a dictionary", "body": "<p>I am trying to add data from a split range (X5:X?,AX5:AX?) into a VBA dictionary. ? Is determined as the last row of data within the sheet. I am new to VBA and trying to force my way through this.</p>\n\n<pre><code>Public Sub Test\n'Creates a dictionary object\n Dim orderstatus As Object, path As String\n Set orderstatus = CreateObject(\"Scripting.Dictionary\")\n Dim order, status 'key and object names\n order = \"Order #\": status = \"Order Status\"\n path = ThisWorkbook.path\n\n'Central District--A Head Water Order Summary\n Dim app As New Excel.Application, book As Excel.Workbook\n app.Visible = False\n Set book = app.Workbooks.Add(path &amp; \"\\CENTRAL DIST\\A HEAD - WATER ORDER SUMMARY.xls\")\n\n\n'A Head #1\n Dim A1Head As Integer, last As Integer, l as Integer\n l = 4\n book.Worksheets(\"A HEAD #1\").Activate\n last = Range(\"X\" &amp; Rows.Count).End(xlUp).Row\n\n Set lastCol = Range(\"X5:X\" &amp; last, \"AX5:AX\" &amp; last)\n For Each l In lastCol.Cells\n    orderstatus.Add lastCol.Value\n Next\nEnd Sub\n</code></pre>\n\n<p>Any help is greatly appreciated!</p>\n"}, {"tags": ["vba", "excel", "pdf"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521051122, "post_id": 49284678, "comment_id": 85572770, "body": "have you done some research?"}, {"owner": {"reputation": 1, "user_id": 9493181, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "dn23", "link": "https://stackoverflow.com/users/9493181/dn23"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521051317, "post_id": 49284678, "comment_id": 85572880, "body": "Yes, have been looking for the best options for the last couple of hours that work within vba for adobe reader"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521051541, "post_id": 49284678, "comment_id": 85572987, "body": "This site has a requirement that, prior to posting questions, a considerable amount of research has been done, and that solutions have been attempted in such a way that evidence of them can be shared in the question.  Please see &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>&quot; as well as &quot;[help-on-topic]&quot;"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521051622, "post_id": 49284678, "comment_id": 85573040, "body": "As for PDF&#39;s they can be a tricky thing to integrate into other applications, especially when it comes to modifying them.  You may require a copy of Adobe Acrobat (the <b>Full</b> version ; not &quot;Reader&quot;) in order to get the VBA libraries you&#39;ll need,."}, {"owner": {"reputation": 1, "user_id": 9493181, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "dn23", "link": "https://stackoverflow.com/users/9493181/dn23"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521052005, "post_id": 49284678, "comment_id": 85573235, "body": "If I have gotten as far as I did in the current code, then I have done my research, been doing vba for the last 1 year. First time I haven&#39;t been able to figure it out myself, can not find other information that is similar enough to my question. I know adobe reader has a comment section and will allow a text box to be added and type in. Is there a way to trigger that using vba code?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521052482, "post_id": 49284678, "comment_id": 85573490, "body": "I see you&#39;re using command-line switches to print the document.  Do you have a list (or link to a list )  of all of the command-line options?  Perhaps there&#39;s something in there we can manipulate."}, {"owner": {"reputation": 1, "user_id": 9493181, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "dn23", "link": "https://stackoverflow.com/users/9493181/dn23"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521053456, "post_id": 49284678, "comment_id": 85574053, "body": "This is the link which helped me find my original commands: <a href=\"https://stackoverflow.com/questions/619158/adobe-reader-command-line-reference\" title=\"adobe reader command line reference\">stackoverflow.com/questions/619158/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9493181, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "dn23", "link": "https://stackoverflow.com/users/9493181/dn23"}, "edited": false, "score": 0, "creation_date": 1521081491, "post_id": 49285859, "comment_id": 85584378, "body": "Thank you, I will look into it!"}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 0, "last_activity_date": 1521054330, "creation_date": 1521054330, "answer_id": 49285859, "question_id": 49284678, "link": "https://stackoverflow.com/questions/49284678/print-pdf-with-text-box-or-watermark/49285859#49285859", "title": "Print PDF with text box or watermark", "body": "<p>Here are a couple options (although any of them will take some work):</p>\n\n<h2>1. Manipulate the PDF file programmatically</h2>\n\n<p>In my experience, PDF files aren't fun to work with at the best of times -- and even more so when there's a need to actually modify the file.  This is mostly because Adobe is so secretive with their proprietary software.</p>\n\n<p>There is a capability of annotating the files to add what you need to (see <a href=\"https://en.wikipedia.org/wiki/Portable_Document_Format#Editing\" rel=\"nofollow noreferrer\">here</a>) but that could involve manually modifying each file.</p>\n\n<p>With the purchase of Adobe Acrobat (the full version; not Reader) I believe you get a library (<code>Acrobat.tlb</code> I believe) that can help you manipulate the file with VBA. It's worth checking the VBA references to see if your company already has the license, in which case <a href=\"https://stackoverflow.com/a/37620819/8112776\">something like this</a> might work.</p>\n\n<h2>2. Add annotations or watermarks manually</h2>\n\n<p>Depending on the volume of files you need to process, this could be an option. There are various freebies online like <a href=\"http://www.bullzip.com/products/pdf/info.php#Features\" rel=\"nofollow noreferrer\">this</a> and <a href=\"https://www.xodo.com/\" rel=\"nofollow noreferrer\">this</a>.</p>\n\n<h2>3. Programmatically with your Printer Settings (via Windows, etc)</h2>\n\n<p>Many, if not most, printers have the option of adding a header/footer or even watermark to \"all\" printed pages. (My <a href=\"http://support.brother.com/g/b/producttop.aspx?c=ca&amp;lang=en&amp;prod=mfcj425w_us\" rel=\"nofollow noreferrer\">cheap Brother printer</a> at home does.)</p>\n\n<p>Some might have the option of including the filename as a heading.  With mine, I would set the printer to include a bitmap as a watermark, and then create a <code>.bmp</code> file programmatically before each print job with whatever information I needed to include.  Bitmaps are surprisingly simple to encode/decode with VBA. (Some ideas <a href=\"http://www.vbaexpress.com/forum/showthread.php?10403-Solved-Bitmaps-with-Excel-VBA-how-to-create\" rel=\"nofollow noreferrer\">here</a> and <a href=\"https://www.experts-exchange.com/questions/20877961/Create-Print-Bitmap-Image-using-VB-VBA.html\" rel=\"nofollow noreferrer\">here</a>.)</p>\n"}], "owner": {"reputation": 1, "user_id": 9493181, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "dn23", "link": "https://stackoverflow.com/users/9493181/dn23"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1337, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521054330, "creation_date": 1521050129, "last_edit_date": 1521051467, "question_id": 49284678, "link": "https://stackoverflow.com/questions/49284678/print-pdf-with-text-box-or-watermark", "title": "Print PDF with text box or watermark", "body": "<p>I am looking to print pdf files with vba but want to add a text box with information that changes based on a list in excel. I have three columns in the excel file with information such as file location for the material pdf, number of copies and the order number that it needs to run on.</p>\n\n<p>Currently I have to hand write all order numbers on the papers after my vba prints the pdf files. Is there a way to add lines of code to my code that will add a text box or watermark that will have the order number on each pdf. Order number can change based on the pdf file being rpinted. Thank you! Code below:</p>\n\n<pre><code>Sub Button4_Click()\nDim Msg As String, Ans As Variant\n\n   Msg = \"Would you like to print all of the BOMs\"\n\n   Ans = MsgBox(Msg, vbYesNo)\n\n   Select Case Ans\n\n   Case vbYes\n\n    'NOTE:\n    '/s=don't show splash screen\n    '/n=new instance\n    '/h=minimized window\n    '/t=print to default printer; or use /t &lt;filename&gt; &lt;printername&gt; &lt;drivername&gt; &lt;portname&gt;\n\n    'CHECK YOUR ADOBE READER VERSION, AND USE CORRECT PATH..\n    zProg = \"C:\\Program Files (x86)\\Adobe\\Acrobat Reader DC\\Reader\\AcroRd32.exe\"\n\n    zLastRow = [M65536].End(xlUp).Row           'find last row in column [M]; e.g. 15\n    temp = \"M1:M\" &amp; zLastRow                    'e.g. \"M1:M15\"\n\n    '~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    For Each cell In Range(temp)                'loop through all entries in range\n    zFile = cell.Value                          'fetch filename from cell\n    r = cell.Row\n    zPrintCopies = Cells(r, \"N\")\n    If zPrintCopies = \"\" Then\n    zPrintCopies = 1\n    Cells(r, \"B\") = 1\n    End If\n\n    If zFile Like \"*.pdf\" Then                  'check it is a pdf file type\n    .LeftHeader = Format(Now(), \"dd/mm/yy\")\n\n    For i = 1 To zPrintCopies\n    Shell (zProg &amp; \" /n /h /t \" &amp; zFile)        'execute command to print  the pdf document\n    Next i\n    End If                                      'end of test for pdf file type\n\n    Next                                        'process next file in list\n    '~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\nCase vbNo\nGoTo Quit:\nEnd Select\n\nQuit:\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "powerpoint", "shape"], "comments": [{"owner": {"reputation": 546, "user_id": 4567386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11f8fce6de0ea6f1be214fa8a8469481?s=128&d=identicon&r=PG&f=1", "display_name": "Shyam Pillai", "link": "https://stackoverflow.com/users/4567386/shyam-pillai"}, "edited": false, "score": 0, "creation_date": 1521058518, "post_id": 49284637, "comment_id": 85576832, "body": "This is a known problem in any current and older version of PowerPoint. I\u2019ve relied on OpenXml to extract the texture out in such a scenario. For a pure vba approach you could consider using the pickup/apply and then reseting the other properties like line formatting etc."}, {"owner": {"reputation": 77, "user_id": 7375080, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/52155149b8f6ee15b9ade38f74b28a6e?s=128&d=identicon&r=PG&f=1", "display_name": "karldegen", "link": "https://stackoverflow.com/users/7375080/karldegen"}, "reply_to_user": {"reputation": 546, "user_id": 4567386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11f8fce6de0ea6f1be214fa8a8469481?s=128&d=identicon&r=PG&f=1", "display_name": "Shyam Pillai", "link": "https://stackoverflow.com/users/4567386/shyam-pillai"}, "edited": false, "score": 0, "creation_date": 1521212456, "post_id": 49284637, "comment_id": 85648951, "body": "Thank you. Well, let&#39;s hope MS will fix it. I also had your Idea...just wanted to get around it. :-)"}], "answers": [{"tags": [], "owner": {"reputation": 77, "user_id": 7375080, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/52155149b8f6ee15b9ade38f74b28a6e?s=128&d=identicon&r=PG&f=1", "display_name": "karldegen", "link": "https://stackoverflow.com/users/7375080/karldegen"}, "is_accepted": false, "score": 0, "last_activity_date": 1521110492, "creation_date": 1521110492, "answer_id": 49297317, "question_id": 49284637, "link": "https://stackoverflow.com/questions/49284637/shape-fillformat-presettexture-always-shows-2-msopresettexturemixed-even-when/49297317#49297317", "title": "Shape.FillFormat.presetTexture always shows -2 (msoPresetTextureMixed) even when set to msoTextureGranite", "body": "<p>Some more code to make the problem clear:\n    </p>\n\n<pre><code>Sub test()\nDim sh As Shape\n\n    'let's assume, there is at least one shape on current slide\n    Set sh = ActiveWindow.View.Slide.Shapes(1)\n\n    Call sh.Fill.Solid ' make FillFormat solid\n\n    Debug.Print sh.Fill.Type ' prints 1 (msoFillSolid)\n    Debug.Print sh.Fill.PresetTexture ' prints -2 (msoTextureAlignmentMixed)\n\n    sh.Fill.PresetTextured (msoTextureDenim)\n\n    Debug.Print sh.Fill.Type ' prints 4 (msoFillTextured)\n    Debug.Print sh.Fill.PresetTexture ' prints -2 again! (msoTextureAlignmentMixed)\n\n    'This assertion fails, because sh.Fill.PresetTexture &lt;&gt; msoTextureDenim\n    Debug.Assert sh.Fill.PresetTexture = msoTextureDenim\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 7375080, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/52155149b8f6ee15b9ade38f74b28a6e?s=128&d=identicon&r=PG&f=1", "display_name": "karldegen", "link": "https://stackoverflow.com/users/7375080/karldegen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521110492, "creation_date": 1521050005, "last_edit_date": 1521050411, "question_id": 49284637, "link": "https://stackoverflow.com/questions/49284637/shape-fillformat-presettexture-always-shows-2-msopresettexturemixed-even-when", "title": "Shape.FillFormat.presetTexture always shows -2 (msoPresetTextureMixed) even when set to msoTextureGranite", "body": "<p>I try to clone with a VBA macro the filling of an PowerPoint 2010 shape from source shape <code>sourceSh</code> to target shape <code>targetSh</code>; only the filling, otherwise <code>Shape.PickUp()</code> and <code>Shape.Apply()</code> would do.</p>\n\n<p>Works fine for some cases like solid fill and gradient, but when the source shape is a built in texture like <code>msoTextureGranite</code> , then the poperty <code>Shape.Fill.PresetTexture</code> always returns <code>msoPresetTextureMixed</code>. So the following code crashes:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>'sourceSh, targetSh initiallized before as Shape\n'crashes, because the value of sourceSh.Fill.PresetTexture is msoPresetTexturemixed\nCall targetSh.Fill.PresetTextured(sourceSh.Fill.PresetTexture)\n\n'even this is unexpected..\ntargetSh.Fill.PresetTextured(msoTextureGranite)\n'now the read only property targetSh.Fill.PresetTexture is expected\n'to be a positive integer representing msoTextureGranite.\n'instead I find -2 what represents msoPresetTextureMixed\n</code></pre>\n\n<p>Does any one knows a solution, work around, something else... ?</p>\n"}, {"tags": ["excel", "charts", "timeserieschart", "dynamic-tables", "vba"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521049067, "post_id": 49284271, "comment_id": 85571501, "body": "Please define <code>dynamic tables</code>? ...it could mean a number  of things depending on one&#39;s interpretation."}, {"owner": {"reputation": 700, "user_id": 6281495, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d710e76b992e84143b04345e39a0f5b3?s=128&d=identicon&r=PG&f=1", "display_name": "framontb", "link": "https://stackoverflow.com/users/6281495/framontb"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521049228, "post_id": 49284271, "comment_id": 85571593, "body": "Sorry, I mean Pivot Tables. I&#39;ll edit the Question."}], "owner": {"reputation": 700, "user_id": 6281495, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d710e76b992e84143b04345e39a0f5b3?s=128&d=identicon&r=PG&f=1", "display_name": "framontb", "link": "https://stackoverflow.com/users/6281495/framontb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521049333, "creation_date": 1521048728, "last_edit_date": 1531161705, "question_id": 49284271, "link": "https://stackoverflow.com/questions/49284271/how-could-i-add-a-line-in-a-chart-created-from-a-dynamic-table", "title": "How could I add a line in a Chart created from a Dynamic Table?", "body": "<p>I've generated a Chart from a Pivot Table. I want to add a line (with a Series object for example), but no way.</p>\n\n<p>I've tried things like that:</p>\n\n<pre><code>Sub createNewLineInChart()\n    Dim cht As ChartObject\n    Set cht = Sheets(\"mySlide\").ChartObjects(\"myChart\")\n    cht.Chart.SeriesCollection.Add Source:=Sheets(\"mySlide\").Range(\"a1:a5\")\nEnd Sub\n</code></pre>\n\n<p>While this works with \"normal\" Charts, it doesn't work with Charts generated from Pivot Table (my case). I need the data for the Chart comes from the Pivot Table, so to copy the data in a static table is not a solution.</p>\n\n<p>So the question: are there any method to add a line in a dynamic generated Chart?</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>With \"Dynamic Table\" I mean Pivot Table</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1521048341, "post_id": 49284002, "comment_id": 85571008, "body": "Do you just need the log base 10 average <code>logavg = 10 * WorksheetFunction.Log10(lSumofValues &#47; lCountofValues)</code> rather than natural log?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1521048494, "post_id": 49284002, "comment_id": 85571112, "body": "Why don&#39;t you just use the worksheet formulae though?"}, {"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 1, "creation_date": 1521049583, "post_id": 49284002, "comment_id": 85571825, "body": "Be aware that <code>LOG</code> from the formula is a log base 10 while the <code>Log</code> from VBA is a log base e. To get the log base 10 with VBA: <code>Log(x) &#47; Log(10)</code>"}, {"owner": {"reputation": 33, "user_id": 9124657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/022e6208923341291bb3495c5c508ec1?s=128&d=identicon&r=PG&f=1", "display_name": "Cameron", "link": "https://stackoverflow.com/users/9124657/cameron"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1521117272, "post_id": 49284002, "comment_id": 85600845, "body": "@sjr Yes I need the log base 10 average, not the natural log.  The worksheet formulae are too inefficient when changing dozens of them at a time."}, {"owner": {"reputation": 33, "user_id": 9124657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/022e6208923341291bb3495c5c508ec1?s=128&d=identicon&r=PG&f=1", "display_name": "Cameron", "link": "https://stackoverflow.com/users/9124657/cameron"}, "reply_to_user": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 0, "creation_date": 1521117474, "post_id": 49284002, "comment_id": 85601000, "body": "@FlorentB I didn&#39;t know that the VBA log is a natural log so thank you."}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 2, "last_activity_date": 1521049443, "creation_date": 1521049443, "answer_id": 49284477, "question_id": 49284002, "link": "https://stackoverflow.com/questions/49284002/logarithmic-averaging/49284477#49284477", "title": "Logarithmic averaging", "body": "<p>A tiny change:</p>\n\n<pre><code>Function logavg(rngValues As Range) As Double\n    With Application.WorksheetFunction\n        Dim lSumofValues As Double\n        Dim lCountofValues As Double\n        Dim lAntilog As Double\n        Dim rngLoop As Range\n\n        lSumofValues = 0\n        lAntilog = 0\n        lCountofValues = rngValues.Count 'Get count of values in items in range\n\n    'For loop - add the antilogs of the values in the range - does not work\n        For Each rngLoop In rngValues\n            lAntilog = .Power(10, 0.1 * rngLoop.Value)\n            lSumofValues = lSumofValues + lAntilog\n        Next\n\n    'Perform calculation - logarithmic average\n        logavg = 10 * .Log10(lSumofValues / lCountofValues)\n    End With\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/o6ISS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/o6ISS.png\" alt=\"enter image description here\"></a></p>\n\n<p>Where my data is in <strong>B1</strong> through <strong>B7</strong></p>\n"}, {"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": true, "score": 2, "last_activity_date": 1521050871, "last_edit_date": 1521050871, "creation_date": 1521050384, "answer_id": 49284757, "question_id": 49284002, "link": "https://stackoverflow.com/questions/49284002/logarithmic-averaging/49284757#49284757", "title": "Logarithmic averaging", "body": "<p>Here's a method using all VBA functions:</p>\n\n<pre><code>Function logAvg(myRng As Range) As Double\n    Dim myCount As Long\n    Dim D As Double\n    Dim I As Long\n    Dim V\n\n    V = myRng\n    For I = 1 To UBound(V, 1)\n        D = D + 10 ^ (V(I, 1) * 0.1)\n    Next I\n\n    myCount = UBound(V, 1)\n    D = D / myCount\n\n    D = Log(D) / Log(10)\n    logAvg = 10 * D\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 9124657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/022e6208923341291bb3495c5c508ec1?s=128&d=identicon&r=PG&f=1", "display_name": "Cameron", "link": "https://stackoverflow.com/users/9124657/cameron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1063, "favorite_count": 0, "accepted_answer_id": 49284757, "answer_count": 2, "score": 3, "last_activity_date": 1521050871, "creation_date": 1521047900, "last_edit_date": 1521049005, "question_id": 49284002, "link": "https://stackoverflow.com/questions/49284002/logarithmic-averaging", "title": "Logarithmic averaging", "body": "<p>I am developing a custom function that will calculate the logarithmic average of a range.  The answer for the post <a href=\"https://stackoverflow.com/questions/23956551/logarithmic-averaging-preset-function-in-excel-using-ranges-as-input-values\">logarithmic averaging question</a> is wrong but it is a starting point.  The problem lies in calculating the anti-logs (10^(0.1x)) of range values.  This is my first post so please forgive any missteps.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Function logavg(rngValues As Range) As Double\n\n    Dim lSumofValues As Double\n    Dim lCountofValues As Double\n    Dim lAntilog As Double\n    Dim rngLoop As Range\n\n    lSumofValues = 0\n    lAntilog = 0\n    lCountofValues = rngValues.Count 'Get count of values in items in range\n\n'For loop - add the antilogs of the values in the range - does not work\n    For Each rngLoop In rngValues\n        lAntilog = WorksheetFunction.Power(10, 0.1 * rngLoop.Value)\n        lSumofValues = lSumofValues + lAntilog\n    Next\n\n'Perform calculation - logarithmic average\n    logavg = 10 * Log(lSumofValues / lCountofValues)\n\nEnd Function\n</code></pre>\n\n<p>I tried this 'for' loop but it doesn't work:</p>\n\n<pre><code>    For Each rngLoop In rngValues\n        lSumofValues = lSumofValues + (10 ^ (0.1 * rngLoop.Value))\n    Next\n</code></pre>\n\n<p>This code for a simple (arithmetic) average works so I know that the range values are being transferred and used properly:</p>\n\n<pre><code>    For Each rngLoop In rngValues\n    lSumofValues = lSumofValues + rngLoop.Value\n    Next\n    logavg = lSumofValues / lCountofValues\n</code></pre>\n\n<p>Test data is: 92.8, 79.1, 81.6, 78.3, 89.4, 86.5, 86.9</p>\n\n<p>The arithmetic average is 84.9 and the logarithmic average is 87.6.</p>\n\n<p>Two Excel formulae that calculate the logarithmic average of B2:B8 are:</p>\n\n<p>a) array formula =10*LOG(SUM(10^(0.1*B2:B8))/COUNT(B2:B8)), and</p>\n\n<p>b) standard formula =10*LOG(SUMPRODUCT(10^(0.1*B2:B8))/COUNT(B2:B8))</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1521048274, "post_id": 49283962, "comment_id": 85570958, "body": "Does it throw an error message or just stop copying?"}], "answers": [{"comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1521048392, "post_id": 49284133, "comment_id": 85571041, "body": "Can you write <b>this is really not advisable</b> in bold 48 point type in red, underlined, italics and flashing if possible. :)"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1521048397, "last_edit_date": 1521048397, "creation_date": 1521048303, "answer_id": 49284133, "question_id": 49283962, "link": "https://stackoverflow.com/questions/49283962/unknown-error-in-excel-vba-macro-code/49284133#49284133", "title": "Unknown error in Excel VBA Macro code", "body": "<p>\"the data stops copying over after two entries.\" - this means it stops here -    <code>ActiveCell.Value = POCPhone</code> A possible reason should be, that <code>POCPhone</code> contains an error. E.g. - <code>Range(\"D4\")</code> is probably <code>#DIV/0</code> or <code>#Value</code></p>\n\n<p>There are 3 ways fix it (2 easy and 1 difficult) :</p>\n\n<ul>\n<li><p>Write <code>On Error Resume Next</code> after <code>Private Sub CommandButton1_Click()</code> - <strong>this is really not advisable</strong>, because it will ignore every error. But it will fix it.</p></li>\n<li><p>Rewrite the whole code, avoiding <code>Select</code> and <code>ActiveCell</code> (This is the difficult one). <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a></p></li>\n<li><p>Write some check like this:</p></li>\n</ul>\n\n<hr>\n\n<pre><code>ActiveCell.Offset(0, 1).Select\nIf Not IsError(ActiveCell) Then ActiveCell.Value = DateRet\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": false, "score": 0, "last_activity_date": 1521048623, "creation_date": 1521048623, "answer_id": 49284246, "question_id": 49283962, "link": "https://stackoverflow.com/questions/49283962/unknown-error-in-excel-vba-macro-code/49284246#49284246", "title": "Unknown error in Excel VBA Macro code", "body": "<p>Here's a refactored version of your code that should do what you're looking for.  Note that the code (including your original version) appears to assume that there is only one line (row 4) from your \"TransReq\" sheet to move over to the \"TransReqLog\" sheet:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    Dim wb As Workbook\n    Dim wsData As Worksheet\n    Dim wsLog As Worksheet\n    Dim rData As Range\n\n    Set wb = ActiveWorkbook\n    Set wsData = wb.Sheets(\"TransReq\")\n    Set wsLog = wb.Sheets(\"TransReqLog\")\n    Set rData = wsData.Range(\"B4:N4\")\n\n    wsLog.Cells(wsLog.Rows.Count, \"B\").End(xlUp).Offset(1).Resize(, rData.Columns.Count).Value = rData.Value\n    rData.ClearContents\n\nEnd Sub\n</code></pre>\n\n<p>As a note, please familiarize yourself with <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba?noredirect=1&amp;lq=1\">How to avoid using Select in Excel VBA</a> (Vityata also linked here in his answer)</p>\n"}, {"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1521104604, "last_edit_date": 1521104604, "creation_date": 1521048752, "answer_id": 49284282, "question_id": 49283962, "link": "https://stackoverflow.com/questions/49283962/unknown-error-in-excel-vba-macro-code/49284282#49284282", "title": "Unknown error in Excel VBA Macro code", "body": "<p>Your code only works for two rows because of this line:<br>\n<code>Worksheets(\"TransReqLog\").Range(\"B3\").End(xlDown).Select</code></p>\n\n<p>The first line is copied successfully as the line of code isn't executed due to the <code>IF</code> statement.</p>\n\n<p>The second line is successful as the code selects cell <code>C3</code> and then performs the same operation as the keyboard shortcut <code>Ctrl+Down</code> which selects the next cell down that isn't empty.  The code then offset by one row.</p>\n\n<p>It breaks on the third attempt as the code does <em>exactly</em> the same as the second attempt - it starts at the empty <code>C3</code> and moves down to the first cell that's not empty.</p>\n\n<p>Providing all cells below are empty it's better to start at the bottom of the sheet and move upwards to the first cell that's not empty.<br>\n<code>Worksheets(\"TransReqLog\").Cells(Worksheets(\"TransReqLog\").Rows.Count, 2).End(xlUp).Select</code>  </p>\n\n<p>If there isn't a mixture of XL2003 and XL2007 or later then the you can just use <code>Worksheets(\"TransReqLog\").Cells(Rows.Count, 2).End(xlUp).Select</code>  </p>\n\n<p>Having said all that, the refactor that @tigeravatar answered with is the way to go.</p>\n"}], "owner": {"reputation": 11, "user_id": 9465158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16bd3ee0a2fd96a555f8785989f8e9b2?s=128&d=identicon&r=PG&f=1", "display_name": "TomJ", "link": "https://stackoverflow.com/users/9465158/tomj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 347, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1521104604, "creation_date": 1521047790, "question_id": 49283962, "link": "https://stackoverflow.com/questions/49283962/unknown-error-in-excel-vba-macro-code", "title": "Unknown error in Excel VBA Macro code", "body": "<p>I'm still quite new to VBA and I'm basically self-taught. I've developed a spreadsheet for work and I need a macro to allow customers to add information then the information copy to sheet 2 in descending order. This is the code I am using currently attempting to use but when I click on the \u201cSave\u201d macro button, the data stops copying over after two entries.  Additionally, is there some code that I can input to clear the blocks so each new customer cannot see what the previous customer entered?  </p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim Name As String, Org As String, POCPhone As String, Email As String, TypeofVeh As String, TotPax As String, TotCar As String, Pickup As String, DateReq As String, DateRet As String, Destination As String, YN As String, Remarks As String\n   Worksheets(\"TransReq\").Select\n   Name = Range(\"B4\")\n   Org = Range(\"C4\")\n   POCPhone = Range(\"D4\")\n   Email = Range(\"E4\")\n   TypeofVeh = Range(\"F4\")\n   TotPax = Range(\"G4\")\n   TotCar = Range(\"H4\")\n   Pickup = Range(\"I4\")\n   DateReq = Range(\"J4\")\n   DateRet = Range(\"K4\")\n   Destination = Range(\"L4\")\n   YN = Range(\"M4\")\n   Remarks = Range(\"N4\")\n   Worksheets(\"TransReqLog\").Select\n   Worksheets(\"TransReqLog\").Range(\"B3\").Select\n   If Worksheets(\"TransReqLog\").Range(\"B3\").Offset(1, 1) &lt;&gt; \"\" Then\n   Worksheets(\"TransReqLog\").Range(\"B3\").End(xlDown).Select\n   End If\n   ActiveCell.Offset(1, 0).Select\n   ActiveCell.Value = Name\n   ActiveCell.Offset(0, 1).Select\n   ActiveCell.Value = Org\n   ActiveCell.Offset(0, 1).Select\n   ActiveCell.Value = POCPhone\n   ActiveCell.Offset(0, 1).Select\n   ActiveCell.Value = Email\n   ActiveCell.Offset(0, 1).Select\n   ActiveCell.Value = TypeofVeh\n   ActiveCell.Offset(0, 1).Select\n   ActiveCell.Value = TotPax\n   ActiveCell.Offset(0, 1).Select\n   ActiveCell.Value = TotCar\n   ActiveCell.Offset(0, 1).Select\n   ActiveCell.Value = Pickup\n   ActiveCell.Offset(0, 1).Select\n   ActiveCell.Value = DateReq\n   ActiveCell.Offset(0, 1).Select\n   ActiveCell.Value = DateRet\n   ActiveCell.Offset(0, 1).Select\n   ActiveCell.Value = Destination\n   ActiveCell.Offset(0, 1).Select\n   ActiveCell.Value = YN\n   ActiveCell.Offset(0, 1).Select\n   ActiveCell.Value = Remarks\n   Worksheets(\"TransReq\").Select\n   Worksheets(\"TransReq\").Range(\"B4\").Select\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["c#", ".net", "vba", "visual-studio", "ms-access"], "comments": [{"owner": {"reputation": 202712, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "edited": false, "score": 4, "creation_date": 1521048142, "post_id": 49283907, "comment_id": 85570870, "body": "I can understand your pain, (been there myself) but your question is simply off-topic or too broad. And if you really need an opinion, well. rewrite everything."}, {"owner": {"reputation": 97, "user_id": 7470572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47141453ecea29cdf4b43b2a97bba035?s=128&d=identicon&r=PG&f=1", "display_name": "JazzmanJim", "link": "https://stackoverflow.com/users/7470572/jazzmanjim"}, "edited": false, "score": 0, "creation_date": 1521048429, "post_id": 49283907, "comment_id": 85571071, "body": "Yes, this will be painful.  It will be a total re-write.  I&#39;ve had to do this for an app that started as Access (ugh) in the late 90&#39;s.  It was moved to VB6 with the database in sql server. In the 2012 time frame we needed to move to WIN7/10 which required a re-write as the third party ActiveX controls used were no longer supported.  Definitely a very painful process.  Good luck."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1521049658, "post_id": 49283907, "comment_id": 85571874, "body": "You might want to see what <a href=\"http://rubberduckvba.com\" rel=\"nofollow noreferrer\">Rubberduck</a> can do for you. Sadly the <i>extract method</i> refactoring has been pulled out and is currently being rewritten (feel free to contribute - it&#39;s all written in C#), but the navigation tooling alone should help quite a bit. Disclaimer: I own &amp; manage this open-source project."}, {"owner": {"reputation": 67, "user_id": 7638743, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q1fcu.jpg?s=128&g=1", "display_name": "West", "link": "https://stackoverflow.com/users/7638743/west"}, "edited": false, "score": 0, "creation_date": 1521050492, "post_id": 49283907, "comment_id": 85572383, "body": "Thanks for the responses. I think at this time it is probably best to recommend a rewrite and see what the client wants to do from there. Y&#39;all are the best!"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1521053387, "post_id": 49283907, "comment_id": 85574007, "body": "Does the client actually want a complete rewrite? Or just some changes that could easily be done in the existing Access application? -- You most probably have seen this, but I&#39;ll link it just in case: <a href=\"https://www.joelonsoftware.com/2000/04/06/things-you-should-never-do-part-i/\" rel=\"nofollow noreferrer\">joelonsoftware.com/2000/04/06/things-you-should-never-do-par&zwnj;&#8203;t-i</a>"}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 7638743, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q1fcu.jpg?s=128&g=1", "display_name": "West", "link": "https://stackoverflow.com/users/7638743/west"}, "edited": false, "score": 1, "creation_date": 1521050541, "post_id": 49284212, "comment_id": 85572422, "body": "This is probably the direction I will take. Sorry, you were awesome enough to respond even though you were inevitably going to be downvoted. I appreciate the response and advice!"}], "tags": [], "owner": {"reputation": 143, "user_id": 1256136, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e5f996ed228e7ae4d85f7c6fed371683?s=128&d=identicon&r=PG", "display_name": "Pierce", "link": "https://stackoverflow.com/users/1256136/pierce"}, "is_accepted": true, "score": 4, "last_activity_date": 1521048542, "creation_date": 1521048542, "answer_id": 49284212, "question_id": 49283907, "link": "https://stackoverflow.com/questions/49283907/converting-vba-project-written-in-ms-access-to-any-modern-language/49284212#49284212", "title": "Converting VBA project written in MS Access to ANY modern language", "body": "<p>\"...there probably is not an answer other than simply rewriting the entire application.\"</p>\n\n<p>I had a similar issue a couple of years ago with a legacy application built on an Access97 database.  </p>\n\n<p>There is no quick fix.  You will spend more time trying to beat the existing code into a new form than it is worth.  Use the old code as a guide for structure, but start from scratch.</p>\n"}], "owner": {"reputation": 67, "user_id": 7638743, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q1fcu.jpg?s=128&g=1", "display_name": "West", "link": "https://stackoverflow.com/users/7638743/west"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1063, "favorite_count": 0, "closed_date": 1521049030, "accepted_answer_id": 49284212, "answer_count": 1, "score": -3, "last_activity_date": 1521050401, "creation_date": 1521047621, "last_edit_date": 1521050401, "question_id": 49283907, "link": "https://stackoverflow.com/questions/49283907/converting-vba-project-written-in-ms-access-to-any-modern-language", "closed_reason": "Not suitable for this site", "title": "Converting VBA project written in MS Access to ANY modern language", "body": "<p>Okay, I know that this is a super weird question and there probably is not an answer other than simply rewriting the entire application. However, I recently took on a project for a client that has a MASSIVE project written inside of Access 2007 with Visual Basic for Applications and some VB6. In order to help them my first plan was to just modernize everything they have. The application runs on XP and I was hoping that I could at least move the project files and forms (automatically) to any type of .net project inside of Visual Studio. I've never used any of the Microsoft developer tools and after a couple days of digging around on the internet, most converters don't actually seem to work. There doesn't seem to be any sort of \"best practice\" way to bring an old VB project to a more modern developer environment. If rewriting everything is really the only option that's fine I was just hoping that one of you very smart people knew of a way that I could at least get most of the code/forms into a newer environment. If I can just open the project in an older version of Visual Basic that works too (their system has access to every major version since 2008) Thanks in advance! </p>\n\n<p>I am also totally open to porting the project into any other language if there is a better tool that works for say Python, Java, C (any iteration of C), etc. </p>\n\n<p>EDIT: \"Questions asking us to recommend or find a book, tool, software library, tutorial or other off-site resource are off-topic for Stack Overflow as they tend to attract opinionated answers and spam. Instead, describe the problem and what has been done so far to solve it.\" \u2013 Scott Craner, Steve, Erik von Asmuth, Kostas K., braX</p>\n\n<p>So in response to this, I have attempted to rebuild the project inside of visual studio 2008 and then using the built-in converter bring the code from VBA to VB6 which (for the most part) worked. From there I could save the project and open it in visual studio 2010 once again using the built-in converter to take the code from VB6 to VB.Net. However, this is where the \"success\" stops. Essentially the project cannot be opened in any newer version of visual studio (attempted with 2012, 2015, and 2017) I was simply hoping that ANYONE would have any ideas on how else I could go about moving this project into Visual Studio or rebuilding it in another language. I understand that the question is not super relevant considering the software I am talking about updating is over 10 years old and some of it even older. Thanks for your responses as I think that it is probably time to evaluate the cost/time involved in a complete rewrite. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1521046951, "post_id": 49283620, "comment_id": 85570076, "body": "What is CallDate and what value does the formula return?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1521047101, "post_id": 49283620, "comment_id": 85570179, "body": "RefCol needs to be a single column. Same with DateCol or you can add a column index numver to Index."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1521048370, "post_id": 49283620, "comment_id": 85571026, "body": "Likely the late-bound <code>Match</code> call is <i>returning</i> some <code>#VALUE!</code> error value, and since that type can&#39;t be coerced to anything it makes the early-bound <code>Index</code> call <i>raise</i> a type mismatch error. Replace <code>Application.Match</code> with <code>Application.WorksheetFunction.Match</code> to make it <i>raise</i> an error in case of a mismatch, and/or pull it out and compute it separately, and only invoke the <code>Index</code> when you <i>know</i> the <code>Match</code> succeeded."}, {"owner": {"reputation": 327, "user_id": 2073606, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/39e2a034e7c5c1afa190ff0ae0cf5357?s=128&d=identicon&r=PG", "display_name": "user2073606", "link": "https://stackoverflow.com/users/2073606/user2073606"}, "edited": false, "score": 0, "creation_date": 1521199005, "post_id": 49283620, "comment_id": 85639824, "body": "CallDate is a text box in a UserForm, is this the problem?  The way I want it to work is that you select the reference and then it displays the call data (date, caller, phone number) in boxes on the form - is this impractical/impossible?  Thanks"}, {"owner": {"reputation": 327, "user_id": 2073606, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/39e2a034e7c5c1afa190ff0ae0cf5357?s=128&d=identicon&r=PG", "display_name": "user2073606", "link": "https://stackoverflow.com/users/2073606/user2073606"}, "edited": false, "score": 0, "creation_date": 1521199084, "post_id": 49283620, "comment_id": 85639884, "body": "@Jeeped - they are single columns in my table, I don&#39;t know how to check if this is the problem"}], "answers": [{"comments": [{"owner": {"reputation": 327, "user_id": 2073606, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/39e2a034e7c5c1afa190ff0ae0cf5357?s=128&d=identicon&r=PG", "display_name": "user2073606", "link": "https://stackoverflow.com/users/2073606/user2073606"}, "edited": false, "score": 0, "creation_date": 1521198823, "post_id": 49284552, "comment_id": 85639692, "body": "Hi, Thanks for this, I have tried this and it returns -  &#39;7&#39; not found, or lookup array is more than one column or row.  I know that the Ref numbers are there because I did a for to loop through and debug print them.  How would I go further and figure this out?  Thanks"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 327, "user_id": 2073606, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/39e2a034e7c5c1afa190ff0ae0cf5357?s=128&d=identicon&r=PG", "display_name": "user2073606", "link": "https://stackoverflow.com/users/2073606/user2073606"}, "edited": false, "score": 0, "creation_date": 1521202415, "post_id": 49284552, "comment_id": 85641867, "body": "Double check that your data does not have spaces or other non printable characters that would exclude Excel finding a match. The error now is with the data. Make sure that if you are looking for numbers that the data is not text strings that look like numbers. It is also looking for exact matches not partial matches"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 0, "last_activity_date": 1521049708, "creation_date": 1521049708, "answer_id": 49284552, "question_id": 49283620, "link": "https://stackoverflow.com/questions/49283620/error-13-type-mismatch-index-match/49284552#49284552", "title": "Error 13 - Type mismatch - Index Match", "body": "<p>As stated most likely the Match is not being found and an error is being passed to the INDEX.</p>\n\n<p>Pull the MATCH out and test for the error before finding the correct cell in the data.</p>\n\n<pre><code>Private Sub Ref_Change()\n\nDim ws As Worksheet\nDim tbl As ListObject\n\nSet ws = Worksheets(\"Details\")\nSet tbl = ws.ListObjects(\"Call_Log\")\n\nDim RefCol As Range\nDim NameCol As Range\nDim PhoneCol As Range\nDim DateCol As Range\n\nSet RefCol = tbl.ListColumns(\"Ref Number\").DataBodyRange\nSet NameCol = tbl.ListColumns(\"Caller Name\").DataBodyRange\nSet PhoneCol = tbl.ListColumns(\"Telephone\").DataBodyRange\nSet DateCol = tbl.ListColumns(\"Date\").DataBodyRange\n\nDim mtchRow As Long\nmtchRow = 0\nOn Error Resume Next\n    mtchRow = Application.WorksheetFunction.Match(Me.ref.Value, RefCol, 0)\nOn Error GoTo 0\nIf mtchRow &gt; 0 Then\n    Me.CallDate.Value = DateCol.Cells(mtchRow, 1).Value\nElse\n    MsgBox \"'\" &amp; Me.ref.Value &amp; \"' not found, or lookup array is more than one column or row\"\nEnd If\n\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 327, "user_id": 2073606, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/39e2a034e7c5c1afa190ff0ae0cf5357?s=128&d=identicon&r=PG", "display_name": "user2073606", "link": "https://stackoverflow.com/users/2073606/user2073606"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 235, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521049708, "creation_date": 1521046738, "last_edit_date": 1521046820, "question_id": 49283620, "link": "https://stackoverflow.com/questions/49283620/error-13-type-mismatch-index-match", "title": "Error 13 - Type mismatch - Index Match", "body": "<p>Getting the above error on the Index/Match.  Will try and keep this short and sweet but I am a VBA noob.  Everything that is called has data in.  One thing I noticed was that RefCol (a range of numbers) has leading and trailing whitespace when I do a Debug Print.  However when I tested the length of the value it returned the correct values.</p>\n\n<p>I can't understand what is breaking it, I did an index match in the workbook itself and it works perfectly.</p>\n\n<pre><code>Private Sub Ref_Change()\n\nDim ws As Worksheet\nDim tbl As ListObject\n\nSet ws = Worksheets(\"Details\")\nSet tbl = ws.ListObjects(\"Call_Log\")\n\nDim RefCol As Range\nDim NameCol As Range\nDim PhoneCol As Range\nDim DateCol As Range\n\nSet RefCol = tbl.ListColumns(\"Ref Number\").DataBodyRange\nSet NameCol = tbl.ListColumns(\"Caller Name\").DataBodyRange\nSet PhoneCol = tbl.ListColumns(\"Telephone\").DataBodyRange\nSet DateCol = tbl.ListColumns(\"Date\").DataBodyRange\n\nMe.CallDate.Value = Application.WorksheetFunction.Index(DateCol, Application.Match(Me.Ref.Value, RefCol, 0))\n\nEnd Sub\n</code></pre>\n\n<p>Have I set this up correctly?</p>\n\n<p>Thanks</p>\n\n<p>Evan</p>\n"}, {"tags": ["excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521046905, "post_id": 49283504, "comment_id": 85570040, "body": "I just tested and it worked fine for me.  I don&#39;t think you need an alternate method; it&#39;s better to figure out what&#39;s wrong with the one you&#39;re trying.  <b>Are you getting an error?</b>"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1521047001, "post_id": 49283504, "comment_id": 85570101, "body": "...also, on what are you basing <code>&quot;apparently Access 2010 does not allow exporting to Excel files with macros&quot;</code>?  Did you read that somewhere or is it a guess?"}, {"owner": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "edited": false, "score": 0, "creation_date": 1521047512, "post_id": 49283504, "comment_id": 85570432, "body": "I don&#39;t think that you can &quot;Export to an Excel workbook&quot; if the workbook is currently open, can you?  You should get some file permission or &quot;can&#39;t open file&quot; error."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521047564, "post_id": 49283504, "comment_id": 85570473, "body": "I thought it could be related that you&#39;re exporting to a <b><code>.XLSB</code></b> file (as opposed to <code>.XLSM</code>), or that you&#39;re using <b><code>acSpreadsheetTypeExcel12Xml</code></b> (as opposed to <code>acSpreadsheetTypeExcel12</code>) but I tried various combinations of those and &quot;I couldn&#39;t make my test <i>not</i> export successfully&quot;.  are you sure the filename is correct?"}, {"owner": {"reputation": 11, "user_id": 9386691, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Craig Kostka", "link": "https://stackoverflow.com/users/9386691/craig-kostka"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521047576, "post_id": 49283504, "comment_id": 85570480, "body": "@ashleedawg No Error it just doesn&#39;t export. If I change the file format back to .xlsx it works perfectly fine. I have tried with .xlsm and .xlsb without any luck. And yes, I read it somewhere which linked back to Microsoft&#39;s site as the source for the conclusion. I agree, I would love to get this method to work. Did you get it to work using MS 2010 and exporting to a .xlsm file?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521047723, "post_id": 49283504, "comment_id": 85570584, "body": "Could you find where you read that?  ...because I think you&#39;re mistaken."}, {"owner": {"reputation": 11, "user_id": 9386691, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Craig Kostka", "link": "https://stackoverflow.com/users/9386691/craig-kostka"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521047855, "post_id": 49283504, "comment_id": 85570683, "body": "@ashleedawg <a href=\"https://www.mrexcel.com/forum/microsoft-access/425958-docmd-transferspreadsheet-access-2007-excel-2007-xlsm-help-needed.html\" rel=\"nofollow noreferrer\">mrexcel.com/forum/microsoft-access/&hellip;</a>"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1521047901, "post_id": 49283504, "comment_id": 85570717, "body": "I tested numerous ways, yes. have you tried exporting to a <b><i>different file</i></b>?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521048072, "post_id": 49283504, "comment_id": 85570820, "body": "@CraigKostka that link doesn&#39;t even mention Excel 2010.  The logical next steps for troubleshooting are: 1. Reboot your computer *(could be a file lock problem), 2. Try a different (blank) file, 3. Try exporting a different table."}, {"owner": {"reputation": 11, "user_id": 9386691, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Craig Kostka", "link": "https://stackoverflow.com/users/9386691/craig-kostka"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521048549, "post_id": 49283504, "comment_id": 85571148, "body": "@ashleedawg Thanks for your help so far. So I created a .xlsm file on my desktop [Local Disk] and it worked. I then tried to run it from the same folder my initial question is based on [Network Drive] and it also worked BUT I noticed the file now has the file name followed by [Group] displayed in the name of the workbook at the top of the file. This is stored in the same location as the original problem file."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521048588, "post_id": 49283504, "comment_id": 85571179, "body": "@craig -  ...but it works?  If you close &amp; re-open, all is okay?  And you can export again?"}, {"owner": {"reputation": 11, "user_id": 9386691, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Craig Kostka", "link": "https://stackoverflow.com/users/9386691/craig-kostka"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521048694, "post_id": 49283504, "comment_id": 85571259, "body": "@ashleedawg Yes! But the problem file does not update with the [Group] text so I suspect this has something to do with being on a group drive. Thanks for ensuring my code is accurate. I will play around and see if i can get the original file to become similar to the test file i made."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521048842, "post_id": 49283504, "comment_id": 85571369, "body": "@craig -  If you continue having problems, you should probably do like Erik suggested below: instead <i>pushing</i> from Access, <i>pull</i> from Excel.  Did someone else have the file open before?  You shouldn&#39;t be exporting to shared files for that reason.  Another option is to export to a &quot;plain&quot; data file, and link your shared workbook from there."}, {"owner": {"reputation": 11, "user_id": 9386691, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Craig Kostka", "link": "https://stackoverflow.com/users/9386691/craig-kostka"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1521049361, "post_id": 49283504, "comment_id": 85571686, "body": "@ashleedawg The [GROUP] after the file name is not what I believed it to mean. It merely means more than one Excel sheet is selected, as soon as I select only one sheet it disappears. I moved my ORIGINAL file in question to my desktop (Local Drive) it the code still does not run for it. This is really frustrating."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521050347, "post_id": 49283504, "comment_id": 85572276, "body": "Did you change the path in your code after you moved the file?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521050514, "post_id": 49283504, "comment_id": 85572405, "body": "...Also, what other code is in the procedure?  For debugging purposes, you should be running only this one line of code. (as per &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>&quot;)"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521050833, "post_id": 49283504, "comment_id": 85572599, "body": "...I can pretty much guarantee it&#39;s a minor oversight on your part, especially since you&#39;re &quot;not getting any errors&quot;.  Make sure it&#39;s the only line of code running (partly so there are no <code>On Error...</code> statements running.  Copy and paste the path from your code into a [Start]-&gt;[Run] dialog and see if it opens <i>as is</i>.  When it opens, scroll to cell A1."}, {"owner": {"reputation": 11, "user_id": 9386691, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Craig Kostka", "link": "https://stackoverflow.com/users/9386691/craig-kostka"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521056880, "post_id": 49283504, "comment_id": 85575879, "body": "@ashleedawg I don&#39;t think its fair to say that it&#39;s guaranteed to be a minor oversight on my part considering I have run this query successfully with other empty .xlsm files and for whatever reason it is not working with the one in question. I have guaranteed the file path is correct as I get it directly from the file and also the code I included is the only code in the Public Function, and there is only one Function I have in the Access file."}], "answers": [{"comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521048260, "post_id": 49283984, "comment_id": 85570950, "body": "Interesting test:... my theory is it won&#39;t work because the file transfer method isn&#39;t the issue."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1521048326, "post_id": 49283984, "comment_id": 85570999, "body": "Perhaps. Anyway, the appropriate way, to do it is to import from Excel, instead of exporting to Excel."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521048553, "post_id": 49283984, "comment_id": 85571153, "body": "It <i>should</i> work either way, but yes.  I&#39;m curious about this one because I&#39;ve probably used <code>TransferSpreadsheet</code> a million times... I was surprised to see that it even works for me if the Excel file is <i>open</i>.  I could see the data removed &amp; replaced, as if it was a DB table.  I&#39;m pretty sure <i>that</i> didn&#39;t used to work."}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": false, "score": 1, "last_activity_date": 1521047846, "creation_date": 1521047846, "answer_id": 49283984, "question_id": 49283504, "link": "https://stackoverflow.com/questions/49283504/export-access-query-to-existing-excel-workbook-which-has-macros/49283984#49283984", "title": "Export Access Query to Existing Excel Workbook (which has Macros)", "body": "<p>You can try using an <code>INSERT</code> query from Access:</p>\n\n<pre><code>CurrentDb.Execute \"INSERT INTO [Excel 12.0 Macro;HDR=Yes;DATABASE=M:\\Merch. Strategy\\Merch Forecasting\\Automotive Division\\File Sharing\\Automotive Deal-Page-Slot View\\Deal-Page-Slot-View.xlsm].[Sheet1$] SELECT * FROM Data_SlotView;\"\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9386691, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Craig Kostka", "link": "https://stackoverflow.com/users/9386691/craig-kostka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1426, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1593955775, "creation_date": 1521046331, "last_edit_date": 1593955775, "question_id": 49283504, "link": "https://stackoverflow.com/questions/49283504/export-access-query-to-existing-excel-workbook-which-has-macros", "title": "Export Access Query to Existing Excel Workbook (which has Macros)", "body": "<p>First question on Stackoverflow, have been using the site as a viewer for a long time. </p>\n\n<p>I need to export a query from Access 2010 into an existing Excel 2010 Workbook which can be either .xlsm or .xlsb (since macros work in both). I set it up the following way:</p>\n\n<ul>\n<li>User clicks a button in the Excel workbook to refresh a tab<br>\n--> this runs VBA in Excel that calls a Macro in Access to run\n         ---> the macro in Access merely calls an existing query in Access to run and export the results back to the initial Excel Workbook.</li>\n</ul>\n\n<p>Access Macro Code:</p>\n\n<pre><code>DoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel12Xml, \"Data_SlotView\", \"M:\\Merch. Strategy\\Merch Forecasting\\Automotive Division\\File Sharing\\Automotive Deal-Page-Slot View\\Deal-Page-Slot-View.xlsb\"\n</code></pre>\n\n<p>My code works if my Excel file was .xlsx but apparently Access 2010 does not allow exporting to Excel files with macros so I have to use some sort of workaround method. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1521046562, "post_id": 49283485, "comment_id": 85569794, "body": "InitializeErrorCodes is a function, not a property, and you are trying to use it as a property. Correct call should be <code>Set ErrorCodes = InitializeErrorCodes</code>. And since InitializeErrorCodes does the collection initialization, you should drop the <code>Set ErrorCodes = New Collection</code> in <code>testingFunc</code>"}, {"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1521046743, "post_id": 49283485, "comment_id": 85569914, "body": "@VincentG My oh my... not sure how I missed such a newbie mistake... Got a little rusty after a couple week break apparently. Thanks for spotting that out for me! Can you post as an answer so I can mark it?"}], "answers": [{"tags": [], "owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "is_accepted": true, "score": 4, "last_activity_date": 1521046918, "creation_date": 1521046918, "answer_id": 49283667, "question_id": 49283485, "link": "https://stackoverflow.com/questions/49283485/vba-function-to-return-collection/49283667#49283667", "title": "VBA Function to Return Collection", "body": "<p><code>InitializeErrorCodes</code> is a function, not a property, but you are trying to use it as a property.\nCorrect call should be <code>Set ErrorCodes = InitializeErrorCodes</code>.</p>\n\n<p>And since InitializeErrorCodes does the collection initialization, you should drop the <code>Set ErrorCodes = New Collection</code> in <code>testingFunc</code>.</p>\n"}], "owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7646, "favorite_count": 0, "accepted_answer_id": 49283667, "answer_count": 1, "score": 1, "last_activity_date": 1521046918, "creation_date": 1521046253, "last_edit_date": 1531164843, "question_id": 49283485, "link": "https://stackoverflow.com/questions/49283485/vba-function-to-return-collection", "title": "VBA Function to Return Collection", "body": "<p>I'm trying to return a type <code>Collection</code> from a function and I am getting the error: </p>\n\n<blockquote>\n  <p>Compile error:</p>\n  \n  <p>Invalid use of property</p>\n</blockquote>\n\n<p>Here is the below code that's I created to test the function. I know the collection is filling correctly as I've testing a run through of the collection and output all values; which all came out as intended.</p>\n\n<p><strong>QUESTION:</strong></p>\n\n<p>Why is this error occurring? And what's the best approach to fix it?</p>\n\n<pre><code>Sub testingFunc()\n\n   Dim ErrorCodes As Collection\n   Set ErrorCodes = New Collection\n\n   Set InitializeErrorCodes = ErrorCodes '&lt;--- Where my error is occurring when trying to retrieve the collection\n\nEnd Sub\n</code></pre>\n\n<p>And here is the code initializing my <code>Error Codes</code></p>\n\n<pre><code>Function InitializeErrorCodes() As Collection '&lt;--- Where I'm trying to return the collection\n\n   Dim ErrorCodes As Collection\n   Set ErrorCodes = New Collection\n\n   AddToErrorCollection ErrorCodes, \"CSD_ERR_120\", \"Multiple products in a case is invalid\"\n   AddToErrorCollection ErrorCodes, \"CSD_ERR_128\", \"Invalid Store with Zero Allocation\"\n   AddToErrorCollection ErrorCodes, \"DET_ERR_101\", \"Purchase Order Status Notification\"\n   AddToErrorCollection ErrorCodes, \"DET_ERR_104\", \"Tolerance Violation - Overshipment\"\n   AddToErrorCollection ErrorCodes, \"DET_ERR_110\", \"Multiple Open Lines found for Product on PO\"\n   AddToErrorCollection ErrorCodes, \"DET_ERR_111\", \"Tolerance Violation - short shipment\"\n   AddToErrorCollection ErrorCodes, \"DET_ERR_112\", \"Tolerance Violation - Number of Store/SKU Discrepancies Exceeded\"\n   AddToErrorCollection ErrorCodes, \"DET_ERR_114\", \"Product (casepack) Mismatch on one or more product identifiers\"\n   AddToErrorCollection ErrorCodes, \"DET_ERR_115\", \"Product (Bulk) Mismatch on one or more product indentifiers\"\n   AddToErrorCollection ErrorCodes, \"DET_ERR_116\", \"No Open Line was found. PO contains a line in Cancel Status for Product\"\n   AddToErrorCollection ErrorCodes, \"DET_ERR_117\", \"Early Shipping Date Violation\"\n   AddToErrorCollection ErrorCodes, \"DET_ERR_118\", \"PO Cancel Date Violation || Passed Cancel Date\"\n   AddToErrorCollection ErrorCodes, \"DET_ERR_125\", \"Duplicate vendor case number\"\n   AddToErrorCollection ErrorCodes, \"HDR_ERR_101\", \"Duplicate Vendor ASN Number\"\n   AddToErrorCollection ErrorCodes, \"PRE_ERR_105\", \"Invalid Prepack configuration. Failed - Missing Component SKU(s)\"\n   AddToErrorCollection ErrorCodes, \"PRE_ERR_106\", \"Product Quantity does not equal the sum of the case quantities\"\n\n   Set InitializeErrorCodes = ErrorCodes\n\nEnd Function\n</code></pre>\n\n<p>Below is the function in conjunction with above to add to the collection</p>\n\n<pre><code>Private Sub AddToErrorCollection(Col As Collection, eName As String, eDescription As String)\n\n   Dim NewErrorCode As cErrorCodes\n   Set NewErrorCode = New cErrorCodes\n   NewErrorCode.name = eName\n   NewErrorCode.description = eDescription\n\n   Col.Add NewErrorCode\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 721, "user_id": 7889129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0oYIA.jpg?s=128&g=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7889129/maddy"}, "edited": false, "score": 0, "creation_date": 1521044438, "post_id": 49282792, "comment_id": 85568348, "body": "I think you missed single quote <code>&#39;</code> in this line <code>&quot;NUMBER = &quot; &amp; Me.NumForm.Value &amp; &quot;&#39;, &quot; &amp; _</code>. after <code>=</code> you need to add <code>&#39;</code>"}, {"owner": {"reputation": 23, "user_id": 9122791, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209374946165089/picture?type=large", "display_name": "Diogo Martins", "link": "https://stackoverflow.com/users/9122791/diogo-martins"}, "reply_to_user": {"reputation": 721, "user_id": 7889129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0oYIA.jpg?s=128&g=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7889129/maddy"}, "edited": false, "score": 0, "creation_date": 1521044547, "post_id": 49282792, "comment_id": 85568414, "body": "Saw that, was a mistake, since it is an integer, there is no need for the quote, took it off but same error."}, {"owner": {"reputation": 424, "user_id": 3479671, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1eec243884e037322a33ea3086499165?s=128&d=identicon&r=PG&f=1", "display_name": "user3479671", "link": "https://stackoverflow.com/users/3479671/user3479671"}, "edited": false, "score": 0, "creation_date": 1521044768, "post_id": 49282792, "comment_id": 85568576, "body": "shouldn&#39;t Str(NewFormationID) be encapsulated in single quotes for the WHERE clause?"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 424, "user_id": 3479671, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1eec243884e037322a33ea3086499165?s=128&d=identicon&r=PG&f=1", "display_name": "user3479671", "link": "https://stackoverflow.com/users/3479671/user3479671"}, "edited": false, "score": 0, "creation_date": 1521045359, "post_id": 49282792, "comment_id": 85568994, "body": "@user3479671 Assuming it&#39;s numerical, which IDs usually are, no, it shouldn&#39;t, and doing so would cause an error. Casting it to a string doesn&#39;t hurt, since you&#39;re concatenating it to a string and that casts it anyway."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 9122791, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209374946165089/picture?type=large", "display_name": "Diogo Martins", "link": "https://stackoverflow.com/users/9122791/diogo-martins"}, "edited": false, "score": 0, "creation_date": 1521045701, "post_id": 49283117, "comment_id": 85569206, "body": "Tried to test your idea, but still got the update syntax error. He doesn&#39;t pass by the update. Doesn&#39;t reach the parameters part."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 23, "user_id": 9122791, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209374946165089/picture?type=large", "display_name": "Diogo Martins", "link": "https://stackoverflow.com/users/9122791/diogo-martins"}, "edited": false, "score": 0, "creation_date": 1521045856, "post_id": 49283117, "comment_id": 85569278, "body": "Did you try the latest version? Hard to fix all errors if there are more than 3"}, {"owner": {"reputation": 23, "user_id": 9122791, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209374946165089/picture?type=large", "display_name": "Diogo Martins", "link": "https://stackoverflow.com/users/9122791/diogo-martins"}, "edited": false, "score": 0, "creation_date": 1521046071, "post_id": 49283117, "comment_id": 85569423, "body": "Saw now the edited version of your answer, i&#39;ll test it now"}, {"owner": {"reputation": 23, "user_id": 9122791, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209374946165089/picture?type=large", "display_name": "Diogo Martins", "link": "https://stackoverflow.com/users/9122791/diogo-martins"}, "edited": false, "score": 0, "creation_date": 1521046262, "post_id": 49283117, "comment_id": 85569572, "body": "Yup that solved the problem, also the keyword Number was the main problem, tried on both ways to see if it would work and it went smoothly. Appreciated! Never knew that Number was a keyword to VBA, still got a lot to learn it seems."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 23, "user_id": 9122791, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209374946165089/picture?type=large", "display_name": "Diogo Martins", "link": "https://stackoverflow.com/users/9122791/diogo-martins"}, "edited": false, "score": 0, "creation_date": 1521046585, "post_id": 49283117, "comment_id": 85569808, "body": "The <a href=\"https://msdn.microsoft.com/en-us/library/ff845663.aspx\" rel=\"nofollow noreferrer\">SQL reserved words</a> list is a good resource. It&#39;s quite a long list."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 23, "user_id": 9122791, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209374946165089/picture?type=large", "display_name": "Diogo Martins", "link": "https://stackoverflow.com/users/9122791/diogo-martins"}, "edited": false, "score": 1, "creation_date": 1521046599, "post_id": 49283117, "comment_id": 85569818, "body": "@DiogoMartins for the record, the <i>main problem</i> was the string-concatenation of what should have been parameters. <a href=\"https://xkcd.com/327/\" rel=\"nofollow noreferrer\"><b>This is serious business</b></a>, in DBA-land it&#39;s called an <i>SQL Injection vulnerability</i>, and it leads to all kinds of problems. As for the square-bracketed name, it&#39;s not a bad idea to <i>systematically</i> add them to every table &amp; field name in your SQL strings."}, {"owner": {"reputation": 23, "user_id": 9122791, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209374946165089/picture?type=large", "display_name": "Diogo Martins", "link": "https://stackoverflow.com/users/9122791/diogo-martins"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1521046849, "post_id": 49283117, "comment_id": 85569999, "body": "I&#39;ve got to admit that I even put it on SQL but there wasn&#39;t any kind of keyword &quot;enlightnment&quot; on NUMBER, will need to learn more keywords it seems. @Mat&#39;sMug thanks for the tip ahah and for now onward i&#39;ll systematically will add them to every table &amp; field name!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1521046981, "post_id": 49283117, "comment_id": 85570090, "body": "Awesome! #OneMoreSavedSoul"}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 2, "last_activity_date": 1521045479, "last_edit_date": 1521045479, "creation_date": 1521045143, "answer_id": 49283117, "question_id": 49282792, "link": "https://stackoverflow.com/questions/49282792/syntax-error-in-update-statement-cant-find-the-solution/49283117#49283117", "title": "Syntax error in UPDATE Statement can&#39;t find the solution", "body": "<p>There are many things wrong with that statement, but they can all be fixed using parametrization.</p>\n\n<p>First, the missed quote, everyone saw that.</p>\n\n<p>Second, you're setting a column equal to <code>Now()</code>, but not using the proper date formatting, and not using date delimiters (<code>#</code>).</p>\n\n<p>Third, you're using apostrophes to delimit strings, but not testing if the strings themselves contain apostrophes, inviting unpredictable and hard to diagnose errors.</p>\n\n<p>Also, <code>Number</code> is a keyword, that should be enclosed in <code>[]</code> brackets.</p>\n\n<p>You should use parametrization, then most of these errors can't occur:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim qd As DAO.QueryDef\nSet qd = CurrentDb.CreateQueryDef(\"\", \"UPDATE formation \" &amp; _\n            \"SET AREA = ?, \" &amp; _\n            \"TYPE = ?, \" &amp; _\n            \"TEAM = ?, \" &amp; _\n            \"PRIORITY = ?, \" &amp; _\n            \"PROCESS = ?, \" &amp; _\n            \"[NUMBER] = ?, \" &amp; _\n            \"SUPERVISOR = ?, \" &amp; _\n            \"Cc = ?, \" &amp; _\n            \"STATUS = 'SUBMITED', \" &amp; _\n            \"USER_UPDATE = ?, \" &amp; _\n            \"DATA_STATUS_NOW = ? \" &amp; _\n            \"WHERE ID = ?\")\nqd.Parameters(0) = Me.AREA\nqd.Parameters(1) = Me.TYPE\nqd.Parameters(2) = Me.TEAM \nqd.Parameters(3) = Me.PRIORITY\nqd.Parameters(4) = Me.PROCESSO \nqd.Parameters(5) = Me.NumForm.Value\nqd.Parameters(6) = Me.SUPERVISOR \nqd.Parameters(7) = Me.mailCc \nqd.Parameters(8) = newFormationUser \nqd.Parameters(9) = Now() \nqd.Parameters(10) = NewFormationID\nqd.Execute\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 9122791, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209374946165089/picture?type=large", "display_name": "Diogo Martins", "link": "https://stackoverflow.com/users/9122791/diogo-martins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 49283117, "answer_count": 1, "score": 0, "last_activity_date": 1521054901, "creation_date": 1521044250, "last_edit_date": 1521054901, "question_id": 49282792, "link": "https://stackoverflow.com/questions/49282792/syntax-error-in-update-statement-cant-find-the-solution", "title": "Syntax error in UPDATE Statement can&#39;t find the solution", "body": "<p>I'm having some trouble updating my table in access through the following code:</p>\n\n<pre><code>Update = \"UPDATE formation \" &amp; _\n            \"SET AREA = '\" &amp; Me.AREA &amp; \"', \" &amp; _\n            \"TYPE = '\" &amp; Me.TYPE &amp; \"', \" &amp; _\n            \"TEAM = '\" &amp; Me.TEAM &amp; \"', \" &amp; _\n            \"PRIORITY = '\" &amp; Me.PRIORITY &amp; \"', \" &amp; _\n            \"PROCESS = '\" &amp; Me.PROCESSO &amp; \"', \" &amp; _\n            \"NUMBER = \" &amp; Me.NumForm.Value &amp; \"', \" &amp; _\n            \"SUPERVISOR = '\" &amp; Me.SUPERVISOR &amp; \"', \" &amp; _\n            \"Cc = '\" &amp; Me.mailCc &amp; \"', \" &amp; _\n            \"STATUS = 'SUBMITED', \" &amp; _\n            \"USER_UPDATE = '\" &amp; newFormationUser &amp; \"', \" &amp; _\n            \"DATA_STATUS_NOW = '\" &amp; Now() &amp; \"' \" &amp; _\n         \"WHERE ID = \" &amp; Str(NewFormationID)\n\nDoCmd.SetWarnings False\nDoCmd.RunSQL Update\nDoCmd.SetWarnings True\n</code></pre>\n\n<p>NumForm is a ComboBox of numbers 1 to 15.\nI've tried to redo query, redo code, remake table with no luck in solving.\nRead over and over again to find errors in typo or even in code.</p>\n\n<p>Can you guys help me?\nThank you,\nDiogo</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1521043837, "post_id": 49282557, "comment_id": 85567897, "body": "<code>Units</code> is not a declared variable in <code>ps = Pressure(FluidName, &quot;Tvap&quot;, Units, SuctionTemp)</code> make sure you use <code>Option Explicit</code>. What you can do to debug the function is writing a test sub that is calling the function like <code>Debug.Print DischargePipingLoss_per_FT(&quot;nnn&quot;, 2, &quot;copper&quot;, 10, 11, 12, &quot;unit&quot;, 2)</code> then start the test sub with F8 and go through step by step."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1521044164, "post_id": 49282557, "comment_id": 85568125, "body": "The function is invoking other functions - do any of these have any kind of side-effects on global or workbook/worksheet state? A UDF isn&#39;t allowed to alter any cells, in any way. What&#39;s the <code>Density</code> function doing?"}, {"owner": {"reputation": 75, "user_id": 9015463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56754e78caeb77f878378b7991d62a52?s=128&d=identicon&r=PG&f=1", "display_name": "J. McConnor", "link": "https://stackoverflow.com/users/9015463/j-mcconnor"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1521045159, "post_id": 49282557, "comment_id": 85568851, "body": "@P\u1d07\u029c forgot to include my global scope declarations, so units is defined"}, {"owner": {"reputation": 75, "user_id": 9015463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56754e78caeb77f878378b7991d62a52?s=128&d=identicon&r=PG&f=1", "display_name": "J. McConnor", "link": "https://stackoverflow.com/users/9015463/j-mcconnor"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1521045239, "post_id": 49282557, "comment_id": 85568910, "body": "@Mat&#39;sMug The density function is calling a separate function in another module. I know this is not a problem, because I have many other functions doing the same thing without issue."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1521045317, "post_id": 49282557, "comment_id": 85568967, "body": "Ok. <i>Something, somewhere</i>, is being invoked and doing something it shouldn&#39;t be doing. You can very well invoke a UDF from VBA code without any errors and get the expected result - and then you get <code>#VALUE</code> when you try to use that same UDF from a worksheet cell. The problem is that we&#39;re not seeing such code here, so the answer below is likely the best you&#39;ll be getting."}, {"owner": {"reputation": 75, "user_id": 9015463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56754e78caeb77f878378b7991d62a52?s=128&d=identicon&r=PG&f=1", "display_name": "J. McConnor", "link": "https://stackoverflow.com/users/9015463/j-mcconnor"}, "edited": false, "score": 2, "creation_date": 1521046642, "post_id": 49282557, "comment_id": 85569843, "body": "Figured it out. Used the Immediate Window and was able to see the error messages being sent from the DLL and fixed my formulas. Nothing wrong with how it was coded. Seems to be an issue with the DLL I&#39;m using and one particular equation. Thanks all"}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1521045661, "last_edit_date": 1592644375, "creation_date": 1521044821, "answer_id": 49282990, "question_id": 49282557, "link": "https://stackoverflow.com/questions/49282557/user-defined-function-gives-value-but-hand-calculation-works/49282990#49282990", "title": "User Defined Function gives #VALUE!, but hand calculation works?", "body": "<p><code>#VALUE</code> is the standard answer of the Excel VBA, when a UDF function is trying to change the environment of Microsoft Excel (see the yellow square).</p>\n<p>Check this small function:</p>\n<pre><code>Public Function Example() As Long\n    'Range(&quot;A1&quot;) = 10\n    Example = 5\nEnd Function\n</code></pre>\n<p>If you call it like this <code>=Example</code> in Excel, it will return 5.</p>\n<p>Then, if you uncomment the <code>Range(&quot;A1&quot;)=10</code> you will see that the <code>#VALUE</code> error appears. Thus, long story short - your function (or the one it is calling) is obviously doing something illegal. Try to find what is it and eliminate it.</p>\n<hr />\n<blockquote>\n<p>A user-defined function called by a formula in a worksheet cell cannot change the environment of Microsoft Excel. This means that such a function cannot do any of the following:</p>\n<ul>\n<li>Insert, delete, or format cells on the spreadsheet.</li>\n<li>Change another cell's value.</li>\n<li>Move, rename, delete, or add sheets to a workbook.</li>\n<li>Change any of the environment options, such as calculation mode or screen views.</li>\n<li>Add names to a workbook.</li>\n<li>Set properties or execute most methods.</li>\n</ul>\n</blockquote>\n<p><a href=\"http://Description%20of%20limitations%20of%20custom%20functions%20in%20Excel\" rel=\"nofollow noreferrer\">support.microsoft.com - Description of limitations of custom functions in Excel</a></p>\n"}], "owner": {"reputation": 75, "user_id": 9015463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56754e78caeb77f878378b7991d62a52?s=128&d=identicon&r=PG&f=1", "display_name": "J. McConnor", "link": "https://stackoverflow.com/users/9015463/j-mcconnor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "closed_date": 1521102596, "answer_count": 1, "score": 0, "last_activity_date": 1521045661, "creation_date": 1521043531, "last_edit_date": 1521045335, "question_id": 49282557, "link": "https://stackoverflow.com/questions/49282557/user-defined-function-gives-value-but-hand-calculation-works", "closed_reason": "Not suitable for this site", "title": "User Defined Function gives #VALUE!, but hand calculation works?", "body": "<p>I have created a VBA user-defined function to calculate some thermal properties. The functions within this user-defined function reference a very large module which references a .DLL file (REFPROP in case you are curious).</p>\n\n<p>When I plug everything into my function I get <code>#VALUE!</code>. However, if I do all the same steps as the function in my worksheet, I don't have any problems, I get a value. When I try to set up breaking points in my function, it will not stop at <code>FluidDensity</code>. Everything before that point stops and calculates correctly.</p>\n\n<pre><code>Option Explicit\nUnits = \"E\"\ngrav = 32.2\n\n    Function DischargePipingLoss_per_FT(FluidName As String, BTUperHR As Double, OutsideDia_copper As String,LiquidTemp As Double, SuctionTemp As Double, Superheat As Double, PipeLossUnits As String, Isentropic_Eff As Double)\n\n            Dim ps As Double\n            Dim ts As Double\n            Dim hs As Double\n            Dim ss As Double\n            Dim pd As Double\n            Dim hd As Double\n            Dim hd_actual As Double\n            Dim td As Double\n            Dim Re As Double, friction As Double\n            Dim DynamicVisc As Double\n            Dim KinematicViscosity_FT2perSEC As Double\n            Dim InsideDia_FT As Double, PressureDrop_ft As Double\n            Dim Velocity_FPS\n            Dim BTUperLB As Double\n            Dim LBperHR As Double\n            Dim FT3perHR As Double\n            Dim FluidDensity As Double\n            Dim SuctionPressure As Double\n            Dim ReturnGasTemp As Double\n            Dim PSID_per_FT As Double\n\n            'Determine suction pressure and temp\n                ps = Pressure(FluidName, \"Tvap\", Units, SuctionTemp)\n                ts = SuctionTemp + Superheat\n\n            'Determine liquid enthalpy, suction gas enthalpy\n                'hf = Enthalpy(FluidName, \"PT\", Units, HighPressure, GasCoolerOutletTemp)\n                hs = VaporEnthalpy(FluidName, \"PT\", Units, ps, ts)\n\n            'Determine return gas / discharge gas entropy\n                ss = VaporEntropy(FluidName, \"PT\", Units, ps, ts)\n\n            'Determine discharge pressure\n                pd = Pressure(FluidName, \"Tvap\", Units, LiquidTemp)\n\n            'Determine isentropic discharge gas enthalpy\n                hd = Enthalpy(FluidName, \"PS\", Units, pd, ss)\n\n            'Determine actual discharge gas enthalpy\n                hd_actual = (hd - hs) / Isentropic_Eff + hs\n\n            'Determine discharge temperature (uncomment if wanted)\n                td = Temperature(FluidName, \"PH\", Units, pd, hd_actual)\n\n            'calculate mass flowrate\n                BTUperLB = RefrigerationEffect(FluidName, Units, LiquidTemp, SuctionTemp, Superheat)\n                LBperHR = BTUperHR / BTUperLB\n\n            'calculate fluid transport properties\n                FluidDensity = Density(FluidName, \"PH\", Units, pd, hd_actual)\n                DynamicVisc = Viscosity(FluidName, \"PH\", Units, pd, hd_actual)\n\n           'calculate volume flowrate and velocity\n                FT3perHR = LBperHR / FluidDensity\n                InsideDia_FT = get_dia(OutsideDia_copper) / 12\n                Velocity_FPS = FT3perHR / (3.14 * (InsideDia_FT / 2) ^ 2) / 3600\n\n            'retrieve friction factor and calculate pressure drop (ft per ft)\n\n                KinematicViscosity_FT2perSEC = DynamicVisc / FluidDensity\n                PressureDrop_ft = FrictionFactor(Velocity_FPS, InsideDia_FT, KinematicViscosity_FT2perSEC) * (1 / InsideDia_FT) * (Velocity_FPS ^ 2 / (2 * grav))\n\n            'convert pressure drop to psi per ft\n            PSID_per_FT = PressureDrop_ft * FluidDensity / 12 ^ 2\n\n            If PipeLossUnits = \"PSI\" Then\n                DischargePipingLoss_per_FT = PSID_per_FT\n            ElseIf PipeLossUnits = \"degF\" Then\n                DischargePipingLoss_per_FT = deltaT(FluidName, td, PSID_per_FT)\n            Else: DischargePipingLoss_per_FT = \"error\"\n            End If\n\n        End Function\n</code></pre>\n"}, {"tags": ["sql-server", "excel", "vba"], "comments": [{"owner": {"reputation": 7147, "user_id": 5464747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f60df21c4da5e9dbe92aff62b4ded3b2?s=128&d=identicon&r=PG", "display_name": "dfundako", "link": "https://stackoverflow.com/users/5464747/dfundako"}, "edited": false, "score": 0, "creation_date": 1521043054, "post_id": 49282353, "comment_id": 85567306, "body": "Anything is possible."}, {"owner": {"reputation": 2334, "user_id": 7948962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b64557f8a617effccaf4426f16e9035?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob H", "link": "https://stackoverflow.com/users/7948962/jacob-h"}, "edited": false, "score": 0, "creation_date": 1521043396, "post_id": 49282353, "comment_id": 85567556, "body": "It&#39;s very unclear what you are asking here. You say the connection is working, but that there is an issue with security. Is it working, or is there an issue? What is the issue? You&#39;ve left out critical information (error? code?), otherwise no one can assist here."}, {"owner": {"reputation": 701, "user_id": 1732057, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/0cbc2ab3e7687ee2ccaf1d8a1af3dfba?s=128&d=identicon&r=PG", "display_name": "PJD", "link": "https://stackoverflow.com/users/1732057/pjd"}, "edited": false, "score": 0, "creation_date": 1521043573, "post_id": 49282353, "comment_id": 85567696, "body": "Sorry I will try an make it a little clearer....I have a working connection string but I am having to pass in the SQL username and password, which can be seen by everyone.  I don&#39;t want the password to be shown in the connection string but store it once I have typed it in once.  Hope that helps."}, {"owner": {"reputation": 3629, "user_id": 4730201, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yjnMS.png?s=128&g=1", "display_name": "Ricardo Pontual", "link": "https://stackoverflow.com/users/4730201/ricardo-pontual"}, "edited": false, "score": 0, "creation_date": 1521044518, "post_id": 49282353, "comment_id": 85568394, "body": "What about to use <i>integrated security</i>?"}, {"owner": {"reputation": 701, "user_id": 1732057, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/0cbc2ab3e7687ee2ccaf1d8a1af3dfba?s=128&d=identicon&r=PG", "display_name": "PJD", "link": "https://stackoverflow.com/users/1732057/pjd"}, "edited": false, "score": 0, "creation_date": 1521044712, "post_id": 49282353, "comment_id": 85568536, "body": "I would rather not be adding a large number of windows accounts to out SQL installation if I can help it so would rather use a SQL Account to access the necessary data."}], "answers": [{"tags": [], "owner": {"reputation": 66, "user_id": 9492773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b1b688c49a90f8cdb4d0293dfd32442?s=128&d=identicon&r=PG&f=1", "display_name": "SmileTechie", "link": "https://stackoverflow.com/users/9492773/smiletechie"}, "is_accepted": false, "score": 0, "last_activity_date": 1521045132, "creation_date": 1521045132, "answer_id": 49283110, "question_id": 49282353, "link": "https://stackoverflow.com/questions/49282353/sql-server-connection-string-to-excel/49283110#49283110", "title": "SQL Server Connection String to Excel", "body": "<p>I'd suggest creating a dll with the connection details in, compile it and then add this as a reference to the excel and distribute it with the excel.</p>\n\n<p>As a reference heres a link on how to do just that; <a href=\"https://stackoverflow.com/questions/3217014/how-to-securely-store-connection-string-details-in-vba\">How to securely store Connection String details in VBA</a></p>\n\n<p>(Sorry new or I'd suggest how to mark as duplicate)</p>\n"}], "owner": {"reputation": 701, "user_id": 1732057, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/0cbc2ab3e7687ee2ccaf1d8a1af3dfba?s=128&d=identicon&r=PG", "display_name": "PJD", "link": "https://stackoverflow.com/users/1732057/pjd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 305, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1521048284, "creation_date": 1521042976, "last_edit_date": 1531161705, "question_id": 49282353, "link": "https://stackoverflow.com/questions/49282353/sql-server-connection-string-to-excel", "title": "SQL Server Connection String to Excel", "body": "<p>I am connecting my Excel 2016 document to my SQL Server to pull data from a table.  I can get this to work fine but the issue is with the security.  I may be remembering this incorrectly but I thought there was a way of storing the username within the connection string with things like the IP but hiding the password.  I am connecting to the SQL Server using a SQL connection and not a Trusted Windows account. Is this possible?</p>\n\n<p>Thanks Phil </p>\n"}, {"tags": ["excel", "excel-2016", "vba"], "comments": [{"owner": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "edited": false, "score": 1, "creation_date": 1521043145, "post_id": 49282352, "comment_id": 85567374, "body": "I doubt that you will find a non VBA solution if you want to delete rows by some criteria..."}, {"owner": {"reputation": 523, "user_id": 942329, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/54d7d9aaa4fc9bb64f1cd7a889caec3f?s=128&d=identicon&r=PG", "display_name": "Eds", "link": "https://stackoverflow.com/users/942329/eds"}, "reply_to_user": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "edited": false, "score": 0, "creation_date": 1521046148, "post_id": 49282352, "comment_id": 85569485, "body": "Suspected as much. Given I have hardly ever touched VBA, any rough suggestions on what kind of commands I might need to be considering?"}], "answers": [{"comments": [{"owner": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "edited": false, "score": 0, "creation_date": 1521099880, "post_id": 49284581, "comment_id": 85590094, "body": "<code>ReDim Preserve</code> should be pulled outside of the for loop (slows down the code a lot). First <code>ReDim</code> the array before the loop <code>ReDim toDel(1 to RNG.Cells.Count)</code> and then remove the unnecessary slots after the loop with <code>ReDim Preserve toDel(1 to i-1)</code>."}, {"owner": {"reputation": 523, "user_id": 942329, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/54d7d9aaa4fc9bb64f1cd7a889caec3f?s=128&d=identicon&r=PG", "display_name": "Eds", "link": "https://stackoverflow.com/users/942329/eds"}, "edited": false, "score": 0, "creation_date": 1521126398, "post_id": 49284581, "comment_id": 85607716, "body": "This works perfectly! All I now need to do (which feels like it might be a bit more tricky), is delete the entire row that cell is on."}, {"owner": {"reputation": 523, "user_id": 942329, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/54d7d9aaa4fc9bb64f1cd7a889caec3f?s=128&d=identicon&r=PG", "display_name": "Eds", "link": "https://stackoverflow.com/users/942329/eds"}, "edited": false, "score": 0, "creation_date": 1521128362, "post_id": 49284581, "comment_id": 85609231, "body": "I managed to do that with the below: RowToDel = Range(toDel(i)).Cells.Row Rows(RowToDel).EntireRow.Delete"}], "tags": [], "owner": {"reputation": 3608, "user_id": 908624, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/RWEjG.jpg?s=128&g=1", "display_name": "Alon Adler", "link": "https://stackoverflow.com/users/908624/alon-adler"}, "is_accepted": true, "score": 1, "last_activity_date": 1521056220, "last_edit_date": 1521056220, "creation_date": 1521049776, "answer_id": 49284581, "question_id": 49282352, "link": "https://stackoverflow.com/questions/49282352/excel-2016-remove-duplicates-where-cell-color-is-x-or-other-condition/49284581#49284581", "title": "Excel 2016 - Remove duplicates where cell color is X, or other condition", "body": "<p>The following code will iterate over 'Column 1' in 'Sheet1', will find every duplicate value and will store it's address in an array. Then it will iterate the array and will check each address cell's color - if it's yellow, it will remove the duplicate.</p>\n\n<p>This is exactly per your requirements (except here yellow will be removed, as it seems more strait forward to me).</p>\n\n<p>For example, this data:</p>\n\n<p><a href=\"https://i.stack.imgur.com/sZ4XK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sZ4XK.png\" alt=\"enter image description here\"></a></p>\n\n<p>Will become this after the VBA run:</p>\n\n<p><a href=\"https://i.stack.imgur.com/2R9pM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2R9pM.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub sbFindDuplicatesInColumn_With_Color_Condition()\n\n    Dim toDel(), i As Long\n    Dim RNG As Range, Cell As Long\n\n    'Declare and set the worksheet where your data is stored\n    Dim sheet As Worksheet\n    Set sheet = Worksheets(\"Sheet1\")\n\n    'Finding the last row in the Column 1\n    lastRow = sheet.Cells(sheet.Rows.Count, 1).End(xlUp).Row\n\n    'Set the range to the last row of data in the column\n    Set RNG = Range(\"a1:a\" &amp; lastRow) 'set your range here\n\n    'Iterate over the column, finding duplicates and store their address in an array\n    For Cell = 1 To RNG.Cells.Count\n        If Application.CountIf(RNG, RNG(Cell)) &gt; 1 Then\n            ReDim Preserve toDel(i)\n            toDel(i) = RNG(Cell).Address\n            i = i + 1\n        End If\n    Next\n    'Iterate over the array and remove duplicates with specific color index (in this example - remove the yellow ones)\n    For i = UBound(toDel) To LBound(toDel) Step -1\n        If Range(toDel(i)).Cells.Interior.ColorIndex = 6 Then\n            Range(toDel(i)).Cells.Value = \"\"\n        End If\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p>You can modify which color you want to remove the value upon, based on the ColorIndex property (To remove whites change the condition to <code>If Range(toDel(i)).Cells.Interior.ColorIndex = 2</code>.</p>\n\n<p>Here is a good reference for <a href=\"http://dmcritchie.mvps.org/excel/colors.htm\" rel=\"nofollow noreferrer\">Excel ColorIndex colors</a>.</p>\n"}], "owner": {"reputation": 523, "user_id": 942329, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/54d7d9aaa4fc9bb64f1cd7a889caec3f?s=128&d=identicon&r=PG", "display_name": "Eds", "link": "https://stackoverflow.com/users/942329/eds"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 242, "favorite_count": 0, "accepted_answer_id": 49284581, "answer_count": 1, "score": 0, "last_activity_date": 1521056220, "creation_date": 1521042975, "last_edit_date": 1531161705, "question_id": 49282352, "link": "https://stackoverflow.com/questions/49282352/excel-2016-remove-duplicates-where-cell-color-is-x-or-other-condition", "title": "Excel 2016 - Remove duplicates where cell color is X, or other condition", "body": "<p>I have a user who wants to remove duplicate rows from a spreadsheet containing 40 odd thousand rows.</p>\n\n<p>It looks like Excels remove duplicates function simply retains the first instance of a value/row, then deletes all duplicates that follow.</p>\n\n<p>They would like to select which duplicate to keep based on (initial preference) the colour of the cell containing the duplicate. Remove duplicates is quite basic so has no ability to do this from what I can see, and even if we could extract the cell color (I thought we could use the below):</p>\n\n<pre><code>=CELL(\"color\",E2)\n</code></pre>\n\n<p>And place the color name or some other value in another cell, I don't think this could be used in conjunction with remove duplicates to achieve what they want.</p>\n\n<p>Is VB the only route that will allow us to achieve this, and might anyone have any suggestions on some code to use to achieve this? Let's say for argument's sake they have cells of yellow and white, and want to remove white.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1521044647, "post_id": 49282217, "comment_id": 85568490, "body": "You could use COUNTIF or MATCH formula and then autofilter. Quicker than looping."}], "answers": [{"comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1521044661, "post_id": 49282394, "comment_id": 85568503, "body": "Don&#39;t think that is a VBA function?"}], "tags": [], "owner": {"reputation": 919, "user_id": 2088245, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gTsG0.jpg?s=128&g=1", "display_name": "Kevbo", "link": "https://stackoverflow.com/users/2088245/kevbo"}, "is_accepted": false, "score": 0, "last_activity_date": 1521043095, "creation_date": 1521043095, "answer_id": 49282394, "question_id": 49282217, "link": "https://stackoverflow.com/questions/49282217/filtering-out-multiple-items/49282394#49282394", "title": "Filtering out multiple items", "body": "<p>If they are the same types (integer, string) then i would put both of your lists into a List(of) and then use the Except function.  this will return you a list of all items that are not present in the original list.  This doesnt modify either list.</p>\n\n<pre><code>var remainingItems = FullList.Except(excludeList);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 49, "user_id": 4984516, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/463687450a620b15321b7d8f61e50c92?s=128&d=identicon&r=PG", "display_name": "Mc837", "link": "https://stackoverflow.com/users/4984516/mc837"}, "is_accepted": true, "score": 0, "last_activity_date": 1521415329, "creation_date": 1521415329, "answer_id": 49353848, "question_id": 49282217, "link": "https://stackoverflow.com/questions/49282217/filtering-out-multiple-items/49353848#49353848", "title": "Filtering out multiple items", "body": "<p>Thank you for the suggestions, but I figured out a better way to do it. This is essentially a macro version of the Advanced Filter button. I copied the Input tab to Output, which I then work on as following:</p>\n\n<pre><code>Dim keyCount As Long\nkeyCount = Sheets(\"Keys\").Cells(Sheets(\"Keys\").Rows.Count, \"A\").End(xlUp).row\n\nWorksheets(\"Output\").Range(\"A2\").Select\nRange(Selection, Selection.End(xlDown)).AdvancedFilter Action:=_\n    xlFilterInPlace, CriteriaRange:=_\n    Sheets(\"Keys\").Range(\"A1:A\" &amp; keyCount), Unique:=False\n</code></pre>\n\n<p>No need for loops and very fast.</p>\n"}], "owner": {"reputation": 49, "user_id": 4984516, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/463687450a620b15321b7d8f61e50c92?s=128&d=identicon&r=PG", "display_name": "Mc837", "link": "https://stackoverflow.com/users/4984516/mc837"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 49353848, "answer_count": 2, "score": 0, "last_activity_date": 1521415329, "creation_date": 1521042584, "last_edit_date": 1531164843, "question_id": 49282217, "link": "https://stackoverflow.com/questions/49282217/filtering-out-multiple-items", "title": "Filtering out multiple items", "body": "<p>I'm trying to filter out a large number of items from a list. I have about 500 keys to filter out of an input list of 700. I don't know if there's a list item for each key though, so the \"dumb\" approach I went down was to loop through each key comparing it to each row of the input list. The code I've written technically works, but it's not efficient and crashes as soon as I try testing with too many keys. Is there a more elegant solution?</p>\n\n<p>My attempt:</p>\n\n<pre><code>Sub ExcludeKeys()\n\n'Copy input to new output sheet\nDim outputTabName As String\nWorksheets(\"Input\").Copy After:=Worksheets(Worksheets.Count)\noutputTabName = \"Output \" + Strings.Trim(Worksheets.Count - 3)\nWorksheets(Worksheets.Count).Name = outputTabName\n\n'Get the column letter the keys are in (input data)\nDim keyCol As String\nkeyCol = Strings.Trim(Worksheets(\"Home\").Range(\"D17\").Value)\n\nDim row As Range\nDim totalRows As Long\nDim keyToEval As Variant\n\n'Make an array out of existing keys\ntotalKeys = Worksheets(\"Keys\").Rows.End(xlUp).row\n\n'Go through the Output sheet\nFor rowNum = 2 To Worksheets(outputTabName).Rows.Count\n\n    'Go through all keys to exclude\n    For i = 1 To LastRow(Worksheets(\"Keys\").Name, 1)\n\n        'Get new key to compare to (in output)\n        keyToEval = Strings.Trim(Worksheets(outputTabName).Range(keyCol &amp; rowNum).Value)\n\n        'If keys match, delete\n        If keyToEval = Strings.Trim(Worksheets(\"Keys\").Range(\"A\" &amp; i).Value) Then\n            Worksheets(outputTabName).Range(keyCol &amp; rowNum).Rows.EntireRow.Delete\n            'If a row was deleted, go back 1 (avoids skipping next)\n            i = 1\n        End If\n    Next i\nNext rowNum\n\nEnd Sub\n\n'----------\n' Handy function to find the last row of a column\n' Source: https://stackoverflow.com/a/48504852/4984516\nFunction LastRow(Optional strSheet As String, Optional columnToCheck As Long = 1) As Long\n\n    Dim shSheet As Worksheet\n\n    If strSheet = vbNullString Then\n       Set shSheet = ActiveSheet\n    Else\n        Set shSheet = Worksheets(strSheet)\n    End If\n\n    LastRow = shSheet.Cells(shSheet.Rows.Count, columnToCheck).End(xlUp).row\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "msgbox", "vba"], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 0, "last_activity_date": 1521042251, "creation_date": 1521042251, "answer_id": 49282091, "question_id": 49281949, "link": "https://stackoverflow.com/questions/49281949/notify-the-text-in-the-cell-when-the-event-is-fired/49282091#49282091", "title": "Notify the text in the cell when the event is fired", "body": "<p>If the block number is one cell left of the tested cell use:</p>\n\n<pre><code>MsgBox \"Block \" &amp; c.Offset(0, -1).Value &amp; \" ends in 15 mins\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "is_accepted": false, "score": 0, "last_activity_date": 1521042883, "creation_date": 1521042883, "answer_id": 49282322, "question_id": 49281949, "link": "https://stackoverflow.com/questions/49281949/notify-the-text-in-the-cell-when-the-event-is-fired/49282322#49282322", "title": "Notify the text in the cell when the event is fired", "body": "<p>You could use the Address:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim c As Range\nFor Each c In Range(\"H2:H7\")\n    If Format$(c.Value, \"HH:MM:SS\") = \"00:15:00\" Then\n        MsgBox \"Block ends in 15 mins\" &amp; vbNewLine &amp; \"Adress: \" &amp; c.Address\n    End If\nNext c\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 9490960, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Xu6H1mpHCJc/AAAAAAAAAAI/AAAAAAAAALc/N_wAhvoMJK8/photo.jpg?sz=128", "display_name": "Jackie Chua", "link": "https://stackoverflow.com/users/9490960/jackie-chua"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 49282091, "answer_count": 2, "score": 1, "last_activity_date": 1521042883, "creation_date": 1521041896, "last_edit_date": 1531161705, "question_id": 49281949, "link": "https://stackoverflow.com/questions/49281949/notify-the-text-in-the-cell-when-the-event-is-fired", "title": "Notify the text in the cell when the event is fired", "body": "<p>I was able to manage to be notified when an event's circumstances is met.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim c As Range\nFor Each c In Range(\"H2:H7\")\n    If Format$(c.Value, \"HH:MM:SS\") = \"00:15:00\" Then\n        MsgBox \"Block ends in 15 mins\"\n    End If\nNext c\n</code></pre>\n\n<p>Now my current problems is that, when one of the event is triggered. I want to be notified by the MsgBox which Block is triggered.</p>\n\n<pre><code>Block   \n1   15:00\n2   17:00\n3   19:00\n4   21:00\n5   23:00\n6   01:00\n</code></pre>\n\n<p>For example like above, Block 2 hits 15 mins, I want to be notify by MsgBox \"Block 2 ends in 15 mins\". \nThank you for the help and hope that I'm not confusing.</p>\n"}, {"tags": ["vba", "excel", "vlookup"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1521041572, "post_id": 49281714, "comment_id": 85566126, "body": "Whare the two column in the lookup range?"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1521041689, "post_id": 49281809, "comment_id": 85566225, "body": "might need a <code>&#39;</code> on the left side of temp."}, {"owner": {"reputation": 1, "user_id": 9492398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bc1d88984bcc12c7d50da5450aea1bd?s=128&d=identicon&r=PG&f=1", "display_name": "gringo1011", "link": "https://stackoverflow.com/users/9492398/gringo1011"}, "edited": false, "score": 0, "creation_date": 1521096637, "post_id": 49281809, "comment_id": 85588706, "body": "Thanks, but it says &quot;Syntax Error&quot; :-/"}], "tags": [], "owner": {"reputation": 721, "user_id": 7889129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0oYIA.jpg?s=128&g=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7889129/maddy"}, "is_accepted": false, "score": 2, "last_activity_date": 1521044096, "last_edit_date": 1521044096, "creation_date": 1521041552, "answer_id": 49281809, "question_id": 49281714, "link": "https://stackoverflow.com/questions/49281714/adding-a-variable-in-a-vlookup/49281809#49281809", "title": "Adding a variable in a VLookUp", "body": "<p>Try this</p>\n\n<p><code>\"=VLOOKUP([@[\" &amp; Chr(10) &amp; \"\u0160tevilka]],'\" &amp; temp &amp; \"'!C[-16]:C[-17],2,FALSE)\"</code></p>\n"}], "owner": {"reputation": 1, "user_id": 9492398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bc1d88984bcc12c7d50da5450aea1bd?s=128&d=identicon&r=PG&f=1", "display_name": "gringo1011", "link": "https://stackoverflow.com/users/9492398/gringo1011"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1522854304, "creation_date": 1521041308, "last_edit_date": 1531164843, "question_id": 49281714, "link": "https://stackoverflow.com/questions/49281714/adding-a-variable-in-a-vlookup", "title": "Adding a variable in a VLookUp", "body": "<p>I'm having a problem with a vlookup function. First code shows that vlookup know what is \"TempArg'17\", but now I want to change it this text to string and write it inside vlookup, so I created a string temp.</p>\n\n<pre><code>Dim temp As String\nDim num As Int\nnum = 17\n\ntemp = \"TempArg\" + \"'\" + Cstr(num)\n</code></pre>\n\n<p>Here is the old code that works:</p>\n\n<pre><code>ActiveCell.FormulaR1C1 = _\n        \"=VLOOKUP([@[\" &amp; Chr(10) &amp; \"\u0160tevilka]],'TempArg''17'!C[-16]:C[-17],2,FALSE)\"\n</code></pre>\n\n<p>And here is the code that I want to change and that doesn't work:</p>\n\n<pre><code>ActiveCell.FormulaR1C1 = _\n        \"=VLOOKUP([@[\" &amp; Chr(10) &amp; \"\u0160tevilka]],temp'!C[-16]:C[-17],2,FALSE)\"\n</code></pre>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["excel", "vba", "macos"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 1, "creation_date": 1521041326, "post_id": 49281583, "comment_id": 85565930, "body": "ladder(10), no quotation marks"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1521041891, "post_id": 49281583, "comment_id": 85566402, "body": "Is 10 definitely there as a key?  is one of the <code>cell</code> values 10?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1521041919, "post_id": 49281583, "comment_id": 85566420, "body": "@peakpeak I think the op wants the key of 10, not item 10?"}, {"owner": {"reputation": 1, "user_id": 9492320, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-BkrwkQjZGuI/AAAAAAAAAAI/AAAAAAAABQU/zkGLpQxv4Io/photo.jpg?sz=128", "display_name": "Richard S", "link": "https://stackoverflow.com/users/9492320/richard-s"}, "edited": false, "score": 0, "creation_date": 1521042641, "post_id": 49281583, "comment_id": 85566966, "body": "Apologies, I&#39;d thought you could use Keys in a collection.  Is that not the case?  I&#39;d thought collections could use Keys if they were unique strings, and dictionaries enabled use of integers.  As for is one of the values of price.ladderKeyPrice &quot;10&quot;, yes it definitely is (the Immediate Window print out validates this for me if I print out the entire collection with the last 3 commented out lines at the bottom).  Thanks to all those trying to help this coding virgin!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 1, "creation_date": 1521043044, "post_id": 49281583, "comment_id": 85567294, "body": "@KostasK. nope. <code>Collection.Add</code> takes an optional second parameter named <code>Key</code>, which must be a <code>String</code>. That key can absolutely be used to retrieve collection items - <i>that&#39;s what it&#39;s for</i>. The advantage of a dictionary is that you can iterate the keys themselves, not that it&#39;s keyed. A collection can absolutely be keyed."}, {"owner": {"reputation": 1, "user_id": 9492320, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-BkrwkQjZGuI/AAAAAAAAAAI/AAAAAAAABQU/zkGLpQxv4Io/photo.jpg?sz=128", "display_name": "Richard S", "link": "https://stackoverflow.com/users/9492320/richard-s"}, "edited": false, "score": 0, "creation_date": 1521043066, "post_id": 49281583, "comment_id": 85567316, "body": "Also as another note, if I use &#39;ladder(10)&quot; (so try and access the object that is in the index position 10) this also returns an error."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1521043078, "post_id": 49281583, "comment_id": 85567325, "body": "Have you tried using a key that doesn&#39;t <i>look like a number</i>? e.g. try prefixing it with a <code>&quot;K&quot;</code> or something. Also assign it explicitly to <code>cell.Value</code> or <code>cell.Text</code>, instead of relying on the implicit default member call."}, {"owner": {"reputation": 1, "user_id": 9492320, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-BkrwkQjZGuI/AAAAAAAAAAI/AAAAAAAABQU/zkGLpQxv4Io/photo.jpg?sz=128", "display_name": "Richard S", "link": "https://stackoverflow.com/users/9492320/richard-s"}, "edited": false, "score": 0, "creation_date": 1521043330, "post_id": 49281583, "comment_id": 85567513, "body": "Hi Mat...I&#39;ve not tried either of those.  I&#39;ll try and work out how to do so and report back."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1521044362, "post_id": 49281583, "comment_id": 85568295, "body": "Also these unqualified <code>Range</code> calls are implicitly referring to <code>ActiveSheet</code>. If that&#39;s not <code>Sheets(2)</code> (<code>cell.Parent</code>), you&#39;re possibly running into a run-time error right there, or storing data from the wrong sheet."}, {"owner": {"reputation": 1, "user_id": 9492320, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-BkrwkQjZGuI/AAAAAAAAAAI/AAAAAAAABQU/zkGLpQxv4Io/photo.jpg?sz=128", "display_name": "Richard S", "link": "https://stackoverflow.com/users/9492320/richard-s"}, "edited": false, "score": 0, "creation_date": 1521045089, "post_id": 49281583, "comment_id": 85568793, "body": "Thanks - think maybe I&#39;m trying to tackle this task too early?  Might head back to the books/videos!"}, {"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1521045706, "post_id": 49281583, "comment_id": 85569209, "body": "@Mat&#39;s Mug Thanks for clarifying this Mat. I was under the impression items can only retrieved by index."}], "owner": {"reputation": 1, "user_id": 9492320, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-BkrwkQjZGuI/AAAAAAAAAAI/AAAAAAAABQU/zkGLpQxv4Io/photo.jpg?sz=128", "display_name": "Richard S", "link": "https://stackoverflow.com/users/9492320/richard-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 238, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593644978, "creation_date": 1521040963, "last_edit_date": 1593644978, "question_id": 49281583, "link": "https://stackoverflow.com/questions/49281583/cant-access-object-from-collection", "title": "Can&#39;t access object from collection", "body": "<p>Apologies for what is no doubt a simple question - am very new to coding so even finding the answer from existing information is tough.</p>\n\n<p>Anyway...</p>\n\n<p>I've defined a Class with 4 value (1 x Single, 1 x String (to use as key), and 2 x Range)</p>\n\n<p>I've then managed to set the Collection based on the class and populate the collection, and can use Debug.Print to print the entire collection's values and also to count the number of items in the collection.</p>\n\n<p>But I can't access a single object from the collection, either by using index position or the specified Key.</p>\n\n<p>When trying I get </p>\n\n<blockquote>\n  <p>Runtime error 438 - Object doesn't support this property or method.</p>\n</blockquote>\n\n<p>The underlying spreadsheet is a 4 column, 200 row sheet, and the eventual goal is for each row to be an object, and then populate a given location for an object (row) with a variable defined in a separate set of code.</p>\n\n<p>Anyway, the Class (PriceLadder) code is:</p>\n\n<pre><code>Public ladderPriceKey As String\nPublic ladderPrice As Single\nPublic layMatchedLocation As Range\nPublic backMatchedLocation As Range\n</code></pre>\n\n<p>and then the module code is:</p>\n\n<pre><code>Sub initialiseLadder()\n\n\n'initialise ladder as collection\n\nDim ladder As Collection\nSet ladder = New Collection\n\nDim cell As Range\nDim price As PriceLadder\n\n'for each cell in Column A\n\nFor Each cell In Sheets(2).Range(\"A11:A220\") ' &amp; Range(\"A\" &amp; Rows.Count).End(xlUp).Row)\n\n\n        ' create a new priceladder object\n\n        Set price = New PriceLadder\n\n        ' fill the data\n        price.ladderPrice = cell\n        price.ladderPriceKey = cell\n        Set price.layMatchedLocation = Range(cell.Offset(0, 2).Address(RowAbsolute:=True, ColumnAbsolute:=True))\n        Set price.backMatchedLocation = Range(cell.Offset(0, 3).Address(RowAbsolute:=True, ColumnAbsolute:=True))\n\n        ' add the price to the collection of ladder prices\n        ladder.Add price, price.ladderPriceKey 'price.ladderPriceKey set as the key for the collection object\n\n    Next\n\n\nDebug.Print ladder.Count\nDebug.Print ladder(\"10\")\n\n '  Dim p As PriceLadder\n'For Each p In ladder\n'Debug.Print \"PriceKey: \" &amp; p.ladderPriceKey &amp; vbTab &amp; \"BackLocation: \" &amp; p.backMatchedLocation.Address &amp; vbTab &amp; \"LayLocation: \" &amp; p.layMatchedLocation.Address &amp; vbTab &amp; \"Price: \" &amp; p.ladderPrice()\n\n\n'    Next\nEnd Sub\n</code></pre>\n\n<p>The line that produces the error is:</p>\n\n<pre><code>Debug.Print ladder(\"10\") \n</code></pre>\n\n<p>where \"10\" is one of the values added as a key from price.ladderKeyPrice</p>\n\n<p>Really sorry if this is a horrible newbie type question.</p>\n\n<p>Thanks for any help than can be given.</p>\n\n<p>Richard</p>\n"}, {"tags": [".net", "excel", "epplus", "vba"], "comments": [{"owner": {"reputation": 88791, "user_id": 134204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vwnA5.jpg?s=128&g=1", "display_name": "Panagiotis Kanavos", "link": "https://stackoverflow.com/users/134204/panagiotis-kanavos"}, "edited": false, "score": 2, "creation_date": 1521040865, "post_id": 49281439, "comment_id": 85565567, "body": "There&#39;s an <a href=\"https://github.com/JanKallman/EPPlus/blob/master/EPPlus/ExcelWorksheets.cs#L203\" rel=\"nofollow noreferrer\">Add overload</a> that acceps a source ExcelWorkSheet. Have you tried it?"}, {"owner": {"reputation": 88791, "user_id": 134204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vwnA5.jpg?s=128&g=1", "display_name": "Panagiotis Kanavos", "link": "https://stackoverflow.com/users/134204/panagiotis-kanavos"}, "edited": false, "score": 0, "creation_date": 1521041019, "post_id": 49281439, "comment_id": 85565688, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/45582359/copy-worksheet-in-epplus-values-only\">Copy worksheet in Epplus Values only</a>"}, {"owner": {"reputation": 88791, "user_id": 134204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vwnA5.jpg?s=128&g=1", "display_name": "Panagiotis Kanavos", "link": "https://stackoverflow.com/users/134204/panagiotis-kanavos"}, "edited": false, "score": 0, "creation_date": 1521041054, "post_id": 49281439, "comment_id": 85565712, "body": "The duplicate question shows how to copy an entire sheet including formatting and asks how to copy only the data"}, {"owner": {"reputation": 354, "user_id": 3057464, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/o8g3V.jpg?s=128&g=1", "display_name": "Ovy.Istrate", "link": "https://stackoverflow.com/users/3057464/ovy-istrate"}, "reply_to_user": {"reputation": 88791, "user_id": 134204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vwnA5.jpg?s=128&g=1", "display_name": "Panagiotis Kanavos", "link": "https://stackoverflow.com/users/134204/panagiotis-kanavos"}, "edited": false, "score": 0, "creation_date": 1521041270, "post_id": 49281439, "comment_id": 85565879, "body": "@Panagiotis Kanavos Yes! you&#39;re right and it works. I don&#39;t know why I haven&#39;t seen it..."}], "answers": [{"tags": [], "owner": {"reputation": 354, "user_id": 3057464, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/o8g3V.jpg?s=128&g=1", "display_name": "Ovy.Istrate", "link": "https://stackoverflow.com/users/3057464/ovy-istrate"}, "is_accepted": true, "score": 6, "last_activity_date": 1521041205, "creation_date": 1521041205, "answer_id": 49281677, "question_id": 49281439, "link": "https://stackoverflow.com/questions/49281439/how-to-copy-an-excel-worksheet-from-a-file-to-another-using-epplus-for-net/49281677#49281677", "title": "How to copy an excel worksheet from a file to another using EPPlus for .NET", "body": "<p>Solved.</p>\n\n<p>There's an overload for the Add method on the ExcelWorksheets class that looks like this:</p>\n\n<pre><code>ExcelWorksheets.Add(string Name, ExcelWorksheet Copy)\n</code></pre>\n\n<p>Can't believe I haven't seen it.</p>\n"}, {"tags": [], "owner": {"reputation": 49, "user_id": 11197329, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/le6V8.gif?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/11197329/alex"}, "is_accepted": false, "score": 1, "last_activity_date": 1552485281, "last_edit_date": 1552485281, "creation_date": 1552484002, "answer_id": 55143139, "question_id": 49281439, "link": "https://stackoverflow.com/questions/49281439/how-to-copy-an-excel-worksheet-from-a-file-to-another-using-epplus-for-net/55143139#55143139", "title": "How to copy an excel worksheet from a file to another using EPPlus for .NET", "body": "<p>Couldn't you just clone the existing one?</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>ExcelWorksheets clonedWorksheet = currentExcelWorksheet.Clone();\n</code></pre>\n"}], "owner": {"reputation": 354, "user_id": 3057464, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/o8g3V.jpg?s=128&g=1", "display_name": "Ovy.Istrate", "link": "https://stackoverflow.com/users/3057464/ovy-istrate"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4650, "favorite_count": 0, "accepted_answer_id": 49281677, "answer_count": 2, "score": 3, "last_activity_date": 1552485281, "creation_date": 1521040558, "last_edit_date": 1531161705, "question_id": 49281439, "link": "https://stackoverflow.com/questions/49281439/how-to-copy-an-excel-worksheet-from-a-file-to-another-using-epplus-for-net", "title": "How to copy an excel worksheet from a file to another using EPPlus for .NET", "body": "<p>Given the following scenario:</p>\n\n<ul>\n<li>I have a source.xlsx file with multiple worksheets (worksheet1, worksheet2, workshToCopy, etc) and I generate the destination.xlsx based on another .xlsx template file that has different worksheets than the source.xlsx. I want to add a worksheet from the source file to the destination file.</li>\n</ul>\n\n<p>For now I was able to add an empty worksheet to my destination file like this:</p>\n\n<pre><code>if (FileExists(outputFile) &amp;&amp; FileExists(inputFile))\n{\n  var inputPackage = new ExcelPackage(inputFile);\n  var outputPackage = new ExcelPackage(outputFile);\n\n  var summaryInputWorksheet = inputPackage.Workbook.Worksheets[ExcelSummaryHelper.SummaryWorksheet];\n  outputPackage.Workbook.Worksheets.Add(summaryInputWorksheet.Name);\n  outputPackage.Workbook.Worksheets.MoveToEnd(summaryInputWorksheet.Name);\n  outputPackage.Save();\n}\n</code></pre>\n\n<p>What's the best approach to copy the content of workshToCopy from source.xlsx to destination.xlsx's new worksheet using the EPPlus library ?</p>\n"}, {"tags": ["mysql", "vba", "excel", "pivot-table"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 0, "creation_date": 1521042191, "post_id": 49281408, "comment_id": 85566614, "body": "<a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/worksheet-change-event-excel\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/vba/excel-vba/articles/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 9218820, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1d86cea2a36c09314fd2a4c556d798f4?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/9218820/jay"}, "edited": false, "score": 0, "creation_date": 1521041852, "post_id": 49281568, "comment_id": 85566360, "body": "This works perfectly if I insert a new PivotTable, however when I insert the PivotTable using the MySQL add-in, it doesn&#39;t call the macro. Any idea why?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 103, "user_id": 9218820, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1d86cea2a36c09314fd2a4c556d798f4?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/9218820/jay"}, "edited": false, "score": 0, "creation_date": 1521041969, "post_id": 49281568, "comment_id": 85566451, "body": "Probably the <code>AddIn</code> is disabling the events temporarily. Idk."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 0, "creation_date": 1521042165, "post_id": 49281568, "comment_id": 85566592, "body": "<a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/worksheet-change-event-excel\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/vba/excel-vba/articles/&hellip;</a>"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1521042790, "post_id": 49281568, "comment_id": 85567092, "body": "@peakpeak - what is the idea of the link?"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1521041915, "last_edit_date": 1521041915, "creation_date": 1521040930, "answer_id": 49281568, "question_id": 49281408, "link": "https://stackoverflow.com/questions/49281408/run-a-macro-when-a-pivottable-is-inserted-from-mysql-database/49281568#49281568", "title": "Run a macro when a PivotTable is inserted from MySQL database", "body": "<p>Pivot tables are a bit different - thus for them there are other events. Try this event:</p>\n\n<pre><code>Private Sub Worksheet_PivotTableUpdate(ByVal Target As PivotTable)\n     MsgBox Target.TableRange1.Address\nEnd Sub\n</code></pre>\n\n<p>Take a look at the other PivotTable related events:</p>\n\n<p><a href=\"https://i.stack.imgur.com/gPQ1w.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gPQ1w.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 103, "user_id": 9218820, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1d86cea2a36c09314fd2a4c556d798f4?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/9218820/jay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1521042167, "creation_date": 1521040473, "last_edit_date": 1521042167, "question_id": 49281408, "link": "https://stackoverflow.com/questions/49281408/run-a-macro-when-a-pivottable-is-inserted-from-mysql-database", "title": "Run a macro when a PivotTable is inserted from MySQL database", "body": "<p>I would like an Excel macro to run automatically when a PivotTable is inserted from a MySQL Database using the MySQL for Excel add-in.</p>\n\n<p>The PivotTable is inserted into a sheet that already exists, and takes up the range A2:CN600, depending on how many rows the table has. I have the following code, which works perfectly when one cell in the specified range is altered:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim KeyCells As Range\n\n    Set KeyCells = Range(\"A2:CN600\")\n\n    If Not Application.Intersect(KeyCells, Range(Target.Address)) _\n       Is Nothing Then\n\n\n        MsgBox \"Cell \" &amp; Target.Address &amp; \" has changed.\"\n\n    End If\nEnd Sub\n</code></pre>\n\n<p>Experimentally, I inserted the MySQL database as a PivotTable into this sheet to see what would happen, however no message box popped up. When I hit Ctrl+a and Delete to remove the table, I got the message:</p>\n\n<blockquote>\n  <p>Cell $A$2:$CN$600 has changed.</p>\n</blockquote>\n\n<p>How can I modify this code so that it will display the message box when the table is inserted? I understand the above code is more suited to a case where the cell values are changed one at a time, instead of a large range having their value changed all at once.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1521040424, "post_id": 49281185, "comment_id": 85565253, "body": "Was going to add that there are more efficient ways of doing this, such as using AutoFilter - see CallumDA&#39;s for another approach."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 1, "last_activity_date": 1521039955, "creation_date": 1521039955, "answer_id": 49281185, "question_id": 49281126, "link": "https://stackoverflow.com/questions/49281126/for-loop-leaves-unwanted-rows-behind/49281185#49281185", "title": "For Loop leaves unwanted rows behind", "body": "<p>Loop backwards (and use Rows.Count rather than hard-coding 65536) as new versions of Excel have a capacity of more than a million rows.</p>\n\n<pre><code>For i = Range(\"A\" &amp; Rows.Count).End(xlUp).Row To 5 Step -1\n    If Application.WorksheetFunction.CountIf(Range(\"A\" &amp; i), \"#N/A\") = 1 Then\n        Range(\"A\" &amp; i).EntireRow.Delete\n    End If\nNext i\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "is_accepted": true, "score": 2, "last_activity_date": 1521040239, "creation_date": 1521040239, "answer_id": 49281310, "question_id": 49281126, "link": "https://stackoverflow.com/questions/49281126/for-loop-leaves-unwanted-rows-behind/49281310#49281310", "title": "For Loop leaves unwanted rows behind", "body": "<p>You can delete your rows all at once, using <code>Union</code>. Like this:</p>\n\n<pre><code>Sub test()\n    Dim i As Long\n    Dim deleteRange As Range\n\n    For i = 5 To Range(\"A\" &amp; \"65536\").End(xlUp).Row Step 1\n        If Application.WorksheetFunction.CountIf(Range(\"A\" &amp; i), \"#N/A\") = 1 Then\n            If deleteRange Is Nothing Then\n                Set deleteRange = Range(\"A\" &amp; i).EntireRow\n            Else: Set deleteRange = Union(deleteRange, Range(\"A\" &amp; i).EntireRow)\n            End If\n        End If\n    Next i\n\n    deleteRange.Delete\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 9388011, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fwgNf.jpg?s=128&g=1", "display_name": "Tourless", "link": "https://stackoverflow.com/users/9388011/tourless"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 49281310, "answer_count": 2, "score": 1, "last_activity_date": 1521040239, "creation_date": 1521039791, "last_edit_date": 1531164843, "question_id": 49281126, "link": "https://stackoverflow.com/questions/49281126/for-loop-leaves-unwanted-rows-behind", "title": "For Loop leaves unwanted rows behind", "body": "<p>...because the row is only evaluated once and the next row is called for evaluation. But the next row is now the previous row.  How do I account for this?</p>\n\n<pre><code>For i = 5 To Range(\"A\" &amp; \"65536\").End(xlUp).Row Step 1\nIf Application.WorksheetFunction.CountIf(Range(\"A\" &amp; i), \"#N/A\") = 1 Then\nRange(\"A\" &amp; i).EntireRow.Delete\nEnd If\nNext i\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 29, "user_id": 9491411, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/66d0afb6832265aa788f60edc9e2d4f7?s=128&d=identicon&r=PG&f=1", "display_name": "sheela", "link": "https://stackoverflow.com/users/9491411/sheela"}, "edited": false, "score": 0, "creation_date": 1521039773, "post_id": 49281102, "comment_id": 85564755, "body": "Example: BA2=C5-AS2; BA3=C5-AS3; BA4=C5-AS4; BA5=C5-AS5"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1521041056, "post_id": 49281102, "comment_id": 85565715, "body": "Just because I see that you used a lot of <code>.Select</code> which is a bad practice and should be avoided. You might read <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a> and your code style and performance will get a lot better."}, {"owner": {"reputation": 29, "user_id": 9491411, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/66d0afb6832265aa788f60edc9e2d4f7?s=128&d=identicon&r=PG&f=1", "display_name": "sheela", "link": "https://stackoverflow.com/users/9491411/sheela"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1521041249, "post_id": 49281102, "comment_id": 85565860, "body": "Actually I am beginner. This is code from Record Micro. I could not modify completely into a complete program."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1521041359, "post_id": 49281102, "comment_id": 85565960, "body": "That&#39;s ok, just a recommendation to read that especially for beginners. (did you see the edited answer below?)"}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 9491411, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/66d0afb6832265aa788f60edc9e2d4f7?s=128&d=identicon&r=PG&f=1", "display_name": "sheela", "link": "https://stackoverflow.com/users/9491411/sheela"}, "edited": false, "score": 0, "creation_date": 1521040724, "post_id": 49281253, "comment_id": 85565488, "body": "@peh but the aim is not only for BA2. it is for a series of cells.                 Example: BA2=C5-AS2; BA3=C5-AS3; BA4=C5-AS4; BA5=C5-AS5"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 29, "user_id": 9491411, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/66d0afb6832265aa788f60edc9e2d4f7?s=128&d=identicon&r=PG&f=1", "display_name": "sheela", "link": "https://stackoverflow.com/users/9491411/sheela"}, "edited": false, "score": 0, "creation_date": 1521040788, "post_id": 49281253, "comment_id": 85565517, "body": "@sheela see my edit. Probably the last one is the one to go for you."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 0, "last_activity_date": 1521040776, "last_edit_date": 1521040776, "creation_date": 1521040113, "answer_id": 49281253, "question_id": 49281102, "link": "https://stackoverflow.com/questions/49281102/subtraction-of-dates-using-macros/49281253#49281253", "title": "Subtraction of Dates using macros", "body": "<p>Have a look at the documentation of the <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/datediff-function\" rel=\"nofollow noreferrer\">DateDiff Function</a>: </p>\n\n<p>For example:</p>\n\n<pre><code>Range(\"BA2\").Value = DateDiff(\"d\", Range(\"C5\").Value,  Range(\"AS2\").Value)\n</code></pre>\n\n<p>\u2026 will return the difference of C5 and AS2 in days into BA2.</p>\n\n<hr>\n\n<p>But you can do that without VBA too:</p>\n\n<p>Put the following formula into BA2 <code>=DAYS(C5,AS2)</code> to get the difference in days.</p>\n\n<hr>\n\n<p>Or you can write that formula with VBA into the cell:</p>\n\n<pre><code>Range(\"BA2\").Formula = \"=DAYS(C5,AS2)\"\n</code></pre>\n\n<hr>\n\n<p>For writing multiple formulas in a loop:</p>\n\n<pre><code>Dim i As Long\nFor i = 2 to 5\n    Range(\"BA\" &amp; i).Formula = \"=DAYS(C5,AS\" &amp; i &amp;\")\"\nNext i\n</code></pre>\n\n<p>Or even better just write the first cell and copy it down</p>\n\n<pre><code>Range(\"BA2\").Formula = \"=DAYS($C$5,AS2)\" 'write first formula\nRange(\"BA2\").AutoFill Destination:=Range(\"BA2:BA5\"), Type:=xlFillDefault 'copy it down until BA5\n</code></pre>\n\n<p>Note that <code>$C$5</code> is a fixed cell but <code>AS2</code> will adjust dynamically when you copy down.</p>\n"}], "owner": {"reputation": 29, "user_id": 9491411, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/66d0afb6832265aa788f60edc9e2d4f7?s=128&d=identicon&r=PG&f=1", "display_name": "sheela", "link": "https://stackoverflow.com/users/9491411/sheela"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "accepted_answer_id": 49281253, "answer_count": 1, "score": 0, "last_activity_date": 1521040776, "creation_date": 1521039743, "last_edit_date": 1531164843, "question_id": 49281102, "link": "https://stackoverflow.com/questions/49281102/subtraction-of-dates-using-macros", "title": "Subtraction of Dates using macros", "body": "<p>In myexcel I wanted to calculate the difference in days between a Single Date in a cell and a series of Dates in column AS2:AS400</p>\n\n<p>Also the difference in days i want it in a seperate column.</p>\n\n<p>I tried to understand the code via record macro and modify it to a two line code. But I couldnt not make it. Could anyone simplyfy the below code to simplfied program. So that I can use for a large no. of data very easily in a column instead of writing it for every single cell.  </p>\n\n<pre><code>Range(\"AS2\").Select\nActiveCell.FormulaR1C1 = \"=R[3]C[-42]-RC[-22]\"\nRange(\"AS3\").Select\nActiveCell.FormulaR1C1 = \"=R[2]C[-42]-RC[-22]\"\nRange(\"AS4\").Select\nActiveCell.FormulaR1C1 = \"=R[1]C[-42]-RC[-22]\"\nRange(\"AS5\").Select\nActiveCell.FormulaR1C1 = \"=RC[-42]-RC[-22]\"\nRange(\"AS6\").Select\nActiveCell.FormulaR1C1 = \"=R[-1]C[-42]-RC[-22]\"\nRange(\"AS7\").Select\nActiveCell.FormulaR1C1 = \"=R[-2]C[-42]-RC[-22]\"\nRange(\"AS8\").Select\nActiveCell.FormulaR1C1 = \"=R[-3]C[-42]-RC[-22]\"   \n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2016"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1521042237, "post_id": 49281099, "comment_id": 85566651, "body": "Would it be enough for you display a text message in the status bar?"}, {"owner": {"reputation": 539, "user_id": 5692465, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/205519d92de8094ef8f12f4e66150aa2?s=128&d=identicon&r=PG&f=1", "display_name": "PKatona", "link": "https://stackoverflow.com/users/5692465/pkatona"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1521044105, "post_id": 49281099, "comment_id": 85568095, "body": "Probably not. Some of the displays will be multiple lines, things like a list of user names to deactivate, or a list of mismatches between two systems. Not enough to warrant a report, but sometimes I may get up to a dozen lines."}, {"owner": {"reputation": 539, "user_id": 5692465, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/205519d92de8094ef8f12f4e66150aa2?s=128&d=identicon&r=PG&f=1", "display_name": "PKatona", "link": "https://stackoverflow.com/users/5692465/pkatona"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1521045677, "post_id": 49281099, "comment_id": 85569191, "body": "For those with just progress displays, it&#39;ll work, I&#39;ll change to that, but for the others, no... But thanks for the suggestion!"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1521053369, "post_id": 49281099, "comment_id": 85573998, "body": "Have you tried adding <code>DoEvents</code> after your code line?"}, {"owner": {"reputation": 539, "user_id": 5692465, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/205519d92de8094ef8f12f4e66150aa2?s=128&d=identicon&r=PG&f=1", "display_name": "PKatona", "link": "https://stackoverflow.com/users/5692465/pkatona"}, "edited": false, "score": 0, "creation_date": 1521055943, "post_id": 49281099, "comment_id": 85575375, "body": "Yep! That did the trick! Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 1, "last_activity_date": 1521126417, "creation_date": 1521126417, "answer_id": 49302943, "question_id": 49281099, "link": "https://stackoverflow.com/questions/49281099/using-generic-vba-access-form-for-multiple-report-progress-displays/49302943#49302943", "title": "Using generic VBA Access Form for multiple report progress displays", "body": "<p>Adding this line:</p>\n\n<pre><code>DoEvents \n</code></pre>\n\n<p>after changing the listbox content makes the change visible.</p>\n\n<p>You need to be aware though, what <code>DoEvents</code> does:</p>\n\n<p><a href=\"https://support.office.com/en-us/article/doevents-function-7af41eca-88e0-470d-adaf-0b3d4c2575b0\" rel=\"nofollow noreferrer\">Yields execution so that the operating system can process other events.</a></p>\n\n<p>This can have unforeseen side effects. E.g. if the button that starts your reporting process stays active while the process runs, the user then can click the button again, which will probably wreak havoc. So be sure to disable that button while the process runs.</p>\n\n<p>See <a href=\"https://msdn.microsoft.com/en-us/library/aa231254(v=vs.60).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/aa231254(v=vs.60).aspx</a></p>\n"}], "owner": {"reputation": 539, "user_id": 5692465, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/205519d92de8094ef8f12f4e66150aa2?s=128&d=identicon&r=PG&f=1", "display_name": "PKatona", "link": "https://stackoverflow.com/users/5692465/pkatona"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 49302943, "answer_count": 1, "score": 0, "last_activity_date": 1594636623, "creation_date": 1521039735, "last_edit_date": 1594636623, "question_id": 49281099, "link": "https://stackoverflow.com/questions/49281099/using-generic-vba-access-form-for-multiple-report-progress-displays", "title": "Using generic VBA Access Form for multiple report progress displays", "body": "<p>I have several reports / processes that either display lots of progress information or display a small amount of information that I deem is not worth creating an output file, and I want to avoid using a bunch of message boxes. I created a generic form with a list box with the intent of using the following command to display progress:</p>\n\n<pre><code>Forms(formName).lstMessages.AddItem \"Status message\"\n</code></pre>\n\n<p>The problem is that nothing displays until sub completion, and in the case of reports that take a minute or so, the generic form actually disappears for a brief period of time.</p>\n\n<p>Short of grabbing every sub / function and putting them into the VBA code for the generic form, is there any way I can \"flush\" the output so that I get progress displays? Or does anyone have a suggestion on another means of accomplishing what I'm trying to do? Thanks!</p>\n"}, {"tags": ["excel", "vba", "macos", "excel-2016"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1521039147, "post_id": 49280690, "comment_id": 85564280, "body": "I&#39;m pretty sure that code is not related to anything shown in the screenshot. And the code would only replace in column V <code>Columns(&quot;V&quot;)</code> but as long as you don&#39;t define in which worksheet, Excel guesses. So you might want to specify in which worksheet the column V is: <code>Worksheets(&quot;SheetName&quot;).Columns(&quot;V&quot;).Replace</code>"}, {"owner": {"reputation": 23, "user_id": 8237803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b1e093c658283ed526847f6f04e49d0?s=128&d=identicon&r=PG&f=1", "display_name": "Seven Cash", "link": "https://stackoverflow.com/users/8237803/seven-cash"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1521040299, "post_id": 49280690, "comment_id": 85565162, "body": "@P\u1d07\u029c I tried put .   Worksheets(&quot;SheetName&quot;).Columns(&quot;V&quot;).Replace .  when define &quot;search in sheet&quot;, but &quot;search in worksheet&quot; still replace all."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1521041869, "post_id": 49280690, "comment_id": 85566380, "body": "The documentation <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-replace-method-excel#examplel\" rel=\"nofollow noreferrer\">Range.Replace Method (Excel)</a> clearly says that for <code>Worksheets(&quot;Sheet1&quot;).Columns(&quot;A&quot;).Replace</code> <i>The replacement range is column A on Sheet1.</i> And that is definitely independent from what is selected in that menu. You must be doing something else than running that code. Or the code you showed us is not <b>exactly</b> the code you run."}, {"owner": {"reputation": 23, "user_id": 8237803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b1e093c658283ed526847f6f04e49d0?s=128&d=identicon&r=PG&f=1", "display_name": "Seven Cash", "link": "https://stackoverflow.com/users/8237803/seven-cash"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1521042844, "post_id": 49280690, "comment_id": 85567130, "body": "As I understand, in order to the code running properly, I have to define the  &quot;search in sheet&quot; first in that menu."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1521043368, "post_id": 49280690, "comment_id": 85567541, "body": "No the code should be completely independent from what you select in that menu. The menu is for manual search only. The code already specifies worksheet and column where the replace should occur. The menu cannot change that code."}, {"owner": {"reputation": 23, "user_id": 8237803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b1e093c658283ed526847f6f04e49d0?s=128&d=identicon&r=PG&f=1", "display_name": "Seven Cash", "link": "https://stackoverflow.com/users/8237803/seven-cash"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1521044176, "post_id": 49280690, "comment_id": 85568136, "body": "@P\u1d07\u029c Please check my code . &#39;   Worksheets(&quot;Sheet4&quot;).Columns(&quot;B&quot;).Replace What:=&quot;XXX&quot;, _                             Replacement:=&quot;KKK&quot;, _                             LookAt:=xlPart, _                             SearchOrder:=xlByRows, _                             MatchCase:=False, _                             SearchFormat:=False, _                             ReplaceFormat:=False  &#39; .         I put same content in different columns, and different sheets, when I select &quot;search in worksheet&quot;, and running code, the code replace all the contents. BTW how to post a image in comments?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1521045000, "post_id": 49280690, "comment_id": 85568727, "body": "Please don&#39;t use comments to post code or images (gets unreadable as you see). Instead <a href=\"https://stackoverflow.com/posts/49280690/edit\">edit</a> your original question to add relevant things and improve your question."}, {"owner": {"reputation": 23, "user_id": 8237803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b1e093c658283ed526847f6f04e49d0?s=128&d=identicon&r=PG&f=1", "display_name": "Seven Cash", "link": "https://stackoverflow.com/users/8237803/seven-cash"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1521046274, "post_id": 49280690, "comment_id": 85569584, "body": "@P\u1d07\u029c I edited the question"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1521047796, "post_id": 49280690, "comment_id": 85570645, "body": "If this really happens, this must be a bug in Excel Mac (this is against any logic and code would not be reliable): <code>Worksheets(&quot;Sheet4&quot;).Columns(&quot;B&quot;).Replace</code> clearly defines sheet and column where to replace in. Maybe you find someone with Excel and Mac (I don&#39;t have a Mac so I cannot confirm this bug). But this should clearly not happen! What you can try is: Make sure you updated Excel to the latest version (maybe it was fixed already)."}, {"owner": {"reputation": 23, "user_id": 8237803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b1e093c658283ed526847f6f04e49d0?s=128&d=identicon&r=PG&f=1", "display_name": "Seven Cash", "link": "https://stackoverflow.com/users/8237803/seven-cash"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1521048028, "post_id": 49280690, "comment_id": 85570791, "body": "@P\u1d07\u029c, because of I updated to the latest version on Mac, mostly my Marcos doesn&#39;t work properly, the find/replace is the biggest issue for me."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1521049122, "post_id": 49280690, "comment_id": 85571526, "body": "Asking Microsoft for support would be a good idea then"}], "owner": {"reputation": 23, "user_id": 8237803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b1e093c658283ed526847f6f04e49d0?s=128&d=identicon&r=PG&f=1", "display_name": "Seven Cash", "link": "https://stackoverflow.com/users/8237803/seven-cash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593644959, "creation_date": 1521038688, "last_edit_date": 1593644959, "question_id": 49280690, "link": "https://stackoverflow.com/questions/49280690/finding-and-replacing-one-column-in-current-sheet-on-mac", "title": "Finding and replacing one column in current sheet on Mac", "body": "<p>I found the below code, it works good when \"search in sheet\".</p>\n\n<p>But sometimes, when I open the excel, it default shows \"search worksheet\". Please see the image.</p>\n\n<p>Then the code will replace entire sheets instead of Columns(\"V\").</p>\n\n<p>Any additional code can control this thing happens? </p>\n\n<p>Thank you in advance.</p>\n\n<pre><code>Sub ReplaceTitleMs()\nColumns(\"V\").Replace    What:=\"Ms \", _\n                        Replacement:=\"\", _\n                        LookAt:=xlPart, _\n                        SearchOrder:=xlByRows, _\n                        MatchCase:=False, _\n                        SearchFormat:=False, _\n                        ReplaceFormat:=False\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/uedUE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uedUE.png\" alt=\"enter image description here\"></a></p>\n\n<p>So here is my currently code: </p>\n\n<pre><code>Sub Test_Replace()\n\nWorksheets(\"Sheet4\").Columns(\"B\").Replace What:=\"XXX\", _\n                        Replacement:=\"KKK\", _\n                        LookAt:=xlPart, _\n                        SearchOrder:=xlByRows, _\n                        MatchCase:=False, _\n                        SearchFormat:=False, _\n                        ReplaceFormat:=False\nWorksheets(\"Sheet4\").Columns(\"B\").Replace What:=\"SIN\", _\n                        Replacement:=\"OOO\", _\n                        LookAt:=xlPart, _\n                        SearchOrder:=xlByRows, _\n                        MatchCase:=False, _\n                        SearchFormat:=False, _\n                        ReplaceFormat:=False\n\nEnd Sub\n</code></pre>\n\n<p>When select \"search in worksheet\" in the menu, and run the code.</p>\n\n<p><a href=\"https://i.stack.imgur.com/ff06M.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ff06M.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "directory", "copy-paste"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 9385221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd67451ab188ada86c7ffa8edea635ff?s=128&d=identicon&r=PG&f=1", "display_name": "shafac14", "link": "https://stackoverflow.com/users/9385221/shafac14"}, "edited": false, "score": 0, "creation_date": 1521045779, "post_id": 49280860, "comment_id": 85569239, "body": "It works, but the issue is that the last column gets added also for the 2 blank rows which are not in the source or target sheet. It happens only for one of the sheets: CopySingleSheetData inSource, inTarget, strFile"}, {"owner": {"reputation": 15, "user_id": 9385221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd67451ab188ada86c7ffa8edea635ff?s=128&d=identicon&r=PG&f=1", "display_name": "shafac14", "link": "https://stackoverflow.com/users/9385221/shafac14"}, "edited": false, "score": 0, "creation_date": 1521105823, "post_id": 49280860, "comment_id": 85593260, "body": "Do you have any idea why this is happening?"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1521039154, "creation_date": 1521039154, "answer_id": 49280860, "question_id": 49280523, "link": "https://stackoverflow.com/questions/49280523/pasting-file-name-at-the-end-of-each-row/49280860#49280860", "title": "Pasting file name at the end of each row", "body": "<p>this should do:</p>\n\n<p>change:</p>\n\n<pre><code>Call CopyData(inSource, inTarget, enSource, enTarget, prSource, prTarget, strFile) \n</code></pre>\n\n<p>to:</p>\n\n<pre><code>CopyData inSource, inTarget, enSource, enTarget, prSource, prTarget, strFile ' Add 'strFile' to the passed parameters\n</code></pre>\n\n<p>change:</p>\n\n<pre><code>Sub CopyData(ByRef inSource As Worksheet, inTarget As Worksheet, enSource As Worksheet, enTarget As Worksheet, prSource As Worksheet, prTarget As Worksheet)\n    CopySingleSheetData inSource, inTarget\n    CopySingleSheetData enSource, enTarget\n    CopySingleSheetData prSource, prTarget\nEnd Sub\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>Sub CopyData(ByRef inSource As Worksheet, inTarget As Worksheet, enSource As Worksheet, enTarget As Worksheet, prSource As Worksheet, prTarget As Worksheet, strFile As String) ' Add 'strFile' as an argument\n    CopySingleSheetData inSource, inTarget, strFile ' pass 'strFile' as a parameter\n    CopySingleSheetData enSource, enTarget, strFile ' pass 'strFile' as a parameter\n    CopySingleSheetData prSource, prTarget, strFile ' pass 'strFile' as a parameter\nEnd Sub\n</code></pre>\n\n<p>and finally change your <code>CopySingleSheetData()</code> sub to:</p>\n\n<pre><code>Sub CopySingleSheetData(sourceSheet As Worksheet, targetSht As Worksheet, strFile As String) ' Add 'strFile' as an argument\n    Dim rngToCopy As Range\n    With sourceSheet\n        Set rngToCopy = Intersect(.UsedRange, .Rows(5).Resize(.UsedRange.Rows.Count))\n    End With\n    rngToCopy.Copy\n    With targetSht.Range(\"A\" &amp; targetSht.Rows.Count).End(xlUp).Offset(1, 0)\n        .PasteSpecial xlPasteValuesAndNumberFormats\n        Application.CutCopyMode = xlCopy\n        .Offset(, rngToCopy.Columns.Count).Resize(rngToCopy.Rows.Count).value = strFile\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 9385221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd67451ab188ada86c7ffa8edea635ff?s=128&d=identicon&r=PG&f=1", "display_name": "shafac14", "link": "https://stackoverflow.com/users/9385221/shafac14"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521039154, "creation_date": 1521038213, "last_edit_date": 1521038382, "question_id": 49280523, "link": "https://stackoverflow.com/questions/49280523/pasting-file-name-at-the-end-of-each-row", "title": "Pasting file name at the end of each row", "body": "<p>I am trying to copy values from few excel files into one. I am trying to achieve that by first looping through directories and then files. </p>\n\n<pre><code>For Each cell In ThisWorkbook.Sheets(\"Info\").Range(\"b8:b9\")\n    MsgBox (cell)\n    strfile = Dir$(cell &amp; \"\\\" &amp; \"*.xlsm\", vbNormal)\n\n    While strfile &lt;&gt; \"\"\n        MsgBox (strfile)\n        ' Open the file and get the source sheet\n        Set wbSource = Workbooks.Open(cell &amp; \"\\\" &amp; strfile)\n        Set inSource = wbSource.Sheets(\"OUTPUT_INSTRUMENT\")\n        Set enSource = wbSource.Sheets(\"OUTPUT_ENTITY\")\n        Set prSource = wbSource.Sheets(\"OUTPUT_PROTECTION\")\n\n        'Copy the data\n        Call CopyHeaders(inSource, inTarget, enSource, enTarget, prSource, prTarget)\n        Call CopyData(inSource, inTarget, enSource, enTarget, prSource, prTarget)\n\n        'Close the workbook and move to the next file.\n        wbSource.Close False\n        strfile = Dir$()\n    Wend\nNext cell\n</code></pre>\n\n<p>Those are the values in B8:B9</p>\n\n<pre><code>C:\\Users\\gdsg\\Desktop\\One\nC:\\Users\\gdsg\\Desktop\\Two\n</code></pre>\n\n<p><strong>So when I copy the headers I am also adding additional column at the end. For each row pasted I need to add the source path (strfile) at the last column. I am trying with this but it doesn't work:</strong></p>\n\n<pre><code>targetSht.Range(targetSht.Columns.Count &amp; targetSht.Rows.Count).End(xlUp).Offset(1, 0).Value = strfile\n</code></pre>\n\n<p>Please find the additional definitions below. Source sheets are looped through the directory.</p>\n\n<pre><code>Set inTarget = ThisWorkbook.Sheets(\"Instrument\")\nSet enTarget = ThisWorkbook.Sheets(\"Entity\")\nSet prTarget = ThisWorkbook.Sheets(\"Protection\")\n\nSub CopyData(ByRef inSource As Worksheet, inTarget As Worksheet, enSource As \nWorksheet, enTarget As Worksheet, prSource As Worksheet, prTarget As Worksheet)\nCopySingleSheetData inSource, inTarget        \nCopySingleSheetData enSource, enTarget        \nCopySingleSheetData prSource, prTarget        \nEnd Sub\n\n\nSub CopySingleSheetData(sourceSheet As Worksheet, targetSht As Worksheet)\nWith sourceSheet\n    Intersect(.UsedRange, .Rows(5).Resize(.UsedRange.Rows.Count)).Copy\nEnd With\ntargetSht.Range(\"A\" &amp; targetSht.Rows.Count).End(xlUp).Offset(1, 0).PasteSpecial xlPasteValuesAndNumberFormats\ntargetSht.Range(targetSht.Columns.Count &amp; targetSht.Rows.Count).End(xlUp).Offset(1, 0).Value = \"dsdf\"\nApplication.CutCopyMode = xlCopy\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "powerbi", "vba"], "answers": [{"comments": [{"owner": {"reputation": 181, "user_id": 6326809, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3b2d6e80ee7eba51e35fd84a0d1b1970?s=128&d=identicon&r=PG&f=1", "display_name": "Sai", "link": "https://stackoverflow.com/users/6326809/sai"}, "edited": false, "score": 0, "creation_date": 1521045142, "post_id": 49281078, "comment_id": 85568836, "body": "Thanks a lot Alexis. I voted for the idea. The reddit workaround doesn&#39;t tell us how we can integrate that with power query. It just shows the WINSCP automation"}, {"owner": {"reputation": 181, "user_id": 6326809, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3b2d6e80ee7eba51e35fd84a0d1b1970?s=128&d=identicon&r=PG&f=1", "display_name": "Sai", "link": "https://stackoverflow.com/users/6326809/sai"}, "edited": false, "score": 0, "creation_date": 1521819801, "post_id": 49281078, "comment_id": 85909831, "body": "Hi Alexis, Do you have any idea about the Power Query question in following thread [link] <a href=\"https://stackoverflow.com/questions/49453462/excel-power-query-how-to-create-final-table-based-on-joins\" title=\"excel power query how to create final table based on joins\">stackoverflow.com/questions/49453462/&hellip;</a>"}], "tags": [], "owner": {"reputation": 32943, "user_id": 765226, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/b0Qnm.jpg?s=128&g=1", "display_name": "Alexis Olson", "link": "https://stackoverflow.com/users/765226/alexis-olson"}, "is_accepted": false, "score": 0, "last_activity_date": 1521039678, "creation_date": 1521039678, "answer_id": 49281078, "question_id": 49280170, "link": "https://stackoverflow.com/questions/49280170/how-to-load-file-to-excel-power-query-from-sftp-site/49281078#49281078", "title": "How to load file to Excel Power query from SFTP site", "body": "<p>Currently, I don't think there is a connector that will do this.</p>\n\n<p>There is an <a href=\"https://ideas.powerbi.com/forums/265200-power-bi-ideas/suggestions/11057568-sftp\" rel=\"nofollow noreferrer\">idea on the Power BI forums</a> that you can vote for related to this.</p>\n\n<p>There might be possible workarounds if you're willing to do some scripting as suggested in <a href=\"https://www.reddit.com/r/excel/comments/63wz8a/how_to_load_source_text_data_files_from_an_sftp/\" rel=\"nofollow noreferrer\">this Reddit thread</a>, but I don't fully understand how that would work.</p>\n"}], "owner": {"reputation": 181, "user_id": 6326809, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3b2d6e80ee7eba51e35fd84a0d1b1970?s=128&d=identicon&r=PG&f=1", "display_name": "Sai", "link": "https://stackoverflow.com/users/6326809/sai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1094, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521039678, "creation_date": 1521037356, "last_edit_date": 1531161705, "question_id": 49280170, "link": "https://stackoverflow.com/questions/49280170/how-to-load-file-to-excel-power-query-from-sftp-site", "title": "How to load file to Excel Power query from SFTP site", "body": "<p>Can anyone please help me on this?\nI am trying to load a file to Excel Power Query from the SFTP site and I don't see any option. \nFollowing are the sample WINSCP SFTP site credentials:</p>\n\n<pre><code>File Protocol: SFTP\nHost Name: ftp.test.com\nPort Number: 22\nUsername: Test1\nPassword: XXXX\n</code></pre>\n\n<p>As shown in the below code snippet, I can load it from my local C drive, but Can you let me know how I can load it from SFTP drive site?</p>\n\n<pre><code>let\nSource = Csv.Document(File.Contents(\"C:\\Users\\Documents\\Winscp\\acct_dept.dat\"),[Delimiter=\"|\", Columns=7, Encoding=1252, QuoteStyle=QuoteStyle.None]),\n#\"Changed Type\" = Table.TransformColumnTypes(Source,{{\"Column1\", type text}, {\"Column2\", type text}})\nin\n    #\"Changed Type\"\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/7Mus6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7Mus6.png\" alt=\"WINSCP SFTP Drive\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1521035564, "post_id": 49279518, "comment_id": 85561686, "body": "Is that how the values appear in a cell?"}, {"owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "edited": false, "score": 0, "creation_date": 1521035668, "post_id": 49279518, "comment_id": 85561751, "body": "This solution will need some VBA code, that&#39;s why I edited tags"}, {"owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "reply_to_user": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "edited": false, "score": 0, "creation_date": 1521035723, "post_id": 49279518, "comment_id": 85561802, "body": "@Micha\u0142Turczyn VBA might be a way to go here, but why not just reimport and separate out the three values?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1521035798, "post_id": 49279518, "comment_id": 85561873, "body": "You can use evalute, e.g. <code>evaluate(&quot;=&quot;&amp;range(&quot;A1&quot;))</code>."}], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1521035930, "post_id": 49279599, "comment_id": 85561973, "body": "you can skip the export and import and just use Text to Columns."}, {"owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1521036025, "post_id": 49279599, "comment_id": 85562039, "body": "@ScottCraner I never knew about this feature."}], "tags": [], "owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "is_accepted": false, "score": 0, "last_activity_date": 1521035686, "creation_date": 1521035686, "answer_id": 49279599, "question_id": 49279518, "link": "https://stackoverflow.com/questions/49279518/excel-calculation-suffix/49279599#49279599", "title": "Excel calculation suffix", "body": "<p>The easiest option here is probably to save your current worksheet as a CSV text file.  Then reimport this file using the diamond symbol in your screen capture as a delimiter.  This will place each of the three values in separate columns.  Once you get this far, you may simply take the product of the three columns.</p>\n"}, {"comments": [{"owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1521036073, "post_id": 49279689, "comment_id": 85562075, "body": "I&#39;m not 100% sure that the separator is actually an asterisk."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1521036150, "post_id": 49279689, "comment_id": 85562135, "body": "What sharp eyes you have!"}, {"owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1521036195, "post_id": 49279689, "comment_id": 85562161, "body": "This is a good answer, surely useful to someone who needs a VBA solution +1."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1521039273, "post_id": 49279689, "comment_id": 85564381, "body": "This seems to be one of those situations in which it is necessary to specify the Value property. <code>Evaluate(Range(&quot;A1&quot;))</code> doesn&#39;t work, although <code>Evaluate(&quot;=&quot; &amp; Range(&quot;A1&quot;))</code> does."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1521040628, "post_id": 49279689, "comment_id": 85565396, "body": "As SJR agreed. That is why I used myRange.Value. Have I missed a trick please?"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1521037052, "last_edit_date": 1521037052, "creation_date": 1521035937, "answer_id": 49279689, "question_id": 49279518, "link": "https://stackoverflow.com/questions/49279518/excel-calculation-suffix/49279689#49279689", "title": "Excel calculation suffix", "body": "<p>Or write a simple UDF to do the Evaluate on the string. If you set your data up as a table then the UDF will be automatically filled down as many rows as required.</p>\n\n<p>In a standard module</p>\n\n<pre><code>Option Explicit\n\nPublic Function GetSum(ByVal myRange As Range) As Long\n    GetSum = Evaluate(myRange.Value)\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/pbfNn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pbfNn.png\" alt=\"Output\"></a></p>\n\n<p>Similar idea was discussed here:</p>\n\n<p><a href=\"https://superuser.com/questions/253353/excel-function-that-evaluates-a-string-as-if-it-were-a-formula\">https://superuser.com/questions/253353/excel-function-that-evaluates-a-string-as-if-it-were-a-formula</a></p>\n\n<p>And a quick and dirty version where you can specify the delimiter e.g. \"*\" or something else that separates the numbers</p>\n\n<pre><code>Public Function GetSum2(ByVal myRange As Range, ByVal delimiter As String) As Long\n\n    Dim myArr() As String\n\n    myArr = Split(myRange.Value, delimiter)\n\n    Dim outputValue As Long\n    outputValue = 1\n\n    Dim i As Long\n\n    For i = LBound(myArr) To UBound(myArr)\n        outputValue = outputValue * CLng(myArr(i))\n    Next i\n\n    GetSum2 = outputValue\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1521036028, "creation_date": 1521036028, "answer_id": 49279725, "question_id": 49279518, "link": "https://stackoverflow.com/questions/49279518/excel-calculation-suffix/49279725#49279725", "title": "Excel calculation suffix", "body": "<p>Try this code:</p>\n\n<pre><code>Sub CalculateVolumes()\nDim column As Long, lastRow As Long, i As Long, number As Variant, volume As Long\ncolumn = 1 'A column\nlastRow = Cells(Rows.Count, column).End(xlUp).Row\n\nFor i = 1 To lastRow\n    volume = 1\n    For Each number In Split(Cells(i, column).Value, \"*\")\n        volume = volume * number\n    Next\n    'column + 1 means that I will put calculated volume next to the cell\n    Cells(i, column + 1).Value = volume\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "is_accepted": false, "score": 1, "last_activity_date": 1521036763, "creation_date": 1521036763, "answer_id": 49279966, "question_id": 49279518, "link": "https://stackoverflow.com/questions/49279518/excel-calculation-suffix/49279966#49279966", "title": "Excel calculation suffix", "body": "<p>Evaluate function works , but it needs a few steps to get it working, you can't just put into the cell as in =Evaluate($A1)\nYou need to setup a named range first</p>\n\n<p>Select cell B1</p>\n\n<p>Go to the FORMULAS tab and click Define Name</p>\n\n<p>In the dialog box, type in a name like Result</p>\n\n<p>In the Refers to box, put in the formula =Evaluate($A1)</p>\n\n<p>Click OK\nNow in B1 type in =Result</p>\n\n<p>You can drag this down for all cells.</p>\n"}, {"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1521036877, "creation_date": 1521036877, "answer_id": 49280003, "question_id": 49279518, "link": "https://stackoverflow.com/questions/49279518/excel-calculation-suffix/49280003#49280003", "title": "Excel calculation suffix", "body": "<p>Without VBA</p>\n\n<p>with data in <strong>A1</strong>, in <strong>B1</strong> enter:</p>\n\n<pre><code>=TRIM(MID(SUBSTITUTE($A1,\"*\",REPT(\" \",999)),999-998,999))*TRIM(MID(SUBSTITUTE($A1,\"*\",REPT(\" \",999)),2*999-998,999))*TRIM(MID(SUBSTITUTE($A1,\"*\",REPT(\" \",999)),3*999-998,999))\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/0OcKg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0OcKg.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1521045781, "post_id": 49280318, "comment_id": 85569240, "body": "Cool formula!.............................we could also multiply 3 <code>MID()</code>s"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1521047869, "post_id": 49280318, "comment_id": 85570693, "body": "My formula allows any number of numbers to be multiplied, but only if they are 3-digit. @ScottCraner&#39;s answer multiplies 3 numbers, regardless of digits.  If you replaced his <code>ROW(1:3)</code> with my <code>ROW(OFFSET($A$1,0,0,1+LEN(B1)-LEN(SUBSTITUTE(B1,&quot;*&quot;,&quot;&quot;)),1))</code> then you get the general case for any number of numbers of any number of digits."}], "tags": [], "owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "is_accepted": false, "score": 1, "last_activity_date": 1521037705, "creation_date": 1521037705, "answer_id": 49280318, "question_id": 49279518, "link": "https://stackoverflow.com/questions/49279518/excel-calculation-suffix/49280318#49280318", "title": "Excel calculation suffix", "body": "<p>If you always have 3-digit numbers, then this Array Formula will work (Remember that you need to hit [Ctrl]+[Shift]+[Enter] to convert from Formula to Array Formula)</p>\n\n<pre><code>=PRODUCT(0+(MID(B1,1+(4*(ROW(OFFSET($A$1,0,0,1+LEN(B1)-LEN(SUBSTITUTE(B1,\"*\",\"\")),1))-1)),3)))\n</code></pre>\n\n<p>Annoyingly, <code>MID</code> doesn't work on arrays in a <code>SUMPRODUCT</code>, so this needs to be a proper Array Formula :(</p>\n\n<p>The <code>B1</code> is the cell with the numbers in, <code>$A$1</code> is just to make sure that we pull out enough 3-digit numbers (leave it on Row 1!), and <code>\"*\"</code> should be the deliminator character</p>\n"}, {"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 1, "last_activity_date": 1521039210, "creation_date": 1521039210, "answer_id": 49280887, "question_id": 49279518, "link": "https://stackoverflow.com/questions/49279518/excel-calculation-suffix/49280887#49280887", "title": "Excel calculation suffix", "body": "<p>Another option:</p>\n\n<pre><code>=PRODUCT(--TRIM(MID(SUBSTITUTE($A1,\"*\",REPT(\" \",999)),(ROW(1:3)-1)*999+1,999)))\n</code></pre>\n\n<p>As an array formula with Ctrl-Shift-Enter instead of Enter.</p>\n"}], "owner": {"reputation": 23, "user_id": 4575457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0a65caccb2a5b73b6d7da85237730cc?s=128&d=identicon&r=PG&f=1", "display_name": "Mikcy", "link": "https://stackoverflow.com/users/4575457/mikcy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 1, "answer_count": 7, "score": 1, "last_activity_date": 1521039210, "creation_date": 1521035453, "last_edit_date": 1521035638, "question_id": 49279518, "link": "https://stackoverflow.com/questions/49279518/excel-calculation-suffix", "title": "Excel calculation suffix", "body": "<p>I have a sheet with 3 side dimensions of a package.\n<a href=\"https://i.stack.imgur.com/wM3Ud.jpg\" rel=\"nofollow noreferrer\">dimension column</a></p>\n\n<p>Is there a way to get the multiplied value of these dimensions? There are hundred of rows, manually would take too much time.</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["arrays", "vba", "excel", "loops", "range"], "comments": [{"owner": {"reputation": 567, "user_id": 5805795, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5e306c676900f1dc3f798f3915879f03?s=128&d=identicon&r=PG&f=1", "display_name": "jcarroll", "link": "https://stackoverflow.com/users/5805795/jcarroll"}, "edited": false, "score": 0, "creation_date": 1521035265, "post_id": 49279353, "comment_id": 85561439, "body": "Untested, but I think you just need to say, <code>Set sheetnames = Worksheets...</code>"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1521035428, "post_id": 49279353, "comment_id": 85561572, "body": "Not a good idea to use <code>.Select</code> and <code>ActiveSheet.</code> anyway. See <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid using Select in Excel VBA macros - Stack Overflow</a>."}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1521035606, "post_id": 49279353, "comment_id": 85561718, "body": "What&#39;s is your array base?  If the array is <code>sheetnames(1)=&quot;Sheet1&quot;: sheetnames(2)=&quot;Sheet2&quot;</code> then <code>sheetnames(0)</code> will return an error.  Use <code>Lbound</code> and <code>Ubound</code> to check"}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1521036117, "last_edit_date": 1521036117, "creation_date": 1521035295, "answer_id": 49279455, "question_id": 49279353, "link": "https://stackoverflow.com/questions/49279353/loop-through-range-of-sheets/49279455#49279455", "title": "Loop through Range of sheets", "body": "<pre><code>Sub CalcSheets()\n\n    Dim k           As Long\n    Dim sheetnames  As Variant\n\n    sheetnames = Array(\"Sheet1\", \"Sheet2\")\n\n    For k = 0 To Application.CountA(sheetnames) - 1\n        Sheets(sheetnames(k)).Calculate\n    Next k    \nEnd Sub\n</code></pre>\n\n<p>In general, <code>Select</code> and <code>ActiveSheet</code> should be avoided and if you are using <code>.Calculate</code> explicitly something should be quite wrong in the whole worksheet design.</p>\n"}, {"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1521035592, "post_id": 49279459, "comment_id": 85561708, "body": "<code>shet</code> ? not `sht ? you were trying to type so fast ;)"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 5, "creation_date": 1521035681, "post_id": 49279459, "comment_id": 85561759, "body": "@ShaiRado The purpose of this macro is calculation.  It&#39;s all about getting shet done."}, {"owner": {"reputation": 335, "user_id": 4920363, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/fcfc13b80adfc16e2e70235c957977a8?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4920363/peter"}, "edited": false, "score": 0, "creation_date": 1521042368, "post_id": 49279459, "comment_id": 85566757, "body": "Great. How can I pull the sheetnames form a Range from a sheet?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 335, "user_id": 4920363, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/fcfc13b80adfc16e2e70235c957977a8?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4920363/peter"}, "edited": false, "score": 0, "creation_date": 1521042822, "post_id": 49279459, "comment_id": 85567112, "body": "Sheetnames = worksheets (&quot;sheet3&quot;).range(&quot;A1:A4&quot;).value @AlexKlindt"}, {"owner": {"reputation": 335, "user_id": 4920363, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/fcfc13b80adfc16e2e70235c957977a8?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4920363/peter"}, "edited": false, "score": 0, "creation_date": 1521048862, "post_id": 49279459, "comment_id": 85571381, "body": "This returns Runtime error 9 for me -  in line <code>Set sht = Worksheets(sheetnames(k))</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 335, "user_id": 4920363, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/fcfc13b80adfc16e2e70235c957977a8?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4920363/peter"}, "edited": false, "score": 0, "creation_date": 1521049015, "post_id": 49279459, "comment_id": 85571470, "body": "I removed the &quot;note&quot; but that would not have caused the error.  That error is because you have misspelled the sheet names.  Double check the sheet names and that the names do not have spaces or other unprintable characters not accounted for in your strings. @AlexKlindt"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 3, "last_activity_date": 1521048928, "last_edit_date": 1521048928, "creation_date": 1521035304, "answer_id": 49279459, "question_id": 49279353, "link": "https://stackoverflow.com/questions/49279353/loop-through-range-of-sheets/49279459#49279459", "title": "Loop through Range of sheets", "body": "<p>Use Lbound and Ubound to loop through the array.</p>\n\n<p>Declare the sht as a worksheet and Set the sheet.  Then avoid the use of select and activate.</p>\n\n<pre><code>Sub Calc_sheets()\n\nDim sheetnames As Variant\nDim sht as Worksheet\n\n\nsheetnames = Array(\"Sheet1\", \"Sheet2\")\n\nFor k = LBound(sheetnames) to Ubound(sheetnames)\n\n        Set Sht = worksheets(sheetnames(k))\n        sht.Calculate\nNext k\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 3, "last_activity_date": 1521035890, "last_edit_date": 1521035890, "creation_date": 1521035404, "answer_id": 49279496, "question_id": 49279353, "link": "https://stackoverflow.com/questions/49279353/loop-through-range-of-sheets/49279496#49279496", "title": "Loop through Range of sheets", "body": "<p>you have to use <code>Set</code></p>\n\n<pre><code>Dim Sheet AS Worksheet\nSet Sheet = sheetnames(k)\n</code></pre>\n\n<p>but you can shorten it down to</p>\n\n<pre><code>Sub Calc_sheets()\n    Dim sheetnames As Variant\n    sheetnames = Array(\"Sheet1\", \"Sheet2\")\n\n    Dim Sheet As Variant\n    For Each Sheet In sheetnames\n        Sheets(Sheet).Calculate\n    Next\nEnd Sub\n</code></pre>\n\n<p>or even shorter:</p>\n\n<pre><code>Sub Calc_sheets()\n    Dim Sheet As Variant\n    For Each Sheet In Array(\"Sheet1\", \"Sheet2\")\n        Sheets(Sheet).Calculate\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 335, "user_id": 4920363, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/fcfc13b80adfc16e2e70235c957977a8?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4920363/peter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1521048928, "creation_date": 1521035083, "last_edit_date": 1521035433, "question_id": 49279353, "link": "https://stackoverflow.com/questions/49279353/loop-through-range-of-sheets", "title": "Loop through Range of sheets", "body": "<p>I am trying to loop through a range of sheets. However, I get an error when selecting the sheets from a range on a sheet.</p>\n\n<pre><code>Sub Calc_sheets()\n\nDim sheetnames As Variant\nsheets(\"Calc_sheets\").Select\n'sheetnames = Worksheets(\"Calc_sheets\").Range(\"a2:a4\").Value # returns an error in row \"Sheet = sheetnames(k)\"\n\nsheetnames = Array(\"Sheet1\", \"Sheet2\") # works fine\n\nFor k = 0 To Application.CountA(sheetnames) - 1\n\n        Sheet = sheetnames(k)\n        sheets(Sheet).Select\n        ActiveSheet.Calculate\nNext k\n\nEnd Sub\n</code></pre>\n\n<p>Do you know how to solve this?</p>\n\n<p>Best,</p>\n"}, {"tags": ["excel", "date", "vba"], "comments": [{"owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "edited": false, "score": 1, "creation_date": 1521032832, "post_id": 49278259, "comment_id": 85559534, "body": "dataDate doesn&#39;t appear to have been Dim&#39;d (also colData) so you probably have type conversion issues. You should look to cast the dates into CDate types for comparison. If you add &#39;Option Explicit&#39; to the top of your code you will be able to find undimensioned variables"}, {"owner": {"reputation": 821, "user_id": 6143650, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/OyfHo.jpg?s=128&g=1", "display_name": "L.Dutch - Reinstate Monica", "link": "https://stackoverflow.com/users/6143650/l-dutch-reinstate-monica"}, "reply_to_user": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "edited": false, "score": 0, "creation_date": 1521033058, "post_id": 49278259, "comment_id": 85559692, "body": "@Tragamor, shouldn&#39;t I get an error in such case? Because I don&#39;t get any."}, {"owner": {"reputation": 747, "user_id": 5627791, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ck0cK.png?s=128&g=1", "display_name": "TomJohnRiddle", "link": "https://stackoverflow.com/users/5627791/tomjohnriddle"}, "edited": false, "score": 3, "creation_date": 1521033201, "post_id": 49278259, "comment_id": 85559810, "body": "I would advise using DateDiff to check difference between dates and base my condition on that. Please see this thread: <a href=\"https://stackoverflow.com/questions/48811340/checking-if-datetime-is-in-between-a-given-datetime-interval/48811906#comment84628013_48811906\" title=\"checking if datetime is in between a given datetime interval\">stackoverflow.com/questions/48811340/&hellip;</a>"}, {"owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "edited": false, "score": 0, "creation_date": 1521033389, "post_id": 49278259, "comment_id": 85559940, "body": "Not necessarily; dates are a difficult beast to work with in VBA as regional settings aren&#39;t taken into account while they are within worksheet formulas. The dates may be being parsed incorrectly which will affect comparisons: are your dates the 3rd July or 7th March?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1521033815, "post_id": 49278259, "comment_id": 85560254, "body": "For displaying dates I can recommend always to use the <a href=\"https://en.wikipedia.org/wiki/ISO_8601\" rel=\"nofollow noreferrer\">format <code>YYYY-MM-DD</code> according to ISO 8601</a> which is the only format with only one interpretation. This makes it also much easier to parse a string into a date in VBA."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1521033992, "post_id": 49278259, "comment_id": 85560403, "body": "If you&#39;re unable to change the date format, similar to what @P\u1d07\u029c has suggested, I would recommend splitting the data for comparison, such that left(cell,2)=month(rng) &amp; right(left(cell,10),4)=year(rng), to make exact comparisons, not relying on the listed date format.  You can do this check in a logic if-statement, e.g., if year_cell = year_rng AND (month_cell = month_rng OR day_cell = day_rng) then..."}, {"owner": {"reputation": 821, "user_id": 6143650, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/OyfHo.jpg?s=128&g=1", "display_name": "L.Dutch - Reinstate Monica", "link": "https://stackoverflow.com/users/6143650/l-dutch-reinstate-monica"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1521096419, "post_id": 49278259, "comment_id": 85588607, "body": "@P\u1d07\u029c, sadly I have no voice in setting the format of the data. I get them from a database"}, {"owner": {"reputation": 821, "user_id": 6143650, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/OyfHo.jpg?s=128&g=1", "display_name": "L.Dutch - Reinstate Monica", "link": "https://stackoverflow.com/users/6143650/l-dutch-reinstate-monica"}, "reply_to_user": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "edited": false, "score": 0, "creation_date": 1521097339, "post_id": 49278259, "comment_id": 85589004, "body": "@Tragamor, the dates are 7th March, and I have already changed to regional settings to handle that."}, {"owner": {"reputation": 821, "user_id": 6143650, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/OyfHo.jpg?s=128&g=1", "display_name": "L.Dutch - Reinstate Monica", "link": "https://stackoverflow.com/users/6143650/l-dutch-reinstate-monica"}, "reply_to_user": {"reputation": 747, "user_id": 5627791, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ck0cK.png?s=128&g=1", "display_name": "TomJohnRiddle", "link": "https://stackoverflow.com/users/5627791/tomjohnriddle"}, "edited": false, "score": 0, "creation_date": 1521097366, "post_id": 49278259, "comment_id": 85589010, "body": "@TomJohnRiddle, if you could put your comment in an answer I&#39;d gladly upvote it"}, {"owner": {"reputation": 747, "user_id": 5627791, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ck0cK.png?s=128&g=1", "display_name": "TomJohnRiddle", "link": "https://stackoverflow.com/users/5627791/tomjohnriddle"}, "edited": false, "score": 0, "creation_date": 1521102773, "post_id": 49278259, "comment_id": 85591401, "body": "@L. Dutch Ok. I posted more elaborate answer with some additional references. Thank you! :)"}], "answers": [{"tags": [], "owner": {"reputation": 747, "user_id": 5627791, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ck0cK.png?s=128&g=1", "display_name": "TomJohnRiddle", "link": "https://stackoverflow.com/users/5627791/tomjohnriddle"}, "is_accepted": true, "score": 1, "last_activity_date": 1538944318, "last_edit_date": 1538944318, "creation_date": 1521102318, "answer_id": 49294537, "question_id": 49278259, "link": "https://stackoverflow.com/questions/49278259/checking-if-a-date-falls-in-a-given-interval-not-working/49294537#49294537", "title": "Checking if a date falls in a given interval not working", "body": "<p>It seems that issue lays in line <code>If dataDate &gt;= FilterStart And dataDate &lt;= FilterEnd</code> comparing date-time data type directly, using comparison operators may return unexpected results. I would advise using VBA's <code>DateDiff</code> function (<a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/datediff-function\" rel=\"nofollow noreferrer\">reference</a>). Similar issue was encountered in <a href=\"https://stackoverflow.com/questions/48811340/checking-if-datetime-is-in-between-a-given-datetime-interval\">this</a> thread and was successfully resolved using <code>DateDiff</code> function.</p>\n"}], "owner": {"reputation": 821, "user_id": 6143650, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/OyfHo.jpg?s=128&g=1", "display_name": "L.Dutch - Reinstate Monica", "link": "https://stackoverflow.com/users/6143650/l-dutch-reinstate-monica"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 49294537, "answer_count": 1, "score": 1, "last_activity_date": 1538944318, "creation_date": 1521031910, "last_edit_date": 1531161705, "question_id": 49278259, "link": "https://stackoverflow.com/questions/49278259/checking-if-a-date-falls-in-a-given-interval-not-working", "title": "Checking if a date falls in a given interval not working", "body": "<p>I want to check if a given date, in the format mm/dd/yyyy hh:mm:ss falls within a given interval. The interval is defined by the start date, with the same format, and its duration in decimal (so half an hour would be 0.5 hours), as in the example below</p>\n\n<p>Example of the intervals in the sheet called filter\n<a href=\"https://i.stack.imgur.com/vI11p.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vI11p.png\" alt=\"enter image description here\"></a></p>\n\n<p>Example of the data in the sheet called data\n<a href=\"https://i.stack.imgur.com/5OWYn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5OWYn.png\" alt=\"enter image description here\"></a>\nI have written the following code:</p>\n\n<pre><code>Sub filter_Click()\nApplication.ScreenUpdating = False\nDim LastDataRow, LastDataCol, LastFilterRow, LastFilterCol, FilterStart, FilterDuration, \n_FilterEnd As Long \n' get boundaries\nWith Sheets(\"data\")\n    LastDataRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    LastDataCol = .Cells(1, .Columns.Count).End(xlToLeft).Column\nEnd With\nWith Sheets(\"filter\")\n    LastFilterRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    LastFilterCol = .Cells(1, .Columns.Count).End(xlToLeft).Column\nEnd With\n\n'filter the data\nlineFilter = 2\nFor rowFilter = 2 To LastFilterRow\n    FilterStart = Sheets(\"filter\").Cells(lineFilter, 5).Value\n    FilterDuration = Sheets(\"filter\").Cells(lineFilter, 6).Value\n    FilterEnd = FilterStart + FilterDuration / 24\n    For colData = 1 To LastDataCol\n        rowdestination = 2\n        colDestination = colData\n        If colData Mod 2 &lt;&gt; 0 Then\n            For rowData = 2 To LastDataRow\n                dataDate = Sheets(\"data\").Cells(rowData, colData)\n                If dataDate &gt;= FilterStart And dataDate &lt;= FilterEnd Then\n                    Sheets(\"data\").Cells(rowData, colData).Copy\n                    Sheets(\"filtered data\").Cells(rowdestination, colDestination).PasteSpecial\n                    Sheets(\"data\").Cells(rowData, colData + 1).Copy\n                    Sheets(\"filtered data\").Cells(rowdestination, colDestination + 1).PasteSpecial\n                    rowdestination = rowdestination + 1\n                End If\n            Next rowData\n        End If\n    Next colData\nNext rowFilter\nSheets(\"data\").Range(\"A1:ZZ1\").Copy\nSheets(\"filtered data\").Range(\"A1:ZZ1\").PasteSpecial\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Now I expect the date in C12 to be within the interval defined in E3 and F3, but the macro doesn't copy them.</p>\n\n<p>This is not the case.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 808, "user_id": 6532640, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-8Uw3zcKUw5c/AAAAAAAAAAI/AAAAAAAAACE/yaXF1QrLkjM/photo.jpg?sz=128", "display_name": "NatNgs", "link": "https://stackoverflow.com/users/6532640/natngs"}, "edited": false, "score": 0, "creation_date": 1521033349, "post_id": 49278043, "comment_id": 85559914, "body": "I think they may have a problem with <code>Criteria1:=&quot;&gt;=Range(&quot;F2&quot;)&quot;, </code> and <code>Criteria2:=&quot;&lt;=Range(&quot;125&quot;)&quot;</code>: Here quotes are understood by the machine like (replacing quotes by brackets) <code>Criteria1:= [Range(] F2 [)] ,</code>  instead of <code>Criteria1:= [Range( [F2] )] ,</code> as expected"}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 9491411, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/66d0afb6832265aa788f60edc9e2d4f7?s=128&d=identicon&r=PG&f=1", "display_name": "sheela", "link": "https://stackoverflow.com/users/9491411/sheela"}, "edited": false, "score": 1, "creation_date": 1521032335, "post_id": 49278069, "comment_id": 85559206, "body": "Thanks SJR. It works well. Could you suggest online portals for knowing/learning these stuffs. I am a very beginner in excel-vba macros"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 29, "user_id": 9491411, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/66d0afb6832265aa788f60edc9e2d4f7?s=128&d=identicon&r=PG&f=1", "display_name": "sheela", "link": "https://stackoverflow.com/users/9491411/sheela"}, "edited": false, "score": 1, "creation_date": 1521033277, "post_id": 49278069, "comment_id": 85559860, "body": "My pleasure. Could you accept the answer please? I can&#39;t really recommend any particular site but if you google Excel VBA you will find a lot of useful tutorials and you can hang about websites like this."}, {"owner": {"reputation": 29, "user_id": 9491411, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/66d0afb6832265aa788f60edc9e2d4f7?s=128&d=identicon&r=PG&f=1", "display_name": "sheela", "link": "https://stackoverflow.com/users/9491411/sheela"}, "edited": false, "score": 0, "creation_date": 1521055431, "post_id": 49278069, "comment_id": 85575075, "body": "Hallo SJR..! I am getting a RUN TIME ERROR:1004.  Autofilter Method of Range Class has failed.  this is the message I get"}, {"owner": {"reputation": 29, "user_id": 9491411, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/66d0afb6832265aa788f60edc9e2d4f7?s=128&d=identicon&r=PG&f=1", "display_name": "sheela", "link": "https://stackoverflow.com/users/9491411/sheela"}, "edited": false, "score": 0, "creation_date": 1521111688, "post_id": 49278069, "comment_id": 85597193, "body": "Opening the file in a different PC. That is the only thing happened. What does &#39;Active Sheet&#39; mean..? Instead how can I mention the exact sheet reference instead of &#39;Active.Sheet&#39;"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 2, "last_activity_date": 1521112264, "last_edit_date": 1521112264, "creation_date": 1521031258, "answer_id": 49278069, "question_id": 49278043, "link": "https://stackoverflow.com/questions/49278043/macro-filter-for-a-range-of-values-numbers-in-excel-using-command-button/49278069#49278069", "title": "Macro Filter for a Range of Values/ Numbers in excel using Command Button", "body": "<p>You need to remove the Ranges from the quotes otherwies they are treated  literally, and your second range was garbled.</p>\n\n<pre><code>ActiveSheet.Range(\"$H$5:$H$592\").AutoFilter Field:=1, Criteria1:=\"&gt;=\" &amp; Range(\"F2\"), _\n        Operator:=xlAnd, Criteria2:=\"&lt;=\" &amp; Range(\"F5\")\n</code></pre>\n\n<p>Including sheet references, amend to suit.</p>\n\n<pre><code>Sheets(\"Whatever\").Range(\"$H$5:$H$592\").AutoFilter Field:=1, Criteria1:=\"&gt;=\" &amp; Sheets(\"Whatever\").Range(\"F2\"), _\n        Operator:=xlAnd, Criteria2:=\"&lt;=\" &amp; Sheets(\"Whatever\").Range(\"F5\")\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 9491411, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/66d0afb6832265aa788f60edc9e2d4f7?s=128&d=identicon&r=PG&f=1", "display_name": "sheela", "link": "https://stackoverflow.com/users/9491411/sheela"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 428, "favorite_count": 0, "accepted_answer_id": 49278069, "answer_count": 1, "score": 1, "last_activity_date": 1521112264, "creation_date": 1521031178, "last_edit_date": 1531164843, "question_id": 49278043, "link": "https://stackoverflow.com/questions/49278043/macro-filter-for-a-range-of-values-numbers-in-excel-using-command-button", "title": "Macro Filter for a Range of Values/ Numbers in excel using Command Button", "body": "<p>I need support in creating a macro filter with command button.</p>\n\n<p>I have numbers on column H2:H592</p>\n\n<p>I would like to filter the values between a Range always. For examples 110 to 140</p>\n\n<p>So I have two cells to enter the Range Excel F2 and F5.</p>\n\n<p>I enter lower range as 110 and Upper Range as 140. I want the values between this range. I tried this by creating a command button macro and taking code for Automatic number filter from Record macro option. But doesnt work well. I mean not at all. Below is the code which used</p>\n\n<pre><code>ActiveSheet.Range(\"$H$5:$H$592\").AutoFilter Field:=1, Criteria1:=\"&gt;=Range(\"F2\")\", _\n        Operator:=xlAnd, Criteria2:=\"&lt;=Range(\"125\")\"\n</code></pre>\n\n<p>Thanks in Prior</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1521030812, "post_id": 49277860, "comment_id": 85558152, "body": "Post the code !"}, {"owner": {"reputation": 57, "user_id": 9476590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ROxCh.png?s=128&g=1", "display_name": "Charles", "link": "https://stackoverflow.com/users/9476590/charles"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1521031608, "post_id": 49277860, "comment_id": 85558701, "body": "Edited to add code"}], "answers": [{"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 0, "last_activity_date": 1521033226, "last_edit_date": 1521033226, "creation_date": 1521032349, "answer_id": 49278417, "question_id": 49277860, "link": "https://stackoverflow.com/questions/49277860/duplicate-rows-based-on-cell-content-and-identifying-primary-value/49278417#49278417", "title": "Duplicate rows based on cell content and identifying primary value", "body": "<p>Here is a slightly different approach, which avoids the second loop.</p>\n\n<pre><code>Sub SplitCell()\n\nDim cArray As Variant\nDim rowIndex As Long, destRow As Long\nDim targetColumn As Long\nDim lastRow As Long, lastCol As Long\nDim srcSheet As Worksheet, destSheet As Worksheet\n\ntargetColumn = 2 'column with semi-colon separated data\n\nSet srcSheet = ThisWorkbook.Worksheets(\"Sheet1\") 'sheet with data\nSet destSheet = ThisWorkbook.Worksheets(\"Sheet2\") 'sheet where result will be displayed\ndestRow = 1\nWith srcSheet\n    lastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    lastCol = .Cells(1, .Columns.Count).End(xlToLeft).Column\n    destSheet.Cells(1, 4).Value = \"Primary\"\n    For rowIndex = 1 To lastRow\n        cArray = Split(srcSheet.Cells(rowIndex, targetColumn), \";\") 'splitting semi-colon separated data in an array\n        destSheet.Cells(destRow, 1).Resize(UBound(cArray) + 1).Value = srcSheet.Cells(rowIndex, targetColumn - 1).Value\n        destSheet.Cells(destRow, 2).Resize(UBound(cArray) + 1).Value = Application.Transpose(cArray)\n        destSheet.Cells(destRow, 3).Resize(UBound(cArray) + 1).Value = srcSheet.Cells(rowIndex, targetColumn + 1).Value\n        If rowIndex &gt; 1 Then destSheet.Cells(destRow, 4).Value = 1\n        If UBound(cArray) &gt; 0 Then\n            destSheet.Cells(destRow + 1, 4).Resize(UBound(cArray)).Value = 0\n        End If\n        destRow = destSheet.Cells(Rows.Count, 1).End(xlUp).Row + 1\n    Next rowIndex\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1521033015, "creation_date": 1521033015, "answer_id": 49278652, "question_id": 49277860, "link": "https://stackoverflow.com/questions/49277860/duplicate-rows-based-on-cell-content-and-identifying-primary-value/49278652#49278652", "title": "Duplicate rows based on cell content and identifying primary value", "body": "<p>Note: I am using this \",\" delimiter as your data shows that rather than your code which is using \";\". Simply swop if necessary.</p>\n\n<pre><code>Option Explicit\n\nSub SplitCell()\n    Dim cArray As Variant\n    Dim cValue As String\n    Dim rowIndex As Long, strIndex As Long, destRow As Long\n    Dim targetColumn As Long\n    Dim lastRow As Long, lastCol As Long\n    Dim srcSheet As Worksheet, destSheet As Worksheet\n\n    targetColumn = 2                             'column with semi-colon separated data\n\n    Set srcSheet = ThisWorkbook.Worksheets(\"Sheet1\") 'sheet with data\n    Set destSheet = ThisWorkbook.Worksheets(\"Sheet2\") 'sheet where result will be displayed\n\n    destRow = 0\n\n    With srcSheet\n\n        lastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n        lastCol = .Cells(1, .Columns.Count).End(xlToLeft).Column\n\n        For rowIndex = 1 To lastRow\n\n            cValue = .Cells(rowIndex, targetColumn).Value 'getting the cell with semi-colon separated data\n            cArray = Split(cValue, \",\")          'splitting semi-colon separated data in an array\n\n            For strIndex = 0 To UBound(cArray)\n\n                destRow = destRow + 1\n                destSheet.Cells(destRow, 1) = .Cells(rowIndex, 1)\n                destSheet.Cells(destRow, 2) = Trim(cArray(strIndex))\n                destSheet.Cells(destRow, 3) = .Cells(rowIndex, 3)\n\n                If rowIndex = 1 Then\n\n                   destSheet.Cells(destRow, 4) = \"Primary\"\n\n                Else\n                    If strIndex = 0 Then\n                        destSheet.Cells(destRow, 4) = 1\n                    Else\n                        destSheet.Cells(destRow, 4) = 0\n                    End If\n                End If\n\n            Next strIndex\n\n        Next rowIndex\n\n    End With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1521037418, "post_id": 49279020, "comment_id": 85562993, "body": "Won&#39;t it be better simply to <code>dim priority as Long</code> and in order to avoid <code>-CInt(priority)</code> which looks tough. Then to say <code>priority = 1</code> and <code>priorty = 0</code> instaed of <code>priority = True</code> and <code>priority = False</code> ? The understanding would be improved."}, {"owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1521038629, "post_id": 49279020, "comment_id": 85563853, "body": "@Vityata Well, that was my first idea, but I have chosen current one, as it&#39;s slightly more memory-efficient (I know it&#39;s not the case)"}, {"owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "reply_to_user": {"reputation": 57, "user_id": 9476590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ROxCh.png?s=128&g=1", "display_name": "Charles", "link": "https://stackoverflow.com/users/9476590/charles"}, "edited": false, "score": 0, "creation_date": 1521038709, "post_id": 49279020, "comment_id": 85563916, "body": "@Charles You could try solution with <code>priority</code> instead of <code>-CInt(priority)</code>, then it would display <code>True</code> instead of one and <code>False</code> instead of zero if you&#39;d like."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1521038721, "post_id": 49279020, "comment_id": 85563932, "body": "@Micha\u0142Turczyn - what is slightly more memory-efficient? Declaring <code>boolean</code> instead of <code>Long</code>?"}, {"owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1521038749, "post_id": 49279020, "comment_id": 85563959, "body": "@Vityata Yes, i guess so, as it takes less space. Check out edited answet, is it better?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1521039918, "post_id": 49279020, "comment_id": 85564881, "body": "@Micha\u0142Turczyn - the space should be irrelevant, <code>long</code> is 32 bit and in all the Operation Systems after the last 20 years it is the native value - <a href=\"https://stackoverflow.com/questions/26409117/why-use-integer-instead-of-long\" title=\"why use integer instead of long\">stackoverflow.com/questions/26409117/&hellip;</a>. But actually the <code>Boolean</code> is slightly faster, tried some loops to see. The <code>Iif</code> is better to understand."}], "tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": true, "score": 2, "last_activity_date": 1521039010, "last_edit_date": 1521039010, "creation_date": 1521034078, "answer_id": 49279020, "question_id": 49277860, "link": "https://stackoverflow.com/questions/49277860/duplicate-rows-based-on-cell-content-and-identifying-primary-value/49279020#49279020", "title": "Duplicate rows based on cell content and identifying primary value", "body": "<p>Try this slight modification of your code, you'll have to declare additional variable <code>Dim priority As Boolean</code>:     </p>\n\n<pre><code>For rowIndex = 1 To lastRow\n    cValue = .Cells(rowIndex, targetColumn).Value 'getting the cell with semi-colon separated data\n    cArray = Split(cValue, \";\") 'splitting semi-colon separated data in an array\n    priority = True\n    For strIndex = 0 To UBound(cArray)\n        destRow = destRow + 1\n        destSheet.Cells(destRow, 1) = .Cells(rowIndex, 1)\n        destSheet.Cells(destRow, 2) = Trim(cArray(strIndex))\n        destSheet.Cells(destRow, 3) = .Cells(rowIndex, 3)\n        destSheet.Cells(destRow, 4) = IIf(priority, 1, 0)\n        priority = False\n    Next strIndex\nNext rowIndex\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1521038287, "last_edit_date": 1521038287, "creation_date": 1521037012, "answer_id": 49280044, "question_id": 49277860, "link": "https://stackoverflow.com/questions/49277860/duplicate-rows-based-on-cell-content-and-identifying-primary-value/49280044#49280044", "title": "Duplicate rows based on cell content and identifying primary value", "body": "<p>your whole sub can boil down to:</p>\n\n<pre><code>Sub SplitCell()\n    Dim vals As Variant\n    vals = ThisWorkbook.Worksheets(\"Sheet001\").Range(\"A1\").CurrentRegion.value\n\n    Dim iVal As Long\n    With ThisWorkbook.Worksheets(\"Sheet002\")\n        .Range(\"A1:C1\").value = Application.index(vals, 1, 0)\n        .Range(\"D1\").value = \"Primary\"\n        For iVal = 2 To UBound(vals)\n            With .Cells(.Rows.Count, 1).End(xlUp).Offset(1).Resize(UBound(Split(vals(iVal, 2) &amp; \",\", \",\")))\n                .Offset(, 0).value = vals(iVal, 1)\n                .Offset(, 1).value = Application.Transpose(Split(vals(iVal, 2) &amp; \",\", \",\"))\n                .Offset(, 2).value = vals(iVal, 3)\n                .Offset(, 3).value = Application.Transpose(Split(\"1,\" &amp; String(.Rows.Count - 1, \",\"), \",\"))\n            End With\n        Next\n        .Range(\"D1\", .Cells(.Rows.Count, 1).End(xlUp)).SpecialCells(xlCellTypeBlanks).value = 0\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 9476590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ROxCh.png?s=128&g=1", "display_name": "Charles", "link": "https://stackoverflow.com/users/9476590/charles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 49279020, "answer_count": 4, "score": 2, "last_activity_date": 1521039010, "creation_date": 1521030661, "last_edit_date": 1521031657, "question_id": 49277860, "link": "https://stackoverflow.com/questions/49277860/duplicate-rows-based-on-cell-content-and-identifying-primary-value", "title": "Duplicate rows based on cell content and identifying primary value", "body": "<p>I'm looking for exactly this operation:\n<a href=\"https://stackoverflow.com/questions/44732943/how-do-i-duplicate-rows-based-on-cell-contents-cell-contains-semi-colon-seperat\">How do I duplicate rows based on cell contents (cell contains semi-colon seperated data)</a></p>\n\n<p>But with an added column:\n<a href=\"https://i.stack.imgur.com/abhnv.jpg\" rel=\"nofollow noreferrer\">Starting table vs End result</a></p>\n\n<p>What I have:</p>\n\n<pre><code>| Name   | Size       | Photo   |\n|--------|------------|---------|\n| Tshirt | 10, 12, 14 | 144.jpg |\n| Jeans  | 30, 40, 42 | 209.jpg |\n| Dress  | 8          | 584.jpg |\n| Shoe   | 6          | 178.jpg |\n</code></pre>\n\n<p>What I would like:</p>\n\n<pre><code>| Name   | Size | Photo   | Primary |\n|--------|------|---------|---------|\n| Tshirt | 10   | 144.jpg | 1       |\n| Tshirt | 12   | 144.jpg | 0       |\n| Tshirt | 14   | 144.jpg | 0       |\n| Jeans  | 30   | 209.jpg | 1       |\n| Jeans  | 40   | 209.jpg | 0       |\n| Jeans  | 42   | 209.jpg | 0       |\n| Dress  | 8    | 584.jpg | 1       |\n| Shoe   | 6    | 178.jpg | 1       |\n</code></pre>\n\n<p>Right now the code I found works perfectly but I don't know how to add the \"Primary\" column.</p>\n\n<pre><code>Sub SplitCell()\nDim cArray As Variant\nDim cValue As String\nDim rowIndex As Integer, strIndex As Integer, destRow As Integer\nDim targetColumn As Integer\nDim lastRow As Long, lastCol As Long\nDim srcSheet As Worksheet, destSheet As Worksheet\n\ntargetColumn = 2 'column with semi-colon separated data\n\nSet srcSheet = ThisWorkbook.Worksheets(\"Sheet1\") 'sheet with data\nSet destSheet = ThisWorkbook.Worksheets(\"Sheet2\") 'sheet where result will be displayed\n\ndestRow = 0\nWith srcSheet\n    lastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    lastCol = .Cells(1, .Columns.Count).End(xlToLeft).Column\n    For rowIndex = 1 To lastRow\n        cValue = .Cells(rowIndex, targetColumn).Value 'getting the cell with semi-colon separated data\n        cArray = Split(cValue, \";\") 'splitting semi-colon separated data in an array\n        For strIndex = 0 To UBound(cArray)\n            destRow = destRow + 1\n            destSheet.Cells(destRow, 1) = .Cells(rowIndex, 1)\n            destSheet.Cells(destRow, 2) = Trim(cArray(strIndex))\n            destSheet.Cells(destRow, 3) = .Cells(rowIndex, 3)\n        Next strIndex\n    Next rowIndex\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Thanks for your help!</p>\n"}, {"tags": ["html", "css", "vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 131, "user_id": 9351236, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4403fbf5d15ea4a0c60a0325204fa820?s=128&d=identicon&r=PG&f=1", "display_name": "user9351236", "link": "https://stackoverflow.com/users/9351236/user9351236"}, "edited": false, "score": 0, "creation_date": 1521030463, "post_id": 49277727, "comment_id": 85557900, "body": "Thanks for your quick response, but it is not making the value BOLD."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "reply_to_user": {"reputation": 131, "user_id": 9351236, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4403fbf5d15ea4a0c60a0325204fa820?s=128&d=identicon&r=PG&f=1", "display_name": "user9351236", "link": "https://stackoverflow.com/users/9351236/user9351236"}, "edited": false, "score": 0, "creation_date": 1521030497, "post_id": 49277727, "comment_id": 85557922, "body": "Then you must have something overriding it."}, {"owner": {"reputation": 131, "user_id": 9351236, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4403fbf5d15ea4a0c60a0325204fa820?s=128&d=identicon&r=PG&f=1", "display_name": "user9351236", "link": "https://stackoverflow.com/users/9351236/user9351236"}, "edited": false, "score": 1, "creation_date": 1521030899, "post_id": 49277727, "comment_id": 85558210, "body": "Sorry. Its working fine. I made a mistake while copying it in my code. Thanks. :)"}], "tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": true, "score": 1, "last_activity_date": 1521041275, "last_edit_date": 1521041275, "creation_date": 1521030279, "answer_id": 49277727, "question_id": 49277702, "link": "https://stackoverflow.com/questions/49277702/format-text-in-outlook-mail-in-bold-and-all-caps/49277727#49277727", "title": "Format text in Outlook mail in bold and all caps", "body": "<p>This will make it <strong>bold</strong> and UPPER CASE:</p>\n\n<pre><code>.HTMLBody = \"Hello &lt;b&gt;\" &amp; UCase$(val1) &amp; \"&lt;/b&gt; Thanks\"\n</code></pre>\n\n<p>you could also use a stronger inline style</p>\n\n<pre><code>.HTMLBody = \"Hello &lt;span style='font-weight:bold !important;'&gt;\" &amp; UCase$(val1) &amp; \"&lt;/span&gt; Thanks\"\n</code></pre>\n\n<p>or if you wanted to do it all with an inline style:</p>\n\n<pre><code>.HTMLBody = \"Hello &lt;span style='font-weight:bold; text-transform:uppercase;'&gt;\" &amp; val1 &amp; \"&lt;/span&gt; Thanks\"\n</code></pre>\n"}], "owner": {"reputation": 131, "user_id": 9351236, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4403fbf5d15ea4a0c60a0325204fa820?s=128&d=identicon&r=PG&f=1", "display_name": "user9351236", "link": "https://stackoverflow.com/users/9351236/user9351236"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 299, "favorite_count": 0, "accepted_answer_id": 49277727, "answer_count": 1, "score": 1, "last_activity_date": 1521166414, "creation_date": 1521030180, "last_edit_date": 1531164843, "question_id": 49277702, "link": "https://stackoverflow.com/questions/49277702/format-text-in-outlook-mail-in-bold-and-all-caps", "title": "Format text in Outlook mail in bold and all caps", "body": "<p>I am taking values from Excel in a Do While loop, and each value is pasted in an Outlook mail every time the loop runs. I want to put that value in Outlook in <strong>BOLD</strong> font and also in CAPS.</p>\n\n<pre><code>Do until k = row_cnt \n    val1 = Worksheets(\"Sheet1\").Range(\"A\" &amp; k).Value\n    Set myApp = CreateObject(\"Outlook.Application\")\n    Set myItem = myApp.CreateItem(olMailItem)     \n    With myItem\n        .Subject = subj\n        .To = email_add\n        .HTMLBody = \"Hello \" &amp; val1 &amp; \"Thanks\"\n        .Display\n        '.send\n    End With\nLoop\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 6486, "user_id": 1116230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55a894894150db28d6641f0c57e48bac?s=128&d=identicon&r=PG", "display_name": "Nico Haase", "link": "https://stackoverflow.com/users/1116230/nico-haase"}, "edited": false, "score": 1, "creation_date": 1521030672, "post_id": 49277689, "comment_id": 85558057, "body": "What have you tried so far? If that is a simple text file, are you sure you want to solve this with Excel?"}, {"owner": {"reputation": 1, "user_id": 9491304, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rudra Pati", "link": "https://stackoverflow.com/users/9491304/rudra-pati"}, "reply_to_user": {"reputation": 6486, "user_id": 1116230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55a894894150db28d6641f0c57e48bac?s=128&d=identicon&r=PG", "display_name": "Nico Haase", "link": "https://stackoverflow.com/users/1116230/nico-haase"}, "edited": false, "score": 0, "creation_date": 1521032773, "post_id": 49277689, "comment_id": 85559492, "body": "It is actually a csv file. I thought easiest way to play with data is by moving data into excel. I tried few ways but didn&#39;t workout. I want to remove duplicates based on Col2 and want to keep the row where Col3 got highest value."}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 1, "creation_date": 1521042393, "post_id": 49277689, "comment_id": 85566777, "body": "Sort by Col C, Sort by Col B, &quot;Data&quot; &gt; &quot;Remove Duplicates&quot;?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9491304, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rudra Pati", "link": "https://stackoverflow.com/users/9491304/rudra-pati"}, "edited": false, "score": 0, "creation_date": 1521032719, "post_id": 49278050, "comment_id": 85559451, "body": "Thanks, I can bring all data into excel. Data file was huge(around 50K records), so I do not want to take a risk thinking excel will keep the first/last row after sorting. I will try anyway."}], "tags": [], "owner": {"reputation": 280, "user_id": 3260114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fe3577e2b0037362ccb927a3ec5be78?s=128&d=identicon&r=PG&f=1", "display_name": "acousticismX", "link": "https://stackoverflow.com/users/3260114/acousticismx"}, "is_accepted": false, "score": 0, "last_activity_date": 1521037914, "last_edit_date": 1521037914, "creation_date": 1521031207, "answer_id": 49278050, "question_id": 49277689, "link": "https://stackoverflow.com/questions/49277689/excel-formula-to-remove-duplicates-and-select-higher-value-row/49278050#49278050", "title": "excel formula to remove duplicates and select higher value row", "body": "<p>If you bring all your data into Excel, you can sort Col1 (from Z-A), and then remove duplicates on Col2.</p>\n\n<p>edit: sorry, meant sort on Col3.</p>\n"}, {"tags": [], "owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "is_accepted": true, "score": 0, "last_activity_date": 1521038120, "creation_date": 1521038120, "answer_id": 49280485, "question_id": 49277689, "link": "https://stackoverflow.com/questions/49277689/excel-formula-to-remove-duplicates-and-select-higher-value-row/49280485#49280485", "title": "excel formula to remove duplicates and select higher value row", "body": "<p>Try Pivot Tables. I grouped data by Col2 and Col1, and then added Col3 to values. Then applied filter TOP 1. This is what I get:</p>\n\n<p><a href=\"https://i.stack.imgur.com/CR9Je.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CR9Je.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>The only problem here is I changed columns position, but at least you get the values you want in seconds. After this, is just to copy and paste in other sheet with the column Order you want.</p>\n"}], "owner": {"reputation": 1, "user_id": 9491304, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rudra Pati", "link": "https://stackoverflow.com/users/9491304/rudra-pati"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 0, "accepted_answer_id": 49280485, "answer_count": 2, "score": -2, "last_activity_date": 1521038120, "creation_date": 1521030125, "last_edit_date": 1531161705, "question_id": 49277689, "link": "https://stackoverflow.com/questions/49277689/excel-formula-to-remove-duplicates-and-select-higher-value-row", "title": "excel formula to remove duplicates and select higher value row", "body": "<p>I have a text file(can be loaded into Excel) with three columns. I want to remove duplicate rows(by duplicate values in row-2) and keep the only one row where row-3 is higher value. For example the date is </p>\n\n<pre><code>Col1 Col2 Col3\nabcd 1111 1000 \nefgh 1111 1001 \nijkl 2222 1002 \nmnop 1111 1003 \nqrst 3333 1004 \nuvwx 1111 1005\nxwvu 2222 1006\n</code></pre>\n\n<p>I want following output</p>\n\n<pre><code>Col1 Col2 Col3 \nuvwx 1111 1005\nxwvu 2222 1006\nqrst 3333 1004\n</code></pre>\n\n<p>thanks a lot in advance. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "edited": false, "score": 0, "creation_date": 1521030207, "post_id": 49277539, "comment_id": 85557729, "body": "Works for me on Excel 2010 x64."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1521030902, "post_id": 49277539, "comment_id": 85558212, "body": "Try <code>Cells(1, 2).value =</code>"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1521031160, "post_id": 49277539, "comment_id": 85558407, "body": "<code>AscW</code> should not be used on Mac."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1521035212, "post_id": 49277539, "comment_id": 85561400, "body": "@PaulOgilvie  <i>Should not</i>, but can be (according to the help file).  The code works fine in Excel 2010. What value is in cell A1?  Is it on the Mac?"}, {"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 1, "creation_date": 1521036437, "post_id": 49277539, "comment_id": 85562354, "body": "Try with a full qualification: <code>Strings.AscW(Cells(1, 1).Value)</code>. I would get this error If I were to create a function named <code>AscW</code> in a module."}, {"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 0, "creation_date": 1521036512, "post_id": 49277539, "comment_id": 85562409, "body": "And just in case the cell is empty: <code>Strings.AscW(Cells(1, 1).Value &amp; vbNullChar)</code>"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1521036610, "post_id": 49277539, "comment_id": 85562494, "body": "Some weird regional setting (is there a Birmingham regional setting - cos, you know, it&#39;s Brum? :p )  Tried your code exactly as you&#39;ve entered (except for procedure heading) and it returned 120 in cell B1 for <code>x</code>.  Same as if I&#39;d added <code>=CODE(A1)</code>."}, {"owner": {"reputation": 732, "user_id": 385695, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/hhQ9j.png?s=128&g=1", "display_name": "PhilHibbs", "link": "https://stackoverflow.com/users/385695/philhibbs"}, "edited": false, "score": 0, "creation_date": 1521037808, "post_id": 49277539, "comment_id": 85563256, "body": "Thanks Florent B., can you make that into an answer so I can accept it as the solution? <code>Strings.AscW</code> did indeed fix it. Now the mystery is just &quot;why&quot;!"}, {"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 0, "creation_date": 1521039376, "post_id": 49277539, "comment_id": 85564443, "body": "@PhilHibbs, the fact that it&#39;s working could simply be because the VBA was recompiled (It could be a portability issue between 32 and 64 bits Excel). It would be far more interesting to know why this is happening. Though there&#39;s no way to confirm without a reproductible example."}, {"owner": {"reputation": 732, "user_id": 385695, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/hhQ9j.png?s=128&g=1", "display_name": "PhilHibbs", "link": "https://stackoverflow.com/users/385695/philhibbs"}, "edited": false, "score": 0, "creation_date": 1521042196, "post_id": 49277539, "comment_id": 85566620, "body": "I might be able to create a minimal test case and get permission to transfer it outside of the secure estate."}], "owner": {"reputation": 732, "user_id": 385695, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/hhQ9j.png?s=128&g=1", "display_name": "PhilHibbs", "link": "https://stackoverflow.com/users/385695/philhibbs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1521036294, "creation_date": 1521029678, "last_edit_date": 1521036294, "question_id": 49277539, "link": "https://stackoverflow.com/questions/49277539/why-does-ascw-give-a-compile-error-in-excel-2010", "title": "Why does AscW() give a Compile Error in Excel 2010?", "body": "<p>I'm trying to do this in Excel VBA:</p>\n\n<pre><code>Cells(1, 2) = AscW(Cells(1, 1).Value)\n</code></pre>\n\n<p>It works fine in Excel 12 (2007) and 16 (2016) on one of my machines (Windows 7 laptop), but the machine (Windows thin client, not sure the version but looks a bit like Windows 7) that has Excel 14 (2010) gives \"Compile error: Wrong number of arguments or invalid property assignment\".</p>\n\n<p>Any ideas? Is it the machine, a bug/feature in that version of Excel, or something else?</p>\n\n<p><em>Update</em> It seems to matter which machine the workbook was created on. They are both <code>.xlsm</code> files, but the one I created on the laptop works fine when I copy it onto the thin client. The workbook that I created on the thin client (actually, I received from someone else) has the problem. Both have the public sub in the worksheet's VBA code. Sadly I cannot transfer files in the other direction.</p>\n"}, {"tags": ["vba", "excel", "vlookup"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1521028731, "post_id": 49277144, "comment_id": 85556709, "body": "&quot;In a 2. Step I want my code to check the &quot;Register No.&quot; in Tabelle1 and copy only those rows from Tabelle3 to Tabelle1.&quot; - which rows?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1521029143, "post_id": 49277144, "comment_id": 85556986, "body": "So tabelle 1 already has register no&#39;s in it and you only want the data from tabelle 2 and 3 which match these?"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1521029236, "post_id": 49277144, "comment_id": 85557051, "body": "If you run down each row in &#39;Tabelle 2&#39;, then you can use <code>WorksheetFunction.Match</code> to check if the item is in &#39;Tabelle 3&#39;.  For example, <code>lRow=0:On Error Resume Next:lRow=WorksheetFunction.Match(&quot;Value&quot;, Sheet1.Columns(1),0):On Error GoTo 0</code> will set <code>lRow</code> to the row in Column <b>A</b> of Sheet1 that contains &quot;Value&quot;, or <code>0</code> if &quot;Value&quot; does not exist in Column <b>A</b> of <code>Sheet1</code>"}, {"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "edited": false, "score": 0, "creation_date": 1521029289, "post_id": 49277144, "comment_id": 85557094, "body": "Why exactly are you using <code>VLookup</code> to copy from <code>Tabelle2</code> to <code>Tabelle1</code>? It is searching for the same row, where you index <code>i</code> is already in. So its better to use one <code>For</code>-Loop and copy the columns with <code>.Cells(i, column)</code>. To Perfom the copy process from  <code>Tabelle3</code>, you can use a <code>VLookup</code>."}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1521029420, "post_id": 49277144, "comment_id": 85557178, "body": "(Also, this looks very much like a duplicate of <a href=\"https://stackoverflow.com/questions/49260060/consolidating-two-worksheets\">this question</a>?  It is much better written and easier to understand, but you should probably have <a href=\"https://stackoverflow.com/posts/49260060/edit\">edited</a> that question instead)"}], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1521033579, "post_id": 49277494, "comment_id": 85560072, "body": "why the 3 loops when you could use one?"}, {"owner": {"reputation": 721, "user_id": 7889129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0oYIA.jpg?s=128&g=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7889129/maddy"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1521033736, "post_id": 49277494, "comment_id": 85560198, "body": "yes but here I just used OP&#39;s code for this answer."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1521033824, "post_id": 49277494, "comment_id": 85560260, "body": ":-) I have used that answer myself too in the past."}, {"owner": {"reputation": 113, "user_id": 9456216, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ba5693829f4c7340e117d99a258fb421?s=128&d=identicon&r=PG&f=1", "display_name": "HPM", "link": "https://stackoverflow.com/users/9456216/hpm"}, "edited": false, "score": 0, "creation_date": 1521036732, "post_id": 49277494, "comment_id": 85562577, "body": "Thanks a lot @Maddy :) Funny thing is I still think my code, I used before, is the same as yours but somehow yours works. (So probably not so similiar at the end :D )"}], "tags": [], "owner": {"reputation": 721, "user_id": 7889129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0oYIA.jpg?s=128&g=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7889129/maddy"}, "is_accepted": true, "score": 0, "last_activity_date": 1521029486, "creation_date": 1521029486, "answer_id": 49277494, "question_id": 49277144, "link": "https://stackoverflow.com/questions/49277144/consolidating-two-sheets/49277494#49277494", "title": "Consolidating two sheets", "body": "<p>Try this</p>\n\n<pre><code>    Dim lastrow As Long\n    lastrow = Tabelle3.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    Set myrange = Tabelle3.UsedRange\n\n\n    For i = 2 To lastrow\n        Tabelle1.Cells(i, 3) = Application.WorksheetFunction.VLookup(Tabelle1.Cells(i, 1), myrange, 2, False)\n    Next i\n\n     For i = 2 To lastrow\n        Tabelle1.Cells(i, 4) = Application.WorksheetFunction.VLookup(Tabelle1.Cells(i, 1), myrange, 3, False)\n    Next i\n\n    For i = 2 To lastrow\n        Tabelle1.Cells(i, 5) = Application.WorksheetFunction.VLookup(Tabelle1.Cells(i, 1), myrange, 4, False)\n    Next i\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1521033633, "post_id": 49277501, "comment_id": 85560122, "body": "How on earth did you translate the question? Bravo"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1521033875, "post_id": 49277501, "comment_id": 85560308, "body": "@QHarr - :) thanks - in general this is a one of the standard cases when someone is using Excel as a database."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1521029534, "creation_date": 1521029534, "answer_id": 49277501, "question_id": 49277144, "link": "https://stackoverflow.com/questions/49277144/consolidating-two-sheets/49277501#49277501", "title": "Consolidating two sheets", "body": "<p>Let's make it really simple - put the three tables on the same worksheet like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/kiFK4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kiFK4.png\" alt=\"enter image description here\"></a></p>\n\n<p>The idea would be to get something like this, after running the code below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/1SrKY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1SrKY.png\" alt=\"enter image description here\"></a></p>\n\n<p>Probably the simplest way to achieve it with some bad practices as hard-coding is like this:</p>\n\n<pre><code>Public Sub TestMe()\n\n    Dim cnt             As Long\n    Dim combinedIndex   As Range\n    Dim currentCell     As Range\n\n    With Worksheets(1)\n        Set combinedIndex = .Range(\"A7:A12\")\n\n        'Fill table with names\n        For cnt = 2 To 5\n            Set currentCell = Nothing\n            Set currentCell = combinedIndex.Find(Cells(cnt, 1))\n            If Not currentCell Is Nothing Then\n                currentCell.Offset(0, 1) = .Cells(cnt, 2)\n            End If\n        Next cnt\n\n        'Fill table with Shoe Sizes\n        For cnt = 2 To 5\n            Set currentCell = Nothing\n            Set currentCell = combinedIndex.Find(Cells(cnt, 4))\n            If Not currentCell Is Nothing Then\n                currentCell.Offset(0, 2) = .Cells(cnt, 5)\n            End If\n        Next cnt\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>This is what the code does:</p>\n\n<ul>\n<li>Defines the <code>combinedIndex</code> range. In a more general case it can be <code>Worksheets(1).Range(\"A:A\")</code></li>\n<li>then loops through the table with the names. It is hardcoded from 2 to 5, but it can be loosened up a bit. Once a <code>RegisterN</code> is found, the second value is written to the offset of the found value</li>\n<li>the same is for the Shoe Sizes table</li>\n</ul>\n"}], "owner": {"reputation": 113, "user_id": 9456216, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ba5693829f4c7340e117d99a258fb421?s=128&d=identicon&r=PG&f=1", "display_name": "HPM", "link": "https://stackoverflow.com/users/9456216/hpm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 49277494, "answer_count": 2, "score": 0, "last_activity_date": 1521033294, "creation_date": 1521028385, "last_edit_date": 1521028913, "question_id": 49277144, "link": "https://stackoverflow.com/questions/49277144/consolidating-two-sheets", "title": "Consolidating two sheets", "body": "<p>I do have two different sheets (Tabelle2 &amp; Tabelle3) and I want to consolidate them  in a third one (Tabelle1) on basis of the Register No. </p>\n\n<p>To copy Tabelle2 into the correct columns in Tabelle1 I'm using VLookup which is working smooth. </p>\n\n<pre><code>Dim lastrow As Long\nlastrow = Tabelle2.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nSet myrange = Tabelle2.UsedRange\n\n\nFor i = 2 To lastrow\n    Tabelle1.Cells(i, 1) = Application.WorksheetFunction.VLookup(Tabelle2.Cells(i, 1), myrange, 1, False)\nNext i\n\n For i = 2 To lastrow\n    Tabelle1.Cells(i, 2) = Application.WorksheetFunction.VLookup(Tabelle2.Cells(i, 1), myrange, 2, False)\nNext i\n\nFor i = 2 To lastrow\n    Tabelle1.Cells(i, 6) = Application.WorksheetFunction.VLookup(Tabelle2.Cells(i, 1), myrange, 3, False)\nNext i\n</code></pre>\n\n<p>In a 2. Step I want my code to check the \"Register No.\" in Tabelle1 and copy only those rows from  Tabelle3 to Tabelle1. <em>Note: Tabelle3 is containing many more \"Register No.\" which data I don't need</em></p>\n\n<p>Does anyone know which function to use or how to solve this challange? :) </p>\n\n<p><a href=\"https://i.stack.imgur.com/hTtFn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hTtFn.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["string", "vba", "excel", "vlookup"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1521028300, "post_id": 49276781, "comment_id": 85556398, "body": "This looks wrong...combinedWorbookSheet1  not only because of the missing k but also how you are joining Workbook with Sheet."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1521030809, "post_id": 49276781, "comment_id": 85558149, "body": "8 Columns back from M is E.  This whole section makes no sense to me:  I then need it to drag the vlookup down to the bottom row of data (using column M in the masterfile as a reference to when the data ends) with cell I15 being the starting point for the vlookup in the masterfile."}], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 6266517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08355bfbde8a176f1c493569c93c8e83?s=128&d=identicon&r=PG&f=1", "display_name": "G. Jonathan", "link": "https://stackoverflow.com/users/6266517/g-jonathan"}, "is_accepted": false, "score": 0, "last_activity_date": 1521029553, "creation_date": 1521029553, "answer_id": 49277507, "question_id": 49276781, "link": "https://stackoverflow.com/questions/49276781/vlookup-from-another-workbook-with-fill-to-last-row/49277507#49277507", "title": "Vlookup from Another Workbook with fill to Last Row", "body": "<p>As I understood you need to apply a vlookup formula in your master file gathering data from another workbook.</p>\n\n<p>The proper strucutre is as followed:\nActiveCell.FormulaR1C1 = \"=VLOOKUP(<strong>RC[8]</strong>,[Book1]Sheet1!<strong>R1C5:R23C6</strong>,2,FALSE)\"</p>\n\n<p>The first bold text is the place of the value you are looking for, relative to the active cell.</p>\n\n<p>The second bold text is the position of your reference table in your other workbook ( here it is book 1).</p>\n\n<p>You can apply this formula to your masterfile by using a loop.</p>\n\n<pre><code>Dim lastRow as Integer\nlastRow = ActiveSheet.Cells(ActiveSheet.Rows.Count, \"M\").End(xlUp).Row\nendCount = 15 + lastRow\nFor i = 15 to endCount\nActiveSheet.Cells(i,13).FormulaR1C1 = \"=VLOOKUP(RC[-8],[combinedWorkbook]Sheet1!R1C1:R700000C2,2,FALSE)\"\nnext i\n</code></pre>\n\n<p>This will apply the vlookup formula in the column I starting row 15 searching for the value in the same row but 8 column before (column \"A\") and will apply for as many row as there are value in the column M.</p>\n"}, {"comments": [{"owner": {"reputation": 59, "user_id": 9479664, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rodge95", "link": "https://stackoverflow.com/users/9479664/rodge95"}, "edited": false, "score": 1, "creation_date": 1521034472, "post_id": 49278134, "comment_id": 85560766, "body": "That works like an absolute dream. Thank you for the tips as well, I will keep them in mind going forward - all good learning."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 59, "user_id": 9479664, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rodge95", "link": "https://stackoverflow.com/users/9479664/rodge95"}, "edited": false, "score": 0, "creation_date": 1521034961, "post_id": 49278134, "comment_id": 85561182, "body": "Lol. Not a problem. You can also upvote helpful answers by clicking the up pointing triangle but you need x number of rep point for that and I am not sure how many that is."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1521032007, "last_edit_date": 1521032007, "creation_date": 1521031492, "answer_id": 49278134, "question_id": 49276781, "link": "https://stackoverflow.com/questions/49276781/vlookup-from-another-workbook-with-fill-to-last-row/49278134#49278134", "title": "Vlookup from Another Workbook with fill to Last Row", "body": "<p>There are simply too many unknowns in your code to give a specific answer.</p>\n\n<p>Some observations:</p>\n\n<p>1) Always use <code>Option Explicit</code> at the top of your code, it will pick up mistakes and inconsistencies for you.</p>\n\n<p>2) Watch out for unused variables declared in your code</p>\n\n<p>3) Always specify which workbook and worksheet you are working with; don't just put <code>Range</code> ... or <code>Cells</code>.... this leads to all sorts of bugs.</p>\n\n<p>4) Your <code>VLOOKUP</code> syntax for working with another workbook needs to be of the order</p>\n\n<pre><code>'[\" &amp; combinedWorkbook.Name &amp; \"]Sheet1'\n</code></pre>\n\n<p>5) xlsx are not text files btw re: your filter </p>\n\n<p>6) For the rest i.e. where you want formulas to go, how you are determining last row etc I am just having to guess. Be specific when coding and try bullet pointing pseudo code first so you are clear what is going on at each stage.</p>\n\n<pre><code>Option Explicit\nSub test()\n\n    Dim filter As String\n    Dim caption As String\n    Dim combinedFilename As String\n    Dim combinedWorkbook As Workbook\n    Dim targetWorkbook As Workbook\n\n    MsgBox \"Select Unpaid Capital Extract\"\n\n    Set targetWorkbook = ThisWorkbook\n\n    filter = \"Text files (*.xlsx),*.xlsx\"\n    caption = \"Please Select an input file\"\n    combinedFilename = Application.GetOpenFilename(filter, , caption)\n\n    Set combinedWorkbook = Application.Workbooks.Open(combinedFilename)\n\n    'Assuming M is used to find last row in targetWorkbook\n    Dim lastRow As Long\n\n    With targetWorkbook.Worksheets(\"Sheet1\") 'this wasn't specified (specify appropriate sheet name)\n\n        lastRow = .Cells(.Rows.Count, \"M\").End(xlUp).Row\n\n         'Assuming I is where formula is being put\n        .Range(\"I15:I\" &amp; lastRow).FormulaR1C1 = _\n                           \"=VLOOKUP(RC[-8],'[\" &amp; combinedWorkbook.Name &amp; \"]Sheet1'!R1C1:R700000C2,2,0)\"\n\n        combinedWorkbook.Close False\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 9479664, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rodge95", "link": "https://stackoverflow.com/users/9479664/rodge95"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 735, "favorite_count": 0, "accepted_answer_id": 49278134, "answer_count": 2, "score": 0, "last_activity_date": 1521032007, "creation_date": 1521027383, "last_edit_date": 1521029690, "question_id": 49276781, "link": "https://stackoverflow.com/questions/49276781/vlookup-from-another-workbook-with-fill-to-last-row", "title": "Vlookup from Another Workbook with fill to Last Row", "body": "<p>I'm looking to import data from another file (combinedWorkbook) to my master file (the file which is running the code) using a vlookup. I then need it to drag the vlookup down to the bottom row of data (using column M in the masterfile as a reference to when the data ends) with cell I15 being the starting point for the vlookup in the masterfile.</p>\n\n<p>The problem I'm having is that when running the macro the vlookup is happening in cell M10 in my masterfile, not dragging down the vlookup to the end of the data and not referencing the combinedWorkbook.</p>\n\n<p>Any help would be appreciated.</p>\n\n<p>This is what I got so far</p>\n\n<pre><code>Dim combinedBook As Workbook\nDim filter As String\nDim caption As String\nDim combinedFilename As String\nDim combinedWorkbook As Workbook\nDim targetWorkbook As Workbook\n\nMsgBox (\"Select Unpaid Capital Extract\")\n\nSet targetWorkbook = ThisWorkbook\n\nfilter = \"Text files (*.xlsx),*.xlsx\"\ncaption = \"Please Select an input file\"\ncombinedFilename = Application.GetOpenFilename(filter, , caption)\n\nSet combinedWorkbook = Application.Workbooks.Open(combinedFilename)\n\nThisWorkbook.Activate\nActiveCell.FormulaR1C1 = _\n    \"=VLOOKUP(RC[-8],combinedWorbookSheet1!R1C1:R700000C2,2,0)\"\nRange(\"M16\").Select\nSelection.End(xlDown).Select\nRange(Selection, Selection.End(xlUp)).Select\nRange(\"I15:I60297\").Select\nRange(\"I60297\").Activate\nSelection.FillDown\nRange(\"I15\").Select\nRange(Selection, Selection.End(xlDown)).Select\nSelection.Copy\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nApplication.CutCopyMode = False\nSelection.End(xlUp).Select\nRange(\"I15\").Select\n\ncombinedWorkbook.Close False\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1521025882, "post_id": 49276158, "comment_id": 85554769, "body": "Of course there is not one <code>.Value</code> for multiple cells <code>H2:H7</code> but multiple values. Therefore you will need to test each value on its own in a loop. And you need to decide if <b>all</b> of the cells need to meet the <code>If</code> criteria or only one of them."}], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1521026862, "last_edit_date": 1521026862, "creation_date": 1521026388, "answer_id": 49276422, "question_id": 49276158, "link": "https://stackoverflow.com/questions/49276158/unable-to-select-a-range-of-cell/49276422#49276422", "title": "Unable to select a range of cell", "body": "<p>Of course there is not one <code>.Value</code> for multiple cells <code>H2:H7</code> but multiple values. </p>\n\n<p>Therefore you will need to test each value on its own in a loop. And you need to decide if all of the cells need to meet the If criteria or only one of them. </p>\n\n<p>This is an Example for a massage box whenever a value in the range <code>H2:H7</code> is <code>00:15:00</code>.<br>\nNote that this runs on every change of <strong>any</strong> cell.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    Dim c As Range\n    For Each c In Range(\"H2:H7\")\n        If Format$(c.Value, \"HH:MM:SS\") = \"00:15:00\" Then\n            MsgBox \"Block 3 ends in 15 mins\"\n        End If\n    Next c\nEnd Sub\n</code></pre>\n\n<p>If you want that only to run when a cell in <code>Range(\"H2:H7\")</code> is changed use</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Target, Range(\"H2:H7\")) Is Nothing Then\n        Dim c As Range\n        For Each c In Range(\"H2:H7\")\n            If Format$(c.Value, \"HH:MM:SS\") = \"00:15:00\" Then\n                MsgBox \"Block 3 ends in 15 mins\"\n            End If\n        Next c\n    End If\nEnd Sub\n</code></pre>\n\n<p>If you want to test only the changed cell (not the whole range) use</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Target, Range(\"H2:H7\")) Is Nothing Then\n        If Format$(Target.Value, \"HH:MM:SS\") = \"00:15:00\" Then\n            MsgBox \"Block 3 ends in 15 mins\"\n        End If\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 9490960, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Xu6H1mpHCJc/AAAAAAAAAAI/AAAAAAAAALc/N_wAhvoMJK8/photo.jpg?sz=128", "display_name": "Jackie Chua", "link": "https://stackoverflow.com/users/9490960/jackie-chua"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "accepted_answer_id": 49276422, "answer_count": 1, "score": 1, "last_activity_date": 1521026862, "creation_date": 1521025690, "last_edit_date": 1531161705, "question_id": 49276158, "link": "https://stackoverflow.com/questions/49276158/unable-to-select-a-range-of-cell", "title": "Unable to select a range of cell", "body": "<p>I am new to here so I'm not sure the rules that well. I currently stumbling at a code that I can't seem to know the problem.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Format(Range(\"H4\").Value, \"HH:MM:SS\") = \"00:15:00\" Then\n        MsgBox \"Block 3 ends in 15 mins\"             \n    End If\nEnd Sub\n</code></pre>\n\n<p>The code is able to handle a single cell but when I change the cell \"H4\" to \"H2:H7\" it will not work.\nPlease help and thank you for the advance.</p>\n"}, {"tags": ["vba", "excel", "excel-formula", "transpose"], "comments": [{"owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1521025874, "post_id": 49276108, "comment_id": 85554762, "body": "Would it be possible for you to load this data into Access?  There is a fairly straightforward canonical query which can be used to generate the output you want in SQL.  Also, I think this can be done with pivot tables, I just don&#39;t know how."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1521027665, "post_id": 49276108, "comment_id": 85555988, "body": "If you have Excel 2010 /2013, you can use <code>Power Query</code> (a free MS add-in) or, in 2016 <code>Data--&gt;Get &amp; Transform</code> to &quot;Pivot&quot; on the <code>Attribute Name</code> column and choose <code>Do not aggregate</code> for the values"}], "answers": [{"tags": [], "owner": {"reputation": 1079, "user_id": 6827197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/445d726384a840c085144bdced116a32?s=128&d=identicon&r=PG&f=1", "display_name": "a-burge", "link": "https://stackoverflow.com/users/6827197/a-burge"}, "is_accepted": false, "score": 0, "last_activity_date": 1521027281, "creation_date": 1521027281, "answer_id": 49276749, "question_id": 49276108, "link": "https://stackoverflow.com/questions/49276108/excel-transpose-data-from-multiple-rows-to-single-column-with-matched-value/49276749#49276749", "title": "Excel - Transpose data from multiple rows to single column with matched value", "body": "<p>You could do this using a helper column and then match it using index + match. Not as simple as you thought, but does work.</p>\n\n<p>1) Add helper column to your data (call it 'Helper'). <code>=concat(SKU,'Attribute Name')</code></p>\n\n<p>2) Use a pivot to get a unique list of SKUs in the rows so that it's easy to update once the data changes. (I'm assuming this is in column A and values start at row 4).</p>\n\n<p>3) Use another pivot to get a unique list of Attributes in the columns next to the other pivot. Then you have the structure of your results. (I'm assuming the first value is in B3). </p>\n\n<p>4) Index match the values of the table <code>=index('Attribute Value', match(concat($A4,B$3),'Helper',0))</code></p>\n\n<p>Note though that this only works when each combination of SKU and Attribute is unique.</p>\n"}, {"comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1521028298, "post_id": 49276866, "comment_id": 85556395, "body": "I&#39;ve found, in 2016, that the <i>null</i> is truly null. When I close out the query, the worksheet has empty cells in those spots."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1521028366, "post_id": 49276866, "comment_id": 85556445, "body": "That is the idea isn&#39;t it? Apologies, can&#39;t help but feel I am missing something here :-("}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1521028416, "post_id": 49276866, "comment_id": 85556486, "body": "I think you can omit your step above of replacing <i>null</i> with nothing"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1521028437, "post_id": 49276866, "comment_id": 85556503, "body": "Doh! Thanks I get it now."}, {"owner": {"reputation": 123, "user_id": 4485831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ANyP1.jpg?s=128&g=1", "display_name": "JamesAllwood", "link": "https://stackoverflow.com/users/4485831/jamesallwood"}, "edited": false, "score": 0, "creation_date": 1521028838, "post_id": 49276866, "comment_id": 85556781, "body": "@QHarr you&#39;re a lifesaver! Thanks so much for your help. I knew there must be a solution for this. Initially I was a bit lost as I couldn&#39;t find that option, but looks like it&#39;s not included in the Mac version, so switched over to my PC and found it there. Amazing stuff. Thanks again!"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1521028885, "post_id": 49276866, "comment_id": 85556807, "body": "No worries. PowerQuery can be very nifty especially for file operations."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 3, "last_activity_date": 1521028635, "last_edit_date": 1521028635, "creation_date": 1521027625, "answer_id": 49276866, "question_id": 49276108, "link": "https://stackoverflow.com/questions/49276108/excel-transpose-data-from-multiple-rows-to-single-column-with-matched-value/49276866#49276866", "title": "Excel - Transpose data from multiple rows to single column with matched value", "body": "<p>You can do this in \u03365\u0336 \u0336s\u0336t\u0336e\u0336p\u0336s\u0336   4 steps with Powerquery. This is in-built for 2016 and a free add-in from Microsoft from 2013 on wards ( or 2010 Professional Plus with Software Assurance). See info <a href=\"https://www.microsoft.com/en-gb/download/details.aspx?id=39379\" rel=\"nofollow noreferrer\">https://www.microsoft.com/en-gb/download/details.aspx?id=39379</a></p>\n\n<p>The advantage is you can easily add rows to the source and simply refresh the query.</p>\n\n<p>1) You select any cell in the range, then in 2016 Get &amp; Transform tab, earlier version use the Powerquery tab, select data from table. A window will pop up with your range of data in:</p>\n\n<p><a href=\"https://i.stack.imgur.com/9HuEJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9HuEJ.png\" alt=\"Step 1\"></a></p>\n\n<p>2) Transform > Pivot column >  Attribute Name column for Attribute Value  in Values Column (used advanced options to select \"Don't aggregate\")</p>\n\n<p><a href=\"https://i.stack.imgur.com/Ao7yv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ao7yv.png\" alt=\"Pivot\"></a></p>\n\n<p>3) Drag columns around to desired arrangement</p>\n\n<p><a href=\"https://i.stack.imgur.com/GxxYm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GxxYm.png\" alt=\"Column order\"></a></p>\n\n<p>4) Home > Close and load to sheet</p>\n\n<p>Here is a version without the column re-ordering</p>\n\n<p><a href=\"https://i.stack.imgur.com/y2vUh.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/y2vUh.gif\" alt=\"Image\"></a></p>\n\n<p>Edit:</p>\n\n<p>Thanks to @Ron Rosenfeld for reminding me that truly <em>null</em> values don't need replacing with blanks as they will appear as blanks when written to the sheet.</p>\n\n<p>So this step was removed:</p>\n\n<p>4) Highlight columns to replace nulls in and go to transform > replace values > and </p>\n\n<p>Value to Find: null </p>\n\n<p>Replace With: </p>\n\n<p><a href=\"https://i.stack.imgur.com/czNFt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/czNFt.png\" alt=\"Find and replace nulls\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1521031690, "last_edit_date": 1521031690, "creation_date": 1521031101, "answer_id": 49278014, "question_id": 49276108, "link": "https://stackoverflow.com/questions/49276108/excel-transpose-data-from-multiple-rows-to-single-column-with-matched-value/49278014#49278014", "title": "Excel - Transpose data from multiple rows to single column with matched value", "body": "<p>This assumes that the data is in columns <strong>A</strong> through <strong>C</strong>:</p>\n\n<pre><code>Sub croupier()\n    Dim i As Long, N As Long, vA As String, vB As String, vC As String\n    Dim rw As Long, cl As Long\n\n'                   setup column headers\n\n    Columns(2).SpecialCells(2).Offset(1).Copy Range(\"D1\")\n    Columns(4).RemoveDuplicates Columns:=1, Header:=xlNo\n    Columns(4).SpecialCells(2).Copy\n    Range(\"E1\").PasteSpecial Transpose:=True\n    Columns(4).SpecialCells(2).Clear\n\n'                   setup row headers\n\n    Columns(1).SpecialCells(2).Copy Range(\"D1\")\n    Columns(4).RemoveDuplicates Columns:=1, Header:=xlYes\n\n'                    deal the data\n\n    N = Cells(Rows.Count, \"A\").End(xlUp).Row\n    For i = 2 To N\n        vA = Cells(i, 1)\n        vB = Cells(i, 2)\n        vC = Cells(i, 3)\n        cl = Rows(1).Find(what:=vB, after:=Range(\"A1\")).Column\n        rw = Columns(4).Find(what:=vA, after:=Range(\"D1\")).Row\n        Cells(rw, cl) = vC\n    Next i\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/09C67.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/09C67.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 123, "user_id": 4485831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ANyP1.jpg?s=128&g=1", "display_name": "JamesAllwood", "link": "https://stackoverflow.com/users/4485831/jamesallwood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1253, "favorite_count": 1, "accepted_answer_id": 49276866, "answer_count": 3, "score": 0, "last_activity_date": 1537762886, "creation_date": 1521025536, "last_edit_date": 1537762886, "question_id": 49276108, "link": "https://stackoverflow.com/questions/49276108/excel-transpose-data-from-multiple-rows-to-single-column-with-matched-value", "title": "Excel - Transpose data from multiple rows to single column with matched value", "body": "<p>Ok, so I have some data that I want to convert from multiple rows to multiple columns.</p>\n\n<p>My input data looks loosely like this - </p>\n\n<pre><code>+----------+----------------+-----------------+\n|   SKU    | Attribute Name | Attribute Value |\n+----------+----------------+-----------------+\n| Product1 | Colour         | Black           |\n| Product1 | Size           | Large           |\n| Product1 | Height         | 20cm            |\n| Product1 | Width          | 40cm            |\n| Product2 | Colour         | Red             |\n| Product2 | Width          | 30cm            |\n| Product2 | Size           | Large           |\n| Product3 | Height         | 25cm            |\n| Product3 | Width          | 30cm            |\n| Product3 | Length         | 90cm            |\n| Product3 | Weight         | 5kg             |\n| Product3 | Size           | Large           |\n| Product3 | Colour         | Blue            |\n+----------+----------------+-----------------+\n</code></pre>\n\n<p>What I want to achieve is an output like this - </p>\n\n<pre><code>+----------+--------+--------+--------+-------+--------+-------+\n|   SKU    | Colour | Height | Length | Size  | Weight | Width |\n+----------+--------+--------+--------+-------+--------+-------+\n| Product1 | Black  | 20cm   |        | Large |        | 40cm  |\n| Product2 | Red    |        |        | Large |        | 30cm  |\n| Product3 | Blue   | 25cm   | 90cm   | Large | 5kg    | 30cm  |\n+----------+--------+--------+--------+-------+--------+-------+\n</code></pre>\n\n<p>I've tried Pivot tables, but you can only return numeric values, rather than the text values I'm looking for.</p>\n\n<p>I know I could probably achieve it using a number of step looking up values and filling them, but I feel like there should be a more simplistic way to achieve this. Maybe it's something better achieved in database rather than a spreadsheet.</p>\n\n<p>Any help would be very much appreciated.</p>\n"}, {"tags": ["excel", "notepad++", "vba"], "answers": [{"tags": [], "owner": {"reputation": 23, "user_id": 9322428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/463fa2bbb8b87f80f5e6ce5d1c7b8cff?s=128&d=identicon&r=PG&f=1", "display_name": "Mitch", "link": "https://stackoverflow.com/users/9322428/mitch"}, "is_accepted": false, "score": 0, "last_activity_date": 1521039667, "creation_date": 1521039667, "answer_id": 49281072, "question_id": 49275850, "link": "https://stackoverflow.com/questions/49275850/move-second-line-to-end-of-third-line-notepad/49281072#49281072", "title": "Move second line to end of third line // notepad++", "body": "<p>Alright, sometimes a bit of time brings ideas :)</p>\n\n<p>I just imported the txt-file in Excel so row 1 is \"Printer1\" and row 2 is \"/900\" and so on.\nThen I just made like this:</p>\n\n<pre><code>B1 =A1\nB2 =A3&amp;A2\nB3 =empty\n</code></pre>\n\n<p>Then i just marked B1 to B3 and dragged it with pressed ctrl key until the end of the file. Et voil\u00e0 I have what i need. Now i just will copy column B to new txt-file and everything is fine :)</p>\n"}, {"tags": [], "owner": {"reputation": 82895, "user_id": 372239, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/2twLb.jpg?s=128&g=1", "display_name": "Toto", "link": "https://stackoverflow.com/users/372239/toto"}, "is_accepted": false, "score": 0, "last_activity_date": 1521040349, "creation_date": 1521040349, "answer_id": 49281359, "question_id": 49275850, "link": "https://stackoverflow.com/questions/49275850/move-second-line-to-end-of-third-line-notepad/49281359#49281359", "title": "Move second line to end of third line // notepad++", "body": "<ul>\n<li><kbd>Ctrl</kbd>+<kbd>H</kbd></li>\n<li>Find what: <code>^.+\\R\\K(.+\\R)(.+\\R)</code></li>\n<li>Replace with: <code>$2$1</code></li>\n<li><em>check Wrap around</em></li>\n<li><em>check Regular expression</em></li>\n<li><em>DO NOT CHECK <code>. matches newline</code></em></li>\n<li><kbd>Replace all</kbd></li>\n</ul>\n\n<p><strong>Explanation:</strong></p>\n\n<pre><code>^           : beginning of line\n  .+        : 1 or more any character but newline (ie. the first line)\n  \\K        : forget all we have seen until this position\n  (.+\\R)    : Group 1, 1 or more any character followed by linebreak (ie. the second line)\n  (.+\\R)    : Group 2, 1 or more any character followed by linebreak (ie. the third line)\n</code></pre>\n\n<p><strong>Replacement:</strong></p>\n\n<pre><code>$2      : content of group 2\n$1      : content of group 1\n</code></pre>\n\n<p><strong>Result for given example:</strong></p>\n\n<pre><code>Printer1\nHBA/8/7\n/900\nPrinter2\nHBA/7/2\n/800\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 9322428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/463fa2bbb8b87f80f5e6ce5d1c7b8cff?s=128&d=identicon&r=PG&f=1", "display_name": "Mitch", "link": "https://stackoverflow.com/users/9322428/mitch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1521040349, "creation_date": 1521024854, "last_edit_date": 1531161705, "question_id": 49275850, "link": "https://stackoverflow.com/questions/49275850/move-second-line-to-end-of-third-line-notepad", "title": "Move second line to end of third line // notepad++", "body": "<p>I have the following txt-file containing a block of three lines and repeating (4000 lines total):</p>\n\n<pre><code>Printer1\n/900\nHBA/8/7\nPrinter2\n/800\nHBA/7/2\n</code></pre>\n\n<p>Now I would like to move the second line to the end of the third line and then repeat (5th line to end of 6th; 8th line to end of 9th and so on)</p>\n\n<p>Any chance this can be done with notepad++? Or maybe Excel macro? I found some examples with regex and vmi but the problem is they were looking for keywords. I would just like to have the whole 2nd line moved to end of 3rd... and then continue the pattern (5th->6th; 8th->9th)</p>\n\n<p>Any input/idea/solution is deeply appreciated.</p>\n\n<p>Kind regards</p>\n\n<p>Mitch</p>\n"}, {"tags": ["sql-server", "ms-access", "vba"], "comments": [{"owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "edited": false, "score": 0, "creation_date": 1521024878, "post_id": 49275695, "comment_id": 85554011, "body": "Try to replace <code>!</code> by <code>.</code> in <code>Count([OpenPosition]![Close Date])</code>"}, {"owner": {"reputation": 263, "user_id": 7287101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b6daec2ed63bcef584ed1a87003d98a?s=128&d=identicon&r=PG&f=1", "display_name": "Sandra ", "link": "https://stackoverflow.com/users/7287101/sandra"}, "reply_to_user": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "edited": false, "score": 0, "creation_date": 1521029123, "post_id": 49275695, "comment_id": 85556972, "body": "Hi Sergey,  Thank you. The code is working as it is but I want to add a filter on Remaining"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3728595"}, "edited": false, "score": 0, "creation_date": 1521036547, "post_id": 49275695, "comment_id": 85562433, "body": "You cannot calculate a field in a <code>SELECT</code> list and use the name of that field later in the same <code>SELECT</code> list. Instead of <code>[Opened]-[Closed] AS Remaining</code> try using <code>Positions.Openings - Count([OpenPosition]![Close Date]) AS Remaining</code>."}], "answers": [{"tags": [], "owner": {"reputation": 263, "user_id": 7287101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b6daec2ed63bcef584ed1a87003d98a?s=128&d=identicon&r=PG&f=1", "display_name": "Sandra ", "link": "https://stackoverflow.com/users/7287101/sandra"}, "is_accepted": false, "score": 1, "last_activity_date": 1521185324, "creation_date": 1521185324, "answer_id": 49315240, "question_id": 49275695, "link": "https://stackoverflow.com/questions/49275695/count-calculated-field-in-query-access/49315240#49315240", "title": "count calculated field in query access", "body": "<p>Thank you, @user3728595, it works perfectly.\nThe final script is </p>\n\n<pre><code> SELECT Positions.[Req #], tblPositionList.PositionName, Positions.[Opening \n    Date], Positions.[Close Date], Positions.Status, Count([OpenPosition]![Close \n    Date]) AS Closed, Positions.Openings AS Opened, Positions.Openings-\n    Count([OpenPosition]![Close Date]) AS Remaining\n    FROM tblPositionList INNER JOIN (Positions INNER JOIN OpenPosition ON \n    Positions.[Req #] = OpenPosition.[Req #]) ON (tblPositionList.PositionID = \n    Positions.PositionID) AND (tblPositionList.PositionID = \n    OpenPosition.PositionID)\n    GROUP BY Positions.[Req #], tblPositionList.PositionName, Positions.[Opening \n    Date], Positions.[Close Date], Positions.Status, Positions.Openings\n    HAVING (((Positions.Openings-Count([OpenPosition]![Close Date]))&gt;0));\n</code></pre>\n"}], "owner": {"reputation": 263, "user_id": 7287101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b6daec2ed63bcef584ed1a87003d98a?s=128&d=identicon&r=PG&f=1", "display_name": "Sandra ", "link": "https://stackoverflow.com/users/7287101/sandra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1521185324, "creation_date": 1521024424, "last_edit_date": 1521029817, "question_id": 49275695, "link": "https://stackoverflow.com/questions/49275695/count-calculated-field-in-query-access", "title": "count calculated field in query access", "body": "<p>I have a query where I want to calculate the open position - close (count the closed rows in another table) and to exclude all the 0 results</p>\n\n<pre><code>SELECT Positions.[Req #], tblPositionList.PositionName, \n       Positions.[Opening Date], Positions.[Close Date], \n       Positions.Status, Count([OpenPosition]![Close Date]) AS Closed,\n       Positions.Openings AS Opened, [Opened]-[Closed] AS Remaining\nFROM tblPositionList INNER JOIN (\n       Positions INNER JOIN OpenPosition ON Positions.[Req #] = OpenPosition.[Req #]) \nON (tblPositionList.PositionID = Positions.PositionID) AND\n   (tblPositionList.PositionID = OpenPosition.PositionID)\nGROUP BY Positions.[Req #], tblPositionList.PositionName, Positions.[Opening Date], \n         Positions.[Close Date], Positions.Status, Positions.Openings;\n</code></pre>\n\n<p>I want to add a filter to Remaining field.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 9465829, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-0NGStmju7JI/AAAAAAAAAAI/AAAAAAAAARU/cfEWDeznnOo/photo.jpg?sz=128", "display_name": "Batyr Nazarov", "link": "https://stackoverflow.com/users/9465829/batyr-nazarov"}, "edited": false, "score": 0, "creation_date": 1521027547, "post_id": 49276173, "comment_id": 85555926, "body": "It gives an error message saying Reference is invalid when I run it"}, {"owner": {"reputation": 51, "user_id": 9465829, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-0NGStmju7JI/AAAAAAAAAAI/AAAAAAAAARU/cfEWDeznnOo/photo.jpg?sz=128", "display_name": "Batyr Nazarov", "link": "https://stackoverflow.com/users/9465829/batyr-nazarov"}, "edited": false, "score": 0, "creation_date": 1521037305, "post_id": 49276173, "comment_id": 85562923, "body": "Thanks SJR I will try to do it"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 0, "last_activity_date": 1521025730, "creation_date": 1521025730, "answer_id": 49276173, "question_id": 49275618, "link": "https://stackoverflow.com/questions/49275618/changing-source-of-pivot-table/49276173#49276173", "title": "Changing source of Pivot Table", "body": "<p>See if this works. The source must be a string and include the sheet name, and you are referring to a pre-existing PT, hence the use of ChangePivotCache.</p>\n\n<pre><code>shTotalsPivot.PivotTables(1).ChangePivotCache _\n    ThisWorkbook.PivotCaches.Create( _\n    SourceType:=xlDatabase, _\n    SourceData:=ActiveSheet.Name &amp; \"!\" &amp; rng.Address(True, True, xlR1C1, True))\nshTotalsPivot.PivotTables(1).refresh\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 51, "user_id": 9465829, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-0NGStmju7JI/AAAAAAAAAAI/AAAAAAAAARU/cfEWDeznnOo/photo.jpg?sz=128", "display_name": "Batyr Nazarov", "link": "https://stackoverflow.com/users/9465829/batyr-nazarov"}, "edited": false, "score": 0, "creation_date": 1521035699, "post_id": 49278164, "comment_id": 85561774, "body": "@BatyrNazarov try edited code, see what you get in the <code>Debug.Print</code> line"}, {"owner": {"reputation": 51, "user_id": 9465829, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-0NGStmju7JI/AAAAAAAAAAI/AAAAAAAAARU/cfEWDeznnOo/photo.jpg?sz=128", "display_name": "Batyr Nazarov", "link": "https://stackoverflow.com/users/9465829/batyr-nazarov"}, "edited": false, "score": 0, "creation_date": 1521037288, "post_id": 49278164, "comment_id": 85562911, "body": "Thanks Shai. I will do it"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 1, "last_activity_date": 1521035677, "last_edit_date": 1521035677, "creation_date": 1521031600, "answer_id": 49278164, "question_id": 49275618, "link": "https://stackoverflow.com/questions/49275618/changing-source-of-pivot-table/49278164#49278164", "title": "Changing source of Pivot Table", "body": "<p>In order to include the sheet's name of the <code>Range.Address</code>, the 4th parameter needs to be <code>xlExternal</code>.</p>\n\n<p>See modified code below:</p>\n\n<pre><code>Dim shTotalsPivot As Worksheet\nDim Rng As Range\nDim RngString As String\nDim PvtTbl As PivotTable\n\nSet Rng = ActiveSheet.Range(\"A1:F\" &amp; LastRow)\n\n' put the full range address (including sheet name) in a String variable\nRngString = Rng.Address(False, False, xlA1, xlExternal)\n\nSet shTotalsPivot = ActiveWorkbook.Sheets(\"Totals Pivot\")\n\n'set the Pivot-Table object\nSet PvtTbl = shTotalsPivot.PivotTables(1)\n\n' === for DEBUG ONLY ===\nDebug.Pring RngString\n\n' update the Pivot-Cache\nWith PvtTbl.PivotCache\n   .SourceData = RngString\n   .Refresh\nEnd With   \n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 9465829, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-0NGStmju7JI/AAAAAAAAAAI/AAAAAAAAARU/cfEWDeznnOo/photo.jpg?sz=128", "display_name": "Batyr Nazarov", "link": "https://stackoverflow.com/users/9465829/batyr-nazarov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1521035677, "creation_date": 1521024225, "last_edit_date": 1531164843, "question_id": 49275618, "link": "https://stackoverflow.com/questions/49275618/changing-source-of-pivot-table", "title": "Changing source of Pivot Table", "body": "<p>I have the following code which worked at some point but now throws me an error at \".SourceData = rng.Address(True, True, xlR1C1, True)\"       </p>\n\n<pre><code>Dim rng As Range\nSet rng = ActiveSheet.Range(\"A1:F\" &amp; LastRow)\nSet shTotalsPivot = ActiveWorkbook.Sheets(\"Totals Pivot\")\n\n\nWith shTotalsPivot.PivotTables(1).PivotCache\n   .SourceData = rng.Address(True, True, xlR1C1, True)\n   .Refresh\nEnd With\n</code></pre>\n\n<p>Could you please advise what I am doing incorrectly. I simply want to change a source in the existing pivot table to the new sheet which will an active sheet in this case. Thanks</p>\n"}, {"tags": ["forms", "ms-access", "vba"], "comments": [{"owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "edited": false, "score": 2, "creation_date": 1521024536, "post_id": 49275559, "comment_id": 85553792, "body": "Not clear enough what do you mean &quot;distribute values into text boxes&quot;. Manually fill values? In any case you can add a calculated column to base query, which calls VBA function with parameters from fields for text boxes, it will be recalled for each field after changing the data in text boxes."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1521035812, "post_id": 49275559, "comment_id": 85561883, "body": "That&#39;s bad database design. Field names are not for storing data. If you have a table with field names for fields in another table, that&#39;s a clear indication your data is not normalized and your design needs to be adjusted. If you don&#39;t adjust your database design, you can&#39;t achieve what you intend to. Similar data should be stored in the same field, with another field to differentiate the type of data, instead of separate fields."}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1521054056, "post_id": 49275559, "comment_id": 85574373, "body": "@ErikvonAsmuth: Some configurable databases have tables of tables and fields, it is a powerful data management tool in a complex information environment. Also not for the faint-hearted!"}, {"owner": {"reputation": 115, "user_id": 9484595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e1dbad7a21b9483192a7403461a4801?s=128&d=identicon&r=PG", "display_name": "Bubaya", "link": "https://stackoverflow.com/users/9484595/bubaya"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1521116431, "post_id": 49275559, "comment_id": 85600241, "body": "@ErikvonAsmuth The database design is debatable indeed, but out of my influence. However, I doubt that a properly normalized database would solve the problem: Given a table with an additional column <code>attribute</code>, you would still have to iterate over all distinct values for <code>attribute</code> and populate the histograms accordingly."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 1, "creation_date": 1521116606, "post_id": 49275559, "comment_id": 85600373, "body": "@Bubaya You don&#39;t have to iterate through it, then. You can just use a chart with a record source that includes all data for all records, and use the <i>link master field</i> and <i>link child field</i> property to get the right data with the right record."}, {"owner": {"reputation": 115, "user_id": 9484595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e1dbad7a21b9483192a7403461a4801?s=128&d=identicon&r=PG", "display_name": "Bubaya", "link": "https://stackoverflow.com/users/9484595/bubaya"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1521117489, "post_id": 49275559, "comment_id": 85601012, "body": "@ErikvonAsmuth: I wasn&#39;t aware of these two properties. Without them, I couldn&#39;t imagine how to do this without iteration. But I think it can be done also with this bad database design without iteration then."}, {"owner": {"reputation": 115, "user_id": 9484595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e1dbad7a21b9483192a7403461a4801?s=128&d=identicon&r=PG", "display_name": "Bubaya", "link": "https://stackoverflow.com/users/9484595/bubaya"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1521193758, "post_id": 49275559, "comment_id": 85636289, "body": "@ErikvonAsmuth: I&#39;ve tried to follow your advice to normalize the database. However, this won&#39;t help me since access complains about the queries&#39; complexity by now. Please consider having a look at my <a href=\"https://stackoverflow.com/q/49317534\">follow up-question</a>."}], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 9484595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e1dbad7a21b9483192a7403461a4801?s=128&d=identicon&r=PG", "display_name": "Bubaya", "link": "https://stackoverflow.com/users/9484595/bubaya"}, "edited": false, "score": 0, "creation_date": 1521035273, "post_id": 49275791, "comment_id": 85561443, "body": "That is bad news for me. Please se my edit for what I am trying to do. Viewing one record at a time is fine on screen; however, when I want to print, I always end up with the continous view, with my histograms not updated between two records."}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": false, "score": 1, "last_activity_date": 1521024700, "creation_date": 1521024700, "answer_id": 49275791, "question_id": 49275559, "link": "https://stackoverflow.com/questions/49275559/run-vba-for-each-record-in-a-form/49275791#49275791", "title": "Run VBA for each record in a form", "body": "<p>You can't. In continuous forms in Access, controls have only a single instance. Any operation on a control influences that control for all records.</p>\n\n<p>There are no separate events per record on a continuous form.</p>\n\n<p>You can iterate through the records, but only before or after the form has been populated.</p>\n"}], "owner": {"reputation": 115, "user_id": 9484595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e1dbad7a21b9483192a7403461a4801?s=128&d=identicon&r=PG", "display_name": "Bubaya", "link": "https://stackoverflow.com/users/9484595/bubaya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 368, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1521035208, "creation_date": 1521024072, "last_edit_date": 1521035208, "question_id": 49275559, "link": "https://stackoverflow.com/questions/49275559/run-vba-for-each-record-in-a-form", "title": "Run VBA for each record in a form", "body": "<p>Given a form which continuously displays certain text boxes for a each record of a table, I'd like a VBA sub to be executed after all text boxes for each record have been (automatically, not via VBA) populated with data from the current record. So the idealized order of execution would be:</p>\n\n<pre><code>fetch next record from table\ndistribute values into text boxes and draw\nexecute VBA\nfetch next record from table\n</code></pre>\n\n<p>How can I achieve this?</p>\n\n<p><strong>Note:</strong> The form is \"continuous\" (I don't know how to say this in access-jargon), i. e. displays all records at once, and not one record at a time with buttons for moving forward/backward.</p>\n\n<p><strong>Note 2:</strong> What I achieve to do is the following: I have a table <code>F</code> that contains names of fields of another table <code>T</code>. My form iterates through the rows of <code>F</code>. For each field name listed in <code>F</code>, I want to print out the name, and build a query that draws a histogram showing the data from <code>T</code> for that column.</p>\n"}, {"tags": ["regex", "vba"], "comments": [{"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 0, "creation_date": 1521040440, "post_id": 49275256, "comment_id": 85565270, "body": "The regex engine doesn&#39;t support the <code>\\k</code> option. Either use <code>Debug.Print m.SubMatches(1)</code> with <code>rg.pattern = &quot;12(3456)&quot;</code>, or <code>rg.pattern = &quot;123456&quot;</code> and then <code>Debug.Print Mid(m, 3)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 765, "user_id": 966785, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8c24afb624a18ff41b5b53f8746ca59a?s=128&d=identicon&r=PG&f=1", "display_name": "mordechai", "link": "https://stackoverflow.com/users/966785/mordechai"}, "edited": false, "score": 0, "creation_date": 1521023770, "post_id": 49275312, "comment_id": 85553266, "body": "my pattern is &quot;123456&quot; , i am search the index of &quot;3456&quot; ,&quot;12&quot; is also a part of the condition, in case of &quot;123456 23456&quot; there is only one match"}, {"owner": {"reputation": 302, "user_id": 8023999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ii1wQ.jpg?s=128&g=1", "display_name": "Jamez Fatout", "link": "https://stackoverflow.com/users/8023999/jamez-fatout"}, "reply_to_user": {"reputation": 765, "user_id": 966785, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8c24afb624a18ff41b5b53f8746ca59a?s=128&d=identicon&r=PG&f=1", "display_name": "mordechai", "link": "https://stackoverflow.com/users/966785/mordechai"}, "edited": false, "score": 0, "creation_date": 1521025995, "post_id": 49275312, "comment_id": 85554849, "body": "Do you want one match or more matches"}, {"owner": {"reputation": 765, "user_id": 966785, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8c24afb624a18ff41b5b53f8746ca59a?s=128&d=identicon&r=PG&f=1", "display_name": "mordechai", "link": "https://stackoverflow.com/users/966785/mordechai"}, "edited": false, "score": 0, "creation_date": 1521035421, "post_id": 49275312, "comment_id": 85561567, "body": "in this case : &quot;123456 3456&quot;, one math of first &quot;3456&quot;, i am searce for &quot;123456&quot; bu i need the first index of  &quot;3456&quot;"}], "tags": [], "owner": {"reputation": 302, "user_id": 8023999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ii1wQ.jpg?s=128&g=1", "display_name": "Jamez Fatout", "link": "https://stackoverflow.com/users/8023999/jamez-fatout"}, "is_accepted": false, "score": 1, "last_activity_date": 1521023379, "creation_date": 1521023379, "answer_id": 49275312, "question_id": 49275256, "link": "https://stackoverflow.com/questions/49275256/regex-compatible-of-reset-match-k-in-microsoft-regex/49275312#49275312", "title": "regex - compatible of reset match (\\K) in microsoft regex", "body": "<pre><code>        string pattern = @\"3456\";\n        string input = @\"123456\";\n\n        foreach (Match m in Regex.Matches(input, pattern))\n        {\n            Console.WriteLine(\"'{0}' found at index {1}.\", m.Value, m.Index);\n        }\n}\n</code></pre>\n\n<p>?? Your description is very bad</p>\n"}], "owner": {"reputation": 765, "user_id": 966785, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8c24afb624a18ff41b5b53f8746ca59a?s=128&d=identicon&r=PG&f=1", "display_name": "mordechai", "link": "https://stackoverflow.com/users/966785/mordechai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521024396, "creation_date": 1521023196, "last_edit_date": 1521024396, "question_id": 49275256, "link": "https://stackoverflow.com/questions/49275256/regex-compatible-of-reset-match-k-in-microsoft-regex", "title": "regex - compatible of reset match (\\K) in microsoft regex", "body": "<pre><code>Dim rg As New RegExp\nrg.pattern = \"3456\" '\"12\\K3456\" in others engine\nrg.Global = 1\nDim result As MatchCollection, m As Match\nSet result = rg.Execute(\"123456 3456\")\nFor Each m In result\n    Debug.Print m.FirstIndex, m.Value\nNext\n</code></pre>\n\n<p>found two matchs, \nhow can i find only the one match \"<strong>3456</strong>\" of \"12<strong>3456</strong>\" in MS regex (C:\\Windows\\SysWOW64\\vbscript.dll)</p>\n"}, {"tags": ["vba", "vbscript", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1521046489, "creation_date": 1521046489, "answer_id": 49283545, "question_id": 49275020, "link": "https://stackoverflow.com/questions/49275020/manual-entry-of-subject-in-outlook-for-vbs/49283545#49283545", "title": "Manual entry of subject in outlook for VBS", "body": "<p>Use InputBox VBS function. See <a href=\"https://blogs.technet.microsoft.com/heyscriptingguy/2004/08/31/how-can-i-prompt-a-user-for-input/\" rel=\"nofollow noreferrer\">https://blogs.technet.microsoft.com/heyscriptingguy/2004/08/31/how-can-i-prompt-a-user-for-input/</a></p>\n"}], "owner": {"reputation": 41, "user_id": 3093993, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9d0e052275e2b8d10556c5480e60bd85?s=128&d=identicon&r=PG&f=1", "display_name": "ramu246", "link": "https://stackoverflow.com/users/3093993/ramu246"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521046512, "creation_date": 1521022493, "last_edit_date": 1521046512, "question_id": 49275020, "link": "https://stackoverflow.com/questions/49275020/manual-entry-of-subject-in-outlook-for-vbs", "title": "Manual entry of subject in outlook for VBS", "body": "<p>How can we enter subject name manually in outlook subject for VBS so that, it will be used to fetch some values in a batfile.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1521023802, "post_id": 49274972, "comment_id": 85553286, "body": "Will you always know the name in advance and can you explain the reason for the .PHP in &quot;vieworder.pdf.php&quot; ?"}, {"owner": {"reputation": 854, "user_id": 8627190, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh4.googleusercontent.com/-hd407nZxwg8/AAAAAAAAAAI/AAAAAAAAAH0/lNmbHUGy5to/photo.jpg?sz=128", "display_name": "arun v", "link": "https://stackoverflow.com/users/8627190/arun-v"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1521023857, "post_id": 49274972, "comment_id": 85553318, "body": "Yes the created file will have a constant name,  this file contains many files downloaded from website from a different pages, using VBA code i have printed those file in a cute pdf format by that all the files get merged as single document, name .php is the name format in website so while printing it has the same name."}], "owner": {"reputation": 854, "user_id": 8627190, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh4.googleusercontent.com/-hd407nZxwg8/AAAAAAAAAAI/AAAAAAAAAH0/lNmbHUGy5to/photo.jpg?sz=128", "display_name": "arun v", "link": "https://stackoverflow.com/users/8627190/arun-v"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1521022824, "creation_date": 1521022371, "last_edit_date": 1521022824, "question_id": 49274972, "link": "https://stackoverflow.com/questions/49274972/how-to-locate-an-recently-opened-pdf-file-and-save-it-in-a-target-folder-using-e", "title": "how to locate an recently opened pdf file and save it in a target folder using excel vba", "body": "<p>I want to locate an recently opened pdf file and save it in a target folder, right now i can able to locate the pdf file using its name and close it but i want to use Save As function.</p>\n\n<p>Code tried to Locate and close the PDF</p>\n\n<pre><code>Option Explicit\nPrivate Declare Function FindWindow Lib \"user32\" _\n    Alias \"FindWindowA\" (ByVal lpClassName As String, _\n    ByVal lpWindowName As String) As Long\nPrivate Declare Function PostMessage Lib \"user32\" _\n    Alias \"PostMessageA\" (ByVal hwnd As Long, _\n    ByVal wMsg As Long, ByVal wParam As Long, _\n    ByVal lParam As Long) As Long\nPrivate Declare Function OpenProcess Lib \"kernel32\" _\n    (ByVal dwDesiredAccess As Long, _\n    ByVal bInheritHandle As Long, _\n    ByVal dwProcessId As Long) As Long\nPrivate Declare Function GetWindowThreadProcessId _\n    Lib \"user32\" (ByVal hwnd As Long, lpdwProcessId As Long) As Long\nDeclare Function GetParent Lib \"user32\" (ByVal hwnd As Long) As Long\nPrivate Declare Function GetWindowText Lib \"user32\" _\n    Alias \"GetWindowTextA\" (ByVal hwnd As Long, _\n    ByVal lpString As String, ByVal cch As Long) As Long\nPrivate Declare Function GetWindow Lib \"user32\" (ByVal hwnd As Long, _\n    ByVal wCmd As Long) As Long\n\nConst GW_HWNDNEXT = 2\nConst WM_CLOSE = &amp;H10\nConst SYNCHRONIZE = &amp;H100000\nPublic Sub Test()\n    Dim hWindow As Long\n    Dim hProcess As Long\n    Dim lProcessId As Long\n    Dim lngReturnValue As Long\n\n    hWindow = SearchHndByWndName_Parent(\"vieworder.pdf.php\")\n    hProcess = OpenProcess(SYNCHRONIZE, 0&amp;, lProcessId)\n    lngReturnValue = PostMessage(hWindow, WM_CLOSE, 0&amp;, 0&amp;)\nEnd Sub\nPrivate Function SearchHndByWndName_Parent(strSearch As String) As Long\n    Dim strTMP As String * 100\n    Dim nhWnd As Long\n    nhWnd = FindWindow(vbNullString, vbNullString)\n    Do While Not nhWnd = 0\n        If GetParent(nhWnd) = 0 Then\n            GetWindowText nhWnd, strTMP, 100\n            If InStr(strTMP, strSearch) &gt; 0 Then\n                SearchHndByWndName_Parent = nhWnd\n                Exit Do\n            End If\n        End If\n        nhWnd = GetWindow(nhWnd, GW_HWNDNEXT)\n\n    Loop\nEnd Function\n</code></pre>\n\n<p>I am working in a restricted environment so I cant add any Adobe dll as reference, also the file which i am looking for is not yet saved in any folder.</p>\n\n<p>Please share your suggestions.\nThank You</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 854, "user_id": 8627190, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh4.googleusercontent.com/-hd407nZxwg8/AAAAAAAAAAI/AAAAAAAAAH0/lNmbHUGy5to/photo.jpg?sz=128", "display_name": "arun v", "link": "https://stackoverflow.com/users/8627190/arun-v"}, "edited": false, "score": 0, "creation_date": 1521021257, "post_id": 49274203, "comment_id": 85551437, "body": "share the code your tried so far"}, {"owner": {"reputation": 721, "user_id": 7889129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0oYIA.jpg?s=128&g=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7889129/maddy"}, "edited": false, "score": 0, "creation_date": 1521021448, "post_id": 49274203, "comment_id": 85551585, "body": "Please check this answer <a href=\"https://stackoverflow.com/a/9391428/7889129\">stackoverflow.com/a/9391428/7889129</a> by JMax. it will solve your problem"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1521023154, "post_id": 49274203, "comment_id": 85552815, "body": "JMax&#39;s solution looks at identifying merged cells rather than looping through cells in a range, and only the first cell if a sub range is merged, so OP would need additional logic to solve."}], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1521353960, "post_id": 49344900, "comment_id": 85690079, "body": "My goodness. How simple and smart but still does loop through all doesn&#39;t it?  Or does looping through 2 cells that are merged really mean looping through one?"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1521382374, "post_id": 49344900, "comment_id": 85697329, "body": "@QHarr - Good point. The latest version only loops through merged cells"}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 3, "last_activity_date": 1521384277, "last_edit_date": 1521384277, "creation_date": 1521352600, "answer_id": 49344900, "question_id": 49274203, "link": "https://stackoverflow.com/questions/49274203/loop-through-cells-merged-cells-in-column/49344900#49344900", "title": "Loop through cells/merged cells in column", "body": "<p>Try this: My sample data is on <strong>Sheet1</strong> (merged cells are outlined)</p>\n\n<p><a href=\"https://i.stack.imgur.com/kQLhj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kQLhj.png\" alt=\"sample data\"></a></p>\n\n<p>The code: in <strong>Sheet1 module</strong></p>\n\n<hr>\n\n<pre><code>Option Explicit\n\nPublic Sub SkipMerged()\n\n    Dim colA As Range, itm As Range\n\n    Set colA = Me.UsedRange.Columns(1)\n\n    Set itm = colA.Cells(1)\n\n    While Len(itm.Value2) &gt; 0\n\n        Debug.Print \"Merged area: \" &amp; itm.MergeArea.Address(0, 0)\n\n        Set itm = itm.MergeArea.Offset(1)\n\n    Wend\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>The output in the Immediate Window:</p>\n\n<pre><code>Merged area: A1:A3\nMerged area: A4\nMerged area: A5:A6\nMerged area: A7:A9\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9489538, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bYyo7NxL7SU/AAAAAAAAAAI/AAAAAAAAAEc/rjNffFAv96o/photo.jpg?sz=128", "display_name": "Abhishek Rai", "link": "https://stackoverflow.com/users/9489538/abhishek-rai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1156, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1521384277, "creation_date": 1521020342, "last_edit_date": 1592644375, "question_id": 49274203, "link": "https://stackoverflow.com/questions/49274203/loop-through-cells-merged-cells-in-column", "title": "Loop through cells/merged cells in column", "body": "<p>I am very new to Excel VBA and haven't quite familiarized myself with all the different functions. This is what I would like to have happen:</p>\n<p>I have a column containing value in combination of cells and <strong>merged cells</strong>. I have to perform an action in <strong>for</strong> <strong>loop</strong> for that column. I want the loop to move from 1 cell to next and not based on the row. e.g cell C1 is merged cell (C1-C3) so the loop should next go to C4 rather than C2.\nIn the attached image, I want the loop to go like C1 -&gt; C4 -&gt; C5 -&gt; C7 -&gt; C11 and like that..</p>\n<p><img src=\"https://i.stack.imgur.com/JHsZS.png\" alt=\"enter image description here\" /></p>\n"}, {"tags": ["vba", "excel", "csv"], "answers": [{"tags": [], "owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "is_accepted": true, "score": 0, "last_activity_date": 1521019137, "creation_date": 1521019137, "answer_id": 49273746, "question_id": 49273516, "link": "https://stackoverflow.com/questions/49273516/opening-a-csv-file-via-vba-leads-to-missing-rows/49273746#49273746", "title": "Opening a .csv file via VBA leads to missing rows", "body": "<p>For some reason, setting the Local parameter to True fixed it, I still don't know how or why so if anyone has any insights I'd appreciate it.\nFixed code:</p>\n\n<pre><code>Workbooks.Open vrtSelectedItem, Local:=True\n</code></pre>\n"}], "owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 49273746, "answer_count": 1, "score": 1, "last_activity_date": 1521019137, "creation_date": 1521018427, "last_edit_date": 1531164843, "question_id": 49273516, "link": "https://stackoverflow.com/questions/49273516/opening-a-csv-file-via-vba-leads-to-missing-rows", "title": "Opening a .csv file via VBA leads to missing rows", "body": "<p>I am using a macro to open a set of selected .csv files, apply the TextToColumns command and then save them as a .xlsx file for further manual processing. One particular .csv file has around 2000 lines in it if I open it manually; when the file is opened via the macro it only contains a total of 1064 lines. Does anyone know what causes this or how I can fix it? Relevant code:</p>\n\n<pre><code>Dim iFileSelect As FileDialog\nDim vrtSelectedItem As Variant\nSet iFileSelect = Application.FileDialog(msoFileDialogFilePicker)\n\nIf iFileSelect.Show = -1 Then\n    Application.DisplayAlerts = False\n    For Each vrtSelectedItem In iFileSelect.SelectedItems\n        Workbooks.Open vrtSelectedItem 'After this step the opened _\n        .csv only contains 1064 out of 2000 lines\n        'Here a macro is run to convert text to columns\n        ActiveWorkbook.Close\n        SetAttr vrtSelectedItem, vbNormal\n        Kill vrtSelectedItem\n    Next vrtSelectedItem\n    Application.DisplayAlerts = True\nEnd If\n\nSet iFileSelect = Nothing\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1521019207, "post_id": 49273488, "comment_id": 85550085, "body": "Are those start and stop values repeated elsewhere within the same column? If not you could use Find to locate them and those cell references to set up your range for deletion. Or even, if they are the first match and last match respectively."}, {"owner": {"reputation": 13, "user_id": 9490271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cea8dcb1482e0179097f299cb81e983?s=128&d=identicon&r=PG&f=1", "display_name": "Jordyb", "link": "https://stackoverflow.com/users/9490271/jordyb"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1521019280, "post_id": 49273488, "comment_id": 85550124, "body": "Only appear once. Is text though."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1521019361, "post_id": 49273488, "comment_id": 85550180, "body": "Can you show some data and any attempts you have made at coding so far? Text can be matched in lots of ways. Is it part of a larger bit of text in a cell?"}, {"owner": {"reputation": 13, "user_id": 9490271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cea8dcb1482e0179097f299cb81e983?s=128&d=identicon&r=PG&f=1", "display_name": "Jordyb", "link": "https://stackoverflow.com/users/9490271/jordyb"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1521019782, "post_id": 49273488, "comment_id": 85550445, "body": "Range starts with:   &quot;Artikelgroep:    Promotional material&quot; Within the range:    &quot;1234ART.NR PRODUCT NAME&quot; Range ends with:   &quot;Artikelgroep:    (totaal)  &quot;  Within this range there are +- 100 rows with all different values and placed every week on another row."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1521019856, "post_id": 49273488, "comment_id": 85550495, "body": "is  &quot;Artikelgroep: Promotional material&quot; within one cell by itself?"}, {"owner": {"reputation": 13, "user_id": 9490271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cea8dcb1482e0179097f299cb81e983?s=128&d=identicon&r=PG&f=1", "display_name": "Jordyb", "link": "https://stackoverflow.com/users/9490271/jordyb"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1521019973, "post_id": 49273488, "comment_id": 85550579, "body": "Yes. The cells within the range don&#39;t have anything else in common."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1521020016, "post_id": 49273488, "comment_id": 85550604, "body": "Is the column always the same for the start and end text?"}, {"owner": {"reputation": 13, "user_id": 9490271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cea8dcb1482e0179097f299cb81e983?s=128&d=identicon&r=PG&f=1", "display_name": "Jordyb", "link": "https://stackoverflow.com/users/9490271/jordyb"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1521020051, "post_id": 49273488, "comment_id": 85550631, "body": "Yes, they are always in column A1"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1521020183, "post_id": 49273488, "comment_id": 85550721, "body": "The answer by @shai rado here <a href=\"https://stackoverflow.com/questions/44227455/excel-vba-find-method-for-specific-column\" title=\"excel vba find method for specific column\">stackoverflow.com/questions/44227455/&hellip;</a> might help. You would do two finds. One for the start and one for the end. Then construct a range out of those and use .EntireRow for when you delete."}, {"owner": {"reputation": 13, "user_id": 9490271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cea8dcb1482e0179097f299cb81e983?s=128&d=identicon&r=PG&f=1", "display_name": "Jordyb", "link": "https://stackoverflow.com/users/9490271/jordyb"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1521021094, "post_id": 49273488, "comment_id": 85551338, "body": "I think i&#39;m at a loss here. I&#39;m not sure how to make this piece of code compatible to my document.."}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1521021928, "last_edit_date": 1521021928, "creation_date": 1521021247, "answer_id": 49274536, "question_id": 49273488, "link": "https://stackoverflow.com/questions/49273488/deleting-a-specific-range-of-rows-with-vba/49274536#49274536", "title": "Deleting a specific range of rows with VBA", "body": "<p>And this is what that might look like for you</p>\n\n<pre><code>Option Explicit\nSub TargetRows()\n\n    Dim wb As Workbook\n    Dim wsTarget As Worksheet\n    Dim startCell As Range\n    Dim endCell As Range\n    Dim startMatch As String\n    Dim endMatch As String\n\n    startMatch = \"Artikelgroep: Promotional material\"\n    endMatch = \"Artikelgroep: (totaal)\"\n\n    Set wsTarget = ThisWorkbook.Worksheets(\"Sheet2\") 'change as required\n    Set startCell = wsTarget.Columns(1).EntireColumn.Find(what:=startMatch, LookIn:=xlValues, lookat:=xlPart)\n    Set endCell = wsTarget.Columns(1).EntireColumn.Find(what:=endMatch, LookIn:=xlValues, lookat:=xlPart)\n\n    Dim deleteRange As Range\n\n    If Not startCell Is Nothing And Not endCell Is Nothing And startCell.Row &lt;= endCell.Row Then\n        Set deleteRange = wsTarget.Range(\"A\" &amp; startCell.Row &amp; \":A\" &amp; endCell.Row)\n    Else\n        Debug.Print \"1 or both values not found or end text found before start text.\"\n    End If\n\n    If Not deleteRange Is Nothing Then deleteRange.EntireRow.Delete\nEnd Sub\n</code></pre>\n\n<p>Reference:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/44227455/excel-vba-find-method-for-specific-column\">Excel VBA Find Method for specific column</a>   (@shai rado)</p>\n"}], "owner": {"reputation": 13, "user_id": 9490271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cea8dcb1482e0179097f299cb81e983?s=128&d=identicon&r=PG&f=1", "display_name": "Jordyb", "link": "https://stackoverflow.com/users/9490271/jordyb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1549, "favorite_count": 0, "accepted_answer_id": 49274536, "answer_count": 1, "score": 1, "last_activity_date": 1521021928, "creation_date": 1521018318, "question_id": 49273488, "link": "https://stackoverflow.com/questions/49273488/deleting-a-specific-range-of-rows-with-vba", "title": "Deleting a specific range of rows with VBA", "body": "<p>I'm very new to VBA so this might be a basic question..</p>\n\n<p>Every week i'm exporting a file with all kinds of data. Within this file I have to delete the same range of rows every time. I could easily automate this by defining a range based on cell positions, but this range starts sometimes not on the same row. However, the range starts with the same value and ends with the same value every time. </p>\n\n<p>Is there any chance I can delete automatically all the rows within the range from begin to bottom? Without needing to specify a range based on cell positions?</p>\n"}, {"tags": ["sql", "database", "vba", "performance", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 0, "last_activity_date": 1521017256, "creation_date": 1521017256, "answer_id": 49273170, "question_id": 49272590, "link": "https://stackoverflow.com/questions/49272590/ms-access-sql-performance-issues-inner-join-update-data/49273170#49273170", "title": "MS Access SQL performance issues INNER JOIN + Update data", "body": "<p>You need to create an <strong>index</strong> on the JOIN column of the imported table. I assume it's the primary key.</p>\n\n<p>After running <code>DoCmd.TransferSpreadsheet</code>, do this:</p>\n\n<pre><code>CurrentDb.Execute \"CREATE UNIQUE INDEX PrimaryKey ON Temp (PackageNumber) WITH PRIMARY\"\n</code></pre>\n\n<p>Your <code>Main</code> table should already have PackageNumber as primary key.</p>\n"}, {"tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": false, "score": 0, "last_activity_date": 1521018663, "creation_date": 1521018663, "answer_id": 49273577, "question_id": 49272590, "link": "https://stackoverflow.com/questions/49272590/ms-access-sql-performance-issues-inner-join-update-data/49273577#49273577", "title": "MS Access SQL performance issues INNER JOIN + Update data", "body": "<p>You can query Excel files directly, avoiding the creation of a temp table, and any overhead associated with it:</p>\n\n<pre><code>UPDATE \n    Main INNER JOIN [Excel 10.0;HDR=Yes;DATABASE=C:\\YourFile.xls].[A:CH] Temp ON Main.[PackageNumber] = Temp.[PackageNumber]\n    SET \n    Main.[Field1]=Temp.[Field1],\n    Main.[Field2]=Temp.[Field2] ...\n</code></pre>\n\n<p>This tends to work way faster than <code>DoCmd.TransferSpreadsheet</code>, which should be avoided when possible in my opinion.</p>\n"}], "owner": {"reputation": 1, "user_id": 9489933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee9da1b1638494995485a8b36cfe3077?s=128&d=identicon&r=PG&f=1", "display_name": "Average Joe", "link": "https://stackoverflow.com/users/9489933/average-joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1521018663, "creation_date": 1521015114, "question_id": 49272590, "link": "https://stackoverflow.com/questions/49272590/ms-access-sql-performance-issues-inner-join-update-data", "title": "MS Access SQL performance issues INNER JOIN + Update data", "body": "<p>I'm using 2 tables: </p>\n\n<p>First as main table that keeps data</p>\n\n<p>Second one is a temp table to import new report everyday and check the difference between records in new report and main table.</p>\n\n<pre><code>        tablename=\"Temp\"\n        DoCmd.TransferSpreadsheet acImport, acSpreadsheetTypeExcel10, tablename,strPath, True, \"A:CH\"  \n        stringSQL = \n        UPDATE \n        Main INNER JOIN Temp ON Main.[PackageNumber] = Temp.[PackageNumber]\n        SET \n        Main.[Field1]=Temp.[Field1],\n        Main.[Field2]=Temp.[Field2] ... \n</code></pre>\n\n<p>If in temp table i can find record with already existing package number I have to update the entire row in main table with data from temp table. \nThere is about 30 columns in main table and about few thousands of records to check in temp report everyday.</p>\n\n<p>Currently i'm meeting performance issues, cause whole operation can take even more than hour!\nWhat are the possibilities to make it run faster? \nI've already tried \"Repair and compact db\" function.</p>\n"}, {"tags": ["sql", "vba", "excel", "join"], "comments": [{"owner": {"reputation": 124613, "user_id": 3522312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c5b53060bf7f71994265a9ef7c17cc5?s=128&d=identicon&r=PG", "display_name": "scaisEdge", "link": "https://stackoverflow.com/users/3522312/scaisedge"}, "edited": false, "score": 1, "creation_date": 1521014118, "post_id": 49272069, "comment_id": 85547301, "body": "for each F1 you need the&quot;merge&quot; on the same row or on two (or more) rows .?. add  a proper data sample and the expected  result"}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 7013169, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7b0ce1f6f4c9c0ac18405f54b03fe569?s=128&d=identicon&r=PG&f=1", "display_name": "l.wach", "link": "https://stackoverflow.com/users/7013169/l-wach"}, "edited": false, "score": 0, "creation_date": 1521016243, "post_id": 49272326, "comment_id": 85548340, "body": "Not working unfortunatly, &quot;Syntax error in JOIN-Operation&quot; #-2147217900"}, {"owner": {"reputation": 67, "user_id": 7013169, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7b0ce1f6f4c9c0ac18405f54b03fe569?s=128&d=identicon&r=PG&f=1", "display_name": "l.wach", "link": "https://stackoverflow.com/users/7013169/l-wach"}, "edited": false, "score": 0, "creation_date": 1521021329, "post_id": 49272326, "comment_id": 85551501, "body": "now there is a diffrent error (same error code) &quot;join expression not supported&quot; I tried brackets but no luck. This is so frustrating thank you for your help!"}, {"owner": {"reputation": 67, "user_id": 7013169, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7b0ce1f6f4c9c0ac18405f54b03fe569?s=128&d=identicon&r=PG&f=1", "display_name": "l.wach", "link": "https://stackoverflow.com/users/7013169/l-wach"}, "edited": false, "score": 0, "creation_date": 1521023919, "post_id": 49272326, "comment_id": 85553363, "body": "Now the error is a data type mismatch any idea?  Thank you very much!"}, {"owner": {"reputation": 124613, "user_id": 3522312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c5b53060bf7f71994265a9ef7c17cc5?s=128&d=identicon&r=PG", "display_name": "scaisEdge", "link": "https://stackoverflow.com/users/3522312/scaisedge"}, "reply_to_user": {"reputation": 67, "user_id": 7013169, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7b0ce1f6f4c9c0ac18405f54b03fe569?s=128&d=identicon&r=PG&f=1", "display_name": "l.wach", "link": "https://stackoverflow.com/users/7013169/l-wach"}, "edited": false, "score": 0, "creation_date": 1521024399, "post_id": 49272326, "comment_id": 85553684, "body": "asnwer  updated  ..but be sure that you are compating the same data type"}, {"owner": {"reputation": 67, "user_id": 7013169, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7b0ce1f6f4c9c0ac18405f54b03fe569?s=128&d=identicon&r=PG&f=1", "display_name": "l.wach", "link": "https://stackoverflow.com/users/7013169/l-wach"}, "edited": false, "score": 0, "creation_date": 1521025112, "post_id": 49272326, "comment_id": 85554178, "body": "back to &quot;syntax error in JOIN-Operation&quot; this is so stupid, is there a diffrent approach to my problem? I have to use Excel... Thank you!"}, {"owner": {"reputation": 67, "user_id": 7013169, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7b0ce1f6f4c9c0ac18405f54b03fe569?s=128&d=identicon&r=PG&f=1", "display_name": "l.wach", "link": "https://stackoverflow.com/users/7013169/l-wach"}, "edited": false, "score": 0, "creation_date": 1521028501, "post_id": 49272326, "comment_id": 85556550, "body": "still data missmatch error, the cells F1 contain an alphanumeric value and both have the same data type theoretically"}], "tags": [], "owner": {"reputation": 124613, "user_id": 3522312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c5b53060bf7f71994265a9ef7c17cc5?s=128&d=identicon&r=PG", "display_name": "scaisEdge", "link": "https://stackoverflow.com/users/3522312/scaisedge"}, "is_accepted": false, "score": 4, "last_activity_date": 1521025477, "last_edit_date": 1521025477, "creation_date": 1521014233, "answer_id": 49272326, "question_id": 49272069, "link": "https://stackoverflow.com/questions/49272069/left-join-excel-vba-adodb-not-working/49272326#49272326", "title": "LEFT JOIN Excel VBA ADODB not working", "body": "<p>if you need  a left join  the sintax for join should be :</p>\n\n<pre><code>SELECT\n[KAP$].F1,\n[KAP$].F5,\n[KAP$].F12,\n[KAP$].F13,\n[KAP$].F37, \n[KAP$].F38,\n[Klima$A3:H899].F1,\n[Klima$A3:H899].F2,\n[Klima$A3:H899].F3,\n[Klima$A3:H899].F4, \n[Klima$A3:H899].F5,\n[Klima$A3:H899].F6,\n[Klima$A3:H899].F7,\n[Klima$A3:H899].F8\nFROM [KAP$]\nLEFT JOIN [Klima$A3:H899]   ON ([KAP$].F1=[Klima$A3:H899].F1)\nWHERE   [KAP$].F8 LIKE 'Klima%' \n</code></pre>\n\n<p><em>assuming that [Klima$A3:H899] is a valid  table  or equivalent</em></p>\n"}, {"comments": [{"owner": {"reputation": 67, "user_id": 7013169, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7b0ce1f6f4c9c0ac18405f54b03fe569?s=128&d=identicon&r=PG&f=1", "display_name": "l.wach", "link": "https://stackoverflow.com/users/7013169/l-wach"}, "edited": false, "score": 0, "creation_date": 1521021727, "post_id": 49273037, "comment_id": 85551770, "body": "excel is giving me a data type mismatch error :( Thank you for your help!"}, {"owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "reply_to_user": {"reputation": 67, "user_id": 7013169, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7b0ce1f6f4c9c0ac18405f54b03fe569?s=128&d=identicon&r=PG&f=1", "display_name": "l.wach", "link": "https://stackoverflow.com/users/7013169/l-wach"}, "edited": false, "score": 1, "creation_date": 1521025429, "post_id": 49273037, "comment_id": 85554416, "body": "@l.wach Try edited answer. Also, if it doesn&#39;t work, try changing <code>&#39;klima&#39;</code> to<code>&#39;%klima%&#39;</code>."}, {"owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "reply_to_user": {"reputation": 67, "user_id": 7013169, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7b0ce1f6f4c9c0ac18405f54b03fe569?s=128&d=identicon&r=PG&f=1", "display_name": "l.wach", "link": "https://stackoverflow.com/users/7013169/l-wach"}, "edited": false, "score": 0, "creation_date": 1521028772, "post_id": 49273037, "comment_id": 85556734, "body": "@l.wach Make sure that both <code>F1</code> columns are of same datatype."}], "tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": false, "score": 1, "last_activity_date": 1521025379, "last_edit_date": 1521025379, "creation_date": 1521016798, "answer_id": 49273037, "question_id": 49272069, "link": "https://stackoverflow.com/questions/49272069/left-join-excel-vba-adodb-not-working/49273037#49273037", "title": "LEFT JOIN Excel VBA ADODB not working", "body": "<p>Try this query:</p>\n\n<pre><code>SELECT [KAP$].F1,\n       [KAP$].F5,\n       [KAP$].F12,\n       [KAP$].F13,\n       [KAP$].F37, \n       [KAP$].F38,\n       [Klima$].F1,\n       [Klima$].F2,\n       [Klima$].F3,\n       [Klima$].F4, \n       [Klima$].F5,\n       [Klima$].F6,\n       [Klima$].F7,\n       [Klima$].F8\nFROM\n    (SELECT F1,F5,F12,F13,F37,F38 FROM [KAP$] WHERE F8 LIKE 'klima') AS [KAP$]\nLEFT JOIN\n    (SELECT F1, F2, F3, F4, F5, F6, F7, F8 FROM [Klima$A3:H899] WHERE F1 IS NOT NULL) AS [Klima$]\nON [KAP$].F1 = [Klima$].F1\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 7013169, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7b0ce1f6f4c9c0ac18405f54b03fe569?s=128&d=identicon&r=PG&f=1", "display_name": "l.wach", "link": "https://stackoverflow.com/users/7013169/l-wach"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1165, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1521025477, "creation_date": 1521013241, "last_edit_date": 1521016009, "question_id": 49272069, "link": "https://stackoverflow.com/questions/49272069/left-join-excel-vba-adodb-not-working", "title": "LEFT JOIN Excel VBA ADODB not working", "body": "<p>I am trying to merge the data from two worsheets in in one workbook.\nI have succesfully queried the data into two diffrent recordsets like so:</p>\n\n<pre><code>SELECT F1,F5,F12,F13,F37,F38 FROM [KAP$] WHERE F8 LIKE 'klima'\n</code></pre>\n\n<p>and</p>\n\n<pre><code>SELECT F1, F2, F3, F4, F5, F6, F7, F8 FROM [Klima$A3:H899] WHERE F1 IS NOT NULL\n</code></pre>\n\n<p>Unfortunatly I have not found a way to \"merge\" the two recordsets.\nHowever I noticed that the better way to archieve this would be to just query the two sheets at once using a left join. However I just can't get the syntax right. My last try was this:</p>\n\n<pre><code>SELECT\n[KAP$].F1,\n[KAP$].F5,\n[KAP$].F12,\n[KAP$].F13,\n[KAP$].F37, \n[KAP$].F38,\n[Klima$].F1,\n[Klima$].F2,\n[Klima$].F3,\n[Klima$].F4, \n[Klima$].F5,\n[Klima$].F6,\n[Klima$].F7,\n[Klima$].F8\nFROM [KAP$] WHERE [KAP$].F8 LIKE 'Klima' LEFT JOIN [Klima$A3:H899] ON [KAP$].F1=[Klima$].F1\n</code></pre>\n\n<p>But as I have noticed there is more than one thing wrong with it... Any help is apreciated, I have been looking for a proper excel vba adodb guide for hours without success....</p>\n\n<p>Thank you!</p>\n\n<p>Edit: Here is some sample data:</p>\n\n<p>KAP:</p>\n\n<pre><code>ID1  Info1  Info2  KAPinfo1  KAPinfo2  KAPinfo3\nID2  Info1  Info2  KAPinfo1  KAPinfo2  KAPinfo3\nID3  Info1  Info2  KAPinfo1  KAPinfo2  KAPinfo3\nID4  Info1  Info2  KAPinfo1  KAPinfo2  KAPinfo3\nID5  Info1  Info2  KAPinfo1  KAPinfo2  KAPinfo3\nID6  Info1  Info2  KAPinfo1  KAPinfo2  KAPinfo3\n</code></pre>\n\n<p>Klima:</p>\n\n<pre><code>ID1 Info1  Info2  Klima3  Klima4  Klima5  Klima6  Klima7  Klima8\nID2 Info1  Info2  Klima3  Klima4  Klima5  Klima6  Klima7  Klima8\nID3 Info1  Info2  Klima3  Klima4  Klima5  Klima6  Klima7  Klima8\nID6 Info1  -  -   Klima3  Klima4  Klima5  Klima6  Klima7  Klima8\n</code></pre>\n\n<p>The merged tables should look like this:</p>\n\n<pre><code>ID1 Info1  Info2  Klima3  Klima4  Klima5  Klima6  Klima7  Klima8  KAPinfo1  KAPinfo2  KAPinfo3\nID2 Info1  Info2  Klima3  Klima4  Klima5  Klima6  Klima7  Klima8  KAPinfo1  KAPinfo2  KAPinfo3\nID3 Info1  Info2  Klima3  Klima4  Klima5  Klima6  Klima7  Klima8  KAPinfo1  KAPinfo2  KAPinfo3\nID4 Info1  Info2  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  KAPinfo1  KAPinfo2  KAPinfo3\nID5 Info1  Info2  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  KAPinfo1  KAPinfo2  KAPinfo3\nID6 Info1  Info2  Klima3  Klima4  Klima5  Klima6  Klima7  Klima8  KAPinfo1  KAPinfo2  KAPinfo3\n</code></pre>\n\n<p>Basically I want to overwrite the columns Info1 and Info2 in the right table (Klima) with the information from the left table (KAP) while keeping extra columns in the right table (Klima)</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1521011894, "post_id": 49270917, "comment_id": 85546277, "body": "Please <a href=\"https://stackoverflow.com/posts/49270917/edit\">edit</a> your original question and add the code you already tried. Stack Overflow is not a free code writing service."}, {"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 1, "creation_date": 1521012010, "post_id": 49270917, "comment_id": 85546325, "body": "Transpose or pivot table come to mind..."}], "answers": [{"tags": [], "owner": {"reputation": 16, "user_id": 9492251, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/96e90007240b82724dadf98e87752303?s=128&d=identicon&r=PG", "display_name": "G S Misra", "link": "https://stackoverflow.com/users/9492251/g-s-misra"}, "is_accepted": true, "score": 0, "last_activity_date": 1521039738, "last_edit_date": 1521039738, "creation_date": 1521039158, "answer_id": 49280864, "question_id": 49270917, "link": "https://stackoverflow.com/questions/49270917/ms-excel-find-the-value-based-on-row-and-column-reference/49280864#49280864", "title": "Ms Excel - Find the value based on row and column reference", "body": "<p>Add a helper column to your data </p>\n\n<ol>\n<li><code>=trim(b2)&amp;text(a2,\"ddmmyyyy\")</code></li>\n<li>Filldown the entire cells having data in the left.</li>\n<li>In target range put the following formula\n<code>=IFERROR(VLOOKUP(TRIM($I2)&amp;TEXT(J$1,\"DDMMYYYY\"),CHOOSE({1,2},$D$2:$D$10,$C$2:$C$10),2,0),\"\")</code></li>\n</ol>\n\n<p>Your target table start from <code>I2</code> filled with names and <code>J1-AM1</code> with dates.</p>\n"}], "owner": {"reputation": 3, "user_id": 7829292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fb584b130c06624e9ad7ce16d0a2384?s=128&d=identicon&r=PG&f=1", "display_name": "Perumal S", "link": "https://stackoverflow.com/users/7829292/perumal-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 49280864, "answer_count": 1, "score": -2, "last_activity_date": 1521039738, "creation_date": 1521008329, "last_edit_date": 1531161705, "question_id": 49270917, "link": "https://stackoverflow.com/questions/49270917/ms-excel-find-the-value-based-on-row-and-column-reference", "title": "Ms Excel - Find the value based on row and column reference", "body": "<h2>Table Data</h2>\n\n<pre><code>Date        Name    Login Hours\n-----      -----    ----------\n01/01/2018 - Peru   -   8:00 AM    \n01/01/2018 - Jethro -   11:00 AM    \n01/01/2018 - Ashraf  -  8:00 AM    \n01/01/2018 - Edcel   -  9:00 AM    \n02/01/2018 - Peru    -  9:00 AM    \n02/01/2018 - Jethro  -  8:15 AM    \n02/01/2018 - Ashraf  -  9:00 AM    \n02/01/2018 - Edcel   -  2:00 PM    \n03/01/2018 - Peru    -  8:15 AM\n</code></pre>\n\n<p>How can I get the data as in the below format,</p>\n\n<ol>\n<li>Name as Rows </li>\n<li>Date as Columns</li>\n<li><p>Login Hours need to be placed against corresponding rows(\"\"name\"\") and columns(\"Date\"). </p>\n\n<pre><code>           01/01/2018   02/01/2018   03/01/2018\n</code></pre>\n\n<ol>\n<li>Peru</li>\n<li>Jethro</li>\n<li>Ashraf</li>\n<li>Edcel</li>\n</ol></li>\n</ol>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "edited": false, "score": 2, "creation_date": 1521008371, "post_id": 49270789, "comment_id": 85544742, "body": "Use VLOOKUP formula in a column and then filter on non-error values."}], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 4, "last_activity_date": 1521008370, "creation_date": 1521008370, "answer_id": 49270928, "question_id": 49270789, "link": "https://stackoverflow.com/questions/49270789/filter-sheet-data-based-on-a-column-value-exists-in-another-sheet/49270928#49270928", "title": "Filter sheet data based on a column value exists in another sheet", "body": "<p>Save the values in the Other sheet in an array, in my code below it's <code>FilterArr</code>, and then you can <code>AutoFilter</code> according to the values in this array by using <code>Criteria1:=FilterArr</code>.</p>\n\n<p>More explanations inside the code below as comments:</p>\n\n<p><strong><em>Code</em></strong></p>\n\n<pre><code>Option Explicit\n\nSub FilterAccordingtoValuesInOtherSheet()\n\nDim Sht1 As Worksheet, sht2 As Worksheet\nDim FilterArr As Variant\nDim LastRow As Long\n\nSet Sht1 = ThisWorkbook.Sheets(\"Sheet1\") ' modify to your sheet's name where you have the data you want to filer\nSet sht2 = ThisWorkbook.Sheets(\"Sheet2\") ' modify to your sheet's name where you have values you want to use for the filter\n\nWith sht2\n    LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row ' get last row with data in column A\n\n    FilterArr = Application.Transpose(.Range(\"A2:A\" &amp; LastRow).Value2)  ' get the values from the second sheet to an array\nEnd With\n\nWith Sht1\n    LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row ' get last row with data in column A\n\n    ' set the Auto-Filter by column A, to the values in the array\n    .Range(\"A1:B\" &amp; LastRow).AutoFilter Field:=1, Criteria1:=FilterArr, Operator:=xlFilterValues\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2926, "user_id": 954093, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/a329dc7bfdaf20e9f46ea64db314292c?s=128&d=identicon&r=PG", "display_name": "Sandeep Thomas", "link": "https://stackoverflow.com/users/954093/sandeep-thomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 49270928, "answer_count": 1, "score": 0, "last_activity_date": 1521008370, "creation_date": 1521007763, "question_id": 49270789, "link": "https://stackoverflow.com/questions/49270789/filter-sheet-data-based-on-a-column-value-exists-in-another-sheet", "title": "Filter sheet data based on a column value exists in another sheet", "body": "<p>Ive a sheet with data similar to this</p>\n\n<pre><code>Users  Role\n-----------\nName1   a\nName2   b\nName3   c\nName4   d\nName5   e\nName6   f\nName7   g\n</code></pre>\n\n<p>Another Sheet</p>\n\n<pre><code>Users Req\n------\nName4\nName6\nName7\n</code></pre>\n\n<p>So the sheet data should be filtered based on the column values exists in second sheet. So after filtering the first sheet looks like this.</p>\n\n<pre><code>Users   Role\n-------------\nName4    d\nName6    f\nName7    g\n</code></pre>\n\n<p>How can we achieve like this</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 4, "creation_date": 1521001977, "post_id": 49269678, "comment_id": 85542734, "body": "On what line? which piece of code gives you the problem?  Use <code>Option Explicit</code> and declare your variables."}, {"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 1, "creation_date": 1521010833, "post_id": 49269678, "comment_id": 85545857, "body": "<code>Srd27</code> up to <code>Srd31</code> are objects, you need to use the <code>Set</code> keyword e.g. <code>Set Srd27 = IE.Document.getElementsByClassName(...)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 9489145, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-gr4rV0nzRjQ/AAAAAAAAAAI/AAAAAAAAHuc/BI8_-EMv2O4/photo.jpg?sz=128", "display_name": "&#214;mer Faruk iskender", "link": "https://stackoverflow.com/users/9489145/%c3%96mer-faruk-iskender"}, "edited": false, "score": 0, "creation_date": 1521039805, "post_id": 49272008, "comment_id": 85564786, "body": "i tried it with correct link but it says Product not found.  &#39;repeat for the rest of the code&#39;. it not pass to second one. its stuck at one. when i use f8 its passing."}], "tags": [], "owner": {"reputation": 1, "user_id": 9489761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/206079c7f53413572c08125f599e019c?s=128&d=identicon&r=PG&f=1", "display_name": "AdamW", "link": "https://stackoverflow.com/users/9489761/adamw"}, "is_accepted": false, "score": 0, "last_activity_date": 1521013050, "creation_date": 1521013050, "answer_id": 49272008, "question_id": 49269678, "link": "https://stackoverflow.com/questions/49269678/object-variable-or-with-block-variable-not-set-error-91/49272008#49272008", "title": "Object variable or with block variable not set - error &#39;91&#39;", "body": "<p>I have tested it and from what I can see it's that the address \"<a href=\"http://steamcommunity.com/market/listings/578080/Sneakers%20(WHITE)\" rel=\"nofollow noreferrer\">http://steamcommunity.com/market/listings/578080/Sneakers%20(WHITE)</a>\" gives you a page saying that the product could not be found. \nThe method getElementsByClassName generates error because the element you are looking for is not available on the loaded page. </p>\n\n<p>Try something like this:</p>\n\n<p><pre>\n       Sub Two()</p>\n\n<p>Set IE = CreateObject(\"InternetExplorer.Application\")</p>\n\n<p>IE.Navigate \"<a href=\"http://steamcommunity.com/market/listings/578080/Sneakers%20(WHITE)\" rel=\"nofollow noreferrer\">http://steamcommunity.com/market/listings/578080/Sneakers%20(WHITE)</a>\"\nDo: DoEvents: Loop Until IE.ReadyState = 4\non error resume next\nSrd27 = IE.Document.getElementsByClassName(\"market_commodity_orders_header_promote\")(0).innerText\non error goto 0\nIf Srd27 &lt;> \"\" then\n   ActiveSheet.Range(\"D27\").Value = Srd27\nElse\n   ActiveSheet.Range(\"D27\").Value = \"Product not found\"\nend if</p>\n\n<p>'repeat for the rest of the code</p>\n\n<code>IE.Quit\nEnd Sub\n</code></pre>\n\n<p></p>\n\n<p>And of course I am always encouraging to use Option Explicit and declare all variables.</p>\n"}, {"comments": [{"owner": {"reputation": 49, "user_id": 9489145, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-gr4rV0nzRjQ/AAAAAAAAAAI/AAAAAAAAHuc/BI8_-EMv2O4/photo.jpg?sz=128", "display_name": "&#214;mer Faruk iskender", "link": "https://stackoverflow.com/users/9489145/%c3%96mer-faruk-iskender"}, "edited": false, "score": 0, "creation_date": 1521039739, "post_id": 49272517, "comment_id": 85564726, "body": "it works well for single but if i try to get multiple result, it did not show result of second one, three,four ..."}, {"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "reply_to_user": {"reputation": 49, "user_id": 9489145, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-gr4rV0nzRjQ/AAAAAAAAAAI/AAAAAAAAHuc/BI8_-EMv2O4/photo.jpg?sz=128", "display_name": "&#214;mer Faruk iskender", "link": "https://stackoverflow.com/users/9489145/%c3%96mer-faruk-iskender"}, "edited": false, "score": 0, "creation_date": 1521040200, "post_id": 49272517, "comment_id": 85565091, "body": "You need to loop through the elements collection. See edit."}, {"owner": {"reputation": 49, "user_id": 9489145, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-gr4rV0nzRjQ/AAAAAAAAAAI/AAAAAAAAHuc/BI8_-EMv2O4/photo.jpg?sz=128", "display_name": "&#214;mer Faruk iskender", "link": "https://stackoverflow.com/users/9489145/%c3%96mer-faruk-iskender"}, "edited": false, "score": 0, "creation_date": 1521040716, "post_id": 49272517, "comment_id": 85565478, "body": "I don&#39;t know how to do that. I am sorry :("}, {"owner": {"reputation": 49, "user_id": 9489145, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-gr4rV0nzRjQ/AAAAAAAAAAI/AAAAAAAAHuc/BI8_-EMv2O4/photo.jpg?sz=128", "display_name": "&#214;mer Faruk iskender", "link": "https://stackoverflow.com/users/9489145/%c3%96mer-faruk-iskender"}, "edited": false, "score": 0, "creation_date": 1521040987, "post_id": 49272517, "comment_id": 85565660, "body": "why is it working when i open vba and pres F8 ? when i use macro in excel it&#39;s not working"}], "tags": [], "owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1521040166, "last_edit_date": 1521040166, "creation_date": 1521014853, "answer_id": 49272517, "question_id": 49269678, "link": "https://stackoverflow.com/questions/49269678/object-variable-or-with-block-variable-not-set-error-91/49272517#49272517", "title": "Object variable or with block variable not set - error &#39;91&#39;", "body": "<p>You need to set the object and validate its state before trying to access its properties.</p>\n\n<p><strong>getElementsByClassName()</strong></p>\n\n<blockquote>\n  <p>Returns a collection of objects with the same class attribute value.</p>\n</blockquote>\n\n<pre><code>Sub Two()\n\n    Dim IE As Object, Srd27 As Object\n\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n    IE.Navigate \"http://steamcommunity.com/market/listings/578080/Sneakers%20(WHITE)\"\n    Do: DoEvents: Loop Until IE.ReadyState = 4\n\n    Set Srd27 = IE.Document.getElementsByClassName(\"market_commodity_orders_header_promote\")(0)\n\n    If Not Srd27 Is Nothing Then\n        ActiveSheet.Range(\"D27\").Value = Srd27.innerText\n    End If\nEnd Sub\n</code></pre>\n\n<p><br>   </p>\n\n<h2>Edit:</h2>\n\n<p>To get multiple results, you have to loop through the elements collection and get the innerText of each element.</p>\n\n<pre><code>Dim elements As Object, element as Object\n\nSet elements = IE.Document.getElementsByClassName(\"market_commodity_orders_header_promote\")\n\nIf Not elements Is Nothing Then\n    For Each element in elements\n        Debug.Print element.innerText\n    Next\nEnd if\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 9489145, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-gr4rV0nzRjQ/AAAAAAAAAAI/AAAAAAAAHuc/BI8_-EMv2O4/photo.jpg?sz=128", "display_name": "&#214;mer Faruk iskender", "link": "https://stackoverflow.com/users/9489145/%c3%96mer-faruk-iskender"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 307, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1521812144, "creation_date": 1521000805, "last_edit_date": 1521812144, "question_id": 49269678, "link": "https://stackoverflow.com/questions/49269678/object-variable-or-with-block-variable-not-set-error-91", "title": "Object variable or with block variable not set - error &#39;91&#39;", "body": "<pre><code>    Sub Two()\n\nSet IE = CreateObject(\"InternetExplorer.Application\")\n\nIE.Navigate \"http://example.com/market/listings/578080/Sneakers%20(WHITE)\"\nDo: DoEvents: Loop Until IE.ReadyState = 4\nSrd27 = IE.Document.getElementsByClassName(\"market_commodity_orders_header_promote\")(0).innerText\nActiveSheet.Range(\"D27\").Value = Srd27\n\nIE.Navigate \"http://example.com/market/listings/578080/Floral%20Shirt%20(Black)\"\nDo: DoEvents: Loop Until IE.ReadyState = 4\nSrd28 = IE.Document.getElementsByClassName(\"market_commodity_orders_header_promote\")(0).innerText\nActiveSheet.Range(\"D28\").Value = Srd28\n\nIE.Navigate \"http://example.com/market/listings/578080/Tracksuit%20Top%20(Yellow)\"\nDo: DoEvents: Loop Until IE.ReadyState = 4\nSrd29 = IE.Document.getElementsByClassName(\"market_commodity_orders_header_promote\")(0).innerText\nActiveSheet.Range(\"D29\").Value = Srd29\n\nIE.Navigate \"http://example.com/market/listings/578080/School%20Jacket\"\nDo: DoEvents: Loop Until IE.ReadyState = 4\nSrd30 = IE.Document.getElementsByClassName(\"market_commodity_orders_header_promote\")(0).innerText\nActiveSheet.Range(\"D30\").Value = Srd30\n\nIE.Navigate \"http://example.com/market/listings/578080/Leather%20Bootcut%20Pants\"\nDo: DoEvents: Loop Until IE.ReadyState = 4\nSrd31 = IE.Document.getElementsByClassName(\"market_commodity_orders_header_promote\")(0).innerText\nActiveSheet.Range(\"D31\").Value = Srd31\n\n    IE.Quit\n    End Sub\n</code></pre>\n\n<p>If i use <kbd>F8</kbd> key in Visual Basic app it works sometimes. But when I use macros in Excel its saying </p>\n\n<blockquote>\n  <p>'object variable or with block variable not set - error '91''</p>\n</blockquote>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1521000442, "post_id": 49269456, "comment_id": 85542344, "body": "Meaning you are getting all values after <code>[?-???]</code> right?"}, {"owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "edited": false, "score": 2, "creation_date": 1521000843, "post_id": 49269456, "comment_id": 85542449, "body": "Please post some sample data instead of snapshots."}, {"owner": {"reputation": 1554, "user_id": 6833290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wyRfl.jpg?s=128&g=1", "display_name": "Tony M", "link": "https://stackoverflow.com/users/6833290/tony-m"}, "edited": false, "score": 0, "creation_date": 1521002464, "post_id": 49269456, "comment_id": 85542847, "body": "Your example output does not seem to correspond to the code you&#39;ve provided, so it&#39;s not clear to me exactly what you want. You could solve that by providing an example of the input and the output for a few specific cases. Also, if your data is delimited properly, you might be able to solve this without macros using data--&gt;text to columns"}, {"owner": {"reputation": 333, "user_id": 3713336, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/6425c70806faa65b4a79711c38b0edd6?s=128&d=identicon&r=PG&f=1", "display_name": "user3713336", "link": "https://stackoverflow.com/users/3713336/user3713336"}, "reply_to_user": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1521030151, "post_id": 49269456, "comment_id": 85557685, "body": "@L42 yes I want to extract all the values after [&#39;&#39;&#39;&#39;]example[&#39;&#39;&#39;&#39;&#39;&#39;]....so extract example"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1521033833, "post_id": 49269456, "comment_id": 85560274, "body": "@user3713336, did you try any of the answers?"}], "answers": [{"comments": [{"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1521038833, "post_id": 49269889, "comment_id": 85564028, "body": "@user3713336: latest version outputs the results sequentially by rows, then by columns"}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": true, "score": 5, "last_activity_date": 1521038624, "last_edit_date": 1521038624, "creation_date": 1521002368, "answer_id": 49269889, "question_id": 49269456, "link": "https://stackoverflow.com/questions/49269456/how-can-i-get-the-text-after-the-second-bracket-in-vba/49269889#49269889", "title": "How can I get the text after the second bracket in VBA?", "body": "<p>Try splitting by the second bracket, then using <code>Left()</code> to determine the length of the string</p>\n\n<hr>\n\n<pre><code>Option Explicit\n\nPublic Sub GetStringAfter2ndBracketInSequentialColumns()\n    Dim i As Long, j As Long, nextRow As Long, ub As Long, lr As Long\n    Dim extract As Variant, found As Long, nextCol As Long\n\n    With Sheet1\n        lr = .UsedRange.Rows.Count\n        nextRow = 1\n        nextCol = 2\n\n        For i = 1 To lr\n            extract = Split(.Cells(i, 1).Value2, \"]\")\n            ub = UBound(extract)\n            If ub &gt; 0 Then\n\n                For j = 0 To ub\n                    If Len(extract(j)) &gt; 0 Then\n                      If Left(extract(j), 1) &lt;&gt; \"[\" Then\n\n                        found = InStr(1, extract(j), \"[\")\n                        If found = 0 Then found = Len(extract(j)) + 1\n                        .Cells(nextRow, nextCol).Value2 = Left(extract(j), found - 1)\n                        nextRow = nextRow + 1\n                        If nextRow &gt; lr Then\n                            nextRow = 1\n                            nextCol = nextCol + 1\n                        End If\n                      End If\n                    End If\n                Next j\n            End If\n        Next i\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Test results:</p>\n\n<p><a href=\"https://i.stack.imgur.com/WAFYA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WAFYA.png\" alt=\"Results\"></a></p>\n\n<p>This is how one of the strings (cell A1) looks like after the split</p>\n\n<p><a href=\"https://i.stack.imgur.com/Q9Lt5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Q9Lt5.png\" alt=\"split\"></a></p>\n\n<hr>\n\n<p><strong>Edit</strong>: measurements for all solutions provided so far:</p>\n\n<pre><code>Timers (with 100,000 rows)\n\n0.824 secs - TextToColumns  (0.81054, 0.82812) - Output: same row split to many cols\n1.679 secs - Split cells    (1.66796, 1.64453) - Output: sequentially by rows, then cols\n3.757 secs - ArrayList      (3.69140, 3.78125) - Output: sequentially in one column\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "is_accepted": false, "score": 1, "last_activity_date": 1521021409, "creation_date": 1521021409, "answer_id": 49274589, "question_id": 49269456, "link": "https://stackoverflow.com/questions/49269456/how-can-i-get-the-text-after-the-second-bracket-in-vba/49274589#49274589", "title": "How can I get the text after the second bracket in VBA?", "body": "<p>Here's little different approach using <code>ArrayList</code></p>\n\n<pre><code>Dim rng As Range\nDim arl As Object\nDim strVal\nDim i As Long\nSet arl = CreateObject(\"System.Collections.ArrayList\")\nFor Each rng In Range(\"A1:A\" &amp; Range(\"A\" &amp; Rows.Count).End(xlUp).Row)\n    strVal = Split(Replace(rng.Value, \"[\", \"]\"), \"]\")\n    For i = 2 To UBound(strVal) Step 2\n        arl.Add CStr(strVal(i))\n    Next i\nNext rng\nFor i = 0 To arl.Count - 1\n    Range(\"B\" &amp; i + 1).Value = arl.Item(i)\nNext i\nSet arl = Nothing\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 1, "creation_date": 1521034147, "post_id": 49276893, "comment_id": 85560520, "body": "This is the fastest and simplest: +1"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 3, "last_activity_date": 1521027682, "creation_date": 1521027682, "answer_id": 49276893, "question_id": 49269456, "link": "https://stackoverflow.com/questions/49269456/how-can-i-get-the-text-after-the-second-bracket-in-vba/49276893#49276893", "title": "How can I get the text after the second bracket in VBA?", "body": "<p>here's a short and quite fast approach</p>\n\n<pre><code>Sub main()\n    With Range(\"A1\", Cells(Rows.Count, 1).End(xlUp))\n        .Replace what:=\"[*]\", replacement:=\"|\", lookat:=xlPart\n        .TextToColumns DataType:=xlDelimited, Other:=True, OtherChar:=\"|\"\n        .Columns(1).Delete xlToLeft\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 333, "user_id": 3713336, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/6425c70806faa65b4a79711c38b0edd6?s=128&d=identicon&r=PG&f=1", "display_name": "user3713336", "link": "https://stackoverflow.com/users/3713336/user3713336"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "accepted_answer_id": 49269889, "answer_count": 3, "score": 3, "last_activity_date": 1582168001, "creation_date": 1520999214, "last_edit_date": 1582168001, "question_id": 49269456, "link": "https://stackoverflow.com/questions/49269456/how-can-i-get-the-text-after-the-second-bracket-in-vba", "title": "How can I get the text after the second bracket in VBA?", "body": "<p>Trying to get the value after the second bracket, I try to work with this one i created but it's not working properly and getting more complicated while I am having more brackets in each row.. Any idea. I uploaded couple images to understand the input and output.</p>\n\n<pre><code>Sub stringtest()\n\n    Dim text As String, i As Long, firstbracket As Long, secondbracket As Long\n    Dim extractTest As String, y As Long\n\n    y = 1\n    For i = 1 To 10\n\n        text = Worksheets(\"Sheet1\").Cells(i, 1).Value\n        firstbracket = InStr(1, text, \"[\")\n        secondbracket = InStr(firstbracket + 1, text, \"]\")\n        extractTest = Mid(text, firstbracket + 1, secondbracket)\n\n        Worksheets(\"Sheet1\").Cells(y, 2).Value = extractTest\n        y = y + 1\n\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/go1iI.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/go1iI.jpg\" alt=\"enter image description here\"></a>   <a href=\"https://i.stack.imgur.com/6ixVC.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6ixVC.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "vbscript", "schedule", "bloomberg"], "comments": [{"owner": {"reputation": 1, "user_id": 4269188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uebId.jpg?s=128&g=1", "display_name": "mingmac", "link": "https://stackoverflow.com/users/4269188/mingmac"}, "edited": false, "score": 0, "creation_date": 1520998334, "post_id": 49269311, "comment_id": 85541855, "body": "Correct for wait duration I want just 10 seconds for Bloomberg to refresh data."}, {"owner": {"reputation": 721, "user_id": 7889129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0oYIA.jpg?s=128&g=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7889129/maddy"}, "edited": false, "score": 0, "creation_date": 1521015315, "post_id": 49269311, "comment_id": 85547891, "body": "you are waiting only 1 second for Bloomberg to refresh in this line <code>Application.OnTime Now + TimeSerial(0, 0, 1), &quot;WaitTillUpdateComplete&quot;.</code> you are passing one second in this fuction <code>TimeSerial( hour, minute, second )</code>. I think you need to pass <code>TimePassed </code> variable in place of <code>1</code>"}, {"owner": {"reputation": 1, "user_id": 4269188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uebId.jpg?s=128&g=1", "display_name": "mingmac", "link": "https://stackoverflow.com/users/4269188/mingmac"}, "reply_to_user": {"reputation": 721, "user_id": 7889129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0oYIA.jpg?s=128&g=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7889129/maddy"}, "edited": false, "score": 0, "creation_date": 1521082754, "post_id": 49269311, "comment_id": 85584624, "body": "What do you mean that I have to pass TImepassed variable in place of 1? Thanks."}, {"owner": {"reputation": 721, "user_id": 7889129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0oYIA.jpg?s=128&g=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7889129/maddy"}, "edited": false, "score": 0, "creation_date": 1521082946, "post_id": 49269311, "comment_id": 85584660, "body": "You are calling WaitTillUpdateComplete sub each and every second. bloomberg need more time to refresh."}], "answers": [{"tags": [], "owner": {"reputation": 23, "user_id": 9269741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2d6e7ad085554c773a12c24aae219a9?s=128&d=identicon&r=PG&f=1", "display_name": "haas", "link": "https://stackoverflow.com/users/9269741/haas"}, "is_accepted": false, "score": 1, "last_activity_date": 1526303310, "creation_date": 1526303310, "answer_id": 50331109, "question_id": 49269311, "link": "https://stackoverflow.com/questions/49269311/task-schedule-open-excel-file-refresh-bloomberg-data-then-save-and-close-file/50331109#50331109", "title": "Task Schedule Open Excel file, Refresh Bloomberg Data, then Save and Close File", "body": "<p>This is an old threat, but maybe this answer will help others.\nThe code below is working for me. The computer is set for it to never sleep or lock the screen.</p>\n\n<p>The computer is using Office 365 and excel 2016.</p>\n\n<pre><code>      '   a .vbs file is just a text file containing visual basic code that has the extension renamed from .txt  to .vbs\n\n'Write Excel.xls  Sheet's full path here\nstrPath = \"myPath\" \n\n\n'Create an Excel instance and set visibility of the instance\nSet objApp = CreateObject(\"Excel.Application\") \nobjApp.Visible = False   '   or True \n\nSet wbToRun = objApp.Workbooks.Open(strPath) \n\n\nStartAutomation\n\nSub StartAutomation()\n    Dim oAddin\n    Set oAddin = objApp.Workbooks.Open(\"C:\\blp\\API\\Office Tools\\BloombergUI.xla\")\n    objApp.Addins(\"Bloomberg Excel Tools\").Installed = False\n    objApp.Addins(\"Bloomberg Excel Tools\").Installed = True\n\n    If Not oAddin Is Nothing Then\n        objApp.DisplayAlerts = False\n        objApp.Calculate\n        objApp.Run \"RefreshAllStaticData\"\n        objApp.Calculate\n        objApp.Run \"RefreshAllStaticData\"\n\n        WaitTillUpdateComplete\n\n    End If\nEnd Sub\n\nDim t\nt = 0\n\nPrivate Sub WaitTillUpdateComplete()\n    objApp.Calculate\n    If objApp.WorksheetFunction.CountIf(objApp.Range(\"rng_inWorkbook\"),\"#NAME?\") &gt; 0 Then\n        Application.OnTime Now + TimeValue(\"00:00:15\"), \"WaitTillUpdateComplete\"\n    ElseIf objApp.WorksheetFunction.CountIf(objApp.Range(\"rng_inWorkbook\"),\"#N/A\") &gt; 0 Then\n        Application.OnTime Now + TimeValue(\"00:00:15\"), \"WaitTillUpdateComplete\"\n    ElseIf objApp.WorksheetFunction.CountIf(objApp.Range(\"rng_inWorkbook\"),\"#N/A Requesting Data...\") &gt; 0 Then\n        If t &lt; 5 Then\n            t = t+ 1\n            waitlonger\n        Else\n            Exit Sub\n        End If\n    Else\n        Exit Sub\n    End If\n\nEnd Sub\n\nSub waitlonger()\n    Dim x\n    x = Now + TimeValue(\"00:00:40\")\n    Do While x &gt; Now\n    Loop\n    objApp.Calculate\nEnd Sub\n\n\nwbToRun.Save \nwbToRun.Close\nobjApp.DisplayAlerts = False \nobjApp.Quit \n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4269188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uebId.jpg?s=128&g=1", "display_name": "mingmac", "link": "https://stackoverflow.com/users/4269188/mingmac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4147, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1526303310, "creation_date": 1520998223, "last_edit_date": 1592644375, "question_id": 49269311, "link": "https://stackoverflow.com/questions/49269311/task-schedule-open-excel-file-refresh-bloomberg-data-then-save-and-close-file", "title": "Task Schedule Open Excel file, Refresh Bloomberg Data, then Save and Close File", "body": "<p>I have tried to collect all codes I could have done and it still not work for me.\nWhat I want to do is to Schedule Task of my Excel file and I have code &quot;RunExcel.vbs&quot; as attached but still not working.</p>\n<p>Reference Link: <a href=\"https://stackoverflow.com/questions/22771185/how-to-set-recurring-schedule-for-xlsm-file-using-windows-task-scheduler\">How to set recurring schedule for xlsm file using Windows Task Scheduler</a></p>\n<p>Reference Link: <a href=\"https://www.mrexcel.com/forum/excel-questions/794869-vb-script-refresh-bloomberg-feed-excel.html\" rel=\"nofollow noreferrer\">https://www.mrexcel.com/forum/excel-questions/794869-vb-script-refresh-bloomberg-feed-excel.html</a></p>\n<ol>\n<li>Open file \u201cPriceRealTIme.xlsm\u201d(Macro-enabled workbook) which is inside \u201cTEst folder\u201d.</li>\n<li>Ignore to update link</li>\n<li>Let it \u201cRefresh Bloomberg Data\u201d and \u201cwait for at 1 minutes or until it done refreshing\u201d.</li>\n<li>Once it\u2019s done. I want to copy paste Value of those columns by using Macro named \u201cCopyPaste\u201d.</li>\n<li>Finally, let it \u201cSave\u201d and  \u201cClose\u201d file.</li>\n</ol>\n<blockquote>\n<pre><code>  '   a .vbs file is just a text file containing visual basic code that has the extension renamed from .txt  to .vbs\n\n'Write Excel.xls  Sheet's full path here\nstrPath = &quot;C:\\Users\\chaic\\OneDrive\\Desktop\\TEst\\PriceRealTIme.xlsm&quot; \n\n'Write the macro name - could try including module name\nstrMacro = &quot;Sheet1.CopyPaste&quot; \n\n  'Create an Excel instance and set visibility of the instance\nSet objApp = CreateObject(&quot;Excel.Application&quot;) \nobjApp.Visible = True   '   or False \n\n  'Open workbook; Run Bloomberg Addin; Run Macro; Save Workbook with changes; Close; Quit Excel\nSet wbToRun = objApp.Workbooks.Open(strPath) \n\nPrivate Const BRG_ADDIN As String = &quot;BloombergUI.xla&quot;\nPrivate Const BRG_REFRESH As String = &quot;!RefreshAllStaticData&quot;\nPrivate TimePassed As Integer\n\nSub StartAutomation()\n    Dim oAddin As Workbook\n    On Error Resume Next\n    Set oAddin = Workbooks(BRG_ADDIN)\n    On Error GoTo 0\n    If Not oAddin Is Nothing Then\n        Application.Run BRG_ADDIN &amp; BRG_REFRESH\n        StartTimer\n    End If\nEnd Sub\n\nPrivate Sub StartTimer()\n    TimePassed = 10\n    WaitTillUpdateComplete\nEnd Sub\n\nSub WaitTillUpdateComplete()\n\n    If WorksheetFunction.CountIf(ThisWorkbook.Names(&quot;BloombergDataRange&quot;).RefersToRange,&quot;#VALUE!&quot;) = 0 Then\n        Application.StatusBar = &quot;Data update used &quot; &amp; TimePassed &amp; &quot;seconds, automation started at &quot; &amp; Now\n    Else\n        Application.StatusBar = &quot;Waiting for Bloomberg Data to finish updating (&quot; &amp; TimePassed &amp; &quot; seconds)...&quot;\n        TimePassed = TimePassed + 1\n        Application.OnTime Now + TimeSerial(0, 0, 1), &quot;WaitTillUpdateComplete&quot;\n    End If\n\nEnd Sub\n\nobjApp.Run strMacro     '   wbToRun.Name &amp; &quot;!&quot; &amp; strMacro \nwbToRun.Save \nwbToRun.Close \nobjApp.Quit \n\n   'Leaves an onscreen message!\nMsgBox strPath &amp; &quot; &quot; &amp; strMacro &amp; &quot; macro and .vbs successfully completed!&quot;,         vbInformation\n</code></pre>\n</blockquote>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 1, "last_activity_date": 1521010491, "creation_date": 1521010491, "answer_id": 49271401, "question_id": 49268660, "link": "https://stackoverflow.com/questions/49268660/receiving-invalid-qualifier-error-when-attempting-to-access-a-form-and-subform-u/49271401#49271401", "title": "Receiving Invalid Qualifier error when attempting to access a form and subform using variable names?", "body": "<p>Remove those <code>.name</code> things. They're not supposed to be there:</p>\n\n<pre><code>With Forms!myForm.mySubForm.Form.RecordsetClone\n   ...\nEnd With\n</code></pre>\n\n<p>If you're going to use that declared subform variable, it's even more simple:</p>\n\n<pre><code>With mySubForm.Form.RecordsetClone\n    ...\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 3393, "user_id": 2373410, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/684a479ecdc16beb9c6ddd01073f2fee?s=128&d=identicon&r=PG", "display_name": "Pangu", "link": "https://stackoverflow.com/users/2373410/pangu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 336, "favorite_count": 0, "accepted_answer_id": 49271401, "answer_count": 1, "score": 0, "last_activity_date": 1594636704, "creation_date": 1520992740, "last_edit_date": 1594636704, "question_id": 49268660, "link": "https://stackoverflow.com/questions/49268660/receiving-invalid-qualifier-error-when-attempting-to-access-a-form-and-subform-u", "title": "Receiving Invalid Qualifier error when attempting to access a form and subform using variable names?", "body": "<p>I am trying perform a <code>RecordsetClone</code> but I keep getting a </p>\n\n<blockquote>\n  <p><strong>Invalid Qualifier</strong></p>\n</blockquote>\n\n<p>compile error.</p>\n\n<p>Currently I have a form, and within it I have a subform that contains a <code>Datasheet</code>. I created a function to pass in the name of the form as well as name of the subform:</p>\n\n<pre><code>Public Sub testModel(nameOfForm As String, nameOfSubform As String)\n    Dim myForm As Access.Form\n    Dim mySubForm As Access.SubForm\n\n    If formIsOpen(nameOfForm) = False Then\n        DoCmd.OpenForm nameOfForm, acNormal\n    End If\n\n    Set myForm = Forms(nameOfForm)\n    Set mySubForm = myForm.Controls(nameOfSubform )\n\n    With Forms!myForm.name.mySubForm.name.Form.RecordsetClone\n       ...\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>The reason for using a variable for the form and subform is because different forms and subforms will be using this function.</p>\n\n<p>The error is definitely involved with the syntax <code>Forms!myForm.name.mySubForm .name.Form.RecordsetClone</code>, and I'm pretty confident it is incorrect.</p>\n\n<p>I've also tried:</p>\n\n<pre><code>Forms!myForm.name.mySubForm.Form.RecordsetClone\n</code></pre>\n\n<p>If I replaced it, directly using the name of the form and subform name, there is no issue, i.e.:</p>\n\n<pre><code>Forms!frmParentForm.frmChildSubForm.Form.RecordsetClone\n</code></pre>\n\n<p>I have printed out the name of <code>myForm</code> and <code>mySubForm</code> via its <code>.name</code> property and it appears to display the correct name for each.</p>\n\n<p>Can someone point me in the right direction on how exactly I can use variable names in place of the actual names of my form and subform? What should the correct syntax be?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba", "vlookup"], "comments": [{"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1520993811, "post_id": 49268601, "comment_id": 85540857, "body": "Assuming the dropdown list is a <b>Data Validation</b> list, you don&#39;t need VBA. Just use vlookup formula on B3 (may as well add <b>IFERROR</b>). Otherwise you need to account this on Worksheet_Change event for any changes on A3."}, {"owner": {"reputation": 15, "user_id": 9459861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7eca57e71bee04e2ed44ef78d530b987?s=128&d=identicon&r=PG&f=1", "display_name": "user9459861", "link": "https://stackoverflow.com/users/9459861/user9459861"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1521002871, "post_id": 49268601, "comment_id": 85542954, "body": "I wanted to use VBA code because the objective of this project is to enter data on DailySales and hit transfer button to move data to respective sheets based on AccountID. This will remove the formula on the cell. Need to create a VBA code formula to auto generate on the column upto 1000 rows not necessarily the single cell."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1521040917, "post_id": 49268601, "comment_id": 85565609, "body": "Could you show some sample data with expected output? It seems like you may be wanting to apply a formula to a range."}, {"owner": {"reputation": 15, "user_id": 9459861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7eca57e71bee04e2ed44ef78d530b987?s=128&d=identicon&r=PG&f=1", "display_name": "user9459861", "link": "https://stackoverflow.com/users/9459861/user9459861"}, "edited": false, "score": 0, "creation_date": 1521082258, "post_id": 49268601, "comment_id": 85584531, "body": "AccountName|AccountID|Date|VocherNumber|MS/HSD|Lts|Rate\tAmou&zwnj;&#8203;nt K Bhasker Rao|7|3/13/2018|234567|MS|35|67.71|2369.85  This is the Daily sales Worksheet"}, {"owner": {"reputation": 15, "user_id": 9459861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7eca57e71bee04e2ed44ef78d530b987?s=128&d=identicon&r=PG&f=1", "display_name": "user9459861", "link": "https://stackoverflow.com/users/9459861/user9459861"}, "edited": false, "score": 0, "creation_date": 1521082327, "post_id": 49268601, "comment_id": 85584542, "body": "AccountName\tAccountID Waterworks\t1 Karthika Enterprises\t2 Laxmi Enterprises\t3 My Home Ready Mix\t4 MSR PTC\t5 Hyd Rock Sand\t6 K Bhasker Rao\t7    This is the accounts Worksheet.   Need to be able to do a lookup on the Dailysheets worksheet AccountID column based on drop down selection on the accountName."}], "answers": [{"tags": [], "owner": {"reputation": 15, "user_id": 9459861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7eca57e71bee04e2ed44ef78d530b987?s=128&d=identicon&r=PG&f=1", "display_name": "user9459861", "link": "https://stackoverflow.com/users/9459861/user9459861"}, "is_accepted": true, "score": 0, "last_activity_date": 1521495282, "last_edit_date": 1521495282, "creation_date": 1521166691, "answer_id": 49312215, "question_id": 49268601, "link": "https://stackoverflow.com/questions/49268601/vlookup-on-strings/49312215#49312215", "title": "Vlookup on strings", "body": "<pre><code>Range(\"B3\").FormulaR1C1 = _\n    \"=IF(ISBLANK(RC[-1]),\"\"\"\",VLOOKUP(RC[-1],Accounts!R2C1:R40C2,2,))\"\nRange(\"B3\").Copy\nRange(\"B3:B1000\").PasteSpecial (xlPasteAll)\n</code></pre>\n\n<p>This is the working code. If someone else is also looking for.</p>\n"}], "owner": {"reputation": 15, "user_id": 9459861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7eca57e71bee04e2ed44ef78d530b987?s=128&d=identicon&r=PG&f=1", "display_name": "user9459861", "link": "https://stackoverflow.com/users/9459861/user9459861"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "accepted_answer_id": 49312215, "answer_count": 1, "score": 0, "last_activity_date": 1521495282, "creation_date": 1520992349, "last_edit_date": 1521040248, "question_id": 49268601, "link": "https://stackoverflow.com/questions/49268601/vlookup-on-strings", "title": "Vlookup on strings", "body": "<p>I am trying to put a dropdown on one cell in the sheet and based on the drop down selection need to have a lookup on the adjacent cell with range of values specified in another sheet.</p>\n\n<p>Spent considerate time on this and couldn't figure out since I am a tableau developer and VBA is not my strong suit.Can someone help me on this one. Thanks!</p>\n\n<pre><code>Worksheets(\"DailySales\").Range(\"B3\") = Application.WorksheetFunction.VLookup( _\n    Worksheets(\"DailySales\").Range(\"A3\"), Worksheets(\"Accounts\").Range(\"A2:B40\"), 2, False)\n</code></pre>\n\n<p>DailySales.A3 has the dropdown list of Account Names based on the selected value B3 needs to be populated with the AccountId's from <code>Accounts.Range(\"A2:B40\")</code></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 349, "user_id": 5581639, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/dd39075f66c34597ec596dc52e653d28?s=128&d=identicon&r=PG&f=1", "display_name": "JG7", "link": "https://stackoverflow.com/users/5581639/jg7"}, "edited": false, "score": 0, "creation_date": 1520995433, "post_id": 49268161, "comment_id": 85541190, "body": "I\u2019m not familiar with Oracle, but you are opening and closing your connection string by using double quotes throughout it. Replace interior quotes with singles instead. Also, you have an extra space before your SELECT statement. Remove it and see what happens."}, {"owner": {"reputation": 45, "user_id": 2474963, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ea8ebe45d141c0a7ded1426d37ff3dff?s=128&d=identicon&r=PG", "display_name": "Lokhi_999", "link": "https://stackoverflow.com/users/2474963/lokhi-999"}, "reply_to_user": {"reputation": 349, "user_id": 5581639, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/dd39075f66c34597ec596dc52e653d28?s=128&d=identicon&r=PG&f=1", "display_name": "JG7", "link": "https://stackoverflow.com/users/5581639/jg7"}, "edited": false, "score": 0, "creation_date": 1520996163, "post_id": 49268161, "comment_id": 85541353, "body": "Thanks Joey! Interior quotes are only used as example in the code."}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1520999642, "post_id": 49268161, "comment_id": 85542156, "body": "No way to check but double check if you have the correct connection string. You can check for connection strings <a href=\"https://www.connectionstrings.com/oracle/\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 45, "user_id": 2474963, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ea8ebe45d141c0a7ded1426d37ff3dff?s=128&d=identicon&r=PG", "display_name": "Lokhi_999", "link": "https://stackoverflow.com/users/2474963/lokhi-999"}, "edited": false, "score": 0, "creation_date": 1521004788, "post_id": 49268161, "comment_id": 85543456, "body": "I have changed the code above now. I am getting error as missing expression."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1521019988, "post_id": 49268161, "comment_id": 85550588, "body": "Have you tried typing your SQL command in just 1 line when you save it into variable and without <code>Chr(10)</code>?"}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 1, "creation_date": 1521046308, "post_id": 49268161, "comment_id": 85569613, "body": "Why the need to do the line feeds?  you also have an extra comma.  Why not just use <code>sqlStr = &quot;SELECT distinct SAM_ID, DP_QV_Name From CMS.CMS_SAM_ALL_DATA&quot;</code>"}], "owner": {"reputation": 45, "user_id": 2474963, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ea8ebe45d141c0a7ded1426d37ff3dff?s=128&d=identicon&r=PG", "display_name": "Lokhi_999", "link": "https://stackoverflow.com/users/2474963/lokhi-999"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1286, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1521040276, "creation_date": 1520988523, "last_edit_date": 1531164843, "question_id": 49268161, "link": "https://stackoverflow.com/questions/49268161/data-source-name-too-long-error", "title": "Data Source name too long error", "body": "<p>I am new to VBA environment, I am trying to copy a specific Column's as \"Column1_name\",\"Column_name\"from table \"Table 1\".\nWhen i execute the below code i receive am error as \"Data Source name too Long\".\nAlso I am not sure whether my Sql code entered below is right to display column from oracle to excel.</p>\n\n<p>Need hand is debugging this error and query.\nThanks in advance</p>\n\n<p>Code - </p>\n\n<pre><code>    Sub data_audit()\n\n    Dim cn As ADODB.Connection\n    Set cn = New ADODB.Connection\n    Dim rs As New ADODB.Connection\n    Dim strConn As String\n    Dim sqlStr As String\n\n\nstrConn = \"Driver={Oracle in OraClient11g_home1}; Dbq=; Uid=; Pwd=;\"\ncn.Open strConn\nsqlStr = \"SELECT distinct\" &amp; Chr(10)\nsqlStr = sqlStr &amp; \"SAM_ID,\" &amp; Chr(10)\nsqlStr = sqlStr &amp; \"DP_QV_Name,\" &amp; Chr(10)\nsqlStr = sqlStr &amp; \"From CMS.CMS_SAM_ALL_DATA\"\nrs.Open sqlStr, strConn &lt;&lt;&lt;&lt;&lt;&lt; error\" Missing Expression\"\n    Sheets(\"Working\").Range(\"J2:g1047856\").ClearContents\n    Sheets(\"Working\").Cells(2, 1).CopyFromRecordset rs\n    rs.Close\n    cn.Close\n    Set cn = Nothing\n    MsgBox \" LOADED!\"\n\n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "shell", "vnc"], "answers": [{"tags": [], "owner": {"reputation": 349, "user_id": 5581639, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/dd39075f66c34597ec596dc52e653d28?s=128&d=identicon&r=PG&f=1", "display_name": "JG7", "link": "https://stackoverflow.com/users/5581639/jg7"}, "is_accepted": false, "score": 0, "last_activity_date": 1520994894, "creation_date": 1520994894, "answer_id": 49268909, "question_id": 49268142, "link": "https://stackoverflow.com/questions/49268142/open-vnc-from-a-list-or-ip-using-one-sub-only/49268909#49268909", "title": "Open vnc from a list or IP using one sub only", "body": "<p>How about a method where you select the cell with the IP address in it, then click a single button. The button would run a <code>main</code> method which runs the <code>shell</code> command with the value of the active cell. </p>\n\n<pre><code>Sub Main\nShell \u201cC:\\Programs Files\\VNC\\tvnviewer.exe\u201d &amp; ActiveCell.Value\nEnd Sub\n</code></pre>\n\n<p>You could even assign the Sub to a keyboard shortcut. Then a button isn\u2019t necessary for the user in the workbook all of the time. </p>\n"}], "owner": {"reputation": 11, "user_id": 2254463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bf02745354501b33c2154a53bd19dd1?s=128&d=identicon&r=PG", "display_name": "user2254463", "link": "https://stackoverflow.com/users/2254463/user2254463"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 155, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521040302, "creation_date": 1520988391, "last_edit_date": 1521040302, "question_id": 49268142, "link": "https://stackoverflow.com/questions/49268142/open-vnc-from-a-list-or-ip-using-one-sub-only", "title": "Open vnc from a list or IP using one sub only", "body": "<p>I have a list of ip addresses in an excel that connects to other machines remotely using vnc. in column A i have the IP and in column B I have the button that when clicked, it opens the vnc with the IP from the column A. Each of the below sub is assigned to the buttons in Column B-- I manually assigned them from the worksheet.</p>\n\n<p>This is my code:</p>\n\n<pre><code>Sub TVM_conn01()\n    Shell \"C:\\Program Files\\VNC\\tvnviewer.exe \" &amp; Cells(1, 1).Value, vbMaximizedFocus\nEnd Sub\nSub TVM_conn02()\n    Shell \"C:\\Program Files\\VNC\\tvnviewer.exe \" &amp; Cells(2, 1).Value, vbMaximizedFocus\nEnd Sub\nSub TVM_conn03()\n    Shell \"C:\\Program Files\\VNC\\tvnviewer.exe \" &amp; Cells(3, 1).Value, vbMaximizedFocus\nEnd Sub\nSub TVM_conn04()\n    Shell \"C:\\Program Files\\VNC\\tvnviewer.exe \" &amp; Cells(4, 1).Value, vbMaximizedFocus\nEnd Sub\nSub TVM_conn05()\n    Shell \"C:\\Program Files\\VNC\\tvnviewer.exe \" &amp; Cells(5, 1).Value, vbMaximizedFocus\nEnd Sub\n</code></pre>\n\n<p>Is there a way I can shorten this? I have 60 machines, I need to create the same for another new 300 machines. </p>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 619, "user_id": 487204, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/0c81d1d50e4d8751ecbae7b19866c681?s=128&d=identicon&r=PG", "display_name": "C0ppert0p", "link": "https://stackoverflow.com/users/487204/c0ppert0p"}, "edited": false, "score": 0, "creation_date": 1520989108, "post_id": 49268192, "comment_id": 85539794, "body": "I was about to answer my own question, when you beat me to it. Without a doubt your&#39;s is the fastest response to my questions ever! Thanks!!"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 619, "user_id": 487204, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/0c81d1d50e4d8751ecbae7b19866c681?s=128&d=identicon&r=PG", "display_name": "C0ppert0p", "link": "https://stackoverflow.com/users/487204/c0ppert0p"}, "edited": false, "score": 0, "creation_date": 1520989358, "post_id": 49268192, "comment_id": 85539854, "body": "<a href=\"https://stackoverflow.com/a/49268192/5781745\">:</a>D"}], "tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": true, "score": 0, "last_activity_date": 1520989050, "last_edit_date": 1520989050, "creation_date": 1520988744, "answer_id": 49268192, "question_id": 49268136, "link": "https://stackoverflow.com/questions/49268136/setting-a-range-in-vbs-not-working-as-expected/49268192#49268192", "title": "setting a range in vbs not working as expected", "body": "<p>Declare your worksheet, and then use that with your range <code>Cells()</code> objects:</p>\n\n<pre><code>Dim ws As Worksheet\nSet ws = ThisWorkbook.Worksheets(\"Key\")\n\nWith ws\n    Set s1 = .Range(\"A7:A28\")\n    Set s1 = .Range(.Cells(7, 1), .Cells(28, 1))\nend with\n</code></pre>\n\n<p>Or if you prefer not to declare your worksheet, this would work too:</p>\n\n<pre><code>With ThisWorkbook.Worksheets(\"Key\")\n    Set s1 = .Range(\"A7:A28\")\n    Set s1 = .Range(.Cells(7, 1), .Cells(28, 1))\nend with\n</code></pre>\n\n<p>Notice that I changed your <code>Cells()</code> (which is referring to the <strong>ActiveSheet</strong>), to <code>.Cells()</code> (which is now referring to your <strong>With Statement</strong>).</p>\n"}], "owner": {"reputation": 619, "user_id": 487204, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/0c81d1d50e4d8751ecbae7b19866c681?s=128&d=identicon&r=PG", "display_name": "C0ppert0p", "link": "https://stackoverflow.com/users/487204/c0ppert0p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "closed_date": 1520989315, "accepted_answer_id": 49268192, "answer_count": 1, "score": 1, "last_activity_date": 1520989050, "creation_date": 1520988364, "last_edit_date": 1531164843, "question_id": 49268136, "link": "https://stackoverflow.com/questions/49268136/setting-a-range-in-vbs-not-working-as-expected", "closed_reason": "Duplicate", "title": "setting a range in vbs not working as expected", "body": "<p>I have two range statements:</p>\n\n<pre><code>Set s1 = Sheets(\"Key\").Range(\"A7:A28\")\nSet s1 = Sheets(\"Key\").Range(Cells(7, 1), Cells(28, 1)\n</code></pre>\n\n<p>The first statement works whether the sheet \"Key\" is active or not.\nThe second statement only works when \"Key\" is active</p>\n\n<p>The second statement results in a run-time error '1004':\nApplication defined or object defined error</p>\n\n<p>What is the correct way of setting a range using row/column syntax?</p>\n"}, {"tags": ["vba", "image", "excel", "userform"], "comments": [{"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1520985946, "post_id": 49267664, "comment_id": 85539041, "body": "Try <a href=\"https://stackoverflow.com/a/37197535/2165759\">WebBrowser control</a>."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 9105808, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I0SdB.jpg?s=128&g=1", "display_name": "Aktike", "link": "https://stackoverflow.com/users/9105808/aktike"}, "edited": false, "score": 0, "creation_date": 1521064668, "post_id": 49272599, "comment_id": 85579623, "body": "Hi @AdamW, thanks for replying!  I tried to update the code as you had suggested, but when I run it breaks at   Set myPicture = Pictures.Insert(txtImgUrl.Value)"}, {"owner": {"reputation": 41, "user_id": 9105808, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I0SdB.jpg?s=128&g=1", "display_name": "Aktike", "link": "https://stackoverflow.com/users/9105808/aktike"}, "edited": false, "score": 0, "creation_date": 1521065146, "post_id": 49272599, "comment_id": 85579845, "body": "It just keeps giving me the runtime 424 object error. I&#39;ve checked spelling and everything so that&#39;s fine. I have declared the Dim as suggested.  I&#39;m not really sure where I&#39;m going wrong?"}, {"owner": {"reputation": 1, "user_id": 9489761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/206079c7f53413572c08125f599e019c?s=128&d=identicon&r=PG&f=1", "display_name": "AdamW", "link": "https://stackoverflow.com/users/9489761/adamw"}, "reply_to_user": {"reputation": 41, "user_id": 9105808, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I0SdB.jpg?s=128&g=1", "display_name": "Aktike", "link": "https://stackoverflow.com/users/9105808/aktike"}, "edited": false, "score": 0, "creation_date": 1521098244, "post_id": 49272599, "comment_id": 85589378, "body": "Ok, so maybe there is something wrong with the URL. Have you checked what\u2019s inside the txtImgUrl.Value ? Try to to step by with F5 and see what\u2019s inside."}, {"owner": {"reputation": 41, "user_id": 9105808, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I0SdB.jpg?s=128&g=1", "display_name": "Aktike", "link": "https://stackoverflow.com/users/9105808/aktike"}, "edited": false, "score": 0, "creation_date": 1521408807, "post_id": 49272599, "comment_id": 85706229, "body": "When I step into it, the line &quot;Set myPicture = Pictures.Insert(txtImgUrl.Value)&quot;, myPicture = nothing &amp; txtImgUrl = the url i entered from shutterstock to test."}], "tags": [], "owner": {"reputation": 1, "user_id": 9489761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/206079c7f53413572c08125f599e019c?s=128&d=identicon&r=PG&f=1", "display_name": "AdamW", "link": "https://stackoverflow.com/users/9489761/adamw"}, "is_accepted": false, "score": 0, "last_activity_date": 1521015146, "creation_date": 1521015146, "answer_id": 49272599, "question_id": 49267664, "link": "https://stackoverflow.com/questions/49267664/embedding-image-from-url-in-an-excel-userform/49272599#49272599", "title": "Embedding image from URL in an Excel Userform", "body": "<p>I am not really sure why do you have the runtime 424 object error. Can you specify which line of code gives you the error?</p>\n\n<p>I would say this link <a href=\"https://stackoverflow.com/questions/16113876/inserting-an-online-picture-to-excel-with-vba\">Inserting an Online Picture to Excel with VBA</a> has everything you really need. </p>\n\n<p>You should declare an object variable for the picture</p>\n\n<pre><code>Dim myPicture As Picture 'embedded pic\n</code></pre>\n\n<p>And the repeat this every time you insert the picture:</p>\n\n<p>You need to insert the picture to the worksheet by setting the value of myPicture object variable. In your case it would be something like this:</p>\n\n<pre><code>Set myPicture = Pictures.Insert(txtImgUrl.Value)\n</code></pre>\n\n<p>And then you add some details on how to position this picture on your worksheet</p>\n\n<pre><code>With myPicture\n    .ShapeRange.LockAspectRatio = msoFalse 'Unlock aspect ratio\n    .Width = ws.Range(\"A\" &amp; LastRow).Width 'Picture width equal to cell width\n    .Height = ws.Range(\"A\" &amp; LastRow).Height 'Picture height equal to cell height\n    .Top = Rows(ws.Range(\"A\" &amp; LastRow).Row).Top 'Picture aligned to the top edge of the cell\n    .Left = Columns(ws.Range(\"A\" &amp; LastRow).Column).Left 'Picture aligned to the left edge of the cell\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 9105808, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I0SdB.jpg?s=128&g=1", "display_name": "Aktike", "link": "https://stackoverflow.com/users/9105808/aktike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1632, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1521040357, "creation_date": 1520984778, "last_edit_date": 1521040357, "question_id": 49267664, "link": "https://stackoverflow.com/questions/49267664/embedding-image-from-url-in-an-excel-userform", "title": "Embedding image from URL in an Excel Userform", "body": "<p>I'm fairly new to VBA, have been trying to work this one out but not having any luck. </p>\n\n<p>I'm trying to create a product catalogue and have built a userform to allow new products to be entered on the first blank row of the spreadsheet. So far so good. </p>\n\n<p>Where I'm getting stuck however, is that I need to embed a product image from a url in the userform (e.g. <a href=\"https://image.shutterstock.com/z/stock-photo-coffee-cup-and-coffee-beans-on-table-261745823.jpg\" rel=\"nofollow noreferrer\">https://image.shutterstock.com/z/stock-photo-coffee-cup-and-coffee-beans-on-table-261745823.jpg</a>) so that the file is able to be ported from computer to computer without losing the images already loaded onto the spreadsheet. </p>\n\n<p>Ideally I don't want to have to insert the URL itself onto the spreadsheet at all. When the user hits Submit, I want the userform to pull the image from online &amp; insert it into column A on the first blank row of the spreadsheet &amp; resize it to a particular width/height. (to be determined). </p>\n\n<p>I've found questions kind of similar to what I need <a href=\"https://stackoverflow.com/questions/16113876/inserting-an-online-picture-to-excel-with-vba\">here</a> &amp; <a href=\"http://www.excelforum.com/excel-programming-vba-macros/819227-show-picture-from-webpage-on-userform.html\" rel=\"nofollow noreferrer\">here</a> &amp; <a href=\"https://stackoverflow.com/questions/36271981/how-to-insert-a-picture-from-the-internet-into-vba-excel-userform\">here</a>. The questions either aren't answered, or I'm not sure how to make them fit my needs. </p>\n\n<p>This is the code I have now, however it presents a runtime 424 object error, I've clearly missed something >&lt;</p>\n\n<pre><code>Private Sub cmdSubmitForm_Click()\n\nDim StorePrice As Currency, SupplierPrice As Currency\nDim pic As String 'file path of pic\n\nDim LastRow As Long, ws As Worksheet\nSet ws = Sheets(\"Pricing\")\n\n'Finds the last blank row\nLastRow = ws.Range(\"B\" &amp; Rows.Count).End(xlUp).Row + 1\n\nStorePrice = txtStorePrice.value\nSupplierPrice= txtSupplier.Price.Value\n\nws.Range(\"B\" &amp; LastRow).Value = txtProductName.Text\nws.Range(\"C\" &amp; LastRow).Value = txtStorePrice.Text\nws.Range(\"D\" &amp; LastRow).Value = cboCategory.Text\nws.Range(\"E\" &amp; LastRow).Value = cboSubCategory.Text\nws.Range(\"F\" &amp; LastRow).Value = txtStoreLink.Text\nws.Range(\"G\" &amp; LastRow).Value = txtSupplierName.text\nws.Range(\"H\" &amp; LastRow).Value = txtSupplierPrice.text\nws.Range(\"I\" &amp; LastRow).Value = txtSupplierLink.text\nws.Range(\"J\" &amp; LastRow).Value = StorePrice- SupplierPrice\nws.Range(\"K\" &amp; LastRow).Value = txtNotes.Text\n\nws.Range(\"A\" &amp; LastRow).Value = Pictures.Insert(txtImgUrl.Value)\n\n\n'handler:\n'MsgBox \"Error\"\n\nEnd Sub\n</code></pre>\n\n<p>If anyone has any ideas on how to solve this I would really appreciate it!!!!</p>\n\n<p>Thanks in advance :)</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1024, "user_id": 6040823, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/DDCAB.jpg?s=128&g=1", "display_name": "Jason Brady", "link": "https://stackoverflow.com/users/6040823/jason-brady"}, "edited": false, "score": 0, "creation_date": 1520982033, "post_id": 49266951, "comment_id": 85537792, "body": "So I&#39;m not sure if I understand, but you want to automatically select the range of cells that contain the <code>=SUM()</code> formula? Do you have an idea usually where these would be at, or can they be anywhere on the worksheet?"}, {"owner": {"reputation": 25, "user_id": 9488198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c989ffbd9e79ae67c3277bfad470ff88?s=128&d=identicon&r=PG&f=1", "display_name": "Elliott", "link": "https://stackoverflow.com/users/9488198/elliott"}, "reply_to_user": {"reputation": 1024, "user_id": 6040823, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/DDCAB.jpg?s=128&g=1", "display_name": "Jason Brady", "link": "https://stackoverflow.com/users/6040823/jason-brady"}, "edited": false, "score": 0, "creation_date": 1521041617, "post_id": 49266951, "comment_id": 85566166, "body": "Hi Jason, in response to your second question, the Total row containing the =Sum() function can occur at any row in the spreadsheet depending upon the amount of data we are trying to track for the project&#39;s billing.  After I do a copy of the prior month&#39;s billing data, I would like to be able to find the &#39;Total&#39; row and reinsert my =Sum() function back into place.  I will add further clarifications in my question with more information."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 9488198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c989ffbd9e79ae67c3277bfad470ff88?s=128&d=identicon&r=PG&f=1", "display_name": "Elliott", "link": "https://stackoverflow.com/users/9488198/elliott"}, "edited": false, "score": 0, "creation_date": 1521042122, "post_id": 49269621, "comment_id": 85566556, "body": "Hello GMalc, thank you for the suggestion on the code.  I tried running it and found two issues, and potentially a third.  The first, is my Range O:Q contains formulas to show the sum of column H and column L.  When the copy occurred, the formulas were also copied and there is a #Value error in the cell, all I need copied are the values.  The second is a Run-time error &#39;1004&#39;: Method &#39;Range&#39; of object &#39;_Global&#39; failed at line 1Row2.  The third potential issue I am seeing is with the xlUp commands.  There may be gaps in the data that could cause that command to miss data."}, {"owner": {"reputation": 25, "user_id": 9488198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c989ffbd9e79ae67c3277bfad470ff88?s=128&d=identicon&r=PG&f=1", "display_name": "Elliott", "link": "https://stackoverflow.com/users/9488198/elliott"}, "edited": false, "score": 0, "creation_date": 1521042173, "post_id": 49269621, "comment_id": 85566599, "body": "[Continued comment from above] I will edit my original question to add more information.  Thanks for your help."}, {"owner": {"reputation": 25, "user_id": 9488198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c989ffbd9e79ae67c3277bfad470ff88?s=128&d=identicon&r=PG&f=1", "display_name": "Elliott", "link": "https://stackoverflow.com/users/9488198/elliott"}, "edited": false, "score": 0, "creation_date": 1521130185, "post_id": 49269621, "comment_id": 85610542, "body": "Good morning @GMalc.  Your code as stated above almost worked, I had to make a couple of modifications that I will post in an edit of my question so you can see the changes I made.  With those changes it works! Thank you!  I have 2 follow up questions, regarding the code.  Is there a way to actually insert the =Sum() function into the &quot;Total&quot; row instead of inserting the =Sum() value?  My second question is, the first cell of data in &quot;H4&quot; is being copied into the cell directly under my total cell. What could be causing this?  Again, thank you for all of the help!!  Have a great day."}, {"owner": {"reputation": 25, "user_id": 9488198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c989ffbd9e79ae67c3277bfad470ff88?s=128&d=identicon&r=PG&f=1", "display_name": "Elliott", "link": "https://stackoverflow.com/users/9488198/elliott"}, "edited": false, "score": 0, "creation_date": 1521130724, "post_id": 49269621, "comment_id": 85610875, "body": "Could you also please explain how/why the code works?  I understand enough to make modifications or mimic the code to make it work, but I don&#39;t fully understand the syntax of the functions to use them again in a different worksheet.  Thanks again for your help.  Have a great day."}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "reply_to_user": {"reputation": 25, "user_id": 9488198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c989ffbd9e79ae67c3277bfad470ff88?s=128&d=identicon&r=PG&f=1", "display_name": "Elliott", "link": "https://stackoverflow.com/users/9488198/elliott"}, "edited": false, "score": 0, "creation_date": 1521175038, "post_id": 49269621, "comment_id": 85628147, "body": "@ Elliot, I&#39;ve edited my answer with comments.  If you want to put the sum formula in the other two columns copy the line of code and change the column letter, like this... <code>ws2.Cells(fRow, &quot;I&quot;).Formula = &quot;=SUM(I4:I&quot; &amp; LastRow2 &amp; &quot;)&quot;</code>"}, {"owner": {"reputation": 25, "user_id": 9488198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c989ffbd9e79ae67c3277bfad470ff88?s=128&d=identicon&r=PG&f=1", "display_name": "Elliott", "link": "https://stackoverflow.com/users/9488198/elliott"}, "edited": false, "score": 0, "creation_date": 1521214895, "post_id": 49269621, "comment_id": 85650555, "body": "Thank you so much for all of your help and adding the comments to the code.  I will test everything out later today or tomorrow and see how it works.  On a side note, I took your suggestion of not to use the select function and have started reworking the rest of my code to make it more streamlined.  Thanks again, have a great day."}, {"owner": {"reputation": 25, "user_id": 9488198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c989ffbd9e79ae67c3277bfad470ff88?s=128&d=identicon&r=PG&f=1", "display_name": "Elliott", "link": "https://stackoverflow.com/users/9488198/elliott"}, "edited": false, "score": 0, "creation_date": 1521244335, "post_id": 49269621, "comment_id": 85664017, "body": "I tried doing an upvote, but it said because I have less than 15 reputation? the vote would be registered, but would not appear.  I have marked your answer as helpful.  I&#39;m sorry, I&#39;m new to posting on the site, so I&#39;m not sure if I missed anything on giving you credit.  I am trying to make sure all the bases are covered.  Thanks and have a great day."}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "reply_to_user": {"reputation": 25, "user_id": 9488198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c989ffbd9e79ae67c3277bfad470ff88?s=128&d=identicon&r=PG&f=1", "display_name": "Elliott", "link": "https://stackoverflow.com/users/9488198/elliott"}, "edited": false, "score": 0, "creation_date": 1521258005, "post_id": 49269621, "comment_id": 85666478, "body": "@Elliott, I&#39;m glad i could help"}], "tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": true, "score": 0, "last_activity_date": 1521174798, "last_edit_date": 1521174798, "creation_date": 1521000428, "answer_id": 49269621, "question_id": 49266951, "link": "https://stackoverflow.com/questions/49266951/variables-w-cell-address-formulas/49269621#49269621", "title": "Variables w/ Cell Address &amp; Formulas", "body": "<p>Edit 1: You need to learn <strong>how not to use Select</strong>. This is what I think you are asking for. The code copies all the new data from \"Current Billing\" from O4 to the last row. Then it paste the data into \"Current Billing (2)\" at cell H4. It then adds the the Sum function in the cell below the last row to sum the data from H4 to the last row. You should be able to add the summing for rows I and J. I've tested this multiple time, you should have not problems.</p>\n\n<pre><code>Dim ws1 As Worksheet\nDim ws2 As Worksheet\n'Ensure your worksheet names are correct\nSet ws1 = ThisWorkbook.Sheets(\"Current Billing\")\nSet ws2 = ThisWorkbook.Sheets(\"Current Billing (2)\")\n\n'Set the last row in column 15, to copy the dynamic range.\nDim LastRow As Long\nLastRow = ws1.Cells(Rows.Count, 15).End(xlUp).Row\n    'Copy your range from \"Current Billing\" to \"Current Billing (2)\" starting at H4\n    ws1.Range(\"O4:Q\" &amp; LastRow).Copy ws2.Range(\"H4\")\n\n'Set the last row variable for the \"Current Billing (2)\" worksheet because it will be different then the \"Current Billing\" worksheet\nDim LastRow2 As Long\n'Set the variable for the empty cell below the last row in column H\nDim fRow As Long\n\nLastRow2 = ws2.Cells(Rows.Count, \"H\").End(xlUp).Row\nfRow = LastRow2 + 1\n\n'Insert the sum formula in the empty cell below the last row in column H\nws2.Cells(fRow, \"H\").Formula = \"=SUM(H4:H\" &amp; LastRow2 &amp; \")\"\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 9488198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c989ffbd9e79ae67c3277bfad470ff88?s=128&d=identicon&r=PG&f=1", "display_name": "Elliott", "link": "https://stackoverflow.com/users/9488198/elliott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 0, "accepted_answer_id": 49269621, "answer_count": 1, "score": 0, "last_activity_date": 1521174798, "creation_date": 1520980538, "last_edit_date": 1521130534, "question_id": 49266951, "link": "https://stackoverflow.com/questions/49266951/variables-w-cell-address-formulas", "title": "Variables w/ Cell Address &amp; Formulas", "body": "<p>I have been to this website many times for help creating macros in Excel's VBA editor.  In fact, I used this website to help create a macro that updates our company's billing spreadsheet semi-automatically.  However, I would like to take to the human error factor out of the process and make it more foolproof.  I just cannot figure out how to search or phrase what I want to do to find the code sequence that will work.  Here is my current code that works perfectly, but leaves room for human error:</p>\n\n<pre><code>'   Copy of \"New Totals\" columns to \"Previous Billing\" columns of new \"Current Billing\" worksheet\nSheets(\"Current Billing\").Select\nRange(\"o4\").Select\nSet Rng1 = Application.InputBox(\"Select complete range of New Totals\" &amp; vbNewLine &amp; vbNewLine &amp; _\n    \"Please start at O4:Q4 and proceed to the end, but do not include the Totals at the bottom\", _\n    \"New Totals Selection\", Type:=8)\nRng1.Select\nRng1.Copy\nSheets(\"Current Billing (2)\").Select\nRange(\"h4\").Select\nRange(\"h4\").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nApplication.CutCopyMode = False\nRange(\"h4\").Select\n</code></pre>\n\n<p>By asking the user to select the cells that need to be copied, I have left room for errors in case cells get missed in copying or the wrong cells are copied.  I would like to minimize that potential.  I came across this code that others have recommended as a better way to copy data:</p>\n\n<pre><code>Dim Rng1 As Range\nDim rng4 As Range\n\nSheets(\"Current Billing\").Select\nSheets(\"Current Billing\").Copy Before:=Sheets(2)\nSheets(\"Current Billing\").Select\n\nSet Rng1 = Sheets(\"Current Billing\").Range(\"o:q\")\n'Range o:q is \"New Totals\" referenced above\nSet rng4 = Sheets(\"Current Billing (2)\").Range(\"h:j\")\n'Range h:j is \"Previous Billing\" referenced above\n\nrng4.Value = Rng1.Value\n</code></pre>\n\n<p>But what that does is erase 3 formulas I have that \"Sum\" the data to give totals of the columns in range H:J.  I would like to find the \"Total\" row at the end of my data, and rebuild the formula in the proper cell.  As an example, I have a \"Sum\" formula in cells H47 and J47 with a range of H4:H45 and J4:J45 respectively.</p>\n\n<p>With all of that explanation, how do I create a macro sequence that will automatically rebuild a formula in a specific cell that will have a variable row location, but static column location (usually)?  I apologize for the long winded explanation, but thank for all of your assistance.  And please let me know if I need to clarify anything.  Have a great day.</p>\n\n<p>[Edit 3-14-18 @ 8:43PDT] My range O:Q contain formulas that do not need to be copied to my range H:J, all I need are the values copied over.  This is where my issue arises, because my =Sum() function varies in row location, I cannot figure out how to identify the specific cell the =Sum() occurred and reinsert it.  I did some research and found the following three functions </p>\n\n<p>=index(H:H, Match(\"\"total\"\", A:A, 0))</p>\n\n<p>=CELL(\"\"address\"\",index(H:H, Match(\"\"total\"\", A:A, 0)))</p>\n\n<p>=offset(CELL(\"\"address\"\",index(H:H, Match(\"\"total\"\", A:A, 0))),-1,0)</p>\n\n<p>but I cannot figure out how to set my variables properly to then be able to reinsert the =Sum() function.  Thank you for the help.</p>\n\n<p>[Edit 3/15/2018 @ 9:10 PDT]  Below is the modified code based upon the code GMalc created that works with 2 clarifications requested.  How to insert the actual =Sum() function into the last Total cell instead of the value; and how to prevent an extra line of data being added directly below the last Total row.</p>\n\n<pre><code>Dim ws1 As Worksheet\nDim ws2 As Worksheet\nSet ws1 = ThisWorkbook.Sheets(\"Current Billing\")\nSet ws2 = ThisWorkbook.Sheets(\"Current Billing (2)\")\n\nDim lRow As Long\nDim lRowa As Long\nlRow = ws1.Cells(Rows.Count, 15).End(xlUp).Row\nlRowa = ws2.Cells(Rows.Count, 15).End(xlUp).Row\n\n   ws2.Range(\"H4:J\" &amp; lRowa).Value = ws1.Range(\"O4:Q\" &amp; lRow).Value\n   'ws2.Range(\"H4\").Value\n\nDim lRow2 As Long\nDim fRow As Long\n\nlRow2 = ws2.Range(\"H4:J\" &amp; Rows.Count).End(xlUp).Row\nfRow = lRow + 1\n\n     ws2.Range(\"H\" &amp; fRow) = WorksheetFunction.Sum(Range(\"H4:H\" &amp; lRow2))\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5574196, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-J_Z4YQfJCmI/AAAAAAAAAAI/AAAAAAAAAGs/PqblOWk6Lj0/photo.jpg?sz=128", "display_name": "Dan ", "link": "https://stackoverflow.com/users/5574196/dan"}, "edited": false, "score": 0, "creation_date": 1521112212, "post_id": 49267367, "comment_id": 85597500, "body": "Thanks, That worked perfectly. Just had to make sure that in the end of the folder path I leave a backslash (&#41; otherwise it doesn&#39;t register the path. Also thanks for optimizing my code."}], "tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": true, "score": 0, "last_activity_date": 1520982972, "creation_date": 1520982972, "answer_id": 49267367, "question_id": 49266794, "link": "https://stackoverflow.com/questions/49266794/excel-vba-folder-path-from-cell-to-import-data/49267367#49267367", "title": "Excel VBA Folder Path from Cell to import data", "body": "<p>You need to get the result of the call to <code>FileDialog</code> and pass it into your Open/Copy/Close code.</p>\n\n<p>You should also avoid all those <code>Select</code>'s and handle some exceptions, something like this</p>\n\n<pre><code>Sub Demo()\n    Dim wb As Workbook\n    Dim rng As Range\n    Dim wsCurrent As Worksheet\n    Dim DefaultFile As String\n\n    Set wsCurrent = ActiveSheet\n    DefaultFile = ActiveWorkbook.Worksheets(\"Meter Data\").Range(\"N12\")\n    If Dir(DefaultFile) = vbNullString Then\n        MsgBox DefaultFile &amp; vbNewLine &amp; \"does not exist.\" &amp; vbNewLine &amp; \"What Now?\"\n    Else\n        With Application.FileDialog(msoFileDialogOpen)\n            .AllowMultiSelect = False\n            .InitialFileName = DefaultFile\n            .Show\n            If .SelectedItems.Count &gt; 0 Then\n                Set wb = Workbooks.Open(.SelectedItems(1))\n                With wb.Sheets(1)\n                    Set rng = .Range(.Range(\"A1\").End(xlToRight), .Range(\"A1\").End(xlDown))\n                    rng.Copy wsCurrent.Range(\"G24\")\n                    wb.Close False\n                End With\n            End If\n        End With\n    End If\nEnd Sub\n</code></pre>\n\n<p></p>\n"}], "owner": {"reputation": 13, "user_id": 5574196, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-J_Z4YQfJCmI/AAAAAAAAAAI/AAAAAAAAAGs/PqblOWk6Lj0/photo.jpg?sz=128", "display_name": "Dan ", "link": "https://stackoverflow.com/users/5574196/dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1212, "favorite_count": 0, "accepted_answer_id": 49267367, "answer_count": 1, "score": 0, "last_activity_date": 1520982972, "creation_date": 1520979842, "last_edit_date": 1531164843, "question_id": 49266794, "link": "https://stackoverflow.com/questions/49266794/excel-vba-folder-path-from-cell-to-import-data", "title": "Excel VBA Folder Path from Cell to import data", "body": "<p>I have a macro that pulls in data from a selected spreadsheet. The way I've originally set it up is to open at the current file path location. The user would then select what file to copy the data from and vba does the rest. I would like to change is so the file path gets input in a cell and then the opened location would then be that file path. Below is my current code:</p>\n\n<pre><code>With Workbooks.Open(Application.GetOpenFilename)\nSheets(1).Select\nRange(\"A1\").Select\nRange(Selection, Selection.End(xlToRight)).Select\nRange(Selection, Selection.End(xlDown)).Select\nSelection.Copy\nWindows(2).Activate\nRange(\"G24\").Select\nActiveSheet.Paste\n.Close False\nEnd With\n</code></pre>\n\n<p>I have something like this that opens based on the file path in the cell. But I ca't seem to figure out how to change my script above</p>\n\n<pre><code>M = Sheets(\"Meter Data\").Range(\"N12\")\nWith Application.FileDialog(msoFileDialogOpen)\n.InitialFileName = M\n.Show\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 835, "user_id": 5860143, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/tngDm.png?s=128&g=1", "display_name": "aaa", "link": "https://stackoverflow.com/users/5860143/aaa"}, "edited": false, "score": 0, "creation_date": 1520985133, "post_id": 49266590, "comment_id": 85538789, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/39042960/excel-vba-add-items-to-dynamically-created-combobox\">Excel VBA Add Items to Dynamically Created ComboBox</a>"}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 9488173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5087853a253837cc1c544797e5e1771c?s=128&d=identicon&r=PG&f=1", "display_name": "Austin", "link": "https://stackoverflow.com/users/9488173/austin"}, "edited": false, "score": 0, "creation_date": 1521038734, "post_id": 49267868, "comment_id": 85563944, "body": "This is exactly what I was looking for.  Thank you."}, {"owner": {"reputation": 49, "user_id": 9488173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5087853a253837cc1c544797e5e1771c?s=128&d=identicon&r=PG&f=1", "display_name": "Austin", "link": "https://stackoverflow.com/users/9488173/austin"}, "edited": false, "score": 0, "creation_date": 1521039002, "post_id": 49267868, "comment_id": 85564165, "body": "With this code,  How can I use the cmbDemo3_Change() event?  My goal is cascading combo box&#39;s."}, {"owner": {"reputation": 49, "user_id": 9488173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5087853a253837cc1c544797e5e1771c?s=128&d=identicon&r=PG&f=1", "display_name": "Austin", "link": "https://stackoverflow.com/users/9488173/austin"}, "edited": false, "score": 0, "creation_date": 1521042834, "post_id": 49267868, "comment_id": 85567121, "body": "I have found the solution to what I asked above Here: <a href=\"https://stackoverflow.com/questions/3014421/how-to-add-events-to-controls-created-at-runtime-in-excel-with-vba\" title=\"how to add events to controls created at runtime in excel with vba\">stackoverflow.com/questions/3014421/&hellip;</a>"}], "tags": [], "owner": {"reputation": 118, "user_id": 5739124, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rnYMzfz1dQU/AAAAAAAAAAI/AAAAAAAAABk/P3WVwCLEPm8/photo.jpg?sz=128", "display_name": "Miros\u0142aw G\u0105dek", "link": "https://stackoverflow.com/users/5739124/miros%c5%82aw-g%c4%85dek"}, "is_accepted": true, "score": 0, "last_activity_date": 1520986264, "creation_date": 1520986264, "answer_id": 49267868, "question_id": 49266590, "link": "https://stackoverflow.com/questions/49266590/create-comboboxs-and-additems-to-them-all-within-the-vba-code/49267868#49267868", "title": "Create ComboBox&#39;s and AddItems to them all within the VBA code", "body": "<p>Here an sample of the code.</p>\n\n<p>You need still to change it for you needs but this will be easy.</p>\n\n<p>I have created a simple userform and one button to do test and it works fast.</p>\n\n<p>To imput the comboboxes replace \".additem\" with a loop to load each of them.</p>\n\n<p>How to do that -- search in google </p>\n\n<blockquote>\n  <p>how to Populate a combobox with vba</p>\n</blockquote>\n\n<p>You cannot refferance any controls on userform if they dont exist.</p>\n\n<p>You need to search for them after creation and then modify them.</p>\n\n<p>Example below with button code.</p>\n\n<p>I think this should bring you to an idea how to manage this.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub CommandButton1_Click()\nDim refControl As Control, frm As UserForm\nDim x\nSet frm = Me\nWith Me\nFor Each x In Me.Controls\nIf TypeName(x) = \"ComboBox\" Then\n    Select Case x.Name\n        Case \"cmbDemo3\"\n        MsgBox \"works!\"\n        'here you can put your code\n    End Select\n    MsgBox x.Name\nEnd If\nNext x\nEnd With\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\nDim combobox_Control As Control\n     Dim i\n\n    For i = 0 To 5\n         Set combobox_Control = Controls.Add(\"forms.combobox.1\")\n         With combobox_Control\n             .Name = \"cmbDemo\" &amp; i\n             .Height = 20\n             .Width = 50\n             .Left = 10\n             .Top = 10 * i * 2\n             .AddItem \"hihi\" 'here you can add your input code\n         End With\n     Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 9488173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5087853a253837cc1c544797e5e1771c?s=128&d=identicon&r=PG&f=1", "display_name": "Austin", "link": "https://stackoverflow.com/users/9488173/austin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 520, "favorite_count": 0, "accepted_answer_id": 49267868, "answer_count": 1, "score": 0, "last_activity_date": 1520986264, "creation_date": 1520978679, "question_id": 49266590, "link": "https://stackoverflow.com/questions/49266590/create-comboboxs-and-additems-to-them-all-within-the-vba-code", "title": "Create ComboBox&#39;s and AddItems to them all within the VBA code", "body": "<p>I need to create ComboBox's and then AddItems to each ComboBox.  This will all be done to a userform.  I need to do this entirely within the VBA code,  this is because each time the userform is opened new information will be shown.</p>\n\n<p>this is what I have so far:</p>\n\n<pre><code>    Private Sub UserForm_Initialize()\n\n    for i = 1 to size\n    Set CmbBX = Me.Controls.Add(\"Forms.ComboBox.1\")\n        CmbBX.Top = ((90 * i) - 18) + 12 + 20\n        CmbBX.Left = 30\n        CmbBX.Text = \"Please select an item from the drop down\"\n        CmbBX.TextAlign = fmTextAlignCenter\n        CmbBX.Width = 324\n        CmbBX.Visible = False\n        CmbBX.Name = \"ComBox2\" &amp; i\n\n    Next\n    end sub\n</code></pre>\n\n<p>the problem is, once each ComboBox is created its like its name isnt there.  I cannot referance the combobox.  this is what I have tried:</p>\n\n<pre><code>ComBox21.AddItems \"Test1\"\nComBox22.AddItems \"Test2\"\n</code></pre>\n\n<p>And it errors out.  When I look at the UserForms function bar at the top of the screen (where I would usually select ComBox22_Change() for example), It shows that no ComboBoxes even exist!</p>\n\n<p>Any Ideas on how to dynamically create and additems to comboboxes?</p>\n\n<p>Thank you in advance\n</p>\n"}, {"tags": ["vba", "ms-word", "word-style"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 4412146, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53e9fb68551bb3687ecc86d7e9e33f97?s=128&d=identicon&r=PG&f=1", "display_name": "Ash", "link": "https://stackoverflow.com/users/4412146/ash"}, "edited": false, "score": 0, "creation_date": 1521058804, "post_id": 49277991, "comment_id": 85576973, "body": "thanks - I saw this code too.  I&#39;ve no problem creating the styles, it is just applying the style to just the header or just the body"}, {"owner": {"reputation": 41, "user_id": 4412146, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53e9fb68551bb3687ecc86d7e9e33f97?s=128&d=identicon&r=PG&f=1", "display_name": "Ash", "link": "https://stackoverflow.com/users/4412146/ash"}, "edited": false, "score": 0, "creation_date": 1521146583, "post_id": 49277991, "comment_id": 85619865, "body": "thanks...but is this code to format a table in Excel?  I&#39;m working in Word"}], "tags": [], "owner": {"reputation": 41, "user_id": 6266517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08355bfbde8a176f1c493569c93c8e83?s=128&d=identicon&r=PG&f=1", "display_name": "G. Jonathan", "link": "https://stackoverflow.com/users/6266517/g-jonathan"}, "is_accepted": false, "score": 0, "last_activity_date": 1528216757, "last_edit_date": 1528216757, "creation_date": 1521031023, "answer_id": 49277991, "question_id": 49266560, "link": "https://stackoverflow.com/questions/49266560/apply-table-style-to-header-using-vba/49277991#49277991", "title": "Apply table style to header using VBA", "body": "<p>Not sure if this is possible but you could follow this <a href=\"https://stackoverflow.com/questions/11526778/how-to-assign-table-styles-with-code-to-a-word-document\">procedure</a> to create your own styles and apply them on the header row or the table body.</p>\n\n<pre><code>Sub tableFormat()\nDim lastRow As Integer\n\nlastRow = ActiveDocument.Tables(1).Rows.Count\n\n\nWith ActiveDocument.Tables(1).Rows(1).Range.Font\n        .Name = \"Arial\"\n        .Size = 12\n        .Italic = True\n        .Bold = True\nEnd With\n\nFor i = 2 To lastRow\nWith ActiveDocument.Tables(1).Rows(i).Range.Font\n        .Name = \"Arial\"\n        .Size = 8\n        .Italic = False\n        .Bold = False\nEnd With\nNext i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 4412146, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53e9fb68551bb3687ecc86d7e9e33f97?s=128&d=identicon&r=PG&f=1", "display_name": "Ash", "link": "https://stackoverflow.com/users/4412146/ash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 821, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593878381, "creation_date": 1520978526, "last_edit_date": 1593878381, "question_id": 49266560, "link": "https://stackoverflow.com/questions/49266560/apply-table-style-to-header-using-vba", "title": "Apply table style to header using VBA", "body": "<p>I'm writing VBA code in Word to format a table.  I need to allow the user to format the table header independently of the table body.  To do this I hoped to be able to use the built in table styles, however, when I do this the style is applied to the whole table and not just the header or body.</p>\n\n<p>Below is the code that I'm using to apply a style to the header:</p>\n\n<pre><code>Sub FormatTableHeader(ByVal control As IRibbonControl)\nDim tbl As Table\n\nIf Selection.Information(wdWithInTable) = True Then\n    Set tbl = Selection.Tables(1)\n\n    tbl.Rows(1).Range.Style = \"TableHeader\"\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>I also need to do something similar for the table body.</p>\n\n<p>Is it possible to do what I'm trying to do using the table styles?  I know I could write code to format the table header, but I hoped to keep the code linked to the styles.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 8271968, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dbb5cbd53d6eab1b39fba1e41aee9eb0?s=128&d=identicon&r=PG&f=1", "display_name": "Blackfyre", "link": "https://stackoverflow.com/users/8271968/blackfyre"}, "edited": false, "score": 0, "creation_date": 1520981826, "post_id": 49266502, "comment_id": 85537723, "body": "Also what was the error? I can&#39;t seem to figure out what you did to fix it."}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": true, "score": 2, "last_activity_date": 1520978238, "creation_date": 1520978238, "answer_id": 49266502, "question_id": 49266365, "link": "https://stackoverflow.com/questions/49266365/excel-issue-with-measuring-calculation-time/49266502#49266502", "title": "Excel: Issue with Measuring calculation time", "body": "<p><strong>Here:</strong></p>\n\n<pre><code>#If VBA7 Then\n    Private Declare PtrSafe Function getFrequency Lib \"kernel32\" Alias _\n        \"QueryPerformanceFrequency\" (cyFrequency As Currency) As Long\n    Private Declare PtrSafe Function getTickCount Lib \"kernel32\" Alias _\n         \"QueryPerformanceCounter\" (cyTickCount As Currency) As Long\n#Else\n    Private Declare Function getFrequency Lib \"kernel32\" Alias _\n        \"QueryPerformanceFrequency\" (cyFrequency As Currency) As Long\n    Private Declare Function getTickCount Lib \"kernel32\" Alias _\n        \"QueryPerformanceCounter\" (cyTickCount As Currency) As Long\n#End If\nFunction MicroTimer() As Double\n\n\n' Returns seconds.\n    Dim cyTicks1 As Currency\n    Static cyFrequency As Currency\n    '\n    MicroTimer = 0\n\n' Get frequency.\n    If cyFrequency = 0 Then getFrequency cyFrequency\n\n' Get ticks.\n    getTickCount cyTicks1\n\n' Seconds\n    If cyFrequency Then MicroTimer = cyTicks1 / cyFrequency\nEnd Function\n\nSub RangeTimer()\n    DoCalcTimer 1\nEnd Sub\nSub SheetTimer()\n    DoCalcTimer 2\nEnd Sub\nSub RecalcTimer()\n    DoCalcTimer 3\nEnd Sub\nSub FullcalcTimer()\n    DoCalcTimer 4\nEnd Sub\n\nSub DoCalcTimer(jMethod As Long)\n    Dim dTime As Double\n    Dim dOvhd As Double\n    Dim oRng As Range\n    Dim oCell As Range\n    Dim oArrRange As Range\n    Dim sCalcType As String\n    Dim lCalcSave As Long\n    Dim bIterSave As Boolean\n    '\n    On Error GoTo Errhandl\n\n' Initialize\n    dTime = MicroTimer\n\n    ' Save calculation settings.\n    lCalcSave = Application.Calculation\n    bIterSave = Application.Iteration\n    If Application.Calculation &lt;&gt; xlCalculationManual Then\n        Application.Calculation = xlCalculationManual\n    End If\n    Select Case jMethod\n    Case 1\n\n        ' Switch off iteration.\n\n        If Application.Iteration &lt;&gt; False Then\n            Application.Iteration = False\n        End If\n\n        ' Max is used range.\n\n        If Selection.Count &gt; 1000 Then\n            Set oRng = Intersect(Selection, Selection.Parent.UsedRange)\n        Else\n            Set oRng = Selection\n        End If\n\n        ' Include array cells outside selection.\n\n        For Each oCell In oRng\n            If oCell.HasArray Then\n                If oArrRange Is Nothing Then\n                    Set oArrRange = oCell.CurrentArray\n                End If\n                If Intersect(oCell, oArrRange) Is Nothing Then\n                    Set oArrRange = oCell.CurrentArray\n                    Set oRng = Union(oRng, oArrRange)\n                End If\n            End If\n        Next oCell\n\n        sCalcType = \"Calculate \" &amp; CStr(oRng.Count) &amp; _\n            \" Cell(s) in Selected Range: \"\n    Case 2\n        sCalcType = \"Recalculate Sheet \" &amp; ActiveSheet.Name &amp; \": \"\n    Case 3\n        sCalcType = \"Recalculate open workbooks: \"\n    Case 4\n        sCalcType = \"Full Calculate open workbooks: \"\n    End Select\n\n' Get start time.\n    dTime = MicroTimer\n    Select Case jMethod\n    Case 1\n        If Val(Application.Version) &gt;= 12 Then\n            oRng.CalculateRowMajorOrder\n        Else\n            oRng.Calculate\n        End If\n    Case 2\n        ActiveSheet.Calculate\n    Case 3\n        Application.Calculate\n    Case 4\n        Application.CalculateFull\n    End Select\n\n' Calculate duration.\n    dTime = MicroTimer - dTime\n    On Error GoTo 0\n\n    dTime = Round(dTime, 5)\n    MsgBox sCalcType &amp; \" \" &amp; CStr(dTime) &amp; \" Seconds\", _\n        vbOKOnly + vbInformation, \"CalcTimer\"\n\nFinish:\n\n    ' Restore calculation settings.\n    If Application.Calculation &lt;&gt; lCalcSave Then\n         Application.Calculation = lCalcSave\n    End If\n    If Application.Iteration &lt;&gt; bIterSave Then\n         Application.Calculation = bIterSave\n    End If\n    Exit Sub\nErrhandl:\n    On Error GoTo 0\n    MsgBox \"Unable to Calculate \" &amp; sCalcType, _\n        vbOKOnly + vbCritical, \"CalcTimer\"\n    GoTo Finish\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 8271968, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dbb5cbd53d6eab1b39fba1e41aee9eb0?s=128&d=identicon&r=PG&f=1", "display_name": "Blackfyre", "link": "https://stackoverflow.com/users/8271968/blackfyre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 357, "favorite_count": 1, "accepted_answer_id": 49266502, "answer_count": 1, "score": 0, "last_activity_date": 1521068544, "creation_date": 1520977599, "last_edit_date": 1521068544, "question_id": 49266365, "link": "https://stackoverflow.com/questions/49266365/excel-issue-with-measuring-calculation-time", "title": "Excel: Issue with Measuring calculation time", "body": "<p>I am trying to get a <code>runtime</code> on formulas for a large file (19 MB and 40 sheets) that uses a host of bad formulas. </p>\n\n<p>I tried using this VBA code from the MS site to identify which formulas are causing the slowdown issues. However, I am new to VBA and this does not seem to work properly.</p>\n\n<blockquote>\n  <p><a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/excel-improving-calcuation-performance\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/vba/excel-vba/articles/excel-improving-calcuation-performance</a></p>\n</blockquote>\n\n<p>Here is the code:</p>\n\n<pre><code>    #If VBA7 Then\n        Private Declare PtrSafe Function getFrequency Lib \"kernel32\" Alias _\n            \"QueryPerformanceFrequency\" (cyFrequency As Currency) As Long\n        Private Declare PtrSafe Function getTickCount Lib \"kernel32\" Alias _\n             \"QueryPerformanceCounter\" (cyTickCount As Currency) As Long\n    #Else\n        Private Declare Function getFrequency Lib \"kernel32\" Alias _                                            \n            \"QueryPerformanceFrequency\" (cyFrequency As Currency) As Long\n        Private Declare Function getTickCount Lib \"kernel32\" Alias _\n            \"QueryPerformanceCounter\" (cyTickCount As Currency) As Long\n    #End If\n    Function MicroTimer() As Double\n    '\n\n    ' Returns seconds.\n        Dim cyTicks1 As Currency\n        Static cyFrequency As Currency\n        '\n        MicroTimer = 0\n\n    ' Get frequency.\n        If cyFrequency = 0 Then getFrequency cyFrequency\n\n    ' Get ticks.\n        getTickCount cyTicks1\n\n    ' Seconds\n        If cyFrequency Then MicroTimer = cyTicks1 / cyFrequency\n    End Function\n\n    Sub RangeTimer()\n        DoCalcTimer 1\n    End Sub\n    Sub SheetTimer()\n        DoCalcTimer 2\n    End Sub\n    Sub RecalcTimer()\n        DoCalcTimer 3\n    End Sub\n    Sub FullcalcTimer()\n        DoCalcTimer 4\n    End Sub\n\n    Sub DoCalcTimer(jMethod As Long)\n        Dim dTime As Double\n        Dim dOvhd As Double\n        Dim oRng As Range\n        Dim oCell As Range\n        Dim oArrRange As Range\n        Dim sCalcType As String\n        Dim lCalcSave As Long\n        Dim bIterSave As Boolean\n        '\n        On Error GoTo Errhandl\n\n    ' Initialize\n        dTime = MicroTimer\n\n        ' Save calculation settings.\n        lCalcSave = Application.Calculation\n        bIterSave = Application.Iteration\n        If Application.Calculation &lt;&gt; xlCalculationManual Then\n            Application.Calculation = xlCalculationManual\n        End If\n        Select Case jMethod\n        Case 1\n\n            ' Switch off iteration.\n\n            If Application.Iteration &lt;&gt; False Then\n                Application.Iteration = False\n            End If\n\n            ' Max is used range.\n\n            If Selection.Count &gt; 1000 Then\n                Set oRng = Intersect(Selection, Selection.Parent.UsedRange)\n            Else\n                Set oRng = Selection\n            End If\n\n            ' Include array cells outside selection.\n\n            For Each oCell In oRng\n                If oCell.HasArray Then\n                    If oArrRange Is Nothing Then\n                        Set oArrRange = oCell.CurrentArray\n                    End If\n                    If Intersect(oCell, oArrRange) Is Nothing Then\n                        Set oArrRange = oCell.CurrentArray\n                        Set oRng = Union(oRng, oArrRange)\n                    End If\n                End If\n            Next oCell\n\n            sCalcType = \"Calculate \" &amp;amp; CStr(oRng.Count) &amp;amp; _\n                \" Cell(s) in Selected Range: \"\n        Case 2\n            sCalcType = \"Recalculate Sheet \" &amp;amp; ActiveSheet.Name &amp;amp; \": \"\n        Case 3\n            sCalcType = \"Recalculate open workbooks: \"\n        Case 4\n            sCalcType = \"Full Calculate open workbooks: \"\n        End Select\n\n    ' Get start time.\n        dTime = MicroTimer\n        Select Case jMethod\n        Case 1\n            If Val(Application.Version) &gt;= 12 Then\n                oRng.CalculateRowMajorOrder\n            Else\n                oRng.Calculate\n            End If\n        Case 2\n            ActiveSheet.Calculate\n        Case 3\n            Application.Calculate\n        Case 4\n            Application.CalculateFull\n        End Select\n\n    ' Calculate duration.\n        dTime = MicroTimer - dTime\n        On Error GoTo 0\n\n        dTime = Round(dTime, 5)\n        MsgBox sCalcType &amp;amp; \" \" &amp;amp; CStr(dTime) &amp;amp; \" Seconds\", _\n            vbOKOnly + vbInformation, \"CalcTimer\"\n\n    Finish:\n\n        ' Restore calculation settings.\n        If Application.Calculation &lt;&gt; lCalcSave Then\n             Application.Calculation = lCalcSave\n        End If\n        If Application.Iteration &lt;&gt; bIterSave Then\n             Application.Calculation = bIterSave\n        End If\n        Exit Sub\n    Errhandl:\n        On Error GoTo 0\n        MsgBox \"Unable to Calculate \" &amp;amp; sCalcType, _\n            vbOKOnly + vbCritical, \"CalcTimer\"\n        GoTo Finish\n    End Sub\n</code></pre>\n\n<p>I keep getting a syntax error. Thanks for your help!</p>\n"}, {"tags": ["ms-access", "vba", "32bit-64bit"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1520977657, "post_id": 49266325, "comment_id": 85536101, "body": "Unless I&#39;m very wrong, this is not an error message from Access, but one created by your code. Check the <code>StartupSettings</code> procedure (I assume)."}, {"owner": {"reputation": 2343, "user_id": 6179818, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/dae9d1c0c3049c5e44fc49a364600fa6?s=128&d=identicon&r=PG&f=1", "display_name": "Jade Cowan", "link": "https://stackoverflow.com/users/6179818/jade-cowan"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1520977949, "post_id": 49266325, "comment_id": 85536252, "body": "@Andre, I&#39;m only catching and displaying what function the error message is occuring in. The error 53 is coming from <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/file-not-found-error-53\" rel=\"nofollow noreferrer\">VBA</a>. The <code>StartupSettings</code> contains the declared subroutine."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1520978363, "post_id": 49266325, "comment_id": 85536456, "body": "Thanks for the edit - so it&#39;s an error handler message. If you remove the error handler, does Access show a more informative error message?"}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 2, "creation_date": 1520978417, "post_id": 49266325, "comment_id": 85536477, "body": "Seems like you are trying to use a x86 dll (SysWow64) in x64 Excel (Declare PtrSafe)."}, {"owner": {"reputation": 2343, "user_id": 6179818, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/dae9d1c0c3049c5e44fc49a364600fa6?s=128&d=identicon&r=PG&f=1", "display_name": "Jade Cowan", "link": "https://stackoverflow.com/users/6179818/jade-cowan"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1520978718, "post_id": 49266325, "comment_id": 85536595, "body": "@Andre, without error handling the message is still the same."}, {"owner": {"reputation": 2343, "user_id": 6179818, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/dae9d1c0c3049c5e44fc49a364600fa6?s=128&d=identicon&r=PG&f=1", "display_name": "Jade Cowan", "link": "https://stackoverflow.com/users/6179818/jade-cowan"}, "reply_to_user": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1520979024, "post_id": 49266325, "comment_id": 85536710, "body": "@ComputerVersteher, a compiler error is thrown if PtrSafe attribute isn&#39;t added to Declare statements on a 64-bit system. Unless I&#39;m misunderstanding the purpose of the attribute, it just means that the statement is safe to run on a 64-bit system."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 1, "creation_date": 1520979027, "post_id": 49266325, "comment_id": 85536713, "body": "As @ComputerVersteher wrote. If you are locked in with 64bit Access and the 32bit DLL, you have a problem. <a href=\"https://stackoverflow.com/questions/4219477/32-bit-dll-in-office-64-bit\" title=\"32 bit dll in office 64 bit\">stackoverflow.com/questions/4219477/32-bit-dll-in-office-64-&zwnj;&#8203;bit</a>"}, {"owner": {"reputation": 2343, "user_id": 6179818, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/dae9d1c0c3049c5e44fc49a364600fa6?s=128&d=identicon&r=PG&f=1", "display_name": "Jade Cowan", "link": "https://stackoverflow.com/users/6179818/jade-cowan"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1520979284, "post_id": 49266325, "comment_id": 85536802, "body": "Thank you for the insight. I&#39;ll look more into the link you sent, @Andre."}, {"owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "edited": false, "score": 2, "creation_date": 1521020101, "post_id": 49266325, "comment_id": 85550660, "body": "BTW, if you use functions declarations, you don&#39;t need library references."}], "owner": {"reputation": 2343, "user_id": 6179818, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/dae9d1c0c3049c5e44fc49a364600fa6?s=128&d=identicon&r=PG&f=1", "display_name": "Jade Cowan", "link": "https://stackoverflow.com/users/6179818/jade-cowan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 781, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1520979233, "creation_date": 1520977393, "last_edit_date": 1520979233, "question_id": 49266325, "link": "https://stackoverflow.com/questions/49266325/vba-file-not-found-error-53-for-library-reference", "title": "VBA File Not Found (Error 53) for Library Reference", "body": "<p>While running my Access application, I receive a Error 53 File Not Found error.</p>\n\n<p><a href=\"https://i.stack.imgur.com/zf6Rr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zf6Rr.png\" alt=\"enter image description here\"></a></p>\n\n<p>The file in the error message refers to a referenced library for the application.</p>\n\n<p><a href=\"https://i.stack.imgur.com/bu9qX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bu9qX.png\" alt=\"enter image description here\"></a></p>\n\n<p>I refer to the library in my code like so...</p>\n\n<pre><code>Private Declare PtrSafe Sub ControlUnlockT Lib \"Accusoft.TwainPro9.ActiveX.dll\" Alias \"PS_Unlock\" _\n(ByVal pw1 As LongPtr, ByVal pw2 As LongPtr, ByVal pw3 As LongPtr, ByVal pw4 As LongPtr)\n</code></pre>\n\n<p>And use the declared subroutine in the following function:</p>\n\n<pre><code>Public Function StartupSettings()\n\nOn Error GoTo Error_StartupSettings\n\n\n'Hide menubars\n'When used with the Application object,\n'the MenuBar property enables you to display a custom menu bar\n'throughout the database. However, if you've set the MenuBar\n'property for a form or report in the database, the custom menu\n'bar of the form or report will be displayed in place of the database's\n'custom menu bar whenever the form or report has the focus.\n'When the form or report loses the focus, the custom menu bar for the\n'database is displayed.\n'Application.MenuBar = \"mcrBlankMenuBar\"\n\nControlUnlockT DLookup(\"Code\", \"tblSecurity\", \"Section=1\"), DLookup(\"Code\", \"tblSecurity\", \"Section=2\"), _\n        DLookup(\"Code\", \"tblSecurity\", \"Section=3\"), DLookup(\"Code\", \"tblSecurity\", \"Section=4\")\nControlUnlock DLookup(\"Code\", \"tblSecurity\", \"Section=1\"), DLookup(\"Code\", \"tblSecurity\", \"Section=2\"), _\n        DLookup(\"Code\", \"tblSecurity\", \"Section=3\"), DLookup(\"Code\", \"tblSecurity\", \"Section=4\")\n\n'Change the keyboard Move After Enter behavior to Next Field rather\n'then next record or dont move\nApplication.SetOption \"Move After Enter\", 1\n\n'Hide database window\nDoCmd.Echo False\n'DoCmd.SelectObject A_MACRO, \"mcrOpenMDB2\", True\n'DoCmd.DoMenuItem 1, 4, 3, , A_MENU_VER20\nDoCmd.Echo True\n\n\n\nExit_StartupSettings:\n    Exit Function\n\n\nError_StartupSettings:\n    MsgBox Err.Description, 16, \"Error \" &amp; Err &amp; \" - StartupSettings\"\n    Resume Exit_StartupSettings\n\n\nEnd Function\n</code></pre>\n\n<p>The file exists in the path, so what am I missing here?</p>\n\n<p><a href=\"https://i.stack.imgur.com/5MOwb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5MOwb.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1520977512, "post_id": 49266285, "comment_id": 85536047, "body": "It is Application.WorksheetFunction.Countifs as well as whatever else is the problem."}, {"owner": {"reputation": 369, "user_id": 5477223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zEaP8.jpg?s=128&g=1", "display_name": "Jan", "link": "https://stackoverflow.com/users/5477223/jan"}, "edited": false, "score": 0, "creation_date": 1520978342, "post_id": 49266285, "comment_id": 85536446, "body": "Did you mean to have the CountIfs criteria to be on different rows?  A3/B3/C2/D1?"}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1520978466, "last_edit_date": 1520978466, "creation_date": 1520978132, "answer_id": 49266478, "question_id": 49266285, "link": "https://stackoverflow.com/questions/49266285/coutnifs-in-excel-vba-is-not-working/49266478#49266478", "title": "Coutnifs in Excel VBA is Not Working", "body": "<p>for only the error described you need to add Application before WorksheetFunction and all the ranges need a worksheet name between the workbook part and the range part. You are currently frequently saying Workbook.Range which is invalid.</p>\n\n<pre><code>ActiveCell.Value = Application.WorksheetFunction.CountIfs(wkb2.Worksheets(\"insertworksheetname\").Range(\"E:E\"), wkb1.Worksheets(\"insertworksheetname\").Range(\"A3\"), wkb2.Worksheets(\"insertworksheetname\").Range(\"J:J\"), wkb1.Worksheets(\"insertworksheetname\").Range(\"B3\"), _\n    wkb2.Worksheets(\"insertworksheetname\").Range(\"K:K\"), wkb1.Worksheets(\"insertworksheetname\").Range(\"C2\"), wkb2.Worksheets(\"insertworksheetname\").Range(\"N:N\"), wkb1.Worksheets(\"insertworksheetname\").Range(\"D1\"))\n</code></pre>\n\n<p>You will get away with the ones where you have just put Range as they reference the active sheet but it is always better to explicitly reference the sheet by name.</p>\n"}, {"tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": false, "score": 0, "last_activity_date": 1520979460, "creation_date": 1520979460, "answer_id": 49266733, "question_id": 49266285, "link": "https://stackoverflow.com/questions/49266285/coutnifs-in-excel-vba-is-not-working/49266733#49266733", "title": "Coutnifs in Excel VBA is Not Working", "body": "<p>As already answered, <code>Workbook</code>'s don't have <code>Range</code>'s, <code>Worksheets</code> do.</p>\n\n<p>Where you use <code>wkb2.Range(\"E:E\")</code> etc, add a reference to the required sheet</p>\n\n<p>eg</p>\n\n<pre><code>wkb2.Worksheets(\"Raw Data - MES Yield\").Range(\"E:E\")\n</code></pre>\n\n<p>Some side notes</p>\n\n<ol>\n<li><p>where you use <code>Dim wkb1, wkb2 As Workbook</code> only <code>wkb2</code> is declared as <code>Workbook</code> (<code>wkb1</code> will be a <code>Variant</code>).  Be explicit for each variable on the line</p></li>\n<li><p>it's better to avoid activating / selecting.  </p></li>\n<li><p>you can avoid the VLookup loop, which be be a lot faster</p></li>\n</ol>\n\n<p>Your code refactored to demonstrate</p>\n\n<pre><code>Sub manipulate()\n    Dim wkb1 As Workbook, wkb2 As Workbook\n    Dim ws1 As Worksheet, ws2 As Worksheet\n    Set wkb1 = ThisWorkbook\n    Set wkb2 = Workbooks.Open _\n      (\"F:\\Flat Panel Engineering\\09 MIT\\Data\\Yield-Symptom_Report_rev05.xlsx\")\n\n    Set ws2 = wbk2.Worksheets(\"Raw Data - MES Yield\")\n    ws2.Range(\"E1\").EntireColumn.Insert\n\n    Dim column As Range\n    Set column = ws2.Range(\"E1:E416650\")\n    column = Application.VLookup(column.Offset(0, 1), _\n      wkb1.Worksheets(\"PF\").Range(\"A1:B80\"), 2, False)\n\n    Set ws1 = wbk1.Worksheets(\"NameOfWb1Sheet\")\n    ws1.Range(\"A3\").End(xlToRight).Offset(0, 1).Value = _\n      Application.WorksheetFunction.CountIfs( _\n      ws2.Range(\"E:E\"), ws1.Range(\"A3\"), _\n      ws2.Range(\"J:J\"), ws1.Range(\"B3\"), _\n      ws2.Range(\"K:K\"), ws1.Range(\"C2\"), _\n      ws2.Range(\"N:N\"), ws1.Range(\"D1\"))\n\n    wkb2.Close savechanges:=False\n\nEnd Sub\n</code></pre>\n\n<p></p>\n"}], "owner": {"reputation": 21, "user_id": 8092758, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kfrM1wawjE4/AAAAAAAAAAI/AAAAAAAAAho/u1q39_4tzi8/photo.jpg?sz=128", "display_name": "user8092758", "link": "https://stackoverflow.com/users/8092758/user8092758"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1520979460, "creation_date": 1520977234, "last_edit_date": 1531164843, "question_id": 49266285, "link": "https://stackoverflow.com/questions/49266285/coutnifs-in-excel-vba-is-not-working", "title": "Coutnifs in Excel VBA is Not Working", "body": "<p>I'm having trouble with getting my code to work (see below). The problem is the countifs function in the last section of the code. I feel that I have formatted it right but an error message is thrown up each time it gets to this part of the code. Error message is \"Run-time error '438': Object doesn't support this property or method.\" Any suggestions are appreciated. </p>\n\n<pre><code>Sub manipulate()\n\nDim wkb1, wkb2 As Workbook\nSet wkb1 = ThisWorkbook\nSet wkb2 = Workbooks.Open(\"F:\\Flat Panel Engineering\\09 MIT\\Data\\Yield-\n    Symptom_Report_rev05.xlsx\")\n\nwkb2.Activate\nSheets(\"Raw Data - MES Yield\").Activate\nRange(\"E1\").EntireColumn.Insert\nRange(\"E2\").Select\n\nDim cell, column As Range\nSet column = Range(\"E1:E416650\")\nFor Each cell In column\n    cell.Value = Application.VLookup(cell.Offset(0, 1), _ \n    wkb1.Sheets(\"PF\").Range(\"A1:B80\"), 2, False)\nNext cell\n\nwkb1.Activate\nRange(\"A3\").End(xlToRight).Offset(0, 1).Select\nActiveCell.Value = WorksheetFunction.CountIfs(wkb2.Range(\"E:E\"), _\n    Range(\"A3\"), wkb2.Range(\"J:J\"), Range(\"B3\"), _\n    wkb2.Range(\"K:K\"), Range(\"C2\"), wkb2.Range(\"N:N\"), Range(\"D1\"))\n\nwkb2.Close savechanges:=False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "function"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 3, "creation_date": 1520977226, "post_id": 49266239, "comment_id": 85535937, "body": "You have sort of jumped to the punchline without the joke. Where is the code to go with this please?"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1520984815, "post_id": 49266239, "comment_id": 85538670, "body": "If your called by name method expects an <code>Integer</code> you can type cast a variant to integer like <code>CallByName obj, &quot;Test&quot;, VbMethod, CInt(v)</code>"}, {"owner": {"reputation": 55, "user_id": 9362561, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-aZD136WAV2c/AAAAAAAAAAI/AAAAAAAAAqk/zgvKTxY019Q/photo.jpg?sz=128", "display_name": "Leo Steeves", "link": "https://stackoverflow.com/users/9362561/leo-steeves"}, "edited": false, "score": 0, "creation_date": 1521052462, "post_id": 49266239, "comment_id": 85573482, "body": "<code>Cint(x)</code> doesn&#39;t work either, it still throws an exception."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1521054152, "post_id": 49266239, "comment_id": 85574426, "body": "Your edit helps, but it is still far from being a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 55, "user_id": 9362561, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-aZD136WAV2c/AAAAAAAAAAI/AAAAAAAAAqk/zgvKTxY019Q/photo.jpg?sz=128", "display_name": "Leo Steeves", "link": "https://stackoverflow.com/users/9362561/leo-steeves"}, "edited": false, "score": 0, "creation_date": 1521056800, "post_id": 49266239, "comment_id": 85575829, "body": "Okay, but I know what the problem is; that <code>CallByName</code> doesn&#39;t accept <code>Variant</code> data types for its last argument (Args). I&#39;m asking if there is a workaround anyone can think of besides creating a large select case statement that catches the inputted data type and Dims a new variable in that type to pass to <code>CallByName</code>."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1521057246, "post_id": 49266239, "comment_id": 85576102, "body": "except the technical guidance says args()\tOptional: Variant ( Array )."}, {"owner": {"reputation": 55, "user_id": 9362561, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-aZD136WAV2c/AAAAAAAAAAI/AAAAAAAAAqk/zgvKTxY019Q/photo.jpg?sz=128", "display_name": "Leo Steeves", "link": "https://stackoverflow.com/users/9362561/leo-steeves"}, "edited": false, "score": 0, "creation_date": 1521057711, "post_id": 49266239, "comment_id": 85576367, "body": "As I said in the post, its because the <code>Let</code> property I&#39;m calling wants a specific data type, which causes <code>CallByName</code> to throw a type mismatch. I even said I don&#39;t know how this works since <code>VarType(Variant&#47;Integer) = VarType(Integer)</code>."}, {"owner": {"reputation": 55, "user_id": 9362561, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-aZD136WAV2c/AAAAAAAAAAI/AAAAAAAAAqk/zgvKTxY019Q/photo.jpg?sz=128", "display_name": "Leo Steeves", "link": "https://stackoverflow.com/users/9362561/leo-steeves"}, "edited": false, "score": 0, "creation_date": 1521057879, "post_id": 49266239, "comment_id": 85576470, "body": "To save you a comment, calling the <code>Let</code> property normally using a <code>Variant</code> data type works fine. It only fails when called by <code>CallByName</code>."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1521066536, "post_id": 49266239, "comment_id": 85580418, "body": "What about adding a properties collection to the class? By that you can let them without <code>CallByName</code>. You still don&#39;t show the class relevant code."}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 9362561, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-aZD136WAV2c/AAAAAAAAAAI/AAAAAAAAAqk/zgvKTxY019Q/photo.jpg?sz=128", "display_name": "Leo Steeves", "link": "https://stackoverflow.com/users/9362561/leo-steeves"}, "edited": false, "score": 0, "creation_date": 1521155531, "post_id": 49292646, "comment_id": 85623384, "body": "That makes sense, sorry I didn&#39;t think of that before asking the question. I&#39;ve been programming in C++ a lot and its default is pass by value so it never really crossed my mind."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "reply_to_user": {"reputation": 55, "user_id": 9362561, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-aZD136WAV2c/AAAAAAAAAAI/AAAAAAAAAqk/zgvKTxY019Q/photo.jpg?sz=128", "display_name": "Leo Steeves", "link": "https://stackoverflow.com/users/9362561/leo-steeves"}, "edited": false, "score": 0, "creation_date": 1521156254, "post_id": 49292646, "comment_id": 85623616, "body": "@LeoSteeves no need for excuses, this was a good problem to think of for me. Learned a lot digging into this.. Just one wish ;) Improve your question with an example of your classes properties to clearfy the problem for others. For sure then you will get some more votes, as topic itself is not the usual I can&#39;t code do it for me ;) . A feedback for Display Names property class would be good too, as it is unclear if this was helpful for you."}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1521280548, "post_id": 49292646, "comment_id": 85670902, "body": "See <a href=\"https://stackoverflow.com/questions/49287139/vba-assign-a-value-to-multiple-classes-at-once-property-let\">this answer</a> for an alternative using classes"}], "tags": [], "owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "is_accepted": true, "score": 3, "last_activity_date": 1521097058, "last_edit_date": 1521097058, "creation_date": 1521094428, "answer_id": 49292646, "question_id": 49266239, "link": "https://stackoverflow.com/questions/49266239/vba-callbyname-wont-accept-variant-arguments/49292646#49292646", "title": "VBA - CallByName won&#39;t accept variant arguments", "body": "<p>The Problem is that you pass the properties-arguments by reference not by value, but you can't pass a reference to a different datatype (variant -> long) as the types don't match and it can't be converted as this would change the data type in the caller too. By using brackets, you <a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/programming-guide/language-features/procedures/how-to-force-an-argument-to-be-passed-by-value\" rel=\"nofollow noreferrer\">force the argument to be passed by value</a> and it can be casted as type<code>Long</code>.</p>\n\n<p>You can avoid this by using <code>ByVal</code>in the<code>Property Letter</code>instead of<code>ByRef</code>(what is implicit used if not set). You are aware that by referencing a variable, changes made in the property change the callers value too? </p>\n\n<p>Example:</p>\n\n<p>Class PassExample</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>'Save as class module PassExample\nPublic Property Let PropByVal(ByVal NewVal As Long)\nNewVal = 1\nEnd Property\nPublic Property Let PropByRef(ByRef NewVal As Long)\nNewVal = 1\nEnd Property \n</code></pre>\n\n<p>Module with test sub:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>'save as standard module\nSub test()\nDim v As Variant\nv = 0\n\nDim ExampleInstance As New PassExample\n\nCallByName ExampleInstance, \"PropByVal\", VbLet, v 'this works\nCallByName ExampleInstance, \"PropByRef\", VbLet, v 'type mismatch\nCallByName ExampleInstance, \"PropByRef\", VbLet, (v) 'this works as ByRef is changed to byval\nDebug.Print v ' shows 0, not 1 as it should be if referenced\n\nCallByName ExampleInstance, \"PropByRef\", VbLet, CVar(v) ' works too as it passes a function-result that can't be referenced\n\nEnd Sub\n</code></pre>\n\n<p>Thanks to Rory and chris neilsen for providing the solution!</p>\n"}], "owner": {"reputation": 55, "user_id": 9362561, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-aZD136WAV2c/AAAAAAAAAAI/AAAAAAAAAqk/zgvKTxY019Q/photo.jpg?sz=128", "display_name": "Leo Steeves", "link": "https://stackoverflow.com/users/9362561/leo-steeves"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1063, "favorite_count": 0, "accepted_answer_id": 49292646, "answer_count": 1, "score": -1, "last_activity_date": 1521102473, "creation_date": 1520976976, "last_edit_date": 1531164843, "question_id": 49266239, "link": "https://stackoverflow.com/questions/49266239/vba-callbyname-wont-accept-variant-arguments", "title": "VBA - CallByName won&#39;t accept variant arguments", "body": "<p><strong>Solution:</strong> Just put brackets around Value in the CallByName statement to force evaluation of it. </p>\n\n<p>Ex. <code>CallByName MobClass, TargetData, vbLet, (Value)</code></p>\n\n<p>Credit goes to Rory from the other post, which I will probably be deleting since it is no longer relevant and a possible duplicate. </p>\n\n<p>I've spent a long time trying to figure out what was wrong with how I was using CallByName. I finally realized that its fourth argument (Args) will throw a type mismatch if the input is not either EXACTLY the same type as the input argument of what its calling or its hard-coded in.</p>\n\n<p>(I don't even understand how, or why, it does this since <code>VarType(Variant/Integer) = VarType(Integer)</code>)</p>\n\n<p>So I either need a way to make it accept variant inputs or convert variables from <code>Variant/Integer</code> to <code>Integer</code> (or create a new variable) without a giant select case.</p>\n\n<p>Edit: So my question wasn't clear so I'll explain it in more detail. I have a bunch of classes that I want to cycle through and call the <code>Let</code> property on. My simplified setup is: </p>\n\n<pre><code>Dim AllClasses as Collection \nSub SetAll(TargetProperty as String, Value as Variant)\n\n    For each ClassX in AllClasses\n\n        CallByName ClassX, TargetProperty, vbLet, Value\n\n    Next ClassX\n\nEnd Sub \n</code></pre>\n\n<p>The problem is <code>Value</code> when it is initialized as <code>Variant</code>. The only time I can get it to not throw a type mismatch exception is when I initialize <code>Value</code> as the exact same type that the property wants, but I can't do that since the data types in the class vary.</p>\n\n<p>Edit 2: I'm going to ask another question about the whole problem since no one seems to know much about <code>CallByName</code></p>\n\n<p>Edit 3: Here's a summary of what we have so far:</p>\n\n<ul>\n<li><p><code>CallByName</code>'s fourth argument (Args) throws a type mismatch when trying to call the <code>Let</code> property on a class. </p></li>\n<li><p>This only happens when the value trying to be assigned is stored in a <code>Variant</code> data type. It works perfectly if the variable is initialized to the same type the <code>Let</code> property is expecting OR if the value is hard-coded into the argument.</p></li>\n<li><p>The <code>Let</code> property works fine on its own. It accepts <code>Variant</code> data types just fine.</p></li>\n<li><p>My question is: <strong>Is there a way to stop this exception?</strong> I'm creating <a href=\"https://stackoverflow.com/questions/49287139/vba-assign-a-value-to-multiple-classes-at-once-property-let\">another post</a> about other possible solutions to my overall problem. </p></li>\n</ul>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 4798881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YAuEi.jpg?s=128&g=1", "display_name": "southerncoop7", "link": "https://stackoverflow.com/users/4798881/southerncoop7"}, "edited": false, "score": 0, "creation_date": 1521029485, "post_id": 49265362, "comment_id": 85557233, "body": "Thank you for the fast response. It looks like it is pulling data only from cell A1 from sheet1. Is it possible to change the MID formula to look at the same cell that &quot;r&quot; is looking at? For example: If &quot;r&quot; is checking A3 then =MID(Sheet1!A3,24,6)."}, {"owner": {"reputation": 37, "user_id": 4798881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YAuEi.jpg?s=128&g=1", "display_name": "southerncoop7", "link": "https://stackoverflow.com/users/4798881/southerncoop7"}, "edited": false, "score": 1, "creation_date": 1521030407, "post_id": 49265362, "comment_id": 85557857, "body": "This is perfect! Exactly what I needed! Thank you!"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1521029944, "last_edit_date": 1521029944, "creation_date": 1520973062, "answer_id": 49265362, "question_id": 49265134, "link": "https://stackoverflow.com/questions/49265134/loop-through-column-using-if-statement-checking-isnumber/49265362#49265362", "title": "Loop Through Column Using If Statement Checking =isnumber()", "body": "<p>You can do it like this - you may have to change sheet names to suit. That said, you don't need VBA for this, you could do it with formulae.</p>\n\n<pre><code>Sub Button1_Click()\n\nDim r As Range\n\nWith Sheet1\n    For Each r In .Range(\"A1\", .Range(\"A\" &amp; Rows.Count).End(xlUp))\n        If Left(r, 3) = \"101\" Then\n            Sheet2.Range(r.Address).Formula = \"=MID(Sheet1!\" &amp; r.Address &amp; \",24,6)\"\n        ElseIf Left(r, 3) = \"621\" Then\n            Sheet2.Range(r.Offset(, 1).Address).Formula = \"=MID(Sheet1!\" &amp; r.Address &amp; \",55,24)\"\n            Sheet2.Range(r.Offset(, 2).Address).Formula = \"=MID(Sheet1!\" &amp; r.Address &amp; \",30,10)\"\n        End If\n    Next r\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 4798881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YAuEi.jpg?s=128&g=1", "display_name": "southerncoop7", "link": "https://stackoverflow.com/users/4798881/southerncoop7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "accepted_answer_id": 49265362, "answer_count": 1, "score": 0, "last_activity_date": 1521029944, "creation_date": 1520972158, "last_edit_date": 1520975319, "question_id": 49265134, "link": "https://stackoverflow.com/questions/49265134/loop-through-column-using-if-statement-checking-isnumber", "title": "Loop Through Column Using If Statement Checking =isnumber()", "body": "<p>I'm just starting to use VBA and I would like some help with writing an IF statement that is searching using <code>=ISnumber()</code> as it loops through all of column A until it encounters an empty cell. </p>\n\n<p>The data I am working with is a text file that is being dropped onto sheet1 and has data that only populates column A. </p>\n\n<p>On sheet2 I would like to press a button that starts a loop. The loop needs to check each row of sheet 1 to see what the first three numbers of the line is for example: <code>=ISNUMBER(SEARCH(\"101\",A1))</code> If this qualification is met then complete something like: <code>=MID(A1,24,6)</code></p>\n\n<p>There are two different row starts: 101 and 621.</p>\n\n<p>My pseudo code logic is as follows:</p>\n\n<pre><code>Sub Button1_Click()\n\nIF 'first iteration\n    Row A1 starts with \"101\"\n        THEN Add =MID(A1,24,6) to cell A1 of sheet 2\n    ELSE IF\n        Row starts with \"621\"\n            THEN Add =MID(A1,55,24) to cell B1 of sheet 2\n                AND add =MID(A1,30,10) to cell C1 of sheet 2\n    ELSE\n        Skip this row\nEnd If\n\nIF 'second iteration\n    Row A2 starts with \"101\"\n        THEN Add =MID(A2,24,6) to cell A2 of sheet 2\n    ELSE IF\n        Row starts with \"621\"\n            THEN Add =MID(A2,55,24) to cell B2 of sheet 2\n                AND add =MID(A2,30,10) to cell C2 of sheet 2\n   ELSE\n        Skip this row\nEnd If\n'iterations continue until empty cell\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 106, "user_id": 9041998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Oe0W.jpg?s=128&g=1", "display_name": "Johnny D", "link": "https://stackoverflow.com/users/9041998/johnny-d"}, "edited": false, "score": 0, "creation_date": 1520976622, "post_id": 49265046, "comment_id": 85535689, "body": "You don&#39;t have a test for values &gt;.98 so the color will be undefined.   Add one more condition to handle if &gt; .98 and specify a color."}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 9415435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c13843f139b24a1d144bc15b402409f?s=128&d=identicon&r=PG&f=1", "display_name": "Sk123", "link": "https://stackoverflow.com/users/9415435/sk123"}, "edited": false, "score": 0, "creation_date": 1521049354, "post_id": 49273763, "comment_id": 85571681, "body": "Thank you, is there a way to add colour to all the bar in the bar chart? For example, right now I have Oct and Nov bar, tomorrow I will get Dec bar once i get the new data, can the macro apply colour to December bar automatically?"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 0, "last_activity_date": 1521019182, "creation_date": 1521019182, "answer_id": 49273763, "question_id": 49265046, "link": "https://stackoverflow.com/questions/49265046/excel-vba-nested-if-applying-colours-to-graphs/49273763#49273763", "title": "Excel VBA - Nested IF applying colours to graphs", "body": "<p><strong>First</strong>: you can replace you multiple <code>If</code>s and <code>Else</code> with <code>Select Case</code>, it will clean and shorten you code by a lot.</p>\n\n<p><strong>Second</strong>: there's no need to select the chart and the point in each of these conditions, you are repeating the same procedures for all scenarios, you can do that before the <code>If</code>s section (or <code>Select Case</code>).</p>\n\n<p><strong>Third</strong>: it's better to avoid using <code>Select</code>, <code>Activate</code> and <code>Selection</code>, instead fully qualify all your Chart, Series and Point objects.</p>\n\n<p>More explanation in the code below;</p>\n\n<p><strong><em>Code</em></strong></p>\n\n<pre><code>Option Explicit\n\nSub ColorGraphs()\n\nDim ChrtObj As ChartObject\nDim Ser As Series\nDim SerPoint As Point\n\n' set the ChartObject\nSet ChrtObj = ActiveSheet.ChartObjects(\"Chart 18\")\n\n' set the Series\nSet Ser = ChrtObj.Chart.SeriesCollection(1)\n\n' set the series point\nSet SerPoint = Ser.Points(3)\n\n' these setting are the same for all your scenarios\nWith SerPoint.Format.Fill\n    .Visible = msoTrue\n    .Transparency = 0\n    .Solid\nEnd With\n\nSelect Case Range(\"D112\").Value\n    Case Is &lt; 0.96\n        SerPoint.Format.Fill.ForeColor.RGB = RGB(204, 0, 51)\n        Range(\"P8\").Interior.Color = RGB(204, 0, 51)\n\n    Case 0.96 To 0.98\n        SerPoint.Format.Fill.ForeColor.RGB = RGB(255, 102, 0)\n        Range(\"P8\").Interior.Color = RGB(255, 102, 0)\n\n    Case Else ' larger than 0.98\n        SerPoint.Format.Fill.ForeColor.RGB = RGB(0, 153, 102)\n        Range(\"P8\").Interior.Color = RGB(0, 153, 102)\n\nEnd Select\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 9415435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c13843f139b24a1d144bc15b402409f?s=128&d=identicon&r=PG&f=1", "display_name": "Sk123", "link": "https://stackoverflow.com/users/9415435/sk123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 49273763, "answer_count": 1, "score": 0, "last_activity_date": 1521019494, "creation_date": 1520971814, "last_edit_date": 1521019494, "question_id": 49265046, "link": "https://stackoverflow.com/questions/49265046/excel-vba-nested-if-applying-colours-to-graphs", "title": "Excel VBA - Nested IF applying colours to graphs", "body": "<p>Could anyone tell me what is wrong with the following code? </p>\n\n<p>It is working most of the time, however sometimes it fails to apply proper colour. For example if the % change from 97% to 100% in cell D112, it will not apply the green colour, but in some cases it will.</p>\n\n<p>Basically based on a % value of a cell D112, I want to apply different colour to the bar chart.</p>\n\n<pre><code>If Range(\"D112\") &lt; 0.96 Then\n    ActiveSheet.ChartObjects(\"Chart 18\").Activate\n    ActiveChart.FullSeriesCollection(1).Select\n    ActiveChart.FullSeriesCollection(1).Points(3).Select\n    With Selection.Format.Fill\n        .Visible = msoTrue\n        .ForeColor.RGB = RGB(204, 0, 51)\n        .Transparency = 0\n        .Solid\n    End With\n    Range(\"P8\").Interior.Color = RGB(204, 0, 51)\n\nElseIf Range(\"D112\") &gt;= 0.96 And Range(\"D112\") &lt;= 0.98 Then\n    ActiveSheet.ChartObjects(\"Chart 18\").Activate\n    ActiveChart.FullSeriesCollection(1).Select\n    ActiveChart.FullSeriesCollection(1).Points(3).Select\n    With Selection.Format.Fill\n        .Visible = msoTrue\n        .ForeColor.RGB = RGB(255, 102, 0)\n        .Transparency = 0\n        .Solid\n    End With\n    Range(\"P8\").Interior.Color = RGB(255, 102, 0)\n\nElse\n    ActiveSheet.ChartObjects(\"Chart 18\").Activate\n    ActiveChart.FullSeriesCollection(1).Select\n    ActiveChart.FullSeriesCollection(1).Points(3).Select\n    With Selection.Format.Fill\n        .Visible = msoTrue\n        .ForeColor.RGB = RGB(0, 153, 102)\n        .Transparency = 0\n        .Solid\n    End With\n\n    Range(\"P8\").Interior.Color = RGB(0, 153, 102)\nEnd If\n</code></pre>\n"}, {"tags": ["vba", "loops", "conditional", "messagebox"], "comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1520971627, "post_id": 49264904, "comment_id": 85533354, "body": "exit your for loop if you only want it to display once via the worksheet change event <code>Exit For</code>.  Create a global variable to hold a Boolean on if it was shown if you only want to display it once per instance."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1520973298, "post_id": 49264904, "comment_id": 85534200, "body": "It looks like you&#39;re trying to implement poor man&#39;s <i>data validation</i>. You&#39;re reinventing the wheel, look under the [Data] Ribbon tab."}], "answers": [{"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 2, "last_activity_date": 1520971659, "creation_date": 1520971659, "answer_id": 49265007, "question_id": 49264904, "link": "https://stackoverflow.com/questions/49264904/vba-message-box-display-loop-on-condition/49265007#49265007", "title": "VBA: Message Box Display, Loop on Condition", "body": "<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    For Each cell In Range(\"S194:BZ194\")\n        If cell.Value &lt; 0 Then\n            MsgBox \"Unrestricted cash cannot be less than zero (Row 194). Please lower the loan growth rate.\"\n            Exit For\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 7512242, "user_type": "registered", "profile_image": "https://graph.facebook.com/10107500013065510/picture?type=large", "display_name": "Christian J", "link": "https://stackoverflow.com/users/7512242/christian-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 927, "favorite_count": 0, "accepted_answer_id": 49265007, "answer_count": 1, "score": 0, "last_activity_date": 1520971659, "creation_date": 1520971231, "question_id": 49264904, "link": "https://stackoverflow.com/questions/49264904/vba-message-box-display-loop-on-condition", "title": "VBA: Message Box Display, Loop on Condition", "body": "<p>I have created VBA code that displays a message box when a certain condition is met. This if statement loops through a determined range. However, the message box is displayed for every cell that meets my condition. Is there a way to ensure the message box is only displayed once? </p>\n\n<p>Here is my code:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nFor Each cell In Range(\"S194:BZ194\")\n    If cell.Value &lt; 0 Then\nMsgBox \"Unrestricted cash cannot be less than zero (Row 194). Please lower the loan growth rate.\"\nEnd If\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "answers": [{"comments": [{"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1521071319, "post_id": 49264974, "comment_id": 85581931, "body": "You should add a check for <code>Control.Value</code> is null by concat an empty string : <code>c.value &amp; vbNullString = vbNullString</code> where <code>vbNullString</code>is the vba-constant for <code>&quot;&quot;</code> (Nz-function would work too, but only in ms-access)."}], "tags": [], "owner": {"reputation": 86, "user_id": 7913774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e67be46a41c1b6ad853dce97837d5b17?s=128&d=identicon&r=PG&f=1", "display_name": "Surya Prakash", "link": "https://stackoverflow.com/users/7913774/surya-prakash"}, "is_accepted": false, "score": 0, "last_activity_date": 1520971517, "creation_date": 1520971517, "answer_id": 49264974, "question_id": 49264658, "link": "https://stackoverflow.com/questions/49264658/check-if-all-inputs-are-not-empty-except-one/49264974#49264974", "title": "Check if all inputs are not empty except one", "body": "<pre><code>For Each c In Me.Controls\n            If TypeName(c) = \"TextBox\" Or TypeName(c) = \"ComboBox\" Then\n                If c.Name &lt;&gt; \"txtPesquisa\" And c.Value = \"\" Then\n                    MsgBox \"Preencher todas informa\u00e7\u00f5es necess\u00e1rias para agendamento!\"\n                    Exit Sub\n                End If\n            End If\n        Next\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 8575305, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/33OCD.jpg?s=128&g=1", "display_name": "BernardoRValle", "link": "https://stackoverflow.com/users/8575305/bernardorvalle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1520971517, "creation_date": 1520970252, "last_edit_date": 1520970996, "question_id": 49264658, "link": "https://stackoverflow.com/questions/49264658/check-if-all-inputs-are-not-empty-except-one", "title": "Check if all inputs are not empty except one", "body": "<p>I want to check if on a form, if all input (txtbox and combobox) are not empty except one that I use for searches (that one is empty, when I'm not using it)</p>\n\n<p>The name of the the txtbox is \"txtPesquisa\" - I use it for searchs</p>\n\n<pre><code>    For Each c In Me.Controls\nIf TypeName(c) = \"TextBox\" Or TypeName(c) = \"ComboBox\" Then\n    If c.Value = \"\" Then\n            MsgBox \"Preencher todas informa\u00e7\u00f5es necess\u00e1rias para agendamento!\"\n            Exit Sub\n    End If\nEnd If\n</code></pre>\n\n<p>Next c</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1209, "user_id": 3927703, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/1058356120/picture?type=large", "display_name": "Alex de Jong", "link": "https://stackoverflow.com/users/3927703/alex-de-jong"}, "edited": false, "score": 0, "creation_date": 1520969962, "post_id": 49264413, "comment_id": 85532484, "body": "Isn&#39;t this an Access VBA object? What do you want to get? In Excel, you could use Me.Name if a form is active in most cases."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1520970439, "post_id": 49264413, "comment_id": 85532738, "body": "<code>Screen</code> is a thing in VB6, not in VBA."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1520971423, "post_id": 49264413, "comment_id": 85533248, "body": "I&#39;m curious about <i>why</i> you would ever even <i>need</i> to get the active form though. How are you displaying that form? Is it modal? There are multiple modeless instances of a form that are visible and you&#39;re trying to get the topmost one? Please clarify. Feel free to include a screenshot of the forms so we can get a better idea of what you&#39;re looking at."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1520971932, "post_id": 49264413, "comment_id": 85533491, "body": "Apparently <code>Screen.ActiveForm</code> is a thing in Access. Note that it returns an <i>Access Form</i>, not a <code>UserForm</code>. In any case without seeing more of your code (in particular, how the forms are displayed), I doubt you&#39;ll get a useful answer."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 1, "creation_date": 1520972410, "post_id": 49264413, "comment_id": 85533762, "body": "This seems to be an XY problem"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 1, "creation_date": 1520972840, "post_id": 49264413, "comment_id": 85533956, "body": "@Storax definitely. That said, <a href=\"https://stackoverflow.com/a/27747500/1188513\"><b>this should help</b></a>. But IMO if you&#39;re displaying a form and you don&#39;t have a programmatic handle on it, you&#39;re doing something wrong. See if <a href=\"https://rubberduckvba.wordpress.com/2017/10/25/userform1-show/\" rel=\"nofollow noreferrer\"><b>this article</b></a> I wrote a few months ago can help restructure things."}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1520975844, "post_id": 49265612, "comment_id": 85535360, "body": "If you would have included the code that displays the form as I asked, we could have helped with the poor design. By all means read the article I linked to in my last comment to your question - it&#39;s possibly a bit advanced stuff, but it should help you wrap your head around form instances, and avoid common traps related to dealing with forms&#39; default instances. That said passing <code>Me</code> works just fine - the design problem IMO is that your form seems to be running the show."}], "tags": [], "owner": {"reputation": 11, "user_id": 9487641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79933f5c702d2c401f8d37ae81980276?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/9487641/matt"}, "is_accepted": false, "score": 1, "last_activity_date": 1520974118, "creation_date": 1520974118, "answer_id": 49265612, "question_id": 49264413, "link": "https://stackoverflow.com/questions/49264413/screen-object-not-found/49265612#49265612", "title": "Screen Object not found", "body": "<p>I was able to get this to work by having the function accept the form as a parameter:</p>\n\n<pre><code>Public Sub LoadData(frmLoad As Object)\n</code></pre>\n\n<p>And simply pass Me to the function:</p>\n\n<pre><code>LoadData Me\n</code></pre>\n\n<p>Perhaps the is poor design but it works.  And therefor I don't need to include the LoadData function in each form.</p>\n\n<p>Matt</p>\n"}], "owner": {"reputation": 11, "user_id": 9487641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79933f5c702d2c401f8d37ae81980276?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/9487641/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 192, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1520974118, "creation_date": 1520969353, "last_edit_date": 1531164843, "question_id": 49264413, "link": "https://stackoverflow.com/questions/49264413/screen-object-not-found", "title": "Screen Object not found", "body": "<p>I have a Project in Excel.  I have a module with sub Load to populate the ActiveForm with data in an Excel table that is tagged to go into that respective form.  The idea is that whichever Form is active, I can call Load and get the data from the Excel table.</p>\n\n<p>I am trying to use this simple code to get the name of the active form, like I have seen in so many examples</p>\n\n<pre><code>Debug.Print Screen.activeform.Name\n</code></pre>\n\n<p>However, the Screen object cannot be found.  I get \"Variable Not Defined\" error. \n Is this something that can be added via references?  I have searched high and low.  Or, can I pass a reference to the \"Me\" to the module?</p>\n\n<p>Here is the code I have in the module to populate whichever form the user opens:</p>\n\n<pre><code>Public Sub Load()\n\nDim rw As Long\n\nSet wb = ThisWorkbook\nSet wsInputs = wb.Worksheets(\"Inputs\")\nSet loInputs = wsInputs.ListObjects(\"tInputs\")\n\nWith loInputs\n    For rw = 1 To .DataBodyRange.Rows.Count\n        If .ListColumns(\"Form\").DataBodyRange.Rows(rw) = screen.activeform Then\n            screen.activeform.Controls(.ListColumns(\"Control Name\").DataBodyRange.Rows(rw).Value) _\n            = .ListColumns(\"Value\").DataBodyRange.Rows(rw).Value\n        End If\n    Next rw\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>The different forms are just different categories of data for input into text and combo boxes that read back and forth from the form to Excel, of if there is data in Excel and the user opens that form, it is pre-populated.</p>\n\n<p>I can include a screenshot but its just a bunch of labels and input boxes.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1520969201, "post_id": 49264310, "comment_id": 85532088, "body": "Where exactly would this &quot;0&quot; be that you&#39;re looking for. I feel there&#39;s an easier way to do this, but right now you haven&#39;t provided much information. Also, is your &quot;0&quot; formatted as a string? Because that&#39;s what your implying by placing it between quotation marks."}, {"owner": {"reputation": 1285, "user_id": 2171052, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4523551e31af1516a685ef1ff1f889eb?s=128&d=identicon&r=PG", "display_name": "Aaron", "link": "https://stackoverflow.com/users/2171052/aaron"}, "edited": false, "score": 0, "creation_date": 1520969574, "post_id": 49264310, "comment_id": 85532283, "body": "Is there a reason you can&#39;t use a nested loop and just call them by number? <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/refer-to-cells-by-using-index-numbers\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/vba/excel-vba/articles/&hellip;</a>"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1520969617, "post_id": 49264310, "comment_id": 85532309, "body": "Why do you use Countif for testing if a cell contains a &quot;0&quot; And do you want to clear contents only in case every cell contains a 0 or do you want to clear in case just one has a 0?"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 9388011, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fwgNf.jpg?s=128&g=1", "display_name": "Tourless", "link": "https://stackoverflow.com/users/9388011/tourless"}, "edited": false, "score": 0, "creation_date": 1520970726, "post_id": 49264473, "comment_id": 85532877, "body": "brilliant in it&#39;s simplicity. Thank you very much!"}], "tags": [], "owner": {"reputation": 1209, "user_id": 3927703, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/1058356120/picture?type=large", "display_name": "Alex de Jong", "link": "https://stackoverflow.com/users/3927703/alex-de-jong"}, "is_accepted": true, "score": 1, "last_activity_date": 1520969599, "creation_date": 1520969599, "answer_id": 49264473, "question_id": 49264310, "link": "https://stackoverflow.com/questions/49264310/if-0-clear-contents-for-multiple-columns/49264473#49264473", "title": "If 0 clear contents for multiple columns", "body": "<p>You can use <code>Range(\"D5:P65536\").Replace What:=0,Replacement:=\"\"</code> to Replace all at once.</p>\n"}, {"tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": false, "score": 0, "last_activity_date": 1520969889, "creation_date": 1520969889, "answer_id": 49264556, "question_id": 49264310, "link": "https://stackoverflow.com/questions/49264310/if-0-clear-contents-for-multiple-columns/49264556#49264556", "title": "If 0 clear contents for multiple columns", "body": "<p>Maybe you are looking for sth like that. This will clear contents only if every cell in a row contains a 0. </p>\n\n<pre><code>Dim i As Long\nDim rg As Range\n\n    For i = 5 To Range(\"D\" &amp; \"65536\").End(xlUp).Row Step 1\n        Set rg = Range(\"D\" &amp; i &amp; \":P\" &amp; i)\n        If Application.WorksheetFunction.CountIf(rg, \"0\") = 13 Then\n            rg.ClearContents\n        End If\n    Next i\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 0, "last_activity_date": 1520969897, "creation_date": 1520969897, "answer_id": 49264560, "question_id": 49264310, "link": "https://stackoverflow.com/questions/49264310/if-0-clear-contents-for-multiple-columns/49264560#49264560", "title": "If 0 clear contents for multiple columns", "body": "<p>Loop through the actual <em>column</em> and use the <code>Find()</code> method to perform your search. If your value exists in that range (range = column), then you can clear the contents that way.</p>\n\n<pre><code>Sub test()\n\n    ' Just for illustration on the columns\n    Const D&amp; = 4:   Const P&amp; = 16\n\n    Dim ws As Worksheet, col As Long\n    Set ws = ThisWorkbook.Worksheets(1)\n\n    For col = D To P\n        If Not ws.Columns(col).find(What:=\"0\", LookAt:=xlWhole) Is Nothing Then\n            ws.Columns(col).ClearContents\n        End If\n    Next col\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 9388011, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fwgNf.jpg?s=128&g=1", "display_name": "Tourless", "link": "https://stackoverflow.com/users/9388011/tourless"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 49264473, "answer_count": 3, "score": 0, "last_activity_date": 1520969897, "creation_date": 1520968946, "last_edit_date": 1531164843, "question_id": 49264310, "link": "https://stackoverflow.com/questions/49264310/if-0-clear-contents-for-multiple-columns", "title": "If 0 clear contents for multiple columns", "body": "<p>I'm wondering how to make the following code work for multiple columns (D:P)?   I've already tried adding &amp; \":\"P\" &amp; \"65536\" to the range, without success.</p>\n\n<pre><code>For i = 5 To Range(\"D\" &amp; \"65536\").End(xlUp).Row Step 1\nIf Application.WorksheetFunction.CountIf(Range(\"D\" &amp; i), \"0\") = 1 Then\nRange(\"D\" &amp; i).ClearContents\nEnd If\nNext i \n</code></pre>\n"}]