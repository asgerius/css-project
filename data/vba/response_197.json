[{"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 36, "user_id": 5873909, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_tFPBa8ibuw/AAAAAAAAAAI/AAAAAAAABA4/qh-D5sNd5XQ/photo.jpg?sz=128", "display_name": "viral gandhi", "link": "https://stackoverflow.com/users/5873909/viral-gandhi"}, "edited": false, "score": 0, "creation_date": 1539868558, "post_id": 52864671, "comment_id": 92663214, "body": "You can use web drivers like selenium to expand it by click events and get the tag out of it."}, {"owner": {"reputation": 36, "user_id": 5873909, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_tFPBa8ibuw/AAAAAAAAAAI/AAAAAAAABA4/qh-D5sNd5XQ/photo.jpg?sz=128", "display_name": "viral gandhi", "link": "https://stackoverflow.com/users/5873909/viral-gandhi"}, "edited": false, "score": 0, "creation_date": 1539868569, "post_id": 52864671, "comment_id": 92663221, "body": "You can use web drivers like selenium to expand it by click events and get the tag out of it."}, {"owner": {"reputation": 3934, "user_id": 212869, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/376b87d1def88c60fc6a8712eb585354?s=128&d=identicon&r=PG", "display_name": "NickSlash", "link": "https://stackoverflow.com/users/212869/nickslash"}, "edited": false, "score": 0, "creation_date": 1591460937, "post_id": 52864671, "comment_id": 110067061, "body": "Can you share a link to the site in question?"}], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1591460617, "creation_date": 1539816706, "last_edit_date": 1591460617, "question_id": 52864671, "link": "https://stackoverflow.com/questions/52864671/how-to-expand-html-elements-and-scrape-td-elements-from-table-schemas", "title": "How to expand HTML elements and scrape td elements from table schemas?", "body": "<p>I am working with a website that requires a user to click on an object, expand it, and then the schema of the table will be revealed.  This is for Google BigQuery; everything is web-based.  The relevant HTML, and and all tag, looks like this.</p>\n\n<pre><code>&lt;div class=\"p6n-dynamic-tree-node-wrapper layout-row flex\" tabindex=\"-1\" role=\"treeitem\" aria-expanded=\"false\" ng-focus=\"treeCtrl.handleNgFocus($index)\" ng-blur=\"treeCtrl.handleNgBlur($index)\" ng-keydown=\"treeCtrl.handleKeyPress($event, $index, node)\" ng-click=\"treeCtrl.handleNodeClick(node)\" flex=\"\" layout=\"row\" jslog=\"47815;track:generic_click\"&gt; &lt;!----&gt; &lt;span class=\"p6n-dynamic-tree-node-content\" style=\"padding-left: 56px;\"&gt; &lt;span class=\"p6n-dynamic-tree-fixed-icon-width\"&gt; &lt;!----&gt; &lt;!----&gt; &lt;/span&gt; &lt;span ng-transclude=\"\" class=\"p6n-dynamic-tree-transclude-span\"&gt; &lt;!----&gt;&lt;pan-icon class=\"p6n-bq-tree-node-icon flex-none\" flex=\"none\" ng-if=\"node.icon\" size=\"18\" icon=\"table\"&gt;\n            &lt;div class=\"p6n-icon p6n-icon-18 p6n-icon-table\"&gt;\n              &lt;!----&gt;\n              &lt;!----&gt;&lt;md-icon ng-if=\"icon != 'working'\" class=\"\" md-svg-icon=\"icon-18:table\" ng-attr-aria-label=\"{{innerAriaLabel === null ?\n                                        undefined :\n                                        innerAriaLabel || icon}}\" role=\"img\" aria-label=\"table\"&gt;&lt;svg id=\"table_cache57\" width=\"100%\" height=\"100%\" viewBox=\"0 0 18 18\" xmlns=\"http://www.w3.org/2000/svg\" fit=\"\" preserveAspectRatio=\"xMidYMid meet\" focusable=\"false\"&gt;&lt;path d=\"M2 2h14v14H2V2zm2 6v2h2V8H4zm0-4v2h10V4H4zm0 8v2h2v-2H4zm4-4v2h2V8H8zm4 0v2h2V8h-2zm-4 4v2h2v-2H8zm4 0v2h2v-2h-2z\" fill-rule=\"evenodd\"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/md-icon&gt;&lt;!----&gt;\n            &lt;/div&gt;&lt;/pan-icon&gt;&lt;!----&gt; &lt;span class=\"p6n-ellipsis flex\" flex=\"\"&gt; tickets &lt;/span&gt; &lt;!----&gt; &lt;/span&gt; &lt;/span&gt; &lt;/div&gt;\n</code></pre>\n\n<p>After the table is expanded, by a click event, the table schema is revealed, and everything is under tables, with td elements, like this:  </p>\n\n<pre><code>&lt;tr pan-table-row=\"\" ng-repeat=\"field in ctrl.flatSchema | panSortBy:(sortCtrl&amp;amp;&amp;amp;sortCtrl.getActiveKey()):&amp;quot;normal&amp;quot;:sortCache:paginateCtrl  track by field.fullName\" ng-init=\"$last &amp;amp;&amp;amp; panTableCtrl.onRowRepeatEnd()\" pan-table-row-after-repeat=\"field\"&gt;&lt;!----&gt;&lt;!----&gt; &lt;td ng-class=\"{'p6n-bq-table-schema-clickable-field-name': ctrl.areFieldsClickable()}\" ng-click=\"ctrl.onFieldClick(field)\" role=\"button\" tabindex=\"0\" class=\"p6n-bq-table-schema-clickable-field-name\"&gt; &lt;span class=\"p6n-color-secondary\"&gt;&lt;/span&gt;&lt;b class=\"p6n-color-primary\"&gt;submitter_id&lt;/b&gt;&lt;/td&gt; &lt;td&gt;INTEGER&lt;/td&gt; &lt;td&gt;NULLABLE&lt;/td&gt; &lt;!----&gt;&lt;td ng-if=\"ctrl.showDescription()\"&gt;&lt;/td&gt;&lt;!----&gt; &lt;/tr&gt;\n</code></pre>\n\n<p>So, my question is, based on the description above, is there a way to expand all web-based tables, expand each, and scrape info from td elements of each table schema?  Thanks for the look.</p>\n"}, {"tags": ["excel", "vba", "pivot-table"], "owner": {"reputation": 31, "user_id": 7816067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ac232edfea25eb1820b70cc126047cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheresGotToBeABetterWay", "link": "https://stackoverflow.com/users/7816067/theresgottobeabetterway"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1544298154, "creation_date": 1539816335, "last_edit_date": 1544298154, "question_id": 52864615, "link": "https://stackoverflow.com/questions/52864615/drilldown-3-separate-olap-pivottables-on-same-sheet-at-the-time", "title": "Drilldown 3 separate OLAP PivotTables on same sheet at the time", "body": "<p>I have a data source to create 3 pivot tables on the same sheet, TCSum.</p>\n\n<p>The 3 tables are lined up right next to each other and all 3 have the same two Rows in the PivotTable Fields, in this order: Region - Market.</p>\n\n<p>I don't want the Region column to be shown 3 times so I've hidden columns G and K on my TCSum sheet.</p>\n\n<p>I'd like when I click the expand button in Column A for my first Region, it expands all 3 tables.</p>\n\n<p>I found <a href=\"https://stackoverflow.com/questions/12352905/making-all-pivot-tables-on-one-sheet-mimic-each-other-in-terms-of-rows-expanding#\">Making all pivot tables on one sheet mimic each other in terms of rows expanding and collapsing</a>. I tried both methods there, and in the more efficient method did update this line with 4 different entries.</p>\n\n<p>I tried:</p>\n\n<pre><code>PivotFieldIndex = \"Region\"\nPivotFieldIndex = \"[Region]\"\nPivotFieldIndex = \"Market\"\nPivotFieldIndex = \"[Market]\"\n</code></pre>\n\n<p>I tried Region and [Region] because I thought since this is added to a data model the correct PivotFieldIndex may need to include them. I came to that conclusion by recording a macro on one data model source and one regular table source.</p>\n\n<p>I also realized that regular pivot tables use ShowDetail while OLAP uses DrilledDown so I attempted to replace every ShowDetail with DrilledDown with no luck. The reason I added this data to a data model is the 3rd pivot table uses the discount count function.</p>\n\n<p>The instructions on the other post mentioned the sheet with the pivot tables needed to be the furthest to the left, which TCSum is, but when I look in Visual Basic, I see Sheet3(TCSum), so I also tried replacing </p>\n\n<pre><code>Set wks = wkb.Sheets(1)\n</code></pre>\n\n<p>With</p>\n\n<pre><code>Set wks = wkb.Sheets(3)\n</code></pre>\n\n<p>And I figured why not try</p>\n\n<pre><code>Set wks = wkb.Sheets(\"TCSum\")\n</code></pre>\n\n<p>I don't get any debug errors when I click the expand button on any of the rows, but unfortunately table 1 expands.</p>\n\n<p>The 3 PivotTables on TCSum are named: TCByType, TCAge, TCAffected (which has the discount count if that matters).</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1539815411, "post_id": 52864421, "comment_id": 92643228, "body": "You can use <code>SUMIF()</code> for this"}, {"owner": {"reputation": 11, "user_id": 10457463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf5aee4184cc7631f4a53a10ff09783a?s=128&d=identicon&r=PG&f=1", "display_name": "kh999459", "link": "https://stackoverflow.com/users/10457463/kh999459"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1539815866, "post_id": 52864421, "comment_id": 92643350, "body": "@TimWilliams Thank you Tim! Sumif needs me to actually have the value listed of each group to sum. The problem is the value for each group in a row is stored temporarily in a variant..."}], "answers": [{"tags": [], "owner": {"reputation": 716, "user_id": 8468145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d93037f8271a7ae98fee7cad2debe0aa?s=128&d=identicon&r=PG&f=1", "display_name": "0liveradam8", "link": "https://stackoverflow.com/users/8468145/0liveradam8"}, "is_accepted": false, "score": 0, "last_activity_date": 1539817532, "creation_date": 1539817532, "answer_id": 52864790, "question_id": 52864421, "link": "https://stackoverflow.com/questions/52864421/sum-up-value-with-different-keys/52864790#52864790", "title": "Sum up value with different keys", "body": "<p>I've rewritten the code to use instead of yours. It adds up all the rows between two row indexes, as long as the first cell in each row has a value of <code>\"Group A\"</code>.</p>\n\n<pre><code>Dim firstRow As Integer\nDim lastRow As Integer\nDim currentSum As Integer\nDim currentGroup As String\n\n'Change firstRow and lastRow to the row indexes of the cells you're adding\nfirstRow = 10\nlastRow = 13\ncurrentSum = 0\ncurrentGroup = \"Group A\"\n\nFor n = firstRow To lastRow\n    If Cells(n, 1).Value = currentGroup Then\n        currentSum = currentSum + Application.sum(Range(Cells(n, 1), Cells(n, 50)))\n    End If\n\n    'Put the cell name of where you want the value, instead of B3\n    Range(\"B3\").Value = currentSum\n\n    'Change currentGroup to the next group here\nNext n\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 4, "last_activity_date": 1539834561, "last_edit_date": 1539834561, "creation_date": 1539817744, "answer_id": 52864808, "question_id": 52864421, "link": "https://stackoverflow.com/questions/52864421/sum-up-value-with-different-keys/52864808#52864808", "title": "Sum up value with different keys", "body": "<p>Use SUMPRODUCT:</p>\n\n<pre><code>=SUMPRODUCT(($A$7:$A$18=A1)*($B$7:$G$18))\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/KG8nJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KG8nJ.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 10457463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf5aee4184cc7631f4a53a10ff09783a?s=128&d=identicon&r=PG&f=1", "display_name": "kh999459", "link": "https://stackoverflow.com/users/10457463/kh999459"}, "edited": false, "score": 0, "creation_date": 1539897962, "post_id": 52866663, "comment_id": 92679050, "body": "thank you a lot!! This works very well. I have little experience in array so I am trying my best to understand the range part and will let you know if I have thoughts on it."}], "tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": true, "score": 1, "last_activity_date": 1539833966, "creation_date": 1539833966, "answer_id": 52866663, "question_id": 52864421, "link": "https://stackoverflow.com/questions/52864421/sum-up-value-with-different-keys/52866663#52866663", "title": "Sum up value with different keys", "body": "<h1>A VBA Array Version</h1>\n\n<p>Before using this code adjust the data in the <strong>customize</strong> section to fit your needs.<br>\nThe commented blocks starting with     <code>'  str1 = \"</code> are used for debugging. You can delete them or uncomment them to see some 'subtotals' in the <strong>immediate</strong> window.</p>\n\n<pre><code>Option Explicit\n\nSub SumGroups()\n\n'-- Customize BEGIN --------------------\n  Const cStrG As String = \"B2\" 'First cell of the group section\n  Const cStrD As String = \"B15\" 'First cell of the data section\n'-- Customize END ----------------------\n\n  Dim oRng As Range\n  Dim oRngResults As Range\n\n  Dim arrNames As Variant\n  Dim arrData As Variant\n  Dim arrResults As Variant\n\n  Dim loNames As Long\n  Dim loData As Long\n  Dim iDataCol As Integer\n  Dim dblResults As Double\n\n  'Debug\n  Dim lo1 As Long\n  Dim i1 As Integer\n  Dim str1 As String\n  Dim str2 As String\n  Dim dTime As Double\n\n'  'Determine the group names range using the first cell of the data section.\n'  Set oRng = Range(cStrG).Resize(Range(cStrD).Rows.End(xlUp).Row - 1, 1)\n\n  'Determine the group names range using the last cell of the group section.\n  Set oRng = Range(cStrG).Resize(Range(cStrG).Rows.End(xlDown).Row - 1, 1)\n  'Determine the range of the results\n  Set oRngResults = oRng.Offset(0, 1)\n  'Paste the group names range into an array\n  arrNames = oRng\n\n'  str1 = \"arrNames:\"\n'  For lo1 = LBound(arrNames) To UBound(arrNames)\n'    str1 = str1 &amp; vbCrLf &amp; lo1 &amp; \". \" &amp; Chr(9) &amp; arrNames(lo1, 1)\n'  Next\n'  Debug.Print str1\n\n  'Determine the data range using resize NOT finished.\n'  Set oRng = Range(cStrD).Resize(Cells(Cells.Rows.Count, _\n      Range(cStrD).Column).End(xlUp).Row - Range(cStrD).Row + 1, 1)\n\n  'Determine the data range not using resize.\n  Set oRng = Range(Cells(Range(cStrD).Row, Range(cStrD).Column), _\n      Cells(Cells(Cells.Rows.Count, Range(cStrD).Column).End(xlUp).Row, _\n      Cells(Range(cStrD).Row, Cells.Columns.Count).End(xlToLeft).Column))\n  'Paste the data range into an array\n  arrData = oRng\n\n  Set oRng = Nothing 'Release object variable\n\n'  str1 = \"arrData:\"\n'  For lo1 = LBound(arrData) To UBound(arrData)\n'    str2 = \"\"\n'    For i1 = LBound(arrData, 2) To UBound(arrData, 2)\n'      str2 = str2 &amp; Chr(9) &amp; arrData(lo1, i1)\n'    Next\n'    str1 = str1 &amp; vbCrLf &amp; lo1 &amp; \".\" &amp; str2\n'  Next\n'  Debug.Print str1\n\n  arrResults = oRngResults\n\n  For loNames = LBound(arrNames) To UBound(arrNames)\n    dblResults = 0\n    For loData = LBound(arrData) To UBound(arrData)\n      If arrNames(loNames, 1) = arrData(loData, 1) Then\n        For iDataCol = LBound(arrData, 2) + 1 To UBound(arrData, 2)\n          dblResults = dblResults + arrData(loData, iDataCol)\n        Next\n      End If\n    Next\n    arrResults(loNames, 1) = dblResults\n  Next\n\n'  str1 = \"arrResults:\"\n'  For lo1 = LBound(arrResults) To UBound(arrResults)\n'    str1 = str1 &amp; vbCrLf &amp; lo1 &amp; \". \" &amp; Chr(9) &amp; arrResults(lo1, 1)\n'  Next\n'  Debug.Print str1\n\n  oRngResults = arrResults\n\n  Set oRngResults = Nothing 'Release object variable\n\nEnd Sub\n</code></pre>\n\n<p>At 50000 rows it calculates in less than a second. The determination of the ranges gave me quite some grief, but I still think they could probably be improved. Would appreciate some feedback regarding the ranges.</p>\n"}], "owner": {"reputation": 11, "user_id": 10457463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf5aee4184cc7631f4a53a10ff09783a?s=128&d=identicon&r=PG&f=1", "display_name": "kh999459", "link": "https://stackoverflow.com/users/10457463/kh999459"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 52866663, "answer_count": 3, "score": 1, "last_activity_date": 1591588742, "creation_date": 1539814850, "last_edit_date": 1591588742, "question_id": 52864421, "link": "https://stackoverflow.com/questions/52864421/sum-up-value-with-different-keys", "title": "Sum up value with different keys", "body": "<p><a href=\"https://i.stack.imgur.com/3AOSl.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3AOSl.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Please refer to the attached picture to have a better idea.</p>\n\n<p>I have multiple rows in my worksheet with a group name and a lot of values. Each group shows multiple times in my table. Now I would like to sum values for every group and return them. What is the most efficient way to do this?</p>\n\n<p>Now I have the code to store each row's total value to an array and sum it up like below:</p>\n\n<pre><code>Dim arr() as variant\nDim n as integer\nDim sum as variant\n\nFor n = firstrow to lastrow   'assume firstrow and lastrow are known numbers\n\narr = Range(Cells(n, 3),Cells(n,column.count)).Value \nsum = Workbookfunction.sum(arr)\n\nNext n\n</code></pre>\n\n<p>Any thoughts will be quite helpful!</p>\n"}, {"tags": ["excel", "vba", "field", "rows", "criteria"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1539821217, "last_edit_date": 1539821217, "creation_date": 1539819876, "answer_id": 52865058, "question_id": 52864394, "link": "https://stackoverflow.com/questions/52864394/excel-vba-extract-variable-number-of-rows-per-variable-number-of-phone-numbers/52865058#52865058", "title": "Excel VBA: Extract variable number of rows per variable number of phone numbers", "body": "<p>Here's some sample code showing how you can filter a sheet, grab a specific number of visible rows, then copy those rows to another sheet.</p>\n\n<pre><code>Sub Tester()\n\n    Dim rng As Range, rngDest As Range\n\n    Set rngDest = Sheet2.Range(\"A2\")\n\n    Set rng = GetFirstVisibleRows(ActiveSheet, 1, \"A\", 10)\n\n    If Not rng Is Nothing Then\n        rng.EntireRow.Copy rngDest\n        Set rngDest = rngDest.Offset(rng.Cells.Count, 0)\n    End If\n\nEnd Sub\n\n'filter the data on a sheet by a given value in a given column, then\n'   return a range with the first x visible rows\nFunction GetFirstVisibleRows(sht As Worksheet, filterColumn As Long, _\n                            filterValue, howManyRows As Long) As Range\n\n    Dim c As Range, rngVis As Range, rngCopy As Range\n\n    'filter the sheet and find the remaining visible rows (if any)\n    With sht.UsedRange\n        .AutoFilter\n        .AutoFilter Field:=filterColumn, Criteria1:=filterValue\n        On Error Resume Next '&lt;&lt; ignore error if no visible cells\n        'offset/resize is to ignore the header row...\n        Set rngVis = .Columns(1).Offset(1, 0).Resize(.Columns(1).Rows.Count - 1).SpecialCells(xlCellTypeVisible)\n        On Error GoTo 0 '&lt;&lt; stop ignoring errors\n    End With\n\n    If Not rngVis Is Nothing Then\n        'some visible (not filtered out) rows, so collect the first x of those...\n        For Each c In rngVis.Cells\n            If rngCopy Is Nothing Then\n                Set rngCopy = c\n            Else\n                Set rngCopy = Application.Union(c, rngCopy)\n            End If\n            'exit loop if we have enough rows\n            If rngCopy.Cells.Count &gt;= howManyRows Then Exit For\n        Next c\n    End If\n\n    Set GetFirstVisibleRows = rngCopy\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8104870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iomYH.png?s=128&g=1", "display_name": "Rico", "link": "https://stackoverflow.com/users/8104870/rico"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1539821217, "creation_date": 1539814690, "last_edit_date": 1539814798, "question_id": 52864394, "link": "https://stackoverflow.com/questions/52864394/excel-vba-extract-variable-number-of-rows-per-variable-number-of-phone-numbers", "title": "Excel VBA: Extract variable number of rows per variable number of phone numbers", "body": "<p>We are looking to automate this process using Excel VBA/macros because we process two to ten spreadsheets a week.\nWe want to extract a certain number of rows per a variable set of phone numbers.\nFor example: a spreadsheet with 200,000 rows has 20,000 rows assigned to ten phone numbers. We want to extract the first ten rows per phone number. Our resulting file will have 100 rows ordered by phone number.</p>\n\n<p>Notes:</p>\n\n<ul>\n<li>We need to extract a variable number of records per phone number.</li>\n<li>The number of columns can vary.</li>\n<li>The number of rows can vary.</li>\n<li>We need the entire row of data.</li>\n<li>The phone number column may be in a different place in each spreadsheet.</li>\n<li>The number of phone numbers may vary.</li>\n</ul>\n\n<p>Here's a code that works on one file, but cannot be duplicated to another worksheet because the \"field\", \"criteria\" and \"rows\" change per worksheet.</p>\n\n<p>We thought IndexMatch might work, but it only returns one item, rather than duplicates.</p>\n\n<p>We don't have a VBA solution, so we do this manually.</p>\n\n<p>Any help would be appreciated!</p>\n\n<pre><code>Sub ExtractPh()\n\n' Establish filter\n' Choose first unique phone number\n\n    Cells.Select\n    Selection.AutoFilter\n    ActiveSheet.UsedRange.AutoFilter Field:=25, Criteria1:= _\n        \"800-836-9207\"\n\n' Copy ten non-sequential rows from row 1 to row 82\n\n   Rows(\"1:82\").Select\n\n    Selection.Copy\n\n' Add rows to second sheet\n\n    Sheets.Add After:=Sheets(Sheets.Count)\n    Rows(\"1:1\").Select\n    ActiveSheet.Paste\n\n' Move second to sheet to first position to save as separate file\n\n    Sheets(\"Sheet1\").Select\n    Application.CutCopyMode = False\n    Sheets(\"Sheet1\").Move Before:=Sheets(1)\n\n' Return to main data sheet\n\n    Sheets(\"Test LKY job\").Select\n\n' Choose second unique phone number in column\n\n    ActiveSheet.UsedRange.AutoFilter Field:=25, Criteria1:= _\n        \"800-907-3803\"\n\n\n' Choose second set of ten non-sequential rows and paste to first sheet\n\n    Rows(\"6:26\").Select\n    Selection.Copy\n    Sheets(\"Sheet1\").Select\n    Rows(\"12:12\").Select\n    ActiveSheet.Paste\n\n' Return to main data sheet\n\n    Sheets(\"Test LKY job\").Select\n\n' Choose third unique phone number in column\n\n    ActiveSheet.UsedRange.AutoFilter Field:=25, Criteria1:= _\n        \"800-538-1668\"\n\n' Choose third set of non-sequential rows and paste to first sheet\n\n    Rows(\"4:48\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"Sheet1\").Select\n    Rows(\"22:22\").Select\n    ActiveSheet.Paste\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 1066, "user_id": 6566741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d4e290cef80d739bcf148e397d637af?s=128&d=identicon&r=PG", "display_name": "Rene", "link": "https://stackoverflow.com/users/6566741/rene"}, "edited": false, "score": 0, "creation_date": 1539816275, "post_id": 52864374, "comment_id": 92643453, "body": "Can&#39;t you do a count first in a query and base your form on the query?"}, {"owner": {"reputation": 124, "user_id": 9878025, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-vSULZmHPsg8/AAAAAAAAAAI/AAAAAAAAAI4/dneFGYu5R7s/photo.jpg?sz=128", "display_name": "Robert Patrician", "link": "https://stackoverflow.com/users/9878025/robert-patrician"}, "reply_to_user": {"reputation": 1066, "user_id": 6566741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d4e290cef80d739bcf148e397d637af?s=128&d=identicon&r=PG", "display_name": "Rene", "link": "https://stackoverflow.com/users/6566741/rene"}, "edited": false, "score": 0, "creation_date": 1539816793, "post_id": 52864374, "comment_id": 92643594, "body": "I&#39;ve tried that. It still requeried on every line, and then froze for five mintues followed by a crash. Reproducible. The Sharepoint is powered by a hamster wheel."}, {"owner": {"reputation": 3725, "user_id": 6777839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YYN3g.jpg?s=128&g=1", "display_name": "Wolfgang Kais", "link": "https://stackoverflow.com/users/6777839/wolfgang-kais"}, "edited": false, "score": 0, "creation_date": 1539823364, "post_id": 52864374, "comment_id": 92644955, "body": "Have you tried to select <i>snapshot</i> as RecordsetType for your query?"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1539878881, "post_id": 52864374, "comment_id": 92669896, "body": "What trigger event is this query placed? Consider the <code>OnCurrent</code> event. So wherever the cursor lands, query runs."}, {"owner": {"reputation": 124, "user_id": 9878025, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-vSULZmHPsg8/AAAAAAAAAAI/AAAAAAAAAI4/dneFGYu5R7s/photo.jpg?sz=128", "display_name": "Robert Patrician", "link": "https://stackoverflow.com/users/9878025/robert-patrician"}, "edited": false, "score": 0, "creation_date": 1539888341, "post_id": 52864374, "comment_id": 92674735, "body": "Currently the query is just part of the datasource. I need to export reports of this data so I need the query to pull ALL the data.  Here&#39;s what happens: Let&#39;s say I have room for 10 records on my screen for the query view. It will only query the files for the first ten records, then stop. When I scroll down, it queries the newly revealed records. When I scroll up, it queries the records again. I tested this by including a beep in the function that queries the number of files."}, {"owner": {"reputation": 124, "user_id": 9878025, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-vSULZmHPsg8/AAAAAAAAAAI/AAAAAAAAAI4/dneFGYu5R7s/photo.jpg?sz=128", "display_name": "Robert Patrician", "link": "https://stackoverflow.com/users/9878025/robert-patrician"}, "edited": false, "score": 0, "creation_date": 1539888908, "post_id": 52864374, "comment_id": 92674990, "body": "To further clarify, it&#39;s even exhibiting this behavior when I put the query as part of a datasource for a report. It will only check the folders of what is visible on screen, and then drag the system to a halt trying to run them for newly revealed records when scrolling down. I am going to try a function to export it to excel as a way to get it to all run at once, but it&#39;s... slow."}], "owner": {"reputation": 124, "user_id": 9878025, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-vSULZmHPsg8/AAAAAAAAAAI/AAAAAAAAAI4/dneFGYu5R7s/photo.jpg?sz=128", "display_name": "Robert Patrician", "link": "https://stackoverflow.com/users/9878025/robert-patrician"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1539878625, "creation_date": 1539814552, "last_edit_date": 1539878625, "question_id": 52864374, "link": "https://stackoverflow.com/questions/52864374/ms-access-form-is-requerying-every-time-i-scroll", "title": "MS Access form is requerying every time I scroll", "body": "<p>I have an MS Access continuous form, one of the fields checks the count of files in a folder relevant to the record. These files are stored on a 12.5 Kbps (the speed of a floppy disk) Sharepoint server, so it takes about 7 seconds per record to query the number of files. And that's fine, except that any time I scroll up or down, it requeries the file count of the records that are newly visible on screen. This means I can't scroll past more than one record every 7 seconds.</p>\n\n<p>What I'd like for the form to do is query ALL the records it would show in the continuous form, and then stop requerying them unless specifically told to.</p>\n\n<p>The line for the data source is</p>\n\n<pre><code>WorksheetFileCount: FlrFileCount(\"\\\\vaww.visn21.portal.va.gov\\sanfrancisco\\education\\EDADMIN\\ProgramFiles\\\" &amp; [ProgramID] &amp; \"\\worksheet\\\") .\n</code></pre>\n\n<p>What I have tried so far.</p>\n\n<ol>\n<li>Build a separate query for the data and direct the form to that query. Same result.</li>\n<li>Build a report from the form. Same result.</li>\n</ol>\n\n<p>EDIT: One particularly weird thing is that it doesn't actually query those folders until that area of the query is visible on screen. So if I put the folder query in the 10th column, and my display only shows 9 columns, it doesn't query the folders until I scroll to the right, at which point it queries all of them. So something in Access is querying JUST the records visible on-screen.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1539813158, "post_id": 52864066, "comment_id": 92642581, "body": "You may need to use a text editor and a regex to insert a <code>Text qualifier</code> (<code>&quot;</code> or <code>&#39;</code>) around words that go together. Another option, if there are no commas in your data, is to convert the text into a csv."}], "answers": [{"comments": [{"owner": {"reputation": 812, "user_id": 5457466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/438a24229b00e5d4327425c37518aca7?s=128&d=identicon&r=PG&f=1", "display_name": "Egalth", "link": "https://stackoverflow.com/users/5457466/egalth"}, "reply_to_user": {"reputation": 1945, "user_id": 2148939, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/65a4495f8cf59bfe786fe5b75598ff13?s=128&d=identicon&r=PG", "display_name": "Selrac", "link": "https://stackoverflow.com/users/2148939/selrac"}, "edited": false, "score": 1, "creation_date": 1539848818, "post_id": 52864752, "comment_id": 92652083, "body": "You&#39;re welcome. I thought I cracked it in only a few minutes until I realized the extra complexity arising from the problem of not knowing whether one single whitespace is or isn&#39;t noise. Treating single-character whitespace noise as special cases seems to be a productive solution, but I would be curious to see other solutions as well. (As for the Regex approach I&#39;ve noted that it can get really slow for large datasets.)"}, {"owner": {"reputation": 812, "user_id": 5457466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/438a24229b00e5d4327425c37518aca7?s=128&d=identicon&r=PG&f=1", "display_name": "Egalth", "link": "https://stackoverflow.com/users/5457466/egalth"}, "reply_to_user": {"reputation": 1945, "user_id": 2148939, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/65a4495f8cf59bfe786fe5b75598ff13?s=128&d=identicon&r=PG", "display_name": "Selrac", "link": "https://stackoverflow.com/users/2148939/selrac"}, "edited": false, "score": 1, "creation_date": 1539850538, "post_id": 52864752, "comment_id": 92653003, "body": "@Selrac, note my update on how you can streamline the code further by removing redundant statemens."}, {"owner": {"reputation": 1945, "user_id": 2148939, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/65a4495f8cf59bfe786fe5b75598ff13?s=128&d=identicon&r=PG", "display_name": "Selrac", "link": "https://stackoverflow.com/users/2148939/selrac"}, "edited": false, "score": 0, "creation_date": 1539850846, "post_id": 52864752, "comment_id": 92653161, "body": "I&#39;m missing the last column (Freight Cost)"}, {"owner": {"reputation": 1945, "user_id": 2148939, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/65a4495f8cf59bfe786fe5b75598ff13?s=128&d=identicon&r=PG", "display_name": "Selrac", "link": "https://stackoverflow.com/users/2148939/selrac"}, "edited": false, "score": 0, "creation_date": 1539851008, "post_id": 52864752, "comment_id": 92653261, "body": "I&#39;ve corrected the missing column with: Range(&quot;A1&quot;).Offset(LastRowR).Resize(1, UBound(sArray) + 1).Value = sArray"}, {"owner": {"reputation": 812, "user_id": 5457466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/438a24229b00e5d4327425c37518aca7?s=128&d=identicon&r=PG&f=1", "display_name": "Egalth", "link": "https://stackoverflow.com/users/5457466/egalth"}, "reply_to_user": {"reputation": 1945, "user_id": 2148939, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/65a4495f8cf59bfe786fe5b75598ff13?s=128&d=identicon&r=PG", "display_name": "Selrac", "link": "https://stackoverflow.com/users/2148939/selrac"}, "edited": false, "score": 0, "creation_date": 1539852199, "post_id": 52864752, "comment_id": 92653959, "body": "Thanks, sorry I missed it."}], "tags": [], "owner": {"reputation": 812, "user_id": 5457466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/438a24229b00e5d4327425c37518aca7?s=128&d=identicon&r=PG&f=1", "display_name": "Egalth", "link": "https://stackoverflow.com/users/5457466/egalth"}, "is_accepted": true, "score": 2, "last_activity_date": 1539877371, "last_edit_date": 1539877371, "creation_date": 1539817276, "answer_id": 52864752, "question_id": 52864066, "link": "https://stackoverflow.com/questions/52864066/excel-or-vba-to-convert-unstructured-text-to-column/52864752#52864752", "title": "Excel or VBA to convert unstructured text to column", "body": "<p>Here is an attempt using a custom <code>ReplaceWhitespace</code> function, which replaces sections of whitespace in turn depending on their length. As an intermediate step whitespace is replaced with semicolons; unnecessary semicolons are removed as a last step. <code>Split</code> <a href=\"https://trumpexcel.com/vba-split-function/\" rel=\"nofollow noreferrer\">is used to read</a> the parsed string to an array, and the <a href=\"https://trumpexcel.com/vba-split-function/\" rel=\"nofollow noreferrer\">array is used</a> to read the result to the worksheet. It should be straightforward to tweak <code>ReplaceWhitespace</code> for your specific needs. </p>\n\n<p>Note that this algorithm does not evaluate whether instances of a single whitespace character should be treated as noise (as in \"TUBELINES UNASSIGNED\") or ar as valid word delimter (as in \"Unit Cost\"). Therefore, single whitespace as noise is treated as special cases in <code>ReplaceWhitespace</code>: <code>\"- -\" ~~&gt; \"-;-\"</code> and <code>\" UNASSIGNED \" ~~&gt; \";UNASSIGNED;\"</code></p>\n\n<p>Assuming your data from the screenshot is located in range <code>A1:A4</code>, this code produces more or less the desired output, as shown in the screenshot below.</p>\n\n<p><strong>EDIT:</strong> The initial design of <code>ReplaceWhitespace</code> was based on trial and error. With a little afterthought I realized that patterns where the number of whitespace characters or semicolons is a <a href=\"https://en.wikipedia.org/wiki/Composite_number\" rel=\"nofollow noreferrer\">composite number</a> will be taken care of by those lines in the algorithm that looks for patterns where the number of characters is a prime number. I have updated the code accordingly.</p>\n\n<pre><code>Sub ParseUnstructured()\n    Dim i As Long\n    For Each cell In Range(\"A1:A4\")\n        i = i + 1\n        ' Clean whitespace:\n        sRow = ReplaceWhitespace(cell.Value)\n        ' Read to array\n        Dim sArray() As String\n        sArray() = Split(sRow, \";\")\n        ' Read to worksheet:\n        Range(\"A1\").Offset(5 + i).Resize(1, UBound(sArray)+1).Value = sArray\n    Next cell\nEnd Sub\n\nFunction ReplaceWhitespace(sInput As String) As String\n    Dim sOutput As String\n    ' Look for special cases with single-whitespace noise:\n    sOutput = Replace(sInput, \"- -\", \"-;-\") ' Take care of \"----- ----\"\n    sOutput = Replace(sOutput, \"UNASSIGNED\", \";UNASSIGNED;\")\n    ' Look for patterns where the number of \"noise\" characters is a prime number:\n    sOutput = Replace(sOutput, \"       \", \";\") ' 7 whitespaces\n    sOutput = Replace(sOutput, \"     \", \";\") ' 5\n    sOutput = Replace(sOutput, \"   \", \";\") ' 3\n    sOutput = Replace(sOutput, \"  \", \";\") ' 2\n    ' sOutput = Replace(sOutput, \" \", \"_\") ' 1 Optional\n    sOutput = Replace(sOutput, \";;;;;\", \";\") ' 5 semicolons\n    sOutput = Replace(sOutput, \";;;\", \";\") ' 3\n    sOutput = Replace(sOutput, \";;\", \";\") ' 2\n    sOutput = Replace(sOutput, \"; \", \";\") ' Takes care of some leftovers.\n    ReplaceWhitespace = sOutput\nEnd Function\n</code></pre>\n\n<p>Result from running <code>ParseUnstructured()</code>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/639eY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/639eY.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 1945, "user_id": 2148939, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/65a4495f8cf59bfe786fe5b75598ff13?s=128&d=identicon&r=PG", "display_name": "Selrac", "link": "https://stackoverflow.com/users/2148939/selrac"}, "edited": false, "score": 0, "creation_date": 1539846006, "post_id": 52865484, "comment_id": 92650645, "body": "Thanks @Ron Rosenfeld, that seems to work. I find the Regex a bit confusing and it seems like I need to update the Category field every time a new word appears. Would it be possible to change the Regex code to work on fixed spaces like in what is defined in the 2nd line with the &#39;-&#39;?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 1945, "user_id": 2148939, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/65a4495f8cf59bfe786fe5b75598ff13?s=128&d=identicon&r=PG", "display_name": "Selrac", "link": "https://stackoverflow.com/users/2148939/selrac"}, "edited": false, "score": 1, "creation_date": 1539857510, "post_id": 52865484, "comment_id": 92656964, "body": "@Selrac Probably could.  Or maybe it would be simpler to use <code>UOM</code> as a marker, if <code>Category</code> was only one word. But since @egalth&#39;s approach is working for you, I would just stick with that."}], "tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 1, "last_activity_date": 1539824095, "creation_date": 1539824095, "answer_id": 52865484, "question_id": 52864066, "link": "https://stackoverflow.com/questions/52864066/excel-or-vba-to-convert-unstructured-text-to-column/52865484#52865484", "title": "Excel or VBA to convert unstructured text to column", "body": "<p>The data you present does have a regular pattern, assuming that the Category can only be one of a few defined words.</p>\n\n<p>One could also assume that UOM has only a few defined words, if Category will only ever be a single word.  For example</p>\n\n<ul>\n<li>Item: First substring followed by a space</li>\n<li>Description: Variable number of words followed by Category</li>\n<li>Category: From list of defined words</li>\n<li>UOM: From list of defined words</li>\n<li>And then the remainder are all space separated.</li>\n</ul>\n\n<p>From that pattern, we can construct a Regular Expression, and use that in a VBA macro to split the line.\nOf course, if the pattern varies from that, the method won't work.  But you'll have to provide examples which encompass all of the variability.</p>\n\n<p>The macro below assumes that Category will be either <code>ASSIGNED</code> or <code>UNASSIGNED</code>, but you can add more words to the pipe-separated list in the code.</p>\n\n<p>Other assumptions are in the code.</p>\n\n<pre><code>Option Explicit\nSub parseLine()\n    Dim WS As Worksheet, R As Range, C As Range\n    Dim RE As Object, MC As Object\n    Dim vRes As Variant, I As Long\n\n'Set original worksheet/range\n'change to suit\n'Below uses column A\nSet WS = Worksheets(\"sheet1\")\nWith WS\n    Set R = .Range(.Cells(1, 1), .Cells(.Rows.Count, 1).End(xlUp))\nEnd With\n\n'Initialize regex engine\nSet RE = CreateObject(\"vbscript.regexp\")\nWith RE\n    .Pattern = \"^(\\S+)\\s+(.*)\\s*\\b(UNASSIGNED|ASSIGNED)\\b\\s+(\\S+)\\s+(\\S+)\\s+(\\S+)\\s+(\\S+)\\s+(\\S+)\\s+(\\S+)\"\n    .IgnoreCase = False\n    .MultiLine = True\n    .Global = True\nEnd With\n\n'Iterate through; create the Parse line and parse\nApplication.ScreenUpdating = False\nFor Each C In R\n    If RE.Test(C.Text) = True Then\n        Set MC = RE.Execute(C.Text)\n        ReDim vRes(1 To MC(0).SubMatches.Count)\n        For I = 1 To UBound(vRes)\n            vRes(I) = MC(0).SubMatches(I - 1)\n        Next I\n\n        'write the results next to the column)\n        With C.Offset(0, 1).Resize(columnsize:=UBound(vRes))\n            .Clear\n            .NumberFormat = \"@\"\n            .Value = vRes\n            .EntireColumn.AutoFit\n        End With\n    End If\nNext C\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1945, "user_id": 2148939, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/65a4495f8cf59bfe786fe5b75598ff13?s=128&d=identicon&r=PG", "display_name": "Selrac", "link": "https://stackoverflow.com/users/2148939/selrac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 372, "favorite_count": 0, "accepted_answer_id": 52864752, "answer_count": 2, "score": 3, "last_activity_date": 1592774945, "creation_date": 1539812667, "last_edit_date": 1592774945, "question_id": 52864066, "link": "https://stackoverflow.com/questions/52864066/excel-or-vba-to-convert-unstructured-text-to-column", "title": "Excel or VBA to convert unstructured text to column", "body": "<p>How can I convert text to column when the text is unstructured with no proper delimiters. </p>\n\n<p>For example, how can i turn the following lines:</p>\n\n<p><a href=\"https://i.stack.imgur.com/9pZVb.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9pZVb.jpg\" alt=\"Excel View\"></a></p>\n\n<p>Into something like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/XG2Vj.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XG2Vj.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>In Excel the Text to columns don't seem to find the right separator (space, tab,...). I tried in VBA with the following:</p>\n\n<pre><code>I1 = Mid(Cells(i, 1), 1, 16)\nI2 = Mid(Cells(i, 1), 17, 33)\nI3 = Mid(Cells(i, 1), 34, 49)\nI4 = Mid(Cells(i, 1), 50, 53)\nI5 = Mid(Cells(i, 1), 54, 66)\nI6 = Mid(Cells(i, 1), 67, 82)\nI7 = Mid(Cells(i, 1), 83, 99)\nI8 = Mid(Cells(i, 1), 100, 116)\nI9 = Mid(Cells(i, 1), 117, 133)\n</code></pre>\n\n<p>But I get it doesn't work for all columns. For example, for I3 I get many more values that expected like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/UrCpu.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UrCpu.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I tried also replacing the tab (in case it existed) like:</p>\n\n<pre><code>MyString = Replace(MyString, vbTab, \"\")\n</code></pre>\n\n<p>But didn't work either.</p>\n\n<p>Is there another way to approach it?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10520662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b11f9ceeda645dbc608478a588f99705?s=128&d=identicon&r=PG&f=1", "display_name": "K.Francis", "link": "https://stackoverflow.com/users/10520662/k-francis"}, "edited": false, "score": 0, "creation_date": 1539868734, "post_id": 52864375, "comment_id": 92663343, "body": "Thank you, this is exactly what I was looking for."}], "tags": [], "owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "is_accepted": true, "score": 1, "last_activity_date": 1539814555, "creation_date": 1539814555, "answer_id": 52864375, "question_id": 52863958, "link": "https://stackoverflow.com/questions/52863958/how-to-number-in-sequence-only-visible-rows-in-excel-using-vba/52864375#52864375", "title": "How To Number In Sequence Only Visible Rows In Excel Using VBA?", "body": "<p>This is untested, so try it out on a copy of your data, I also assumed you want to put the numbering in column <code>A</code>:</p>\n\n<pre><code>Private Sub Refresh_Click()\n\nDim totalRows As Long\nDim rowCounter As Long\nDim i as long\n\nrowCounter = 1\ntotalRows = ActiveSheet.UsedRange.Rows.Count + ActiveSheet.UsedRange.Row - 1    \n\nfor i = 10 to totalRows\n    If ActiveSheet.Rows(i).Hidden = False then \n        Range(\"A\" &amp; i).Value = rowCounter \n        rowCounter = rowCounter + 1\n    End if  \nNext i\n\nEnd Sub\n</code></pre>\n\n<p>This will basically loop through all the rows, check to see if they're visible and if yes, insert the row counter</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1539816620, "creation_date": 1539816620, "answer_id": 52864661, "question_id": 52863958, "link": "https://stackoverflow.com/questions/52863958/how-to-number-in-sequence-only-visible-rows-in-excel-using-vba/52864661#52864661", "title": "How To Number In Sequence Only Visible Rows In Excel Using VBA?", "body": "<p>Work through the cells in the SpecialCells(xlCellTypeVisible).</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Refresh_Click()\n\n    Dim a As Long, n As Long, r As Range\n\n    If CBool(Application.Subtotal(103, Range(Cells(10, \"B\"), Cells(Rows.Count, \"B\")))) Then\n        Range(Cells(10, \"B\"), Cells(Rows.Count, \"B\").End(xlUp)).Offset(0, -1).ClearContents\n        For Each r In Range(Cells(10, \"B\"), Cells(Rows.Count, \"B\").End(xlUp)).SpecialCells(xlCellTypeVisible)\n            n = n + 1\n            r.Offset(0, -1) = n\n        Next r\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 10520662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b11f9ceeda645dbc608478a588f99705?s=128&d=identicon&r=PG&f=1", "display_name": "K.Francis", "link": "https://stackoverflow.com/users/10520662/k-francis"}, "edited": false, "score": 0, "creation_date": 1539869055, "post_id": 52865375, "comment_id": 92663569, "body": "I will log that away for use later. In this instance a VBA solution is preferable for the end user of the tool."}], "tags": [], "owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "is_accepted": false, "score": 0, "last_activity_date": 1539823009, "creation_date": 1539823009, "answer_id": 52865375, "question_id": 52863958, "link": "https://stackoverflow.com/questions/52863958/how-to-number-in-sequence-only-visible-rows-in-excel-using-vba/52865375#52865375", "title": "How To Number In Sequence Only Visible Rows In Excel Using VBA?", "body": "<p>You don't need the VBA to number only the visible rows.   The <code>WorkSheetFunction</code> SUBTOTAL will give you the same result.</p>\n\n<blockquote>\n<pre><code>=SUBTOTAL(3,B$10:B10)\n</code></pre>\n</blockquote>\n\n<p><a href=\"https://i.stack.imgur.com/lRQ2A.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lRQ2A.gif\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 13, "user_id": 10520662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b11f9ceeda645dbc608478a588f99705?s=128&d=identicon&r=PG&f=1", "display_name": "K.Francis", "link": "https://stackoverflow.com/users/10520662/k-francis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 664, "favorite_count": 0, "accepted_answer_id": 52864375, "answer_count": 3, "score": 1, "last_activity_date": 1539823009, "creation_date": 1539812088, "question_id": 52863958, "link": "https://stackoverflow.com/questions/52863958/how-to-number-in-sequence-only-visible-rows-in-excel-using-vba", "title": "How To Number In Sequence Only Visible Rows In Excel Using VBA?", "body": "<p>The goal is to have my code number only the visible rows in sequence so that if a filter is applied or lines are deleted the end user can click the \"Refresh\" button, shown in the image below, updating the sequence and the summary at the top of the page. </p>\n\n<p>The code I am using at the moment applies to all the cells in the range including those that are hidden and I have no idea how to change it so that it only applies to the visible cells.</p>\n\n<p><a href=\"https://i.stack.imgur.com/rwDGS.jpg\" rel=\"nofollow noreferrer\">This is the Report</a></p>\n\n<p>And this is the code attached to my \"Refresh\" button;</p>\n\n<pre><code>Private Sub Refresh_Click()\n\nApplication.Goto Reference:=\"R10C2\"\nSelection.End(xlDown).Select\n\nDim maxRowIndex As Long\nDim rowCounter As Long\n\nmaxRowIndex = ActiveCell.Row - 9\nrowCounter = 1\n\nRange(\"A10\").Select\n\nFor rowCounter = 1 To maxRowIndex\nActiveCell = rowCounter\nActiveCell.Offset(1).Select\nNext\n\nEnd Sub\n</code></pre>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["excel", "vba", "pivot", "pivot-table"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 4, "creation_date": 1539810002, "post_id": 52863387, "comment_id": 92641409, "body": "If you&#39;re using CF then you should use <code>DisplayFormat.Interior.ColorIndex</code>"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1539810178, "post_id": 52863387, "comment_id": 92641501, "body": "<code>.Color</code>, not <code>.ColorIndex</code>. The two are not the same thing."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1539810293, "post_id": 52863387, "comment_id": 92641553, "body": "What @BigBen said - using <code>Range().Font.Color = Range().Interior.Color</code> worked just fine for me."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1539810597, "post_id": 52863387, "comment_id": 92641665, "body": "@BigBen = +1 for reading the posted code!"}, {"owner": {"reputation": 187, "user_id": 9883115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57da220163c962f1915d32cda36e6bf5?s=128&d=identicon&r=PG&f=1", "display_name": "Art", "link": "https://stackoverflow.com/users/9883115/art"}, "reply_to_user": {"reputation": 1156, "user_id": 10315836, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hZjRU.png?s=128&g=1", "display_name": "Valon Miller", "link": "https://stackoverflow.com/users/10315836/valon-miller"}, "edited": false, "score": 0, "creation_date": 1539810760, "post_id": 52863387, "comment_id": 92641737, "body": "@ValonMiller Yes, I&#39;m using conditional formatting for those cells."}, {"owner": {"reputation": 187, "user_id": 9883115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57da220163c962f1915d32cda36e6bf5?s=128&d=identicon&r=PG&f=1", "display_name": "Art", "link": "https://stackoverflow.com/users/9883115/art"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1539810802, "post_id": 52863387, "comment_id": 92641756, "body": "@TimWilliams Could you tell where should I use DisplayFormat.Interior.ColorIndex?"}, {"owner": {"reputation": 187, "user_id": 9883115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57da220163c962f1915d32cda36e6bf5?s=128&d=identicon&r=PG&f=1", "display_name": "Art", "link": "https://stackoverflow.com/users/9883115/art"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1539810873, "post_id": 52863387, "comment_id": 92641788, "body": "@dwirony Could you post the code that worked for you? When I use .Color instead of .ColorIndex nothing happens.."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1539811841, "post_id": 52863387, "comment_id": 92642108, "body": "<code>.Font.Color = .DisplayFormat.Interior.Color</code>"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1539812149, "post_id": 52863387, "comment_id": 92642202, "body": "@Art sorry I didn&#39;t see you were using cf. So you do need .displayformat in there."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1539812394, "post_id": 52863387, "comment_id": 92642286, "body": "<code>.PivotFields(&quot;Name&quot;).DataRange.NumberFormat = &quot;;;;&quot;&quot;&quot;&quot;&quot;</code>"}, {"owner": {"reputation": 187, "user_id": 9883115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57da220163c962f1915d32cda36e6bf5?s=128&d=identicon&r=PG&f=1", "display_name": "Art", "link": "https://stackoverflow.com/users/9883115/art"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1539868671, "post_id": 52863387, "comment_id": 92663297, "body": "@TimWilliams sorry but the code still doesn&#39;t work, nothing happens. Have you used the one with &quot;For loop&quot; or &quot;intersect&quot;? Is it possible to share your code?"}, {"owner": {"reputation": 187, "user_id": 9883115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57da220163c962f1915d32cda36e6bf5?s=128&d=identicon&r=PG&f=1", "display_name": "Art", "link": "https://stackoverflow.com/users/9883115/art"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1539868704, "post_id": 52863387, "comment_id": 92663326, "body": "@TimWilliams could you explain what does this line do and where should I plug it? .PivotFields(&quot;Name&quot;).DataRange.NumberFormat = &quot;;;;&quot;&quot;&quot;&quot;&quot;"}, {"owner": {"reputation": 187, "user_id": 9883115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57da220163c962f1915d32cda36e6bf5?s=128&d=identicon&r=PG&f=1", "display_name": "Art", "link": "https://stackoverflow.com/users/9883115/art"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1539868902, "post_id": 52863387, "comment_id": 92663459, "body": "@dwirony no worries, thanks for the suggestion. Did you make the code work by any chance? I still cannot find the right solution..."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1539874364, "post_id": 52863387, "comment_id": 92667073, "body": "that line would replace the loop where you&#39;re adjusting the font color.  It&#39;s a custom number format and there are good explanations to be found via google.  Eg: <a href=\"https://support.office.com/en-us/article/number-format-codes-5026bbd6-04bc-48cd-bf33-80f18b4eae68\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>"}, {"owner": {"reputation": 187, "user_id": 9883115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57da220163c962f1915d32cda36e6bf5?s=128&d=identicon&r=PG&f=1", "display_name": "Art", "link": "https://stackoverflow.com/users/9883115/art"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1539882719, "post_id": 52863387, "comment_id": 92671856, "body": "@TimWilliams thank you, the approach did work!  And if I need to &quot;hide&quot; another column, I should just add the same line for that column or is there a way to add both columns in one line?  When I try to write <code>.PivotFields(&quot;ID&quot;, &quot;Name&quot;).DataRange.NumberFormat = &quot;;;;&quot;&quot;&quot;&quot;&quot;</code> - an error pops up.. Also could you tell what I should change in the ` = &quot;;;;&quot;&quot;&quot;&quot;&quot; ` to &quot;unhide&quot; records names?"}, {"owner": {"reputation": 187, "user_id": 9883115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57da220163c962f1915d32cda36e6bf5?s=128&d=identicon&r=PG&f=1", "display_name": "Art", "link": "https://stackoverflow.com/users/9883115/art"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1539883226, "post_id": 52863387, "comment_id": 92672082, "body": "@TimWilliams I think I found a way to &quot;unhide&quot; records&#39; names using <code>.PivotFields(&quot;Name&quot;).DataRange.NumberFormat = &quot;General&quot;</code>, thank you!"}], "answers": [{"comments": [{"owner": {"reputation": 187, "user_id": 9883115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57da220163c962f1915d32cda36e6bf5?s=128&d=identicon&r=PG&f=1", "display_name": "Art", "link": "https://stackoverflow.com/users/9883115/art"}, "edited": false, "score": 0, "creation_date": 1539887701, "post_id": 52864004, "comment_id": 92674384, "body": "unfortunately, nothing works now, I have no idea why.. I constantly get 1004 error, though I triple checked the columns&#39; names and tried to plug source name and custom name - nothing helps.."}, {"owner": {"reputation": 187, "user_id": 9883115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57da220163c962f1915d32cda36e6bf5?s=128&d=identicon&r=PG&f=1", "display_name": "Art", "link": "https://stackoverflow.com/users/9883115/art"}, "edited": false, "score": 0, "creation_date": 1539888280, "post_id": 52864004, "comment_id": 92674701, "body": "HideText and sub for toggling also doesn&#39;t work, get &quot;Sub or Function not defined&quot; error."}, {"owner": {"reputation": 187, "user_id": 9883115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57da220163c962f1915d32cda36e6bf5?s=128&d=identicon&r=PG&f=1", "display_name": "Art", "link": "https://stackoverflow.com/users/9883115/art"}, "edited": false, "score": 0, "creation_date": 1539889550, "post_id": 52864004, "comment_id": 92675330, "body": "HideText with False shoots &quot;Expected: end of statement&quot; compile error"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 187, "user_id": 9883115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57da220163c962f1915d32cda36e6bf5?s=128&d=identicon&r=PG&f=1", "display_name": "Art", "link": "https://stackoverflow.com/users/9883115/art"}, "edited": false, "score": 0, "creation_date": 1539892481, "post_id": 52864004, "comment_id": 92676692, "body": "I was missing commas before the <code>False</code> in the unhide lines, but otherwise tests out fine for me."}, {"owner": {"reputation": 187, "user_id": 9883115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57da220163c962f1915d32cda36e6bf5?s=128&d=identicon&r=PG&f=1", "display_name": "Art", "link": "https://stackoverflow.com/users/9883115/art"}, "edited": false, "score": 0, "creation_date": 1539894341, "post_id": 52864004, "comment_id": 92677563, "body": "I&#39;m completely stuck here..  Could you explain a bit more how I can use &quot;HideText&quot; option without Sub/End Sub? It always opens a window where I should select a macro but I don&#39;t have any...  Also do you have any ideas why I constantly get 1004 error if I try to run your previous option <code>.PivotFields(&quot;Name&quot;).DataRange.NumberFormat = &quot;;;;&quot;&quot;&quot;&quot;&quot;</code> ?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 187, "user_id": 9883115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57da220163c962f1915d32cda36e6bf5?s=128&d=identicon&r=PG&f=1", "display_name": "Art", "link": "https://stackoverflow.com/users/9883115/art"}, "edited": false, "score": 0, "creation_date": 1539894557, "post_id": 52864004, "comment_id": 92677664, "body": "Those samples of code are for you to insert where you need them - it&#39;s not my aim to write the whole thing out, just to give you some ideas. The code needs to be in a method (Sub/Function) so you will need to add those parts."}, {"owner": {"reputation": 187, "user_id": 9883115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57da220163c962f1915d32cda36e6bf5?s=128&d=identicon&r=PG&f=1", "display_name": "Art", "link": "https://stackoverflow.com/users/9883115/art"}, "edited": false, "score": 0, "creation_date": 1539926742, "post_id": 52864004, "comment_id": 92685514, "body": "I&#39;m not that proficient in VBA as you are, I just started to getting into it and if I knew or had a slightest idea how to combine or insert those samples I wouldn&#39;t ask (I usually try to solve a problem on my own). I thought this community help to solve problems not to make them more complicated. Although I assume you have a final code and know how to solve this problem, I have to make another post to ask the community how I can write a full code using those samples as I cannot create the solution myself. Anyways, thanks for your help, I will continue trying to find a solution to my problem."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 187, "user_id": 9883115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57da220163c962f1915d32cda36e6bf5?s=128&d=identicon&r=PG&f=1", "display_name": "Art", "link": "https://stackoverflow.com/users/9883115/art"}, "edited": false, "score": 0, "creation_date": 1539927015, "post_id": 52864004, "comment_id": 92685585, "body": "The code you posted had two full subs (one with correctly nested <code>With</code> blocks!), so I (reasonably I thought) assumed you knew how to write code to some degree.  All you need to do is put (eg) <code>Sub HideInfo()</code> and <code>End Sub</code> around each block of code and you&#39;re done."}, {"owner": {"reputation": 187, "user_id": 9883115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57da220163c962f1915d32cda36e6bf5?s=128&d=identicon&r=PG&f=1", "display_name": "Art", "link": "https://stackoverflow.com/users/9883115/art"}, "edited": false, "score": 0, "creation_date": 1539955550, "post_id": 52864004, "comment_id": 92699215, "body": "Thank you, I understand, everyone has it&#39;s own approach. I&#39;ve tried doing that multiple times before but constantly get an error 1004: &quot;unable to get the pivotfields property of the worksheet class&quot;.  I&#39;ve checked names for my columns (Source and Custom names) but it seems that the code still cannot find them and I&#39;m not sure why.."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1539927549, "last_edit_date": 1539927549, "creation_date": 1539812303, "answer_id": 52864004, "question_id": 52863387, "link": "https://stackoverflow.com/questions/52863387/vba-change-font-color-based-on-backgroud-color-in-pivot-table/52864004#52864004", "title": "VBA Change font color based on backgroud color in pivot table", "body": "<p>Note there is an alternative approach to hiding the text - by setting a custom number format</p>\n\n<p><a href=\"https://support.office.com/en-us/article/number-format-codes-5026bbd6-04bc-48cd-bf33-80f18b4eae68\" rel=\"nofollow noreferrer\">https://support.office.com/en-us/article/number-format-codes-5026bbd6-04bc-48cd-bf33-80f18b4eae68</a></p>\n\n<p>Hide text:</p>\n\n<pre><code>Sub HideInfo()\n    With ActiveSheet.PivotTables(\"PivotTable1\")\n\n        HideText .PivotFields(\"Name\").DataRange\n        HideText .PivotFields(\"ID\").DataRange\n\n    End With\nEnd Sub\n</code></pre>\n\n<p>Unhide text:</p>\n\n<pre><code>Sub ShowInfo\n    With ActiveSheet.PivotTables(\"PivotTable1\")\n\n        HideText .PivotFields(\"Name\").DataRange, False   '&lt;&lt;edited\n        HideText .PivotFields(\"ID\").DataRange, False     '&lt;&lt;edited\n\n    End With\nEnd Sub\n</code></pre>\n\n<p>Utility sub for toggling cell format to hide/unhide content:</p>\n\n<pre><code>Sub HideText(rng as Range, Optional bHide As Boolean = True)\n    rng.NumberFormat = IIf(bHide, \";;;\"\"\"\"\", \"General\")\nEnd Sub\n</code></pre>\n\n<p>Note you could use a format as part of a CF rule format, if you only needed to hide certain values. This has the advantage that it is dynamic and so would change with the data... </p>\n\n<p><a href=\"https://i.stack.imgur.com/TpXcf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TpXcf.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 187, "user_id": 9883115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57da220163c962f1915d32cda36e6bf5?s=128&d=identicon&r=PG&f=1", "display_name": "Art", "link": "https://stackoverflow.com/users/9883115/art"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1023, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1539927549, "creation_date": 1539809319, "last_edit_date": 1539810951, "question_id": 52863387, "link": "https://stackoverflow.com/questions/52863387/vba-change-font-color-based-on-backgroud-color-in-pivot-table", "title": "VBA Change font color based on backgroud color in pivot table", "body": "<p>I'm trying to write a VBA code to change a font color of a cell based on a background color of that cell. Generally, to \"hide\" record names in two columns (\"ID\" and \"Name\"). Cells are colored using conditional formatting.</p>\n\n<p><a href=\"https://i.stack.imgur.com/XMZT8.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XMZT8.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I managed to find a way to change a font using only 1 color but don't know how dynamically get background color of a cell and use it as a font color.<br>\nSimple <code>.Font.Color = .Interior.ColorIndex</code> doesn't work...</p>\n\n<pre><code>Sub Color_text_black()  \n   Dim c As Range\n    With ActiveSheet.PivotTables(\"PivotTable2\")\n\n    With Intersect(.PivotFields(\"Name\").DataRange.Cells, .TableRange1)\n        .Font.Bold = False\n        .Font.Color = 1 '.Font.Color = .Interior.ColorIndex doesn't work\n\n    End With\n    End With\nEnd Sub\n</code></pre>\n\n<p>Also maybe there should be another way to get the background color, I tried to use For loop but it always sends me an error.</p>\n\n<pre><code>Sub Color_text()\n    Dim c As Range\n\n    With ActiveSheet.PivotTables(\"PivotTable1\")\n\n        For Each c In .PivotFields(\"Name\").DataRange.Cells\n          .Font.Bold = False\n          .Font.Color = .Interior.ColorIndex\n        Next\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Thank you for any help!</p>\n"}, {"tags": ["regex", "excel", "vba"], "comments": [{"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 1, "creation_date": 1540225634, "post_id": 52863383, "comment_id": 92776854, "body": "<a href=\"https://support.office.com/en-us/article/text-import-wizard-c5b02af6-fda1-4440-899f-f78bafe41857\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>"}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 2, "creation_date": 1540230833, "post_id": 52863383, "comment_id": 92779311, "body": "Your file looks like an ASCII fixed structure file. No delimiters, but fixed width of the columns. So create a simple parser which will read the file line by line and parse the particular line based on the fixed width of column. E.g. the first column has width of 25 characters, next has 30, next 22 etc. So read it and paste it immediately to excel. Then next line and so on."}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1540312452, "post_id": 52863383, "comment_id": 92815520, "body": "@user2521987 what about a record based solution (i.e. fixed width strings)?  <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/get-statement\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/language/reference/&hellip;</a>"}, {"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "edited": false, "score": 0, "creation_date": 1540390375, "post_id": 52863383, "comment_id": 92848696, "body": "If you have authority over writing to the text file, put a placeholder in the blank spaces before importing to excel."}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1540546767, "post_id": 52863383, "comment_id": 92915412, "body": "There seem to be several good answers now, please consider checking which one works best for you. If none work, please let know."}], "answers": [{"comments": [{"owner": {"reputation": 3952, "user_id": 1945782, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zsM5t.png?s=128&g=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/1945782/paul"}, "edited": false, "score": 0, "creation_date": 1540277590, "post_id": 52921727, "comment_id": 92793907, "body": "I thought you could also name your columns later...  But I agree, this is the most straightforward option, even if you have to do a little tidying up afterward."}, {"owner": {"reputation": 164, "user_id": 9806115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67740de6f5b3fe2525112524cbb6571f?s=128&d=identicon&r=PG&f=1", "display_name": "Harinie R", "link": "https://stackoverflow.com/users/9806115/harinie-r"}, "reply_to_user": {"reputation": 3952, "user_id": 1945782, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zsM5t.png?s=128&g=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/1945782/paul"}, "edited": false, "score": 0, "creation_date": 1540310039, "post_id": 52921727, "comment_id": 92814224, "body": "Yes, you are free to add names of column in excel even after import by excel&#39;s usual  &quot;insert new row&quot; method."}, {"owner": {"reputation": 3952, "user_id": 1945782, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zsM5t.png?s=128&g=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/1945782/paul"}, "edited": false, "score": 0, "creation_date": 1540311173, "post_id": 52921727, "comment_id": 92814865, "body": "Yes! It&#39;s okay - I&#39;m having a senior moment! I&#39;m thinking of the import for Ms Access! Ignore that first sentence  ;o)"}], "tags": [], "owner": {"reputation": 164, "user_id": 9806115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67740de6f5b3fe2525112524cbb6571f?s=128&d=identicon&r=PG&f=1", "display_name": "Harinie R", "link": "https://stackoverflow.com/users/9806115/harinie-r"}, "is_accepted": false, "score": 3, "last_activity_date": 1540176324, "last_edit_date": 1540176324, "creation_date": 1540175777, "answer_id": 52921727, "question_id": 52863383, "link": "https://stackoverflow.com/questions/52863383/preserving-columns-when-writing-from-a-text-file-to-excel-using-vba/52921727#52921727", "title": "Preserving &quot;columns&quot; when writing from a text file to excel using VBA", "body": "<p>Have you tried the \"import from text file option\" of excel?\nIf you just want to import the text file to excel with or without headers, then you <a href=\"https://knowledgebase.constantcontact.com/articles/KnowledgeBase/6269-convert-a-text-file-to-an-excel-file?lang=en_US\" rel=\"nofollow noreferrer\">can import directly in excel using the built in option available in excel</a>.This recognises the header and blank spaces properly.One point to be noted is the headers of the text file should always be in first line for this method.\nIf you are not sure of this, then you can go for a vba script.if so, then the link provided by ferdinando will help you.</p>\n"}, {"comments": [{"owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "edited": false, "score": 0, "creation_date": 1540447593, "post_id": 52935615, "comment_id": 92870618, "body": "But what if then width of a column is variable?"}, {"owner": {"reputation": 11591, "user_id": 1097347, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/efffb39e9e98d002a5b9afe2fde7e50d?s=128&d=identicon&r=PG", "display_name": "Uri Goren", "link": "https://stackoverflow.com/users/1097347/uri-goren"}, "reply_to_user": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "edited": false, "score": 0, "creation_date": 1540484568, "post_id": 52935615, "comment_id": 92892929, "body": "This method assumes that column width is approximately constant (as in the use-case the OP demonstrated). If this assumption does not hold, a different solution is needed."}], "tags": [], "owner": {"reputation": 11591, "user_id": 1097347, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/efffb39e9e98d002a5b9afe2fde7e50d?s=128&d=identicon&r=PG", "display_name": "Uri Goren", "link": "https://stackoverflow.com/users/1097347/uri-goren"}, "is_accepted": true, "score": 5, "last_activity_date": 1540233328, "last_edit_date": 1540233328, "creation_date": 1540232950, "answer_id": 52935615, "question_id": 52863383, "link": "https://stackoverflow.com/questions/52863383/preserving-columns-when-writing-from-a-text-file-to-excel-using-vba/52935615#52935615", "title": "Preserving &quot;columns&quot; when writing from a text file to excel using VBA", "body": "<p>Assuming that each column is <code>10</code> characters long, I would use this width instead of a space delimeter</p>\n\n<pre><code>Sub FeedTextFileToActiveSheet(ByVal TextFile As String)\n  Dim i As Integer, Line As String\n  Open TextFile For Input As #1\n  While Not EOF(#1)\n    i = i + 1\n    Input #1, Line\n    Range(\"A\" &amp; i) = Trim(Mid(Line, 1, 10))  'Business ID\n    Range(\"B\" &amp; i) = Trim(Mid(Line, 11, 10)) 'Employee ID\n    ' ... and so on\n  Wend\n  Close #1\nEnd Sub\n</code></pre>\n\n<p>To use it, just call <code>FeedTextFileToActiveSheet(\"Path.txt\")</code></p>\n"}, {"tags": [], "owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "is_accepted": false, "score": 1, "last_activity_date": 1540277214, "creation_date": 1540277214, "answer_id": 52942757, "question_id": 52863383, "link": "https://stackoverflow.com/questions/52863383/preserving-columns-when-writing-from-a-text-file-to-excel-using-vba/52942757#52942757", "title": "Preserving &quot;columns&quot; when writing from a text file to excel using VBA", "body": "<p>If the file looks exactly alike the image when opened in notepad, most probably it is <em>fixed width</em>. Whatever may be the case better go a blank workbook, start Record Macro and simply try to open the text file. Automatically Text import wizard will open. Chose type as Fixed Width (preferably) or delimited, go through each step carefully reading the guiding instruction provided. (When asked for start import at row, it is better to give first line containing significant data, omitting header lines etc).  When the file is fully opened stop the recording.  You will have a recorded macro something like this.</p>\n\n<pre><code>Workbooks.OpenText Filename:=\"C:\\Users\\user\\Desktop\\Text.prn\", Origin:= _\n        xlMSDOS, StartRow:=5, DataType:=xlFixedWidth, FieldInfo:=Array(Array(0, 1) _\n        , Array(14, 1), Array(29, 1), Array(44, 1), Array(59, 1), Array(74, 5), Array(89, 1), Array( _\n        104, 1)), TrailingMinusNumbers:=True\n</code></pre>\n\n<p>Now simply use that portion of code (may be with little modification in filename etc) in your procedure to Open the text file. Then simply copy the current region and paste in a work sheet already made ready with headers etc like.</p>\n\n<pre><code>ActiveWorkbook.ActiveSheet.Range(\"A1\").CurrentRegion.Copy ThisWorkbook.Sheets(1).Range(\"a5\")\n ActiveWorkbook.Close False\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11591, "user_id": 1097347, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/efffb39e9e98d002a5b9afe2fde7e50d?s=128&d=identicon&r=PG", "display_name": "Uri Goren", "link": "https://stackoverflow.com/users/1097347/uri-goren"}, "edited": false, "score": 0, "creation_date": 1540678768, "post_id": 52952200, "comment_id": 92955259, "body": "Great answer! this answer should definitely be marked as accepted since it works columnar structure. voted up !"}], "tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": false, "score": 2, "last_activity_date": 1540387731, "last_edit_date": 1540387731, "creation_date": 1540306834, "answer_id": 52952200, "question_id": 52863383, "link": "https://stackoverflow.com/questions/52863383/preserving-columns-when-writing-from-a-text-file-to-excel-using-vba/52952200#52952200", "title": "Preserving &quot;columns&quot; when writing from a text file to excel using VBA", "body": "<p>If you have this file organized visually, I would go by that logic. It means that value of a column starts where\nthe column header starts. This implies that value of a column ends where the next one begins.</p>\n\n<p>Helpful image, describing the logic (also, example text file I used):</p>\n\n<p><a href=\"https://i.stack.imgur.com/UDZ87.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UDZ87.png\" alt=\"enter image description here\"></a></p>\n\n<p>All this logic can be done by reading first line, which contains headers, and determining all indexes of\nbeginning of every header. Then, for each line we can easily determine value between two particular indexes, cut\nit out and trim to remove extra spaces at the beginning and at the end of a value.</p>\n\n<p>Try below code (all necessary comments in code):</p>\n\n<pre><code>Sub ReadDataFromCsv()\n    Dim Fn As String, WS As Worksheet, st As String, i As Long, columnHeadersIndexes As Object, numberOfColumns As Long\n    Fn = \"your path here\" ' the file path and name\n    Set WS = Sheets(\"Sheet1\")\n    ' Create array that will hold indexes of a beginning of a column header\n    Set columnHeadersIndexes = CreateObject(\"System.Collections.ArrayList\")\n    'Read text file to st string\n    With CreateObject(\"Scripting.FileSystemObject\")\n        If Not .FileExists(Fn) Then\n            MsgBox Fn &amp; \"  : is missing.\"\n            Exit Sub\n        ElseIf FileLen(Fn) = 0 Then\n            MsgBox Fn &amp; \"  : is empty\"\n        Else\n            With .OpenTextFile(Fn, 1)\n                ' Read first line\n                st = .ReadLine\n                i = 1\n                ' Find beginning of first column name\n                Do While Mid(st, i, 1) = \" \"\n                    i = i + 1\n                Loop\n                columnHeadersIndexes.Add (i)\n                ' At least two spaces separate two headers, so we can safely add 2 without risk of loosing any letters frmo next header\n                i = i + 2\n                Dim j As Long: j = 1\n                Do While i &lt; Len(st)\n                    ' If we have two spaces followed by non-space, then save index (beginning of a header)\n                    If Mid(st, i - 2, 2) = \"  \" And Mid(st, i, 1) &lt;&gt; \" \" Then\n                        ' Set column header\n                        Cells(1, j) = Mid(st, columnHeadersIndexes(columnHeadersIndexes.Count - 1), i - columnHeadersIndexes(columnHeadersIndexes.Count - 1) - 1)\n                        columnHeadersIndexes.Add (i)\n                        j = j + 1\n                    End If\n                    i = i + 1\n                Loop\n                ' Set column header\n                Cells(1, j) = Trim(Mid(st, columnHeadersIndexes(columnHeadersIndexes.Count - 1), Len(st)))\n                numberOfColumns = columnHeadersIndexes.Count\n                ' Skip line with ------ characters\n                .ReadLine\n                Dim currentRow As Long: currentRow = 2\n                Do While .AtEndOfStream &lt;&gt; True\n                    st = .ReadLine\n                    ' Read all columns from a line\n                    For i = 0 To numberOfColumns - 2\n                        If Len(st) &gt;= columnHeadersIndexes(i) Then\n                            cellValue = Mid(st, columnHeadersIndexes(i), columnHeadersIndexes(i + 1) - columnHeadersIndexes(i) - 1)\n                            cellValue = Trim(cellValue)\n                            Cells(currentRow, i + 1) = cellValue\n                        End If\n                    Next\n                    ' Read last column, if exists\n                    If Len(st) &gt;= columnHeadersIndexes(i) Then\n                        'here we pass Len(st) as length for substring - it assures that we don't pass too small value and miss some characters\n                        cellValue = Mid(st, columnHeadersIndexes(i), Len(st))\n                        cellValue = Trim(cellValue)\n                        Cells(currentRow, i + 1) = cellValue\n                    End If\n                    currentRow = currentRow + 1\n                Loop\n                .Close\n            End With\n        End If\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1540401781, "creation_date": 1540401781, "answer_id": 52974763, "question_id": 52863383, "link": "https://stackoverflow.com/questions/52863383/preserving-columns-when-writing-from-a-text-file-to-excel-using-vba/52974763#52974763", "title": "Preserving &quot;columns&quot; when writing from a text file to excel using VBA", "body": "<p>you could:</p>\n\n<ul>\n<li><p>process the line with all \"-\"s, to get the actual fields width</p></li>\n<li><p>paste all text content into wanted sheet column A rows</p></li>\n<li><p>use <code>TextToColumns()</code> method to spread text from column A into as many columns as needed, determined by proper handling of the \"-\"s line</p></li>\n</ul>\n\n<p>as follows:</p>\n\n<pre><code>Option Explicit\n\nSub Test()\n\n    Dim Fn As String, WS As Worksheet\n    Dim lines As Variant, line As Variant\n\n    Fn = \"Path.txt\" ' the file path and name\n    Set WS = Sheets(\"Sheet1\")\n\n    'Read text file to st string\n    With CreateObject(\"Scripting.FileSystemObject\")\n       If Not .FileExists(Fn) Then\n           MsgBox Fn &amp; \"  : is missing.\"\n           Exit Sub\n       Else\n           If FileLen(Fn) = 0 Then\n               MsgBox Fn &amp; \"  : is empty\"\n               Exit Sub\n           Else\n                With .OpenTextFile(Fn, 1)\n                    lines = Split(.readall, vbLf)\n                    .Close\n                End With\n           End If\n       End If\n    End With\n\n    For Each line In lines ' loop through all text lines\n        If InStr(line, \"-\") &gt; 0 Then Exit For ' loop till you reach the \"-\"s line, which will be used to get FieldInfo array for textToColumns method\n    Next\n\n    With WS\n        .Range(\"a1\").Resize(UBound(lines) + 1).Value = Application.Transpose(lines) ' copy all text lines into column A rows\n        .Columns(1).TextToColumns Destination:=Range(\"A1\"), DataType:=xlFixedWidth, FieldInfo:=GetFieldInfo(Trim(line)), TrailingMinusNumbers:=True ' convert text to columns feeding FieldInfo array arranged from the \"-\"s line structure\n    End With\n\nEnd Sub\n\n\nFunction GetFieldInfo(st As String) As Variant()\n    Dim i As Long, n As Long, nFields As Long\n\n    nFields = UBound(Split(WorksheetFunction.Trim(st), \" \")) ' get the number of fields by counting the \"-\"s groups separated by single space\n\n    ReDim arrtext(0 To nFields) ' size FieldInfo array accordingly\n    Do\n        arrtext(i) = Array(n, 1) ' build current FieldInfo array field with current field position in text\n        n = InStr(n + 1, st, \" -\") ' search next field position\n        i = i + 1\n    Loop While i &lt; nFields\n    arrtext(i) = Array(n, 1) ' build last FieldInfo array field with last field position in text\n\n    GetFieldInfo = arrtext ' return FieldInfo array\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 2521987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ede6dcc174ad0d23bfda675d15b2bc78?s=128&d=identicon&r=PG", "display_name": "user2521987", "link": "https://stackoverflow.com/users/2521987/user2521987"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1562, "favorite_count": 1, "accepted_answer_id": 52935615, "answer_count": 5, "score": 6, "last_activity_date": 1592724967, "creation_date": 1539809305, "last_edit_date": 1592724967, "question_id": 52863383, "link": "https://stackoverflow.com/questions/52863383/preserving-columns-when-writing-from-a-text-file-to-excel-using-vba", "title": "Preserving &quot;columns&quot; when writing from a text file to excel using VBA", "body": "<p>I have a text file that is formatted in the following way:</p>\n\n<p><a href=\"https://i.stack.imgur.com/socyF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/socyF.png\" alt=\"enter image description here\"></a></p>\n\n<p>And I am using the below code in VBA to write the text file into excel:</p>\n\n<pre><code>Sub Test()\n\n Dim Fn As String, WS As Worksheet, st As String\n\n Fn = \"Path.txt\" ' the file path and name\n Set WS = Sheets(\"Sheet1\")\n\n 'Read text file to st string\n With CreateObject(\"Scripting.FileSystemObject\")\n    If Not .FileExists(Fn) Then\n        MsgBox Fn &amp; \"  : is missing.\"\n        Exit Sub\n    Else\n        If FileLen(Fn) = 0 Then\n            MsgBox Fn &amp; \"  : is empty\"\n            Exit Sub\n        Else\n            With .OpenTextFile(Fn, 1)\n             st = .ReadAll\n             .Close\n            End With\n        End If\n    End If\n End With\n\n 'Replace every two or more space in st string with vbTab\n With CreateObject(\"VBScript.RegExp\")\n  .Pattern = \"[ ]{2,}\"\n  .Global = True\n  .Execute st\n  st = .Replace(st, vbTab)\n End With\n\n 'Put st string in Clipboard\n With CreateObject(\"New:{1C3B4210-F441-11CE-B9EA-00AA006B1A69}\")\n    .SetText st\n    .PutInClipboard\n End With\n\n 'Paste Clipboard to range\n WS.Range(\"A1\").PasteSpecial\n\nEnd Sub\n</code></pre>\n\n<p>My goal is to preserve the columns from the text file in Excel.</p>\n\n<p>However, my code can't tell that a blank space under <code>Plan Type</code> and a blank space under <code>Benefit Plan</code> are actually two different columns of data. It treats the blank space under the two columns as one long blank space, and the formatting isn't preserved. </p>\n\n<p>Visually we know there are columns, but my code cannot see this.</p>\n\n<p>Is there a way to program this so it recognizes that there are two spaces in the text file instead of one big space?</p>\n\n<p>What I want to avoid is having to manually deliminate this with a character. Is that possible?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1539809976, "post_id": 52863374, "comment_id": 92641397, "body": "You cannot set the return of the vlookup as it does not return a range but a value.  Remove the <code>Set</code> and simply assign the value: <code>Sheets(&quot;Endur T1&quot;).Range(&quot;O2&quot;).Value = vResult</code>"}], "owner": {"reputation": 11, "user_id": 10520668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05c596d56f9f41c7a2e4e68eb27cc611?s=128&d=identicon&r=PG&f=1", "display_name": "WillieE", "link": "https://stackoverflow.com/users/10520668/williee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1543592311, "creation_date": 1539809237, "last_edit_date": 1543592311, "question_id": 52863374, "link": "https://stackoverflow.com/questions/52863374/vlookup-then-copy", "title": "Vlookup then copy", "body": "<p>I'm trying to find a value in one sheet using a vlookup, assign that value to a variable, then copy it to another sheet.</p>\n\n<p>For the Vlookup, I'm trying to find the values of POM&amp;VENT as to be looked up as Value1Value3 . </p>\n\n<p>I get an error telling me Object required.  </p>\n\n<pre><code>Dim LookRangeT1 As Range\n\nLookupRangeT1 = Sheets(\"T-1\").Range(\"A20:S700\")\n\nDim POM As String\nPOM = \"Value1\"\n\nDim VENT As String\nVENT = \"Value3\"\n\nDim LookRangeT1 As Range\nLookupRangeT1 = Sheets(\"T-1\").Range(\"A20:S700\")\n\nDim LookupCOT As Integer\nLookupCOT = 16\n\nDim LookupCMP As Integer\nLookupCMP = 17\n\nDim LookupRDI As Integer\nLookupRDI = 18\n\nDim LookupCOF As Integer\nLookupCOF = 19\n\nDim vResult As Integer\nExactMatch = False\n\nSet vResult = Application.WorksheetFunction.VLookup((POM) &amp; (VENT), \nLookupRangeT1, LookupCMP, ExactMatch)\nvResult.Copy\nSheets(\"Endur T1\").Activate\nRange(\"O2\").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nApplication.CutCopyMode = False\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "edited": false, "score": 0, "creation_date": 1539809818, "post_id": 52863360, "comment_id": 92641316, "body": "<code>Loc</code> is likely <code>Nothing</code> so you need to guard against this situation.  In other words, you can&#39;t check the <code>Offset</code> unless <code>Loc</code> is valid.  Same thing for <code>Pool</code>."}, {"owner": {"reputation": 39, "user_id": 9603305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd2946a28ea3815dfc18e060ce9e920a?s=128&d=identicon&r=PG&f=1", "display_name": "AJames", "link": "https://stackoverflow.com/users/9603305/ajames"}, "reply_to_user": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "edited": false, "score": 0, "creation_date": 1539810120, "post_id": 52863360, "comment_id": 92641470, "body": "Correct, but all I want is to close the UserForm.  I&#39;m not updating anything."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1539811315, "post_id": 52863360, "comment_id": 92641933, "body": "This is a good example of why you should decouple your business logic from your presentation logic.  I&#39;d give <a href=\"https://stackoverflow.com/a/47291028/4088852\">this answer</a> a read, then remove that entire section of code from the event handler to somewhere more appropriate."}, {"owner": {"reputation": 39, "user_id": 9603305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd2946a28ea3815dfc18e060ce9e920a?s=128&d=identicon&r=PG&f=1", "display_name": "AJames", "link": "https://stackoverflow.com/users/9603305/ajames"}, "edited": false, "score": 0, "creation_date": 1539820030, "post_id": 52863360, "comment_id": 92644327, "body": "Comintern, that is an awesome link that I have now saved.  Thanks so much!"}], "owner": {"reputation": 39, "user_id": 9603305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd2946a28ea3815dfc18e060ce9e920a?s=128&d=identicon&r=PG&f=1", "display_name": "AJames", "link": "https://stackoverflow.com/users/9603305/ajames"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1539809205, "creation_date": 1539809205, "question_id": 52863360, "link": "https://stackoverflow.com/questions/52863360/closing-userform-results-in-object-variable-or-with-block-variable-not-set", "title": "Closing UserForm results in &#39;Object variable or With block variable not set&#39;", "body": "<p>So I have a UserForm that works, except for the close button.  I have the simple close code...</p>\n\n<pre><code>Private Sub vbClose_Click()\nUnload Me\nEnd Sub\n</code></pre>\n\n<p>But when that part runs, another Private Sub kicks off for some reason...</p>\n\n<pre><code>Private Sub ComboBox_AfterUpdate()\nDim myRng As Range, VIT As Workbook, Sheet As Worksheet, LastRow As Long, myCol As String, LastCol As Long\nDim Loc As Range, CLoc As String, ANLoc As String, CurLoc As String\n\nSet VIT = Workbooks(\"Workbook.xlsm\")\nSet Data = Sheets(\"Sheet\")\nLastCol = Data.Range(\"A1\").CurrentRegion.Columns.Count\nmyCol = GetColumnLetter(LastCol)\nLastRow = Data.Range(\"B\" &amp; Rows.Count).End(xlUp).Row\nSet myRng = Range(\"H2:H\" &amp; LastRow)\nSet Loc = myRng.Find(What:=Fund.Value, LookIn:=xlValues)\nIf Loc.Offset(0, -5).Value = Pool.Value Then &lt;--------- line that breaks\n   CLoc = Loc.Offset(0, 60)\n   Cusip.Caption = Format(CLoc, \"000000000\")\n   ANLoc = Loc.Offset(0, 40).Value\n   AcctNum.Caption = Format(ANLoc, \"0000\")\n   CurLoc = Loc.Offset(0, 11)\n   CurrLabel.Caption = CurLoc\n   Else\n   Set Loc = myRng.FindNext(After:=Loc)\n   CLoc = Loc.Offset(0, 60).Value\n   Cusip.Caption = Format(CLoc, \"000000000\")\n   ANLoc = Loc.Offset(0, 40)\n   AcctNum.Caption = Format(ANLoc, \"0000\")\n   CurLoc = Loc.Offset(0, 11)\n   CurrLabel.Caption = CurLoc\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Any help is appreciated as to why.</p>\n"}, {"tags": ["uitableview", "ms-access", "vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1539807911, "post_id": 52862869, "comment_id": 92640461, "body": "Do you have the same internet security settings?"}, {"owner": {"reputation": 135, "user_id": 9936434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b91c648a35f6d8b5c82845d5bddc9ab?s=128&d=identicon&r=PG&f=1", "display_name": "throwaway", "link": "https://stackoverflow.com/users/9936434/throwaway"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1539808910, "post_id": 52862869, "comment_id": 92640942, "body": "Thanks, that made me realize the error. It was something incredibly simple, I just had to add the website I was accessing as a trusted site in Internet Explorer."}], "answers": [{"comments": [{"owner": {"reputation": 145, "user_id": 3042785, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1e697ebc9fb73efdb72a72ef4b9da210?s=128&d=identicon&r=PG&f=1", "display_name": "WizzleWuzzle", "link": "https://stackoverflow.com/users/3042785/wizzlewuzzle"}, "edited": false, "score": 0, "creation_date": 1565798828, "post_id": 52863268, "comment_id": 101466349, "body": "So if it is a trusted site, you have to use InternetExplorerMedium, otherwise InternetExplorer is fine?"}, {"owner": {"reputation": 135, "user_id": 9936434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b91c648a35f6d8b5c82845d5bddc9ab?s=128&d=identicon&r=PG&f=1", "display_name": "throwaway", "link": "https://stackoverflow.com/users/9936434/throwaway"}, "reply_to_user": {"reputation": 145, "user_id": 3042785, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1e697ebc9fb73efdb72a72ef4b9da210?s=128&d=identicon&r=PG&f=1", "display_name": "WizzleWuzzle", "link": "https://stackoverflow.com/users/3042785/wizzlewuzzle"}, "edited": false, "score": 0, "creation_date": 1567699899, "post_id": 52863268, "comment_id": 102050321, "body": "I am not for sure about that, I had trouble with InternetExplorer, it just refused to work without any real reason I could figure out. I literally went into IE and then to Settings, to set up a trusted site."}], "tags": [], "owner": {"reputation": 135, "user_id": 9936434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b91c648a35f6d8b5c82845d5bddc9ab?s=128&d=identicon&r=PG&f=1", "display_name": "throwaway", "link": "https://stackoverflow.com/users/9936434/throwaway"}, "is_accepted": true, "score": 2, "last_activity_date": 1539808885, "creation_date": 1539808885, "answer_id": 52863268, "question_id": 52862869, "link": "https://stackoverflow.com/questions/52862869/what-would-cause-internetexplorermedium-to-work-on-one-machine-but-not-another/52863268#52863268", "title": "What would cause InternetExplorerMedium to work on one machine but not another?", "body": "<p>It was something incredibly simple, I just had to add the website I was accessing as a trusted site in Internet Explorer.</p>\n"}], "owner": {"reputation": 135, "user_id": 9936434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b91c648a35f6d8b5c82845d5bddc9ab?s=128&d=identicon&r=PG&f=1", "display_name": "throwaway", "link": "https://stackoverflow.com/users/9936434/throwaway"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1167, "favorite_count": 0, "accepted_answer_id": 52863268, "answer_count": 1, "score": 0, "last_activity_date": 1594627194, "creation_date": 1539807035, "last_edit_date": 1594627194, "question_id": 52862869, "link": "https://stackoverflow.com/questions/52862869/what-would-cause-internetexplorermedium-to-work-on-one-machine-but-not-another", "title": "What would cause InternetExplorerMedium to work on one machine but not another?", "body": "<p>I have a VBA script in Access that logs onto a website and downloads some data, I built it using a laptop and use the code of </p>\n\n<pre><code>Dim objIE As InternetExplorerMedium 'special object variable representing the IE browser\nDim aEle As HTMLLinkElement 'special object variable for an &lt;a&gt; (link) element\nDim element As HTMLLinkElement\nSet objIE = New InternetExplorerMedium\nOn Error GoTo Errorhandler\nobjIE.Visible = False\nDoCmd.Hourglass (True) 'navigate IE to this web page\nobjIE.navigate www.google.com ' google just for example\n</code></pre>\n\n<p>Then it inputs the login info into the proper boxes and logs in.</p>\n\n<p>Which works fine, however I installed this front end on another user's PC and it no longer works, it just opens the page but fills in no info.</p>\n\n<p>However, if I change,</p>\n\n<pre><code>Set objIE = New InternetExplorerMedium\n</code></pre>\n\n<p>to</p>\n\n<pre><code>Set objIE = CreateObject(\"InternetExplorer.Application\")\n</code></pre>\n\n<p>then it works on their PC. But this change does not work on my laptop. </p>\n\n<p>What would cause this issue and how could I standardize this so I can install on any windows machine without worry of this occurring. </p>\n\n<p>Notes:\nWe are both on the company LAN, and both are running windows 10 Home.</p>\n"}, {"tags": ["excel", "vba", "subtotal"], "comments": [{"owner": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "edited": false, "score": 0, "creation_date": 1539805118, "post_id": 52862346, "comment_id": 92639197, "body": "Just to verify, given <code>Range(&quot;Table2[[#Totals],[Var %]]&quot;).Select</code> you wish to replace Table2 with tablename?  Then it&#39;s just a matter of concatenating this string.  <code>Range(CStr(tablename.Value) &amp; &quot;[[#Totals],[Var %]]&quot;).Select</code>"}, {"owner": {"reputation": 15, "user_id": 10452607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af55dcb192a91b52f7d6aabf38486cc8?s=128&d=identicon&r=PG&f=1", "display_name": "Hoganator", "link": "https://stackoverflow.com/users/10452607/hoganator"}, "reply_to_user": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "edited": false, "score": 0, "creation_date": 1539810254, "post_id": 52862346, "comment_id": 92641538, "body": "I also want to concatenate the ActiveSheet lines too, so that the subtotals can be added for each tab!"}], "answers": [{"tags": [], "owner": {"reputation": 1110, "user_id": 5572384, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y2BvJ.jpg?s=128&g=1", "display_name": "StoneGiant", "link": "https://stackoverflow.com/users/5572384/stonegiant"}, "is_accepted": true, "score": 1, "last_activity_date": 1539809867, "creation_date": 1539809867, "answer_id": 52863509, "question_id": 52862346, "link": "https://stackoverflow.com/questions/52862346/sum-average-rows-to-table-on-multiple-tabs-vba/52863509#52863509", "title": "Sum/Average Rows to Table on Multiple Tabs VBA", "body": "<p>If there is only one table on each sheet, the solution is relatively trivial. However, if there are multiple tables, you will need to identify the table name as well as the tab name on your Tab Names sheet. Here's the solution if each sheet has only one table.</p>\n\n<pre><code>For Each tablename In Worksheets(\"Tab Names\").Range(\"B1:B64\")\n    Set TargetSheet = Worksheets(CStr(tablename.Value))\n    With TargetSheet.ListObjects(1)\n        .ShowTotals = True\n        .ListColumns(\"Var %\").TotalsCalculation = xlTotalsCalculationAverage\n        .ListColumns(\"Var $\").TotalsCalculation = xlTotalsCalculationSum\n    End With\nNext tablename\n</code></pre>\n\n<p>I removed a lot of unnecessary range selecting in your code. Objects don't need to be selected to work with them. In fact, it will slow things down if you do.</p>\n"}], "owner": {"reputation": 15, "user_id": 10452607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af55dcb192a91b52f7d6aabf38486cc8?s=128&d=identicon&r=PG&f=1", "display_name": "Hoganator", "link": "https://stackoverflow.com/users/10452607/hoganator"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 676, "favorite_count": 0, "accepted_answer_id": 52863509, "answer_count": 1, "score": 0, "last_activity_date": 1539810271, "creation_date": 1539804784, "last_edit_date": 1539810271, "question_id": 52862346, "link": "https://stackoverflow.com/questions/52862346/sum-average-rows-to-table-on-multiple-tabs-vba", "title": "Sum/Average Rows to Table on Multiple Tabs VBA", "body": "<p>I would like to add subtotals for either a sum or average. The tables on these tabs all have the same row lengths, and the same headers (there is a group of 8 tabs that have 3 additional columns, so I will create another loop later on the tackle those). </p>\n\n<p>I'm not sure how to make the table references in the below code generic to reference whatever table is on that specific tab. This is what I have so far...any help would be greatly appreciated! Thank you!</p>\n\n<pre><code>Sub AddTotals()\n\nDim tablename As Range\nDim TargetSheet As Worksheet\nDim tbl As ListObject\nDim rng As Range\n\nWorksheets(\"Tab Names\").Activate\n\nFor Each tablename In Worksheets(\"Tab Names\").Range(\"B1:B64\").Cells\n    Set TargetSheet = Worksheets(CStr(tablename.Value))\n    Set rng = Range(TargetSheet.Range(\"F11\"), TargetSheet.Range(\"F11\").SpecialCells(xlLastCell))\n\n    Range(\"F11\").Select\n    ActiveSheet.ListObjects(Active).ShowTotals = True\n    Range(\"Table2[[#Totals],[Var %]]\").Select\n    ActiveSheet.ListObjects(\"Table2\").ListColumns(\"Var %\").TotalsCalculation = _\n    xlTotalsCalculationAverage\n    Range(\"Table2[[#Totals],[Var $]]\").Select\n    ActiveSheet.ListObjects(\"Table2\").ListColumns(\"Var $\").TotalsCalculation = _\n    xlTotalsCalculationSum\n\nNext tablename\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "parameters", "combobox", "dialog"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 10520468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e037c06de219e2f9ef687f0976c87459?s=128&d=identicon&r=PG&f=1", "display_name": "CoVoid", "link": "https://stackoverflow.com/users/10520468/covoid"}, "is_accepted": true, "score": 0, "last_activity_date": 1539866011, "creation_date": 1539866011, "answer_id": 52874136, "question_id": 52862342, "link": "https://stackoverflow.com/questions/52862342/ms-access-vba-combo-box-opens-a-dialog-instead-of-taking-the-combo-box-value-fro/52874136#52874136", "title": "MS Access VBA Combo Box opens a dialog instead of taking the combo box value from the form", "body": "<p>I was using the wrong syntax for referencing the comboBox.</p>\n\n<pre><code>Private Sub cboSelectByDate_Change()\n    DoCmd.ApplyFilter , \"[Delivery Date] = Forms!frmDeliveries!cboSelectByDate\"\nEnd Sub\n</code></pre>\n\n<p>Has the desired result</p>\n"}], "owner": {"reputation": 1, "user_id": 10520468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e037c06de219e2f9ef687f0976c87459?s=128&d=identicon&r=PG&f=1", "display_name": "CoVoid", "link": "https://stackoverflow.com/users/10520468/covoid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 52874136, "answer_count": 1, "score": 0, "last_activity_date": 1539866011, "creation_date": 1539804756, "last_edit_date": 1539850000, "question_id": 52862342, "link": "https://stackoverflow.com/questions/52862342/ms-access-vba-combo-box-opens-a-dialog-instead-of-taking-the-combo-box-value-fro", "title": "MS Access VBA Combo Box opens a dialog instead of taking the combo box value from the form", "body": "<p>I want to filter a list of records by a certain date, which the user selects from a Combo Box. </p>\n\n<p>Here is the code that I have to apply a filter when the value of the combo box changes.</p>\n\n<pre><code>Private Sub cboSelectByDate_Change()\n    DoCmd.ApplyFilter , \"[Delivery Date] = Me.cboSelectByDate\"\n`End Sub`\n</code></pre>\n\n<p>However when the combo box is changed, a dialog box titled \"Enter Parameter Value\" appears asking for a value for <code>Me.cboSelectByDate</code></p>\n\n<p>How can I make sure Access reads the currently selected value of the combo box instead of opening this dialog?</p>\n"}, {"tags": ["excel", "ms-access", "vba", "recordset"], "comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1539805166, "post_id": 52862306, "comment_id": 92639229, "body": "What version of Excel are you using?"}, {"owner": {"reputation": 305, "user_id": 9437110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb42963fea25acac17f39c7f3738bd25?s=128&d=identicon&r=PG&f=1", "display_name": "user525966", "link": "https://stackoverflow.com/users/9437110/user525966"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1539805562, "post_id": 52862306, "comment_id": 92639392, "body": "@teylyn Access and Excel are both 2010 version"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1539806080, "post_id": 52862306, "comment_id": 92639643, "body": "<a href=\"https://social.msdn.microsoft.com/Forums/office/en-US/3e602bd1-4db2-45bd-85ed-c925894e7048/exporting-large-recordsets-to-excel-stops-at-65536-records-after-upgrade-to-office-2010?forum=accessdev\" rel=\"nofollow noreferrer\">social.msdn.microsoft.com/Forums/office/en-US/&hellip;</a>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1539806170, "post_id": 52862306, "comment_id": 92639686, "body": "Another one: <a href=\"https://social.msdn.microsoft.com/Forums/office/en-US/25e413a1-57c3-407a-9e26-3bb124610e3d/output-limit-for-the-copyfromrecordset-method?forum=accessdev\" rel=\"nofollow noreferrer\">social.msdn.microsoft.com/Forums/office/en-US/&hellip;</a>"}, {"owner": {"reputation": 305, "user_id": 9437110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb42963fea25acac17f39c7f3738bd25?s=128&d=identicon&r=PG&f=1", "display_name": "user525966", "link": "https://stackoverflow.com/users/9437110/user525966"}, "edited": false, "score": 0, "creation_date": 1539806261, "post_id": 52862306, "comment_id": 92639723, "body": "I am pretty sure this Excel file is not being opened in compatibility mode"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1539806423, "post_id": 52862306, "comment_id": 92639794, "body": "@user525966 my link suggests that it is a limit to the clipboard and as such one would need to use a different method to avoid the clipboard."}, {"owner": {"reputation": 305, "user_id": 9437110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb42963fea25acac17f39c7f3738bd25?s=128&d=identicon&r=PG&f=1", "display_name": "user525966", "link": "https://stackoverflow.com/users/9437110/user525966"}, "edited": false, "score": 0, "creation_date": 1539807001, "post_id": 52862306, "comment_id": 92640024, "body": "I got it working by closing the workbook opening and re-opening it, for some reason now it has the full rows and not just 65536 -- wish I didn&#39;t have to do that though"}], "answers": [{"tags": [], "owner": {"reputation": 191, "user_id": 5658623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/589f4ad1339d6763ea2cd54aa2cc5bdd?s=128&d=identicon&r=PG&f=1", "display_name": "yashika vaish", "link": "https://stackoverflow.com/users/5658623/yashika-vaish"}, "is_accepted": false, "score": 0, "last_activity_date": 1539858908, "creation_date": 1539858908, "answer_id": 52872109, "question_id": 52862306, "link": "https://stackoverflow.com/questions/52862306/copyfromrecordset-only-copying-over-65535-rows/52872109#52872109", "title": "CopyFromRecordset only copying over 65535 rows?", "body": "<p>The excel file you are using is having .xls format most probably or any other incompatible one. from the next time change your excel file format and try again.</p>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1540665621, "creation_date": 1540665621, "answer_id": 53025145, "question_id": 52862306, "link": "https://stackoverflow.com/questions/52862306/copyfromrecordset-only-copying-over-65535-rows/53025145#53025145", "title": "CopyFromRecordset only copying over 65535 rows?", "body": "<p>If you are using Excel 2003 or older, 65,535 is a hard limit.  If you have Excel 2007 or newer, there are so, so, so many ways to do this.  Here is one version of countless ways to do this.</p>\n\n<pre><code>Sub ExportDataToExcel()\n   Dim conn As ADODB.Connection\n   Dim myRecordset As ADODB.Recordset\n   Dim strConn As String\n\n   strConn = \"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=\" &amp; \"C:\\your_path_here\\Northwind.mdb\"\n\n   Set myRecordset = New ADODB.Recordset\n\n   FocusRow = ActiveCell.Row\n   With myRecordset\n       .Open \"SELECT * FROM YourTable WHERE ID=\" &amp; Worksheets(\"Sheet1\").Range(\"A2\").Value, _\n         strConn, adOpenKeyset, adLockOptimistic\n\n      .Fields(\"ID\").Value = Worksheets(\"Sheet1\").Range(\"A\" &amp; FocusRow).Value\n      .Fields(\"FName\").Value = Worksheets(\"Sheet1\").Range(\"B\" &amp; FocusRow).Value\n      .Fields(\"LName\").Value = Worksheets(\"Sheet1\").Range(\"C\" &amp; FocusRow).Value\n      .Fields(\"Address\").Value = Worksheets(\"Sheet1\").Range(\"D\" &amp; FocusRow).Value\n      .Fields(\"Age\").Value = Worksheets(\"Sheet1\").Range(\"E\" &amp; FocusRow).Value\n      .Update\n      .Close\n   End With\n   Set myRecordset = Nothing\n   Set conn = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 305, "user_id": 9437110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb42963fea25acac17f39c7f3738bd25?s=128&d=identicon&r=PG&f=1", "display_name": "user525966", "link": "https://stackoverflow.com/users/9437110/user525966"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 324, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1540665621, "creation_date": 1539804604, "question_id": 52862306, "link": "https://stackoverflow.com/questions/52862306/copyfromrecordset-only-copying-over-65535-rows", "title": "CopyFromRecordset only copying over 65535 rows?", "body": "<p>I am writing some code in MS Access VBA.</p>\n\n<p>I have an MS Access query with 110,000 rows and I am trying to copy them over to an Excel spreadsheet, but when I call</p>\n\n<p>xlWorksheet.Range(\"A2\").CopyFromRecordset rs</p>\n\n<p>It's only porting over 65535 rows. Is there a way to make it port over the entire set?</p>\n"}, {"tags": ["excel", "vba", "selenium", "selenium-webdriver", "web-scraping"], "answers": [{"comments": [{"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1539805030, "post_id": 52862290, "comment_id": 92639160, "body": "Hey @QHarr, thanks for your solution. My question perhaps misguided you. My script can successfully select the Country <code>Canada</code> from the dropdown. What it can&#39;t do is press the <code>Done</code> button to reflect the change to that page. Once again - It&#39;s all about prssing the <code>Done</code> button. Btw, I tried your script but still the same as I was having earlier."}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1539807208, "post_id": 52862290, "comment_id": 92640117, "body": "No damn way!!! Yep, you made it @QHarr. Do you know whether there is any option for <b><i><code>Focus</code></i></b> in vba selenium binding?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1539807825, "post_id": 52862290, "comment_id": 92640420, "body": "Usually use  moveToElement()"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 2, "last_activity_date": 1539806766, "last_edit_date": 1539806766, "creation_date": 1539804512, "answer_id": 52862290, "question_id": 52862083, "link": "https://stackoverflow.com/questions/52862083/unexpected-selenium-behaviour-after-selecting-from-dropdown/52862290#52862290", "title": "Unexpected Selenium behaviour after selecting from dropdown", "body": "<p>Seems like it needs a little breather before the final click.</p>\n\n<pre><code>Option Explicit\nPublic Sub SelectDropdown()\n    Dim driver As New ChromeDriver\n    With driver\n        .get \"https://www.amazon.com/dp/B071V5DQ56/\"\n        .FindElementByCss(\"#nav-packard-glow-loc-icon\", timeout:=5000).Click\n        .FindElementByCss(\"#GLUXCountryListDropdown\", timeout:=5000).Click\n        .FindElementById(\"GLUXCountryList\", timeout:=5000).AsSelect.SelectByText \"Canada\"\n        Application.Wait Now + TimeSerial(0, 0, 1)\n        .FindElementByCss(\"[data-action='a-popover-close']\", timeout:=5000).Click\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 52862290, "answer_count": 1, "score": 1, "last_activity_date": 1556945860, "creation_date": 1539803635, "last_edit_date": 1556945860, "question_id": 52862083, "link": "https://stackoverflow.com/questions/52862083/unexpected-selenium-behaviour-after-selecting-from-dropdown", "title": "Unexpected Selenium behaviour after selecting from dropdown", "body": "<p>I've written a Selenium script in VBA to select from a dropdown then press the <code>Done</code> button.</p>\n\n<p>By default the page shows <code>Bangladesh</code> in it's landing page. I need to change it to <code>Canada</code>.</p>\n\n<p>My script selects the desired country from the dropdown but when it is supposed to click the <code>Done</code> button, it clicks elsewhere so the country remains unchanged. The script doesn't show any error.</p>\n\n<p><a href=\"https://rads.stackoverflow.com/amzn/click/com/B071V5DQ56\" rel=\"nofollow noreferrer\" rel=\"nofollow noreferrer\">Site link:</a></p>\n\n<pre><code>Sub SelectDropdown()\n    Dim driver As New ChromeDriver\n\n    With driver\n        .get \"https://www.amazon.com/dp/B071V5DQ56/\"\n        .FindElementByCss(\"#nav-packard-glow-loc-icon\", timeout:=5000).Click\n        .FindElementByCss(\"#GLUXCountryListDropdown\", timeout:=5000).Click\n        .FindElementById(\"GLUXCountryList\", timeout:=5000).AsSelect.SelectByText \"Canada\"\n        .FindElementByCss(\"div.a-popover-wrapper button[name='glowDoneButton']\", timeout:=5000).Click\n    End With\n    Stop\nEnd Sub\n</code></pre>\n\n<p>This is what it shows in the landing page.</p>\n\n<p><a href=\"https://i.stack.imgur.com/UCtAa.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UCtAa.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2016"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1539804343, "post_id": 52861966, "comment_id": 92638860, "body": "Where is the button? You want every record to get the same value of <code>99999</code>? Use an UPDATE action SQL. Or loop RecordsetClone and set value of each record. Or code physically sets focus on each record in form and sets Value. Edit question to post code."}, {"owner": {"reputation": 13, "user_id": 10509225, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-b5L23UfLceY/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DU_pEcg60jCoc5nkgHP59coxwbtlw/mo/photo.jpg?sz=128", "display_name": "Allanmr", "link": "https://stackoverflow.com/users/10509225/allanmr"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1539804810, "post_id": 52861966, "comment_id": 92639061, "body": "Yes, every record to get &quot;99999&quot; and the first 3 checkboxes &quot;checked&quot;. BUT ONLY when a separate button is pressed. This button just populates the list"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1539805171, "post_id": 52861966, "comment_id": 92639236, "body": "What does OpenQuery do - INSERT records? So in button event run UPDATE on those new records. What would be the filter criteria - a date or particular field Is Null?"}, {"owner": {"reputation": 13, "user_id": 10509225, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-b5L23UfLceY/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DU_pEcg60jCoc5nkgHP59coxwbtlw/mo/photo.jpg?sz=128", "display_name": "Allanmr", "link": "https://stackoverflow.com/users/10509225/allanmr"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1539805471, "post_id": 52861966, "comment_id": 92639354, "body": "Yes, they insert into. No filter criteria... I&#39;m currently learning SQL so my knowledge is at a basic/novice level. this is the current code: <code>INSERT INTO paradetails ( ptype, amount, paraid, class, emp ) SELECT ParaTypes.autoid, [enter maximum per disicipline] AS amount, paraheader.autoid, paraheader.class, paraheader.EMP FROM ParaTypes, paraheader WHERE (((paraheader.autoid)=[forms]![paraheader]![autoid]));</code>"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1539805679, "post_id": 52861966, "comment_id": 92639460, "body": "Now build an UPDATE query that targets those new records. What would distinguish them from other existing records? The amount field Is Null and/or a date? Only you know what criteria can be used to select those new records - probably the same criteria that filters them for display on form."}, {"owner": {"reputation": 13, "user_id": 10509225, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-b5L23UfLceY/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DU_pEcg60jCoc5nkgHP59coxwbtlw/mo/photo.jpg?sz=128", "display_name": "Allanmr", "link": "https://stackoverflow.com/users/10509225/allanmr"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1539806301, "post_id": 52861966, "comment_id": 92639741, "body": "You think an UPDATE query would be best? I&#39;d have to add in through my VBA button (I have VBA&gt;SQL statements so I can do it)"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1539820052, "post_id": 52861966, "comment_id": 92644331, "body": "It is simpler code than looping through recordset."}], "owner": {"reputation": 13, "user_id": 10509225, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-b5L23UfLceY/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DU_pEcg60jCoc5nkgHP59coxwbtlw/mo/photo.jpg?sz=128", "display_name": "Allanmr", "link": "https://stackoverflow.com/users/10509225/allanmr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1539805099, "creation_date": 1539803205, "last_edit_date": 1539805099, "question_id": 52861966, "link": "https://stackoverflow.com/questions/52861966/ms-access-subform-text-boxes-input-by-query-can-i-add-default-values", "title": "MS Access subform text boxes input by query. Can I add default values?", "body": "<p>I am trying to auto fill in text/check boxes. I only want to do this when a button is pressed. Currently the form detail in design view has 1 row of text/check boxes (pic 1), when the query is run in form view it creates 19 more items in the column (pic 2).  </p>\n\n<p>I can fill in the first line by just entering amount.value=\"99999\" but the rest of the 'boxes' aren't there so I can't add a value to them...\nAm I able to add default values to these only when a button is pressed?</p>\n\n<p><img src=\"https://i.stack.imgur.com/acjuM.png\" alt=\"design view\"></p>\n\n<p><img src=\"https://i.stack.imgur.com/XV4tl.png\" alt=\"form view\"></p>\n\n<pre><code>Private Sub Command23_Click()\nOn Error GoTo Err_Command23_Click\n\n    Dim stDocName As String\n\n    stDocName = \"InsertParaTypes\"\n\n    DoCmd.DoMenuItem acFormBar, acRecordsMenu, acSaveRecord, , acMenuVer70\n    DoCmd.OpenQuery stDocName, acNormal, acEdit\n\nExit_Command23_Click:\n    Exit Sub\n\nErr_Command23_Click:\n    MsgBox Err.Description\n    Resume Exit_Command23_Click\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13431, "user_id": 2169762, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nns8w.png?s=128&g=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/2169762/martin"}, "edited": false, "score": 3, "creation_date": 1539800284, "post_id": 52861198, "comment_id": 92636948, "body": "Whilst editing your question to tidy up your code it became apparent that you appear to be missing <code>Next j</code> from your code.  Is that what is causing your error?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1539800286, "post_id": 52861198, "comment_id": 92636949, "body": "<code>Next j</code> is missing."}, {"owner": {"reputation": 13431, "user_id": 2169762, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nns8w.png?s=128&g=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/2169762/martin"}, "edited": false, "score": 1, "creation_date": 1539800538, "post_id": 52861198, "comment_id": 92637065, "body": "Just a tip, if you correctly format and indent your code in future, simple grammatical errors such as missing <code>Next</code>s, <code>End If</code>s, and other closing statements, become very obvious."}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 1, "creation_date": 1539800597, "post_id": 52861198, "comment_id": 92637096, "body": "And once you add the <code>Next j</code>, <code>j = j + 1</code> will be redundant."}, {"owner": {"reputation": 25, "user_id": 10520135, "user_type": "registered", "profile_image": "https://graph.facebook.com/2206268492739214/picture?type=large", "display_name": "Johnny", "link": "https://stackoverflow.com/users/10520135/johnny"}, "edited": false, "score": 0, "creation_date": 1539801297, "post_id": 52861198, "comment_id": 92637425, "body": "Thanks for the editing, I&#39;m new to using VBA. If I add in the &quot;Next j&quot; I still get &quot;Remove&quot; on the lines where I should be getting &quot;Keep&quot;. Is there something else that is wrong?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1539801716, "post_id": 52861198, "comment_id": 92637639, "body": "Yes you need to exit the inner loop as soon as you get the positive, otherwise it will only return the result of the Y27 every time."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 10520135, "user_type": "registered", "profile_image": "https://graph.facebook.com/2206268492739214/picture?type=large", "display_name": "Johnny", "link": "https://stackoverflow.com/users/10520135/johnny"}, "edited": false, "score": 0, "creation_date": 1539802299, "post_id": 52861639, "comment_id": 92637931, "body": "Now that gives me an error at  &quot;Next j&quot;. Compile error: Next without For"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1539802421, "last_edit_date": 1539802421, "creation_date": 1539801841, "answer_id": 52861639, "question_id": 52861198, "link": "https://stackoverflow.com/questions/52861198/loop-inside-loop-using-multiple-variables/52861639#52861639", "title": "Loop inside loop using multiple variables", "body": "<p>As stated in the comments.  Use <code>Next j</code> and exit the inner loop when criteria is met.</p>\n\n<pre><code>Sub DoubleLoop()\n    Dim i As Long, j As Long\n    Dim Carr As Integer\n\n    For i = 2 To 49235\n        Range(\"P\" &amp; i).Value = \"Remove\"\n        For j = 2 To 27\n            If Range(\"P\" &amp; i).Value = (\"Y\" &amp; j) And Range(\"S\" &amp; i).Value = (\"Z\" &amp; j) And Range(\"P\" &amp; i).Value = (\"AA\" &amp; j) Then\n                Range(\"P\" &amp; i).Value = \"Keep\"\n                Exit For\n            End If\n        Next j\n    Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 10520135, "user_type": "registered", "profile_image": "https://graph.facebook.com/2206268492739214/picture?type=large", "display_name": "Johnny", "link": "https://stackoverflow.com/users/10520135/johnny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 52861639, "answer_count": 1, "score": 1, "last_activity_date": 1539802421, "creation_date": 1539800025, "last_edit_date": 1539800258, "question_id": 52861198, "link": "https://stackoverflow.com/questions/52861198/loop-inside-loop-using-multiple-variables", "title": "Loop inside loop using multiple variables", "body": "<p>I am having trouble making a program work in Excel.</p>\n\n<p>I need loop through all the lines in my excel spreadsheet, and loop through multiple possible cells for each line. </p>\n\n<pre><code>Sub DoubleLoop() \n    Dim i As Long\n    Dim Carr As Integer\n\n    For i = 2 To 49235\n        For j = 2 To 27\n            If Range(\"P\" &amp; i).Value = (\"Y\" &amp; j) And Range(\"S\" &amp; i).Value = (\"Z\" &amp; j) And Range(\"P\" &amp; i).Value = (\"AA\" &amp; j) Then\n                Range(\"P\" &amp; i).Value = \"Keep\"\n            ElseIf j &lt; 27 Then\n                j = j + 1\n            ElseIf j = 27 Then\n                Range(\"X\" &amp; i).Value = \"Remove\"\n            End If\n    Next i\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "number-formatting"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 6509613, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-rbkUXJkLYaQ/AAAAAAAAAAI/AAAAAAAAAEM/rslJNB03nHM/photo.jpg?sz=128", "display_name": "Samu Lattu", "link": "https://stackoverflow.com/users/6509613/samu-lattu"}, "edited": false, "score": 0, "creation_date": 1539800658, "post_id": 52860644, "comment_id": 92637129, "body": "This is a nifty idea, though I&#39;ll wait before proceeding with it. This workaround would involve accounting for #DIV/0. Sometimes the input for the data labels is #DIV/0, which would break rounding, but is expressed as <code>0.0</code> by <code>NumberFormat=0.0</code> as desired."}, {"owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "reply_to_user": {"reputation": 31, "user_id": 6509613, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-rbkUXJkLYaQ/AAAAAAAAAAI/AAAAAAAAAEM/rslJNB03nHM/photo.jpg?sz=128", "display_name": "Samu Lattu", "link": "https://stackoverflow.com/users/6509613/samu-lattu"}, "edited": false, "score": 0, "creation_date": 1539810789, "post_id": 52860644, "comment_id": 92641748, "body": "@SamuLattu Yeah definitely, depending on how you&#39;re loading your data into your chart, you can use conditionals like <code>if</code> statements to assign <code>0.0</code> to cases where it would be <code>#DIV&#47;0</code>"}, {"owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "reply_to_user": {"reputation": 31, "user_id": 6509613, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-rbkUXJkLYaQ/AAAAAAAAAAI/AAAAAAAAAEM/rslJNB03nHM/photo.jpg?sz=128", "display_name": "Samu Lattu", "link": "https://stackoverflow.com/users/6509613/samu-lattu"}, "edited": false, "score": 0, "creation_date": 1539810856, "post_id": 52860644, "comment_id": 92641781, "body": "@SamuLattu Just be careful because I believe the <code>Round()</code> function has some weird traits with its round up/down rules"}, {"owner": {"reputation": 31, "user_id": 6509613, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-rbkUXJkLYaQ/AAAAAAAAAAI/AAAAAAAAAEM/rslJNB03nHM/photo.jpg?sz=128", "display_name": "Samu Lattu", "link": "https://stackoverflow.com/users/6509613/samu-lattu"}, "edited": false, "score": 0, "creation_date": 1539866873, "post_id": 52860644, "comment_id": 92662140, "body": "yes, <code>Round()</code> uses banker&#39;s rounding, meaning it rounds 0.45 to 0.40 and not 0.50. That would not have been a deal-breaker in my case, but I found a more direct solution to force formatting. @kubie"}], "tags": [], "owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "is_accepted": false, "score": 1, "last_activity_date": 1539797845, "creation_date": 1539797845, "answer_id": 52860644, "question_id": 52860484, "link": "https://stackoverflow.com/questions/52860484/how-can-i-make-sure-excel-does-not-change-number-format-of-a-data-label-in-other/52860644#52860644", "title": "How can I make sure Excel does not change number format of a data label in other language versions?", "body": "<p>Don't have a direct solution, but if this persists with <code>NumberFormat</code>, you can programmatically use combinations of built-in Excel functions to achieve the same numbers.</p>\n\n<p>for ex:</p>\n\n<pre><code>number = Round(number, 1)\n</code></pre>\n\n<p>In this case, you can leave the NumberFormat as <code>\"General\"</code> or something similar</p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 6509613, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-rbkUXJkLYaQ/AAAAAAAAAAI/AAAAAAAAAEM/rslJNB03nHM/photo.jpg?sz=128", "display_name": "Samu Lattu", "link": "https://stackoverflow.com/users/6509613/samu-lattu"}, "is_accepted": true, "score": 0, "last_activity_date": 1539866708, "creation_date": 1539866708, "answer_id": 52874374, "question_id": 52860484, "link": "https://stackoverflow.com/questions/52860484/how-can-i-make-sure-excel-does-not-change-number-format-of-a-data-label-in-other/52874374#52874374", "title": "How can I make sure Excel does not change number format of a data label in other language versions?", "body": "<p>It appears the easiest solution is to programmatically disable decimal separators and replace them with your own, <a href=\"https://docs.microsoft.com/en-us/previous-versions/office/developer/office-2003/aa214274(v=office.11)\" rel=\"nofollow noreferrer\">as described here</a>.</p>\n\n<pre><code>Application.DecimalSeparator = \".\"\nApplication.ThousandsSeparator = \",\"\nApplication.UseSystemSeparators = False\n</code></pre>\n\n<p>I came across this solution <a href=\"https://stackoverflow.com/questions/20652409/using-vba-to-detect-which-decimal-sign-the-computer-is-using\">in this thread</a> while searching for how to determine the language version of Excel.</p>\n\n<p>Another solution is to use the decimal separator prescribed by the system when defining the number format. This solution seems to also produce the desired result (one decimal place displayed, even if 0), though with whatever decimal separator the system has defined:</p>\n\n<pre><code>Chart.SeriesCollection(1).DataLabels.NumberFormat = \"0\" &amp; Application.International(xlDecimalSeparator) &amp; \"0\"\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 6509613, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-rbkUXJkLYaQ/AAAAAAAAAAI/AAAAAAAAAEM/rslJNB03nHM/photo.jpg?sz=128", "display_name": "Samu Lattu", "link": "https://stackoverflow.com/users/6509613/samu-lattu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 52874374, "answer_count": 2, "score": 3, "last_activity_date": 1593677144, "creation_date": 1539797098, "last_edit_date": 1593677144, "question_id": 52860484, "link": "https://stackoverflow.com/questions/52860484/how-can-i-make-sure-excel-does-not-change-number-format-of-a-data-label-in-other", "title": "How can I make sure Excel does not change number format of a data label in other language versions?", "body": "<p>I have a workbook with VBA code that specifies a number format for data labels in a horizontal bar chart.</p>\n\n<pre><code>Chart.SeriesCollection(1).DataLabels.NumberFormat = \"0.0\"\n</code></pre>\n\n<p>In my copy of Excel (O365) in English, <a href=\"https://i.stack.imgur.com/3fIjq.png\" rel=\"nofollow noreferrer\">output is as expected</a>, e.g. <code>3.7</code>. When the workbook is opened in another copy of Excel (O365) in a language other than English, Excel appears to insert a backwards slash that can be seen <a href=\"https://i.stack.imgur.com/RSvS7.png\" rel=\"nofollow noreferrer\">in the Format Code -field of the Format Data Labels -sidebar</a> (i.e. <code>0\\.0</code>). Where output should be e.g. <code>3.7</code>, <a href=\"https://i.stack.imgur.com/C6pV3.png\" rel=\"nofollow noreferrer\">output becomes</a> <code>0.4</code>.</p>\n\n<p>The issue persists when I load up the workbook after it has been touched by the non-English Excel - my version doesn't throw away the backward slash. The issue goes away when I delete the backwards slash, and output is as expected again.</p>\n\n<p>It seems to me Excel treats the leading zero and decimal point as plain text and the second zero as the intended numerical character.</p>\n\n<p>How can I make sure Excel maintains the number format specified in VBA when a workbook is opened in a different language version?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1539797181, "post_id": 52860424, "comment_id": 92635450, "body": "When you say the sheet is named based on who to send the email to, do you mean it has their actual name or their email address?"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1539797210, "post_id": 52860424, "comment_id": 92635466, "body": "It&#39;d help if you pasted your current code as well, because this problem isn&#39;t <i>too</i> difficult"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1539797352, "post_id": 52860424, "comment_id": 92635529, "body": "If you want to go the route with each sheet as a separate file, you can attach that file to an email using something like this <a href=\"https://stackoverflow.com/a/37302823/2727437\">stackoverflow.com/a/37302823/2727437</a>"}, {"owner": {"reputation": 93, "user_id": 3443724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0526e17b60b469a6890ea0d300feb38a?s=128&d=identicon&r=PG&f=1", "display_name": "bezj", "link": "https://stackoverflow.com/users/3443724/bezj"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1539797700, "post_id": 52860424, "comment_id": 92635683, "body": "@Marcucciboy2 Posted code! The name of the separate sheets is the persons name not their email address currently. Checking your suggested link now."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1539798165, "post_id": 52860424, "comment_id": 92635922, "body": "Oh okay you were a little further back then I expected, check out Ron de Bruin&#39;s classic examples for creating outlook mail with excel vba <a href=\"https://www.rondebruin.nl/win/s1/outlook/mail.htm\" rel=\"nofollow noreferrer\">rondebruin.nl/win/s1/outlook/mail.htm</a>"}, {"owner": {"reputation": 8351, "user_id": 4279155, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/841b7391f3f7873bec1a8d9d8d2dc759?s=128&d=identicon&r=PG&f=1", "display_name": "Dominique", "link": "https://stackoverflow.com/users/4279155/dominique"}, "edited": false, "score": 0, "creation_date": 1591538172, "post_id": 52860424, "comment_id": 110087915, "body": "Are you aware of the &quot;mail merge&quot; feature? <a href=\"https://support.office.com/en-us/article/mail-merge-using-an-excel-spreadsheet-858c7d7f-5cc0-4ba1-9a7b-0a948fa3d7d3\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>"}], "owner": {"reputation": 93, "user_id": 3443724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0526e17b60b469a6890ea0d300feb38a?s=128&d=identicon&r=PG&f=1", "display_name": "bezj", "link": "https://stackoverflow.com/users/3443724/bezj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1591532093, "creation_date": 1539796886, "last_edit_date": 1591532093, "question_id": 52860424, "link": "https://stackoverflow.com/questions/52860424/automating-emails-to-individual-recipients-based-on-sheet-name", "title": "Automating Emails to individual recipients based on sheet name", "body": "<p>I have a large report that I have to parse through and send emails to individuals based on the data in the report. I have created a macro that allows me to split the data I need into separate sheets within the workbook so that the sheet's are named based on who the data should be emailed to.</p>\n\n<p>I am struggling with finding how to automate the next step so that, based on the title of the sheet (name of person not email address), an email is sent to that person.</p>\n\n<p>Currently my workaround is another macro that saves all the different sheets as separate workbooks, but that still requires me to manually send emails with attachments. Perhaps there is an easier way to automate once I have all the sheets saved as separate files?</p>\n\n<pre><code>Sub parse_data()\n\n    Dim lr As Long\n    Dim ws As Worksheet\n    Dim vcol, i As Integer\n    Dim icol As Long\n    Dim myarr As Variant\n    Dim title As String\n    Dim titlerow As Integer\n\n    vcol = 5\n    Set ws = sheets(\"Master\")\n    lr = ws.Cells(ws.rows.count, vcol).End(xlUp).row\n    title = \"A1:W1\"\n    titlerow = ws.Range(title).Cells(1).row\n    icol = ws.Columns.count\n    ws.Cells(1, icol) = \"Unique\"\n\n    For i = 2 To lr\n        On Error Resume Next\n        If ws.Cells(i, vcol) &lt;&gt; \"\" _\n        And Application.WorksheetFunction.Match(ws.Cells(i, vcol), ws.Columns(icol), 0) = 0 Then\n            ws.Cells(ws.rows.count, icol).End(xlUp).offset(1) = ws.Cells(i, vcol)\n        End If\n    Next\n\n    myarr = Application.WorksheetFunction.Transpose(ws.Columns(icol).SpecialCells(xlCellTypeConstants))\n    ws.Columns(icol).clear\n\n    For i = 2 To UBound(myarr)\n        ws.Range(title).AutoFilter field:=vcol, Criteria1:=myarr(i) &amp; \"\"\n\n        If Not Evaluate(\"=ISREF('\" &amp; myarr(i) &amp; \"'!A1)\") Then\n            sheets.Add(after:=Worksheets(Worksheets.count)).name = myarr(i) &amp; \"\"\n        Else\n            sheets(myarr(i) &amp; \"\").Move after:=Worksheets(Worksheets.count)\n        End If\n\n        ws.Range(\"A\" &amp; titlerow &amp; \":A\" &amp; lr).EntireRow.copy sheets(myarr(i) &amp; \"\").Range(\"A1\")\n        sheets(myarr(i) &amp; \"\").Columns.AutoFit\n    Next\n\n    ws.AutoFilterMode = False\n    ws.Activate\n\nEnd Sub\n\nSub Splitbook()\n\n    'Split worksheets into seperate saved files'\n\n    Dim xPath As String\n    xPath = ActiveWorkbook.path\n\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n\n    For Each xWs In ThisWorkbook.sheets\n        xWs.copy\n        ActiveWorkbook.SaveAs filename:=xPath &amp; \"\\\" &amp; xWs.name &amp; \".xlsx\"\n        ActiveWorkbook.Close False\n    Next\n\n    Application.DisplayAlerts = True\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>Any assistance is much appreciated. Thanks in advance!</p>\n"}, {"tags": ["regex", "vba", "hyperlink", "ms-word"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1539796834, "post_id": 52860339, "comment_id": 92635300, "body": "I don&#39;t think replace makes sense for what you&#39;re trying to do. I think it&#39;d make more sense to clear the text at <code>Match.Range</code> and then instead add the hyperlink at the location of the <code>Match.Range</code>"}, {"owner": {"reputation": 1, "user_id": 3341969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63b1fc3aa57e39a9c7db0915c7a446fb?s=128&d=identicon&r=PG&f=1", "display_name": "UCanCallMeBob89", "link": "https://stackoverflow.com/users/3341969/ucancallmebob89"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 1, "creation_date": 1539798879, "post_id": 52860339, "comment_id": 92636279, "body": "@Marcucciboy2 how would you do that? I&#39;m thinking something like  &#39;For Each Match In Matches&#39; &#39;Match.Text = &quot;&quot;&#39; ActiveDocument.Hyperlinks.Add Anchor:=Match, Address:=&quot;<a href=\"https://www.my_website.com/\" rel=\"nofollow noreferrer\">my_website.com</a>&quot; &amp; Match&#39;"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1539799044, "post_id": 52860339, "comment_id": 92636350, "body": "Does <code>Matches</code> actually receive a range from <code>RegEx.Execute</code> of each match for that regex?"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1539799077, "post_id": 52860339, "comment_id": 92636363, "body": "Yeah, that&#39;s what I&#39;m thinking I&#39;d go for"}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 1, "creation_date": 1539801648, "post_id": 52860339, "comment_id": 92637608, "body": "You cannot do that with regex alone, the regex only works on plain text. Find the index in the document and try to add a hyperlink at that position."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1539837112, "post_id": 52860339, "comment_id": 92647674, "body": "You need to use Word&#39;s built-in Find functionality. It doesn&#39;t use RegEx, but it does have &quot;wildcards&quot; capability that&#39;s similar, just not as powerful. Should do the trick for this, though. Searching in the Internet should turn up a lot of examples. The Find will need to execute in a loop and each &quot;hit&quot; will need to process inserting the required hyperlink using the Word object model."}], "answers": [{"tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": false, "score": 0, "last_activity_date": 1539846122, "creation_date": 1539846122, "answer_id": 52868620, "question_id": 52860339, "link": "https://stackoverflow.com/questions/52860339/use-vba-to-replace-regex-strings-with-hyperlinks-in-word/52868620#52868620", "title": "Use VBA to replace RegEx strings with hyperlinks in Word", "body": "<p>Try:</p>\n\n<pre><code>Sub FindAndHyperlink()\nApplication.ScreenUpdating = False\nConst HLnk As String = \"https://www.my_website.com/\"\nWith ActiveDocument.Range\n  With .Find\n    .ClearFormatting\n    .Replacement.ClearFormatting\n    .Text = \"A-[0-9]{1,}\"\n    .Replacement.Text = \"\"\n    .Forward = True\n    .Wrap = wdFindStop\n    .Format = False\n    .MatchWildcards = True\n    .Execute\n  End With\n  Do While .Find.Found\n    .Hyperlinks.Add Anchor:=.Duplicate, Address:=HLnk &amp; .Text, TextToDisplay:=.Text\n    .Start = .Hyperlinks(1).Range.End\n    .Find.Execute\n  Loop\nEnd With\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1540665102, "creation_date": 1540665102, "answer_id": 53025082, "question_id": 52860339, "link": "https://stackoverflow.com/questions/52860339/use-vba-to-replace-regex-strings-with-hyperlinks-in-word/53025082#53025082", "title": "Use VBA to replace RegEx strings with hyperlinks in Word", "body": "<p>I just tested this and it worked fine for me.</p>\n\n<pre><code>([a-z _:/.A-Z-1-9]+)\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/n3MBB.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/n3MBB.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Notice the UPPERCASE and lowercase, plus the 1-9 (one through nine, inclusive), as well as the characters such as slash and period.</p>\n"}], "owner": {"reputation": 1, "user_id": 3341969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63b1fc3aa57e39a9c7db0915c7a446fb?s=128&d=identicon&r=PG&f=1", "display_name": "UCanCallMeBob89", "link": "https://stackoverflow.com/users/3341969/ucancallmebob89"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 388, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1540665102, "creation_date": 1539796579, "last_edit_date": 1539836914, "question_id": 52860339, "link": "https://stackoverflow.com/questions/52860339/use-vba-to-replace-regex-strings-with-hyperlinks-in-word", "title": "Use VBA to replace RegEx strings with hyperlinks in Word", "body": "<p>I'm trying to search through a word document and replace regex matches with a series of static hyperlinks.</p>\n\n<p>For example, if I get a regex match for <code>\"A-1\"</code>, I want to replace the <code>\"A-1\"</code> string with a hyperlink with <code>Anchor = \"A-1\"</code> and <code>Address = \"https://www.my_website.com/A-1\"</code>. My RegEx matches could be <code>\"A-1\", \"A-2\", \"A-3\", etc</code>.</p>\n\n<p>I'm familiar with RegEx but I'm very new to VBA. What I have so far:</p>\n\n<pre><code>Sub FindAndHyperlink()\n\n    Dim RegEx As Object\n    Set RegEx = CreateObject(\"VBScript.RegExp\")\n\n    RegEx.Global = True\n    RegEx.Pattern = \"([A][\\-])([0-9])\"\n\n    Set Matches = RegEx.Execute(ActiveDocument.Range.Text)\n    For Each Match In Matches\n        ActiveDocument.Range.Text = RegEx.Replace(ActiveDocument.Range.Text, (ActiveDocument.Hyperlinks.Add Anchor:=Match, Address:=\"https://www.my_website.com/\" &amp; Match))\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>This doesn't compile because it's expecting a <code>)</code> after <code>ActiveDocument.Hyperlinks.Add</code>.</p>\n\n<p>I think the problem is that the <code>RegEx.Replace()</code> method is expecting <code>(String, String)</code> arguments rather than <code>(String, Hyperlink object)</code>, but I'm not sure the best way to get around that.</p>\n\n<p>Any help would be appreciated.</p>\n"}, {"tags": ["excel", "vba", "comments", "vlookup"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1539796601, "post_id": 52860293, "comment_id": 92635187, "body": "What line throws the error?"}, {"owner": {"reputation": 5, "user_id": 10518777, "user_type": "registered", "profile_image": "https://graph.facebook.com/1975555195844610/picture?type=large", "display_name": "Billy Kuhn", "link": "https://stackoverflow.com/users/10518777/billy-kuhn"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1539797220, "post_id": 52860293, "comment_id": 92635473, "body": "I am not sure. I thing my problems are with the .Comment.Shape.TextFrame.AutoSize = False, .Comment.Text Text:=CStr(WorksheetFunction.VLookup(c, lookRange, 2, False)),and the Application.ScreenUpdating = True"}], "answers": [{"comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1539801519, "post_id": 52860608, "comment_id": 92637536, "body": "<i>cough</i> you should set screenupdating to false <i>cough</i>"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1539801776, "post_id": 52860608, "comment_id": 92637670, "body": "@Marcucciboy2 - Probably. OP has it as <code>True</code>, so I just left it."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1539801982, "post_id": 52860608, "comment_id": 92637762, "body": "He also mentioned he was having trouble with it"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 1, "last_activity_date": 1539802734, "last_edit_date": 1539802734, "creation_date": 1539797648, "answer_id": 52860608, "question_id": 52860293, "link": "https://stackoverflow.com/questions/52860293/vba-excel-comment-lookup/52860608#52860608", "title": "VBA Excel Comment Lookup", "body": "<p>There's an issue with your <code>VLOOKUP()</code>.  In the event that your cell does NOT have an entry in the <code>VLOOKUP()</code> table, it will error out.  One quick solution is to slightly tweak the code: </p>\n\n<pre><code>On Error Resume Next\n.Comment.Text Text:=CStr(WorksheetFunction.VLookup(c, lookRange, 2, False))\nOn Error GoTo 0\n</code></pre>\n\n<p>Another alternative would be to prompt the user to add the missing value/return value, but that's a little more involved and I'm not sure what you want to return if there's no <code>VLOOKUP()</code> entry found.</p>\n\n<p>Edit: Here's some error handling included. It will expand the VLOOKUP table if there's no entry for a cell value:</p>\n\n<pre><code>Option Explicit\n\nSub CommentLookup()\nDim commentRange As Range 'Range where you want to add comments to\nDim c As Range\nDim lookRange As Range     'Range to lookup\nSet commentRange = Range(\"$L$6:$U$6\")     'Define our ranges\nSet lookRange = Range(\"$BD$3:$BE$15\")    \nApplication.ScreenUpdating = False\nFor Each c In commentRange 'loop through and comment\n    With c\n        c.Select\n        .ClearComments\n        .AddComment\n        .Comment.Visible = False\n        On Error GoTo tableAdd\n        .Comment.Text Text:=CStr(WorksheetFunction.VLookup(c, lookRange, 2, False))\n        On Error GoTo 0\n        .Comment.Shape.TextFrame.AutoSize = False\n    End With\nNext c\nApplication.ScreenUpdating = True\nExit Sub\n\ntableAdd:\nDim entry As String\nentry = InputBox(\"What is the expected return value for \" &amp; c.Value)\nWith lookRange\n    .Cells(.Rows.Count, .Columns.Count).Offset(1, 0).Value = entry\n    .Cells(.Rows.Count, 1).Offset(1, 0).Value = c\n    Set lookRange = Range(\"$BD$3:$BE$\" &amp; .Cells(.Rows.Count, .Columns.Count).Offset(1, 0).Row)\nEnd With\nResume Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 10518777, "user_type": "registered", "profile_image": "https://graph.facebook.com/1975555195844610/picture?type=large", "display_name": "Billy Kuhn", "link": "https://stackoverflow.com/users/10518777/billy-kuhn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "accepted_answer_id": 52860608, "answer_count": 1, "score": 0, "last_activity_date": 1593677155, "creation_date": 1539796426, "last_edit_date": 1593677155, "question_id": 52860293, "link": "https://stackoverflow.com/questions/52860293/vba-excel-comment-lookup", "title": "VBA Excel Comment Lookup", "body": "<p>I have several data validation list in cells <code>L6:U6</code>. They are all the same list. The list comes from the range <code>BD3:BD15</code> and is in alphabetical order. In cells <code>BE3:BE15</code> I have comments regarding the different items that appear in my drop down list. What I am looking for is when an item is selected in any of my data validation cells, that the comment will be vlookup'ed from range <code>BD3:BE15</code>. So for example, you select the word \"Burn\" in the drop down or cell <code>L6</code>, and a vlookup will be done with range <code>BD3:BE15</code> to pull the comment related to how to treat a burn will appear when you hover over cell <code>L6</code>.  </p>\n\n<p>Here is the code I have come up with, but when I run it I hit a few problems. I get a Run-time error '1004': Application-defined or object defined error. I hit okay and the comments only appear over cells <code>L6:N6</code>. For the comments I do get, I can not see the entire string, it gets cut off with several words off-screen. And when I select a different item, like the word \"Poison\", the comment does not update either. Can someone review the code I have and tell me where I am going wrong?</p>\n\n<pre><code>Sub CommentLookup()\n'Range where you want to add comments to\nDim commentRange As Range\nDim c As Range\n'Range to lookup\nDim lookRange As Range\n'Define our ranges\nSet commentRange = Range(\"$L$6:$U$6\")\nSet lookRange = Range(\"$BD$3:$BE$15\")\nApplication.ScreenUpdating = True\n'loop through and comment\nFor Each c In commentRange\n    With c\n        .ClearComments\n        .AddComment\n        .Comment.Visible = False\n        .Comment.Text Text:=CStr(WorksheetFunction.VLookup(c, lookRange, 2, False))\n        .Comment.Shape.TextFrame.AutoSize = False\n    End With\nNext c\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "listbox"], "comments": [{"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 0, "creation_date": 1539802476, "post_id": 52860150, "comment_id": 92638006, "body": "I tried by copy pasting the code and worked perfectly. It is a clean piece of code.  However Cells(lbxBDGExpensesHistory.ListCount - (lbxBDGExpensesHistory.ListCount - i)+2 is effectively cancelling lbxBDGExpensesHistory.ListCount and using only i+2 as row. May please try a trial run by replacing \u2018.EntireRow.Delete\u2019 with something like \u2018.Font.Bold = True\u2019 to witness the effect"}, {"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 0, "creation_date": 1539803873, "post_id": 52860150, "comment_id": 92638625, "body": "NB. However my listbox is not dynamically linked. I populated it at init"}, {"owner": {"reputation": 15, "user_id": 10494926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eZAOW.jpg?s=128&g=1", "display_name": "Shyllenno", "link": "https://stackoverflow.com/users/10494926/shyllenno"}, "reply_to_user": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 0, "creation_date": 1539805082, "post_id": 52860150, "comment_id": 92639182, "body": "Hi Ahmed AU.   I did replace the &quot;EntireRow.Delete&quot; with &quot;Font.Bold = True&quot; and it changed all the selected rows, but not the entire row, only the row from column 1. So, meaning that the code works with multiple selection.  Said that, why does it not delete, likewise it changes the font property???   Could be that a problem caused by the fact that the listbox is dynamically updated?  Thanks."}, {"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 0, "creation_date": 1539827676, "post_id": 52860150, "comment_id": 92645727, "body": "After ist Deletion from bottom of the list, dynamically linked ListBox control may be getting repopulated, thus deselecting other selections. May please use Listbox.List property at init event of userform and also again after completion of deletion loop to repopulate the Listbox."}, {"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 0, "creation_date": 1539843155, "post_id": 52860150, "comment_id": 92649403, "body": "Another way to solve the problem with dynamic link, is to disable calculation before deletion loop &quot;Application.Calculation = xlCalculationManual&quot;  and again enable calculation after deletion loop  &quot;Application.Calculation = xlCalculationAutomatic&quot;. But Caution Error within the deletion loop may cause to keep excel calculation manual"}, {"owner": {"reputation": 15, "user_id": 10494926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eZAOW.jpg?s=128&g=1", "display_name": "Shyllenno", "link": "https://stackoverflow.com/users/10494926/shyllenno"}, "reply_to_user": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 0, "creation_date": 1539863004, "post_id": 52860150, "comment_id": 92659866, "body": "Good morning Ahmed AU. OMG you are a genius. It was exactly what was happening, the automatic calculation was deselecting the remaining selection after the first exclusion. Adding the codes at the beginning and at the end on the &quot;If statement when it is true&quot; solved the problem. Thank you very much for your patience and your willingness to help me out. Cheers."}], "owner": {"reputation": 15, "user_id": 10494926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eZAOW.jpg?s=128&g=1", "display_name": "Shyllenno", "link": "https://stackoverflow.com/users/10494926/shyllenno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1539808483, "creation_date": 1539795820, "last_edit_date": 1539808483, "question_id": 52860150, "link": "https://stackoverflow.com/questions/52860150/deleting-rows-from-a-listbox-range-multiselection-vba-deletes-only-the-last-row", "title": "Deleting rows from a ListBox range multiselection VBA, deletes only the last row", "body": "<p>I really looked up to find a answer before asking here, but I couldn't find a solution.</p>\n\n<p>I'm new at VBA, I did my best but I couldn't figure it out, I've tried arrays, with and so on, and I couldn't, so if the answer for my question has been already answered in another post, pardon me, ok? I couldn't find, probably the heading of the question is not so clear as I've looked for...</p>\n\n<p>So, I am trying to delete certain rows after an user had selected them from a listbox, but the code only deletes the last row in that range selected.</p>\n\n<p>Please, help me out. Thank you all.</p>\n\n<p>My code is:</p>\n\n<pre><code>Private Sub cmdBDGDeleteExpense_Click()\n\nDim UserAnswer As Long\nDim i As Long\n\nUserAnswer = MsgBox(\"Are you sure you would like to delete this expense?\", vbCritical + vbYesNo + vbDefaultButton2, \"Delete Expense\")\n\nIf UserAnswer = 6 Then\n    For i = lbxBDGExpensesHistory.ListCount - 1 To 0 Step -1\n        If lbxBDGExpensesHistory.Selected(i) Then\n            Worksheets(\"expenses_history\").Cells(lbxBDGExpensesHistory.ListCount - (lbxBDGExpensesHistory.ListCount - i) + 2, 1).EntireRow.Delete\n        End If\n    Next i\nElse\n    MsgBox \"Nothing was deleted!\"\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "string"], "comments": [{"owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "edited": false, "score": 0, "creation_date": 1539795742, "post_id": 52859870, "comment_id": 92634775, "body": "Can you explain what you mean by &quot;doesn&#39;t work&quot;? Tell us what are you expecting and what occurs that you didn&#39;t expect. Perhaps add examples of <code>strSubject</code> that don&#39;t work."}, {"owner": {"reputation": 53, "user_id": 10486971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a4aa35d576e31b5fd2603664b268f98?s=128&d=identicon&r=PG&f=1", "display_name": "Sharon", "link": "https://stackoverflow.com/users/10486971/sharon"}, "reply_to_user": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "edited": false, "score": 0, "creation_date": 1539795873, "post_id": 52859870, "comment_id": 92634827, "body": "By doesn&#39;t work  i meant it doesn&#39;t finds the FOR REVIEW in the subject line. It would find only stuff after the word REVIEW."}], "answers": [{"tags": [], "owner": {"reputation": 110, "user_id": 8676713, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/95724206c280d2070460f995332e8788?s=128&d=identicon&r=PG&f=1", "display_name": "yossup", "link": "https://stackoverflow.com/users/8676713/yossup"}, "is_accepted": false, "score": 0, "last_activity_date": 1539795277, "creation_date": 1539795277, "answer_id": 52859989, "question_id": 52859870, "link": "https://stackoverflow.com/questions/52859870/how-to-find-two-words-in-the-subject-line-of-email-in-vba/52859989#52859989", "title": "How to find two words in the subject line of email in vba?", "body": "<p>try:</p>\n\n<pre><code>  \"*\" \"FOR REVIEW\" \"*\"\n</code></pre>\n\n<p>instead of </p>\n\n<pre><code>\"FOR REVIEW*\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 53, "user_id": 10486971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a4aa35d576e31b5fd2603664b268f98?s=128&d=identicon&r=PG&f=1", "display_name": "Sharon", "link": "https://stackoverflow.com/users/10486971/sharon"}, "is_accepted": true, "score": 0, "last_activity_date": 1539795757, "creation_date": 1539795757, "answer_id": 52860131, "question_id": 52859870, "link": "https://stackoverflow.com/questions/52859870/how-to-find-two-words-in-the-subject-line-of-email-in-vba/52860131#52860131", "title": "How to find two words in the subject line of email in vba?", "body": "<p>Changed </p>\n\n<pre><code>strSubject = Item.Subject\n     If (Trim(strSubject)) Like \"FOR REVIEW*\" Then\n</code></pre>\n\n<p>To</p>\n\n<pre><code>Item.Subject LIKE \"*For Review*\"\n</code></pre>\n\n<p>So it finds the words.I removed TRIM function.</p>\n"}], "owner": {"reputation": 53, "user_id": 10486971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a4aa35d576e31b5fd2603664b268f98?s=128&d=identicon&r=PG&f=1", "display_name": "Sharon", "link": "https://stackoverflow.com/users/10486971/sharon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 52860131, "answer_count": 2, "score": 1, "last_activity_date": 1592783506, "creation_date": 1539794843, "last_edit_date": 1592783506, "question_id": 52859870, "link": "https://stackoverflow.com/questions/52859870/how-to-find-two-words-in-the-subject-line-of-email-in-vba", "title": "How to find two words in the subject line of email in vba?", "body": "<pre><code>Private Sub Application_ItemSend(ByVal Item As Object, Cancel As Boolean)\nDim strSubject As String\n  strSubject = Item.Subject\n     If (Trim(strSubject)) Like \"FOR REVIEW*\" Then\n         Prompt$ = \"Please do xyz\"\n       If MsgBox(Prompt$, vbYesNo + vbQuestion + vbMsgBoxSetForeground, \"Review Subject Line\") = vbNo Then\n        Cancel = True\n      End If\n    End If\nEnd Sub\n</code></pre>\n\n<ol>\n<li><p>Need to find FOR REVIEW anywhere in the subject .</p>\n\n<p>note: * FOR REVIEW * doesn't works !!</p></li>\n<li><p>Need to change the button NO to 'Go back'.\nreplacing No with Goback didn't work !!</p></li>\n</ol>\n"}, {"tags": ["excel", "vba", "copy-paste", "named-ranges"], "comments": [{"owner": {"reputation": 1, "user_id": 10519510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf916a7c9bdaaefb9f87e94c94b1f8e3?s=128&d=identicon&r=PG&f=1", "display_name": "ArityforClarity", "link": "https://stackoverflow.com/users/10519510/arityforclarity"}, "edited": false, "score": 0, "creation_date": 1539794545, "post_id": 52859645, "comment_id": 92634238, "body": "UPDATE: In one of the files from which the source data is being taken from, I created a range that is linked to the data that I was originally extracting, but the linked test range was made to be contiguous regarding the four columns. After redefining the named range to reference the test range, the function worked correctly. Still hoping for a solution aside from creating custom, contiguous ranges in each of the 30 reference files."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1539794627, "post_id": 52859645, "comment_id": 92634276, "body": "You can&#39;t perform a direct assignment of values using ranges which aren&#39;t contiguous."}, {"owner": {"reputation": 1, "user_id": 10519510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf916a7c9bdaaefb9f87e94c94b1f8e3?s=128&d=identicon&r=PG&f=1", "display_name": "ArityforClarity", "link": "https://stackoverflow.com/users/10519510/arityforclarity"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1539794677, "post_id": 52859645, "comment_id": 92634297, "body": "Thanks for the reply Tim, I have stepped through the code and have observed that the newly opened workbook source ranges are intact and not experiencing any issues."}, {"owner": {"reputation": 1, "user_id": 10519510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf916a7c9bdaaefb9f87e94c94b1f8e3?s=128&d=identicon&r=PG&f=1", "display_name": "ArityforClarity", "link": "https://stackoverflow.com/users/10519510/arityforclarity"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1539794769, "post_id": 52859645, "comment_id": 92634333, "body": "Just out of curiosity, any idea as to why the copy paste function can operate on non contiguous ranges?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1539794920, "post_id": 52859645, "comment_id": 92634406, "body": "It&#39;s a different operation, and has different rules."}], "owner": {"reputation": 1, "user_id": 10519510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf916a7c9bdaaefb9f87e94c94b1f8e3?s=128&d=identicon&r=PG&f=1", "display_name": "ArityforClarity", "link": "https://stackoverflow.com/users/10519510/arityforclarity"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1546729362, "creation_date": 1539793989, "last_edit_date": 1546729362, "question_id": 52859645, "link": "https://stackoverflow.com/questions/52859645/vba-range-method-for-copy-paste-resulting-in-n-a", "title": "VBA .range method for copy/paste resulting in #N/A", "body": "<p>Currently I have a macro which, using a control file, cycles through a list of external files performing the following processes:</p>\n\n<ul>\n<li>opens file</li>\n<li>inserts two variables from the control file</li>\n<li>allows the external, newly opened file to calculate based on the inserted variables</li>\n<li>extracts several ranges of data from the opened files, bringing them back to specified ranges in the control file</li>\n</ul>\n\n<p>Due to the number of files being opened (30), and the somewhat large nature of said files (on average 15k KB), I have been attempting to optimize the script.</p>\n\n<p>Currently, I am replacing all use of the clipboard (copy/paste) with the .range method, wherein a source range is equated to a destination range. This is working on several of the items, but I am running into an issue on a particular range that needs to be moved to the control file.</p>\n\n<p>The range moves correctly from source to destination, but the fourth column of data in the range that is moving results in #N/A once arrived at the destination. The source data is all formula driven (vs hard coded data), so it seems odd that only the 4th column is experiencing the issue. The only thing that is different about this 4th column is that it is non-contiguous with the first three columns, but is the 4th column of the named range.</p>\n\n<p>This is the particular piece of code that is resulting the #N/A:</p>\n\n<pre><code>**Workbooks(Control_File).Sheets(Project).Range(ProjRange).Value = \nWorkbooks(Open_ES).Sheets(\"Sale Refi Dist. Template\").Range(Project &amp; \n\"_Tranche_1\").Value**\n</code></pre>\n\n<p>Below is the full script:</p>\n\n<pre><code>Sub NAV_Waterfalls()\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\n\nAs_Of_Date = Range(\"As_Of_Date\")\nControl_File = Range(\"Control_File_Name\")\n\n\nSet Project_Rng = Range(\"Project_Range\")\nDim cell As Range\nDim FPath As String\n\n\nZ = Range(\"Project_Range\").Rows.Count\n\nFor Each cell In Project_Rng\n\nWorkbooks(Control_File).Sheets(\"Asset Control - NAV\").Activate\nProject = cell\n\nFPath = Range(Project &amp; \"_FilePath\")\nOpen_ES = Project &amp; \" - Equity\"\nNAV = Range(Project &amp; \"_NAV\")\n\nDim book As Workbook\nSet book = Workbooks.Open(FPath, 2, ReadOnly:=True)\n\n\n'Delete last run data\nWorkbooks(Control_File).Sheets(Project).Activate\nRows(\"7:500\").Select\nSelection.ClearContents\n\n'Insert Date\nWorkbooks(Control_File).Activate\nWorkbooks(Control_File).Sheets(\"Asset Control - \nNAV\").Range(\"As_of_Date\").Copy Workbooks(Open_ES).Sheets(\"Sale Refi Dist. \nTemplate\").Range(Project &amp; \"_Date_Input\")\n\n\n'Insert Project NAV\nWorkbooks(Control_File).Activate\nWorkbooks(Control_File).Sheets(\"Asset Control - NAV\").Range(Project &amp; \n\"_NAV\").Copy Workbooks(Open_ES).Sheets(\"Sale Refi Dist. \nTemplate\").Range(Project &amp; \"_NAV_Input\")\n\n\n\n'Tranche 1\nOn Error Resume Next\n\nWith Workbooks(Open_ES).Sheets(\"Sale Refi Dist. Template\").Range(Project &amp; \n\"_Tranche_1\")\nTranche_Rows = .Rows.Count\nTranche_Cols = 4\nEnd With\n\nWorkbooks(Control_File).Sheets(Project).Activate\nRange(\"A\" &amp; Cells.Rows.Count).End(xlUp).Select\nActiveCell.Offset(1).Select.Activate\n\nStartRow = ActiveCell.Row\nLastrow = Tranche_Rows\nLet ProjRange = \"A\" &amp; StartRow &amp; \":\" &amp; \"D\" &amp; StartRow + Lastrow - 1\n\n\n\n**Workbooks(Control_File).Sheets(Project).Range(ProjRange).Value = \nWorkbooks(Open_ES).Sheets(\"Sale Refi Dist. Template\").Range(Project &amp; \n\"_Tranche_1\").Value**\n\nApplication.CutCopyMode = False\n\nWorkbooks(Open_ES).Close SaveChanges:=False\nWorkbooks(Control_File).Save\n\nNext\nApplication.ScreenUpdating = True\nApplication.DisplayAlerts = True\nEnd Sub\n</code></pre>\n\n<p>The actual script has portions that repeat the section labelled \"Tranche 1\" for additional tranches, but will likely be re-wrote into a loop for all tranches, so I have excluded this piece. </p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1539793802, "post_id": 52859498, "comment_id": 92633868, "body": "Can you share an URL? Can you share the page code? What actions on the page make this drop down appear? The user will be interacting with the drop down anyway so why the need to have the drop down expanded? If your site, change to radio buttons/check boxes."}, {"owner": {"reputation": 1, "user_id": 6610261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1dd18666835f65f784da0014bfe689a?s=128&d=identicon&r=PG&f=1", "display_name": "DJB", "link": "https://stackoverflow.com/users/6610261/djb"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1540031649, "post_id": 52859498, "comment_id": 92720336, "body": "Thanks for response QHarr. the url is not available out side of organization.any general/public website solution also is fine for me if we can achieve this action. please advise"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1540031804, "post_id": 52859498, "comment_id": 92720377, "body": "Without seeing the page I don&#39;t know what to advise. Normally .Click on the Select tag element suffices. Sometimes you need a FireEvent or combination of FireEvents."}, {"owner": {"reputation": 1, "user_id": 6610261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1dd18666835f65f784da0014bfe689a?s=128&d=identicon&r=PG&f=1", "display_name": "DJB", "link": "https://stackoverflow.com/users/6610261/djb"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1540032413, "post_id": 52859498, "comment_id": 92720524, "body": "Thanks QHarr. i tried even with fire event options. still i am unable to do this action. I tried even with gmail application. still i had the same trouble in showing up the drop down options on page. so you can try with any public website to see the trouble in acheiving this."}], "owner": {"reputation": 1, "user_id": 6610261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1dd18666835f65f784da0014bfe689a?s=128&d=identicon&r=PG&f=1", "display_name": "DJB", "link": "https://stackoverflow.com/users/6610261/djb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 17, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1539793458, "creation_date": 1539793458, "question_id": 52859498, "link": "https://stackoverflow.com/questions/52859498/vba-ie-automation-show-drop-down-list-options-in-web-page", "title": "vba IE automation Show drop down list options in web page", "body": "<p>i want to click on the object dropdownlist (select tag) in webpage and wants to show the options available to the user. But when i perform click / fireevent(\"onlick\"), the object is getting clicked but the dorp down is not expanding with the available options. (I dont want to select the value, but i want to show the avilable options in dropdown to user). I have already tried the follwing options</p>\n\n<pre><code>object.click\nobject.fireevent(\"onclick\")\nobject.fireevent(\"onmousedown\")\nobject.fireevent(\"onmouseup\")\nobject.fireevent(\"ondblclick\"). \n</code></pre>\n\n<p>But nothing is worked. please advise on how can i achieve this action</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 7, "creation_date": 1539793210, "post_id": 52859408, "comment_id": 92633539, "body": "You need to use <code>Set</code>."}, {"owner": {"reputation": 627, "user_id": 3075813, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/6939855d9ee7a37afc7f8517d5db2a02?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Erickson", "link": "https://stackoverflow.com/users/3075813/joseph-erickson"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1539793341, "post_id": 52859408, "comment_id": 92633607, "body": "Thanks for the catch...I&#39;ve forgotten about the set / object rule too many times. Thanks."}], "owner": {"reputation": 627, "user_id": 3075813, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/6939855d9ee7a37afc7f8517d5db2a02?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Erickson", "link": "https://stackoverflow.com/users/3075813/joseph-erickson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1591532103, "creation_date": 1539793121, "last_edit_date": 1591532103, "question_id": 52859408, "link": "https://stackoverflow.com/questions/52859408/why-cant-a-collection-be-inserted-into-an-array", "title": "Why can&#39;t a collection be inserted into an array", "body": "<p>Confused why, when attempting to add a collection to an array, I get runtime error 450, <code>wrong number of arguments or invalid property assignment</code></p>\n\n<p>Does VBA not allow this activity? Or is different syntax required?</p>\n\n<pre><code>Sub collectionTest()\n\n    Dim x As New Collection\n    x.Add (\"Hello\")\n\n    Dim someArr(0 To 0) As Variant\n    someArr(0) = x\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1539793063, "post_id": 52859358, "comment_id": 92633464, "body": "I suspect you&#39;d see the same thing with any data type that can be formatted."}, {"owner": {"reputation": 968, "user_id": 5910169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a40180e3fa49fbf4e55145adf54d9?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Ball", "link": "https://stackoverflow.com/users/5910169/frank-ball"}, "edited": false, "score": 1, "creation_date": 1539796271, "post_id": 52859358, "comment_id": 92635011, "body": "Characters.Count is a function that is datatype specific.  While numbers look like text, they really aren&#39;t until you cast them as such.  What you&#39;re asking for would be similar to a function that asked for &quot;&#39;Bob&#39; + 1&quot;, since &#39;Bob&#39; is text, you can&#39;t add to it."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 968, "user_id": 5910169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a40180e3fa49fbf4e55145adf54d9?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Ball", "link": "https://stackoverflow.com/users/5910169/frank-ball"}, "edited": false, "score": 0, "creation_date": 1539796634, "post_id": 52859358, "comment_id": 92635207, "body": "@FrankBall - I see. Indeed, if I add <code>Range(&quot;A1&quot;).NumberFormat = &quot;@&quot;</code> on the error case it works quite well. However, I was hoping to see some kind of documentation, but probably this is a too general case... I guess."}, {"owner": {"reputation": 968, "user_id": 5910169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a40180e3fa49fbf4e55145adf54d9?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Ball", "link": "https://stackoverflow.com/users/5910169/frank-ball"}, "edited": false, "score": 0, "creation_date": 1539797004, "post_id": 52859358, "comment_id": 92635366, "body": "<a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/data-type-summary\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/language/reference/&hellip;</a>"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 968, "user_id": 5910169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a40180e3fa49fbf4e55145adf54d9?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Ball", "link": "https://stackoverflow.com/users/5910169/frank-ball"}, "edited": false, "score": 0, "creation_date": 1539800378, "post_id": 52859358, "comment_id": 92636991, "body": "@FrankBall - well this is documentation for the data types? I hoped for documentation, saying that <code>Characters.Count</code> property throws an error when we pass numeric value and runs ok when it is String. Somehow could not find anything here - <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.characters.count\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/api/excel.characters.cou&zwnj;&#8203;nt</a>"}, {"owner": {"reputation": 968, "user_id": 5910169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a40180e3fa49fbf4e55145adf54d9?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Ball", "link": "https://stackoverflow.com/users/5910169/frank-ball"}, "edited": false, "score": 0, "creation_date": 1539812523, "post_id": 52859358, "comment_id": 92642334, "body": "This is the MS documentation on the function:  <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.characters.count\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/api/excel.characters.cou&zwnj;&#8203;nt</a> and this is the documentation for the Characters object: <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.characters\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/api/excel.characters</a>.  This is most likely the best that you&#39;ll find."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 968, "user_id": 5910169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a40180e3fa49fbf4e55145adf54d9?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Ball", "link": "https://stackoverflow.com/users/5910169/frank-ball"}, "edited": false, "score": 0, "creation_date": 1539847742, "post_id": 52859358, "comment_id": 92651532, "body": "@FrankBall - thanks for the links and the efforts, but somehow they are not very explicit on the type value (like not at all)."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1546366142, "post_id": 52859358, "comment_id": 94832687, "body": "Late reply, maybe helpful :-; The first paragraph in the help docu states: <i>&quot;&#39;   Returns a Characters object that represents a range of characters \u25bawithin the object \u25batext\u25c4. &#39;   You can use the Characters object to format characters \u25bawithin a text string\u25c4.&quot;</i> So implicitly you are always referring to the <code>Range</code> object allowing text content only (c.f. also Syntax definition)."}], "answers": [{"tags": [], "owner": {"reputation": 2299, "user_id": 4361999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/7BvMf.jpg?s=128&g=1", "display_name": "JMP", "link": "https://stackoverflow.com/users/4361999/jmp"}, "is_accepted": false, "score": 0, "last_activity_date": 1591538275, "creation_date": 1591538275, "answer_id": 62246413, "question_id": 52859358, "link": "https://stackoverflow.com/questions/52859358/why-characters-count-property-fails-when-the-cell-value-is-numeric/62246413#62246413", "title": "Why Characters.Count Property fails When the Cell Value is Numeric?", "body": "<p>Your first example causes <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/isnumeric-function\" rel=\"nofollow noreferrer\"><code>IsNumeric()</code></a> to return true, and so it is treated as a number and not as text, which the Characters property requires.</p>\n\n<pre><code>Cells(1, 1) = \"123.4\"\nDebug.Print IsNumeric(Cells(1, 1)) ' returns true\n\nCells(1, 1) = \"123a\"\nDebug.Print IsNumeric(Cells(1, 1)) ' returns false\n</code></pre>\n"}], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 291, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1591538275, "creation_date": 1539792953, "last_edit_date": 1591532117, "question_id": 52859358, "link": "https://stackoverflow.com/questions/52859358/why-characters-count-property-fails-when-the-cell-value-is-numeric", "title": "Why Characters.Count Property fails When the Cell Value is Numeric?", "body": "<p>Trying the code:</p>\n\n<pre><code>n = Worksheets(\"Sheet1\").Range(\"A1\").Characters.Count \nWorksheets(\"Sheet1\").Range(\"A1\") _ \n .Characters(n, 1).Font.Superscript = True\n</code></pre>\n\n<p>from <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.font.superscript\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/api/excel.font.superscript</a></p>\n\n<p>I have noticed that it fails with numeric value in <code>A1</code>.\nThus, after some research, I have found that it works with strings and fails if we write completely numeric value in A1:</p>\n\n<pre><code>Sub TestMe()\n\n    Dim a As Variant\n    Range(\"A1\") = \"2\"\n    a = Array(Range(\"A1\").Characters)\n    Debug.Print a(0).Count\n\nEnd Sub\n</code></pre>\n\n<p>Obviously there is an error because of the <em>Unable to get the Count property of the Characters class</em>, as displayed in the local window:</p>\n\n<p><a href=\"https://i.stack.imgur.com/7Typk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7Typk.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p>Of course, if there is a value in A1, which cannot be parsed to numeric, then everthing is ok:</p>\n\n<pre><code>Sub TestMe()\n\n    Dim a As Variant\n    Range(\"A1\") = \"a34\"\n    a = Array(Range(\"A1\").Characters)\n    Debug.Print a(0).Count\n\nEnd Sub\n</code></pre>\n\n<p>Produces this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/EFtr7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EFtr7.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>The question:</strong> Is there some documentation about this which explains the reason for this errors, or this is a hidden \"feature\", or some kind of internal Excel optimization, parsing numeric values to numbers? Or the Remark in the documentation that Characters is not a collection means exactly this?</p>\n\n<ul>\n<li><a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.characters\" rel=\"nofollow noreferrer\">Range.Characters Documentation</a></li>\n</ul>\n"}, {"tags": ["excel", "vba", "thunderbird"], "answers": [{"tags": [], "owner": {"reputation": 2524, "user_id": 2705042, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/ShRFK.jpg?s=128&g=1", "display_name": "spinjector", "link": "https://stackoverflow.com/users/2705042/spinjector"}, "is_accepted": false, "score": 0, "last_activity_date": 1539792432, "creation_date": 1539792432, "answer_id": 52859214, "question_id": 52858803, "link": "https://stackoverflow.com/questions/52858803/access-to-thunderbird-address-book-abook-mab/52859214#52859214", "title": "Access to Thunderbird Address Book - abook.mab", "body": "<p>According to this documentation, the Thunderbird MAB files are in a format called \"MORK\":\n<a href=\"https://wiki.mozilla.org/Address_Book\" rel=\"nofollow noreferrer\">https://wiki.mozilla.org/Address_Book</a></p>\n\n<p>Here is info on the MORK format, with some links to Python scripts and other code which you may be able to deconstruct and convert to VBA:\n<a href=\"https://wiki.mozilla.org/Mork\" rel=\"nofollow noreferrer\">https://wiki.mozilla.org/Mork</a> </p>\n"}], "owner": {"reputation": 3, "user_id": 9632809, "user_type": "registered", "profile_image": "https://graph.facebook.com/2056597644370116/picture?type=large", "display_name": "Jairo Manuel Mart&#237;nez Hdz", "link": "https://stackoverflow.com/users/9632809/jairo-manuel-mart%c3%adnez-hdz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 303, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1591532142, "creation_date": 1539791089, "last_edit_date": 1591532142, "question_id": 52858803, "link": "https://stackoverflow.com/questions/52858803/access-to-thunderbird-address-book-abook-mab", "title": "Access to Thunderbird Address Book - abook.mab", "body": "<p>I have an Excel VBA macro where I send emails using Thunderbird. I would like to know if there's a way to access Thunderbird's address book so that I could search an email adress from a textbox. Is this possible?</p>\n"}, {"tags": ["excel", "vba", "date", "format"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1539791092, "post_id": 52858777, "comment_id": 92632452, "body": "You never declare <code>ano</code>, so so that&#39;s why you always have <code>-</code> at the start.  Can you provide an example of the input?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1539791750, "post_id": 52858777, "comment_id": 92632758, "body": "Does this not do what you want? <code>format(&quot;01&#47;12&#47;2019&quot;,&quot;yyyy-mm-dd&quot;)</code>"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1539791938, "post_id": 52858777, "comment_id": 92632860, "body": "If @Nathan_Sav&#39;s suggestion doesn&#39;t work, then include a <code>CDate</code> to explicitly convert Text to Date:  <code>Cells(linha, 24).Value = Format(CDate(Cells(linha, 24).Value),&quot;yyyy-mm-dd&quot;)</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1539792554, "post_id": 52858777, "comment_id": 92633171, "body": "Is <code>Cells(....).Value</code> giving you a <code>Date</code> or a <code>String</code>?"}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "edited": false, "score": 0, "creation_date": 1539793853, "post_id": 52858777, "comment_id": 92633893, "body": "I think that you have made a mistake trying to extract ano variable from the string you extract date parts.could you post the whole string?"}], "owner": {"reputation": 31, "user_id": 7243162, "user_type": "registered", "profile_image": "https://graph.facebook.com/1311729748840274/picture?type=large", "display_name": "Rui Pereira Pereira", "link": "https://stackoverflow.com/users/7243162/rui-pereira-pereira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 306, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1539883137, "creation_date": 1539790968, "last_edit_date": 1539791947, "question_id": 52858777, "link": "https://stackoverflow.com/questions/52858777/vba-excel-how-do-i-convert-date-strings-from-dd-mm-yyyy-to-yyyy-mm-dd", "title": "VBA Excel - How do i convert Date Strings from dd/mm/yyyy to yyyy-mm-dd?", "body": "<p>I'm new to this... I'm having problems converting date strings in Excel. Can anybody help me?</p>\n\n<p>Instead of converting, I'm getting something like this:   -/2-13/06/2017</p>\n\n<p>Thanks in advance!</p>\n\n<pre><code>Sub muda_datas()\n    For linha = 3 To 479\n    MsgBox Cells(linha, 24).Value\n        dia = Cells(linha, 24).Value\n        mes = Mid(Cells(linha, 24).Value, 6, 2)\n        Cells(linha, 24).Value = ano &amp; \"-\" &amp; mes &amp; \"-\" &amp; dia\n    Next linha\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1539792147, "post_id": 52858503, "comment_id": 92632961, "body": "I don&#39;t think I understand what this means: &quot;find the four columns that correspond to the value in either the seventh or eight row&quot;."}, {"owner": {"reputation": 1, "user_id": 10519325, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-EmnvI6wRe38/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWmpX7VPtgMFthKwsW93I1oeyAsPQ/mo/photo.jpg?sz=128", "display_name": "KarlD777", "link": "https://stackoverflow.com/users/10519325/karld777"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1539792939, "post_id": 52858503, "comment_id": 92633398, "body": "Basically, rows 1 through 8 will have the same four column header that will repeat through the spreadsheet.  I&#39;ve included a screenshot of an example: <a href=\"https://i.stack.imgur.com/IdEZF.png\" rel=\"nofollow noreferrer\">i.stack.imgur.com/IdEZF.png</a>  In this example, I want the macro to reference the value that would be in row 8 then post in the four columns under that refence (such as D through G, I through L, etc)."}, {"owner": {"reputation": 5038, "user_id": 4552529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7dff9245051269e55748c81670088e8?s=128&d=identicon&r=PG&f=1", "display_name": "Wizhi", "link": "https://stackoverflow.com/users/4552529/wizhi"}, "edited": false, "score": 0, "creation_date": 1539806518, "post_id": 52858503, "comment_id": 92639833, "body": "Try also to give an example of final output... still to unclear :("}, {"owner": {"reputation": 1, "user_id": 10519325, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-EmnvI6wRe38/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWmpX7VPtgMFthKwsW93I1oeyAsPQ/mo/photo.jpg?sz=128", "display_name": "KarlD777", "link": "https://stackoverflow.com/users/10519325/karld777"}, "edited": false, "score": 0, "creation_date": 1539807660, "post_id": 52858503, "comment_id": 92640338, "body": "I am not allowed to embed pictures in my posts yet but here are links to the inputs and the outputs.  Note that the input was entered on the first tab (data), the macro was run, and based on the text on line 8 it was pasted either under &quot;Example&quot; or &quot;Example 2&quot;.    [3]: <a href=\"https://i.stack.imgur.com/wZIca.png\" rel=\"nofollow noreferrer\">i.stack.imgur.com/wZIca.png</a>    [4]: <a href=\"https://i.stack.imgur.com/cJ1zS.png\" rel=\"nofollow noreferrer\">i.stack.imgur.com/cJ1zS.png</a>    [5]: <a href=\"https://i.stack.imgur.com/GAj8b.png\" rel=\"nofollow noreferrer\">i.stack.imgur.com/GAj8b.png</a>    [6]: <a href=\"https://i.stack.imgur.com/ZuDif.png\" rel=\"nofollow noreferrer\">i.stack.imgur.com/ZuDif.png</a>"}], "owner": {"reputation": 1, "user_id": 10519325, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-EmnvI6wRe38/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWmpX7VPtgMFthKwsW93I1oeyAsPQ/mo/photo.jpg?sz=128", "display_name": "KarlD777", "link": "https://stackoverflow.com/users/10519325/karld777"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1591532167, "creation_date": 1539790082, "last_edit_date": 1591532167, "question_id": 52858503, "link": "https://stackoverflow.com/questions/52858503/macro-that-copies-from-one-tab-and-pastes-in-a-different-tab-based-on-a-match-of", "title": "Macro that copies from one tab and pastes in a different tab based on a match of a cell", "body": "<p>I am trying to expand upon a worksheet and require assistance.</p>\n\n<p>Currently I have the following macro set up to copy from one sheet range and paste to another sheet:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim Rng1 As Range\nDim Rng2 As Range\n\nSet Rng1 = Range(\"D12:G253\")\nSet Rng2 = Range(\"D12:G253\")\nRng2.Value = Rng1.Value\n\n\nDim xlws1 As Worksheet\nDim xlws2 As Worksheet\n\nSet xlws1 = Worksheets(\"Data\")\nSet Rng1 = xlws1.Range(\"d12:g253\")\n\nSet xlws2 = Worksheets(\"Final\")\nSet Rng2 = xlws2.Range(\"D12:g253\")\nRng2.Value = Rng1.Value\n</code></pre>\n\n<p>However, now I would like the data pasted to be dynamic and not always land in \"D12:G253\" but instead find the four columns that correspond to the value in either the seventh or eight row.  I have descriptions set up in the first three columns that I will stay and not need to be copied and I have headers in the first 11 rows that will not need to change either.</p>\n\n<p>I've tried following these posts <a href=\"https://stackoverflow.com/questions/28316086/macro-to-copy-range-and-paste-based-on-cell-value#\">Post 1</a> <a href=\"https://stackoverflow.com/questions/23218923/macro-with-match-or-if-then-copy-into-a-new-tab\">Post 2</a> but cannot follow completely due to my lack of coding knowledge.</p>\n\n<p>Please help me so I can expand.</p>\n\n<p><a href=\"https://i.stack.imgur.com/IdEZF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IdEZF.png\" alt=\"Screenshot of example worksheet\"></a></p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1539790315, "post_id": 52858463, "comment_id": 92632026, "body": "Looking at the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/outlook.recipients.remove\" rel=\"nofollow noreferrer\">doc</a>, Remove does seems to only accept a Long index, not a String."}, {"owner": {"reputation": 43, "user_id": 4459366, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-YsQ5OEnnMKM/AAAAAAAAAAI/AAAAAAAAg0M/Hh3kOB73RDQ/photo.jpg?sz=128", "display_name": "Pyrometheous", "link": "https://stackoverflow.com/users/4459366/pyrometheous"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1539790592, "post_id": 52858463, "comment_id": 92632189, "body": "Yeah, I found that too, I&#39;m just not familiar with how to use an index in an outlook macro."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1539790636, "post_id": 52858463, "comment_id": 92632205, "body": "You can use a <code>For</code> loop to locate and remove the recipient."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1539790837, "post_id": 52858463, "comment_id": 92632323, "body": "There is also a <a href=\"https://docs.microsoft.com/en-us/office/vba/api/outlook.recipient.delete\" rel=\"nofollow noreferrer\">Recipient.Delete</a> Method, not sure if it could work."}, {"owner": {"reputation": 43, "user_id": 4459366, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-YsQ5OEnnMKM/AAAAAAAAAAI/AAAAAAAAg0M/Hh3kOB73RDQ/photo.jpg?sz=128", "display_name": "Pyrometheous", "link": "https://stackoverflow.com/users/4459366/pyrometheous"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1539802273, "post_id": 52858463, "comment_id": 92637920, "body": "I can&#39;t figure out how to use those methods. It&#39;s driving me crazy that I can&#39;t figure this out. Microsoft&#39;s documentation doesn&#39;t outright say how to use it, it just says that they are methods for &quot;Recipient&quot; or &quot;Recipients&quot;, but doesn&#39;t show an example or anything. I&#39;m also having trouble figuring out &quot;Long&quot; and &quot;Index&quot;. Do you have any articles you could suggest on a place to start reading up on it?"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 4459366, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-YsQ5OEnnMKM/AAAAAAAAAAI/AAAAAAAAg0M/Hh3kOB73RDQ/photo.jpg?sz=128", "display_name": "Pyrometheous", "link": "https://stackoverflow.com/users/4459366/pyrometheous"}, "edited": false, "score": 0, "creation_date": 1539791538, "post_id": 52858695, "comment_id": 92632660, "body": "I&#39;ll mess around with using a &quot;for&quot; loop in about an hour or so, I&#39;ve got a couple meetings scheduled coming up in a few minutes.   I don&#39;t think I&#39;ve done loops in an Outlook macro yet, so this should be fun to learn. Thank you for the suggestion. I&#39;ll update you once I&#39;ve had the opportunity to try it."}, {"owner": {"reputation": 43, "user_id": 4459366, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-YsQ5OEnnMKM/AAAAAAAAAAI/AAAAAAAAg0M/Hh3kOB73RDQ/photo.jpg?sz=128", "display_name": "Pyrometheous", "link": "https://stackoverflow.com/users/4459366/pyrometheous"}, "edited": false, "score": 0, "creation_date": 1539800868, "post_id": 52858695, "comment_id": 92637227, "body": "I&#39;m having a really hard time figuring this out, earlier I found something that explained the index and creating a list (I think), but I accidentally closed a bunch of tabs and lost the page. Can you direct me to an article that explains &quot;Index&quot; and &quot;long&quot;?"}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1539790691, "creation_date": 1539790691, "answer_id": 52858695, "question_id": 52858463, "link": "https://stackoverflow.com/questions/52858463/remove-a-recipient-in-a-reply-all/52858695#52858695", "title": "Remove a Recipient in a &quot;Reply All&quot;", "body": "<p>Loop through the recipients using a \"for\" loop from Count down to 1, check the <code>Recipient.Address</code> property. If it matches the value you are after, call <code>Recipients.Remove</code> passing the current loop index.</p>\n"}, {"comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1539863146, "post_id": 52868156, "comment_id": 92659933, "body": "Not a problem if only one item is processed but it is safer to count down when reducing a collection with delete or move. <a href=\"https://stackoverflow.com/questions/10725068/for-each-loop-some-items-get-skipped-when-looping-through-outlook-mailbox-to-de\" title=\"for each loop some items get skipped when looping through outlook mailbox to de\">stackoverflow.com/questions/10725068/&hellip;</a>"}, {"owner": {"reputation": 43, "user_id": 4459366, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-YsQ5OEnnMKM/AAAAAAAAAAI/AAAAAAAAg0M/Hh3kOB73RDQ/photo.jpg?sz=128", "display_name": "Pyrometheous", "link": "https://stackoverflow.com/users/4459366/pyrometheous"}, "edited": false, "score": 0, "creation_date": 1539874160, "post_id": 52868156, "comment_id": 92666932, "body": "I&#39;ve been messing around with this a bit and I&#39;m getting a Compile Error <code>Expected: variable</code>. Messing around more with it I thought I had it working correctly, but it ended up removing all recipients and adding the extra recipient I needed.   I&#39;m pretty sure my problem is here   <code>For Each Address In EmailAddressGoesHere</code>   I&#39;ve tried different ways of putting in the email address, but get errors every time."}, {"owner": {"reputation": 828, "user_id": 10252988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/047bac7a125b9725dc9a257f8f0e0266?s=128&d=identicon&r=PG&f=1", "display_name": "Alina Li", "link": "https://stackoverflow.com/users/10252988/alina-li"}, "edited": false, "score": 0, "creation_date": 1539913445, "post_id": 52868156, "comment_id": 92682666, "body": "EmailAddressGoesHere must be a variable with a type that&#39;s a collection type or Object. Refers to the collection over which the statements are to be repeated. Please refer to this link: <a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/statements/for-each-next-statement\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/dotnet/visual-basic/language-refere&zwnj;&#8203;nce/&hellip;</a>"}], "tags": [], "owner": {"reputation": 828, "user_id": 10252988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/047bac7a125b9725dc9a257f8f0e0266?s=128&d=identicon&r=PG&f=1", "display_name": "Alina Li", "link": "https://stackoverflow.com/users/10252988/alina-li"}, "is_accepted": false, "score": 0, "last_activity_date": 1539849589, "last_edit_date": 1539849589, "creation_date": 1539844152, "answer_id": 52868156, "question_id": 52858463, "link": "https://stackoverflow.com/questions/52858463/remove-a-recipient-in-a-reply-all/52868156#52868156", "title": "Remove a Recipient in a &quot;Reply All&quot;", "body": "<p>As Dmitry mentioned, you could refer to the below code:</p>\n\n<pre><code>    Sub Reply_All()\n    Dim olReply As MailItem\n    Dim strSubject As String\n    For Each olItem In Application.ActiveExplorer.Selection\n    Set olReply = olItem.ReplyAll\n    For Each Address In EmailAddressGoesHere\n    olReply.Recipients.Add (Address)\n    Next\n    For Each Rec In olReply.Recipients\n        Rec.Delete\n    Next\n    strSubject = olReply.Subject\n        olReply.Subject = \"(Added Subject Line Info - ) \" &amp; strSubject\n        olReply.Display\n    Next\n    End Sub\n</code></pre>\n\n<p>For more information, please refer to this link:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/27167084/remove-recipient-from-mail-recipient-collection\">remove recipient from mail.recipient collection</a></p>\n"}, {"tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": false, "score": 0, "last_activity_date": 1539895372, "creation_date": 1539895372, "answer_id": 52882253, "question_id": 52858463, "link": "https://stackoverflow.com/questions/52858463/remove-a-recipient-in-a-reply-all/52882253#52882253", "title": "Remove a Recipient in a &quot;Reply All&quot;", "body": "<pre><code>Option Explicit\n' Consider Option Explicit mandatory\n' Tools | Options | Editor tab | Require Variable Declaration\n\nSub Reply_All_RemoveSingleOrMultipleCopiesAddress()\n\n    Dim olItem As Object\n    Dim olReply As MailItem\n\n    Dim i As Long\n\n    For Each olItem In ActiveExplorer.Selection\n\n        If olItem.Class = olMail Then\n\n            Set olReply = olItem.ReplyAll\n\n            'olReply.Display\n\n            ' If the address could occur once or multiple times,\n            '  start at the end and work backwards\n            For i = olReply.Recipients.count To 1 Step -1\n\n                'Debug.Print olReply.Recipients(i).Address\n\n                ' \"EmailAddressToBeRemoved\" with the quotes as shown\n                If LCase(olReply.Recipients(i).Address) = LCase(\"EmailAddressToBeRemoved\") Then\n                    olReply.Recipients.remove (i)\n                End If\n\n            Next\n\n            olReply.Display\n\n        End If\n\n    Next\n\nEnd Sub\n\n\nSub Reply_All_RemoveSingleAddressReliably()\n\n    Dim olItem As Object\n    Dim olReply As MailItem\n    Dim recip As recipient\n\n    For Each olItem In ActiveExplorer.Selection\n\n        If olItem.Class = olMail Then\n\n            Set olReply = olItem.ReplyAll\n\n            'olReply.Display\n\n            ' If the address can appear once only,\n            '  otherwise use a downward counting loop\n            For Each recip In olReply.Recipients\n\n                'Debug.Print recip.Address\n\n                ' \"EmailAddressToBeRemoved\" with the quotes as shown \n                If LCase(recip.Address) = LCase(\"EmailAddressToBeRemoved\") Then\n\n                    ' Delete not remove\n                    recip.Delete\n\n                    ' No need to continue if only one instance of address can occur,\n                    '  otherwise you would unreliably delete anyway.\n                    ' The address immediately after a deleted address is skipped\n                    '  as it moves into the old position of the deleted address.\n                    Exit For\n\n                End If\n\n            Next\n\n            olReply.Display\n\n        End If\n\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 14871134, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/570e9306d2da6744981da73d1eea7094?s=128&d=identicon&r=PG", "display_name": "guest90310", "link": "https://stackoverflow.com/users/14871134/guest90310"}, "is_accepted": false, "score": 0, "last_activity_date": 1608633206, "creation_date": 1608633206, "answer_id": 65407122, "question_id": 52858463, "link": "https://stackoverflow.com/questions/52858463/remove-a-recipient-in-a-reply-all/65407122#65407122", "title": "Remove a Recipient in a &quot;Reply All&quot;", "body": "<p>To whom it may concern.</p>\n<p>You can easily try a combination of the solutions offered for a quick result:</p>\n<pre><code>Set myRecipients = olReply.Recipients\n\nDim y As Long\ny = myRecipients.Count\n\nDo Until y = 0\n    If myRecipients(y) = &quot;to be removed&quot; Then\n    myRecipients(y).Delete\n    End If\n    y = y - 1\nLoop\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 4459366, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-YsQ5OEnnMKM/AAAAAAAAAAI/AAAAAAAAg0M/Hh3kOB73RDQ/photo.jpg?sz=128", "display_name": "Pyrometheous", "link": "https://stackoverflow.com/users/4459366/pyrometheous"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 944, "favorite_count": 1, "answer_count": 4, "score": 0, "last_activity_date": 1608721714, "creation_date": 1539789940, "last_edit_date": 1608721714, "question_id": 52858463, "link": "https://stackoverflow.com/questions/52858463/remove-a-recipient-in-a-reply-all", "title": "Remove a Recipient in a &quot;Reply All&quot;", "body": "<p>I'm trying to &quot;reply all&quot;, add text to the subject, add a recipient, and remove a recipient.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Reply_All()\n    Dim olReply As mailitem\n    Dim strSubject As String\n    For Each olItem In Application.ActiveExplorer.Selection\n        Set olReply = olItem.ReplyAll\n        Set olRecip = olReply.Recipients.Add(&quot;EmailAddressGoesHere&quot;)\n        Set olRecip = olReply.Recipients.Remove(&quot;EmailAddressGoesHere&quot;)\n        strSubject = olReply.Subject\n        olReply.Subject = &quot;(Added Subject Line Info - ) &quot; &amp; strSubject\n        olReply.Display\n    Next\nEnd Sub\n</code></pre>\n<p>Everything works when I comment out the <code>Recipients.Remove</code> line.</p>\n<p>I noticed that</p>\n<pre><code>Set olRecip = olReply.Recipients.Add(&quot;EmailAddressGoesHere&quot;)\n</code></pre>\n<p>has &quot;Add Name As String&quot;</p>\n<p>While</p>\n<pre><code>Set olRecip = olReply.Recipients.Remove(&quot;EmailAddressGoesHere&quot;)\n</code></pre>\n<p>has &quot;Remove Index As Long&quot; as the yellow text that comes up when you type it into the script.</p>\n"}, {"tags": ["excel", "vba", "pivot-table"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1539842546, "post_id": 52858323, "comment_id": 92649183, "body": "<i>&quot;I tried to record the macro but no success.&quot;</i> This is very meaningless. What did you record? Show the code you tried. Why <i>exactly</i> didn&#39;t that work? What did it do instead of what you expected?"}, {"owner": {"reputation": 224, "user_id": 10419493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57992f514d2fea11816e84519957ec5e?s=128&d=identicon&r=PG&f=1", "display_name": "SeT", "link": "https://stackoverflow.com/users/10419493/set"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1539852244, "post_id": 52858323, "comment_id": 92653980, "body": "Thanks for getting back to me P\u1d07\u029c and editing my post. I&#39;m quite new to this forum so thanks also for your advises.  Regarding the above query; it seems that I recorded the macro moved and my pivot table into new tab thereafter. That&#39;s why it didn&#39;t work  The good news is, I finally managed to get this working."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1539853548, "post_id": 52858323, "comment_id": 92654705, "body": "Please don&#39;t use comment for code. If it belongs to your question <a href=\"https://stackoverflow.com/posts/52858323/edit\">edit</a> the question and add it there. If it is a solution, post it as an answer and mark your own post as solution (may need to wait some time until you can vote your post)."}, {"owner": {"reputation": 224, "user_id": 10419493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57992f514d2fea11816e84519957ec5e?s=128&d=identicon&r=PG&f=1", "display_name": "SeT", "link": "https://stackoverflow.com/users/10419493/set"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1539854070, "post_id": 52858323, "comment_id": 92655026, "body": "Thanks P\u1d07\u029c. I will be able to mark this as a solution tomorrow."}], "answers": [{"tags": [], "owner": {"reputation": 224, "user_id": 10419493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57992f514d2fea11816e84519957ec5e?s=128&d=identicon&r=PG&f=1", "display_name": "SeT", "link": "https://stackoverflow.com/users/10419493/set"}, "is_accepted": true, "score": 1, "last_activity_date": 1539853844, "creation_date": 1539853844, "answer_id": 52870684, "question_id": 52858323, "link": "https://stackoverflow.com/questions/52858323/sorting-fields-and-values-in-pivot-table/52870684#52870684", "title": "Sorting Fields and Values in Pivot Table", "body": "<p>The below code worked for me:</p>\n\n<pre><code>ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"COUNTRY\").AutoSort _\n    xlDescending, \"Sum of Amount\", ActiveSheet.PivotTables(\"PivotTable1\"). _\n    PivotColumnAxis.PivotLines(3), 1\n\nActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"CITY\").AutoSort _\n    xlDescending, \"Sum of Amount\", ActiveSheet.PivotTables(\"PivotTable1\"). _\n    PivotColumnAxis.PivotLines(3), 1\n</code></pre>\n\n<p>Thanks for your help in this matter P\u1d07\u029c</p>\n"}], "owner": {"reputation": 224, "user_id": 10419493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57992f514d2fea11816e84519957ec5e?s=128&d=identicon&r=PG&f=1", "display_name": "SeT", "link": "https://stackoverflow.com/users/10419493/set"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1218, "favorite_count": 0, "accepted_answer_id": 52870684, "answer_count": 1, "score": 0, "last_activity_date": 1593677165, "creation_date": 1539789524, "last_edit_date": 1593677165, "question_id": 52858323, "link": "https://stackoverflow.com/questions/52858323/sorting-fields-and-values-in-pivot-table", "title": "Sorting Fields and Values in Pivot Table", "body": "<p>I need a little help with macro that can sort the data in the below pivot table.</p>\n\n<p>I have a macro that copies Excel ranges from a few spreadsheets, then pastes the data into destination workbooks and updates multiple pivot tables.</p>\n\n<p>Each time when I change a filter to the new month in the below pivot table, everything is sorted in the alphabetical order. As I need to change a filter on a monthly basis, I would like to ensure that the data is in the required order in this specific pivot table.</p>\n\n<p>I would like to sort the pivot table by values in descending order but always only in the 4th column (for the last month - in this case for October). It needs to be done for both - countries and cities.</p>\n\n<p><strong>Original Pivot Table:</strong>  </p>\n\n<p><a href=\"https://i.stack.imgur.com/6s2Pk.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6s2Pk.jpg\" alt=\"Original Pivot Table\"></a></p>\n\n<p><strong>Required order of the pivot table:</strong>  </p>\n\n<p><a href=\"https://i.stack.imgur.com/CmVAO.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CmVAO.jpg\" alt=\"Required order of the pivot table\"></a></p>\n\n<p>I tried to record the macro but no success.</p>\n"}, {"tags": ["excel", "vba", "string", "count"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1539789445, "post_id": 52858201, "comment_id": 92631491, "body": "A VBA function seems the best choice for this imo."}, {"owner": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "edited": false, "score": 0, "creation_date": 1539789603, "post_id": 52858201, "comment_id": 92631566, "body": "How many words can be in the different cells (the maximum?) It might be possible without VBA"}, {"owner": {"reputation": 31, "user_id": 10519308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a327bf4ba5c58db68c89828d44f801f?s=128&d=identicon&r=PG&f=1", "display_name": "David Gorgan", "link": "https://stackoverflow.com/users/10519308/david-gorgan"}, "reply_to_user": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1539791751, "post_id": 52858201, "comment_id": 92632760, "body": "@AlexK. you are definitely right."}, {"owner": {"reputation": 31, "user_id": 10519308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a327bf4ba5c58db68c89828d44f801f?s=128&d=identicon&r=PG&f=1", "display_name": "David Gorgan", "link": "https://stackoverflow.com/users/10519308/david-gorgan"}, "reply_to_user": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "edited": false, "score": 0, "creation_date": 1539791789, "post_id": 52858201, "comment_id": 92632781, "body": "@Pierre44 Usually 3-4 words, but it can go up to 8."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1592312177, "post_id": 52858201, "comment_id": 110375376, "body": "Old thread, but this is possible with normal function relatively easy. Have a look at <a href=\"https://stackoverflow.com/a/58674097/9758194\">this</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1156, "user_id": 6636638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cca4dc3546ba881a3958a66dbe89f449?s=128&d=identicon&r=PG&f=1", "display_name": "B. Cratty", "link": "https://stackoverflow.com/users/6636638/b-cratty"}, "is_accepted": false, "score": 0, "last_activity_date": 1539789426, "creation_date": 1539789426, "answer_id": 52858285, "question_id": 52858201, "link": "https://stackoverflow.com/questions/52858201/count-number-of-characters-of-each-word-in-a-cell-in-excel/52858285#52858285", "title": "Count number of characters of each word in a cell in excel", "body": "<p>You could use the <strong>Characters.Count</strong> property. </p>\n\n<p>I got the following script from <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.characters.count\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<pre><code>Sub MakeSuperscript() \n Dim n As Integer \n\n n = Worksheets(\"Sheet1\").Range(\"A1\").Characters.Count \n Worksheets(\"Sheet1\").Range(\"A1\").Characters(n, 1) _ \n .Font.Superscript = True \nEnd Sub\n</code></pre>\n\n<p>So in your case I believe if you were to use the <code>.split()</code> function to create an array of words. Then while looping through each element of the array you can use the <code>Characters.count()</code> property.</p>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 10519308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a327bf4ba5c58db68c89828d44f801f?s=128&d=identicon&r=PG&f=1", "display_name": "David Gorgan", "link": "https://stackoverflow.com/users/10519308/david-gorgan"}, "edited": false, "score": 0, "creation_date": 1539790292, "post_id": 52858343, "comment_id": 92632010, "body": "Thank you so much! Saved me a lot of time"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 31, "user_id": 10519308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a327bf4ba5c58db68c89828d44f801f?s=128&d=identicon&r=PG&f=1", "display_name": "David Gorgan", "link": "https://stackoverflow.com/users/10519308/david-gorgan"}, "edited": false, "score": 0, "creation_date": 1539790646, "post_id": 52858343, "comment_id": 92632214, "body": "@DavidGorgan - there are a few ways to do this, as the multiple answers show.  Whichever one works for you as your Answer, would you mind marking it as such by clicking the check mark left of the post?"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 2, "last_activity_date": 1539818445, "last_edit_date": 1539818445, "creation_date": 1539789599, "answer_id": 52858343, "question_id": 52858201, "link": "https://stackoverflow.com/questions/52858201/count-number-of-characters-of-each-word-in-a-cell-in-excel/52858343#52858343", "title": "Count number of characters of each word in a cell in excel", "body": "<pre><code>Function count_Chars(ByVal target As Range)\nDim splt\n\nsplt = Split(target, \" \")\n\nDim i As Long\nDim output As String\n\nFor i = LBound(splt) To UBound(splt)\n    output = output &amp; \" \" &amp; Len(splt(i))\nNext i\n\ncount_Chars = TRIM(output)\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/zRTyq.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zRTyq.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 73, "user_id": 7375823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4329d04939f011b81854e2c60c93dce?s=128&d=identicon&r=PG&f=1", "display_name": "Musicodelic", "link": "https://stackoverflow.com/users/7375823/musicodelic"}, "is_accepted": false, "score": 1, "last_activity_date": 1539794561, "last_edit_date": 1539794561, "creation_date": 1539789647, "answer_id": 52858359, "question_id": 52858201, "link": "https://stackoverflow.com/questions/52858201/count-number-of-characters-of-each-word-in-a-cell-in-excel/52858359#52858359", "title": "Count number of characters of each word in a cell in excel", "body": "<p>maybe with a loop?\nPresuming that the words are separated by spaces:</p>\n\n<pre><code>Sub CountChars\n    Dim strWord as Variant, lenWord as Long, StrCount as String\n\n    For Each strWord in Split(mysheet.range(\"A1\"),\" \")\n        lenWord = len(strWord)\n\n        'if you wish to display side by side:\n        StrCount = StrCount &amp; cstr(lenword) &amp; \" \"\n    Next\n    StrCount = Trim(StrCount) 'To remove the space at the end from the last loop\n    Debug.print StrCount\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1539790060, "post_id": 52858389, "comment_id": 92631843, "body": "Just curious - why use <code>Chr(32)</code> instead of <code>&quot; &quot;</code>?"}, {"owner": {"reputation": 31, "user_id": 10519308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a327bf4ba5c58db68c89828d44f801f?s=128&d=identicon&r=PG&f=1", "display_name": "David Gorgan", "link": "https://stackoverflow.com/users/10519308/david-gorgan"}, "edited": false, "score": 0, "creation_date": 1539790318, "post_id": 52858389, "comment_id": 92632027, "body": "Thank you so much!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1539789715, "creation_date": 1539789715, "answer_id": 52858389, "question_id": 52858201, "link": "https://stackoverflow.com/questions/52858201/count-number-of-characters-of-each-word-in-a-cell-in-excel/52858389#52858389", "title": "Count number of characters of each word in a cell in excel", "body": "<p>Try this short array based UDF.</p>\n\n<pre><code>Option Explicit\n\nFunction wordLength(str As String)\n    Dim i As Long, arr As Variant\n    arr = Split(str, Chr(32))\n    For i = LBound(arr) To UBound(arr)\n        arr(i) = Len(arr(i))\n    Next i\n    wordLength = Join(arr, Chr(32))\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/WbNiN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WbNiN.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1539790265, "creation_date": 1539790265, "answer_id": 52858570, "question_id": 52858201, "link": "https://stackoverflow.com/questions/52858201/count-number-of-characters-of-each-word-in-a-cell-in-excel/52858570#52858570", "title": "Count number of characters of each word in a cell in excel", "body": "<p>A User-Defined-Function is a good idea, indeed:</p>\n\n<pre><code>Public Function CountWords(inString As String) As String\n\n    Dim i As Long\n    Dim myArr As Variant: myArr = Split(inString)\n    For i = LBound(myArr) To UBound(myArr)\n        CountWords = CountWords &amp; \" \" &amp; Len(myArr(i))\n    Next i\n    CountWords = Trim(CountWords)\n\nEnd Function\n</code></pre>\n\n<ul>\n<li>The <code>Split()</code> does not need an argument what to split with, if it is space;</li>\n<li>The <code>Trim()</code> removes the last space;</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 10519308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a327bf4ba5c58db68c89828d44f801f?s=128&d=identicon&r=PG&f=1", "display_name": "David Gorgan", "link": "https://stackoverflow.com/users/10519308/david-gorgan"}, "edited": false, "score": 1, "creation_date": 1539791917, "post_id": 52858753, "comment_id": 92632846, "body": "Woah, I really appreciate your effort xD."}], "tags": [], "owner": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "is_accepted": false, "score": 1, "last_activity_date": 1539790871, "creation_date": 1539790871, "answer_id": 52858753, "question_id": 52858201, "link": "https://stackoverflow.com/questions/52858201/count-number-of-characters-of-each-word-in-a-cell-in-excel/52858753#52858753", "title": "Count number of characters of each word in a cell in excel", "body": "<p>Just to show the horrible answer you get without VBA: </p>\n\n<p>You can look for the \" \" and then count the length between the different spaces. </p>\n\n<pre><code>=find(\" \",B3,1)-1&amp;\" \"&amp;\nfind(\" \",B3,find(\" \",B3,1)+1)-(find(\" \",B3,1))-1&amp;\" \"&amp;\nfind(\" \",B3,find(\" \",B3,find(\" \",B3,1)+1)+1)-(find(\" \",B3,find(\" \",B3,1)+1)-(find(\" \",B3,1))+find(\" \",B3,1))-1&amp;\" \"&amp;\nLEN(B3)-(find(\" \",B3,1)+find(\" \",B3,find(\" \",B3,1)+1)-(find(\" \",B3,1))+find(\" \",B3,find(\" \",B3,find(\" \",B3,1)+1)+1)-(find(\" \",B3,find(\" \",B3,1)+1)-(find(\" \",B3,1))+find(\" \",B3,1)))\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 10519308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a327bf4ba5c58db68c89828d44f801f?s=128&d=identicon&r=PG&f=1", "display_name": "David Gorgan", "link": "https://stackoverflow.com/users/10519308/david-gorgan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 380, "favorite_count": 0, "accepted_answer_id": 52858343, "answer_count": 6, "score": 0, "last_activity_date": 1593677175, "creation_date": 1539789173, "last_edit_date": 1593677175, "question_id": 52858201, "link": "https://stackoverflow.com/questions/52858201/count-number-of-characters-of-each-word-in-a-cell-in-excel", "title": "Count number of characters of each word in a cell in excel", "body": "<p>For instance if I have the sentence in one cell:</p>\n\n<pre><code>The fox jumped twice    \n</code></pre>\n\n<p>the output should be</p>\n\n<pre><code>3 3 6 5\n</code></pre>\n\n<p>I've tried using the <code>len()</code> and <code>trim()</code> functions in a couple of combinations but didn't manage to find a solution yet, was afraid that it could be done only by using VBA.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1539789413, "post_id": 52858184, "comment_id": 92631468, "body": "Qualify <code>Cells()</code> with the workbook/worksheet, just like you did with the Sheet."}, {"owner": {"reputation": 1, "user_id": 10519333, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-vt_eWI8dB8w/AAAAAAAAAAI/AAAAAAAAAA8/ncwwX09GG2I/photo.jpg?sz=128", "display_name": "Shannon Fisher", "link": "https://stackoverflow.com/users/10519333/shannon-fisher"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1539789770, "post_id": 52858184, "comment_id": 92631660, "body": "When I do Cells(&quot;B:B&quot;) it selects all of the cells empty and filled, is there another way to format it to just get the filled cells?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1539789808, "post_id": 52858184, "comment_id": 92631686, "body": "Try <code>... = dib.Worksheets(&quot;GOO&quot;).Range(dib.Worksheets(&quot;GOO&quot;).Cells (1, 1), dib.Worksheets(&quot;GOO&quot;).Cells(rows.Count, 2).End(xlUp)).Formula</code>"}, {"owner": {"reputation": 1, "user_id": 10519333, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-vt_eWI8dB8w/AAAAAAAAAAI/AAAAAAAAAA8/ncwwX09GG2I/photo.jpg?sz=128", "display_name": "Shannon Fisher", "link": "https://stackoverflow.com/users/10519333/shannon-fisher"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1539790427, "post_id": 52858184, "comment_id": 92632092, "body": "I&#39;m still getting the empty cells, is there another way to go about this?"}], "answers": [{"tags": [], "owner": {"reputation": 892, "user_id": 10503508, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q1Afy.jpg?s=128&g=1", "display_name": "Ferdinando", "link": "https://stackoverflow.com/users/10503508/ferdinando"}, "is_accepted": false, "score": 0, "last_activity_date": 1539801388, "creation_date": 1539801388, "answer_id": 52861518, "question_id": 52858184, "link": "https://stackoverflow.com/questions/52858184/how-to-select-all-full-cells-and-copy-into-other-doc-vba/52861518#52861518", "title": "how to select all full cells and copy into other doc vba", "body": "<p><code>enter code here</code>IF i understood your question you can try this code and after you can copy the result in other file(you have to add another code).</p>\n\n<pre><code>Dim r, c, count, numRows, numCols As Integer\n\nnumRows = ActiveSheet.UsedRange.Rows.count ' number rows\nnumCols = ActiveSheet.UsedRange.Columns.count ' number columns\ncount = 1\n\nFor c = 1 To numCols\ncount = 1\n    For r = 1 To numRows\n\n        If (Cells(r, c) &lt;&gt; \"\") Then\n\n            'prendo il dato e lo metto nell'altro foglio\n            With Sheets(\"Destination\")'name second sheet where i get final result\n\n               'copy data into destination sheet\n               .Cells(count, c) = Cells(r, c)\n                count = count + 1\n            End With            \n        End If        \n    Next r    \nNext c\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10519333, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-vt_eWI8dB8w/AAAAAAAAAAI/AAAAAAAAAA8/ncwwX09GG2I/photo.jpg?sz=128", "display_name": "Shannon Fisher", "link": "https://stackoverflow.com/users/10519333/shannon-fisher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 17, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1539801388, "creation_date": 1539789124, "question_id": 52858184, "link": "https://stackoverflow.com/questions/52858184/how-to-select-all-full-cells-and-copy-into-other-doc-vba", "title": "how to select all full cells and copy into other doc vba", "body": "<p>I want to select all of the filled cells in a different excel document and paste it into a different excel document but I keep getting an error message. </p>\n\n<pre><code>Worksheets(\"FOO\").Range(\"H:H\").Formula = dib.Worksheets(\"GOO\").Range(Cells\n(1, 1), Cells(rows.Count, 2).End(xlUp)).Formula\n</code></pre>\n"}, {"tags": ["vba", "count", "attachment"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10519270, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ubelj0oGNVg/AAAAAAAAAAI/AAAAAAAAFwM/uNGdv9XWzJ0/photo.jpg?sz=128", "display_name": "Joshna Surendran", "link": "https://stackoverflow.com/users/10519270/joshna-surendran"}, "edited": false, "score": 0, "creation_date": 1539938777, "post_id": 52860197, "comment_id": 92690456, "body": "Thank you for the response Sir. But there is no path in the excel sheet. The user would save the reports with the naming convention provided in the excel sheet and save the report in the same folder where this macro is saved.  Let me know if you need the complete document"}], "tags": [], "owner": {"reputation": 73, "user_id": 7375823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4329d04939f011b81854e2c60c93dce?s=128&d=identicon&r=PG&f=1", "display_name": "Musicodelic", "link": "https://stackoverflow.com/users/7375823/musicodelic"}, "is_accepted": false, "score": 0, "last_activity_date": 1539796023, "creation_date": 1539796023, "answer_id": 52860197, "question_id": 52858144, "link": "https://stackoverflow.com/questions/52858144/checking-for-attachments-before-sending-the-emails-using-vba/52860197#52860197", "title": "Checking for attachments before sending the emails using VBA", "body": "<p>Presuming that <code>AttachmentName</code> is a full file path string, maybe your code could check if the file exists beforehand.</p>\n\n<p>For the sake of simplicity...</p>\n\n<pre><code>If Len(Dir(AttachmentName)) = 0 then msgbox \"The File \" &amp; AttachmentName &amp; \" is missing\"\n</code></pre>\n\n<p>... Just after you set <code>AttachmentName</code> value at <code>AttchmentName = Application.WorksheetFunction.VLookup(FLNM, AddressList, 2, True)</code></p>\n\n<p>Obviously, same for any other Attachment variables.</p>\n"}], "owner": {"reputation": 1, "user_id": 10519270, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ubelj0oGNVg/AAAAAAAAAAI/AAAAAAAAFwM/uNGdv9XWzJ0/photo.jpg?sz=128", "display_name": "Joshna Surendran", "link": "https://stackoverflow.com/users/10519270/joshna-surendran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 285, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1539949842, "creation_date": 1539789025, "last_edit_date": 1539949842, "question_id": 52858144, "link": "https://stackoverflow.com/questions/52858144/checking-for-attachments-before-sending-the-emails-using-vba", "title": "Checking for attachments before sending the emails using VBA", "body": "<p>I have a macro to draft automatic emails based on the recipients in each columns. </p>\n\n<p>However, I'm looking for a code which can if the attachments named in the excel sheet are attached to the email. If there is any attachment missing from that email  it should show a msg box with the name of the missing attachment. \n<a href=\"https://i.stack.imgur.com/rGDQb.png\" rel=\"nofollow noreferrer\">SNip of one the sheets attached</a></p>\n\n<pre><code>Sub Email1()\n\n\n\nDim olApp As Outlook.Application\nSet olApp = CreateObject(\"Outlook.Application\")\n\nDim olMail As Outlook.MailItem\nSet olMail = olApp.CreateItem(olMailItem)\n\nDim FLNM As String\nDim AttchmentName As String\nSet AddressList = Sheets(\"Tracker Summary\").Range(\"Y:Z\")\n\nDim AttchmentName1 As String\nDim path As String\n\nCall FetchFileNames\n\npath = ThisWorkbook.path &amp; \"/\"\n\nDim i As Integer\n\ni = 5\n\nWith olMail\n\nActiveSheet.Range(\"A1\").Select\n.BodyFormat = olFormatHTML\n\n    .Display\n    .To = ActiveSheet.Cells(2, i).Value\n    .CC = ActiveSheet.Cells(3, i).Value\n    .Subject = ActiveSheet.Cells(4, i).Value\n    .HTMLBody = ActiveSheet.Cells(5, i).Value &amp; .HTMLBody\n    j = 6\n\n    Do Until IsEmpty(Cells(j, i))\n\n    On Error Resume Next\n\n    FLNM = ActiveSheet.Cells(j, i).Value\n\n    AttchmentName1 = Application.WorksheetFunction.VLookup(FLNM, AddressList, 1, True)\n\n    If FLNM = AttchmentName1 Then\n\n    AttchmentName = Application.WorksheetFunction.VLookup(FLNM, AddressList, 2, True)\n\n    .Attachments.Add AttchmentName\n\n    End If\n\n    j = j + 1\n\n    Loop\n\n    '.Display\n\n    End With\n\nSheets(\"Tracker Summary\").Range(\"Y:Z\").ClearContents\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1, "user_id": 10519318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18efc09ca587d5d9bf63a6b83c17e69e?s=128&d=identicon&r=PG&f=1", "display_name": "Santiago", "link": "https://stackoverflow.com/users/10519318/santiago"}, "edited": false, "score": 0, "creation_date": 1539789124, "post_id": 52858107, "comment_id": 92631294, "body": "The cells are exactly the same, I just need to change the source from the other flie to the sheet in my current file."}], "answers": [{"tags": [], "owner": {"reputation": 1560, "user_id": 5618307, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FVWb0.jpg?s=128&g=1", "display_name": "IqbalHamid", "link": "https://stackoverflow.com/users/5618307/iqbalhamid"}, "is_accepted": false, "score": 0, "last_activity_date": 1539872586, "last_edit_date": 1592644375, "creation_date": 1539872586, "answer_id": 52876206, "question_id": 52858107, "link": "https://stackoverflow.com/questions/52858107/excel-vba-charts-changing-source/52876206#52876206", "title": "Excel VBA charts changing source", "body": "<ol>\n<li><p>Right click on your chart,</p>\n</li>\n<li><p>Choose 'Select Data'.</p>\n</li>\n<li><p>In chart data range at the top, enter:</p>\n<p>=[PathTo.xlsx]Sheet[N]![Range]</p>\n</li>\n</ol>\n<p>Where:</p>\n<blockquote>\n<p><em>[PathTo.xlsx]</em> = Path to your remote file</p>\n<p><em>Sheet[N]</em> = Sheet Name</p>\n<p><em>[Range]</em> = Cell range to be charted.</p>\n</blockquote>\n<p>For example:</p>\n<pre><code>=[Book1.xlsx]Sheet1!$A$1:$B$13\n</code></pre>\n<p>Hope that helps!</p>\n"}], "owner": {"reputation": 1, "user_id": 10519318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18efc09ca587d5d9bf63a6b83c17e69e?s=128&d=identicon&r=PG&f=1", "display_name": "Santiago", "link": "https://stackoverflow.com/users/10519318/santiago"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1591532181, "creation_date": 1539788929, "last_edit_date": 1591532181, "question_id": 52858107, "link": "https://stackoverflow.com/questions/52858107/excel-vba-charts-changing-source", "title": "Excel VBA charts changing source", "body": "<p>I have an excel sheet with 69 charts linked to another excel file, and I want to change the source of all charts to a Sheet in my current file, but I couldn't do it. Does anyone know how to? Thanks!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 1, "creation_date": 1539788970, "post_id": 52858061, "comment_id": 92631200, "body": "<code>If WB.Visible = true then</code> ..."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1539789051, "post_id": 52858061, "comment_id": 92631244, "body": "<code>.visible</code> does this help?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1539789118, "post_id": 52858061, "comment_id": 92631292, "body": "@cybernetic.nomad that&#39;s the workbook.   It&#39;s the worksheets, not sure what is actually required the loop or that bit :)"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1539797035, "post_id": 52858061, "comment_id": 92635380, "body": "@Nathan_Sav - You&#39;re right, for some reason I read <code>WB</code>, <code>LTD</code> and <code>EDD</code> as 3 worksheets... got to get my eyes checked"}], "answers": [{"comments": [{"owner": {"reputation": 720, "user_id": 8356237, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rSOb2.jpg?s=128&g=1", "display_name": "West Ray", "link": "https://stackoverflow.com/users/8356237/west-ray"}, "edited": false, "score": 0, "creation_date": 1539789993, "post_id": 52858227, "comment_id": 92631793, "body": "It didn&#39;t seem to work. Nothing happens when I&#39;m triggering it from EDD sheet. If I select one of the visible sheets and then trigger it, it will do the operation, then I have to go to another sheet (activate it manually) and then trigger the code."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 720, "user_id": 8356237, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rSOb2.jpg?s=128&g=1", "display_name": "West Ray", "link": "https://stackoverflow.com/users/8356237/west-ray"}, "edited": false, "score": 1, "creation_date": 1539858983, "post_id": 52858227, "comment_id": 92657708, "body": "@WestRay  Did you change &quot;xx.xlsm&quot; to your workbook name?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 720, "user_id": 8356237, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rSOb2.jpg?s=128&g=1", "display_name": "West Ray", "link": "https://stackoverflow.com/users/8356237/west-ray"}, "edited": false, "score": 0, "creation_date": 1539861981, "post_id": 52858227, "comment_id": 92659314, "body": "@WestRay to be fair, this is the way to loop through worksheets. (Downvoter care to mention why the vote?)  Where is this sub stored and being called from? It&#39;s unclear how you&#39;d incorporate this into your OP code, but with some quick research you should be able to get it."}, {"owner": {"reputation": 720, "user_id": 8356237, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rSOb2.jpg?s=128&g=1", "display_name": "West Ray", "link": "https://stackoverflow.com/users/8356237/west-ray"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1539874678, "post_id": 52858227, "comment_id": 92667287, "body": "@Nathan_Sav - I think that goes without saying. brucewayne I will work on it tonight and tomorrow and let you know - but at the moment it doesn&#39;t work (am surprised as well)."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 720, "user_id": 8356237, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rSOb2.jpg?s=128&g=1", "display_name": "West Ray", "link": "https://stackoverflow.com/users/8356237/west-ray"}, "edited": false, "score": 0, "creation_date": 1539874847, "post_id": 52858227, "comment_id": 92667411, "body": "@WestRay - However you implement this, are you making sure to link your new ranges to each <code>ws</code>? How isn&#39;t this working, can you please clarify <i>where</i> this code runs from (worksheet module or workbook module?), and make sure you don&#39;t have any <code>.Select</code> or <code>.Activate</code> in the final code.  Again, this is <i>the way</i> to loop through worksheets (alternative is to use an <code>i</code> counter I suppose), so any issues are further in the code I think."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 720, "user_id": 8356237, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rSOb2.jpg?s=128&g=1", "display_name": "West Ray", "link": "https://stackoverflow.com/users/8356237/west-ray"}, "edited": false, "score": 1, "creation_date": 1539877675, "post_id": 52858227, "comment_id": 92669184, "body": "@WestRay  :)  You&#39;d be surprised, I&#39;ve written an answer using B1:B10 and had comment back saying, thanks, but my range is A1:A10.  What is the issue with this code?  What are you running in the &quot;do things&quot; section?"}, {"owner": {"reputation": 720, "user_id": 8356237, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rSOb2.jpg?s=128&g=1", "display_name": "West Ray", "link": "https://stackoverflow.com/users/8356237/west-ray"}, "edited": false, "score": 0, "creation_date": 1539949363, "post_id": 52858227, "comment_id": 92695904, "body": "It runs from the workbook module, in the dothings I call my code which has no &#39;select&#39; or &#39;activate&#39; in it, it&#39;s basically this: Sub test_visibleonly()  Dim WB As Workbook Dim INF As Long, RSP As Long  Set WB = Workbooks(&quot;xx.xlsm&quot;) Set EDD = WB.Sheets(&quot;EDD&quot;)  INF = Range(&quot;A&quot; &amp; Rows.Count).End(xlUp).Row  For i = 1 To INF If Range(&quot;I&quot; &amp; i).Value = &quot;Further Information Needed&quot; Then     Range(&quot;I&quot; &amp; i).Offset(0, -6).Copy     EDD.Range(&quot;C&quot; &amp; Rows.Count).End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues End If Next i  Application.CutCopyMode = False End Sub"}, {"owner": {"reputation": 720, "user_id": 8356237, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rSOb2.jpg?s=128&g=1", "display_name": "West Ray", "link": "https://stackoverflow.com/users/8356237/west-ray"}, "edited": false, "score": 0, "creation_date": 1540396083, "post_id": 52858227, "comment_id": 92852668, "body": "I think I have found the issue, the tab that is visible needs to be activated so the code [I have] can execute on it specifically (we are assuming we don&#39;t know tab names)."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": -1, "last_activity_date": 1539789246, "creation_date": 1539789246, "answer_id": 52858227, "question_id": 52858061, "link": "https://stackoverflow.com/questions/52858061/how-to-run-the-code-only-through-visible-tabs/52858227#52858227", "title": "How to run the code only through visible tabs?", "body": "<p>Just loop through worksheets, checking if they're visible:</p>\n\n<pre><code>Dim ws As Worksheet\nFor Each ws In Workbooks(\"XX.xlsm\").Worksheets\n    If ws.Visible = xlSheetVisible Then\n        ' Do things\n    End If\nNext ws\n</code></pre>\n"}], "owner": {"reputation": 720, "user_id": 8356237, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rSOb2.jpg?s=128&g=1", "display_name": "West Ray", "link": "https://stackoverflow.com/users/8356237/west-ray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 1, "accepted_answer_id": 52858227, "answer_count": 1, "score": 0, "last_activity_date": 1593677186, "creation_date": 1539788801, "last_edit_date": 1593677186, "question_id": 52858061, "link": "https://stackoverflow.com/questions/52858061/how-to-run-the-code-only-through-visible-tabs", "title": "How to run the code only through visible tabs?", "body": "<p>I have a rather trivial problem. I have this code [which is worksheet-specific as you can see, what I need is that it goes through all visible [non-hidden] worksheets, can you please advise?]:</p>\n\n<pre><code>Sub TRANS_to_EDD()\n\nDim WB As Workbook\nDim LTD As Worksheet\nDim INF As Long, RSP As Long\n\nSet WB = Workbooks(\"XX.xlsm\")\nSet LTD = WB.Sheets(\"LimitedCo\")\nSet EDD = WB.Sheets(\"EDD\")\n\nINF = LTD.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nFor i = 2 To INF\nIf LTD.Range(\"I\" &amp; i).Value = \"Reject\" Then\n    LTD.Range(\"I\" &amp; i).Offset(0, -6).Copy\n    EDD.Range(\"C\" &amp; Rows.Count).End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues\nEnd If\nNext i\n\nFor i = 2 To INF\nIf LTD.Range(\"I\" &amp; i).Value = \"Reject\" Then\n    LTD.Range(\"I\" &amp; i).Offset(0, -5).Copy\n    EDD.Range(\"E\" &amp; Rows.Count).End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues\nEnd If\nNext i\n\nApplication.CutCopyMode = False\nEnd Sub\n</code></pre>\n\n<p>Thanks</p>\n\n<p>PS. EDD always stays as it is the end destination. </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 968, "user_id": 5910169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a40180e3fa49fbf4e55145adf54d9?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Ball", "link": "https://stackoverflow.com/users/5910169/frank-ball"}, "is_accepted": false, "score": 0, "last_activity_date": 1539797184, "creation_date": 1539797184, "answer_id": 52860501, "question_id": 52858047, "link": "https://stackoverflow.com/questions/52858047/convert-delimited-text-to-csv/52860501#52860501", "title": "Convert delimited text to csv", "body": "<p>Try changing this line:</p>\n\n<pre><code> \"TEXT;File1\" _\n</code></pre>\n\n<p>to</p>\n\n<pre><code>\"TEXT;\" &amp; File1 _\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 3823876, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/6d920ea9a36d85fa2c771f3e7d8199c9?s=128&d=identicon&r=PG&f=1", "display_name": "hannah", "link": "https://stackoverflow.com/users/3823876/hannah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1591532197, "creation_date": 1539788762, "last_edit_date": 1591532197, "question_id": 52858047, "link": "https://stackoverflow.com/questions/52858047/convert-delimited-text-to-csv", "title": "Convert delimited text to csv", "body": "<p>I need to convert the file containing delimiter \"|\" to excel file using VBA. My code is working when I used the constant path location. But, I got an error if I used the value from the textbox wherein the user will select the location of the file.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>    Dim wb As Workbook\nDim File1 As String\n\nSet wb = Workbooks.Add(xlWBATWorksheet)\n\nFile1 = txtBox.Text\n\nWith wb.ActiveSheet.QueryTables.Add(Connection:= _\n    \"TEXT;File1\" _\n    , Destination:=Range(\"$A$1\"))\n    .Name = \"sample\"\n    .FieldNames = True\n    .RowNumbers = False\n    .FillAdjacentFormulas = False\n    .PreserveFormatting = True\n    .RefreshOnFileOpen = False\n    .RefreshStyle = xlInsertDeleteCells\n    .SavePassword = False\n    .SaveData = True\n    .AdjustColumnWidth = True\n    .RefreshPeriod = 0\n    .TextFilePromptOnRefresh = False\n    .TextFilePlatform = 437\n    .TextFileStartRow = 1\n    .TextFileParseType = xlDelimited\n    .TextFileTextQualifier = xlTextQualifierDoubleQuote\n    .TextFileConsecutiveDelimiter = False\n    .TextFileTabDelimiter = False\n    .TextFileSemicolonDelimiter = False\n    .TextFileCommaDelimiter = False\n    .TextFileSpaceDelimiter = False\n    .TextFileOtherDelimiter = \"|\"\n    .TextFileColumnDataTypes = Array(1, 1, 1, 1, 1, 1, 1, 1, 1)\n    .TextFileTrailingMinusNumbers = True\n    .Refresh BackgroundQuery:=False\nEnd With\nRows(\"1:1\").Select\nSelection.Delete Shift:=xlUp\nRows(\"2:2\").Select\nSelection.Delete Shift:=xlUp\n</code></pre>\n\n<p>The File1 is the location of the file. It can be change depending on the location of the txt file. If I change it to example \"C:\\Users\\sample.txt\", it is working fine. Is there anything wrong with my code?</p>\n\n<p>Error:\n<a href=\"https://i.stack.imgur.com/ymoEx.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ymoEx.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Also, how can I change the value of <strong>.Name</strong> using the selected file from the textbox instead of hardcoded it?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 182, "user_id": 4723652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83d76e4d118165936de6866d5f42004?s=128&d=identicon&r=PG&f=1", "display_name": "Techie", "link": "https://stackoverflow.com/users/4723652/techie"}, "edited": false, "score": 0, "creation_date": 1539788844, "post_id": 52857999, "comment_id": 92631136, "body": "first copy data from A2 to another sheet and  save txt file."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 3944769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43d5e69c28482f65bf0f36199a68ada6?s=128&d=identicon&r=PG&f=1", "display_name": "Josh White", "link": "https://stackoverflow.com/users/3944769/josh-white"}, "edited": false, "score": 0, "creation_date": 1539879061, "post_id": 52860482, "comment_id": 92669994, "body": "Thanks.  Looks like i&#39;m getting a OBJECT REQUIRED error on line: MyVal = MySheet.Range(&quot;A2&quot;).Value &#39;Your specific cell value"}, {"owner": {"reputation": 73, "user_id": 7375823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4329d04939f011b81854e2c60c93dce?s=128&d=identicon&r=PG&f=1", "display_name": "Musicodelic", "link": "https://stackoverflow.com/users/7375823/musicodelic"}, "reply_to_user": {"reputation": 11, "user_id": 3944769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43d5e69c28482f65bf0f36199a68ada6?s=128&d=identicon&r=PG&f=1", "display_name": "Josh White", "link": "https://stackoverflow.com/users/3944769/josh-white"}, "edited": false, "score": 0, "creation_date": 1539888203, "post_id": 52860482, "comment_id": 92674668, "body": "You are right. Updated the code. You have to set the <code>MySheet</code> object referencing the sheet you are working on, and, of course, changing the object name as you wish."}], "tags": [], "owner": {"reputation": 73, "user_id": 7375823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4329d04939f011b81854e2c60c93dce?s=128&d=identicon&r=PG&f=1", "display_name": "Musicodelic", "link": "https://stackoverflow.com/users/7375823/musicodelic"}, "is_accepted": false, "score": 0, "last_activity_date": 1539888063, "last_edit_date": 1539888063, "creation_date": 1539797097, "answer_id": 52860482, "question_id": 52857999, "link": "https://stackoverflow.com/questions/52857999/excel-sheet-with-two-buttons-to-save-certain-cells-as-txt-to-specific-location/52860482#52860482", "title": "Excel Sheet with Two Buttons to save certain cells as TXT to specific location", "body": "<p>This should do:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim path As String\nDim filename1 As String\n\n'New Variables:\nDim MyVal as Variant\nDim FileNum as Integer\nDim FSO as Object\nDim MySheet as Sheet\n\n\npath = \"S:\\\"\nfilename1 = \"scal0091\"\nSet MySheet = Thisworkbook.Sheets(\"MySheetName\") 'Put Your Sheet Name Here\nMyVal = MySheet.range(\"A2\").value 'Your specific cell value\nApplication.DisplayAlerts = False 'why?\n\n'Create a new text file:\nSet FSO = CreateObject(\"Scripting.FileSystemObject\")\nFSO.CreateTextFile path &amp; filename1, False\n\n'Write to Text File\nFileNum = FreeFile()\nOpen path &amp; filename1 for output as #FileNum\n    Print #FileNum, MyVal\nClose #FileNum\n\nSet FSO = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 3944769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43d5e69c28482f65bf0f36199a68ada6?s=128&d=identicon&r=PG&f=1", "display_name": "Josh White", "link": "https://stackoverflow.com/users/3944769/josh-white"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1591592103, "creation_date": 1539788600, "last_edit_date": 1591592103, "question_id": 52857999, "link": "https://stackoverflow.com/questions/52857999/excel-sheet-with-two-buttons-to-save-certain-cells-as-txt-to-specific-location", "title": "Excel Sheet with Two Buttons to save certain cells as TXT to specific location", "body": "<p>I have a Excel Spreedsheet that has data in Cells  A2 that I need to be able to click on the button and it exports that data to a text file in a network drive as a certain name (no extension). </p>\n\n<p>I also then need another button on the same sheet to save cells E2 and F2 to the same network location as a separate file name (no extension). </p>\n\n<p>I have the below code, but it copies ALL the data on the sheet to the file name when each button would need to only save the data from specific cells.  I'm guessing this is a RANGE option that I just cannot figure out.   </p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim path As String\nDim filename1 As String\n\npath = \"S:\\\"\nfilename1 = \"scal0091\"\nApplication.DisplayAlerts = False\n\nActiveWorkbook.SaveAs Filename:=path &amp; filename1 &amp; \".\", FileFormat:=xlText\nEnd Sub\n</code></pre>\n\n<p>Any suggestions?</p>\n\n<p>Thank you! </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 968, "user_id": 5910169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a40180e3fa49fbf4e55145adf54d9?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Ball", "link": "https://stackoverflow.com/users/5910169/frank-ball"}, "is_accepted": false, "score": 0, "last_activity_date": 1539796936, "creation_date": 1539796936, "answer_id": 52860438, "question_id": 52857753, "link": "https://stackoverflow.com/questions/52857753/how-to-include-a-short-message-in-email-body-which-has-a-page-of-workbook-inclu/52860438#52860438", "title": "How to include a short message in email body, which has a page of workbook included?", "body": "<p>Try this:</p>\n\n<pre><code>.HTMLBody = msg &amp; \"&lt;br&gt;\" &amp; RangetoHTML(rng)\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9880873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a6ba424369342825a0233c168b0a266?s=128&d=identicon&r=PG&f=1", "display_name": "Emily", "link": "https://stackoverflow.com/users/9880873/emily"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 19, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1539796936, "creation_date": 1539787830, "last_edit_date": 1539788895, "question_id": 52857753, "link": "https://stackoverflow.com/questions/52857753/how-to-include-a-short-message-in-email-body-which-has-a-page-of-workbook-inclu", "title": "How to include a short message in email body, which has a page of workbook included?", "body": "<p>I'm struggling to include a short message in email body, which has a page of workbook included. I can't find the reason. It's working perfect, but I can't add a message before the table. Any help, please? Thank you:)</p>\n\n<pre><code>Dim rng As Range\nDim OutApp As Object\nDim OutMail As Object\nDim strbody As String\n\nWith Application\n    .EnableEvents = False\n    .ScreenUpdating = False\nEnd With\n\nSet rng = Nothing\nSet rng = Sheet20.UsedRange\n'You can also use a sheet name\n'Set rng = Sheets(\"Sheet20\").UsedRange\n\nSet OutApp = CreateObject(\"Outlook.Application\")\nSet OutMail = OutApp.CreateItem(0)\n\nstrbody = \"Hi there\"\n\nOn Error Resume Next\n\nmsg = \"&lt;body style = 'font-family:Trebuchet;'&gt;\" &amp; \"Good morning,\" &amp; \"&lt;br&gt;&lt;br&gt;\" &amp; \"&lt;p style ='color: Red;'&gt; Please see attached the IC225 daily casualty list. &lt;/p&gt;\"\nmsg = msg &amp; \"&lt;h3&gt;Summary for \" &amp; dr.Shapes(\"DR_TITLE\").TextFrame.Characters.Text &amp; \"&lt;/h3&gt;\"\n\n\n\nWith OutMail\n    .To = \"julia.naydenova@lner.co.uk\"\n    .CC = \"\"\n    .BCC = \"\"\n    .Subject = \"Investigation Request\"\n    .HTMLBody = RangetoHTML(rng)\n    .Send   'or use .Display\nEnd With\nOn Error GoTo 0\n\nWith Application\n    .EnableEvents = True\n    .ScreenUpdating = True\nEnd With\n\nSet OutMail = Nothing\nSet OutApp = Nothing\nEnd Sub\n\nFunction RangetoHTML(rng As Range)\n' Changed by Ron de Bruin 28-Oct-2006\n' Working in Office 2000-2016\nDim fso As Object\nDim ts As Object\nDim TempFile As String\nDim TempWB As Workbook\n\nTempFile = Environ$(\"temp\") &amp; \"\\\" &amp; Format(Now, \"dd-mm-yy h-mm-ss\") &amp; \".htm\"\n\n'Copy the range and create a new workbook to past the data in\nrng.Copy\nSet TempWB = Workbooks.Add(1)\nWith TempWB.Sheets(1)\n    .Cells(1).PasteSpecial Paste:=8\n    .Cells(1).PasteSpecial xlPasteValues, , False, False\n    .Cells(1).PasteSpecial xlPasteFormats, , False, False\n    .Cells(1).Select\n    Application.CutCopyMode = False\n    On Error Resume Next\n    .DrawingObjects.Visible = True\n    .DrawingObjects.Delete\n    On Error GoTo 0\nEnd With\n\n'Publish the sheet to a htm file\nWith TempWB.PublishObjects.Add( _\n     SourceType:=xlSourceRange, _\n     Filename:=TempFile, _\n     Sheet:=TempWB.Sheets(1).Name, _\n     Source:=TempWB.Sheets(1).UsedRange.Address, _\n     HtmlType:=xlHtmlStatic)\n    .Publish (True)\nEnd With\n\n'Read all data from the htm file into RangetoHTML\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\nSet ts = fso.GetFile(TempFile).OpenAsTextStream(1, -2)\nRangetoHTML = ts.readall\nts.Close\nRangetoHTML = Replace(RangetoHTML, \"align=center x:publishsource=\", _\n                      \"align=left x:publishsource=\")\n\n'Close TempWB\nTempWB.Close savechanges:=False\n\n'Delete the htm file we used in this function\nKill TempFile\n\nSet ts = Nothing\nSet fso = Nothing\nSet TempWB = Nothing\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 4, "creation_date": 1539787259, "post_id": 52857505, "comment_id": 92630172, "body": "Have you tried using <code>Worksheet.Copy</code> to copy the whole worksheet, code/data/objects/formatting and all to the new Workbook?"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1539788411, "post_id": 52857505, "comment_id": 92630906, "body": "Probably the search you should be looking for would be export/import worksheet vba code"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1539788599, "post_id": 52857505, "comment_id": 92631001, "body": "<a href=\"http://www.cpearson.com/excel/vbe.aspx\" rel=\"nofollow noreferrer\">cpearson.com/excel/vbe.aspx</a>"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1539788762, "post_id": 52857505, "comment_id": 92631100, "body": "Probably duplicating the current workbook (with the VBA code) and importing/moving the worksheets from another workbook is simpler."}, {"owner": {"reputation": 43, "user_id": 10329556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5394161d7d106f2f183affb81a12fa31?s=128&d=identicon&r=PG&f=1", "display_name": "Mr. O", "link": "https://stackoverflow.com/users/10329556/mr-o"}, "edited": false, "score": 0, "creation_date": 1539848951, "post_id": 52857505, "comment_id": 92652158, "body": "Thanks for your answers but it didn&#39;t solve my problem. I need to copy only the vba code from a given worksheet, not the whole worksheet."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1539853403, "post_id": 52857505, "comment_id": 92654631, "body": "Please be more clear which code exactly you mean. You are mixing up the terms &quot;workbook&quot; and &quot;worksheet&quot;. Please clarify."}, {"owner": {"reputation": 43, "user_id": 10329556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5394161d7d106f2f183affb81a12fa31?s=128&d=identicon&r=PG&f=1", "display_name": "Mr. O", "link": "https://stackoverflow.com/users/10329556/mr-o"}, "edited": false, "score": 0, "creation_date": 1539935472, "post_id": 52857505, "comment_id": 92688771, "body": "Clarification: I meant that i need to copy only the vba part of the worksheet (which i see in VBA Editor after clicking &quot;Sheet1&quot;) without the data that is on this worksheet (which i see in Excel standard view)"}], "owner": {"reputation": 43, "user_id": 10329556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5394161d7d106f2f183affb81a12fa31?s=128&d=identicon&r=PG&f=1", "display_name": "Mr. O", "link": "https://stackoverflow.com/users/10329556/mr-o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 360, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1591566826, "creation_date": 1539787099, "last_edit_date": 1591566826, "question_id": 52857505, "link": "https://stackoverflow.com/questions/52857505/how-to-export-worksheet-vba-code-to-another-workbook", "title": "How to export worksheet vba code to another workbook", "body": "<p>I need to copy whole VBAProject to another workbook. I managed to find how to copy and paste modules and user forms but have problem with Microsoft Excel Objects.</p>\n\n<p>Is there a way to export worksheets macro code with another macro?</p>\n"}, {"tags": ["excel", "vba", "worksheet"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1539786945, "post_id": 52857436, "comment_id": 92629976, "body": "Have you stepped through to see what&#39;s going on?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1539787384, "post_id": 52857436, "comment_id": 92630255, "body": "<code>Set checkrng = Range(Range(...</code>  What workbook/worksheet do you expect that Range to be? I assume you want to link it to the <code>With</code> statement, yeah?  You need to qualify those ranges with a preceding <code>.</code>, e.g. <code>Set checkrng = .Range(.Range(&quot;US&quot;), .Range(&quot;U&quot; ...)</code>"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1539788110, "post_id": 52857436, "comment_id": 92630708, "body": "<i>I read somewhere that there is no need to activate the worksheet</i> This is true, but you need to reference the worksheet where you have the data you want. You can do it with objects and variables, or you can do it activating that sheet first and then, rest of your code."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1539788252, "post_id": 52857436, "comment_id": 92630801, "body": "And yes, as @BruceWayne said, you need the dot in <code>With...End With</code> statement. I upvoted his/her comment because your code looks code. Try what he/she said."}, {"owner": {"reputation": 1814, "user_id": 2588953, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/7cEaY.jpg?s=128&g=1", "display_name": "Chris L", "link": "https://stackoverflow.com/users/2588953/chris-l"}, "edited": false, "score": 0, "creation_date": 1539789371, "post_id": 52857436, "comment_id": 92631438, "body": "ok, adding the <code>.</code> before <code>Range</code> gets it to pull the data from the correct sheet, but the range is not correct.  In column <code>U</code> I have a dynamic list of check numbers starting at row 5 and in cell <code>AE1</code> is a count of the check numbers so my range should be from row 5 to the last check number (4 plus checktotal) but it is giving me a range from <code>U5</code> to the last cell with data in the column"}, {"owner": {"reputation": 1814, "user_id": 2588953, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/7cEaY.jpg?s=128&g=1", "display_name": "Chris L", "link": "https://stackoverflow.com/users/2588953/chris-l"}, "edited": false, "score": 1, "creation_date": 1539789466, "post_id": 52857436, "comment_id": 92631504, "body": "oh, I&#39;m an idiot.  originally I wrote the code for the last cell with data then changed it and forgot to delete the <code>.End(xlDown)</code> duh!"}], "owner": {"reputation": 1814, "user_id": 2588953, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/7cEaY.jpg?s=128&g=1", "display_name": "Chris L", "link": "https://stackoverflow.com/users/2588953/chris-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1591566839, "creation_date": 1539786855, "last_edit_date": 1591566839, "question_id": 52857436, "link": "https://stackoverflow.com/questions/52857436/excel-vba-data-from-worksheet-in-another-workbook", "title": "Excel VBA - Data from worksheet in another workbook", "body": "<p>I am trying to pull data from a worksheet in another workbook and it isn't working properly.  I'm not getting an error in the code but it is not pulling the data from the worksheet I want but rather whatever worksheet is open when the workbook opens.  I read somewhere that there is no need to activate the worksheet so I am not sure what is wrong with the following code:</p>\n\n<pre><code>Dim prfile1 As String\nDim prfile2 As String\nDim filepath As String\nDim checktotal As Integer\nDim checkrng As Range\nDim emunber As String\n\nprfile1 = Worksheets(\"setup\").Range(\"B10\").Value\nprfile2 = Worksheets(\"setup\").Range(\"B7\").Value\nfilepath = Worksheets(\"setup\").Range(\"e10\").Value\nemunber = Worksheets(\"ReprintOld\").Range(\"V3\").Value\n\nWorkbooks.Open filepath &amp; prfile2\nWindows(prfile2).Activate\nSheets(emunber).Activate\nchecktotal = Workbooks(prfile2).Worksheets(emunber).Range(\"AE1\")\n\nWith Workbooks(prfile2).Worksheets(emunber)\n\n    Set checkrng = Range(Range(\"U5\"), Range(\"U\" &amp; 4 + checktotal).End(xlDown))\n\nEnd With\n\nWindows(prfile1).Activate\nMsgBox emunber\nMsgBox checktotal\nMsgBox checkrng.Address\n</code></pre>\n"}, {"tags": ["vba", "count", "rows"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10519064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e067067849a7fb662e3239c6d68ccb8?s=128&d=identicon&r=PG&f=1", "display_name": "Daivd", "link": "https://stackoverflow.com/users/10519064/daivd"}, "edited": false, "score": 0, "creation_date": 1539788618, "post_id": 52857487, "comment_id": 92631017, "body": "Hi Tamara, how do I get it to count the number of filtered rows and report the number"}], "tags": [], "owner": {"reputation": 67, "user_id": 1389980, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/0f5wX.jpg?s=128&g=1", "display_name": "Tamara Pattinson", "link": "https://stackoverflow.com/users/1389980/tamara-pattinson"}, "is_accepted": false, "score": 0, "last_activity_date": 1539787026, "creation_date": 1539787026, "answer_id": 52857487, "question_id": 52857278, "link": "https://stackoverflow.com/questions/52857278/vba-code-to-count-number-of-rows-in-filtered-data-sum-a-relevant-column-in-f/52857487#52857487", "title": "VBA code to count number of rows (in filtered data) &amp; sum a relevant column in filtered source file", "body": "<pre><code>dim endRow as integer\nRange(\"a1\").select\nselection.End(xlDown).Select\nendRow = activecell.row\n</code></pre>\n\n<p>This is assuming that all fields in that column will have values.\nThis also works with xlToRight and xlToLeft as long as there are values in each cell.</p>\n"}, {"tags": [], "owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "is_accepted": false, "score": 0, "last_activity_date": 1539788820, "creation_date": 1539788820, "answer_id": 52858069, "question_id": 52857278, "link": "https://stackoverflow.com/questions/52857278/vba-code-to-count-number-of-rows-in-filtered-data-sum-a-relevant-column-in-f/52858069#52858069", "title": "VBA code to count number of rows (in filtered data) &amp; sum a relevant column in filtered source file", "body": "<p>To count the non-blank non-hidden cells in Column A of Worksheet <code>Sheet1</code>, you can use this code:</p>\n\n<pre><code>WorksheetFunctions.Subtotal(103, Sheet1.Columns(1))\n</code></pre>\n\n<p>To do so in a Cell is very similar:</p>\n\n<pre><code>=SUBTOTAL(103, Sheet1!$A:$A)\n</code></pre>\n\n<p>(Of course, this <em>will</em> include your header row)</p>\n\n<p>(<code>SUBTOTAL(3, Sheet1!A:A)</code> is the same as <code>COUNTA(Sheet1!A:A)</code> - using <code>103</code> instead is what makes it ignore the hidden/filtered-out rows)</p>\n"}], "owner": {"reputation": 1, "user_id": 10519064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e067067849a7fb662e3239c6d68ccb8?s=128&d=identicon&r=PG&f=1", "display_name": "Daivd", "link": "https://stackoverflow.com/users/10519064/daivd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1539788820, "creation_date": 1539786365, "last_edit_date": 1539787603, "question_id": 52857278, "link": "https://stackoverflow.com/questions/52857278/vba-code-to-count-number-of-rows-in-filtered-data-sum-a-relevant-column-in-f", "title": "VBA code to count number of rows (in filtered data) &amp; sum a relevant column in filtered source file", "body": "<p>I would like to get help on VBA codes to:</p>\n\n<ul>\n<li><p>count the number of rows (which could be filtered) from a source file which I have opened and reported the number in a master file. </p></li>\n<li><p>have the sum of a relevant column in the source file and report the value in a master file. </p></li>\n</ul>\n\n<p>The reason for these questions is to make sure that the input source file has been completely copied into the master file. </p>\n\n<p>Any help would be much appreciated.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1177, "user_id": 4734515, "user_type": "registered", "accept_rate": 68, "profile_image": "https://lh4.googleusercontent.com/-LkOMfutk0Eg/AAAAAAAAAAI/AAAAAAAAAEk/N5dZ__kGZw4/photo.jpg?sz=128", "display_name": "pheeper", "link": "https://stackoverflow.com/users/4734515/pheeper"}, "is_accepted": false, "score": 0, "last_activity_date": 1539788880, "creation_date": 1539788880, "answer_id": 52858091, "question_id": 52857254, "link": "https://stackoverflow.com/questions/52857254/loop-copying-value-in-bulk-data-columns-tables/52858091#52858091", "title": "Loop copying value in bulk data columns (tables)", "body": "<p>This should do the trick.  Let me know if you have any questions.</p>\n\n<pre><code>Sub CopyTableInWorksheet()\n    Dim ws As Worksheet\n    Set ws = ThisWorkbook.Sheets(\"Sheet1\")\n    Dim lStartColumn As Long\n    Dim lStartRow As Long\n    Dim lEndRow As Long\n    Dim lSpacer As Long\n    Dim lWidth As Long\n    Dim lPasteColumn As Long\n\n    'Set table size and spacing values\n    lStartColumn = 2\n    lStartRow = 2\n    lEndRow = 100000\n    lSpacer = 3\n\n    'Determine width of table, set the column number to start the new table, then copy and paste\n    lWidth = ws.Range(ws.Cells(lStartRow, lStartColumn), ws.Cells(lStartRow, lStartColumn).End(xlToRight)).Columns.Count\n    lPasteColumn = ws.Cells(lStartRow, lStartColumn).Column + lWidth + lSpacer\n    ws.Range(ws.Cells(lStartRow, 2), ws.Cells(lEndRow, ws.Range(\"B1\").Column + lWidth)).Copy ws.Range(ws.Cells(lStartRow, lPasteColumn), ws.Cells(lEndRow, lPasteColumn + lWidth))\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 728, "user_id": 6694814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06da9bcbd088ee23277f2b7494ba9daa?s=128&d=identicon&r=PG&f=1", "display_name": "MKR", "link": "https://stackoverflow.com/users/6694814/mkr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1591566854, "creation_date": 1539786308, "last_edit_date": 1591566854, "question_id": 52857254, "link": "https://stackoverflow.com/questions/52857254/loop-copying-value-in-bulk-data-columns-tables", "title": "Loop copying value in bulk data columns (tables)", "body": "<p>Good afternoon,</p>\n\n<p>I have a query regarding make a copy within columns when facing a bulk data.</p>\n\n<p>Basically I have a tables, that are repeatable.</p>\n\n<p>Eaxch table starts from B-column and continues towards next 53 columns to BB column, then there are 3 empty column and next table starts from BF to EF columns,  and last one from EJ to HJ column.</p>\n\n<p>Then I would like to copy for instance a B column, paste it in FN column, knowing that this is a leftmost part of my table. To copy another columns I have to know, that the distance is 53 between leftmost and rightmost column of the table (which are the same) and 56 between leftmost column of 1st table and leftmost column of 2nd table. \nInitially I counted the columns like \nCOLUMNS(FN11:HN11) =53, that is a simple excel formula. Next I used this code:</p>\n\n<pre><code>Sub cols_UK()\nSheets(\"14\").Activate\nRange(\"A11:A4739\").Copy\nRange(\"FN11, HR11, JU11\").PasteSpecial xlPasteValues\nRange(\"B11:B4739\").Copy\nRange(\"FO11, HO11, HS11, JS11, JW11, LW11\").PasteSpecial xlPasteValues\n</code></pre>\n\n<p>which obviously works, but the job is quite tedious.</p>\n\n<p>As same as here:</p>\n\n<pre><code>Range(\"FM11, HQ11, JU11, LX11\").Value = \"1to10\"\nRange(\"FM479, HQ479, JU479, LX479\").Value = \"11to20\"\nRange(\"FM947, HQ947, JU947, LX947\").Value = \"21to31\"\nRange(\"FM1415, HQ1415, JU1415, LX1415\").Value = \"MONTH\"\n</code></pre>\n\n<p>where I would like to put some values in columns being in some particular distance from each other.</p>\n\n<p>Is some loop solution in case of columns?</p>\n\n<p>Thanks &amp; regards,<a href=\"https://i.stack.imgur.com/1YKZY.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1YKZY.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1539786092, "post_id": 52857125, "comment_id": 92629361, "body": "I thing you want Resume"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1539786257, "post_id": 52857125, "comment_id": 92629501, "body": "@QHarr - <code>Resume</code> would result in endless loop. The <code>Resume Next</code> in the error handler is the correct way to deal with it."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1539786290, "post_id": 52857125, "comment_id": 92629526, "body": "@Vityata Correct. I meant it in the error handler. Is there a difference between Resume and Resume Next in this case? Pardon my ignorance. + for your soln."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1539786372, "post_id": 52857125, "comment_id": 92629587, "body": "@QHarr - I know (for the error handler). The <code>Resume</code> there would cause the endless loop."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1539786405, "post_id": 52857125, "comment_id": 92629609, "body": "My bad! Lesson learnt."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1539786910, "post_id": 52857125, "comment_id": 92629959, "body": "@QHarr - actually, these two <code>Resume Next</code> and <code>Resume</code> from the Error handler are really a useful feature. I have updated with examples."}], "answers": [{"comments": [{"owner": {"reputation": 2344, "user_id": 8461786, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/55878061e134ad81c5d169881b3c6d2e?s=128&d=identicon&r=PG&f=1", "display_name": "barciewicz", "link": "https://stackoverflow.com/users/8461786/barciewicz"}, "edited": false, "score": 0, "creation_date": 1539787258, "post_id": 52857189, "comment_id": 92630170, "body": "Vityata,many thanks for your thorough answer. However, as I stated in my question, I want to skip to next iteration, not next line. In your code <code>Resume Next</code> will go to <code>Debug.Print &quot;testing&quot;</code>, and I want to skip it - and whatever might go after it - and go to <code>Next x</code> instead."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 2344, "user_id": 8461786, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/55878061e134ad81c5d169881b3c6d2e?s=128&d=identicon&r=PG&f=1", "display_name": "barciewicz", "link": "https://stackoverflow.com/users/8461786/barciewicz"}, "edited": false, "score": 0, "creation_date": 1539787605, "post_id": 52857189, "comment_id": 92630389, "body": "@barciewicz - I see. I came up with another answer for this, <code>GoTo</code> is somehow bad, dangerous and etc."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 2, "last_activity_date": 1539786968, "last_edit_date": 1539786968, "creation_date": 1539786099, "answer_id": 52857189, "question_id": 52857125, "link": "https://stackoverflow.com/questions/52857125/how-to-go-to-next-iteration-on-error-aka-simulating-pythons-continue-statemen/52857189#52857189", "title": "How to go to next iteration on error AKA simulating Python&#39;s &quot;continue&quot; statement in VBA?", "body": "<p>You need <code>Resume Next</code> to go to the next line after the line, causing the error. And <code>Err.Clear</code> is a good practice as well.</p>\n\n<p>The <code>Exit Sub</code> before the <code>errhandler</code> is also a good practice:</p>\n\n<pre><code>Sub SkipIteration()\n\n    Dim x As Long        \n    For x = 5 To -5 Step -1\n        On Error GoTo errhandler:\n        Debug.Print 15 / x\n        Debug.Print \"testing\"\n    Next x        \n    Exit Sub\n\nerrhandler:\n    If Err.Number = 11 Then\n        Debug.Print (\"Error on \" &amp; x)\n        Err.Clear\n        Resume Next\n    End If    \nEnd Sub\n</code></pre>\n\n<p>The difference between <code>Resume</code> and <code>Resume Next</code> is the following:</p>\n\n<ul>\n<li><code>Resume</code> tries to go back to where it was called.</li>\n</ul>\n\n<p>In the <code>TestMeResume</code> procedure, it throws Error 11 at the Debug.Print a/b and in the error handler it assigns b = 5. Then with <code>Resume</code> it retries the <code>Debug.Print a / b</code>, and as far as <code>b</code> is not <code>0</code>, it runs.</p>\n\n<ul>\n<li><code>Resume Next</code> goes to where it was called, ignores the line and continues with the next one. </li>\n</ul>\n\n<p>In the <code>TestMeResumeNext</code> procedure, error 91 is thrown at <code>a = 12</code> and the error handler is triggered. In the error handler a is assigned to <code>Range(\"A14\")</code> and with <code>Resume Next</code> the <code>a = 12</code> is skipped and the <code>Sub</code> continues.</p>\n\n<hr>\n\n<pre><code>Sub TestMeResumeNext()\n\n    On Error GoTo TestMeResumeNext_Error\n\n    Dim a As Range\n    a = 12              'Error 91 here!\n    Debug.Print a.Row   'Resume Next goes back here\n    Exit Sub\n\nTestMeResumeNext_Error:\n    Set a = Range(\"A14\")\n    Resume Next\nEnd Sub\n\nSub TestMeResume()\n\n    On Error GoTo TestMeResume_Error\n\n    Dim a As Long: a = 10\n    Dim b As Long: b = 0\n    Debug.Print a / b   'Error 11 here the first time\n    Exit Sub\n\nTestMeResume_Error:\n    b = 5\n    Resume\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 1, "last_activity_date": 1539788454, "last_edit_date": 1539788454, "creation_date": 1539787321, "answer_id": 52857572, "question_id": 52857125, "link": "https://stackoverflow.com/questions/52857125/how-to-go-to-next-iteration-on-error-aka-simulating-pythons-continue-statemen/52857572#52857572", "title": "How to go to next iteration on error AKA simulating Python&#39;s &quot;continue&quot; statement in VBA?", "body": "<p>The other option here is to inline your error handler. This makes it obvious that you are aware of the potential for a specific line of code to raise an error, and doesn't rely on <code>Resume</code> for flow control.  Letting the error go to your handler at the bottom of the function and then jump back into the main line of the code makes it much less obvious what the expected behavior of the loop is.</p>\n\n<pre><code>Sub SkipIteration()\n    Dim x As Long\n\n    For x = 5 To -5 Step -1\n        On Error Resume Next\n        Debug.Print 15 / x\n        If Err.Number = 11 Then\n            Debug.Print \"Expected error on \" &amp; x\n            On Error GoTo errhandler\n        Else\n            On Error GoTo errhandler\n            Debug.Print \"Process the rest of the loop\"\n        End If\n    Next x\n\n    Exit Sub\nerrhandler:\n    Debug.Print \"Unexpected error \"; Err.Number\nEnd Sub\n</code></pre>\n\n<p>Even better would be to separate the concerns of your procedures in a way that the portion of the loop that gets executed is a single statement:</p>\n\n<pre><code>Sub SkipIteration()\n    On Error GoTo errhandler\n\n    Dim x As Long\n    For x = 5 To -5 Step -1\n        If TheThingThatCanError(x) Then\n            ActionThatDependsOnAbove x\n        End If\n    Next x\n\n    Exit Sub\nerrhandler:\n    Debug.Print \"Unexpected error \"; Err.Number\nEnd Sub\n\nPrivate Function TheThingThatCanError(x As Long) As Boolean\n    On Error Resume Next\n    Debug.Print 15 / x\n    If Err.Number = 11 Then\n        Debug.Print \"Expected error on \" &amp; x\n        Exit Function\n    End If\n    TheThingThatCanError = True\nEnd Function\n\nPrivate Sub ActionThatDependsOnAbove(x As Long)\n    Debug.Print \"I don't want this to be printed on error \" &amp; x\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1539787873, "post_id": 52857670, "comment_id": 92630556, "body": "Using <code>Evaluate</code> like that is horrible. Not only does it evaluate the expression twice (once for the <code>Evaluate</code> call and once for the &quot;real&quot; call), it offloads it to Excel, which may or may not use the same semantics for a more complicated expression."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1539788069, "post_id": 52857670, "comment_id": 92630679, "body": "@Comintern - yup, not the best one, but currently cannot come up with a 1-line option. And I do not want to have a dedicated function or <code>On Error Resume Next</code>,  because it would be like your answer. :D"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": -1, "last_activity_date": 1539854222, "last_edit_date": 1539854222, "creation_date": 1539787579, "answer_id": 52857670, "question_id": 52857125, "link": "https://stackoverflow.com/questions/52857125/how-to-go-to-next-iteration-on-error-aka-simulating-pythons-continue-statemen/52857670#52857670", "title": "How to go to next iteration on error AKA simulating Python&#39;s &quot;continue&quot; statement in VBA?", "body": "<p>If you want to skip the <code>Error</code> and continue with the next iteration, a possible way is to use <code>GoTo</code> and make some <a href=\"https://en.wikipedia.org/wiki/Spaghetti_code\" rel=\"nofollow noreferrer\">spaghetti code</a>:</p>\n\n<pre><code>Sub SkipIteration()\n    Dim x As Long\n    For x = 5 To -5 Step -1\n        If IsError(Evaluate(\"15 / \" &amp; x)) Then GoTo Skipper\n        Debug.Print 15 / x\n        Debug.Print x\nSkipper:\n    Next x\nEnd Sub\n</code></pre>\n\n<p>Or use embed the whole <code>IsError</code> check in a if and avoid the <code>GoTo</code>. But then you have to go one tab to the right and lose indentation:</p>\n\n<pre><code>Sub SkipIteration()\n    Dim x As Long\n    For x = 5 To -5 Step -1\n        If Not IsError(Evaluate(\"15 / \" &amp; x)) Then\n            Debug.Print 15 / x\n            Debug.Print x\n        End If\n    Next x\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2344, "user_id": 8461786, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/55878061e134ad81c5d169881b3c6d2e?s=128&d=identicon&r=PG&f=1", "display_name": "barciewicz", "link": "https://stackoverflow.com/users/8461786/barciewicz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 296, "favorite_count": 0, "accepted_answer_id": 52857572, "answer_count": 3, "score": 2, "last_activity_date": 1592826464, "creation_date": 1539785914, "last_edit_date": 1592826464, "question_id": 52857125, "link": "https://stackoverflow.com/questions/52857125/how-to-go-to-next-iteration-on-error-aka-simulating-pythons-continue-statemen", "title": "How to go to next iteration on error AKA simulating Python&#39;s &quot;continue&quot; statement in VBA?", "body": "<p>In the following code, how do I make the loop continue on next iteraration - not next line - after the error is encountered?</p>\n\n<p>Right now the code will not go past x=0:</p>\n\n<pre><code>Sub skip_iteration()\n\nDim x As Long\n\nFor x = 5 To -5 Step -1\n    On Error GoTo errhandler:\n    Debug.Print 15 / x\n    Debug.Print \"I don't want this to be printed on error\"\nNext x\n\nerrhandler:\nIf Err.Number = 11 Then\n    Debug.Print (\"Error on \" &amp; x)\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>I have looked into this answer: \n<a href=\"https://stackoverflow.com/questions/20681306/skip-to-next-iteration-in-loop-vba/30448991\">Skip to next iteration in loop vba</a> among others, but could not translate it to my code.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1110, "user_id": 5572384, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y2BvJ.jpg?s=128&g=1", "display_name": "StoneGiant", "link": "https://stackoverflow.com/users/5572384/stonegiant"}, "edited": false, "score": 2, "creation_date": 1539785998, "post_id": 52856952, "comment_id": 92629313, "body": "Why not set the interior color on the target cell just like you&#39;re doing on the source cell?"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1539786176, "post_id": 52856952, "comment_id": 92629431, "body": "Not your question, but you don&#39;t need <code>With FandR</code> if you are going to use <code>Set rngR = FandR.Range(&quot;H&quot;)</code>"}, {"owner": {"reputation": 1, "user_id": 10518981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a930aa6392bedb88bac5bc401bc65de?s=128&d=identicon&r=PG&f=1", "display_name": "Waris", "link": "https://stackoverflow.com/users/10518981/waris"}, "edited": false, "score": 0, "creation_date": 1539786745, "post_id": 52856952, "comment_id": 92629849, "body": "Thank you for the correction Cybernetic.nomad. StoneGiant, if I do that, it does nothing."}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1539789387, "post_id": 52856952, "comment_id": 92631449, "body": "Are worksheets FandR and PDH in the same workbook? Is this code in the ActiveWorkbook? Do you want to highlight the cells to which you are referring to with c.Offset(0, 1)? The &#39;i&#39; variable is used only one time in the &#39;Set rng&#39; line, so it is pretty useless."}, {"owner": {"reputation": 1, "user_id": 10518981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a930aa6392bedb88bac5bc401bc65de?s=128&d=identicon&r=PG&f=1", "display_name": "Waris", "link": "https://stackoverflow.com/users/10518981/waris"}, "edited": false, "score": 0, "creation_date": 1539789802, "post_id": 52856952, "comment_id": 92631682, "body": "the i variable is useless agreed. All these are in the same, active, workbook. FandR has a list of values to search for in column H and in column I values to replace with. The code searches for the H values in column E of sheet PDH and replaces it with FandR!I:I values. However, when the values are replaced, I would also like it to highlight or flag the replaced value in some way. Thank you for your help!"}, {"owner": {"reputation": 1, "user_id": 10518981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a930aa6392bedb88bac5bc401bc65de?s=128&d=identicon&r=PG&f=1", "display_name": "Waris", "link": "https://stackoverflow.com/users/10518981/waris"}, "edited": false, "score": 0, "creation_date": 1539791850, "post_id": 52856952, "comment_id": 92632811, "body": "I figured it out, the replace function has an inbuilt replaceformat function. However, this is a T/F function and the replace format must defined using with function."}, {"owner": {"reputation": 1, "user_id": 10518981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a930aa6392bedb88bac5bc401bc65de?s=128&d=identicon&r=PG&f=1", "display_name": "Waris", "link": "https://stackoverflow.com/users/10518981/waris"}, "edited": false, "score": 0, "creation_date": 1539796897, "post_id": 52856952, "comment_id": 92635324, "body": "With Application.ReplaceFormat.Interior         .PatternColorIndex = xlAutomatic         .ThemeColor = xlThemeColorAccent1         .TintAndShade = 0         .PatternTintAndShade = 0         End With"}], "owner": {"reputation": 1, "user_id": 10518981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a930aa6392bedb88bac5bc401bc65de?s=128&d=identicon&r=PG&f=1", "display_name": "Waris", "link": "https://stackoverflow.com/users/10518981/waris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1539785434, "creation_date": 1539785434, "question_id": 52856952, "link": "https://stackoverflow.com/questions/52856952/vba-multiple-value-find-and-replace-but-also-highlight-replaced-cells", "title": "VBA Multiple value find and replace but also highlight replaced cells", "body": "<p>I have a code that finds and replaces values in one sheet from a list in another sheet. However, I need this code to also highlight the cell, or flag it in some way so that it can be reviewed manually later. Any suggestions? </p>\n\n<p>Here is the code:</p>\n\n<pre><code>Sub ReplaceValues()\nDim FandR As Worksheet\nDim PDH As Worksheet\nDim rng As Range, rngR As Range\nDim i As Long\nDim rngReplacement\nDim c As Range\nDim curVal As String\n\nSet FandR = Sheets(\"Find and Replace\")\nSet PDH = ThisWorkbook.Sheets(\"Paste Data here\")\ni = PDH.Rows.Count\nWith PDH\nSet rng = .Range(\"E1\", .Range(\"E\" &amp; i).End(xlUp))\nEnd With\n\nWith FandR\n    Set rngR = FandR.Range(\"H\")\n\nEnd With\n\n\nFor Each c In rngR\n    curVal = c.Value\n    c.Interior.Color = vbYellow\n\n    With rng\n        .Replace curVal, c.Offset(0, 1).Value, xlWhole, , True\n\n    End With\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1110, "user_id": 5572384, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y2BvJ.jpg?s=128&g=1", "display_name": "StoneGiant", "link": "https://stackoverflow.com/users/5572384/stonegiant"}, "edited": false, "score": 0, "creation_date": 1539786204, "post_id": 52856767, "comment_id": 92629456, "body": "Try looping through the sheets in the workbook that aren&#39;t the front page."}, {"owner": {"reputation": 11, "user_id": 10518928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb34987949c9aa815d8ada87884bab2f?s=128&d=identicon&r=PG&f=1", "display_name": "chxrlotter", "link": "https://stackoverflow.com/users/10518928/chxrlotter"}, "edited": false, "score": 0, "creation_date": 1539786344, "post_id": 52856767, "comment_id": 92629566, "body": "current code is:       Private Sub CommandButton1_Click()       Dim c As Range     Dim j As Integer     Dim Source As Worksheet     Dim Target As Worksheet       &#39; Change worksheet designations as needed     Set Source = ActiveWorkbook.Worksheets(&quot;Front Page&quot;)     Set Target = ActiveWorkbook.Worksheets(&quot;Charlotte&quot;)       j = 2     &#39; Start copying to row 2 in target sheet     For Each c In Source.Range(&quot;C1:C1000&quot;)   &#39; Do 1000 rows         If c = &quot;Charlotte Richardson&quot; Then            Source.Rows(c.Row).Copy Target.Rows(j)            j = j + 1         End If     Next c End Sub"}, {"owner": {"reputation": 11, "user_id": 10518928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb34987949c9aa815d8ada87884bab2f?s=128&d=identicon&r=PG&f=1", "display_name": "chxrlotter", "link": "https://stackoverflow.com/users/10518928/chxrlotter"}, "edited": false, "score": 1, "creation_date": 1539786481, "post_id": 52856767, "comment_id": 92629657, "body": "I should probably mention that I scoured the internet for hours to finally find this code as none others did what I wanted. I didn\u2019t write it myself! Beyond newbie!"}, {"owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "edited": false, "score": 0, "creation_date": 1539786521, "post_id": 52856767, "comment_id": 92629678, "body": "@chxrlotter you should edit your question and add that code above"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1539793698, "post_id": 52856767, "comment_id": 92633808, "body": "You need to get a list of unique names (using e,g advanced filter) and then loop through that replacing &quot;Charlotte Richardson&quot; with each name."}], "answers": [{"comments": [{"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 1, "creation_date": 1539799021, "post_id": 52859500, "comment_id": 92636339, "body": "Nice one, didn&#39;t occur to me to use two arrays and populate them your way."}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": false, "score": 1, "last_activity_date": 1539793468, "creation_date": 1539793468, "answer_id": 52859500, "question_id": 52856767, "link": "https://stackoverflow.com/questions/52856767/how-to-search-the-same-column-for-more-than-one-value/52859500#52859500", "title": "How to search the same column for more than one value?", "body": "<p>Try this - although you'll have to add the worksheet names to the array <code>arr1</code> and the full names you're looking for to the array <code>arr2</code>:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    Dim c As Range\n    Dim j As Long, i as Long\n    Dim Source As Worksheet\n    Dim Target As Worksheet\n    Dim arr1 As Variant, arr2 As Variant\n\n    arr1 = Array(\"Charlotte\", \"Mikey\", \"Bob\")\n    arr2 = Array(\"Charlotte Richardson\", \"Mikey Joe\", \"Bob Vann\")\n\n    'Change worksheet designations as needed\n    Set Source = ActiveWorkbook.Worksheets(\"Front Page\")\n\n    'Start copying to row 2 in target sheet\n    For i = 0 To UBound(arr1)\n\n        j = 2\n        Set Target = ActiveWorkbook.Worksheets(arr1(i))\n\n        For Each c In Source.Range(\"C1:C1000\") ' Do 1000 rows\n            If c = arr2(i) Then\n                Source.Rows(c.Row).Copy Target.Rows(j)\n                j = j + 1\n            End If\n        Next c\n\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1539798325, "post_id": 52860159, "comment_id": 92635998, "body": "I like it, but the names in the tabs would be too long to see them all at once, but how about the other way around: change the  data in the column to names only."}, {"owner": {"reputation": 968, "user_id": 5910169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a40180e3fa49fbf4e55145adf54d9?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Ball", "link": "https://stackoverflow.com/users/5910169/frank-ball"}, "reply_to_user": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1539798499, "post_id": 52860159, "comment_id": 92636083, "body": "The problem with using first names only is that when you have Bob Smith and Bob Jones working for you , you have a big problem."}, {"owner": {"reputation": 968, "user_id": 5910169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a40180e3fa49fbf4e55145adf54d9?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Ball", "link": "https://stackoverflow.com/users/5910169/frank-ball"}, "reply_to_user": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 1, "creation_date": 1539799190, "post_id": 52860159, "comment_id": 92636416, "body": "You can also try this solution from Mr Excel.  You would place this code in &quot;Front Page&quot; workbook in VBA.  What it does is when you dbl-click on a cell containing the staff member&#39;s name, it will take you directly to that person&#39;s sheet. Not a perfect solution, but it works very well for getting you to a sheet quickly.  You could even set up a list on your &quot;Front Page&quot; sheet that contains the staff names and use that.  <a href=\"https://www.mrexcel.com/forum/excel-questions/147286-show-sheet-tabs-two-rows-post721368.html#post721368\" rel=\"nofollow noreferrer\">mrexcel.com/forum/excel-questions/&hellip;</a>"}], "tags": [], "owner": {"reputation": 968, "user_id": 5910169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a40180e3fa49fbf4e55145adf54d9?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Ball", "link": "https://stackoverflow.com/users/5910169/frank-ball"}, "is_accepted": false, "score": 1, "last_activity_date": 1539795850, "creation_date": 1539795850, "answer_id": 52860159, "question_id": 52856767, "link": "https://stackoverflow.com/questions/52856767/how-to-search-the-same-column-for-more-than-one-value/52860159#52860159", "title": "How to search the same column for more than one value?", "body": "<p>If you were to name your sheets with the exact name you're looking for (\"Charlotte Richardson\", instead of \"Charlotte\"), then you could use this:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n  Dim c As Range\n  Dim j As Integer, i As Integer\n  Dim Source As Worksheet\n\n  Set Source = ActiveWorkbook.Worksheets(\"Front Page\")\n  For i = 2 To ActiveWorkbook.Sheets.Count 'Assuming that \"Front Page\" is your first sheet\n    j = 2\n    ' Start copying to row 2 in target sheet\n    For Each c In Source.Range(\"C1:C1000\") ' Do 1000 rows\n      If c.Value2 = ActiveWorkbook.Worksheets(i).Name Then\n        Source.Rows(c.Row).Copy ActiveWorkbook.Worksheets(i).Rows(j)\n        j = j + 1\n      End If\n    Next c\n  Next\nEnd Sub\n</code></pre>\n\n<p>The nice thing about this is that when you have to add staff members all you have to do is add a new sheet with the correct name and your code will work without any modifications.</p>\n"}, {"tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 1, "last_activity_date": 1539797866, "creation_date": 1539797866, "answer_id": 52860646, "question_id": 52856767, "link": "https://stackoverflow.com/questions/52856767/how-to-search-the-same-column-for-more-than-one-value/52860646#52860646", "title": "How to search the same column for more than one value?", "body": "<h1>An Array Solution</h1>\n\n<p>It is strongly recommended that you <strong>create a copy of the original file</strong> and test the code there first. Open the workbook and go to <strong>SaveAs</strong> and save it with another name\u00b8like 'Test' or something. Now you're ready to 'play'.</p>\n\n<p><strong>Before using this code you will have to manually input the data in the 'Customize' section of the code.</strong></p>\n\n<p>Such a code should ideally preserve old data in the seven sheets and update only (add new rows) but it always <strong>deletes</strong> (ClearContents) the old data in the seven sheets starting from row 2, before adding the new data. Further more, the code has <strong>no error handling</strong>.</p>\n\n<p>On the other hand, the code does what it is supposed to do. If something would go wrong the 'Front Page' sheet is in no danger, so if something happens to the other sheets you can always create them again. </p>\n\n<pre><code>Private Sub CommandButton1_Click()\n  Dim c As Range\n  Dim i As Integer\n  Dim j As Integer\n  Dim Source As Worksheet\n  Dim Target As Worksheet\n  Dim arr() As String\n  'Create an array of data\n  ReDim arr(1 To 7, 1 To 2) As String\n'-- Customize BEGIN --------------------\n  'Sheet Names\n  arr(1, 1) = \"Charlotte\"\n  arr(2, 1) = \"\"\n  arr(3, 1) = \"\"\n  arr(4, 1) = \"\"\n  arr(5, 1) = \"\"\n  arr(6, 1) = \"\"\n  arr(7, 1) = \"\"\n  'Names in column 'C'\n  arr(1, 2) = \"Charlotte Richardson\"\n  arr(2, 2) = \"\"\n  arr(3, 2) = \"\"\n  arr(4, 2) = \"\"\n  arr(5, 2) = \"\"\n  arr(6, 2) = \"\"\n  arr(7, 2) = \"\"\n'-- Customize END ----------------------\n\n  Set Source = ActiveWorkbook.Worksheets(\"Front Page\")\n\n  For i = 1 To 7\n    j = 2\n    Set Target = ActiveWorkbook.Worksheets(arr(i, 1))\n    ' ClearContents of Target\n    Target.Range(j &amp; \":\" &amp; Target.Rows.Count).ClearContents\n    ' Start copying to row 2 in target sheet\n    For Each c In Source.Range(\"C1:C1000\") ' Do 1000 rows\n      If c = arr(i, 2) Then\n        Source.Rows(c.Row).Copy Target.Rows(j)\n        j = j + 1\n      End If\n    Next\n  Next\nEnd Sub\n</code></pre>\n\n<p>To fully understand the code you should read about <strong>arrays, loops, ranges</strong> and whatever keyword you see in the code.</p>\n"}], "owner": {"reputation": 11, "user_id": 10518928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb34987949c9aa815d8ada87884bab2f?s=128&d=identicon&r=PG&f=1", "display_name": "chxrlotter", "link": "https://stackoverflow.com/users/10518928/chxrlotter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 1, "answer_count": 3, "score": 1, "last_activity_date": 1602589247, "creation_date": 1539784869, "last_edit_date": 1602589247, "question_id": 52856767, "link": "https://stackoverflow.com/questions/52856767/how-to-search-the-same-column-for-more-than-one-value", "title": "How to search the same column for more than one value?", "body": "<p>I have a workbook which has eight worksheets. The first sheet is a front page which holds all the data within the workbook, a master sheet if you will. The remaining seven tabs are the staff names of the team.</p>\n<p>I have code which will search column C for a name and copy the entire row containing that name into the corresponding staff member's individual worksheet.</p>\n<p>I now need to search the same column (C) for the remaining staff members' names and copy the respective row to the respective worksheet.</p>\n<p>My current code:</p>\n<pre><code>Private Sub CommandButton1_Click()\n    Dim c As Range\n    Dim j As Integer\n    Dim Source As Worksheet\n    Dim Target As Worksheet\n    ' Change worksheet designations as needed\n    Set Source = ActiveWorkbook.Worksheets(&quot;Front Page&quot;)\n    Set Target = ActiveWorkbook.Worksheets(&quot;Charlotte&quot;)\n    j = 2\n    ' Start copying to row 2 in target sheet\n    For Each c In Source.Range(&quot;C1:C1000&quot;) ' Do 1000 rows\n        If c = &quot;Charlotte Richardson&quot; Then\n            Source.Rows(c.Row).Copy Target.Rows(j)\n            j = j + 1\n        End If\n    Next c\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1539785304, "post_id": 52856761, "comment_id": 92628843, "body": "<i>&quot;The code I have for working out the column headers is below, but it doesn&#39;t help with the rest.&quot;</i> - Not really sure what you mean by this, what is the exact problem you&#39;re running into?"}, {"owner": {"reputation": 1, "user_id": 10518882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13e3aef1ec11d05d0fc01bf1756d21cb?s=128&d=identicon&r=PG&f=1", "display_name": "Tills", "link": "https://stackoverflow.com/users/10518882/tills"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1539859080, "post_id": 52856761, "comment_id": 92657764, "body": "Sorry If I&#39;ve been unclear, I actually have this working as a formula, (=IF(AND(J$6&gt;=INDEX(&#39;Raw Data&#39;!$K$2:$K$8,MATCH(Table!$C7,&#39;Raw Data&#39;!$D$2:$D$8,0)),J$6&lt;=INDEX(&#39;Raw Data&#39;!$L$2:$L$8,MATCH(Table!$C7,&#39;Raw Data&#39;!$D$2:$D$8,0))),INDEX(&#39;Raw Data&#39;!$J$2:$J$8,MATCH(Table!$C7,&#39;Raw Data&#39;!$D$2:$D$8,0),1),&quot;&quot;)) however  a. it&#39;s a bit cumbersome and  b. I would like to run a for loop to check this formula in each of the cells (rather than having the formula in each cell) does this make sense?"}], "owner": {"reputation": 1, "user_id": 10518882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13e3aef1ec11d05d0fc01bf1756d21cb?s=128&d=identicon&r=PG&f=1", "display_name": "Tills", "link": "https://stackoverflow.com/users/10518882/tills"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1591592114, "creation_date": 1539784855, "last_edit_date": 1591592114, "question_id": 52856761, "link": "https://stackoverflow.com/questions/52856761/vba-creating-a-dynamic-table-and-proportionally-spreading-values-out-based-on", "title": "VBA - Creating a dynamic table and proportionally spreading values out based on variable term", "body": "<p>I'm quite new to VBA and have been doing some searching but have yet to find what I need.</p>\n\n<p>I have some data in a table that includes Id field, Commission amount, start date and contract term.</p>\n\n<p>From this data I need to create another table that in the first column has the IDs and after that creates a column header for each month (start (B1) and end months (B2) worked out from the data) and splits the commission equally over the term period. </p>\n\n<p>The code I have for working out the column headers is below, but it doesn't help with the rest.</p>\n\n<pre><code>Sub tableFill()\n  Dim d1 As Date, d2 As Date, Tbl As Range\n  d1 = Range(\"B1\").Value\n  d2 = Range(\"B2\").Value\n  Set Tbl = Range(\"J6:BV6\")\n  Call setLabels(d1, d2, Tbl)\nEnd Sub\n\nSub setLabels(dt1 As Date, dt2 As Date, rng As Range)\n    Dim rToFill As Range, r As Range\n    Set rToFill = Intersect(rng(1).EntireRow, rng).Offset(0, 0)\n    For Each r In rToFill\n        dv = DateSerial(Year(dt1), Month(dt1) + i, Day(dt1))\n        r.Value = dv\n        i = i + 1\n        If dt1 + i &gt; dt2 Then Exit Sub\n    Next r\nEnd Sub\n</code></pre>\n\n<p>Any help appreciated. Thanks</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11, "user_id": 10518880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0048fe7aab6a545a4f41f38082b5758a?s=128&d=identicon&r=PG&f=1", "display_name": "amie", "link": "https://stackoverflow.com/users/10518880/amie"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1539784687, "post_id": 52856534, "comment_id": 92628413, "body": "I am not able to pick the cell value from the excelsheet which is an output of sql server query. I have to compare 2 cell values and if there is difference then insert  an empty row.  I have just began and stuck . Sorry!"}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "edited": false, "score": 0, "creation_date": 1539785274, "post_id": 52856534, "comment_id": 92628818, "body": "@amie please post your code or a picture so you can help you."}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1539786053, "last_edit_date": 1539786053, "creation_date": 1539784329, "answer_id": 52856571, "question_id": 52856534, "link": "https://stackoverflow.com/questions/52856534/i-am-a-beginner-how-to-get-cell-value-in-variable-in-vba-excel/52856571#52856571", "title": "I am a beginner, How to get cell value in variable in VBA excel?", "body": "<p>You have the variable on the left and the assignment value on the right, accessed via <code>.Value</code> property of <code>Range</code> object. </p>\n\n<p>Comparing them depends on what type of comparison you want to do. I show an equal comparison of the two variables. You decide which operator you want to use and place between the two variables. </p>\n\n<p>I am showing single cell comparisons. If you try this with more than one cell you will actually generate an array which can't be housed in an <code>Integer</code> variable type. Also, you want <code>Long</code> rather than <code>Integer</code> to lessen chance of overflow by trying to put too large a numeric value in an <code>Integer</code>. You are also assuming that the datatype in the cell is numeric or can be coerced to numeric.</p>\n\n<p>e.g.</p>\n\n<pre><code>currValue = ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A1\").Value\ncompareValue = ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A2\").Value\n\nDebug.Print currValue = compareValue\n</code></pre>\n\n<p>You will need to follow some tutorials to get to understand this as it is pretty fundamental stuff.</p>\n"}, {"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 1, "last_activity_date": 1539785023, "last_edit_date": 1539785023, "creation_date": 1539784697, "answer_id": 52856704, "question_id": 52856534, "link": "https://stackoverflow.com/questions/52856534/i-am-a-beginner-how-to-get-cell-value-in-variable-in-vba-excel/52856704#52856704", "title": "I am a beginner, How to get cell value in variable in VBA excel?", "body": "<p>A brief explanation how to compare:</p>\n\n<pre><code>Sub Compare()\n\nDim CellValue As Integer, CompareWithValue As Integer\n\nCellValue = Sheet1.Range(\"A1\").Value '&lt;= The value in the A1 of Sheet1\nCompareWithValue = Sheet1.Range(\"A2\").Value '&lt;= The value in the A2 of \n                    Sheet1\n\nIf CellValue &gt; CompareWithValue Then '&lt;= Compare if CellValue is greater than \nCompareWithValue (here you can also use &lt; or =)\n'what do you want to happen if the above condition is true\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10518880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0048fe7aab6a545a4f41f38082b5758a?s=128&d=identicon&r=PG&f=1", "display_name": "amie", "link": "https://stackoverflow.com/users/10518880/amie"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "closed_date": 1539787422, "answer_count": 2, "score": -5, "last_activity_date": 1539786175, "creation_date": 1539784210, "last_edit_date": 1539786175, "question_id": 52856534, "link": "https://stackoverflow.com/questions/52856534/i-am-a-beginner-how-to-get-cell-value-in-variable-in-vba-excel", "closed_reason": "Needs more focus", "title": "I am a beginner, How to get cell value in variable in VBA excel?", "body": "<p>i am trying to compare cell values in a column in excel. If the number changes from 8 to 7 i have to insert a blank row. So i tried to take the values in variables and then compare them. But i am not able to set the value in variable :(</p>\n"}, {"tags": ["excel", "vba", "locale"], "comments": [{"owner": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "edited": false, "score": 0, "creation_date": 1539783952, "post_id": 52856304, "comment_id": 92627903, "body": "Have you tried it with &quot;1.6&quot;, &quot;1.67&quot;, &quot;1.678&quot; and &quot;1.6789&quot;? Works on my machine (also German local). I think the problem is, that the VBA-Editor always works in English"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1539784099, "post_id": 52856304, "comment_id": 92627989, "body": "Do you want to insert the values as number or text/string?"}, {"owner": {"reputation": 89, "user_id": 4706332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1967d814d73a5583b01967be32eaccc6?s=128&d=identicon&r=PG&f=1", "display_name": "JoshK", "link": "https://stackoverflow.com/users/4706332/joshk"}, "edited": false, "score": 0, "creation_date": 1539784174, "post_id": 52856304, "comment_id": 92628045, "body": "Yeah, that would work. The thing is, that in my program the ranges first get pulled from a range. And when I assign a string with <code>str = Cell.Value2</code> I&#39;ll get it with a &quot;,&quot;."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1539784252, "post_id": 52856304, "comment_id": 92628099, "body": "don&#39;t pull number values into a string variable."}, {"owner": {"reputation": 89, "user_id": 4706332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1967d814d73a5583b01967be32eaccc6?s=128&d=identicon&r=PG&f=1", "display_name": "JoshK", "link": "https://stackoverflow.com/users/4706332/joshk"}, "edited": false, "score": 0, "creation_date": 1539784351, "post_id": 52856304, "comment_id": 92628167, "body": "Yes but when I define my variable as Double, for example, it can&#39;t be Empty since the default state of a double is 0."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1539784399, "post_id": 52856304, "comment_id": 92628205, "body": "OK, please <a href=\"https://stackoverflow.com/posts/52856304/edit\">edit</a> your question and show the code that you are actually using. Explain your actual problem instead of that constructed one."}, {"owner": {"reputation": 89, "user_id": 4706332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1967d814d73a5583b01967be32eaccc6?s=128&d=identicon&r=PG&f=1", "display_name": "JoshK", "link": "https://stackoverflow.com/users/4706332/joshk"}, "edited": false, "score": 0, "creation_date": 1539784619, "post_id": 52856304, "comment_id": 92628365, "body": "The Code i&#39;m using is far to complex for this problem. It&#39;s supposed to transfer Data between Workbooks using Classes.  But i&#39;ll try doing a minimal example of that."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1539785735, "post_id": 52856304, "comment_id": 92629116, "body": "Your <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> is unclear and doesn&#39;t reflect the problem you&#39;re trying to solve. As it stands, the answer is <code>.Cells(1, 1).Value2 = 1.6</code>, i.e. don&#39;t write a string into a cell if you mean it to contain a number. It&#39;s also unclear where and how <code>Double</code> defaulting to 0 comes into play. Cells contain a <code>Variant</code>, the <code>Double</code> is the variant subtype, only when the cell contains a number. Thus, an empty cell <i>does</i> contain <code>Empty</code> (default <code>Variant</code> value)."}], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 4706332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1967d814d73a5583b01967be32eaccc6?s=128&d=identicon&r=PG&f=1", "display_name": "JoshK", "link": "https://stackoverflow.com/users/4706332/joshk"}, "edited": false, "score": 0, "creation_date": 1539784424, "post_id": 52856444, "comment_id": 92628222, "body": "Well if i would simply declare the value as double and i&#39;d pull an empty cell it still would be 0. But in my use case it&#39;s 0&lt;&gt;&quot;&quot;."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 89, "user_id": 4706332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1967d814d73a5583b01967be32eaccc6?s=128&d=identicon&r=PG&f=1", "display_name": "JoshK", "link": "https://stackoverflow.com/users/4706332/joshk"}, "edited": false, "score": 1, "creation_date": 1539786318, "post_id": 52856444, "comment_id": 92629550, "body": "@JoshK Then your code should check for empty cells before assigning them to the variable. That&#39;s not really a reason to use Strings!"}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 1, "last_activity_date": 1539783950, "creation_date": 1539783950, "answer_id": 52856444, "question_id": 52856304, "link": "https://stackoverflow.com/questions/52856304/value2-number-as-string/52856444#52856444", "title": "Value2 Number as string", "body": "<p>VBA operates as if in a US locale. If you manually entered those items into cells in a US locale, you'd see exactly the same results, namely coercion to a number once there are sufficient digits to warrant the comma being a thousands separator.</p>\n\n<p>I confess I don't really follow your logic with \"I often have to pass Double values as a string because I need to differ between \"0\" and \"\".\"</p>\n"}], "owner": {"reputation": 89, "user_id": 4706332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1967d814d73a5583b01967be32eaccc6?s=128&d=identicon&r=PG&f=1", "display_name": "JoshK", "link": "https://stackoverflow.com/users/4706332/joshk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 350, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1591592130, "creation_date": 1539783545, "last_edit_date": 1591592130, "question_id": 52856304, "link": "https://stackoverflow.com/questions/52856304/value2-number-as-string", "title": "Value2 Number as string", "body": "<p>I've encountered some strange behavior. \nI often have to pass Double values as a string because I need to differ between \"0\" and \"\". </p>\n\n<p>Look at this easy example: \n(I'm on a German locale, so my Decimal separator is a \",\") </p>\n\n<pre><code>Sub TestNumbers()\n    With ActiveSheet\n        .Cells(1, 1).Value2 = \"1,6\"\n        .Cells(1, 2).Value2 = \"1,67\"\n        .Cells(1, 3).Value2 = \"1,678\"\n        .Cells(1, 4).Value = \"1,6789\"\n    End With\nEnd Sub\n</code></pre>\n\n<p>And now look at the Output: \n<a href=\"https://i.stack.imgur.com/QW15I.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QW15I.png\" alt=\"Why the hell?\"></a></p>\n\n<p>Why does it omit the comma at 3 Decimal Places? It happens for <code>.value</code> and <code>.value2</code> as you can see.</p>\n"}, {"tags": ["excel", "vba", "copy-paste", "lookup"], "owner": {"reputation": 11, "user_id": 10518000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/541e589585503266c83cecf66c01ab99?s=128&d=identicon&r=PG&f=1", "display_name": "TCJ", "link": "https://stackoverflow.com/users/10518000/tcj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 235, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1544515013, "creation_date": 1539783418, "last_edit_date": 1544515013, "question_id": 52856260, "link": "https://stackoverflow.com/questions/52856260/macro-to-copy-and-paste-cell-to-offset-lookup", "title": "Macro to copy and paste cell to offset lookup", "body": "<p>I can't seem to find the right code for what I want to do. I've designed a very basic POS type system in excel for our shop:</p>\n\n<p><img src=\"https://i.stack.imgur.com/6xjQi.png\" alt=\"Sale\"></p>\n\n<p>When a stock number is typed into column A, column B,C,D &amp; E are populated using Index &amp; Match formula.</p>\n\n<p>When I press the cash/card/cheque button, Excel copies the information and pastes it in another sheet, then resets the form.</p>\n\n<p>This all works perfectly. However, what I also want to happen when the buttons are pressed is for Excel to copy the date and time at the top , search for the stock numbers in column A in the \"Stock\" sheet, and paste it into column I (Date Sold) of all the relevant cells.</p>\n\n<p>I have no idea how to even start this. Below is the current code for the button. It's not pretty, but it does the job:</p>\n\n<pre><code>Sub CASH()\nRange(\"F19\").Select\nActiveCell.FormulaR1C1 = \"CASH\"\n\nApplication.ScreenUpdating = False\nDim copySheet As Worksheet\nDim pasteSheet As Worksheet\n\nSet copySheet = Worksheets(\"Sale\")\nSet pasteSheet = Worksheets(\"Sales\")\n\ncopySheet.Range(\"A1:F20\").Copy\npasteSheet.Cells(Rows.Count, 1).End(xlUp).Offset(3, 0).PasteSpecial \nPaste:=xlPasteValuesAndNumberFormats, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\npasteSheet.Cells(Rows.Count, 1).End(xlUp).Offset(-19, 0).PasteSpecial \nPaste:=xlPasteFormats, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\nApplication.CutCopyMode = False\nApplication.ScreenUpdating = True\n\nApplication.Goto Reference:=\"Default\"\nSelection.Copy\nRange(\"A2\").Select\nActiveSheet.Paste\nApplication.CutCopyMode = False\nRange(\"A2\").Select\nEnd Sub\n</code></pre>\n\n<p>Any help would be greatly appreciated!</p>\n"}, {"tags": ["excel", "vba", "properties", "calculation"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 10518777, "user_type": "registered", "profile_image": "https://graph.facebook.com/1975555195844610/picture?type=large", "display_name": "Billy Kuhn", "link": "https://stackoverflow.com/users/10518777/billy-kuhn"}, "edited": false, "score": 0, "creation_date": 1539786223, "post_id": 52856412, "comment_id": 92629471, "body": "Sub Workbook_Open() Worksheets(&quot;Map&quot;).EnableCalculation = False Dim oldCalc As Boolean oldCalc = ActiveSheet.EnableCalculation ActiveSheet.EnableCalculation = False ActiveSheet.EnableCalculation = True ActiveSheet.EnableCalculation = oldCalc End Sub Is this what you mean?"}, {"owner": {"reputation": 540, "user_id": 7747667, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6XJn7.jpg?s=128&g=1", "display_name": "oxwilder", "link": "https://stackoverflow.com/users/7747667/oxwilder"}, "reply_to_user": {"reputation": 5, "user_id": 10518777, "user_type": "registered", "profile_image": "https://graph.facebook.com/1975555195844610/picture?type=large", "display_name": "Billy Kuhn", "link": "https://stackoverflow.com/users/10518777/billy-kuhn"}, "edited": false, "score": 0, "creation_date": 1539795613, "post_id": 52856412, "comment_id": 92634717, "body": "@BillyKuhn You can just do <code>Sub Workbook_Open()   Worksheets(&quot;Map&quot;).EnableCalculation = False   End Sub  </code> but keep in mind it won&#39;t recalculate that worksheet until the value is marked as <code>true</code>. In what circumstances would you want it to recalculate?"}, {"owner": {"reputation": 5, "user_id": 10518777, "user_type": "registered", "profile_image": "https://graph.facebook.com/1975555195844610/picture?type=large", "display_name": "Billy Kuhn", "link": "https://stackoverflow.com/users/10518777/billy-kuhn"}, "edited": false, "score": 0, "creation_date": 1539796910, "post_id": 52856412, "comment_id": 92635328, "body": "I seemed to got it working now. The code I had was applied to a button so it would only recalculate when the button was clicked. That way, when I was working in other tabs and entering in data, this worksheet would not be recalculating every time I typed because it is all based off of way to many formulas.  When I just had the string, I was not getting the enable calculation property turned off, but by combining it, and using the button on opening, it solves my problem."}, {"owner": {"reputation": 540, "user_id": 7747667, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6XJn7.jpg?s=128&g=1", "display_name": "oxwilder", "link": "https://stackoverflow.com/users/7747667/oxwilder"}, "reply_to_user": {"reputation": 5, "user_id": 10518777, "user_type": "registered", "profile_image": "https://graph.facebook.com/1975555195844610/picture?type=large", "display_name": "Billy Kuhn", "link": "https://stackoverflow.com/users/10518777/billy-kuhn"}, "edited": false, "score": 0, "creation_date": 1539797767, "post_id": 52856412, "comment_id": 92635716, "body": "@BillyKuhn Glad to hear it. If you&#39;re satisfied with the solution, mark the question as answered and that will help the next person looking for this sort of solution."}], "tags": [], "owner": {"reputation": 540, "user_id": 7747667, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6XJn7.jpg?s=128&g=1", "display_name": "oxwilder", "link": "https://stackoverflow.com/users/7747667/oxwilder"}, "is_accepted": true, "score": 0, "last_activity_date": 1539783847, "creation_date": 1539783847, "answer_id": 52856412, "question_id": 52856220, "link": "https://stackoverflow.com/questions/52856220/turn-off-enable-calculation/52856412#52856412", "title": "Turn off enable calculation", "body": "<p>Insert a module called <code>Sub Workbook_Open()</code> and add the line <code>ws.EnableCalculation = False</code> where ws is whichever worksheet you want to set the property for--for example <code>worksheets(\"Sheet4\")</code> or <code>worksheets(4)</code>. The Workbook_Open() sub will run automatically every time the workbook is opened.</p>\n"}], "owner": {"reputation": 5, "user_id": 10518777, "user_type": "registered", "profile_image": "https://graph.facebook.com/1975555195844610/picture?type=large", "display_name": "Billy Kuhn", "link": "https://stackoverflow.com/users/10518777/billy-kuhn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1697, "favorite_count": 0, "accepted_answer_id": 52856412, "answer_count": 1, "score": 0, "last_activity_date": 1593445374, "creation_date": 1539783282, "last_edit_date": 1593445374, "question_id": 52856220, "link": "https://stackoverflow.com/questions/52856220/turn-off-enable-calculation", "title": "Turn off enable calculation", "body": "<p>I have a workbook with a lot of different formulas and I have one worksheet in it called Map, that I need to not auto calculate, every time I enter new data into a different worksheet. I have the following VBA code below on this worksheet. The problem is I need to manually go to the Developer tab, Properties, EnableCalculation, and select False. When I do it this way, the code works perfectly. However when I close and re-open the workbook, the EnableCalculation in the Properties, has been automatically changed to True. I can't seem to come up with a code to turn this Property on this individual sheet only to False upon opening the workbook.</p>\n\n<p>Any suggestions on how to do this would be appreciated. I am new to coding, like this is my first time trying to write a VBA code and its taken me days to just get what I have below. So the more descriptive the better. Thank you!</p>\n\n<pre><code>Sub docalc()\nDim oldCalc As Boolean\noldCalc = ActiveSheet.EnableCalculation\nActiveSheet.EnableCalculation = False\nActiveSheet.EnableCalculation = True\nActiveSheet.EnableCalculation = oldCalc\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "userform"], "answers": [{"comments": [{"owner": {"reputation": 1331, "user_id": 10498111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8dd0523c4e1cb82448b30957581803a6?s=128&d=identicon&r=PG&f=1", "display_name": "usmanhaq", "link": "https://stackoverflow.com/users/10498111/usmanhaq"}, "reply_to_user": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "edited": false, "score": 0, "creation_date": 1539785089, "post_id": 52856562, "comment_id": 92628691, "body": "I added this because of two reasons (1) I feel it is always a good idea to initialize variables (2) 2nd is I haven\u2019t tested it but it is possible that when the form is initialized 2nd time it may get the old value of n (it do happens in some languages)"}, {"owner": {"reputation": 197, "user_id": 10186814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d70a16739b4f390d68b13008f18c6108?s=128&d=identicon&r=PG&f=1", "display_name": "Xavi", "link": "https://stackoverflow.com/users/10186814/xavi"}, "edited": false, "score": 0, "creation_date": 1539788724, "post_id": 52856562, "comment_id": 92631077, "body": "Thanks a lot Usmanhaq for your point, it seems it works a bit better with the initialization at 0...You are right concerning the new workbook open, if I open a new one when my userform is still open, It is not added automatically in the listbox (in other word my listbox is not dynamic). In this case, I have to Close the userform and reopen it again and then I can see the new workbook open in my Listbox."}], "tags": [], "owner": {"reputation": 1331, "user_id": 10498111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8dd0523c4e1cb82448b30957581803a6?s=128&d=identicon&r=PG&f=1", "display_name": "usmanhaq", "link": "https://stackoverflow.com/users/10498111/usmanhaq"}, "is_accepted": true, "score": 2, "last_activity_date": 1539784308, "creation_date": 1539784308, "answer_id": 52856562, "question_id": 52855768, "link": "https://stackoverflow.com/questions/52855768/userform-to-navigate-between-severals-open-workbooks/52856562#52856562", "title": "Userform to navigate between severals open workbooks", "body": "<p>I can think of three problems</p>\n\n<ol>\n<li>First can be a problem of initializing, i have initialized n = 0</li>\n</ol>\n\n<blockquote>\n<pre><code>Sub UserForm_Initialize()\n    Dim n As Long\n    n = 0\n    Do\n        n = n + 1\n        Me.ListBox1.AddItem Workbooks(n).Name\n    Loop Until n = Workbooks.Count\nEnd Sub\n</code></pre>\n</blockquote>\n\n<ol start=\"2\">\n<li><p>Second one is the form is taking the list of workbooks when you are opening it, so logically it will not look for any workbook opened after its initialization</p></li>\n<li><p>third problem can be the excel window. Your form will take the workbooks in one excel window, if you open two excels, it will not take excel workbooks from that.\nAs an example take following cases.</p></li>\n</ol>\n\n<p>a. When you double click an excel file, it opens in the same window.</p>\n\n<p>b. When you click open in the already existing excel window and opens a file it will open in same window</p>\n\n<p>c. When you open another excel from the excel shortcut, you are opening another excel and any file in that excel will not be included in you form.</p>\n\n<p>My knowledge is limited to few versions of excel, maybe in other versions things are different, but in the ones i have seen these can be the cases.</p>\n"}], "owner": {"reputation": 197, "user_id": 10186814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d70a16739b4f390d68b13008f18c6108?s=128&d=identicon&r=PG&f=1", "display_name": "Xavi", "link": "https://stackoverflow.com/users/10186814/xavi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 52856562, "answer_count": 1, "score": 0, "last_activity_date": 1593677207, "creation_date": 1539781996, "last_edit_date": 1593677207, "question_id": 52855768, "link": "https://stackoverflow.com/questions/52855768/userform-to-navigate-between-severals-open-workbooks", "title": "Userform to navigate between severals open workbooks", "body": "<p>I have a small program VBA which is fact a userform which allows me to display all the existing workbooks which are currently open. Via this userform I can select another workbook and by clicking the name of the workbook displays in the listbox, it reorients me to the desired Workbook by activating it. The problem is that it does not work every time and sometimes when I try to click on the desired workbook on my listbox, it does not necessarily reorient me to the desired workbook. Maybe the code related to my listbox has something wrong: <code>With Me.ListBox1If .ListIndex &lt;&gt; -1 Then Workbooks (.Value).Activate</code>\nIf someone can help me, that would be really great.</p>\n\n<p>Thanks\nXavier</p>\n\n<p>Please find my code below:</p>\n\n<pre><code>'code in module in VBAproject (personal.XLSB)\nSub UserFormmanagementworkbooks()\n    UserForm2.Show vbModeless\nEnd Sub\n\n'code in userform called Userform2\nSub UserForm_Initialize()\n    Dim n As Long\n    Do\n        n = n + 1\n        Me.ListBox1.AddItem Workbooks(n).Name\n    Loop Until n = Workbooks.Count\nEnd Sub\n\nSub ListBox1_Click()\n    With Me.ListBox1\n        If .ListIndex &lt;&gt; -1 Then Workbooks(.Value).Activate\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1539781917, "post_id": 52855682, "comment_id": 92626552, "body": "You are not showing all of the relevant part of the code. We need to see where you set <code>selRng</code>"}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 10197573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c568aae2b1bcddb97cb779784225073?s=128&d=identicon&r=PG&f=1", "display_name": "SoftJellyfish", "link": "https://stackoverflow.com/users/10197573/softjellyfish"}, "edited": false, "score": 0, "creation_date": 1539782584, "post_id": 52855803, "comment_id": 92626985, "body": "That worked perfectly, thanks! Modified my code as well to have everything in one If condition."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 2, "last_activity_date": 1539782094, "creation_date": 1539782094, "answer_id": 52855803, "question_id": 52855682, "link": "https://stackoverflow.com/questions/52855682/excel-row-coloring-goes-beyond-the-used-range/52855803#52855803", "title": "Excel row coloring goes beyond the used range", "body": "<p>To restrict it to the usedrange (which is not always accurate), you could use:</p>\n\n<pre><code>Intersect(cell.EntireRow, cell.worksheet.usedrange).Interior.Color = RGB(0, 200, 0)\n</code></pre>\n\n<p>Also, you don't really need three If statements, just one, since it's the same colour each time:</p>\n\n<pre><code>If InStr(cell.value, \"_cb\") Or InStr(cell.value, \"_mou\") or InStr(cell.value, \"_ebp\") Then\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1539783544, "last_edit_date": 1539783544, "creation_date": 1539783008, "answer_id": 52856141, "question_id": 52855682, "link": "https://stackoverflow.com/questions/52855682/excel-row-coloring-goes-beyond-the-used-range/52856141#52856141", "title": "Excel row coloring goes beyond the used range", "body": "<p>If the last column is always \"CB\" in all the occasions you can use:</p>\n\n<pre><code>Range(\"A\" &amp; cell.Row &amp; \":CB\" &amp; cell.Row).Interior.Color = RGB(0, 200, 0)\n</code></pre>\n\n<p>However, if last column is not fix you can use:</p>\n\n<pre><code>If InStr(cell.Value, \"_cb\") Or InStr(cell.Value, \"_mou\") Or InStr(cell.Value, \"_ebp\") Then\n    LastColumn = Worksheets(\"Data\").Cells(cell.Row, Worksheets(\"Data\").Columns.Count).End(xlToLeft).Column\n    Range(Cells(cell.Row, 1), Cells(cell.Row, LastColumn)).Interior.Color = RGB(0, 200, 0)\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 10197573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c568aae2b1bcddb97cb779784225073?s=128&d=identicon&r=PG&f=1", "display_name": "SoftJellyfish", "link": "https://stackoverflow.com/users/10197573/softjellyfish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "accepted_answer_id": 52855803, "answer_count": 2, "score": 0, "last_activity_date": 1539783544, "creation_date": 1539781764, "question_id": 52855682, "link": "https://stackoverflow.com/questions/52855682/excel-row-coloring-goes-beyond-the-used-range", "title": "Excel row coloring goes beyond the used range", "body": "<p>lemme start by showing a snippet of code</p>\n\n<pre><code>For Each cell In selRng.Cells\n    If InStr(cell.value, \"_cb\") Then\n        cell.EntireRow.Interior.Color = RGB(0, 200, 0)\n    End If\n    If InStr(cell.value, \"_mou\") Then\n        cell.EntireRow.Interior.Color = RGB(0, 200, 0)\n    End If\n    If InStr(cell.value, \"_ebp\") Then\n        cell.EntireRow.Interior.Color = RGB(0, 200, 0)\n    End If\nNext cell\n</code></pre>\n\n<p>All this code does is that it checks if the end of the string in a cell contains any of those three substrings, after that it will color the while row green.</p>\n\n<p>The issue comes from the fact that the line is gonna be colored way beyond the used range, I tried deleting the extra lines being used in the end but to no avail, there is always one line that remains at the very end of the worksheet where the green lines spill out from. </p>\n\n<p>It looks like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/4rI4H.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4rI4H.png\" alt=\"Green Lines Spilling\"></a></p>\n\n<p>I know there has to be a way to fix this but I cannot seem to be able to find what exactly is wrong with the code.</p>\n"}, {"tags": ["excel", "vba", "office365"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 2, "creation_date": 1539781542, "post_id": 52855527, "comment_id": 92626314, "body": "What is the idea of this - <code>Ft.Range(&quot;O5:R10&quot; &amp; Num)</code>?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1539781546, "post_id": 52855527, "comment_id": 92626319, "body": "What is the value of <code>Num</code> at the time of error?"}, {"owner": {"reputation": 23, "user_id": 10455161, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2OjbbEiLEeU/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVNWsibzXxQPKmXrvuqnG-p5PBmfw/mo/photo.jpg?sz=128", "display_name": "Jonas Korani", "link": "https://stackoverflow.com/users/10455161/jonas-korani"}, "edited": false, "score": 0, "creation_date": 1539782181, "post_id": 52855527, "comment_id": 92626714, "body": "It gets my criteria from those places. My num equals to 6. at that moment.  That is for my advanced filter function using Listbox"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1539783625, "post_id": 52855527, "comment_id": 92627700, "body": "do you realize that for <code>Num = 6</code> the <code>&quot;O5:R10&quot; &amp; Num</code> will result in <code>&quot;O5:R106&quot;</code> and for <code>Num = 10</code> it will jump to <code>&quot;O5:R1010&quot;</code>? This cannot be correct. Please <a href=\"https://stackoverflow.com/posts/52855527/edit\">edit</a> your question and explain your overall goal detailed. You are asking the wrong question."}, {"owner": {"reputation": 23, "user_id": 10455161, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2OjbbEiLEeU/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVNWsibzXxQPKmXrvuqnG-p5PBmfw/mo/photo.jpg?sz=128", "display_name": "Jonas Korani", "link": "https://stackoverflow.com/users/10455161/jonas-korani"}, "edited": false, "score": 0, "creation_date": 1539784032, "post_id": 52855527, "comment_id": 92627952, "body": "Good catch sir! It was suppost to be Ft.Range(&quot;O5:R&quot; &amp; Num), I have been playing around a little.  This should ofc be jumping between 05:R5 and O5:R10 Ill check if this solved my issue. But tbh i doubt it, because this is why i tried playing around in first place, to fix the issue"}, {"owner": {"reputation": 23, "user_id": 10455161, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2OjbbEiLEeU/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVNWsibzXxQPKmXrvuqnG-p5PBmfw/mo/photo.jpg?sz=128", "display_name": "Jonas Korani", "link": "https://stackoverflow.com/users/10455161/jonas-korani"}, "edited": false, "score": 0, "creation_date": 1539785609, "post_id": 52855527, "comment_id": 92629038, "body": "Still getting the Error.  THe problem here is that im getting the same error even if i preset the criteria cell myself manually, it shows error in that line.  O5:R5 and remove &amp;num  This string will basically get my criteria from O5 to RX depandend on what value in G2 is."}], "answers": [{"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1539844363, "post_id": 52866524, "comment_id": 92649913, "body": "No <code>Ft.range(&quot;O5:R10&quot; &amp; Num)</code> works. <code>Num</code> is a <code>Range</code> object and because of concatenating it to a <code>String</code> using <code>&amp;</code> its <code>.Value</code> is automatically cast into a <code>String</code>. You can easily test it."}, {"owner": {"reputation": 23, "user_id": 10455161, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2OjbbEiLEeU/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVNWsibzXxQPKmXrvuqnG-p5PBmfw/mo/photo.jpg?sz=128", "display_name": "Jonas Korani", "link": "https://stackoverflow.com/users/10455161/jonas-korani"}, "edited": false, "score": 0, "creation_date": 1539844769, "post_id": 52866524, "comment_id": 92650049, "body": "that is correct, basically Ft.range(&quot;O5:R&quot; &amp; Num) will change from depandend on the value in &quot;Num&quot; So it could be dynamic from O5:R5 and up to O5:R(value of Num) works fine"}], "tags": [], "owner": {"reputation": 164, "user_id": 10184585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c63a1c236c7ce5e1e261b113e05fe7a?s=128&d=identicon&r=PG&f=1", "display_name": "Bruce", "link": "https://stackoverflow.com/users/10184585/bruce"}, "is_accepted": false, "score": -1, "last_activity_date": 1539832845, "creation_date": 1539832845, "answer_id": 52866524, "question_id": 52855527, "link": "https://stackoverflow.com/questions/52855527/vba-getting-error-run-time-error-1004-help/52866524#52866524", "title": "VBA Getting error &quot;Run time error 1004 help&quot;", "body": "<p>Ft.range (\"O5:R10\" &amp; Num) is the wrong usage. Try this code: </p>\n\n<blockquote>\n  <p>Dt.Range(\"A1\").CurrentRegion.AdvancedFilter Action:=xlFilterCopy, _\n      CriteriaRange:=Ft.Range(\"O5:R10,\" &amp; Num.Address), CopyToRange:=Ft.Range(\"B12:V12\"), Unique:=False</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1539844903, "post_id": 52868253, "comment_id": 92650115, "body": "Since the issue cannot reproduced anymore and is solved in a manner unlikely to help future readers, I voted to close it. \u2022 Thx for your feedback."}], "tags": [], "owner": {"reputation": 23, "user_id": 10455161, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2OjbbEiLEeU/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVNWsibzXxQPKmXrvuqnG-p5PBmfw/mo/photo.jpg?sz=128", "display_name": "Jonas Korani", "link": "https://stackoverflow.com/users/10455161/jonas-korani"}, "is_accepted": false, "score": 0, "last_activity_date": 1539844626, "creation_date": 1539844626, "answer_id": 52868253, "question_id": 52855527, "link": "https://stackoverflow.com/questions/52855527/vba-getting-error-run-time-error-1004-help/52868253#52868253", "title": "VBA Getting error &quot;Run time error 1004 help&quot;", "body": "<p>I appriciate the time you have put in to help me. I found out what the problem was.</p>\n\n<p>I normally import CSV file that is getting converted to excel database which this program is built on, Somehow somewhere my CSV file got corrupted and the import was changed was made so the headers was different than the Advanced filter once, so when the advanced filter tried to find my values it couldent locate them with the criteria. </p>\n\n<p>I wish you all a nice day and again, thank you</p>\n"}], "owner": {"reputation": 23, "user_id": 10455161, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2OjbbEiLEeU/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVNWsibzXxQPKmXrvuqnG-p5PBmfw/mo/photo.jpg?sz=128", "display_name": "Jonas Korani", "link": "https://stackoverflow.com/users/10455161/jonas-korani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 128, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1539844626, "creation_date": 1539781336, "last_edit_date": 1539786005, "question_id": 52855527, "link": "https://stackoverflow.com/questions/52855527/vba-getting-error-run-time-error-1004-help", "title": "VBA Getting error &quot;Run time error 1004 help&quot;", "body": "<p>Can you see any error with this code ? It have been running flawlessly for a while, but suddently im getting </p>\n\n<blockquote>\n  <p>1004 the extract range has a missing or invalid field name</p>\n</blockquote>\n\n<p>all the time. I cant figure out why. I have modified my Excel very much since last so every now and then it just poops up.</p>\n\n<pre><code>Sub FilterMe()\n    Dim Num As Range\n    Dim Dt As Worksheet, Ft As Worksheet\n\n\n    Set Dt = Sheets(\"Data\")\n    Set Ft = Sheets(\"FilterData\")\n    Set Num = Sheets(\"FilterData\").Range(\"G2\")\n\n    Dt.Range(\"A1\").CurrentRegion.AdvancedFilter Action:=xlFilterCopy, _\n    CriteriaRange:=Ft.Range(\"O5:R10\" &amp; Num), CopyToRange:=Ft.Range(\"B12:V12\"), Unique:=False\n\n '   Application.Calculation = xlCalculationAutomatic\n '   Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>The debugger shows error at this line:</p>\n\n<pre><code>CriteriaRange:=Ft.Range(\"O5:R10\" &amp; Num), CopyToRange:=Ft.Range(\"B12:V12\"), Unique:=False\n</code></pre>\n\n<p>I have tried to change <code>Num</code> from <code>Range</code>, to <code>Integer</code>, to <code>String</code> and many other options. But for some reason it wont accept that.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 3, "creation_date": 1539780872, "post_id": 52855293, "comment_id": 92625855, "body": "Your code is incomplete. Please copy/paste your code instead of re-typing it here. Then also format and indent it correctly for better readability."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 10476338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4714ee4ec4a66f21db2f77077760bbb6?s=128&d=identicon&r=PG&f=1", "display_name": "nikhilsharma", "link": "https://stackoverflow.com/users/10476338/nikhilsharma"}, "edited": false, "score": 0, "creation_date": 1539832447, "post_id": 52856066, "comment_id": 92646677, "body": "Hi @Chronocidal, Thanks for helping me, however the count does not adjust according to the autofilter. So when i filter the rows, the count should reflect the change. For instance when i deselect Class A in the autofilter, the count should change"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "reply_to_user": {"reputation": 23, "user_id": 10476338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4714ee4ec4a66f21db2f77077760bbb6?s=128&d=identicon&r=PG&f=1", "display_name": "nikhilsharma", "link": "https://stackoverflow.com/users/10476338/nikhilsharma"}, "edited": false, "score": 0, "creation_date": 1539848030, "post_id": 52856066, "comment_id": 92651676, "body": "@nikhilsharma Which of the options are you using?  If you&#39;re using a UDF, you may need <code>Application.Volatile</code> at the start to make it recalculate when the workbook changes"}, {"owner": {"reputation": 23, "user_id": 10476338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4714ee4ec4a66f21db2f77077760bbb6?s=128&d=identicon&r=PG&f=1", "display_name": "nikhilsharma", "link": "https://stackoverflow.com/users/10476338/nikhilsharma"}, "edited": false, "score": 0, "creation_date": 1539850012, "post_id": 52856066, "comment_id": 92652718, "body": ",yes its a UDF,"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "reply_to_user": {"reputation": 23, "user_id": 10476338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4714ee4ec4a66f21db2f77077760bbb6?s=128&d=identicon&r=PG&f=1", "display_name": "nikhilsharma", "link": "https://stackoverflow.com/users/10476338/nikhilsharma"}, "edited": false, "score": 0, "creation_date": 1539850191, "post_id": 52856066, "comment_id": 92652818, "body": "@nikhilsharma Read <a href=\"https://docs.microsoft.com/en-gb/office/vba/api/Excel.Application.Volatile\" rel=\"nofollow noreferrer\">this MSDN article</a>"}, {"owner": {"reputation": 23, "user_id": 10476338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4714ee4ec4a66f21db2f77077760bbb6?s=128&d=identicon&r=PG&f=1", "display_name": "nikhilsharma", "link": "https://stackoverflow.com/users/10476338/nikhilsharma"}, "edited": false, "score": 0, "creation_date": 1539850493, "post_id": 52856066, "comment_id": 92652976, "body": "let me give it a try. I posted my code based on your suggestions in the answer below"}], "tags": [], "owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "is_accepted": true, "score": 1, "last_activity_date": 1539782803, "creation_date": 1539782803, "answer_id": 52856066, "question_id": 52855293, "link": "https://stackoverflow.com/questions/52855293/countif-changes-with-autofilter-for-multiple-columns/52856066#52856066", "title": "countif changes with autofilter for multiple columns", "body": "<p>If this <strong>does</strong> need to be in VBA - and I can think of various situations where it would - then you can use <code>Range.SpecialCells(xlCellTypeVisible)</code> to get <em>only</em> the Cells that are Visible - e.g.</p>\n\n<pre><code>Dim Col_Dessert As Long, Col_Snack As Long\n\nDim i As Long\nDim rowCheck As Range, wsCheck As Worksheet\n\nCol_Dessert = 5\nCol_Snack = 6\n\ni = 0\nSet wsCheck = Worksheets(\"JIS\")\nFor Each rowCheck In Intersect(wsCheck.AutoFilter.Range.Columns(1), wsCheck.AutoFilter.Range.SpecialCells(xlCellTypeVisible)).Cells\n    If wsCheck.Cells(rowCheck.Row, Col_Dessert).Value = \"L\" And wsCheck.Cells(rowCheck.Row, Col_Dessert).Value = \"WESTERN\" Then\n        i = i + 1\n    End If\nNext rowCheck\n\nSet wsCheck = Nothing\n</code></pre>\n\n<p>However, if you are trying to create User Defined Function to do this in the Worksheet, consider a <code>SUMPRODUCT</code> with <code>SUBTOTAL(103</code> (i.e. <code>COUNTA</code> while ignoring hidden rows) instead.  Basic form:</p>\n\n<pre><code>=SUMPRODUCT(--(ConditionRange1=\"Value1\")*--(ConditionRange2=\"Value2\")*--SUBTOTAL(103,OFFSET($A$1,ROW(ConditionRange1)-1,0)))\n</code></pre>\n\n<p>Adapted for you, to match <code>\"L\"</code> in Column E and <code>\"WESTERN\"</code> in Column F:</p>\n\n<pre><code>=SUMPRODUCT(--($E$1:$E$100=\"L\")*--($F$1:$F$100=\"WESTERN\")*--SUBTOTAL(103,OFFSET($A$1,ROW($A$1:$A$100)-1,0)))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 10476338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4714ee4ec4a66f21db2f77077760bbb6?s=128&d=identicon&r=PG&f=1", "display_name": "nikhilsharma", "link": "https://stackoverflow.com/users/10476338/nikhilsharma"}, "is_accepted": false, "score": 0, "last_activity_date": 1539832789, "creation_date": 1539832789, "answer_id": 52866518, "question_id": 52855293, "link": "https://stackoverflow.com/questions/52855293/countif-changes-with-autofilter-for-multiple-columns/52866518#52866518", "title": "countif changes with autofilter for multiple columns", "body": "<pre><code>Dim i As Integer\nDim r As Range\nDim wsCheck As Worksheet\n\ni = 0\nSet wsCheck = Worksheets(\"JIS\")\nFor Each r In Intersect(wsCheck.AutoFilter.Range.Columns(5), wsCheck.AutoFilter.Range.SpecialCells(xlCellTypeVisible)).Cells\n    If wsCheck.Cells(r.Row, Col_Starter).Value = \"S\" And wsCheck.Cells(r.Row, Col_Dessert).Value = \"WESTERN\" Then\n        i = i + 1\n        wsCheck.Range(\"A5\") = \"S:\" &amp; \" \" &amp; i\n    End If\nNext r\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 10476338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4714ee4ec4a66f21db2f77077760bbb6?s=128&d=identicon&r=PG&f=1", "display_name": "nikhilsharma", "link": "https://stackoverflow.com/users/10476338/nikhilsharma"}, "is_accepted": false, "score": 0, "last_activity_date": 1539853462, "creation_date": 1539853462, "answer_id": 52870582, "question_id": 52855293, "link": "https://stackoverflow.com/questions/52855293/countif-changes-with-autofilter-for-multiple-columns/52870582#52870582", "title": "countif changes with autofilter for multiple columns", "body": "<pre><code>Dim i As Long \nDim r As Range\n Dim wsCheck As Worksheet \ni = 0 \nSet wsCheck = Worksheets(\"JIS\")\n wsCheck.Application.Volatile (True) \nFor Each r In Intersect(wsCheck.AutoFilter.Range.Columns(Col_Western), wsCheck.AutoFilter.Range.SpecialCells(xlCellTypeVisible)).Cells\nIf wsCheck.Cells(r.Row, Col_Starter).Value = \"S\" And wsCheck.Cells(r.Row, Col_Dessert).Value = \"WESTERN\" Then i = i + 1 wsCheck.Range(\"A5\") = \"S:\" &amp; \" \" &amp; i \nEnd If \nNext r \nSet wsCheck = Nothing\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3404, "user_id": 2181188, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/7JwZP.jpg?s=128&g=1", "display_name": "Fandango68", "link": "https://stackoverflow.com/users/2181188/fandango68"}, "is_accepted": false, "score": 0, "last_activity_date": 1569303971, "creation_date": 1569303971, "answer_id": 58073768, "question_id": 52855293, "link": "https://stackoverflow.com/questions/52855293/countif-changes-with-autofilter-for-multiple-columns/58073768#58073768", "title": "countif changes with autofilter for multiple columns", "body": "<p>You don't need VBA. Use Excel smart formulas.</p>\n\n<blockquote>\n  <p><code>=SUMPRODUCT(SUBTOTAL(3,OFFSET(EDIManifestsAll[UniqueContainer],\n  ROW(EDIManifestsAll[UniqueContainer])-ROW(EDIManifestsAll[UniqueContainer]),0,1)),\n  --(EDIManifestsAll[UniqueContainer]=\"Y\"))</code></p>\n</blockquote>\n\n<p>Where:</p>\n\n<ul>\n<li><code>EDIManifestsAll</code> = your table reference or name</li>\n<li><code>UniqueContainer</code> = your filtered column heading</li>\n<li>\"Y\" = any arbitrary value that you want to <code>COUNTIF()</code></li>\n</ul>\n\n<p>ps: my answer is based on your title <em>\"countif changes with autofilter ...\"</em>. If you're trying to resolve in VBA specifically, then all other answers should do it.</p>\n"}], "owner": {"reputation": 23, "user_id": 10476338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4714ee4ec4a66f21db2f77077760bbb6?s=128&d=identicon&r=PG&f=1", "display_name": "nikhilsharma", "link": "https://stackoverflow.com/users/10476338/nikhilsharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 197, "favorite_count": 0, "accepted_answer_id": 52856066, "answer_count": 4, "score": 0, "last_activity_date": 1593677287, "creation_date": 1539780640, "last_edit_date": 1593677287, "question_id": 52855293, "link": "https://stackoverflow.com/questions/52855293/countif-changes-with-autofilter-for-multiple-columns", "title": "countif changes with autofilter for multiple columns", "body": "<p>I am working on a VBA project and I want it to count the number of cells within a range that matches a particular criteria.</p>\n\n<p>So are two columns and the countif would count the value if two requirements are fulfilled. \nIn addition, I have added autofilter to range, therefore the count will change when you filter the columns (For instance the value would change if i select certain classroom rather than all classroom)</p>\n\n<pre><code>        dim i as integer\n    dim rcell as integer\n    lastrow = Activesheet.Cells(.Rows.Count, 1).End(xlUp).Row\n\nCol_Dessert =5\nCol_Snack =6\n\ni=0\n\n    with Worksheets(\"JIS\")\nFor rcell = 1 to lastrow\nIf range(cells(rcell,Col_Dessert).value=\"L\" ) And range(cells(rcell,Col_Dessert).value=\"WESTERN\" ) then\ni=i+1\n\nend if\nnext rcell\nend with\n</code></pre>\n"}, {"tags": [".net", "excel", "vba", "reference", "automation"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1539780165, "post_id": 52854820, "comment_id": 92625424, "body": "Just <a href=\"https://blogs.msdn.microsoft.com/gabhan_berry/2008/02/12/excel-event-handling-in-c/\" rel=\"nofollow noreferrer\">handle</a> the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.workbook.sheetselectionchange\" rel=\"nofollow noreferrer\">Workbook.SheetSelectionChange</a> event."}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 3, "creation_date": 1539780370, "post_id": 52854820, "comment_id": 92625544, "body": "Just a thought: If you return a reference to an Excel object (Range), but closes the Excel workbook, I would highly assume that the reference will be invalid."}], "answers": [{"tags": [], "owner": {"reputation": 397, "user_id": 568388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2bd6b2ff7ad41b9bd455d0541248be3?s=128&d=identicon&r=PG", "display_name": "Mike Wilson", "link": "https://stackoverflow.com/users/568388/mike-wilson"}, "is_accepted": false, "score": 0, "last_activity_date": 1539869918, "creation_date": 1539869918, "answer_id": 52875377, "question_id": 52854820, "link": "https://stackoverflow.com/questions/52854820/automate-excel-from-net-to-prompt-a-user-to-select-a-single-cell-and-close-wor/52875377#52875377", "title": "Automate Excel from .NET to prompt a user to select a single cell, and close workbook and return the cell reference immediately", "body": "<h2>Thanks</h2>\n\n<p>It's not the most graceful solution but a combination of Comintern and FunThomas' comments is a good enough workaround for now.</p>\n\n<p>Later, I'll probably just load the Excel worksheets into DataTables.</p>\n\n<p>Cheers,</p>\n\n<p>Mike</p>\n"}], "owner": {"reputation": 397, "user_id": 568388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2bd6b2ff7ad41b9bd455d0541248be3?s=128&d=identicon&r=PG", "display_name": "Mike Wilson", "link": "https://stackoverflow.com/users/568388/mike-wilson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1539869918, "creation_date": 1539779046, "question_id": 52854820, "link": "https://stackoverflow.com/questions/52854820/automate-excel-from-net-to-prompt-a-user-to-select-a-single-cell-and-close-wor", "title": "Automate Excel from .NET to prompt a user to select a single cell, and close workbook and return the cell reference immediately", "body": "<p>I have a (.NET Winforms) application which needs to open an Excel Workbook, prompt the user to select a cell from this workbook -- and upon single-clicking the cell, return immediately back to the calling (.NET Winforms application) a reference/pointer to the selected cell in the Excel workbook.</p>\n\n<p>It is trivial to automate Excel in a manner which causes a user-selected Workbook to open, and to obtain a cell reference, however, I would like to be able to close the workbook immediately once a cell has been selected <em>without adding VBA to the Excel workbook</em>.</p>\n\n<p>Is this possible in an elegant way?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1331, "user_id": 10498111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8dd0523c4e1cb82448b30957581803a6?s=128&d=identicon&r=PG&f=1", "display_name": "usmanhaq", "link": "https://stackoverflow.com/users/10498111/usmanhaq"}, "edited": false, "score": 0, "creation_date": 1539778407, "post_id": 52854526, "comment_id": 92624317, "body": "I can see that it is a string (from right to left) starting from a ) and ending at a space. Is it true in all cases"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1539778547, "post_id": 52854526, "comment_id": 92624428, "body": "&quot;and so on&quot; - what does this mean? Why not 72EE in the penultimate example?"}, {"owner": {"reputation": 1, "user_id": 8020757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/537917167b94c3634d9a53ad7b396302?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/8020757/david"}, "edited": false, "score": 0, "creation_date": 1539779264, "post_id": 52854526, "comment_id": 92624865, "body": "Unfortunatley the data can appear almost in any order begining with numbers or letters,  also the data I want (in Bold) might or might not be in Brackets. Humans build the data so can be extremely inconsistant."}, {"owner": {"reputation": 1, "user_id": 8020757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/537917167b94c3634d9a53ad7b396302?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/8020757/david"}, "edited": false, "score": 0, "creation_date": 1539779518, "post_id": 52854526, "comment_id": 92625009, "body": "AND SO ON. well the data in this example is within the brackets, though not always the case, the 72EE refers to something totally different,  The issue is I need to look, for example, for 70T 71T 72T 73T 74T 75T (approx 100 different versions) and find out which one is in each line for around 5,000 lines."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1539779771, "post_id": 52854526, "comment_id": 92625158, "body": "If there is no logic or pattern to the string you want to extract, it&#39;s a tough one. You could have a list of all the codes you want, and loop through each of them for each entry in your data. You might get false positives I guess, but I think that&#39;s the best you can do."}, {"owner": {"reputation": 1, "user_id": 8020757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/537917167b94c3634d9a53ad7b396302?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/8020757/david"}, "edited": false, "score": 0, "creation_date": 1539782814, "post_id": 52854526, "comment_id": 92627148, "body": "I will attempt the Lop from list as sounds best way, thanks"}], "answers": [{"tags": [], "owner": {"reputation": 1331, "user_id": 10498111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8dd0523c4e1cb82448b30957581803a6?s=128&d=identicon&r=PG&f=1", "display_name": "usmanhaq", "link": "https://stackoverflow.com/users/10498111/usmanhaq"}, "is_accepted": false, "score": 1, "last_activity_date": 1539780163, "last_edit_date": 1539780163, "creation_date": 1539779956, "answer_id": 52855069, "question_id": 52854526, "link": "https://stackoverflow.com/questions/52854526/excel-vba-extract-specific-data-from-column-of-mixed-data/52855069#52855069", "title": "Excel VBA Extract Specific Data from Column of Mixed Data", "body": "<p>Insert this formula in a cell it is assuming your string is present in column A, you can change it if it is not the case and check how many it extracts.</p>\n\n<pre><code>=MID(A1,SEARCH(\" \",A1,SEARCH(\"R1?\",A1))+1,SEARCH(\")\",A1)-SEARCH(\" \",A1,SEARCH(\"R1?\",A1))-1)\n</code></pre>\n\n<p>filter out the remaining ones, find some thing common in them and let me know and we can build another formula for those cells.</p>\n"}, {"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 0, "last_activity_date": 1539780462, "last_edit_date": 1539780462, "creation_date": 1539779992, "answer_id": 52855076, "question_id": 52854526, "link": "https://stackoverflow.com/questions/52854526/excel-vba-extract-specific-data-from-column-of-mixed-data/52855076#52855076", "title": "Excel VBA Extract Specific Data from Column of Mixed Data", "body": "<p>I recommend to use Regular Expressions for that if you need to do it with VBA. There is a pretty good explanation at \n<a href=\"https://stackoverflow.com/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loops\">How to use Regular Expressions (Regex) in Microsoft Excel both in-cell and loops</a>.</p>\n\n<p>As pattern you could use something like <code>.+\\(.+ (.+)\\).*</code> (see <a href=\"https://regex101.com/r/jK1zKc/1/\" rel=\"nofollow noreferrer\">https://regex101.com/r/jK1zKc/1/</a>)</p>\n\n<p><strong>For a manual solution</strong><br>\nUse <a href=\"https://support.office.com/en-us/article/split-text-into-different-columns-with-the-convert-text-to-columns-wizard-30b14928-5550-41f5-97ca-7a3e9c363ed7\" rel=\"nofollow noreferrer\">Split text into different columns with the Convert Text to Columns Wizard</a> to split into columns by the spaces.</p>\n\n<p><a href=\"https://i.stack.imgur.com/uu2vm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uu2vm.png\" alt=\"enter image description here\"></a></p>\n\n<p>Then do a simple replace <code>\")\"</code> by <code>\"\"</code> in column D.</p>\n\n<hr>\n\n<p>Or do the manual solution with VBA (assuming your data in column A):</p>\n\n<pre><code>Option Explicit\n\nSub SplitAndDelet()\n    Range(\"A:A\").TextToColumns Destination:=Range(\"A1\"), DataType:=xlDelimited, _\n        TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=True, Tab:=False, _\n        Semicolon:=False, Comma:=False, Space:=True, Other:=True, OtherChar:= _\n        \")\", FieldInfo:=Array(Array(1, 1), Array(2, 1), Array(3, 1), Array(4, 1), Array(5, 1)) _\n        , TrailingMinusNumbers:=True\n    Range(\"A:C,E:E\").Delete Shift:=xlToLeft\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 945, "user_id": 4219600, "user_type": "registered", "profile_image": "https://graph.facebook.com/511041755/picture?type=large", "display_name": "James Cooke", "link": "https://stackoverflow.com/users/4219600/james-cooke"}, "is_accepted": false, "score": 0, "last_activity_date": 1539786722, "last_edit_date": 1539786722, "creation_date": 1539780494, "answer_id": 52855250, "question_id": 52854526, "link": "https://stackoverflow.com/questions/52854526/excel-vba-extract-specific-data-from-column-of-mixed-data/52855250#52855250", "title": "Excel VBA Extract Specific Data from Column of Mixed Data", "body": "<p>If you want to do this in vba you could set up an array of tyres and loop through them for each cell. for example if you had this on your sheet;</p>\n\n<p><a href=\"https://i.stack.imgur.com/16M6y.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/16M6y.png\" alt=\"enter image description here\"></a></p>\n\n<p>you could do something like this;</p>\n\n<pre><code>Public Sub FindTyres()\n\n' Column to Loop\nDim col As String\ncol = \"B\"\n\n' rows to Loop\nDim startRow As String\nDim endRow As String\nstartRow = \"2\"\nendRow = \"7\"\n\n' Get list of Tyres\nDim tyresArr()\ntyresArr = getTyresArr()\n\n' Set Range to Loop\nDim rng As Range, cell As Range\nSet rng = Range(col &amp; startRow &amp; \":\" &amp; col &amp; endRow)\n\n' Looping through Array params\nDim tyre As Variant\n\n' Loop through Cells\n    For Each cell In rng\n       currentCellVal = cell.Value\n\n       ' Loop through tyres\n       For Each tyre In tyresArr\n\n            Debug.Print tyre\n            ' if you find it do something\n             If InStr(1, currentCellVal, CStr(tyre)) &lt;&gt; 0 Then\n                 MsgBox \"Value \" &amp; CStr(tyre) &amp; \" Contained in Cell \" &amp; cell.Address\n                 Exit For\n             End If\n\n       Next tyre\n\n\n    Next cell\n\n\n\nEnd Sub\n\nPrivate Function getTyresArr()\n\nDim tyresArr(3)\n\n\ntyresArr(0) = \"71T\"\ntyresArr(1) = \"73T\"\ntyresArr(2) = \"75T\"\ntyresArr(3) = \"104N\"\n\ngetTyresArr = tyresArr\n\nEnd Function\n</code></pre>\n\n<p>Please note this assumes you will only ever have one tyre code per line.\nyou may get some false positives if these strings exist for other reasons.\nyou would need to enter all the codes into the function that returns the array.</p>\n"}], "owner": {"reputation": 1, "user_id": 8020757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/537917167b94c3634d9a53ad7b396302?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/8020757/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1591644436, "creation_date": 1539778026, "last_edit_date": 1591644436, "question_id": 52854526, "link": "https://stackoverflow.com/questions/52854526/excel-vba-extract-specific-data-from-column-of-mixed-data", "title": "Excel VBA Extract Specific Data from Column of Mixed Data", "body": "<p>I have a list of Tyres form the internet, the list is 5,000 lines long in one column.\nI need to extract from each line the data in BOLD ideally into the next column</p>\n\n<p>EXAMPLE of TYRES</p>\n\n<ul>\n<li>LS388 (145/70 R13 <strong>71T</strong>)</li>\n<li>LS388 (155/65 R13 <strong>73T</strong>)</li>\n<li>LS388 (155/65 R14 <strong>75T</strong>)</li>\n<li>4-Seasons (155/65 R14 <strong>75T</strong>)</li>\n<li>CT6 (155/70 R12 <strong>104N</strong>) 72EE</li>\n<li>LS388 (155/70 R13 <strong>75T</strong>)</li>\n</ul>\n\n<p>The problem is that the number can be between 59 and 120 and the letter could be H T V R N X Z and so on. Also the text could be anywhere within the line of data not always towards the end as shown. </p>\n\n<p>There could be 100 variations to look for and </p>\n\n<p>Rather than having one line of code to search for a <strong>LIKE 71T</strong> for each line of tyres, can I use a source table of these variations and reference them one by one in the code is some sort of loop? or other suggestions if in VBA appreciated</p>\n\n<p>At the moment I have this VBA code for each possible variation, one line for each variant.</p>\n\n<pre><code>ElseIf ActiveCell.Value Like \"*79S*\" Then\nActiveCell.offset(0,1).Value = \"79S\"\n</code></pre>\n"}, {"tags": ["vba", "object", "ms-word", "required"], "comments": [{"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1539778135, "post_id": 52854451, "comment_id": 92624166, "body": "What is <code>dtp_datum</code>?"}, {"owner": {"reputation": 85, "user_id": 4003637, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/2f0dae9dcead6109bb1c447feff7fe0f?s=128&d=identicon&r=PG&f=1", "display_name": "Roman78", "link": "https://stackoverflow.com/users/4003637/roman78"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1539778599, "post_id": 52854451, "comment_id": 92624462, "body": "I think a Variable. It is not declared somewhere else."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1539780711, "post_id": 52854451, "comment_id": 92625752, "body": "I suspect <code>dtp_datum</code> is an Active-X control on the <code>UserForm</code> (maybe a date picker?) that either isn&#39;t present or isn&#39;t registered on the older machines."}, {"owner": {"reputation": 85, "user_id": 4003637, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/2f0dae9dcead6109bb1c447feff7fe0f?s=128&d=identicon&r=PG&f=1", "display_name": "Roman78", "link": "https://stackoverflow.com/users/4003637/roman78"}, "edited": false, "score": 0, "creation_date": 1539783244, "post_id": 52854451, "comment_id": 92627423, "body": "How could i check this?"}], "owner": {"reputation": 85, "user_id": 4003637, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/2f0dae9dcead6109bb1c447feff7fe0f?s=128&d=identicon&r=PG&f=1", "display_name": "Roman78", "link": "https://stackoverflow.com/users/4003637/roman78"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 130, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1539787140, "creation_date": 1539777797, "last_edit_date": 1539787140, "question_id": 52854451, "link": "https://stackoverflow.com/questions/52854451/vba-error-424-object-required-but-only-one-some-pcs", "title": "VBA error 424 Object Required but only one some PCs", "body": "<p>We use an external software database which generates an Word document and will run a Visual Basic Script to enter date and time which are added into the Word document.</p>\n\n<p>This works on some machines and on other it won't. Strangely it works on the newer machines whit a newer image of Windows. We install our computer using a AIK-Server. There are 2 images on that server one for the newer computers and and older one from 2017. So now i try to figure out what is missing in the older one. </p>\n\n<p>The code generates the 424 error while running the second entry of this subroutine:</p>\n\n<pre><code>Private Sub UserForm_Initialize()\ndtp_datum.Value = Date\n\nEnd Sub\n</code></pre>\n\n<p>I doubt it is an error of the script, because it is working on the newer ones. I think that something is missing, like a Runtime library or Plug-in. But i cant figure out what. The never image is based on the older one, so it must be something added to the new image. </p>\n\n<p>The image contains Windows 7, Office 2010 Pro, Novell Groupwise, and some default programs like Adobe reader and Firefox. Updated to the latest version of W7 and Office using WSUS.</p>\n"}, {"tags": ["html", "excel", "vba", "web-scraping"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1539777680, "post_id": 52854186, "comment_id": 92623886, "body": "I think it is an XY problem (see <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">What is the XY problem?</a>). Can you instead explain what your actual goal is? Probably there is another approach where you don&#39;t run into that issue at all."}, {"owner": {"reputation": 73, "user_id": 10448315, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gzdV2m4f6GE/AAAAAAAAAAI/AAAAAAAAAZ8/zKlDIBRKK4Y/photo.jpg?sz=128", "display_name": "Cumhur Ay", "link": "https://stackoverflow.com/users/10448315/cumhur-ay"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1539859948, "post_id": 52854186, "comment_id": 92658228, "body": "To analyze, I want to get the works data of 70-80 horses."}, {"owner": {"reputation": 88791, "user_id": 134204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vwnA5.jpg?s=128&g=1", "display_name": "Panagiotis Kanavos", "link": "https://stackoverflow.com/users/134204/panagiotis-kanavos"}, "edited": false, "score": 0, "creation_date": 1539864232, "post_id": 52854186, "comment_id": 92660565, "body": "Again, why are you doing any of this? Excel <a href=\"https://support.office.com/en-us/article/connect-to-a-web-page-power-query-b2725d67-c9e8-43e6-a590-c0a175bd64d8\" rel=\"nofollow noreferrer\">can pull data from web pages</a> for at least a decade now. PowerQuery can clean, transform data quite easily, plus it can read from a <i>lot</i> of sources, not just web sites. Finally, you don&#39;t need to <i>paste</i> just to set a cell&#39;s or range&#39;s values."}], "answers": [{"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1539777214, "post_id": 52854210, "comment_id": 92623603, "body": "<code>For Each elem</code>, <code>For Each trow</code> is no assigning? Probably you missed them ;) \u2022 But I doubt setting them <code>nothing</code> will solve the issue."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1539777607, "post_id": 52854210, "comment_id": 92623846, "body": "@P\u1d07\u029c -  yes, there is assignment, but still the performance bonus is discussable. The <code>Set elem = Nothing</code> breaks a reference, should not be doing something more."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1539777731, "post_id": 52854210, "comment_id": 92623918, "body": "Yes, that&#39;s exactly what I think."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 3, "last_activity_date": 1539777525, "last_edit_date": 1539777525, "creation_date": 1539777003, "answer_id": 52854210, "question_id": 52854186, "link": "https://stackoverflow.com/questions/52854186/how-do-i-clean-up-objects-in-excel-vba/52854210#52854210", "title": "How do I clean up objects in Excel vba?", "body": "<p>In general <code>Set elem = Nothing</code> is what you need.</p>\n\n<p>In your code you are assigning the variables within a for-each loop, thus even if you set them to <code>Nothing</code> later, there would not be a performance bonus.</p>\n"}, {"comments": [{"owner": {"reputation": 73, "user_id": 10448315, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gzdV2m4f6GE/AAAAAAAAAAI/AAAAAAAAAZ8/zKlDIBRKK4Y/photo.jpg?sz=128", "display_name": "Cumhur Ay", "link": "https://stackoverflow.com/users/10448315/cumhur-ay"}, "edited": false, "score": 0, "creation_date": 1539777423, "post_id": 52854218, "comment_id": 92623721, "body": "I tried that, but it didn&#39;t. Every round of the cycle, the Excel page where the macro copied the data fills down. It hangs after a while."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 73, "user_id": 10448315, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gzdV2m4f6GE/AAAAAAAAAAI/AAAAAAAAAZ8/zKlDIBRKK4Y/photo.jpg?sz=128", "display_name": "Cumhur Ay", "link": "https://stackoverflow.com/users/10448315/cumhur-ay"}, "edited": false, "score": 0, "creation_date": 1539777750, "post_id": 52854218, "comment_id": 92623929, "body": "@CumhurAy - I also think that the HTTP requests are the time problem. Try with <code>For w = 1 To 2</code> to see whether there is a difference."}, {"owner": {"reputation": 73, "user_id": 10448315, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gzdV2m4f6GE/AAAAAAAAAAI/AAAAAAAAAZ8/zKlDIBRKK4Y/photo.jpg?sz=128", "display_name": "Cumhur Ay", "link": "https://stackoverflow.com/users/10448315/cumhur-ay"}, "edited": false, "score": 0, "creation_date": 1539778375, "post_id": 52854218, "comment_id": 92624301, "body": "for example no problem up to 20"}, {"owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "reply_to_user": {"reputation": 73, "user_id": 10448315, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gzdV2m4f6GE/AAAAAAAAAAI/AAAAAAAAAZ8/zKlDIBRKK4Y/photo.jpg?sz=128", "display_name": "Cumhur Ay", "link": "https://stackoverflow.com/users/10448315/cumhur-ay"}, "edited": false, "score": 0, "creation_date": 1539778840, "post_id": 52854218, "comment_id": 92624607, "body": "@CumhurAy See additional suggestions."}], "tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": false, "score": 1, "last_activity_date": 1539778796, "last_edit_date": 1539778796, "creation_date": 1539777021, "answer_id": 52854218, "question_id": 52854186, "link": "https://stackoverflow.com/questions/52854186/how-do-i-clean-up-objects-in-excel-vba/52854218#52854218", "title": "How do I clean up objects in Excel vba?", "body": "<p>Try setting those object to <code>Nothing</code>, like below:</p>\n\n<pre><code>Set elem = Nothing\nSet trow = Nothing\n</code></pre>\n\n<p>I am not sure whether you need variable declarations in your loop, you can take them out of the loop, this might save some time.</p>\n\n<p>But I think your HTTP requests are taking so long, not any VBA code.</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>Try setting <code>Application.EnableEvents</code> and <code>Application.ScreenUpdating</code> to <code>False</code> at the beggining of macro and setting them back to <code>True</code> at the end.</p>\n"}, {"comments": [{"owner": {"reputation": 73, "user_id": 10448315, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gzdV2m4f6GE/AAAAAAAAAAI/AAAAAAAAAZ8/zKlDIBRKK4Y/photo.jpg?sz=128", "display_name": "Cumhur Ay", "link": "https://stackoverflow.com/users/10448315/cumhur-ay"}, "edited": false, "score": 0, "creation_date": 1539778544, "post_id": 52854456, "comment_id": 92624422, "body": "yes I think it is due to fast and frequent data demand. For example, 1 to 20 is not a problem."}, {"owner": {"reputation": 73, "user_id": 10448315, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gzdV2m4f6GE/AAAAAAAAAAI/AAAAAAAAAZ8/zKlDIBRKK4Y/photo.jpg?sz=128", "display_name": "Cumhur Ay", "link": "https://stackoverflow.com/users/10448315/cumhur-ay"}, "edited": false, "score": 0, "creation_date": 1539778635, "post_id": 52854456, "comment_id": 92624483, "body": "How can I include all data into an array by including Asay (w)?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 73, "user_id": 10448315, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gzdV2m4f6GE/AAAAAAAAAAI/AAAAAAAAAZ8/zKlDIBRKK4Y/photo.jpg?sz=128", "display_name": "Cumhur Ay", "link": "https://stackoverflow.com/users/10448315/cumhur-ay"}, "edited": false, "score": 1, "creation_date": 1539778796, "post_id": 52854456, "comment_id": 92624584, "body": "You presumably know how many columns are retrieved (unless this varies?) so you could oversize an array row wise with the appropriate number of columns and write to that (using a rowCounter variable to keep track of how many rows you have populated). Transpose and ReDim the rows to the right size using rowCounter variable. Or ignore the resize and dump the whole thing out - you&#39;ll have some empty rows at the end but doesn&#39;t matter if not overwriting anything."}, {"owner": {"reputation": 73, "user_id": 10448315, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gzdV2m4f6GE/AAAAAAAAAAI/AAAAAAAAAZ8/zKlDIBRKK4Y/photo.jpg?sz=128", "display_name": "Cumhur Ay", "link": "https://stackoverflow.com/users/10448315/cumhur-ay"}, "edited": false, "score": 0, "creation_date": 1539779966, "post_id": 52854456, "comment_id": 92625281, "body": "Sorumu de\u011fi\u015ftirdim. Kodun tamam\u0131n\u0131 yazd\u0131m. Y sayfas\u0131ndaki pivottable&#39;dan okudu\u011fu numaralar\u0131 da yazd\u0131m. Bu \u015fekliyle kod &#231;al\u0131\u015f\u0131rken bir s&#252;re sonra kilitleniyor."}, {"owner": {"reputation": 73, "user_id": 10448315, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gzdV2m4f6GE/AAAAAAAAAAI/AAAAAAAAAZ8/zKlDIBRKK4Y/photo.jpg?sz=128", "display_name": "Cumhur Ay", "link": "https://stackoverflow.com/users/10448315/cumhur-ay"}, "edited": false, "score": 0, "creation_date": 1539780244, "post_id": 52854456, "comment_id": 92625466, "body": "The code you typed for &quot;<a href=\"https://stackoverflow.com/questions/52766563/i-want-to-get-data-from-web-site-with-excel-vba-but-i-cant\" title=\"i want to get data from web site with excel vba but i cant\">stackoverflow.com/questions/52766563/&hellip;</a>&quot; question works very well for this question. Thanks to your codes, I learned to get data with the &quot;get&quot; method. but the &quot;post&quot; job is a bit distressed."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 73, "user_id": 10448315, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gzdV2m4f6GE/AAAAAAAAAAI/AAAAAAAAAZ8/zKlDIBRKK4Y/photo.jpg?sz=128", "display_name": "Cumhur Ay", "link": "https://stackoverflow.com/users/10448315/cumhur-ay"}, "edited": false, "score": 1, "creation_date": 1539781221, "post_id": 52854456, "comment_id": 92626100, "body": "Without working with your dataset all I can say is immediately clear is that you want to avoid touching the worksheet as much as you do. Read data in from the sheet once, into an array. Loop the array. Write results to an array. Write the array to the sheet. Each time you use .Select, .Cells etc you are gaining overhead and slowing your process."}, {"owner": {"reputation": 73, "user_id": 10448315, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gzdV2m4f6GE/AAAAAAAAAAI/AAAAAAAAAZ8/zKlDIBRKK4Y/photo.jpg?sz=128", "display_name": "Cumhur Ay", "link": "https://stackoverflow.com/users/10448315/cumhur-ay"}, "edited": false, "score": 0, "creation_date": 1539860850, "post_id": 52854456, "comment_id": 92658706, "body": "You know how much beginner I am from the code. I&#39;ve also reviewed the codes you&#39;ve written, but I don&#39;t understand how to loop through, write data into a table, and export it to excel."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 73, "user_id": 10448315, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gzdV2m4f6GE/AAAAAAAAAAI/AAAAAAAAAZ8/zKlDIBRKK4Y/photo.jpg?sz=128", "display_name": "Cumhur Ay", "link": "https://stackoverflow.com/users/10448315/cumhur-ay"}, "edited": false, "score": 1, "creation_date": 1539863989, "post_id": 52854456, "comment_id": 92660410, "body": "I have written an update. Let me know. It runs in a few seconds."}, {"owner": {"reputation": 73, "user_id": 10448315, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gzdV2m4f6GE/AAAAAAAAAAI/AAAAAAAAAZ8/zKlDIBRKK4Y/photo.jpg?sz=128", "display_name": "Cumhur Ay", "link": "https://stackoverflow.com/users/10448315/cumhur-ay"}, "edited": false, "score": 1, "creation_date": 1539870211, "post_id": 52854456, "comment_id": 92664347, "body": "Perfect master. I bow in front of you with respect. Thank you so much."}, {"owner": {"reputation": 73, "user_id": 10448315, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gzdV2m4f6GE/AAAAAAAAAAI/AAAAAAAAAZ8/zKlDIBRKK4Y/photo.jpg?sz=128", "display_name": "Cumhur Ay", "link": "https://stackoverflow.com/users/10448315/cumhur-ay"}, "edited": false, "score": 0, "creation_date": 1539873122, "post_id": 52854456, "comment_id": 92666245, "body": "I made little changes to the code. On the line &quot;html.body.innerHTML = http.GetString (url)&quot; gives error 7. what would be the reason?"}, {"owner": {"reputation": 73, "user_id": 10448315, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gzdV2m4f6GE/AAAAAAAAAAI/AAAAAAAAAZ8/zKlDIBRKK4Y/photo.jpg?sz=128", "display_name": "Cumhur Ay", "link": "https://stackoverflow.com/users/10448315/cumhur-ay"}, "edited": false, "score": 0, "creation_date": 1539873155, "post_id": 52854456, "comment_id": 92666259, "body": "Set ws = ThisWorkbook.Worksheets(&quot;X&quot;)     Set ww = ThisWorkbook.Worksheets(&quot;Y&quot;)     Set html = New HTMLDocument     Asays = Application.Transpose(ww.Range(&quot;A1:A&quot; &amp; ww.Columns(&quot;A:A&quot;).Find(What:=&quot;bo\u015f&quot;).Row - 1).Value)"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 73, "user_id": 10448315, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gzdV2m4f6GE/AAAAAAAAAAI/AAAAAAAAAZ8/zKlDIBRKK4Y/photo.jpg?sz=128", "display_name": "Cumhur Ay", "link": "https://stackoverflow.com/users/10448315/cumhur-ay"}, "edited": false, "score": 0, "creation_date": 1539873329, "post_id": 52854456, "comment_id": 92666389, "body": "I don&#39;t know. If you run my code as it was before you changed does it sitll run fine?"}, {"owner": {"reputation": 73, "user_id": 10448315, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gzdV2m4f6GE/AAAAAAAAAAI/AAAAAAAAAZ8/zKlDIBRKK4Y/photo.jpg?sz=128", "display_name": "Cumhur Ay", "link": "https://stackoverflow.com/users/10448315/cumhur-ay"}, "edited": false, "score": 1, "creation_date": 1539880396, "post_id": 52854456, "comment_id": 92670684, "body": "I&#39;m sorry the error is caused by me. Asay numbers start from A2, not A1. I&#39;ve fixed it working super."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 4, "last_activity_date": 1539871156, "last_edit_date": 1539871156, "creation_date": 1539777804, "answer_id": 52854456, "question_id": 52854186, "link": "https://stackoverflow.com/questions/52854186/how-do-i-clean-up-objects-in-excel-vba/52854456#52854456", "title": "How do I clean up objects in Excel vba?", "body": "<p>Slowing down maybe due to throttling of network if you are trying to hit the site too many times in quick succession. This is particularly likely given your access method. Better would be to see if an API is available to bulk access info. You are likely going through many networks to get to this page as well. It may be possible to get some basic info about delays from <a href=\"https://www.quora.com/How-can-I-tell-if-certain-websites-are-being-throttled-by-my-ISP\" rel=\"nofollow noreferrer\">TRACERT</a> command from a command prompt.</p>\n\n<p>You are doing a POST so remember there is a fair amount of server side stuff going on as well. </p>\n\n<p>You don't need to set <code>elem</code> to <code>Nothing</code> as it only exists during your <code>For Loop</code>. Same for <code>tRow</code>.</p>\n\n<p>Putting <code>.getElementsByClassName(\"at_Galoplar\")(0).Rows</code> into a variable will provided faster referencing.</p>\n\n<p>Write the results to an array first and then dump the array out to the sheet in one go will provide significant improvement in speed.</p>\n\n<p>Using <code>New</code> keyword can lead to unexpected behaviour. You can create one instance of <code>HTMLDocument</code> and work with that provided you have good error handling in. I have had occassional cases in a loop where I have had to set <code>HTMLDocument</code> to <code>Nothing</code> before looping back round.</p>\n\n<hr>\n\n<p>Personally, I would <em>cheat</em> and re-write this to leverage that you can issue GET requests to get the same info. I use a class to hold the XMLHTTP object, and an array to hold the results. I write the results out in one go. This takes a few seconds to run for me. The asay numbers are in <code>Sheet1</code> range <code>A1:A84</code>.</p>\n\n<p>Class module clsHTTP</p>\n\n<pre><code>Option Explicit    \nPrivate http As Object\n\nPrivate Sub Class_Initialize()\n    Set http = CreateObject(\"MSXML2.XMLHTTP\")\nEnd Sub\n\nPublic Function GetString(ByVal url As String) As String\n    Dim sResponse As String\n    With http\n        .Open \"GET\", url, False\n        .setRequestHeader \"If-Modified-Since\", \"Sat, 1 Jan 2000 00:00:00 GMT\"\n        .send\n        sResponse = StrConv(.responseBody, vbUnicode)\n        GetString = sResponse\n    End With\nEnd Function\n</code></pre>\n\n<p>Standard module 1</p>\n\n<pre><code>Option Explicit\nPublic Sub DGaloplar()\n    Dim asays(), ws As Worksheet, asay As Long, html As HTMLDocument\n    Dim http As clsHTTP, url As String, headers(), numberOfRequests As Long\n\n    headers = Array(\"Asay\", \"Tarih\", \"Sehir\", \"Kg\", \"Jokey\", \"400\", \"600\", \"800\", \"1000\", \"1200\", \"1400\", \"\u00c7\", \"Pist\", \"Durum\")\n    Set http = New clsHTTP\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n    Set html = New HTMLDocument\n    asays = Application.Transpose(ws.Range(\"A1:A84\").Value) 'Load asay values from sheet 1\n\n    Const numTableRows As Long = 11\n    Const numTableColumns As Long = 15\n    Const BASE_URL As String = \"https://yenibeygir.com/at/getatdetaytab/?tab=galopTab&amp;id=\"\n\n    numberOfRequests = UBound(asays)\n\n    Dim results(), headerRow As Boolean, tRows As Object, tRow As Object, iRow As Long\n    Dim tCells As Object, tCell As Object, r As Long, c As Long, hTable As HTMLTable\n    ReDim results(1 To numTableRows * numberOfRequests, 1 To numTableColumns)\n\n    Application.ScreenUpdating = False\n\n    For asay = 1 To numberOfRequests\n        headerRow = True\n        url = BASE_URL &amp; asays(asay)\n        html.body.innerHTML = http.GetString(url)\n        Set hTable = html.querySelector(\".at_Galoplar\")\n        Set tRows = hTable.getElementsByTagName(\"tr\")\n\n        For Each tRow In tRows\n            If Not headerRow Then\n                c = 2: r = r + 1\n                results(r, 1) = asays(asay)\n                Set tCells = tRow.getElementsByTagName(\"td\")\n                For Each tCell In tCells\n                    results(r, c) = tCell.innerText\n                    c = c + 1\n                Next\n            End If\n            headerRow = False\n        Next\n    Next\n\n    With ws\n        .Cells(1, 3).Resize(1, UBound(headers) + 1) = headers\n        .Cells(2, 3).Resize(UBound(results, 1), UBound(results, 2)) = results\n    End With\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>Refereces:</strong></p>\n\n<ol>\n<li>Microsoft HTML Object Library</li>\n</ol>\n"}], "owner": {"reputation": 73, "user_id": 10448315, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gzdV2m4f6GE/AAAAAAAAAAI/AAAAAAAAAZ8/zKlDIBRKK4Y/photo.jpg?sz=128", "display_name": "Cumhur Ay", "link": "https://stackoverflow.com/users/10448315/cumhur-ay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 502, "favorite_count": 0, "accepted_answer_id": 52854456, "answer_count": 3, "score": 1, "last_activity_date": 1593677276, "creation_date": 1539776932, "last_edit_date": 1593677276, "question_id": 52854186, "link": "https://stackoverflow.com/questions/52854186/how-do-i-clean-up-objects-in-excel-vba", "title": "How do I clean up objects in Excel vba?", "body": "<pre><code>Public Sub D_Galoplar()\n    Application.ScreenUpdating = False\n    Dim Asay(1 To 250)\n    Dim Jsay(1 To 100)\n    For q = 2 To Sheets(\"Y\").Columns(\"A:A\").Find(What:=\"bo\u015f\").Row - 1\n        Asay(q - 1) = Sheets(\"Y\").Range(\"A\" &amp; q)\n    Next q\n    For q = 2 To Sheets(\"Y\").Columns(\"C:C\").Find(What:=\"bo\u015f\").Row - 1\n        Jsay(q - 1) = Sheets(\"Y\").Range(\"C\" &amp; q)\n    Next q\nFor w = 1 To 250\n    Cells.Delete Shift:=xlUp\n    Range(\"A1\").Select\n    If Asay(w) &lt; 1 Then Exit For\n\n    Dim elem As Object, trow As Object\n    Dim R&amp;, C&amp;, s$\n    With New XMLHTTP60\n        .Open \"POST\", \"https://yenibeygir.com/at/getatdetaytab\", False\n        .setRequestHeader \"content-type\", \"application/x-www-form-urlencoded; charset=UTF-8\"\n        .send \"tab=galopTab&amp;id=\" &amp; Asay(w)\n        s = .responseText\n    End With\n    With New HTMLDocument\n        .body.innerHTML = s\n        For Each elem In .getElementsByClassName(\"at_Galoplar\")(0).Rows\n            For Each trow In elem.Cells\n                C = C + 1: Cells(R + 1, C) = trow.innerText\n            Next trow\n            C = 0: R = R + 1\n        Next elem\n    End With\n\n    Cells.UnMerge\n    Range(\"A1\").Select\n\n    If Range(\"A1048576\").End(xlUp).Row &lt; 2 Then GoTo ATLA2\n\n    Columns(\"A:A\").Insert\n    For i = 2 To Range(\"B1048576\").End(xlUp).Row - 1\n        Range(\"A\" &amp; i) = Asay(w)\n    Next i\n\n    Range(\"O2\").FormulaR1C1 = \"=IF(ISBLANK(RC[-9]),\"\"-\"\",IF(ISNUMBER(RC[-9]),RC[-9]/4,((LEFT(RC[-9],1)*6000)+(MID(RC[-9],3,2)*100)+(RIGHT(RC[-9],1)*10))/400))\"\n    Range(\"P2\").FormulaR1C1 = \"=IF(ISBLANK(RC[-9]),\"\"-\"\",IF(ISNUMBER(RC[-9]),RC[-9]/6,((LEFT(RC[-9],1)*6000)+(MID(RC[-9],3,2)*100)+(RIGHT(RC[-9],1)*10))/600))\"\n    Range(\"Q2\").FormulaR1C1 = \"=IF(ISBLANK(RC[-9]),\"\"-\"\",IF(ISNUMBER(RC[-9]),RC[-9]/8,((LEFT(RC[-9],1)*6000)+(MID(RC[-9],3,2)*100)+(RIGHT(RC[-9],1)*10))/800))\"\n    Range(\"R2\").FormulaR1C1 = \"=IF(ISBLANK(RC[-9]),\"\"-\"\",IF(ISNUMBER(RC[-9]),RC[-9]/10,((LEFT(RC[-9],1)*6000)+(MID(RC[-9],3,2)*100)+(RIGHT(RC[-9],1)*10))/1000))\"\n    Range(\"S2\").FormulaR1C1 = \"=IF(ISBLANK(RC[-9]),\"\"-\"\",IF(ISNUMBER(RC[-9]),RC[-9]/12,((LEFT(RC[-9],1)*6000)+(MID(RC[-9],3,2)*100)+(RIGHT(RC[-9],1)*10))/1200))\"\n    Range(\"T2\").FormulaR1C1 = \"=IF(ISBLANK(RC[-9]),\"\"-\"\",IF(ISNUMBER(RC[-9]),RC[-9]/14,((LEFT(RC[-9],1)*6000)+(MID(RC[-9],3,2)*100)+(RIGHT(RC[-9],1)*10))/1400))\"\n    Range(\"O2:T2\").Copy\n    Range(\"O2:O\" &amp; Range(\"A1048576\").End(xlUp).Row).PasteSpecial Paste:=xlPasteFormulas\n    Cells.Copy\n    Cells.PasteSpecial Paste:=xlPasteValues\n    Columns(\"O:T\").Cut Columns(\"F:K\")\n\n    Range(\"A2:N\" &amp; Range(\"A1048576\").End(xlUp).Row).Copy\n    Sheets(\"Galop\").Range(\"A\" &amp; Sheets(\"Galop\").Range(\"A1048576\").End(xlUp).Row + 1).PasteSpecial Paste:=xlPasteValues\n\nATLA2:\n    Cells.Delete Shift:=xlUp\nNext w\nEnd Sub\n</code></pre>\n\n<p>I want to get a lot of data with the <code>For Next</code> cycle, but after a while the page hangs. How can I reset objects at the end of each cycle?</p>\n\n<p>Asay numbers\n10182\n10221\n10279\n10303\n10316\n10325\n10360\n10370\n10680\n11598\n11629\n11715\n11745\n12335\n12385\n12533\n12559\n13154\n13393\n13635\n13641\n13669\n13673\n14027\n14057\n14062\n14228\n14619\n14674\n14687\n14743\n14770\n14778\n15197\n15217\n15323\n15382\n15507\n15775\n15828\n16077\n16335\n16510\n17149\n17513\n17867\n18532\n37964\n60176\n66067\n66255\n66581\n66582\n66896\n66998\n67056\n67309\n67356\n67379\n67473\n68008\n68012\n68162\n68298\n68312\n68320\n68332\n68333\n68353\n68383\n68545\n68702\n68775\n68922\n69445\n69606\n69817\n69963\n69968\n69985\n69986\n70048\n70202\n71372\n(bo\u015f)</p>\n"}, {"tags": ["excel", "vba", "search", "excel-formula"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1539776867, "post_id": 52854009, "comment_id": 92623382, "body": "The only way I can imagine is a Userform with a TextBox (search) and a ListBox (to select with check boxes). \u2022 By the way I don&#39;t understand how selecting multiple items for one cell could work at all. I see no sense in that."}, {"owner": {"reputation": 191, "user_id": 5658623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/589f4ad1339d6763ea2cd54aa2cc5bdd?s=128&d=identicon&r=PG&f=1", "display_name": "yashika vaish", "link": "https://stackoverflow.com/users/5658623/yashika-vaish"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1539777001, "post_id": 52854009, "comment_id": 92623465, "body": "Thanks peh , could you please help me with this approach"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1539777090, "post_id": 52854009, "comment_id": 92623517, "body": "This is a question/answer based website so you need to ask a question to get an answer: See <a href=\"https://meta.stackoverflow.com/a/284237/3219613\">Why is \u201cCan someone help me?\u201d not an actual question?</a>). Also you will need to start on your own and show the code you already have (because this is no code writing service). We can only assist you to solve your issues on your own."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1539777355, "post_id": 52854009, "comment_id": 92623682, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/42879261/how-to-filter-listbox-values-based-on-a-textbox-value\">How to filter listbox values based on a Textbox value</a>"}], "answers": [{"tags": [], "owner": {"reputation": 4326, "user_id": 8370633, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/gxmCt.png?s=128&g=1", "display_name": "ImaginaryHuman072889", "link": "https://stackoverflow.com/users/8370633/imaginaryhuman072889"}, "is_accepted": false, "score": 0, "last_activity_date": 1539866945, "creation_date": 1539866945, "answer_id": 52874443, "question_id": 52854009, "link": "https://stackoverflow.com/questions/52854009/i-am-getting-issue-in-making-excel-data-validation-listdrop-down-searchable-li/52874443#52874443", "title": "I am getting issue in making Excel data validation list(Drop Down) searchable like excel filter and select/deselect one or more values from the same", "body": "<p>I have been thinking about (a purely formula-based solution to) this question since yesterday.</p>\n\n<p>I found a solution that first allows you to create custom filters on lists, and then the data validation drop-down list is chosen from the filtered list.</p>\n\n<p>(If necessary, you can just hide these filtered list helper columns, since there is probably no reason for the user to see them.)</p>\n\n<p>See below, an example dataset that I created, and some example filters. </p>\n\n<p><a href=\"https://i.stack.imgur.com/WbttQ.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WbttQ.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>The Original List is in column <code>A</code>, then the <code>C</code> and <code>E</code> columns use formulas to filter the list to the left of it, based on the criteria (the yellow cells).</p>\n\n<p>Here is the array formula I have in cell <code>C2</code>:</p>\n\n<pre><code>= IFERROR(INDEX($A$2:$A$8,SMALL(IF(LEFT($A$2:$A$8,LEN($B$2))=$B$2,\n  ROW($A$2:$A$8)-ROW($A$2)+1),ROW($A2)-ROW($A$2)+1)),\"(no match)\")\n</code></pre>\n\n<p>And here is the array formula I have in cell <code>E2</code>:</p>\n\n<pre><code>= IFERROR(INDEX($C$2:$C$8,SMALL(IF(LEN($C$2:$C$8)=IF($D$2=0,LEN($C$2:$C$8),$D$2),\n  ROW($C$2:$C$8)-ROW($C$2)+1),ROW($C2)-ROW($C$2)+1)),\"(no match)\")\n</code></pre>\n\n<p>I dragged these cells down to row 8.</p>\n\n<p>Note these are array formulas, so you must press <kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>Enter</kbd> on your keyboard instead of just pressing <kbd>Enter</kbd> after typing this formula.</p>\n\n<p>Now the <code>E</code> column contains the original list, but with these two filters applied. Of course, you can add as many other extra filters as you desire. One disadvantage is that these formulas are fairly long and need to be created on an as-needed basis, but the formulas do generally follow the same structure if you compare the two formulas above.</p>\n\n<p>Setting up the data validation drop-down list, I used this formula:</p>\n\n<pre><code>= OFFSET($E$2,0,0,IFERROR(MATCH(\"(no match)\",$E$2:$E$8,0),ROW($E$8)-ROW($E$2)+2)-1,1)\n</code></pre>\n\n<p>This formula works by returning the list in column <code>E</code>, but it only returns the list up to (and not including) the first instance of where <code>(no match)</code> occurs.</p>\n\n<p>See below, I have this in cell <code>G2</code> in my example spreadsheet.</p>\n\n<p><a href=\"https://i.stack.imgur.com/6WaUK.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6WaUK.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Side note: <code>OFFSET</code> is volatile and should typically be avoided, but unfortunately <code>OFFSET</code> is the only option (that I'm aware of) which allows you to use variable-length drop-down lists in data validation.</p>\n\n<p>With this setup, you can change the fields in cell <code>B2</code> and <code>D2</code>, which will ultimately filter the data in your original list and this filter will be reflected in your drop-down list.</p>\n\n<p>See a few examples below of this working. Note the drop-down list changes depending on the outcome of the lists based on the filters.</p>\n\n<hr>\n\n<p><strong><em>No filters applied</em></strong>\n<a href=\"https://i.stack.imgur.com/YrFYd.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YrFYd.jpg\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p><strong><em>Both filters applied</em></strong>\n<a href=\"https://i.stack.imgur.com/EA83A.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EA83A.jpg\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p><strong><em>First filter only applied</em></strong>\n<a href=\"https://i.stack.imgur.com/tUBmr.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tUBmr.jpg\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p><strong><em>Second filter only applied</em></strong>\n<a href=\"https://i.stack.imgur.com/cMrjV.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cMrjV.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 191, "user_id": 5658623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/589f4ad1339d6763ea2cd54aa2cc5bdd?s=128&d=identicon&r=PG&f=1", "display_name": "yashika vaish", "link": "https://stackoverflow.com/users/5658623/yashika-vaish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 185, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1591644447, "creation_date": 1539776387, "last_edit_date": 1591644447, "question_id": 52854009, "link": "https://stackoverflow.com/questions/52854009/i-am-getting-issue-in-making-excel-data-validation-listdrop-down-searchable-li", "title": "I am getting issue in making Excel data validation list(Drop Down) searchable like excel filter and select/deselect one or more values from the same", "body": "<p>I am having a worksheet in excel in which I have created a data validation list in one column. The list have very large number of values so It is very tedious task to scroll through the list. I want to implement the functionality in which a search box will be there to faster retrieval of drop down value. also If there would be some check boxes to select all or deselect all after search results.\nI am open for vba approach too please help me with the same .</p>\n\n<p>Thanks in advance. </p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 1, "creation_date": 1539776434, "post_id": 52853866, "comment_id": 92623130, "body": "Not at all sure what you are asking, but it may sound as you look for an <i>array</i>: <code>DateFiled(1 To 6)</code>."}, {"owner": {"reputation": 129, "user_id": 9208443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3e5f14e35b5b5972bd95431b0737fd2?s=128&d=identicon&r=PG&f=1", "display_name": "Besarion", "link": "https://stackoverflow.com/users/9208443/besarion"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1539776547, "post_id": 52853866, "comment_id": 92623187, "body": "Hi there ive just added some pics does that help make it easier to understand? Pretty I want to move what is covered over 1 to 10 rows into one row of data"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1539776939, "post_id": 52853866, "comment_id": 92623421, "body": "@Besarion - can you add a TLDR section to the question with 3 sentenses? I have also not managed to understand what you were asking, but it seems interesting."}, {"owner": {"reputation": 129, "user_id": 9208443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3e5f14e35b5b5972bd95431b0737fd2?s=128&d=identicon&r=PG&f=1", "display_name": "Besarion", "link": "https://stackoverflow.com/users/9208443/besarion"}, "edited": false, "score": 0, "creation_date": 1539778024, "post_id": 52853866, "comment_id": 92624105, "body": "Has that helped? Put it at the top"}], "answers": [{"tags": [], "owner": {"reputation": 129, "user_id": 9208443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3e5f14e35b5b5972bd95431b0737fd2?s=128&d=identicon&r=PG&f=1", "display_name": "Besarion", "link": "https://stackoverflow.com/users/9208443/besarion"}, "is_accepted": true, "score": 0, "last_activity_date": 1539848889, "creation_date": 1539848889, "answer_id": 52869317, "question_id": 52853866, "link": "https://stackoverflow.com/questions/52853866/ms-access-update-table-with-7-collections-or-1-array/52869317#52869317", "title": "MS Access Update table with 7 Collections Or 1 Array?", "body": "<p>Hi there so i figured it out. The code is very bulky so anyone who can make it a bit more streamlined and flexible e.g. it the columns i need changed would be much appreciated.</p>\n\n<pre><code>Dim db As DAO.Database\nSet db = CurrentDb\nDim rsFormat As DAO.Recordset\nDim rsFigs1 As Object\nDim qdfDef As DAO.QueryDef\nDim rstDef As Object\nDim varRecord As Variant\nDim NIF As String\nDim nIFF As String\nDim intI As Integer\nDim intJ As Integer\nDim RegNum, LatestDate, Date1, Date2, Date3, Date4, Date5, LatestMaterial, Material1, Material2, Material3, Material4, Material5, LatestDepreciation, Depreciation1, Depreciation2 As String\nDim Depreciation3, Depreciation4, Depreciation5, LatestTrading, Trading1, Trading2, Trading3, Trading4, Trading5, LatestTotalInterest, TotalInterest1, TotalInterest2, TotalInterest3 As String\nDim TotalInterest4, TotalInterest5, LatestPreTaxProfit, PreTaxProfit1, PreTaxProfit2, PreTaxProfit3, PreTaxProfit4, PreTaxProfit5, LatestTotEmpRem, TotEmpRem1, TotEmpRem2, TotEmpRem3 As String\nDim TotEmpRem4, TotEmpRem5, SQL As String\n\nSet rsFormat = CurrentDb.OpenRecordset(\"Select [NIF Code] FROM SabiFigures1;\")\n    If Not (rsFormat.EOF And rsFormat.BOF) Then\n        rsFormat.MoveFirst\n        Do Until rsFormat.EOF = True\n            nIFF = rsFormat![NIF Code]\n            Set qdfDef = CurrentDb.QueryDefs(\"PopulateSabiFigures1\")\n            qdfDef.Parameters(\"NIF: \").Value = nIFF\n            Set rstDef = qdfDef.OpenRecordset()\n            rstDef.MoveLast\n            rstDef.MoveFirst\n            varRecord = rstDef.GetRows(rstDef.RecordCount)\n            For intI = 0 To 5\n                For intJ = 0 To UBound(varRecord, 1)\n                    Debug.Print varRecord(intJ, intI)\n                    On Error Resume Next\n                    If intI = 0 Then\n                        If intJ = 0 Then\n                            RegNum = varRecord(intJ, intI)\n                        ElseIf intJ = 1 Then\n                            LatestDate = varRecord(intJ, intI)\n                        ElseIf intJ = 2 Then\n                            LatestMaterial = varRecord(intJ, intI)\n                        ElseIf intJ = 3 Then\n                            LatestDepreciation = varRecord(intJ, intI)\n                        ElseIf intJ = 4 Then\n                            LatestTrading = varRecord(intJ, intI)\n                        ElseIf intJ = 5 Then\n                            LatestTotalInterest = varRecord(intJ, intI)\n                        ElseIf intJ = 6 Then\n                            LatestPreTaxProfit = varRecord(intJ, intI)\n                        ElseIf intJ = 7 Then\n                            LatestTotEmpRem = varRecord(intJ, intI)\n                        Else\n                            MsgBox \"Error in Loop\"\n                            Exit Sub\n                        End If\n                ElseIf intI = 1 Then\n                        If intJ = 0 Then\n                            RegNum = varRecord(intJ, intI)\n                        ElseIf intJ = 1 Then\n                            Date1 = varRecord(intJ, intI)\n                        ElseIf intJ = 2 Then\n                            Material1 = varRecord(intJ, intI)\n                        ElseIf intJ = 3 Then\n                            Depreciation1 = varRecord(intJ, intI)\n                        ElseIf intJ = 4 Then\n                            Trading1 = varRecord(intJ, intI)\n                        ElseIf intJ = 5 Then\n                            TotalInterest1 = varRecord(intJ, intI)\n                        ElseIf intJ = 6 Then\n                            PreTaxProfit1 = varRecord(intJ, intI)\n                        ElseIf intJ = 7 Then\n                            TotEmpRem1 = varRecord(intJ, intI)\n                        Else\n                            MsgBox \"Error in Loop\"\n                            Exit Sub\n                        End If\n                ElseIf intI = 2 Then\n                        If intJ = 0 Then\n                            RegNum = varRecord(intJ, intI)\n                        ElseIf intJ = 1 Then\n                            Date2 = varRecord(intJ, intI)\n                        ElseIf intJ = 2 Then\n                            Material2 = varRecord(intJ, intI)\n                        ElseIf intJ = 3 Then\n                            Depreciation2 = varRecord(intJ, intI)\n                        ElseIf intJ = 4 Then\n                            Trading2 = varRecord(intJ, intI)\n                        ElseIf intJ = 5 Then\n                            TotalInterest2 = varRecord(intJ, intI)\n                        ElseIf intJ = 6 Then\n                            PreTaxProfit2 = varRecord(intJ, intI)\n                        ElseIf intJ = 7 Then\n                            TotEmpRem2 = varRecord(intJ, intI)\n                        Else\n                            MsgBox \"Error in Loop\"\n                            Exit Sub\n                        End If\n                ElseIf intI = 3 Then\n                        If intJ = 0 Then\n                            RegNum = varRecord(intJ, intI)\n                        ElseIf intJ = 1 Then\n                            Date3 = varRecord(intJ, intI)\n                        ElseIf intJ = 2 Then\n                            Material3 = varRecord(intJ, intI)\n                        ElseIf intJ = 3 Then\n                            Depreciation3 = varRecord(intJ, intI)\n                        ElseIf intJ = 4 Then\n                            Trading3 = varRecord(intJ, intI)\n                        ElseIf intJ = 5 Then\n                            TotalInterest3 = varRecord(intJ, intI)\n                        ElseIf intJ = 6 Then\n                            PreTaxProfit3 = varRecord(intJ, intI)\n                        ElseIf intJ = 7 Then\n                            TotEmpRem3 = varRecord(intJ, intI)\n                        Else\n                            MsgBox \"Error in Loop\"\n                            Exit Sub\n                        End If\n                ElseIf intI = 4 Then\n                        If intJ = 0 Then\n                            RegNum = varRecord(intJ, intI)\n                        ElseIf intJ = 1 Then\n                            Date4 = varRecord(intJ, intI)\n                        ElseIf intJ = 2 Then\n                            Material4 = varRecord(intJ, intI)\n                        ElseIf intJ = 3 Then\n                            Depreciation4 = varRecord(intJ, intI)\n                        ElseIf intJ = 4 Then\n                            Trading4 = varRecord(intJ, intI)\n                        ElseIf intJ = 5 Then\n                            TotalInterest4 = varRecord(intJ, intI)\n                        ElseIf intJ = 6 Then\n                            PreTaxProfit4 = varRecord(intJ, intI)\n                        ElseIf intJ = 7 Then\n                            TotEmpRem4 = varRecord(intJ, intI)\n                        Else\n                            MsgBox \"Error in Loop\"\n                            Exit Sub\n                        End If\n                ElseIf intI = 5 Then\n                        If intJ = 0 Then\n                            RegNum = varRecord(intJ, intI)\n                        ElseIf intJ = 1 Then\n                            Date5 = varRecord(intJ, intI)\n                        ElseIf intJ = 2 Then\n                            Material5 = varRecord(intJ, intI)\n                        ElseIf intJ = 3 Then\n                            Depreciation5 = varRecord(intJ, intI)\n                        ElseIf intJ = 4 Then\n                            Trading5 = varRecord(intJ, intI)\n                        ElseIf intJ = 5 Then\n                            TotalInterest5 = varRecord(intJ, intI)\n                        ElseIf intJ = 6 Then\n                            PreTaxProfit5 = varRecord(intJ, intI)\n                        ElseIf intJ = 7 Then\n                            TotEmpRem5 = varRecord(intJ, intI)\n                        Else\n                            MsgBox \"Error in Loop\"\n                            Exit Sub\n                        End If\n                Else\n                    MsgBox \"Error in Loop\"\n                    Exit Sub\n                End If\n                Next intJ\n\n            Next intI\n    SQL = \"UPDATE SabiFigures1 SET SabiFigures1.[Closing Date Last avail yr] = '\" &amp; LatestDate &amp; \"', SabiFigures1.[Closing Date Year - 1] = '\" &amp; Date1 &amp; \"', \" &amp; _\n          \"SabiFigures1.[Closing Date Year - 2] = '\" &amp; Date2 &amp; \"', SabiFigures1.[Closing Date Year - 3] = '\" &amp; Date3 &amp; \"', SabiFigures1.[Closing Date Year - 4] = '\" &amp; Date4 &amp; \"', \" &amp; _\n          \"SabiFigures1.[Closing Date Year - 5] = '\" &amp; Date5 &amp; \"', SabiFigures1.[Material costs th EUR Last avail yr] = '\" &amp; LatestMaterial &amp; \"', SabiFigures1.[Material costs th EUR Year - 1] \" &amp; _\n          \"= '\" &amp; Material1 &amp; \"', SabiFigures1.[Material costs th EUR Year - 2] = '\" &amp; Material2 &amp; \"', SabiFigures1.[Material costs th EUR Year - 3] = '\" &amp; Material3 &amp; \"', SabiFigures1.[Material costs th EUR Year - 4] \" &amp; _\n          \"= '\" &amp; Material4 &amp; \"', SabiFigures1.[Material costs th EUR Year - 5] = '\" &amp; Material5 &amp; \"', SabiFigures1.[Depreciation th EUR Last avail yr] = '\" &amp; LatestDepreciation &amp; \"', SabiFigures1.[Depreciation th EUR Year - 1] = \" &amp; _\n          \"'\" &amp; Depreciation1 &amp; \"', SabiFigures1.[Depreciation th EUR Year - 2] = '\" &amp; Depreciation2 &amp; \"', SabiFigures1.[Depreciation th EUR Year - 3] = '\" &amp; Depreciation3 &amp; \"', SabiFigures1.[Depreciation th EUR Year - 4] = '\" &amp; Depreciation4 &amp; \"', \" &amp; _\n          \"SabiFigures1.[Depreciation th EUR Year - 5] = '\" &amp; Depreciation5 &amp; \"', SabiFigures1.[Financial revenue th EUR Last avail yr] = '\" &amp; LatestTrading &amp; \"', SabiFigures1.[Financial revenue th EUR Year - 1] \" &amp; _\n          \"= '\" &amp; Trading1 &amp; \"', SabiFigures1.[Financial revenue th EUR Year - 2] = '\" &amp; Trading2 &amp; \"', SabiFigures1.[Financial revenue th EUR Year - 3] = '\" &amp; Trading3 &amp; \"', SabiFigures1.[Financial revenue th EUR Year \" &amp; _\n          \"- 4] = '\" &amp; Trading4 &amp; \"', SabiFigures1.[Financial revenue th EUR Year - 5] = '\" &amp; Trading5 &amp; \"', SabiFigures1.[Financial expenses th EUR Last avail yr] = '\" &amp; LatestTotalInterest &amp; \"', SabiFigures1.[Financial expenses \" &amp; _\n          \"th EUR Year - 1] = '\" &amp; TotalInterest1 &amp; \"', SabiFigures1.[Financial expenses th EUR Year - 2] = '\" &amp; TotalInterest2 &amp; \"', SabiFigures1.[Financial expenses th EUR Year - 3] = '\" &amp; TotalInterest3 &amp; \"', \" &amp; _\n          \"SabiFigures1.[Financial expenses th EUR Year - 4] = '\" &amp; TotalInterest4 &amp; \"', SabiFigures1.[Financial expenses th EUR Year - 5] = '\" &amp; TotalInterest5 &amp; \"', SabiFigures1.\" &amp; _\n          \"[P/L before tax th EUR Last avail yr] = '\" &amp; LatestPreTaxProfit &amp; \"', SabiFigures1.[P/L before tax th EUR Year - 1] = '\" &amp; PreTaxProfit1 &amp; \"', SabiFigures1.[P/L before tax th EUR Year - 2] \" &amp; _\n          \"= '\" &amp; PreTaxProfit2 &amp; \"', SabiFigures1.[P/L before tax th EUR Year - 3] = '\" &amp; PreTaxProfit3 &amp; \"', SabiFigures1.[P/L before tax th EUR Year - 4] = '\" &amp; PreTaxProfit4 &amp; \"', SabiFigures1.[P/L before tax th EUR Year - 5] = \" &amp; _\n          \"'\" &amp; PreTaxProfit5 &amp; \"', SabiFigures1.[Cost of employees th EUR Last avail yr] = '\" &amp; LatestTotEmpRem &amp; \"', SabiFigures1.[Cost of employees th EUR Year - 1] = '\" &amp; TotEmpRem1 &amp; \"', SabiFigures1.[Cost of employees th EUR Year - 2] \" &amp; _\n          \"= '\" &amp; TotEmpRem2 &amp; \"', SabiFigures1.[Cost of employees th EUR Year - 3] = '\" &amp; TotEmpRem3 &amp; \"', SabiFigures1.[Cost of employees th EUR Year - 4] = '\" &amp; TotEmpRem4 &amp; \"', SabiFigures1.[Cost of employees th EUR Year - 5] = '\" &amp; TotEmpRem5 &amp; \"' \" &amp; _\n          \"WHERE (((SabiFigures1.[NIF Code])='\" &amp; RegNum &amp; \"'));\"\n    db.Execute SQL\n    SQL = \"\"\n    RegNum = \"\"\n    LatestDate = \"\"\n    Date1 = \"\"\n    Date2 = \"\"\n    Date3 = \"\"\n    Date4 = \"\"\n    Date5 = \"\"\n    LatestMaterial = \"\"\n    Material1 = \"\"\n    Material2 = \"\"\n    Material3 = \"\"\n    Material4 = \"\"\n    Material5 = \"\"\n    LatestDepreciation = \"\"\n    Depreciation1 = \"\"\n    Depreciation2 = \"\"\n    Depreciation3 = \"\"\n    Depreciation4 = \"\"\n    Depreciation5 = \"\"\n    LatestTrading = \"\"\n    Trading1 = \"\"\n    Trading2 = \"\"\n    Trading3 = \"\"\n    Trading4 = \"\"\n    Trading5 = \"\"\n    LatestTotalInterest = \"\"\n    TotalInterest1 = \"\"\n    TotalInterest2 = \"\"\n    TotalInterest3 = \"\"\n    TotalInterest4 = \"\"\n    TotalInterest5 = \"\"\n    LatestPreTaxProfit = \"\"\n    PreTaxProfit1 = \"\"\n    PreTaxProfit2 = \"\"\n    PreTaxProfit3 = \"\"\n    PreTaxProfit4 = \"\"\n    PreTaxProfit5 = \"\"\n    LatestTotEmpRem = \"\"\n    TotEmpRem1 = \"\"\n    TotEmpRem2 = \"\"\n    TotEmpRem3 = \"\"\n    TotEmpRem4 = \"\"\n    TotEmpRem5 = \"\"\n\n            'For intI = 6 To UBound(varRecord, 2)\n            '    For intJ = 0 To UBound(varRecord, 1)\n            '        Debug.Print varRecord(intJ, intI)\n            '    Next intJ\n            'Next intI\n\n            rstDef.Close\n            Set rstDef = Nothing\n        rsFormat.MoveNext\n        Loop\n    End If\n</code></pre>\n"}], "owner": {"reputation": 129, "user_id": 9208443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3e5f14e35b5b5972bd95431b0737fd2?s=128&d=identicon&r=PG&f=1", "display_name": "Besarion", "link": "https://stackoverflow.com/users/9208443/besarion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 52869317, "answer_count": 1, "score": 0, "last_activity_date": 1539848889, "creation_date": 1539775906, "last_edit_date": 1539789221, "question_id": 52853866, "link": "https://stackoverflow.com/questions/52853866/ms-access-update-table-with-7-collections-or-1-array", "title": "MS Access Update table with 7 Collections Or 1 Array?", "body": "<p>So trying to keep this section very brief:\nI have two tables. Tbl1 has the financial accounts by year for each company in seperate rows.\nTable2 has each company only once and all the financial data is now in one row.\nHow do i do that? Currently attempting it with Collections have a second attempt going with Arrays.</p>\n\n<p>Hi guys so i have two tables Figs1 and Sabi. Figs1 is set up like: NIF,PeriodEnding, Materials, Depreciation, Non-Trading Income, Total Interest, Pretax Profit, TotalEmpRemu. </p>\n\n<p>So you'll get repeating Company IDs with each each of their financials as the rows.</p>\n\n<p>In Sabi it changes to each company has 1 row and all that data is in columns e.g. PeriodEnding_Latest, PeriodEnding -1, PeriodEnding -2 etc. till -6. I have made a collection for each column in Figs1 and i want to update the table Sabi in the correct order. </p>\n\n<p>So PeriodEnding collection will have {(31/12/2018), (31/12/2017), (31/12/2016), (31/12/2015), (31/12/2014), (31/12/2013)}</p>\n\n<p>Those values need to go to PeriodEnding_Latest, PeriodEnding -1, PeriodEnding -2 etc.</p>\n\n<p>I have the update SQL Statement and filled it with variables:</p>\n\n<pre><code>    SQL = \"UPDATE SabiFigures1 SET SabiFigures1.[Closing Date Last avail yr] = '&amp; DateFiled1 &amp;', SabiFigures1.[Closing Date Year - 1] = '&amp; DateFiled2 &amp;', \" &amp; _\n          \"SabiFigures1.[Closing Date Year - 2] = '&amp; DateFiled3 &amp;', SabiFigures1.[Closing Date Year - 3] = '&amp; DateFiled4 &amp;', SabiFigures1.[Closing Date Year - 4] = '&amp; DateFiled5 &amp;, \" &amp; _\n          \"SabiFigures1.[Closing Date Year - 5] = '&amp; DateFiled6 &amp;', SabiFigures1.[Material costs th EUR Last avail yr] = '2933', SabiFigures1.[Material costs th EUR Year - 1] \" &amp; _\n          \"= '2791', SabiFigures1.[Material costs th EUR Year - 2] = '3721', SabiFigures1.[Material costs th EUR Year - 3] = '3021', SabiFigures1.[Material costs th EUR Year - 4] \" &amp; _\n         \"= '3005', SabiFigures1.[Material costs th EUR Year - 5] = '1890', SabiFigures1.[Depreciation th EUR Last avail yr] = '49', SabiFigures1.[Depreciation th EUR Year - 1] = \" &amp; _\n         \"'52', SabiFigures1.[Depreciation th EUR Year - 2] = '47', SabiFigures1.[Depreciation th EUR Year - 3] = '42', SabiFigures1.[Depreciation th EUR Year - 4] = '54', \" &amp; _\n        \"SabiFigures1.[Depreciation th EUR Year - 5] = '63', SabiFigures1.[Financial revenue th EUR Last avail yr] = Null, SabiFigures1.[Financial revenue th EUR Year - 1] \" &amp; _\n        \"= Null, SabiFigures1.[Financial revenue th EUR Year - 2] = Null, SabiFigures1.[Financial revenue th EUR Year - 3] = Null, SabiFigures1.[Financial revenue th EUR Year \" &amp; _\n        \"- 4] = Null, SabiFigures1.[Financial revenue th EUR Year - 5] = Null, SabiFigures1.[Financial expenses th EUR Last avail yr] = Null, SabiFigures1.[Financial expenses \" &amp; _\n       \"th EUR Year - 1] = Null, SabiFigures1.[Financial expenses th EUR Year - 2] = Null, SabiFigures1.[Financial expenses th EUR Year - 3] = Null, \" &amp; _\n       \"SabiFigures1.[Financial expenses th EUR Year - 4] = Null, SabiFigures1.[Financial expenses th EUR Year - 5] = Null, SabiFigures1.\" &amp; _\n     \"[P/L before tax th EUR Last avail yr] = '407', SabiFigures1.[P/L before tax th EUR Year - 1] = '252', SabiFigures1.[P/L before tax th EUR Year - 2] \" &amp; _\n     \"= '1076', SabiFigures1.[P/L before tax th EUR Year - 3] = '597', SabiFigures1.[P/L before tax th EUR Year - 4] = '329', SabiFigures1.[P/L before tax th EUR Year - 5] = \" &amp; _\n                                            \"'102', SabiFigures1.[Cost of employees th EUR Last avail yr] = '1226', SabiFigures1.[Cost of employees th EUR Year - 1] = '1205', SabiFigures1.[Cost of employees th EUR Year - 2] \" &amp; _\n   \"= '1310', SabiFigures1.[Cost of employees th EUR Year - 3] = '1157', SabiFigures1.[Cost of employees th EUR Year - 4] = '1319', SabiFigures1.[Cost of employees th EUR Year - 5] = '1342' \" &amp; _\n   \"WHERE (((SabiFigures1.[NIF Code])='A01011550'));\"\n   db.Execute SQL\n</code></pre>\n\n<p>The code pretty much goes to first table: Figs1 and get the first regnumber it will then go to Sabi where i have prepopulated the unqiue NIFs. If it finds a correspondencing NIF in Figs1 and Sabi then it should fill out the variables from the collection however, i dont know how to do variable \"variables\". E.g. the base structure of the variable should be DateFiled but as it loops through the collection of PeriodEndings it should change from DateFiled1 till Datefiled6.</p>\n\n<pre><code>Set rsFigs1 = CurrentDb.OpenRecordset(\"Select * FROM Figs1Ready ORDER BY NIF, PeriodEnding DESC;\")\n    If Not (rsFigs1.EOF And rsFigs1.BOF) Then\n        rsFigs1.MoveFirst\n        Do Until rsFigs1.EOF = True\n            NIF = rsFigs1!NIF\n            Set rsFormat = CurrentDb.OpenRecordset(\"Select * FROM SabiFigures1;\")\n            If Not (rsFormat.EOF And rsFormat.BOF) Then\n                rsFormat.MoveFirst\n                Do Until rsFormat.EOF = True\n                    nIFF = rsFormat![NIF Code]\n                    If NIF = nIFF Then\n                        Set qdfDef = CurrentDb.QueryDefs(\"PopulateSabiFigures1\")\n                        qdfDef.Parameters(\"NIF: \").Value = nIFF\n                        Set rstDef = qdfDef.OpenRecordset()\n                        Set PeriodEnding = RSToColl(rstDef, \"PeriodEnding\")\n                        Set Materials1 = RSToColl(rstDef, \"Materials\")\n                        Set Depreciation1 = RSToColl(rstDef, \"Depreciation\")\n                        Set NonTrading1 = RSToColl(rstDef, \"Non-Trading Income\")\n                        Set TotalInterest = RSToColl(rstDef, \"Total_Interest_Charges\")\n                        Set Pretax = RSToColl(rstDef, \"Pretax_Profit\")\n                        Set TotalRemu = RSToColl(rstDef, \"Total_Empl_Remu_000\")\n\n                        For i = 1 To 6\n                        VariableName = \"DateFiled\" &amp; i\n                        Next i\n\n                        For Each Period In PeriodEnding\n                            Debug.Print TypeName(Period)\n                        Next\n\n\n                    End If\n                           SQL = 'The massive SQL statement above\n                           db.Execute SQL\n            rsFormat.MoveNext\n            Loop\n        End If\n    rsFigs1.MoveNext\n    Loop\nEnd If\n\n\nrstDef.Close\nSet rstDef = Nothing\nrsFormat.Close\nSet rsFormat = Nothing\nrsFigs1.Close\nSet rsFigs1 = Nothing\n</code></pre>\n\n<p>Maybe i'm looking at the problem in the wrong way any help and pointers would be appreciated. Thanks in advance. Added some pictures hopefully it helps\n<a href=\"https://i.stack.imgur.com/kLZ1c.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kLZ1c.jpg\" alt=\"Pretty much the layout and design of Figs\"></a>\n<a href=\"https://i.stack.imgur.com/yLufs.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yLufs.jpg\" alt=\"Design and layout of sabi\"></a></p>\n\n<p>To Gustav who first suggested an Array i can do something like this:\nThis will bring back every year(row) individually. I would like to update a row in one go to save on time instead updating each yearly value. Pretty much updating each row 6 times which would take a lot longer I imagine.</p>\n\n<pre><code>Set rsFormat = CurrentDb.OpenRecordset(\"Select * FROM SabiFigures1;\")\n    If Not (rsFormat.EOF And rsFormat.BOF) Then\n        rsFormat.MoveFirst\n        Do Until rsFormat.EOF = True\n            nIFF = rsFormat![NIF Code]\n            Set qdfDef = CurrentDb.QueryDefs(\"PopulateSabiFigures1\")\n            qdfDef.Parameters(\"NIF: \").Value = nIFF\n            Set rstDef = qdfDef.OpenRecordset()\n            rstDef.MoveLast\n            rstDef.MoveFirst\n            varRecord = rstDef.GetRows(rstDef.RecordCount)\n            For intI = 0 To 5 'UBound(varRecord, 2)\n                For intJ = 0 To UBound(varRecord, 1)\n                    Debug.Print varRecord(intJ, intI)\n                Next intJ\n            Next intI\n                    'whole row updated here after each value of the array is passed to variables for each year and financial value.\n            rstDef.Close\n            Set rstDef = Nothing\n        rsFormat.MoveNext\n        Loop\n    End If\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "ms-office"], "comments": [{"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 3, "creation_date": 1539776066, "post_id": 52853700, "comment_id": 92622924, "body": "I guess you will have to adopt - <i>resistance is futile</i>: <a href=\"https://stackoverflow.com/questions/45332357/ms-access-vba-error-run-time-error-70-permission-denied\">Workaround</a>"}], "owner": {"reputation": 1997, "user_id": 4409883, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/xZatI.jpg?s=128&g=1", "display_name": "Edgar", "link": "https://stackoverflow.com/users/4409883/edgar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 198, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1539775374, "creation_date": 1539775374, "question_id": 52853700, "link": "https://stackoverflow.com/questions/52853700/vba-set-typelib-createobject-scriptlet-typelib-permission-denied-same-p", "title": "VBA &#39;set typelib = createobject(\u201cscriptlet.typelib\u201d)&#39; Permission Denied - same problem, new reason?", "body": "<p>In 2017 this problem was described</p>\n\n<pre><code>createobject(\u201cscriptlet.typelib\u201d)' Permission Denied\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/questions/45082258/vba-set-typelib-createobjectscriptlet-typelib-permission-denied\">VBA &#39;set typelib = createobject(&quot;scriptlet.typelib&quot;)&#39; Permission Denied</a></p>\n\n<p>At that time the problem could be solved by removing KB3213624.\nNow October 2018, the problem happens again even if KB3213624 is not installed.</p>\n\n<p>Yesterday about 30 updates were installed on a PC with that problem. It will take me a long time to check them one by one.\nDoes anybody else have the same experience and knows already which update is to blame this time?</p>\n"}, {"tags": ["excel", "vba", "maxifs"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1539775100, "post_id": 52853486, "comment_id": 92622396, "body": "There is a <code>Application.WorksheetFunction.MaxIfs</code> (since Office 2013 I think)"}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 9497551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9fe214dce005ed2943cb5a14fad9129?s=128&d=identicon&r=PG&f=1", "display_name": "Uvulagirl", "link": "https://stackoverflow.com/users/9497551/uvulagirl"}, "edited": false, "score": 0, "creation_date": 1539776059, "post_id": 52853716, "comment_id": 92622919, "body": "Thanks @Dom! That code has worked! I knew it would be something simple that I just couldn&#39;t think of. Though I&#39;m using Excel 2016 on my laptop at home, at work we&#39;re using 2010. Will that affect this code from working? cheers"}, {"owner": {"reputation": 83, "user_id": 10489292, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156760876493739/picture?type=large", "display_name": "Dom", "link": "https://stackoverflow.com/users/10489292/dom"}, "reply_to_user": {"reputation": 17, "user_id": 9497551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9fe214dce005ed2943cb5a14fad9129?s=128&d=identicon&r=PG&f=1", "display_name": "Uvulagirl", "link": "https://stackoverflow.com/users/9497551/uvulagirl"}, "edited": false, "score": 0, "creation_date": 1539776448, "post_id": 52853716, "comment_id": 92623135, "body": "No problem happy to help. Take a look at Vityata\u2019s answer - I think enabling MS Office 16.0 object library would work, although I\u2019m not sure if this is available in Excel 2010."}, {"owner": {"reputation": 17, "user_id": 9497551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9fe214dce005ed2943cb5a14fad9129?s=128&d=identicon&r=PG&f=1", "display_name": "Uvulagirl", "link": "https://stackoverflow.com/users/9497551/uvulagirl"}, "edited": false, "score": 0, "creation_date": 1539822997, "post_id": 52853716, "comment_id": 92644885, "body": "Hi @Dom, bad news. It looks like MS Office 16.0 object library isn&#39;t available in my work&#39;s set up. Are you able to suggest a different code? I can get array formula =MAX(IF(A:A&lt;2018000,A:A)) +1 to get the result I want in Excel but I&#39;ve never used an array formula in VBA."}], "tags": [], "owner": {"reputation": 83, "user_id": 10489292, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156760876493739/picture?type=large", "display_name": "Dom", "link": "https://stackoverflow.com/users/10489292/dom"}, "is_accepted": true, "score": 1, "last_activity_date": 1539775438, "creation_date": 1539775438, "answer_id": 52853716, "question_id": 52853486, "link": "https://stackoverflow.com/questions/52853486/ms-excel-2010-maxifs-equivalent-in-vba-userform/52853716#52853716", "title": "MS Excel 2010 MAXIFS equivalent in VBA Userform", "body": "<p>If you're looking for the largest number anyway, do you need to filter out anything lower than 2018000? If you have at least one entry equal to/higher than 2018000, your end result will be higher regardless of the other entries.</p>\n\n<p>I'm sure there are more efficient ways of doing it, but if you are happy with:</p>\n\n<pre><code>Me.tbContractNumber = Application.WorksheetFunction.Max(Sheet1.UsedRange.Columns(1)) + 1\n</code></pre>\n\n<p>then try:</p>\n\n<pre><code>me.tbContractNumber = Application.WorksheetFunction.MaxIfs(Sheet1.UsedRange.Columns(1), Sheet1.UsedRange.Columns(1), \"&gt;\" &amp; 2018000) + 1\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 17, "user_id": 9497551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9fe214dce005ed2943cb5a14fad9129?s=128&d=identicon&r=PG&f=1", "display_name": "Uvulagirl", "link": "https://stackoverflow.com/users/9497551/uvulagirl"}, "edited": false, "score": 1, "creation_date": 1539776351, "post_id": 52853721, "comment_id": 92623088, "body": "Thanks @Vityata! That is very valuable information. I will have to try it out next time I get stuck converting formulas to VBA. Cheers!"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1539775932, "last_edit_date": 1539775932, "creation_date": 1539775449, "answer_id": 52853721, "question_id": 52853486, "link": "https://stackoverflow.com/questions/52853486/ms-excel-2010-maxifs-equivalent-in-vba-userform/52853721#52853721", "title": "MS Excel 2010 MAXIFS equivalent in VBA Userform", "body": "<p><em>...but apparently MAXIFS is not an available function in VBA</em>. In VBA it is not present, but if you add the Excel 16.0 Object Library (second on the screenshot) to your project, you would be able to access it as follows:</p>\n\n<pre><code>Application.WorksheetFunction.MaxIfs 'Only in Excel\nExcel.WorksheetFunction.MaxIfs       'Any host of VBA - Excel, Access, Word\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/GEgbx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GEgbx.png\" alt=\"enter image description here\"></a></p>\n\n<p>The library is added by default, if you work in Excel. Concerning \"translation\" the working formula from Excel to VBA, check this:</p>\n\n<p><a href=\"https://stackoverflow.com/a/49363501/5448626\">https://stackoverflow.com/a/49363501/5448626</a></p>\n"}, {"tags": [], "owner": {"reputation": 17, "user_id": 9497551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9fe214dce005ed2943cb5a14fad9129?s=128&d=identicon&r=PG&f=1", "display_name": "Uvulagirl", "link": "https://stackoverflow.com/users/9497551/uvulagirl"}, "is_accepted": false, "score": 0, "last_activity_date": 1539866836, "creation_date": 1539866836, "answer_id": 52874407, "question_id": 52853486, "link": "https://stackoverflow.com/questions/52853486/ms-excel-2010-maxifs-equivalent-in-vba-userform/52874407#52874407", "title": "MS Excel 2010 MAXIFS equivalent in VBA Userform", "body": "<p>I just learned the Evaluate function! So equivalent of the array formula I want to use converts in VBA to:</p>\n\n<pre><code>Me.tbContractNumber = Evaluate(\"=MAX(IF(\" &amp; \"A:A\" &amp; \"&lt;2018000,\" &amp; \"A:A\" &amp; \"))+1\")\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 9497551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9fe214dce005ed2943cb5a14fad9129?s=128&d=identicon&r=PG&f=1", "display_name": "Uvulagirl", "link": "https://stackoverflow.com/users/9497551/uvulagirl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1565, "favorite_count": 0, "accepted_answer_id": 52853716, "answer_count": 3, "score": 1, "last_activity_date": 1539866836, "creation_date": 1539774682, "last_edit_date": 1539823997, "question_id": 52853486, "link": "https://stackoverflow.com/questions/52853486/ms-excel-2010-maxifs-equivalent-in-vba-userform", "title": "MS Excel 2010 MAXIFS equivalent in VBA Userform", "body": "<p>I've created an Excel Userform to facilitate the data entry of new lines into a contract register. I have a field that auto-generates a new unique contract number by looking for the largest number in the list of contract numbers (Column A) and then adds 1. This formula works perfectly:</p>\n\n<pre><code>Me.tbContractNumber = Application.WorksheetFunction.Max(Sheet1.UsedRange.Columns(1)) + 1\n</code></pre>\n\n<p>I now have to add an IF criteria to filter out any contract numbers LESS Than \"2018000\". I have worked out how to do this in a normal Excel workbook using MAXIFS but apparently MAXIFS is not an available function in VBA?</p>\n\n<p>Can someone suggest an equivalent VBA code to the below Excel formula? Thanking you in advance!</p>\n\n<pre><code>=MAXIFS(A2:A500,A2:A500,\"&lt;2018000\")+1\n</code></pre>\n\n<p><strong>EDIT</strong> Our work computers run 2010 and won't allow me to add the MS Office 16.0 Object Library so MAXIFS function will not work. I can get the following array formula to work but I have never used an array formula in VBA. Could someone please suggest an equivalent VBA code to the below Excel formula? Thanking you in advance!</p>\n\n<pre><code>{=MAX(IF(A:A&lt;2018000,A:A)) +1}\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1539774165, "post_id": 52853226, "comment_id": 92621787, "body": "Can you provide an URL?"}, {"owner": {"reputation": 438, "user_id": 7546144, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/185d34367f3bb1b78249439381110c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/7546144/anthony"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1539774257, "post_id": 52853226, "comment_id": 92621845, "body": "@QHarr I am scraping to an AS400 screen not a website."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1539774286, "post_id": 52853226, "comment_id": 92621861, "body": "Oh..my bad. Will delete answer. I guess that means you cannot specify number of times to repeat (e.g. Application.SendKeys &quot;{TAB 15}&quot;)  nor use .Clear on input field?"}, {"owner": {"reputation": 438, "user_id": 7546144, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/185d34367f3bb1b78249439381110c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/7546144/anthony"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1539774559, "post_id": 52853226, "comment_id": 92622033, "body": "@QHarr Appreciate your time. Using .SendKeys (&quot;&lt;Clear&gt;&quot;) clears the whole screen not just the field. Will try your Application.SendKeys &quot;{TAB 15}&quot;)  though."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1539774592, "post_id": 52853226, "comment_id": 92622057, "body": "Clear is a method applied to an input element in html not as sendkeys."}, {"owner": {"reputation": 14672, "user_id": 8967612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEhyd.png?s=128&g=1", "display_name": "41686d6564", "link": "https://stackoverflow.com/users/8967612/41686d6564"}, "edited": false, "score": 1, "creation_date": 1539774652, "post_id": 52853226, "comment_id": 92622102, "body": "<a href=\"https://stackoverflow.com/q/42133930/4934172\">This</a> might be related."}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1539775026, "post_id": 52853226, "comment_id": 92622344, "body": "usually the <code>Home</code> key moves the caret to the beginning, or <code>Ctrl</code> + <code>Left</code>"}], "owner": {"reputation": 438, "user_id": 7546144, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/185d34367f3bb1b78249439381110c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/7546144/anthony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1539774141, "creation_date": 1539773705, "last_edit_date": 1539774110, "question_id": 52853226, "link": "https://stackoverflow.com/questions/52853226/how-to-efficiently-clear-a-field-using-excel-vba-while-scraping", "title": "How to efficiently clear a field using excel vba while scraping?", "body": "<p>I need to clear a field before populating it with a number. I overcame my problem by using the code below but is there a more efficient way of doing this? That is am I able to move the cursor directly to the start of the field without tabing and clear the whole field without sending individual deletes?</p>\n\n<pre><code>.SendKeys (\"&lt;Tab&gt;&lt;Tab&gt;&lt;Tab&gt;&lt;Tab&gt;&lt;Tab&gt;&lt;Tab&gt;&lt;Tab&gt;&lt;Tab&gt;&lt;Tab&gt;&lt;Tab&gt;&lt;Tab&gt;&lt;Tab&gt;&lt;Tab&gt;&lt;Tab&gt;&lt;Tab&gt;\")\n            .SendKeys (\"&lt;Delete&gt;\")\n            .SendKeys (\"&lt;Delete&gt;\")\n            .SendKeys (\"&lt;Delete&gt;\")\n            .SendKeys (\"&lt;Delete&gt;\")\n            .SendKeys (\"&lt;Delete&gt;\")\n            .SendKeys (\"&lt;Delete&gt;\")\n            .Putstring cardno, 9, 29\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 9196626, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2KbEc.jpg?s=128&g=1", "display_name": "Pavan Shriram Jangid", "link": "https://stackoverflow.com/users/9196626/pavan-shriram-jangid"}, "edited": false, "score": 0, "creation_date": 1540467884, "post_id": 52857301, "comment_id": 92882021, "body": "I tried did but no change in execution time for CopyFromRecordset"}, {"owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "reply_to_user": {"reputation": 23, "user_id": 9196626, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2KbEc.jpg?s=128&g=1", "display_name": "Pavan Shriram Jangid", "link": "https://stackoverflow.com/users/9196626/pavan-shriram-jangid"}, "edited": false, "score": 0, "creation_date": 1540476347, "post_id": 52857301, "comment_id": 92887769, "body": "Did you try the <code>CursorLocation = adUseClient</code> part? @pavanjangid"}, {"owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "reply_to_user": {"reputation": 23, "user_id": 9196626, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2KbEc.jpg?s=128&g=1", "display_name": "Pavan Shriram Jangid", "link": "https://stackoverflow.com/users/9196626/pavan-shriram-jangid"}, "edited": false, "score": 0, "creation_date": 1540561220, "post_id": 52857301, "comment_id": 92923500, "body": "@pavanjangid Are you calling <code>con.Close</code> after each query? You can leave the connection open between queries and call <code>con.Close</code> when you are done."}], "tags": [], "owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "is_accepted": false, "score": 0, "last_activity_date": 1539786766, "last_edit_date": 1539786766, "creation_date": 1539786405, "answer_id": 52857301, "question_id": 52853192, "link": "https://stackoverflow.com/questions/52853192/copyfromrecordset-taking-too-much-time/52857301#52857301", "title": "CopyFromRecordset taking too much time", "body": "<p>If you don't have already, you can add these before copying over the recordset:</p>\n\n<pre><code>Application.ScreenUpdating = False\nApplication.EnableEvents = False\nApplication.Calculation = xlManual\n</code></pre>\n\n<p>Then turn them back to normal after the data is copied over.</p>\n\n<p>The only other way I can think of for copying over the recordset data would be to loop through all of the fields in the recordset but I can't imagine this being any faster.</p>\n\n<p>Please also see SwiftJr's answer on: <a href=\"https://stackoverflow.com/questions/1574213/vba-querying-access-with-excel-why-so-slow\">VBA: Querying Access with Excel. Why so slow?</a></p>\n\n<p>Maybe you can set your cursor location with <code>CursorLocation = adUseClient</code> on your connection as the answer notes</p>\n"}], "owner": {"reputation": 23, "user_id": 9196626, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2KbEc.jpg?s=128&g=1", "display_name": "Pavan Shriram Jangid", "link": "https://stackoverflow.com/users/9196626/pavan-shriram-jangid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 235, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1591644460, "creation_date": 1539773617, "last_edit_date": 1591644460, "question_id": 52853192, "link": "https://stackoverflow.com/questions/52853192/copyfromrecordset-taking-too-much-time", "title": "CopyFromRecordset taking too much time", "body": "<p>I am running below one VBA code and in that <code>CopyFromRecordset</code> is being called multiple time and taking too much time for execution.</p>\n\n<p>Is there any way to reduce execution time?</p>\n\n<pre><code>DBPath = ThisWorkbook.FullName\nSconnect = \"Provider=MSDASQL.1;DSN=Excel Files;DBQ=\" &amp; DBPath &amp; \";HDR=Yes';\"\ncon.Open Sconnect\nSQLQuery = \"Select * from [ALM_Scenario_Dump$] where Scenario_Name='\" &amp; Scenario_Na &amp; \"'\"\nmrs.Open SQLQuery, con\n               ThisWorkbook.Sheets(\"ALM_Scenario_Detailed_Temp\").Range(\"A2\").CopyFromRecordset mrs\nmrs.Close\ncon.Close\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 5, "creation_date": 1539775906, "post_id": 52853047, "comment_id": 92622835, "body": "Try removing the parentheses from around <code>objMyRecordset</code> and see if that makes any difference..."}], "owner": {"reputation": 164, "user_id": 6100889, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d668560e423af459bd8d8e701ac1cb72?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/6100889/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 99, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1591644471, "creation_date": 1539773113, "last_edit_date": 1591644471, "question_id": 52853047, "link": "https://stackoverflow.com/questions/52853047/vba-class-does-not-support-automation-or-does-not-support-expected-interface", "title": "VBA Class does not support automation or does not support expected interface", "body": "<p>I have this code trying to query a ms sql database but I get the above error on the last line  any help please</p>\n\n<pre><code>     'Declare variables'\nDim objMyConn As ADODB.Connection\n Dim objMyRecordset As ADODB.Recordset\n    Set objMyConn = New ADODB.Connection\n    Set objMyRecordset = New ADODB.Recordset\n    Dim strSQL As String\n\n'Open Connection'\n    objMyConn.ConnectionString = \"connection string\"\n    objMyConn.Open\n\n'Set and Excecute SQL Command'\n    strSQL = \"SELECT * FROM dbtable\"\n\n'Open Recordset'\n    Set objMyRecordset.ActiveConnection = objMyConn\n    objMyRecordset.Open strSQL\n\n'Copy Data to Excel'\n (ERROR HERE--&gt;)      ActiveSheet.Range(\"A1\").CopyFromRecordset (objMyRecordset)\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-2013"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9828342, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XGsbwqhj5_o/AAAAAAAAAAI/AAAAAAAAAAk/YrkT_shhgYk/photo.jpg?sz=128", "display_name": "Martin Strau&#223;berger", "link": "https://stackoverflow.com/users/9828342/martin-strau%c3%9fberger"}, "edited": false, "score": 0, "creation_date": 1539869941, "post_id": 52853811, "comment_id": 92664180, "body": "I am very grateful for your fast response and solutions. It works perfect!"}, {"owner": {"reputation": 3, "user_id": 9828342, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XGsbwqhj5_o/AAAAAAAAAAI/AAAAAAAAAAk/YrkT_shhgYk/photo.jpg?sz=128", "display_name": "Martin Strau&#223;berger", "link": "https://stackoverflow.com/users/9828342/martin-strau%c3%9fberger"}, "edited": false, "score": 0, "creation_date": 1539870380, "post_id": 52853811, "comment_id": 92664467, "body": "One further point. How can I copy an entire row with all formulas but also emptying the Text in the same time? Thanks in advance :-)"}, {"owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "reply_to_user": {"reputation": 3, "user_id": 9828342, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XGsbwqhj5_o/AAAAAAAAAAI/AAAAAAAAAAk/YrkT_shhgYk/photo.jpg?sz=128", "display_name": "Martin Strau&#223;berger", "link": "https://stackoverflow.com/users/9828342/martin-strau%c3%9fberger"}, "edited": false, "score": 0, "creation_date": 1539937170, "post_id": 52853811, "comment_id": 92689640, "body": "If you only want to copy formulas and no content, use this: <code>ActiveCell.EntireRow.Copy</code> and then <code>range(&quot;a22&quot;).PasteSpecial xlPasteFormulas</code>, where &quot;a22&quot; represents the target row. Please note that target column always must be &quot;A&quot; when copying entire row. BTW, as you work with a range of rectangular shape, why don&#39;t you take a look at how to work with ranges instead of entire rows."}], "tags": [], "owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "is_accepted": true, "score": 0, "last_activity_date": 1539775726, "creation_date": 1539775726, "answer_id": 52853811, "question_id": 52853030, "link": "https://stackoverflow.com/questions/52853030/delimit-macro-on-flexible-area-in-sheet/52853811#52853811", "title": "Delimit macro on flexible area in Sheet", "body": "<p>You can operate with <code>Target.Row</code> and <code>Activecell.Row</code>, like this: </p>\n\n<pre><code>Set Target = Range(\"A9:R200\").Find(\"Y\", LookIn:=xlValues, lookat:=xlWhole, MatchCase:=True) \n   ' note the quotes around Y\nIf Target Is Nothing Then\n    iMaxRow = 200             ' need to set some maximum value even if Y is not found\nElse\n    iMaxRow = Target.Row\nEndif\nIf Activecell.Row &gt;iMaxRow Then\n     Msgbox \"out of range\"\n     End\nEnd\n... and here you can continue inserting\n</code></pre>\n\n<p>Similarly, you can control the horizontal dimension with <code>Target.Column</code>. \nAnd it can make sense to limit the number of inserted rows, too, like this: </p>\n\n<pre><code>If ActiveCell.Row + icountROws &gt; iMaxRow Then icountRows = iMAxRow - ActiveCell.Row \n</code></pre>\n\n<p>Try to avoid using select. See more here: <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How To Avoid Using Select</a>. Anyhow, you can not compare an entire (selected) row with a value. </p>\n\n<p>Instead of </p>\n\n<pre><code>ActiveCell.EntireRow.Select 'Can this work?\nIf ActiveCell.EntireRow.Select &gt;= Y And ActiveCell.EntireRow.Select = Y Then\n</code></pre>\n\n<p>use</p>\n\n<pre><code>If Target.Value = \"Y\" Then \n</code></pre>\n\n<p>or</p>\n\n<pre><code>If Target.Value = \"Y\" Or Target.Value = \"y\" Then \n</code></pre>\n\n<p>Instead of </p>\n\n<pre><code>ActiveCell.EntireRow.Select\nSelection.Copy\n</code></pre>\n\n<p>use</p>\n\n<pre><code>ActiveCell.EntireRow.Copy\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9828342, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XGsbwqhj5_o/AAAAAAAAAAI/AAAAAAAAAAk/YrkT_shhgYk/photo.jpg?sz=128", "display_name": "Martin Strau&#223;berger", "link": "https://stackoverflow.com/users/9828342/martin-strau%c3%9fberger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 52853811, "answer_count": 1, "score": 0, "last_activity_date": 1593677220, "creation_date": 1539773062, "last_edit_date": 1593677220, "question_id": 52853030, "link": "https://stackoverflow.com/questions/52853030/delimit-macro-on-flexible-area-in-sheet", "title": "Delimit macro on flexible area in Sheet", "body": "<p>I am new to VBA and try to handle a Sheet with 2 tables and specific macros.\nI created macros within one single module and placed to buttons called: Positionen_Einf\u00fcgen (insert entire rows) and Zeile_L\u00f6schen (delete entire row).</p>\n\n<p>The code runs perfect, but now I want to dilimit these macros for a specific area in my Wokrsheet(Einzelkosten), but the area is still flexible since you are allowed to insert multiple rows or delete one row.</p>\n\n<p>In this case I placed an big red \"Y\" where the table stops. My \"Y\" is flexible and moves of course with the macros if you use them. Like several rows down or one up.</p>\n\n<p>I want to use this \"Y\" as a boarder for the ActiveCell.EntireRow.Select. So can I write a .Find(\"Y\") function within my macros, like in the code below:</p>\n\n<pre><code>Position_Einf\u00fcgen()\n'Disable Excel feautres to prevent Errors\nActiveSheet.Unprotect\n\nApplication.Calculation = xlCalculationManual\nApplication.EnableEvents = False\nApplication.ScreenUpdating = False\n\n'set specific range for area\nDim Target As Range\nSet Target = Range(\"A9:R200\").Find(Y, LookIn:=xlValues)\n\n\nicountROws = Application.InputBox(Prompt:=\"How many rows do you want to  insert after Line \" _\n&amp; ActiveCell.Row &amp; \" ?\", Type:=1)\n' Dont allow negative numbers or empty field: Error Handling\nIf icountROws &lt;= 0 Then End\n\nActiveCell.EntireRow.Select\n'Can this work?\n     If ActiveCell.EntireRow.Select &gt;= Y And ActiveCell.EntireRow.Select = Y Then\n     MsgBox (\"Sie befinden sich au\u00dferhalb des erlaubten Bereichs\")\n     End If\n Exit Sub\n     Else If\n     Selection.Copy\n     ' Selection.PasteSpecial xlPasteFormulas\n     Rows(ActiveCell.Row &amp; \":\" &amp; ActiveCell.Row + icountROws - 1).Insert shift:=xlDown\n     End If\n\n    'Re-enable features after running macro, auto-debugging\n     Application.Calculation = xlCalculationAutomatic\n     Application.EnableEvents = True\n     Application.ScreenUpdating = True\n\n     ActiveSheet.Protect DrawingObjects:=False, Contents:=True, Scenarios:= _\n        True, AllowFormattingCells:=True, AllowFormattingColumns:=True\n     ActiveSheet.EnableSelection = xlNoRestrictions\nEnd Sub\n</code></pre>\n\n<p>Here is the 2. macro: Delete Function</p>\n\n<pre><code>Sub Zeile_L\u00f6schen()\n\n'select row to delete\nDim DeletePrompt As Integer\n\nDeletePrompt = MsgBox(\"Are you sure you want to delete this row?\", vbYesNo +   vbQuestion, \"Delete\")\n    ActiveSheet.Unprotect\n    If DeletePrompt = vbYes Then\n    Rows(ActiveCell.Row).Delete\n    Else\n        'do nothing\n    End If\n\n    ActiveSheet.Protect DrawingObjects:=False, Contents:=True, Scenarios:= _\n        True, AllowFormattingCells:=True, AllowFormattingColumns:=True\n    ActiveSheet.EnableSelection = xlNoRestrictions\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/4Vqx4.png\" rel=\"nofollow noreferrer\">Within my black highlighted brackets is the specific area where the code is allowed to run, otherwise Prompt MsgBox(\"You are outside of the table\")</a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1539776999, "post_id": 52852932, "comment_id": 92623462, "body": "You can&#39;t. Changing colours will not trigger a recalculation, so you&#39;d have to use something like a timer to recalculate everything periodically, which would be annoying at best. Best solution in my opinion is to rethink your entire approach to whatever you think you need this for. ;)"}, {"owner": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1539777976, "post_id": 52852932, "comment_id": 92624075, "body": "@Rory thanks, At least I know that Application.volatile brought me as far as possible for a clean code :)"}], "owner": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1591644481, "creation_date": 1539772757, "last_edit_date": 1591644481, "question_id": 52852932, "link": "https://stackoverflow.com/questions/52852932/refreshing-a-vba-function-not-only-with-value-changes-also-colors-etc", "title": "Refreshing a VBA function not only with value changes (Also colors etc...)", "body": "<p>I tried to refresh a cell function that returns the colorindex of a cell. </p>\n\n<pre><code>Function doubled(RA As Range)\n\nApplication.Volatile\ndoubled = RA.Font.ColorIndex\n\nEnd Function\n</code></pre>\n\n<p>I have seen this answer but it only updates for values : <a href=\"https://stackoverflow.com/questions/11045/refresh-excel-vba-function-results\">Refresh Excel VBA Function Results</a></p>\n"}, {"tags": ["vba", "ms-word", "word-contentcontrol"], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 1, "last_activity_date": 1539775304, "creation_date": 1539775304, "answer_id": 52853686, "question_id": 52852721, "link": "https://stackoverflow.com/questions/52852721/how-to-add-content-control-before-bookmark/52853686#52853686", "title": "How to add Content Control before bookmark?", "body": "<p>Bookmarks aren't substantial \"objects\" in the text flow, the way a character is, so it's not possible to insert anything immediately before a bookmark. The insertion position would have to be moved at least one character back from the bookmark.</p>\n\n<p>The only way to have the bookmark directly after the content control is to delete and recreate the bookmark. Here's an example. Note the use of <code>Range</code> objects to keep track of where the content control is and where the bookmark is. This example is for an \"I-beam\" bookmark: a bookmark that is a single position, not a range of characters.</p>\n\n<pre><code>Sub InsertCCbeforeBookmark()\n    Dim bkm As Bookmark, sBookmarkName As String\n    Dim rngBookmark As Word.Range, rngCC As Word.Range\n    Dim objCC As ContentControl\n\n    sBookmarkName = \"VP_pav\"\n    Set bkm = ActiveDocument.Bookmarks(sBookmarkName)\n    Set rngBookmark = bkm.Range\n    Set rngCC = rngBookmark.Duplicate\n    rngCC.Collapse wdCollapseStart\n    Set objCC = ActiveDocument.Contentcontrols.Add(0, rngCC)\n    rngBookmark.Start = objCC.Range.End\n    rngBookmark.MoveStart wdCharacter, 1\n    bkm.Delete\n    ActiveDocument.Bookmarks.Add sBookmarkName, rngBookmark\n    objCC.title = \"Test\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 491, "user_id": 10154892, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-zxWv-GwaUFs/AAAAAAAAAAI/AAAAAAAABNQ/k076JfSWJ-c/photo.jpg=k-s128", "display_name": "Gexas", "link": "https://stackoverflow.com/users/10154892/gexas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 245, "favorite_count": 0, "accepted_answer_id": 52853686, "answer_count": 1, "score": 1, "last_activity_date": 1545423870, "creation_date": 1539772135, "last_edit_date": 1545423870, "question_id": 52852721, "link": "https://stackoverflow.com/questions/52852721/how-to-add-content-control-before-bookmark", "title": "How to add Content Control before bookmark?", "body": "<p>I want macro to add Content Control before bookmark. I am having trouble figuring out syntax for \"before\" part since <code>.Range.InsertBefore</code> works only with string. </p>\n\n<p>Please give me some direction how to change my code to make new Content Conrols to be inserted before bookmark.</p>\n\n<p>My current code for inserting Content Control: </p>\n\n<pre><code>Sub Test()\n\n    Dim objCC As ContentControl\n          'it inserts Content control after bookmark, not before, how to change this part?\n    Set objCC = ActiveDocument.ContentControls.Add(0, ActiveDocument.Bookmarks(\"VP_pav\").Range)\n    objCC.Title = \"Test\"\n\n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula", "excel-2016"], "comments": [{"owner": {"reputation": 43423, "user_id": 1011724, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/2JAXi.jpg?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/1011724/dan"}, "edited": false, "score": 0, "creation_date": 1539771304, "post_id": 52852190, "comment_id": 92620177, "body": "Can you post a link to the website, perhaps there is a better way for you to copy or paste the data..."}, {"owner": {"reputation": 5188, "user_id": 239991, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b5db9624095605a6fc05ff584cf8c14c?s=128&d=identicon&r=PG&f=1", "display_name": "venkat", "link": "https://stackoverflow.com/users/239991/venkat"}, "reply_to_user": {"reputation": 43423, "user_id": 1011724, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/2JAXi.jpg?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/1011724/dan"}, "edited": false, "score": 0, "creation_date": 1539772398, "post_id": 52852190, "comment_id": 92620792, "body": "Sorry it&#39;s internal client portal"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1539842842, "post_id": 52852190, "comment_id": 92649277, "body": "This is impossible. Why? Because for No 1 all lines but the last go into description. But for No 2 only the first line goes to description and the others go to comments. How can the computer decide that? I see no pattern here. \u2022 No pattern means not possible! \u2022 Therefore you can only solve this if you show us the original data (of the website) you already lost information (which text is which column) while you extracted it to Excel/Word. So the way you extract the data is already wrong and needs to be fixed."}], "answers": [{"tags": [], "owner": {"reputation": 102, "user_id": 9533798, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KYlZOcL9Uws/AAAAAAAAAAI/AAAAAAAABSQ/oc-0zjfztwg/photo.jpg?sz=128", "display_name": "Neeraj Dwivedi", "link": "https://stackoverflow.com/users/9533798/neeraj-dwivedi"}, "is_accepted": false, "score": -2, "last_activity_date": 1539771149, "creation_date": 1539771149, "answer_id": 52852392, "question_id": 52852190, "link": "https://stackoverflow.com/questions/52852190/how-to-customize-dynamic-tabular-data-from-web-into-excel/52852392#52852392", "title": "How to customize dynamic tabular data from web into excel", "body": "<p>Try using <strong>Keep Source Formatting</strong> to keep the formatting of whatever you copied.</p>\n\n<p>Shortcut is--> <strong>CTRL + K</strong></p>\n\n<p>Link to the article about pasting to retain formatting -->  <a href=\"https://support.office.com/en-us/article/copy-cell-data-and-paste-attributes-only-0636593a-985c-4c34-bcfa-049f470a6596\" rel=\"nofollow noreferrer\">https://support.office.com/en-us/article/copy-cell-data-and-paste-attributes-only-0636593a-985c-4c34-bcfa-049f470a6596</a></p>\n"}, {"comments": [{"owner": {"reputation": 5188, "user_id": 239991, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b5db9624095605a6fc05ff584cf8c14c?s=128&d=identicon&r=PG&f=1", "display_name": "venkat", "link": "https://stackoverflow.com/users/239991/venkat"}, "edited": false, "score": 0, "creation_date": 1539772450, "post_id": 52852393, "comment_id": 92620818, "body": "This not resolving the expected output when sharing the report with the data. Any alternate ways?"}, {"owner": {"reputation": 43423, "user_id": 1011724, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/2JAXi.jpg?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/1011724/dan"}, "reply_to_user": {"reputation": 5188, "user_id": 239991, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b5db9624095605a6fc05ff584cf8c14c?s=128&d=identicon&r=PG&f=1", "display_name": "venkat", "link": "https://stackoverflow.com/users/239991/venkat"}, "edited": false, "score": 0, "creation_date": 1539772969, "post_id": 52852393, "comment_id": 92621109, "body": "@venkat what does that mean? You need to be specific. Note that because it&#39;s using the <code>ROW</code> formula, it relies on this being in row 1 and referencing row 1. Also, I have literally pasted your input data directly into Excel and you can see your exact output data shown which is generated by the formula so you need to be a lot more specific about what you want if it&#39;s not the exact input and output in your question."}, {"owner": {"reputation": 43423, "user_id": 1011724, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/2JAXi.jpg?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/1011724/dan"}, "reply_to_user": {"reputation": 5188, "user_id": 239991, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b5db9624095605a6fc05ff584cf8c14c?s=128&d=identicon&r=PG&f=1", "display_name": "venkat", "link": "https://stackoverflow.com/users/239991/venkat"}, "edited": false, "score": 0, "creation_date": 1539773436, "post_id": 52852393, "comment_id": 92621364, "body": "Note that if your input data or output data do not start in row 1, then here is a more general formula <code>=INDEX($A:$A,(ROW(A1)-1)*3+ROW($A$6)+COLUMN(A3)-1)</code>. This assumes the input data are in column A and it starts in row 6. It doesn&#39;t matter where the output data are. Just drag it across and down"}, {"owner": {"reputation": 43423, "user_id": 1011724, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/2JAXi.jpg?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/1011724/dan"}, "reply_to_user": {"reputation": 5188, "user_id": 239991, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b5db9624095605a6fc05ff584cf8c14c?s=128&d=identicon&r=PG&f=1", "display_name": "venkat", "link": "https://stackoverflow.com/users/239991/venkat"}, "edited": false, "score": 3, "creation_date": 1539793781, "post_id": 52852393, "comment_id": 92633853, "body": "This is a completely different question"}], "tags": [], "owner": {"reputation": 43423, "user_id": 1011724, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/2JAXi.jpg?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/1011724/dan"}, "is_accepted": false, "score": 0, "last_activity_date": 1539773685, "last_edit_date": 1539773685, "creation_date": 1539771151, "answer_id": 52852393, "question_id": 52852190, "link": "https://stackoverflow.com/questions/52852190/how-to-customize-dynamic-tabular-data-from-web-into-excel/52852393#52852393", "title": "How to customize dynamic tabular data from web into excel", "body": "<p><a href=\"https://i.stack.imgur.com/EaUFk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EaUFk.png\" alt=\"enter image description here\"></a></p>\n\n<p>You can do it with this formula, changing the last parameter from <code>+1</code> up to <code>+3</code> for each column of your output. </p>\n\n<pre><code>=INDEX(A:A,(ROW()-1)*3+1)\n</code></pre>\n\n<p>The image shows the formula used for your third column</p>\n\n<p>Note that if your input or output data do not start in row 1, then you need to change it as follows:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Pe9ZH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Pe9ZH.png\" alt=\"enter image description here\"></a></p>\n\n<p>i.e. put the formula <code>=INDEX($A:$A,(ROW(A1)-1)*3+ROW($A$6)+COLUMN(A3)-1)</code> in the cell in which you want your output to start. Change the <code>$A:$A</code> to the column containing your input data and <code>$A$6</code> to the cell where your input data start.</p>\n"}, {"comments": [{"owner": {"reputation": 5188, "user_id": 239991, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b5db9624095605a6fc05ff584cf8c14c?s=128&d=identicon&r=PG&f=1", "display_name": "venkat", "link": "https://stackoverflow.com/users/239991/venkat"}, "edited": false, "score": 0, "creation_date": 1539793656, "post_id": 52854695, "comment_id": 92633778, "body": "Modified the Question."}, {"owner": {"reputation": 5038, "user_id": 4552529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7dff9245051269e55748c81670088e8?s=128&d=identicon&r=PG&f=1", "display_name": "Wizhi", "link": "https://stackoverflow.com/users/4552529/wizhi"}, "reply_to_user": {"reputation": 5188, "user_id": 239991, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b5db9624095605a6fc05ff584cf8c14c?s=128&d=identicon&r=PG&f=1", "display_name": "venkat", "link": "https://stackoverflow.com/users/239991/venkat"}, "edited": false, "score": 1, "creation_date": 1539810613, "post_id": 52854695, "comment_id": 92641675, "body": "What is the logic in the updated question.... seems like some rows are randomly going to the &quot;description&quot; column while other is going to the &quot;comments&quot;..."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1539843321, "post_id": 52854695, "comment_id": 92649476, "body": "Why did you use 3 loops if you could do it in one? Looks a way complicated to me. Also you must not use <code>Integer</code> for row counting variables. Excel has more rows than <code>Integer</code> can handle. It is recommended <a href=\"https://stackoverflow.com/a/26409520/3219613\">always to use Long instead of Integer</a> in VBA since there is no benefit in <code>Integer</code> at all. \u2022 And yes the OP already lost the information about &quot;which text belongs to which headline&quot; during data extraction from website to Excel. Therefore you cannot solve this at all."}], "tags": [], "owner": {"reputation": 5038, "user_id": 4552529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7dff9245051269e55748c81670088e8?s=128&d=identicon&r=PG&f=1", "display_name": "Wizhi", "link": "https://stackoverflow.com/users/4552529/wizhi"}, "is_accepted": false, "score": 1, "last_activity_date": 1539786861, "last_edit_date": 1539786861, "creation_date": 1539778579, "answer_id": 52854695, "question_id": 52852190, "link": "https://stackoverflow.com/questions/52852190/how-to-customize-dynamic-tabular-data-from-web-into-excel/52854695#52854695", "title": "How to customize dynamic tabular data from web into excel", "body": "<p>The code assumes there are no blank cells in your data and I put the initial data in Column A.</p>\n\n<p>The First part of the code is to modify the code for your needs.</p>\n\n<p>You set the sheet name: <code>ActiveWorkbook.Worksheets(\"Sheet1\")</code></p>\n\n<p>You decide which row to start (including header): <code>startrow = 1</code></p>\n\n<p>And also what names that should be in the new columns you are moving to: <code>SheetName.Cells(1, 2) = \"Sl.No\"</code> etc..</p>\n\n<p><em>Notice that the code create a whole new table (copy and paste), the old column with data will be deleted at the end.</em></p>\n\n<p><strong>VBA Code</strong></p>\n\n<pre><code>Sub MoveCells()\n\nDim lrow As Integer\nDim lrowno As Integer\nDim lrowname As Integer\nDim lrowcity As Integer\n\nDim i As Integer\nDim j As Integer\nDim k As Integer\nDim startrow As Integer\nDim SheetName As Worksheet\n\n\n'################## Set variables ##################\nSet SheetName = ActiveWorkbook.Worksheets(\"Sheet1\") 'Name your worksheet\nstartrow = 1 'Set row number you want to sart the loop from\n\n'Name first header rows\nSheetName.Cells(1, 2) = \"Sl.No\" 'Column B = 2\nSheetName.Cells(1, 3) = \"Name\" 'Column C = 3\nSheetName.Cells(1, 4) = \"City\" 'Column D = 4\n\n\n'################## Execute Code ##################\nlrow = Cells(Rows.Count, 1).End(xlUp).Row 'Check the last row in Column A.\n\nFor i = startrow + 1 To lrow Step 3 'start from row 1 and add 1 row. Then loop to row lrow. After every loop it jump 3 rows.\nlrowno = Cells(Rows.Count, 2).End(xlUp).Row 'Find last row in column B\nSheetName.Cells(lrowno + 1, 2) = SheetName.Cells(i, 1) 'Copy Cells from Column A to Column B's last row\nNext i\n\nFor j = startrow + 2 To lrow Step 3 'start from row 1 and add 2 rows. Then loop to row lrow. After every loop it jump 3 rows.\nlrowname = Cells(Rows.Count, 3).End(xlUp).Row 'Find last row in Column C\nSheetName.Cells(lrowname + 1, 3) = SheetName.Cells(j, 1) 'Copy Cells from Column A to Column C's last row\nNext j\n\nFor k = startrow + 3 To lrow Step 3 'start from row 1 and add 3 rows. Then loop to row lrow. After every loop it jump 3 rows.\nlrowcity = Cells(Rows.Count, 4).End(xlUp).Row 'Find last row in Column D\nSheetName.Cells(lrowcity + 1, 4) = SheetName.Cells(k, 1) 'Copy Cells from Column A to Column D's last row\nNext k\n\n'Delete first column\nColumns(1).EntireColumn.Delete\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5188, "user_id": 239991, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b5db9624095605a6fc05ff584cf8c14c?s=128&d=identicon&r=PG&f=1", "display_name": "venkat", "link": "https://stackoverflow.com/users/239991/venkat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "answer_count": 3, "score": -3, "last_activity_date": 1591644494, "creation_date": 1539770547, "last_edit_date": 1591644494, "question_id": 52852190, "link": "https://stackoverflow.com/questions/52852190/how-to-customize-dynamic-tabular-data-from-web-into-excel", "title": "How to customize dynamic tabular data from web into excel", "body": "<p>How to customize dynamic data taken from web into excel</p>\n\n<p>Example Data taken from Web getting displayed as below when paste into excel/word:</p>\n\n<pre><code>1\nApplication has not up for the below reasons:\na. Low Processor Speed\nb. Power failure\nc. Under Maintenance \nAll Application issues resolved on 10/04\n2\nSystem has to process instructions defined\nSystem has processed these instructions:\nExecuting commands\nSending auto email\nLogging Response status in LogViewer\n3\nSend email\nEmail sent to the below group:\nBackEnd Team\nNetwork users\nGroup MGRS\n4\nStart the application\nApplication started successfully\n</code></pre>\n\n<p>The expected tabular format as:</p>\n\n<pre><code>Sl.No     Description                                        Comments\n1         Application has not up for the below reasons:      All Application issues resolved on 10/04\n          a. Low Processor Speed\n          b. Power failure\n          c. Under Maintenance     \n2         System has to process instructions defined         System has processed these instructions:\n                                                             Executing commands\n                                                             Sending auto email\n                                                             Logging Response status in LogViewer\n\n3         Send email                                         Email sent to the below group:\n                                                             BackEnd Team\n                                                             Network users\n                                                             Group MGRS\n4         Start the application                              Application started successfully\n</code></pre>\n\n<p>I tried with Text to columns or delimited etc  but not getting as expected output.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 83, "user_id": 2868825, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b71e4bbd3848af47dbcfab528b67bc1?s=128&d=identicon&r=PG&f=1", "display_name": "Jhun", "link": "https://stackoverflow.com/users/2868825/jhun"}, "edited": false, "score": 0, "creation_date": 1539770987, "post_id": 52852141, "comment_id": 92619979, "body": "Thanks for the suggestion but the preference is that it would go on a row. But I have tried the full stop anyway but it does not work."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1539770990, "post_id": 52852141, "comment_id": 92619981, "body": "So you&#39;re transposing as well, or at least splitting down the sheet not across?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1539771016, "post_id": 52852141, "comment_id": 92620000, "body": "What do you mean it &quot;does not work&quot;?"}, {"owner": {"reputation": 83, "user_id": 2868825, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b71e4bbd3848af47dbcfab528b67bc1?s=128&d=identicon&r=PG&f=1", "display_name": "Jhun", "link": "https://stackoverflow.com/users/2868825/jhun"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1539771090, "post_id": 52852141, "comment_id": 92620042, "body": "Yes something like that. putting each number line into individual cell compartment."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1539771203, "post_id": 52852141, "comment_id": 92620112, "body": "I doubt you&#39;ll get anyone to write the code for you when (1) you&#39;ve not shown us any code yourself (2) we&#39;ve got no idea what your data looks like and (3) we&#39;ve got no idea what the output should be. I would suggest you investigate <code>Split</code>."}, {"owner": {"reputation": 83, "user_id": 2868825, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b71e4bbd3848af47dbcfab528b67bc1?s=128&d=identicon&r=PG&f=1", "display_name": "Jhun", "link": "https://stackoverflow.com/users/2868825/jhun"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1539771443, "post_id": 52852141, "comment_id": 92620269, "body": "Thank you for your kind comment. I have not written any code for this. My concern  only is if there is a way to do attain the goal. Yeah i will still look around. There might be ways to do it aside from writing a code. Thanks SJR."}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1539774590, "post_id": 52852141, "comment_id": 92622055, "body": "Solution coming in an hour or so."}, {"owner": {"reputation": 83, "user_id": 2868825, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b71e4bbd3848af47dbcfab528b67bc1?s=128&d=identicon&r=PG&f=1", "display_name": "Jhun", "link": "https://stackoverflow.com/users/2868825/jhun"}, "edited": false, "score": 0, "creation_date": 1539774825, "post_id": 52852141, "comment_id": 92622210, "body": "Thank you VBasic2008, that is very helpful, I will wait for your solution. I&#39;m currently trying to play with Power Query as suggested below. Thanks in advance."}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 2868825, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b71e4bbd3848af47dbcfab528b67bc1?s=128&d=identicon&r=PG&f=1", "display_name": "Jhun", "link": "https://stackoverflow.com/users/2868825/jhun"}, "edited": false, "score": 0, "creation_date": 1539772437, "post_id": 52852586, "comment_id": 92620812, "body": "Thank you. Are you referring to 2003 version of Excel?"}, {"owner": {"reputation": 1112, "user_id": 7354796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7efd450f69bda421b8348f3f694ae621?s=128&d=identicon&r=PG&f=1", "display_name": "OwlsSleeping", "link": "https://stackoverflow.com/users/7354796/owlssleeping"}, "reply_to_user": {"reputation": 83, "user_id": 2868825, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b71e4bbd3848af47dbcfab528b67bc1?s=128&d=identicon&r=PG&f=1", "display_name": "Jhun", "link": "https://stackoverflow.com/users/2868825/jhun"}, "edited": false, "score": 0, "creation_date": 1539772664, "post_id": 52852586, "comment_id": 92620929, "body": "You can get Power Query as an add-in for 2010+, it&#39;s included by default as Get &amp; Transform in 2017+"}, {"owner": {"reputation": 83, "user_id": 2868825, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b71e4bbd3848af47dbcfab528b67bc1?s=128&d=identicon&r=PG&f=1", "display_name": "Jhun", "link": "https://stackoverflow.com/users/2868825/jhun"}, "edited": false, "score": 0, "creation_date": 1539772831, "post_id": 52852586, "comment_id": 92621022, "body": "Thanks ill try that out."}, {"owner": {"reputation": 83, "user_id": 2868825, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b71e4bbd3848af47dbcfab528b67bc1?s=128&d=identicon&r=PG&f=1", "display_name": "Jhun", "link": "https://stackoverflow.com/users/2868825/jhun"}, "edited": false, "score": 0, "creation_date": 1539778200, "post_id": 52852586, "comment_id": 92624205, "body": "The problem with the data is there is no definite delimiter to use."}, {"owner": {"reputation": 1112, "user_id": 7354796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7efd450f69bda421b8348f3f694ae621?s=128&d=identicon&r=PG&f=1", "display_name": "OwlsSleeping", "link": "https://stackoverflow.com/users/7354796/owlssleeping"}, "reply_to_user": {"reputation": 83, "user_id": 2868825, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b71e4bbd3848af47dbcfab528b67bc1?s=128&d=identicon&r=PG&f=1", "display_name": "Jhun", "link": "https://stackoverflow.com/users/2868825/jhun"}, "edited": false, "score": 0, "creation_date": 1539781910, "post_id": 52852586, "comment_id": 92626542, "body": "Did you try cr and/or lf? Worked perfectly on your example data"}, {"owner": {"reputation": 83, "user_id": 2868825, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b71e4bbd3848af47dbcfab528b67bc1?s=128&d=identicon&r=PG&f=1", "display_name": "Jhun", "link": "https://stackoverflow.com/users/2868825/jhun"}, "edited": false, "score": 0, "creation_date": 1540202499, "post_id": 52852586, "comment_id": 92762850, "body": "Thanks for your suggestion. But i haven&#39;t tried that yet. But I did tried using the Power Query."}, {"owner": {"reputation": 1112, "user_id": 7354796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7efd450f69bda421b8348f3f694ae621?s=128&d=identicon&r=PG&f=1", "display_name": "OwlsSleeping", "link": "https://stackoverflow.com/users/7354796/owlssleeping"}, "reply_to_user": {"reputation": 83, "user_id": 2868825, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b71e4bbd3848af47dbcfab528b67bc1?s=128&d=identicon&r=PG&f=1", "display_name": "Jhun", "link": "https://stackoverflow.com/users/2868825/jhun"}, "edited": false, "score": 0, "creation_date": 1540203042, "post_id": 52852586, "comment_id": 92763156, "body": "@Jhun I&#39;m glad the vba solution worked for you.   What was your delimiter in the end? vBasic2008 went for the generic case of all non-printing characters since the original attempt with lf surprisingly didn&#39;t work on your data (or could just be range issues).  That way I can add your edge case for any future readers who might prefer Get &amp; Transform to VBA."}, {"owner": {"reputation": 83, "user_id": 2868825, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b71e4bbd3848af47dbcfab528b67bc1?s=128&d=identicon&r=PG&f=1", "display_name": "Jhun", "link": "https://stackoverflow.com/users/2868825/jhun"}, "edited": false, "score": 0, "creation_date": 1540293502, "post_id": 52852586, "comment_id": 92803435, "body": "Hi. Basically what I did at the end is to remove all numbers at the beginning of each line and changed to comma. Then revised the code to consider comma as the delimiter. By the way the powerquery works as well if you changed the delimiter to comma in this case. Thank you for your advices, it\u2019s a great help."}, {"owner": {"reputation": 1112, "user_id": 7354796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7efd450f69bda421b8348f3f694ae621?s=128&d=identicon&r=PG&f=1", "display_name": "OwlsSleeping", "link": "https://stackoverflow.com/users/7354796/owlssleeping"}, "reply_to_user": {"reputation": 83, "user_id": 2868825, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b71e4bbd3848af47dbcfab528b67bc1?s=128&d=identicon&r=PG&f=1", "display_name": "Jhun", "link": "https://stackoverflow.com/users/2868825/jhun"}, "edited": false, "score": 0, "creation_date": 1540298317, "post_id": 52852586, "comment_id": 92806418, "body": "It&#39;s good that works. Please be aware that comma delimited lines will cause you issues if anyone enters a legitimate comma in the text field.  That&#39;s why @VBasic2008 and myself both suggested splitting on the non-printing line break characters.  Nice idea, but wouldn&#39;t recommend it to anyone trying this in the future."}], "tags": [], "owner": {"reputation": 1112, "user_id": 7354796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7efd450f69bda421b8348f3f694ae621?s=128&d=identicon&r=PG&f=1", "display_name": "OwlsSleeping", "link": "https://stackoverflow.com/users/7354796/owlssleeping"}, "is_accepted": false, "score": 0, "last_activity_date": 1539771736, "creation_date": 1539771736, "answer_id": 52852586, "question_id": 52852141, "link": "https://stackoverflow.com/questions/52852141/excel-formula-or-sql-script-that-would-put-bulk-text-into-individual-cell/52852586#52852586", "title": "Excel formula or SQL script that would put bulk text into individual cell", "body": "<p>This is possible in Get&amp;Transform if you're on a recent version of Excel.</p>\n\n<p>Get Data from range</p>\n\n<p>Right Click the Column>Split Column>By Delimiter</p>\n\n<p>In advanced options you can split by row and get the \"new line\" character i.e. cr/lf</p>\n"}, {"comments": [{"owner": {"reputation": 83, "user_id": 2868825, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b71e4bbd3848af47dbcfab528b67bc1?s=128&d=identicon&r=PG&f=1", "display_name": "Jhun", "link": "https://stackoverflow.com/users/2868825/jhun"}, "edited": false, "score": 0, "creation_date": 1539857022, "post_id": 52856389, "comment_id": 92656679, "body": "Thank you very much for your time, quick reply and intellectual scripting. The Script runs with no error but it only keeps producing sheet every time it is excuted. Is there any more thing I need to do? Thank you again."}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "reply_to_user": {"reputation": 83, "user_id": 2868825, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b71e4bbd3848af47dbcfab528b67bc1?s=128&d=identicon&r=PG&f=1", "display_name": "Jhun", "link": "https://stackoverflow.com/users/2868825/jhun"}, "edited": false, "score": 0, "creation_date": 1539903334, "post_id": 52856389, "comment_id": 92680715, "body": "Copy the code into the worksheet to be processed and adjust the constants in the customize section (first five statements). From your picture the first data was in row &#39;2&#39; and the column used was column &#39;T&#39;. Maybe it is different now so change the number or letter."}], "tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 0, "last_activity_date": 1539786947, "last_edit_date": 1539786947, "creation_date": 1539783774, "answer_id": 52856389, "question_id": 52852141, "link": "https://stackoverflow.com/questions/52852141/excel-formula-or-sql-script-that-would-put-bulk-text-into-individual-cell/52856389#52856389", "title": "Excel formula or SQL script that would put bulk text into individual cell", "body": "<h1>Comorbidity</h1>\n\n<h2>Intro</h2>\n\n<p>Wikipedia: In medicine, comorbidity is the presence of one or more additional diseases or disorders co-occurring with (that is, concomitant or concurrent with) a primary disease or disorder; in the countable sense of the term, a comorbidity (plural comorbidities) is each additional disorder or disease.</p>\n\n<h2>The Code</h2>\n\n<p>Beware: There is no error handling, so if something goes wrong just don't save anything. Close without saving and try again.<br>\nThe code was tested and works fine with Excel 2003 and should work fine with all newer versions, too.<br>\nThe code blocks starting with     <code>'  str1 =</code> are just for debugging, a kind of 'subtotals' and can be deleted if you wish. </p>\n\n<pre><code>Sub Comorbidities()\n  'Description\n    'Writes the contents of cell values with several rows (per cell) to a new\n    'worksheet each row in a seperate row. For this to work the worksheet with\n    'the 'several row cells values' has to be active (selected).\n\n'-- CUSTOMIZE BEGIN --------------------\n  Const cStrHeader As String = \"Comorbidities\" 'Header\n  Const cLoRow As Long = 2 'Starting row of initial data\n  Const cStrColumn As String = \"T\" 'Column of initial data\n\n  Const cLoRowResult As Long = 2 'Starting row of resulting data\n  Const cStrColumnResult As String = \"A\" 'Column of resulting data\n'-- CUSTOMIZE END ----------------------\n\n  Dim oRng As Range 'Initial Range\n  Dim oRngResult As Range 'Resulting Range\n\n  Dim arrRng As Variant 'Array containing the initial data pasted from the range\n  Dim arrSplit As Variant 'Array containing the rows inside a cell\n  Dim arrData() As Variant 'Array containing the resulting data\n\n  Dim loData As Long 'Count of all rows\n  Dim loRng As Long 'Counter\n  Dim loArr As Long 'Counter\n  Dim iSplit As Integer 'Counter\n\n  Dim str1 As String 'Debug String\n  Dim lo1 As Long 'Debug Counter\n\n  'Determine the range to be processed\n  Set oRng = Range(Cells(cLoRow, cStrColumn), _\n      Cells(Cells(Rows.Count, cStrColumn).End(xlUp).Row, cStrColumn))\n  'Paste range into array\n  arrRng = oRng\n  Set oRng = Nothing 'Release the variable, initial data is in arrRng.\n\n'Now arrays are taking over\n\n'  str1 = \"arrRng\"\n'  For lo1 = LBound(arrRng) To UBound(arrRng)\n'      str1 = str1 &amp; vbCrLf &amp; lo1 &amp; \". \" &amp; arrRng(lo1, 1)\n'  Next\n'  Debug.Print str1\n\n  'Counting data - split each cells value and add to sum (loData)\n\n  'Reading data from arrRng.\n  For loRng = LBound(arrRng) To UBound(arrRng)\n    'Splitting arrSplit by Chr(10)\n    arrSplit = Split(arrRng(loRng, 1), Chr(10))\n    loData = loData + UBound(arrSplit) + 1  '+ 1 i.e. arrSplit is 0-based.\n  Next\n\n  'Redeclare arrData using the result of the counting (loData).\n  ReDim Preserve arrData(1 To loData, 1 To 1)\n\n  'Reading data from arrRng.\n  For loRng = LBound(arrRng) To UBound(arrRng)\n    'Splitting arrSplit by Chr(10).\n    arrSplit = Split(arrRng(loRng, 1), Chr(10))\n\n'  str1 = \"arrSplit\"\n'  For lo1 = LBound(arrSplit) To UBound(arrSplit)\n'      str1 = str1 &amp; vbCrLf &amp; lo1 + 1 &amp; \". \" &amp; arrSplit(lo1)\n'  Next\n'  Debug.Print str1\n\n    'Writing arrSplit data to arrData.\n    For iSplit = LBound(arrSplit) To UBound(arrSplit)\n      loArr = loArr + 1\n      arrData(loArr, 1) = arrSplit(iSplit)\n    Next\n\n    Erase arrSplit 'Is repeatedly newly created to write data to arrData.\n\n'  str1 = \"arrData\"\n'  For lo1 = LBound(arrData) To UBound(arrData)\n'      str1 = str1 &amp; vbCrLf &amp; lo1 &amp; \". \" &amp; arrData(lo1, 1)\n'  Next\n'  Debug.Print str1\n\n  Next\n\n  Erase arrRng 'No longer needed, resulting data is in arrData.\n\n'  str1 = \"arrData\"\n'  For lo1 = LBound(arrData) To UBound(arrData)\n'      str1 = str1 &amp; vbCrLf &amp; arrData(lo1, 1)\n'  Next\n'  Debug.Print str1\n\n'Output to new worksheet\n\n  'Add a new worksheet positioned after the initial worksheet.\n  Worksheets.Add After:=ActiveSheet\n  'Determine the resulting range in the new worksheet.\n  Set oRngResult = Range(Cells(1, 1), Cells(loData, 1))\n  'Paste data into range\n  oRngResult = arrData\n\n  Erase arrData 'No longer needed, all data is in oRngResult.\n\n  Set oRngResult = Nothing 'Release the variable, all data is in the worksheet.\n\n  'Write Header\n  Cells(cLoRowResult - 1, cStrColumnResult).Value = cStrHeader\n\nEnd Sub\n</code></pre>\n\n<h2>Some additional info</h2>\n\n<p><strong>How to put more lines into one cell</strong></p>\n\n<p>You have to hold the left ALT key and press enter after each line. </p>\n\n<p><strong>How I got the delimiter</strong></p>\n\n<p>When you go into a cell (click in the formula bar) e.g. cell 'A1' with more lines (bulk data), you select the end of a line expanding over the 'invisible' kind of 'space looking' character right after the 'visible' part and copy it. Then paste it into another cell e.g. A2. Now in e.g. cell A3 write the formula <code>=CODE(A2)</code>and the result will be 10. So in VBA this means you choose this character by using the Chr Function: <code>Chr(10)</code> (in Excel this is <code>=CHAR(10)</code>.\nBTW the character is called Line Feed (LF) or New Line (NL). For other character codes look <a href=\"http://www.asciitable.com/\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 83, "user_id": 2868825, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b71e4bbd3848af47dbcfab528b67bc1?s=128&d=identicon&r=PG&f=1", "display_name": "Jhun", "link": "https://stackoverflow.com/users/2868825/jhun"}, "edited": false, "score": 0, "creation_date": 1540194767, "post_id": 52893242, "comment_id": 92758477, "body": "Thank you so much. You are a savior. Works like a charm."}], "tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": true, "score": 1, "last_activity_date": 1539955943, "last_edit_date": 1539955943, "creation_date": 1539955352, "answer_id": 52893242, "question_id": 52852141, "link": "https://stackoverflow.com/questions/52852141/excel-formula-or-sql-script-that-would-put-bulk-text-into-individual-cell/52893242#52893242", "title": "Excel formula or SQL script that would put bulk text into individual cell", "body": "<h1>Comorbidity 2.0</h1>\n\n<h2>Intro</h2>\n\n<p>Wikipedia: In medicine, comorbidity is the presence of one or more additional diseases or disorders co-occurring with (that is, concomitant or concurrent with) a primary disease or disorder; in the countable sense of the term, a comorbidity (plural comorbidities) is each additional disorder or disease.</p>\n\n<p>Since you couldn't get the first script to work I could only conclude that you might have a different <strong>line delimiter</strong> than the Line Feed at the end of each line in the <strong>multi-line cells</strong>. So I wrote an improved version of the whole thing and added a function to determine the delimiter for each cell. Now you only have to select a <strong>column</strong> e.g. A, B, or <strong>T</strong> (in your sample picture) etc. in the <strong>customize</strong> section of the code:</p>\n\n<pre><code>'-- CUSTOMIZE BEGIN --------------------\n  Const cStrColumn As String = \"T\" '&lt;-- ***COLUMN IN HERE***\n\n  Const cStrColumnResult As String = \"A\" 'Resulting Data Column\n  Const cLoRow As Long = 0 '0 to use the first row of the initial data range.\n'-- CUSTOMIZE END ----------------------\n</code></pre>\n\n<p>... and the code does the rest itself.</p>\n\n<h2>The Code</h2>\n\n<pre><code>Option Explicit\n\n'-------------------------------------------------------------------------------\nSub MultilineCellExtractor()\n'-------------------------------------------------------------------------------\n'Description\n  'Copies the contents of each cell of a specified COLUMN in a worksheet,\n  'skipping blank cells and converting multiple lines in cells each to a new\n  'cell, and returns the result in a COLUMN of a newly created worksheet.\n'Arguments as constants\n  'cStrColumn\n    'The Column of the Initial Data in ThisWorkbook's ActiveSheet\n  'cStrColumnResult\n    'The Column of the Resulting Data in a Newly to be Created Worksheet\n  'cLoRow\n    'The First Row of the Resulting Data in the Newly Created Worksheet\n'Returns\n  'A new worksheet with a column of the processed data.\n'Usage\n  'Open the workbook to be processed. Go to VBE and insert a new module. Copy\n  'this script ('MultilineCellExtractor') and the function 'FirstNonPrintable'\n  'and paste them into the module. Edit the 'customize section' to fit your\n  'needs. Exit VBE and start the Run Macro Dialog (Play Button). DoubleClick or\n  'select 'MultilineCellExtractor' and click Run to execute.\n'Remarks\n  'If there is no data in the column to be processed a message pops up (the only\n  'error handling done so far). If there are no multiline cells, the data is\n  'just copied while skipping the blanks.\n  'There can be no damage done using this script in the previously described way\n  'because the worksheet is only to be READ from, and the result is always\n  'pasted into a NEW worksheet.\n\n'-------------------------------------------------------------------------------\n'-- CUSTOMIZE BEGIN --------------------\n  Const cStrColumn As String = \"T\" 'Initial Data Column\n\n  Const cStrColumnResult As String = \"A\" 'Resulting Data Column\n  Const cLoRow As Long = 0 '0 to use the first row of the initial data range.\n'-- CUSTOMIZE END ----------------------\n\n'-------------------------------------------------------------------------------\n  Dim oRng As Range 'Initial Colum, Initial Range, Resulting Range\n\n  Dim arrRng As Variant 'Array Containing the Initial Data Range (Column)\n  Dim arrSplit As Variant 'Array Containing the Cell Lines\n  Dim arrData() As Variant 'Array Containing the Resulting Data Range (Column)\n\n  Dim loRow1 As Long 'First Row of the Initial Data Range (Column)\n  Dim loRow2 As Long 'Last Row of the Initial Data Range (Column)\n  Dim loRowResult As Long 'First Row of the Resulting Data Range (Column)\n\n  Dim loRng As Long 'Initial Array Rows Counter\n  Dim iSplit As Integer 'Multiline Cell Lines Counter\n  Dim loData As Long 'Resulting Array(Range) Rows Calculator and Counter\n\n  Dim strRng As String 'Initial Data Reader: Shortcut for arrRng(loRng, 1).\n\n  Dim str1 As String 'Debug String Writer\n  Dim lo1 As Long 'Debug String Array Data Counter\n\n'-------------------------------------------------------------------------------\n  'Column of Initial Data\n    'Needed to calculate first and last rows of data.\n  Set oRng = ThisWorkbook.ActiveSheet.Range(cStrColumn &amp; \":\" &amp; cStrColumn)\n  'First Row Containing Data\n  On Error Resume Next\n    loRow1 = oRng.Find(What:=\"*\", After:=Cells(Rows.Count, cStrColumn), _\n        LookIn:=xlValues, LookAt:=xlPart, _\n        SearchOrder:=xlByRows, SearchDirection:=xlNext).Row\n    If Err Then\n      MsgBox \"You have probably selected a column with no data.\"\n      GoTo ProcedureExit\n    End If\n  'Last Row Containing Data\n  loRow2 = oRng.Find(What:=\"*\", After:=Cells(1, cStrColumn), _\n    LookIn:=xlValues, LookAt:=xlPart, _\n    SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n  'Calculate Initial Range\n  Set oRng = ThisWorkbook.ActiveSheet.Range(Cells(loRow1, cStrColumn), _\n      Cells(loRow2, cStrColumn))\n\n'  str1 = \"Calculate Initial Range (Results):\"\n'  str1 = str1 &amp; vbCrLf &amp; Space(2) &amp; \"loRow1 = \" &amp; loRow1\n'  str1 = str1 &amp; vbCrLf &amp; Space(2) &amp; \"loRow2 = \" &amp; loRow2\n'  str1 = str1 &amp; vbCrLf &amp; Space(2) &amp; \"oRng.Address: \" &amp; oRng.Address\n'  Debug.Print str1 &amp; vbCrLf\n\n  'Paste range into array\n  arrRng = oRng\n  Set oRng = Nothing 'Release the variable, initial data is in arrRng.\n\n'  str1 = \"arrRng Contents:\"\n'  For lo1 = LBound(arrRng) To UBound(arrRng)\n'      str1 = str1 &amp; vbCrLf &amp; Space(2) &amp; lo1 &amp; \". \" &amp; arrRng(lo1, 1)\n'  Next\n'  Debug.Print str1 &amp; vbCrLf\n\n'-------------------------------------------------------------------------------\n'Now arrays are taking over\n\n  'Count data in arrRng to calculate size of arrData.\n  For loRng = LBound(arrRng) To UBound(arrRng)\n    strRng = arrRng(loRng, 1)\n    If strRng &lt;&gt; \"\" Then 'Not empty cell, continue.\n      If FirstNonPrintable(strRng) &gt; 0 Then 'Non printable character found.\n        'Splitting arrSplit by 'FirstNonPrintable'\n        arrSplit = Split(strRng, Chr(FirstNonPrintable(strRng)))\n        loData = loData + UBound(arrSplit) + 1  '+ 1 i.e. arrSplit is 0-based.\n       Else 'Nonprintable character not found.\n        loData = loData + 1\n      End If\n'     Else 'Empty cell, do nothing.\n    End If\n  Next\n\n  'Redeclare arrData using the result of the counting (loData).\n  ReDim Preserve arrData(1 To loData, 1 To 1)\n\n  'Reset counter for counting.\n  loData = 0\n  'Read data from arrRng and write to array.\n  For loRng = LBound(arrRng) To UBound(arrRng)\n    strRng = arrRng(loRng, 1)\n    If strRng &lt;&gt; \"\" Then 'Not empty cell, continue.\n      If FirstNonPrintable(strRng) &gt; 0 Then 'Non printable character found.\n        'Splitting arrSplit by 'FirstNonPrintable'\n        arrSplit = Split(strRng, Chr(FirstNonPrintable(strRng)))\n'\n'  str1 = \"arrSplit Contents:\"\n'  For lo1 = LBound(arrSplit) To UBound(arrSplit)\n'      str1 = str1 &amp; vbCrLf &amp; Space(2) &amp; lo1 + 1 &amp; \". \" &amp; arrSplit(lo1)\n'  Next\n'  Debug.Print str1 &amp; vbCrLf\n'\n        'Writing arrSplit data to arrData.\n        For iSplit = LBound(arrSplit) To UBound(arrSplit)\n          loData = loData + 1\n          arrData(loData, 1) = arrSplit(iSplit)\n        Next\n\n        Erase arrSplit 'Is repeatedly newly created to write data to arrData.\n\n       Else 'Nonprintable character not found.\n        loData = loData + 1\n        arrData(loData, 1) = strRng\n      End If\n'     Else 'Empty cell, do nothing.\n    End If\n  Next\n\n  Erase arrRng 'No longer needed, resulting data is in arrData.\n'\n'  str1 = \"arrData Contents:\"\n'  For lo1 = LBound(arrData) To UBound(arrData)\n'      str1 = str1 &amp; vbCrLf &amp; Space(2) &amp; lo1 &amp; \". \" &amp; arrData(lo1, 1)\n'  Next\n'  Debug.Print str1\n'\n'-------------------------------------------------------------------------------\n'Return data in new worksheet\n\n  'Calculate the first row of data in the resulting worksheet.\n  If cLoRow &gt; 0 Then\n    loRowResult = cLoRow 'Row as the constant in the 'customize section'.\n   Else\n    loRowResult = loRow1 'Same row as in the initial worksheet.\n  End If\n  'Add a new (resulting) worksheet positioned after the initial worksheet.\n  ThisWorkbook.Worksheets.Add _\n      After:=ActiveSheet 'The resulting worksheet is active now.\n  'Calculate the resulting range in the new worksheet.\n  Set oRng = ActiveSheet.Range(Cells(loRowResult, cStrColumnResult), _\n      Cells(loRowResult + loData - 1, cStrColumnResult))\n  'Paste data into the resulting range.\n  oRng = arrData\n  Erase arrData 'No longer needed, all data is in oRng.\n\n'-------------------------------------------------------------------------------\nProcedureExit:\n  Set oRng = Nothing 'Release the variable, all data is in the worksheet.\n\nEnd Sub\n'-------------------------------------------------------------------------------\n\n'-------------------------------------------------------------------------------\nFunction FirstNonPrintable(StringToClean As String, _\n    Optional Code0Position1String2 As Integer = 0) As Variant\n'-------------------------------------------------------------------------------\n'Description\n  'Finds the first character in a string that is different from the character\n  'at the same position in the cleaned version of the same string and returns\n  'its code, position or string.\n'Arguments\n  'StringToClean (String)\n    'The string to clean.\n  'Code0Position1String2 (Integer)\n    'Returns for\n      '0, the character code (Asc) of the found character to be used with\n        'the Chr function.\n      '1, the position of the found character.\n      '2, the found character.\n\n  Dim strCleaned As String\n  Dim loLen As Long\n\n  strCleaned = WorksheetFunction.Clean(StringToClean)\n\n  If StringToClean = strCleaned Then Exit Function\n\n  For loLen = 1 To Len(StringToClean)\n    If Mid(StringToClean, loLen, 1) &lt;&gt; Mid(strCleaned, loLen, 1) Then\n      Select Case Code0Position1String2\n        Case 0\n          FirstNonPrintable = Asc(Mid(StringToClean, loLen, 1))\n        Case 1\n          FirstNonPrintable = loLen\n        Case 2\n          FirstNonPrintable = Mid(StringToClean, loLen, 1)\n      End Select\n      Exit Function\n    End If\n  Next\n\nEnd Function\n'-------------------------------------------------------------------------------\n</code></pre>\n\n<h2>Some additional info</h2>\n\n<p>To put more lines into a cell you have to hold the left ALT key and press enter after each line. </p>\n\n<p>For character codes look <a href=\"http://www.asciitable.com/\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 83, "user_id": 2868825, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b71e4bbd3848af47dbcfab528b67bc1?s=128&d=identicon&r=PG&f=1", "display_name": "Jhun", "link": "https://stackoverflow.com/users/2868825/jhun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 0, "accepted_answer_id": 52893242, "answer_count": 3, "score": -1, "last_activity_date": 1593677256, "creation_date": 1539770420, "last_edit_date": 1593677256, "question_id": 52852141, "link": "https://stackoverflow.com/questions/52852141/excel-formula-or-sql-script-that-would-put-bulk-text-into-individual-cell", "title": "Excel formula or SQL script that would put bulk text into individual cell", "body": "<p>I have a SQL database of illnesses (Records of 9,000) but the illnesses are copy-pasted into a single field and arranged in numbers. From here we always extract to Excel to manipulate the data. My problem now is to put these illnesses into separate cell compartment in excel so that we can filter it properly. \nI have only tried the Text-to-Column in Excel but it does not do the job.</p>\n\n<p><strong>Example:</strong><a href=\"https://i.stack.imgur.com/lCUFD.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lCUFD.jpg\" alt=\"This is how the sheet looks like\"></a></p>\n\n<p><strong>And this is what I'm trying to achieve:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/sQOE3.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sQOE3.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I hope it makes sense. \nThank you.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1539771823, "post_id": 52851990, "comment_id": 92620464, "body": "Not really an answer but why isn&#39;t your original formula just <code>&quot;=DEUX+D2&quot;</code>?"}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "edited": false, "score": 0, "creation_date": 1539772096, "post_id": 52851990, "comment_id": 92620638, "body": "if you have the same ranges &amp; range names in all workbooks just use &quot;=DEUX+Sheet1!D2&quot; as formula an avoid copy paste."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1539772253, "post_id": 52851990, "comment_id": 92620722, "body": "Find and Replace if the paths are the same."}, {"owner": {"reputation": 2053, "user_id": 1581875, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4c4820fbcdf16fb5aa890353e3198582?s=128&d=identicon&r=PG&f=1", "display_name": "Olorin", "link": "https://stackoverflow.com/users/1581875/olorin"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1539774353, "post_id": 52851990, "comment_id": 92621899, "body": "@SJR See the remark I added at the end of the question."}, {"owner": {"reputation": 2053, "user_id": 1581875, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4c4820fbcdf16fb5aa890353e3198582?s=128&d=identicon&r=PG&f=1", "display_name": "Olorin", "link": "https://stackoverflow.com/users/1581875/olorin"}, "reply_to_user": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "edited": false, "score": 0, "creation_date": 1539774435, "post_id": 52851990, "comment_id": 92621949, "body": "@ALOXAZ Because in the real setup, the range I copy has millions of cells, and hundreds of thousands of cells containing formulas (as I wrote in the question, btw) so what you propose wouldn&#39;t be tractable."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1539778588, "post_id": 52851990, "comment_id": 92624454, "body": "If you are copying millions of cells you might want to re-think what your apporach."}, {"owner": {"reputation": 2053, "user_id": 1581875, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4c4820fbcdf16fb5aa890353e3198582?s=128&d=identicon&r=PG&f=1", "display_name": "Olorin", "link": "https://stackoverflow.com/users/1581875/olorin"}, "edited": false, "score": 0, "creation_date": 1539788476, "post_id": 52851990, "comment_id": 92630942, "body": "@SRJ That&#39;s the classic IT answer :) More seriously : except my problem of sheet reference, copying a range of millions of cells with values and hundred of thousands of formula cell doesn&#39;t take much time <b>at all</b>. This not a valid argument for me to &quot;rethink my approach&quot;."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1539792875, "post_id": 52851990, "comment_id": 92633357, "body": "I don&#39;t agree. I think it is a valid argument! Anyway, as I said before either use Find and Replace to remove the paths or write some code to scan all cells containing formulae for square brackets and remove everything before the &quot;]&quot;. There are probably examples online."}], "answers": [{"comments": [{"owner": {"reputation": 2053, "user_id": 1581875, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4c4820fbcdf16fb5aa890353e3198582?s=128&d=identicon&r=PG&f=1", "display_name": "Olorin", "link": "https://stackoverflow.com/users/1581875/olorin"}, "edited": false, "score": 0, "creation_date": 1539774464, "post_id": 52852999, "comment_id": 92621968, "body": "You can easily imagine that in my real setup this wouldn&#39;t help at all, see comments"}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1539772950, "creation_date": 1539772950, "answer_id": 52852999, "question_id": 52851990, "link": "https://stackoverflow.com/questions/52851990/issue-while-copying-a-range-from-a-workbook-to-another-reference-to-old-workbo/52852999#52852999", "title": "Issue while copying a range from a workbook to another : reference to old workbook appears in the formula", "body": "<p>You can try:</p>\n\n<pre><code>Sub test5()\n\nDim Total As Long\n\nTotal = Application.Sum(Range(\"DEUX\").Value, Sheet1.Range(\"D2\").Value)\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 13682670, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QNu5GQhwdKQ/AAAAAAAAAAI/AAAAAAAAABw/7n617rSEpMs/photo.jpg?sz=128", "display_name": "DiegoB", "link": "https://stackoverflow.com/users/13682670/diegob"}, "is_accepted": false, "score": 0, "last_activity_date": 1591889888, "last_edit_date": 1591889888, "creation_date": 1591887978, "answer_id": 62327452, "question_id": 52851990, "link": "https://stackoverflow.com/questions/52851990/issue-while-copying-a-range-from-a-workbook-to-another-reference-to-old-workbo/62327452#62327452", "title": "Issue while copying a range from a workbook to another : reference to old workbook appears in the formula", "body": "<p>You can try an easy, simple way <kbd>Ctrl</kbd> + <kbd>H</kbd> and replace all <code>path1[Source.xlsx]</code> with <code>\"\"</code> </p>\n"}], "owner": {"reputation": 2053, "user_id": 1581875, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4c4820fbcdf16fb5aa890353e3198582?s=128&d=identicon&r=PG&f=1", "display_name": "Olorin", "link": "https://stackoverflow.com/users/1581875/olorin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1591889888, "creation_date": 1539769962, "last_edit_date": 1591644505, "question_id": 52851990, "link": "https://stackoverflow.com/questions/52851990/issue-while-copying-a-range-from-a-workbook-to-another-reference-to-old-workbo", "title": "Issue while copying a range from a workbook to another : reference to old workbook appears in the formula", "body": "<p>I have a source workbook with only one sheet <code>Sheet1</code> with :</p>\n\n<ul>\n<li>Cell <code>C2</code> is named \"DEUX\" (name relative to sheet <code>Sheet1</code>) and contains the number 2</li>\n<li>Cell <code>D2</code> contains the number 3</li>\n<li>Cell <code>C3</code> is named \"RESULT\" (name relative to sheet <code>Sheet1</code>) and contains the formula \"=DEUX+Sheet1!D2\" (which gives 5)</li>\n</ul>\n\n<p>This source workbook is in <code>path1</code>. I have a copy of the source woorkbook at <code>path2</code>, the target workbook. In it I added the following macro :</p>\n\n<pre><code>Public Sub CpyRange()\n\n    Dim pathToSource As String\n    pathToSource = \"path1\" 'the aforementionned path to source workbook\n    Dim wkbSource As Workbook\n    Set wkbSource = Workbooks.Open(pathToSource &amp; \"Source.xlsx\")\n    Dim wksSource As Worksheet\n    Set wksSource = wkbSource.Sheets(\"Sheet1\")\n    Dim rangeToCopy As Range\n    Application.DisplayAlerts = False\n    Set rangeToCopy = wksSource.Range(\"RangeToCopy\")\n    rangeToCopy.Copy\n    ThisWorkbook.Sheets(\"Sheet1\").Range(\"RangeToCopy\").PasteSpecial xlPasteFormulas\n    Application.DisplayAlerts = True\n    wkbSource.Close\n\nEnd Sub\n</code></pre>\n\n<p>(Without the <code>Application.DisplayAlerts = False</code> bit, when the macro was run, I was having pop-ups \"A formula or sheet you want to move or copy contains the name DEUX\" etc. Now I don't have them which is what I want.)</p>\n\n<p>But I have a problem after running the macro : in cell <code>C3</code> of sheet <code>Sheet1</code> of the target workbook I have the formula : \"=DEUX+'path1[Source.xlsx]Sheet1'!D2\" where <code>path1</code> is the windows path to the source wokbook.</p>\n\n<p>I would like to have the same formula as in the source workbook, that is : \"=DEUX+Sheet1!D2\".</p>\n\n<p><em>This is an example isolating the problem that I have in a real setup where the range <code>RangeToCopy</code> is huge, millions of cells with several hundred of thousands of formulas in it.</em> So how would I achieve this simply ?</p>\n\n<p><strong>Remark.</strong> I have <code>Sheet1!D2</code> and not <code>D2</code> just to model that in the real setup the cell is in another sheet from the same workbook.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 446, "user_id": 6679822, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2577d77799d72f3958ca2c81ed69f41d?s=128&d=identicon&r=PG&f=1", "display_name": "juicy89", "link": "https://stackoverflow.com/users/6679822/juicy89"}, "edited": false, "score": 0, "creation_date": 1539770349, "post_id": 52852016, "comment_id": 92619609, "body": "This looks like exactly what I&#39;m after. Thanks so much. I&#39;m gonna give it a go now"}, {"owner": {"reputation": 446, "user_id": 6679822, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2577d77799d72f3958ca2c81ed69f41d?s=128&d=identicon&r=PG&f=1", "display_name": "juicy89", "link": "https://stackoverflow.com/users/6679822/juicy89"}, "edited": false, "score": 0, "creation_date": 1539771283, "post_id": 52852016, "comment_id": 92620159, "body": "This looks to be working perfect. However it appears I have some errors in some of my workbooks. I&#39;m getting an error 438. Object doesn&#39;t support this property or method. I&#39;ve done a little digging and it looks like some of the edit text boxes in some workbooks are missing. How would I go about checking if the value is undefined/ null in vba?"}, {"owner": {"reputation": 446, "user_id": 6679822, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2577d77799d72f3958ca2c81ed69f41d?s=128&d=identicon&r=PG&f=1", "display_name": "juicy89", "link": "https://stackoverflow.com/users/6679822/juicy89"}, "edited": false, "score": 0, "creation_date": 1539780359, "post_id": 52852016, "comment_id": 92625534, "body": "I ended up using On Error Resume Then and the script ran without a hitch. Thanks again!"}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "reply_to_user": {"reputation": 446, "user_id": 6679822, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2577d77799d72f3958ca2c81ed69f41d?s=128&d=identicon&r=PG&f=1", "display_name": "juicy89", "link": "https://stackoverflow.com/users/6679822/juicy89"}, "edited": false, "score": 0, "creation_date": 1539782883, "post_id": 52852016, "comment_id": 92627196, "body": "Yes, my code simply takes whatever the first shape is on the sheet, which has a risk if anything other than a textbox happens to be the &quot;top&quot; shape on the sheet. We could expand the code to check all shapes and only do the textboxes, but perhaps that is overkill in this situation"}], "tags": [], "owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "is_accepted": true, "score": 1, "last_activity_date": 1539770038, "creation_date": 1539770038, "answer_id": 52852016, "question_id": 52851776, "link": "https://stackoverflow.com/questions/52851776/get-data-from-an-edit-text-box/52852016#52852016", "title": "Get data from an Edit Text box", "body": "<p>Something like this perhaps:</p>\n\n<pre><code>Sub TransferCompanyNames()\n    Dim i As Integer\n    Dim SourceBook As Workbook\n    Dim TargetSheet As Worksheet\n    Set TargetSheet = Workbooks(\"ChangeToYourWorkbookName\").Worksheets(\"ChangeToYourSheetName\")\n    For i = 1 To 480\n        Set SourceBook = Workbooks.Open(Range(\"A\" &amp; i).Value)\n        TargetSheet.Range(\"B\" &amp; i).Value = ActiveSheet.Shapes(1).TextFrame.Characters(1, _\n                                           ActiveSheet.Shapes(1).TextFrame.Characters.Count).Text\n        SourceBook.Close False\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 446, "user_id": 6679822, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2577d77799d72f3958ca2c81ed69f41d?s=128&d=identicon&r=PG&f=1", "display_name": "juicy89", "link": "https://stackoverflow.com/users/6679822/juicy89"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 52852016, "answer_count": 1, "score": -1, "last_activity_date": 1609308471, "creation_date": 1539769298, "last_edit_date": 1609308471, "question_id": 52851776, "link": "https://stackoverflow.com/questions/52851776/get-data-from-an-edit-text-box", "title": "Get data from an Edit Text box", "body": "<p>I want to grab data from an Edit Text box from other workbooks and insert it into a single worksheet in a different workbook.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Sub TransferCompanyNames()\n    for(int i = 0; i &lt; 479; i++){\n        variable = Workbooks.Open Range(//Column A with index i);\n        //column a contains a link to the workbook C:/Users/.../Documents/file.xlsx\n        //grab data from Edit Text Box and insert into current sheet at column A with index i\n    }\nEnd Sub\n</code></pre>\n<p>I understand that this isn't the correct syntax.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1539769890, "post_id": 52851767, "comment_id": 92619334, "body": "If you have honestly been working on this for a week you have too much time on your hands."}, {"owner": {"reputation": 37, "user_id": 7719472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bd55508904ce4a6dbf83710acdb2d67?s=128&d=identicon&r=PG&f=1", "display_name": "Hsu.George", "link": "https://stackoverflow.com/users/7719472/hsu-george"}, "edited": false, "score": 0, "creation_date": 1539772713, "post_id": 52851767, "comment_id": 92620959, "body": "@Jeeped really really appreciate your code! But I have to study the code you gave me! It looks so fancy and difficult for me! By the way I never thought that I can solve the problem with vba.. and I think it\u2019s unbreakable to solve without vba! And I think it\u2019s too awesome for you, you probably just took 15 min to solve this!"}], "answers": [{"comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1539770451, "post_id": 52852120, "comment_id": 92619674, "body": "Nice. Is that first pattern a typo?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1539770543, "post_id": 52852120, "comment_id": 92619720, "body": "Yeah, my first attempt only caught integers. I tried the second without removing the first."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 2, "last_activity_date": 1539770456, "last_edit_date": 1539770456, "creation_date": 1539770324, "answer_id": 52852120, "question_id": 52851767, "link": "https://stackoverflow.com/questions/52851767/how-do-i-add-some-specific-numbers-in-a-cell/52852120#52852120", "title": "How do I add some specific numbers in a cell", "body": "<p>Try this simple regex based UDF.</p>\n\n<pre><code>Option Explicit\n\nFunction sumNums(str As String) As Double\n    Dim n As Long\n    Static rgx As Object, cmat As Object\n\n    If rgx Is Nothing Then\n        Set rgx = CreateObject(\"VBScript.RegExp\")\n    End If\n\n    With rgx\n        .Global = True\n        .MultiLine = True\n        .Pattern = \"(\\-?\\d*\\.?\\d+)\"\n        If .test(str) Then\n            Set cmat = .Execute(str)\n            For n = 0 To cmat.Count - 1\n                sumNums = sumNums + CDbl(cmat.Item(n))\n            Next n\n        End If\n    End With\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/Mf4p6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Mf4p6.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 206726, "user_id": 5459839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iehrR.jpg?s=128&g=1", "display_name": "trincot", "link": "https://stackoverflow.com/users/5459839/trincot"}, "is_accepted": false, "score": 1, "last_activity_date": 1539771553, "creation_date": 1539771553, "answer_id": 52852522, "question_id": 52851767, "link": "https://stackoverflow.com/questions/52851767/how-do-i-add-some-specific-numbers-in-a-cell/52852522#52852522", "title": "How do I add some specific numbers in a cell", "body": "<p>Here is a User Defined Function, just using String indexing:</p>\n\n<pre><code>Function SumNumbers(s As String) As Currency\n    Dim i As Long\n    Dim j As Long\n\n    For i = 1 To Len(s)\n        If InStr(\"-0123456789.\", Mid(s, i, 1)) Then\n            j = i\n            Do \n                i = i + 1\n            Loop While InStr(\"0123456789.\", Mid(s, i, 1))\n            SumNumbers = SumNumbers + CCur(Mid(s, j, i - j))\n        End If\n    Next\nEnd Function\n</code></pre>\n\n<p>Put it in the Visual Basic Editor (Shift+F11) in a new Module (right-click project, choose \"Insert...\" and \"Module\").</p>\n\n<p>Use the formula in your sheet, for example in cell B1:</p>\n\n<pre><code>=SumNumbers(A1)\n</code></pre>\n\n<p>NB: I prefer to use <code>Currency</code> and <code>CCur</code> to avoid floating point errors. It expects numbers to have at the most 4 decimals, and supports up to about 14 digits before the decimal separator.</p>\n"}, {"tags": [], "owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "is_accepted": false, "score": 1, "last_activity_date": 1539771567, "creation_date": 1539771567, "answer_id": 52852528, "question_id": 52851767, "link": "https://stackoverflow.com/questions/52851767/how-do-i-add-some-specific-numbers-in-a-cell/52852528#52852528", "title": "How do I add some specific numbers in a cell", "body": "<p>another solution is:</p>\n\n<pre><code>Function cal_cm(cl As Range) As Double\n    Dim i%, testVal$, result$\n    result = \"=\"\n    For i = 1 To Len(cl)\n        testVal = cl.Characters(i, 1).Text\n        If \"0123456789+.\" Like \"*\" &amp; testVal &amp; \"*\" Then\n            result = result &amp; testVal\n        End If\n    Next i\n    cal_cm = Evaluate(result)\nEnd Function\n</code></pre>\n\n<p>test</p>\n\n<p><a href=\"https://i.stack.imgur.com/wYWD7.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wYWD7.gif\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 206726, "user_id": 5459839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iehrR.jpg?s=128&g=1", "display_name": "trincot", "link": "https://stackoverflow.com/users/5459839/trincot"}, "is_accepted": false, "score": 0, "last_activity_date": 1539778252, "creation_date": 1539778252, "answer_id": 52854604, "question_id": 52851767, "link": "https://stackoverflow.com/questions/52851767/how-do-i-add-some-specific-numbers-in-a-cell/52854604#52854604", "title": "How do I add some specific numbers in a cell", "body": "<p>Here is a way to do it without VBA, but with some limitations: </p>\n\n<ul>\n<li>It expects every number to be followed by \"cm\"</li>\n<li>It expects every number to have a space in front of it (except for the first number which may be at the very start of the string)</li>\n<li>You need to know what the maximum count of numbers is in the input</li>\n</ul>\n\n<p>Assuming the input string is in cell A1, you could proceed as follows:</p>\n\n<ul>\n<li>Leave B1 blank</li>\n<li>In C1 put the formula <code>=IFERROR(MID($A1,1,FIND(\"cm\",$A1,LEN(B1)+2)-1), \"0\")</code></li>\n<li>Copy C1 to D1, E1, and F1</li>\n<li>In G1 put the formula <code>=VALUE(IFERROR(RIGHT(C1,LEN(C1)-FIND(\"@\",SUBSTITUTE(C1,\" \",\"@\",LEN(C1)-LEN(SUBSTITUTE(C1,\" \",\"\"))),1)),C1))</code></li>\n<li>Copy G1 to H1, I1, and J1</li>\n<li>In K1 put the formula <code>=SUM(G1:J1)</code></li>\n</ul>\n\n<p>You would get this result. The color coding identifies each of the groups that are copies:</p>\n\n<p><a href=\"https://i.stack.imgur.com/tAnML.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tAnML.png\" alt=\"enter image description here\"></a></p>\n\n<p>K1 will have the desired output.</p>\n\n<p>Note that F1 (and J1) contain 0. This would get the value of a fourth value in the input if it existed. </p>\n\n<p>You'll understand how to make room for more cells if your input could have 5 or more numerical values embedded in it.</p>\n"}], "owner": {"reputation": 37, "user_id": 7719472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bd55508904ce4a6dbf83710acdb2d67?s=128&d=identicon&r=PG&f=1", "display_name": "Hsu.George", "link": "https://stackoverflow.com/users/7719472/hsu-george"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 52852120, "answer_count": 4, "score": -1, "last_activity_date": 1593677309, "creation_date": 1539769261, "last_edit_date": 1593677309, "question_id": 52851767, "link": "https://stackoverflow.com/questions/52851767/how-do-i-add-some-specific-numbers-in-a-cell", "title": "How do I add some specific numbers in a cell", "body": "<p>lets say</p>\n<p>In a range A1</p>\n<p>8cm book + 13cm ruler + 0.34cm paper\nthen how i sum up  8 + 13 + 0.34 inside the cell then = 21.34cm</p>\n<p>then put the sumup in A2</p>\n<p>\u2014\u2014\u2014\u2014\u2014\u2014-updates question\u2014\u2014\u2014\u2014\u2014\u2014\u2014</p>\n<p>Sorry, I must make the question clearer!\n8cm book + 13cm ruler + ruler version#2 +0.34cm paper</p>\n<p>And I was wondering is it still working for the code from all master?</p>\n<p>this problem bothers me 1 week.\nhope can get the anwser!\nthanks!!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1539768023, "post_id": 52851279, "comment_id": 92618254, "body": "It is really unclear what the objective of your code is, and what it actually does."}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 1, "creation_date": 1539768042, "post_id": 52851279, "comment_id": 92618268, "body": "Getting an error message is not a good description of your problem. Please include what error, and where you get it."}, {"owner": {"reputation": 29, "user_id": 9684967, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Alok Nagar", "link": "https://stackoverflow.com/users/9684967/alok-nagar"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1539768322, "post_id": 52851279, "comment_id": 92618439, "body": "Thanks for your message, My code is trying to copy sales of each product (Column H of File6) and pasting it to Column T of a newly added sheet s1, s2 etc. I get error message when it searches for item 3 and which is not available."}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1539770707, "post_id": 52851279, "comment_id": 92619810, "body": "Not actually answering the question, but why do you have both <code>icnt1</code> and <code>store</code> if they are going to be <i>exactly the same value</i>?  Why do re-select the already-<code>ActiveSheet</code> after you rename it?  And, have a read on <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba?rq=1\">how to avoid using Select in Excel</a>...  (e.g. <code>ActiveSheet.Range(&quot;T3&quot;).PasteSpecial</code>)"}], "answers": [{"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 1, "last_activity_date": 1539768306, "creation_date": 1539768306, "answer_id": 52851462, "question_id": 52851279, "link": "https://stackoverflow.com/questions/52851279/missing-number-in-a-loop-of-vba-generates-error/52851462#52851462", "title": "Missing Number in a Loop of VBA generates error", "body": "<p>You need to check first whether the filter returns anything. Assign it to a range and check it's not Nothing before proceeding.</p>\n\n<p>Please also read up on (1) using Option Explicit and declaring your variables and (2) avoiding <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba?rq=1\">Select</a>.</p>\n\n<pre><code>Sub mycode()\n\nDim r As Range\n\nicnt1 = 0\nmax1 = Range(\"N1\").Value\n\nFor store = 1 To max1\n    icnt1 = icnt1 + 1\n    Windows(File6).Activate\n    With ActiveSheet\n        .AutoFilterMode = False\n        .Range(\"$A$1:$K$10000\").AutoFilter Field:=1, Criteria1:=icnt1\n        With .AutoFilter.Range\n            On Error Resume Next\n            Set r = .Offset(1, 7).Resize(.rows.count-1,1).SpecialCells(xlCellTypeVisible)\n            On Error GoTo 0\n            If Not r Is Nothing Then\n                Sheets(\"template\").Copy Before:=Sheets(\"template\")\n                ActiveSheet.Name = \"s\" &amp; icnt1\n                r.Copy\n                Sheets(\"s\" &amp; icnt1).Range(\"T3\").PasteSpecial Paste:=xlPasteValues\n            End If\n        End With\n    End With\nNext\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1539770997, "post_id": 52851497, "comment_id": 92619984, "body": "Hmm...  Would it be faster/more efficient to use <code>WorksheetFunction.CountIf</code> to check for <code>icnt1</code> in Column A before filtering?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1539771122, "post_id": 52851497, "comment_id": 92620056, "body": "For a specific single filter value, yes but this is more universal."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1539768389, "creation_date": 1539768389, "answer_id": 52851497, "question_id": 52851279, "link": "https://stackoverflow.com/questions/52851279/missing-number-in-a-loop-of-vba-generates-error/52851497#52851497", "title": "Missing Number in a Loop of VBA generates error", "body": "<p>You need to check if there are visible cells in the filter range before proceeding with the Copy/Add/Paste.</p>\n\n<pre><code>Sub mycode()\n\n    dim icnt1  as long, max1 as long, store as long\n    icnt1 = 0\n    max1 = Range(\"N1\").Value\n    For store = 1 To max1\n        icnt1 = icnt1 + 1\n\n        with Windows(File6)\n            if .autofiltermode then .autofiltermode = false\n            .Range(\"$A$1:$K$10000\").AutoFilter Field:=1, Criteria1:=icnt1\n            with .resize(.rows.count-1, 1).offset(1, 7)\n                if cbool(application.subtotal(103, .cell)) then\n                    .Copy\n\n                     Sheets(\"template\").Copy Before:=Sheets(\"template\")\n                     ActiveSheet.Name = \"s\" &amp; icnt1\n                     Sheets(\"s\" &amp; icnt1).Select\n\n                     Range(\"T3\").PasteSpecial Paste:=xlPasteValues\n                 end if\n             end with\n         end with\n\n    Next store\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 9684967, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Alok Nagar", "link": "https://stackoverflow.com/users/9684967/alok-nagar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1545769057, "creation_date": 1539767727, "last_edit_date": 1545769057, "question_id": 52851279, "link": "https://stackoverflow.com/questions/52851279/missing-number-in-a-loop-of-vba-generates-error", "title": "Missing Number in a Loop of VBA generates error", "body": "<p>I have the following code which searches for the different available products using the  sequence of numbers.</p>\n\n<p>If one product number is missing this code throws an error message.</p>\n\n<p>Example of my code:-</p>\n\n<pre><code>Sub mycode()\n\n    icnt1 = 0\n    max1 = Range(\"N1\").Value\n\n    For store = 1 To max1\n        icnt1 = icnt1 + 1\n\n        Windows(File6).Activate\n        ActiveSheet.Range(\"$A$1:$K$10000\").AutoFilter Field:=1, Criteria1:=icnt1\n\n        Range(\"H2\", Range(\"H\" &amp; Rows.Count).End(xlUp)).Select\n        Selection.Copy\n\n        Sheets(\"template\").Copy Before:=Sheets(\"template\")\n        ActiveSheet.Name = \"s\" &amp; icnt1\n\n        Sheets(\"s\" &amp; icnt1).Select\n        Range(\"T3\").Select\n        Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>If I have a product list in accurate sequence (1, 2, 3, 4, 5 etc.) then I am not facing any issue.</p>\n\n<p>If one or more products is missing (like 1, 2, 4, 5, 6 etc.) I am getting an error message. I tried to put an option of <code>On Error Resume Next</code> but that is also not working.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "edited": false, "score": 0, "creation_date": 1539766877, "post_id": 52850822, "comment_id": 92617550, "body": "You are talking about date, prices and you are counting cells. Can you explain better, maybe with a screenshot what you want?"}], "answers": [{"tags": [], "owner": {"reputation": 721, "user_id": 7889129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0oYIA.jpg?s=128&g=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7889129/maddy"}, "is_accepted": false, "score": 0, "last_activity_date": 1539767295, "last_edit_date": 1539767295, "creation_date": 1539766817, "answer_id": 52851003, "question_id": 52850822, "link": "https://stackoverflow.com/questions/52850822/count-number-of-cells-in-range-of-all-values/52851003#52851003", "title": "Count number of cells in range of all values", "body": "<p>If you just want to get count of cells between those two prices, You Can use <code>.Column</code> to get the first column and last column number and then simply count the cells in between. </p>\n\n<p>try like this\n     <code>days = Abs(price0.Column - price.Column)</code> </p>\n\n<p>To count cells between two rows <code>days = Abs(price0.Rows(1).row - price.Rows(1).row)</code></p>\n"}, {"tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1539767641, "creation_date": 1539767641, "answer_id": 52851250, "question_id": 52850822, "link": "https://stackoverflow.com/questions/52850822/count-number-of-cells-in-range-of-all-values/52851250#52851250", "title": "Count number of cells in range of all values", "body": "<p>I think you might need <code>Cells</code> instead of <code>Rows</code>:</p>\n\n<pre><code>days = Range(price0.Cells(1), price.Cells(1)).Cells.Count\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 10501071, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NntVEudbu90/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DXcDyshoQG1j5KCZy0YCqBWdQT3rg/mo/photo.jpg?sz=128", "display_name": "Daimon", "link": "https://stackoverflow.com/users/10501071/daimon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1539767764, "creation_date": 1539766206, "last_edit_date": 1539767764, "question_id": 52850822, "link": "https://stackoverflow.com/questions/52850822/count-number-of-cells-in-range-of-all-values", "title": "Count number of cells in range of all values", "body": "<p>I am trying to count the distance between two cells using:</p>\n\n<pre><code>days = Range(price0.Rows(1), price.Rows(1)).Cells.count\n</code></pre>\n\n<p>where <code>price0</code> and price are the initial price and range of prices of interest respectively.</p>\n\n<p>I want to be able to count the distance between two prices so that I can run a function only when <code>days &gt; x</code> (where <code>x</code> is an integer). Currently, using the above code, I am unable to count the distance between 2 cells when the value of <code>price</code> is 0.</p>\n\n<p>How should I change my code so that I can count the days between two ranges? Thanks!</p>\n"}, {"tags": ["excel", "vba", "export", "sap", "saprfc"], "answers": [{"comments": [{"owner": {"reputation": 379, "user_id": 2766148, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/ayl2X.png?s=128&g=1", "display_name": "Markus", "link": "https://stackoverflow.com/users/2766148/markus"}, "edited": false, "score": 0, "creation_date": 1539780989, "post_id": 52851948, "comment_id": 92625936, "body": "Thanks a lot, I took your code as an inspiration. Dumping the Cell of the tblData     tbldata.Cell(i, 1) and splitting at the @ sign (which is returned by the sap system)     tmp = Split(input_text, &quot;@&quot;) I think my getPieceOfTextzeile function, which was called on every cell was slowing everything down."}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "reply_to_user": {"reputation": 379, "user_id": 2766148, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/ayl2X.png?s=128&g=1", "display_name": "Markus", "link": "https://stackoverflow.com/users/2766148/markus"}, "edited": false, "score": 0, "creation_date": 1539784197, "post_id": 52851948, "comment_id": 92628065, "body": "Nice going. Glad I could help and thanks for the reward. Respect."}], "tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": true, "score": 1, "last_activity_date": 1543143685, "last_edit_date": 1543143685, "creation_date": 1539769816, "answer_id": 52851948, "question_id": 52850792, "link": "https://stackoverflow.com/questions/52850792/vba-rfc-sap-export-to-excel/52851948#52851948", "title": "VBA (RFC) SAP export to excel", "body": "<h1>Arrays: Faster Than Ranges</h1>\n\n<p>If the data was ready (need not to be processed) something like this could be a solution:</p>\n\n<pre><code>Sub Sap()\n\n    Const cStrStart As String = \"A1\" 'First cell of the resulting data\n\n    Dim tbldata\n    Dim arrSap As Variant 'Will become a one-based two dimensional array\n    Dim oRng As Range\n\n        arrSap = tbldata 'Data is in the array.\n\n        'Calculate the range: Must be the same size as arrSap\n        Set oRng = Range(Cells(Range(cStrStart).Row, UBound(arrSap)), _\n            Cells(Range(cStrStart)).Column, UBound(arrSap, 2))\n\n        oRng = arrSap 'Paste array into range.\n\nEnd Sub\n</code></pre>\n\n<p>Since you need to process your data from tbldata do what you do not to the range, but to an array which should be much faster:</p>\n\n<pre><code>Sub Sap()\n\n    Const cStrStart As String = \"A1\" 'First cell of the resulting data\n\n    Dim arrSap() As Variant\n    Dim oRng As Range\n    Dim Size As Integer\n\n    If RFC_READ_TABLE.Call = True Then\n'-------------------------------------------------------------------------------\n        MsgBox tbldata.RowCount\n        If tbldata.RowCount &gt; 0 Then\n            Size = UBound(ColumnNames, 1) - LBound(ColumnNames, 1) + 1\n            ReDim arrSap(1 To tbldata.RowCount + 1, 1 To Size) '+ 1 for header\n            ' Write table header\n            For j = 1 To Size\n                arrSap(1, j).Value = ColumnNames(j)\n            Next j\n            ' Write data\n            For i = 1 + 1 To tbldata.RowCount + 1 '+ 1 for header\n                DoEvents\n                '- 1 due to header, don't know what \"WA\" is\n                Textzeile = tbldata(i - 1, \"WA\")\n                For j = 1 To Size\n                    arrSap(i, j) = _\n                        LTrim(RTrim(getPieceOfTextzeile(Textzeile)))\n                Next j\n            Next\n'-------------------------------------------------------------------------------\n            'Calculate the range: Must be the same size as arrSap\n            Set oRng = Range(Cells(Range(cStrStart).Row, Range(cStrStart).Column), _\n                Cells(UBound(arrSap) + Range(cStrStart).Row -1, _\n                UBound(arrSap, 2) + Range(cStrStart).Column -1))\n            oRng = arrSap\n'-------------------------------------------------------------------------------\n        Else\n            MsgBox \"No entries found in system \" &amp; SYSID, vbInformation\n        End If\n    Else\n        MsgBox \"ERROR CALLING SAP REMOTE FUNCTION CALL\"\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Now adjust the cStrStart, check the rest of the code and you're good to go.<br>\nI haven't created a working example so I edited this code a few times. Check it carefully not to lose data.</p>\n"}], "owner": {"reputation": 379, "user_id": 2766148, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/ayl2X.png?s=128&g=1", "display_name": "Markus", "link": "https://stackoverflow.com/users/2766148/markus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1175, "favorite_count": 1, "accepted_answer_id": 52851948, "answer_count": 1, "score": 1, "last_activity_date": 1543143685, "creation_date": 1539766129, "last_edit_date": 1539789339, "question_id": 52850792, "link": "https://stackoverflow.com/questions/52850792/vba-rfc-sap-export-to-excel", "title": "VBA (RFC) SAP export to excel", "body": "<p>I am writing a VB application for connecting to a sap system (using rfc).\nEverything works fine and I do get a connection and the data as well.</p>\n\n<p>Nevertheless the code for saving the accessed data and writing it to a excel file is really slow.</p>\n\n<p>After the connection I call RFC_READ_TABLE, which returns with a result in &lt;5 secs, which is perfect. Writing to excel (cell by cell) is pretty slow.\nIs there any way to 'export' the whole tblData to excel and not being dependent on writing cell by cell?</p>\n\n<p>Thanks in advance!</p>\n\n<pre><code>If RFC_READ_TABLE.Call = True Then\n    MsgBox tblData.RowCount\n    If tblData.RowCount &gt; 0 Then\n\n        ' Write table header\n        For j = 1 To Size\n            Cells(1, j).Value = ColumnNames(j)\n        Next j\n\n        Size = UBound(ColumnNames, 1) - LBound(ColumnNames, 1) + 1\n\n        For i = 1 To tblData.RowCount\n            DoEvents\n            Textzeile = tblData(i, \"WA\")\n\n            For j = 1 To Size\n                Cells(i + 1, j).Value = LTrim(RTrim(getPieceOfTextzeile(Textzeile)))\n            Next j\n\n       Next\n    Else\n       MsgBox \"No entries found in system \" &amp; SYSID, vbInformation\n    End If\n\nElse\n   MsgBox \"ERROR CALLING SAP REMOTE FUNCTION CALL\"\nEnd If\n</code></pre>\n"}, {"tags": ["excel", "vba", "oledb", "fileserver"], "answers": [{"tags": [], "owner": {"reputation": 82, "user_id": 8879831, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0bbb6faadb2855b2de386306a6579cd9?s=128&d=identicon&r=PG", "display_name": "Vinnie Novido", "link": "https://stackoverflow.com/users/8879831/vinnie-novido"}, "is_accepted": true, "score": 0, "last_activity_date": 1539946617, "creation_date": 1539946617, "answer_id": 52891012, "question_id": 52850669, "link": "https://stackoverflow.com/questions/52850669/vba-connection-to-another-workbook-on-a-fileserver/52891012#52891012", "title": "VBA connection to another workbook on a fileserver", "body": "<p>After a long time of trying different things, the answer was actually super easy, and embarrassing.</p>\n\n<p>In my filepath I thought it was \\FILEREP\\ when it actually is \\FILERP\\</p>\n\n<p>So my lesson to all is, make sure you have the right file path before you start looking at other things! :)</p>\n\n<p>In the end all I needed was the standard connection string seen below!</p>\n\n<pre><code>strConnection = \"Provider=Microsoft.ACE.OLEDB.12.0;\" &amp; _\n                \"Data Source=\" &amp; filepath &amp; \";\" &amp; _\n                \"Extended Properties=\"\"Excel 12.0 Xml;HDR=No;\"\"\"\n</code></pre>\n"}], "owner": {"reputation": 82, "user_id": 8879831, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0bbb6faadb2855b2de386306a6579cd9?s=128&d=identicon&r=PG", "display_name": "Vinnie Novido", "link": "https://stackoverflow.com/users/8879831/vinnie-novido"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 52891012, "answer_count": 1, "score": 0, "last_activity_date": 1539946617, "creation_date": 1539765760, "last_edit_date": 1539874939, "question_id": 52850669, "link": "https://stackoverflow.com/questions/52850669/vba-connection-to-another-workbook-on-a-fileserver", "title": "VBA connection to another workbook on a fileserver", "body": "<p>I want to import data from one workbook to another and have done so with the help of the OLEDB driver. However it only works on my local machine. When I tried to test it in the actual production environment it failed to connect to the source file. Both the running file and the source file exist on a fileserver with authentication requirements, but I have read/write access, yet I'm unable to open the source file.</p>\n\n<p>Everytime I try to fetch data from the excel workbook I get an error saying that the file I'm trying to connect to is already open and cannot be accessed. I know for certain that no one is using the source file. I've tried using different way of writing the filepath, and each variant gives me different error. (\"\\FILERP\\...\" as well as a drive letter \"G:...\")</p>\n\n<p>Below you can find one of the string connections that I've tried without success.</p>\n\n<pre><code>strConnection = \"Provider=Microsoft.ACE.OLEDB.12.0;\" &amp; _\n                \"Data Source=\" &amp; filepath &amp; \";\" &amp; _\n                \"User ID=\" &amp; userName &amp; \";\" &amp; _\n                \"IMEX=1;\" &amp; _\n                \"Mode=Read;\" &amp; _\n                \"Extended Properties=\"\"Excel 12.0 Xml;\" &amp; _\n                \"HDR=NO;\"\"\"\n</code></pre>\n\n<p>Some examples of errors that I get:</p>\n\n<pre><code>strConnection = \"Provider=Microsoft.ACE.OLEDB.12.0;\" &amp; _\n                \"Data Source=\" &amp; filepath &amp; \";\" &amp; _\n                \"Extended Properties=\"\"Excel 12.0 Xml;HDR=No;\"\"\"\n</code></pre>\n\n<p>Runtime error '-2147467259 (80004005)' \"Can't update. The database or object is write protected.\"</p>\n\n<pre><code>strConnection = \"Provider=Microsoft.ACE.OLEDB.12.0;\" &amp; _\n                \"Data Source=\" &amp; filepath &amp; \";\" &amp; _\n                \"Integrated Security=SSPI;\" &amp; _\n                \"Extended Properties=\"\"Excel 12.0 Xml;HDR=No;\"\"\"\n</code></pre>\n\n<p>Runtime error '-2147217887 (80040e21)' \"Multiple-step OLE DB operation generated errors. Check each OLE DB status value\"</p>\n\n<pre><code>    strConnection = \"Provider=Microsoft.ACE.OLEDB.12.0;\" &amp; _\n                \"Data Source=\" &amp; filepath &amp; \";\" &amp; _\n                \"User Id=\" &amp; userName &amp; \";\" &amp; _\n                \"Password=****;\" &amp; _\n                \"Extended Properties=\"\"Excel 12.0 Xml;HDR=No;\"\"\"\n</code></pre>\n\n<p>Runtime error '-2147217843 (80040e4d) \"Can't start the program. The information file for workgroups is missing or is exclusively opened by another user.\"</p>\n"}, {"tags": ["excel", "vba", "function", "sum"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1539764701, "post_id": 52850307, "comment_id": 92616365, "body": "Is your code working so far or not? What <i>exactly</i> is the issue? Any errors? What is your question? You didn&#39;t ask one."}, {"owner": {"reputation": 95, "user_id": 10358101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d60e9e6ac30ec05b48e43401e89ef076?s=128&d=identicon&r=PG&f=1", "display_name": "NHure92", "link": "https://stackoverflow.com/users/10358101/nhure92"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1539764928, "post_id": 52850307, "comment_id": 92616490, "body": "The code is working, what I would like to do is find out if there is a way to have the current sum total it produces on the individual worksheets also moved onto a master worksheet. So for example, if I go back to look at the data for week 39 (1st-5th october) I could find the sum total from the individual worksheets on a master worksheet."}], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 10358101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d60e9e6ac30ec05b48e43401e89ef076?s=128&d=identicon&r=PG&f=1", "display_name": "NHure92", "link": "https://stackoverflow.com/users/10358101/nhure92"}, "edited": false, "score": 0, "creation_date": 1539766446, "post_id": 52850575, "comment_id": 92617283, "body": "Hi, I should probably add I already have a master worksheet (I&#39;ve edited my post with a screenshot of it) which contains other data on it. Is there anyway to specify the column where I would like the data to appear? So for example, would it be possible through the VBA so that in column F I can have a cell which shows the date range (1st-5th Oct for example) and in the adjacent cell in column J it shows the sum values for those dates? My screenshot will try to demonstrate this"}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1539765396, "creation_date": 1539765396, "answer_id": 52850575, "question_id": 52850307, "link": "https://stackoverflow.com/questions/52850307/vba-sum-totals-to-a-master-worksheet/52850575#52850575", "title": "VBA - sum totals to a master worksheet", "body": "<p>Try:</p>\n\n<pre><code>Sub test4()\n\nDim ws As Worksheet\nDim LastRowJ As Long\nDim MasterTotal As Double\n\nFor Each ws In ActiveWorkbook.Worksheets\n    LastRowJ = ws.Cells(ws.Rows.Count, \"J\").End(xlUp).Row\n    MasterTotal = MasterTotal + ws.Range(\"J\" &amp; LastRowJ).Value '&lt;= Let us assume that total appears in each sheet at the last line in column J\nNext ws\n\nSheet1.Range(\"A1\").Value = MasterTotal '&lt;= Change where you want to import the total of totals\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 95, "user_id": 10358101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d60e9e6ac30ec05b48e43401e89ef076?s=128&d=identicon&r=PG&f=1", "display_name": "NHure92", "link": "https://stackoverflow.com/users/10358101/nhure92"}, "edited": false, "score": 0, "creation_date": 1539770754, "post_id": 52850794, "comment_id": 92619842, "body": "Thank you, i&#39;ve tried your code and it creates a new worksheet titled master and adds a figure to it. However it has now stopped including the sum totals on the individual worksheets, is there a way to still keep these as well? Additionally, is there a way to add the date to column a on the master worksheet once it does the VBA is run and it does the calculation?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 95, "user_id": 10358101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d60e9e6ac30ec05b48e43401e89ef076?s=128&d=identicon&r=PG&f=1", "display_name": "NHure92", "link": "https://stackoverflow.com/users/10358101/nhure92"}, "edited": false, "score": 0, "creation_date": 1539771344, "post_id": 52850794, "comment_id": 92620210, "body": "this still creates the sum on each individual worksheet in column J and sums from J3 to last used cell. Debug your code (go through it step by step using F8) to see what happens in each step."}, {"owner": {"reputation": 95, "user_id": 10358101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d60e9e6ac30ec05b48e43401e89ef076?s=128&d=identicon&r=PG&f=1", "display_name": "NHure92", "link": "https://stackoverflow.com/users/10358101/nhure92"}, "edited": false, "score": 0, "creation_date": 1539772072, "post_id": 52850794, "comment_id": 92620623, "body": "my mistake, you&#39;re right the code you&#39;ve suggested works. Thank you so much!"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1539768511, "last_edit_date": 1539768511, "creation_date": 1539766132, "answer_id": 52850794, "question_id": 52850307, "link": "https://stackoverflow.com/questions/52850307/vba-sum-totals-to-a-master-worksheet/52850794#52850794", "title": "VBA - sum totals to a master worksheet", "body": "<p>I recommend the following \u2026</p>\n\n<pre><code>Option Explicit\n\nPublic Sub AutoSumAllWorkheets()\n    Const MasterName As String = \"Master\" 'specify name of master sheet\n\n    Dim wsMaster As Worksheet\n    On Error Resume Next 'test if master exists\n    Set wsMaster = ActiveWorkbook.Worksheets(MasterName)\n    On Error GoTo 0\n\n    If wsMaster Is Nothing Then 'add master if not exists\n        Set wsMaster = ActiveWorkbook.Worksheets.Add(Before:=ActiveWorkbook.Worksheets(1))\n        wsMaster.Name = MasterName\n        'instead you can throw a message and exit here\n        'MsgBox \"No master found\"\n        'Exit Sub\n    End If\n\n    Dim FirstCell As Range, LastCell As Range\n\n    Dim ws As Worksheet\n    For Each ws In ActiveWorkbook.Worksheets\n        With ws\n            If .Name &lt;&gt; MasterName Then 'don't sum on master sheet\n                Set FirstCell = .Range(\"J3\")\n                Set LastCell = FirstCell.End(xlDown)\n                LastCell.Offset(2, 0).Formula = \"=SUM(\" &amp; FirstCell.Address &amp; \":\" &amp; LastCell.Address &amp; \")\"\n\n                'write in master\n                With wsMaster.Cells(wsMaster.Rows.Count, \"A\").End(xlUp)\n                    .Offset(1, 0).Value = ws.Name\n                    .Offset(1, 1).Formula = \"=\" &amp; LastCell.Offset(2, 0).Address(External:=True)\n                End With\n            End If\n        End With\n    Next ws\n\n    'sum all sheets up\n    With wsMaster.Cells(wsMaster.Rows.Count, \"A\").End(xlUp)\n        .Offset(2, 0).Value = \"Total sum:\"\n        .Offset(2, 1).Formula = \"=SUM(\" &amp; wsMaster.Cells(1, \"B\").Address &amp; \":\" &amp; .Offset(0, 1).Address &amp; \")\"\n    End With\nEnd Sub\n</code></pre>\n\n<p>The first part checks if a master sheet exists and adds one if it doesn't exist.</p>\n\n<p>Then I improved your code a bit:</p>\n\n<ul>\n<li>I recommend to use clear variable names (makes it easier). For example your <code>firstCel</code> actually was not the first but the sum cell. That is very confusing and you will easily fail.</li>\n<li>Use <code>.Formula</code> to write a formula.</li>\n<li>I added some code to write the sums of each sheet into the master sheet. Note that this appends the entries at the master sheet. So if you run it twice you need to clear the entries in the master sheet first.</li>\n</ul>\n\n<p>If you want to write into another column of the master sheet just change the column name of <code>wsMaster.Cells(wsMaster.Rows.Count, \"A\").End(xlUp)</code> from <code>\"A\"</code> to eg <code>\"L\"</code></p>\n"}], "owner": {"reputation": 95, "user_id": 10358101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d60e9e6ac30ec05b48e43401e89ef076?s=128&d=identicon&r=PG&f=1", "display_name": "NHure92", "link": "https://stackoverflow.com/users/10358101/nhure92"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 52850794, "answer_count": 2, "score": 0, "last_activity_date": 1539768511, "creation_date": 1539764422, "last_edit_date": 1539766684, "question_id": 52850307, "link": "https://stackoverflow.com/questions/52850307/vba-sum-totals-to-a-master-worksheet", "title": "VBA - sum totals to a master worksheet", "body": "<p>Okay, so here goes. I have a workbook with individual worksheets for each day detailing the stock trading activity. I also currently have a VBA which provides a sum total for specified columns on each of these worksheets, and this works fine.</p>\n\n<p>However, what I would like to do is add to my VBA so that it provides a sum total for these columns into the master worksheet.</p>\n\n<p>So, for example: If there was trading activity totalling 4m on the 1st Oct 2018 on worksheet 1, and trading activity totalling 3m on 2nd october 2018 on worksheet 2, I would like to have this total of 7m shown on the master worksheet. </p>\n\n<p>I've attached my current vba below, the column currently being summed on each individual worksheet is J. The columns summed on the individual worksheet do not change, however the amount of data contained in those columns obviously does depending on trading activity. </p>\n\n<pre><code>Sub autoSum_AllSheets()\n    Dim ws As Worksheet\n    Dim cel1 As String, cel2 As String\n    Dim firstCel As Range\n\n    For Each ws In ActiveWorkbook.Worksheets\n        With ws\n            Set firstCel = .Range(\"J3\").End(xlDown).Offset(2, 0)\n            cel1 = firstCel.Offset(-2, 0).End(xlUp).Address\n            cel2 = firstCel.Offset(-1).Address\n            firstCel.Value = \"=SUM(\" &amp; cel1 &amp; \":\" &amp; cel2 &amp; \")\"\n        End With\n    Next ws\nEnd Sub\n</code></pre>\n\n<p>I've also attached a screenshot of a current mock worksheet taken from a random day, with the sum total i get after running the vba bolded and highlighted in red.</p>\n\n<p><a href=\"https://i.stack.imgur.com/CwFyu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CwFyu.png\" alt=\"VBA\"></a></p>\n\n<p>Any advice on how to approach this would be great as I'm a newcomer to all things VBA.  </p>\n\n<p><strong>Edit: I've attached a mock screenshot of what I'm trying to achieve on the master worksheet below:</strong> </p>\n\n<p><a href=\"https://i.stack.imgur.com/gT2H1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gT2H1.png\" alt=\"master worksheet example of what i need\"></a></p>\n"}, {"tags": ["vba", "outlook", "calendar", "appointment"], "comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1539776959, "post_id": 52850075, "comment_id": 92623436, "body": "See <a href=\"https://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a>. Add code for calling the function and for MoveAppointment."}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1539882267, "post_id": 52850075, "comment_id": 92671633, "body": "<code>xpl.AddToSelection apptmts</code>. No brackets around apptmts and later around oOlAppt"}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1539882516, "post_id": 52850075, "comment_id": 92671754, "body": "The real question appears to be, why are the selected items being deselected in MoveAppointment?"}, {"owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "reply_to_user": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1540021993, "post_id": 52850075, "comment_id": 92718233, "body": "@niton - #1: Created a MCVE."}, {"owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "reply_to_user": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1540022597, "post_id": 52850075, "comment_id": 92718368, "body": "@niton - #2: Done. That changes the error code, to something more sensible, and it helped revealing another problem, which is solved. Please see EDIT."}, {"owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "reply_to_user": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1540022647, "post_id": 52850075, "comment_id": 92718381, "body": "@niton - #3: Agreed. But that is the way Outlook works, and then my need for writing code to re-select items."}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1540053570, "post_id": 52850075, "comment_id": 92726446, "body": "The selection is no longer in the ActiveExplorer. You have <code>Set sel = xpl.Selection</code> to keep a handle on the selection. Replace <code>Debug.Print &quot;Count = &quot; &amp; xpl.Selection.Count</code> with <code>Debug.Print &quot;Count = &quot; &amp; sel.Count</code>. The reason xpl.Selection.Count returns zero is <code>sel</code> has moved outside of the active explorer."}, {"owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "reply_to_user": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1540085412, "post_id": 52850075, "comment_id": 92733531, "body": "@niton - That would only print the original number of selected items, but it would not solve my problem. I need to end with the same original set of appointments selected."}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1540132418, "post_id": 52850075, "comment_id": 92742702, "body": "<code>Debug.Print &quot;Count = &quot; &amp; sel.Count</code> prints the count of the <b>current</b> number of selected items. The original selected items have not been deselected they have moved out of view. Change your calendar view so there are two weeks visible, before making a selection in the first week. You should see the selection end up in the second week. You can use this awkward method to get xpl.Selection (ActiveExplorer.Selection) again, or just use the existing <code>sel</code> for whatever purpose you want xpl.Selection for."}, {"owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "reply_to_user": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1540199975, "post_id": 52850075, "comment_id": 92761293, "body": "@niton - I think this is not true. <code>Debug.Print &quot;Count = &quot; &amp; sel.Count</code> prints the count of items at the time <code>Set sel = xpl.Selection</code> was executed, and it wouldn&#39;t change if I later change the <code>xpl.Selection</code>. On the ohter hand, <code>Debug.Print &quot;Count = &quot; &amp; xpl.Selection.Count</code> prints the count of the current number of selected items. I have just tested this. Then the need of re-selecting items."}], "answers": [{"tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": false, "score": 0, "last_activity_date": 1540242779, "creation_date": 1540242779, "answer_id": 52937831, "question_id": 52850075, "link": "https://stackoverflow.com/questions/52850075/reselect-items-in-calendar-after-processing-the-items/52937831#52937831", "title": "Reselect items in Calendar after processing the items", "body": "<p>Re: How can I end with a Selection of the same original items?</p>\n\n<p>With <code>Set sel = xpl.Selection</code>, sel is a Selection of the same original items.</p>\n\n<pre><code>Sub MoveAppt_SelOnly()\n\n    ' Move selected appointment a given number of days within the Calendar\n\n    Dim xpl As Explorer\n    Dim sel As Selection\n    Dim ndays As Long\n\n    Set xpl = ActiveExplorer\n\n    If xpl.Selection(1).Class = olAppointment Then\n\n        If xpl.Selection(1).subject = \"test\" Then\n\n            Debug.Print\n            Debug.Print \"xpl.Selection.count ....: \" &amp; xpl.Selection.count\n            Debug.Print \"xpl.Selection(1).subject: \" &amp; xpl.Selection(1).subject\n            Debug.Print \"xpl.Selection(1).start..: \" &amp; xpl.Selection(1).Start\n\n            Set sel = xpl.Selection\n            Debug.Print \"sel(1).subject..........: \" &amp; sel(1).subject\n            Debug.Print \"sel(1).start............: \" &amp; sel(1).Start\n\n            ndays = 7\n\n            MoveAppointment sel(1), ndays\n\n            Debug.Print\n            Debug.Print \"xpl.Selection.count ....: \" &amp; xpl.Selection.count\n            Debug.Print \"sel(1).subject..........: \" &amp; sel(1).subject\n            Debug.Print \"sel(1).start.........new: \" &amp; sel(1).Start\n\n            ' For testing. Be sure the item is not in the view after this first move\n            '  otherwise you do not lose track of xpl.Selection.\n            MsgBox \"The moved item should not be in the view.\" &amp; vbCr &amp; _\n                \"xpl.Selection.count ....: \" &amp; xpl.Selection.count &amp; vbCr &amp; _\n                \"sel(1).subject..........: \" &amp; sel(1).subject &amp; vbCr &amp; _\n                \"sel(1).start.........new: \" &amp; sel(1).Start\n\n            Debug.Print\n            ' If you see zero here it does not matter\n            Debug.Print \"xpl.Selection.count ....: \" &amp; xpl.Selection.count\n\n            Debug.Print \"sel(1).subject..........: \" &amp; sel(1).subject\n            Debug.Print \"sel(1).start.........new: \" &amp; sel(1).Start\n\n            ' Return the item to where it started, using sel,\n            '   a \"Selection of the same original items\".\n            MoveAppointment sel(1), ndays * (-1)\n\n            MsgBox \"The moved item should be in the view now.\" &amp; vbCr &amp; _\n                \"xpl.Selection.count ....: \" &amp; xpl.Selection.count &amp; vbCr &amp; _\n                \"sel(1).subject..........: \" &amp; sel(1).subject &amp; vbCr &amp; _\n                \"sel(1).start....original: \" &amp; sel(1).Start\n\n            Debug.Print\n            ' If you see zero here it does not matter\n            Debug.Print \"xpl.Selection.count ....: \" &amp; xpl.Selection.count\n\n            Debug.Print \"sel(1).subject..........: \" &amp; sel(1).subject\n            Debug.Print \"sel(1).start....original: \" &amp; sel(1).Start\n\n        End If\n\n    End If\n\nEnd Sub\n\n\nSub MoveAppointment(ByRef oOlAppt As AppointmentItem, ByVal ndays As Long)\n\n    ' Move an AppointmentItem a given number of days within the Calendar\n\n    Dim newStart As Date\n\n    With oOlAppt\n        oOlAppt.Start = DateAdd(\"d\", ndays, oOlAppt.Start)\n        .Save\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 221, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1596144520, "creation_date": 1539763568, "last_edit_date": 1596144520, "question_id": 52850075, "link": "https://stackoverflow.com/questions/52850075/reselect-items-in-calendar-after-processing-the-items", "title": "Reselect items in Calendar after processing the items", "body": "<p>I have an Outlook VBA function that takes a Selection and processes its Items.</p>\n<p>I want it to Select again whatever Selection existed previously.</p>\n<p>I guessed I have to store the initial selection. After processing a first item, the Selection becomes empty, so I would use <code>AddToSelection</code> to add one item at a time.<br />\nBut I could not avoid getting <code>error 438</code>.</p>\n<p>From <a href=\"https://docs.microsoft.com/en-us/office/vba/api/outlook.explorer.addtoselection\" rel=\"nofollow noreferrer\">official documentation</a>, the only possible source of error I see is any listed in &quot;Under the following conditions, Outlook returns an error when you call the AddToSelection method:&quot;<br />\nBut I think none of those apply.</p>\n<p><strong>What are possible sources of error, and how can I systematically assess which is my case?</strong></p>\n<p><strong>How can I end with a <code>Selection</code> of the same original items?</strong></p>\n<p>My function (here applied to a <code>Selection</code> with a single item):</p>\n<pre><code>Sub MoveAppt()\n' Move selected appointment a given number of days within the Calendar\n    Dim sel As Outlook.Selection, xpl As Explorer\n    Dim oOlAppt As Outlook.AppointmentItem\n    Set xpl = Application.ActiveExplorer\n    Set sel = xpl.Selection\n    Set oOlAppt = sel.Item(1)\n    Dim newStart As Date\n    Dim ndays As Integer\n    ndays = 7\n    newStart = MoveAppointment(oOlAppt, ndays)\n\n    Debug.Print &quot;Count = &quot; &amp; xpl.Selection.Count    ' THIS GIVES 0, CONFIRMING AN EMPTY Selection\n    If (xpl.IsItemSelectableInView(oOlAppt)) Then   ' &lt;----- THIS RETURNS True ...\n        xpl.AddToSelection oOlAppt                  ' &lt;----- ... BUT THIS GIVES ERROR -2147467259 (80004005)\n    Else\n        Debug.Print &quot;Object is not selectable&quot;\n    End If\nEnd Sub\n\nFunction MoveAppointment(ByRef oOlAppt As Outlook.AppointmentItem, ByVal ndays As Integer) As Date\n' Move an Outlook.AppointmentItem a given number of days within the Calendar\n    With oOlAppt\n        Dim currStart As Date, newStart As Date\n        currStart = .Start\n        newStart = DateAdd(&quot;d&quot;, ndays, currStart)\n        .Start = newStart\n        .Save\n    End With\n    MoveAppointment2 = newStart\nEnd Function\n</code></pre>\n<p><strong>EDIT</strong>:<br />\nRemoving parenthesis about the argument of <code>AddToSelection</code> changed the error to that indicated in the code.<br />\nSo I tried: 1) setting a breakpoint at that line, 2) when the breakpoint is hit, going in the calendar view to the week of <code>newStart</code>, where the moved item is now, 3) continuing. This runs ok, so it seems to answer the question.</p>\n<p>As for how to re-select the original items, I guess I should: 1) determine the min and max dates among all original items, 2) set the <code>CalendarView</code> to cover those dates, 3) loop through all items in the original selection and <code>AddToSelection</code> them.<br />\nI wouldn't know if there is anything simpler.</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 1534, "user_id": 5373986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5937e22068b8355cf94c4c18f747660f?s=128&d=identicon&r=PG&f=1", "display_name": "Taazar", "link": "https://stackoverflow.com/users/5373986/taazar"}, "edited": false, "score": 0, "creation_date": 1539763646, "post_id": 52849723, "comment_id": 92615768, "body": "You can put line numbers into it but it&#39;s quite complicated."}, {"owner": {"reputation": 407, "user_id": 5973860, "user_type": "registered", "accept_rate": 93, "profile_image": "https://lh3.googleusercontent.com/-QhAxmtyBUoI/AAAAAAAAAAI/AAAAAAAAAjI/kXQt5c3QNJY/photo.jpg?sz=128", "display_name": "Cypher236", "link": "https://stackoverflow.com/users/5973860/cypher236"}, "reply_to_user": {"reputation": 1534, "user_id": 5373986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5937e22068b8355cf94c4c18f747660f?s=128&d=identicon&r=PG&f=1", "display_name": "Taazar", "link": "https://stackoverflow.com/users/5373986/taazar"}, "edited": false, "score": 0, "creation_date": 1539764044, "post_id": 52849723, "comment_id": 92615979, "body": "What do you mean by line numbers? As in returning the error line? I was hoping more for some kind of proper exception message rather than just &quot;Connection failure&quot;"}, {"owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "edited": false, "score": 0, "creation_date": 1539764063, "post_id": 52849723, "comment_id": 92615991, "body": "If your code calls other procedures, all those procedures also should have error handlers, otherwise, the error from those procedures will be &quot;bubbled&quot; upper until code with error handler reached and error code/message will be totally misleading."}, {"owner": {"reputation": 407, "user_id": 5973860, "user_type": "registered", "accept_rate": 93, "profile_image": "https://lh3.googleusercontent.com/-QhAxmtyBUoI/AAAAAAAAAAI/AAAAAAAAAjI/kXQt5c3QNJY/photo.jpg?sz=128", "display_name": "Cypher236", "link": "https://stackoverflow.com/users/5973860/cypher236"}, "edited": false, "score": 0, "creation_date": 1539764203, "post_id": 52849723, "comment_id": 92616077, "body": "It opens another form, however each sub in the form it opens has its own error message informing the user which sub failed so I think it should be ok there"}], "answers": [{"comments": [{"owner": {"reputation": 407, "user_id": 5973860, "user_type": "registered", "accept_rate": 93, "profile_image": "https://lh3.googleusercontent.com/-QhAxmtyBUoI/AAAAAAAAAAI/AAAAAAAAAjI/kXQt5c3QNJY/photo.jpg?sz=128", "display_name": "Cypher236", "link": "https://stackoverflow.com/users/5973860/cypher236"}, "edited": false, "score": 0, "creation_date": 1539764903, "post_id": 52850261, "comment_id": 92616474, "body": "Thanks for the answer, frustratingly I can&#39;t just change it and test it directly myself so I&#39;ll have to put in a request and see if this helps."}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 1, "last_activity_date": 1539764267, "creation_date": 1539764267, "answer_id": 52850261, "question_id": 52849723, "link": "https://stackoverflow.com/questions/52849723/getting-a-more-useful-accurate-error-message/52850261#52850261", "title": "Getting a more useful/accurate error message", "body": "<p>Domain aggregates often don't give descriptive error messages. I'm assuming your database runs into problems connecting to the backend when running the domain aggregate.</p>\n\n<p>You can easily replace your domain aggregate with a recordset call:</p>\n\n<pre><code>blnSystemMaintenance = CurrentDb.OpenRecordset(\"SELECT SystemMaintenance FROM ConfigItems\")(0).Value\n</code></pre>\n\n<p>Often, those give a bit more descriptive errors, if the error occurs at all when using a recordset.</p>\n"}, {"comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1539769289, "post_id": 52850929, "comment_id": 92618993, "body": "The general point of this question is fine (nice error handling code!), but afaik it doesn&#39;t apply to this case because it&#39;s a rare type of error that can&#39;t be generated by err.Raise: the err.Number is zero, while the err.Description is set! That&#39;s a scenario that should never happen (and if it does, your second error handler will fail with RTE 5 Invalid procedure call or argument). I think I&#39;ve previously encountered it when having connectivity issues to my backend, but note this special kind of error will make your error handler fail."}], "tags": [], "owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "is_accepted": false, "score": 1, "last_activity_date": 1539766516, "creation_date": 1539766516, "answer_id": 52850929, "question_id": 52849723, "link": "https://stackoverflow.com/questions/52849723/getting-a-more-useful-accurate-error-message/52850929#52850929", "title": "Getting a more useful/accurate error message", "body": "<p>Sometimes error messages may be misleading for some type of functions like <code>DLookup</code>, this is a system problem, but sometimes error messages are misleading because not all procedures have correct error handlers and it's difficult to localize the problem especially if the developer has no direct access to the application. So, correct error handlers may significantly simplify troubleshooting.</p>\n\n<p>Normally I use two types of error handlers, which give me quite clear diagnostic messages. Most common - usual error handler for procedures, which may interact with the user and normally called by the system - events handlers:</p>\n\n<pre><code>Private Sub Frame2_Click()\n    On Error GoTo ErrorHandler\n    'code here\nExitHere:\n    On Error Resume Next\n    Exit Sub\n    Resume '&gt;&gt; remove in release\nErrorHandler:\n    MsgBox \"Error \" &amp; err.Number &amp; \" (\" &amp; err.Description &amp; \"), Line \" &amp; Erl &amp; \" in procedure Frame2_Click of Form_Form1\", vbExclamation + vbMsgBoxHelpButton, \"Error \" &amp; Now()\n    Resume ExitHere\nEnd Sub\n</code></pre>\n\n<p>The second type of handlers - for procedures, which may be called only by other VBA procedures, \"bubble\" handler, which adds information about the error to error description and passes the error up to caller procedure:</p>\n\n<pre><code>Sub MySub()\n    On Error GoTo ErrorHandler\n    'code here\nExitHere:\n    Exit Sub\n    Resume '&gt;&gt; remove in release\nErrorHandler:\n    Debug.Assert Not (STOP_AT_ERROR And IS_DEV) '&gt;&gt; remove in release\n    err.Raise err.Number, \"MySub of Form_Form1\", err.Description &amp; vbCrLf &amp; \"in MySub of Form_Form1 at \" &amp; Erl\nEnd Sub\n</code></pre>\n\n<p>It allows to show full call stack with error lines and procedure names. Line numbers should be added to each line of code though. </p>\n\n<p>For debug simplifying I use two constants: if <code>STOP_AT_ERROR</code> is <code>True</code> and <code>IS_DEV</code> is <code>True</code>, code execution stops right after the error without bubbling and allows to inspect variables. For inspecting, I move the code execution pointer to the line <code>Resume</code> using Ctrl-F9, then press F8 and code pointer moves to the row, which caused the error.</p>\n\n<p>In the production or QA versions just change <code>IS_DEV</code> to <code>False</code> and code won't stop at <code>Debug.Assert</code> line. </p>\n\n<p>For automatic generating error handlers and adding line numbers, I use third party software, for instance, MZ-Tools. It can be done manually, but it's quite a time consuming</p>\n"}], "owner": {"reputation": 407, "user_id": 5973860, "user_type": "registered", "accept_rate": 93, "profile_image": "https://lh3.googleusercontent.com/-QhAxmtyBUoI/AAAAAAAAAAI/AAAAAAAAAjI/kXQt5c3QNJY/photo.jpg?sz=128", "display_name": "Cypher236", "link": "https://stackoverflow.com/users/5973860/cypher236"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 52850261, "answer_count": 2, "score": 0, "last_activity_date": 1539766516, "creation_date": 1539762396, "question_id": 52849723, "link": "https://stackoverflow.com/questions/52849723/getting-a-more-useful-accurate-error-message", "title": "Getting a more useful/accurate error message", "body": "<p>We have an issue with an Access front-end that seemingly randomly but constantly times out users with no explanation. This has been a long-standing issue, each time the disconnect happens we're provided with the sub that's causing the issue and a generic error message.</p>\n\n<p>I'm starting to think the error message is misleading, it gives a generic \"Connection Failure\" with an Error Code of 0. After Googling the code that apparently means no error occurred?</p>\n\n<p>I use C# not VBA so I'm not familiar with it but the error handling is as follows:</p>\n\n<pre><code>    Private Sub Form_Timer()\n\n    Dim blnSystemMaintenance As Boolean\n\n    On Error GoTo ErrHand\n\n    ' Check for System Maintenance.\n    blnSystemMaintenance = DLookup(\"SystemMaintenance\", \"ConfigItems\")\n    If blnSystemMaintenance Then\n\n    //Do stuff\n        Else\n    //Do stuff\n        End If\n\n    //Do stuff\n\n    End If\n\n    ErrExit:\n        Exit Sub\n        Resume\n    ErrHand:\n    '    If Err.Number = 1 Then\n\n    '    Else\n            MsgBox \"Error number: \" &amp; Err.Number &amp; vbCrLf &amp; _\n           \"Error description: \" &amp; Err.Description, vbCritical, _\n           \"Unexpected Error Occurred in Sub: Form_Timer\"\n    Resume ErrExit\n    '    End If\n\n\n    End Sub\n</code></pre>\n\n<p>Is there a way to get a more helpful error message?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 10358672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6037bfc7ea69402f02339050d5f7044b?s=128&d=identicon&r=PG&f=1", "display_name": "Martinswe", "link": "https://stackoverflow.com/users/10358672/martinswe"}, "edited": false, "score": 0, "creation_date": 1539773040, "post_id": 52849921, "comment_id": 92621135, "body": "Thanks! That helped me a lot!"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 2, "last_activity_date": 1539763503, "last_edit_date": 1539763503, "creation_date": 1539763024, "answer_id": 52849921, "question_id": 52849393, "link": "https://stackoverflow.com/questions/52849393/cant-add-item-to-combobox-form-control-in-vba-excel/52849921#52849921", "title": "Can&#39;t add item to combobox (form control) in vba excel", "body": "<p>You can directly loop through the DropDowns (this is how Form Control \"ComboBoxes\" are called) instead of looping all <code>Shapes</code> \u2026</p>\n\n<pre><code>Option Explicit\n\nPublic Sub PopulateCombos()\n    Dim dd As DropDown\n    For Each dd In Sheet1.DropDowns\n        dd.AddItem \"Done\"\n        dd.AddItem \"Not Done\"\n    Next dd\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 10358672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6037bfc7ea69402f02339050d5f7044b?s=128&d=identicon&r=PG&f=1", "display_name": "Martinswe", "link": "https://stackoverflow.com/users/10358672/martinswe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 289, "favorite_count": 0, "accepted_answer_id": 52849921, "answer_count": 1, "score": 2, "last_activity_date": 1593677318, "creation_date": 1539761155, "last_edit_date": 1593677318, "question_id": 52849393, "link": "https://stackoverflow.com/questions/52849393/cant-add-item-to-combobox-form-control-in-vba-excel", "title": "Can&#39;t add item to combobox (form control) in vba excel", "body": "<p>I have several ComboBoxes (form control) on <code>sheet1</code>. I would like to loop through and populate them. Nothing happens, no error or no items in the list of each ComboBox. I use this code:</p>\n\n<pre><code>Sub cmbBox()\n    Dim ctrl As Shape\n    For Each ctrl In Sheet1.Shapes\n        If ctrl.Type = msoOLEControlObject Then\n            ctrl.AddItem \"Done\"\n            ctrl.AddItem \"Not Done\"\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 1, "creation_date": 1547372707, "post_id": 52849271, "comment_id": 95164564, "body": "A full reply and instructive for many readers to learn about <code>Application.InputBox</code> +1)"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 2, "last_activity_date": 1539762665, "last_edit_date": 1539762665, "creation_date": 1539760693, "answer_id": 52849271, "question_id": 52848823, "link": "https://stackoverflow.com/questions/52848823/validate-input-box-entry-between-min-and-max-number/52849271#52849271", "title": "Validate Input box entry between min and max number", "body": "<p>It should look like this \u2026</p>\n\n<pre><code>Option Explicit\n\nPublic Sub AskForYear()\n    Dim InputValue As Variant   'needs to be variant because input is FALSE if cancel button is pressed\n    Dim DefaultYear As Integer\n\n    DefaultYear = Year(Date)    'Get the year of the current date today\n\n    Do\n        InputValue = Application.InputBox(Prompt:=\"Please enter a Year between 2015 and \" &amp; DefaultYear &amp; \".\" &amp; vbCrLf &amp; \"Year covered:\", Title:=\"Year\", Default:=DefaultYear, Type:=1)\n        If VarType(InputValue) = vbBoolean And InputValue = False Then Exit Sub  'cancel was pressed\n    Loop While InputValue &lt; 2015 Or InputValue &gt; DefaultYear\n\n    Range(\"I1\").Value = InputValue 'write input value\nEnd Sub\n</code></pre>\n\n<ul>\n<li><p>It uses a <code>Do</code> loop that is at least run once (note the criteria is in the <code>Loop While</code> part). It keeps asking for a date between 2015 and this year until the criteria is met. Then it will continue to write into the range.</p></li>\n<li><p>Note that there is a cancel criteria to catch if the user pressed the cancel button. Then it exits the sub without writing into the range.  </p>\n\n<blockquote>\n  <p><strong><em>This is just hypothetical for your specific case (asking for a year) but \u2026</em></strong><br>\n  For this criteria it is not sufficient to test <code>If InputValue = False</code> if you plan to accept <code>0</code> as number input. Therefore you need also to test for <code>Boolean</code>type:<br>\n  <code>If VarType(InputValue) = vbBoolean</code><br>\n  This is because <code>False</code> is automatically cast to <code>0</code>.</p>\n</blockquote></li>\n<li><p>Note that I used <code>Application.InputBox</code> instead of <code>InputBox</code>. These are 2 completely different ones: </p>\n\n<pre><code>Application.InputBox(Prompt, Title, Default, Left, Top, HelpFile, HelpContextID, Type)\n'see the different parameters\nInputBox(Prompt, Title, Default, XPos, YPos, HelpFile, Context) As String\n</code></pre>\n\n<p>In <code>Application.InputBox</code> you can provide a <code>Type</code> parameter which I set to <code>1</code> which means it only accepts numbers (see <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.application.inputbox#remarks\" rel=\"nofollow noreferrer\">Application.InputBox Method</a>). With just <code>InputBox</code> you cannot do this.</p></li>\n<li><p>I recommend to use meaningful variable names, which makes it much easier to read and maintain the code. Also only use <code>Variant</code> if really necessary. In this case it is, because the <code>Application.InputBox</code> can either return a <code>Boolean</code> (cancel button) or number (input).</p></li>\n<li><p>Another recommendation is to <em>always</em> specify a worksheet for a <code>Range</code> like <code>Worksheets(\"Sheet1\").Range(\"I1\")</code> otherwise Excel guesses which worksheet you mean and it might easily fail.</p></li>\n</ul>\n"}], "owner": {"reputation": 11, "user_id": 9750971, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Arianne Gale Cruz", "link": "https://stackoverflow.com/users/9750971/arianne-gale-cruz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 544, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1547239829, "creation_date": 1539758919, "last_edit_date": 1547239829, "question_id": 52848823, "link": "https://stackoverflow.com/questions/52848823/validate-input-box-entry-between-min-and-max-number", "title": "Validate Input box entry between min and max number", "body": "<p>I used <code>InputBox</code> for the \"period\" which is the month (\"m\").</p>\n\n<p>When I try using it for the \"year\" (\"YYYY\") it does not function as expected.</p>\n\n<p>My code for the \"year\" (same as in \"period\", only different values and variables):</p>\n\n<pre><code>Dim VYear as variant\nDim defY as variant\n\ndefY = Format(DateAdd(\"YYYY\", 0, Now), \"YYYY\")\nVYear = InputBox(\"Year covered\",\"Year\",defY)\nIf VYear &gt; 2014 And VYear &lt; defY Then\n    Range(\"I1\").Value = VYear\nElseIf VYear = \"\" Then\n    Exit Sub\nElse\n    Do Until VYear &gt; 2014 And VYear &lt; defY\n    MsgBox \"Please enter a year not earlier than 2015 and not later than this year\"\n    VYear = InputBox(\"Year covered\")\n    Loop\nEnd If\n</code></pre>\n\n<p>It does give me the default value of 2018. When I tried entering wrong values, it proceeds with the message in <code>MsgBox</code> as expected, but it would no longer accept ANY values, even the year \"2018\". </p>\n\n<p>Cycle goes: <code>MsgBox</code> (Please enter....) then <code>InputBox</code> then <code>MsgBox</code> again.</p>\n\n<p>I intentionally used <code>As Variant</code> so that even though users input letters, it won't give the error of <em>\"type mismatch\"</em>.</p>\n"}, {"tags": ["excel", "vba", "sorting"], "answers": [{"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1539759248, "creation_date": 1539759248, "answer_id": 52848910, "question_id": 52848753, "link": "https://stackoverflow.com/questions/52848753/custom-order-sort/52848910#52848910", "title": "Custom order sort", "body": "<p>Try:</p>\n\n<pre><code>ActiveWorkbook.Worksheets(\"Sheet1\").Sort.SortFields.Clear\nActiveWorkbook.Worksheets(\"Sheet1\").Sort.SortFields.Add2 Key:=Range(\"A:A\") _\n    , SortOn:=xlSortOnValues, Order:=xlAscending, CustomOrder:= _\n    \"Critical,High,Medium,Low\", DataOption:=xlSortNormal\n\n    With ActiveWorkbook.Worksheets(\"Sheet1\").Sort\n    .SetRange Range(\"A:A\")\n    .Header = xlNo\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 103, "user_id": 10068582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0246d2ec38d248d21d3259213e14625d?s=128&d=identicon&r=PG&f=1", "display_name": "Abdullah Naina", "link": "https://stackoverflow.com/users/10068582/abdullah-naina"}, "edited": false, "score": 0, "creation_date": 1539761923, "post_id": 52849114, "comment_id": 92614904, "body": "great solution you have provided"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 2, "last_activity_date": 1539760080, "creation_date": 1539760080, "answer_id": 52849114, "question_id": 52848753, "link": "https://stackoverflow.com/questions/52848753/custom-order-sort/52849114#52849114", "title": "Custom order sort", "body": "<p>Your custom sort criteria needs to be in an array. Try,</p>\n\n<pre><code>Sub runSortC()\n    Dim vCustom_Sort As Variant, rr As Long\n\n    vCustom_Sort = Array(\"Critical\",\"High\",\"Medium\",\"Low\", Chr(42))\n    Application.AddCustomList ListArray:=vCustom_Sort\n\n    with Range(\"C:C\")\n        .parent.Sort.SortFields.Clear\n\n        'sort on custom order with header\n        .Cells.Sort Key1:=.Columns(1), Order1:=xlAscending, _\n                    Orientation:=xlTopToBottom, Header:=xlYes, MatchCase:=False, _\n                    OrderCustom:=Application.CustomListCount + 1\n\n        .parent.Sort.SortFields.Clear\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>If this is in a public module, a qualified parent worksheet reference would help.</p>\n"}], "owner": {"reputation": 103, "user_id": 10068582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0246d2ec38d248d21d3259213e14625d?s=128&d=identicon&r=PG&f=1", "display_name": "Abdullah Naina", "link": "https://stackoverflow.com/users/10068582/abdullah-naina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2361, "favorite_count": 1, "accepted_answer_id": 52849114, "answer_count": 2, "score": 1, "last_activity_date": 1573647853, "creation_date": 1539758651, "last_edit_date": 1573647853, "question_id": 52848753, "link": "https://stackoverflow.com/questions/52848753/custom-order-sort", "title": "Custom order sort", "body": "<p>Hi I would like to sort the whole C column based on the values(Critical, high, medium,low). I am running this code on macro enabled worksheet</p>\n\n<p>Here is my code.</p>\n\n<pre><code>Sub run()\nRange(\"C:C\").Sort Key1:=Range(\"C1\"), SortOn:=xlSortOnValues, Order:=xlAscending, CustomOrder:=\"Critical,High,Medium,Low\", DataOption:=xlSortNormal\nEnd Sub\n</code></pre>\n\n<p>It did not work as there is error indicated. No argument. What is the solution to correct this problem? Thank you.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "edited": false, "score": 2, "creation_date": 1539759159, "post_id": 52848684, "comment_id": 92613437, "body": "On which line do you get the error ?"}, {"owner": {"reputation": 3, "user_id": 8145092, "user_type": "registered", "profile_image": "https://graph.facebook.com/1497661356920684/picture?type=large", "display_name": "Faisal Abraham", "link": "https://stackoverflow.com/users/8145092/faisal-abraham"}, "reply_to_user": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "edited": false, "score": 0, "creation_date": 1539835495, "post_id": 52848684, "comment_id": 92647313, "body": "from rng.Cells(i, 1).Copy extwb.Worksheets(&quot;PAID&quot;).Cells(lastRow, 1)"}], "answers": [{"comments": [{"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "reply_to_user": {"reputation": 3, "user_id": 8145092, "user_type": "registered", "profile_image": "https://graph.facebook.com/1497661356920684/picture?type=large", "display_name": "Faisal Abraham", "link": "https://stackoverflow.com/users/8145092/faisal-abraham"}, "edited": false, "score": 0, "creation_date": 1539844580, "post_id": 52850711, "comment_id": 92649985, "body": "Then troubleshoot that line where you set the last row."}], "tags": [], "owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "is_accepted": true, "score": 0, "last_activity_date": 1539765880, "creation_date": 1539765880, "answer_id": 52850711, "question_id": 52848684, "link": "https://stackoverflow.com/questions/52848684/got-an-error-1004-we-can-do-that-to-a-merged-cell-why/52850711#52850711", "title": "got an error 1004: we can do that to a merged cell.. why?", "body": "<p>You have merged cells in <code>extwb.Worksheets(\"PAID\")</code> that you're trying to paste in. </p>\n\n<p>That's not going to work - The <code>.Copy</code> source needs to be the same size, i.e. if two cells are merged in the destination range, you need to have two merged cells in the source range.</p>\n\n<p>You can resolve this by doing:</p>\n\n<pre><code>extwb.Worksheets(\"PAID\").Range(\"A\" &amp; lastRow &amp; \":E\" &amp; lastrow).Unmerge\nrng.Cells(i, 1).Copy extwb.Worksheets(\"PAID\").Cells(lastRow, 1)\nrng.Cells(i, 2).Copy extwb.Worksheets(\"PAID\").Cells(lastRow, 2)\nrng.Cells(i, 3).Copy extwb.Worksheets(\"PAID\").Cells(lastRow, 3)\nrng.Cells(i, 4).Copy extwb.Worksheets(\"PAID\").Cells(lastRow, 4)\nrng.Cells(i, 5).Copy extwb.Worksheets(\"PAID\").Cells(lastRow, 5)\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8145092, "user_type": "registered", "profile_image": "https://graph.facebook.com/1497661356920684/picture?type=large", "display_name": "Faisal Abraham", "link": "https://stackoverflow.com/users/8145092/faisal-abraham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 733, "favorite_count": 0, "accepted_answer_id": 52850711, "answer_count": 1, "score": -2, "last_activity_date": 1593579975, "creation_date": 1539758455, "last_edit_date": 1593579975, "question_id": 52848684, "link": "https://stackoverflow.com/questions/52848684/got-an-error-1004-we-can-do-that-to-a-merged-cell-why", "title": "got an error 1004: we can do that to a merged cell.. why?", "body": "<p>got an <strong>Error 1004:</strong> <strong>we can do that to a merged cell</strong>..</p>\n<p>Why ?</p>\n<p>How can I fix it ?</p>\n<p>I want to copy cell in twb to extwb...</p>\n<p>This code be like = run -&gt; got an error -&gt; reset macro -&gt; run again -&gt; it work</p>\n<pre><code>Sub Ke1()\n\nDim twb As Workbook\nDim extwb As Workbook\nDim rng As Range\nDim i As Long\nDim lastRow As Long\nlastRow = Cells(Rows.Count, 1).End(xlUp).Row + 1\n\n\nSet twb = Workbooks.Open(&quot;C:\\Users\\faisal.abraham\\Documents\\Faisal\\Travel\\CCCPU030732017.xlsx&quot;)\nSet extwb = Workbooks.Open(&quot;C:\\Users\\faisal.abraham\\Documents\\Faisal\\Travel\\CCCPU030732018.xlsx&quot;)\n'Set twb = Application.Workbooks(&quot;CCCPU030732017.xlsx&quot;)\n'Set extwb = Application.Workbooks(&quot;CCCPU030732018.xlsx&quot;)\n\nSet rng = twb.Worksheets(&quot;PAID&quot;).Range(&quot;A1:E500&quot;)\nFor i = 5 To rng.Cells(Rows.Count, 2).End(xlUp).Row\n\n    rng.Cells(i, 1).Copy extwb.Worksheets(&quot;PAID&quot;).Cells(lastRow, 1)\n    rng.Cells(i, 2).Copy extwb.Worksheets(&quot;PAID&quot;).Cells(lastRow, 2)\n    rng.Cells(i, 3).Copy extwb.Worksheets(&quot;PAID&quot;).Cells(lastRow, 3)\n    rng.Cells(i, 4).Copy extwb.Worksheets(&quot;PAID&quot;).Cells(lastRow, 4)\n    rng.Cells(i, 5).Copy extwb.Worksheets(&quot;PAID&quot;).Cells(lastRow, 5)\n      \n    lastRow = lastRow + 1\n    \nNext i\n\ntwb.Close savechanges:=False\nextwb.Saved = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "reply_to_user": {"reputation": 1, "user_id": 10512139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/327cb92164f4bfef7834e15857fa552e?s=128&d=identicon&r=PG&f=1", "display_name": "Aravind SR", "link": "https://stackoverflow.com/users/10512139/aravind-sr"}, "edited": false, "score": 0, "creation_date": 1539861230, "post_id": 52850164, "comment_id": 92658916, "body": "@Aravind SR if the above answer is what you are looking for please vote this answer is usefull by pressing the upper arrow above 0 next to the answer.thanks a lot!"}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1539763900, "creation_date": 1539763900, "answer_id": 52850164, "question_id": 52848597, "link": "https://stackoverflow.com/questions/52848597/to-input-date-between-start-and-end-date/52850164#52850164", "title": "to input date between start and end date", "body": "<p>It s difficult to understand what do you mean but you can try this:</p>\n\n<pre><code>Sub test3()\n\nDim Startdate As Date, EndDate As Date, AdditionalDate As String\nDim DatesDiff As Integer\nDim i As Integer\nDim LastRowA As Long\n\nStartdate = Format(CDate(\"01/01/12\"), \"DD/MM/YYYY\")\nEndDate = Format(CDate(\"01/04/12\"), \"DD/MM/YYYY\")\n\nIf Sheet1.Range(\"A1\").Value = \"\" Then\n    Sheet1.Range(\"A1\").Value = Startdate\nElse\n    LastRowA = Sheet1.Cells(Sheet1.Rows.Count, \"A\").End(xlUp).Row\n    Sheet1.Range(\"A\" &amp; LastRowA + 1).Value = Startdate\nEnd If\n\nDatesDiff = Month(EndDate) - Month(Startdate) - 1\n\nFor i = 1 To DatesDiff\n    AdditionalDate = Left(CStr(Startdate), 2) &amp; \"/\" &amp; (Month(CStr(Startdate)) + i) &amp; \"/\" &amp; Right(CStr(Startdate), 4)\n    LastRowA = Sheet1.Cells(Sheet1.Rows.Count, \"A\").End(xlUp).Row\n    Sheet1.Range(\"A\" &amp; LastRowA + 1).Value = CDate(AdditionalDate) 'Format(CDate(AdditionalDate), \"DD/MM/YYYY\")\nNext i\n    LastRowA = Sheet1.Cells(Sheet1.Rows.Count, \"A\").End(xlUp).Row\n    Sheet1.Range(\"A\" &amp; LastRowA + 1).Value = EndDate\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10512139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/327cb92164f4bfef7834e15857fa552e?s=128&d=identicon&r=PG&f=1", "display_name": "Aravind SR", "link": "https://stackoverflow.com/users/10512139/aravind-sr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 118, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1591644522, "creation_date": 1539758088, "last_edit_date": 1591644522, "question_id": 52848597, "link": "https://stackoverflow.com/questions/52848597/to-input-date-between-start-and-end-date", "title": "to input date between start and end date", "body": "<p>I have a method to input a start and end date using user form. How can I input the dates in between this start and end date and provide it as an input in excel sheet using <code>VBA</code>?</p>\n\n<p>For example, if my <strong>start date</strong> <code>1st jan 2012</code> and my <strong>end date</strong> is <code>1st april 2012</code>, I would like to get input in an <code>excel sheet</code> in this form :</p>\n\n<pre><code>1st jan 2012\n1st feb 2012\n1st march 2012\n1st april 2012\n</code></pre>\n\n<p>Please, suggest me a VBA code to do the same.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1539756558, "post_id": 52847967, "comment_id": 92612266, "body": "show your code attempts"}], "answers": [{"tags": [], "owner": {"reputation": 2397, "user_id": 9038475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b7f74f49de917e716f4d679473e70f4?s=128&d=identicon&r=PG&f=1", "display_name": "Geshode", "link": "https://stackoverflow.com/users/9038475/geshode"}, "is_accepted": true, "score": 0, "last_activity_date": 1539755722, "creation_date": 1539755722, "answer_id": 52848096, "question_id": 52847967, "link": "https://stackoverflow.com/questions/52847967/changing-row-data-to-column-data-vba/52848096#52848096", "title": "Changing row data to column data vba", "body": "<p>If you want to do it programmatically, you can use the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheetfunction.transpose\" rel=\"nofollow noreferrer\"><code>transpose</code></a> method in Excel VBA.</p>\n\n<p>If you want to do it manually inside Excel, you can do the following:</p>\n\n<ul>\n<li>Select and copy the original data.</li>\n<li>Select the first cell of the destination range.</li>\n<li>Right click the destination cell and choose <strong>Paste Special</strong> in which you can choose <strong>Transpose</strong>.</li>\n</ul>\n"}], "owner": {"reputation": 13, "user_id": 9600798, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "rafcioz", "link": "https://stackoverflow.com/users/9600798/rafcioz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 52848096, "answer_count": 1, "score": 0, "last_activity_date": 1539759075, "creation_date": 1539755071, "last_edit_date": 1539759075, "question_id": 52847967, "link": "https://stackoverflow.com/questions/52847967/changing-row-data-to-column-data-vba", "title": "Changing row data to column data vba", "body": "<p>I have simple question. I need to transform data from example A1 to lastcolumn in sheet1 to from a1 to lastrow in existing sheet2 (by VBA). Can anyone help me with that? I've been working on huge VBA code (for me) and I cannot proceed with that simple thing. Thanks!</p>\n\n<p><a href=\"https://i.stack.imgur.com/NZEjC.png\" rel=\"nofollow noreferrer\">https://i.stack.imgur.com/NZEjC.png</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/GBpky.png\" rel=\"nofollow noreferrer\">https://i.stack.imgur.com/GBpky.png</a> </p>\n\n<pre><code>Sheets(\"sheet1\").Select\nRange(\"C1:ADI1\").Select\nSelection.Copy\nSheets(\"raportPDF\").Select\nRange(\"B6\").Select\nSelection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _\n    False, Transpose:=True\nApplication.CutCopyMode = False\nSelection.UnMerge\nSelection.SpecialCells(xlCellTypeBlanks).Select\nSelection.Delete Shift:=xlUp\n</code></pre>\n"}, {"tags": ["sql", "vba"], "comments": [{"owner": {"reputation": 186087, "user_id": 575376, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/LnDUq.gif?s=128&g=1", "display_name": "juergen d", "link": "https://stackoverflow.com/users/575376/juergen-d"}, "edited": false, "score": 1, "creation_date": 1539753628, "post_id": 52847712, "comment_id": 92611277, "body": "Have you tried <code>VALUES (&#39;01&#47;09&#47;2018&#39;, 353660, &#39;BRUIN NOEL&#39;, &#39;Employer&#39;, -694.58, &#39;open&#39;)</code>?"}, {"owner": {"reputation": 1, "user_id": 10516595, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216039783601121/picture?type=large", "display_name": "Roen P. Malubay", "link": "https://stackoverflow.com/users/10516595/roen-p-malubay"}, "edited": false, "score": 0, "creation_date": 1539753740, "post_id": 52847712, "comment_id": 92611313, "body": "yes, I tried also to update one data first and it is having error."}, {"owner": {"reputation": 1, "user_id": 10516595, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216039783601121/picture?type=large", "display_name": "Roen P. Malubay", "link": "https://stackoverflow.com/users/10516595/roen-p-malubay"}, "edited": false, "score": 0, "creation_date": 1539753752, "post_id": 52847712, "comment_id": 92611319, "body": "Error: Syntax Error"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1539753803, "post_id": 52847712, "comment_id": 92611329, "body": "[Contribution Month] if the field name has spaces"}, {"owner": {"reputation": 472, "user_id": 6899593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/000e1cc8d4874fb425a2508604baac39?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamad", "link": "https://stackoverflow.com/users/6899593/mohamad"}, "edited": false, "score": 0, "creation_date": 1539753903, "post_id": 52847712, "comment_id": 92611366, "body": "Try to use OPENROWSET. <a href=\"https://stackoverflow.com/questions/15822576/excel-into-sql-server-with-microsoft-ace-oledb-12-0\" title=\"excel into sql server with microsoft ace oledb 12 0\">stackoverflow.com/questions/15822576/&hellip;</a> Hope this can help you!"}, {"owner": {"reputation": 1, "user_id": 10516595, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216039783601121/picture?type=large", "display_name": "Roen P. Malubay", "link": "https://stackoverflow.com/users/10516595/roen-p-malubay"}, "edited": false, "score": 0, "creation_date": 1539753903, "post_id": 52847712, "comment_id": 92611367, "body": "ok. let me try that one!"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1539753957, "post_id": 52847712, "comment_id": 92611386, "body": "<a href=\"https://stackoverflow.com/questions/45329909/insert-data-from-one-excel-file-to-another-one-using-adodb\" title=\"insert data from one excel file to another one using adodb\">stackoverflow.com/questions/45329909/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 669, "user_id": 5093463, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CB12B4rFIYs/AAAAAAAAAAI/AAAAAAAADi4/b-c7Kwra3OM/photo.jpg?sz=128", "display_name": "M. Mohabbati", "link": "https://stackoverflow.com/users/5093463/m-mohabbati"}, "is_accepted": false, "score": 0, "last_activity_date": 1539757695, "last_edit_date": 1539757695, "creation_date": 1539756846, "answer_id": 52848328, "question_id": 52847712, "link": "https://stackoverflow.com/questions/52847712/insert-data-into-excel-file-using-sql/52848328#52848328", "title": "Insert Data into Excel File using SQL", "body": "<p>Try the follwing code:</p>\n\n<pre><code>INSERT INTO  [Sheet1$] ([Contribution Month], [Serial], [Name], [Contributions Type], [Amount], [Status]) \nVALUES ('01/09/2018', 353660, 'BRUIN NOEL', 'Employer', -694.58, 'open')\n</code></pre>\n\n<p>There are some characters missing. For sheet name <code>[]</code>, field name <code>[]</code> and their <code>''</code> string value.</p>\n"}], "owner": {"reputation": 1, "user_id": 10516595, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216039783601121/picture?type=large", "display_name": "Roen P. Malubay", "link": "https://stackoverflow.com/users/10516595/roen-p-malubay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1539757695, "creation_date": 1539753471, "last_edit_date": 1539753604, "question_id": 52847712, "link": "https://stackoverflow.com/questions/52847712/insert-data-into-excel-file-using-sql", "title": "Insert Data into Excel File using SQL", "body": "<p>Im using SQL statement to insert some date in excel. but got error.</p>\n\n<p>I tried</p>\n\n<pre><code>INSERT INTO  Sheet1$ (Contribution Month, Serial, Name, Contributions Type, Amount, Status) \nVALUES (01/09/2018, 353660, BRUIN NOEL, Employer, -694.58, open)\n\nINSERT INTO  Sheet1 (Contribution Month, Serial, Name, Contributions Type, Amount, Status) \nVALUES (01/09/2018, 353660, BRUIN NOEL, Employer, -694.58, open)\n\nINSERT INTO  Sheet1$ (Contribution Month, Serial, Name, Contributions Type, Amount, Status) \nVALUES ('01/09/2018', '353660', 'BRUIN NOEL', 'Employer', '-694.58', 'open')\n\nINSERT INTO  Sheet1 (Contribution Month, Serial, Name, Contributions Type, Amount, Status) \nVALUES ('01/09/2018', '353660', 'BRUIN NOEL', 'Employer', '-694.58', 'open')\n</code></pre>\n\n<p>Any corrections?</p>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 2868, "user_id": 2582968, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BKlgI.png?s=128&g=1", "display_name": "Jan", "link": "https://stackoverflow.com/users/2582968/jan"}, "edited": false, "score": 0, "creation_date": 1539750838, "post_id": 52847302, "comment_id": 92610499, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/42837959/loop-through-rows-and-columns-excel-macro-vba\">Loop through rows and columns Excel Macro VBA</a>"}, {"owner": {"reputation": 2868, "user_id": 2582968, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BKlgI.png?s=128&g=1", "display_name": "Jan", "link": "https://stackoverflow.com/users/2582968/jan"}, "edited": false, "score": 0, "creation_date": 1539750901, "post_id": 52847302, "comment_id": 92610512, "body": "you ask two different questions at once, which isn&#39;t what you should do here.  please look at this guide <a href=\"https://stackoverflow.com/help/how-to-ask\">how to ask good questions</a>."}], "owner": {"reputation": 9, "user_id": 10516427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29471b499f603ddd1c994226b6d78626?s=128&d=identicon&r=PG&f=1", "display_name": "okayokay", "link": "https://stackoverflow.com/users/10516427/okayokay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1539772153, "creation_date": 1539750492, "last_edit_date": 1539772153, "question_id": 52847302, "link": "https://stackoverflow.com/questions/52847302/excel-vba-to-loop-through-cell-column-and-paste-in-word", "title": "Excel VBA to loop through cell column and paste in word", "body": "<p><strong>What I've done so far :-</strong><br>\n1. VBA script to open a template word document. copy the value from column(A1) and paste it in a word document by using the find function.<br>\n2. I have done this with two columns for two different locations in a word document.<br>\n3. Then, I have saved the document using the value from column(A1).</p>\n\n<p><strong>What I wish to do:-</strong><br>\n1. Right now, this runs only for one word document.<br>\n2. I wish to run a loop such that I can copy each row into a word document, save it and move onto the next row and save the template word document with a unique name(i.e, from column A)<br>\n3. based on the code below, I'm guessing I need two loops, I just can't figure it out and would love some help.</p>\n\n<p>Code I've written so far:-\n1. some of them return the function call and didn't think it would be useful, thus I didn't paste it.</p>\n\n<pre><code>Set appWd = CreateObject(\"Word.Application\")\nappWd.Visible = True\nSet docWD = appWd.Documents.Open(\"C:\\Users\\Draft.docx\")\n\n'Select Sheet where copying from in excel\nSet sheet1 = Sheets(\"Sheet1\")\nSet wdFind = appWd.Selection.Find\nClipT = \"  \"\nClipEmpty.SetText ClipT\n\nsheet1.Range(\"A1\").Copy\nwdFind.Text = \"DateHere\"\nCall FormatPaste\n\nsheet1.Range(\"B1\").Copy\nwdFind.Text = \"EntryHere\"\nCall FormatPaste\n\nsaveCell1 = sheet1.Range(\"B1\").Text\ndir2 = \"C:\\Users\\\" &amp; saveCell1\ndocWD.SaveAs (dir2 &amp; \".docx\")\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 865, "user_id": 10361731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8873db235bacaa9d53de9c31a0b8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Jchang43", "link": "https://stackoverflow.com/users/10361731/jchang43"}, "edited": false, "score": 0, "creation_date": 1539750824, "post_id": 52847222, "comment_id": 92610493, "body": "if you use value it should still read it as week 2. It could be because you haven&#39;t fully specified what book and sheet the Range you want to look at is in. When you don&#39;t specify it assumes you mean the active sheet."}], "answers": [{"tags": [], "owner": {"reputation": 1205, "user_id": 8578580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a063b2c15a5847791ed1e0007d04b8c0?s=128&d=identicon&r=PG&f=1", "display_name": "TechnoDabbler", "link": "https://stackoverflow.com/users/8578580/technodabbler"}, "is_accepted": true, "score": 1, "last_activity_date": 1539751791, "last_edit_date": 1539751791, "creation_date": 1539751462, "answer_id": 52847433, "question_id": 52847222, "link": "https://stackoverflow.com/questions/52847222/take-value-from-cell-to-vba/52847433#52847433", "title": "Take Value From Cell to VBA", "body": "<p>As @Brotato says, define the range explicitly (for example):</p>\n\n<pre><code>Option Explicit\n\nPublic Sub CheckA1()\n\n    If ActiveWorkbook.Worksheets(\"Sheet1\").Range(\"A1\").Value = \"Week 2\" Then\n        MsgBox \"It is Week 2\"\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Which would result in ...</p>\n\n<p><a href=\"https://i.stack.imgur.com/oLFM0.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oLFM0.jpg\" alt=\"screen1\"></a></p>\n"}], "owner": {"reputation": 17, "user_id": 10253649, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-aga5_L0lPMs/AAAAAAAAAAI/AAAAAAAAALU/UPUHKix2sA8/photo.jpg?sz=128", "display_name": "Yohanes Lim", "link": "https://stackoverflow.com/users/10253649/yohanes-lim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "accepted_answer_id": 52847433, "answer_count": 1, "score": 1, "last_activity_date": 1593677329, "creation_date": 1539749881, "last_edit_date": 1593677329, "question_id": 52847222, "link": "https://stackoverflow.com/questions/52847222/take-value-from-cell-to-vba", "title": "Take Value From Cell to VBA", "body": "<p>i'm having an issue using Range.Value/Value2/Text</p>\n\n<p>For Ex:\nCell A1 Contains IF Formula and resulted = Week 2</p>\n\n<p>in my VBA i want to loop according to Week that contains in A1</p>\n\n<p>so my code will be like:</p>\n\n<pre><code>Dim a as Integer\nIf (Range(\"A1\").Text = \"Week 2\") Then\n    a = 4\nEnd if\n</code></pre>\n\n<p>using .text or .value or .value2 returns nothing. so variable a is equal zero</p>\n\n<p>any idea how to take this value?</p>\n"}, {"tags": ["database", "ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "is_accepted": true, "score": 1, "last_activity_date": 1539743527, "creation_date": 1539743527, "answer_id": 52846467, "question_id": 52846438, "link": "https://stackoverflow.com/questions/52846438/set-control-property-after-opening-a-form-on-a-specific-record/52846467#52846467", "title": "Set Control Property after opening a form on a specific record", "body": "<p>Don't open in Dialog mode, the code after DoCmd works only when the form is closed. Change the <code>Modal</code> property of the form to <code>Yes</code> instead.</p>\n\n<pre><code>Private Sub Text23_Click()\n    DoCmd.OpenForm \"FrmEntregas\", acNormal, \"\", \"[EntregasID]=\" &amp; Nz(CodeContextObject.EntregasID, 0), acEdit\n    Forms(\"FrmEntregas\").btnReiniciar.Visible = False\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 10136705, "user_type": "registered", "profile_image": "https://graph.facebook.com/1854641374581546/picture?type=large", "display_name": "Christian Andres", "link": "https://stackoverflow.com/users/10136705/christian-andres"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 52846467, "answer_count": 1, "score": 0, "last_activity_date": 1539850051, "creation_date": 1539743132, "last_edit_date": 1539850051, "question_id": 52846438, "link": "https://stackoverflow.com/questions/52846438/set-control-property-after-opening-a-form-on-a-specific-record", "title": "Set Control Property after opening a form on a specific record", "body": "<p>Im new to Access and need some help. D:\nSo I have a form in datasheet view which displays basic information of all the records from a query. By pressing a text field at the end of each record it opens another form in edit mode with the details of that specific record.</p>\n\n<p>But after it opens I want to disable or hide some fields and controls including a button which clears all the fields in the form so that users can't press it accidentally and erase all Information in the form.\nI've tried this code:</p>\n\n<pre><code>Private Sub Text23_Click()\n\n    DoCmd.OpenForm \"FrmEntregas\", acNormal, \"\", \"[EntregasID]=\" &amp; Nz(CodeContextObject.EntregasID, 0), acEdit, acDialog\n\n    'Forms(\"FrmEntregas\").btnReiniciar.Visible = False\n    'Forms!FrmEntregas!btnReiniciar.Visible = False\n    'Forms(\"FrmEntregas\").Form.Controls(btnReiniciar).Visible = False\n\nEnd Sub\n</code></pre>\n\n<p>The first line works great, the problem comes when refering to the form's button. I've tried refering to the button in three different ways but none of them work. It displays this message: </p>\n\n<p>\"Runtime Error 2450: Microsoft Access cannot find the referenced form 'FrmEntregas'.\"</p>\n\n<p>If someone could point me in the right direction I'd be more than thankful!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1553, "user_id": 7806300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/S7U65.jpg?s=128&g=1", "display_name": "addohm", "link": "https://stackoverflow.com/users/7806300/addohm"}, "edited": false, "score": 0, "creation_date": 1539742837, "post_id": 52846366, "comment_id": 92608734, "body": "<code>if not ele = &quot;th&quot; then ........... End if R = R + 1 Next</code>  Just throwing that out there."}, {"owner": {"reputation": 91, "user_id": 5078821, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cae5cc7cc5f7efe7e1711c14599f63ca?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan", "link": "https://stackoverflow.com/users/5078821/ryan"}, "reply_to_user": {"reputation": 1553, "user_id": 7806300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/S7U65.jpg?s=128&g=1", "display_name": "addohm", "link": "https://stackoverflow.com/users/7806300/addohm"}, "edited": false, "score": 0, "creation_date": 1539743666, "post_id": 52846366, "comment_id": 92608889, "body": "OK, just tried that, am I missing extra components to that because it&#39;s still erroring out. Thank you."}, {"owner": {"reputation": 1553, "user_id": 7806300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/S7U65.jpg?s=128&g=1", "display_name": "addohm", "link": "https://stackoverflow.com/users/7806300/addohm"}, "edited": false, "score": 0, "creation_date": 1539743917, "post_id": 52846366, "comment_id": 92608955, "body": "I really don&#39;t know.  What is the error?  Why don&#39;t you catch the error and let us know what it is?"}, {"owner": {"reputation": 91, "user_id": 5078821, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cae5cc7cc5f7efe7e1711c14599f63ca?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan", "link": "https://stackoverflow.com/users/5078821/ryan"}, "reply_to_user": {"reputation": 1553, "user_id": 7806300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/S7U65.jpg?s=128&g=1", "display_name": "addohm", "link": "https://stackoverflow.com/users/7806300/addohm"}, "edited": false, "score": 0, "creation_date": 1539744004, "post_id": 52846366, "comment_id": 92608975, "body": "Run-time error &#39;424&#39;: Object required. This occurs on the WSW.Range(&quot;I&quot; &amp; R).Value = ele.Children(1).textContent line since there is a th that has a colspan of 2. The if statement isn&#39;t triggering it seems."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1539745112, "post_id": 52846366, "comment_id": 92609237, "body": "Can you post a picture of the html?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1539762336, "post_id": 52846366, "comment_id": 92615092, "body": "Can you share the html using the snippet tool via <a href=\"https://stackoverflow.com/posts/52846366/edit\">edit</a> ? And are you after everything in the table including headers? There has to be a better way to be honest."}], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 5078821, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cae5cc7cc5f7efe7e1711c14599f63ca?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan", "link": "https://stackoverflow.com/users/5078821/ryan"}, "edited": false, "score": 0, "creation_date": 1539751035, "post_id": 52846858, "comment_id": 92610553, "body": "Excellent, this is it. I had to make one small tweak which was the &quot;td&quot;s in your solution should be &quot;tr&quot;s since it goes tbody-&gt;tr-&gt;td and it&#39;s the children of the tr&#39;s I&#39;m after. Simple fix though and much appreciated. I&#39;ll mark your answer as the solution."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 3, "last_activity_date": 1539746711, "creation_date": 1539746711, "answer_id": 52846858, "question_id": 52846366, "link": "https://stackoverflow.com/questions/52846366/excel-vba-for-loop-need-to-skip-first-element-in-web-scrape/52846858#52846858", "title": "Excel VBA - For Loop Need To Skip First Element In Web Scrape", "body": "<p>The index of getElementsByTagName is zero to <em>n</em> based but the count (aka .length) is one to <em>n</em> based. You use R as the index reference so it does double duty. </p>\n\n<pre><code>dim R as long\nR = 1\n\nFor R=1 to  IE.Document.getElementsByTagName(\"tbody\")(13).getElementsByTagName(\"td\").length -1\n\n    with IE.Document.getElementsByTagName(\"tbody\")(13).getElementsByTagName(\"td\")(R)\n        WSW.Range(\"H\" &amp; R).Value = .Children(0).textContent\n        WSW.Range(\"I\" &amp; R).Value = .Children(1).textContent\n    end with\n\nNext R\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 5078821, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cae5cc7cc5f7efe7e1711c14599f63ca?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan", "link": "https://stackoverflow.com/users/5078821/ryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 229, "favorite_count": 0, "accepted_answer_id": 52846858, "answer_count": 1, "score": 1, "last_activity_date": 1593677341, "creation_date": 1539742393, "last_edit_date": 1593677341, "question_id": 52846366, "link": "https://stackoverflow.com/questions/52846366/excel-vba-for-loop-need-to-skip-first-element-in-web-scrape", "title": "Excel VBA - For Loop Need To Skip First Element In Web Scrape", "body": "<p>I'm fairly new/inexperienced at VBA and I'm (seemingly) one small step from finishing a project that been kicking my butt. For some background, I'm scraping a website and navigating to the appropriate \"tbody\" tag and iterating through the encompassed \"tr\" tags. In each tr I am expecting two \"td\" cells. The problem is the first tr has a \"th\" tag with a colspan of 2, meaning obviously there is only one child in that tr and the code crashes out. What I don't (yet) know how to do is to skips or account for the exception in the first tr. Here is the relevant snippet of the code:</p>\n\n<pre><code>R = 1\n\nFor Each ele In IE.Document.getElementsByTagName(\"tbody\")(13).getElementsByTagName(\"td\")\n\n\nWSW.Range(\"H\" &amp; R).Value = ele.Children(0).textContent\nWSW.Range(\"I\" &amp; R).Value = ele.Children(1).textContent\n\nR = R + 1\n\nNext\n</code></pre>\n\n<p>Not sure if I've walked myself down a rabbit hole, if the code is salvageable, or if the slate for this section of the code should be recreated. Thank you for any help. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 103, "user_id": 10068582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0246d2ec38d248d21d3259213e14625d?s=128&d=identicon&r=PG&f=1", "display_name": "Abdullah Naina", "link": "https://stackoverflow.com/users/10068582/abdullah-naina"}, "edited": false, "score": 0, "creation_date": 1539740903, "post_id": 52846081, "comment_id": 92608404, "body": "I thought the solution was to only reset the loop when the condition is met. I should expand my mind to find other solutions. Thank for the great solution."}], "answers": [{"tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": true, "score": 1, "last_activity_date": 1539745854, "last_edit_date": 1539745854, "creation_date": 1539740331, "answer_id": 52846156, "question_id": 52846081, "link": "https://stackoverflow.com/questions/52846081/reset-the-loop-when-the-condition-is-met-excel-vba/52846156#52846156", "title": "Reset the loop when the condition is met excel vba", "body": "<p>You <strong>do not</strong> need to reset the loop if you want to look in Columns <code>A:Q</code> in the first row. The key is to avoid deleting while you are inside the loop since this creates shifts in the range you are looping through. </p>\n\n<p>The below solution will loop through your range and add target cells to a <code>Union</code> (collection of cells) and once the loop is complete, it will delete the columns of all cells in the <code>Union</code></p>\n\n<hr>\n\n<h2>Also,</h2>\n\n<p>Add <code>Option Explicit</code>. You need to declare your variables and <code>Option Explicit</code> will force you to do so. This also indirectly acts as a handy spell checker. </p>\n\n<p>Last thing: I changed your variable '<code>cell</code>' to '<code>myCell</code>' to avoid confusion with the already existing object <code>Cells</code></p>\n\n<hr>\n\n<pre><code>Option Explicit\n\nSub run()\n\nDim MR As Range, myCell As Range, DeleteMe As Range\n\nSet MR = Range(\"A1:Q1\")\n\nFor Each myCell In MR\n    If myCell = \"First Discovered\" Or myCell = \"Last Observed\" Then\n        If DeleteMe Is Nothing Then\n            Set DeleteMe = myCell\n        Else\n            Set DeleteMe = Union(DeleteMe, myCell)\n        End If\n    End If\nNext myCell\n\nIf Not DeleteMe Is Nothing Then DeleteMe.EntireColumn.Delete\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 10068582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0246d2ec38d248d21d3259213e14625d?s=128&d=identicon&r=PG&f=1", "display_name": "Abdullah Naina", "link": "https://stackoverflow.com/users/10068582/abdullah-naina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 540, "favorite_count": 0, "accepted_answer_id": 52846156, "answer_count": 1, "score": 0, "last_activity_date": 1539745854, "creation_date": 1539739622, "question_id": 52846081, "link": "https://stackoverflow.com/questions/52846081/reset-the-loop-when-the-condition-is-met-excel-vba", "title": "Reset the loop when the condition is met excel vba", "body": "<p>I have an excel sheet. I want to reset the loop when the condition is met as I have two conditions. However, I thought of implementing step next to the for loop from this solution website, <a href=\"https://stackoverflow.com/questions/35047024/reset-a-for-loop-when-a-condition-is-met-vba\">Reset a for loop when a condition is met vba</a>. It did not work as it applied to only numbers not A1. What is the solutions to correct this problem? Thank you.</p>\n\n<pre><code>Sub run()\n Set MR = Range(\"A1:Q1\")\n    'Loop through the cell in the first row\n    For Each cell In MR\n        If cell.Value = \"First Discovered\" Or cell.Value = \"Last Observed\" Then cell.EntireColumn.Delete\n    Next cell\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1539745801, "post_id": 52845767, "comment_id": 92609379, "body": "You only need to use End(xlUp) once, and then all other values should go on that same row: don&#39;t run it separately in each column.  You need to pick a column which will have no blanks though."}, {"owner": {"reputation": 29, "user_id": 10236952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bffb6ebe98dfcd55723966ff11571eea?s=128&d=identicon&r=PG&f=1", "display_name": "user10236952", "link": "https://stackoverflow.com/users/10236952/user10236952"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1539746218, "post_id": 52845767, "comment_id": 92609484, "body": "meaning, if i specified column A to use the end(xlUp), then i need to delete it from other column?"}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 10236952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bffb6ebe98dfcd55723966ff11571eea?s=128&d=identicon&r=PG&f=1", "display_name": "user10236952", "link": "https://stackoverflow.com/users/10236952/user10236952"}, "edited": false, "score": 0, "creation_date": 1539744140, "post_id": 52846405, "comment_id": 92609005, "body": "Hi, it has compile error that said expected, &quot;List separator or ).  for line columnToAppendTo"}, {"owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "reply_to_user": {"reputation": 29, "user_id": 10236952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bffb6ebe98dfcd55723966ff11571eea?s=128&d=identicon&r=PG&f=1", "display_name": "user10236952", "link": "https://stackoverflow.com/users/10236952/user10236952"}, "edited": false, "score": 0, "creation_date": 1539744500, "post_id": 52846405, "comment_id": 92609094, "body": "Sorry, forgot to close double quotes. And now? Does it work?"}, {"owner": {"reputation": 29, "user_id": 10236952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bffb6ebe98dfcd55723966ff11571eea?s=128&d=identicon&r=PG&f=1", "display_name": "user10236952", "link": "https://stackoverflow.com/users/10236952/user10236952"}, "edited": false, "score": 0, "creation_date": 1539744678, "post_id": 52846405, "comment_id": 92609134, "body": "Oh wait. I&#39;ll try it first"}, {"owner": {"reputation": 29, "user_id": 10236952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bffb6ebe98dfcd55723966ff11571eea?s=128&d=identicon&r=PG&f=1", "display_name": "user10236952", "link": "https://stackoverflow.com/users/10236952/user10236952"}, "edited": false, "score": 0, "creation_date": 1539744878, "post_id": 52846405, "comment_id": 92609184, "body": "Hi, i got compile error for line maxLastRow, particularly the .Rows part."}, {"owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "reply_to_user": {"reputation": 29, "user_id": 10236952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bffb6ebe98dfcd55723966ff11571eea?s=128&d=identicon&r=PG&f=1", "display_name": "user10236952", "link": "https://stackoverflow.com/users/10236952/user10236952"}, "edited": false, "score": 0, "creation_date": 1539745190, "post_id": 52846405, "comment_id": 92609246, "body": "I&#39;ve changed the line to put the code after (it needed to be within the <code>With</code> block). Any luck now? I do not have access to a desktop to test at the moment, unfortunately."}, {"owner": {"reputation": 29, "user_id": 10236952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bffb6ebe98dfcd55723966ff11571eea?s=128&d=identicon&r=PG&f=1", "display_name": "user10236952", "link": "https://stackoverflow.com/users/10236952/user10236952"}, "edited": false, "score": 0, "creation_date": 1539745472, "post_id": 52846405, "comment_id": 92609318, "body": "Hi, the code can be run, but, there no data being copied, the master list is empty. I&#39;ll update the code in my question for you to see."}], "tags": [], "owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "is_accepted": false, "score": 0, "last_activity_date": 1539744778, "last_edit_date": 1539744778, "creation_date": 1539742779, "answer_id": 52846405, "question_id": 52845767, "link": "https://stackoverflow.com/questions/52845767/copying-data-from-multiple-workbook-to-one-masterfile-data-not-entered-in-the-s/52846405#52846405", "title": "Copying data from multiple workbook to one masterfile: data not entered in the same row", "body": "<p>Untested. There may be a better way to do this, but after this line:</p>\n\n<pre><code>With SummWb.Sheets(\"Master List\")\n</code></pre>\n\n<p>Put</p>\n\n<pre><code>Dim maxLastRow as long\nDim columnsToAppendTo as variant\ncolumnsToAppendTo = array(\"A\", \"B\", \"C\", \"D\", \"E\", \"I\", \"J\", \"K\", \"L\", \"M\", \"N\", \"F\")\n\nDim index as long\n\nFor index = lbound(columnsToAppendTo) to ubound(columnsToAppendTo)\n\nmaxLastRow = application.max(.cells(.Rows.Count,  columnsToAppendTo(index)).End(xlUp).row, maxLastRow)\n\nNext index\n</code></pre>\n\n<p>Then re-write the section of your code where you actually write to the master file, as such:</p>\n\n<pre><code>.Cells(maxLastRow + 1, \"A\").Value = SceWb.Sheets(\"Survey\").Range(\"B3\").Value ' Use offset instead of +1 if you need to '\n</code></pre>\n\n<p>And so forth.</p>\n\n<p>The main difference is you work out the last row across all columns first/in advance, then use that particular last row value for each column.</p>\n"}, {"comments": [{"owner": {"reputation": 29, "user_id": 10236952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bffb6ebe98dfcd55723966ff11571eea?s=128&d=identicon&r=PG&f=1", "display_name": "user10236952", "link": "https://stackoverflow.com/users/10236952/user10236952"}, "edited": false, "score": 0, "creation_date": 1539748903, "post_id": 52846910, "comment_id": 92610082, "body": "Hi, i used numbers and it move all my data. So instead of numbers, can I use the alphabet?"}, {"owner": {"reputation": 29, "user_id": 10236952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bffb6ebe98dfcd55723966ff11571eea?s=128&d=identicon&r=PG&f=1", "display_name": "user10236952", "link": "https://stackoverflow.com/users/10236952/user10236952"}, "edited": false, "score": 0, "creation_date": 1539749370, "post_id": 52846910, "comment_id": 92610196, "body": "Hi tim, thank you so much!! it works. thank you for input I learn new things today"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1539747216, "creation_date": 1539747216, "answer_id": 52846910, "question_id": 52845767, "link": "https://stackoverflow.com/questions/52845767/copying-data-from-multiple-workbook-to-one-masterfile-data-not-entered-in-the-s/52846910#52846910", "title": "Copying data from multiple workbook to one masterfile: data not entered in the same row", "body": "<p>You only need to use <code>End(xlUp)</code> once, and then all other values should go on that same row: don't run it separately in each column. You need to pick a column which will have no blanks though.</p>\n\n<p>E.g: using ColA</p>\n\n<pre><code>With SummWb.Sheets(\"Master List\").Cells(rows.count,1).end(xlup).offset(1,0).Entirerow\n    .cells(1).value = 'whatever\n    .cells(2).value = 'other value\n    'etc etc\nend with\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 10236952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bffb6ebe98dfcd55723966ff11571eea?s=128&d=identicon&r=PG&f=1", "display_name": "user10236952", "link": "https://stackoverflow.com/users/10236952/user10236952"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 52846910, "answer_count": 2, "score": -1, "last_activity_date": 1593677353, "creation_date": 1539736737, "last_edit_date": 1593677353, "question_id": 52845767, "link": "https://stackoverflow.com/questions/52845767/copying-data-from-multiple-workbook-to-one-masterfile-data-not-entered-in-the-s", "title": "Copying data from multiple workbook to one masterfile: data not entered in the same row", "body": "<p>i have a code to copy from multiple workbooks to one masterfile. but the problem here is that, there are possibilities that the datafile will contain an empty row. So everytime a new data is added, instead of being in a same row, it will moved up to fill the all the blank column. Sorry If my words are not clear, english isnt my first language. I attached the example here   </p>\n\n<p>Expected Result</p>\n\n<pre><code>A     B      C      D       E\nbb   1234    cc     \nff   3242    ff     \nfjn  7643    jk    fjnnD  fjnnE\ngwd  9754    jk    gjwdD  gjwdE\n</code></pre>\n\n<p>Result that I get</p>\n\n<pre><code>A     B      C      D       E\nbb   1234    cc     fjnnD  fjnnE\nff   3242    ff     gjwdD  gjwdE\nfjn  7643    jk    \ngwd  9754    jk    \n</code></pre>\n\n<p>Here is my code</p>\n\n<pre><code>Sub UploadData()\n\nDim SummWb As Workbook\nDim SceWb As Workbook\n\n'Get folder containing files\nWith Application.FileDialog(msoFileDialogFolderPicker)\n    .AllowMultiSelect = False\n    .Show\n    On Error GoTo Error_handler\n    myFolderName = .SelectedItems(1)\n    'Err.Clear\n    'On Error GoTo 0\nEnd With\n\nIf Right(myFolderName, 1) &lt;&gt; \"\\\" Then myFolderName = myFolderName &amp; \"\\\"\n    'Settings\n    Application.ScreenUpdating = False\n    oldStatusBar = Application.DisplayStatusBar\n    Application.DisplayStatusBar = True\n    Set SummWb = ActiveWorkbook\n    'Get source files and append to output file\n    mySceFileName = Dir(myFolderName &amp; \"*.*\")\n\n        Do While mySceFileName &lt;&gt; \"\" 'Stop once all files found\n            Application.StatusBar = \"Processing: \" &amp; mySceFileName\n            Set SceWb = Workbooks.Open(myFolderName &amp; mySceFileName) 'Open file found\n                With SummWb.Sheets(\"Master List\")\n                                     Dim maxLastRow As Long\n             Dim columnsToAppendTo As Variant\n             columnsToAppendTo = Array(\"A\", \"B\", \"C\", \"D\", \"E\", \"I\", \"J\", \"K\", \"L\", \"M\", \"N\", \"F\")\n             Dim index As Long\n\n            For index = LBound(columnsToAppendTo) To UBound(columnsToAppendTo)\n            maxLastRow = Application.Max(.Cells(.Rows.Count, columnsToAppendTo(index)).End(xlUp).Row, maxLastRow)\n            Next index\n\n                .Cells(maxLastRow + 1, \"A\").Value = SceWb.Sheets(\"Survey\").Range(\"B3\").Value\n                .Cells(maxLastRow + 1, \"C\").Value = SceWb.Sheets(\"Survey\").Range(\"B4\").Value\n                .Cells(maxLastRow + 1, \"D\").Value = SceWb.Sheets(\"Survey\").Range(\"B5\").Value\n                .Cells(maxLastRow + 1, \"E\").Value = SceWb.Sheets(\"Survey\").Range(\"B6\").Value\n                .Cells(maxLastRow + 1, \"I\").Value = SceWb.Sheets(\"Survey\").Range(\"C9\").Value\n                .Cells(maxLastRow + 1, \"J\").Value = SceWb.Sheets(\"Survey\").Range(\"D9\").Value\n                .Cells(maxLastRow + 1, \"K\").Value = SceWb.Sheets(\"Survey\").Range(\"C10\").Value\n                .Cells(maxLastRow + 1, \"L\").Value = SceWb.Sheets(\"Survey\").Range(\"D10\").Value\n                .Cells(maxLastRow + 1, \"M\").Value = SceWb.Sheets(\"Survey\").Range(\"C11\").Value\n                .Cells(maxLastRow + 1, \"N\").Value = SceWb.Sheets(\"Survey\").Range(\"D11\").Value\n                .Cells(maxLastRow + 1, \"F\").Value = SummWb.Sheets(\"Upload Survey\").Range(\"C8\").Value\n                End With\n            SceWb.Close (False) 'Close Workbook\n            mySceFileName = Dir\n\n        Loop\nMsgBox (\"Upload complete.\")\n'Settings and save output file\nApplication.StatusBar = False\nApplication.DisplayStatusBar = oldStatusBar\nSummWb.Activate\nSummWb.Save 'save automaticallly\nApplication.ScreenUpdating = True\nExit Sub\nError_handler:\nMsgBox (\"You cancelled the action.\")\n\nEnd Sub\n</code></pre>\n\n<p>I am guessing the problem is with the End(xlUp) statement. Any kind of help is much appreciated. </p>\n\n<p>edit (deleted portion of the code)</p>\n\n<pre><code>.Cells(.Rows.Count, \"A\").End(xlUp).Offset(1, 0).Value = SceWb.Sheets(\"Survey\").Range(\"B3\").Valu\n.Cells(.Rows.Count, \"C\").End(xlUp).Offset(1, 0).Value = SceWb.Sheets(\"Survey\").Range(\"B4\").Value\n.Cells(.Rows.Count, \"D\").End(xlUp).Offset(1, 0).Value = SceWb.Sheets(\"Survey\").Range(\"B5\").Value\n.Cells(.Rows.Count, \"E\").End(xlUp).Offset(1, 0).Value = SceWb.Sheets(\"Survey\").Range(\"B6\").Value\n.Cells(.Rows.Count, \"I\").End(xlUp).Offset(1, 0).Value = SceWb.Sheets(\"Survey\").Range(\"C9\").Value\n.Cells(.Rows.Count, \"J\").End(xlUp).Offset(1, 0).Value = SceWb.Sheets(\"Survey\").Range(\"D9\").Value\n.Cells(.Rows.Count, \"K\").End(xlUp).Offset(1, 0).Value = SceWb.Sheets(\"Survey\").Range(\"C10\").Value\n.Cells(.Rows.Count, \"L\").End(xlUp).Offset(1, 0).Value = SceWb.Sheets(\"Survey\").Range(\"D10\").Value\n.Cells(.Rows.Count, \"M\").End(xlUp).Offset(1, 0).Value = SceWb.Sheets(\"Survey\").Range(\"C11\").Value\n.Cells(.Rows.Count, \"N\").End(xlUp).Offset(1, 0).Value = SceWb.Sheets(\"Survey\").Range(\"D11\").Value\n.Cells(.Rows.Count, \"F\").End(xlUp).Offset(1, 0).Value = SummWb.Sheets(\"Upload Survey\").Range(\"C8\").Value\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 229, "user_id": 10305539, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vmtmrWHPM-s/AAAAAAAAAAI/AAAAAAAAAHs/x9ECcI11M9o/photo.jpg?sz=128", "display_name": "greenn", "link": "https://stackoverflow.com/users/10305539/greenn"}, "edited": false, "score": 0, "creation_date": 1539771112, "post_id": 52848045, "comment_id": 92620053, "body": "Thanks! I did not know that DoCmd.OpenReport had option to add where condition. But follwong your code gives me this error on the openreport line with the where condidiotn"}, {"owner": {"reputation": 229, "user_id": 10305539, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vmtmrWHPM-s/AAAAAAAAAAI/AAAAAAAAAHs/x9ECcI11M9o/photo.jpg?sz=128", "display_name": "greenn", "link": "https://stackoverflow.com/users/10305539/greenn"}, "edited": false, "score": 0, "creation_date": 1539771124, "post_id": 52848045, "comment_id": 92620059, "body": "&quot;this expression is typed incorrectly or it is too complex to be evaluated&quot;"}, {"owner": {"reputation": 2892, "user_id": 1935222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gx2zd.png?s=128&g=1", "display_name": "4dmonster", "link": "https://stackoverflow.com/users/1935222/4dmonster"}, "reply_to_user": {"reputation": 229, "user_id": 10305539, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vmtmrWHPM-s/AAAAAAAAAAI/AAAAAAAAAHs/x9ECcI11M9o/photo.jpg?sz=128", "display_name": "greenn", "link": "https://stackoverflow.com/users/10305539/greenn"}, "edited": false, "score": 0, "creation_date": 1539773419, "post_id": 52848045, "comment_id": 92621352, "body": "1. check if report works when opened manually 2. check if  <code>InvNum</code> is text type in query/table 3. check what is <code>WhereCondition</code> is not wrong."}], "tags": [], "owner": {"reputation": 2892, "user_id": 1935222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gx2zd.png?s=128&g=1", "display_name": "4dmonster", "link": "https://stackoverflow.com/users/1935222/4dmonster"}, "is_accepted": false, "score": 0, "last_activity_date": 1539755405, "creation_date": 1539755405, "answer_id": 52848045, "question_id": 52845720, "link": "https://stackoverflow.com/questions/52845720/problem-with-searching-the-report-with-openargs-in-access-vba/52848045#52848045", "title": "Problem with searching the report with openargs in Access VBA", "body": "<p>To open report with filtered data you can do this:</p>\n\n<ol>\n<li>In Design view for report's <code>RecordSource</code> set query with all data\n(your <code>*PRINT FINAL DATA *</code>). And save it. </li>\n<li><p>For form in click handler write this (i omit all error check &amp; etc)</p>\n\n<p><code>strInput = InputBox(\"Which value did you want to print?\")\nDoCmd.OpenReport \"01-REPORT\", acPreview, , \"InvNum = '\" &amp; strInput &amp; \"'\"</code></p></li>\n</ol>\n\n<p>The forth parameter of <code>OpenReport</code> is <code>WhereCondition</code> which filters data before doing report.</p>\n\n<p>P.S. And report asks for value of every field because your report don't have saved value in <code>RecordSource</code> when you open it. Or query have no such fields.</p>\n"}], "owner": {"reputation": 229, "user_id": 10305539, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vmtmrWHPM-s/AAAAAAAAAAI/AAAAAAAAAHs/x9ECcI11M9o/photo.jpg?sz=128", "display_name": "greenn", "link": "https://stackoverflow.com/users/10305539/greenn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 105, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1539755405, "creation_date": 1539736327, "question_id": 52845720, "link": "https://stackoverflow.com/questions/52845720/problem-with-searching-the-report-with-openargs-in-access-vba", "title": "Problem with searching the report with openargs in Access VBA", "body": "<p>I have a form  in MS Access where on button click event I have the following code running. My objective is to make a user enter a value on button click on a form and send that value to report using openargs. I wanted to add the openargs parameter in that query but when I enter a value on the inputbox and hit enter I get a prompt called \"Enter Parameter\" which asks me to enter value for all the fields in the report. I am new to VBA and don't know what I am doing wrong </p>\n\n<p><strong>Form</strong></p>\n\n<pre><code>strInput = InputBox(\"Which value did you want to print?\")\n    DoCmd.OpenReport \"01-REPORT\", acPreview, , , , OpenArgs = strInput\n</code></pre>\n\n<p><strong>Report</strong></p>\n\n<p>In my report on open report event I have</p>\n\n<pre><code> Private Sub Report_Open(Cancel As Integer)\n    If Me.OpenArgs &gt; 0 Then\n    Me.RecordSource = \"PRINT FINAL DATA WHERE \" &amp; \"InvNum = '\" &amp; Me.OpenArgs &amp; \"'\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>*PRINT FINAL DATA * is the name of a query which is the recordsource of the report.</p>\n"}, {"tags": ["excel", "vba", "debugging", "combobox"], "answers": [{"comments": [{"owner": {"reputation": 1814, "user_id": 2588953, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/7cEaY.jpg?s=128&g=1", "display_name": "Chris L", "link": "https://stackoverflow.com/users/2588953/chris-l"}, "edited": false, "score": 0, "creation_date": 1539736178, "post_id": 52845676, "comment_id": 92607385, "body": "this now gives me a different error 91: Object variable or With block variable not set"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 1814, "user_id": 2588953, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/7cEaY.jpg?s=128&g=1", "display_name": "Chris L", "link": "https://stackoverflow.com/users/2588953/chris-l"}, "edited": false, "score": 0, "creation_date": 1539736340, "post_id": 52845676, "comment_id": 92607421, "body": "Hmm. Is the workbook prfile2 open? Is <code>prfile2</code> a variable, or the workbook name? If it&#39;s the workbook name, it needs to be inside of double quotes, as well as <code>emunber</code>. So, <code>With Workbooks(&quot;prfile2&quot;).Worksheets(&quot;emunber&quot;)</code>. Adding <code>Option Explicit</code> to the top of the module would prevent this as well."}, {"owner": {"reputation": 1814, "user_id": 2588953, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/7cEaY.jpg?s=128&g=1", "display_name": "Chris L", "link": "https://stackoverflow.com/users/2588953/chris-l"}, "edited": false, "score": 0, "creation_date": 1539736434, "post_id": 52845676, "comment_id": 92607437, "body": "the workbook is open and yes those are variables for the workbook and worksheet.  there is no error for the checktotal line just before this line"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 1814, "user_id": 2588953, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/7cEaY.jpg?s=128&g=1", "display_name": "Chris L", "link": "https://stackoverflow.com/users/2588953/chris-l"}, "edited": false, "score": 0, "creation_date": 1539736576, "post_id": 52845676, "comment_id": 92607463, "body": "Okay, then is the variable <code>emunber</code> of the datatype <b>String</b> or datatype <b>Worksheet</b>? What does the line look like when you assign <code>emunber</code>&#39;s value/object?"}, {"owner": {"reputation": 1814, "user_id": 2588953, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/7cEaY.jpg?s=128&g=1", "display_name": "Chris L", "link": "https://stackoverflow.com/users/2588953/chris-l"}, "edited": false, "score": 0, "creation_date": 1539736776, "post_id": 52845676, "comment_id": 92607510, "body": "emunber is a String <code>emunber = Worksheets(&quot;ReprintOld&quot;).Range(&quot;V3&quot;).Value</code>.  This is a value that changes based on a selection in a listbox and <code>prfile2</code> contains worksheets that are named after these &quot;V3&quot; values"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 1814, "user_id": 2588953, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/7cEaY.jpg?s=128&g=1", "display_name": "Chris L", "link": "https://stackoverflow.com/users/2588953/chris-l"}, "edited": false, "score": 0, "creation_date": 1539737195, "post_id": 52845676, "comment_id": 92607599, "body": "I&#39;ve tested mock data of this and it&#39;s working as intended. I can&#39;t imagine what the issue would be. Right above the With statement, type <code>stop</code>. When it reaches this line, press <code>Ctrl + G</code> in the VBE. In the immediate window that pops up, type <code>? Workbooks(prfile2).Worksheets(emunber) is nothing</code> and see what it outputs"}, {"owner": {"reputation": 1814, "user_id": 2588953, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/7cEaY.jpg?s=128&g=1", "display_name": "Chris L", "link": "https://stackoverflow.com/users/2588953/chris-l"}, "edited": false, "score": 0, "creation_date": 1539737375, "post_id": 52845676, "comment_id": 92607642, "body": "it output <code>False</code>"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 1814, "user_id": 2588953, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/7cEaY.jpg?s=128&g=1", "display_name": "Chris L", "link": "https://stackoverflow.com/users/2588953/chris-l"}, "edited": false, "score": 0, "creation_date": 1539737560, "post_id": 52845676, "comment_id": 92607680, "body": "Oh. Thanks for adding your full code. <code>checkrng</code> is type <code>Range</code>. You will need to use the <code>Set</code> keyword for an object. I&#39;ll update code"}, {"owner": {"reputation": 1814, "user_id": 2588953, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/7cEaY.jpg?s=128&g=1", "display_name": "Chris L", "link": "https://stackoverflow.com/users/2588953/chris-l"}, "edited": false, "score": 0, "creation_date": 1539738189, "post_id": 52845676, "comment_id": 92607807, "body": "that got rid of the error! but unfortunately my combobox didn&#39;t populate as I had hoped with the code following that <code>with</code> statement.  Is there a way to confirm the range that is returned for the <code>checkrng</code> variable?"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 1814, "user_id": 2588953, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/7cEaY.jpg?s=128&g=1", "display_name": "Chris L", "link": "https://stackoverflow.com/users/2588953/chris-l"}, "edited": false, "score": 0, "creation_date": 1539738442, "post_id": 52845676, "comment_id": 92607858, "body": "you can confirm the range by prompting a msgbox (or immediate window again). <code>MsgBox checkrng.Address</code> will return something like <code>$U$5:$U$10</code> or something along those lines."}], "tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": true, "score": 1, "last_activity_date": 1539737595, "last_edit_date": 1539737595, "creation_date": 1539735944, "answer_id": 52845676, "question_id": 52845559, "link": "https://stackoverflow.com/questions/52845559/excel-vba-fill-activex-combobox-with-dynamic-range-from-another-workbook/52845676#52845676", "title": "Excel VBA - Fill ActiveX Combobox with dynamic range from another workbook", "body": "<p>You need to <em>qualify</em> all your <code>Range</code> objects.</p>\n\n<pre><code>checktotal = Workbooks(prfile2).Worksheets(emunber).Range(\"AE1\")\n\nWith Workbooks(prfile2).Worksheets(emunber)\n\n    Set checkrng = .Range(.Range(\"U5\"), .Range(\"U5\").End(xlDown))\n\nend with\n</code></pre>\n"}], "owner": {"reputation": 1814, "user_id": 2588953, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/7cEaY.jpg?s=128&g=1", "display_name": "Chris L", "link": "https://stackoverflow.com/users/2588953/chris-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 0, "accepted_answer_id": 52845676, "answer_count": 1, "score": 1, "last_activity_date": 1593590141, "creation_date": 1539734780, "last_edit_date": 1593590141, "question_id": 52845559, "link": "https://stackoverflow.com/questions/52845559/excel-vba-fill-activex-combobox-with-dynamic-range-from-another-workbook", "title": "Excel VBA - Fill ActiveX Combobox with dynamic range from another workbook", "body": "<p>I am trying to fill an ActiveX Combobox with a dynamic range from another workbook but I am getting a run-time error '1004' Application or object-defined error on the line of code that assigns the range:</p>\n\n<pre><code>Dim prfile1 As String\nDim prfile2 As String\nDim filepath As String\nDim checktotal As Integer\nDim checkrng As Range\nDim emunber As String\n\nprfile1 = Worksheets(\"setup\").Range(\"B10\").Value\nprfile2 = Worksheets(\"setup\").Range(\"B7\").Value\nfilepath = Worksheets(\"setup\").Range(\"e10\").Value\nemunber = Worksheets(\"ReprintOld\").Range(\"V3\").Value\n\nWorkbooks.Open filepath &amp; prfile2\nWindows(prfile2).Activate\n\nchecktotal = Workbooks(prfile2).Worksheets(emunber).Range(\"AE1\")\ncheckrng = Workbooks(prfile2).Worksheets(emunber).Range(Range(\"U5\"), Range(\"U5\").End(xlDown))\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1539734817, "post_id": 52845364, "comment_id": 92607095, "body": "There&#39;s something &quot;off&quot; about those two columns, but without seeing your sheet it&#39;s pretty difficult to know what that might be."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1539742460, "post_id": 52845364, "comment_id": 92608665, "body": "Try converting the table to a range and then back to a table - that might reset the problem columns"}, {"owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "edited": false, "score": 0, "creation_date": 1539743906, "post_id": 52845364, "comment_id": 92608952, "body": "In each of the two columns (which currently do not populate new rows with the formula), check if the formula stays the same throughout the column. Sounds like something is preventing it from being a <code>calculated column</code>."}, {"owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "edited": false, "score": 0, "creation_date": 1539744286, "post_id": 52845364, "comment_id": 92609043, "body": "For each of the two columns, take a cell in that column which contains the correct formula, copy-paste it to the first cell of that column, then double-click the bottom right corner of the cell to overwrite the column (with what should be the same formula). Second thing you could try is recreating the columns themselves from scratch (if this is an option -- depending on how many cells refer to that column). Maybe just store the formulas somewhere temporarily, re-create the columns, run the VBA code you posted, check if the formulas were added to new rows (in the newly created columns)"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 10515608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad26ade2292e811374d70920688fc63a?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/10515608/chris"}, "is_accepted": false, "score": 0, "last_activity_date": 1540127406, "creation_date": 1540127406, "answer_id": 52915638, "question_id": 52845364, "link": "https://stackoverflow.com/questions/52845364/listrows-add-not-copying-all-formulas-to-new-row/52915638#52915638", "title": "ListRows.Add not copying all formulas to new row", "body": "<p>Thanks for the help everyone, converting to range, then back didn't do the trick so I created another column as \"chillin\" suggested and changed the formulas that referenced the column and all is working as expected. Appreciated the responses</p>\n"}], "owner": {"reputation": 1, "user_id": 10515608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad26ade2292e811374d70920688fc63a?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/10515608/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 513, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1540127406, "creation_date": 1539733126, "question_id": 52845364, "link": "https://stackoverflow.com/questions/52845364/listrows-add-not-copying-all-formulas-to-new-row", "title": "ListRows.Add not copying all formulas to new row", "body": "<p>I have a table with a subroutine to add a new row at the bottom.\nWhen adding a new row, it will not copy the formula for 2 columns only.  All other formulas copy to the new line without issue.\nI'm calling ListRows.Add\nI've used this in several project without failure, but can't figure out why only 2 columns will not copy the formula to the new row.</p>\n\n<p>Table details:\nName: tblFlights\nColumns: 103\nProtected Columns with formulas: A, P-S, U, AI-AM, AP-AW, AZ-BA, BG-BQ, BS-CB, CD-CG, CI-CO.\nUn-protected Columns (for data entry): B-O, W-X, CY.</p>\n\n<p>On the newly added row (at the bottom), Columns P &amp; R formulas do not copy.\nAll other columns with formulas copy just fine.</p>\n\n<p>I have also noticed that on Column P the \"Protection\" does not copy.  Column R \"Protection\" copies just fine.</p>\n\n<p>These are the only 2 columns that have issues with ListRows.Add</p>\n\n<p>When I manually do an Insert->Table Row Below, same issue happens.When I manually do an Insert->Table Row Above, same issue happens.</p>\n\n<p>Any help or ideas would be appreciated.</p>\n\n<p>Chris</p>\n\n<pre><code>Sub btnInsertBottom()\nCall SheetUnLock\nApplication.ScreenUpdating = False\n\nDim Tbl As ListObject\nDim NewRow As ListRow\n\nSet Tbl = Range(\"tblFlights\").ListObject\nSet NewRow = Tbl.ListRows.Add(AlwaysInsert:=True)\n\nRange(\"tblFlights[[#Headers],[Date (mm/dd/yy)]]\").Select\nCall btnGotoBottom\n\nApplication.ScreenUpdating = True\nCall SheetLock\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5, "user_id": 8091198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d103585e4fbb1b5d1f6db1b0618aef2?s=128&d=identicon&r=PG&f=1", "display_name": "beelzabud", "link": "https://stackoverflow.com/users/8091198/beelzabud"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1539762665, "post_id": 52845325, "comment_id": 92615250, "body": "The headers in the columns corresponding to columns5, 7 and 17, which are called \u201cResource\u201d \u201cActivity\u201d and \u201cStakeholders\u201d. Is that what you mean?"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 8091198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d103585e4fbb1b5d1f6db1b0618aef2?s=128&d=identicon&r=PG&f=1", "display_name": "beelzabud", "link": "https://stackoverflow.com/users/8091198/beelzabud"}, "edited": false, "score": 0, "creation_date": 1539771611, "post_id": 52850587, "comment_id": 92620371, "body": "This looks like what I\u2019m after. Will try it out - thanks!"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 0, "last_activity_date": 1539765445, "creation_date": 1539765445, "answer_id": 52850587, "question_id": 52845325, "link": "https://stackoverflow.com/questions/52845325/determine-if-target-cell-is-in-table-column-by-column-name/52850587#52850587", "title": "Determine if target cell is in table column, by column name", "body": "<p>You can use the properties of a table, thus.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nDim c As Long\n\nWith ActiveSheet.ListObjects(\"Table1\")\n    c = Target.Column - .ListColumns(1).Range.Column + 1\n    If Intersect(Target, .DataBodyRange) Is Nothing Then Exit Sub\n    If .HeaderRowRange(c).Value = \"Resources\" Or _\n       .HeaderRowRange(c).Value = \"Activity\" Or _\n       .HeaderRowRange(c).Value = \"Stakeholders\" Then\n            MsgBox \"Yes\"\n    End If\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 588, "user_id": 7049751, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a6b0e27ce4e8c20a20d34e793f4e4636?s=128&d=identicon&r=PG&f=1", "display_name": "Sphinx", "link": "https://stackoverflow.com/users/7049751/sphinx"}, "is_accepted": false, "score": 0, "last_activity_date": 1539765879, "creation_date": 1539765879, "answer_id": 52850709, "question_id": 52845325, "link": "https://stackoverflow.com/questions/52845325/determine-if-target-cell-is-in-table-column-by-column-name/52850709#52850709", "title": "Determine if target cell is in table column, by column name", "body": "<p>You could use named ranges to avoid error in case someone add columns to sheet.<BR> \nFor example column \"5\" is column \"E\". So in cell \"E1\" you create named range like \"ActivityCol\" and do the same for other columns (using differentr names of course) <BR> \nThen in your code you could do something like </p>\n\n<pre><code>Option Explicit\n\nSub Test()  \n    Dim ActivityColNo as Long, ResourcesColNo as Long, StakeholdersColNo as Long \n    ......\n    With Thisworkbook.sheets(\"Your sheet name\") \n        ActivityColNo  = .range(\"ActivityCol\").Column\n        ResourcesColNo  = .range(\"Some name\").Column \n        StakeholdersColNo  = .range(\"Some other name\").Column \n    End With\n    ........\n    If Target.Column = ActivityColNo Or Target.Column = ResourcesColNo Or _ \n        Target.Column = StakeholdersColNo Then\n    .........\n\nEnd Sub \n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 8091198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d103585e4fbb1b5d1f6db1b0618aef2?s=128&d=identicon&r=PG&f=1", "display_name": "beelzabud", "link": "https://stackoverflow.com/users/8091198/beelzabud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 826, "favorite_count": 0, "accepted_answer_id": 52850587, "answer_count": 2, "score": -1, "last_activity_date": 1543826300, "creation_date": 1539732682, "last_edit_date": 1543826300, "question_id": 52845325, "link": "https://stackoverflow.com/questions/52845325/determine-if-target-cell-is-in-table-column-by-column-name", "title": "Determine if target cell is in table column, by column name", "body": "<p>I want to run a procedure if the target cell is in specific columns.</p>\n\n<p>I am using column numbers to determine this. If extra columns are added to the table the system falls over.</p>\n\n<p>My code is below;</p>\n\n<ul>\n<li>the column names are a \"Activity\", \"Resources\" and \"Stakeholders\" (in the table\"Schedule\");</li>\n<li>the columns are 5, 7 and 17, in the line <code>If Target.Column = 5 Or Target.Column = 7 Or Target.Column = 17 Then</code></li>\n</ul>\n\n<pre class=\"lang-vb prettyprint-override\"><code>If Target.Count &gt; 1 Then GoTo exitHandler\n\nOn Error Resume Next\nSet rngDV = Cells.SpecialCells(xlCellTypeAllValidation)\nOn Error GoTo exitHandler\n\nIf rngDV Is Nothing Then GoTo exitHandler\n\nIf Intersect(Target, rngDV) Is Nothing Then\n   'do nothing\nElse\n    Application.EnableEvents = False\n    newVal = Target.Value\n    Application.Undo\n    oldVal = Target.Value\n    Target.Value = newVal\n    If Target.Column = 5 Or Target.Column = 7 Or Target.Column = 17 Then\n        If oldVal = \"\" Then\n            'do nothing\n        Else\n            If newVal = \"\" Then\n                'do nothing\n            Else\n                lUsed = InStr(1, oldVal, newVal)\n                If lUsed &gt; 0 Then\n                    If Right(oldVal, Len(newVal)) = newVal Then\n                        Target.Value = Left(oldVal, Len(oldVal) - Len(newVal) - 2)\n                    Else\n                        Target.Value = Replace(oldVal, newVal &amp; \", \", \"\")\n                    End If\n                Else\n                    Target.Value = oldVal _\n                      &amp; \", \" &amp; newVal\n                End If\n            End If\n        End If\n    End If\nEnd If\n\nexitHandler:\n  Application.EnableEvents = True\n</code></pre>\n"}]