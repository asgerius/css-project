[{"tags": ["excel", "vba", "out-of-memory"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 2, "creation_date": 1541632549, "post_id": 53199220, "comment_id": 93287237, "body": "You really should look into <code>Select Case</code> -- much cleaner if you are comparing the same variable over and over."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1541632658, "post_id": 53199220, "comment_id": 93287274, "body": "How large are the ranges in question?  There&#39;s no obvious issues but your code really would benefit from refactoring to remove the duplication."}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 2, "creation_date": 1541633225, "post_id": 53199220, "comment_id": 93287432, "body": "Is this your entire code? You are missing an <code>End If</code> - so that leads me to believe that it&#39;s not. I am somewhat concerned that you might be missing an <code>EnableEvents = False</code> somewhere and you are now in an endless loop with your <code>Worksheet_Change()</code> event."}, {"owner": {"reputation": 3, "user_id": 10548954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c11d8b0019cfdf2ede494f6c2e1f9585?s=128&d=identicon&r=PG&f=1", "display_name": "stringBean", "link": "https://stackoverflow.com/users/10548954/stringbean"}, "edited": false, "score": 0, "creation_date": 1541699360, "post_id": 53199220, "comment_id": 93314453, "body": "Nope! This is not the entire code. There were just soooo many if statements (I forgot that select case exists)"}], "answers": [{"tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 0, "last_activity_date": 1541636704, "creation_date": 1541636704, "answer_id": 53199897, "question_id": 53199220, "link": "https://stackoverflow.com/questions/53199220/vba-code-that-copies-column-from-one-sheet-to-another-has-intermittent-out-of-m/53199897#53199897", "title": "VBA code that copies column from one sheet to another has intermittent &quot;out of memory&quot; error", "body": "<p>You may have an issue with your <code>Events</code> as pointed out by @K.Davis. Just toggle off <code>Events</code> once and ensure all code that will potentially bring a change is nested inside the <code>Event</code> trap.</p>\n\n<p>Your code can be reduced greatly here with use of <code>Select Case</code> and <code>With</code> block. This also yields significantly better readability which will go a long way in helping you debug your code.</p>\n\n<pre><code>Sub TableStuff()\n\nDim CV As Worksheet\nSet CV = Sheets(\"Classification Values\")\n\nApplication.EnableEvents = False\n    With Sheets(\"CLASS_CHECK\").Range(\"Column\")\n        Select Case headerTitle\n            Case \"Analog\"\n               .Value = CV.Range(\"Analog\").Value\n            Case \"Asic\"\n                .Value = CV.Range(\"Asic\").Value\n            Case \"Board Artifacts\"\n                .Value = CV.Range(\"Board\").Value\n            Case \"Clock\"\n                .Value = CV.Range(\"Clock\").Value\n            Case \"Connector\"\n                .Value = CV.Range(\"Connector\").Value\n            Case \"Digital\"\n                .Value = CV.Range(\"Digital\").Value\n            Case \"Discrete: Capacitor\"\n                .Value = CV.Range(\"Capacitor\").Value\n        End Select\n    End With\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1541638699, "post_id": 53199899, "comment_id": 93288740, "body": "Remember that time you gave me a \u201cBIG F FOR FAIL\u201d for using <b>On Error GoTo Here</b> in a loop? Lol BIG T FOR THANKS for single handendly internet shaming me which lead to a better understand of loop scripts ;)"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1541639055, "post_id": 53199899, "comment_id": 93288837, "body": "@urdearboy - well I try never to pronounce &quot;Fail&quot; or to shame people, so I will try to work on my people skills ;-)"}, {"owner": {"reputation": 3, "user_id": 10548954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c11d8b0019cfdf2ede494f6c2e1f9585?s=128&d=identicon&r=PG&f=1", "display_name": "stringBean", "link": "https://stackoverflow.com/users/10548954/stringbean"}, "edited": false, "score": 0, "creation_date": 1541699602, "post_id": 53199899, "comment_id": 93314561, "body": "Thanks for the help, Tim!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1541636724, "creation_date": 1541636724, "answer_id": 53199899, "question_id": 53199220, "link": "https://stackoverflow.com/questions/53199220/vba-code-that-copies-column-from-one-sheet-to-another-has-intermittent-out-of-m/53199899#53199899", "title": "VBA code that copies column from one sheet to another has intermittent &quot;out of memory&quot; error", "body": "<p>Would suggest this as one possible refactoring to remove the global variable and the repetition:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    Dim rngTitle As Range\n    Set rngTitle = Me.Range(\"title\")\n    If Not Application.Intersect(Target, rngTitle) Is Nothing Then\n        doStuffWithTable rngTitle.Value\n    End If\nEnd Sub\n\nPublic Sub doStuffWithTable(title)\n    Dim rngName As String\n\n    Select Case title\n        Case \"Analog\", \"Asic\", \"Clock\", \"Connector\", \"Digital\"\n            rngName = title\n        Case \"Board Artifacts\"\n            rngName = \"Board\"\n        Case \"Discrete: Capacitor\"\n            rngName = \"Capacitor\"\n    End Select\n\n    If Len(rngName) &gt; 0 Then\n        Application.EnableEvents = False\n        ThisWorkbook.Sheets(\"CLASS_CHECK\").Range(\"Column\").Value = _\n            ThisWorkbook.Sheets(\"Classification Values\").Range(rngName).Value\n        Application.EnableEvents = True\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10548954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c11d8b0019cfdf2ede494f6c2e1f9585?s=128&d=identicon&r=PG&f=1", "display_name": "stringBean", "link": "https://stackoverflow.com/users/10548954/stringbean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 53199899, "answer_count": 2, "score": 0, "last_activity_date": 1586399503, "creation_date": 1541631729, "last_edit_date": 1586399503, "question_id": 53199220, "link": "https://stackoverflow.com/questions/53199220/vba-code-that-copies-column-from-one-sheet-to-another-has-intermittent-out-of-m", "title": "VBA code that copies column from one sheet to another has intermittent &quot;out of memory&quot; error", "body": "<p>The attached code takes user input from a drop-down list, finds the matching header in another sheet, and copies a column of data from one sheet (\"Classification Values\") to another (\"CLASS_CHECK\").</p>\n\n<p>This code causes \"out of memory\" errors after so many uses, however. </p>\n\n<p>Any ideas how I can improve my code so it doesn't run out of memory?</p>\n\n<p>Thank you!</p>\n\n<p>Code:</p>\n\n<hr>\n\n<pre><code>Public headerTitle As String\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\n    headerTitle = Range(\"title\").Value\n    Debug.Print (headerTitle)\n    Call doStuffWithTable\nEnd Sub\n\nPublic Sub doStuffWithTable()\n\n    If (headerTitle = \"Analog\") Then\n        Application.EnableEvents = False\n        Sheets(\"CLASS_CHECK\").Range(\"Column\").Value = Sheets(\"Classification Values\").Range(\"Analog\").Value\n        Application.EnableEvents = True\n    ElseIf (headerTitle = \"Asic\") Then\n        Application.EnableEvents = False\n        Sheets(\"CLASS_CHECK\").Range(\"Column\").Value = Sheets(\"Classification Values\").Range(\"Asic\").Value\n        Application.EnableEvents = True\n    ElseIf (headerTitle = \"Board Artifacts\") Then\n        Application.EnableEvents = False\n        Sheets(\"CLASS_CHECK\").Range(\"Column\").Value = Sheets(\"Classification Values\").Range(\"Board\").Value\n        Application.EnableEvents = True\n    ElseIf (headerTitle = \"Clock\") Then\n        Application.EnableEvents = False\n        Sheets(\"CLASS_CHECK\").Range(\"Column\").Value = Sheets(\"Classification Values\").Range(\"Clock\").Value\n        Application.EnableEvents = True\n    ElseIf (headerTitle = \"Connector\") Then\n        Application.EnableEvents = False\n        Sheets(\"CLASS_CHECK\").Range(\"Column\").Value = Sheets(\"Classification Values\").Range(\"Connector\").Value\n        Application.EnableEvents = True\n    ElseIf (headerTitle = \"Digital\") Then\n        Application.EnableEvents = False\n        Sheets(\"CLASS_CHECK\").Range(\"Column\").Value = Sheets(\"Classification Values\").Range(\"Digital\").Value\n        Application.EnableEvents = True\n    ElseIf (headerTitle = \"Discrete: Capacitor\") Then\n        Application.EnableEvents = False\n        Sheets(\"CLASS_CHECK\").Range(\"Column\").Value = Sheets(\"Classification Values\").Range(\"Capacitor\").Value\n        Application.EnableEvents = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1541632313, "post_id": 53199202, "comment_id": 93287164, "body": "you are overwriting Source variable in the above. It will end up as Sheet2. I think you mean it to be Target but that is a bad variable name as is part of event based structures."}, {"owner": {"reputation": 75, "user_id": 8056395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5abf9e591cd8db6c9e66f9a9e11c3225?s=128&d=identicon&r=PG&f=1", "display_name": "njrob", "link": "https://stackoverflow.com/users/8056395/njrob"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1541632384, "post_id": 53199202, "comment_id": 93287183, "body": "Yes you are correct...sorry, I was copying this from another machine, will change to reflect what it actually is."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1541632422, "post_id": 53199202, "comment_id": 93287195, "body": "change to something like wsTarget and wsSource"}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 8056395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5abf9e591cd8db6c9e66f9a9e11c3225?s=128&d=identicon&r=PG&f=1", "display_name": "njrob", "link": "https://stackoverflow.com/users/8056395/njrob"}, "edited": false, "score": 0, "creation_date": 1541633752, "post_id": 53199384, "comment_id": 93287567, "body": "Thanks!  I&#39;m getting a value error when I try it but I&#39;ll try playing around with this."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 75, "user_id": 8056395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5abf9e591cd8db6c9e66f9a9e11c3225?s=128&d=identicon&r=PG&f=1", "display_name": "njrob", "link": "https://stackoverflow.com/users/8056395/njrob"}, "edited": false, "score": 0, "creation_date": 1541634250, "post_id": 53199384, "comment_id": 93287692, "body": "You would get that either if value not found , or you haven\u2019t entered the formula using ctrl + shift + enter. Then {} will appear around the formula."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1541633165, "last_edit_date": 1541633165, "creation_date": 1541632851, "answer_id": 53199384, "question_id": 53199202, "link": "https://stackoverflow.com/questions/53199202/returning-result-of-sheet1-columnb-to-sheet2-columnb-given-a-certain-value-exist/53199384#53199384", "title": "Returning result of Sheet1.ColumnB to Sheet2.ColumnB given a certain value exists in any cell for Sheet1.ColumnC", "body": "<p>You can use a formula. For example, in C2 sheet2, with your data as shown in A1:C4 sheet1 </p>\n\n<pre><code>=INDEX(Sheet1!$B$2:$B$4,MATCH(A2&amp;\"x\",Sheet1!$A$2:$A$4&amp;Sheet1!$C$2:$C$4,0))\n</code></pre>\n\n<p>Enter as an array formula with <kbd>Ctrl</kbd> +<kbd>Shift</kbd>+<kbd>Enter</kbd> </p>\n\n<p><a href=\"https://i.stack.imgur.com/6oblk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6oblk.png\" alt=\"enter image description here\"></a></p>\n\n<p>You could wrap in an <code>IFERROR(formula,\"\")</code> to mask any non matches.</p>\n"}], "owner": {"reputation": 75, "user_id": 8056395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5abf9e591cd8db6c9e66f9a9e11c3225?s=128&d=identicon&r=PG&f=1", "display_name": "njrob", "link": "https://stackoverflow.com/users/8056395/njrob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 53199384, "answer_count": 1, "score": 0, "last_activity_date": 1586399539, "creation_date": 1541631628, "last_edit_date": 1586399539, "question_id": 53199202, "link": "https://stackoverflow.com/questions/53199202/returning-result-of-sheet1-columnb-to-sheet2-columnb-given-a-certain-value-exist", "title": "Returning result of Sheet1.ColumnB to Sheet2.ColumnB given a certain value exists in any cell for Sheet1.ColumnC", "body": "<p>So I have a problem.  I have something akin to this in Sheet1, where I have multiple instances of the same term with different (or sometimes non-existent) definitions:</p>\n\n<pre><code>     Term Name    Definition      Chosen Definition?           \n     Account      The account.      \n     Account      \n     Account      An account name.        x\n</code></pre>\n\n<p>Sheet2 is a reference sheet with all of the unique term names, but no definitions as of yet.</p>\n\n<pre><code>    Term Name     Definition\n    Account\n    Product\n    Customer\n</code></pre>\n\n<p>Since I have so many duplicates of the same term in Sheet1, I am trying to write something where I can simply put an 'x' in the third column ('Chosen Definition?') to mark the definition that I have chosen, and it will take the adjacent definition cell from Sheet1 (in Column B), and put it into the right spot in Sheet2 like so:</p>\n\n<pre><code>    Term Name     Definition\n    Account       An account name.\n    Product\n    Customer\n</code></pre>\n\n<p>I assume this would be done either by combining something like an IF statement, an AND statement, and a VLOOKUP, or in VBA (which I'm not an expert in at all).  I've tried both methods and I feel like I've gotten somewhat close, but not quite there.  Here's my VBA code:</p>\n\n<pre><code>    Sub InputData()\n        Dim c as Range\n        Dim j as Integer\n        Dim Source as Worksheet\n        Dim Target as Worksheet\n\n        Set Source = ActiveWorkbook.Worksheets(\"Sheet1\")\n        Set Target = ActiveWorkbook.Worksheets(\"Sheet2\")\n\n        j = 2\n        For Each c in Source.Range(\"C3:C1000\")\n            If c = \"x\"\n                Source.Rows(c.Rows).Copy Target.Rows(j)\n                j = j + 1\n            End If\n        Next c\n    End Sub\n</code></pre>\n\n<p>That just puts any row with an 'x' in column C at the beginning of Sheet2:</p>\n\n<pre><code>    Term Name     Definition\n    Account       An account name.\n    Account\n    Product\n    Customer\n</code></pre>\n\n<p>Am I getting close with the VBA code that I have?  I don't think that formulas will work since I believe that what I am looking for needs to loop through each cell to find a match, but I don't want to add a new row each time I find a match.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1541634139, "post_id": 53199015, "comment_id": 93287662, "body": "Once you get the <code>Max_date</code>, you must get the <b>row number</b> of the cell containing the value.  Then you can do the <i>fill-down</i>"}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1541646341, "post_id": 53199015, "comment_id": 93290475, "body": "Are you trying to fill across from Col A to Col T?"}], "answers": [{"tags": [], "owner": {"reputation": 140, "user_id": 4795359, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153158823210791/picture?type=large", "display_name": "Osman Wong", "link": "https://stackoverflow.com/users/4795359/osman-wong"}, "is_accepted": false, "score": 0, "last_activity_date": 1541649487, "last_edit_date": 1541649487, "creation_date": 1541649024, "answer_id": 53201294, "question_id": 53199015, "link": "https://stackoverflow.com/questions/53199015/excel-vba-unable-to-filldown-from-date-variable-in-vba/53201294#53201294", "title": "Excel VBA: Unable to Filldown from Date Variable in VBA", "body": "<p>Max_date gives you the actual date value, not the row value, so it doesn't work. You need to find a way to get the row number (i use worksheet match function below).\nand since you got the date value already you can just use that value to populate col A to T</p>\n\n<pre><code>Max_date = Application.WorksheetFunction.Max(Columns(\"A\"))\n\nMax_Row = Application.WorksheetFunction.Match(Max_date, Columns(\"A\"), 0)\n\nWorksheets(\"Sheet1\").Range(\"A\" &amp; Max_Row &amp; \":T\" &amp; Max_Row).Value = Max_date\n</code></pre>\n\n<p>Constraint - does not work when you have multiple identical max value in column A, the match function always goes for the first one only</p>\n"}], "owner": {"reputation": 1, "user_id": 10620925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e2bafbda8ad21f2d7b5d162161bb818?s=128&d=identicon&r=PG&f=1", "display_name": "swl681", "link": "https://stackoverflow.com/users/10620925/swl681"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1586399574, "creation_date": 1541630526, "last_edit_date": 1586399574, "question_id": 53199015, "link": "https://stackoverflow.com/questions/53199015/excel-vba-unable-to-filldown-from-date-variable-in-vba", "title": "Excel VBA: Unable to Filldown from Date Variable in VBA", "body": "<p>My goal is to find the most recent date in <code>column A</code> (the date in <code>column A</code> is determined by a formula) and filldown one row from the most recent date in <code>column A</code> through <code>column T</code>.</p>\n\n<p>I am able to locate the most recent date in <code>column A</code> utilizing </p>\n\n<pre><code>Max_date = Application.WorksheetFunction.Max(Columns(\"A\"))\n</code></pre>\n\n<p>but when I try to identify it in a range I am unsuccessful.</p>\n\n<p>Below is the total of failing code:</p>\n\n<pre><code>Sub Find_Date()\n\nDim Max_date As Date\n\nMax_date = Application.WorksheetFunction.Max(Columns(\"A\"))\n\nWorksheets(\"Sheet1\").Range(\"A\" &amp; Max_date).End(xlDown).FillDown\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["json", "excel", "vba", "web-scraping"], "comments": [{"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1541632458, "post_id": 53198461, "comment_id": 93287209, "body": "My answer to <a href=\"https://stackoverflow.com/a/51128453/9912714\">Using VBA and VBA-JSON to access JSON data from Wordpress API</a> has a function that will print all the proper accessors to the immediate window."}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1541633537, "post_id": 53198461, "comment_id": 93287489, "body": "Can you provide an example <code>strMatchID</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 601, "user_id": 7959614, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f104f49cd87068e81f128afbda86a637?s=128&d=identicon&r=PG&f=1", "display_name": "HJA24", "link": "https://stackoverflow.com/users/7959614/hja24"}, "edited": false, "score": 0, "creation_date": 1541710922, "post_id": 53198938, "comment_id": 93319821, "body": "Yes, it worked! Thank you for your help. I  corrected the JSON in according to your instruction by including the following Excel-formula <code>=SUBSTITUTE(SUBSTITUTE(A1,A2,A3),A5,A6)</code> where A1 = &#39;, A2 =  &quot;, A3 = None, A4 = &quot;None&quot;. Is it also possible to include this in the VBA script easier and less-exhaustive?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 601, "user_id": 7959614, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f104f49cd87068e81f128afbda86a637?s=128&d=identicon&r=PG&f=1", "display_name": "HJA24", "link": "https://stackoverflow.com/users/7959614/hja24"}, "edited": false, "score": 0, "creation_date": 1541711069, "post_id": 53198938, "comment_id": 93319895, "body": "Just nest replace statements on the .responseText ?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 601, "user_id": 7959614, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f104f49cd87068e81f128afbda86a637?s=128&d=identicon&r=PG&f=1", "display_name": "HJA24", "link": "https://stackoverflow.com/users/7959614/hja24"}, "edited": false, "score": 0, "creation_date": 1541711260, "post_id": 53198938, "comment_id": 93319996, "body": "something like :  Replace$(Replace$(MyRequest.ResponseText, Chr$( 39),Chr$(34)),&quot;None&quot;, Chr$(34)&amp;&quot;None&quot;&amp;Chr$(34))"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 601, "user_id": 7959614, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f104f49cd87068e81f128afbda86a637?s=128&d=identicon&r=PG&f=1", "display_name": "HJA24", "link": "https://stackoverflow.com/users/7959614/hja24"}, "edited": false, "score": 0, "creation_date": 1541713111, "post_id": 53198938, "comment_id": 93320748, "body": "I cleaned the code before saving to file but otherwise it would be something like: Replace$(Replace$(jsonText, Chr$( 39),Chr$(34)),&quot;None&quot;, Chr$(34)&amp;&quot;None&quot;&amp;Chr$(34)) . Disclaimer: Not tested."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 2, "last_activity_date": 1541633085, "last_edit_date": 1541633085, "creation_date": 1541630179, "answer_id": 53198938, "question_id": 53198461, "link": "https://stackoverflow.com/questions/53198461/dynamically-looping-over-json-request-with-index-numbers-in-key/53198938#53198938", "title": "Dynamically looping over JSON-request with index numbers in key", "body": "<p>After you have corrected the JSON by swopping <code>'</code> for <code>\"\"</code> and wrapped <code>None</code> as <code>\"None\"</code> you can use the following to get the names. Note I am reading the JSON from a file.  You would cut that bit out and replace with </p>\n\n<pre><code>Set Json = JsonConverter.ParseJson(MyRequest.ResponseText)(\"match\")(\"homeTeam\")(\"lineup\")\n</code></pre>\n\n<p>You are dealing with a collection of dictionaries so you access the name by key during the loop (each item is a dictionary not a collection).</p>\n\n<p>Put your <code>CreateObject(\"WinHttp.WinHttpRequest.5.1\")</code> before the loop. There is no point in continually recreating and destroying the object. Create it once and leave to go out of scope at the end of the sub.</p>\n\n<p>If you have any blank rows in the data area using <code>currentRegion</code> could return the wrong end row.</p>\n\n<pre><code>Option Explicit\nPublic Sub ReadValues()\n    Dim fso As Object, stream As Object, jsonText As String, item As Object\n    Dim json As Object, ws As Worksheet, i As Long\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n    Set stream = fso.OpenTextFile(\"C:\\Users\\User\\Desktop\\test.json\", ForReading)\n    jsonText = stream.ReadAll\n    stream.Close\n\n    Set json = JsonConverter.ParseJson(jsonText)(\"match\")(\"homeTeam\")(\"lineup\") 'collection of dictionaries\n    i = 1\n    For Each item In json\n       ws.Cells(9, i).Value =  item(\"name\")\n       i = i + 1\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 601, "user_id": 7959614, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f104f49cd87068e81f128afbda86a637?s=128&d=identicon&r=PG&f=1", "display_name": "HJA24", "link": "https://stackoverflow.com/users/7959614/hja24"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 53198938, "answer_count": 1, "score": 0, "last_activity_date": 1541711326, "creation_date": 1541627843, "last_edit_date": 1541711326, "question_id": 53198461, "link": "https://stackoverflow.com/questions/53198461/dynamically-looping-over-json-request-with-index-numbers-in-key", "title": "Dynamically looping over JSON-request with index numbers in key", "body": "<p>I have written the following VBA-macro:</p>\n\n<pre><code>Sub getLineUps()\n\nDim lastRow As Long\nDim strURL As String\nDim strJSON As String \nDim strMatchID As String\nDim strIndex As Integer\nDim i, x As Integer\nDim Json As Object\n\n\nlastRow = Range(\"A8\").CurrentRegion.Rows.Count\n\nFor x = 9 To lastRow\n   strMatchID = Cells(9, 1).Value\n   strURL = \"https://api.football-data.org/v2/matches/\" &amp; strMatchID\n   Set MyRequest = CreateObject(\"WinHttp.WinHttpRequest.5.1\")\n   MyRequest.Open \"Get\", strURL\n   MyRequest.setRequestHeader \"X-Auth-Token\", \"personal_password\"\n   MyRequest.Send\n   Set Json = JsonConverter.ParseJson(MyRequest.ResponseText)\n\n   For Each Item In Json(\"match\")(\"homeTeam\")(\"lineup\")\n      Cells(9, 11).Value = Item(0)(\"name\")\n      Cells(9, 12).Value = Item(1)(\"name\")\n      Cells(9, 13).Value = Item(2)(\"name\")\n      Cells(9, 14).Value = Item(3)(\"name\")\n      Cells(9, 15).Value = Item(4)(\"name\")\n      Cells(9, 16).Value = Item(5)(\"name\")\n      Cells(9, 17).Value = Item(6)(\"name\")\n      Cells(9, 18).Value = Item(7)(\"name\")\n      Cells(9, 19).Value = Item(8)(\"name\")\n      Cells(9, 20).Value = Item(9)(\"name\")\n      Cells(9, 21).Value = Item(10)(\"name\")\n   Next\nNext\n\nEnd Sub\n</code></pre>\n\n<p>Running this macro gives me the following error-message: <em>Run-time error '13': Type Mismatch</em> on the following line: <code>Cells(9, 11).Value = Item(0)(\"name\")</code>\nThe output of my JSON-request looks as follows:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>{\r\n  'head2head': {\r\n    'numberOfMatches': 7,\r\n    'totalGoals': 19,\r\n    'homeTeam': {\r\n      'wins': 1,\r\n      'draws': 1,\r\n      'losses': 5\r\n    },\r\n    'awayTeam': {\r\n      'wins': 5,\r\n      'draws': 1,\r\n      'losses': 1\r\n    }\r\n  },\r\n  'match': {\r\n    'id': 233132,\r\n    'competition': {\r\n      'id': 2021,\r\n      'name': 'Premier League'\r\n    },\r\n    'season': {\r\n      'id': 151,\r\n      'startDate': '2018-08-10',\r\n      'endDate': '2019-05-12',\r\n      'currentMatchday': 11,\r\n      'winner': None,\r\n      'availableStages': [\r\n        'REGULAR_SEASON'\r\n      ]\r\n    },\r\n    'utcDate': '2018-11-03T12:30:00Z',\r\n    'status': 'FINISHED',\r\n    'minute': None,\r\n    'attendance': 10792,\r\n    'venue': 'Vitality Stadium',\r\n    'matchday': 11,\r\n    'stage': 'REGULAR_SEASON',\r\n    'group': 'Regular Season',\r\n    'lastUpdated': '2018-11-05T05:03:52Z',\r\n    'score': {\r\n      'winner': 'AWAY_TEAM',\r\n      'duration': 'REGULAR',\r\n      'fullTime': {\r\n        'homeTeam': 1,\r\n        'awayTeam': 2\r\n      },\r\n      'halfTime': {\r\n        'homeTeam': 1,\r\n        'awayTeam': 1\r\n      },\r\n      'extraTime': {\r\n        'homeTeam': None,\r\n        'awayTeam': None\r\n      },\r\n      'penalties': {\r\n        'homeTeam': None,\r\n        'awayTeam': None\r\n      }\r\n    },\r\n    'homeTeam': {\r\n      'id': 1044,\r\n      'name': 'AFC Bournemouth',\r\n      'coach': {\r\n        'id': 11594,\r\n        'name': 'Eddie Howe',\r\n        'countryOfBirth': 'England',\r\n        'nationality': 'England'\r\n      },\r\n      'captain': {\r\n        'id': 8232,\r\n        'name': 'Simon Francis',\r\n        'shirtNumber': 2\r\n      },\r\n      'lineup': [\r\n        {\r\n          'id': 8247,\r\n          'name': 'Ryan Fraser',\r\n          'position': 'Midfielder',\r\n          'shirtNumber': 24\r\n        },\r\n        {\r\n          'id': 3327,\r\n          'name': 'Lewis Cook',\r\n          'position': 'Midfielder',\r\n          'shirtNumber': 16\r\n        },\r\n        {\r\n          'id': 8229,\r\n          'name': 'Asmir Begovi\u0107',\r\n          'position': 'Goalkeeper',\r\n          'shirtNumber': 27\r\n        },\r\n        {\r\n          'id': 3737,\r\n          'name': 'Jefferson Lerma',\r\n          'position': 'Midfielder',\r\n          'shirtNumber': 8\r\n        },\r\n        {\r\n          'id': 8231,\r\n          'name': 'Adam Smith',\r\n          'position': 'Defender',\r\n          'shirtNumber': 15\r\n        },\r\n        {\r\n          'id': 8240,\r\n          'name': 'Nathan Ak\u00e9',\r\n          'position': 'Defender',\r\n          'shirtNumber': 5\r\n        },\r\n        {\r\n          'id': 8251,\r\n          'name': 'Callum Wilson',\r\n          'position': 'Attacker',\r\n          'shirtNumber': 13\r\n        },\r\n        {\r\n          'id': 4321,\r\n          'name': 'David Brooks',\r\n          'position': 'Attacker',\r\n          'shirtNumber': 20\r\n        },\r\n        {\r\n          'id': 8232,\r\n          'name': 'Simon Francis',\r\n          'position': 'Defender',\r\n          'shirtNumber': 2\r\n        },\r\n        {\r\n          'id': 8234,\r\n          'name': 'Steve Cook',\r\n          'position': 'Defender',\r\n          'shirtNumber': 3\r\n        },\r\n        {\r\n          'id': 8242,\r\n          'name': 'Junior Stanislas',\r\n          'position': 'Midfielder',\r\n          'shirtNumber': 19\r\n        }\r\n      ],\r\n      'bench': [\r\n        {\r\n          'id': 8227,\r\n          'name': 'Artur Boruc',\r\n          'position': 'Goalkeeper',\r\n          'shirtNumber': 1\r\n        },\r\n        {\r\n          'id': 8233,\r\n          'name': 'Charlie Daniels',\r\n          'position': 'Defender',\r\n          'shirtNumber': 11\r\n        },\r\n        {\r\n          'id': 8246,\r\n          'name': 'Andrew Surman',\r\n          'position': 'Midfielder',\r\n          'shirtNumber': 6\r\n        },\r\n        {\r\n          'id': 8243,\r\n          'name': 'Dan Gosling',\r\n          'position': 'Midfielder',\r\n          'shirtNumber': 4\r\n        },\r\n        {\r\n          'id': 8255,\r\n          'name': 'Jermain Defoe',\r\n          'position': 'Attacker',\r\n          'shirtNumber': 18\r\n        },\r\n        {\r\n          'id': 8254,\r\n          'name': 'Jordon Ibe',\r\n          'position': 'Attacker',\r\n          'shirtNumber': 10\r\n        },\r\n        {\r\n          'id': 8253,\r\n          'name': 'Lys Mousset',\r\n          'position': 'Attacker',\r\n          'shirtNumber': 9\r\n        }\r\n      ]\r\n    },\r\n    'awayTeam': {\r\n      'id': 66,\r\n      'name': 'Manchester United FC',\r\n      'coach': {\r\n        'id': 11613,\r\n        'name': 'Jos\u00e9 Mourinho',\r\n        'countryOfBirth': 'Portugal',\r\n        'nationality': 'Portugal'\r\n      },\r\n      'captain': {\r\n        'id': 3317,\r\n        'name': 'Ashley Young',\r\n        'shirtNumber': 18\r\n      },\r\n      'lineup': [\r\n        {\r\n          'id': 3188,\r\n          'name': 'David De Gea',\r\n          'position': 'Goalkeeper',\r\n          'shirtNumber': 1\r\n        },\r\n        {\r\n          'id': 7909,\r\n          'name': 'Mata',\r\n          'position': 'Attacker',\r\n          'shirtNumber': 8\r\n        },\r\n        {\r\n          'id': 7896,\r\n          'name': 'Chris Smalling',\r\n          'position': 'Defender',\r\n          'shirtNumber': 12\r\n        },\r\n        {\r\n          'id': 7911,\r\n          'name': 'Alexis S\u00e1nchez',\r\n          'position': 'Attacker',\r\n          'shirtNumber': 7\r\n        },\r\n        {\r\n          'id': 3372,\r\n          'name': 'Anthony Martial',\r\n          'position': 'Attacker',\r\n          'shirtNumber': 11\r\n        },\r\n        {\r\n          'id': 7898,\r\n          'name': 'Luke Shaw',\r\n          'position': 'Defender',\r\n          'shirtNumber': 23\r\n        },\r\n        {\r\n          'id': 3492,\r\n          'name': 'Victor Nilsson-Lindel\u00f6f',\r\n          'position': 'Defender',\r\n          'shirtNumber': 2\r\n        },\r\n        {\r\n          'id': 3317,\r\n          'name': 'Ashley Young',\r\n          'position': 'Midfielder',\r\n          'shirtNumber': 18\r\n        },\r\n        {\r\n          'id': 3438,\r\n          'name': 'Nemanja Mati\u0107',\r\n          'position': 'Midfielder',\r\n          'shirtNumber': 31\r\n        },\r\n        {\r\n          'id': 3366,\r\n          'name': 'Paul Pogba',\r\n          'position': 'Midfielder',\r\n          'shirtNumber': 6\r\n        },\r\n        {\r\n          'id': 3232,\r\n          'name': 'Fred',\r\n          'position': 'Midfielder',\r\n          'shirtNumber': 17\r\n        }\r\n      ],\r\n      'bench': [\r\n        {\r\n          'id': 3202,\r\n          'name': 'Sergio Romero',\r\n          'position': 'Goalkeeper',\r\n          'shirtNumber': 22\r\n        },\r\n        {\r\n          'id': 7897,\r\n          'name': 'Phil Jones',\r\n          'position': 'Defender',\r\n          'shirtNumber': 4\r\n        },\r\n        {\r\n          'id': 7900,\r\n          'name': 'Matteo Darmian',\r\n          'position': 'Defender',\r\n          'shirtNumber': 36\r\n        },\r\n        {\r\n          'id': 3325,\r\n          'name': 'Jesse Lingard',\r\n          'position': 'Midfielder',\r\n          'shirtNumber': 14\r\n        },\r\n        {\r\n          'id': 7904,\r\n          'name': 'Ander Herrera',\r\n          'position': 'Midfielder',\r\n          'shirtNumber': 21\r\n        },\r\n        {\r\n          'id': 7905,\r\n          'name': 'Scott McTominay',\r\n          'position': 'Midfielder',\r\n          'shirtNumber': 39\r\n        },\r\n        {\r\n          'id': 3331,\r\n          'name': 'Marcus Rashford',\r\n          'position': 'Attacker',\r\n          'shirtNumber': 10\r\n        }\r\n      ]\r\n    },\r\n    'goals': [\r\n      {\r\n        'minute': 11,\r\n        'extraTime': None,\r\n        'type': 'REGULAR',\r\n        'team': {\r\n          'id': 1044,\r\n          'name': 'AFC Bournemouth'\r\n        },\r\n        'scorer': {\r\n          'id': 8251,\r\n          'name': 'Callum Wilson'\r\n        },\r\n        'assist': {\r\n          'id': 8242,\r\n          'name': 'Junior Stanislas'\r\n        }\r\n      },\r\n      {\r\n        'minute': 35,\r\n        'extraTime': None,\r\n        'type': 'REGULAR',\r\n        'team': {\r\n          'id': 66,\r\n          'name': 'Manchester United FC'\r\n        },\r\n        'scorer': {\r\n          'id': 3372,\r\n          'name': 'Anthony Martial'\r\n        },\r\n        'assist': {\r\n          'id': 7911,\r\n          'name': 'Alexis S\u00e1nchez'\r\n        }\r\n      },\r\n      {\r\n        'minute': 90,\r\n        'extraTime': 2,\r\n        'type': 'REGULAR',\r\n        'team': {\r\n          'id': 66,\r\n          'name': 'Manchester United FC'\r\n        },\r\n        'scorer': {\r\n          'id': 3331,\r\n          'name': 'Marcus Rashford'\r\n        },\r\n        'assist': None\r\n      }\r\n    ],\r\n    'bookings': [\r\n      {\r\n        'minute': 54,\r\n        'team': {\r\n          'id': 66,\r\n          'name': 'Manchester United FC'\r\n        },\r\n        'player': {\r\n          'id': 7898,\r\n          'name': 'Luke Shaw'\r\n        },\r\n        'card': 'YELLOW_CARD'\r\n      },\r\n      {\r\n        'minute': 58,\r\n        'team': {\r\n          'id': 1044,\r\n          'name': 'AFC Bournemouth'\r\n        },\r\n        'player': {\r\n          'id': 3737,\r\n          'name': 'Jefferson Lerma'\r\n        },\r\n        'card': 'YELLOW_CARD'\r\n      },\r\n      {\r\n        'minute': 63,\r\n        'team': {\r\n          'id': 1044,\r\n          'name': 'AFC Bournemouth'\r\n        },\r\n        'player': {\r\n          'id': 8242,\r\n          'name': 'Junior Stanislas'\r\n        },\r\n        'card': 'YELLOW_CARD'\r\n      },\r\n      {\r\n        'minute': 64,\r\n        'team': {\r\n          'id': 1044,\r\n          'name': 'AFC Bournemouth'\r\n        },\r\n        'player': {\r\n          'id': 8251,\r\n          'name': 'Callum Wilson'\r\n        },\r\n        'card': 'YELLOW_CARD'\r\n      },\r\n      {\r\n        'minute': 82,\r\n        'team': {\r\n          'id': 66,\r\n          'name': 'Manchester United FC'\r\n        },\r\n        'player': {\r\n          'id': 3317,\r\n          'name': 'Ashley Young'\r\n        },\r\n        'card': 'YELLOW_CARD'\r\n      },\r\n      {\r\n        'minute': 83,\r\n        'team': {\r\n          'id': 1044,\r\n          'name': 'AFC Bournemouth'\r\n        },\r\n        'player': {\r\n          'id': 8231,\r\n          'name': 'Adam Smith'\r\n        },\r\n        'card': 'YELLOW_CARD'\r\n      },\r\n      {\r\n        'minute': 90,\r\n        'team': {\r\n          'id': 66,\r\n          'name': 'Manchester United FC'\r\n        },\r\n        'player': {\r\n          'id': 3331,\r\n          'name': 'Marcus Rashford'\r\n        },\r\n        'card': 'YELLOW_CARD'\r\n      }\r\n    ],\r\n    'substitutions': [\r\n      {\r\n        'minute': 56,\r\n        'team': {\r\n          'id': 66,\r\n          'name': 'Manchester United FC'\r\n        },\r\n        'playerOut': {\r\n          'id': 7909,\r\n          'name': 'Mata'\r\n        },\r\n        'playerIn': {\r\n          'id': 3331,\r\n          'name': 'Marcus Rashford'\r\n        }\r\n      },\r\n      {\r\n        'minute': 56,\r\n        'team': {\r\n          'id': 66,\r\n          'name': 'Manchester United FC'\r\n        },\r\n        'playerOut': {\r\n          'id': 3232,\r\n          'name': 'Fred'\r\n        },\r\n        'playerIn': {\r\n          'id': 7904,\r\n          'name': 'Ander Herrera'\r\n        }\r\n      },\r\n      {\r\n        'minute': 68,\r\n        'team': {\r\n          'id': 1044,\r\n          'name': 'AFC Bournemouth'\r\n        },\r\n        'playerOut': {\r\n          'id': 3327,\r\n          'name': 'Lewis Cook'\r\n        },\r\n        'playerIn': {\r\n          'id': 8243,\r\n          'name': 'Dan Gosling'\r\n        }\r\n      },\r\n      {\r\n        'minute': 74,\r\n        'team': {\r\n          'id': 1044,\r\n          'name': 'AFC Bournemouth'\r\n        },\r\n        'playerOut': {\r\n          'id': 8247,\r\n          'name': 'Ryan Fraser'\r\n        },\r\n        'playerIn': {\r\n          'id': 8254,\r\n          'name': 'Jordon Ibe'\r\n        }\r\n      },\r\n      {\r\n        'minute': 78,\r\n        'team': {\r\n          'id': 66,\r\n          'name': 'Manchester United FC'\r\n        },\r\n        'playerOut': {\r\n          'id': 7911,\r\n          'name': 'Alexis S\u00e1nchez'\r\n        },\r\n        'playerIn': {\r\n          'id': 3325,\r\n          'name': 'Jesse Lingard'\r\n        }\r\n      },\r\n      {\r\n        'minute': 90,\r\n        'team': {\r\n          'id': 1044,\r\n          'name': 'AFC Bournemouth'\r\n        },\r\n        'playerOut': {\r\n          'id': 8242,\r\n          'name': 'Junior Stanislas'\r\n        },\r\n        'playerIn': {\r\n          'id': 8246,\r\n          'name': 'Andrew Surman'\r\n        }\r\n      }\r\n    ],\r\n    'referees': [\r\n      {\r\n        'id': 11520,\r\n        'name': 'Paul Tierney',\r\n        'nationality': None\r\n      },\r\n      {\r\n        'id': 11606,\r\n        'name': 'Constantine Hatzidakis',\r\n        'nationality': None\r\n      },\r\n      {\r\n        'id': 11576,\r\n        'name': 'Darren Cann',\r\n        'nationality': None\r\n      },\r\n      {\r\n        'id': 11487,\r\n        'name': 'Kevin Friend',\r\n        'nationality': None\r\n      }\r\n    ]\r\n  }\r\n}</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Although, this output doesn't show it, we need an index number. I observed this by inspecting the output with Python.</p>\n\n<p><a href=\"https://i.stack.imgur.com/cF27d.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cF27d.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>&amp;</p>\n\n<p><a href=\"https://i.stack.imgur.com/9KcKG.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9KcKG.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>What is exactly going wrong with my VBA-macro as it doesn't show the desired output? \nIn addition, how can I re-write the macro in the following way:</p>\n\n<pre><code>previous code\n...\n\nSet Json = JsonConverter.ParseJson(MyRequest.ResponseText)\ni = 1\nFor Each Item In Json(\"match\")(\"homeTeam\")(\"lineup\")\n  Cells(9, i).Value = Item(indexnumber??)(\"name\")\n  i = i + 1 \n</code></pre>\n\n<p>How to correctly specify the index-number in this version?</p>\n\n<p>Thank you very very much</p>\n\n<p><strong>Solution with the help QHarr</strong></p>\n\n<pre><code>Option Explicit\nPublic Sub ReadValues()\nDim fso As Object, stream As Object, jsonText, jsonInput As String, item As \nObject\nDim json As Object, ws As Worksheet, i As Long\nSet ws = ThisWorkbook.Worksheets(\"Sheet1\")\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\nSet stream = fso.OpenTextFile(\"C:\\Users\\HJA\\Desktop\\Betting\\line_up.json\", \nForReading)\njsonText = stream.ReadAll\n\nws.Cells(1, 1).Value = jsonText\nws.Cells(7,1).Formula = \"=SUBSTITUTE(SUBSTITUTE(A1,A2,A3),A5,A6)\"\njsonInput = Cells(7, 1).Value\nMsgBox jsonInput\n\nSet json = JsonConverter.ParseJson(jsonInput)(\"match\")(\"homeTeam\")(\"lineup\") 'collection of dictionaries\ni = 1\nFor Each item In json\n   ws.Cells(9, i).Value = item(\"name\")\n   i = i + 1\nNext\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["excel", "vba", "user-defined-functions"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1541625830, "post_id": 53198001, "comment_id": 93284677, "body": "you mean whose value is rowName  and colName?"}, {"owner": {"reputation": 6410, "user_id": 1051115, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b37fdf7928b7aecd15a973b250979333?s=128&d=identicon&r=PG", "display_name": "Krazy Glew", "link": "https://stackoverflow.com/users/1051115/krazy-glew"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1541626149, "post_id": 53198001, "comment_id": 93284801, "body": "&quot;whose value is rowName and colName?&quot; - yes.  More precisely, I mean the cell of the table (passed as parameter tbl),. whose column is the column that has the value of the string colName in the #Headers row, and whose row has the value of the parameter rowName as the value of - in this example - the column whose header is &quot;RowKey&quot;.  // An extended version might pass in the column header name to be used for the RowKey."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1541626644, "post_id": 53198001, "comment_id": 93285041, "body": "Sounds like you could use index on tbl with match and match for rowName and colName. That would return the row and column you need and thus the value."}, {"owner": {"reputation": 6410, "user_id": 1051115, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b37fdf7928b7aecd15a973b250979333?s=128&d=identicon&r=PG", "display_name": "Krazy Glew", "link": "https://stackoverflow.com/users/1051115/krazy-glew"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1541629882, "post_id": 53198001, "comment_id": 93286302, "body": "@QHarr - yeah, I have used both VLOOKUP/MATCH and INDEX-MATCH in my formulae.  I just haven&#39;t been able to transform those formulae into VBA."}], "answers": [{"comments": [{"owner": {"reputation": 6410, "user_id": 1051115, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b37fdf7928b7aecd15a973b250979333?s=128&d=identicon&r=PG", "display_name": "Krazy Glew", "link": "https://stackoverflow.com/users/1051115/krazy-glew"}, "edited": false, "score": 0, "creation_date": 1541629807, "post_id": 53198265, "comment_id": 93286275, "body": "Ugh!  Is there no way to call INDEX or VLOOKUP directly from the UDF, so that the code corresponds to the formula?   //  Anyway, not complaining, I can understand what you are doing, although I haven&#39;t tested it yet.  Thanks. This may become accepted answer, but still!!!"}], "tags": [], "owner": {"reputation": 2344, "user_id": 757661, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/22d55e7c13896272c09c997eeba72318?s=128&d=identicon&r=PG", "display_name": "gordon613", "link": "https://stackoverflow.com/users/757661/gordon613"}, "is_accepted": false, "score": 0, "last_activity_date": 1541626909, "creation_date": 1541626909, "answer_id": 53198265, "question_id": 53198001, "link": "https://stackoverflow.com/questions/53198001/excel-udf-to-specify-table-row-and-col-by-name/53198265#53198265", "title": "Excel UDF to specify Table Row and Col by Name", "body": "<p>This should work</p>\n\n<pre><code>Function TRC(tbl As Range, rowName, colName)\n\n  aRow = -1\n  aColumn = -1\n  For j = 1 To tbl.Rows.Count\n    If tbl.Cells(j, 1) = rowName Then aRow = j\n  Next j\n  For k = 1 To tbl.Columns.Count\n    If tbl.Cells(1, k) = colName Then aColumn = k\n  Next k\n  If (aRow = -1) Or (aColumn = -1) Then\n    TRC = \"Error\"\n  Else\n    TRC = tbl.Cells(aRow, aColumn)\n  End If\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 2, "last_activity_date": 1541632138, "last_edit_date": 1541632138, "creation_date": 1541631070, "answer_id": 53199109, "question_id": 53198001, "link": "https://stackoverflow.com/questions/53198001/excel-udf-to-specify-table-row-and-col-by-name/53199109#53199109", "title": "Excel UDF to specify Table Row and Col by Name", "body": "<p>You mean something like this? I would advise using a more descriptive function name.</p>\n\n<pre><code>Option Explicit\nPublic Sub test()\n    Dim table As ListObject\n    Set table = ThisWorkbook.Worksheets(\"Sheet2\").ListObjects(\"table2\")\n    Debug.Print TRC(table.Range, \"RowA\", \"ColB\")\nEnd Sub\n\n\nPublic Function TRC(ByVal table As Range, ByVal rowName As String, ByVal colName As String) As Variant\n    TRC = Application.Index(table, Application.Match(rowName, table.Columns(1), 0), Application.Match(colName, table.Rows(1), 0))\nEnd Function\n</code></pre>\n\n<hr>\n\n<p>You could customize function with error handling/alternative return values e.g.</p>\n\n<pre><code>Public Function TRC(ByVal table As Range, ByVal rowName As String, ByVal colName As String) As Variant\n    Dim ret As Variant\n    ret = Application.Index(table, Application.Match(rowName, table.Columns(1), 0), Application.Match(colName, table.Rows(1), 0))\n    If Not IsError(ret) Then\n        TRC = ret\n    Else\n        TRC = \"Not found\"\n    End If\nEnd Function\n</code></pre>\n\n<hr>\n\n<p>In sheet usage:</p>\n\n<pre><code>=TRC(Table2[#All],\"RowA\",\"ColB\")\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/xImNd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xImNd.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 6410, "user_id": 1051115, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b37fdf7928b7aecd15a973b250979333?s=128&d=identicon&r=PG", "display_name": "Krazy Glew", "link": "https://stackoverflow.com/users/1051115/krazy-glew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 313, "favorite_count": 0, "accepted_answer_id": 53199109, "answer_count": 2, "score": 0, "last_activity_date": 1541632138, "creation_date": 1541625664, "last_edit_date": 1541626391, "question_id": 53198001, "link": "https://stackoverflow.com/questions/53198001/excel-udf-to-specify-table-row-and-col-by-name", "title": "Excel UDF to specify Table Row and Col by Name", "body": "<p>Given an Excel table such as that in the image below</p>\n\n<p><a href=\"https://i.stack.imgur.com/cOsfz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cOsfz.png\" alt=\"enter image description here\"></a></p>\n\n<p>I know how to use VLOOKUP and MATCH to access data elements using \"symbolic names\" for rows and columns - a column name for the latter, a search key for the former.</p>\n\n<p>At least, I know how to do this in an Excel formula.</p>\n\n<pre><code>=VLOOKUP(\"RowA\",Table2,MATCH(\"ColA\",Table2[#Headers],0))\n</code></pre>\n\n<p>But this is pretty verbose.  </p>\n\n<p>I would like to abbreviate it as a UDF (User Defined Function)</p>\n\n<p>(TRC standing for \"Table Row Column\")</p>\n\n<p>skeleton looking like</p>\n\n<pre><code>Function TRC(tbl As Range, rowName, colName) \n  'in Table tbl, \n  'looks up value whose row key is rowVal, \n  'and whose column heading is colVal\n  ...\nEnd Function\n</code></pre>\n\n<p>that might  be called as follows, for a semi-realistic example, where columns are particular CPU models, and rows are uarch parameters. </p>\n\n<pre><code>Cache_Size_in_Bytes = TRC(Cache_Param_Table,\"Line_Size\",\"Pentium4\")\n</code></pre>\n\n<p>or placed in a formukla in a cell like</p>\n\n<pre><code>= TRC(Cache_Param_Table,\"Line_Size\",\"Pentium4\")\n</code></pre>\n\n<p>Unfortunately, I have not managed to get anything working.</p>\n\n<p>Help?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1541626420, "post_id": 53197936, "comment_id": 93284931, "body": "What can you explain what the current problem is? I&#39;ve read this a few times and I&#39;m not picking up on what the problem is."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1541626438, "post_id": 53197936, "comment_id": 93284940, "body": "Just checking - are the ship to numbers supposed to be different between the first and second runs?"}, {"owner": {"reputation": 5, "user_id": 548115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe5e97a26c4d2f83d841ad78e52b6805?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/548115/michael"}, "edited": false, "score": 0, "creation_date": 1541630529, "post_id": 53197936, "comment_id": 93286540, "body": "@ Marcucciboy2  - if you look at picture one there are two rows associated with ...984 order number in the first table - both paste are pasted in second table which is ok"}, {"owner": {"reputation": 5, "user_id": 548115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe5e97a26c4d2f83d841ad78e52b6805?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/548115/michael"}, "edited": false, "score": 0, "creation_date": 1541631424, "post_id": 53197936, "comment_id": 93286854, "body": "@ Marcucciboy2  - if you look at picture one there are two rows associated with ...984 ship to number in the first table - both are pasted in the second table which is ok.  When I process the routine a second time with a different ship to number, it is pasted correctly.  But look at the first table, one of the two lines (...984) of the ship to number in the first table disappears!"}, {"owner": {"reputation": 5, "user_id": 548115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe5e97a26c4d2f83d841ad78e52b6805?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/548115/michael"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1541634613, "post_id": 53197936, "comment_id": 93287787, "body": "@BigBen - that is the exact problem. One of the rows of the Ship To data for ...984 was deleted. It was the first row the source table."}], "answers": [{"tags": [], "owner": {"reputation": 5, "user_id": 548115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe5e97a26c4d2f83d841ad78e52b6805?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/548115/michael"}, "is_accepted": false, "score": 0, "last_activity_date": 1542151613, "creation_date": 1542151613, "answer_id": 53290995, "question_id": 53197936, "link": "https://stackoverflow.com/questions/53197936/listrows-add-function-deletes-data-from-original-table/53290995#53290995", "title": "ListRows.Add function deletes data from Original Table", "body": "<p>I ultimately separated the two tables to two different sheets.  The problem was solved.  </p>\n\n<p>For whatever reason the one table kept deleting rows from the other table when it was on the same sheet.</p>\n"}], "owner": {"reputation": 5, "user_id": 548115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe5e97a26c4d2f83d841ad78e52b6805?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/548115/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542151613, "creation_date": 1541625414, "last_edit_date": 1541625530, "question_id": 53197936, "link": "https://stackoverflow.com/questions/53197936/listrows-add-function-deletes-data-from-original-table", "title": "ListRows.Add function deletes data from Original Table", "body": "<p>Yesterday, my question for this issue was resolved:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/53177811/vba-copy-paste-data-from-source-table-into-target-table-when-databodyrange-is-no\">VBA Copy/Paste Data from Source Table into Target Table when DataBodyRange is Nothing</a></p>\n\n<p>I can now 'add' data to a table when <code>DataBodyRange</code> is <code>Nothing</code>.</p>\n\n<p>However there was an unintended consequence that I can not figure out with the <code>ListRows.Add</code> approach.</p>\n\n<p>Steps:</p>\n\n<ol>\n<li>I call the referenced routine and select a value from the SOURCE (left side) table.  Data gets filtered and pasted correctly into the TARGET (right side) table.</li>\n<li>I call the routine again.  One line from the SOURCE table is deleted immediately after the ListRows.Add function (I placed 'Stops' in the code to diagnose location of issue.)</li>\n</ol>\n\n<p>Here is a picture of second run at first Stop.\n<img src=\"https://i.stack.imgur.com/WHT66.png\" alt=\"At the first STOP\"></p>\n\n<p>Here is a picture of the second run after the <code>ListRows.Add</code>\n<img src=\"https://i.stack.imgur.com/Q4upu.png\" alt=\"At the second STOP - after ListRows.Add\"></p>\n\n<p>And here is the code with the Stops shown.</p>\n\n<pre><code>Sub Copy_With_AutoFilter()\n\nDim loSource As Excel.ListObject\nDim loTarget As Excel.ListObject\nDim SourceDataRowsCount As Long\nDim TargetDataRowsCount As Long\nDim myfilter As Range\nDim rng As Range\nDim EndRow As ListRow\n\nSet loSource = Sheets(\"ProductData\").ListObjects(\"tblProductData\")\nSet loTarget = Sheets(\"ProductData\").ListObjects(\"tblMyProducts\")\nSet myfilter = Range(\"ShipToNumber\")\n\n'Change ScreenUpdating, Calculation, EnableEvents, etc.\n    With Application\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n    ViewMode = ActiveWindow.View\n    ActiveWindow.View = xlNormalView\n    ActiveSheet.DisplayPageBreaks = False\n\n'Delete all table rows except first row\n    If Not loTarget.DataBodyRange Is Nothing Then\n           loTarget.DataBodyRange.Delete\n           loTarget.Resize Range(\"$J$1:$Q$2\")\n    End If\n\n'Create the Filter for the Source Table &amp; Count Number of Cells\n    loSource.Range.AutoFilter Field:=3, Criteria1:=myfilter\n    SourceDataRowsCount = loSource.ListColumns(1).DataBodyRange.SpecialCells(xlCellTypeVisible).Count\n\n'Setup the Target Table\n    If SourceDataRowsCount &lt;&gt; 0 Then\n        Set rng = Range(\"tblMyProducts[#All]\").Resize(SourceDataRowsCount + 1, 8)\n        loTarget.Resize rng\n\n'Check to see if there is data in table\n    If Not loTarget.DataBodyRange Is Nothing Then\n        loSource.DataBodyRange.SpecialCells(xlCellTypeVisible).Copy 'Copy Data from Source Table to Target Table\n        loTarget.DataBodyRange.PasteSpecial (xlPasteValues)\n    Else\n\n        STOP 'First Stop\n             loTarget.ListRows.Add\n        STOP 'Second Stop\n\n        loSource.DataBodyRange.SpecialCells(xlCellTypeVisible).Copy loTarget.DataBodyRange(1, 1)\n    End If\n\n'Restore ScreenUpdating, Calculation, EnableEvents, etc.\n        Sheets(\"ProductData\").ListObjects(\"tblProductData\").ShowAutoFilter = False\n        Application.CutCopyMode = False\n        ActiveWindow.View = ViewMode\n        With Application\n            .ScreenUpdating = True\n            .EnableEvents = True\n        End With\n    Else\n        MsgBox \"Sorry, this Ship To location has not ordered any products in the last six months.  Please contact customer service so that your tables can be updated.\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>Any help would be greatly appreciated.</p>\n\n<p>The bottom line is I am trying to copy / paste a range of filtered values from a source table to a target table so that I can use the target table data in drop down menus, combo boxes, etc.</p>\n\n<p>Thank you in advance for your help.\nMichael</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "edited": false, "score": 0, "creation_date": 1541688008, "post_id": 53197957, "comment_id": 93307935, "body": "How would this work if my code is populating a new workbook with every manager on the master file? Where would I paste this if the worksheet is constantly opening and closing to a new set of data?"}], "tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 0, "last_activity_date": 1541625489, "creation_date": 1541625489, "answer_id": 53197957, "question_id": 53197868, "link": "https://stackoverflow.com/questions/53197868/how-could-i-implement-a-dialogue-box-message-if-two-columns-have-equal-values-in/53197957#53197957", "title": "How could I implement a dialogue box message if two columns have equal values in their rows?", "body": "<p>If you want something more immediate, you can use the <code>Worksheet_Change()</code> event to make the dialog show immediately when the value is entered - and clear the value.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    Dim watchRng As Range\n    Set watchRng = Me.Columns(\"S\")\n\n    If Not Intersect(Target, watchRng) Is Nothing Then\n\n        If Target.Value = Me.Cells(Target.Row, \"O\").Value Then\n\n            Application.EnableEvents = False\n\n            MsgBox \"You cannot input the same %\"\n            Target.ClearContents\n\n            Application.EnableEvents = True\n\n        End If\n\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>This need's to be placed in the <strong>Worksheet's Code Module</strong> for this to work properly.</p>\n"}], "owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562366321, "creation_date": 1541625057, "last_edit_date": 1562366321, "question_id": 53197868, "link": "https://stackoverflow.com/questions/53197868/how-could-i-implement-a-dialogue-box-message-if-two-columns-have-equal-values-in", "title": "How could I implement a dialogue box message if two columns have equal values in their rows?", "body": "<p>I have worksheets that are distributed to managers. Columns A:O are locked (protected sheet), but columns P:T are editable with a few drop down validation lists. </p>\n\n<p>If a manager inputs data in column S (cell S2) and their selection off the drop down list = the same value as what's in column O (cell O2), then I want a dialogue box to show that they cannot input the same value. </p>\n\n<p>I was thinking something like this: </p>\n\n<p><strong>rng 1 = column O, rng 2 = column S</strong></p>\n\n<pre><code>Dim rng1 As range, rng2 As range\nlastrow = ActiveWorkbook.Worksheets(\"Sheet1\").Range(\"A\" &amp; Rows.Count).End(xlUp).row\n\nSet rng1 = Range(\"O2:O\" &amp; lastrow)\nSet rng2 = Range(\"S2:S\" &amp; lastrow)\n\nIf rng1.value = rng2.value Then\n    -dialogue box \"You cannot input the same %\"\nEnd If\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook", "runtime-error"], "answers": [{"comments": [{"owner": {"reputation": 157, "user_id": 9659467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B35kJ.jpg?s=128&g=1", "display_name": "R.E.L.", "link": "https://stackoverflow.com/users/9659467/r-e-l"}, "edited": false, "score": 0, "creation_date": 1541625754, "post_id": 53197980, "comment_id": 93284639, "body": "I&#39;m not sure I understand what you mean, could provide me with some resources or further explanation? Perhaps how to troubleshoot this? Thank you!"}, {"owner": {"reputation": 1, "user_id": 9481676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a6f47106fbcfacfc8dec51966da1b6?s=128&d=identicon&r=PG&f=1", "display_name": "pniel", "link": "https://stackoverflow.com/users/9481676/pniel"}, "reply_to_user": {"reputation": 157, "user_id": 9659467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B35kJ.jpg?s=128&g=1", "display_name": "R.E.L.", "link": "https://stackoverflow.com/users/9659467/r-e-l"}, "edited": false, "score": 0, "creation_date": 1541626038, "post_id": 53197980, "comment_id": 93284763, "body": "for checking the smtp settings you can chek this link: <a href=\"https://www.mailjet.com/support/how-do-i-change-my-smtp-settings-in-outlook,98.htm\" rel=\"nofollow noreferrer\">mailjet.com/support/&hellip;</a>   for the ssl you can check the Certificate Center of windows and for the log file it should be in the TEMP directory at windows files the full path appears in the events at mangment tools"}], "tags": [], "owner": {"reputation": 1, "user_id": 9481676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a6f47106fbcfacfc8dec51966da1b6?s=128&d=identicon&r=PG&f=1", "display_name": "pniel", "link": "https://stackoverflow.com/users/9481676/pniel"}, "is_accepted": false, "score": 0, "last_activity_date": 1541625848, "last_edit_date": 1541625848, "creation_date": 1541625576, "answer_id": 53197980, "question_id": 53197843, "link": "https://stackoverflow.com/questions/53197843/excel-to-outlook-send-returns-run-time-error/53197980#53197980", "title": "Excel to Outlook: .Send returns Run-time Error", "body": "<p>If it works to you a few days ago perhaps it's blocked by 'smtp' port or 'ssl' verification ? it can caused by the isp server also if it exist..\none last point that i can think about .. maybe the run time service itself falling in the scripting routine (if it happend there is a log file..)\nif it happend i'm offer to reinstall the outlook run time or the debugger service or both..</p>\n"}, {"comments": [{"owner": {"reputation": 157, "user_id": 9659467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B35kJ.jpg?s=128&g=1", "display_name": "R.E.L.", "link": "https://stackoverflow.com/users/9659467/r-e-l"}, "edited": false, "score": 0, "creation_date": 1541627423, "post_id": 53198164, "comment_id": 93285347, "body": "Before I try it, is this something everyone would have to hard code change in their individual outlook applications? I just want to be sure because I&#39;ll write some instructions to add this in if that&#39;s the case"}, {"owner": {"reputation": 157, "user_id": 9659467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B35kJ.jpg?s=128&g=1", "display_name": "R.E.L.", "link": "https://stackoverflow.com/users/9659467/r-e-l"}, "edited": false, "score": 0, "creation_date": 1541627767, "post_id": 53198164, "comment_id": 93285503, "body": "also upon using the .save function, this appeared in the &#39;To&#39; section of my draft email: ` &lt;/O=ENOVA/OU=EXCHANGE ADMINISTRATIVE GROUP (FYDIBOHF23SPDLT)/CN=RECIPIENTS/CN=1D7DF0ED82D24F52A584C2007&zwnj;&#8203;A34B288-DOE, J (CON&gt; ` (assume J Doe, is my name)"}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "reply_to_user": {"reputation": 157, "user_id": 9659467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B35kJ.jpg?s=128&g=1", "display_name": "R.E.L.", "link": "https://stackoverflow.com/users/9659467/r-e-l"}, "edited": false, "score": 0, "creation_date": 1541628594, "post_id": 53198164, "comment_id": 93285833, "body": "It would need to be in the outlook of any machine where the macro runs and sends emails. I have no idea what that string is, Mine just sends the email from the host machines default outlook email address"}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "reply_to_user": {"reputation": 157, "user_id": 9659467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B35kJ.jpg?s=128&g=1", "display_name": "R.E.L.", "link": "https://stackoverflow.com/users/9659467/r-e-l"}, "edited": false, "score": 0, "creation_date": 1541628738, "post_id": 53198164, "comment_id": 93285882, "body": "Just keep in mind, this is ALWAYS ACTIVE in the outlook session, any draft you create on that outlook will automatically send, if outlook autosaves a draft when you have only half written an email, IT WILL SEND IT, This isn&#39;t an issue for me as it&#39;s on a VM so there is no danger of accidental sending."}, {"owner": {"reputation": 157, "user_id": 9659467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B35kJ.jpg?s=128&g=1", "display_name": "R.E.L.", "link": "https://stackoverflow.com/users/9659467/r-e-l"}, "edited": false, "score": 0, "creation_date": 1541628958, "post_id": 53198164, "comment_id": 93285962, "body": "I see what you mean. I&#39;m going to edit it so it only sends drafts that have a particular string in the title. But I do have a question, where did you place this in the outlook VBA? in a module or in the ThisOutlookSession? I have not used VBA from outlook before."}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "reply_to_user": {"reputation": 157, "user_id": 9659467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B35kJ.jpg?s=128&g=1", "display_name": "R.E.L.", "link": "https://stackoverflow.com/users/9659467/r-e-l"}, "edited": false, "score": 0, "creation_date": 1541629371, "post_id": 53198164, "comment_id": 93286111, "body": "Yeah whack it in ThisOutlookSession. The hints is a great idea, I did that in the past when autodownloading files I email my server, it only saves things from me with a specific string in the title."}], "tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": true, "score": 1, "last_activity_date": 1541626398, "creation_date": 1541626398, "answer_id": 53198164, "question_id": 53197843, "link": "https://stackoverflow.com/questions/53197843/excel-to-outlook-send-returns-run-time-error/53198164#53198164", "title": "Excel to Outlook: .Send returns Run-time Error", "body": "<p>I had the same issue years ago due to our email policy not allowing remote sending so I added code to Outlook to send drafts upon saving then instead of <code>.send</code> in Excel I used <code>.save</code>, This runs on my VM so I am guaranteed it will not accidentally send something I am drafting, I wouldn't recommend this on your normal use machine. It's a strange solution but it works.</p>\n\n<p>Outlook code:</p>\n\n<pre><code>Private WithEvents Items As Outlook.Items\n\nPrivate Sub Application_Startup()\nDim objNS As Outlook.NameSpace\nSet objNS = GetNamespace(\"MAPI\")\nSet Items = objNS.GetDefaultFolder(olFolderDrafts).Items\nSet objNS = Nothing\nEnd Sub\n\nPrivate Sub Items_ItemAdd(ByVal Item As Object)\nEmailOutlookDraftsMessages\nEnd Sub\n\nPublic Sub EmailOutlookDraftsMessages()\nDim lDraftItem As Long\nDim myOutlook As Outlook.Application\nDim myNameSpace As Outlook.NameSpace\nDim myFolders As Outlook.Folders\nDim myDraftsFolder As Outlook.MAPIFolder\nSet myOutlook = Outlook.Application\nSet myNameSpace = myOutlook.GetNamespace(\"MAPI\")\nSet myFolders = myNameSpace.Folders\nSet myDraftsFolder = myFolders(\"insight@brickworks.com.au\").Folders(\"Drafts\")\nFor lDraftItem = myDraftsFolder.Items.Count To 1 Step -1\nIf Len(Trim(myDraftsFolder.Items.Item(lDraftItem).To)) &gt; 0 Then\n    myDraftsFolder.Items.Item(lDraftItem).Send\nEnd If\nNext lDraftItem\nSet myDraftsFolder = Nothing\nSet myNameSpace = Nothing\nSet myOutlook = Nothing\nEnd Sub\n</code></pre>\n\n<p>Hope that helps, sing out if you get stuck.</p>\n"}, {"tags": [], "owner": {"reputation": 157, "user_id": 9659467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B35kJ.jpg?s=128&g=1", "display_name": "R.E.L.", "link": "https://stackoverflow.com/users/9659467/r-e-l"}, "is_accepted": false, "score": 0, "last_activity_date": 1541630263, "creation_date": 1541630263, "answer_id": 53198955, "question_id": 53197843, "link": "https://stackoverflow.com/questions/53197843/excel-to-outlook-send-returns-run-time-error/53198955#53198955", "title": "Excel to Outlook: .Send returns Run-time Error", "body": "<p>Huge thanks goes out to <a href=\"https://stackoverflow.com/users/4556996/dan-donoghue\">Dan Donoghue</a> who created this code and helped me place it in the correct place: the ThisOutlookSession in Outlook VBA. I tweaked it a little, so that it only send drafts that have a recipient and contain a certain text string included in the subject. I'm hoping to find a way to tweak it so that my email doesn't need to be manually input.</p>\n\n<pre><code>Private WithEvents Items As Outlook.Items\n    Private Sub Application_Startup()\n    Dim objNS As Outlook.NameSpace\n    Set objNS = GetNamespace(\"MAPI\")\n    Set Items = objNS.GetDefaultFolder(olFolderDrafts).Items\n    Set objNS = Nothing\n    End Sub\n\n    Private Sub Items_ItemAdd(ByVal Item As Object)\n    EmailOutlookDraftsMessages\n    End Sub\n\n    Public Sub EmailOutlookDraftsMessages()\n    Dim lDraftItem As Long\n    Dim myOutlook As Outlook.Application\n    Dim myNameSpace As Outlook.NameSpace\n    Dim myFolders As Outlook.Folders\n    Dim myDraftsFolder As Outlook.MAPIFolder\n    Set myOutlook = Outlook.Application\n    Set myNameSpace = myOutlook.GetNamespace(\"MAPI\")\n    Set myFolders = myNameSpace.Folders\n    Set myDraftsFolder = myFolders(\"R.E.L.s_email@fake.com\").Folders(\"Drafts\")\n    For lDraftItem = myDraftsFolder.Items.Count To 1 Step -1\n    If Len(Trim(myDraftsFolder.Items.Item(lDraftItem).To)) &gt; 0 And InStr(myDraftsFolder.Items.Item(lDraftItem).Subject, \"WO# \") &gt; 0 Then\n        myDraftsFolder.Items.Item(lDraftItem).Send\n    End If\n    Next lDraftItem\n    Set myDraftsFolder = Nothing\n    Set myNameSpace = Nothing\n    Set myOutlook = Nothing\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 157, "user_id": 9659467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B35kJ.jpg?s=128&g=1", "display_name": "R.E.L.", "link": "https://stackoverflow.com/users/9659467/r-e-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "accepted_answer_id": 53198164, "answer_count": 3, "score": 0, "last_activity_date": 1541630263, "creation_date": 1541624921, "last_edit_date": 1541626079, "question_id": 53197843, "link": "https://stackoverflow.com/questions/53197843/excel-to-outlook-send-returns-run-time-error", "title": "Excel to Outlook: .Send returns Run-time Error", "body": "<p>This has been asked before, however, I have tested all of the prior solutions provided and none have worked, so I am asking here.</p>\n\n<p>I have excel code that sends an email if a particular set of conditions are met. I have triple checked my data, and there has been no error there. Now the code worked fine a few days ago, and all of a sudden I am getting a <code>Run-Time error '287': Application-defined or object-defined error.</code> on the <code>.Send</code> line. When I use <code>.Display</code> instead, it works fine but obviously I have to manually send the email.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Sub mailing()\n\n    Dim OutApp As Object\n    Dim OutMail As Object\n    Dim cell As Range\n    Dim lastrow As Long\n    Dim ws As Worksheet\n\n\n        lastrow = Worksheets(\"2018\").Cells(Rows.Count, \"Y\").End(xlUp).Row\n        Dim rgRem1 As Range 'rg, Reminder 1\n        Dim rgRem2 As Range 'Reminder 2\n        Dim rgRem3 As Range 'Reminder 3\n        Dim rgAssigned As Range 'rg2, days since assigned\n\n        Set ws = Worksheets(\"2018\")\n\n        With ws\n            lastrow = .Cells(Rows.Count, \"G\").End(xlUp).Row\n            Set rgAssigned = Range(.Cells(1, \"X\"), .Cells(lastrow, \"X\"))\n            Set rgRem1 = Range(.Cells(1, \"Y\"), .Cells(lastrow, \"Y\"))\n            Set rgRem2 = Range(.Cells(1, \"z\"), .Cells(lastrow, \"z\"))\n            Set rgRem3 = Range(.Cells(1, \"aa\"), .Cells(lastrow, \"aa\"))\n        End With\n\n    Application.ScreenUpdating = False\n    Set OutApp = CreateObject(\"Outlook.Application\")\n\n\n\n    For Each cell In rgRem1\n        Set OutMail = OutApp.CreateItem(0)\n        If cell.Value = \"SENDING\" Then      'try with less conditions first\n            With OutMail\n                .To = Cells(cell.Row, \"V\").Value\n                .Subject = \"WO# \" &amp; Cells(cell.Row, \"G\").Value &amp; \" -  Reminder\"\n                .Body = \"Work Order: \" &amp; Cells(cell.Row, \"G\").Value &amp; _\n                    \" has been assigned to you for \" &amp; Cells(cell.Row, \"x\").Value &amp; \" days and is not yet completed. Can you provide any updates?\" &amp; _\n                    vbNewLine &amp; vbNewLine &amp; _\n                    \"Region: \" &amp; Cells(cell.Row, \"B\").Value &amp; vbNewLine &amp; _\n                    \"District: \" &amp; Cells(cell.Row, \"C\").Value &amp; vbNewLine &amp; _\n                    \"City: \" &amp; Cells(cell.Row, \"D\").Value &amp; vbNewLine &amp; _\n                    \"Atlas: \" &amp; Cells(cell.Row, \"E\").Value &amp; vbNewLine &amp; _\n                    \"Notification Number: \" &amp; Cells(cell.Row, \"F\").Value &amp; vbNewLine\n                '.ReadReceiptRequested = True\n                .Send\n            End With\n            Cells(cell.Row, \"Y\").Value = Now\n            Set OutMail = Nothing\n        End If\n\n        Next cell\n\n    For Each cell In rgRem2\n        Set OutMail = OutApp.CreateItem(0)\n        If cell.Value = \"SENDING\" Then      'try with less conditions first\n            With OutMail\n                .To = Cells(cell.Row, \"V\").Value\n                .Subject = \"WO# \" &amp; Cells(cell.Row, \"G\").Value &amp; \" - Reminder\"\n                .Body = \"Work Order: \" &amp; Cells(cell.Row, \"G\").Value &amp; _\n                    \" has been assigned to you for \" &amp; Cells(cell.Row, \"x\").Value &amp; \" days and is not yet completed. Can you provide any updates?\" &amp; _\n                    vbNewLine &amp; vbNewLine &amp; _\n                    \"Region: \" &amp; Cells(cell.Row, \"B\").Value &amp; vbNewLine &amp; _\n                    \"District: \" &amp; Cells(cell.Row, \"C\").Value &amp; vbNewLine &amp; _\n                    \"City: \" &amp; Cells(cell.Row, \"D\").Value &amp; vbNewLine &amp; _\n                    \"Atlas: \" &amp; Cells(cell.Row, \"E\").Value &amp; vbNewLine &amp; _\n                    \"Notification Number: \" &amp; Cells(cell.Row, \"F\").Value &amp; vbNewLine\n                '.ReadReceiptRequested = True\n                .Send\n            End With\n            Cells(cell.Row, \"z\").Value = Now\n            Set OutMail = Nothing\n        End If\n\n        Next cell\n\n\n    For Each cell In rgRem3\n        Set OutMail = OutApp.CreateItem(0)\n        If cell.Value = \"SENDING\" Then      'try with less conditions first\n            With OutMail\n                .To = Cells(cell.Row, \"V\").Value\n                .Subject = \"WO# \" &amp; Cells(cell.Row, \"G\").Value &amp; \" - Reminder\"\n                .Body = \"Work Order: \" &amp; Cells(cell.Row, \"G\").Value &amp; _\n                    \" has been assigned to you for \" &amp; Cells(cell.Row, \"x\").Value &amp; \" days and is not yet completed. Can you provide any updates?\" &amp; _\n                    vbNewLine &amp; vbNewLine &amp; _\n                    \"Region: \" &amp; Cells(cell.Row, \"B\").Value &amp; vbNewLine &amp; _\n                    \"District: \" &amp; Cells(cell.Row, \"C\").Value &amp; vbNewLine &amp; _\n                    \"City: \" &amp; Cells(cell.Row, \"D\").Value &amp; vbNewLine &amp; _\n                    \"Atlas: \" &amp; Cells(cell.Row, \"E\").Value &amp; vbNewLine &amp; _\n                    \"Notification Number: \" &amp; Cells(cell.Row, \"F\").Value &amp; vbNewLine\n                '.ReadReceiptRequested = True\n                .Send\n            End With\n            Cells(cell.Row, \"aa\").Value = Now\n            Set OutMail = Nothing\n        End If\n\n        Next cell\n\n\n\n    'Set OutApp = Nothing                        'it will be Nothing after End Sub\n    Application.ScreenUpdating = True\n\n    'For Each cell In rgAssigned\n        'If cell.Value = 25 And cell.Value &lt;&gt; \"Completed\" And cell.Value &lt;&gt; \"Over 75 days since assigned\" And cell.Value &lt;&gt; \"\" And Cells(cell.Row, \"Y\").Value = \"\" Then\n        'Cells(cell.Row, \"Y\").Value = \"SENDING\"\n        'End If\n\n        'If cell.Value = 50 And cell.Value &lt;&gt; \"Completed\" And cell.Value &lt;&gt; \"Over 75 days since assigned\" And cell.Value &lt;&gt; \"\" And Cells(cell.Row, \"Z\").Value = \"\" Then\n        'Cells(cell.Row, \"Z\").Value = \"SENDING\"\n        'End If\n\n        'If cell.Value = 75 And cell.Value &lt;&gt; \"Completed\" And cell.Value &lt;&gt; \"Over 75 days since assigned\" And cell.Value &lt;&gt; \"\" And Cells(cell.Row, \"AA\").Value = \"\" Then\n        'Cells(cell.Row, \"AA\").Value = \"SENDING\"\n        'End If\n    'Next cell\nEnd Sub\n</code></pre>\n\n<p><strong>I've tried several solutions suggested online including:</strong></p>\n\n<ol>\n<li>Checking my trust center settings--they are set as seen in <a href=\"https://image.ibb.co/m37jNq/trust.png\" rel=\"nofollow noreferrer\">this image</a>.</li>\n<li>Using <code>.SendKeys</code> (both <code>.SendKeys \"%S\"</code> and <code>.SendKeys \"^{ENTER}\"</code>) </li>\n<li>Using <code>.SendMail</code></li>\n<li>Enabling all the References (in Excel) related to Microsoft Scripting Runtime, Outlook, and object-libraries</li>\n<li>Running the code both with Outlook open and with Outlook closed</li>\n<li>I am avoiding a mail merge solution as this excel is meant to be used by multiple people, each with the same trust center settings but different mail merge settings</li>\n</ol>\n\n<p>I have this email automation in several of my macros and none of them are working. My security has not changed and my computer has not had a major update since the last time I used this excel. If anyone has any patches or information that can help me--<em>that does not include or only repeat the solutions I have already tested</em>--I would greatly appreciate it. I asked this question on mrexcel.com/forum regarding a similar but different code and am reaching out here as I have yet to receive any answer.</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Here is more information regarding my References in Excel:</p>\n\n<p><a href=\"https://i.stack.imgur.com/NdMIG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NdMIG.png\" alt=\"References\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 2, "creation_date": 1541623176, "post_id": 53197444, "comment_id": 93283406, "body": "Why not just enter the first date, then drag over (using the anchor at the bottom right hand corner)? Excel will automatically increment the date"}, {"owner": {"reputation": 3, "user_id": 10620451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2c386fb88ac5711ab7f3a2514942b14?s=128&d=identicon&r=PG&f=1", "display_name": "G. Ang", "link": "https://stackoverflow.com/users/10620451/g-ang"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1541623372, "post_id": 53197444, "comment_id": 93283494, "body": "@cybernetic.nomad thanks for the suggestion but my client wants a button that add with everyclick for them instead of them autofilling themselves and recording a macro only work once"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 1, "creation_date": 1541623778, "post_id": 53197444, "comment_id": 93283702, "body": "<a href=\"https://stackoverflow.com/questions/11926972/excel-vba-finding-the-last-column-with-data\">Find the last cell used</a> in row 2 then insert the value of it in the next cell over, making sure it is formatted as a date."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1541624927, "post_id": 53197444, "comment_id": 93284260, "body": "<code>Cells(2,Columns.Count).End(xlToLeft).offset(,1).value2 = Cells(2,Columns.Count).End(xlToLeft).value2 + 1</code>"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10620451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2c386fb88ac5711ab7f3a2514942b14?s=128&d=identicon&r=PG&f=1", "display_name": "G. Ang", "link": "https://stackoverflow.com/users/10620451/g-ang"}, "edited": false, "score": 0, "creation_date": 1541625367, "post_id": 53197627, "comment_id": 93284462, "body": "It may be a little complicated to have to select the date manually but I am also able to get +1 to the day instead of month using your code. Nonetheless appreciate your effort!"}, {"owner": {"reputation": 105, "user_id": 9808154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fd6a98412f53a13e79ec56c431df064?s=128&d=identicon&r=PG&f=1", "display_name": "ThisGuyJustNeedsHelp", "link": "https://stackoverflow.com/users/9808154/thisguyjustneedshelp"}, "reply_to_user": {"reputation": 3, "user_id": 10620451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2c386fb88ac5711ab7f3a2514942b14?s=128&d=identicon&r=PG&f=1", "display_name": "G. Ang", "link": "https://stackoverflow.com/users/10620451/g-ang"}, "edited": false, "score": 0, "creation_date": 1541627012, "post_id": 53197627, "comment_id": 93285188, "body": "I&#39;ve modified my code to fit your need. Couldn&#39;t go wrong with either answer."}], "tags": [], "owner": {"reputation": 105, "user_id": 9808154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fd6a98412f53a13e79ec56c431df064?s=128&d=identicon&r=PG&f=1", "display_name": "ThisGuyJustNeedsHelp", "link": "https://stackoverflow.com/users/9808154/thisguyjustneedshelp"}, "is_accepted": false, "score": 0, "last_activity_date": 1541627997, "last_edit_date": 1541627997, "creation_date": 1541623924, "answer_id": 53197627, "question_id": 53197444, "link": "https://stackoverflow.com/questions/53197444/excel-vba-macro-autofilling-date-to-the-next-right-cell/53197627#53197627", "title": "Excel VBA Macro: Autofilling date to the next (right) cell", "body": "<p>Assign this to your button. Just change the \"2\" in code to whatever your row is.</p>\n\n<pre><code>Sub autoFillNextCellDate()\n    Dim LastCol, currentRow As Integer\n    currentRow = 2 'change to whatever row you want to work with\n    With ActiveSheet\n        LastCol = .Cells(currentRow , .Columns.Count).End(xlToLeft).Column\n    End With\n\n    Cells(currentRow , LastCol).AutoFill Destination:=Range(Cells(currentRow , LastCol), Cells(currentRow , LastCol).Offset(0, 1)), Type:=xlFillDefault\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 10620451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2c386fb88ac5711ab7f3a2514942b14?s=128&d=identicon&r=PG&f=1", "display_name": "G. Ang", "link": "https://stackoverflow.com/users/10620451/g-ang"}, "edited": false, "score": 0, "creation_date": 1541625236, "post_id": 53197790, "comment_id": 93284398, "body": "Works like a charm! And yes I&#39;m using d/mm/yy format although it may not be so clear."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 0, "last_activity_date": 1541624652, "creation_date": 1541624652, "answer_id": 53197790, "question_id": 53197444, "link": "https://stackoverflow.com/questions/53197444/excel-vba-macro-autofilling-date-to-the-next-right-cell/53197790#53197790", "title": "Excel VBA Macro: Autofilling date to the next (right) cell", "body": "<p>Assign this macro to your button:</p>\n\n<pre><code>Sub AddADate()\n    Dim N As Long, d As Date, d2 As Date\n    N = Cells(2, Columns.Count).End(xlToLeft).Column\n    d = Cells(2, N).Value\n    Cells(2, N + 1).Value = DateSerial(Year(d), Month(d) + 1, Day(d))\nEnd Sub\n</code></pre>\n\n<p><em>(this assumes you are using d/m/yy formatting)</em></p>\n"}], "owner": {"reputation": 3, "user_id": 10620451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2c386fb88ac5711ab7f3a2514942b14?s=128&d=identicon&r=PG&f=1", "display_name": "G. Ang", "link": "https://stackoverflow.com/users/10620451/g-ang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 567, "favorite_count": 0, "closed_date": 1542074933, "accepted_answer_id": 53197790, "answer_count": 2, "score": -1, "last_activity_date": 1542006645, "creation_date": 1541623053, "last_edit_date": 1542006645, "question_id": 53197444, "link": "https://stackoverflow.com/questions/53197444/excel-vba-macro-autofilling-date-to-the-next-right-cell", "closed_reason": "Needs more focus", "title": "Excel VBA Macro: Autofilling date to the next (right) cell", "body": "<p>I have a row (say row 2) with these 16 values (A-P): </p>\n\n<p><code>1/1/11 , 1/2/11 , 1/3/11 , 1/4/11 ... ... ... 1/2/12 , 1/3/12 , 1/4/12</code></p>\n\n<p>Would it be possible to create a Macro that when clicked, autofills the cell to the right of it (Q2) with 1/5/12. And when clicked again it autofills the next cell (R2) with 1/6/12 and so on? </p>\n\n<p>I've tried searching everything that has to do with auto-filling but the macros only apply for an array and not the next empty cell one at a time. Thanks and appreciate any help given!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "edited": false, "score": 1, "creation_date": 1541622800, "post_id": 53197336, "comment_id": 93283242, "body": "Build the string inside the loop and move the <code>MsgBox</code> outside the loop."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 7856774, "user_type": "registered", "profile_image": "https://graph.facebook.com/1281216978593989/picture?type=large", "display_name": "Abdelmalek Aissi", "link": "https://stackoverflow.com/users/7856774/abdelmalek-aissi"}, "edited": false, "score": 0, "creation_date": 1541623123, "post_id": 53197384, "comment_id": 93283385, "body": "I wish you actually let me find the correct way of writing it :) , however, thank you so much for your help !"}], "tags": [], "owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "is_accepted": false, "score": 1, "last_activity_date": 1541622792, "creation_date": 1541622792, "answer_id": 53197384, "question_id": 53197336, "link": "https://stackoverflow.com/questions/53197336/multiplication-table-in-a-msgbox/53197384#53197384", "title": "Multiplication table in a msgbox", "body": "<p>You need to generate one string with the table, <em>before</em> display the message box:</p>\n\n<pre><code>Sub Multiplication1()\n\nDim number As Integer\nDim i As Integer\nDim res As Integer\nDim myTable as String\n\n\nnumber = InputBox(\" Write number \")\n\nFor i = 1 To 10\n    res = number * i\n    myTable = myTable &amp; number &amp; \" *\" &amp; i &amp; \" =\" &amp; res &amp; vbCrLf\nNext i\n\nMsgBox myTable\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "reply_to_user": {"reputation": 29, "user_id": 7856774, "user_type": "registered", "profile_image": "https://graph.facebook.com/1281216978593989/picture?type=large", "display_name": "Abdelmalek Aissi", "link": "https://stackoverflow.com/users/7856774/abdelmalek-aissi"}, "edited": false, "score": 0, "creation_date": 1541624217, "post_id": 53197394, "comment_id": 93283933, "body": "@AbdelmalekAissi If my answer helped you you should accept it (green check mark on the left) and optionally upvote."}], "tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": true, "score": 1, "last_activity_date": 1541622842, "creation_date": 1541622842, "answer_id": 53197394, "question_id": 53197336, "link": "https://stackoverflow.com/questions/53197336/multiplication-table-in-a-msgbox/53197394#53197394", "title": "Multiplication table in a msgbox", "body": "<p>Few remarks: don't use <code>Integer</code>, it's stored as <code>Long</code> anyway in VBA and you don't need to declare all variables on separate lines :) see the code below. And to sdolve your problem, append every result to a string variable in a loop, after that display it in a message box.</p>\n\n<pre><code>Sub Multiplication1()\n    Dim number As Long, i As Long, res As Long, s As String\n    number = InputBox(\" Write number \")\n    s = \"\"\n    For i = 1 To 10\n        res = number * i\n        s = s &amp; (number &amp; \" *\" &amp; i &amp; \" =\" &amp; res &amp; vbCrLf)\n    Next\n\n    MsgBox s\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 7856774, "user_type": "registered", "profile_image": "https://graph.facebook.com/1281216978593989/picture?type=large", "display_name": "Abdelmalek Aissi", "link": "https://stackoverflow.com/users/7856774/abdelmalek-aissi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 412, "favorite_count": 0, "accepted_answer_id": 53197394, "answer_count": 2, "score": 0, "last_activity_date": 1586399610, "creation_date": 1541622568, "last_edit_date": 1586399610, "question_id": 53197336, "link": "https://stackoverflow.com/questions/53197336/multiplication-table-in-a-msgbox", "title": "Multiplication table in a msgbox", "body": "<p>I need to show on the same <code>MsgBox</code> the multiplication table of a number chosen by a user.</p>\n\n<pre><code>Sub Multiplication1()\n\n    Dim number As Integer\n    Dim i As Integer\n    Dim res As Integer\n\n    number = InputBox(\" Write number \")\n\n    For i = 1 To 10\n        res = number * i\n\n        MsgBox (number &amp; \" *\" &amp; i &amp; \" =\" &amp; res &amp; vbCrLf)\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>In this code, for every loop iteration I have a now <code>MsgBox</code> with the correct answer, I want all the answers on the same msgbox.</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1541621450, "post_id": 53197052, "comment_id": 93282656, "body": "Note that the images that <i>don&#39;t</i> work are all from <code>images-amazon.com</code>. Perhaps there&#39;s something the they are implementing that doesn&#39;t allow you to access the image like you&#39;re calling it.  Perhaps save the image locally, then use the local file as what to insert?  In other words - let&#39;s try and figure out if it&#39;s a limitation with your VBA code, or the image/source itself."}, {"owner": {"reputation": 312, "user_id": 5376832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/131cf551898d23800289731848abedbc?s=128&d=identicon&r=PG&f=1", "display_name": "Karlomanio", "link": "https://stackoverflow.com/users/5376832/karlomanio"}, "edited": false, "score": 0, "creation_date": 1541628815, "post_id": 53197052, "comment_id": 93285910, "body": "I would try debugging this code to see how the code perceives the URL. It could be some of the characters in them. Or it could be that Amazon doesn&#39;t let you use VBA code with its images as a security thing."}, {"owner": {"reputation": 640, "user_id": 4934536, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-FH3r_zUz8aI/AAAAAAAAAAI/AAAAAAAAAg4/jLT4QUBRzi0/photo.jpg?sz=128", "display_name": "Kurt Ludikovsky", "link": "https://stackoverflow.com/users/4934536/kurt-ludikovsky"}, "edited": false, "score": 0, "creation_date": 1546008427, "post_id": 53197052, "comment_id": 94758001, "body": "I actually have the same issue with the same procedure (same source ?! :-) ). I had this already working some weeks ago (also with alots of trouble). This &#39;old&#39; Version dir work, and now it doesn&#39;t work anymore. It just delivers the first image in a selection (Rng as Selection) but not for the rest. The MS-Error codes are as usual useless at all."}], "owner": {"reputation": 128, "user_id": 2170644, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/hOT5W.jpg?s=128&g=1", "display_name": "Harif87", "link": "https://stackoverflow.com/users/2170644/harif87"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 425, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1586399646, "creation_date": 1541621250, "last_edit_date": 1586399646, "question_id": 53197052, "link": "https://stackoverflow.com/questions/53197052/excel-vba-picture-insert-not-working-only-for-some-urls", "title": "Excel VBA Picture Insert Not Working - Only for Some URLs", "body": "<p>I have used the below VBA code to insert pictures from an image URL. \nFor some reason, this code works with some image URLs but not for others.</p>\n\n<p>For example, the below URLs will work</p>\n\n<p><a href=\"http://a.espncdn.com/combiner/i?img=/i/headshots/nfl/players/full/3123076.png&amp;w=350&amp;h=254\" rel=\"nofollow noreferrer\">http://a.espncdn.com/combiner/i?img=/i/headshots/nfl/players/full/3123076.png&amp;w=350&amp;h=254</a></p>\n\n<p><a href=\"https://upload.wikimedia.org/wikipedia/commons/thumb/c/c8/David_Njoku_2018.jpg/220px-David_Njoku_2018.jpg\" rel=\"nofollow noreferrer\">https://upload.wikimedia.org/wikipedia/commons/thumb/c/c8/David_Njoku_2018.jpg/220px-David_Njoku_2018.jpg</a></p>\n\n<p>But the below will not</p>\n\n<p><a href=\"http://ecx.images-amazon.com/images/I/41HkOMYqc9L.SL500.jpg\" rel=\"nofollow noreferrer\">http://ecx.images-amazon.com/images/I/41HkOMYqc9L.SL500.jpg</a></p>\n\n<p><a href=\"http://ecx.images-amazon.com/images/I/41gWzC%2B5IqL.SL500.jpg\" rel=\"nofollow noreferrer\">http://ecx.images-amazon.com/images/I/41gWzC%2B5IqL.SL500.jpg</a></p>\n\n<p><a href=\"http://ecx.images-amazon.com/images/I/41gWzC%2B5IqL.SL500.jpg\" rel=\"nofollow noreferrer\">http://ecx.images-amazon.com/images/I/41gWzC%2B5IqL.SL500.jpg</a></p>\n\n<p>Does anyone know if there are any limitations to the  \"ActiveSheet.Pictures.Insert\" command?</p>\n\n<p>Below is the code i am using</p>\n\n<pre><code>Sub URLPictureInsert()\n    Dim Pshp As Shape\n    Dim xRg As Range\n    Dim xCol As Long\n    On Error Resume Next\n    Application.ScreenUpdating = False\n    Set Rng = ActiveSheet.Range(\"A1 :A24\")\n    For Each cell In Rng\n        filenam = cell\n        ActiveSheet.Pictures.Insert(filenam).Select\n        Set Pshp = Selection.ShapeRange.Item(1)\n        If Pshp Is Nothing Then GoTo lab\n        xCol = cell.Column + 1\n        Set xRg = Cells(cell.Row, xCol)\n        With Pshp\n            .LockAspectRatio = msoFalse\n            .Width = 100\n            .Height = 100\n            .Top = xRg.Top + (xRg.Height - .Height) / 2\n            .Left = xRg.Left + (xRg.Width - .Width) / 2\n        End With\nlab:\n    Set Pshp = Nothing\n    Range(\"A1\").Select\n    Next\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "path", "directory"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9937993, "user_type": "registered", "profile_image": "https://graph.facebook.com/1823154264409252/picture?type=large", "display_name": "Rico", "link": "https://stackoverflow.com/users/9937993/rico"}, "edited": false, "score": 0, "creation_date": 1541619574, "post_id": 53196202, "comment_id": 93281735, "body": "Hi Ben. That resolved the problem. ;) Thank you so munch for the help."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 13, "user_id": 9937993, "user_type": "registered", "profile_image": "https://graph.facebook.com/1823154264409252/picture?type=large", "display_name": "Rico", "link": "https://stackoverflow.com/users/9937993/rico"}, "edited": false, "score": 0, "creation_date": 1541619596, "post_id": 53196202, "comment_id": 93281744, "body": "No problem, glad to help."}, {"owner": {"reputation": 13, "user_id": 9937993, "user_type": "registered", "profile_image": "https://graph.facebook.com/1823154264409252/picture?type=large", "display_name": "Rico", "link": "https://stackoverflow.com/users/9937993/rico"}, "edited": false, "score": 0, "creation_date": 1541620371, "post_id": 53196202, "comment_id": 93282123, "body": "Hi Ben, Quick question would   Shell &quot;explorer.exe &quot; &amp; file_path, vbNormalFocus  be different if my path contained a space? Like: H:\\Projects\\IWA Populate"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1541620849, "post_id": 53196202, "comment_id": 93282376, "body": "<code>Shell &quot;explorer.exe &quot;&quot;&quot; &amp; file_path &amp; &quot;&quot;&quot;&quot;, vbNormalFocus</code> will allow for spaces in the folder path"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1541621031, "post_id": 53196202, "comment_id": 93282453, "body": "@TimWilliams thanks for jumping in, added that to the answer."}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 7, "last_activity_date": 1541621016, "last_edit_date": 1541621016, "creation_date": 1541617755, "answer_id": 53196202, "question_id": 53196128, "link": "https://stackoverflow.com/questions/53196128/open-folder-using-variable-path/53196202#53196202", "title": "Open folder using variable Path", "body": "<p>Move <code>file_path</code> <em>outside</em> the quotation marks and use the ampersand <code>&amp;</code>. While it's inside the quotation marks, it is no longer the variable <code>file_path</code>, but the <code>String</code> literal <code>\"file_path\"</code>.</p>\n\n<p>Change:</p>\n\n<pre><code>Shell \"explorer.exe file_path\", vbNormalFocus\n</code></pre>\n\n<p>to </p>\n\n<pre><code>Shell \"explorer.exe \" &amp; file_path, vbNormalFocus\n</code></pre>\n\n<hr>\n\n<p><strong>EDIT</strong>: As @TimWilliams pointed out, you can adjust this to </p>\n\n<pre><code>Shell \"explorer.exe \"\"\" &amp; file_path &amp; \"\"\"\", vbNormalFocus\n</code></pre>\n\n<p>to allow for spaces in the file name.</p>\n"}], "owner": {"reputation": 13, "user_id": 9937993, "user_type": "registered", "profile_image": "https://graph.facebook.com/1823154264409252/picture?type=large", "display_name": "Rico", "link": "https://stackoverflow.com/users/9937993/rico"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4473, "favorite_count": 0, "accepted_answer_id": 53196202, "answer_count": 1, "score": 1, "last_activity_date": 1594644571, "creation_date": 1541617514, "last_edit_date": 1594644571, "question_id": 53196128, "link": "https://stackoverflow.com/questions/53196128/open-folder-using-variable-path", "title": "Open folder using variable Path", "body": "<p>I am trying to open the folder where the macro workbook is located.</p>\n<p>In this example, it is in folder &quot;H:\\Projects\\IWA_Populate&quot;. However, the workbook could be in any folder location.</p>\n<p>If I specify a static path as below it opens to the target folder IWA_Populate:</p>\n<pre><code>Shell &quot;explorer.exe H:\\Projects\\IWA_Populate&quot;, vbNormalFocus\n</code></pre>\n<p>However if I replace the path with a variable as such below it only opens My Documents folder.</p>\n<pre><code>Shell &quot;explorer.exe file_path&quot;, vbNormalFocus\n</code></pre>\n<p>Here is my code to get file_path initialized:</p>\n<pre><code>Public file_path As String\nPublic xl As Excel.Application\nSet xl = Application: xl.DisplayAlerts = False\nActiveWorkbook.Save\nfile_path = xl.ActiveWorkbook.Path\n'Shell &quot;explorer.exe H:\\Projects\\IWA_Populate&quot;, vbNormalFocus\nShell &quot;explorer.exe file_path&quot;, vbNormalFocus\nMsgBox file_path\n</code></pre>\n<p>The Message box is to test that <code>file_path</code> is set to the correct full path.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1541616809, "post_id": 53195902, "comment_id": 93280448, "body": "You can <a href=\"https://stackoverflow.com/questions/5890257/populate-unique-values-into-a-vba-array-from-excel#5891317\">populate unique values to an array</a> then move the array to the desired range"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 1, "creation_date": 1541618734, "post_id": 53195902, "comment_id": 93281321, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/28609687/excel-vba-adding-items-to-combo-box-without-repeated-items\">Excel VBA adding items to combo box without repeated items</a>"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1541618756, "post_id": 53195902, "comment_id": 93281329, "body": "The only thing you&#39;d probably have to add to that solution is <code>Me.floors.clear</code> above where it loops and adds the items in"}], "owner": {"reputation": 2183, "user_id": 1474921, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/629c3c899819f28cbf068691b1c7c618?s=128&d=identicon&r=PG", "display_name": "Jason Kelly", "link": "https://stackoverflow.com/users/1474921/jason-kelly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 130, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1586399682, "creation_date": 1541616576, "last_edit_date": 1586399682, "question_id": 53195902, "link": "https://stackoverflow.com/questions/53195902/adding-column-values-to-a-combo-box-but-how-to-skip-duplicates", "title": "Adding column values to a combo box, but how to skip duplicates?", "body": "<p>I really need your help with this as I believe that there is more to this puzzling problem. I am using a basic for loop to grab all of my column values from column A and insert them into my user form combobox (floors).</p>\n\n<p>How can the function below be amended such that it only add the unqiue values 1 time as opposed to just duplicating the column value each and everytime:</p>\n\n<p><a href=\"https://i.stack.imgur.com/xJm5v.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xJm5v.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub tester()\n\n    With Sheets(\"Office Spaces\")\n\n        lRow = Cells(Rows.Count, 1).End(xlUp).row\n\n        For i = 3 To lRow\n\n            If Not IsEmpty(.Cells(i, 1).Value) Then\n\n                Me.floor.AddItem .Cells(i, 1).Value\n\n            End If\n\n        Next i\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>The desired outcome would look like this:\n<a href=\"https://i.stack.imgur.com/oCJJe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oCJJe.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "user-defined-functions"], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 10466772, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nqiI-il8RlI/AAAAAAAAAAI/AAAAAAAAADQ/a2_ma_WlA5E/photo.jpg?sz=128", "display_name": "Sir Christopher McFarlane", "link": "https://stackoverflow.com/users/10466772/sir-christopher-mcfarlane"}, "edited": false, "score": 1, "creation_date": 1541617544, "post_id": 53196004, "comment_id": 93280776, "body": "Ooooh this works! Shamefully enough, I misread the As Double() as As Double). I thought it was a part of the declarations inside the brackets. Thank you BigBen. This is a really helpful hindsight."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 53, "user_id": 10466772, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nqiI-il8RlI/AAAAAAAAAAI/AAAAAAAAADQ/a2_ma_WlA5E/photo.jpg?sz=128", "display_name": "Sir Christopher McFarlane", "link": "https://stackoverflow.com/users/10466772/sir-christopher-mcfarlane"}, "edited": false, "score": 0, "creation_date": 1541617615, "post_id": 53196004, "comment_id": 93280808, "body": "@SirChristopherMcFarlane no shame in that at all. Glad to help"}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 3, "last_activity_date": 1541624351, "last_edit_date": 1541624351, "creation_date": 1541616941, "answer_id": 53196004, "question_id": 53195457, "link": "https://stackoverflow.com/questions/53195457/udf-random-number-generator-type-mismatch/53196004#53196004", "title": "UDF Random Number Generator Type Mismatch", "body": "<p><code>Double</code> is not the same as <code>Double()</code>: <code>RandNorm</code> returns an <em>array</em>. When used as a UDF in a single cell, <code>RandNorm</code> returns the <em>first</em> element of that array. For example, consider the following function.</p>\n\n<pre><code>Function foo() As Double()\n    Dim z(0 To 1) As Double\n    z(0) = 1\n    z(1) = 2\n    foo = z\nEnd Function\n</code></pre>\n\n<p>When used as a UDF in a single cell, <code>=foo()</code> will always return <code>1</code>. You'd need to enter it as an array formula in 2 cells with <kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>Enter</kbd> to display the second element <code>2</code>.</p>\n\n<p>The easy fix might be changing <code>Double()</code> to <code>Double</code> and <code>RandNorm = z</code> to <code>RandNorm = z(0)</code>. </p>\n\n<pre><code>Function RandNorm(Optional mean As Double = 0, _\n              Optional Dev As Double = 1, _\n              Optional Corr As Double = 0, _\n              Optional bVolatile As Boolean = False) As Double\n    ....\n    If Corr &lt;&gt; 0 Then z(1) = Corr * z(0) + Sqr(1 - Corr ^ 2) * z(1)\n    RandNorm = z(0)\nEnd Function\n</code></pre>\n\n<p>Though it's hard to say that's what you're looking for - since you're effectively ignoring <code>z(1)</code>.</p>\n"}], "owner": {"reputation": 53, "user_id": 10466772, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nqiI-il8RlI/AAAAAAAAAAI/AAAAAAAAADQ/a2_ma_WlA5E/photo.jpg?sz=128", "display_name": "Sir Christopher McFarlane", "link": "https://stackoverflow.com/users/10466772/sir-christopher-mcfarlane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 53196004, "answer_count": 1, "score": 2, "last_activity_date": 1586399718, "creation_date": 1541614674, "last_edit_date": 1586399718, "question_id": 53195457, "link": "https://stackoverflow.com/questions/53195457/udf-random-number-generator-type-mismatch", "title": "UDF Random Number Generator Type Mismatch", "body": "<p>I've been trying for almost an hour wrapping my head around this problem but it seems to be getting nowhere.</p>\n\n<p>Basically I wanted to try a better random number generator and found this code which I wanted to try to implement in my program</p>\n\n<pre><code> Function RandNorm(Optional mean As Double = 0, _\n              Optional Dev As Double = 1, _\n              Optional Corr As Double = 0, _\n              Optional bVolatile As Boolean = False) As Double()\n\n\nRandomize\nDim z(0 To 1)   As Double\nDim U           As Double\nDim V           As Double\nDim S           As Double\n\nIf bVolatile Then Application.Volatile\n\nDo\n    U = 2 * [rand()] - 1\n    V = 2 * [rand()] - 1\n    S = U * U + V * V\nLoop Until S &lt; 1\n\nS = Sqr(-2 * Log(S) / S)\nz(0) = Dev * U * S + mean\nz(1) = Dev * V * S + mean\n\nIf Corr &lt;&gt; 0 Then z(1) = Corr * z(0) + Sqr(1 - Corr ^ 2) * z(1)\nRandNorm = z\nEnd Function\n</code></pre>\n\n<p>As you can see, the function returns a number. When run in Excel, like <code>=RandNorm()</code>, all is fine. But when run in e.g such a simple code like this:</p>\n\n<pre><code> Sub test()\n\n    Dim x() As Double, i As Long\n\n    ReDim x(1 To 10, 1 To 1)\n    For i = 1 To 10\n          x(i, 1) = RandNorm\n    Next i\n\n    Range(\"A1:A10\") = x\nEnd Sub\n</code></pre>\n\n<p>It's giving me \"Type mismatch\" error although it has been defined <code>As Double</code>.\nIf I define <code>RandNorm As Double</code> in the <code>Sub</code>, it's giving me 0's.\nHowever, if I replace the <code>x(i, 1)</code> to <code>Cells(i, 1)</code>, it works.</p>\n\n<p>The function is in its own Module and the Sub too.</p>\n\n<p>What did I miss? Any help would be really appreciated. Thanks in advance!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 3, "creation_date": 1541614463, "post_id": 53195275, "comment_id": 93279404, "body": "When you are working accross multiple work books, it is extremely important that you properly qualify your objects with a workbook/sheet. You have unqualified ranges and instances of <code>ActiveSheet</code> which should be srapped"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 4, "creation_date": 1541614501, "post_id": 53195275, "comment_id": 93279415, "body": "Kudos for <code>Option Explicit</code>"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1541614817, "post_id": 53195275, "comment_id": 93279563, "body": "I believe <code>Range(&quot;A&quot; &amp; LastRow + 1 &amp; &quot;A&quot; &amp; LastRow + LR)</code> is the range you&#39;re looking for (where LastRow is the last filled cell in Column <code>A</code> of <code>wsDEST</code>)"}], "answers": [{"comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 1, "creation_date": 1541624639, "post_id": 53195661, "comment_id": 93284115, "body": "congratz on 5k rep :)"}, {"owner": {"reputation": 19, "user_id": 7475461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4172df384df21367004619f5489ac700?s=128&d=identicon&r=PG&f=1", "display_name": "K. Bow", "link": "https://stackoverflow.com/users/7475461/k-bow"}, "edited": false, "score": 0, "creation_date": 1541704878, "post_id": 53195661, "comment_id": 93317022, "body": "Something in this revised script has caused the paste function to no longer work. I threw in a MsgBox after the line to copy the data to confirm that was still working correctly, so something with how the line for pasting the data caused it to no longer work.  I tried moving the &quot;For&quot; loop to my old script and adding in the appropriate variables, but that didn&#39;t work either. It still copied the data from the other files over but did not assign the dates."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1541705651, "post_id": 53195661, "comment_id": 93317343, "body": "Well, I asked about 3 clalrifying questions in the comments yesterday and you did not answer. You should not post your question until you are ready to tend to it because volunteers waste their time studying your problem and when it takes you a day to respond, we have to re-read your problem and catch back up. Given that this is volunteer time donated to you, that&#39;s not an ideal situation.  Won&#39;t have time to revisit this until Mon sorry"}, {"owner": {"reputation": 19, "user_id": 7475461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4172df384df21367004619f5489ac700?s=128&d=identicon&r=PG&f=1", "display_name": "K. Bow", "link": "https://stackoverflow.com/users/7475461/k-bow"}, "edited": false, "score": 0, "creation_date": 1541803135, "post_id": 53195661, "comment_id": 93355068, "body": "Sorry, I am new to using the site, but I&#39;m not seeing any clarifying questions from you. I see &quot;Kudos for Option Explicit&quot;, and to avoid using ActiveSheet when using multiple workbooks. Then I see one comment from someone else. I am unfortunately unable to remain 100% vigilant on comments on my question, as I can only access this site at specific times due to scheduling. I was relying on the email notifications to alert me when there was change, but I only got a single email after the three comments were left and you created this answer."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1541804021, "post_id": 53195661, "comment_id": 93355276, "body": "I deleted the questions when I posted this. I can revisit your question on monday"}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 0, "last_activity_date": 1541615594, "creation_date": 1541615594, "answer_id": 53195661, "question_id": 53195275, "link": "https://stackoverflow.com/questions/53195275/excel-vba-set-cell-value-to-variable-adjacent-to-all-cells-that-are-not-blank/53195661#53195661", "title": "Excel VBA - Set Cell Value to Variable Adjacent to All Cells that Are Not Blank", "body": "<p>Maybe something like this. </p>\n\n<ol>\n<li>You need to calculate your last row for each work book (destination and import) and you are currently doing so for just one book it looks like. For your destination book, the first available blank row (<code>LR</code>) will change every time you paste in a new range so this needs to be recalculated inside the loop before you open another book. On your import books, each file will presumably have varying rows, so this needs it's own last row calculation (<code>LR2</code>).</li>\n<li>I qualified your sheets where <code>ws</code> which refers to <code>Sheet1</code> on your destination book. We will then use <code>wbGRP.Sheets(1)</code> which will reference the first sheet on each import book you open. This may be need to be corrected (<em>Pending response from you in comments</em>)</li>\n<li>For <strong>Step 5</strong>, you will need to loop through your newly pasted data on <code>ws</code>. Where these rows exist can be deduced from your variables <code>LR</code> and <code>LR2</code>. Then just check if <code>Column A</code> is blank inside loop, and output <code>dateChooser</code> on desired column. I am pasting <code>dateChooser</code> in <code>Column B</code> here (<em>Also pending response from you in comments</em>)</li>\n<li>Kudos on having <code>Option Explicit</code>. I did re-organize a few things here (Declare statics outside of screen updating, group like variables, etc. </li>\n</ol>\n\n<p>This is not tested. Will be happy to make edits when you get to questions in comments</p>\n\n<hr>\n\n<pre><code>Option Explicit\n\nSub ImportGroups()\n\nDim ws As Worksheet: Set ws = ThisWorkbook.Sheets(\"Sheet1\")\nDim fPATH As String, fNAME As String\nDim LR As Long, LR2 As Long, i As Long\nDim wbGRP As Workbook, dateChooser As Variant\n\nfPATH = \"C:\\&lt;path&gt;\\\"\nfNAME = Dir(fPATH &amp; \"*\")\n\nApplication.DisplayAlerts = False\n    Do While Len(fNAME) &gt; 0\n        Set wbGRP = Workbooks.Open(fPATH &amp; fNAME)   'open the file\n        LR = ws.Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1).Row  'how many rows of info?\n\n        If LR &gt; 3 Then\n            dateChooser = InputBox(\"Enter date based on this file name: \" &amp; fNAME)\n            LR2 = wbGRP.Sheets(1).Range(\"A\" &amp; wbGRP.Sheets(1).Rows.Count).End(xlUp).Row\n            wbGRP.Sheets(1).Range(\"A1:A\" &amp; LR2).Copy\n            ws.Range(\"B\" &amp; LR).End(xlUp).PasteSpecial xlPasteValues\n\n            For i = LR To (LR + LR2 - 1)\n                If ws.Range(\"A\" &amp; i) = \"\" Then ws.Range(\"B\" &amp; i) = dateChooser\n            Next i\n        End If\n\n        wbGRP.Close False\n        fNAME = Dir\n    Loop\nApplication.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 7475461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4172df384df21367004619f5489ac700?s=128&d=identicon&r=PG&f=1", "display_name": "K. Bow", "link": "https://stackoverflow.com/users/7475461/k-bow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 183, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1541615594, "creation_date": 1541614035, "question_id": 53195275, "link": "https://stackoverflow.com/questions/53195275/excel-vba-set-cell-value-to-variable-adjacent-to-all-cells-that-are-not-blank", "title": "Excel VBA - Set Cell Value to Variable Adjacent to All Cells that Are Not Blank", "body": "<p>I have multiple reports that I need to compile into a single master file following specific steps, then put a date to the left of the new data. The steps that need to be followed are:</p>\n\n<ol>\n<li>Open a file in Directory</li>\n<li>Set a variable based on the file name to be used in a later step (I am using an InputBox function for this)</li>\n<li>Copy all cells with data in column A from that file</li>\n<li>Paste the cell data into the first blank cell in column B for my master file</li>\n<li><strong>If there is data in column B and the adjacent cell in column A is blank, change that cell's value to the variable chosen in Step 2</strong></li>\n<li>Close the file and open the next file in the directory</li>\n</ol>\n\n<p>So basically, it needs to open File X, copy everything from column A of File X to column B of the Master, then insert a date in column B of the master for each row that has data in column B</p>\n\n<p>I'm stuck on Step 5 and cannot figure out a way to find all cells that had data pasted into them from Step 4 and set the value of all cells directly to the left of them.</p>\n\n<pre><code>Option Explicit\n\nSub ImportGroups()\nDim fPATH As String, fNAME As String\nDim LR As Long, NR As Long\nDim wbGRP As Workbook, wsDEST As Worksheet\nDim dateChooser As Variant\nDim cell As Range\n\n\nSet wsDEST = ActiveWorkbook.Sheets(\"Sheet1\")\n\n\nApplication.DisplayAlerts = False\n\nfPATH = \"C:\\&lt;path&gt;\\\"       'remember the final \\ in this string\n\nfNAME = Dir(fPATH &amp; \"*\")        'get the first filename in fpath\n\nDo While Len(fNAME) &gt; 0\n    Set wbGRP = Workbooks.Open(fPATH &amp; fNAME)   'open the file\n    LR = Range(\"A\" &amp; Rows.Count).End(xlUp).Row  'how many rows of info?\n\n    If LR &gt; 3 Then\n\n        dateChooser = InputBox(\"Enter date based on this file name: \" &amp; fNAME)\n\n        ActiveSheet.Range(\"A1:A\" &amp; LR).Copy\n        wsDEST.Cells(Rows.Count, 2).End(xlUp).Offset(1, 0).PasteSpecial xlPasteValue\n\n        ' This is where I need to set the value of all cells adjacent to the pasted cells\n\n    End If\n\n    wbGRP.Close False   'close data workbook\n        fNAME = Dir         'get the next filename\nLoop\nApplication.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "activex"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 10619850, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KStYli4etno/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCK44XI6Jkb-aqiqT6GDo_XERJ3ww/mo/photo.jpg?sz=128", "display_name": "Brad", "link": "https://stackoverflow.com/users/10619850/brad"}, "edited": false, "score": 0, "creation_date": 1541772904, "post_id": 53202333, "comment_id": 93341446, "body": "sdda, thanks for the response.  My problem isn&#39;t so much that the buttons change size, but that they flat out don&#39;t work.  Drag workbook to main display and everything works fine; drag it over to the second display, and you can no longer click the buttons."}], "tags": [], "owner": {"reputation": 26, "user_id": 10620350, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jdVXB.jpg?s=128&g=1", "display_name": "sdda", "link": "https://stackoverflow.com/users/10620350/sdda"}, "is_accepted": false, "score": 0, "last_activity_date": 1541657430, "creation_date": 1541657430, "answer_id": 53202333, "question_id": 53195206, "link": "https://stackoverflow.com/questions/53195206/active-x-command-buttons-with-second-display/53202333#53202333", "title": "Active X Command Buttons with Second Display", "body": "<p>unfortunately I had the same issue. It's not related to hardware, but software. If you change the resolution of the screen or projector (in my case), the active x buttons are starting to grow and deform.</p>\n\n<p>The solution what I used is, to run this code on every active x action (just make a <code>call</code> for the <code>sub</code>), to make sure the buttons/labels etc are on their right place.</p>\n\n<pre><code>Set wbkWorkbook1 = ThisWorkbook\n\nSet Rng = wbkWorkbook1.Worksheets(\"WS1\").Range(\"A14:F15\")\nwbkWorkbook1.Worksheets(\"WS1\").BTN.Width = Rng.Width\nwbkWorkbook1.Worksheets(\"WS1\").BTN.Height = Rng.Height\nwbkWorkbook1.Worksheets(\"WS1\").BTN.Left = wbkWorkbook1.Worksheets(\"WS1\").Range(wbkWorkbook1.Worksheets(\"WS1\").BTN.TopLeftCell.Address).Left\nwbkWorkbook1.Worksheets(\"WS1\").BTN.Top = wbkWorkbook1.Worksheets(\"WS1\").Range(wbkWorkbook1.Worksheets(\"WS1\").BTN.TopLeftCell.Address).Top\n</code></pre>\n\n<p>What this code makes: In this example we have an active X button labelled '<strong>BTN</strong>' on the worksheet named '<strong>WS1</strong>'. \nOnce this script runs it aligns the BTN into the <strong>A14:F15</strong> range.</p>\n\n<p>So if you change the resolution and runs this code, your active x controls will be re-adjusted.</p>\n\n<p>You can go through on all controls with a <code>do ... loop until</code> procedure for sure.</p>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 10619850, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KStYli4etno/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCK44XI6Jkb-aqiqT6GDo_XERJ3ww/mo/photo.jpg?sz=128", "display_name": "Brad", "link": "https://stackoverflow.com/users/10619850/brad"}, "edited": false, "score": 0, "creation_date": 1566476333, "post_id": 57591031, "comment_id": 101673662, "body": "Karthick,  Thanks for the reply, I will go back and play with resolutions.  This makes sense because the Surface Pro&#39;s aspect ratio is closer to that of a square than a normal monitor. (3:2 vs. 16:9)"}], "tags": [], "owner": {"reputation": 11, "user_id": 11956817, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAIZuAbKbAedcD_i6l41tU_tx1kaDtLH3LYUgtTtA=k-s128", "display_name": "Karthick Nethaji", "link": "https://stackoverflow.com/users/11956817/karthick-nethaji"}, "is_accepted": false, "score": 1, "last_activity_date": 1566388413, "creation_date": 1566388413, "answer_id": 57591031, "question_id": 53195206, "link": "https://stackoverflow.com/questions/53195206/active-x-command-buttons-with-second-display/57591031#57591031", "title": "Active X Command Buttons with Second Display", "body": "<p>Brad, I had the same problem where the activex buttons became unclickable when get connected to the secondary display. The problem is solely because of the varied resolutions. Ensure that the secondary monitor has the same resolution as that of primary monitory. In my case, my secondary monitor was a projector and I changed its resolution to 1366x768 which is what being used in the laptop. It then worked. </p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 12202236, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mC9vHmJtz5Hf02v2onF244OxkhrwzjpbGeLKr-Qfg=k-s128", "display_name": "LRivera", "link": "https://stackoverflow.com/users/12202236/lrivera"}, "is_accepted": false, "score": 0, "last_activity_date": 1570810618, "creation_date": 1570810618, "answer_id": 58345085, "question_id": 53195206, "link": "https://stackoverflow.com/questions/53195206/active-x-command-buttons-with-second-display/58345085#58345085", "title": "Active X Command Buttons with Second Display", "body": "<p>I deal with the same issue in a computer a couple months ago, I ended changing the  ActiveX buttons to the form controls ones, a couple days ago, same thing happen, BUT this time i find along with the IT Supports for the company i work for, that you have to match the SCREEN SCALE on all the monitors you have connected, and that should solve the problem.. </p>\n\n<p>I know, is stupid, but that's the solution..</p>\n"}], "owner": {"reputation": 21, "user_id": 10619850, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KStYli4etno/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCK44XI6Jkb-aqiqT6GDo_XERJ3ww/mo/photo.jpg?sz=128", "display_name": "Brad", "link": "https://stackoverflow.com/users/10619850/brad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1259, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1570810618, "creation_date": 1541613804, "last_edit_date": 1566553960, "question_id": 53195206, "link": "https://stackoverflow.com/questions/53195206/active-x-command-buttons-with-second-display", "title": "Active X Command Buttons with Second Display", "body": "<p>I put Active X Command Buttons in an Excel Workbook.  They work just fine when the workbook is displayed on the primary monitor, but not when the workbook is displayed on the secondary monitor.  How do I fix this? </p>\n\n<p>I'm not sure if it is hardware specific, but I run a MS Surface Pro 5.  At home it is connected to a Surface Dock with two monitors; the device screen is duplicated to one monitor (primary) and the desktop is extended to the other.  On-the-go I use a portable monitor thru the Mini Display Port.  The problem occurs in both configurations. </p>\n"}, {"tags": ["excel", "vba", "function", "excel-formula"], "comments": [{"owner": {"reputation": 39, "user_id": 10525751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e34cd59347c3fcdc5e2a3150b1d34ff?s=128&d=identicon&r=PG&f=1", "display_name": "Dani", "link": "https://stackoverflow.com/users/10525751/dani"}, "edited": false, "score": 0, "creation_date": 1541613865, "post_id": 53195154, "comment_id": 93279128, "body": "Thanks dear for the editing"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1541628075, "post_id": 53195154, "comment_id": 93285637, "body": "Those dates, are they in a random order? Or can we assume it&#39;s reverse chronological order starting top row going down?"}, {"owner": {"reputation": 39, "user_id": 10525751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e34cd59347c3fcdc5e2a3150b1d34ff?s=128&d=identicon&r=PG&f=1", "display_name": "Dani", "link": "https://stackoverflow.com/users/10525751/dani"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1541628168, "post_id": 53195154, "comment_id": 93285670, "body": "Thanks for the reply. These can be in random as well as in chronological order"}, {"owner": {"reputation": 39, "user_id": 10525751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e34cd59347c3fcdc5e2a3150b1d34ff?s=128&d=identicon&r=PG&f=1", "display_name": "Dani", "link": "https://stackoverflow.com/users/10525751/dani"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1541628248, "post_id": 53195154, "comment_id": 93285699, "body": "If chronological order is necessary, i can sort these dates from newest to oldest"}, {"owner": {"reputation": 862, "user_id": 9211191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3abb20de4292973fd582868c407fc9e9?s=128&d=identicon&r=PG&f=1", "display_name": "Peter K.", "link": "https://stackoverflow.com/users/9211191/peter-k"}, "edited": false, "score": 0, "creation_date": 1541688562, "post_id": 53195154, "comment_id": 93308279, "body": "Are you sure there always be <b>at least</b> 4 dates for each Salon ?"}, {"owner": {"reputation": 862, "user_id": 9211191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3abb20de4292973fd582868c407fc9e9?s=128&d=identicon&r=PG&f=1", "display_name": "Peter K.", "link": "https://stackoverflow.com/users/9211191/peter-k"}, "edited": false, "score": 0, "creation_date": 1541719869, "post_id": 53195154, "comment_id": 93323135, "body": "@Dani Hi, could you update/fine-tune your question with the comment you made on the answer of MichalRosa ? My own answer is for the original question (average for last 4 dates), but it seems you actually want the average of the 2nd last date until the 4th last? So does that mean the average of 3 values? Or of 4 values (from 2nd last until 5th last)?"}, {"owner": {"reputation": 39, "user_id": 10525751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e34cd59347c3fcdc5e2a3150b1d34ff?s=128&d=identicon&r=PG&f=1", "display_name": "Dani", "link": "https://stackoverflow.com/users/10525751/dani"}, "edited": false, "score": 0, "creation_date": 1541750189, "post_id": 53195154, "comment_id": 93330353, "body": "I am really sorry for the confusion caused by my question. Yes Michal&#39;s answer worked for my original post then i asked again in the comments and it is not necessary that it should have atleast 4 or 5 dates, number of dates can be more or less but if dates are less than 5 then i will ignore those records. dates atleast should be 5 to calculate this. i hope i cleared y question"}, {"owner": {"reputation": 862, "user_id": 9211191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3abb20de4292973fd582868c407fc9e9?s=128&d=identicon&r=PG&f=1", "display_name": "Peter K.", "link": "https://stackoverflow.com/users/9211191/peter-k"}, "edited": false, "score": 0, "creation_date": 1541751623, "post_id": 53195154, "comment_id": 93330953, "body": "@Dani That&#39;s fine, it is natural that a question evolves. I updated my answer, and made it flexible (with two parameters), so you can use the same formula to calculate different variations for your analysis."}, {"owner": {"reputation": 39, "user_id": 10525751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e34cd59347c3fcdc5e2a3150b1d34ff?s=128&d=identicon&r=PG&f=1", "display_name": "Dani", "link": "https://stackoverflow.com/users/10525751/dani"}, "reply_to_user": {"reputation": 862, "user_id": 9211191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3abb20de4292973fd582868c407fc9e9?s=128&d=identicon&r=PG&f=1", "display_name": "Peter K.", "link": "https://stackoverflow.com/users/9211191/peter-k"}, "edited": false, "score": 0, "creation_date": 1541751818, "post_id": 53195154, "comment_id": 93331042, "body": "@Peter K Yeah i included and it works like a charm. Thank you so much for all the help and support."}, {"owner": {"reputation": 862, "user_id": 9211191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3abb20de4292973fd582868c407fc9e9?s=128&d=identicon&r=PG&f=1", "display_name": "Peter K.", "link": "https://stackoverflow.com/users/9211191/peter-k"}, "edited": false, "score": 0, "creation_date": 1541752838, "post_id": 53195154, "comment_id": 93331505, "body": "You&#39;re welcome. I updated my answer with some explanation. I hope it helps."}, {"owner": {"reputation": 39, "user_id": 10525751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e34cd59347c3fcdc5e2a3150b1d34ff?s=128&d=identicon&r=PG&f=1", "display_name": "Dani", "link": "https://stackoverflow.com/users/10525751/dani"}, "edited": false, "score": 0, "creation_date": 1541756217, "post_id": 53195154, "comment_id": 93333108, "body": "Yeah it helped a lot, this even only not resolved my problem but also gave me clarification. Salute to your Sir."}, {"owner": {"reputation": 862, "user_id": 9211191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3abb20de4292973fd582868c407fc9e9?s=128&d=identicon&r=PG&f=1", "display_name": "Peter K.", "link": "https://stackoverflow.com/users/9211191/peter-k"}, "edited": false, "score": 0, "creation_date": 1541757751, "post_id": 53195154, "comment_id": 93333880, "body": "Ok thanks. If your question was fully answered, please do not forget to &quot;close&quot; the topic by accepting the answer that was most helpful / best solution."}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 10525751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e34cd59347c3fcdc5e2a3150b1d34ff?s=128&d=identicon&r=PG&f=1", "display_name": "Dani", "link": "https://stackoverflow.com/users/10525751/dani"}, "edited": false, "score": 0, "creation_date": 1541649270, "post_id": 53199732, "comment_id": 93291042, "body": "Thanks michal, can i also have solution if i want to start with 2nd lastest date down to 4?"}, {"owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "reply_to_user": {"reputation": 39, "user_id": 10525751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e34cd59347c3fcdc5e2a3150b1d34ff?s=128&d=identicon&r=PG&f=1", "display_name": "Dani", "link": "https://stackoverflow.com/users/10525751/dani"}, "edited": false, "score": 0, "creation_date": 1541649657, "post_id": 53199732, "comment_id": 93291148, "body": "Welcome.       =SUMPRODUCT((salon=F2)*(coach=G2)*(date&gt;=LARGE(date,4))*(dat&zwnj;&#8203;e&lt;=LARGE(date,2))*am&zwnj;&#8203;ount)/3"}, {"owner": {"reputation": 39, "user_id": 10525751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e34cd59347c3fcdc5e2a3150b1d34ff?s=128&d=identicon&r=PG&f=1", "display_name": "Dani", "link": "https://stackoverflow.com/users/10525751/dani"}, "edited": false, "score": 0, "creation_date": 1541650385, "post_id": 53199732, "comment_id": 93291275, "body": "Main purpose behide this is that i want to calculate % of change between the amount of lastest date to average of prevoius 4 latest date, so that is why i need average amount of 4 latest date excluding the latest date."}, {"owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "reply_to_user": {"reputation": 39, "user_id": 10525751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e34cd59347c3fcdc5e2a3150b1d34ff?s=128&d=identicon&r=PG&f=1", "display_name": "Dani", "link": "https://stackoverflow.com/users/10525751/dani"}, "edited": false, "score": 0, "creation_date": 1541651984, "post_id": 53199732, "comment_id": 93291643, "body": "Just change the number in date&gt;=LARGE(date,4) and (date&lt;=LARGE(date,2) as required.  Cheers,"}, {"owner": {"reputation": 39, "user_id": 10525751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e34cd59347c3fcdc5e2a3150b1d34ff?s=128&d=identicon&r=PG&f=1", "display_name": "Dani", "link": "https://stackoverflow.com/users/10525751/dani"}, "edited": false, "score": 0, "creation_date": 1541656563, "post_id": 53199732, "comment_id": 93292733, "body": "Yeah i have change but this is giving me correct values when i use range and when i use table column it doesn&#39;t give me correct value. Please see below my formula: =SUMPRODUCT((SalonInput[Salon]=&#39;Per Change&#39;!A2)*(SalonInput[Coach]=&#39;Per Change&#39;!B2)*(SalonInput[Week Ending]&gt;=LARGE(SalonInput[Week Ending],5))*(SalonInput[Week Ending]&lt;=LARGE(SalonInput[Week Ending],2))*SalonInput[Weekly Takings])/4"}, {"owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "reply_to_user": {"reputation": 39, "user_id": 10525751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e34cd59347c3fcdc5e2a3150b1d34ff?s=128&d=identicon&r=PG&f=1", "display_name": "Dani", "link": "https://stackoverflow.com/users/10525751/dani"}, "edited": false, "score": 0, "creation_date": 1541657806, "post_id": 53199732, "comment_id": 93293053, "body": "=SUMPRODUCT( (Table1[Salon]=F2)* (Table1[coach]=G2)* (Table1[date]&gt;=LARGE(Table1[date],5))* (Table1[date]&lt;=LARGE(Table1[date],2))* Table1[amount])/4  You seem to have it right, I&#39;ve checked the calculations and as far as I can see they are correct.  What results do you get from your input which seem to be wrong?  Cheers,"}, {"owner": {"reputation": 39, "user_id": 10525751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e34cd59347c3fcdc5e2a3150b1d34ff?s=128&d=identicon&r=PG&f=1", "display_name": "Dani", "link": "https://stackoverflow.com/users/10525751/dani"}, "edited": false, "score": 0, "creation_date": 1541658819, "post_id": 53199732, "comment_id": 93293322, "body": "Dear Your Solution works if we have one salon type and one Coach type for example i have list of salons and Coaches and i don&#39;t want to change ranges separately for  every salon just say the same range is not working for Sal2 col2."}, {"owner": {"reputation": 39, "user_id": 10525751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e34cd59347c3fcdc5e2a3150b1d34ff?s=128&d=identicon&r=PG&f=1", "display_name": "Dani", "link": "https://stackoverflow.com/users/10525751/dani"}, "edited": false, "score": 0, "creation_date": 1541659162, "post_id": 53199732, "comment_id": 93293422, "body": "I have added image in original question please see that for clarification"}, {"owner": {"reputation": 39, "user_id": 10525751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e34cd59347c3fcdc5e2a3150b1d34ff?s=128&d=identicon&r=PG&f=1", "display_name": "Dani", "link": "https://stackoverflow.com/users/10525751/dani"}, "edited": false, "score": 0, "creation_date": 1541751917, "post_id": 53199732, "comment_id": 93331090, "body": "@ Michal, Your formula works like a charm and thank you for all the help and support"}], "tags": [], "owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "is_accepted": false, "score": 1, "last_activity_date": 1541715906, "last_edit_date": 1541715906, "creation_date": 1541635476, "answer_id": 53199732, "question_id": 53195154, "link": "https://stackoverflow.com/questions/53195154/average-of-four-dates-with-multiple-criteria/53199732#53199732", "title": "Average of four dates with multiple criteria", "body": "<p><a href=\"https://i.stack.imgur.com/c8LN2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/c8LN2.png\" alt=\"enter image description here\"></a></p>\n\n<p>Well, this one should work.  I hope I've tested it for all possible scenarios.</p>\n\n<pre><code> =SUMPRODUCT(\n (Table1[Salon]=G5)*(Table1[coach]=H5)*\n (Table1[date]&gt;=LARGE(((Table1[Salon]=G5)*(Table1[coach]=H5)*(Table1[date])),5))*\n (Table1[date]&lt;=LARGE(((Table1[Salon]=G5)*(Table1[coach]=H5)*(Table1[date])),2))*\n Table1[amount])/4\n</code></pre>\n\n<p>Let me know how it works for you.</p>\n\n<p>Cheers,</p>\n"}, {"comments": [{"owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "edited": false, "score": 0, "creation_date": 1541716311, "post_id": 53211083, "comment_id": 93321968, "body": "Sorry to say but it doesn&#39;t work for multiple Salon/coach combinations the same reason my first solutions were wrong.  You have to create separate date arrays for each combination."}, {"owner": {"reputation": 862, "user_id": 9211191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3abb20de4292973fd582868c407fc9e9?s=128&d=identicon&r=PG&f=1", "display_name": "Peter K.", "link": "https://stackoverflow.com/users/9211191/peter-k"}, "reply_to_user": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "edited": false, "score": 0, "creation_date": 1541718899, "post_id": 53211083, "comment_id": 93322851, "body": "@MichalRosa Did you test the formula, and if so, what is wrong with the result? With my solution, the data arrays are calculated dynamically within the formula, so do not need to be created separately. This formula works for all possible combinations of Salon and Coach, so I am not sure why it does not work for you?"}, {"owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "edited": false, "score": 0, "creation_date": 1541719960, "post_id": 53211083, "comment_id": 93323166, "body": "I have tested it.  Please try it yourself with multiple Salons and Coaches - use an input table as shown in my answer.  You have to check dates for each Salon/Coach combination separately.  Have a look at the screenshot - <a href=\"https://drive.google.com/open?id=1iTftH_8nEeB7oD1ZzniMDYjiZek0wlsO\" rel=\"nofollow noreferrer\">drive.google.com/open?id=1iTftH_8nEeB7oD1ZzniMDYjiZek0wlsO</a> - values in column E are calculated mannualy, values in column I are from my formula, values in column J come from your formula.  Cheers, Michal"}, {"owner": {"reputation": 862, "user_id": 9211191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3abb20de4292973fd582868c407fc9e9?s=128&d=identicon&r=PG&f=1", "display_name": "Peter K.", "link": "https://stackoverflow.com/users/9211191/peter-k"}, "reply_to_user": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "edited": false, "score": 0, "creation_date": 1541720552, "post_id": 53211083, "comment_id": 93323328, "body": "But my formula is still answering the original question, i.e. average of last 4 dates, and I read in the comments from @Dani under your answer (and also what you wrote in the screenshot in you answer) that you calculate &quot;previous 4 without the last one&quot; ?"}, {"owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "edited": false, "score": 0, "creation_date": 1541721644, "post_id": 53211083, "comment_id": 93323558, "body": "Peter, your formula works only if there is one combination of Salon/Coach, it fails if there are more.  It&#39;s that simple. It answers the original problem as posed but not the extended problem presented later. Please do check it yourself.  Cheers, Michal"}, {"owner": {"reputation": 862, "user_id": 9211191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3abb20de4292973fd582868c407fc9e9?s=128&d=identicon&r=PG&f=1", "display_name": "Peter K.", "link": "https://stackoverflow.com/users/9211191/peter-k"}, "reply_to_user": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "edited": false, "score": 0, "creation_date": 1541722101, "post_id": 53211083, "comment_id": 93323648, "body": "My formula must be put in place of the question marks in the original question, i.e. next to Sal1 and col1, and it takes these two values as input and gives the result. The formula needs then of course to be copied down, and will work for any combination of Salon/Coach that will be put next to the formula (and for which input data is available!). This is indeed not explicitly explained in my answer."}, {"owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "edited": false, "score": 0, "creation_date": 1541722873, "post_id": 53211083, "comment_id": 93323845, "body": "Peter, please have a look at this - <a href=\"https://drive.google.com/open?id=1yII_gYF_G21VX7X12bTPTSTEEDDMy5sU\" rel=\"nofollow noreferrer\">drive.google.com/open?id=1yII_gYF_G21VX7X12bTPTSTEEDDMy5sU</a> it&#39;s a spreadsheet with your formula calculating a table with multiple combinations of Salon/Coach.  Your formula is in column J, mine is in column I.  Please study it.  Regards, Michal"}, {"owner": {"reputation": 862, "user_id": 9211191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3abb20de4292973fd582868c407fc9e9?s=128&d=identicon&r=PG&f=1", "display_name": "Peter K.", "link": "https://stackoverflow.com/users/9211191/peter-k"}, "reply_to_user": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "edited": false, "score": 0, "creation_date": 1541724057, "post_id": 53211083, "comment_id": 93324056, "body": "Michal, you made a mistake in changing the references of the IFs: you have <code>($B$2:$B$16=G3)</code> but it should be <code>($A$2:$A$16=G3)</code>. The result will still be different than yours, because we are calculating different things (see one of my previous comments). If you use the Version 2 of my solution, this will give you full control over the range of dates to average."}, {"owner": {"reputation": 862, "user_id": 9211191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3abb20de4292973fd582868c407fc9e9?s=128&d=identicon&r=PG&f=1", "display_name": "Peter K.", "link": "https://stackoverflow.com/users/9211191/peter-k"}, "reply_to_user": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "edited": false, "score": 0, "creation_date": 1541725139, "post_id": 53211083, "comment_id": 93324273, "body": "Here is your spreadsheet back, corrected and with v2 of the formula (and with parameters set to duplicate your calculation) : <a href=\"https://wetransfer.com/downloads/2e5d1203be422fe4c489508f1c8019d720181109005506/388d89\" rel=\"nofollow noreferrer\">wetransfer.com/downloads/&hellip;</a>"}], "tags": [], "owner": {"reputation": 862, "user_id": 9211191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3abb20de4292973fd582868c407fc9e9?s=128&d=identicon&r=PG&f=1", "display_name": "Peter K.", "link": "https://stackoverflow.com/users/9211191/peter-k"}, "is_accepted": true, "score": 2, "last_activity_date": 1541757576, "last_edit_date": 1541757576, "creation_date": 1541691357, "answer_id": 53211083, "question_id": 53195154, "link": "https://stackoverflow.com/questions/53195154/average-of-four-dates-with-multiple-criteria/53211083#53211083", "title": "Average of four dates with multiple criteria", "body": "<p><strong>Final Version</strong> (flexible date parameters &amp; defined names)</p>\n\n<p>With an array function (so you have to enter this with ctrl+shift+enter), and with named ranges to make the formula better understandable :  </p>\n\n<pre><code>{=AVERAGE(IF(\n     (r_salon=A14)*\n     (r_coach=B14)*\n     (r_date&gt;=LARGE(IF((r_salon=A14)*(r_coach=B14);r_date;);\n                    MIN(d_last;COUNTIFS(r_salon;A14;r_coach;B14))))*\n     (r_date&lt;=LARGE(IF((r_salon=A14)*(r_coach=B14);r_date;);\n                    MIN(d_first;COUNTIFS(r_salon;A14;r_coach;B14))));\n      r_amount))} \n</code></pre>\n\n<p>For testing, I put the formula on the same sheet as the data, so Sal1 is in cell <code>A14</code> and col1 in cell <code>B14</code>. </p>\n\n<p>Explanation of the formula (so you can fine-tune if needed) :</p>\n\n<ul>\n<li>The two inner <code>IF</code> create an array of all dates for Sal1 and col1 (cells <code>A14</code> and <code>B14</code>), and the <code>LARGE</code> functions around it takes the n-th largest value; the n is actually calculated as the minimum of <code>d_first</code> or <code>d_last</code> respectively <em>and</em> the number of dates/rows actually present for the sal1/col1 combination (this will take care of the case that for some Salon/Coach combination(s) there could be less than <code>d_first</code> or <code>d_last</code> dates;</li>\n<li>The outer <code>IF</code> then creates an array of all dates that meet all criteria, i.e. for Sal1 <em>AND</em> col1 <em>AND</em> that are after <code>d_first</code> <em>AND</em> before <code>d_last</code> (calculated with the inner <code>IF</code> in the previous step); The <code>*</code> is shorthand for the <code>AND</code> operator, which also works for array formula's (the <code>AND</code> doesn't);</li>\n<li>The <code>AVERAGE</code> is trivial of course.</li>\n</ul>\n\n<p>To make the formula more flexible, I used two parameter (defined names): <code>d_first</code> is the most recent date you want to include, and <code>d_last</code> is the last date you want to include. Some examples:  </p>\n\n<ul>\n<li><code>d_first=2</code> and <code>d_last=5</code> : to answer your actual (updated) question, i.e. average for 4 dates, starting with the 2nd most recent until the 5th most recent;</li>\n<li><code>d_first=1</code> and <code>d_last=4</code> : this is the same as the first version of the answer, i.e. the result will be the average of the 4 most recent dates;</li>\n<li><code>d_first=2</code> and <code>d_last=4</code> : this will be the average of the 2nd most recent date until the 4th;</li>\n<li><code>d_first=1</code> and <code>d_last=1</code> : this will just result in the most recent date (average of one value is just the value itself).</li>\n</ul>\n\n<p>You just have to make sure that <code>d_first</code> is a positive integer (greater than zero), and <code>d_last</code> must be greater or equal than <code>d_first</code>. If they are greater than the total number of dates in the data-set, the result is the value corresponding with the earliest date.</p>\n\n<p>You also have to think about what happens if you have multiple entries for the same date. The current formula works with cut-off dates (earliest and latest), and not with number of records to actually average ((if you have several records with the same date that is within the cut-off dates, all these will be used in the calculation of the average). </p>\n\n<p><strong>Version 2</strong> (adding more flexibility)</p>\n\n<p>The formula :  </p>\n\n<p><code>{=AVERAGE(IF(($A$2:$A$11=A14)*($B$2:$B$11=B14)*($C$2:$C$11&gt;=LARGE(IF(($A$2:$A$11=A14)*($B$2:$B$11=B14);$C$2:$C$11;);MIN(d_last;COUNTIFS($A$2:$A$11;A14;$B$2:$B$11;B14))))*($C$2:$C$11&lt;=LARGE(IF(($A$2:$A$11=A14)*($B$2:$B$11=B14);$C$2:$C$11;);MIN(d_first;COUNTIFS($A$2:$A$11;A14;$B$2:$B$11;B14))));$D$2:$D$11))}</code></p>\n\n<p><strong>Version 1</strong> (original question, i.e. avg of last 4 dates; this is not relevant, as the question has been updated)  </p>\n\n<p>You can accomplish that with the following array formula (so you have to enter this with ctrl+shift+enter): </p>\n\n<p><code>{=AVERAGE(IF(($A$2:$A$11=A14)*($B$2:$B$11=B14)*($C$2:$C$11&gt;=LARGE(IF(($A$2:$A$11=A14)*($B$2:$B$11=B14);$C$2:$C$11;);MIN(4;COUNTIFS($A$2:$A$11;A14;$B$2:$B$11;B14))));$D$2:$D$11))}</code>   </p>\n\n<p><strong>Note</strong><br>\n(<em>just FYI, and in case you debug the formula with F9 and inspect the various array intermediate results</em>)<br>\nThe arrays not only contains the values that meet the condition(s), but will be the same size than the argument of the <code>IF</code> (i.e. will have as many values as there are rows in your data set), and is filled with <code>FALSE</code> for the rows that do not match the condition(s). As the <code>AVERAGE</code> function (like many others) does not take into account the <code>FALSE</code> values, this has no impact on the result, hence I did not make the formula overly complex to keep only the matching dates in the arrays.</p>\n"}], "owner": {"reputation": 39, "user_id": 10525751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e34cd59347c3fcdc5e2a3150b1d34ff?s=128&d=identicon&r=PG&f=1", "display_name": "Dani", "link": "https://stackoverflow.com/users/10525751/dani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 53211083, "answer_count": 2, "score": 1, "last_activity_date": 1557150511, "creation_date": 1541613647, "last_edit_date": 1557150511, "question_id": 53195154, "link": "https://stackoverflow.com/questions/53195154/average-of-four-dates-with-multiple-criteria", "title": "Average of four dates with multiple criteria", "body": "<p>I have two Excel sheets. Sheet 1 has the following records:</p>\n\n<pre><code>Salon          coach       date         amount\nSal1           col1       11/7/2018     500\nSal1           col1       11/1/2018     400\nSal1           col1       10/25/2018    600\nSal1           col1       10/19/2018    700\nSal1           col1       10/1/2018     250\nAnd so on\n</code></pre>\n\n<p>Sheet 2 has the following cloumns and records:</p>\n\n<pre><code>Salon         coach       average of lastest 4 dates\nSal1          col1                       ???\n</code></pre>\n\n<p>I want to find the average amount for the four latest dates excluding the most recent date. Calculation should start from 2nd latest date to 5th latest date with matching the criteria salon and coach.</p>\n\n<p><a href=\"https://i.stack.imgur.com/qXhmS.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qXhmS.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1541613390, "post_id": 53194978, "comment_id": 93278912, "body": "Just do <code>xlCell.Select</code>. You&#39;ve already declared <code>xlCell</code> as a <code>Range</code>, so no need to wrap it in <code>Range()</code>."}, {"owner": {"reputation": 23, "user_id": 10619809, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-4lMLVcwBmuk/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCWw0IfvySOS4Kg-RkTaoIGzTpZEQ/mo/photo.jpg?sz=128", "display_name": "Eric R", "link": "https://stackoverflow.com/users/10619809/eric-r"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1541613890, "post_id": 53194978, "comment_id": 93279140, "body": "I&#39;ve tried this as well, unfortunately it gives a different error &#39;Run-time error &#39;438&#39;: Object doesn&#39;t support this propert or method."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1541614269, "post_id": 53194978, "comment_id": 93279308, "body": "what is your active sheet when you&#39;re running this code?"}, {"owner": {"reputation": 23, "user_id": 10619809, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-4lMLVcwBmuk/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCWw0IfvySOS4Kg-RkTaoIGzTpZEQ/mo/photo.jpg?sz=128", "display_name": "Eric R", "link": "https://stackoverflow.com/users/10619809/eric-r"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1541614325, "post_id": 53194978, "comment_id": 93279330, "body": "The code is attached to a command button on HomeSheet, I want it to search on DataSheet and select a cell on DataSheet"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1541615023, "post_id": 53194978, "comment_id": 93279645, "body": "then add a &#39;xlSheet.Activate&#39; before that select line."}, {"owner": {"reputation": 23, "user_id": 10619809, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-4lMLVcwBmuk/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCWw0IfvySOS4Kg-RkTaoIGzTpZEQ/mo/photo.jpg?sz=128", "display_name": "Eric R", "link": "https://stackoverflow.com/users/10619809/eric-r"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1541616028, "post_id": 53194978, "comment_id": 93280096, "body": "Thank you so much, that worked!"}], "owner": {"reputation": 23, "user_id": 10619809, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-4lMLVcwBmuk/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCWw0IfvySOS4Kg-RkTaoIGzTpZEQ/mo/photo.jpg?sz=128", "display_name": "Eric R", "link": "https://stackoverflow.com/users/10619809/eric-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1541613264, "creation_date": 1541612875, "last_edit_date": 1541613264, "question_id": 53194978, "link": "https://stackoverflow.com/questions/53194978/excel-how-do-i-use-a-cell-value-in-one-sheet-to-go-to-another-value-on-a-separ", "title": "Excel - How do I use a cell value in one sheet to go to another value on a separate sheet in same workbook", "body": "<p>Right now I have a spot where the person will enter in their date they want to find and I want them to be able to push 'GO', this part is easy. I want it to look in another data sheet and go to and select the cell that corresponds with the value they put in the first sheet.</p>\n\n<p>For reference in my code below 'HomeSheet' is the user page where they enter the data. 'DataSheet' is the page I want them to be directed to when they push the button.</p>\n\n<p>Current code is giving me an error on the 3rd to last row where it's trying to select the cell it found that corresponded with the input date on the HomeSheet.</p>\n\n<p>Any help is greatly appreciated!</p>\n\n<pre><code>Private Sub CommandButton4_Click()\n\n    Dim xlRange As Range\n    Dim xlCell As Range\n    Dim xlSheet As Worksheet\n    Dim valueToFind\n\n    valueToFind = ThisWorkbook.Sheets(\"Homesheet\").Range(\"I8\")\n    Set xlSheet = ActiveWorkbook.Worksheets(\"DataSheet\")\n    Set xlRange = xlSheet.Range(\"A1:ZZ1\")\n\n    For Each xlCell In xlRange\n        If xlCell.Value = valueToFind Then\n        Sheets(\"DataSheet\").Range(xlCell).Select\n        End If\n    Next xlCell\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 2, "creation_date": 1541610796, "post_id": 53194280, "comment_id": 93277643, "body": "<a href=\"https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba\">This SO question&#39;s accepted answer</a> will help you find the first unused cell in a column. Presuming you wrote the rest of that code, you should have no problem moving on from there."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1541625398, "post_id": 53194280, "comment_id": 93284474, "body": "You mentioned you only want to copy from A to E but take note you&#39;ve got code that mentions column F <code>wsCopyFrom.Range(&quot;F2:F5000&quot;).Copy</code>"}, {"owner": {"reputation": 1, "user_id": 10619465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01adf7f7250ccceb28deb96ace847dcf?s=128&d=identicon&r=PG&f=1", "display_name": "Christian ", "link": "https://stackoverflow.com/users/10619465/christian"}, "edited": false, "score": 0, "creation_date": 1541694302, "post_id": 53194280, "comment_id": 93311807, "body": "I am sorry for the confusion.  I did say copy from A to E.  It should be copy to A to E.  The workbooks I copy from use Columns A to F.  I skip column E and past F from the one workbook  to E on the second work book.  To help clarify.  I copy column A from workbook 1 to A on workbook 2; B from workbook 1 to B on workbook 2; C from workbook 1 to C on workbook 2, D from workbook 1 to D on workbook 2 and F from workbook 1 to E on workbook 2."}, {"owner": {"reputation": 1, "user_id": 10619465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01adf7f7250ccceb28deb96ace847dcf?s=128&d=identicon&r=PG&f=1", "display_name": "Christian ", "link": "https://stackoverflow.com/users/10619465/christian"}, "edited": false, "score": 0, "creation_date": 1541694719, "post_id": 53194280, "comment_id": 93312049, "body": "Please ignore the coding for Sub Multi_FindReplace().  That was copied and pasted by mistake."}, {"owner": {"reputation": 1, "user_id": 10619465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01adf7f7250ccceb28deb96ace847dcf?s=128&d=identicon&r=PG&f=1", "display_name": "Christian ", "link": "https://stackoverflow.com/users/10619465/christian"}, "edited": false, "score": 0, "creation_date": 1541700797, "post_id": 53194280, "comment_id": 93315158, "body": "I found code that takes you to the first blank cell in a specified column. I verified that the code by itself takes you to the first empty cell in the specified column.  When I use it in the current codes I get the following run time error.  &quot;Run time error 1004:  Unable to get the Select property of the Range class.   The code is modified to:       wsCopyTo.Range(&quot;A2&quot;).End(xlDown).Offset(1, 0).Select.PasteSpecial Paste:=xlPasteValues, _             Operation:=xlNone, SkipBlanks:=True, Transpose:=False"}], "owner": {"reputation": 1, "user_id": 10619465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01adf7f7250ccceb28deb96ace847dcf?s=128&d=identicon&r=PG&f=1", "display_name": "Christian ", "link": "https://stackoverflow.com/users/10619465/christian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1541610307, "creation_date": 1541610060, "last_edit_date": 1541610307, "question_id": 53194280, "link": "https://stackoverflow.com/questions/53194280/using-a-macro-to-copy-to-first-blank-cell-that-is-variable", "title": "Using a Macro to copy to first blank cell that is variable", "body": "<p>I am trying to modify the below code so that it will be able to copy from one workbook to another and paste in the first empty blank cell in column A. For example if I copy and paste from A1 to E18 from one workbook, I want to be able to modify the code so that it opens a second workbook and copies and pastes the code from A19 (the first blank cell in A).  I am greener than green when it comes to VBA programming. I have looked at examples for similar situations but have not been able to figure out how to apply them to what I want to do.  Thank you! </p>\n\n<pre><code> Option Explicit\n\n   Sub FreezerLogImport()\n   Dim vFile As Variant\n   Dim wbCopyTo As Workbook\n   Dim wsCopyTo As Worksheet\n   Dim wbCopyFrom As Workbook\n   Dim wsCopyFrom As Worksheet\n\n   Set wbCopyTo = ActiveWorkbook\n   Set wsCopyTo = ActiveSheet\n\n\n   '-------------------------------------------------------------\n 'Open file with data to be copied\n\n     vFile = Application.GetOpenFilename(\"Excel Files (*.xl*),\" &amp; _\n     \"*.xl*\", 1, \"Select Excel File\", \"Open\", False)\n\n  'If Cancel then Exit\n      If TypeName(vFile) = \"Boolean\" Then\n           Exit Sub\n      Else\n    Set wbCopyFrom = Workbooks.Open(vFile)\n    Set wsCopyFrom = wbCopyFrom.Worksheets(1)\n    End If\n\n'--------------------------------------------------------------\n\n\n'Copy Range\n    wsCopyFrom.Range(\"A2:A5000\").Copy\n    wsCopyTo.Range(\"A2:A5000\").PasteSpecial Paste:=xlPasteValues, _\n            Operation:=xlNone, SkipBlanks:=True, Transpose:=False\n\n    wsCopyFrom.Range(\"B2:B5000\").Copy\n    wsCopyTo.Range(\"B2\").PasteSpecial Paste:=xlPasteValues, _\n            Operation:=xlNone, SkipBlanks:=True, Transpose:=False\n\n            wsCopyFrom.Range(\"C2:C5000\").Copy\n    wsCopyTo.Range(\"C2\").PasteSpecial Paste:=xlPasteValues, _\n            Operation:=xlNone, SkipBlanks:=True, Transpose:=False\n\n            wsCopyFrom.Range(\"D2:D5000\").Copy\n    wsCopyTo.Range(\"D2\").PasteSpecial Paste:=xlPasteValues, _\n            Operation:=xlNone, SkipBlanks:=True, Transpose:=False\n\n            wsCopyFrom.Range(\"F2:F5000\").Copy\n    wsCopyTo.Range(\"E2:E5000\").PasteSpecial Paste:=xlPasteValues, _\n            Operation:=xlNone, SkipBlanks:=True, Transpose:=False\n\n' Turn off Selection of last column\n\n    Application.Selection = False\n\n' Turn off CutCopyMode to prevent Clipboard message pop-up\n\n    Application.CutCopyMode = False\n\n'Close file that was opened\n    wbCopyFrom.Close SaveChanges:=False\n\nEnd Sub\n</code></pre>\n\n<p>.</p>\n\n<pre><code>Sub Multi_FindReplace()\n'PURPOSE: Find &amp; Replace a list of text/values throughout entire workbook\n' Finds M. tuberculosis and nontuberculosis mycobacteria and replaces them with MTBC and NTM, respectively.\n'SOURCE: www.TheSpreadsheetGuru.com/the-code-vault\n\nDim sheet1 As Worksheet\nDim fndList As Variant\nDim rplcList As Variant\nDim x As Long\n\nfndList = Array(\"M. tuberculosis\", \"Unidentified nontuberculosis mycobacteria (NTM)\")\nrplcList = Array(\"MTBC\", \"Unidentified NTM\")\n\n'Loop through each item in Array lists\n  For x = LBound(fndList) To UBound(fndList)\n    'Loop through each worksheet in ActiveWorkbook\n      For Each sheet1 In ActiveWorkbook.Worksheets\n        sheet1.Cells.Replace What:=fndList(x), Replacement:=rplcList(x), _\n          LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=False, _\n          SearchFormat:=False, ReplaceFormat:=False\n      Next sheet1\n\n  Next x\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook-addin", "late-binding"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1541610176, "post_id": 53194264, "comment_id": 93277321, "body": "Look up how to use <i>late binding</i> instead of <i>early binding</i>. There are helpful questions already on SO."}, {"owner": {"reputation": 11, "user_id": 10381687, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pP2Apgyn6mw/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOwZm54Mywl1eU46TTEg5Hi9wLccA/mo/photo.jpg?sz=128", "display_name": "Leonardo Stamato", "link": "https://stackoverflow.com/users/10381687/leonardo-stamato"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1541630799, "post_id": 53194264, "comment_id": 93286656, "body": "@BigBen Thanks for your help! I tried but I couldnt find a solution to paste the range as a picture, without having to open word Document."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1541631676, "post_id": 53194264, "comment_id": 93286926, "body": "You should be able to do that still with late binding. Maybe post your revised code?"}, {"owner": {"reputation": 11, "user_id": 10381687, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pP2Apgyn6mw/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOwZm54Mywl1eU46TTEg5Hi9wLccA/mo/photo.jpg?sz=128", "display_name": "Leonardo Stamato", "link": "https://stackoverflow.com/users/10381687/leonardo-stamato"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1541632665, "post_id": 53194264, "comment_id": 93287278, "body": "@BigBen This last code is where I stopped. I tried to copy a range of the report and paste as an image in the email body. it says the &quot;commentsrange&quot; on Call createJpg(ActiveSheet.comments, commentsrange, &quot;DashboardFile&quot;) is mismatching."}, {"owner": {"reputation": 11, "user_id": 10381687, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pP2Apgyn6mw/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOwZm54Mywl1eU46TTEg5Hi9wLccA/mo/photo.jpg?sz=128", "display_name": "Leonardo Stamato", "link": "https://stackoverflow.com/users/10381687/leonardo-stamato"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1541634230, "post_id": 53194264, "comment_id": 93287687, "body": "@BigBen how do I share the file with you? Thank you in advance"}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 1, "creation_date": 1544795319, "post_id": 53194264, "comment_id": 94413169, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/32939197/convert-early-binding-vba-to-late-binding-vba-excel-to-outlook-contacts\">Convert Early Binding VBA to Late Binding VBA : Excel to Outlook Contacts</a>"}], "owner": {"reputation": 11, "user_id": 10381687, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pP2Apgyn6mw/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOwZm54Mywl1eU46TTEg5Hi9wLccA/mo/photo.jpg?sz=128", "display_name": "Leonardo Stamato", "link": "https://stackoverflow.com/users/10381687/leonardo-stamato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 364, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1547223640, "creation_date": 1541609987, "last_edit_date": 1547223640, "question_id": 53194264, "link": "https://stackoverflow.com/questions/53194264/run-same-macro-in-different-versions-of-excel-outlook-word", "title": "Run same macro in different versions of Excel / Outlook / Word", "body": "<p>I generate reports to send to different branches. I run a macro that creates protected reports (*.xlsm). These reports have a space for comments for the Branch Managers, with a \"send Comments\" button that run this macro below.</p>\n\n<p>I suggested the following <a href=\"https://i.stack.imgur.com/9uZVd.png\" rel=\"nofollow noreferrer\">references</a> to add if the macro does not work.</p>\n\n<p>The Branch Managers have different versions of MS Office (Excel, Outlook, etc.) on their laptops. When they try to Run, it shows errors, such as: \"Error in Loadind DLL\"; <a href=\"https://i.stack.imgur.com/hnLia.png\" rel=\"nofollow noreferrer\">Error2</a>, etc.</p>\n\n<p>What should be done on the Branch Managers side to run this Macro?</p>\n\n<pre><code>Sub CommentsEmail()\n\nDim template As Workbook\nDim dashboard As Worksheet\nDim comments As Worksheet\nDim OutApp As Object\nDim OutMail As Object\nDim olApp As Outlook.Application\nDim mymail As Outlook.mailItem\nDim objSel As Word.Selection\nDim commentsrange As Range\nDim branch As String\nDim Sendto As String\n\nUpdateScreen = False\n\nShell (\"Outlook\")\n\nSet olApp = New Outlook.Application\nSet mymail = olApp.CreateItem(olMailItem)\nSet template = ActiveWorkbook\nSet dashboard = template.Worksheets(\"Dashboard\")\nSet comments = template.Worksheets(\"Comments\")\nbranch = dashboard.Cells(1, 25)\nSendto = comments.Cells(2, 10)\nSet commentsrange = comments.Range(Cells(7, 1), Cells(52, 4))\n\ntemplate.Activate\n\n\nSet OutApp = CreateObject(\"Outlook.Application\")\nSet OutMail = OutApp.CreateItem(0)\n\n'OutMail.Display\nDim wordDoc As Word.Document\nSet wordDoc = OutMail.GetInspector.WordEditor\n\nSet objSel = wordDoc.Windows(1).Selection\n\n        'construct the body of the email here\n        With objSel\n\n            'first text\n            .InsertAfter \"Dear All,\" &amp; vbCrLf\n            .Move wdParagraph, 1\n\n            'second text\n            .InsertAfter vbCrLf &amp; \"See below the Comments for Flash Indicator - \" &amp; branch &amp; vbCrLf &amp; vbCrLf\n            .Move wdParagraph, 1\n\n            'copy a range and paste a picture\n            commentsrange.Copy ''again, you need to modify your target range\n            .PasteAndFormat wdChartPicture\n            .Move wdParagraph, 1\n\n            .InsertAfter vbCrLf &amp; \"Let us know of any questions.\" &amp; vbCrLf &amp; vbCrLf\n            .Move wdParagraph, 1\n\n            .InsertAfter vbCrLf &amp; \"Kind Regards,\" &amp; vbCrLf\n        End With\n\n        OutMail.To = OutMail.To &amp; \";\" &amp; Sendto\n\n        With OutMail\n\n         .Subject = \"Comments on Flash Indicator Results - \" &amp; branch\n         .Attachments.Add (ActiveWorkbook.FullName)\n         .Display\n        End With\n\nOn Error GoTo 0\n\n        Set OutMail = Nothing\n        Set OutApp = Nothing\n\n\n        With Application\n            .ScreenUpdating = True\n            .EnableEvents = True\n        End With\n        Exit Sub\n\nEnd Sub\n</code></pre>\n\n<p>Is this still early binding? If yes, I am totally lost.</p>\n\n<pre><code>Sub CommentsEmail2()\n\nDim template As Workbook\nDim dashboard As Worksheet\nDim comments As Worksheet\nDim OlaApp As Object\nDim OleMail As Object\n\nDim TempFilePath As String\nDim xHTMLBody As String\n\nDim commentsrange As Range\nDim branch As String\nDim Sendto As String\n\nUpdateScreen = False\n\nSet template = ActiveWorkbook\nSet dashboard = template.Worksheets(\"Dashboard\")\nSet comments = template.Worksheets(\"Comments\")\nSet commentsrange = comments.Range(Cells(7, 1), Cells(52, 4))\n\nbranch = dashboard.Cells(1, 25)\nSendto = comments.Cells(2, 10)\n\ntemplate.Activate\n\n On Error Resume Next\n    Set olApp = GetObject(, \"Outlook.Application\")\n    If Err &lt;&gt; 0 Then Set olApp = CreateObject(\"Outlook.Application\")\n    On Error GoTo 0\n    Set OleMail = olApp.CreateItem(0)\n\nCall createJpg(ActiveSheet.comments, commentsrange, \"DashboardFile\")\n        TempFilePath = Environ$(\"temp\") &amp; \"\\\"\n        xHTMLBody = \"&lt;span LANG=EN&gt;\" _\n                &amp; \"&lt;p class=style2&gt;&lt;span LANG=EN&gt;&lt;font FACE=Calibri SIZE=3&gt;\" _\n                &amp; \"Hello, this is the data range that you want:&lt;br&gt; \" _\n                &amp; \"&lt;br&gt;\" _\n                &amp; \"&lt;img src='cid:DashboardFile.jpg'&gt;\" _\n                &amp; \"&lt;br&gt;Best Regards!&lt;/font&gt;&lt;/span&gt;\"\n        With OleMail\n            .Subject = \"test\"\n            .HTMLBody = xHTMLBody\n          .Attachments.Add TempFilePath &amp; \"DashboardFile.jpg\", olByValue\n          .Attachments.Add (ActiveWorkbook.FullName)\n            .To = \" \"\n            .Cc = \" \"\n            .Display\n        End With\n\n\n\n\n        Set OleMail = Nothing\n        Set OlaApp = Nothing\n\n\n        With Application\n            .ScreenUpdating = True\n            .EnableEvents = True\n        End With\n        Exit Sub\n\nEnd Sub\n\nSub createJpg(SheetName As String, commentsrange As String, nameFile As String)\n    Dim xRgPic As Range\n    ThisWorkbook.Activate\n    Worksheets(comments).Activate\n    Set xRgPic = ThisWorkbook.Worksheets(comments).Range(Cells(7, 1), Cells(52, 4))\n    xRgPic.CopyPicture\n    With ThisWorkbook.Worksheets(comments).ChartObjects.Add(xRgPic.Left, xRgPic.Top, xRgPic.Width, xRgPic.Height)\n        .Activate\n        .Chart.Paste\n        .Chart.Export Environ$(\"temp\") &amp; \"\\\" &amp; nameFile &amp; \".jpg\", \"JPG\"\n    End With\n    Worksheets(comments).ChartObjects(Worksheets(comments).ChartObjects.Count).Delete\nSet xRgPic = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1541609441, "post_id": 53194094, "comment_id": 93276918, "body": "<code>set r=Sheets(&quot;BD&quot;).Range(&quot;T3&quot;).resize(Sheets(&quot;BD&quot;).Range(&quot;T3:T50&zwnj;&#8203;000&quot;).end(xlUp).row,&zwnj;&#8203;1)</code>"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 1, "creation_date": 1541610631, "post_id": 53194094, "comment_id": 93277560, "body": "There is a growing consensus that this is a duplicate of a question about finding the last used row in a column. Is that what your question is about? If not, you&#39;ll have to clarify. Maybe <a href=\"https://stackoverflow.com/posts/53194094/edit\">edit</a> your post and include some more code."}], "answers": [{"tags": [], "owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "is_accepted": false, "score": 0, "last_activity_date": 1541610284, "creation_date": 1541610284, "answer_id": 53194342, "question_id": 53194094, "link": "https://stackoverflow.com/questions/53194094/efective-method-to-find-last-row-vba-excel/53194342#53194342", "title": "Efective method to find last row vba excel", "body": "<p>This might give you some ideas:</p>\n\n<pre><code>With Sheets(\"BD\")\n\n    ' Since T is column #20 and goes to 6 more\n    For col = 20 To 26\n\n        ' get last row\n        lastRow = .Cells(.Rows.Count, col).End(xlUp).Row\n\n        ' set range\n        Set yourRng = .Range(.Cells(3, col), .Cells(lastRow, col))\n\n        ' you might want to change 8,2 to make dynamic\n        ws.Cells(8, 2).Value = Application.WorksheetFunction.SumIfs(yourRng , EquipaBd, EquipaForm, AgenteBd, AgenteForm)\n\n    Next\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 5650329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/021503ecae4265393b3ef05723fe7d24?s=128&d=identicon&r=PG&f=1", "display_name": "P.Costa", "link": "https://stackoverflow.com/users/5650329/p-costa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "closed_date": 1541612684, "answer_count": 1, "score": 0, "last_activity_date": 1586399754, "creation_date": 1541609327, "last_edit_date": 1586399754, "question_id": 53194094, "link": "https://stackoverflow.com/questions/53194094/efective-method-to-find-last-row-vba-excel", "closed_reason": "Duplicate", "title": "Efective method to find last row vba excel", "body": "<p>i have the following method to set to define a ranga:</p>\n\n<pre><code>Set RegJan = Sheets(\"BD\").Range(\"T3:T50000\")\n</code></pre>\n\n<p>the range is smaller than this, but in order to make it work for some months, i set it to 50000 rows.</p>\n\n<p>i then use this code in the following line of vba:</p>\n\n<pre><code>ws.Cells(8, 2).Value = Application.WorksheetFunction.SumIfs(RegJan, \nEquipaBd, EquipaForm, AgenteBd, AgenteForm) 'Soma dos Registos\n</code></pre>\n\n<p>This last line i already transformed in a loop so that it calculates in every line i need it,the problem is that i have to do the first line of code  for every month of the year an for 6 more variables</p>\n\n<p>is there a better way of doing this? possibly a dynamic way?</p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 2, "last_activity_date": 1541606828, "creation_date": 1541606828, "answer_id": 53193328, "question_id": 53193138, "link": "https://stackoverflow.com/questions/53193138/vba-access-application-filedialog/53193328#53193328", "title": "VBA Access - Application.FileDialog", "body": "<p>Add  </p>\n\n<pre><code>.InitialFileName = CurrentProject.Path 'Or any path  \n</code></pre>\n\n<p>to the <code>With Application.FileDialog(3)</code> block.</p>\n"}], "owner": {"reputation": 389, "user_id": 9098538, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d5863ffca9fd9167d26eb2233bc2cd6f?s=128&d=identicon&r=PG&f=1", "display_name": "Shadyjunior", "link": "https://stackoverflow.com/users/9098538/shadyjunior"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 53193328, "answer_count": 1, "score": 0, "last_activity_date": 1541609353, "creation_date": 1541606315, "last_edit_date": 1541609353, "question_id": 53193138, "link": "https://stackoverflow.com/questions/53193138/vba-access-application-filedialog", "title": "VBA Access - Application.FileDialog", "body": "<p>Quick question, I have a simple bit of code which allows the user to click on a textbox and find the location of the required file. However, can I get this so that when the \"Browser\" popup appears, is so that it shows a specific file path ie; T:\\Production</p>\n\n<pre><code>Private Sub SideProfile_Click()\n\n        Dim vrtSelectedItem As Variant\n\n        With Application.FileDialog(3)\n            .AllowMultiSelect = False\n        If .Show = -1 Then\n            For Each vrtSelectedItem In .SelectedItems\n                SideProfile = \"#\" &amp; vrtSelectedItem &amp; \"#\"\n\n            Next vrtSelectedItem\n        Else\n            End If\n        End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "class", "dictionary", "compiler-errors"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1541606179, "post_id": 53193066, "comment_id": 93275083, "body": "No, this error is caused by <code>singleKey</code> returning a null object or a non-object from the <code>Dictionary</code>. Where are you filling <code>thecollection</code>?"}, {"owner": {"reputation": 37, "user_id": 6718386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f1ebbf304f0e6c09deec3a496370bf1?s=128&d=identicon&r=PG&f=1", "display_name": "Freddie Fred", "link": "https://stackoverflow.com/users/6718386/freddie-fred"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1541608042, "post_id": 53193066, "comment_id": 93276142, "body": "I am passing in a dictionary from another sub.  The dictionary is there.  I can see it in the locals window."}, {"owner": {"reputation": 37, "user_id": 6718386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f1ebbf304f0e6c09deec3a496370bf1?s=128&d=identicon&r=PG&f=1", "display_name": "Freddie Fred", "link": "https://stackoverflow.com/users/6718386/freddie-fred"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1541608303, "post_id": 53193066, "comment_id": 93276290, "body": "If I remove the &quot;Country&quot;, the code run and it returns the index number."}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1541608494, "post_id": 53193066, "comment_id": 93276385, "body": "It looks as if you are treating the value as an object, while it just is a number. Can you provide us with some of the code that populates the dictionary?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1541608617, "post_id": 53193066, "comment_id": 93276457, "body": "I wasn&#39;t implying that the dictionary wasn&#39;t there. I&#39;m saying the error is almost certainly because <code>thecollection.Item(singleKey)</code> is <code>Nothing</code>."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1541608623, "post_id": 53193066, "comment_id": 93276460, "body": "This question is impossible to answer without seeing the code that populates the dictionary. <code>.Country</code> is a member call that implies the dictionary is populated with objects that have a <code>Country</code> property. <code>.Item(singlekey)</code> returning a number points to the dictionary <i>not</i> being populated with object instances."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1541609333, "post_id": 53193066, "comment_id": 93276831, "body": "Ok, not <i>impossible</i>."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1541609358, "post_id": 53193066, "comment_id": 93276849, "body": "would it not be <code>thecollection(singlekey).country</code> ?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1541609395, "post_id": 53193066, "comment_id": 93276889, "body": "@Nathan_Sav that&#39;s an implicit default member call. <code>Item</code> is the default member, OP&#39;s code is just making it explicit."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1541609558, "post_id": 53193066, "comment_id": 93276985, "body": "@MathieuGuindon Yes, that&#39;s what i am getting at is it a(x) where x the number of <code>classes</code> in the dictionary, so key(x) should return item(x) a class, looks like this is not the case."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1541609718, "post_id": 53193066, "comment_id": 93277067, "body": "@Nathan_Sav <code>Item</code> (whether implicit or explicit) takes a <code>Key</code> parameter, not an index."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1541610095, "post_id": 53193066, "comment_id": 93277277, "body": "Yes, <code>singleKey</code> is a key as it comes from the keys() array.   The OP hasnt got the dictionary set right, so it should be col(&quot;a&quot;)=class, col(&quot;b&quot;)=class.  So <code>thecollection(singlekey)</code> should return the item, the populated class.  As answer below"}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 6718386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f1ebbf304f0e6c09deec3a496370bf1?s=128&d=identicon&r=PG&f=1", "display_name": "Freddie Fred", "link": "https://stackoverflow.com/users/6718386/freddie-fred"}, "edited": false, "score": 0, "creation_date": 1541613184, "post_id": 53194089, "comment_id": 93278818, "body": "Yes, you were right!  I switched the key and item.  Now the code works.  Thank you so much."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 1, "last_activity_date": 1541609297, "creation_date": 1541609297, "answer_id": 53194089, "question_id": 53193066, "link": "https://stackoverflow.com/questions/53193066/vba-dictionary-class-424-object-required-error/53194089#53194089", "title": "VBA dictionary, class 424 object required error", "body": "<blockquote>\n  <p><em>If I remove the \"Country\", the code run and it returns the index number.</em></p>\n</blockquote>\n\n<p>Then you are populating your dictionary with numbers, possibly due to inverting the <code>Key</code> and <code>Item</code> arguments to the <code>Dictionary.Add</code> method, but that's hard to tell without seeing that code.</p>\n\n<p>\"Object Required\" means you're making a member call against something that isn't an object... like a number, or a string.</p>\n\n<p>In order for <code>thecollection.Item(singleKey).Country</code> to succeed, you need to be populating <code>thecollection</code> (a very misleading name for a <code>Dictionary</code> BTW) with objects that have a <code>Country</code> property.</p>\n\n<p>For example you'd have a <code>Thing</code> class module with this code:</p>\n\n<pre><code>Option Explicit\nPrivate mCountry As String\n\nPublic Property Get Country() As String\n    Country = mCountry\nEnd Property\n\nPublic Property Let Country(ByVal value As String)\n    mCountry = value\nEnd Property\n</code></pre>\n\n<p>Then you'd be creating instances of that class, and populating the dictionary with them:</p>\n\n<pre><code>Dim thing1 As Thing\nSet thing1 = New Thing\nthing1.Country = \"Canada\"\nthecollection.Add \"foo\", thing1 ' note: key first, then the item\n</code></pre>\n\n<p>Then your code would work. That said I realize this is examplified code, but iterating dictionary keys doesn't strike me as very efficient.</p>\n"}], "owner": {"reputation": 37, "user_id": 6718386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f1ebbf304f0e6c09deec3a496370bf1?s=128&d=identicon&r=PG&f=1", "display_name": "Freddie Fred", "link": "https://stackoverflow.com/users/6718386/freddie-fred"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 435, "favorite_count": 0, "accepted_answer_id": 53194089, "answer_count": 1, "score": -2, "last_activity_date": 1541609297, "creation_date": 1541606088, "question_id": 53193066, "link": "https://stackoverflow.com/questions/53193066/vba-dictionary-class-424-object-required-error", "title": "VBA dictionary, class 424 object required error", "body": "<p>This code is has an  424 object error. </p>\n\n<pre><code>   Dim singleKey As Variant\n\n    For Each singleKey In thecollection.Keys()\n\n        Debug.Print thecollection.Item(singleKey).Country\n\n    Next singleKey\n</code></pre>\n\n<p>The error is caused by the debug.print line.  </p>\n\n<p>The country is part of a custom class.  </p>\n\n<p>I am at a lost.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 4, "creation_date": 1541605585, "post_id": 53192843, "comment_id": 93274717, "body": "What is the overall goal of the above and with a loop? If you are calling the bottom sub from the top where will  pDisp and URL come from?"}, {"owner": {"reputation": 101, "user_id": 8386648, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OyZSvRZ3bgU/AAAAAAAAAAI/AAAAAAAAAJE/9in8vEpijgg/photo.jpg?sz=128", "display_name": "Tahor Sui Juris", "link": "https://stackoverflow.com/users/8386648/tahor-sui-juris"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1541607637, "post_id": 53192843, "comment_id": 93275899, "body": "Yes, the goal is to loop through a list of URLs.  Sorry, the pDisp and URL were not removed, as the URL is derived from the actual cell value."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1541607690, "post_id": 53192843, "comment_id": 93275939, "body": "So, is the bottom sub relevant?"}, {"owner": {"reputation": 101, "user_id": 8386648, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OyZSvRZ3bgU/AAAAAAAAAAI/AAAAAAAAAJE/9in8vEpijgg/photo.jpg?sz=128", "display_name": "Tahor Sui Juris", "link": "https://stackoverflow.com/users/8386648/tahor-sui-juris"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1541607777, "post_id": 53192843, "comment_id": 93275986, "body": "Necessary to determine when the webbrowser completes."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1541607950, "post_id": 53192843, "comment_id": 93276090, "body": "But you don&#39;t call it in the top sub."}, {"owner": {"reputation": 101, "user_id": 8386648, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OyZSvRZ3bgU/AAAAAAAAAAI/AAAAAAAAAJE/9in8vEpijgg/photo.jpg?sz=128", "display_name": "Tahor Sui Juris", "link": "https://stackoverflow.com/users/8386648/tahor-sui-juris"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1541608136, "post_id": 53192843, "comment_id": 93276193, "body": "Correction pDisp and URL are dependent upon the actual webpage retrieved, as the URL is derived from the actual cell value."}, {"owner": {"reputation": 101, "user_id": 8386648, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OyZSvRZ3bgU/AAAAAAAAAAI/AAAAAAAAAJE/9in8vEpijgg/photo.jpg?sz=128", "display_name": "Tahor Sui Juris", "link": "https://stackoverflow.com/users/8386648/tahor-sui-juris"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1541608190, "post_id": 53192843, "comment_id": 93276219, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/aa768329(v=vs.85).aspx\" rel=\"nofollow noreferrer\">link</a>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1541608238, "post_id": 53192843, "comment_id": 93276250, "body": "Aha..... that is me told. Thanks."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1541608288, "post_id": 53192843, "comment_id": 93276275, "body": "So, you just want a loop over cells picking up new URLs?"}, {"owner": {"reputation": 101, "user_id": 8386648, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OyZSvRZ3bgU/AAAAAAAAAAI/AAAAAAAAAJE/9in8vEpijgg/photo.jpg?sz=128", "display_name": "Tahor Sui Juris", "link": "https://stackoverflow.com/users/8386648/tahor-sui-juris"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1541608379, "post_id": 53192843, "comment_id": 93276328, "body": "Yes, and Call the top Procedure."}], "owner": {"reputation": 101, "user_id": 8386648, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OyZSvRZ3bgU/AAAAAAAAAAI/AAAAAAAAAJE/9in8vEpijgg/photo.jpg?sz=128", "display_name": "Tahor Sui Juris", "link": "https://stackoverflow.com/users/8386648/tahor-sui-juris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1586399789, "creation_date": 1541605404, "last_edit_date": 1586399789, "question_id": 53192843, "link": "https://stackoverflow.com/questions/53192843/excel-vba-using-call-procedure-to-loop", "title": "Excel VBA Using Call procedure to loop", "body": "<p>Any suggestions on the best practice to Call the procedure would be greatly appreciated.  Have tried to set it on OnSelectionChange with no success.  The DocumentComplete includes an END which is necessary to stop the Application.Speech from repeating.  Below is the code.</p>\n\n<pre><code>Sub AutoDomain()\n'HOW TO LOOP?\n    Dim xURL As String\n    ActiveWorkbook.Save\n    ActiveCell.Offset(1, 0).Select\n    Application.Speech.Speak \"Starting Look Up\", Speakasync:=True, Purge:=True\n    xURL = Cells(ActiveCell.Row, 1)\n    Cells(1, 3).Value = \"\"\n    Cells(1, 3).Interior.ColorIndex = xlNone\n    Cells(1, 3).Borders.Color = xlNone\n    Cells(ActiveCell.Row, 3).Value = \"\"\n    WebBrowser1.Silent = True\n    WebBrowser1.Navigate (xURL)\n    Sheets(1).Calculate\nEnd Sub\n\nPrivate Sub WebBrowser1_DocumentComplete(ByVal pDisp As Object, URL As Variant)\n    WebBrowser1.Stop\n    URL = Cells(ActiveCell.Row, 1)\n    Cells(1, 3).Value = WebBrowser1.LocationURL\n    Cells(1, 3).Interior.ColorIndex = 19\n    Cells(1, 3).Borders.Color = vbRed\n    Cells(ActiveCell.Row, 3).Value = \"DOMAIN : \" &amp; WebBrowser1.LocationURL &amp; vbCrLf &amp; \"TITLE  : \" &amp; WebBrowser1.LocationName\n    Do Until Cells(ActiveCell.Row, 3).Value &lt;&gt; \"\"\n        DoEvents\n    Loop\n    Application.Speech.Speak \" Look Up Completed \", Speakasync:=True, Purge:=True\n    End\n    Exit Sub\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-2013"], "comments": [{"owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "edited": false, "score": 3, "creation_date": 1541604289, "post_id": 53192446, "comment_id": 93273886, "body": "What have you researched / tried so far, and what is your specific problem? See <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> then <a href=\"https://stackoverflow.com/posts/53192446/edit\">edit</a> your question to include your code, and any appropriate errors."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1541604929, "post_id": 53192446, "comment_id": 93274330, "body": "Why not just use a Vlookup function here?"}, {"owner": {"reputation": 3, "user_id": 10619063, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-JJJVhs_oEfI/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCPWu-x6KmNc3Acv2j7G5NTXNuqaA/mo/photo.jpg?sz=128", "display_name": "Adam Deuchar", "link": "https://stackoverflow.com/users/10619063/adam-deuchar"}, "edited": false, "score": 0, "creation_date": 1541605152, "post_id": 53192446, "comment_id": 93274470, "body": "I have another spreadsheet that has 13 reporting periods, I have set up a recorded macros and a button for each reporting period.  When the reporting period ends you click the button and it goes to various spreadsheets etc picking up values (basically saving manual input).  The issue I have is one spreadsheet in particular has a list of codes with an amount, at the bottom the amount is a total (figure I want), for some reporting periods a code could be removed and instead of my recorded macro picking up the total value from D33 it picks it from D32 therefore inserting the incorrect figure."}, {"owner": {"reputation": 3, "user_id": 10619063, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-JJJVhs_oEfI/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCPWu-x6KmNc3Acv2j7G5NTXNuqaA/mo/photo.jpg?sz=128", "display_name": "Adam Deuchar", "link": "https://stackoverflow.com/users/10619063/adam-deuchar"}, "edited": false, "score": 0, "creation_date": 1541605534, "post_id": 53192446, "comment_id": 93274685, "body": "Also I have scoured the internet using a search engine and thought I would try here for help as I could not find anything that could help"}], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1541605127, "creation_date": 1541605127, "answer_id": 53192753, "question_id": 53192446, "link": "https://stackoverflow.com/questions/53192446/vba-to-find-specific-word-and-copy-value-to-another-cell/53192753#53192753", "title": "VBA to find specific word and copy value to another cell", "body": "<p>Use the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/Excel.Range.Find\" rel=\"nofollow noreferrer\">Range.Find Method</a> to find your specific string in column A and the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/Excel.Range.Offset\" rel=\"nofollow noreferrer\">Range.Offset Property</a> to move to column D:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub Example()\n    Dim FoundAt As Range\n    Set FoundAt = Worksheets(\"SearchSheet\").Columns(\"A\").Find(What:=\"Summary of CAMBUSLANG\", LookIn:=xlValues, LookAt:=xlWhole)\n\n    If Not FoundAt Is Nothing Then \n        Worksheets(\"AnotherSheet\").Range(\"A1\").Value = FoundAt.Offset(ColumnOffset:=3).Value\n    Else 'nothing found\n        MsgBox \"'Summary of CAMBUSLANG' not found.\", vbCritical\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10619063, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-JJJVhs_oEfI/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCPWu-x6KmNc3Acv2j7G5NTXNuqaA/mo/photo.jpg?sz=128", "display_name": "Adam Deuchar", "link": "https://stackoverflow.com/users/10619063/adam-deuchar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 523, "favorite_count": 0, "accepted_answer_id": 53192753, "answer_count": 1, "score": -2, "last_activity_date": 1586399825, "creation_date": 1541604076, "last_edit_date": 1586399825, "question_id": 53192446, "link": "https://stackoverflow.com/questions/53192446/vba-to-find-specific-word-and-copy-value-to-another-cell", "title": "VBA to find specific word and copy value to another cell", "body": "<p>I am looking for help with vba.</p>\n\n<p>I want to search column A for \"Summary of CAMBUSLANG\" and if found assign the value that is in column D to another cell for talking sake say Column A of another spreadsheet.</p>\n\n<p>any help would be greatly appreciated.</p>\n"}, {"tags": ["vba", "outlook", "freeze"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1541604242, "post_id": 53192403, "comment_id": 93273847, "body": "Try pasting function-by-function."}], "answers": [{"comments": [{"owner": {"reputation": 151, "user_id": 9622165, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Barok", "link": "https://stackoverflow.com/users/9622165/barok"}, "edited": false, "score": 0, "creation_date": 1543124045, "post_id": 53200448, "comment_id": 93800844, "body": "None of the pasting schemes worked. However, running Outlook in safemode and back worked for good!"}], "tags": [], "owner": {"reputation": 293, "user_id": 10025039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f4c1e4aa063ea5bcc59fcb59286fb08?s=128&d=identicon&r=PG&f=1", "display_name": "Simon Li", "link": "https://stackoverflow.com/users/10025039/simon-li"}, "is_accepted": false, "score": 0, "last_activity_date": 1541641799, "creation_date": 1541641799, "answer_id": 53200448, "question_id": 53192403, "link": "https://stackoverflow.com/questions/53192403/outlook-hangs-when-vba-code-is-pasted-into-thisoutlooksession/53200448#53200448", "title": "Outlook hangs when VBA code is pasted into thisOutlookSession", "body": "<p>You should be to clear your code of OutlookSession and Restart your Outlook. Then try pasting function-by-function(As Paul mentioned) to check the problem. Also, you could try to change an another PC to test your code. </p>\n\n<p>Related link: <a href=\"https://answers.microsoft.com/en-us/msoffice/forum/all/outlook-freezes-with-macro/8749b498-b3c9-462d-ab78-5f2f28c23f10\" rel=\"nofollow noreferrer\">Outlook Freezes with Macro</a></p>\n"}], "owner": {"reputation": 151, "user_id": 9622165, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Barok", "link": "https://stackoverflow.com/users/9622165/barok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 177, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1541641799, "creation_date": 1541603953, "question_id": 53192403, "link": "https://stackoverflow.com/questions/53192403/outlook-hangs-when-vba-code-is-pasted-into-thisoutlooksession", "title": "Outlook hangs when VBA code is pasted into thisOutlookSession", "body": "<p>Outlook freezes (mouse cursor spins in a circle) into an endless loop when VBA code is copied from Notepad++ and pasted into thisOutlookSession. It hangs but does not crash the application.</p>\n\n<p>Subroutines such as event-driven Itemsend() and Application_Startup() are used in my code. I am not sure if this problem has to do with the code structure itself. Some other random codes seem to paste just fine with no hanging problems however.</p>\n"}, {"tags": ["vba", "email", "outlook"], "comments": [{"owner": {"reputation": 10300, "user_id": 428486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4ca8698e59a2414899f97b850084f45?s=128&d=identicon&r=PG", "display_name": "lucascaro", "link": "https://stackoverflow.com/users/428486/lucascaro"}, "edited": false, "score": 0, "creation_date": 1541976094, "post_id": 53192300, "comment_id": 93392487, "body": "Why do you need to do this? By definition, all recipients would already have gotten the same email with the same attachment, no? i"}], "answers": [{"tags": [], "owner": {"reputation": 828, "user_id": 10252988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/047bac7a125b9725dc9a257f8f0e0266?s=128&d=identicon&r=PG&f=1", "display_name": "Alina Li", "link": "https://stackoverflow.com/users/10252988/alina-li"}, "is_accepted": false, "score": -1, "last_activity_date": 1541656269, "creation_date": 1541656269, "answer_id": 53202191, "question_id": 53192300, "link": "https://stackoverflow.com/questions/53192300/forward-emails-with-attachments-to-all-recipients/53202191#53202191", "title": "Forward emails with attachments to all recipients", "body": "<p>You could create a <a href=\"https://www.slipstick.com/outlook/rules/outlooks-rules-and-alerts-run-a-script/\" rel=\"nofollow noreferrer\">macro rule</a>, when you receive an email from specific sender run a script.\nAbout automatically save attachment, please refer to this code:</p>\n\n<pre><code> Sub Save_Attachment(olItem As Outlook.MailItem)\n        Dim olAttch As Outlook.attachment\n        Dim sPath As String\n        Dim acount\n        Dim objMsg As MailItem\n        Dim recips As Outlook.Recipients\n        Dim recip As Outlook.Recipient\n\n    For Each olAttch In olItem.Attachments\n           If olAttch.UnRead = True Then\n                If olAttch.SenderEmailAddress = \"v-shuail@microsoft.com\" Then\n                    Set acount = olAttch.Attachments.Count\n                    If acount &gt; 0 Then\n                        Set objMsg = Application.CreateItem(olMailItem)\n                        Set recips = olAttch.Recipients\n\n\n                        With objMsg\n                          .Subject = \"This is the subject\"\n                          .Attachments.Add (\"path-to-file.docx\")\n                           For Each recip In recips\n                            .Recipients.Add (recip)\n                           Next\n                          .Send\n                        End With\n                        Set objMsg = Nothing\n                    End If\n                End If\n            End If\n        Next\n\n        Set olAttch = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9958609, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-A9CTi9QfqAU/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3h0lsY9euzkDhY_udN4Qs8v6NW-g/mo/photo.jpg?sz=128", "display_name": "Debra S", "link": "https://stackoverflow.com/users/9958609/debra-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1541976037, "creation_date": 1541603606, "last_edit_date": 1592644375, "question_id": 53192300, "link": "https://stackoverflow.com/questions/53192300/forward-emails-with-attachments-to-all-recipients", "title": "Forward emails with attachments to all recipients", "body": "<p>I receive emails containing Excel reports as an attachment. They are all from the same sender but have different recipients on each email.</p>\n<p>An example:</p>\n<p>Email #1</p>\n<blockquote>\n<p>From: John@gmail.com To: me@gmail.com;mike@gmail.com</p>\n<p>+1 attachment Excel file</p>\n</blockquote>\n<p>Email #2</p>\n<blockquote>\n<p>From: John@gmail.com To: me@gmail.com;jessica@gmail.com</p>\n<p>+1 attachment Excel file</p>\n</blockquote>\n<p>I need to forward those emails to the recipients again WITH the attachment file.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 105, "user_id": 9808154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fd6a98412f53a13e79ec56c431df064?s=128&d=identicon&r=PG&f=1", "display_name": "ThisGuyJustNeedsHelp", "link": "https://stackoverflow.com/users/9808154/thisguyjustneedshelp"}, "edited": false, "score": 0, "creation_date": 1541602308, "post_id": 53191865, "comment_id": 93272493, "body": "do you have worksheet password enabled? add activesheet.protect &quot;password&quot; to the end of your code."}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "edited": false, "score": 3, "creation_date": 1541602315, "post_id": 53191865, "comment_id": 93272499, "body": "The locking only works if the sheet is protected."}, {"owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "reply_to_user": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "edited": false, "score": 0, "creation_date": 1541602563, "post_id": 53191865, "comment_id": 93272656, "body": "@user3561813 I added the rest of the script before it sets my next <code>wb = nothing</code>   is there a spot later on that I should be locking these columns?"}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "edited": false, "score": 0, "creation_date": 1541602675, "post_id": 53191865, "comment_id": 93272727, "body": "@nicklanta See my answer below. There is a difference between a workbook that is password protected and a worksheet that is protected. See if you can incorporate my answer, and let us know if we can offer additional help. In your case, before you Save and close the workbook, you can make a call to <code>Sheet1.Protect &quot;Password&quot;</code>, with your respective sheet and password."}], "answers": [{"comments": [{"owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "edited": false, "score": 0, "creation_date": 1541603597, "post_id": 53191977, "comment_id": 93273430, "body": "When I print the array, I then put within the <code>with</code> statement,   <code>.protect &quot;password&quot;</code> <code>.cells.locked = false</code> it stops on the <code>.cells.locked = false</code> line and says &quot;unable to set locked property of the range class&quot;"}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "reply_to_user": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "edited": false, "score": 0, "creation_date": 1541605604, "post_id": 53191977, "comment_id": 93274732, "body": "@nicklanta It&#39;s all about ordering. You can&#39;t set the <code>Locked</code> property once the sheet is already protected. So, you have to unlock the sheet (using code or manually), then designate the appropriate cells as <code>Locked</code> then protect the sheet. It&#39;s much the same as if you were using the Excel interface. If you tried locking cells on a protected sheet, you&#39;d get the same error. Let me know if that helps."}, {"owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "edited": false, "score": 0, "creation_date": 1541605893, "post_id": 53191977, "comment_id": 93274912, "body": "Ok, I got it to work, but is there any way to unprotect the sheet afterwards? My manager doesn&#39;t want the people that will receive this to have to input two passwords (one for workbook and one for worksheet)"}, {"owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "edited": false, "score": 0, "creation_date": 1541606049, "post_id": 53191977, "comment_id": 93275007, "body": "My manager wants a seamless experience where I&#39;ll distribute these files, the manager will input one password to open the workbook and then on Sheet 1 only able to edit rows in columns P-T"}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "reply_to_user": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "edited": false, "score": 0, "creation_date": 1541618938, "post_id": 53191977, "comment_id": 93281426, "body": "@nicklanta That was the idea of the code up above. The code programmatically unprotects the worksheet, does whatever needs to be done, and then protects it programatically. The user doesn&#39;t have to actually input the password; it&#39;s stored in the code."}], "tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": true, "score": 1, "last_activity_date": 1541602551, "creation_date": 1541602551, "answer_id": 53191977, "question_id": 53191865, "link": "https://stackoverflow.com/questions/53191865/why-arent-these-columns-locking-properly/53191977#53191977", "title": "Why aren&#39;t these columns locking properly?", "body": "<p>I'll just add on with an answer to clarify things. The <code>Locked</code> property simply indicates whether or not the cells is modifiable <em>when the sheet is protected.</em> You can protect a sheet by going to the Review tab in the Excel toolbar, then selecting Protect Sheet.</p>\n\n<p>Alternatively, you can protect and unprotect within your code. For example:</p>\n\n<pre><code>Sub Protect_Sheet()\n    Sheet1.Protect \"Password\"\nEnd Sub\n\nSub Unprotect_Sheet()\n    Sheet1.Unprotect \"Password\"\nEnd Sub\n</code></pre>\n\n<p>You can call these methods within a larger method if you want to perfrom some action on locked sheets, then protect the sheet.</p>\n"}, {"comments": [{"owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "edited": false, "score": 0, "creation_date": 1541603612, "post_id": 53192040, "comment_id": 93273437, "body": "When I print the array, I then put within the <code>with</code> statement,   <code>.protect &quot;password&quot;</code> <code>.cells.locked = false</code> it stops on the <code>.cells.locked = false</code> line and says &quot;unable to set locked property of the range class&quot;"}, {"owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "edited": false, "score": 0, "creation_date": 1541606656, "post_id": 53192040, "comment_id": 93275345, "body": "I notice that it locks the whole sheet, but I want the user to be able to make edits to any column after column O. When I do something like <code>sheet1.unprotect</code> (add in columns to lock A:O) <code>sheet1.protect</code> this unlocks the columns after I unprotect the sheet"}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1541602755, "creation_date": 1541602755, "answer_id": 53192040, "question_id": 53191865, "link": "https://stackoverflow.com/questions/53191865/why-arent-these-columns-locking-properly/53192040#53192040", "title": "Why aren&#39;t these columns locking properly?", "body": "<p>When the code start import:</p>\n\n<pre><code>Sheet1.Unprotect \"Password\" '&lt;- Unprotect the sheet in order to Unlock sheet and give the opportunity to the code to work.\n</code></pre>\n\n<p>and when the code finish import:</p>\n\n<pre><code>Sheet1.Protect \"Password\" '&lt;- Protect the sheet in order to lock the sheet \n</code></pre>\n"}], "owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 53191977, "answer_count": 2, "score": 3, "last_activity_date": 1586399861, "creation_date": 1541602223, "last_edit_date": 1586399861, "question_id": 53191865, "link": "https://stackoverflow.com/questions/53191865/why-arent-these-columns-locking-properly", "title": "Why aren&#39;t these columns locking properly?", "body": "<p>I have to protect columns A:O from being edited in a worksheet I'm creating, but it doesn't seem to be working properly. </p>\n\n<pre><code> Set Wb = Workbooks.Add(XlWBATemplate.xlWBATWorksheet)\n        With Wb\n        With .Worksheets(\"Sheet1\")\n             .Cells.Locked = False\n             .Columns(\"A:O\").Locked = True  \n        End With\n</code></pre>\n\n<p>Why are those columns able to be edited after I run the macro?</p>\n\n<p>Rest of script underneath (including saving):</p>\n\n<pre><code> .SaveAs strNewPath &amp; strFileName, Password:=\"password\", FileFormat:=51\n            .Saved = True\n            .Close\n\n        End With\n        Set Wb = Nothing\n    End If\nNext\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1014, "user_id": 10027228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MzF1P.jpg?s=128&g=1", "display_name": "Dvyn Resh", "link": "https://stackoverflow.com/users/10027228/dvyn-resh"}, "edited": false, "score": 0, "creation_date": 1541602772, "post_id": 53191647, "comment_id": 93272804, "body": "Hi you can verify the similar question posted here<a href=\"https://stackoverflow.com/questions/31068309/excel-vba-macro-to-only-export-non-blank-cells\">Question</a>"}], "answers": [{"comments": [{"owner": {"reputation": 74, "user_id": 9180767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94e411caa0e3f4d0fedc5eab1ef72899?s=128&d=identicon&r=PG&f=1", "display_name": "Laurentiu", "link": "https://stackoverflow.com/users/9180767/laurentiu"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1541604058, "post_id": 53192187, "comment_id": 93273731, "body": "Thanks, I changed it a bit after testing it, was not sure if the hidden rows get exported to the PDF, but apparently they are not."}, {"owner": {"reputation": 147, "user_id": 5450121, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c4c620970c5e639ac1a3fb7059756144?s=128&d=identicon&r=PG&f=1", "display_name": "premiumcopypaper", "link": "https://stackoverflow.com/users/5450121/premiumcopypaper"}, "edited": false, "score": 0, "creation_date": 1541608815, "post_id": 53192187, "comment_id": 93276575, "body": "Thanks this works really well, the only thing is that I&#39;m not looking to remove all empty rows since some add padding, rather only hide for Rows 34-42 and 44 to 56"}], "tags": [], "owner": {"reputation": 74, "user_id": 9180767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94e411caa0e3f4d0fedc5eab1ef72899?s=128&d=identicon&r=PG&f=1", "display_name": "Laurentiu", "link": "https://stackoverflow.com/users/9180767/laurentiu"}, "is_accepted": true, "score": 2, "last_activity_date": 1541618874, "last_edit_date": 1541618874, "creation_date": 1541603210, "answer_id": 53192187, "question_id": 53191647, "link": "https://stackoverflow.com/questions/53191647/hide-rows-if-no-text-on-export-to-pdf/53192187#53192187", "title": "Hide rows if no text on export to PDF", "body": "<p>I have adjusted your script to hide blank rows. It checks only the range you mention above, in case it's a dynamic range you can let me know.</p>\n\n<pre><code>Private Sub CommandButton2_Click()\n\nDim rowCounter As Integer\nDim columnCounter As Integer\nDim blankFlag As Boolean\n\nWith sheets(\"Summary\")\n    'hide blank rows in 34-42 and 44-56 interval\n    For rowCounter = 34 To 56\n        blankFlag = True\n\n        For columnCounter = 2 To 8\n            If .Cells(rowCounter, columnCounter) &lt;&gt; \"\" Then\n                blankFlag = False\n                Exit For\n            End If\n        Next columnCounter\n\n        If blankFlag = True Then rows(rowCounter).EntireRow.Hidden = True\n        If rowCounter = 42 then rowCounter = rowCounter + 1\n    Next rowCounter\n\nEnd With\n\nWith sheets(\"Summary\").Range(\"B2:H83\")\n    'export to PDF\n    .ExportAsFixedFormat _\n        Type:=xlTypePDF, _\n        filename:=\"F:\\Export.pdf\", _\n        Quality:=xlQualityStandard, _\n        IncludeDocProperties:=True, _\n        IgnorePrintAreas:=False, _\n        OpenAfterPublish:=True\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 501, "user_id": 8580202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ab9a3cb8bd7c29a445545f21c050228?s=128&d=identicon&r=PG", "display_name": "adhy wijaya", "link": "https://stackoverflow.com/users/8580202/adhy-wijaya"}, "is_accepted": false, "score": 0, "last_activity_date": 1541604714, "creation_date": 1541604714, "answer_id": 53192631, "question_id": 53191647, "link": "https://stackoverflow.com/questions/53191647/hide-rows-if-no-text-on-export-to-pdf/53192631#53192631", "title": "Hide rows if no text on export to PDF", "body": "<p>I think you can try this code:</p>\n\n<pre><code>    Private Sub CommandButton2_Click()\n\n        Dim ShtSummary As Worksheet\n        Dim i As Integer\n\n        Set ShtSummary = Sheets(\"Summary\")\n\n        For i = 3 To 83\n            If Application.WorksheetFunction.CountA(Rows(i)) = 0 Then\n                ShtSummary.Rows(i).EntireRow.Hidden = True\n            End If\n\n        Next i\n\n     With Sheets(\"Summary\").Range(\"B2:H83\")\n        .ExportAsFixedFormat _\n            Type:=xlTypePDF, _\n            Filename:=\"F:\\Export.pdf\", _\n            Quality:=xlQualityStandard, _\n            IncludeDocProperties:=True, _\n            IgnorePrintAreas:=False, _\n            OpenAfterPublish:=True\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Good Luck.</p>\n"}, {"tags": [], "owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "is_accepted": false, "score": 1, "last_activity_date": 1541613330, "last_edit_date": 1541613330, "creation_date": 1541605385, "answer_id": 53192835, "question_id": 53191647, "link": "https://stackoverflow.com/questions/53191647/hide-rows-if-no-text-on-export-to-pdf/53192835#53192835", "title": "Hide rows if no text on export to PDF", "body": "<p>Better to hide all of the empty rows at once instead of hiding them individually on each iteration of the loop.</p>\n\n<pre><code>Private Sub CommandButton2_Click()\n\n    Dim mainRng As Range\n    Set mainRng = sheets(\"Summary\").Range(\"B2:H83\")\n\n    Dim unionRng As Range\n\n    Dim roww As Range\n    For Each roww In mainRng.rows\n        If WorksheetFunction.CountA(roww) = 0 Then\n            If Not unionRng Is Nothing Then\n                Set unionRng = Union(unionRng, roww)\n            Else\n                Set unionRng = roww\n            End If\n        End If\n    Next\n\n    If Not unionRng Is Nothing Then unionRng.EntireRow.Hidden = True\n\n    mainRng.ExportAsFixedFormat _\n        Type:=xlTypePDF, _\n        filename:=\"F:\\Export.pdf\", _\n        Quality:=xlQualityStandard, _\n        IncludeDocProperties:=True, _\n        IgnorePrintAreas:=False, _\n        OpenAfterPublish:=True\n\n    If Not unionRng Is Nothing Then unionRng.EntireRow.Hidden = False\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 147, "user_id": 5450121, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c4c620970c5e639ac1a3fb7059756144?s=128&d=identicon&r=PG&f=1", "display_name": "premiumcopypaper", "link": "https://stackoverflow.com/users/5450121/premiumcopypaper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 200, "favorite_count": 0, "accepted_answer_id": 53192187, "answer_count": 3, "score": 0, "last_activity_date": 1541618874, "creation_date": 1541601525, "question_id": 53191647, "link": "https://stackoverflow.com/questions/53191647/hide-rows-if-no-text-on-export-to-pdf", "title": "Hide rows if no text on export to PDF", "body": "<p>I have a simple script for exporting a range to Excel:</p>\n\n<pre><code>`Private Sub CommandButton2_Click()\n\n With Sheets(\"Summary\").Range(\"B2:H83\")\n    .ExportAsFixedFormat _\n        Type:=xlTypePDF, _\n        Filename:=\"F:\\Export.pdf\", _\n        Quality:=xlQualityStandard, _\n        IncludeDocProperties:=True, _\n        IgnorePrintAreas:=False, _\n        OpenAfterPublish:=True\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>`\nThe issue is that certain rows may or may not be populated based on inputs in separate sheets. So for example Rows 34-42 could be populated, but more likely than not only Row 34 is populated. This leaves a lot of white space in the exported PDF.</p>\n\n<p>I have no idea how to structure my code to check if there is info in the Row, and if not then to hide the row thereby eliminating white space</p>\n"}, {"tags": ["excel", "vba", "object", "copy-paste"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1541601638, "post_id": 53191589, "comment_id": 93272046, "body": "remove the <code>.Activate</code> and declare your variables as <code>Long</code>."}, {"owner": {"reputation": 5, "user_id": 8954148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8689c5648bd4e9e14f21697db5d1afe3?s=128&d=identicon&r=PG&f=1", "display_name": "OMO", "link": "https://stackoverflow.com/users/8954148/omo"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1541601875, "post_id": 53191589, "comment_id": 93272199, "body": "Perfect, it worked. With regards to the paste values...is it possible to format them as dates?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1541602188, "post_id": 53191589, "comment_id": 93272413, "body": "Have a look at the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.numberformat\" rel=\"nofollow noreferrer\">Range.NumberFormat Property</a>."}, {"owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "edited": false, "score": 0, "creation_date": 1541602216, "post_id": 53191589, "comment_id": 93272427, "body": "<code>.Range(.Cells(7, &quot;D&quot;), .Cells(7, PasteRange + 4)).NumberFormat = &quot;m&#47;d&#47;yyyy&quot;</code> for date format"}], "answers": [{"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1541601872, "post_id": 53191715, "comment_id": 93272197, "body": "Btw. if you don&#39;t use <code>PasteRange</code> at all you can omit it completely. And it should be <code>.PasteSpecial Paste:=xlPasteValues, Transpose:=True</code>"}, {"owner": {"reputation": 865, "user_id": 10361731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8873db235bacaa9d53de9c31a0b8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Jchang43", "link": "https://stackoverflow.com/users/10361731/jchang43"}, "edited": false, "score": 0, "creation_date": 1541616858, "post_id": 53191715, "comment_id": 93280476, "body": "You could also do this in one line I believe by just assigning values<code>ThisWorkbook.Worksheets(&quot;SectorSort&quot;).Range(&quot;D7:D&quot; &amp; 7 + bRow - tRow).Value = .Range(.Cells(tRow, &quot;A&quot;), Application.Transpose(.Cells(bRow, &quot;A&quot;)).Value) </code>"}], "tags": [], "owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "is_accepted": false, "score": 1, "last_activity_date": 1541601940, "last_edit_date": 1541601940, "creation_date": 1541601759, "answer_id": 53191715, "question_id": 53191589, "link": "https://stackoverflow.com/questions/53191589/object-required-on-copy-paste-from-different-sheet/53191715#53191715", "title": "Object Required on Copy Paste from Different Sheet", "body": "<p>There were a couple changes needed:</p>\n\n<pre><code>Sub Clean()\n\n    Dim tRow As Long: tRow = 5\n    Dim bRow As Long\n\n    With ThisWorkbook.Worksheets(\"Canadian\")\n        bRow = .Cells(.Rows.Count, \"A\").End(xlUp).row\n        .Range(.Cells(tRow, \"A\"), .Cells(bRow, \"A\")).Copy\n    End With\n\n    With ThisWorkbook.Worksheets(\"SectorSort\")\n        .Range(\"D7\").PasteSpecial Paste:=xlPasteValues, Transpose:=True\n    End With\n\n\nEnd Sub\n</code></pre>\n\n<p>Needed to remove <code>.Activate</code></p>\n\n<p>Add the <code>.</code> before <code>Range</code> and <code>Cells</code> because you are in a <code>With</code> statement</p>\n\n<p>And also you can just target a single cell when pasting</p>\n"}, {"tags": [], "owner": {"reputation": 520, "user_id": 6425980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b524dab02b94a074d78b988cf62e1405?s=128&d=identicon&r=PG&f=1", "display_name": "Lambik", "link": "https://stackoverflow.com/users/6425980/lambik"}, "is_accepted": false, "score": 0, "last_activity_date": 1541601810, "creation_date": 1541601810, "answer_id": 53191725, "question_id": 53191589, "link": "https://stackoverflow.com/questions/53191589/object-required-on-copy-paste-from-different-sheet/53191725#53191725", "title": "Object Required on Copy Paste from Different Sheet", "body": "<p>change </p>\n\n<pre><code>With ThisWorkbook.Worksheets(\"Canadian\").Activate\n</code></pre>\n\n<p>into</p>\n\n<pre><code>With ThisWorkbook.Worksheets(\"Canadian\")\n</code></pre>\n\n<p>Same for the next With (regarding \"SectorSort\")</p>\n"}], "owner": {"reputation": 5, "user_id": 8954148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8689c5648bd4e9e14f21697db5d1afe3?s=128&d=identicon&r=PG&f=1", "display_name": "OMO", "link": "https://stackoverflow.com/users/8954148/omo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1541601967, "creation_date": 1541601356, "last_edit_date": 1541601676, "question_id": 53191589, "link": "https://stackoverflow.com/questions/53191589/object-required-on-copy-paste-from-different-sheet", "title": "Object Required on Copy Paste from Different Sheet", "body": "<p>I'm trying to copy a range from a sheet and then transpose + paste it into another sheet in the same workbook but for some reason am getting an </p>\n\n<blockquote>\n  <p>object required error </p>\n</blockquote>\n\n<p>on the initial <code>.Copy</code> line. Could someone explain this to me? </p>\n\n<pre><code>Sub Clean()\n    Dim tRow As Double\n    Dim bRow As Double\n    Dim PasteRange As Double\n\n    tRow = 5\n\n    With ThisWorkbook.Worksheets(\"Canadian\").Activate\n        bRow = Cells(Rows.Count, \"A\").End(xlUp).row\n        Worksheets(\"Canadian\").Range(.Cells(tRow, \"A\"), .Cells(bRow, \"A\")).Copy\n        PasteRange = (bRow - tRow)\n    End With\n\n    With ThisWorkbook.Worksheets(\"SectorSort\").Activate\n        .Range(.Cells(7, \"D\"), .Cells(7, PasteRange + 4)).PasteSpecial (xlPasteValues), Transpose:=True    \n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 703, "user_id": 9914902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570635b78e628529da1527be3f6c87c0?s=128&d=identicon&r=PG&f=1", "display_name": "JosephC", "link": "https://stackoverflow.com/users/9914902/josephc"}, "edited": false, "score": 1, "creation_date": 1541601478, "post_id": 53191483, "comment_id": 93271948, "body": "Are you running Outlook at the same time you are running the code? <a href=\"https://answers.microsoft.com/en-us/office/forum/office_2010-outlook/run-time-error-429-activex-component-cant-create/c487d430-1348-4123-a527-00a9a9f4a424?msgId=303f2ba1-c6b2-4f60-8011-98dd7054497e\" rel=\"nofollow noreferrer\">Microsoft Community</a>"}, {"owner": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "reply_to_user": {"reputation": 703, "user_id": 9914902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570635b78e628529da1527be3f6c87c0?s=128&d=identicon&r=PG&f=1", "display_name": "JosephC", "link": "https://stackoverflow.com/users/9914902/josephc"}, "edited": false, "score": 0, "creation_date": 1541602503, "post_id": 53191483, "comment_id": 93272620, "body": "Yes, outlook is open."}], "answers": [{"comments": [{"owner": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "edited": false, "score": 1, "creation_date": 1541602706, "post_id": 53191591, "comment_id": 93272745, "body": "Thanks kubie, looks like removal of the 14 worked for me."}], "tags": [], "owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "is_accepted": true, "score": 2, "last_activity_date": 1541602476, "last_edit_date": 1541602476, "creation_date": 1541601372, "answer_id": 53191591, "question_id": 53191483, "link": "https://stackoverflow.com/questions/53191483/vba-email-activex-component-cant-create-object/53191591#53191591", "title": "VBA, Email, ActiveX Component can&#39;t create object", "body": "<p>You can try removing the <code>14</code>:</p>\n\n<pre><code>Set outApp = CreateObject(\"Outlook.Application\")\n</code></pre>\n\n<p>Also, per @JosephC's note, you might need Outlook to be open</p>\n"}], "owner": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 522, "favorite_count": 0, "accepted_answer_id": 53191591, "answer_count": 1, "score": 2, "last_activity_date": 1586399897, "creation_date": 1541601008, "last_edit_date": 1586399897, "question_id": 53191483, "link": "https://stackoverflow.com/questions/53191483/vba-email-activex-component-cant-create-object", "title": "VBA, Email, ActiveX Component can&#39;t create object", "body": "<p>I am trying to run an automatic email via VBA.</p>\n\n<p>However I get the error <code>ActiveX Component can't create object</code></p>\n\n<p>on this line of code: </p>\n\n<pre><code>Set outApp = CreateObject(\"Outlook.Application.14\")\n</code></pre>\n\n<p>Typically another person runs this code on their computer and works fine.</p>\n\n<p>What is causing the activex error?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1541601014, "post_id": 53191412, "comment_id": 93271676, "body": "See this thread: <a href=\"https://stackoverflow.com/questions/42015700/what-are-the-benefits-and-risks-of-using-the-strptr-function-in-vba\" title=\"what are the benefits and risks of using the strptr function in vba\">stackoverflow.com/questions/42015700/&hellip;</a>. The key is using <code>StrPtr</code> on the result, or use <code>Application.Inputbox</code> instead."}], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1541601409, "last_edit_date": 1541601409, "creation_date": 1541601063, "answer_id": 53191498, "question_id": 53191412, "link": "https://stackoverflow.com/questions/53191412/inputbox-in-excel-difference-between-ok-and-cancel/53191498#53191498", "title": "InputBox in Excel difference between ok and cancel", "body": "<p>Use the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/Excel.Application.InputBox\" rel=\"nofollow noreferrer\">Application.InputBox Method</a>:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub AskForInput()\n    Dim Response As Variant\n    Response = Application.InputBox(\"type something\")\n\n    If Not (VarType(Response) = vbBoolean And Response = False) Then\n        Worksheets(\"Sheet1\").Range(\"A1\").Value = Response\n    End If\nEnd Sub\n</code></pre>\n\n<p>Note that <code>(VarType(Response) = vbBoolean And Response = False)</code> checks if cancel was pressed. If the input box is empty and you press OK it will still empty the cell.</p>\n\n<p>Also note that we additionally need to check the <code>VarType</code> of the <code>Response</code> here otherwise it would consider an input of <code>0</code> as <code>False</code> and cancel.</p>\n"}], "owner": {"reputation": 53, "user_id": 10618733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec60eddcd824249e94f6fe661e12b64e?s=128&d=identicon&r=PG&f=1", "display_name": "cristi m", "link": "https://stackoverflow.com/users/10618733/cristi-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 53191498, "answer_count": 1, "score": 0, "last_activity_date": 1586399933, "creation_date": 1541600774, "last_edit_date": 1586399933, "question_id": 53191412, "link": "https://stackoverflow.com/questions/53191412/inputbox-in-excel-difference-between-ok-and-cancel", "title": "InputBox in Excel difference between ok and cancel", "body": "<p>I want a simple inputbox that doesn't empty the cell if i press cancel,leaving the previous cell contents, but when i press ok it will show in the cell anything that I type in and if i'm not typing in anything it will show an empty cell. (only when ok is pressed).</p>\n"}, {"tags": ["excel", "vba", "memory-management", "out-of-memory"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1541602941, "post_id": 53191401, "comment_id": 93272956, "body": "1.) There&#39;s nothing with a subscript in the code provided, so that won&#39;t be answerable without seeing the code around where the error is thrown. 2.) The memory &quot;issue&quot; is going to scale with the number of items you&#39;re holding in memory at the same time, as is the run-time. When I see 24 <i>million</i> iterations, 30 minutes doesn&#39;t sound unreasonable, but with the scant amount of code provided your biggest performance hit is using <code>Application.WorksheetFunction</code>. I&#39;d replace that with your own VBA implementation."}, {"owner": {"reputation": 13, "user_id": 10384878, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155863607542336/picture?type=large", "display_name": "Andy", "link": "https://stackoverflow.com/users/10384878/andy"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1541603997, "post_id": 53191401, "comment_id": 93273690, "body": "1) this seems to be causing by some definitions, I will take this off as it is not relevant. FYI, we want to set a tenor to MAX 10Years, which is not properly reflected. 2) When you say replace that with my own VBA implementation, What do you mean? Simillar to <code>INT(InputMatrix(n,3)</code>, except round up- is there such a function?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1541608428, "post_id": 53191401, "comment_id": 93276351, "body": "There is if you write one.  ;-)"}], "owner": {"reputation": 13, "user_id": 10384878, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155863607542336/picture?type=large", "display_name": "Andy", "link": "https://stackoverflow.com/users/10384878/andy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1586399968, "creation_date": 1541600743, "last_edit_date": 1586399968, "question_id": 53191401, "link": "https://stackoverflow.com/questions/53191401/saving-memory-in-vba-after-screenupdating-is-turned-off-periodic-saving-and-re", "title": "Saving memory in VBA, after ScreenUpdating is turned off, periodic saving and repeating and rewriting existing data few times", "body": "<p>I am trying to save memory in excel, as I am trying to run a large Monte Carlo simulation, with 30k entries and 10k simulations.</p>\n\n<p>The following are already implemented steps to save memory:</p>\n\n<pre><code>1. Application.ScreenUpdating = False \n\n2. If (sims * inputlength) &gt; 24000000 Then\n      originalsims = sims\n      sims = Int((24000000 / inputlength))\n      repeats = Application.WorksheetFunction.RoundUp((originalsims / sims), 0)\nEnd If\n</code></pre>\n\n<p>I realised that if the number of inputs * simulations exceed the number of 24mio, it gives a memory issue, so I break down total number of simulations and repeat the whole process x times, to reach the initially desired number of simulations. </p>\n\n<pre><code>3. ActiveWorkbook.Save\n</code></pre>\n\n<p>I've read somewhere that if I save the file once in a while (I do it every 1000 simulations) this will also preserve some memory. </p>\n\n<p>Questions:</p>\n\n<ol>\n<li><p>Not relevant -> deleted.</p></li>\n<li><p>How to further improve memory issues and not having to let the macro run for approx. 30 minutes each time?</p></li>\n</ol>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 79, "user_id": 5650329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/021503ecae4265393b3ef05723fe7d24?s=128&d=identicon&r=PG&f=1", "display_name": "P.Costa", "link": "https://stackoverflow.com/users/5650329/p-costa"}, "is_accepted": false, "score": 0, "last_activity_date": 1541603045, "creation_date": 1541603045, "answer_id": 53192121, "question_id": 53191388, "link": "https://stackoverflow.com/questions/53191388/vba-sumifs-with-loop/53192121#53192121", "title": "Vba sumifs with loop", "body": "<p>Sorry for the time consumed of you all, the problem was simple, I was declaring wrong one variable since the last cell value needed to be declared as a string, and it was int.\nThanks anyways</p>\n"}], "owner": {"reputation": 79, "user_id": 5650329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/021503ecae4265393b3ef05723fe7d24?s=128&d=identicon&r=PG&f=1", "display_name": "P.Costa", "link": "https://stackoverflow.com/users/5650329/p-costa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 244, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1586400004, "creation_date": 1541600701, "last_edit_date": 1586400004, "question_id": 53191388, "link": "https://stackoverflow.com/questions/53191388/vba-sumifs-with-loop", "title": "Vba sumifs with loop", "body": "<p>i am trying to do a macro that does a sumif based on several conditions where one of those conditions is set by the value of the first cell of each row.</p>\n\n<p>at the moment i have the following code:</p>\n\n<pre><code>For i = 20 To lngLastRow\n    ws.Cells(i, 2).Value = Application.WorksheetFunction.SumIfs(RegJan, EquipaBd, EquipaForm, AgenteBd, AgenteForm, MarcasBD, ws.Cells(i, 1).Value)\n    Next\n</code></pre>\n\n<p>the error that i am getting is in this line (i supouse that it is refering to the last condition used (ws.Cells(i, 1).Value).\ni run this macro where i declared all the variables and for each row i had the following code</p>\n\n<pre><code>ws.Cells(20, 2).Value = Application.WorksheetFunction.SumIfs(RegJan, \nEquipaBd, EquipaForm, AgenteBd, AgenteForm, MarcasBD, MarcasForm1)\n</code></pre>\n\n<p>i declared all this variables like this:</p>\n\n<pre><code>Set MarcasForm1 = Sheets(\"Zoom\").Range(\"A20\")\n</code></pre>\n\n<p>but my sheet has more than 200 rows with diferent names in the first cell of each row, and i was thinking that with a loop i woul resolve this, but i am stuck. can anyone help me?</p>\n\n<p>thanks in advance</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 0, "last_activity_date": 1541617057, "creation_date": 1541617057, "answer_id": 53196026, "question_id": 53191161, "link": "https://stackoverflow.com/questions/53191161/add-shadow-to-text-in-ms-word-by-vba/53196026#53196026", "title": "Add shadow to text in ms word by vba", "body": "<p>Indeed, the macro recorder does not yield much information about working with \"Text Effects\"...</p>\n\n<p>The <code>Shadow</code> property can only set whether a text effect shadow is \"on\" or \"off\".</p>\n\n<p>To change how the shadow looks it's necessary to work with a <code>ShadowFormat</code> object. The <a href=\"https://docs.microsoft.com/en-us/office/vba/api/word.shadowformat\" rel=\"nofollow noreferrer\">documentation</a> for <code>ShadowFormat</code> is somewhat misleading since it refers only to <code>Shape</code> objects. But the same properties apply to shadows for fonts.</p>\n\n<p>What's more, the property for returning a <code>ShadowFormat</code> object for a <code>Font</code> is not ShadowFormat, it's <code>TextShadow</code>. So code like the following example:</p>\n\n<pre><code>Sub AddFontShadow()\n    Dim shad As Word.ShadowFormat\n\n    Set shad = Selection.Font.TextShadow\n    With shad\n        Debug.Print \"Blur: \" &amp; .Blur, _\n                    \"ForeColor: \" &amp; .ForeColor, _\n                    \"Obscured: \" &amp; .Obscured, _\n                    \"OffsetX: \" &amp; .OffsetX, _\n                    \"OffsetY: \" &amp; .OffsetY, _\n                    \"Style: \" &amp; .style, _\n                    \"Transparency: \" &amp; .Transparency, _\n                    \"Type: \" &amp; .Type\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 10439350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c14a1800fe019ba2a5a5da54aec72a6c?s=128&d=identicon&r=PG&f=1", "display_name": "Sarooj", "link": "https://stackoverflow.com/users/10439350/sarooj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 276, "favorite_count": 0, "accepted_answer_id": 53196026, "answer_count": 1, "score": 0, "last_activity_date": 1541617057, "creation_date": 1541599921, "last_edit_date": 1541616385, "question_id": 53191161, "link": "https://stackoverflow.com/questions/53191161/add-shadow-to-text-in-ms-word-by-vba", "title": "Add shadow to text in ms word by vba", "body": "<p>I am working on a template  in ms word , I need to add shadow to a selection.</p>\n\n<p>The macro recorder gives</p>\n\n<pre><code>Selection.Font.Shadow = true\n</code></pre>\n\n<p>but I didn't know how to use it and how to determine the type of shadow and its properties.  I didn't find the name of these types or how to deal with them, like setting the depth or angle.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1541599308, "post_id": 53190879, "comment_id": 93270704, "body": "If you run your code step by step using F8 and stop after line <code>IE.Document\u2026</code> and have a quick look at the Internet Explorer window there is a red popup for about 2 seconds saying <i>&quot;Event Details - We&#39;re having a technical problem. Please try again in a few minutes.&quot;</i>"}, {"owner": {"reputation": 13, "user_id": 9996657, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Y-LBER6Fh8Y/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq37b1bCjN4ASghI4o6JxIWrzM2_LA/mo/photo.jpg?sz=128", "display_name": "Derek Park", "link": "https://stackoverflow.com/users/9996657/derek-park"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1541603944, "post_id": 53190879, "comment_id": 93273653, "body": "Got it. I just spoke with the Auction.com technical team and they have disabled interactions using IE and only work on Google Chrome."}, {"owner": {"reputation": 13641, "user_id": 1871033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30bea353b9b21b063e2be8ab57a1465e?s=128&d=identicon&r=PG", "display_name": "CherryDT", "link": "https://stackoverflow.com/users/1871033/cherrydt"}, "edited": false, "score": 0, "creation_date": 1586400315, "post_id": 53190879, "comment_id": 108116460, "body": "Unrelated: You should never write <code>Do While &lt;something&gt;; Loop</code> with nothing inside it because that will cause 100% usage of one CPU core for no good reason and make the application unresponsive as well. Put a <code>DoEvents</code> inside the loop."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9996657, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Y-LBER6Fh8Y/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq37b1bCjN4ASghI4o6JxIWrzM2_LA/mo/photo.jpg?sz=128", "display_name": "Derek Park", "link": "https://stackoverflow.com/users/9996657/derek-park"}, "edited": false, "score": 0, "creation_date": 1541603948, "post_id": 53191298, "comment_id": 93273656, "body": "Got it. I just spoke with the Auction.com technical team and they have disabled interactions using IE and only work on Google Chrome."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 13, "user_id": 9996657, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Y-LBER6Fh8Y/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq37b1bCjN4ASghI4o6JxIWrzM2_LA/mo/photo.jpg?sz=128", "display_name": "Derek Park", "link": "https://stackoverflow.com/users/9996657/derek-park"}, "edited": false, "score": 1, "creation_date": 1541603980, "post_id": 53191298, "comment_id": 93273675, "body": "That&#39;s ok. You want a chrome answer? Assuming you can install selenium basic."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 13, "user_id": 9996657, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Y-LBER6Fh8Y/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq37b1bCjN4ASghI4o6JxIWrzM2_LA/mo/photo.jpg?sz=128", "display_name": "Derek Park", "link": "https://stackoverflow.com/users/9996657/derek-park"}, "edited": false, "score": 0, "creation_date": 1541604841, "post_id": 53191298, "comment_id": 93274256, "body": "And if you can&#39;t install selenium I could probably write you something in python/java which could be run from command line an IDE."}, {"owner": {"reputation": 13, "user_id": 9996657, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Y-LBER6Fh8Y/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq37b1bCjN4ASghI4o6JxIWrzM2_LA/mo/photo.jpg?sz=128", "display_name": "Derek Park", "link": "https://stackoverflow.com/users/9996657/derek-park"}, "edited": false, "score": 0, "creation_date": 1541605731, "post_id": 53191298, "comment_id": 93274819, "body": "Hello QHarr, Thank you for your offer. However, I would like to learn how to use Selenium first! I don&#39;t want your efforts to go to waste. I have downloaded Selenium and am now looking into how to set it on PATH. Many thanks!"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 13, "user_id": 9996657, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Y-LBER6Fh8Y/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq37b1bCjN4ASghI4o6JxIWrzM2_LA/mo/photo.jpg?sz=128", "display_name": "Derek Park", "link": "https://stackoverflow.com/users/9996657/derek-park"}, "edited": false, "score": 0, "creation_date": 1541605856, "post_id": 53191298, "comment_id": 93274887, "body": "No worries. Let me know if any problems. There is a tutorial <a href=\"https://codingislove.com/browser-automation-in-excel-selenium/\" rel=\"nofollow noreferrer\">here</a> and remember to look at the example.xlsm on <a href=\"https://github.com/florentbr/SeleniumBasic/tree/master/Examples/Excel\" rel=\"nofollow noreferrer\">Github</a>  You can additionally pass the path to the driver folder as an argument to selenium."}, {"owner": {"reputation": 13, "user_id": 9996657, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Y-LBER6Fh8Y/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq37b1bCjN4ASghI4o6JxIWrzM2_LA/mo/photo.jpg?sz=128", "display_name": "Derek Park", "link": "https://stackoverflow.com/users/9996657/derek-park"}, "edited": false, "score": 0, "creation_date": 1541606046, "post_id": 53191298, "comment_id": 93275005, "body": "Okay. So I was able to run it but the following came up: Run-time error &#39;33&#39;: Application-defined or object-defined error."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 13, "user_id": 9996657, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Y-LBER6Fh8Y/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq37b1bCjN4ASghI4o6JxIWrzM2_LA/mo/photo.jpg?sz=128", "display_name": "Derek Park", "link": "https://stackoverflow.com/users/9996657/derek-park"}, "edited": false, "score": 0, "creation_date": 1541606668, "post_id": 53191298, "comment_id": 93275351, "body": "oh.. on which line? I tested it and it ran fine."}, {"owner": {"reputation": 13, "user_id": 9996657, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Y-LBER6Fh8Y/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq37b1bCjN4ASghI4o6JxIWrzM2_LA/mo/photo.jpg?sz=128", "display_name": "Derek Park", "link": "https://stackoverflow.com/users/9996657/derek-park"}, "edited": false, "score": 0, "creation_date": 1541606893, "post_id": 53191298, "comment_id": 93275487, "body": "WAIT. I looked at a previous comment of yours on another post and a user stated that they just had to paste the new driver into the SeleniumBasic folder."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 13, "user_id": 9996657, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Y-LBER6Fh8Y/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq37b1bCjN4ASghI4o6JxIWrzM2_LA/mo/photo.jpg?sz=128", "display_name": "Derek Park", "link": "https://stackoverflow.com/users/9996657/derek-park"}, "edited": false, "score": 0, "creation_date": 1541607082, "post_id": 53191298, "comment_id": 93275600, "body": "you could try that. Mine is on the environmental path. Did the other user pass that path to selenium as an argument/was the selenium folder on the environmental path?"}, {"owner": {"reputation": 13, "user_id": 9996657, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Y-LBER6Fh8Y/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq37b1bCjN4ASghI4o6JxIWrzM2_LA/mo/photo.jpg?sz=128", "display_name": "Derek Park", "link": "https://stackoverflow.com/users/9996657/derek-park"}, "edited": false, "score": 0, "creation_date": 1541607720, "post_id": 53191298, "comment_id": 93275955, "body": "Here is the link to the thread! <a href=\"https://stackoverflow.com/questions/51196363/open-chrome-browser-with-selenium-in-vba\" title=\"open chrome browser with selenium in vba\">stackoverflow.com/questions/51196363/&hellip;</a>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 13, "user_id": 9996657, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Y-LBER6Fh8Y/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq37b1bCjN4ASghI4o6JxIWrzM2_LA/mo/photo.jpg?sz=128", "display_name": "Derek Park", "link": "https://stackoverflow.com/users/9996657/derek-park"}, "edited": false, "score": 0, "creation_date": 1541607811, "post_id": 53191298, "comment_id": 93276010, "body": "Thanks for the link. You hit the check mark next to the answer. <a href=\"https://stackoverflow.com/help/someone-answers\">stackoverflow.com/help/someone-answers</a>"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 2, "last_activity_date": 1541604236, "last_edit_date": 1541604236, "creation_date": 1541600381, "answer_id": 53191298, "question_id": 53190879, "link": "https://stackoverflow.com/questions/53190879/why-is-my-vba-code-unable-to-select-download-in-order-to-download-a-xls-file/53191298#53191298", "title": "Why is my VBA code unable to select &quot;Download&quot; in order to download a .xls file this specific website?", "body": "<p>As an aside I would go with an attribute = value CSS selector btw</p>\n\n<pre><code>ie.document.querySelector(\"[data-elm-id='event_details_download_auction_inventory']\").Click\n</code></pre>\n\n<hr>\n\n<p><strong>Selenium Basic with Chrome:</strong></p>\n\n<pre><code>Option Explicit\nPublic Sub GetDownload()\n'VBE &gt; Tools &gt; References &gt; Selenium Type Library\n'Requires latest chrome browser and chrome driver\n'Chrome driver containing folder must be on environmental path\n'Download selenium https://github.com/florentbr/SeleniumBasic/releases/tag/v2.0.9.0\n    Dim d As WebDriver\n    Set d = New ChromeDriver\n    Const URL = \"https://www.auction.com/event/details/E-11142/?filter=reset\"\n\n    With d\n        .Start \"Chrome\"\n        .get URL\n        .FindElementByCss(\"[data-elm-id='event_details_download_auction_inventory']\").Click\n        .Quit\n    End With\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/a/52690693/6241235\">Other selenium info</a></p>\n\n<p><a href=\"https://superuser.com/questions/284342/what-are-path-and-other-environment-variables-and-how-can-i-set-or-use-them\">Environmental path</a> - the driver must sit in a folder which is on this path.</p>\n"}], "owner": {"reputation": 13, "user_id": 9996657, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Y-LBER6Fh8Y/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq37b1bCjN4ASghI4o6JxIWrzM2_LA/mo/photo.jpg?sz=128", "display_name": "Derek Park", "link": "https://stackoverflow.com/users/9996657/derek-park"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 53191298, "answer_count": 1, "score": 1, "last_activity_date": 1586400040, "creation_date": 1541598881, "last_edit_date": 1586400040, "question_id": 53190879, "link": "https://stackoverflow.com/questions/53190879/why-is-my-vba-code-unable-to-select-download-in-order-to-download-a-xls-file", "title": "Why is my VBA code unable to select &quot;Download&quot; in order to download a .xls file this specific website?", "body": "<p>Good morning,</p>\n\n<p>I am wondering why my code does not work on this site in particular. I would like to be able to have it press \"Download\" in order to initiate the process for downloading an .xls file. However, it does not and I am unable to figure it out.</p>\n\n<pre><code>Public IE As InternetExplorer\n\nPublic Sub Main()\n  Call InitiateIE\n  IE.navigate (\"https://www.auction.com/event/details/E-11142/?filter=reset\")\n  Call LoadIE\n  IE.Document.getElementsByClassName(\"button-root_button_jzfF button-role-default_button_3iu5 button-is-medium_button_3vqd navigation-btn_styles_M1TS download-inventory-btn_styles_3ytA navigation-container-element_styles_3MZ0\")(0).Click\n  Call LoadIE\n  IE.Quit\nEnd Sub\n\nPrivate Sub InitiateIE()\n  Set IE = New InternetExplorer\n  IE.Visible = True\nEnd Sub\n\nPrivate Sub LoadIE(Optional BufferTime As Long = 1000)\n  Do While IE.Busy\n  Loop\n  Do Until IE.Document.ReadyState = \"complete\" Or IE.Document.ReadyState = \"interactive\"\n  Loop\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1541599021, "post_id": 53190821, "comment_id": 93270548, "body": "Just to be clear, you want to hide all of the columns that are merged into a single cell?"}, {"owner": {"reputation": 1079, "user_id": 6827197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/445d726384a840c085144bdced116a32?s=128&d=identicon&r=PG&f=1", "display_name": "a-burge", "link": "https://stackoverflow.com/users/6827197/a-burge"}, "edited": false, "score": 0, "creation_date": 1541600232, "post_id": 53190821, "comment_id": 93271222, "body": "Could try this to identify Date 1 and continue with your solution: <a href=\"https://stackoverflow.com/questions/22075988/detect-merged-cells-in-vba-excel-with-mergearea\" title=\"detect merged cells in vba excel with mergearea\">stackoverflow.com/questions/22075988/&hellip;</a>"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1541601343, "post_id": 53190821, "comment_id": 93271876, "body": "Not sure what you mean.  You can check if a cell is part of a merged range by checking the <code>MergeCells</code> property of the cell and return the merged address using the <code>MergeArea.Address</code> property of the cell."}, {"owner": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1541601765, "post_id": 53190821, "comment_id": 93272119, "body": "Along the lines of @DarrenBartrup-Cook &#39;s comments, you might be able to do something like <code>MergeArea.Range(&quot;A1&quot;)</code> to grab the date for a merged area, but I&#39;d like to think about this to see if there is a cleaner way to do this (if someone does not come up with a solution before I get to it :)"}, {"owner": {"reputation": 13, "user_id": 10614963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ed9a03c6d297fb2bd3d01d9ab097ac1?s=128&d=identicon&r=PG&f=1", "display_name": "GBeltramini", "link": "https://stackoverflow.com/users/10614963/gbeltramini"}, "edited": false, "score": 0, "creation_date": 1541602888, "post_id": 53190821, "comment_id": 93272901, "body": "I want to input a Start and End Date and show only everything in between them."}], "answers": [{"tags": [], "owner": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "is_accepted": false, "score": 0, "last_activity_date": 1541604438, "last_edit_date": 1541604438, "creation_date": 1541603962, "answer_id": 53192406, "question_id": 53190821, "link": "https://stackoverflow.com/questions/53190821/hide-multiple-columns-except-date-range/53192406#53192406", "title": "Hide Multiple Columns Except Date Range", "body": "<p>Maybe something like the below:</p>\n\n<pre><code>Function ShowDate(StartDate As Date, LastDate As Date)\n\nDim tVar As Variant, CurDate As Date, hideBoolean As Boolean\n\nWith ActiveSheet\n    ' Get the date range, and the field ranges, and put into an array for easy manipulation\n    tVar = Intersect(.UsedRange, .Range(\"2:3\"))\nEnd With\n\n' For each column\nFor i = 1 To UBound(tVar, 2)\n    ' If there is no field, then let's not do anything\n    If Len(tVar(2, i)) = 0 Then GoTo SkipIt\n    ' If there is a date, then make a note of it, otherwise make the top level equal to the current date\n    If Not Len(tVar(1, i)) = 0 Then CurDate = tVar(1, i) Else tVar(1, i) = CurDate\n    ' Figure out whether we want to hide the column or not.\n    hideBoolean = (tVar(1, i) &lt; StartDate) And (tVar(1, i) &gt; LastDate)\n    ' And finally hide or unhide that column\n    ActiveSheet.Cells(1, i).EntireColumn.Hidden = hideBoolean\nSkipIt:\n    Next i\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10614963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ed9a03c6d297fb2bd3d01d9ab097ac1?s=128&d=identicon&r=PG&f=1", "display_name": "GBeltramini", "link": "https://stackoverflow.com/users/10614963/gbeltramini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1586402243, "creation_date": 1541598667, "last_edit_date": 1586402243, "question_id": 53190821, "link": "https://stackoverflow.com/questions/53190821/hide-multiple-columns-except-date-range", "title": "Hide Multiple Columns Except Date Range", "body": "<p>I'm trying to write a VBA code to show only some columns between two dates which are input in other cells. Since Excel doesn't consider \"Date 1\" (annoying) as the content for all the merged cells it is not possible to use some \"while\" logic, which could be great here. </p>\n\n<p>I've tried some things but they clearly don't work.</p>\n\n<p>Context:\nI have this currently in multiple sheets in a workbook and I wanted to have all the information in one sheet and the idea to keep it organized was to use a filter.</p>\n\n<p>If someone has an idea for the code or another way to organize this, it would be very helpful.</p>\n\n<p>Code I tried:</p>\n\n<pre><code>With ActiveSheet\n    LastDate = .Cells(\"2\", Columns.Count).End(xlToLeft).Column\n    Set DDS = Range(.Cells(2, 11), .Cells(56, LastDate))\nEnd With\n\nFor i = 1 To LastDate\n    If DDS(1, i) = StartDate Then\n        DDS.Cells(1, i).EntireColumn.Hidden = False\n        i = i + 22\n        For j = i To LastDate\n            If DDS(1, j) = EndDate Then\n                For k = j To LastDate\n                    If DDS(1, k) &lt;&gt; 0 And DDS(1, k) &lt;&gt; EndDate Then\n                        j = k\n                        Exit For\n                    End If\n                Next k\n                i = j\n                Exit For\n            End If\n        Next j\n    Else\n        DDS.Cells(1, i).EntireColumn.Hidden = True\n        i = i + 22\n    End If\nNext i\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/mOi5T.png\" alt=\"Tables\"></p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1541598764, "post_id": 53190746, "comment_id": 93270415, "body": "<code>.Run (&quot;&quot;&quot;C:\\PathToRuntim\\MSACCESS.EXE&quot;&quot; &quot;&quot;U:\\Database1.accdb&quot;&quot;&quot;)</code> Try to specify the path to the runtime"}, {"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1541599283, "post_id": 53190746, "comment_id": 93270688, "body": "or you could change the extension from accdb to accdr"}], "answers": [{"tags": [], "owner": {"reputation": 1112, "user_id": 7354796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7efd450f69bda421b8348f3f694ae621?s=128&d=identicon&r=PG&f=1", "display_name": "OwlsSleeping", "link": "https://stackoverflow.com/users/7354796/owlssleeping"}, "is_accepted": false, "score": 0, "last_activity_date": 1541599408, "last_edit_date": 1541599408, "creation_date": 1541598991, "answer_id": 53190905, "question_id": 53190746, "link": "https://stackoverflow.com/questions/53190746/vba-open-access-in-runtime/53190905#53190905", "title": "VBA Open Access in Runtime", "body": "<pre><code>CreateObject(\"WScript.Shell\").Run (\"\"\"U:\\Database1.accdb\"\" /runtime\")\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 10489030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8984472387c640076b1647fe4d5e558?s=128&d=identicon&r=PG&f=1", "display_name": "O.Gum", "link": "https://stackoverflow.com/users/10489030/o-gum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1541599408, "creation_date": 1541598426, "last_edit_date": 1541598635, "question_id": 53190746, "link": "https://stackoverflow.com/questions/53190746/vba-open-access-in-runtime", "title": "VBA Open Access in Runtime", "body": "<p>How can i open Access in Runtime ? I tried it with the Code below but it seems he opens the full Version Access and not the runtime Version.</p>\n\n<pre><code>CreateObject(\"WScript.Shell\").Run (\"\"\"U:\\Database1.accdb\"\"\")\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1541597458, "post_id": 53190430, "comment_id": 93269660, "body": "move <code>Counter = 1</code> right below <code>For Each ws In ThisWorkbook.Worksheets</code> to reset the counter for every worksheet."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1541597635, "post_id": 53190430, "comment_id": 93269752, "body": "@P\u1d07\u029c is really too fast ;)"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1541598022, "post_id": 53190430, "comment_id": 93269940, "body": "@VincentG Actually not that fast: I wrote that answer <a href=\"https://stackoverflow.com/questions/53176057/rearrange-columns-on-all-worksheets/53176192#53176192\">here</a> and the OP asked that already in a comment (which provided not the essential information to understand what the issue was). So actually with a better explained question I immediately saw the issue here because I already knew that piece of code ... So I had some kind of advantage here ;)"}], "owner": {"reputation": 7, "user_id": 10490222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d57df066e2927f05a326a41a3695a1d?s=128&d=identicon&r=PG&f=1", "display_name": "maracleinc", "link": "https://stackoverflow.com/users/10490222/maracleinc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1586402279, "creation_date": 1541597354, "last_edit_date": 1586402279, "question_id": 53190430, "link": "https://stackoverflow.com/questions/53190430/vba-rearranging-columns-code-moves-columns-to-the-right-on-each-sheet", "title": "VBA: Rearranging Columns code moves columns to the right on each sheet", "body": "<p>I have this code that looks through each worksheet and rearranges the columns based on an array. The problem is, with each sheet the code moves my columns from starting in A1.</p>\n\n<p>For example, sheet 1 starts in A1, sheet 2 starts in P1, sheet 3 starts in AE, and so forth. They all need to start in A1. </p>\n\n<p>Also, on every sheet except sheet 1, it adds a blank column after each header, which I don't want. </p>\n\n<p>Here is the code:</p>\n\n<pre><code>Sub RearrangeColumnsInAllWorksheets()\nDim arrColOrder As Variant\narrColOrder = Array(\"Company\", \"First Name\", \"Last Name\", \"Email\", \"Category\", \"Address\", \"Suite or Unit?\", \"Suite/Unit\", \"City\", \"Province\", \"Postal Code\", \"Phone\", \"Fax\", \"Website\", \"Service Areas\", \"Logo\", \"CONCAT\")\n\nDim ndx As Long\nDim Found As Range\n\nDim Counter As Long\nCounter = 1\nApplication.ScreenUpdating = False\n\nDim ws As Worksheet\nFor Each ws In ThisWorkbook.Worksheets 'loop through all worksheets\n    For ndx = LBound(arrColOrder) To UBound(arrColOrder)\n        Set Found = ws.Rows(\"1:1\").Find(arrColOrder(ndx), LookIn:=xlValues, LookAt:=xlWhole, SearchOrder:=xlByColumns, SearchDirection:=xlNext, MatchCase:=False)\n        If Not Found Is Nothing Then\n            If Found.Column &lt;&gt; Counter Then\n                Found.EntireColumn.Cut\n                ws.Columns(Counter).Insert Shift:=xlToRight\n                Application.CutCopyMode = False\n            End If\n            Counter = Counter + 1\n         End If\n    Next ndx\nNext ws\n\nApplication.ScreenUpdating = True 'don't forget to turn it on again\nEnd Sub\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba", "match", "msgbox"], "answers": [{"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1541597718, "post_id": 53190371, "comment_id": 93269785, "body": "Note that <code>Dim countRows, r, c, e As Integer</code> only declares <code>e As Integer</code> but all others as <code>Variant</code>. You need to declare a type for <b>every</b> variable <code>Dim countRows As Long, r As Long, c As Long, e  As Long</code>. Also all row counting variables need to be of type <code>Long</code> because Excel has more rows than <code>Integer</code> can handle. It is recommended <a href=\"https://stackoverflow.com/a/26409520/3219613\">always to use Long instead of Integer</a> in VBA as there is no benefit in <code>Integer</code> at all."}], "tags": [], "owner": {"reputation": 892, "user_id": 10503508, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q1Afy.jpg?s=128&g=1", "display_name": "Ferdinando", "link": "https://stackoverflow.com/users/10503508/ferdinando"}, "is_accepted": true, "score": 0, "last_activity_date": 1541597658, "last_edit_date": 1541597658, "creation_date": 1541597126, "answer_id": 53190371, "question_id": 53190153, "link": "https://stackoverflow.com/questions/53190153/vba-excel-how-to-match-two-column-and-paste-the-data-in-anotherone/53190371#53190371", "title": "VBA Excel how to match two column and paste the data in anotherone", "body": "<p>Welcome to SO Antonio,( i am italian and i have studied your question)try to put <code>next e</code> before <code>If trovato = False Then</code>...\nKeep me update...</p>\n\n<pre><code>Sub AssociazioneCodice()\n\n    'Dichiarazione della variabile per conteggio righe\n\n\n    Dim countRows, r, c, e As Integer\n    Dim trovato As Boolean\n    \u00a0\n    'Applicazione conteggio righe - Achtung!: Inserire sempre correttamente il nome del foglio dove si trovano i riferimenti da contare\n    countRows = ThisWorkbook.Worksheets(\"Foglio2\").Range(\"A:A\").Cells.SpecialCells(xlCellTypeConstants).Count\n\n    'Il for serve a cercare il numero del codice nella colonna E dei codici\n    For r = 1 To countRows\n    \u00a0\n        'Con il secondo for effettuo la corrispondenza tra la colonna dei codici E e confronto con i codici di riferimento generici della colonna F\n        For e = 1 To countRows\n\n            'L'if seguente serve a dire SE la cella della riga 'r' della colonna E \u00e8 uguale alla cella della riga 'e' della colonna F\n            If Cells(r, 5) = Cells(e, 6) Then\n\n                'visto che ho trovato corrispondenza, allora prendi il contenuto della riga 'e' della colonna G e copiala nella riga 'r' della colonna H\n                Cells(r, 8) = Cells(e, 7)\n\n                e = countRows                    'una volta controllato il codice e trovato, passo alla riga 'r' successiva\n                trovato = True\n\n            End If\n\n        Next e\n\n        If trovato = False Then\n\n            'SE non \u00e8 stato trovato il codice, allora manda un messaggio e scrivi \"ERRORE\" nella riga'r' della colonna H\n            MsgBox \"Codice non in elenco \" &amp; Cells(r, 5).Value &amp; \" Riga \" &amp; r\n            Cells(r, 8) = \" ERRORE \"\n\n        Else\n\n            trovato = False                      'Se ha trovato il codice, allora viene resettato a False il booleano 'trovato'\n\n        End If\n\n    Next r\n\n    MsgBox \" Numero di avvisi a sistema \" &amp; countRows\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7, "user_id": 10608784, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JqKyUjORink/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAM6ODzuujINOlwUCuey8JpT9gPvQ/mo/photo.jpg?sz=128", "display_name": "ANTONIO SAVIO RANIERI", "link": "https://stackoverflow.com/users/10608784/antonio-savio-ranieri"}, "edited": false, "score": 0, "creation_date": 1541597890, "post_id": 53190444, "comment_id": 93269871, "body": "Thank you for your answare but i need for every rows in H column. Your code is good but only for row #2 while I need from first to last. I like so much your smallest code but how can I let work it?"}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "reply_to_user": {"reputation": 7, "user_id": 10608784, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JqKyUjORink/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAM6ODzuujINOlwUCuey8JpT9gPvQ/mo/photo.jpg?sz=128", "display_name": "ANTONIO SAVIO RANIERI", "link": "https://stackoverflow.com/users/10608784/antonio-savio-ranieri"}, "edited": false, "score": 0, "creation_date": 1541598380, "post_id": 53190444, "comment_id": 93270191, "body": "According to your images posted with the question the row 1 is the Header - &quot;Source Code&quot; so data start from row 2 up to the last row.so, in my example i start loop from row 2 to last row."}, {"owner": {"reputation": 7, "user_id": 10608784, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JqKyUjORink/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAM6ODzuujINOlwUCuey8JpT9gPvQ/mo/photo.jpg?sz=128", "display_name": "ANTONIO SAVIO RANIERI", "link": "https://stackoverflow.com/users/10608784/antonio-savio-ranieri"}, "edited": false, "score": 0, "creation_date": 1541599178, "post_id": 53190444, "comment_id": 93270626, "body": "Yes. I know that the data starts from row 2 but your code stop Always to 2nd row"}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "reply_to_user": {"reputation": 7, "user_id": 10608784, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JqKyUjORink/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAM6ODzuujINOlwUCuey8JpT9gPvQ/mo/photo.jpg?sz=128", "display_name": "ANTONIO SAVIO RANIERI", "link": "https://stackoverflow.com/users/10608784/antonio-savio-ranieri"}, "edited": false, "score": 0, "creation_date": 1541599326, "post_id": 53190444, "comment_id": 93270715, "body": "This may occurred from the wrong calculation of last row - LR.You must check two thinks: 1.Sheet1 name &amp; column. Could you please tell me which is the value of LR when the code enter the loop?"}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1541597405, "creation_date": 1541597405, "answer_id": 53190444, "question_id": 53190153, "link": "https://stackoverflow.com/questions/53190153/vba-excel-how-to-match-two-column-and-paste-the-data-in-anotherone/53190444#53190444", "title": "VBA Excel how to match two column and paste the data in anotherone", "body": "<p>You can also use:</p>\n\n<pre><code>Sub AssociazioneCodice()\n\nDim LR As Long, i As Long\n\nWith Worksheets(\"Sheet1\")\n\n    LR = .Range(\"E\" &amp; .Rows.Count).End(xlUp).Row\n\n    For i = 2 To LR\n        If .Range(\"E\" &amp; i).Value = .Range(\"F\" &amp; i).Value Then\n            .Range(\"H\" &amp; i).Value = .Range(\"G\" &amp; i).Value\n        End If\n\n    Next i\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 10608784, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JqKyUjORink/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAM6ODzuujINOlwUCuey8JpT9gPvQ/mo/photo.jpg?sz=128", "display_name": "ANTONIO SAVIO RANIERI", "link": "https://stackoverflow.com/users/10608784/antonio-savio-ranieri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 2, "accepted_answer_id": 53190371, "answer_count": 2, "score": 1, "last_activity_date": 1586402315, "creation_date": 1541596264, "last_edit_date": 1586402315, "question_id": 53190153, "link": "https://stackoverflow.com/questions/53190153/vba-excel-how-to-match-two-column-and-paste-the-data-in-anotherone", "title": "VBA Excel how to match two column and paste the data in anotherone", "body": "<p>i'm new in vba and i would ask something about a VBA code that i made.</p>\n\n<p>I've already read this link:\n<a href=\"https://stackoverflow.com/questions/44776790/vba-match-column-data-and-paste\">VBA - Match Column Data and paste</a>\nbut it's not good for my needs.</p>\n\n<p>My target is match column E with column F and give the description inside rows in G to paste in column H.</p>\n\n<p>To get an msg box error if the match is false.</p>\n\n<p>my problem is that the msg box appear always on my desk without matching.</p>\n\n<p>Which is my mistake? </p>\n\n<p>thank you everyone.</p>\n\n<p><a href=\"https://i.stack.imgur.com/lrtqM.png\" rel=\"nofollow noreferrer\">This is an example of my sheet:</a></p>\n\n<p>This is my code so far:</p>\n\n<pre><code>Sub AssociazioneCodice()\n\n'Dichiarazione della variabile per conteggio righe\nDim countRows, r, c, e As Integer\nDim trovato As Boolean\ntrovato = False\n\n\n'Applicazione conteggio righe - Achtung!: Inserire sempre correttamente il nome del foglio dove si trovano i riferimenti da contare\ncountRows = ThisWorkbook.Worksheets(\"Foglio2\").Range(\"A:A\").Cells.SpecialCells(xlCellTypeConstants).Count\n\n'Il for serve a cercare il numero del codice nella colonna E dei codici\nFor r = 1 To countRows\n\n'Con il secondo for effettuo la corrispondenza tra la colonna dei codici E e confronto con i codici di riferimento generici della colonna F\n    For e = 1 To countRows\n\n'L'if seguente serve a dire SE la cella della riga 'r' della colonna E \u00e8 uguale alla cella della riga 'e' della colonna F\n        If Cells(r, 5) = Cells(e, 6) Then\n        'visto che ho trovato corrispondenza, allora prendi il contenuto della riga 'e' della colonna G e copiala nella riga 'r' della colonna H\n\n            Cells(r, 8) = Cells(e, 7)\n            e = countRows   'una volta controllato il codice e trovato, passo alla riga 'r' successiva\n            trovato = True\n\n        End If\n\n    If trovato = False Then\n    'SE non \u00e8 stato trovato il codice, allora manda un messaggio e scrivi \"ERRORE\" nella riga'r' della colonna H\n\n        MsgBox \"Codice non in elenco \" &amp; Cells(r, 5).Value &amp; \" Riga \" &amp; r\n        Cells(r, 8) = \" ERRORE \"\n\n    Else: trovato = False   'Se ha trovato il codice, allora viene resettato a False il booleano 'trovato'\n\n    End If\n\n    Next e\nNext r\n\nMsgBox \" Numero di avvisi a sistema \" &amp; countRows\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "dictionary", "object", "scripting.dictionary"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1541596542, "post_id": 53190135, "comment_id": 93269206, "body": "Best guess would be that you never added that MSID, since it&#39;s in the other part of the (unspecified) <code>If</code> clause."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1541597217, "post_id": 53190135, "comment_id": 93269539, "body": "Wrap the access in <code>If processList.Exists(MSID) Then</code>. You&#39;re assuming that you get a result from <code>processList(MSID)</code>."}, {"owner": {"reputation": 11, "user_id": 6388446, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iq9qV.png?s=128&g=1", "display_name": "Rionick", "link": "https://stackoverflow.com/users/6388446/rionick"}, "edited": false, "score": 0, "creation_date": 1541598903, "post_id": 53190135, "comment_id": 93270487, "body": "I updated the question. This if statement evaluates as false (not found in the dictionary). However, when I debug, I see it there with the exact same MSID. It just absolutely doesn&#39;t make sense to me... Even if I access it with <code>If processList.Exists(&quot;124&quot;) Then </code> it doesn&#39;t work"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 6388446, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iq9qV.png?s=128&g=1", "display_name": "Rionick", "link": "https://stackoverflow.com/users/6388446/rionick"}, "is_accepted": false, "score": 0, "last_activity_date": 1541605191, "creation_date": 1541605191, "answer_id": 53192773, "question_id": 53190135, "link": "https://stackoverflow.com/questions/53190135/vba-object-required-error-altering-object-from-dictionary/53192773#53192773", "title": "VBA - Object Required Error, Altering Object from Dictionary", "body": "<p>So... It's a bit shameful but after some hours of trying to solve this problem I found out,\nthat I added the Object to the list with MSID=\"124 \" as Key. </p>\n\n<p>When I tried to access, I of course used MSID with value \"124\".\nNotice the difference? Yes, that space at the end.</p>\n\n<p>The tricky part is - VBA debugger trims spaces at the end of Strings,\nso it's actually impossible to see it. The same situation is if you print this out - impossible to see... </p>\n\n<p>So in the end, I spent many hours looking for the answer, which is so simple :/ \nAll I can do is to laugh about this. </p>\n"}], "owner": {"reputation": 11, "user_id": 6388446, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iq9qV.png?s=128&g=1", "display_name": "Rionick", "link": "https://stackoverflow.com/users/6388446/rionick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 242, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1541605191, "creation_date": 1541596213, "last_edit_date": 1541598512, "question_id": 53190135, "link": "https://stackoverflow.com/questions/53190135/vba-object-required-error-altering-object-from-dictionary", "title": "VBA - Object Required Error, Altering Object from Dictionary", "body": "<p><br>\nI am programming a kind of parser which reads an Excel table and then creates a \n<strong>List of processes</strong> with some <strong>properties</strong> like <em>Name, StartTime, EndTime</em> etc.\nFor this I have a class <strong>Process</strong> and in the main file, I have a <strong>processList</strong> (Scripting.Dictionary), where I put the processes as I read the lines... For this assignment, the <strong>key</strong> is a String called <strong>MSID</strong>.</p>\n\n<p>Now the problem is that for some reason, I am only able to access the Object from the Dictionary and alter its parameters inside one part of my If-ElseIf statement. In the other case, it throws <strong>424-object required error</strong> and I have no idea why.</p>\n\n<p>Here is the code</p>\n\n<pre><code>Sub ParseMessages()\n' ITERATOR VARIABLES\nDim wb As Workbook, ws As Worksheet\nDim rowIter As Long, row As Variant\nDim A As Variant, B As Variant, C As Variant, D As Variant, E As Variant, F As Variant  ' A,B,C,D,E,F variables for the cells of each row\n\n' PROCESS PARAMETERS\nDim MSID As Variant\nDim StartTime As Variant\nDim EndTime As Variant\n\n' OBJECTS\nDim process As process\nDim processList As Scripting.Dictionary     ' DICTIONARY where the error happens\nSet processList = New Scripting.Dictionary\n\nWorksheets(1).Activate\n\n'####### MAIN LOOP ######################################################\nFor rowIter = 1 To 11\n    row = Rows(rowIter)\n    A = row(1, 1)\n    B = row(1, 2)\n    C = row(1, 3)\n    D = row(1, 4)\n    E = row(1, 5)\n    F = row(1, 6)\n    Dim startIndex As Long, endIndex As Long, count As Long\n\n    ' ------ PROCESSSTART -&gt; MSID, processName, startTime\n    If (.....) Then\n        Debug.Print (vbNewLine &amp; \"Process start\")\n        If (...) Then   ' --MSID\n            startIndex = InStr(F, \"Nr\") + 3             '3 to skip \"Nr \"\n            endIndex = InStr(startIndex, F, \"(\")\n            count = endIndex - startIndex\n            MSID = Mid(F, startIndex, count)\n            StartTime = B\n            Debug.Print (StartTime &amp; \" -&gt; \" &amp; MSID)\n\n            ' **** MAKE new Process object, add to collection\n            Set process = New process\n            process.StartTime = StartTime\n            process.MSID = MSID\n            processList.Add MSID, process    ' Add to the dictionary, KEY, VALUE\n\n        ElseIf (...) Then      ' --ProcessName\n            startIndex = InStr(F, \"=\") + 2\n            endIndex = InStr(F, \"&lt;\") - 1\n            count = endIndex - startIndex\n            processName = Mid(F, startIndex, count)\n            Debug.Print (processName)\n            ' **** Add Name to the last element of the dictionary\n            processList(processList.Keys(processList.count - 1)).Name = processName 'get last Process Object\n            processList(MSID).Name = \"Just Testing\" ' !!!! here it works\n        Else\n        End If\n\n    ' ------ END OF PROCESS -&gt;\n    ElseIf (......) Then\n        startIndex = InStr(D, \"MSID\") + 5\n        endIndex = InStr(startIndex, D, \"]\")\n        count = endIndex - startIndex\n        MSID = Mid(D, startIndex, count)\n\n        EndTime = B\n        Debug.Print (EndTime &amp; \" End of process \" &amp; MSID)\n\n        ' **** Add End time for the process from the collection, specified by MSID\n        Debug.Print (\"Test of \" &amp; processList(MSID).Name)  ' !!!!! Doesn't work\n        processList(MSID).Name = \"Just Prooooooving\"       ' !!!!! Here doesn't work\n        processList(MSID).EndTime = EndTime                ' !!!!! Does not work\n    End If\nNext\nEnd Sub\n</code></pre>\n\n<p>So to specify the question - why is it that this works:</p>\n\n<pre><code>processList(MSID).Name = \"Just Testing\" ' !!!! here it works\n</code></pre>\n\n<p>And this doesn't:</p>\n\n<pre><code>processList(MSID).Name = \"Just Prooooooving\"       ' !!!!! Here doesn't work\n</code></pre>\n\n<p>If I first prove if the Object with the MSID key exists in the dictionary,\nit's not found. </p>\n\n<pre><code>If processList.Exists(MSID) Then\n            Debug.Print (\"Process exists, altering it...\")\n            processList(MSID).Name = \"Just Prooooooving\"   ' !!!!! Here doesn't work\n            processList(MSID).EndTime = EndTime\nEnd If\n</code></pre>\n\n<p>But on the very first line where the condition is evaluated, I get something different by debug. It's THERE! See picture below</p>\n\n<p><a href=\"https://i.stack.imgur.com/U1NV4.png\" rel=\"nofollow noreferrer\">Debugging - MSID there but not able to access Dictionary entry with this as a key</a></p>\n\n<p>Can you suggest how to solve this issue?</p>\n\n<p>Thank you very much in advance for your help!</p>\n"}, {"tags": ["excel", "vba", "formatting", "msgbox"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1541597213, "post_id": 53189846, "comment_id": 93269536, "body": "To your edit: The issue is that your error handler is silent. If a error occurs it jumps to <code>Handler:</code> and nothing happens (no message at all). Therefore you cannot notice any errors. comment out <code>On Error GoTo Handler</code> to debug it and implement a proper error handling later: See <a href=\"https://excelmacromastery.com/vba-error-handling\" rel=\"nofollow noreferrer\">VBA Error Handling \u2013 A Complete Guide</a>"}], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 8966999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b57dc4045be0594909cb357a98756d0?s=128&d=identicon&r=PG&f=1", "display_name": "L.Writer", "link": "https://stackoverflow.com/users/8966999/l-writer"}, "edited": false, "score": 0, "creation_date": 1541596638, "post_id": 53189933, "comment_id": 93269250, "body": "Thanks, your answer makes absolutely sense to me. But it seems not be working now. I will update my original post with further details."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 77, "user_id": 8966999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b57dc4045be0594909cb357a98756d0?s=128&d=identicon&r=PG&f=1", "display_name": "L.Writer", "link": "https://stackoverflow.com/users/8966999/l-writer"}, "edited": false, "score": 0, "creation_date": 1541596774, "post_id": 53189933, "comment_id": 93269321, "body": "@L.Writer Ah didn&#39;t see it. You used <code>ActiveCell</code> instead of <code>Target</code> so it might read from another cell than you wrote in. Fixed my answer."}, {"owner": {"reputation": 77, "user_id": 8966999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b57dc4045be0594909cb357a98756d0?s=128&d=identicon&r=PG&f=1", "display_name": "L.Writer", "link": "https://stackoverflow.com/users/8966999/l-writer"}, "edited": false, "score": 0, "creation_date": 1541597251, "post_id": 53189933, "comment_id": 93269563, "body": "I have used your update, but it seems still not to be working for me?! I have updated my original post with some additional details, hopefully this will help."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 77, "user_id": 8966999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b57dc4045be0594909cb357a98756d0?s=128&d=identicon&r=PG&f=1", "display_name": "L.Writer", "link": "https://stackoverflow.com/users/8966999/l-writer"}, "edited": false, "score": 0, "creation_date": 1541597343, "post_id": 53189933, "comment_id": 93269609, "body": "Comment out <code>On Error GoTo Handler</code> and tell which error you get and where please."}, {"owner": {"reputation": 77, "user_id": 8966999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b57dc4045be0594909cb357a98756d0?s=128&d=identicon&r=PG&f=1", "display_name": "L.Writer", "link": "https://stackoverflow.com/users/8966999/l-writer"}, "edited": false, "score": 0, "creation_date": 1541597827, "post_id": 53189933, "comment_id": 93269830, "body": "Ah sorry, missed the error handler... ^^ <code>Target.Offset(0, 3).NumberFormat = &quot;currency&quot;</code> seems to be the issue.. I&#39;m receiving <b>runtime error 1004</b>"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 77, "user_id": 8966999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b57dc4045be0594909cb357a98756d0?s=128&d=identicon&r=PG&f=1", "display_name": "L.Writer", "link": "https://stackoverflow.com/users/8966999/l-writer"}, "edited": false, "score": 1, "creation_date": 1541598230, "post_id": 53189933, "comment_id": 93270085, "body": "Ah I missed that too. Obviously <code>&quot;currency&quot;</code> is no valid number format. So you must use something like <code>&quot;#,##0.00 $&quot;</code>. See <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.numberformat\" rel=\"nofollow noreferrer\">Range.NumberFormat Property</a> and <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.numberformatlocal\" rel=\"nofollow noreferrer\">Range.NumberFormatLocal Property</a>"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 3, "last_activity_date": 1541598324, "last_edit_date": 1541598324, "creation_date": 1541595543, "answer_id": 53189933, "question_id": 53189846, "link": "https://stackoverflow.com/questions/53189846/excel-vba-formatting-and-variable-output-not-always-working/53189933#53189933", "title": "Excel VBA formatting and variable output not always working", "body": "<p>The <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/format-function-visual-basic-for-applications\" rel=\"nofollow noreferrer\">Format function</a> always returns a string/text.</p>\n\n<p>So here: <code>Target.Offset(0, 3) = Format(0.7, \"currency\")</code> you don't write a numeric value but a text.</p>\n\n<p>Instead write the value and set the number format of the cell:</p>\n\n<pre><code>Target.Offset(0, 3).Value = 0.7\nTarget.Offset(0, 3).NumberFormat = \"#,##0.00 $\"\n</code></pre>\n\n<p>Then you can read the cell's <code>.Text</code> (instead of <code>.Value</code>) to get it formatted as shown in cell:</p>\n\n<pre><code>Dim price As Sting\nprice = Target.Offset(0, 3).Text\nMsgBox \"The price is now \" &amp; price\n</code></pre>\n\n<p>or read the cell's Value and format it whatever you like:</p>\n\n<pre><code>Dim price As Double\nprice = Target.Offset(0, 3).Value\nMsgBox \"The price is now \" &amp; Format(price, \"#,##0.00 $\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 501, "user_id": 8580202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ab9a3cb8bd7c29a445545f21c050228?s=128&d=identicon&r=PG", "display_name": "adhy wijaya", "link": "https://stackoverflow.com/users/8580202/adhy-wijaya"}, "is_accepted": false, "score": -1, "last_activity_date": 1541595587, "creation_date": 1541595587, "answer_id": 53189950, "question_id": 53189846, "link": "https://stackoverflow.com/questions/53189846/excel-vba-formatting-and-variable-output-not-always-working/53189950#53189950", "title": "Excel VBA formatting and variable output not always working", "body": "<p>Can you try to change this line:</p>\n\n<pre><code>Dim price As Double\n</code></pre>\n\n<p>Good Luck</p>\n"}], "owner": {"reputation": 77, "user_id": 8966999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b57dc4045be0594909cb357a98756d0?s=128&d=identicon&r=PG&f=1", "display_name": "L.Writer", "link": "https://stackoverflow.com/users/8966999/l-writer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 727, "favorite_count": 0, "accepted_answer_id": 53189933, "answer_count": 2, "score": 1, "last_activity_date": 1541598324, "creation_date": 1541595198, "last_edit_date": 1541596901, "question_id": 53189846, "link": "https://stackoverflow.com/questions/53189846/excel-vba-formatting-and-variable-output-not-always-working", "title": "Excel VBA formatting and variable output not always working", "body": "<p>If a specific value will entered in row \"A\", a specific price should be inserted into row \"D\" and after that the entered price should be displayed in a messagebox.</p>\n\n<p>The first part was just an easy setup, but with the msgbox I have actually some issues. \nMaybe because of the procedure of the code?! The price is just in this moment inside the cell and my code is already trying to get this in the moment empty cell?! - not sure.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nOn Error GoTo Handler\n\nDim price As String\n\nIf Target.Column = 1 And Target.Value = \"XY01\" Then\n    Application.EnableEvents = False\n    Target.Offset(0, 3) = Format(0.7, \"currency\")\n    Application.EnableEvents = True\n    price = ActiveCell.Offset(0, 3).Value\n    MsgBox \"The price is now \" &amp; price\nEnd If\nHandler:\nEnd Sub\n</code></pre>\n\n<p>The really strange thing is that inside the first row it will be displayed as excepted:\n<a href=\"https://i.stack.imgur.com/AHCtD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AHCtD.png\" alt=\"enter image description here\"></a></p>\n\n<p>Just in every other row it will be displayed like this (it's just empty):\n<a href=\"https://i.stack.imgur.com/0pZAx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0pZAx.png\" alt=\"enter image description here\"></a></p>\n\n<p>My 2nd question is that I have formatted the value as \"currency\", but I'm anyway get this error message (in English like that the cell is formatted as text). Also by formatting the cell by the excel tools the error message will not disappear.</p>\n\n<p>Any Idea to fix this? </p>\n\n<p>Thank you guys.\n<a href=\"https://i.stack.imgur.com/E6X5x.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/E6X5x.png\" alt=\"enter image description here\"></a></p>\n\n<p>==============</p>\n\n<h1>EDIT</h1>\n\n<p>I have updated my code to following, so I was able to solve my 2nd question regarding the note that my value is just a text.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nOn Error GoTo Handler\n\nDim price As String\n\nIf Target.Column = 1 And Target.Value = \"XY01\" Then\n    Application.EnableEvents = False\n    Target.Offset(0, 3).Value = 0.7\n    Target.Offset(0, 3).NumberFormat = \"currency\"\n    Application.EnableEvents = True\n    price = Target.Offset(0, 3).Text\n    MsgBox \"The price is now \" &amp; price\nEnd If\nHandler:\nEnd Sub\n</code></pre>\n\n<p>I don't know why, but now will not be <strong>any</strong> msgbox displayed?!\nAlso the price will now only once inserted, if I type in the code again in another cell (a cell down) the code seems not be running again?!</p>\n\n<p>I need to reopen excel to bring it up to work again.</p>\n"}, {"tags": ["arrays", "vba", "text-files"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1541598079, "post_id": 53189727, "comment_id": 93269978, "body": "So where is this array that you&#39;re referring to? Are you looping over this code from another procedure?"}, {"owner": {"reputation": 1, "user_id": 10408353, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EINMTX53hGU/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWXJvtKPU-pCq_jm80HsNKUdOIbcg/mo/photo.jpg?sz=128", "display_name": "N Wally", "link": "https://stackoverflow.com/users/10408353/n-wally"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1541598311, "post_id": 53189727, "comment_id": 93270144, "body": "@Comintern this function is called from my main procedure. It displays data based on the date that is located in the cell.  Var1 is the first name, var2 is the surname, and var3 is the date. Currently we get a msgbox with the right data, I just can&#39;t get it to also write it to a .txt file properly. Currently with &#39;output&#39; it displays just the last line of the array data. &#39;Append&#39; displays all the right data, but it does not replace the .txt file - only adds to it. It would need to replace and save over the old data in the .txt file."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1541598397, "post_id": 53189727, "comment_id": 93270201, "body": "In that case, you&#39;re blowing away the file every time you call this. You need to open the file <i>before you start the loop</i>, not with every iteration. Can you edit the question to include the calling code?"}, {"owner": {"reputation": 1, "user_id": 10408353, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EINMTX53hGU/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWXJvtKPU-pCq_jm80HsNKUdOIbcg/mo/photo.jpg?sz=128", "display_name": "N Wally", "link": "https://stackoverflow.com/users/10408353/n-wally"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1541598608, "post_id": 53189727, "comment_id": 93270333, "body": "@Comintern just did. Please check - I am assuming I would just copy the code into the other functions as they are all pretty much the same (would just need to change the odd thing)."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1541598751, "post_id": 53189727, "comment_id": 93270406, "body": "OK, so you have 3 files you&#39;re writing to? Open all three before the <code>For Each</code> in the calling code, and then pass the appropriate file handle to each function."}, {"owner": {"reputation": 1, "user_id": 10408353, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EINMTX53hGU/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWXJvtKPU-pCq_jm80HsNKUdOIbcg/mo/photo.jpg?sz=128", "display_name": "N Wally", "link": "https://stackoverflow.com/users/10408353/n-wally"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1541598925, "post_id": 53189727, "comment_id": 93270500, "body": "Would you be able to put this into code? I don&#39;t think I am quite understanding where to put it."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10408353, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EINMTX53hGU/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWXJvtKPU-pCq_jm80HsNKUdOIbcg/mo/photo.jpg?sz=128", "display_name": "N Wally", "link": "https://stackoverflow.com/users/10408353/n-wally"}, "edited": false, "score": 0, "creation_date": 1541597923, "post_id": 53190440, "comment_id": 93269883, "body": "Hi, I think using this code may change my entire thing. Currently this code is called as a function which displays a msgbox on screen. Changing it to that above I think will remove what it does - it is meant to display the msg on screen, and also write to a txt file. Or does this still do it?"}, {"owner": {"reputation": 175, "user_id": 6847397, "user_type": "registered", "profile_image": "https://graph.facebook.com/865166940350454/picture?type=large", "display_name": "Nelman Jay Louie Vasquez", "link": "https://stackoverflow.com/users/6847397/nelman-jay-louie-vasquez"}, "reply_to_user": {"reputation": 1, "user_id": 10408353, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EINMTX53hGU/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWXJvtKPU-pCq_jm80HsNKUdOIbcg/mo/photo.jpg?sz=128", "display_name": "N Wally", "link": "https://stackoverflow.com/users/10408353/n-wally"}, "edited": false, "score": 0, "creation_date": 1541598275, "post_id": 53190440, "comment_id": 93270120, "body": "@NWally I only did here is optimized your code. Your <code>Expired</code> (It should be return a value because this is a Function not a Sub) is act like a variable which is absurd. I created a local variable which you can put them all of your variables and use it as return value."}, {"owner": {"reputation": 1, "user_id": 10408353, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EINMTX53hGU/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWXJvtKPU-pCq_jm80HsNKUdOIbcg/mo/photo.jpg?sz=128", "display_name": "N Wally", "link": "https://stackoverflow.com/users/10408353/n-wally"}, "edited": false, "score": 0, "creation_date": 1541598419, "post_id": 53190440, "comment_id": 93270211, "body": "I tested it, but it does not quite work. It uses append, but it would need to use OUTPUT i think, as I need it to replace the data in the .txt file everytime and not add to it."}, {"owner": {"reputation": 175, "user_id": 6847397, "user_type": "registered", "profile_image": "https://graph.facebook.com/865166940350454/picture?type=large", "display_name": "Nelman Jay Louie Vasquez", "link": "https://stackoverflow.com/users/6847397/nelman-jay-louie-vasquez"}, "reply_to_user": {"reputation": 1, "user_id": 10408353, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EINMTX53hGU/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWXJvtKPU-pCq_jm80HsNKUdOIbcg/mo/photo.jpg?sz=128", "display_name": "N Wally", "link": "https://stackoverflow.com/users/10408353/n-wally"}, "edited": false, "score": 0, "creation_date": 1541598652, "post_id": 53190440, "comment_id": 93270360, "body": "I &#39;d update the code. I replaced the <code>Open sFilePath For Append As #FileNumber</code> into <code>Open sFilePath For Output As #FileNumber</code>"}, {"owner": {"reputation": 175, "user_id": 6847397, "user_type": "registered", "profile_image": "https://graph.facebook.com/865166940350454/picture?type=large", "display_name": "Nelman Jay Louie Vasquez", "link": "https://stackoverflow.com/users/6847397/nelman-jay-louie-vasquez"}, "reply_to_user": {"reputation": 1, "user_id": 10408353, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EINMTX53hGU/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWXJvtKPU-pCq_jm80HsNKUdOIbcg/mo/photo.jpg?sz=128", "display_name": "N Wally", "link": "https://stackoverflow.com/users/10408353/n-wally"}, "edited": false, "score": 0, "creation_date": 1541598714, "post_id": 53190440, "comment_id": 93270392, "body": "@NWally It will replace the data in the .txt file everytime you call the function."}, {"owner": {"reputation": 1, "user_id": 10408353, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EINMTX53hGU/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWXJvtKPU-pCq_jm80HsNKUdOIbcg/mo/photo.jpg?sz=128", "display_name": "N Wally", "link": "https://stackoverflow.com/users/10408353/n-wally"}, "edited": false, "score": 0, "creation_date": 1541598757, "post_id": 53190440, "comment_id": 93270410, "body": "I tried that, but it still only displays the last line of the array data. I think there needs to be some kind of loop with OUTPUT."}], "tags": [], "owner": {"reputation": 175, "user_id": 6847397, "user_type": "registered", "profile_image": "https://graph.facebook.com/865166940350454/picture?type=large", "display_name": "Nelman Jay Louie Vasquez", "link": "https://stackoverflow.com/users/6847397/nelman-jay-louie-vasquez"}, "is_accepted": false, "score": -1, "last_activity_date": 1541597728, "last_edit_date": 1541597728, "creation_date": 1541597385, "answer_id": 53190440, "question_id": 53189727, "link": "https://stackoverflow.com/questions/53189727/vba-array-write-to-txt-file/53190440#53190440", "title": "VBA array write to .txt file", "body": "<p>I fixed your code. You missed Semicolon in your <code>Print</code> that why it didn't work.</p>\n\n<pre><code>Option Explicit\n\nPrivate Function Expired( _\n        ByRef msg As String, _\n        ByRef var1 As Variant, _\n        ByRef var2 As Variant, _\n        ByRef var3 As Variant _\n    ) As String\n\n    ' Init Vars\n    Dim msg_ As String\n    Dim Block As String\n    Dim sFilePath As String: sFilePath = \"R:\\HR and Admin\\Expired.txt\"\n    Dim FileNumber As Integer: FileNumber = FreeFile\n\n\n    ' Check if msg has no value\n    If msg = vbNullString Then msg_ = \"Persons with EXPIRED Safeguading Certificates:@NL@NL\"\n\n    Block = msg &amp; _\n        \"@\" &amp; var1 &amp; \" \" &amp; _\n        \"@\" &amp; var2 &amp; \" \" &amp; _\n        \"(@\" &amp; var3 &amp; \")@NL\"\n\n    ' Text File\n    If Dir(sFilePath) = vbNullString Then\n        MsgBox \"File Does not exists\"\n\n        ' Return nothing\n        Expired = vbNullString\n    Else\n        Open sFilePath For Output As #FileNumber\n        Print #FileNumber, var1, var2, var3;\n        Close #FileNumber\n\n        ' Return Block\n        Expired = Block\n    End If\n\nEnd Function\n</code></pre>\n\n<hr>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Debug.Print Expired(\"f\", 1, 2, 3)\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 10408353, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EINMTX53hGU/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWXJvtKPU-pCq_jm80HsNKUdOIbcg/mo/photo.jpg?sz=128", "display_name": "N Wally", "link": "https://stackoverflow.com/users/10408353/n-wally"}, "edited": false, "score": 0, "creation_date": 1541601031, "post_id": 53191180, "comment_id": 93271685, "body": "Sadly it doesn&#39;t quite work - it just says &#39;expected array&#39;, I have now changed the questions to include all the code in my excel sheet in case you can see an easier way to do it."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 1, "user_id": 10408353, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EINMTX53hGU/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWXJvtKPU-pCq_jm80HsNKUdOIbcg/mo/photo.jpg?sz=128", "display_name": "N Wally", "link": "https://stackoverflow.com/users/10408353/n-wally"}, "edited": false, "score": 0, "creation_date": 1541601468, "post_id": 53191180, "comment_id": 93271942, "body": "@NWally - My bad, the example had the file handle variables named the same as the functions. See the edit."}, {"owner": {"reputation": 1, "user_id": 10408353, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EINMTX53hGU/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWXJvtKPU-pCq_jm80HsNKUdOIbcg/mo/photo.jpg?sz=128", "display_name": "N Wally", "link": "https://stackoverflow.com/users/10408353/n-wally"}, "edited": false, "score": 0, "creation_date": 1541602126, "post_id": 53191180, "comment_id": 93272357, "body": "This works perfectly, thank you! I just had to change the # to match the correct one"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 1, "user_id": 10408353, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EINMTX53hGU/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWXJvtKPU-pCq_jm80HsNKUdOIbcg/mo/photo.jpg?sz=128", "display_name": "N Wally", "link": "https://stackoverflow.com/users/10408353/n-wally"}, "edited": false, "score": 0, "creation_date": 1541602259, "post_id": 53191180, "comment_id": 93272458, "body": "@NWally Oops - missed those in the first edit (fixed)."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 1, "last_activity_date": 1541602242, "last_edit_date": 1541602242, "creation_date": 1541599960, "answer_id": 53191180, "question_id": 53189727, "link": "https://stackoverflow.com/questions/53189727/vba-array-write-to-txt-file/53191180#53191180", "title": "VBA array write to .txt file", "body": "<p>You need to open the file <em>once</em> instead of looping over the file open. The easiest way to change your existing code is to open all 3 files before you start the loop, and then close them when you're done. Then pass the open file handle to the procedure that writes it:</p>\n\n<pre><code>Dim expiredFile As Integer, expiringFile As Integer, notrainingFile As Integer\n\nexpiredFile = FreeFile\nOpen \"R:\\HR and Admin\\Expired.txt\" For Output As #expiredFile\nexpiringFile = FreeFile\nOpen \"R:\\HR and Admin\\Expiring.txt\" For Output As #expiringFile\nnotrainingFile = FreeFile\nOpen \"R:\\HR and Admin\\NoTraining.txt\" For Output As #notrainingFile\n\nFor Each Key In trainingDate.Keys\n    Set personInquiryTraining = trainingDate(Key)\n    If personInquiryTraining.TrainingExpired _\n       And personInquiryTraining.trainingDate &lt;&gt; DateSerial(1900, 1, 1) Then\n        'Training is expired\n        msg(1) = expired(expiredFile, msg(1), _\n                         personInquiryTraining.firstName, _\n                         personInquiryTraining.surName, _\n                         personInquiryTraining.trainingExpiryDate)\n    End If\n    '...\nNext\n\nClose #expiredFile\nClose #expiringFile\nClose #notrainingFile\n</code></pre>\n\n<p>Called function example:</p>\n\n<pre><code>Private Function expired(FileNumber As Integer, ByRef msg As String, ByRef var1 As Variant, _\n                         ByRef var2 As Variant, ByRef var3 As Variant) As String\n    expired = msg &amp; \"@var1 @var2 (@var3)@NL\"\n    expired = Replace(expired, \"@var1\", var1)\n    expired = Replace(expired, \"@var2\", var2)\n    expired = Replace(expired, \"@var3\", var3)\n    Print #FileNumber, var1, var2, var3\nEnd Function\n</code></pre>\n\n<p>Note that this is somewhat of a hack to fit your existing code, because you are doing too much in the calling procedure. A much better solution would be to separate the selection logic (your calling loop) from the file output entirely. It would be much more robust if you processed the array first, pushing the results into a <code>Collection</code> or some other container, and then had a single \"write\" function that takes a file name to generically write them to a passed file name.</p>\n"}], "owner": {"reputation": 1, "user_id": 10408353, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EINMTX53hGU/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWXJvtKPU-pCq_jm80HsNKUdOIbcg/mo/photo.jpg?sz=128", "display_name": "N Wally", "link": "https://stackoverflow.com/users/10408353/n-wally"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1703, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1541888467, "creation_date": 1541594743, "last_edit_date": 1541888467, "question_id": 53189727, "link": "https://stackoverflow.com/questions/53189727/vba-array-write-to-txt-file", "title": "VBA array write to .txt file", "body": "<p>I am having problems getting my array to write to a txt.file correctly.\nWhat it does currently, is display the results in a msgbox so we can see it straight away, and writes only some of the data that appeared in that msgbox into the txt.file.</p>\n\n<p>I tried using 'Append' which does display all the data, but of course, it only adds the data to the txt.file rather than replacing what is already in there.\n'Output' I think is the only way of getting it to write all the data into the txt.file, and then also replace it each time.</p>\n\n<p>Sadly, I cannot get it to work with 'output'. It currently only writes the last line of data that was in the array.</p>\n\n<p>I assume I need some kind of loop, but I cannot figure out a way to get it to work successfully.</p>\n\n<p>My code is below. Any help would be appreciated.</p>\n\n<pre><code>Private Function Expired(ByRef msg As String, ByRef var1 As Variant, ByRef \nvar2 As Variant, ByRef var3 As Variant) As String\nDim sFilePath As String\n\n\nDim FileNumber\n\n\nIf Len(msg) = 0 Then msg = \"Persons with EXPIRED Safeguading \nCertificates:@NL@NL\"\nExpired = msg &amp; \"@var1 @var2 (@var3)@NL\"\nExpired = Replace(Expired, \"@var1\", var1)\nExpired = Replace(Expired, \"@var2\", var2)\nExpired = Replace(Expired, \"@var3\", var3)\n\n\nsFilePath = \"R:\\HR and Admin\\Expired.txt\"\nFileNumber = FreeFile\nIf (VBA.Len(VBA.Dir(sFilePath))) = 0 Then MsgBox \"File Does not exists\": End\nOpen sFilePath For Output As #FileNumber \nPrint #FileNumber , var1, var2, var3\n\n\nClose #FileNumber\n</code></pre>\n\n<p>The following is all the code for the vba sheet:</p>\n\n<pre><code>    Public Sub Expire_New(ByRef ws As Worksheet, ByVal Name As String)\n\nDim msg(1 To 3) As String\nDim x           As Long\nDim nDx         As Long\nDim dDiff       As Long\n\n'Establish the location of the first cell (range) of the Safegaurding Training block\n'Find the first instance of Safeguarding Training on the sheet\nDim sgTrainingCol As Range\nWith ws.Range(\"A1:AA1000\")  'Using something large to provide a range to search\n    Set sgTrainingCol = .Find(\"Safeguarding Training\", LookIn:=xlValues)\nEnd With\n\n'Establish the location of the first cell (range) of the heading column\n'for the table on the sheet. Find the first instance of what is contained\n'in mTitleFirstHeadingColumn\nDim HeadingRangeStart As Range\nWith ws.Range(\"A1:AA1000\")  'Using something large to provide a range to search\n    Set HeadingRangeStart = .Find(Name, LookIn:=xlValues)\nEnd With\n\nDim TrainingInfoRange As Range\nDim personFNSR As Range\nWith ws\n    'finds the last row of the Heading column that has data, there can NOT be any empty rows\n    'in the middle of this search.  It assumes that the name column date is contigous until\n    'reaching the end of the data set.\n    x = .Cells(HeadingRangeStart.Row, HeadingRangeStart.Column).End(xlDown).Row\n    'Set the TrainingInfoRange to point to the data contained in the 4 columns under Safeguarding Training\n    Set TrainingInfoRange = .Range(.Cells(sgTrainingCol.Row + 2, sgTrainingCol.Column), .Cells(x, sgTrainingCol.Column + 3))\n    'Set pseronFNSR to the First Name/Name, Surname range\n    Set personFNSR = .Range(.Cells(HeadingRangeStart.Row + 1, HeadingRangeStart.Column), .Cells(x, HeadingRangeStart.Column + 1))\nEnd With\n\n'I am a big fan of collections and scripting dictionaries.\n'They make code easier to read and to implement.\nDim trainingDate As Scripting.Dictionary\nSet trainingDate = CopyRngDimToCollection(personFNSR, TrainingInfoRange)\n\n'This boolean will be used to control continued flow of the\n'macro.  If NoExpiredTraining gets set to false, then there\n'are people who must complete training.\nDim NoExpiredTraining As Boolean: NoExpiredTraining = True\n\n'person training inquiry object - see class definition\nDim personInquiryTraining As clPersonTraining\n\n'this is an index variable used to loop through items\n'contained in the Scripting Dictionary object\nDim Key As Variant\n\nFor Each Key In trainingDate.Keys\n    'Assing the next object in the trainingDate Scripting Dictionary\n    'to the person training inquiry object\n    Set personInquiryTraining = trainingDate(Key)\n    'Check to see if there are any training issues\n    'if so, then set NoExpiredTraining to False\n    'because there is expired, expiring or missing training\n    If personInquiryTraining.ExpiringTraining _\n      Or personInquiryTraining.NoTraining _\n      Or personInquiryTraining.TrainingExpired Then\n        NoExpiredTraining = False\n    End If\nNext\n\nIf NoExpiredTraining Then\n    'msg(4) = MsgBox(\"There are either no ...\n    'is only used if want to do something based on\n    'what button the user pressed.  Otherwise use\n    'the Method form of MsgBox\n    MsgBox \"There are either no expired safeguarding certificates, \" _\n         &amp; \"or no certificate expiring within the next 31 days.\", _\n         vbInformation, \"Warning\"\n    Exit Sub\nEnd If\n\n'If this code executes, then there is expired training.\n'Let's collect the status for each individual\nFor Each Key In trainingDate.Keys\n    Set personInquiryTraining = trainingDate(Key)\n    If personInquiryTraining.TrainingExpired _\n      And personInquiryTraining.trainingDate &lt;&gt; DateSerial(1900, 1, 1) Then 'Training is expired\n        msg(1) = Expired(msg(1), _\n              personInquiryTraining.firstName, _\n              personInquiryTraining.surName, _\n              personInquiryTraining.trainingExpiryDate)\n    End If\n    If personInquiryTraining.ExpiringTraining _\n      And personInquiryTraining.trainingExpiryDate &lt;&gt; DateSerial(1900, 1, 1) Then 'Training is expiring\n        msg(2) = Expiring(msg(2), _\n              personInquiryTraining.firstName, _\n              personInquiryTraining.surName, _\n              personInquiryTraining.trainingExpiryDate, _\n              DateDiff(\"d\", Date, personInquiryTraining.trainingExpiryDate))\n    End If\n    If personInquiryTraining.NoTraining Then 'Training is None\n        msg(3) = NoTraining(msg(3), _\n              personInquiryTraining.firstName, _\n              personInquiryTraining.surName, _\n              \"NONE\")\n    End If\nNext\n\n'Because of the Exit Sub statement above, the code bwlow\n'will only execute if there are expired, expiring or missing\n'training\nFor x = LBound(msg) To UBound(msg)\n    msg(x) = Replace(msg(x), \"@NL\", vbCrLf)\n    If Len(msg(x)) &lt; 1024 Then\n    Select Case msg(x)\nCase msg(1)\n    If Len(msg(x)) &amp; vbNullString &gt; 0 Then\n        'MsgBox \"(If this box is blank, there is nothing Expired)\" &amp; vbCrLf &amp; vbCrLf &amp; msg(x), vbExclamation, \"Safeguarding Certificate Notification\"\n        MsgBox msg(x), vbCritical, \"Safeguarding Certificate Notification\"\n        End If\nCase msg(2)\n    If Len(msg(x)) &amp; vbNullString &gt; 0 Then\n        'MsgBox \"(If this box is blank, there is nothing Expired)\" &amp; vbCrLf &amp; vbCrLf &amp; msg(x), vbExclamation, \"Safeguarding Certificate Notification\"\n        MsgBox msg(x), vbExclamation, \"Safeguarding Certificate Notification\"\n        End If\nCase msg(3)\n    If Len(msg(x)) &amp; vbNullString &gt; 0 Then\n        'MsgBox \"(If this box is blank, there is nothing Expired)\" &amp; vbCrLf &amp; vbCrLf &amp; msg(x), vbExclamation, \"Safeguarding Certificate Notification\"\n        MsgBox msg(x), vbCritical, \"Safeguarding Certificate Notification\"\n        End If\n        End Select\nElse\n     MsgBox \"String length for notification too long to fit into this MessageBox\", vbExclamation, \"Invalid String Length to Display\"\nEnd If\n\nNext x\n\n  End Sub\n\n\n\n\n'***************************************************************************\n   '**\n    '** This fucntion copies all rows of data for the column specified into\n      '** a scripting dictionary\n      Private Function CopyRngDimToCollection(ByRef mFNSR As Range, ByRef \n      mTrainInfo) As Scripting.Dictionary\n\nDim retVal As New Scripting.Dictionary\n'nDx will become a key for each of the scripting dictionary items\nDim nDx As Long: nDx = 1\n'person training inquiry object - see class definition\nDim personTraining As clPersonTraining\n\nDim mRow As Range\nFor Each mRow In mFNSR.Rows\n    'instantiate a new person training inquiry object\n    Set personTraining = New clPersonTraining\n    With personTraining\n        .firstName = mRow.Value2(1, 1)\n        .surName = mRow.Value2(1, 2)\n    End With\n    retVal.Add nDx, personTraining\n    nDx = nDx + 1\nNext\nnDx = 1\n\nFor Each mRow In mTrainInfo.Rows\n    'Retrieve the person training inquiry object\n    'from the scripting dictionary (retVal)\n    Set personTraining = retVal(nDx)\n\n    'Add the training data information to\n    'the person training inquiry object\n    With personTraining\n        'Next two equations determine if the excel range has a null value\n        'if so then the person training inquiry object's date field is set to a\n        'default value of 1-1-1900 - this could be any valid date\n        'otherwise the value is set to what is in the excel range from the sheet\n        .trainingDate = IIf(mRow.Value2(1, 1) = vbNullString, DateSerial(1900, 1, 1), mRow.Value2(1, 1))\n        .trainingExpiryDate = IIf(mRow.Value2(1, 2) = vbNullString, DateSerial(1900, 1, 1), mRow.Value2(1, 2))\n        .trainingLevel = mRow.Value2(1, 3)\n        .certSeenBy = mRow.Value2(1, 4)\n    End With\n    'Update the object stored at the current key location\n    'given by the value of nDx\n    Set retVal(nDx) = personTraining\n    nDx = nDx + 1\nNext\n\n'Set the return value for the function\nSet CopyRngDimToCollection = retVal\n\nEnd Function\n\n   Private Function Expired(ByRef msg As String, ByRef var1 As Variant, \n ByRef var2 As Variant, ByRef var3 As Variant) As String\n Dim sFilePath As String\n Dim FileNumber\n\n\n    If Len(msg) = 0 Then msg = \"Persons with EXPIRED Safeguading \n   Certificates:@NL@NL\"\nExpired = msg &amp; \"@var1 @var2 (@var3)@NL\"\nExpired = Replace(Expired, \"@var1\", var1)\nExpired = Replace(Expired, \"@var2\", var2)\nExpired = Replace(Expired, \"@var3\", var3)\n\n  sFilePath = \"R:\\HR and Admin\\Expired.txt\"\n  FileNumber = FreeFile\n  If (VBA.Len(VBA.Dir(sFilePath))) = 0 Then MsgBox \"File Does not exists\": \n  End\n\n     Open sFilePath For Output As #FileNumber\n     Print #FileNumber, var1, var2, var3\n\n    Close #FileNumber\n\n\n\n   End Function\n\n    Private Function Expiring(ByRef msg As String, ByRef var1 As Variant, \n   ByRef var2 \n  As Variant, ByRef var3 As Variant, ByRef d As Long) As String\n Dim sFilePath As String\n  Dim FileNumber\n\nIf Len(msg) = 0 Then msg = \"Persons with EXPIRING Safeguarding \nCertificates:@NL@NL\"\n\nExpiring = msg &amp; \"@var1 @var2 (@var3) (@d days remaining)@NL\"\nExpiring = Replace(Expiring, \"@var1\", var1)\nExpiring = Replace(Expiring, \"@var2\", var2)\nExpiring = Replace(Expiring, \"@var3\", var3)\nExpiring = Replace(Expiring, \"@d\", d)\n\n  sFilePath = \"R:\\HR and Admin\\Expiring.txt\"\n  FileNumber = FreeFile\n  If (VBA.Len(VBA.Dir(sFilePath))) = 0 Then MsgBox \"File Does not exists\": \n  End\n\n Open sFilePath For Output As #FileNumber\n  Print #FileNumber, var1, var2, var3\n\n  Close #FileNumber\n\n\n  End Function\n\n   Private Function NoTraining(ByRef msg As String, ByRef var1 As Variant, \n   ByRef var2 As Variant, ByRef var3 As Variant) As String\n  Dim sFilePath As String\n  Dim FileNumber\n If Len(msg) = 0 Then msg = \"SAFEGUARDING TRAINING NOT COMPLETED FOR: \n @NL@NL\"\n\nNoTraining = msg &amp; \" @var1 @var2@NL\"\nNoTraining = Replace(NoTraining, \"@var1\", var1)\nNoTraining = Replace(NoTraining, \"@var2\", var2)\nNoTraining = Replace(NoTraining, \"@var3\", var3)\n\n  sFilePath = \"R:\\HR and Admin\\NoTraining.txt\"\n  FileNumber = FreeFile\n  If (VBA.Len(VBA.Dir(sFilePath))) = 0 Then MsgBox \"File Does not exists\": \n  End\n\n   Open sFilePath For Output As #FileNumber\n   Print #FileNumber, var1, var2, var3\n\n   Close #FileNumber\n\n\n   End Function\n</code></pre>\n"}, {"tags": ["vba", "ms-word", "vsto", "ribbonx"], "answers": [{"comments": [{"owner": {"reputation": 181, "user_id": 3114229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe318a84dab076b967fd335b1a1dffa9?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/3114229/martin"}, "edited": false, "score": 0, "creation_date": 1541683517, "post_id": 53193723, "comment_id": 93305225, "body": "Thanks! So, in short, what I read from your reply is, that what I&#39;m trying to do is going to take quite an effort to actually do?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 181, "user_id": 3114229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe318a84dab076b967fd335b1a1dffa9?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/3114229/martin"}, "edited": false, "score": 0, "creation_date": 1541694367, "post_id": 53193723, "comment_id": 93311840, "body": "@Martin &quot;quite an effort&quot; is undefined - I have no way of knowing what you consider that to be. Nor whether a VSTO add-in (rather than a VBA solution) works for you. Working with edit boxes in a Ribbon isn&#39;t &quot;difficult&quot; (for me, anyway), but it&#39;s not as simple as working with a VBA UserForm, for example."}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 2, "last_activity_date": 1541608151, "creation_date": 1541608151, "answer_id": 53193723, "question_id": 53189541, "link": "https://stackoverflow.com/questions/53189541/working-with-ribbon-controls-defined-in-a-vsto-add-in-using-vba/53193723#53193723", "title": "Working with Ribbon controls defined in a VSTO add-in using VBA", "body": "<p>By design, it's not possible to access Ribbon controls from a project that does not contain that Ribbon's XML. While the VSTO Ribbon Designer is \"nice to have\" you cannot use it with VBA code - only with code in the VSTO project that contains the Ribbon. </p>\n\n<p>That means you either need to write VB.NET code in the VSTO project, or you need to create the Ribbon XML differently.</p>\n\n<p>If you want to use VBA then you need the Ribbon XML (there is an \"Export\" option in VSTO). Using the <a href=\"http://openxmldeveloper.org/blog/b/openxmldeveloper/archive/2010/08/10/23248.aspx\" rel=\"nofollow noreferrer\">Custom UI Editor</a> the Ribbon XML can be incorporated into a Word docm or dotm file.</p>\n\n<p>The information in the series of articles <a href=\"https://docs.microsoft.com/en-us/previous-versions/office/developer/office-2007/aa338202(v=office.12)\" rel=\"nofollow noreferrer\">Customizing the 2007 Office Fluent Ribbon for Developers</a> describes how to write VBA code that uses controls in the Ribbon XML. There are also lots of articles, discussions and examples on the Internet, plus a really good book on the subject (RibbonX Customizing the Office 2007 RIbbon).</p>\n"}], "owner": {"reputation": 181, "user_id": 3114229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe318a84dab076b967fd335b1a1dffa9?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/3114229/martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1542286489, "creation_date": 1541593915, "last_edit_date": 1542286489, "question_id": 53189541, "link": "https://stackoverflow.com/questions/53189541/working-with-ribbon-controls-defined-in-a-vsto-add-in-using-vba", "title": "Working with Ribbon controls defined in a VSTO add-in using VBA", "body": "<p>I'm trying to create a ribbon for Office Word 365 with two editboxes and a checkbox.</p>\n\n<p>I have a macro I would like to use that input afterwards.</p>\n\n<p>So far I have used the Ribbon Designer in Visual Studio to create an Add-in ribbon.\n<a href=\"https://i.stack.imgur.com/tLgLT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tLgLT.png\" alt=\"enter image description here\"></a>   </p>\n\n<p>The Add-in shows in Word and it looks like it's supposed to. I just can't figure out how to get the input from the editboxes and checkbox to vba.</p>\n\n<p>The VBA code I have looks like this:</p>\n\n<pre><code>Sub PasteAndSelectPicture()\n\nApplication.ScreenUpdating = False\n\nDim ils As Word.InlineShape\nDim shp As Word.Shape\nDim lNrIls As Long\nDim lNrShp As Long\nDim rngDoc As Word.Range\nDim rngSel As Word.Range\n\nSet rngDoc = ActiveDocument.Content\nSet rngSel = Selection.Range\nrngDoc.End = rngSel.End + 1\n\n'Get an InlineShape\nlNrIls = rngDoc.InlineShapes.Count\nSelection.PasteSpecial Link:=False, DataType:=wdPasteEnhancedMetafile, Placement:=wdInLine, DisplayAsIcon:=False\n\nDebug.Print rngDoc.InlineShapes.Count, lNrIls\n\nSet ils = rngDoc.InlineShapes(lNrIls + 1)\nils.Width = Application.CentimetersToPoints(VAR1)\n\nSet shp = ils.ConvertToShape\nshp.IncrementRotation VAR2\n\nshp.ConvertToInlineShape\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>I'd like the VAR1 and VAR2 to be inputs from the two editboxes.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1541609762, "post_id": 53189276, "comment_id": 93277093, "body": "One thing I can see without testing is that your passed sheet name contains a space, but you&#39;re not taking that into account in  your formula.  <code>,&#39;&quot; &amp; SHEET_NAME &amp; &quot;&#39;!C[-12]</code> would work."}, {"owner": {"reputation": 19, "user_id": 10571135, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210195334638229/picture?type=large", "display_name": "Vratislav Va\u0161ina", "link": "https://stackoverflow.com/users/10571135/vratislav-va%c5%a1ina"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1541610292, "post_id": 53189276, "comment_id": 93277385, "body": "It does not show the compile error anymore, so we do have little progress, haha. However, every time the sub is called, new window opens with question &quot;where to save&quot;. So I guess it thinks, that the &quot;SHEET_NAME&quot; is actuall name of some sheet, not String variable.."}, {"owner": {"reputation": 19, "user_id": 10571135, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210195334638229/picture?type=large", "display_name": "Vratislav Va\u0161ina", "link": "https://stackoverflow.com/users/10571135/vratislav-va%c5%a1ina"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1541610502, "post_id": 53189276, "comment_id": 93277480, "body": "whole the formula is in &quot; &quot;, it is inserted into cell like it is.. Isnt that the problem?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1541610578, "post_id": 53189276, "comment_id": 93277524, "body": "Yes, part of the problem is probably positioning of the <code>&quot; &quot;</code>.  I think my answer below will solve it."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1541610904, "post_id": 53189276, "comment_id": 93277703, "body": "Your edited code works as long as you put the extra <code>&#39;</code> in around the <code>Sheet_Name</code>."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 10571135, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210195334638229/picture?type=large", "display_name": "Vratislav Va\u0161ina", "link": "https://stackoverflow.com/users/10571135/vratislav-va%c5%a1ina"}, "edited": false, "score": 0, "creation_date": 1541595395, "post_id": 53189486, "comment_id": 93268613, "body": "It shows \u2192 Compile error: Expected: end of statement"}], "tags": [], "owner": {"reputation": 344, "user_id": 7915175, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fff6640a70932cf34a7f78a9faf5a208?s=128&d=identicon&r=PG&f=1", "display_name": "aozk", "link": "https://stackoverflow.com/users/7915175/aozk"}, "is_accepted": false, "score": 0, "last_activity_date": 1541594169, "last_edit_date": 1541594169, "creation_date": 1541593668, "answer_id": 53189486, "question_id": 53189276, "link": "https://stackoverflow.com/questions/53189276/sheet-name-as-a-sub-parametr-vs-vlookup/53189486#53189486", "title": "Sheet name as a SUB parametr vs VLOOKUP", "body": "<pre><code>Call ART_R(FROM_CELL, TO_CELL, Application.Caller.Worksheet.Name)\n</code></pre>\n\n<p>and in your sub:</p>\n\n<pre><code>ActiveCell.FormulaR1C1 = \"=IF(ISERROR(VLOOKUP(RC[-1],\"&amp;SHEET_NAME&amp;\"!C[-12]:C[-11],2,0)),\"\"\"\",(VLOOKUP(RC[-1],\"&amp;SHEET_NAME&amp;\"!C[-12]:C[-11],2,0)))\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 19, "user_id": 10571135, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210195334638229/picture?type=large", "display_name": "Vratislav Va\u0161ina", "link": "https://stackoverflow.com/users/10571135/vratislav-va%c5%a1ina"}, "edited": false, "score": 0, "creation_date": 1541611413, "post_id": 53194329, "comment_id": 93277957, "body": "It works, I love you! :D  I missed the extra &#39; in the code..  Thank you so much :)"}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 0, "last_activity_date": 1541610229, "creation_date": 1541610229, "answer_id": 53194329, "question_id": 53189276, "link": "https://stackoverflow.com/questions/53189276/sheet-name-as-a-sub-parametr-vs-vlookup/53194329#53194329", "title": "Sheet name as a SUB parametr vs VLOOKUP", "body": "<p>This will place the formula in each cell between <code>From_Cell</code> and <code>To_Cell</code> on <code>Sheet_Name</code>.  </p>\n\n<p>I see you're using <code>=IF(ISERROR.....</code> in your code - this is the way to do it in Excel 2003 and earlier, after 2003 <code>IFERROR</code> is better.   </p>\n\n<p>2007+ version:</p>\n\n<pre><code>Sub Test()\n\n    Art_R \"O2\", \"O23\", \"RPL OC\"\n\nEnd Sub\n\n\nPublic Sub Art_R(From_Cell As String, To_Cell As String, Sheet_Name As String)\n\n    With ActiveWorkbook.Worksheets(Sheet_Name)\n        .Range(From_Cell &amp; \":\" &amp; To_Cell).FormulaR1C1 = _\n            \"=IFERROR(VLOOKUP(RC[-1],'\" &amp; Sheet_Name &amp; \"'!C[-12]:C[-11],2,0),\"\"\"\")\"\n    End With\n\nEnd Sub  \n</code></pre>\n\n<p>2003 version:  </p>\n\n<pre><code>Public Sub Art_R(From_Cell As String, To_Cell As String, Sheet_Name As String)\n\n    With ActiveWorkbook.Worksheets(Sheet_Name)\n        .Range(From_Cell &amp; \":\" &amp; To_Cell).FormulaR1C1 = _\n            \"=IF(ISERROR(VLOOKUP(RC[-1],'\" &amp; Sheet_Name &amp; \"'!C[-12]:C[-11],2,0)),\"\"\"\",VLOOKUP(RC[-1],'\" &amp; Sheet_Name &amp; \"'!C[-12]:C[-11],2,0))\"\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 10571135, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210195334638229/picture?type=large", "display_name": "Vratislav Va\u0161ina", "link": "https://stackoverflow.com/users/10571135/vratislav-va%c5%a1ina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 53194329, "answer_count": 2, "score": 0, "last_activity_date": 1541610229, "creation_date": 1541592874, "last_edit_date": 1541608965, "question_id": 53189276, "link": "https://stackoverflow.com/questions/53189276/sheet-name-as-a-sub-parametr-vs-vlookup", "title": "Sheet name as a SUB parametr vs VLOOKUP", "body": "<p>I am quite new to VBA, could someone please help?</p>\n\n<p>I have folowing code and I would like to call it from different subs in different sheets \u2192 so I gave SHEET_NAME as a parametr of this sub, however, this can not work with vlookup, at least not this way. Can someone propose different way how to do this? \nBTW I do not need the formula in the cell, I am perfectly fine just with value.</p>\n\n<pre><code>Sub ART_R(FROM_CELL, TO_CELL, SHEET_NAME)\n\nRange(FROM_CELL).Select\n\n    ActiveCell.FormulaR1C1 = \"=IF(ISERROR(VLOOKUP(RC[-1],SHEET_NAME!C[-12]:C[-11],2,0)),\"\"\"\",(VLOOKUP(RC[-1],SHEET_NAME!C[-12]:C[-11],2,0)))\"\n\nSelection.AutoFill Destination:=Range(FROM_CELL, TO_CELL), Type:=xlFillValues\n\nEnd Sub\n</code></pre>\n\n<p>Thanks a lot!</p>\n\n<p>EDIT:\nnow it looks like that:</p>\n\n<pre><code>Sub ART_R(FROM_CELL, TO_CELL, SHEET_NAME)\n    Range(FROM_CELL).Select\n    ActiveCell.FormulaR1C1 = \"=IF(ISERROR(VLOOKUP(RC[-1],\"&amp;SHEET_NAME&amp;\"!C[-12]:C[-11],2,0)),\"\"\"\",(VLOOKUP(RC[-1],\"&amp;SHEET_NAME&amp;\"!C[-12]:C[-11],2,0)))\"\n    Selection.AutoFill Destination:=Range(FROM_CELL, TO_CELL), Type:=xlFillValues\nEnd Sub\n</code></pre>\n\n<p>The call should look (ideally) like that: </p>\n\n<pre><code>Call ART_R(\"M4\", \"M19\", \"RPL OC\")\n</code></pre>\n\n<p>where \"RPL OC\" is name of sheet - it will be always different</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1541591339, "post_id": 53188838, "comment_id": 93266670, "body": "This line will error without a Set assuming DDS is a range <code>DDS = Range(.Cells(2, 11), .Cells(56, LastDate))</code>"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1541591791, "post_id": 53188838, "comment_id": 93266911, "body": "And if DDS is not a range it does not of course have an <code>EntireColumn</code> property."}, {"owner": {"reputation": 13, "user_id": 10614963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ed9a03c6d297fb2bd3d01d9ab097ac1?s=128&d=identicon&r=PG&f=1", "display_name": "GBeltramini", "link": "https://stackoverflow.com/users/10614963/gbeltramini"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1541593078, "post_id": 53188838, "comment_id": 93267504, "body": "I see. I just saw that the code doesn&#39;t work."}, {"owner": {"reputation": 13, "user_id": 10614963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ed9a03c6d297fb2bd3d01d9ab097ac1?s=128&d=identicon&r=PG&f=1", "display_name": "GBeltramini", "link": "https://stackoverflow.com/users/10614963/gbeltramini"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1541593086, "post_id": 53188838, "comment_id": 93267510, "body": "Any ideas to make it work?"}], "answers": [{"tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": false, "score": 0, "last_activity_date": 1541594983, "creation_date": 1541594983, "answer_id": 53189786, "question_id": 53188838, "link": "https://stackoverflow.com/questions/53188838/hide-columns-except-date-range/53189786#53189786", "title": "Hide Columns Except Date Range", "body": "<p>try,</p>\n\n<pre><code>With ActiveSheet\n    LastDate = .Cells(\"2\", Columns.Count).End(xlToLeft).Column\n    set DDS = .Range(.Cells(2, 11), .Cells(56, LastDate))\nEnd With\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 10614963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ed9a03c6d297fb2bd3d01d9ab097ac1?s=128&d=identicon&r=PG&f=1", "display_name": "GBeltramini", "link": "https://stackoverflow.com/users/10614963/gbeltramini"}, "edited": false, "score": 0, "creation_date": 1541597288, "post_id": 53189956, "comment_id": 93269582, "body": "Hi, I really like your solution but my problem with it is that the dates are in merged cells and they have multiple columns under them. When excel is looking for a value in a merged cell it considers that only the first cell of the merged has the value (which annoys me very much)."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "reply_to_user": {"reputation": 13, "user_id": 10614963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ed9a03c6d297fb2bd3d01d9ab097ac1?s=128&d=identicon&r=PG&f=1", "display_name": "GBeltramini", "link": "https://stackoverflow.com/users/10614963/gbeltramini"}, "edited": false, "score": 0, "creation_date": 1541601531, "post_id": 53189956, "comment_id": 93271982, "body": "You should not  use merged cells in ranges you intend to use vba with,"}, {"owner": {"reputation": 13, "user_id": 10614963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ed9a03c6d297fb2bd3d01d9ab097ac1?s=128&d=identicon&r=PG&f=1", "display_name": "GBeltramini", "link": "https://stackoverflow.com/users/10614963/gbeltramini"}, "edited": false, "score": 0, "creation_date": 1541602947, "post_id": 53189956, "comment_id": 93272960, "body": "Ok, so how could I have this without merging the cells? I mean, they are multiple columns relative to a specific date"}], "tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 0, "last_activity_date": 1541595609, "creation_date": 1541595609, "answer_id": 53189956, "question_id": 53188838, "link": "https://stackoverflow.com/questions/53188838/hide-columns-except-date-range/53189956#53189956", "title": "Hide Columns Except Date Range", "body": "<p>You can find the Startdate and enddate, then hide all the columns and unhide the columns between start and end dates.</p>\n\n<p>Edit to suite:</p>\n\n<pre><code>Sub Button1_Click()\n\n    Dim rng As Range\n    Dim StartDate As Date\n    Dim EndDate As Date\n    Dim fDate As Range\n    Dim e As Range, s As Range, UnH As Range\n\n    StartDate = Range(\"W2\").Value\n    EndDate = Range(\"X2\").Value\n\n    Set rng = Rows(1).SpecialCells(xlCellTypeConstants, 23)\n    Set s = rng.Find(StartDate, lookat:=xlWhole)\n    Set e = rng.Find(EndDate, lookat:=xlWhole)\n    Set UnH = Range(Cells(1, s.Column), Cells(1, e.Column))\n\n    rng.EntireColumn.Hidden = True\n    UnH.EntireColumn.Hidden = False\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 588, "user_id": 7049751, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a6b0e27ce4e8c20a20d34e793f4e4636?s=128&d=identicon&r=PG&f=1", "display_name": "Sphinx", "link": "https://stackoverflow.com/users/7049751/sphinx"}, "is_accepted": false, "score": 0, "last_activity_date": 1541596047, "creation_date": 1541596047, "answer_id": 53190082, "question_id": 53188838, "link": "https://stackoverflow.com/questions/53188838/hide-columns-except-date-range/53190082#53190082", "title": "Hide Columns Except Date Range", "body": "<p>You could try like this. </p>\n\n<pre><code>Sub test()\n\n    Dim Ws As Worksheet\n    Dim DDS As Range\n    Dim i As Long, j As Long, LastDateCol As Long\n\n    Set Ws = ActiveSheet\n    With Ws\n        LastDateCol = .Cells(\"2\", Columns.Count).End(xlToLeft).Column\n        Set DDS = .Range(.Cells(2, 11), .Cells(56, LastDateCol))\n    End With\n\n    For i = 1 To DDS.Columns.Count\n        If DDS.Item(1, i) = StartDate Then\n            DDS.Item(1, i).EntireColumn.Hidden = False\n            For j = i To LastDate\n                If DDS.Item(1, i) = EndDate Then\n                    i = j\n                    Exit For\n                End If\n            Next j\n        Else\n            DDS.Item(1, i).EntireColumn.Hidden = True\n        End If\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p>Is it intended that you loop only first row (<code>DDS(1, i)</code>)? <BR> \nYou range is 55 rows <code>DDS = Range(.Cells(2, 11), .Cells(56, LastDate))</code><BR></p>\n"}], "owner": {"reputation": 13, "user_id": 10614963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ed9a03c6d297fb2bd3d01d9ab097ac1?s=128&d=identicon&r=PG&f=1", "display_name": "GBeltramini", "link": "https://stackoverflow.com/users/10614963/gbeltramini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1586402351, "creation_date": 1541591156, "last_edit_date": 1586402351, "question_id": 53188838, "link": "https://stackoverflow.com/questions/53188838/hide-columns-except-date-range", "title": "Hide Columns Except Date Range", "body": "<p>I am trying to create a code that hides several columns except for the range defined by two cells. This is the code:</p>\n\n<pre><code>For i = 1 To LastDate\n    If DDS(1, i) = StartDate Then\n        DDS.Cells(1, i).EntireColumn.Hidden = False\n        For j = i To LastDate\n            If DDS(1, i) = EndDate Then\n                i = j\n                Exit For\n            End If\n        Next j\n    Else\n        DDS.Cells(1, i).EntireColumn.Hidden = True\n    End If\nNext i\n</code></pre>\n\n<p>Is there a way to improve this code?\nWhy am I getting an object error when trying to hide the column?</p>\n\n<p>\"DDS\" is a Range reviously defined.</p>\n\n<pre><code>With ActiveSheet\n    LastDate = .Cells(\"2\", Columns.Count).End(xlToLeft).Column\n    DDS = Range(.Cells(2, 11), .Cells(56, LastDate))\nEnd With\n</code></pre>\n\n<p>Thanks.</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1541590483, "post_id": 53188572, "comment_id": 93266308, "body": "You should post what formulas have you tried. Also, posting your data example as text instead of as image would help users to replicate your problem."}, {"owner": {"reputation": 21, "user_id": 5753922, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/gqU2I.png?s=128&g=1", "display_name": "kehoewex86", "link": "https://stackoverflow.com/users/5753922/kehoewex86"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1541590847, "post_id": 53188572, "comment_id": 93266451, "body": "Ok, not sure it required a marking down for that, not a huge amount of text.  I haven&#39;t posted any formulae that I&#39;ve used as they have not worked, which is why I am asking for advice on how to go about this.  I can use basic COUNTIFS on both columns, but not sure how to add a condition, potentially with match and index, in order to only count those rows where the row below &quot;ShowEnterConfirmationNumber&quot; is blank and on the same row as the blank in column H the value is &quot;FALSE&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 5753922, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/gqU2I.png?s=128&g=1", "display_name": "kehoewex86", "link": "https://stackoverflow.com/users/5753922/kehoewex86"}, "edited": false, "score": 0, "creation_date": 1541592018, "post_id": 53188960, "comment_id": 93267036, "body": "That&#39;s brilliant! Thank you so much!"}, {"owner": {"reputation": 862, "user_id": 9211191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3abb20de4292973fd582868c407fc9e9?s=128&d=identicon&r=PG&f=1", "display_name": "Peter K.", "link": "https://stackoverflow.com/users/9211191/peter-k"}, "reply_to_user": {"reputation": 21, "user_id": 5753922, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/gqU2I.png?s=128&g=1", "display_name": "kehoewex86", "link": "https://stackoverflow.com/users/5753922/kehoewex86"}, "edited": false, "score": 2, "creation_date": 1541592926, "post_id": 53188960, "comment_id": 93267435, "body": "@kehoewex86 You&#39;re welcome. Please accept the answer if it works for you."}, {"owner": {"reputation": 862, "user_id": 9211191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3abb20de4292973fd582868c407fc9e9?s=128&d=identicon&r=PG&f=1", "display_name": "Peter K.", "link": "https://stackoverflow.com/users/9211191/peter-k"}, "reply_to_user": {"reputation": 21, "user_id": 5753922, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/gqU2I.png?s=128&g=1", "display_name": "kehoewex86", "link": "https://stackoverflow.com/users/5753922/kehoewex86"}, "edited": false, "score": 1, "creation_date": 1541593494, "post_id": 53188960, "comment_id": 93267721, "body": "@kehoewex86 Thanks. And just a comment, in case you are wondering why your question was down-voted. I assume this were users that think that your question should have been posted on Superuser, and not on Stackoverflow; I know it says &quot;complex formula development&quot; in the description of what is allowed, so I guess the down-voters didn&#39;t consider it &quot;complex&quot; enough ... ;)"}, {"owner": {"reputation": 21, "user_id": 5753922, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/gqU2I.png?s=128&g=1", "display_name": "kehoewex86", "link": "https://stackoverflow.com/users/5753922/kehoewex86"}, "edited": false, "score": 0, "creation_date": 1541593641, "post_id": 53188960, "comment_id": 93267826, "body": "Wow!  I assumed it was just because they got angry that they couldn&#39;t answer the question ;) haha"}], "tags": [], "owner": {"reputation": 862, "user_id": 9211191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3abb20de4292973fd582868c407fc9e9?s=128&d=identicon&r=PG&f=1", "display_name": "Peter K.", "link": "https://stackoverflow.com/users/9211191/peter-k"}, "is_accepted": true, "score": 3, "last_activity_date": 1541596279, "last_edit_date": 1541596279, "creation_date": 1541591668, "answer_id": 53188960, "question_id": 53188572, "link": "https://stackoverflow.com/questions/53188572/excel-index-match-countif-trying-to-count-multiple-values-that-match-2-conditi/53188960#53188960", "title": "Excel Index Match Countif - trying to count multiple values that match 2 conditions", "body": "<p>Use a helper column (e.g. M), add this test in cell M2 and auto-fill down :<br>\n<code>=AND(L1=\"ShowEnterConfirmationNumber\";L2=\"\";H2=\"FALSE\")</code><br>\nand then count all TRUE (1) values in column M.   </p>\n\n<p>And if you want everything in a single cell, without helper column, you can use this :<br>\n<code>=COUNTIFS($L$1:$L$10;\"ShowEnterConfirmationNumber\";$L$2:$L$11;\"\";$H$2:$H$11;\"FALSE\")</code><br>\nI stopped at row 10, so you have of course to replace this with the row number with the last value in your dataset. Please also be careful for the test on \"FALSE\"; my syntax works if in your data it is entered as a text string; if it is a real Boolean, you probably have to do remove the \"\" around the FALSE in the formula.</p>\n"}], "owner": {"reputation": 21, "user_id": 5753922, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/gqU2I.png?s=128&g=1", "display_name": "kehoewex86", "link": "https://stackoverflow.com/users/5753922/kehoewex86"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 623, "favorite_count": 0, "accepted_answer_id": 53188960, "answer_count": 1, "score": -2, "last_activity_date": 1586402387, "creation_date": 1541590039, "last_edit_date": 1586402387, "question_id": 53188572, "link": "https://stackoverflow.com/questions/53188572/excel-index-match-countif-trying-to-count-multiple-values-that-match-2-conditi", "title": "Excel Index Match Countif - trying to count multiple values that match 2 conditions", "body": "<p>I'm trying to write a formula to count the \"ShowEnterConfirmationNumber\" instances in column L, but only when the cell below it is blank and there is an instance of 'FALSE' in column H in the row below it.  </p>\n\n<p>I've tried Match, index and Countifs but can't seem to find the right combination to return a count of these based on the above conditions.  Can anyone help?</p>\n\n<p><a href=\"https://i.stack.imgur.com/JJXS6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JJXS6.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c#", "vba", "vb.net", "powerpoint", "office-interop"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1541589349, "post_id": 53188236, "comment_id": 93265828, "body": "Can you show the way that you are using the interops please?"}, {"owner": {"reputation": 1315, "user_id": 1091166, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5057a5b4b4e4f6a5864ce60a08ce9a72?s=128&d=identicon&r=PG&f=1", "display_name": "Azaz ul Haq", "link": "https://stackoverflow.com/users/1091166/azaz-ul-haq"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1541589652, "post_id": 53188236, "comment_id": 93265948, "body": "powerPointSlide.Shapes.AddChart(XlChartType.xlBarClustered, 0, 0, 100, 100). powerPointSlide is PowerPoint.Slide class object. This line takes 500-700 miliseconds and opens up an excel instance."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1541600044, "post_id": 53188236, "comment_id": 93271123, "body": "Can you show the class in the original code, so can see how you are using the interops rather than class. Cheers."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1541609613, "post_id": 53188236, "comment_id": 93277019, "body": "What kind of powerpoint add-in? Faster would certainly be to leverage the Office Open XML file format using, for example, the Open XML SDK. In PowerPoint this can be done only on the closed file, however..."}, {"owner": {"reputation": 1315, "user_id": 1091166, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5057a5b4b4e4f6a5864ce60a08ce9a72?s=128&d=identicon&r=PG&f=1", "display_name": "Azaz ul Haq", "link": "https://stackoverflow.com/users/1091166/azaz-ul-haq"}, "edited": false, "score": 0, "creation_date": 1541687014, "post_id": 53188236, "comment_id": 93307285, "body": "I&#39;m using PowerPoint VSTO addin with interop assemblies. Open XML could be an option but I&#39;ve to work with opened file in real time instead of closed file."}, {"owner": {"reputation": 1315, "user_id": 1091166, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5057a5b4b4e4f6a5864ce60a08ce9a72?s=128&d=identicon&r=PG&f=1", "display_name": "Azaz ul Haq", "link": "https://stackoverflow.com/users/1091166/azaz-ul-haq"}, "edited": false, "score": 0, "creation_date": 1541778552, "post_id": 53188236, "comment_id": 93344685, "body": "If someone wants to discuss performance issues, I&#39;ve a separate issue opened for that, with BOUNTY... <a href=\"https://stackoverflow.com/questions/53004405/powerpoint-interop-assemblies-slowness-issue\" title=\"powerpoint interop assemblies slowness issue\">stackoverflow.com/questions/53004405/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 8771, "user_id": 1393543, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5940aefd57c6c8f7e9921d0512bc1d81?s=128&d=identicon&r=PG", "display_name": "Christian Sauer", "link": "https://stackoverflow.com/users/1393543/christian-sauer"}, "is_accepted": false, "score": 0, "last_activity_date": 1542092744, "creation_date": 1542092744, "answer_id": 53275576, "question_id": 53188236, "link": "https://stackoverflow.com/questions/53188236/interop-powerpoint-chart-alternative/53275576#53275576", "title": "Interop PowerPoint Chart Alternative", "body": "<p>If you are prepared to go that route, you can use Office Open XML Sdk to generate the files directly. It's quite efficient to do that compared to Interop (milliseoncds vs minutes runtime...) but it is a lot of work to program.</p>\n\n<p><a href=\"https://docs.microsoft.com/en-us/office/open-xml/open-xml-sdk\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/open-xml/open-xml-sdk</a></p>\n\n<p>If you want to use that, use an abstraction library with helps with the excel files, though - doing them by hand is a royal pain.</p>\n"}], "owner": {"reputation": 1315, "user_id": 1091166, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5057a5b4b4e4f6a5864ce60a08ce9a72?s=128&d=identicon&r=PG&f=1", "display_name": "Azaz ul Haq", "link": "https://stackoverflow.com/users/1091166/azaz-ul-haq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 144, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542092744, "creation_date": 1541588694, "last_edit_date": 1542092588, "question_id": 53188236, "link": "https://stackoverflow.com/questions/53188236/interop-powerpoint-chart-alternative", "title": "Interop PowerPoint Chart Alternative", "body": "<p>As we know inserting chart in PowerPoint presentation is quite slow and painful task using PowerPoint Interop assemblies. It not only opens up the unnecessary Excel window \nthat we have to tackle but also it takes some considerable amount of time to completely insert the chart. </p>\n\n<p>Taking care of Excel instances can be sometimes very painful task and it may lead to application crashes and slowness of PowerPoint addin itself.</p>\n\n<p>So my question is: Is there any alternative(s) to PowerPoint Interop charts that can be incorporated into PowerPoint Addin. </p>\n\n<p>Any feedback or suggestion would be highly appreciated.</p>\n"}, {"tags": ["excel", "vba", "copy-paste"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1541587769, "post_id": 53187900, "comment_id": 93265112, "body": "I recommend to apply <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a> first. Which would probably already solve your issue."}], "answers": [{"comments": [{"owner": {"reputation": 197, "user_id": 10186814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d70a16739b4f390d68b13008f18c6108?s=128&d=identicon&r=PG&f=1", "display_name": "Xavi", "link": "https://stackoverflow.com/users/10186814/xavi"}, "edited": false, "score": 0, "creation_date": 1541593232, "post_id": 53188001, "comment_id": 93267588, "body": "Thanks a lot SJR and PEH!"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 4, "last_activity_date": 1541587849, "creation_date": 1541587849, "answer_id": 53188001, "question_id": 53187900, "link": "https://stackoverflow.com/questions/53187900/activesheet-pastespecial-paste-xlpastevalues-not-working/53188001#53188001", "title": "ActiveSheet.PasteSpecial Paste:=xlPasteValues not working", "body": "<p>Try this and read up on <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba?s=1%7C151.0787\">how to avoid Select and Activate</a>.</p>\n\n<pre><code>Worksheets(\"instructions macros\").Range(\"N18:S18\").Copy\nWorksheets(\"Sheet1\").Range(\"I\" &amp; Rows.Count).End(xlUp).Offset(1, 0).PasteSpecial Paste:=xlPasteValues\n</code></pre>\n\n<p>You can avoid Copy and Paste altogether (when pasting values), which is slightly more efficient, though unlikely to be noticeable in your case.</p>\n\n<pre><code>With Worksheets(1).Range(\"N18:S18\")\n    Worksheets(\"Sheet1\").Range(\"I\" &amp; Rows.Count).End(xlUp).Offset(1, 0).Resize(.Rows.Count, .Columns.Count).Value = .Value\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 197, "user_id": 10186814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d70a16739b4f390d68b13008f18c6108?s=128&d=identicon&r=PG&f=1", "display_name": "Xavi", "link": "https://stackoverflow.com/users/10186814/xavi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4174, "favorite_count": 1, "accepted_answer_id": 53188001, "answer_count": 1, "score": 0, "last_activity_date": 1586402422, "creation_date": 1541587512, "last_edit_date": 1586402422, "question_id": 53187900, "link": "https://stackoverflow.com/questions/53187900/activesheet-pastespecial-paste-xlpastevalues-not-working", "title": "ActiveSheet.PasteSpecial Paste:=xlPasteValues not working", "body": "<p>I want to create a macro which copy some datas from another sheet and paste them (with a paste special value) to the final row of my range (from column I) of my active sheet (Sheet1). However, when I try to execute my macro, the last line of my macro is not read properly and it returns the error message \"run time error 1004: application defined or object defined error\"\nIf someone can help me to fix this issue, that would be super.\nMany thanks.\nXavier</p>\n\n<p>Please find my VBA code below:</p>\n\n<pre><code>Sub insertfinalrow()\nWorksheets(\"instructions macros\").Activate\nRange(\"N18:S18\").Copy\nWorksheets(\"Sheet1\").Activate\nRange(\"I\" &amp; Rows.Count).End(xlUp).Select\nActiveCell.Offset(1, 0).Select\nActiveSheet.PasteSpecial Paste:=xlPasteValues\u00a0\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "is_accepted": true, "score": 0, "last_activity_date": 1541587121, "creation_date": 1541587121, "answer_id": 53187789, "question_id": 53187653, "link": "https://stackoverflow.com/questions/53187653/how-to-access-range-object-item-by-index/53187789#53187789", "title": "How to access `.Range` object item by index?", "body": "<p>The cells in <code>r</code> are grouped by rows. Use <code>r.Cells(1)</code> to return the first cell in the group. </p>\n"}], "owner": {"reputation": 2344, "user_id": 8461786, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/55878061e134ad81c5d169881b3c6d2e?s=128&d=identicon&r=PG&f=1", "display_name": "barciewicz", "link": "https://stackoverflow.com/users/8461786/barciewicz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 53187789, "answer_count": 1, "score": 0, "last_activity_date": 1541587121, "creation_date": 1541586635, "last_edit_date": 1541586908, "question_id": 53187653, "link": "https://stackoverflow.com/questions/53187653/how-to-access-range-object-item-by-index", "title": "How to access `.Range` object item by index?", "body": "<p>Normally I would access <code>.Range</code> object item by index number like this:</p>\n\n<pre><code>debug.print Selection(2)\n</code></pre>\n\n<p>But I get </p>\n\n<blockquote>\n  <p>Type mismatch</p>\n</blockquote>\n\n<p>if I try this on the following, because <code>r.Count</code> is only 1:</p>\n\n<pre><code>For Each r In grouping_range.Rows\n    Debug.Print r(1)\nNext r\n</code></pre>\n\n<p>How do I fix this?</p>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1541587944, "post_id": 53187524, "comment_id": 93265195, "body": "Welcome to Stack Overflow. Please note that because this is no free code writing service it is necessary to show either what you have tried so far and where you got stuck or errors (by showing your code) or at least to show what you have researched and the effort you made. Otherwise it is just asking us to do all the work for you. Reading <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> might help you to improve your question."}], "answers": [{"tags": [], "owner": {"reputation": 69, "user_id": 8594202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f15f41aa17a6a52d33b75e4afcff875c?s=128&d=identicon&r=PG&f=1", "display_name": "K Emery", "link": "https://stackoverflow.com/users/8594202/k-emery"}, "is_accepted": true, "score": 1, "last_activity_date": 1541693758, "last_edit_date": 1541693758, "creation_date": 1541605896, "answer_id": 53192997, "question_id": 53187524, "link": "https://stackoverflow.com/questions/53187524/linking-hyperlinks-in-a-word-document-to-a-corresponding-document-in-a-excel-she/53192997#53192997", "title": "Linking Hyperlinks in a Word Document to a corresponding document in a excel sheet", "body": "<p>I got it working myself. Below is the full code.</p>\n\n<pre><code>Dim strArray() As String\n    Dim LinkArray() As String\n    Dim TotalRows As Long\n\nPrivate Sub DOCUMENT_OPEN()\nDim file\nDim path As String\nDim FilenameWaterMark As String\nDim Rng As Range\nDim SearchString As String\nDim EndString As String\nDim Id As String\nDim Link As String\n\nCall OpenExcelFile\n\ni = 1\nFor i = 1 To TotalRows\n\n\nSet Rng = ActiveDocument.Range\nSearchString = strArray(i)\n    With Rng.Find\n    .MatchWildcards = False\n        Do While .Execute(findText:=SearchString, Forward:=False, MatchWholeWord:=True) = True\n            Rng.MoveStartUntil (strArray(i))\n            Rng.MoveEndUntil (\"\")\n            Link = LinkArray(i)\n\n                ActiveDocument.Hyperlinks.Add Anchor:=Rng, _\n                Address:=Link, _\n                SubAddress:=\"\", ScreenTip:=\"\", TextToDisplay:=Rng.Text\n                Rng.Collapse wdCollapseStart\n\n\n        Loop\n    End With\nNext\n\n\nActiveDocument.Save\n\nEnd Sub\n\nSub OpenExcelFile()\n'Variables\n\n    Dim i, x As Long\n    Dim oExcel As Excel.Application\n    Dim oWB As Workbook\n     i = 1\n'Opening Excel Sheet\n    Set oExcel = New Excel.Application\n    Set oWB = oExcel.Workbooks.Open(\"H:\\DCTEST\\Templates\\DOCS.xlsx\")\n    oExcel.Visible = False\n\n'Counts Number of Rows in Sheet\n    TotalRows = Rows(Rows.Count).End(xlUp).Row\n    ReDim strArray(1 To TotalRows)\n    ReDim LinkArray(1 To TotalRows)\n\n'Assigns each cell in Column A to an Array\n    For i = 1 To TotalRows\n        strArray(i) = Cells(i, 1).Value\n    Next\n\n'searches for hyperlink\n    For i = 1 To TotalRows\n        LinkArray(i) = Cells(i, 2).Value\n    Next\n\noExcel.Quit\n\nEnd Sub\n</code></pre>\n\n<p>This runs when the document is open and links all mentions of a template to its document in the template folder. </p>\n"}], "owner": {"reputation": 69, "user_id": 8594202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f15f41aa17a6a52d33b75e4afcff875c?s=128&d=identicon&r=PG&f=1", "display_name": "K Emery", "link": "https://stackoverflow.com/users/8594202/k-emery"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 53192997, "answer_count": 1, "score": -3, "last_activity_date": 1583030524, "creation_date": 1541586165, "last_edit_date": 1583030524, "question_id": 53187524, "link": "https://stackoverflow.com/questions/53187524/linking-hyperlinks-in-a-word-document-to-a-corresponding-document-in-a-excel-she", "title": "Linking Hyperlinks in a Word Document to a corresponding document in a excel sheet", "body": "<p>To keep it simple I have several hundred word documents for clients which list templates used for those clients. I need to hyperlink each mention of a template in every document to its corresponding template document, which are all stored in a template folder. </p>\n\n<p>I have a excel spread sheet with 2 columns. The 1st being the name of the template, the 2nd being a hyperlink to that template in the relevant folder. \nBelow is the script I have created but I am having issues getting it to hyperlink the text, I have tried the code written here with some changed to search and replace with my variable but it makes them all the same hyperlink. <a href=\"https://superuser.com/a/1010293\">https://superuser.com/a/1010293</a> </p>\n\n<p>I am struggling to find another way to do this based on my current knowledge of VBA.  </p>\n\n<p>Below is my current code which carries out the whole task.</p>\n\n<pre><code>    Public strArray() As String\n    Public LinkArray() As String\n    Public TotalRows As Long\n\nSub Hyperlink()\nDim file\nDim path As String\nDim FilenameWaterMark As String\n\nCall OpenExcelFile\n\ni = 1\nFor i = 1 To TotalRows\n\n'here I need the document to look through while searching for strarray(I) \n'and make that string a hyperlink to linkarray(I) \nNext\n\n\nActiveDocument.Save\n\nEnd Sub\n\nSub OpenExcelFile()\n'Variables\n\n    Dim i, x As Long\n    Dim oExcel As Excel.Application\n    Dim oWB As Workbook\n     i = 1\n'Opening Excel Sheet\n    Set oExcel = New Excel.Application\n    Set oWB = oExcel.Workbooks.Open(\"H:\\DCTEST\\Templates\\DOCS.xlsx\")\n    oExcel.Visible = True\n\n'Counts Number of Rows in Sheet\n    TotalRows = Rows(Rows.Count).End(xlUp).Row\n    ReDim strArray(1 To TotalRows)\n    ReDim LinkArray(1 To TotalRows)\n\n'Assigns each cell in Column A to an Array\n    For i = 1 To TotalRows\n        strArray(i) = Cells(i, 1).Value\n    Next\n\n'searches for hyperlink\n    For i = 1 To TotalRows\n        LinkArray(i) = Cells(i, 2).Value\n    Next\n\noExcel.Quit\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 6, "creation_date": 1541583345, "post_id": 53186654, "comment_id": 93262900, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/6688131/test-or-check-if-sheet-exists\">Test or check if sheet exists</a>"}], "answers": [{"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1541584050, "post_id": 53186827, "comment_id": 93263246, "body": "I hardly recommend to read: <a href=\"https://stackoverflow.com/questions/36491908/whats-the-deference-between-end-and-exit-sub-in-vba\">What&#39;s the deference between \u201cend\u201d and \u201cexit sub\u201d in VBA?</a>. <code>End</code> will kill your whole VBA execution. \u2022 And your code will still add a sheet even if sheet <code>data</code> exists."}, {"owner": {"reputation": 812, "user_id": 5457466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/438a24229b00e5d4327425c37518aca7?s=128&d=identicon&r=PG&f=1", "display_name": "Egalth", "link": "https://stackoverflow.com/users/5457466/egalth"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1541585973, "post_id": 53186827, "comment_id": 93264248, "body": "Indeed, that was sloppy of me, I&#39;ve edited accordingly. Thanks for the correction. (As for <code>End</code> vs. <code>Exit Sub</code>, I&#39;m perfctly aware of the difference, that&#39;s irrelevant after the edit, but the choice should obviously be made depending on context.)"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1541586768, "post_id": 53186827, "comment_id": 93264662, "body": "It will fail if eg a chart sheet named <code>Data</code> exists because you check only for existing worksheets. Note that <code>Sheets &lt;&gt; Worksheets</code>. <code>Sheets</code> can contain all type of sheets like <code>Charts</code>, <code>Worksheets</code>, etc."}, {"owner": {"reputation": 812, "user_id": 5457466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/438a24229b00e5d4327425c37518aca7?s=128&d=identicon&r=PG&f=1", "display_name": "Egalth", "link": "https://stackoverflow.com/users/5457466/egalth"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1541586943, "post_id": 53186827, "comment_id": 93264745, "body": "Thanks again, good point. Always learning. I&#39;ll leave the post as is for now."}], "tags": [], "owner": {"reputation": 812, "user_id": 5457466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/438a24229b00e5d4327425c37518aca7?s=128&d=identicon&r=PG&f=1", "display_name": "Egalth", "link": "https://stackoverflow.com/users/5457466/egalth"}, "is_accepted": false, "score": 0, "last_activity_date": 1541606682, "last_edit_date": 1541606682, "creation_date": 1541583561, "answer_id": 53186827, "question_id": 53186654, "link": "https://stackoverflow.com/questions/53186654/if-sheet-exist-dont-add-another-one/53186827#53186827", "title": "If sheet exist, don&#39;t add another one", "body": "<p>(<strong>EDIT:</strong> A previous version of this answer produced the wrong result, details in comments.)</p>\n\n<p>This should work. Note the use of <code>On Error Resume Next</code> combined with <code>On Error GoTo 0</code> instead of <code>On Error GoTo ErrorHandler</code>. (GoTo statements are commonly associated with <a href=\"https://stackoverflow.com/questions/195520/what-is-spaghetti-code#325789\">so-called \"spaghetti code\"</a>, so it could be a good habit to avoid them when possible.)</p>\n\n<pre><code>Sub AddWorkSheet()\n    Dim wb As Workbook, ws As Worksheet\n    On Error Resume Next\n    Set ws = Worksheets(\"Data\")\n    If Err.Number &lt;&gt; 9 Then ' 9 means subscript out of range\n        MsgBox (\"Sheet already exists.\"), vbCritical\n    Else\n        Sheets.Add After:=Worksheets(Worksheets.Count)\n        Sheets(Worksheets.Count).Name = \"data\"\n    End If\n    On Error GoTo 0\nEnd Sub\n</code></pre>\n\n<p>In your original code, you could add an <code>Exit Sub</code> statement before the error handler; without it <code>ErrorHandler</code> will always be called. (You might want to have a look at the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/Excel.Sheets.Add\" rel=\"nofollow noreferrer\">documentation</a>.).</p>\n"}, {"tags": [], "owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "is_accepted": false, "score": 0, "last_activity_date": 1541584090, "creation_date": 1541584090, "answer_id": 53186962, "question_id": 53186654, "link": "https://stackoverflow.com/questions/53186654/if-sheet-exist-dont-add-another-one/53186962#53186962", "title": "If sheet exist, don&#39;t add another one", "body": "<p>Before adding a sheet, check if it exists:</p>\n\n<pre><code>Function ShtExist(ShtName As String) As Boolean\nOn Error Resume Next\n    ShtExist = Len(ThisWorkbook.Sheets(ShtName).Name) &gt; 0\nOn Error GoTo 0\nEnd Function\n\nSub AddWorkSheet()\n\n    Dim wb As Workbook, shtDest As Worksheet\n    If ShtExist(\"Data\") Then\n    MsgBox (\"Something went wrong.\"), vbCritical\n    Else\n    Sheets.Add.Name = (\"Data\")\n    Set shtDest = Sheets(\"Data\")\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 10442526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb558cd6dc215ce0ace3fec781186ecd?s=128&d=identicon&r=PG&f=1", "display_name": "G. Koen", "link": "https://stackoverflow.com/users/10442526/g-koen"}, "edited": false, "score": 0, "creation_date": 1541751416, "post_id": 53187404, "comment_id": 93330849, "body": "Unfortunately this doesn&#39;t seem to work though. I still get the same error (1004, via the else function in the errorhandler), but right after that another numbered sheet gets created."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "reply_to_user": {"reputation": 33, "user_id": 10442526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb558cd6dc215ce0ace3fec781186ecd?s=128&d=identicon&r=PG&f=1", "display_name": "G. Koen", "link": "https://stackoverflow.com/users/10442526/g-koen"}, "edited": false, "score": 0, "creation_date": 1541756604, "post_id": 53187404, "comment_id": 93333283, "body": "You get error 1004 in line <code>MsgBox Err.Description, vbCritical, Err.Number</code>?"}], "tags": [], "owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "is_accepted": false, "score": 1, "last_activity_date": 1541585716, "creation_date": 1541585716, "answer_id": 53187404, "question_id": 53186654, "link": "https://stackoverflow.com/questions/53186654/if-sheet-exist-dont-add-another-one/53187404#53187404", "title": "If sheet exist, don&#39;t add another one", "body": "<p>When you try to assign a non-exist worksheet to a variable, VBA will return error 9. From my POV, I think it's useful to trap that error and then create the worksheet if needed.</p>\n\n<p>So I would use:</p>\n\n<pre><code>Sub AddWorkSheet()\nDim wb As Workbook, shtDest As Worksheet\n\nOn Error GoTo ErrorHandler\nSet shtDest = Sheets(\"Data\")\n\n\n'&lt;--rest of your code--&gt;\n'\n'\n'\n'\n'\n'\n''&lt;--rest of your code--&gt;\n\nSet shtDest = Nothing\nSet wb = Nothing\n\nExit Sub\n\n\nErrorHandler:\nIf Err.Number = 9 Then\n    'must create worksheet DATA\n    Sheets.Add.Name = (\"Data\")\n    Set shtDest = Sheets(\"Data\")\n    Resume Next\nElse\n    'different error. MSgbox with new error\n    MsgBox Err.Description, vbCritical, Err.Number\n    Stop\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Please, note that right before the <code>ErrorHanlder</code> part, I added <code>Exit Sub</code> to avoid this part of code being executed every time the sub runs.</p>\n"}], "owner": {"reputation": 33, "user_id": 10442526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb558cd6dc215ce0ace3fec781186ecd?s=128&d=identicon&r=PG&f=1", "display_name": "G. Koen", "link": "https://stackoverflow.com/users/10442526/g-koen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 474, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1541606682, "creation_date": 1541582950, "last_edit_date": 1541583266, "question_id": 53186654, "link": "https://stackoverflow.com/questions/53186654/if-sheet-exist-dont-add-another-one", "title": "If sheet exist, don&#39;t add another one", "body": "<p>If the sheet \"Data\" does not exist, the code works perfectly, if it does exist however I get the error \"Name already exists, try a different name\". I've simply fixed this with an <code>On Error GoTo ErrorHandler</code>, the problem however is that after the code runs and the macro triggers the errorhandler msgbox , it still creates a new sheet regardless (with the names 'Sheet1,2,3,...').</p>\n\n<p>Snippet:</p>\n\n<pre><code>Sub AddWorkSheet()\n    Dim wb As Workbook, shtDest As Worksheet\n    On Error GoTo ErrorHandler\n    Sheets.Add.Name = (\"Data\")\n    Set shtDest = Sheets(\"Data\")\n\nErrorHandler:\n    MsgBox (\"Something went wrong.\"), vbCritical\n\nEnd Sub\n</code></pre>\n\n<p>I'd like the code to simply return the message box and not create any additional sheets if the sheet \"Data\" already exists.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1541583152, "post_id": 53186612, "comment_id": 93262826, "body": "You should really work on your sentence structure. Sentences like <i>&quot;So If the the customer has doors and windows the sales person that should be retrieved is Jack If the customer has tiles and windows then the sales person that should be retrived is Sarah If the customer has windows, doors and tiles then the sales person that should be retrived is Sarah And if the customer has a single product then the name of the sales person retrieved should be the name of the person in the sales person column on that worksheet&quot;</i> without punctuation are almost not understandable. Please improve your question"}, {"owner": {"reputation": 21, "user_id": 10617451, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xcF0YobF0R8/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbC3Rqw8vIi1IZu_jfuSN5iCpziDBg/mo/photo.jpg?sz=128", "display_name": "Skip Houston", "link": "https://stackoverflow.com/users/10617451/skip-houston"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1541665124, "post_id": 53186612, "comment_id": 93295654, "body": "Thanks PEH. I have edited the question as requested."}], "owner": {"reputation": 21, "user_id": 10617451, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xcF0YobF0R8/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbC3Rqw8vIi1IZu_jfuSN5iCpziDBg/mo/photo.jpg?sz=128", "display_name": "Skip Houston", "link": "https://stackoverflow.com/users/10617451/skip-houston"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1541768422, "creation_date": 1541582775, "last_edit_date": 1541768422, "question_id": 53186612, "link": "https://stackoverflow.com/questions/53186612/search-across-excel-worksheets-and-return-a-value-based-on-where-clause-with-hie", "title": "Search across Excel worksheets and return a value based on where clause with hierarchy?", "body": "<p>I am trying to return a lead sales person based on the products that are used by the customer</p>\n\n<p>I have a workbook that contains a number of worksheets within it. The first worksheet is a summary worksheet with a search field and a button that when clicked returns specific column data from the other sheets. \nThe other sheets are based on product, we have three products which equals three worksheets. The columns in each of those worksheets is the same with the data different from product to product. </p>\n\n<p>I have been asked to add a new column, \"sales person\" to each product worksheet with the aim of pulling that data into the summary worksheet when a new search is executed. \nThe problem I am facing is that there is a lead sales person when multiple products are used by the customer. Though each product has a sales person, it is a different person per product and where multiple products are used by the customer one of the sales people assumes the role of lead sales person</p>\n\n<p><strong>The workbook structure is</strong>\nWorksheet 1 is the summary sheet and will have a new column title called \"lead sales person\"\nworksheet 2 is for windows and the sales person is Jack\nWorksheet 3 is for doors and the sales person is Mary\nWorksheet 4 is for tiles and the sales person is Sarah</p>\n\n<p><strong>Scenarios for returning the correct lead sales person</strong></p>\n\n<p>1 - WHERE customer product list = doors AND windows \nTHEN the sales person that should be retrieved is Jack</p>\n\n<p>2 - WHERE customer product list = tiles and windows \nTHEN then the sales person that should be retrieved is Sarah</p>\n\n<p>3 - WHERE customer product list = windows, doors and tiles \nTHEN the sales person that should be retrieved is Sarah</p>\n\n<p>4 - WHERE customer product list = a single product \nTHEN the name of the sales person retrieved should be the name of the person in the sales person column on that worksheet </p>\n\n<p>NB: The common link between each worksheet is the Customer ID field. This is what allows us to see all products that a customer has when executing the query below.</p>\n\n<p>Ideally what I need is something that is flexible so that there would be no need to hard code people's name into the code to retrieve the lead sales person</p>\n\n<p>Below is the code that I have written for the search across worksheets as it currently is. It works great, just need to find a way to add the above! \nThanks in advance.</p>\n\n<pre><code>Option Compare Text\n\nSub OptionCompareText()\n\n\nEnd Sub\n\nSub SearchMultipleSheets()\n\n    'The 5 in the line below is the maximum array value which further down is the arr(i, 5) = ws.Name entry\n    Dim arr(999, 5) As Variant, r As Range\n    Dim ws As Worksheet, i As Integer, s As String\n    Dim lastrow As Long\n    lastrow = Sheets(\"Sheet2\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n    Set r = Sheets (\"Sheet2\").Range(\"A2:A &amp; Lastrow)\n\n    With Sheets(1)\n        s = Range(\"c1\").Value\n        .Range(\"a3\").Resize(.UsedRange.Rows.Count, .UsedRange.Columns.Count).ClearContents\n    End With\n    For Each ws In Worksheets\n        If ws.Name &lt;&gt; Sheets(1).Name Then\n        With ws\n            For Each r In .Range(\"a2\", .Range(\"a\" &amp; .Rows.Count).End(xlUp))\n                If r.Value &amp; r.Offset(0, 1).Value &amp; r.Offset(0, 2).Value &amp; r.Offset(0, 3).Value Like \"*\" &amp; s &amp; \"*\" Then\n                    arr(i, 0) = ws.Name\n                    'arr(i, 1) = r.Value\n                    arr(i, 1) = r.Offset(0, 1).Value\n                    arr(i, 2) = r.Offset(0, 2).Value\n                    arr(i, 3) = r.Offset(0, 3).Value\n                    arr(i, 4) = r.Offset(0, 4).Value\n\n                    i = i + 1\n                End If\n            Next r\n        End With\n        End If\n    Next ws\n    With Sheets(1)\n        .Range(\"a3\").Resize(i, 6).Value = arr\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1541581556, "post_id": 53186288, "comment_id": 93261974, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/30380490/find-and-findnext-for-excel-vba\">Find and FindNext for Excel VBA</a>"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1541581587, "post_id": 53186288, "comment_id": 93261991, "body": "Additionally I recommend to read <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a> and apply this technique to your code."}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 10585791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc5063e4c34845b91020fa01f655284?s=128&d=identicon&r=PG&f=1", "display_name": "Vaggelis", "link": "https://stackoverflow.com/users/10585791/vaggelis"}, "edited": false, "score": 0, "creation_date": 1541594837, "post_id": 53189081, "comment_id": 93268370, "body": "Thank you very much DirtyDeffy it works!!!!!! The only change I made is to remove \u201cThisWorbook.\u201d from the two sets. As you understand I am not hard coder but I am trying, my thought was to target the cells with \u201c#N/A\u201d because these cells are 15 or 20 max in a range of 5000 and its time consuming to do it manually\u2026As I understand your code search every cell to much the value \u201c#N/A\u201d am I right?"}, {"owner": {"reputation": 467, "user_id": 9490000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a996f5c51b98710f55f20aaf72f376b?s=128&d=identicon&r=PG&f=1", "display_name": "DirtyDeffy", "link": "https://stackoverflow.com/users/9490000/dirtydeffy"}, "reply_to_user": {"reputation": 57, "user_id": 10585791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc5063e4c34845b91020fa01f655284?s=128&d=identicon&r=PG&f=1", "display_name": "Vaggelis", "link": "https://stackoverflow.com/users/10585791/vaggelis"}, "edited": false, "score": 0, "creation_date": 1541597252, "post_id": 53189081, "comment_id": 93269564, "body": "@Vaggelis For a new coder, your idea was nicely thought out. Only a few places in the execution, where it needed improvement. <code>ThisWorkbook</code> simply specifies which workbook the code needs to target. Yes you are completely right. My version of the code is almost identical to the <code>.Find</code> method. My version uses a loop to go through column F and if the cell value is &quot;#N/A&quot; then it triggers the copy/paste. I would like you to thoroughly look through my code and ask me if there is anything you don&#39;t understand. You only get better at coding if you understand the code you&#39;re using :)"}, {"owner": {"reputation": 467, "user_id": 9490000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a996f5c51b98710f55f20aaf72f376b?s=128&d=identicon&r=PG&f=1", "display_name": "DirtyDeffy", "link": "https://stackoverflow.com/users/9490000/dirtydeffy"}, "reply_to_user": {"reputation": 57, "user_id": 10585791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc5063e4c34845b91020fa01f655284?s=128&d=identicon&r=PG&f=1", "display_name": "Vaggelis", "link": "https://stackoverflow.com/users/10585791/vaggelis"}, "edited": false, "score": 0, "creation_date": 1541597317, "post_id": 53189081, "comment_id": 93269591, "body": "@Vaggelis However in this particular case, using a filter instead of VBA coding might have been easier ;)"}, {"owner": {"reputation": 57, "user_id": 10585791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc5063e4c34845b91020fa01f655284?s=128&d=identicon&r=PG&f=1", "display_name": "Vaggelis", "link": "https://stackoverflow.com/users/10585791/vaggelis"}, "edited": false, "score": 0, "creation_date": 1541600922, "post_id": 53189081, "comment_id": 93271633, "body": "DirtyDeffy I much appreciate your help, your code is very very good and yes I can read it little by little! I thing .Find because this code is a small part of bigger code. I work with huge excel spreadsheets and the code must be efficient, usually 150 000 lines and more! The big code copy data from other two excels in sheet 3 and 4 refresh pivot in sheet 1 now your code find the #N/A copy them to Sheet2 and I have code more to export a report and automate email\u2026! I have many things to learn to code like you! I have many questions about other codes may I ask you about or I must upload question?"}, {"owner": {"reputation": 467, "user_id": 9490000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a996f5c51b98710f55f20aaf72f376b?s=128&d=identicon&r=PG&f=1", "display_name": "DirtyDeffy", "link": "https://stackoverflow.com/users/9490000/dirtydeffy"}, "reply_to_user": {"reputation": 57, "user_id": 10585791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc5063e4c34845b91020fa01f655284?s=128&d=identicon&r=PG&f=1", "display_name": "Vaggelis", "link": "https://stackoverflow.com/users/10585791/vaggelis"}, "edited": false, "score": 0, "creation_date": 1541665988, "post_id": 53189081, "comment_id": 93296011, "body": "@Vaggelis Post a new question and link it here as a comment :)"}, {"owner": {"reputation": 57, "user_id": 10585791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc5063e4c34845b91020fa01f655284?s=128&d=identicon&r=PG&f=1", "display_name": "Vaggelis", "link": "https://stackoverflow.com/users/10585791/vaggelis"}, "edited": false, "score": 0, "creation_date": 1542625596, "post_id": 53189081, "comment_id": 93622433, "body": "Hi DirtyDeffy i have post another question, here is the link: <a href=\"https://stackoverflow.com/questions/53373236/copy-a-range-of-adjacent-columns-from-sheet1-to-sheet2\" title=\"copy a range of adjacent columns from sheet1 to sheet2\">stackoverflow.com/questions/53373236/&hellip;</a>"}, {"owner": {"reputation": 57, "user_id": 10585791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc5063e4c34845b91020fa01f655284?s=128&d=identicon&r=PG&f=1", "display_name": "Vaggelis", "link": "https://stackoverflow.com/users/10585791/vaggelis"}, "edited": false, "score": 0, "creation_date": 1545303419, "post_id": 53189081, "comment_id": 94581711, "body": "<a href=\"https://stackoverflow.com/questions/53866938/pivot-table-filter-month-select-all-before-current-month\" title=\"pivot table filter month select all before current month\">stackoverflow.com/questions/53866938/&hellip;</a>"}, {"owner": {"reputation": 57, "user_id": 10585791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc5063e4c34845b91020fa01f655284?s=128&d=identicon&r=PG&f=1", "display_name": "Vaggelis", "link": "https://stackoverflow.com/users/10585791/vaggelis"}, "edited": false, "score": 0, "creation_date": 1545303502, "post_id": 53189081, "comment_id": 94581756, "body": "Hi DirtyDeffy i have a question about Pivot Table if you have time to help me with this thank you!"}], "tags": [], "owner": {"reputation": 467, "user_id": 9490000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a996f5c51b98710f55f20aaf72f376b?s=128&d=identicon&r=PG&f=1", "display_name": "DirtyDeffy", "link": "https://stackoverflow.com/users/9490000/dirtydeffy"}, "is_accepted": false, "score": 0, "last_activity_date": 1541592096, "creation_date": 1541592096, "answer_id": 53189081, "question_id": 53186288, "link": "https://stackoverflow.com/questions/53186288/vba-find-n-a-value-and-copy-adjacent-cells-to-another-sheet-and-loop/53189081#53189081", "title": "VBA Find #N/A value and copy adjacent cells to another sheet and loop", "body": "<p>Try this and let me know if it works:</p>\n\n<pre><code>Option Explicit\nSub Find()\nApplication.ScreenUpdating = False\nDim SearchRange As Range\nDim FindCell As Range\nDim Check As Boolean\nDim LastRow As Long\nDim ws As Worksheet\nDim ws2 As Worksheet\nDim FindCounter As Long\n\nSet ws = ThisWorkbook.Worksheets(\"Sheet1\") ' &lt;--- Insert the name of your worksheet here\nSet ws2 = ThisWorkbook.Worksheets(\"Sheet2\")\nLastRow = ws.Cells(Rows.Count, \"F\").End(xlUp).Row ' &lt;--- Finds the last used row\nSet SearchRange = Range(\"F1:F\" &amp; LastRow)\nFindCounter = 0\n\nFor Each FindCell In SearchRange\n    If FindCell.Value = \"#N/A\" Then\n        FindCounter = FindCounter + 1\n        FindCell.Offset(0, -3).Resize(, 3).Copy\n        ws2.Range(\"A\" &amp; ws2.Cells(Rows.Count, \"A\").End(xlUp).Row + 1).PasteSpecial xlPasteValues\n    End If\nNext\n\nMsgBox \"Succes!\" &amp; vbNewLine &amp; vbNewLine &amp; \"This many cells were found: \" &amp; FindCounter\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 10585791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc5063e4c34845b91020fa01f655284?s=128&d=identicon&r=PG&f=1", "display_name": "Vaggelis", "link": "https://stackoverflow.com/users/10585791/vaggelis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 803, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1541592096, "creation_date": 1541581447, "last_edit_date": 1541581668, "question_id": 53186288, "link": "https://stackoverflow.com/questions/53186288/vba-find-n-a-value-and-copy-adjacent-cells-to-another-sheet-and-loop", "title": "VBA Find #N/A value and copy adjacent cells to another sheet and loop", "body": "<p>Good day to everyone,</p>\n\n<p>I have been trying to find an answer here that would fit my problem but I have been unsuccessful. I am using FIND to search column F for cell with <code>#N/A</code> value and copy adjacent cells to another \"Sheet2\" at the end of the column A. I have made the following code that works but my problem is I want to make it to loop to find the next cell with <code>#N/A</code> value till find all.</p>\n\n<pre><code>Sub Find()\n    Dim SerchRange As Range\n    Dim FindCell As Range\n    Set SerchRange = Range(\"F:F\")\n    Set FindCell = SerchRange.FIND(What:=\"#N/A\", _\n      LookIn:=xlValues, _\n      LookAt:=xlWhole, _\n      SearchOrder:=xlByRows, _\n      SearchDirection:=xlNext, _\n      MatchCase:=False)\n\n    If FindCell Is Nothing Then\n        MsgBox \"Nothing was found all clear\"    \n    Else\n        FindCell.Select\n        ActiveCell.Offset(0, -3).Resize(, 3).Select\n        Selection.Copy\n        Sheets(\"Sheet2\").Select\n        Cells(Rows.Count, \"A\").End(xlUp).Offset(1, 0).Select\n        ActiveSheet.Paste\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 126499, "user_id": 1531124, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/zw18i.png?s=128&g=1", "display_name": "GhostCat", "link": "https://stackoverflow.com/users/1531124/ghostcat"}, "edited": false, "score": 0, "creation_date": 1541584012, "post_id": 53186257, "comment_id": 93263219, "body": "Welcome to Stack Overflow! Other users marked your question for low quality and need for improvement. I re-worded/formatted your input to make it easier to read/understand. Please review my changes to ensure they reflect your intentions. Feel free to drop me a comment in case you have further questions or feedback for me."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1541587862, "post_id": 53186257, "comment_id": 93265156, "body": "I recommend to read <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 10617334, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lRBi8.jpg?s=128&g=1", "display_name": "Sylvain.A", "link": "https://stackoverflow.com/users/10617334/sylvain-a"}, "edited": false, "score": 0, "creation_date": 1541602771, "post_id": 53186725, "comment_id": 93272803, "body": "Thank you Darren.  I used the code you first posted and edited it to fit the appropriate ranges, it works great and I will definitely re-use it for other macros.  The color sorting was intended as I am using a conditional formatting which allows me to differentiate variables."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 5, "user_id": 10617334, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lRBi8.jpg?s=128&g=1", "display_name": "Sylvain.A", "link": "https://stackoverflow.com/users/10617334/sylvain-a"}, "edited": false, "score": 0, "creation_date": 1541602918, "post_id": 53186725, "comment_id": 93272936, "body": "Good stuff.   The first set of code is still in there - just padded it out with the other code.  If it&#39;s helped feel free to tick the accepted answer next to the answer. :)"}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 0, "last_activity_date": 1541588119, "last_edit_date": 1541588119, "creation_date": 1541583232, "answer_id": 53186725, "question_id": 53186257, "link": "https://stackoverflow.com/questions/53186257/excel-vba-macro-with-a-for-loop/53186725#53186725", "title": "Excel VBA macro with a For loop", "body": "<p>This will copy the columns to the bottom of column A.  Just adjust the value that <code>x</code> steps through - currently goes from <code>B</code> to <code>CR</code>.  </p>\n\n<p><em>Edit:</em>  I've updated the code to include the other parts in your code.  I'm not sure how you're deciding on some ranges so I've left those as is rather than finding the end of the various ranges.<br>\n<em>e.g.</em> do you always clear <code>A64:T584</code> or is it variable?</p>\n\n<pre><code>Public Sub Transpose()\n\n    Dim x As Long\n    Dim rLastCell As Range\n    Dim shtHidden As Worksheet\n    Dim shtImport As Worksheet\n\n    Set shtHidden = ThisWorkbook.Worksheets(\"HiddenSheet\")\n    Set shtImport = ThisWorkbook.Worksheets(\"Import\")\n\n    With shtHidden\n        .Visible = xlSheetVisible\n\n        .Range(\"A64:T584\").ClearContents\n        .Range(\"B2:P61\").Copy\n        .Range(\"A64\").PasteSpecial xlPasteValues\n        With .Range(\"A64:BH78\")\n            .Replace What:=\"0\", Replacement:=\"\", _\n                LookAt:=xlWhole, SearchOrder:=xlByRows\n            .SpecialCells(xlCellTypeBlanks).Delete Shift:=xlUp\n        End With\n\n        For x = 2 To 96 'Adjust to column numbers you want to copy.\n            Set rLastCell = .Cells(Rows.Count, 1).End(xlUp) 'Last cell containing data in column 1.\n            .Range(.Cells(64, x), .Cells(78, x)).Copy 'Copy rows 64:78 of column \"x\".\n            rLastCell.Offset(1).PasteSpecial xlPasteValues 'Paste values to end of column A.\n        Next x\n\n        Set rLastCell = .Cells(Rows.Count, 1).End(xlUp)\n\n        'You seem to be sorting on colour here and then value.  Not sure - so only sorted on value.\n        With .Sort\n            With .SortFields\n                .Clear\n                .Add Key:=shtHidden.Range(shtHidden.Cells(64, 1), rLastCell), _\n                     SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n            End With\n\n            .SetRange shtHidden.Range(shtHidden.Cells(64, 1), rLastCell)\n            .Header = xlNo 'Or xlYes\n            .MatchCase = False\n            .Orientation = xlTopToBottom\n            '.SortMethod = xlPinYin 'Something to do with Chinese alphabet, so not needed.\n            .Apply\n        End With\n\n        'No need to PasteSpecial Values as that was done when copying into column A.\n        .Range(.Cells(64, 1), rLastCell).Copy Destination:=ThisWorkbook.Worksheets(\"Import\").Range(\"C2\")\n\n    End With\n\n    With shtImport\n        With .Sort\n            With .SortFields\n                .Clear\n                .Add Key:=shtImport.Range(\"A2:A97\"), _\n                    SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n            End With\n            .SetRange shtImport.Range(\"A2:T97\")\n            .Header = xlGuess\n            .MatchCase = False\n            .Orientation = xlTopToBottom\n            .Apply\n        End With\n        .Range(\"A1:A97\").Delete Shift:=xlToLeft\n        .Columns(\"A:F\").AutoFit\n    End With\n\n    shtHidden.Visible = xlSheetHidden 'or xlSheetVeryHidden\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 10617334, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lRBi8.jpg?s=128&g=1", "display_name": "Sylvain.A", "link": "https://stackoverflow.com/users/10617334/sylvain-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 53186725, "answer_count": 1, "score": 0, "last_activity_date": 1586402461, "creation_date": 1541581317, "last_edit_date": 1586402461, "question_id": 53186257, "link": "https://stackoverflow.com/questions/53186257/excel-vba-macro-with-a-for-loop", "title": "Excel VBA macro with a For loop", "body": "<p>I used the following macro which I know is horrible to look at but I was not good enough to integrate a loop in the code so I repeated it.  </p>\n\n<p>However, I now need to increase the number of copied columns to 96 and I think it would be much nicer to have a loop...</p>\n\n<p>Here is the current code:</p>\n\n<pre><code>Sub Transpose()   \n' Transpose Macro\n'    \n'\n    Application.ScreenUpdating = False\n    Sheets(\"HiddenSheet\").Visible = True\n    Sheets(\"Hiddensheet\").Select\n    Range(\"A64:T584\").Select\n    Selection.ClearContents\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"B2:P61\").Select\n    Selection.Copy\n    Range(\"A64\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=True\n    Range(\"A64:BH78\").Select\n    Selection.Replace What:=\"0\", Replacement:=\"\", LookAt:=xlWhole, _\n    SearchOrder:=xlByRows, MatchCase:=True, SearchFormat:=False, _\n    ReplaceFormat:=False\n\n    Range(\"A64:BH78\").Select\n    Selection.SpecialCells(xlCellTypeBlanks).Select\n    Selection.Delete Shift:=xlUp\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"B64:B78\").Select\n    Selection.Copy\n    Range(\"A63\").End(xlDown).Offset(1, 0).Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"C64:C78\").Select\n    Selection.Copy\n    Range(\"A64\").End(xlDown).Offset(1, 0).Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"D64:D78\").Select\n    Selection.Copy\n    Range(\"A64\").End(xlDown).Offset(1, 0).Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"E64:E78\").Select\n    Selection.Copy\n    Range(\"A64\").End(xlDown).Offset(1, 0).Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"F64:F78\").Select\n    Selection.Copy\n    Range(\"A64\").End(xlDown).Offset(1, 0).Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"G64:G78\").Select\n    Selection.Copy\n    Range(\"A64\").End(xlDown).Offset(1, 0).Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"H64:H78\").Select\n    Selection.Copy\n    Range(\"A64\").End(xlDown).Offset(1, 0).Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"I64:I78\").Select\n    Selection.Copy\n    Range(\"A64\").End(xlDown).Offset(1, 0).Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"J64:J78\").Select\n    Selection.Copy\n    Range(\"A64\").End(xlDown).Offset(1, 0).Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"K64:K78\").Select\n    Selection.Copy\n    Range(\"A64\").End(xlDown).Offset(1, 0).Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"L64:L78\").Select\n    Selection.Copy\n    Range(\"A64\").End(xlDown).Offset(1, 0).Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"M64:M78\").Select\n    Selection.Copy\n    Range(\"A64\").End(xlDown).Offset(1, 0).Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"N64:N78\").Select\n    Selection.Copy\n    Range(\"A64\").End(xlDown).Offset(1, 0).Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"O64:O78\").Select\n    Selection.Copy\n    Range(\"A64\").End(xlDown).Offset(1, 0).Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"P64:P78\").Select\n    Selection.Copy\n    Range(\"A64\").End(xlDown).Offset(1, 0).Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"Q64:Q78\").Select\n    Selection.Copy\n    Range(\"A64\").End(xlDown).Offset(1, 0).Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"R64:R78\").Select\n    Selection.Copy\n    Range(\"A64\").End(xlDown).Offset(1, 0).Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"S64:S78\").Select\n    Selection.Copy\n    Range(\"A64\").End(xlDown).Offset(1, 0).Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"T64:T78\").Select\n    Selection.Copy\n    Range(\"A64\").End(xlDown).Offset(1, 0).Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"U64:U78\").Select\n    Selection.Copy\n    Range(\"A64\").End(xlDown).Offset(1, 0).Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"V64:V78\").Select\n    Selection.Copy\n    Range(\"A64\").End(xlDown).Offset(1, 0).Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"W64:W78\").Select\n    Selection.Copy\n    Range(\"A64\").End(xlDown).Offset(1, 0).Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"X64:X78\").Select\n    Selection.Copy\n    Range(\"A64\").End(xlDown).Offset(1, 0).Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"Y64:Y78\").Select\n    Selection.Copy\n    Range(\"A64\").End(xlDown).Offset(1, 0).Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"Z64:Z78\").Select\n    Selection.Copy\n    Range(\"A64\").End(xlDown).Offset(1, 0).Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"AA64:AA78\").Select\n    Selection.Copy\n    Range(\"A64\").End(xlDown).Offset(1, 0).Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"AB64:AB78\").Select\n    Selection.Copy\n    Range(\"A64\").End(xlDown).Offset(1, 0).Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"AC64:AC78\").Select\n    Selection.Copy\n    Range(\"A64\").End(xlDown).Offset(1, 0).Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"AD64:AD78\").Select\n    Selection.Copy\n    Range(\"A64\").End(xlDown).Offset(1, 0).Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"AE64:AE78\").Select\n    Selection.Copy\n    Range(\"A64\").End(xlDown).Offset(1, 0).Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"AF64:AF78\").Select\n    Selection.Copy\n    Range(\"A64\").End(xlDown).Offset(1, 0).Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"AG64:AG78\").Select\n    Selection.Copy\n    Range(\"A64\").End(xlDown).Offset(1, 0).Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"AH64:AH78\").Select\n    Selection.Copy\n    Range(\"A64\").End(xlDown).Offset(1, 0).Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"AI64:AI78\").Select\n    Selection.Copy\n    Range(\"A64\").End(xlDown).Offset(1, 0).Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"AJ64:AJ78\").Select\n    Selection.Copy\n    Range(\"A64\").End(xlDown).Offset(1, 0).Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"AK64:AK78\").Select\n    Selection.Copy\n    Range(\"A64\").End(xlDown).Offset(1, 0).Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"AL64:AL78\").Select\n    Selection.Copy\n    Range(\"A64\").End(xlDown).Offset(1, 0).Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"AM64:AM78\").Select\n    Selection.Copy\n    Range(\"A64\").End(xlDown).Offset(1, 0).Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"AN64:AN78\").Select\n    Selection.Copy\n    Range(\"A64\").End(xlDown).Offset(1, 0).Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"AO64:AO78\").Select\n    Selection.Copy\n    Range(\"A64\").End(xlDown).Offset(1, 0).Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"AP64:AP78\").Select\n    Selection.Copy\n    Range(\"A64\").End(xlDown).Offset(1, 0).Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"AQ64:AQ78\").Select\n    Selection.Copy\n    Range(\"A64\").End(xlDown).Offset(1, 0).Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"AR64:AR78\").Select\n    Selection.Copy\n    Range(\"A64\").End(xlDown).Offset(1, 0).Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"AS64:AS78\").Select\n    Selection.Copy\n    Range(\"A64\").End(xlDown).Offset(1, 0).Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"AT64:AT78\").Select\n    Selection.Copy\n    Range(\"A64\").End(xlDown).Offset(1, 0).Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"AU64:AU78\").Select\n    Selection.Copy\n    Range(\"A64\").End(xlDown).Offset(1, 0).Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"AV64:AV78\").Select\n    Selection.Copy\n    Range(\"A64\").End(xlDown).Offset(1, 0).Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"AW64:AW78\").Select\n    Selection.Copy\n    Range(\"A64\").End(xlDown).Offset(1, 0).Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"AX64:AX78\").Select\n    Selection.Copy\n    Range(\"A64\").End(xlDown).Offset(1, 0).Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"AY64:AY78\").Select\n    Selection.Copy\n    Range(\"A64\").End(xlDown).Offset(1, 0).Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"AZ64:AZ78\").Select\n    Selection.Copy\n    Range(\"A64\").End(xlDown).Offset(1, 0).Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"BA64:BA78\").Select\n    Selection.Copy\n    Range(\"A64\").End(xlDown).Offset(1, 0).Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"BB64:BB78\").Select\n    Selection.Copy\n    Range(\"A64\").End(xlDown).Offset(1, 0).Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"BC64:BC78\").Select\n    Selection.Copy\n    Range(\"A64\").End(xlDown).Offset(1, 0).Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"BD64:BD78\").Select\n    Selection.Copy\n    Range(\"A64\").End(xlDown).Offset(1, 0).Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"BE64:BE78\").Select\n    Selection.Copy\n    Range(\"A64\").End(xlDown).Offset(1, 0).Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"BF64:BF78\").Select\n    Selection.Copy\n    Range(\"A64\").End(xlDown).Offset(1, 0).Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"BG64:BG78\").Select\n    Selection.Copy\n    Range(\"A64\").End(xlDown).Offset(1, 0).Select\n    ActiveSheet.Paste\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"BH64:BH78\").Select\n    Selection.Copy\n    Range(\"A64\").End(xlDown).Offset(1, 0).Select\n    ActiveSheet.Paste\n\n    Range(\"A44\").End(xlDown).Select\n    ActiveWorkbook.Worksheets(\"Hiddensheet\").Sort.SortFields.Clear\n    ActiveWorkbook.Worksheets(\"Hiddensheet\").Sort.SortFields.Add(Range(\"A24\").End(xlDown), _\n        xlSortOnCellColor, xlAscending, , xlSortNormal).SortOnValue.Color = RGB(252, _\n        213, 180)\n    ActiveWorkbook.Worksheets(\"Hiddensheet\").Sort.SortFields.Add(Range(\"A24\").End(xlDown), _\n        xlSortOnCellColor, xlAscending, , xlSortNormal).SortOnValue.Color = RGB(216, _\n        228, 188)\n    ActiveWorkbook.Worksheets(\"Hiddensheet\").Sort.SortFields.Add(Range(\"A24\").End(xlDown), _\n        xlSortOnCellColor, xlAscending, , xlSortNormal).SortOnValue.Color = RGB(230, _\n        184, 183)\n    ActiveWorkbook.Worksheets(\"Hiddensheet\").Sort.SortFields.Add(Range(\"A24\").End(xlDown), _\n        xlSortOnCellColor, xlAscending, , xlSortNormal).SortOnValue.Color = RGB(0, _\n        255, 0)\n    ActiveWorkbook.Worksheets(\"Hiddensheet\").Sort.SortFields.Add(Range(\"A24\").End(xlDown), _\n        xlSortOnCellColor, xlAscending, , xlSortNormal).SortOnValue.Color = RGB(184, _\n        204, 228)\n    ActiveWorkbook.Worksheets(\"Hiddensheet\").Sort.SortFields.Add(Range(\"A24\").End(xlDown), _\n        xlSortOnCellColor, xlAscending, , xlSortNormal).SortOnValue.Color = RGB(204, _\n        192, 218)\n    ActiveWorkbook.Worksheets(\"Hiddensheet\").Sort.SortFields.Add(Range(\"A24\").End(xlDown), _\n        xlSortOnCellColor, xlAscending, , xlSortNormal).SortOnValue.Color = RGB(196, _\n        189, 151)\n    ActiveWorkbook.Worksheets(\"Hiddensheet\").Sort.SortFields.Add(Range(\"A24\").End(xlDown), _\n        xlSortOnCellColor, xlAscending, , xlSortNormal).SortOnValue.Color = RGB(217, _\n        217, 217)\n    ActiveWorkbook.Worksheets(\"Hiddensheet\").Sort.SortFields.Add(Range(\"A24\").End(xlDown), _\n        xlSortOnCellColor, xlAscending, , xlSortNormal).SortOnValue.Color = RGB(255, _\n        255, 0)\n    ActiveWorkbook.Worksheets(\"Hiddensheet\").Sort.SortFields.Add(Range(\"A24\").End(xlDown), _\n        xlSortOnCellColor, xlAscending, , xlSortNormal).SortOnValue.Color = RGB(255, _\n        192, 0)\n    ActiveWorkbook.Worksheets(\"Hiddensheet\").Sort.SortFields.Add(Range(\"A24\").End(xlDown), _\n        xlSortOnCellColor, xlAscending, , xlSortNormal).SortOnValue.Color = RGB(146, _\n        208, 80)\n    ActiveWorkbook.Worksheets(\"Hiddensheet\").Sort.SortFields.Add(Range(\"A24\").End(xlDown), _\n        xlSortOnCellColor, xlAscending, , xlSortNormal).SortOnValue.Color = RGB(0, _\n    176, 80)\n    ActiveWorkbook.Worksheets(\"Hiddensheet\").Sort.SortFields.Add(Range(\"A24\").End(xlDown), _\n        xlSortOnCellColor, xlAscending, , xlSortNormal).SortOnValue.Color = RGB(0, _\n    176, 240)\n    ActiveWorkbook.Worksheets(\"Hiddensheet\").Sort.SortFields.Add(Range(\"A24\").End(xlDown), _\n        xlSortOnCellColor, xlAscending, , xlSortNormal).SortOnValue.Color = RGB(255, _\n    0, 0)\n    ActiveWorkbook.Worksheets(\"Hiddensheet\").Sort.SortFields.Add(Range(\"A24\").End(xlDown), _\n        xlSortOnCellColor, xlAscending, , xlSortNormal).SortOnValue.Color = RGB(112, _\n    48, 160)\n\n    With ActiveWorkbook.Worksheets(\"Hiddensheet\").Sort\n        .SetRange Range(\"A64:A963\")\n        .Header = xlGuess\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n\n    Sheets(\"Hiddensheet\").Select\n    Range(\"A64:A159\").Select\n    Selection.Copy\n    Sheets(\"Import\").Select\n    Range(\"C2\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\n    Sheets(\"Import\").Select\n    Range(\"A2:F97\").Select\n    ActiveWorkbook.Worksheets(\"Import\").Sort.SortFields.Clear\n    ActiveWorkbook.Worksheets(\"Import\").Sort.SortFields.Add Key:=Range(\"A2:A97\") _\n        , SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n    With ActiveWorkbook.Worksheets(\"Import\").Sort\n        .SetRange Range(\"A2:T97\")\n        .Header = xlGuess\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n    Range(\"A1:A97\").Select\n    Selection.Delete Shift:=xlToLeft\n    Columns(\"A:F\").Select\n    Cells.EntireColumn.AutoFit\n\n\n    Sheets(\"HiddenSheet\").Visible = False\n</code></pre>\n\n<p>I need to repeat the part that copies the next column and pastes it at the bottom of the A column 95 times, I would really appreciate some help on the loop.</p>\n\n<p>How could I go about this?</p>\n"}, {"tags": ["excel", "vba", "sumifs"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1541581370, "post_id": 53186206, "comment_id": 93261884, "body": "Please include the code you already have tried in your question. Also it is necessary that you ask a question to that code and tell where you got stuck or errors. Reading <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> might help to improve your question. \u2022 Also why do you need VBA if there is a <code>=SUMIFS</code> formula you can use?"}, {"owner": {"reputation": 95, "user_id": 10358101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d60e9e6ac30ec05b48e43401e89ef076?s=128&d=identicon&r=PG&f=1", "display_name": "NHure92", "link": "https://stackoverflow.com/users/10358101/nhure92"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1541581971, "post_id": 53186206, "comment_id": 93262204, "body": "Hi, I&#39;ve edited and included my code. My code currently provides a sum total for column K on each worksheet and embeds the active worksheet into an outlook email and sends it out. As for codes for sumif, I&#39;ve been reading but have been unable to find anything thus far which is why I&#39;m here looking for possible solutions. The VBA has been requested by management, it is out of my control"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1541582903, "post_id": 53186206, "comment_id": 93262693, "body": "First of all you should read and apply: <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a> \u2022 At least for me it is still very unclear what exactly you try to sum (to less information, see also <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>). But have a look at the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheetfunction.sumifs\" rel=\"nofollow noreferrer\">WorksheetFunction.SumIfs Method</a>"}, {"owner": {"reputation": 1112, "user_id": 7354796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7efd450f69bda421b8348f3f694ae621?s=128&d=identicon&r=PG&f=1", "display_name": "OwlsSleeping", "link": "https://stackoverflow.com/users/7354796/owlssleeping"}, "edited": false, "score": 1, "creation_date": 1541585605, "post_id": 53186206, "comment_id": 93264065, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/52850307/vba-sum-totals-to-a-master-worksheet\">VBA - sum totals to a master worksheet</a>"}, {"owner": {"reputation": 1112, "user_id": 7354796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7efd450f69bda421b8348f3f694ae621?s=128&d=identicon&r=PG&f=1", "display_name": "OwlsSleeping", "link": "https://stackoverflow.com/users/7354796/owlssleeping"}, "edited": false, "score": 1, "creation_date": 1541585714, "post_id": 53186206, "comment_id": 93264112, "body": "The same question has been asked daily for weeks. If this is materially different to those other questions please focus on the specific point that needs help."}], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1541614601, "creation_date": 1541614601, "answer_id": 53195434, "question_id": 53186206, "link": "https://stackoverflow.com/questions/53186206/sumif-across-entire-workbook/53195434#53195434", "title": "SUMIF across entire workbook", "body": "<p>I don't think you even need VBA for this task.  Something like this should do it for you.</p>\n\n<pre><code>=SUMPRODUCT(SUMIF(INDIRECT(\"'\"&amp;sheets&amp;\"'!\"&amp;\"rng\"),criteria,INDIRECT(\"'\"&amp;sheets&amp;\"'!\"&amp;\"sumrng\")))\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/MzLKq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MzLKq.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 95, "user_id": 10358101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d60e9e6ac30ec05b48e43401e89ef076?s=128&d=identicon&r=PG&f=1", "display_name": "NHure92", "link": "https://stackoverflow.com/users/10358101/nhure92"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 321, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1586877713, "creation_date": 1541581134, "last_edit_date": 1541582700, "question_id": 53186206, "link": "https://stackoverflow.com/questions/53186206/sumif-across-entire-workbook", "title": "SUMIF across entire workbook", "body": "<p>Have been looking to solve this issue for a work spreadsheet but yet to find a solution. My workbook currently includes daily stock activity per client on individual worksheets (worksheets titled '5.9.2018, 6.9.2018, 7.9.2018 and so forth). The workbook also contains a master worksheet which is designed to provide weekly and monthly summaries of these daily worksheets (screenshot of master sheet below):</p>\n\n<p><a href=\"https://i.stack.imgur.com/VFitt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VFitt.png\" alt=\"master\"></a></p>\n\n<p>What I would like to do is incorporate a sumifs or similar function into my vba which will use the client name from the master sheet as a reference and check pre-determined columns across each daily worksheet to produce those monthly and weekly figures. Any guidance on how to incorporate this into a VBA would be greatly appreciated as I am a relative newcomer to VBA and have not been able to find the solution on my own.</p>\n\n<p>Thank you</p>\n\n<p>Edit: Current VBA included below</p>\n\n<pre><code>Sub AutoSum()\n    Dim wscount As Long\n    Dim i As Long\n    wscount = ActiveWorkbook.Worksheets.Count\n\n    For i = 1 To wscount\n        Sheets(i).Select\n        Range(\"K4\").Select\n        Selection.End(xlDown).Select\n        ActiveCell.Offset(2, 0).Select\n\n        Dim cel1 As String, cel2 As String\n        cel1 = ActiveCell.Offset(-2, 0).End(xlUp).Address\n        cel2 = ActiveCell.Offset(-1).Address\n        ActiveCell.Value = \"=sum(\" &amp; (cel1) &amp; \":\" &amp; (cel2) &amp; \")\"\n    Next i\n\n    Dim rng As Range\n    Dim OutApp As Object\n    Dim OutMail As Object\n\n    Set rng = Nothing\n    On Error Resume Next\n\n    Set rng = Selection.SpecialCells(xlCellTypeVisible)\n\n    On Error GoTo 0\n\n    If rng Is Nothing Then\n        MsgBox \"The selection is not a range or the sheet is protected\" &amp; _\n           vbNewLine &amp; \"please correct and try again.\", vbOKOnly\n        Exit Sub\n    End If\n\n    With Application\n        .EnableEvents = False\n        .ScreenUpdating = False\n    End With\n\n    Set OutApp = CreateObject(\"Outlook.Application\")\n    Set OutMail = OutApp.CreateItem(0)\n\n    On Error Resume Next\n    With OutMail\n        .To =\n        .CC = \"\"\n        .BCC = \"\"\n        .Subject = \"Today's Trades\" &amp; Date\n        .HTMLBody = RangetoHTML(rng)\n        .Send   'or use .Display\n    End With\n    On Error GoTo 0\n\n    With Application\n        .EnableEvents = True\n        .ScreenUpdating = True\n    End With\n\n    Set OutMail = Nothing\n    Set OutApp = Nothing\nEnd Sub\n\n\nFunction RangetoHTML(rng As Range)\n    Dim fso As Object\n    Dim ts As Object\n    Dim TempFile As String\n    Dim TempWB As Workbook\n\n    TempFile = Environ$(\"temp\") &amp; \"\\\" &amp; Format(Now, \"dd-mm-yy h-mm-ss\") &amp; \".htm\"\n\n    rng.Copy\n    Set TempWB = Workbooks.Add(1)\n    With TempWB.Sheets(1)\n        .Cells(1).PasteSpecial Paste:=8\n        .Cells(1).PasteSpecial xlPasteValues, , False, False\n        .Cells(1).PasteSpecial xlPasteFormats, , False, False\n        .Cells(1).Select\n        Application.CutCopyMode = False\n        On Error Resume Next\n        .DrawingObjects.Visible = True\n        .DrawingObjects.Delete\n        On Error GoTo 0\n    End With\n\n    With TempWB.PublishObjects.Add( _\n         SourceType:=xlSourceRange, _\n         Filename:=TempFile, _\n         Sheet:=TempWB.Sheets(1).Name, _\n         source:=TempWB.Sheets(1).UsedRange.Address, _\n         HtmlType:=xlHtmlStatic)\n        .Publish (True)\n    End With\n\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n    Set ts = fso.GetFile(TempFile).OpenAsTextStream(1, -2)\n    RangetoHTML = ts.readall\n    ts.Close\n    RangetoHTML = Replace(RangetoHTML, \"align=center x:publishsource=\", _\n                          \"align=left x:publishsource=\")\n\n    TempWB.Close savechanges:=False\n\n    Kill TempFile\n\n    Set ts = Nothing\n    Set fso = Nothing\n    Set TempWB = Nothing\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": false, "score": 0, "last_activity_date": 1541580634, "creation_date": 1541580634, "answer_id": 53186074, "question_id": 53185707, "link": "https://stackoverflow.com/questions/53185707/combine-2-worksheet-change-events/53186074#53186074", "title": "Combine 2 Worksheet_Change events", "body": "<p>Try this:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    If Target.Count &gt; 1 Then Exit Sub\n    Dim lr As Long\n    lr = Range(\"B\" &amp; Rows.Count).End(xlUp).row\n\n    Application.ScreenUpdating = False\n\n    If Not Intersect(Target, Range(\"G2\")) Is Nothing Then\n        Range(\"Z7:Z\" &amp; lr) = \"=ISERROR(MATCH(G$2,B7:O7,0))\"\n        Range(\"Z7\", Range(\"Z\" &amp; Rows.Count).End(xlUp)).AutoFilter 1, False\n        Call activate_button_31\n\n    ElseIf Not Intersect(Target, Range(\"G3\")) Is Nothing Then\n        Range(\"Q7:Q\" &amp; lr) = \"=ISERROR(MATCH(G$3,B7:O7,0))\"\n        Range(\"Q7\", Range(\"Q\" &amp; Rows.Count).End(xlUp)).AutoFilter 1, False\n        Call activate_button_40\n    End If\n\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "is_accepted": false, "score": 0, "last_activity_date": 1541580971, "creation_date": 1541580971, "answer_id": 53186161, "question_id": 53185707, "link": "https://stackoverflow.com/questions/53185707/combine-2-worksheet-change-events/53186161#53186161", "title": "Combine 2 Worksheet_Change events", "body": "<p>One way to combine the routines:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim lr As Long\n\n    On Error GoTo Terminate\n    If Target.Count &gt; 1 Then GoTo Terminate\n    xlQuiet True\n    lr = Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n\n    If Not Intersect(Target, Range(\"G2\")) Is Nothing Then\n        With Range(\"Z7:Z\" &amp; lr)\n            .Formula = \"=ISERROR(MATCH(G$2,B7:O7,0))\"\n            .AutoFilter 1, False\n        End With\n        xlQuiet False\n        Call activate_button_31\n    ElseIf Not Intersect(Target, Range(\"G3\")) Is Nothing Then\n        With Range(\"Q7:Q\" &amp; lr)\n            .Formula = \"=ISERROR(MATCH(G$3,B7:O7,0))\"\n            .AutoFilter 1, False\n        End With\n        xlQuiet False\n        Call activate_button_40\n    End If\n\nTerminate:\n    If err Then\n        Debug.Print \"Error\", err.Number, err.Description\n        err.clear\n    End If\n    xlQuiet False\n\nEnd Sub\n\nPrivate Sub xlQuiet(Optional ByVal b As Boolean)\n    With Application\n        .ScreenUpdating = Not b\n        .EnableEvents = Not b\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6484491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e6692694e2890bc1443bd663a1b4ead?s=128&d=identicon&r=PG&f=1", "display_name": "Coenie", "link": "https://stackoverflow.com/users/6484491/coenie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1586402494, "creation_date": 1541578935, "last_edit_date": 1586402494, "question_id": 53185707, "link": "https://stackoverflow.com/questions/53185707/combine-2-worksheet-change-events", "title": "Combine 2 Worksheet_Change events", "body": "<p>I have two Worksheet_Change event subs that work perfectly on their own, however I need to combine these to test the conditions of either of two ranges \"G2\" or G3\". I have tried all the options in search, but just cannot get this to work. I would appreciate any assistance or advise.\nBelow are the two Subs:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    If Intersect(Target, Range(\"G2\")) Is Nothing Then Exit Sub\n    If Target.Count &gt; 1 Then Exit Sub\n\n          Dim lr As Long\n          lr = Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n\n    Application.ScreenUpdating = False\n\n          Range(\"Z7:Z\" &amp; lr) = \"=ISERROR(MATCH(G$2,B7:O7,0))\"\n          Range(\"Z7\", Range(\"Z\" &amp; Rows.Count).End(xlUp)).AutoFilter 1, False\n\n    Application.ScreenUpdating = True\n    Call activate_button_31\n\n\nEnd Sub\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\n    If Intersect(Target, Range(\"G3\")) Is Nothing Then Exit Sub\n    If Target.Count &gt; 1 Then Exit Sub\n\n          Dim lr As Long\n          lr = Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n\n    Application.ScreenUpdating = False\n\n          Range(\"Q7:Q\" &amp; lr) = \"=ISERROR(MATCH(G$3,B7:O7,0))\"\n          Range(\"Q7\", Range(\"Q\" &amp; Rows.Count).End(xlUp)).AutoFilter 1, False\n\n    Application.ScreenUpdating = True\n    Call activate_button_40\n\n\nEnd Sub\n</code></pre>\n\n<p>Please let me know should you require any further information.</p>\n\n<p>Kind Regards</p>\n\n<p>Coenie</p>\n"}, {"tags": ["excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1541580961, "post_id": 53185546, "comment_id": 93261702, "body": "Please include in your question: Which error in which line?"}, {"owner": {"reputation": 2465, "user_id": 2570277, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0483cce5f2ea53671a36477fed79898b?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/2570277/nick"}, "edited": false, "score": 2, "creation_date": 1541583424, "post_id": 53185546, "comment_id": 93262934, "body": "Do you have microsoft access installed on the computer you are running this from?"}, {"owner": {"reputation": 7, "user_id": 10489030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8984472387c640076b1647fe4d5e558?s=128&d=identicon&r=PG&f=1", "display_name": "O.Gum", "link": "https://stackoverflow.com/users/10489030/o-gum"}, "edited": false, "score": 0, "creation_date": 1541598487, "post_id": 53185546, "comment_id": 93270253, "body": "no MS Access is not installed on this Computer. Im accessing it via Citrix."}], "owner": {"reputation": 7, "user_id": 10489030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8984472387c640076b1647fe4d5e558?s=128&d=identicon&r=PG&f=1", "display_name": "O.Gum", "link": "https://stackoverflow.com/users/10489030/o-gum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 96, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1541582617, "creation_date": 1541578020, "last_edit_date": 1541582617, "question_id": 53185546, "link": "https://stackoverflow.com/questions/53185546/open-access-forms-over-citrix-in-excel-vba", "title": "Open Access Forms over Citrix in Excel VBA", "body": "<p>I want to open a Access Forms over Citrix in Excel with VBA. I tried it with the below code but it gives me a runtime error at the second line. How can i Open Citrix Programms with VBA ? </p>\n\n<pre><code>Dim Access As Object\nSet Access = CreateObject(\"Access.Application\")\nAccess.Visible = True\nAccess.OpenCurrentDatabase \"U:\\Database1.accdb\"\nMsgBox \"Datenbank ge\u00f6ffnet.\"\nAccess.CloseCurrentDatabase\nSet Access = Nothing\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula", "excel-2016"], "comments": [{"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 2, "creation_date": 1541578315, "post_id": 53185476, "comment_id": 93260611, "body": "You can treat <code>.Activate</code> in the same way as <code>.Select</code> - here is the <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">&quot;How to avoid using Select in Excel VBA&quot;</a> guide - things like <code>EMS.Range(&quot;J19&quot;).Copy</code> or <code>wb1.ActiveSheet.Range(&quot;J34&quot;).PasteSpecial xlPasteValues</code>"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1541581193, "post_id": 53185476, "comment_id": 93261803, "body": "I additionally recommend to avoid <code>ActiveWorkbook</code> too by setting the opened workbook to the variable directly: <code>Set wb2 = Workbooks.Open(&quot;HR Headcount Report 2018 Australia SEPTEMBER.XLSX&quot;)</code>. \u2022 Also you should specify the workbook for <b>every</b> sheet <code>Set EMS = wb2.Worksheets(&quot;Employee Movement Summary&quot;)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 10589030, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Cct9Pt6X5oA/AAAAAAAAAAI/AAAAAAAAACI/BmOa2lugBpQ/photo.jpg?sz=128", "display_name": "Lim Hong En", "link": "https://stackoverflow.com/users/10589030/lim-hong-en"}, "edited": false, "score": 0, "creation_date": 1541640668, "post_id": 53186270, "comment_id": 93289218, "body": "Thanks for the help! I have managed to remove all <code>.Activate</code> from my sub. However, my screen still flickers when I run my macro with a button as it switches between workbooks. Is there a way to fix this?"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 15, "user_id": 10589030, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Cct9Pt6X5oA/AAAAAAAAAAI/AAAAAAAAACI/BmOa2lugBpQ/photo.jpg?sz=128", "display_name": "Lim Hong En", "link": "https://stackoverflow.com/users/10589030/lim-hong-en"}, "edited": false, "score": 0, "creation_date": 1541667720, "post_id": 53186270, "comment_id": 93296874, "body": "@LimHongEn you could make the workbook invisible until you finish copying data over then make it visible again, something like <code>wb2.Visible = False</code>"}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": true, "score": 1, "last_activity_date": 1541581393, "creation_date": 1541581393, "answer_id": 53186270, "question_id": 53185476, "link": "https://stackoverflow.com/questions/53185476/screen-flickers-even-when-application-screenupdating-is-false/53186270#53186270", "title": "Screen flickers even when Application.ScreenUpdating is False", "body": "<p>The code below will guide you somewhat to remove all your Activate statements:</p>\n\n<pre><code>Sub UpdateData()\n\nApplication.ScreenUpdating = False\nDebug.Print Application.ScreenUpdating\nApplication.DisplayStatusBar = False\nApplication.Calculation = xlManual\nApplication.EnableEvents = False\n\nDim wb1 As Workbook\nDim wb2 As Workbook\nDim ws1 As Worksheet\nDim EMS As Worksheet\nDim TD As Worksheet\nDim JV1 As Worksheet\n\nSet wb1 = ThisWorkbook\nSet ws1 = ActiveSheet\n'better to refer to the actual sheet name rather than the Active Sheet, amend as required\n\nSet wb2 = Workbooks.Open(\"HR Headcount Report 2018 Australia SEPTEMBER.XLSX\")\n\nSet EMS = wb2.Sheets(\"Employee Movement Summary\")\nEMS.Range(\"J19\").Copy\nws1.Range(\"J34\").PasteSpecial xlPasteValues\n\nSet TD = wb2.Sheets(\"Turnover Dashboard\")\nTD.Range(\"J44\").Copy\nws1.Range(\"J2\").PasteSpecial xlPasteValues\nTD.Range(\"J47\").Copy\nws1.Range(\"J3\").PasteSpecial xlPasteValues\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 10589030, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Cct9Pt6X5oA/AAAAAAAAAAI/AAAAAAAAACI/BmOa2lugBpQ/photo.jpg?sz=128", "display_name": "Lim Hong En", "link": "https://stackoverflow.com/users/10589030/lim-hong-en"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 985, "favorite_count": 0, "accepted_answer_id": 53186270, "answer_count": 1, "score": 1, "last_activity_date": 1586402530, "creation_date": 1541577645, "last_edit_date": 1586402530, "question_id": 53185476, "link": "https://stackoverflow.com/questions/53185476/screen-flickers-even-when-application-screenupdating-is-false", "title": "Screen flickers even when Application.ScreenUpdating is False", "body": "<p>Hi i am new to VBA so i apologies in advance if my code looks bad. My problem is, I would like to stop my screen from flickering when i run my macro using a button. However, I have tried multiple codes to solve this but to no avail. I have tried <code>Application.ScreenUpdating = False</code> at the start of my sub and switched back to True before ending the sub but the screen still flickers. Is there any other solution for this? Thanks in advance!</p>\n\n<p>Code:</p>\n\n<pre><code>Sub UpdateData()\n\nApplication.ScreenUpdating = False\nDebug.Print Application.ScreenUpdating\nApplication.DisplayStatusBar = False\nApplication.Calculation = xlManual\nApplication.EnableEvents = False\n\nDim wb1 As Workbook\nDim wb2 As Workbook\nDim ws1 As Worksheet\nDim EMS As Worksheet\nDim TD As Worksheet\nDim JV1 As Worksheet\n\nSet wb1 = ActiveWorkbook\n\nWorkbooks.Open (\"HR Headcount Report 2018 Australia SEPTEMBER.XLSX\")\nSet wb2 = ActiveWorkbook\nSet EMS = Sheets(\"Employee Movement Summary\")\nEMS.Activate\nRange(\"J19\").Copy\nwb1.Activate\nRange(\"J34\").PasteSpecial xlPasteValues\n\nwb2.Activate\nSet TD = Sheets(\"Turnover Dashboard\")\nTD.Activate\nRange(\"J44\").Copy\nwb1.Activate\nRange(\"J2\").PasteSpecial xlPasteValues\nwb2.Activate\nRange(\"J47\").Copy\nwb1.Activate\nRange(\"J3\").PasteSpecial xlPasteValues\n</code></pre>\n\n<p>P.S. This is the first half of my code. I suspect that the multiple use of <code>.Activate</code> is causing the problem. If that is the case, how can I rewrite my code to avoid using <code>.Activate</code>?</p>\n"}, {"tags": ["vba", "autocad"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10003330, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-i4CMMBEqm0c/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1t05dXN43meyjkdKwDei-VJIXTRw/mo/photo.jpg?sz=128", "display_name": "Nghia Chau", "link": "https://stackoverflow.com/users/10003330/nghia-chau"}, "edited": false, "score": 0, "creation_date": 1541639885, "post_id": 53195646, "comment_id": 93289037, "body": "Thanks for your reply. I&#39;ll try to do as your instruction."}, {"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "reply_to_user": {"reputation": 1, "user_id": 10003330, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-i4CMMBEqm0c/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1t05dXN43meyjkdKwDei-VJIXTRw/mo/photo.jpg?sz=128", "display_name": "Nghia Chau", "link": "https://stackoverflow.com/users/10003330/nghia-chau"}, "edited": false, "score": 0, "creation_date": 1542408898, "post_id": 53195646, "comment_id": 93571754, "body": "@NghiaChau You&#39;re most welcome. Please mark my answer as the solution if it answers your question, so that the question appears as resolved to others browsing the site."}], "tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": false, "score": 0, "last_activity_date": 1541615521, "creation_date": 1541615521, "answer_id": 53195646, "question_id": 53185237, "link": "https://stackoverflow.com/questions/53185237/renaming-dynamic-block-visibility-states-using-vba/53195646#53195646", "title": "Renaming Dynamic Block Visibility States using VBA", "body": "<p>In short, it is <strong>not</strong> possible to rename Dynamic Block Visibility States directly using the LISP or VBA API, without resorting to invoking standard AutoCAD commands, for example, using the AutoLISP <code>command</code> function, or <code>sendcommand</code> method.</p>\n\n<p>Dynamic Block Parameters contained within a block definition are not exposed to the ActiveX object model and therefore cannot be modified using Visual LISP or VBA.</p>\n\n<p>Such parameters <em>are</em> exposed to Vanilla AutoLISP by examining the DXF data stored within the Extension Dictionary of the <code>BLOCK_RECORD</code> entity, but such data cannot be modified using <code>entmod</code>, nor does it yield any relevant properties following conversion to an equivalent VLA-Object representation.</p>\n\n<hr>\n\n<p>For what it's worth, you can access the Dynamic Block Parameter DXF data using the following route through the AutoLISP API:</p>\n\n<p>First, obtain the <code>BLOCK</code> entity:</p>\n\n<pre class=\"lang-lisp prettyprint-override\"><code>(setq bl (tblobjname \"block\" \"YourBlockName\"))\n</code></pre>\n\n<p>Then obtain the parent <code>BLOCK_RECORD</code> entity:</p>\n\n<pre class=\"lang-lisp prettyprint-override\"><code>(setq br (cdr (assoc 330 (entget bl))))\n</code></pre>\n\n<p>Now obtain the Extension Dictionary from DXF group 360 (additional checks for the presence of <code>\"{ACAD_XDICTIONARY\"</code> against DXF group 102 should be used in production code):</p>\n\n<pre class=\"lang-lisp prettyprint-override\"><code>(setq d1 (cdr (assoc 360 (entget br))))\n</code></pre>\n\n<p>Now search this dictionary for the <code>ACAD_ENHANCEDBLOCK</code> entry:</p>\n\n<pre class=\"lang-lisp prettyprint-override\"><code>(setq d2 (dictsearch d1 \"acad_enhancedblock\"))\n</code></pre>\n\n<p>This will yield the DXF data for the <code>ACAD_EVALUATION_GRAPH</code> entity.</p>\n\n<p>You can then iterate over the DXF group 360 within the DXF data to obtain the DXF data for each Dynamic Block Parameter found within the block definition, e.g.:</p>\n\n<pre class=\"lang-lisp prettyprint-override\"><code>_$ (foreach dxf d2 (if (= 360 (car dxf)) (print (cdr (assoc 0 (entget (cdr dxf)))))))\n\n\"BLOCKPOLARPARAMETER\" \n\"BLOCKPOLARGRIP\" \n\"BLOCKGRIPLOCATIONCOMPONENT\" \n\"BLOCKGRIPLOCATIONCOMPONENT\" \n\"BLOCKPOLARSTRETCHACTION\" \n\"BLOCKFLIPPARAMETER\" \n\"BLOCKFLIPGRIP\" \n\"BLOCKGRIPLOCATIONCOMPONENT\" \n\"BLOCKGRIPLOCATIONCOMPONENT\" \n\"BLOCKGRIPLOCATIONCOMPONENT\" \n\"BLOCKFLIPACTION\" \n\"BLOCKVISIBILITYPARAMETER\" \n\"BLOCKVISIBILITYGRIP\" \n\"BLOCKGRIPLOCATIONCOMPONENT\" \n\"BLOCKGRIPLOCATIONCOMPONENT\"\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10003330, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-i4CMMBEqm0c/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1t05dXN43meyjkdKwDei-VJIXTRw/mo/photo.jpg?sz=128", "display_name": "Nghia Chau", "link": "https://stackoverflow.com/users/10003330/nghia-chau"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 490, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1541805596, "creation_date": 1541576426, "last_edit_date": 1541805596, "question_id": 53185237, "link": "https://stackoverflow.com/questions/53185237/renaming-dynamic-block-visibility-states-using-vba", "title": "Renaming Dynamic Block Visibility States using VBA", "body": "<p>How can I change or rename visibility states for a dynamic block in AutoCAD using VBA, similar to clicking <code>RENAME</code> in the Visibility State dialog box which appears when issuing the <code>BVSTATE</code> command in the Block Editor?</p>\n\n<p>Thanks so much for your help.</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 1300, "user_id": 7602468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3XKX5.gif?s=128&g=1", "display_name": "p._phidot_", "link": "https://stackoverflow.com/users/7602468/p-phidot"}, "edited": false, "score": 0, "creation_date": 1558925275, "post_id": 53185209, "comment_id": 99246719, "body": "Does the proposed solution works for you?"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 10616897, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNcrc.jpg?s=128&g=1", "display_name": "SDiab", "link": "https://stackoverflow.com/users/10616897/sdiab"}, "edited": false, "score": 0, "creation_date": 1559290778, "post_id": 53201064, "comment_id": 99381484, "body": "Thank you Michal I will try it . :)"}], "tags": [], "owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "is_accepted": false, "score": 1, "last_activity_date": 1541647059, "creation_date": 1541647059, "answer_id": 53201064, "question_id": 53185209, "link": "https://stackoverflow.com/questions/53185209/how-to-write-a-formula-that-skip-other-criterias-and-apply-only-the-chosen-valu/53201064#53201064", "title": "How to write a formula that skip other criteria`s and apply only the chosen values from the drop down list?", "body": "<p><a href=\"https://i.stack.imgur.com/KHD3e.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KHD3e.png\" alt=\"enter image description here\"></a></p>\n\n<p>I used named ranges, you can also hardcode the ranges or use a table:</p>\n\n<pre><code> =SUMPRODUCT(\n (IF(ISBLANK(F2),MATCH(\"*\",phase,0),F2=phase))*\n (IF(ISBLANK(G2),MATCH(\"*\",sprint,0),G2=sprint))*\n (IF(ISBLANK(H2),MATCH(\"*\",Item,0),H2=Item))*\n (IF(ISBLANK(I2),MATCH(\"*\",type,0),I2=type)))\n</code></pre>\n\n<p>Cheers,\nMichal</p>\n"}], "owner": {"reputation": 31, "user_id": 10616897, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNcrc.jpg?s=128&g=1", "display_name": "SDiab", "link": "https://stackoverflow.com/users/10616897/sdiab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1586402566, "creation_date": 1541576310, "last_edit_date": 1592644375, "question_id": 53185209, "link": "https://stackoverflow.com/questions/53185209/how-to-write-a-formula-that-skip-other-criterias-and-apply-only-the-chosen-valu", "title": "How to write a formula that skip other criteria`s and apply only the chosen values from the drop down list?", "body": "<p>I have 2 sheets in excel file with two tables:</p>\n<p><strong>Sheet 1:</strong>\nTable 1 having columns [A,B,C,D]</p>\n<p><strong>Comment:</strong>\nThis table is a filtered table containing multiple rows having multiple values\nI can filter directly from the header drop down to get the specific row related to the criteria I choose in the headers.</p>\n<p><strong>Sheet 2:</strong>\nTable 2 having Columns [A,B,C,D] and Cell [A4]</p>\n<p><strong>Comment:</strong>\nThis table is a Filter Summary table for each column contain a drop down list containing a list of values , the user can choose one in each column to filter the table 1 in a formula located inside the Cell A4.\n<strong>Cell A4</strong> containing the formula that will calculate the number of rows in table 1, after applying the criteria chosen from the table 2.</p>\n<p><strong>Question</strong>\nIf i want to filter by two column or three columns only and not by all the columns located inside the table 2, how to write a formula that skip other criteria`s and apply only the chosen values from the table 2?</p>\n<p><strong>Code:</strong>\nCell A4 contains the following code:\n=COUNTIFS(QA_ITEMS!A:A,$A$4,QA_ITEMS!B:B,$B$4,QA_ITEMS!C:C,$C$4,QA_ITEMS!D:D,$D$4)</p>\n<p>Attached for your reference.\n<a href=\"https://i.stack.imgur.com/om2yj.png\" rel=\"nofollow noreferrer\">Adding-Multiple Criteria in a formula dynamically</a></p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "answers": [{"comments": [{"owner": {"reputation": 655, "user_id": 2670777, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d69cb2368cc72bf16229fdddf46e557a?s=128&d=identicon&r=PG", "display_name": "joehua", "link": "https://stackoverflow.com/users/2670777/joehua"}, "edited": false, "score": 0, "creation_date": 1541582990, "post_id": 53186041, "comment_id": 93262729, "body": "Thanks but I don&#39;t use Office 365. I use Excel 2010."}], "tags": [], "owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "is_accepted": false, "score": 1, "last_activity_date": 1541580472, "creation_date": 1541580472, "answer_id": 53186041, "question_id": 53185093, "link": "https://stackoverflow.com/questions/53185093/adapt-small-indexfrequency-to-vba/53186041#53186041", "title": "adapt SMALL(,INDEX(FREQUENCY..) to VBA", "body": "<p>There are several options here - the simplest option, <em>if</em> you have Office 365, is to use the <a href=\"https://support.office.com/en-us/article/MINIFS-function-6ca1ddaa-079b-4e74-80cc-72eef32e6599\" rel=\"nofollow noreferrer\"><code>MINIFS</code></a> function, like so: <code>WorksheetFunction.MinIf(myarr, myarr, \"&lt;&gt;0\")</code></p>\n\n<p>But, since you haven't tagged the question as <a href=\"/questions/tagged/office365\" class=\"post-tag\" title=\"show questions tagged &#39;office365&#39;\" rel=\"tag\">office365</a>, I will use a different option:</p>\n\n<pre><code>Private Function MinPositive(Values As Variant) As Variant\n    MinPositive = CVErr(xlErrValue)\n    On Error GoTo FuncErr\n    Dim TempVal As Double, Pointer As Long\n    If IsArray(Values) Then\n        TempVal = WorksheetFunction.Max(Values) 'High bound\n        If TempVal &lt;= 0 Then Exit Function 'No values greater than 0\n        For Pointer = LBound(Values) To UBound(Values)\n            If CDbl(Values(Pointer)) &gt; 0 And CDbl(Values(Pointer)) &lt; TempVal Then\n                TempVal = CDbl(Values(Pointer)) 'Swap for lower number\n            End If\n        Next Pointer\n    End If\n    MinPositive = TempVal 'Output the Min value greater than 0\nFuncErr:\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 655, "user_id": 2670777, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d69cb2368cc72bf16229fdddf46e557a?s=128&d=identicon&r=PG", "display_name": "joehua", "link": "https://stackoverflow.com/users/2670777/joehua"}, "edited": false, "score": 1, "creation_date": 1541583024, "post_id": 53186284, "comment_id": 93262746, "body": "Works like a charm. Thank you. Would you be kind enough to explain what&#39;s going on in the formula?"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1541581436, "creation_date": 1541581436, "answer_id": 53186284, "question_id": 53185093, "link": "https://stackoverflow.com/questions/53185093/adapt-small-indexfrequency-to-vba/53186284#53186284", "title": "adapt SMALL(,INDEX(FREQUENCY..) to VBA", "body": "<p>Not entirely sure what you are doing but you can do MIN IF inside of Evaluate with an array</p>\n\n<pre><code>Option Explicit\nPublic Sub GetMinGreaterThanZero()\n    Dim arr()\n    arr = Array(0, 4, 2, 1)\n    Debug.Print Evaluate(\"=MIN(IF({\" &amp; Join(arr, \";\") &amp; \"}&gt;0,{\" &amp; Join(arr, \";\") &amp; \"}))\")\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 655, "user_id": 2670777, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d69cb2368cc72bf16229fdddf46e557a?s=128&d=identicon&r=PG", "display_name": "joehua", "link": "https://stackoverflow.com/users/2670777/joehua"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 53186284, "answer_count": 2, "score": 0, "last_activity_date": 1586402602, "creation_date": 1541575649, "last_edit_date": 1586402602, "question_id": 53185093, "link": "https://stackoverflow.com/questions/53185093/adapt-small-indexfrequency-to-vba", "title": "adapt SMALL(,INDEX(FREQUENCY..) to VBA", "body": "<p>I'm trying to find the minimum non-zero value. I found the following example on the web and tried to adapt it to VBA with no avail.</p>\n\n<pre><code>=SMALL((A1,C1,E1),INDEX(FREQUENCY((A1,C1,E1),0),1)+1)\n</code></pre>\n\n<p>Here is my adaption:</p>\n\n<pre><code>myarr = Array(A, B, C)\n.Range(Cells(D, 1), Cells(WorksheetFunction.Small(myarr,WorksheetFunction.Index(WorksheetFunction.Frequency(myarr, 0), 1) + 1),1)).EntireRow.Delete\n</code></pre>\n\n<p>where A, B, C, D are four integers.</p>\n\n<p>In the debug window, the SMALL function returned \"out of context\" and as soon as this line of code was executed, the compiler exit the sub as if an \"Exit Sub\" command was executed.</p>\n\n<p>My guess is FREQUENCY function is not working. How to make it work?</p>\n\n<p>For only three values, it's easy to use a non-function solution such as nested IFs but I'm interested in how to make the functions work as I might need it in the future.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1541574414, "post_id": 53184798, "comment_id": 93259162, "body": "Are both numbers in the same cell?"}, {"owner": {"reputation": 209, "user_id": 3761714, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/59b4e7ad9accdee54411a1c49907c03f?s=128&d=identicon&r=PG&f=1", "display_name": "Luis", "link": "https://stackoverflow.com/users/3761714/luis"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1541574641, "post_id": 53184798, "comment_id": 93259239, "body": "Yes, but I can use text to column and separate them easily. They are all integers between 1 and 81"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1541574861, "post_id": 53184798, "comment_id": 93259309, "body": "Add two new columns using MIN() and MAX()  to re-order each pair of numbers (making &quot;like&quot; pairs identical), copy/paste values and then use Remove Duplicates on the new columns."}, {"owner": {"reputation": 209, "user_id": 3761714, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/59b4e7ad9accdee54411a1c49907c03f?s=128&d=identicon&r=PG&f=1", "display_name": "Luis", "link": "https://stackoverflow.com/users/3761714/luis"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1541575879, "post_id": 53184798, "comment_id": 93259687, "body": "Thanks! You could post that as the answer."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1541605434, "creation_date": 1541605434, "answer_id": 53192855, "question_id": 53184798, "link": "https://stackoverflow.com/questions/53184798/remove-permutations-from-list-using-vba-excel/53192855#53192855", "title": "Remove permutations from list using vba/Excel", "body": "<p>Add two new columns using <code>MIN()</code> and <code>MAX()</code> to re-order each pair of numbers (making \"like\" pairs identical), copy/paste values and then use Remove Duplicates on the new columns</p>\n"}], "owner": {"reputation": 209, "user_id": 3761714, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/59b4e7ad9accdee54411a1c49907c03f?s=128&d=identicon&r=PG&f=1", "display_name": "Luis", "link": "https://stackoverflow.com/users/3761714/luis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 53192855, "answer_count": 1, "score": -1, "last_activity_date": 1586402637, "creation_date": 1541573888, "last_edit_date": 1586402637, "question_id": 53184798, "link": "https://stackoverflow.com/questions/53184798/remove-permutations-from-list-using-vba-excel", "title": "Remove permutations from list using vba/Excel", "body": "<p>I have a list like this one:</p>\n\n<pre><code>0,4\n1,1\n1,2\n1,3\n2,1\n2,3\n3,1\n3,2\n4,0\n</code></pre>\n\n<p>Where 0,4 is just a permutation of 4,0 - 1,2 a permutation of 2,1 and so on. \nSo I want to get rid of what I then consider duplicates.\nAny idea would be appreciated!</p>\n"}, {"tags": ["vba", "xmlhttprequest"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1541575138, "post_id": 53184176, "comment_id": 93259422, "body": "Those two code samples don&#39;t do the same thing?  The first one uses request headers and the second one sends the data in the request as the POST body."}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1541578264, "post_id": 53184176, "comment_id": 93260589, "body": "Try to remove all <code>.SetRequestHeader</code> from the VBA code and use <code>oRequest.Send &quot;user-id=haissk&amp;api-key=key&amp;number=1234567890&quot;</code>, don&#39;t forget to <a href=\"https://stackoverflow.com/a/34601029/2165759\">URLEncode</a> each values before concatenation."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1541579797, "post_id": 53184176, "comment_id": 93261203, "body": "Did you check the response status? Did you get a 403?"}], "owner": {"reputation": 216, "user_id": 4058178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c08c970d8d2a990cc5389945d60b73?s=128&d=identicon&r=PG&f=1", "display_name": "Sam K", "link": "https://stackoverflow.com/users/4058178/sam-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 115, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1541580641, "creation_date": 1541569742, "last_edit_date": 1541580641, "question_id": 53184176, "link": "https://stackoverflow.com/questions/53184176/how-to-make-a-async-call-to-rest-api-and-pass-encoded-http-content-from-vba", "title": "How to make a Async call to Rest API and pass encoded HTTP Content from VBA?", "body": "<p>I am using the below code to get a response from API, however, I am only getting a blank response. Can someone help here</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim oDic As New Dictionary\nDim oRequest As New MSXML2.XMLHTTP\n' Set oRequest = CreateObject(\"WinHttp.WinHttpRequest.5.1\")\n\noRequest.Open \"POST\", \"https://neutrinoapi.com/phone-validate\", True\n\noRequest.SetRequestHeader \"user-id\", \"haissk\"\noRequest.SetRequestHeader \"api-key\", \"key\"\noRequest.SetRequestHeader \"number\", \"1234567890\"\n\noRequest.Send \n\nWhile oRequest.readyState &lt;&gt; 4\n    DoEvents\nWend\n\nMsgBox oRequest.ResponseText\n</code></pre>\n\n<p>I've also tried </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>oRequest.Send EncodeBase64(\"user-id=haissk&amp;api-key=key=1234567890\")\n</code></pre>\n\n<p>When I try the same from C# it just works fine. Below is the C# code</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>using (var client = new HttpClient())\n{\n    var req = new List&lt;KeyValuePair&lt;string, string&gt;&gt;();\n    req.Add(new KeyValuePair&lt;string, string&gt;(\"user-id\", \"haissk\"));\n    req.Add(new KeyValuePair&lt;string, string&gt;(\"api-key\", \"key\"));\n    req.Add(new KeyValuePair&lt;string, string&gt;(\"number\", \"1234567890\"));\n\n    var content = new FormUrlEncodedContent(req);\n    var response = await client.PostAsync(\"https://neutrinoapi.com/phone-validate\", content);\n    var responseStr = await response.Content.ReadAsStringAsync();\n\n    JObject result = JObject.Parse(responseStr);\n}\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-access", "sharepoint", "ms-word"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1541574320, "post_id": 53184062, "comment_id": 93259122, "body": "What is the path used for saving, and how does it compare to the working Word path ?"}, {"owner": {"reputation": 3, "user_id": 10616671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28789935fc278fa9e8d256675aaa179a?s=128&d=identicon&r=PG&f=1", "display_name": "J Morton", "link": "https://stackoverflow.com/users/10616671/j-morton"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1541598245, "post_id": 53184062, "comment_id": 93270098, "body": "The path to the SP folder is the same. Only the file names are different."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1541607246, "post_id": 53184062, "comment_id": 93275699, "body": "Please use the <a href=\"https://stackoverflow.com/posts/53184062/edit\">edit</a> link under the question to add the code for <code>GetSPAddress</code>. I do notice that for Word you pass a value to this method, but not for the code that&#39;s not working?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1541611907, "post_id": 53184062, "comment_id": 93278210, "body": "If you <code>Debug.Print</code> the Excel path can you save to that location manually ?"}, {"owner": {"reputation": 3, "user_id": 10616671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28789935fc278fa9e8d256675aaa179a?s=128&d=identicon&r=PG&f=1", "display_name": "J Morton", "link": "https://stackoverflow.com/users/10616671/j-morton"}, "edited": false, "score": 0, "creation_date": 1541613038, "post_id": 53184062, "comment_id": 93278749, "body": "Yes, I can save to it manually."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10616671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28789935fc278fa9e8d256675aaa179a?s=128&d=identicon&r=PG&f=1", "display_name": "J Morton", "link": "https://stackoverflow.com/users/10616671/j-morton"}, "edited": false, "score": 0, "creation_date": 1541615039, "post_id": 53195281, "comment_id": 93279650, "body": "I tried this and I get an error Runtime error &#39;1004&#39;. The file could not be accessed. Try one of the following: Make sure the specified folder exists. ..."}, {"owner": {"reputation": 3, "user_id": 10616671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28789935fc278fa9e8d256675aaa179a?s=128&d=identicon&r=PG&f=1", "display_name": "J Morton", "link": "https://stackoverflow.com/users/10616671/j-morton"}, "edited": false, "score": 0, "creation_date": 1541615249, "post_id": 53195281, "comment_id": 93279745, "body": "The path being saved to goes to is https:\\\\eu001-sp.shell.com\\sites\\AAAAA9233\\TestForLIR\\Test4.&zwnj;&#8203;xls"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 3, "user_id": 10616671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28789935fc278fa9e8d256675aaa179a?s=128&d=identicon&r=PG&f=1", "display_name": "J Morton", "link": "https://stackoverflow.com/users/10616671/j-morton"}, "edited": false, "score": 0, "creation_date": 1541636947, "post_id": 53195281, "comment_id": 93288306, "body": "<code>https:\\\\ </code> or <code>https:&#47;&#47; </code> ?  I was able to run a SaveAs from excel into a Sharepoint library using the same type of path, so it can work..."}, {"owner": {"reputation": 3, "user_id": 10616671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28789935fc278fa9e8d256675aaa179a?s=128&d=identicon&r=PG&f=1", "display_name": "J Morton", "link": "https://stackoverflow.com/users/10616671/j-morton"}, "edited": false, "score": 0, "creation_date": 1541720985, "post_id": 53195281, "comment_id": 93323421, "body": "Tim made the correct remark. I feel silly, but I was using \\ instead of /. As soon as I made that change it worked fine. Thanks!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1541614061, "creation_date": 1541614061, "answer_id": 53195281, "question_id": 53184062, "link": "https://stackoverflow.com/questions/53184062/access-vba-automation-able-to-save-word-document-to-sharepoint-but-not-excel-spr/53195281#53195281", "title": "Access VBA automation able to save Word document to Sharepoint but not Excel spreadsheet", "body": "<p>The only thing I can think of to suggest is to set a workbook variable when you open the report so you can be absolutely sure which file is getting saved (though that in itself shouldn't cause an error...)</p>\n\n<pre><code>Dim wb As Object   '&lt;&lt;&lt;\nSet oExcelApp = CreateObject(\"Excel.Application\")\noExcelApp.Visible = True\noExcelApp.AskToUpdateLinks = False\noExcelApp.DisplayAlerts = False\nSet wb = oExcelApp.Workbooks.Open(\"c:\\apps\\\" &amp; strReportName) '&lt;&lt;&lt;\nSPAddress = GetSPAddress()\nwb.SaveAs SPAddress &amp; strReportName '&lt;&lt;&lt;\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10616671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28789935fc278fa9e8d256675aaa179a?s=128&d=identicon&r=PG&f=1", "display_name": "J Morton", "link": "https://stackoverflow.com/users/10616671/j-morton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 665, "favorite_count": 0, "accepted_answer_id": 53195281, "answer_count": 1, "score": -1, "last_activity_date": 1541614061, "creation_date": 1541568872, "last_edit_date": 1541611640, "question_id": 53184062, "link": "https://stackoverflow.com/questions/53184062/access-vba-automation-able-to-save-word-document-to-sharepoint-but-not-excel-spr", "title": "Access VBA automation able to save Word document to Sharepoint but not Excel spreadsheet", "body": "<p>I have an Access database that creates files and saves them to Sharepoint on an internal network. In two cases the files are Word documents and saving them to Sharepoint works fine. Two of the files are Excel spreadsheets, and saving them using save or savecopy is not working. The last file is PowerPoint, and saving it is also failing.</p>\n\n<p>The Word save that works looks like this:</p>\n\n<pre><code>Set objWord = New Word.Application\nSet objDoc = objWord.Documents.Add\nobjWord.Visible = True\nSet objSelection = objWord.Selection\nSet objRange = objDoc.Range\n\nCreation of document\n\nDim SPAddress As String\nSPAddress = GetSPAddress(iProjectId) &amp; \"ProjectFactSheet_\" &amp; sSiteName &amp; \"_\" &amp; Format(Now(), \"yyyymmddhhnnss\") &amp; \".docx\"\nobjDoc.SaveAs SPAddress\n</code></pre>\n\n<p>The Excel save that fails looks like this:</p>\n\n<pre><code>Set oExcelApp = CreateObject(\"Excel.Application\")\noExcelApp.Visible = True\noExcelApp.AskToUpdateLinks = False\noExcelApp.DisplayAlerts = False\noExcelApp.Workbooks.Open (\"c:\\apps\\\" &amp; strReportName)\nSPAddress = GetSPAddress()\noExcelApp.ActiveWorkbook.SaveAs SPAddress &amp; strReportName\n</code></pre>\n\n<ul>\n<li>savecopyas also gets an error.</li>\n</ul>\n\n<p>This fails with the error filename cannot be accessed. The file may be corrupted, located on a server that is not responding or read only.</p>\n\n<pre><code>Public Function GetSPAddress(Optional lngQuaID As Long) As String\n    GetSPAddress = \"\"\n\n    If IsNull(lngQuaID) Or lngQuaID = 0 Then\n        GetSPAddress = DLookup(\"SPBasePath\", \"AppData\")\n    Else\n        If IsNull(DLookup(\"[SPPath]\", \"QualificationLog\", \"[QuaID] = \" &amp; lngQuaID)) Then\n            GetSPAddress = DLookup(\"SPBasePath\", \"AppData\")\n        Else\n            GetSPAddress = DLookup(\"[SPPath]\", \"QualificationLog\", \"[QuaID] = \" &amp; lngQuaID)\n        End If\n    End If\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "ms-word", "shapes"], "answers": [{"tags": [], "owner": {"reputation": 314, "user_id": 10497887, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EenXU.jpg?s=128&g=1", "display_name": "Gen.L", "link": "https://stackoverflow.com/users/10497887/gen-l"}, "is_accepted": false, "score": 1, "last_activity_date": 1541606403, "creation_date": 1541606403, "answer_id": 53193175, "question_id": 53184003, "link": "https://stackoverflow.com/questions/53184003/word-vba-after-insert-a-page-break-my-text-box-on-page1-all-go-to-page2/53193175#53193175", "title": "Word VBA: After Insert a page break, My text box on page1 all go to page2", "body": "<p>I found a solution by myself, I post here, hopefully can help other people have similar question.</p>\n\n<p>If you have no text in your page, only shapes, the shapes anchor to the page beginning character position.   if you use<code>Selection.InsertBreak</code> to insert a new blank page, the anchor will go to the new second page.</p>\n\n<p>So you can just put one line of code before you insertbreak, which is <code>Selection.EndKey</code>, Then everything should be fine. </p>\n"}], "owner": {"reputation": 314, "user_id": 10497887, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EenXU.jpg?s=128&g=1", "display_name": "Gen.L", "link": "https://stackoverflow.com/users/10497887/gen-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 455, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1541607094, "creation_date": 1541568381, "last_edit_date": 1541607094, "question_id": 53184003, "link": "https://stackoverflow.com/questions/53184003/word-vba-after-insert-a-page-break-my-text-box-on-page1-all-go-to-page2", "title": "Word VBA: After Insert a page break, My text box on page1 all go to page2", "body": "<p>I am writing MS Word VBA code to generate word doc(the doc is purely generated by code).</p>\n\n<p>At the very beginning, I placed a bunch of TextBoxes on page 1 of the document with some content in it using VBA Code <code>ActiveDocument.Shapes.AddTextBox()...</code>.</p>\n\n<p>After finished all the textboxes task on page 1, now I want to insert a new page at the end, and begin putting more Textboxes on page 2 using VBA code</p>\n\n<p>I use <code>Selection.InsertBreak wdPageBreak</code> at the end of my current code to get the second page. Bear in mind, currently, there is no text on page 1, only several Textboxes.</p>\n\n<p>What I get from the above wdPageBreak is a new Page, but all my finished TextBoxes go to the 2nd page.</p>\n\n<p>What I want is after InsertBreak, I have a blank new page2 ready to be worked on, and the finished TextBoxes stay where they were(page 1)</p>\n\n<p>I have around more than 50 TextBoxes to work on. So I will need this trick again and again.</p>\n\n<p>New to Word VBA Programming, very appreciate for your time to answer my stupid question.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1541569684, "post_id": 53183846, "comment_id": 93257885, "body": "Where there is sheet(1) change that to 2 or 3 to do the respective sheets."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1541575779, "post_id": 53183846, "comment_id": 93259655, "body": "avoid too long lines. No one likes horizontal scrolling"}], "owner": {"reputation": 1, "user_id": 10616572, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SfS2VL3fC9U/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbD9hzX6uK0bt2TgtAEJqF4LaKMMCQ/mo/photo.jpg?sz=128", "display_name": "cynthia ", "link": "https://stackoverflow.com/users/10616572/cynthia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1586402673, "creation_date": 1541567188, "last_edit_date": 1586402673, "question_id": 53183846, "link": "https://stackoverflow.com/questions/53183846/run-macro-on-2-or-3-pages", "title": "Run macro on 2 or 3 pages", "body": "<p>I was given a macro to use, it works fine with 1 pg worksheets but some of my worksheets have 2 or 3 pages. Any idea how I can change the code to do more than 1 page? Any feedback is appreciated. Here is the macro code:</p>\n\n<pre><code>Dim wksAufruf As Worksheet\n\nDim wkbAufruf As Workbook\n\nDim wksActive As Worksheet\n\nDim varDatei As Variant\n\nOption Explicit\n\nSub DateiAufrufen()\nDim s As String\n\nSet wksActive = ThisWorkbook.Sheets(1)\ns = wksActive.Cells(3, 2).Value\n'ChDrive                ' drive specification\n    ChDir s             ' path specification for the selection dialog\"\n    varDatei = Application.GetOpenFilename(\"Excel-Dateien (*.xls*), *.xl*\")\n    Set wkbAufruf = Workbooks.Open(varDatei, False, True)\n    Set wksAufruf = wkbAufruf.Sheets(1)\nEnd Sub\nSub DateiErstellen()\n\n'###admin read out\n\nDim out As String           'output folder path\nDim head As String          'row of column-headlines\nDim filetype As String      'output filetype\n\nout = wksActive.Cells(5, 2).Value     'output folder path\nhead = wksActive.Cells(7, 2).Value\nIf Right(out, 1) &lt;&gt; \"\\\" Then\n    out = out &amp; \"\\\"\nEnd If\n\nfiletype = wksActive.Cells(9, 2).Value\nfiletype = Replace(filetype, \".\", \"\")\n\n'###create new file\n\nDim FSyObjekt As Object     'to create new file\n\nApplication.ScreenUpdating = False\nSet FSyObjekt = CreateObject(\"Scripting.FileSystemObject\")\nWorkbooks.Add\nSet wksActive = ActiveWorkbook.Sheets(1)\n\n'###pre-work copy data\n\nDim name As String\nDim r As Integer\nDim c As Integer\nDim r1 As Integer           'row wksActive\nDim i1 As Integer           'row wksAufruf\nDim i2 As Integer           'column wksAufruf\nDim rel As Integer          'first column released\n\n\nr = wksAufruf.UsedRange.Rows.Count          'last row wksAufruf\nc = wksAufruf.UsedRange.Columns.Count       'last column wksAufruf\nname = wkbAufruf.name                       'file name\nr1 = 1\n\nFor i2 = 1 To c\n    If wksAufruf.Cells(head - 1, i2) Like \"*RELEASED*\" Then\n        rel = i2\n        Exit For\n    End If\nNext i2\n\n\n'###Copy Data\nDim s As String\n\nFor i1 = 1 To r\n    For i2 = 1 To c\n        If i1 = head Then\n            s = wksAufruf.Cells(i1, i2) &amp; \" \" &amp; wksAufruf.Cells(i1 + 1, i2)       'because column headlines in Hawker's lists stretch over two rows\n            If i2 = c Then\n                i1 = i1 + 1\n            End If\n        Else\n            s = wksAufruf.Cells(i1, i2).Value\n        End If\n        wksActive.Cells(r1, i2) = s\n    Next i2\n    r1 = r1 + 1\nNext i1\n\nwkbAufruf.Close False       'close without saving\n\nActiveWorkbook.Sheets(2).Delete     'close cheets 2 and 3 of the newly created worksheet\nActiveWorkbook.Sheets(2).Delete\n\n'delete upper row\nFor i1 = 1 To head - 1\n    Rows(\"1\").EntireRow.Delete\nNext i1\n\n'delete bottom row\nr = wksActive.UsedRange.Rows.Count\nFor r1 = 1 To r\n    If wksActive.Cells(r1, 3).Value = \"\" Then\n        Exit For                                'find row to delete\n    End If\nNext r1\n\ni1 = r1\nFor r1 = i1 To r\n    wksActive.Rows(i1).EntireRow.Delete\nNext r1\n\n\nFor i2 = 1 To c                                                                                                              'delete empty columns\n    If wksActive.Cells(1, i2).Value = \"\" Or wksActive.Cells(1, i2).Value = \" \" Or wksActive.Cells(1, i2).Value = \"  \" _\n    Or wksActive.Cells(1, i2).Value = \"   \" Or wksActive.Cells(1, i2).Value = \"    \" Or wksActive.Cells(1, i2).Value = \"     \" Then\n        wksActive.Columns(i2).EntireColumn.Delete\n        If i2 &lt;= rel Then\n            rel = rel - 1\n        End If\n\n        If i2 = c Then\n            Exit For\n        End If\n\n        i2 = i2 - 1\n        c = c - 1\n    End If\nNext i2\n\n'released and received\nFor i2 = 1 To wksActive.UsedRange.Columns.Count\n    s = \"\"\n    If i2 &gt; 1 And i2 &lt; rel Then\n        s = \"RECEIVED \" &amp; wksActive.Cells(1, i2)\n    ElseIf i2 &gt;= rel And i2 &lt; wksActive.UsedRange.Columns.Count Then\n        s = \"RELEASED \" &amp; wksActive.Cells(1, i2)\n    Else\n        s = wksActive.Cells(1, i2)\n    End If\n    wksActive.Cells(1, i2) = s\nNext i2\n\nModul2.ColumnManagement wksActive\n\nDim k As Integer\nk = InStr(1, name, \".\")\nname = Left(name, k - 1)\n\nActiveWorkbook.SaveAs out &amp; \"FD_\" &amp; name &amp; \".\" &amp; filetype\nActiveWorkbook.Close\n\nEnd Sub\n\nSub main()\n    DateiAufrufen\n    DateiErstellen\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1541560725, "post_id": 53183105, "comment_id": 93256283, "body": "You could probably just paste it over to a helper column and use excel\u2019s built-in <code>remove duplicates</code> button. I know it\u2019s not as neat but it\u2019s probably a bit simpler than what you\u2019re doing."}, {"owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1541561685, "post_id": 53183105, "comment_id": 93256454, "body": "Those are manual process and apply right now but I am trying automate reports ."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1541562775, "post_id": 53183105, "comment_id": 93256659, "body": "Then yeah you could use a dictionary and since you only have two values it fits neatly as a key value pair"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1541564084, "post_id": 53183105, "comment_id": 93256878, "body": "Pivot table seems the way to go. Can you elaborate on why a pivot table won\u2019t work? You can do analysis with GETPIVOTDATA or refer to the cells in pivot table manually just like you would any other table.... seems like your question is synonymous to \u201cHow can I build this pivot table without using a pivot table?\u201d"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1541565024, "post_id": 53183105, "comment_id": 93257032, "body": "Nonetheless, you could write a macro to do this. One way to do so would be to take @Marcucciboy2 first comment and convert that to a macro to generate your unique list. UDF is not ideal here unless you plan to provide an index to the unique value you want."}, {"owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "edited": false, "score": 0, "creation_date": 1541579108, "post_id": 53183105, "comment_id": 93260910, "body": "I already use macro. Also uses formulas with helper column and those works fine for me. But I was trying do without helper column."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 1, "creation_date": 1541593207, "post_id": 53183105, "comment_id": 93267573, "body": "Show us your current macro"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1541594900, "post_id": 53183105, "comment_id": 93268406, "body": "For more control over your output, you could also use <code>Power Pivot</code> in Excel 2010+ aka <code>Get&amp;Transform</code> in Excel 2016+"}], "answers": [{"tags": [], "owner": {"reputation": 76, "user_id": 10225649, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6tjzX.png?s=128&g=1", "display_name": "InExSu VBAGem t2d2", "link": "https://stackoverflow.com/users/10225649/inexsu-vbagem-t2d2"}, "is_accepted": false, "score": 0, "last_activity_date": 1541569154, "creation_date": 1541569154, "answer_id": 53184097, "question_id": 53183105, "link": "https://stackoverflow.com/questions/53183105/extract-unique-months-from-dates-with-year/53184097#53184097", "title": "Extract unique months from dates with year", "body": "<p>In the pivot table, click on the cell containing the date, select Group from the menu, then select the Months step.</p>\n"}, {"comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1541686213, "post_id": 53190151, "comment_id": 93306770, "body": "Nice, same approach I imagined."}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 1, "last_activity_date": 1541597022, "last_edit_date": 1541597022, "creation_date": 1541596264, "answer_id": 53190151, "question_id": 53183105, "link": "https://stackoverflow.com/questions/53183105/extract-unique-months-from-dates-with-year/53190151#53190151", "title": "Extract unique months from dates with year", "body": "<p>For this example i have use Sheet1 and the results paste in Sheet2</p>\n\n<p>Try:</p>\n\n<pre><code>Public Sub Get_Unique_Count_Paste_Array()\n\nDim Ob As Object\nDim rng As Range\nDim Item As Variant\nDim str As String\nDim r As Long\nDim Date_ As String\nDim Amount_ As Double\n\nr = 1\n\nSet Ob = CreateObject(\"scripting.dictionary\")\n\n\nLR = Sheet1.Range(\"A\" &amp; Sheet1.Rows.Count).End(xlUp).Row\n\nFor Each rng In Sheet1.Range(\"A2:A\" &amp; LR)\n    Date_ = Format(rng.Value, \"mmm-yy\")\n    Amount_ = Right(rng.Offset(0, 1).Value, Len(rng.Offset(0, 1).Value) - 1)\n\n    If Len(Date_) &gt; 0 Then\n        str = Date_\n        Ob(Date_) = Ob(Date_) + Amount_\n    End If\nNext rng\n\nFor Each Item In Ob.keys\n\n    With Worksheets(\"Sheet2\")\n\n        .Cells(r, 1).Value = Item\n        With .Cells(r, 2)\n            .Value = Ob(Item)\n            .NumberFormat = \"[$$-en-US]#,##0.00\"\n        End With\n\n    End With\n\n    r = r + 1\n\nNext Item\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 0, "last_activity_date": 1541606639, "creation_date": 1541606639, "answer_id": 53193264, "question_id": 53183105, "link": "https://stackoverflow.com/questions/53183105/extract-unique-months-from-dates-with-year/53193264#53193264", "title": "Extract unique months from dates with year", "body": "<h1>Monthify</h1>\n\n<p>Before using the code, <strong>study the customize section carefully</strong>. A serious limitation is that each of the two column pairs contains <strong>adjacent</strong> columns, which is implemented in order to skip looping through the range.</p>\n\n<pre><code>Option Explicit\n\nSub Monthify()\n\n'**** Customize BEGIN ******************\n  Const cStrDateCol As String = \"B\"     ' Column Letter of the Date\n  Const cStrSalesCol As String = \"C\"    ' Column Letter of the Sales\n  Const cStrMonthCol As String = \"E\"    ' Column Letter of the Resulting Month\n  Const cStrTotalCol As String = \"F\"    ' Column Letter of the Resulting Sales\n  Const cLngFirstRow As Long = 4        ' First Row of Initial Data\n  Const cLngFirstRowResult As Long = 4  ' First Row of Resulting Data\n  Const cLngLastRow As Long = 0         ' Last Row (If 0, it is calculated.)\n  Const cStrSheet = \"Sheet1\"            ' Sheet Name. If \"\", then ActiveSheet.\n  Const cStrMonth1 As String = \"MMM\"    ' Month Format Part 1\n  Const cStrMonth2 As String = \"-\"      ' Month Format Part 2\n  Const cStrMonth3 As String = \"YY\"     ' Month Format Part 3\n'**** Customize END ********************\n\n  Dim objWs As Worksheet\n\n  Dim arrInit As Variant      ' Initial Array\n  Dim arrResult As Variant    ' Resulting Array\n  Dim lngLastRow As Long      ' Last Row Calculator\n  Dim lngArr As Long          ' Array Row Counter\n  Dim lngArr2 As Long         ' Array Additional Sort Row Counter\n  Dim iArr As Integer         ' Array Columns Counter\n  Dim vntArr As Variant       ' Array Temporary Variable\n  Dim lngUnique As Long       ' (Unique) Months Count(er)\n'*******************************************************************************\n' Objects\n\n  ' In Workbook\n  With ThisWorkbook\n    If cStrSheet &lt;&gt; \"\" Then\n      Set objWs = .Worksheets(cStrSheet)\n     Else\n      Set objWs = .ActiveSheet\n    End If\n  End With\n\n  ' In Worksheet\n  With objWs\n    ' Define last row of data.\n    If cLngLastRow &lt;&gt; 0 Then ' Last row is defined.\n      lngLastRow = cLngLastRow\n     Else ' Last row isn't defined, has to be calculated.\n      If .Cells(.Rows.Count, cStrDateCol) = \"\" Then ' Last cell is empty.\n        lngLastRow = .Cells(.Rows.Count, cStrDateCol).End(xlUp).Row\n       Else ' Last cell is not empty.\n        lngLastRow = .Cells(.Rows.Count, cStrDateCol).Row\n      End If\n    End If\n    ' Paste data into array.\n    arrInit = Union(.Range( _\n        Cells(cLngFirstRow, cStrDateCol), _\n        Cells(lngLastRow, cStrDateCol)), .Range( _\n        Cells(cLngFirstRow, cStrSalesCol), _\n        Cells(lngLastRow, cStrSalesCol))).Value2\n  End With\n\n'*******************************************************************************\n' Arrays\n\n  ' Sort initial array by date ascending.\n  For lngArr = LBound(arrInit) To UBound(arrInit)\n    For lngArr2 = lngArr + 1 To UBound(arrInit)\n      If arrInit(lngArr, 1) &gt; arrInit(lngArr2, 1) Then\n        For iArr = 1 To 2\n          vntArr = arrInit(lngArr2, iArr)\n          arrInit(lngArr2, iArr) = arrInit(lngArr, iArr)\n          arrInit(lngArr, iArr) = vntArr\n        Next\n      End If\n    Next\n  Next\n\n  ' Convert date to months-year string.\n  For lngArr = LBound(arrInit) To UBound(arrInit)\n    arrInit(lngArr, 1) = WorksheetFunction.Proper(Format(arrInit(lngArr, 1), _\n    cStrMonth1)) &amp; cStrMonth2 &amp; Format(arrInit(lngArr, 1), cStrMonth3)\n  Next\n\n  ' Count the number of unique month-year strings to determine the resulting\n  ' array's size.\n  vntArr = \"\"\n  For lngArr = LBound(arrInit) To UBound(arrInit)\n    If vntArr &lt;&gt; arrInit(lngArr, 1) Then\n      vntArr = arrInit(lngArr, 1)\n      lngUnique = lngUnique + 1\n    End If\n  Next\n\n  ' Resize resulting array.\n  ReDim arrResult(1 To lngUnique, 1 To 2)\n\n  ' Write first column to resulting array.\n  vntArr = \"\"\n  lngUnique = 0\n  For lngArr = LBound(arrInit) To UBound(arrInit)\n    If vntArr &lt;&gt; arrInit(lngArr, 1) Then\n      vntArr = arrInit(lngArr, 1)\n      lngUnique = lngUnique + 1\n      arrResult(lngUnique, 1) = arrInit(lngArr, 1)\n    End If\n  Next\n\n  ' Write second column to resulting array.\n  For lngArr2 = LBound(arrResult) To UBound(arrResult)\n    vntArr = 0\n    For lngArr = LBound(arrInit) To UBound(arrInit)\n      If arrResult(lngArr2, 1) = arrInit(lngArr, 1) Then\n        vntArr = vntArr + arrInit(lngArr, 2)\n      End If\n    Next\n    arrResult(lngArr2, 2) = vntArr\n  Next\n\n'*******************************************************************************\n'Objects\n\n  ' Paste array into range.\n  With objWs\n    Union(.Range( _\n        Cells(cLngFirstRowResult, cStrMonthCol), _\n        Cells(cLngFirstRowResult + lngUnique - 1, cStrMonthCol)), .Range( _\n        Cells(cLngFirstRowResult, cStrTotalCol), _\n        Cells(cLngFirstRowResult + lngUnique - 1, cStrTotalCol))) = arrResult\n  End With\n\n  Set objWs = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 463, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1586402709, "creation_date": 1541560299, "last_edit_date": 1586402709, "question_id": 53183105, "link": "https://stackoverflow.com/questions/53183105/extract-unique-months-from-dates-with-year", "title": "Extract unique months from dates with year", "body": "<p>I have a list of date with daily sales value. I want to extract unique months from those dates so that I can prepare a report of monthly sales.</p>\n\n<pre><code>   Date      Sales\n--------------------\n07-09-2018   $3,000 \n08-09-2018   $2,500 \n09-10-2018   $2,800 \n10-10-2018   $2,700 \n11-11-2018   $2,500 \n12-12-2018   $3,200 \n13-12-2018   $2,900 \n14-08-2018   $2,750 \n15-08-2018   $2,875 \n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/YohIk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YohIk.png\" alt=\"enter image description here\"></a></p>\n\n<p>Right now I am using a helper column and combination of formulas to extract unique months. I can also do this with <code>Pivot Table</code>. But I need some analysis on these data because in my actual data there many columns and needs some other few reports. So, if anybody can help me with do these without helper column and <code>Pivot Table</code>. <code>UDF</code> is second choice if it is not possible with built in functions.</p>\n"}, {"tags": ["excel", "vba", "selenium"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10616242, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4ZqleYj4NUM/AAAAAAAAAAI/AAAAAAAAFlY/TojjweZelWk/photo.jpg?sz=128", "display_name": "Jim Dell", "link": "https://stackoverflow.com/users/10616242/jim-dell"}, "edited": false, "score": 0, "creation_date": 1541595538, "post_id": 53185212, "comment_id": 93268681, "body": "Thanks I will give it a try"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1541586767, "last_edit_date": 1541586767, "creation_date": 1541576321, "answer_id": 53185212, "question_id": 53182944, "link": "https://stackoverflow.com/questions/53182944/access-web-page-body-text-using-vba-selenium/53185212#53185212", "title": "Access web page body text using VBA &amp; Selenium", "body": "<p>You are not making it browser agnostic. You are simply widening the choice of browser to those supported via selenium basic. This brings some problems of its own which you are noticing. </p>\n\n<ol>\n<li>Folders containing the drivers must be on the environmental path or the path passed to selenium webdriver as an argument.</li>\n<li>You should use the latest Chrome browser and Chrome driver</li>\n<li>You cannot use the latest FireFox browser and driver. It is not supported. I think you need  <a href=\"https://github.com/florentbr/SeleniumBasic/issues/133\" rel=\"nofollow noreferrer\">FF v.46.0.1</a>.</li>\n<li>If using IE then zoom must be to 100%.</li>\n<li>I suggest browsing the issues pages of <a href=\"https://github.com/florentbr/SeleniumBasic/issues\" rel=\"nofollow noreferrer\">Github</a> for further known issues</li>\n<li>Heuristically, I have heard some banter about problems with Windows 10 and Selenium Basic - would be interested to know if anyone has got this working as I am not on that version.</li>\n</ol>\n\n<p>Review the <a href=\"https://github.com/florentbr/SeleniumBasic/blob/master/Examples/Excel/Examples.xlsm\" rel=\"nofollow noreferrer\">examples.xlsm</a> provided by <a href=\"https://github.com/florentbr/SeleniumBasic\" rel=\"nofollow noreferrer\">selenium basic GitHub site</a> to see which other browsers are supported (e.g. Opera, PhantomJS, FirefoxLight,CEF).</p>\n\n<p>With Chrome you can get the body text with this:</p>\n\n<pre><code>Option Explicit \nPublic Sub GetInfo()\n    Dim d As WebDriver, s As String\n    Set d = New ChromeDriver\n    Const URL = \"https://www.neutrinoapi.com/api/api-examples/python/\"\n\n    With d\n        .Start \"Chrome\"\n        .get URL\n        s = .FindElementByTag(\"body\").Text\n        Debug.Print s\n        .Quit\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>Other info:</strong> <a href=\"https://stackoverflow.com/a/52294259/6241235\">https://stackoverflow.com/a/52294259/6241235</a></p>\n"}], "owner": {"reputation": 3, "user_id": 10616242, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4ZqleYj4NUM/AAAAAAAAAAI/AAAAAAAAFlY/TojjweZelWk/photo.jpg?sz=128", "display_name": "Jim Dell", "link": "https://stackoverflow.com/users/10616242/jim-dell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1297, "favorite_count": 0, "accepted_answer_id": 53185212, "answer_count": 1, "score": 0, "last_activity_date": 1586402745, "creation_date": 1541558774, "last_edit_date": 1586402745, "question_id": 53182944, "link": "https://stackoverflow.com/questions/53182944/access-web-page-body-text-using-vba-selenium", "title": "Access web page body text using VBA &amp; Selenium", "body": "<p>I am trying to convert an <code>Excel macro</code> that currently uses Internet Explorer and use the following line of code to extract the web page\u2019s <code>&lt;body&gt;</code> text</p>\n\n<pre><code>x = .Document.DocumentElement.InnerText\n</code></pre>\n\n<p>Using the <code>Selenium</code> demo, I am able to produce a <code>jpg</code> of the page with <code>Chrome &amp; IE</code>, but <code>Firefox</code> just loads a blank page and <code>IE64 &amp; Edge</code> don\u2019t work on <code>Windows 10.</code></p>\n\n<p>I have been unable to find the proper VBA command with Selenium to copy the body text to variable \u201dx\u201d. I only want to read it.</p>\n\n<p>I am trying to do this to make my macro browser independent.</p>\n\n<p>The macro is for my use only.</p>\n\n<p>Jim</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 10453535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fd6e15058b39d1c10e6311277365ac2?s=128&d=identicon&r=PG&f=1", "display_name": "Sarah", "link": "https://stackoverflow.com/users/10453535/sarah"}, "edited": false, "score": 0, "creation_date": 1541600907, "post_id": 53187407, "comment_id": 93271622, "body": "Thank you so much. This is exactly what I was looking for!"}, {"owner": {"reputation": 67, "user_id": 10453535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fd6e15058b39d1c10e6311277365ac2?s=128&d=identicon&r=PG&f=1", "display_name": "Sarah", "link": "https://stackoverflow.com/users/10453535/sarah"}, "edited": false, "score": 0, "creation_date": 1541605960, "post_id": 53187407, "comment_id": 93274946, "body": "Is there a way to make this so that it only does it for specific rows?"}, {"owner": {"reputation": 491, "user_id": 10154892, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-zxWv-GwaUFs/AAAAAAAAAAI/AAAAAAAABNQ/k076JfSWJ-c/photo.jpg=k-s128", "display_name": "Gexas", "link": "https://stackoverflow.com/users/10154892/gexas"}, "reply_to_user": {"reputation": 67, "user_id": 10453535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fd6e15058b39d1c10e6311277365ac2?s=128&d=identicon&r=PG&f=1", "display_name": "Sarah", "link": "https://stackoverflow.com/users/10453535/sarah"}, "edited": false, "score": 0, "creation_date": 1541665740, "post_id": 53187407, "comment_id": 93295911, "body": "In my opinion, more or less everything possible, but sometimes it is to difficult to achieve and not worth the trouble. But to adjust this code to exclude some rows should not be to hard. Specify what do you mean by saying &quot;specific&quot;? Which rows should be excluded?"}], "tags": [], "owner": {"reputation": 491, "user_id": 10154892, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-zxWv-GwaUFs/AAAAAAAAAAI/AAAAAAAABNQ/k076JfSWJ-c/photo.jpg=k-s128", "display_name": "Gexas", "link": "https://stackoverflow.com/users/10154892/gexas"}, "is_accepted": true, "score": 0, "last_activity_date": 1541585735, "creation_date": 1541585735, "answer_id": 53187407, "question_id": 53182931, "link": "https://stackoverflow.com/questions/53182931/vba-add-row-values-until-they-are-greater-than-or-equal-to-x/53187407#53187407", "title": "VBA: Add row values until they are greater than or equal to X", "body": "<p>Try this. If I understood your request correctly, this should do the trick.</p>\n\n<pre><code>Option Explicit\nSub time()\n\nDim x As Long\nDim i As Long\nDim xTime As Double\nDim iTime As Double\nDim LastRow As Long\n\n'adjust worksheet and table names accordingly to mach yours\nLastRow = Worksheets(\"Sheet1\").Range(\"Table1\").Rows.Count\n\n    For x = LastRow + 1 To 2 Step -1\n        xTime = Cells(x, \"A\").Value + Cells(x, \"B\").Value\n        For i = x To 2 Step -1\n            iTime = Cells(i, \"A\").Value + Cells(i, \"B\").Value\n            If iTime - xTime = 1 Or iTime - xTime &gt; 1 Then\n                Cells(x, \"C\").Value = Cells(i, \"A\").Value\n                Cells(x, \"D\").Value = Cells(i, \"B\").Value\n                Exit For\n            End If\n            Next i\n        Next x\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 1, "last_activity_date": 1541595979, "creation_date": 1541595979, "answer_id": 53190065, "question_id": 53182931, "link": "https://stackoverflow.com/questions/53182931/vba-add-row-values-until-they-are-greater-than-or-equal-to-x/53190065#53190065", "title": "VBA: Add row values until they are greater than or equal to X", "body": "<p>For a formula only approach and using an extra column:  </p>\n\n<p>With your <code>Date and Time</code> table going from <code>A1:B10</code>.</p>\n\n<ul>\n<li>Add this formula to <code>C2</code> and drag down to <code>C10</code>:<br>\n<code>=SUM($A2,$B2)</code></li>\n<li>Add this formula to <code>D2</code> and drag down to <code>D10</code>:<br>\n<code>=IFERROR(INDEX($A$2:$A2,MATCH($C2+1,$C$2:$C2,-1)),\"\")</code>  </li>\n<li>Add this to <code>E2</code> and drag down:<br>\n<code>=IFERROR(INDEX($B$2:$B2,MATCH($C2+1,$C$2:$C2,-1)),\"\")</code>    </li>\n</ul>\n\n<p>If your date column contains the date &amp; time but is formatted to show just the date then you can change references to column <code>C</code> to column <code>A</code>.  </p>\n\n<pre><code>| Date       | Time  | Hidden           | Next Time over 24 Hrs                                 |                                                       |\n|------------|-------|------------------|-------------------------------------------------------|-------------------------------------------------------|\n| 15/04/2018 | 16:09 | =SUM($A2,$B2)    | =IFERROR(INDEX($A$2:$A2,MATCH($C2+1,$C$2:$C2,-1)),\"\") | =IFERROR(INDEX($B$2:$B2,MATCH($C2+1,$C$2:$C2,-1)),\"\") |\n| 15/04/2018 | 12:11 | 15/04/2018 12:11 |                                                       |                                                       |\n| 15/04/2018 | 06:10 | 15/04/2018 06:10 |                                                       |                                                       |\n| 14/04/2018 | 14:24 | 14/04/2018 14:24 |                                                       |                                                       |\n| 14/04/2018 | 06:10 | 14/04/2018 06:10 | 15/04/2018                                            | 06:10                                                 |\n| 13/04/2018 | 07:31 | 13/04/2018 07:31 | 14/04/2018                                            | 14:24                                                 |\n| 13/04/2018 | 07:31 | 13/04/2018 07:31 | 14/04/2018                                            | 14:24                                                 |\n| 13/04/2018 | 06:39 | 13/04/2018 06:39 | 14/04/2018                                            | 14:24                                                 |\n| 13/04/2018 | 06:10 | 13/04/2018 06:10 | 14/04/2018                                            | 06:10                                                 |\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 10453535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fd6e15058b39d1c10e6311277365ac2?s=128&d=identicon&r=PG&f=1", "display_name": "Sarah", "link": "https://stackoverflow.com/users/10453535/sarah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 1, "accepted_answer_id": 53187407, "answer_count": 2, "score": 1, "last_activity_date": 1541619249, "creation_date": 1541558689, "last_edit_date": 1541619249, "question_id": 53182931, "link": "https://stackoverflow.com/questions/53182931/vba-add-row-values-until-they-are-greater-than-or-equal-to-x", "title": "VBA: Add row values until they are greater than or equal to X", "body": "<p>I haven't been able to find anything on this so sorry if it has been asked before. <em>Edited</em></p>\n\n<p>I have a number of dates and times that are listed in a column and they have varying hours between them. \nStarting from the bottom (earliest date) I am looking to identify the next row that is over 24 hours away and have that value display under \"Next Time over 24 Hrs.\" Sample provided. </p>\n\n<pre><code>+------------+-------+--+-----------------------+-------+\n| Date       | Time  |  | Next Time over 24 Hrs |       |\n+------------+-------+--+-----------------------+-------+\n| 04/15/2018 | 16:09 |  | None                  | None  |\n+------------+-------+--+-----------------------+-------+\n| 04/15/2018 | 12:11 |  | None                  | None  |\n+------------+-------+--+-----------------------+-------+\n| 04/15/2018 | 06:10 |  | None                  | None  |\n+------------+-------+--+-----------------------+-------+\n| 04/14/2018 | 14:24 |  | 04/15/2018            | 16:09 |\n+------------+-------+--+-----------------------+-------+\n| 04/14/2018 | 06:10 |  | 04/15/2018            | 06:10 |\n+------------+-------+--+-----------------------+-------+\n| 04/13/2018 | 07:31 |  | 04/14/2018            | 14:24 |\n+------------+-------+--+-----------------------+-------+\n| 04/13/2018 | 07:31 |  | 04/14/2018            | 14:24 |\n+------------+-------+--+-----------------------+-------+\n| 04/13/2018 | 06:39 |  | 04/14/2018            | 14:24 |\n+------------+-------+--+-----------------------+-------+\n| 04/13/2018 | 06:10 |  | 04/14/2018            | 06:10 |\n+------------+-------+--+-----------------------+-------+\n</code></pre>\n\n<p>*Update: Final code used here</p>\n\n<pre><code>Sub test()\n\nDim x As Long\nDim i As Long\nDim xTime As Double\nDim iTime As Double\nDim LastRow As Long\n\nLastRow = Worksheets(\"Sheet1\").Cells(Rows.Count, \"A\").End(xlUp).Row\n\n         For x = LastRow + 1 To 2 Step -1\n          If Cells(x, \"F\") = \"VALUE\" Then\n            xTime = Cells(x, \"A\").Value + Cells(x, \"B\").Value\n            For i = x To 2 Step -1\n                iTime = Cells(i, \"A\").Value + Cells(i, \"B\").Value\n                If iTime - xTime = 1 Or iTime - xTime &gt; 1 Then\n                    Cells(x, \"R\").Value = Cells(i, \"A\").Value\n                    Cells(x, \"S\").Value = Cells(i, \"B\").Value\n                    Exit For\n                End If\n            Next I\n          End If\n        Next x\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 449, "user_id": 9129978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da0980148de15b82d82d39abbe6434c9?s=128&d=identicon&r=PG&f=1", "display_name": "tera_789", "link": "https://stackoverflow.com/users/9129978/tera-789"}, "edited": false, "score": 0, "creation_date": 1541560842, "post_id": 53183113, "comment_id": 93256304, "body": "Thanks! I will check it tomorrow and will surely update whether it worked well or not."}, {"owner": {"reputation": 449, "user_id": 9129978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da0980148de15b82d82d39abbe6434c9?s=128&d=identicon&r=PG&f=1", "display_name": "tera_789", "link": "https://stackoverflow.com/users/9129978/tera-789"}, "edited": false, "score": 0, "creation_date": 1541621261, "post_id": 53183113, "comment_id": 93282571, "body": "I just checked, and it works. Thanks a lot! However, is there a way for me to get <code>R1</code> dynamically? For example, now it is set to <code>&quot;A1:E1&quot;</code>. What if I do not know in advance which columns have data?"}, {"owner": {"reputation": 449, "user_id": 9129978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da0980148de15b82d82d39abbe6434c9?s=128&d=identicon&r=PG&f=1", "display_name": "tera_789", "link": "https://stackoverflow.com/users/9129978/tera-789"}, "edited": false, "score": 0, "creation_date": 1541633342, "post_id": 53183113, "comment_id": 93287456, "body": "I used <code>Intersect</code> solution and it worked, but the issue is that I need to start from column B - B1. Intersect start from first column - A. I like your first edited solution with <code>Range</code> but I get the error: <code>Object doesn&#39;t support this property&#47;method</code>. I also try to apply this somehow to all my sheets in the workbook. Whenever I call this function, I call it inside <code>For Each ws In MyBook.Worksheets ... Next ws</code> but it does not get applied to all sheets. Any help? Thanks"}, {"owner": {"reputation": 529, "user_id": 10277540, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uhl4j.png?s=128&g=1", "display_name": "Display name", "link": "https://stackoverflow.com/users/10277540/display-name"}, "reply_to_user": {"reputation": 449, "user_id": 9129978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da0980148de15b82d82d39abbe6434c9?s=128&d=identicon&r=PG&f=1", "display_name": "tera_789", "link": "https://stackoverflow.com/users/9129978/tera-789"}, "edited": false, "score": 0, "creation_date": 1541634567, "post_id": 53183113, "comment_id": 93287774, "body": "<code>Intersect</code> does not necessarily start at column A but I agree it is sometimes tricky to get the right behavior with it. I fixed the first option, just a typo. I&#39;ll edit for multiple sheets."}, {"owner": {"reputation": 529, "user_id": 10277540, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uhl4j.png?s=128&g=1", "display_name": "Display name", "link": "https://stackoverflow.com/users/10277540/display-name"}, "reply_to_user": {"reputation": 449, "user_id": 9129978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da0980148de15b82d82d39abbe6434c9?s=128&d=identicon&r=PG&f=1", "display_name": "tera_789", "link": "https://stackoverflow.com/users/9129978/tera-789"}, "edited": false, "score": 0, "creation_date": 1541635201, "post_id": 53183113, "comment_id": 93287914, "body": "Change A1 to B1 as it seems to be your starting point and note that the color coding stays consistent within the sheets so be careful if you have more different codes than your stored colors."}, {"owner": {"reputation": 449, "user_id": 9129978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da0980148de15b82d82d39abbe6434c9?s=128&d=identicon&r=PG&f=1", "display_name": "tera_789", "link": "https://stackoverflow.com/users/9129978/tera-789"}, "edited": false, "score": 0, "creation_date": 1541635261, "post_id": 53183113, "comment_id": 93287922, "body": "Thank you a lot - works exactly as I needed! What do you mean by &quot;different codes&quot;?"}, {"owner": {"reputation": 529, "user_id": 10277540, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uhl4j.png?s=128&g=1", "display_name": "Display name", "link": "https://stackoverflow.com/users/10277540/display-name"}, "reply_to_user": {"reputation": 449, "user_id": 9129978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da0980148de15b82d82d39abbe6434c9?s=128&d=identicon&r=PG&f=1", "display_name": "tera_789", "link": "https://stackoverflow.com/users/9129978/tera-789"}, "edited": false, "score": 0, "creation_date": 1541636607, "post_id": 53183113, "comment_id": 93288228, "body": "I mean different dates in your data. You have a limited number of color stored in your array so you&#39;ll run into a problem if you try to color a lot of different dates."}], "tags": [], "owner": {"reputation": 529, "user_id": 10277540, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uhl4j.png?s=128&g=1", "display_name": "Display name", "link": "https://stackoverflow.com/users/10277540/display-name"}, "is_accepted": true, "score": 1, "last_activity_date": 1541635041, "last_edit_date": 1541635041, "creation_date": 1541560451, "answer_id": 53183113, "question_id": 53182853, "link": "https://stackoverflow.com/questions/53182853/color-cell-headers-based-on-value-which-is-not-known-in-advance/53183113#53183113", "title": "Color cell headers based on value which is not known in advance", "body": "<p>Something like this:</p>\n\n<pre><code>Sub color_header()\n    Dim colors(): colors = Array(RGB(255, 99, 71), RGB(255, 127, 80), RGB(205, 92, 92), RGB(240, 128, 128), RGB(233, 150, 122), RGB(250, 128, 114), RGB(255, 160, 122), RGB(255, 69, 0), RGB(255, 140, 0), RGB(255, 165, 0))\n    Dim a As Integer: a = 0\n    Dim D1 As Object: Set D1 = CreateObject(\"scripting.dictionary\")\n    Dim R1 As Range: Set R1 = Range(\"A1:E1\") 'This is your header area\n    Dim R0 As Range\n\n    For Each R0 In R1\n        If Not D1.exists(Left(R0, 7)) Then\n            D1.Add Left(R0, 7), a\n            R0.Interior.Color = colors(a)\n            a = a + 1\n        Else\n            R0.Interior.Color = colors(D1(Left(R0, 7)))\n        End If\n    Next R0\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/7T147.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7T147.png\" alt=\"enter image description here\"></a></p>\n\n<p>A few way to narrow dynamic ranges:</p>\n\n<p>If you know first data is in <code>A1</code>, change <code>Range(\"A1:E1\")</code> to :</p>\n\n<p><code>Range(\"A1\",cells(1,Columns.Count).end(XlToLeft))</code></p>\n\n<p>If you only know that the data is on row 1 you can try :</p>\n\n<p><code>Intersect(Rows(1),Activesheet.Usedrange)</code></p>\n\n<p>Note that this is all assuming you are working on the activesheet. Consider adding workbook and worksheet referencing to avoid errors.</p>\n\n<p>Multiple sheets version:</p>\n\n<pre><code>Sub color_header()\n    Dim colors(): colors = Array(RGB(255, 99, 71), RGB(255, 127, 80), RGB(205, 92, 92), RGB(240, 128, 128), RGB(233, 150, 122), RGB(250, 128, 114), RGB(255, 160, 122), RGB(255, 69, 0), RGB(255, 140, 0), RGB(255, 165, 0))\n    Dim a As Integer: a = 0\n    Dim D1 As Object: Set D1 = CreateObject(\"scripting.dictionary\")\n    Dim Ws As Worksheet\n    Dim R1 As Range\n    Dim R0 As Range\n\n    For Each Ws In ActiveWorkbook.Sheets\n        Set R1 = Ws.Range(\"A1\", Ws.Cells(1, Ws.Columns.Count).End(xlToLeft))\n        For Each R0 In R1\n            If Not D1.exists(Left(R0, 7)) Then\n                D1.Add Left(R0, 7), a\n                R0.Interior.Color = colors(a)\n                a = a + 1\n            Else\n                R0.Interior.Color = colors(D1(Left(R0, 7)))\n            End If\n        Next R0\n    Next Ws\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 449, "user_id": 9129978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da0980148de15b82d82d39abbe6434c9?s=128&d=identicon&r=PG&f=1", "display_name": "tera_789", "link": "https://stackoverflow.com/users/9129978/tera-789"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 53183113, "answer_count": 1, "score": 0, "last_activity_date": 1562350809, "creation_date": 1541557876, "last_edit_date": 1562350809, "question_id": 53182853, "link": "https://stackoverflow.com/questions/53182853/color-cell-headers-based-on-value-which-is-not-known-in-advance", "title": "Color cell headers based on value which is not known in advance", "body": "<p>There are similar questions but they ask something like this: if value is 100 - color red, 200 - color green.</p>\n\n<p>My situation - <em>The cell's value is unknown in advance, so there is no pattern to match or compare against</em>.</p>\n\n<p><strong>My goal:</strong></p>\n\n<p>I want to color the first cell in each column based on the first 7 characters.</p>\n\n<p>For example, these are sample cells:</p>\n\n<pre><code>2017.09--T-2018_08_30   2017.10--T-2018_08_30   2017.09--T-2018_08_30   2017.10--T-2018_08_30   2017.08--T-2018_08_30 \n</code></pre>\n\n<p>The first 7 chars are <em>yyyy.mm</em>. 1st and 3rd columns (both have 2017.09) should be of one color, 2nd and 4th (both have 2017.10) should be of different color, and the last column (2017.08) should be of different color as well.</p>\n\n<p>I would like the colors to be pulled from an array of colors:</p>\n\n<pre><code>Dim colors() as String: colors = Array(\"RGB(255,99,71)\", \"RGB(255,127,80)\", \"RGB(205,92,92)\", \"RGB(240,128,128)\", \"RGB(233,150,122)\", \"RGB(250,128,114)\", \"RGB(255,160,122)\", \"RGB(255,69,0)\", \"RGB(255,140,0)\", \"RGB(255,165,0)\")\n</code></pre>\n\n<p><strong>So I can visualize my goal</strong> - I have done the same thing in JavaScript.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>const colors = [\r\n\t'#FF6633', '#FFB399', '#FF33FF', '#FFFF99', '#00B3E6', \r\n\t'#E6B333', '#3366E6', '#999966', '#99FF99', '#B34D4D',\r\n\t'#80B300', '#809900', '#E6B3B3', '#6680B3', '#66991A', \r\n  \t'#FF99E6', '#CCFF1A', '#FF1A66', '#E6331A', '#33FFCC',\r\n  \t'#66994D', '#B366CC', '#4D8000', '#B33300', '#CC80CC', \r\n \t'#66664D', '#991AFF', '#E666FF', '#4DB3FF', '#1AB399',\r\n  \t'#E666B3', '#33991A', '#CC9999', '#B3B31A', '#00E680', \r\n  \t'#4D8066', '#809980', '#E6FF80', '#1AFF33', '#999933',\r\n  \t'#FF3380', '#CCCC00', '#66E64D', '#4D80CC', '#9900B3', \r\n  \t'#E64D66', '#4DB380', '#FF4D4D', '#99E6E6', '#6666FF'\r\n];\r\nconst used = {};\r\n\r\nfunction getColor(key) {\r\n  \tused[key] = used[key] || colors.shift();\r\n  \treturn used[key];\r\n}\r\n\r\nfunction setHeaderColor() {\r\n\tconst mainTable = document.getElementById('main-table');\r\n\tconst headerRow = document.querySelectorAll('#main-table tr:first-child th');\r\n\tconst test = [];\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// Holds first 7 chars and background color of each column header\r\n\r\n\t// Extract first 7 characters from column header name\r\n\tfor (let i = 0; i &lt; headerRow.length; i++) {\r\n\t\ttest.push({\r\n\t\t\tversion: headerRow[i].innerHTML.substring(0, 7),\r\n\t\t\tcolor: headerRow[i].style.backgroundColor || null\r\n\t\t});\r\n\t}\r\n\r\n\tfor (let i = 1; i &lt; test.length; i++) {\r\n\t\t\ttest[i].color = getColor(test[i].version);\r\n\t}\r\n\r\n\tfor (let i = 0; i &lt; headerRow.length; i++) {\r\n\t\theaderRow[i].style.backgroundColor = test[i].color;\r\n\t}\r\n}\r\n\r\ndocument.addEventListener('DOMContentLoaded', setHeaderColor);</code></pre>\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;link rel=\"stylesheet\" href=\"https://www.w3schools.com/w3css/4/w3.css\"&gt;\r\n\r\n&lt;table class=\"w3-table-all\" id=\"main-table\"&gt;\r\n  &lt;tr&gt;\r\n    &lt;th class=\"w3-center\"&gt; Name&lt;/th&gt;\r\n    &lt;th class=\"w3-center\"&gt;2017.10-T-2018_08_30 ms_201709.&lt;/th&gt;\r\n    &lt;th class=\"w3-center\"&gt;2017.09-T-2018_08_30 ms_201709.&lt;/th&gt;\r\n    &lt;th class=\"w3-center\"&gt;2017.10-T-2018_08_30 ms_201709&lt;/th&gt;\r\n    &lt;th class=\"w3-center\"&gt;2017.09-T-2018_08_30 ms_201709&lt;/th&gt;\r\n    &lt;th class=\"w3-center\"&gt;2017.08-T-2018_08_30 ms_201709&lt;/th&gt;\r\n  &lt;/tr&gt;\r\n&lt;/table&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 116, "user_id": 5982062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HFQvV.jpg?s=128&g=1", "display_name": "wallyeye", "link": "https://stackoverflow.com/users/5982062/wallyeye"}, "is_accepted": true, "score": 0, "last_activity_date": 1541558201, "creation_date": 1541558201, "answer_id": 53182887, "question_id": 53182844, "link": "https://stackoverflow.com/questions/53182844/vba-cells-find-return-values-instead-of-address/53182887#53182887", "title": "VBA cells.find return values instead of address", "body": "<p>It is actually returning a range object (one cell), with the value of the cell being displayed when you hover over it. You don\u2019t need the first With statement, the findcell.offset will work without the \u201c.\u201d In front of it.</p>\n"}], "owner": {"reputation": 3, "user_id": 10455445, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-sAReNAkXtJo/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVPwqigM-EeaGgsTNMZrJ927yQ1wQ/mo/photo.jpg?sz=128", "display_name": "\u6e6f\u6770\u5112", "link": "https://stackoverflow.com/users/10455445/%e6%b9%af%e6%9d%b0%e5%84%92"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "accepted_answer_id": 53182887, "answer_count": 1, "score": 0, "last_activity_date": 1586402781, "creation_date": 1541557806, "last_edit_date": 1586402781, "question_id": 53182844, "link": "https://stackoverflow.com/questions/53182844/vba-cells-find-return-values-instead-of-address", "title": "VBA cells.find return values instead of address", "body": "<p>I have two worksheets in same workbook, sheets(\"\u9001\u9054\u5730\u5740\") store raw data, sheets(\"\u9001\u9054\u8b49\u66f8\") for user type the string which they want to find, as code below.</p>\n\n<pre><code>Private Sub OpenAddress()\n\nDim addressNum As Integer\nDim addressString As String\nDim name As String\nDim findCell As Range\n\nCount = TB1.Value\n'TB1.Value is the string which type by user\n\nSet findCell = Worksheets(\"\u9001\u9054\u5730\u5740\").Columns(\"A\").Cells.Find(what:=Count, lookat:=xlWhole, LookIn:=xlValues)\n\nIf findCell Is Nothing Then\n\nMsgBox \"not found\"\nisPass = False\n\nExit Sub\n\nEnd If\n\nFor i = 1 To People\n\nS = 2\n\nWith Worksheets(\"\u9001\u9054\u5730\u5740\")\n    .findCell.Offset(0, 1).Value = name\n    .findCell.Offset(0, 2).Value = addressNum\n    .findCell.Offset(0, 3).Value = addressString\n\nEnd With\n\nWith Worksheets(\"\u9001\u9054\u8b49\u66f8\")\n\n.Cells(S, 1).Value = name\n.Cells(S, 3).Value = addressNum &amp; \"  \" &amp; addressString\n\nS = S + 1\ni = i + 1\n\nEnd With\n\nNext i\n\nS = 2\n\nEnd Sub\n</code></pre>\n\n<p>The problem is, variable findCell result in return the string you type instead of the address of it. </p>\n\n<p>Ex: You want find where the string \"1\" is, but findCell return \"1\" \ninstead of return the address \"1\" is. </p>\n"}, {"tags": ["excel", "vba", "double-click"], "answers": [{"tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": true, "score": 0, "last_activity_date": 1541554317, "creation_date": 1541554317, "answer_id": 53182526, "question_id": 53182488, "link": "https://stackoverflow.com/questions/53182488/excel-vba-multiple-double-click-actions/53182526#53182526", "title": "Excel VBA multiple double click actions", "body": "<p>That's where the <code>Cancel</code> in <code>Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)</code> comes in.</p>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n\n    Rem: Increment your date\n\n    Cancel = True   '&lt;-- Set to true\n\nEnd Sub\n</code></pre>\n\n<p>If you only want to cancel in column B because that's where your dates are located, then:</p>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n\n    Rem: Only Cancel if double-clicked in column B\n    If Not Intersect(Target, Me.Columns(\"B\")) Is Nothing Then\n\n        Cancel = True   '&lt;-- Set to true\n\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 137, "user_id": 2010692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TvuhU.jpg?s=128&g=1", "display_name": "K0ICHI", "link": "https://stackoverflow.com/users/2010692/k0ichi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 428, "favorite_count": 0, "accepted_answer_id": 53182526, "answer_count": 1, "score": 1, "last_activity_date": 1541554317, "creation_date": 1541553923, "question_id": 53182488, "link": "https://stackoverflow.com/questions/53182488/excel-vba-multiple-double-click-actions", "title": "Excel VBA multiple double click actions", "body": "<p>I've got some code that increments the date in a cell by 1 day when I double click it. But to repeat, I first have to click outside the cell.</p>\n\n<p>Is it not possible to have multiple successive double click actions?</p>\n"}, {"tags": ["excel", "vba", "date-conversion"], "comments": [{"owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "edited": false, "score": 0, "creation_date": 1541551733, "post_id": 53182158, "comment_id": 93254533, "body": "Use &quot;Application.Workbooks.Open Filename:=strInPath, Format:=xlDelimited, Local:=True&quot; when opening the CSV file and it should be fine."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1541553536, "post_id": 53182158, "comment_id": 93254948, "body": "Actually, the <b><i>key part of the code</i></b> will be the line that opens the file. That is where the magic needs to be done. If you have Excel 2010+, you might be better off using <code>Power Query</code> aka <code>Get &amp; Transform</code> in 2016+ to do the import and conversion.  You can record a macro while doing that, also. Upload and post a link to a specimen CSV file so we can test things out."}, {"owner": {"reputation": 1, "user_id": 10615927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b3b3adb9aabe97f0f3a91c27220a8f2?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/10615927/matt"}, "edited": false, "score": 0, "creation_date": 1541553591, "post_id": 53182158, "comment_id": 93254958, "body": "Thanks Michal, doesn&#39;t work for me as hoped though.  In my post I mentioned the file is *CSV, what I should have said it that it is a report created as a *CSV but it is already loaded in as *xlsx by the time I get it.  I&#39;m pretty sure that is why what you recommended trying doesn&#39;t work for me in this instance.  Also, I am in Excel 2010."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10615927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b3b3adb9aabe97f0f3a91c27220a8f2?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/10615927/matt"}, "edited": false, "score": 0, "creation_date": 1541559518, "post_id": 53182612, "comment_id": 93256068, "body": "Thanks for that, I&#39;ll try roll that in soon."}], "tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 0, "last_activity_date": 1541555340, "creation_date": 1541555340, "answer_id": 53182612, "question_id": 53182158, "link": "https://stackoverflow.com/questions/53182158/vba-texttocolumns-errors-relating-to-date-format/53182612#53182612", "title": "VBA TextToColumns Errors Relating to Date Format", "body": "<p>The \"best\" way to handle this will be to properly import the CSV file.  If you do that, you can specify the date format at the time of import, before Excel converts the dates into a combination of text strings, and improperly converted dates.</p>\n\n<p>If that is not possible, and must absolutely work with the xls file that has incorrectly imported the original data, you can try this macro. It should work, but read the notes carefully for possible pitfalls and usage information.</p>\n\n<pre><code>Option Explicit\nSub ConvertDates()\n    'converts dates that have been mismatched MDY / DMY\n    'Assumes dates are all in selected column\n    '   Only need to select a single cell in the column\n    '   will place results in a column next to original data\n    ' If adjacent column is not blank, a column will be inserted\n    'Figures out the original format by analyzing a \"text\" date\n    'Time components are converted directly.  This might be OK unless\n    ' in a non standard format such as 1400Z\n\nDim R As Range, C As Range\nDim sDelim As String\nDim FileDateFormat As String * 3\nDim I As Long, J As Long, V As Variant\nDim vDateParts As Variant\nDim YR As Long, MN As Long, DY As Long\nDim TM As Double\nDim vRes As Variant 'to hold the results of conversion\n\nSet R = Selection\n\n'Test that selected cell contains a date\nIf Not IsDate(R(1)) Then\n    MsgBox \"Select a cell containing a date\"\n    Exit Sub\nEnd If\n\nSet R = Intersect(R.EntireColumn, ActiveSheet.UsedRange)\nReDim vRes(1 To R.Rows.Count, 1 To 1)\n\n'Find a \"text date\" cell to analyze\nFor Each C In R\n    With C\n    If IsDate(.Value) And Not IsNumeric(.Value2) Then\n        'find delimiter\n        For I = 1 To Len(.Text)\n            If Not Mid(.Text, I, 1) Like \"#\" Then\n                sDelim = Mid(.Text, I, 1)\n                Exit For\n            End If\n        Next I\n\n        'split off any times\n        V = Split(.Text &amp; \" 00:00\")\n        vDateParts = Split(V(0), sDelim)\n\n        If vDateParts(0) &gt; 12 Then\n            FileDateFormat = \"DMY\"\n            Exit For\n        ElseIf vDateParts(1) &gt; 12 Then\n            FileDateFormat = \"MDY\"\n            Exit For\n        Else\n            MsgBox \"cannot analyze data\"\n            Exit Sub\n        End If\n    End If\n    End With\nNext C\n\nIf sDelim = \"\" Then\n   MsgBox \"cannot find problem\"\n   Exit Sub\nEnd If\n\n'Check that analyzed date format different from Windows Regional Settings\nSelect Case Application.International(xlDateOrder)\n    Case 0 'MDY\n        If FileDateFormat = \"MDY\" Then\n            MsgBox \"File Date Format and Windows Regional Settings match\" &amp; vbLf _\n                &amp; \"Look for problem elsewhere\"\n            Exit Sub\n        End If\n    Case 1 'DMY\n        If FileDateFormat = \"DMY\" Then\n            MsgBox \"File Date Format and Windows Regional Settings match\" &amp; vbLf _\n                &amp; \"Look for problem elsewhere\"\n            Exit Sub\n        End If\nEnd Select\n\n'Process dates\n'Could shorten this segment but probably more understandable this way\nJ = 0\nSelect Case FileDateFormat\n    Case \"DMY\"\n        For Each C In R\n        With C\n            If IsDate(.Value) And IsNumeric(.Value2) Then\n            'Reverse the day and the month\n                YR = Year(.Value2)\n                MN = Day(.Value2)\n                DY = Month(.Value2)\n                TM = .Value2 - Int(.Value2)\n            ElseIf IsDate(.Value) And Not IsNumeric(.Value2) Then\n                V = Split(.Text &amp; \" 00:00\") 'remove the time\n                vDateParts = Split(V(0), sDelim)\n                YR = vDateParts(2)\n                MN = vDateParts(1)\n                DY = vDateParts(0)\n                TM = TimeValue(V(1))\n            Else\n                YR = 0\n            End If\n\n            J = J + 1\n            If YR = 0 Then\n                vRes(J, 1) = C.Value\n            Else\n                vRes(J, 1) = DateSerial(YR, MN, DY) + TM\n            End If\n        End With\n        Next C\n    Case \"MDY\"\n        For Each C In R\n        With C\n            If IsDate(.Value) And IsNumeric(.Value2) Then\n            'Reverse the day and the month\n                YR = Year(.Value2)\n                MN = Day(.Value2)\n                DY = Month(.Value2)\n                TM = .Value2 - Int(.Value2)\n            ElseIf IsDate(.Value) And Not IsNumeric(.Value2) Then\n                V = Split(.Text &amp; \" 00:00\") 'remove the time\n                vDateParts = Split(V(0), sDelim)\n                YR = vDateParts(2)\n                MN = vDateParts(0)\n                DY = vDateParts(1)\n                TM = TimeValue(V(1))\n            Else\n                YR = 0\n            End If\n\n            J = J + 1\n            If YR = 0 Then\n                vRes(J, 1) = C.Value\n            Else\n                vRes(J, 1) = DateSerial(YR, MN, DY) + TM\n            End If\n        End With\n        Next C\nEnd Select\n\nWith R.Offset(0, 1).EntireColumn\n    Set C = .Find(what:=\"*\", LookIn:=xlFormulas)\n    If Not C Is Nothing Then .EntireColumn.Insert\nEnd With\n\nR.Offset(0, 1).Value = vRes\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10615927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b3b3adb9aabe97f0f3a91c27220a8f2?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/10615927/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 150, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1541555340, "creation_date": 1541551179, "question_id": 53182158, "link": "https://stackoverflow.com/questions/53182158/vba-texttocolumns-errors-relating-to-date-format", "title": "VBA TextToColumns Errors Relating to Date Format", "body": "<p>I am having a problem with date formatting and TextToColumns.  Although similar to some other threads, I couldn't match them directly to my problem.</p>\n\n<p>Background:  I have a recurring relatively large *.csv file that includes three columns of date/time stamps.  These are currently text in the form 'DD/MM/YYYY hh:mm'.  My computer is D/M/Y by default.  If I manually use the Text To Columns feature in Excel (delimited, no delimiters selected, column data format Date: DMY), then the conversion occurs correctly.</p>\n\n<p>Error: In trying to automate the conversion in VBA, I recorded a macro as a starting point and then went from there.  Once I completed writing the routine, I ran it and saw that it only did about half the dates.  Further investigation revealed that it only changed dates that could be either way... i.e. the day did not exceed the 12th.  I then realised what was happening was that the code only 'worked' when it could interpret the date in a MDY format.  This means that it actually created an error as dates such as 05/02/2010 (5 Feb 2010) then appeared as 02/05/2010 (2 May 2010).  </p>\n\n<p>The key part of the code is as follows:</p>\n\n<pre><code>Range(\"SCDB\").Columns(aryColTitleIndex(i)).TextToColumns _\n  Destination:=Range(\"SCDB\").Columns(aryColTitleIndex(i)), _\n  DataType:=xlDelimited, TextQualifier:=xlDoubleQuote, _\n  ConsecutiveDelimiter:=False, Tab:=False, Semicolon:=False, _\n  Comma:=False, Space:=False, Other:=False, FieldInfo:=Array(1, xlDMYFormat), _\n  TrailingMinusNumbers:=True\n</code></pre>\n\n<p>(The named ranges and column indexes are working fine).  I tried FieldInfo:=Array(1, 4) as well as what is shown above, but no change.  Basically, it looks like VBA wants to operate in MYD but Excel in DMY.</p>\n\n<p>Any ideas?  Thanks</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 1, "creation_date": 1541551816, "post_id": 53181835, "comment_id": 93254556, "body": "That error implies that 1 or more of the following is true: <code>Workbooks(MasterBook)</code> is nothing... <code>.Sheets(PasteSheet)</code> is nothing... <code>Workbooks(DataBook)</code> is nothing... <code>.Sheets(CurrentPullSheet)</code> is nothing. It would make it easier on you to set your workbooks to an object variable as well as your worksheets."}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "edited": false, "score": 0, "creation_date": 1541614808, "post_id": 53181835, "comment_id": 93279558, "body": "Sorry I don&#39;t have a better answer for you, but honestly a database would be much better for this kind of task.  Look into getting Access or SQL Server setup.  That will make things like this much, much, much easier.  You can do what you want, but it&#39;s going to be very difficult to setup using VBA, and it&#39;s going to be a nightmare to maintain.  You should try to use the best tool for the job, and in this case it is NOT Excel."}], "owner": {"reputation": 1, "user_id": 10560338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a41f3bacf866dee0644c0005258b4398?s=128&d=identicon&r=PG&f=1", "display_name": "Ray", "link": "https://stackoverflow.com/users/10560338/ray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1541550965, "creation_date": 1541548488, "last_edit_date": 1541550965, "question_id": 53181835, "link": "https://stackoverflow.com/questions/53181835/import-multiple-named-worksheets-from-multiple-workbooks", "title": "Import Multiple Named Worksheets from Multiple Workbooks", "body": "<p>I am trying to import multiple worksheets from different workbooks, for different scenarios. To explain better - I have scenario Apple, Banana, and Cherry. Each scenario has it's own file folder with workbooks One, Two, and, Three. Workbook one has sheets Jack, John, and Jill. Workbook Two has sheets Rachel, Robin, and Ryan. Workbook Three has sheets Sam, Sally, and Susan. The sheet names don't change from scenario to scenario.</p>\n\n<p>The master workbook has a drop-down of the different scenarios and a list of the sheets to bring in from each workbook (e.g. drop-down selected is scenario Apple, ranges include - from workbook One import Jack and Jill, from workbook Two import Robin, and from workbook Three import Sam and Susan).</p>\n\n<p>See image for masterworkbook layout:<br>\n<a href=\"https://i.stack.imgur.com/7Z7wP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7Z7wP.png\" alt=\"See image for masterworkbook layout\"></a></p>\n\n<p>The code needs to go to the appropriate scenario folder (referred to as Run in the code) and then open up each workbook and pull in the appropriate worksheets. Right now I am getting  </p>\n\n<blockquote>\n  <p>Run-time error 9: subscript out of range  </p>\n</blockquote>\n\n<p>on the <code>Workbooks(Masterbook)=Workbooks(Databook)</code> line.</p>\n\n<p>Am I over complicating this? Any advice would be greatly appreciated!</p>\n\n<pre><code>Sub CopySheetsfromCRSS()\n\nDim MasterBook As String\nDim wb As Workbook\nDim DataBook As String\nDim CurrentPullSheet As String\nDim DataDumpSheet As String\nDim PasteSheet As String\nDim OneRange As Range\nDim TwoRange As Range\nDim ThreeRange As Range\nDim TypesOfData As Range\nDim CopyRange As String\nDim Locations As Range\nSet OneRange = Range(\"B1\", Range(\"B1\").End(xlDown))\nSet TwoRange = Range(\"C1\", Range(\"C1\").End(xlDown))\nSet ThreeRange = Range(\"D1\", Range(\"D1\").End(xlDown))\n\nApplication.ScreenUpdating = False\n\n'Read in Range of Copy Data'\nLet CopyRange = \"A1:DI517\"\n'Read range of sheets to Pull'\nSet TypesOfData = Range(\"A1\", Range(\"A1\").End(xlDown))\n\nMasterBook = ActiveWorkbook.Name\n\nWith ThisWorkbook.ActiveSheet\n'Type of Data Loop'\nFor i = 1 To TypesOfData.Rows.Count\n    If i = 1 Then\n        'One'\n        Set Locations = OneRange\n        ElseIf i = 2 Then\n        'Two'\n        Set Locations = TwoRange\n        Else\n        'Three'\n        Set Locations = ThreeRange\n    End If\n\n'Run Loop'\n    For j = 1 To Rows.Count\n        If j = 1 Then\n        RunCell = \"E1\"\n        End If\n        CurrentRun = .Range(RunCell).Value\n        'Open Workbook'\n        Workbooks.Open ThisWorkbook.Path &amp; \"\\Runs\\\" &amp; CurrentRun &amp; \"\\\" &amp; CurrentRun &amp; \"_\" &amp; TypesOfData.Cells(i, 1) &amp; \".xlsx\"\n        DataBook = ActiveWorkbook.Name\n            For k = 1 To Locations.Rows.Count\n                'Copy Data'\n                CurrentPullSheet = Locations.Cells(k, 1)\n                PasteSheet = \"Data_\" &amp; CurrentPullSheet\n                Workbooks(MasterBook).Sheets(PasteSheet).Range(CopyRange).Value = Workbooks(DataBook).Sheets(CurrentPullSheet).Range(CopyRange).Value\n            Next\n        'Close Workbook'\n        Workbooks(MasterBook).Activate\n        For Each wb In Application.Workbooks\n            If Not Not wb.Name &lt;&gt; ActivateWorkbook.Name Then\n            If wb.Name Like \"*.xls\" Then\n                wb.Close SaveChanges:=True\n                Else\n                wb.Close\n            End If\n            End If\n        Next\n    Next\nNext\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["mysql", "vba", "ms-access", "odbc"], "comments": [{"owner": {"reputation": 1854, "user_id": 6071871, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IfFKy.jpg?s=128&g=1", "display_name": "ArcherBird", "link": "https://stackoverflow.com/users/6071871/archerbird"}, "edited": false, "score": 0, "creation_date": 1541544892, "post_id": 53181177, "comment_id": 93252799, "body": "I think the issue would be revealed in your connection string. What data provider/driver to you reference in the connection string? Are you sure you have that provider/driver installed?"}, {"owner": {"reputation": 11, "user_id": 10615682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6d36035286f2db159d91deb4147ca34?s=128&d=identicon&r=PG&f=1", "display_name": "Z.Bryant", "link": "https://stackoverflow.com/users/10615682/z-bryant"}, "reply_to_user": {"reputation": 1854, "user_id": 6071871, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IfFKy.jpg?s=128&g=1", "display_name": "ArcherBird", "link": "https://stackoverflow.com/users/6071871/archerbird"}, "edited": false, "score": 0, "creation_date": 1541545918, "post_id": 53181177, "comment_id": 93253107, "body": "@ArcherBird Using odbc 5.1 driver, as the newer drivers had a bug of #Deleted for medium/long texts The connection string simply calls a file dsn which is on a secure location   Public Function ConnectString() &#39;Global mysql connection&#39;  ConnectString = &quot;DRIVER={MySQL ODBC 5.1 Driver};PORT=XXXX;DATABASE={IMS-DATA};SERVER=192.XXX.XX.39;F&zwnj;&#8203;ILEDSN=\\\\RJEDB01\\IMS&zwnj;&#8203;Connections\\IMS-DATA&zwnj;&#8203;.dsn;UID=****;PWD=**&zwnj;&#8203;**&quot;  End Function"}, {"owner": {"reputation": 1854, "user_id": 6071871, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IfFKy.jpg?s=128&g=1", "display_name": "ArcherBird", "link": "https://stackoverflow.com/users/6071871/archerbird"}, "edited": false, "score": 0, "creation_date": 1541546034, "post_id": 53181177, "comment_id": 93253158, "body": "which line of code throws the error?"}, {"owner": {"reputation": 1854, "user_id": 6071871, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IfFKy.jpg?s=128&g=1", "display_name": "ArcherBird", "link": "https://stackoverflow.com/users/6071871/archerbird"}, "edited": false, "score": 0, "creation_date": 1541546160, "post_id": 53181177, "comment_id": 93253193, "body": "the other thing to look at would be whatever gets assigned into your strSQL variable (looks like this is being set by some function, <code>RefreshRS</code> not shown here). You would want to check for differences in the grammer between JET SQL and MySQL"}, {"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1543005037, "post_id": 53181177, "comment_id": 93777796, "body": "you should probably use linked tables"}], "owner": {"reputation": 11, "user_id": 10615682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6d36035286f2db159d91deb4147ca34?s=128&d=identicon&r=PG&f=1", "display_name": "Z.Bryant", "link": "https://stackoverflow.com/users/10615682/z-bryant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 211, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1541546556, "creation_date": 1541543978, "last_edit_date": 1541546556, "question_id": 53181177, "link": "https://stackoverflow.com/questions/53181177/access-filters-not-working-with-adodb-recordset-connection-errdata-provider-cou", "title": "Access Filters not working with ADODB.Recordset connection err(Data Provider could not be initialized", "body": "<p>We have migrated part of our Access database to mysql, this snippet simply retrieves the sql statement from a table containing form names and sql statements and then sets it as the forms recordset</p>\n\n<p>The issue i have right now is although the speed is a tremendous improvement, The access front end is not completely functioning as expected right now, the Refresh and filter by text access functions do not work, simply throw error (Data Provider could not be initialized).</p>\n\n<p>I believe this has something to do with us setting the recordsource to the form, is there anyway around this without a huge performance drop?</p>\n\n<p>If i simply link a view from mysql into access and set the forms recordsource as that view, it takes a much longer time to load and filter</p>\n\n<p>The Picture here <a href=\"https://i.stack.imgur.com/cbAxh.png\" rel=\"nofollow noreferrer\">http://puu.sh/BXw55/fe8b01d8d0.jpg</a> Shows when the error occurs, when trying to use Access Filters</p>\n\n<p>Here is the function: </p>\n\n<pre><code>Private Sub Command91_Click() 'Clear filters'\nOn Error GoTo ErrHandler\nDim oConn As ADODB.Connection\nDim rs As ADODB.Recordset\nDim ConnStr As String\nDim strOrderBy As String\n\n'Creating new connection, and then using ConnectString function to connect to mysql Database'\nSet oConn = New ADODB.Connection\noConn.Open ConnectString\n\n'Clears filter fields to null'\nfltrDocBaseID.Value = Null\nfltrDocBaseClientDocNumber.Value = Null\nfltrDisciplinesID.Value = Null\nfltrDocTypeID.Value = Null\nfltrDocSubTypesID.Value = Null\nfltrProjectID.Value = Null\nFilterOn = False\nfltrDocBaseTitle1.Value = Null\nfltrDocBaseTitle2.Value = Null\nfltrDocBaseTitle3.Value = Null\nfltrDocBaseTitle4.Value = Null\n\n'Retrieves SQL code from refreshDS(fname As String) located in Module- SQLDatasources'\nstrSQL = refreshRS(Me.Name)\n'Creates new recordset'\n\nSet rs = New ADODB.Recordset\n'Connects to mysql database, runs strSQL and then sets page recordset'\n'to the current strSQL'\nWith rs\n    Set .ActiveConnection = oConn\n    .Source = strSQL\n    .LockType = adLockOptimistic\n    .CursorType = adOpenKeyset\n    .CursorLocation = adUseClient\n    .Open\nEnd With\n\nSet Me.Recordset = rs\n'Closes recordset and connections, This is a good practice for traffic efficiency'\nrs.Close\noConn.Close\nSet rs = Nothing\nSet oConn = Nothing\n</code></pre>\n"}, {"tags": ["excel", "vba", "checkbox"], "comments": [{"owner": {"reputation": 59, "user_id": 10591730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4cf8b36094d6d5f9dd922481d206f7c?s=128&d=identicon&r=PG&f=1", "display_name": "M T ", "link": "https://stackoverflow.com/users/10591730/m-t"}, "edited": false, "score": 0, "creation_date": 1541595736, "post_id": 53180939, "comment_id": 93268792, "body": "Anybody please?"}, {"owner": {"reputation": 59, "user_id": 10591730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4cf8b36094d6d5f9dd922481d206f7c?s=128&d=identicon&r=PG&f=1", "display_name": "M T ", "link": "https://stackoverflow.com/users/10591730/m-t"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1541607248, "post_id": 53180939, "comment_id": 93275702, "body": "Cheers for that @FreeMan"}], "answers": [{"tags": [], "owner": {"reputation": 59, "user_id": 10591730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4cf8b36094d6d5f9dd922481d206f7c?s=128&d=identicon&r=PG&f=1", "display_name": "M T ", "link": "https://stackoverflow.com/users/10591730/m-t"}, "is_accepted": true, "score": 0, "last_activity_date": 1541605987, "creation_date": 1541605987, "answer_id": 53193032, "question_id": 53180939, "link": "https://stackoverflow.com/questions/53180939/excel-2016-vba-code-for-checkbox-on-userform1-to-specify-data-to-be-transferred/53193032#53193032", "title": "Excel 2016 VBA Code for Checkbox on Userform1 to specify data to be transferred onto another sheet (same workbook)", "body": "<p>OK I'm no expert and I had help from @FreeMan who took his time in explaining and providing the code. I take no credit in this. Putting it out there so anybody else with similar issue can benefit from this. I well and truly appreciate all who have tried to help with this and with other VBA related questions and code here. </p>\n\n<p>Here it is:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n  Dim dcc As Long\n  Dim abc As Worksheet, pfl As Worksheet\n\n  Set abc = ThisWorkbook.Worksheets(Me.ComboBox1.Value)\n  Set pfl = Sheets(\"ProfitLoss\")\n\nWith abc\ndcc = .Range(\"A\" &amp; Rows.count).End(xlUp).row\n.Cells(dcc + 1, 1).Value = Date\n.Cells(dcc + 1, 2).Value = Me.TextBox1.Value\n.Cells(dcc + 1, 3).Value = Me.TextBox2.Value\n.Cells(dcc + 1, 4).Value = Me.TextBox3.Value\n.Cells(dcc + 1, 5).Value = Me.TextBox4.Value\n.Cells(dcc + 1, 6).Value = Me.TextBox5.Value\n\nEnd With\n\n\nIf CheckBox1.Value Then 'this is a shorter way of writing the conditional\nWith pfl\n  dcc = .Range(\"A\" &amp; Rows.count).End(xlUp).row\n  .Cells(dcc + 1, 1).Value = Date\n  .Cells(dcc + 1, 2).Value = Me.TextBox1.Value\n  .Cells(dcc + 1, 3).Value = Me.TextBox2.Value\n  .Cells(dcc + 1, 4).Value = Me.TextBox3.Value\n  .Cells(dcc + 1, 5).Value = Me.TextBox4.Value\n  .Cells(dcc + 1, 6).Value = Me.TextBox5.Value\n End With\nEnd If\n\n TextBox1.text = \"\"\n TextBox2.text = \"\"\n TextBox3.text = \"\"\n TextBox4.text = \"\"\n TextBox5.text = \"\"\n\nEnd Sub\n</code></pre>\n\n<p>I hope it'll help somebody. Cheers.</p>\n"}], "owner": {"reputation": 59, "user_id": 10591730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4cf8b36094d6d5f9dd922481d206f7c?s=128&d=identicon&r=PG&f=1", "display_name": "M T ", "link": "https://stackoverflow.com/users/10591730/m-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 53193032, "answer_count": 1, "score": 0, "last_activity_date": 1586402817, "creation_date": 1541542678, "last_edit_date": 1586402817, "question_id": 53180939, "link": "https://stackoverflow.com/questions/53180939/excel-2016-vba-code-for-checkbox-on-userform1-to-specify-data-to-be-transferred", "title": "Excel 2016 VBA Code for Checkbox on Userform1 to specify data to be transferred onto another sheet (same workbook)", "body": "<p><a href=\"https://i.stack.imgur.com/BQSj3.png\" rel=\"nofollow noreferrer\">workbook</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/mLr7S.png\" rel=\"nofollow noreferrer\">profitloss</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/92YJ1.png\" rel=\"nofollow noreferrer\">userform</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/KCsTD.png\" rel=\"nofollow noreferrer\">new userform option</a></p>\n\n<p>User @Lambik helped me a lot in achieving functionality in this workbook. Successfully managed to get the data from userform1 to January 2019 sheet and at the same time transferred on to the profitloss sheet. What I didn't thought about was that in profit and loss all fields can not be copied and pasted. </p>\n\n<p>I tried to add new label and new textbox on the userform and get it to work by studying the code provided by @Lambik but there was another error, not error its more like a repetition, if I keep the edited version of userform1 (I've deleted it btw very non practical) then even if extra fields are \"not\" filled on the userform1 the rest of the entries still go into profitloss, that means, manually deleting every entry which is not suppose to be in there. So I thought long and hard and only thing I can think of is to add a checkbox on the userform1 and when the checkbox is clicked only then the first two fields from userform1 which are comment and rent go into profitloss along with the respective month selected from the combobox1. I think, I think it's the right logic. If anybody can help with the VBA code that how to achieve this using the checkbox then I'd appreciate it very much. I've attached links to the screenshots of the workbook, column rows of profitloss, old userform1 (works like a charm, thanks to @Lambik) and the new edited userform1 with the extra label and checkbox to have data copied onto the profit and loss sheet along with the current month selected.</p>\n\n<p>The code that have the userform1 working is,</p>\n\n<pre><code>Private Sub ComboBox1_Change()\n\nDim SheetName As String\nDim ws As Worksheet\nDim LastRow As Long\n\nSheetName = ComboBox1.Value\nSet ws = Sheets(SheetName)\n\n LastRow = ws.Cells(ws.Rows.Count, \"G\").End(xlUp).Row\n Label8.Caption = \"         Balance is: \" &amp; ws.Cells(LastRow, 7).Value\n\n\nPrivate Sub CommandButton1_Click()\n\nDim dcc As Long\nDim abc As Worksheet, pfl As Worksheet\n\n Set abc = ThisWorkbook.Worksheets(Me.ComboBox1.Value)\n Set pfl = Sheets(\"ProfitLoss\")\n\nWith abc\n\ndcc = .Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n.Cells(dcc + 1, 1).Value = Date\n.Cells(dcc + 1, 2).Value = Me.TextBox1.Value (comment/source)\n.Cells(dcc + 1, 3).Value = Me.TextBox2.Value (rent)\n.Cells(dcc + 1, 4).Value = Me.TextBox3.Value\n.Cells(dcc + 1, 5).Value = Me.TextBox4.Value\n.Cells(dcc + 1, 6).Value = Me.TextBox5.Value\n\nEnd With\n\nWith pfl\ndcc = .Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n.Cells(dcc + 1, 1).Value = Date\n.Cells(dcc + 1, 2).Value = Me.TextBox1.Value (comment/source)\n.Cells(dcc + 1, 3).Value = Me.TextBox2.Value (In)\n.Cells(dcc + 1, 4).Value = Me.TextBox3.Value \n.Cells(dcc + 1, 5).Value = Me.TextBox4.Value\n.Cells(dcc + 1, 6).Value = Me.TextBox5.Value\nEnd With\n\nTextBox1.Text = \"\"\nTextBox2.Text = \"\"\nTextBox3.Text = \"\"\nTextBox4.Text = \"\"\nTextBox5.Text = \"\"\n\n\nEnd Sub\n</code></pre>\n\n<p>The added checkbox on userform1 is checkbox1 and I put (comment/source) (rent) in code above to identify which rows needs to be transferred. If possible then when the checkbox is checked meaning entry will go into january 2019 and also in profitloss then that entry be automatically be highlighted and change colour to lets say green? or any for that matter. just to stand out if userform1 is not in use and user is just looking at the sheet. I appreciate your help in achieving this. Thanks in advance. </p>\n\n<p>Cheers.</p>\n\n<p>P.S. From userform1 only comment and rent needs to be added onto the profitloss sheet when the checkbox is checked and nothing else.</p>\n"}, {"tags": ["vba", "function"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1541542864, "post_id": 53180599, "comment_id": 93251981, "body": "It&#39;s not clear what the function means to do. Is it invoked from a worksheet cell? If so you&#39;ll want to take a <code>ByVal Target As Range</code> parameter, and work off that instead of <code>ActiveCell</code>. Function should have a declared return type (<code>As Long</code>?)"}, {"owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "edited": false, "score": 0, "creation_date": 1541542966, "post_id": 53180599, "comment_id": 93252026, "body": "Are your variables declared outside of the function -- or not declared at all? You might be able to replace the <code>on error resume next</code> with <code>if zrange is nothing then exit function</code>"}, {"owner": {"reputation": 1, "user_id": 8993738, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Iyk6EchUQWA/AAAAAAAAAAI/AAAAAAAAG-M/B5WV3LNbgzw/photo.jpg?sz=128", "display_name": "Marcelo Botti", "link": "https://stackoverflow.com/users/8993738/marcelo-botti"}, "edited": false, "score": 0, "creation_date": 1541551956, "post_id": 53180599, "comment_id": 93254592, "body": "Thanks Mathieu and Chillin for your help! The worksheet is a workgroup planner, plus a gantt diagram. The porpose of this vba function is to count how many blue cells you have inside a range of rows (blue cells means that a guy is on duty...). Yes, it&#39;s invoked from a worksheet cell (that one with &quot;#&#191;NOMBRE?&quot; on it, and it&#39;s also copied to the cells on the right). To be honest, I have no idea how to use ByVal Target as Range, but I&#39;ll check my vba books... The function have no parameters at all."}, {"owner": {"reputation": 1, "user_id": 8993738, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Iyk6EchUQWA/AAAAAAAAAAI/AAAAAAAAG-M/B5WV3LNbgzw/photo.jpg?sz=128", "display_name": "Marcelo Botti", "link": "https://stackoverflow.com/users/8993738/marcelo-botti"}, "edited": false, "score": 0, "creation_date": 1541552002, "post_id": 53180599, "comment_id": 93254603, "body": "I would like to calculate the parameters in a sort of automatic way, as the range of rows are the cells two columns to the left (Offset(-1, -2)), and the text color cell is the one at the left of the function cell (Offset(0, -1))."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1541553906, "creation_date": 1541553906, "answer_id": 53182487, "question_id": 53180599, "link": "https://stackoverflow.com/questions/53180599/function-without-parameters/53182487#53182487", "title": "Function without parameters", "body": "<p>Here's one approach (a little simplified from your code...)</p>\n\n<pre><code>Function countcolor()\n    Dim clr As Long, rng As Range, c As Range, rv As Long\n\n    With Application.ThisCell '&lt;&lt; ThisCell is the cell calling the function\n        clr = .Offset(0, -1).Interior.Color '&lt;&lt; color to look for...\n        Set rng = .Parent.Range(.Offset(-1, -2), .Offset(-1, -2).End(xlUp))\n    End With\n\n    For Each c In rng.Resize(, 100).Cells '&lt;&lt; adjust resizing to suit...\n        If c.Interior.Color = clr Then rv = rv + 1\n    Next c\n\n    countcolor = rv\n\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/16xR6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/16xR6.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 8993738, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Iyk6EchUQWA/AAAAAAAAAAI/AAAAAAAAG-M/B5WV3LNbgzw/photo.jpg?sz=128", "display_name": "Marcelo Botti", "link": "https://stackoverflow.com/users/8993738/marcelo-botti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1541553906, "creation_date": 1541541142, "last_edit_date": 1541541668, "question_id": 53180599, "link": "https://stackoverflow.com/questions/53180599/function-without-parameters", "title": "Function without parameters", "body": "<p>I have this function that counts a range of cells by a colored text. The original function uses two inputs (range and text color) as parameters. As I\u00b4m using it at different rows, I want that calculate the dynamic cells range automatically, but I don't know how to manage that parameters inside a vba function. This is my code. Hope someone can give me a hand... regards, M.</p>\n\n<pre><code>Function CountByColor()\n'Function CountByColor(rng, cell)\nApplication.Volatile\n\nSet MyCell = ActiveCell.Address\n\nActiveCell.Offset(-1, -2).Select\nRange(Selection, Selection.End(xlUp)).Select\nSet MyRange = ActiveSheet.UsedRange\n\n'Set zRange = rng\n\nSet zRange = MyRange\nSet zCell = MyCell.Offset(0, -1)\n\nzValue = cell.Value\nzFontColor = zCell.font.color\nzCellColor = zCell.Interior.color\n\nCountByColor = 0\n\nOn Error Resume Next\nFor Each cell In zRange\n    If cell.Value = zValue Then\n        If cell.font.color = zFontColor Then\n            If cell.Interior.color = zCellColor Then\n            CountByColor = CountByColor + 1\n            End If\n        End If\n    End If\nNext\nOn Error GoTo 0\n\nEnd Function\n</code></pre>\n\n<p>The range parameter is created by \"activecell.offset(-1, -2).select\", and the text colored reference cell by \"mycell.offset(0, -1)...</p>\n\n<p><a href=\"https://i.stack.imgur.com/xtg5X.jpg\" rel=\"nofollow noreferrer\">This is my worksheet...</a></p>\n"}, {"tags": ["excel", "vba", "web-scraping", "automation"], "answers": [{"comments": [{"owner": {"reputation": 175, "user_id": 6847397, "user_type": "registered", "profile_image": "https://graph.facebook.com/865166940350454/picture?type=large", "display_name": "Nelman Jay Louie Vasquez", "link": "https://stackoverflow.com/users/6847397/nelman-jay-louie-vasquez"}, "edited": false, "score": 0, "creation_date": 1541542923, "post_id": 53180845, "comment_id": 93252007, "body": "Adding a <code>Set ws = Nothing</code>, <code>Set clipboard = Nothing</code>, and <code>Set html = Nothing</code> at the end. You need to clean the mess."}, {"owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "reply_to_user": {"reputation": 175, "user_id": 6847397, "user_type": "registered", "profile_image": "https://graph.facebook.com/865166940350454/picture?type=large", "display_name": "Nelman Jay Louie Vasquez", "link": "https://stackoverflow.com/users/6847397/nelman-jay-louie-vasquez"}, "edited": false, "score": 1, "creation_date": 1541543289, "post_id": 53180845, "comment_id": 93252131, "body": "@NELMVN It&#39;s my understanding that garbage collection will take care of that anyway, since the object references will go out of scope at the end of the procedure. Maybe I&#39;m wrong."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "edited": false, "score": 0, "creation_date": 1541543470, "post_id": 53180845, "comment_id": 93252204, "body": "NELMVN As pointed out by @chillin  this will be cleared up when the sub goes out of scope.Object variables will release their reference and the runtime calls the object\u2019s Release method to decrement the object\u2019s reference count. This is the same as set x = Nothing."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1541542593, "last_edit_date": 1541542593, "creation_date": 1541542279, "answer_id": 53180845, "question_id": 53180509, "link": "https://stackoverflow.com/questions/53180509/x-rates-excel-vba-data-pulling/53180845#53180845", "title": "x-rates Excel VBA data pulling", "body": "<p>You can use the following. It uses <a href=\"https://codingislove.com/http-requests-excel-vba/\" rel=\"nofollow noreferrer\">XMLHTTP</a> as a faster retrieval method. Concatenates yesterday's date into the URL to get the latest rates. The alphabetized table is selected by its class name and index position.</p>\n\n<pre><code>Option Explicit\nPublic Sub GetTable()\n    Dim sResponse As String, html As HTMLDocument, ws As Worksheet, clipboard As Object\n\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n\n    With CreateObject(\"MSXML2.XMLHTTP\")\n        .Open \"GET\", \"https://www.x-rates.com/historical/?from=CAD&amp;amount=1&amp;date=\" &amp; Format$(Date - 1, \"yyyy-mm-dd\"), False\n        .setRequestHeader \"If-Modified-Since\", \"Sat, 1 Jan 2000 00:00:00 GMT\"\n        .send\n        sResponse = StrConv(.responseBody, vbUnicode)\n    End With\n\n    Set clipboard = GetObject(\"New:{1C3B4210-F441-11CE-B9EA-00AA006B1A69}\")\n    Set html = New HTMLDocument\n\n    With html\n        .body.innerHTML = sResponse\n        clipboard.SetText .querySelectorAll(\".ratesTable\").item(1).outerHTML\n        clipboard.PutInClipboard\n    End With     \n    ws.Cells(1, 1).PasteSpecial \nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>References (VBE > Tools > References):</strong></p>\n\n<ol>\n<li>Microsoft HTML Object Library</li>\n</ol>\n"}], "owner": {"reputation": 23, "user_id": 10051492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5e153b20c6ff90439eb110223394368?s=128&d=identicon&r=PG&f=1", "display_name": "Patio", "link": "https://stackoverflow.com/users/10051492/patio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 235, "favorite_count": 1, "accepted_answer_id": 53180845, "answer_count": 1, "score": 1, "last_activity_date": 1586402852, "creation_date": 1541540590, "last_edit_date": 1586402852, "question_id": 53180509, "link": "https://stackoverflow.com/questions/53180509/x-rates-excel-vba-data-pulling", "title": "x-rates Excel VBA data pulling", "body": "<p>I am pretty new to Excel VBA and I'm having trouble pulling data from this website: <a href=\"https://www.x-rates.com/historical/?from=CAD&amp;amount=1&amp;date=2018-11-05\" rel=\"nofollow noreferrer\">https://www.x-rates.com/historical/?from=CAD&amp;amount=1&amp;date=2018-11-05</a>. I would like to automate this process so I can get these rates every month. This is as far as I have gotten and I get lost from here:</p>\n\n<p>'start a new subroutine called SearchBot</p>\n\n<p>Sub SearchBot()</p>\n\n<pre><code>'dimension (declare or set aside memory for) our variables\nDim objIE As InternetExplorer 'special object variable representing the IE browser\nDim aEle As HTMLLinkElement 'special object variable for an &lt;a&gt; (link) element\nDim y As Integer 'integer variable we'll use as a counter\nDim result As String 'string variable that will hold our result link\n\n'initiating a new instance of Internet Explorer and asigning it to objIE\nSet objIE = New InternetExplorer\n\n'make IE browser visible (False would allow IE to run in the background)\nobjIE.Visible = True\n\n'navigate IE to this web page (a pretty neat search engine really)\nobjIE.navigate \"https://www.x-rates.com/table/?from=CAD&amp;amount=1\"\n</code></pre>\n\n<p>Any help would be appreciated!</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 1854, "user_id": 6071871, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IfFKy.jpg?s=128&g=1", "display_name": "ArcherBird", "link": "https://stackoverflow.com/users/6071871/archerbird"}, "edited": false, "score": 1, "creation_date": 1541540216, "post_id": 53180275, "comment_id": 93250906, "body": "I&#39;m having some trouble following exactly what you want. What objects do you currently have on your form. I understand there is a comboBox - when the user changes the comboBox - are you trying to take the selected value, and set the rowsource of another form object?"}, {"owner": {"reputation": 287, "user_id": 8565299, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e36f101da38488b09818d1a06932847d?s=128&d=identicon&r=PG&f=1", "display_name": "dvd.Void", "link": "https://stackoverflow.com/users/8565299/dvd-void"}, "reply_to_user": {"reputation": 1854, "user_id": 6071871, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IfFKy.jpg?s=128&g=1", "display_name": "ArcherBird", "link": "https://stackoverflow.com/users/6071871/archerbird"}, "edited": false, "score": 0, "creation_date": 1541540609, "post_id": 53180275, "comment_id": 93251071, "body": "No, The form has multiple fields (IE, part number, description, manufacturer, country of origin etc). Part numbers are unique but say we buy 10 articles from the same manufacturer, they all come from the same country and a lot of the properties are the same. To avoid retyping everything I want the user to just select manufacturer from a combo box and have all the fields initially blank in the form pre-filled"}, {"owner": {"reputation": 1854, "user_id": 6071871, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IfFKy.jpg?s=128&g=1", "display_name": "ArcherBird", "link": "https://stackoverflow.com/users/6071871/archerbird"}, "edited": false, "score": 0, "creation_date": 1541540883, "post_id": 53180275, "comment_id": 93251193, "body": "can you guarantee that you will only have one option from your query for each blank field? Or would you just use whatever is in the first record?"}, {"owner": {"reputation": 287, "user_id": 8565299, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e36f101da38488b09818d1a06932847d?s=128&d=identicon&r=PG&f=1", "display_name": "dvd.Void", "link": "https://stackoverflow.com/users/8565299/dvd-void"}, "reply_to_user": {"reputation": 1854, "user_id": 6071871, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IfFKy.jpg?s=128&g=1", "display_name": "ArcherBird", "link": "https://stackoverflow.com/users/6071871/archerbird"}, "edited": false, "score": 0, "creation_date": 1541541118, "post_id": 53180275, "comment_id": 93251279, "body": "Yes, the search query is on a table ID, unique values only"}], "answers": [{"comments": [{"owner": {"reputation": 287, "user_id": 8565299, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e36f101da38488b09818d1a06932847d?s=128&d=identicon&r=PG&f=1", "display_name": "dvd.Void", "link": "https://stackoverflow.com/users/8565299/dvd-void"}, "edited": false, "score": 0, "creation_date": 1541541880, "post_id": 53180365, "comment_id": 93251603, "body": "Hi, thanks for that. Question, the rs definition, is that a query you are making? I had already made a query that gave me the results I wanted I dont know if that would help at all. Something like If Nz(Me.txtbox.Value, &quot;&quot;) = &quot;&quot; Then Me.txtBox = myQuery.results.field1 (or something like that, I dont really know VBA much)"}, {"owner": {"reputation": 1854, "user_id": 6071871, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IfFKy.jpg?s=128&g=1", "display_name": "ArcherBird", "link": "https://stackoverflow.com/users/6071871/archerbird"}, "reply_to_user": {"reputation": 287, "user_id": 8565299, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e36f101da38488b09818d1a06932847d?s=128&d=identicon&r=PG&f=1", "display_name": "dvd.Void", "link": "https://stackoverflow.com/users/8565299/dvd-void"}, "edited": false, "score": 0, "creation_date": 1541541984, "post_id": 53180365, "comment_id": 93251648, "body": "@dvd.Void if you have a query object built already, you can open the recordset by referencing the query object&#39;s name. like: <code>Set rs = CurrentDb.OpenRecordset(&quot;MyQueryName&quot;)</code> the rest would be the same."}, {"owner": {"reputation": 1854, "user_id": 6071871, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IfFKy.jpg?s=128&g=1", "display_name": "ArcherBird", "link": "https://stackoverflow.com/users/6071871/archerbird"}, "reply_to_user": {"reputation": 287, "user_id": 8565299, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e36f101da38488b09818d1a06932847d?s=128&d=identicon&r=PG&f=1", "display_name": "dvd.Void", "link": "https://stackoverflow.com/users/8565299/dvd-void"}, "edited": false, "score": 0, "creation_date": 1541542728, "post_id": 53180365, "comment_id": 93251942, "body": "@dvd.Void - PS - if your query has parameters, the set up is a little different. Let me know if this helps :-)"}, {"owner": {"reputation": 287, "user_id": 8565299, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e36f101da38488b09818d1a06932847d?s=128&d=identicon&r=PG&f=1", "display_name": "dvd.Void", "link": "https://stackoverflow.com/users/8565299/dvd-void"}, "edited": false, "score": 0, "creation_date": 1541543971, "post_id": 53180365, "comment_id": 93252405, "body": "Hi, yes the query has parameters based on the comboBox. (Basically the query returns the vendor from the combo box selection). As of now with the code you suggested I get &quot;Run-time error &#39;3061: too few parameters. Expected 1&quot;. Edited OP with code"}, {"owner": {"reputation": 1854, "user_id": 6071871, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IfFKy.jpg?s=128&g=1", "display_name": "ArcherBird", "link": "https://stackoverflow.com/users/6071871/archerbird"}, "reply_to_user": {"reputation": 287, "user_id": 8565299, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e36f101da38488b09818d1a06932847d?s=128&d=identicon&r=PG&f=1", "display_name": "dvd.Void", "link": "https://stackoverflow.com/users/8565299/dvd-void"}, "edited": false, "score": 0, "creation_date": 1541544262, "post_id": 53180365, "comment_id": 93252533, "body": "@dvd.Void - I&#39;ve updated my answer to help with passing parameters and opening the recordset. Hope this helps."}, {"owner": {"reputation": 287, "user_id": 8565299, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e36f101da38488b09818d1a06932847d?s=128&d=identicon&r=PG&f=1", "display_name": "dvd.Void", "link": "https://stackoverflow.com/users/8565299/dvd-void"}, "edited": false, "score": 0, "creation_date": 1541545068, "post_id": 53180365, "comment_id": 93252862, "body": "Thanks for the quick feedback. Current error says &quot;3265: Item not found in this collection&quot;. I am curious as to why, the combo box itself loads from the table so I&#39;m not changing anything or typing anything at all. I am not sure if maybe the Parameter might be the issue? (I already have some set parameters in the query design itself ([Forms]![NewItem]![LoadMatCB])"}, {"owner": {"reputation": 287, "user_id": 8565299, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e36f101da38488b09818d1a06932847d?s=128&d=identicon&r=PG&f=1", "display_name": "dvd.Void", "link": "https://stackoverflow.com/users/8565299/dvd-void"}, "edited": false, "score": 0, "creation_date": 1541545373, "post_id": 53180365, "comment_id": 93252950, "body": "qry.Parameters(&quot;Vendor&quot;) = LoadMatCB.Value. If I highlight the LoadMatCb.Value I can see the correct value that I selected but they first half qry.Parameters(&quot;Vendor&quot;) = &lt;Item not found in this collection&gt;. Thats why I mentioned that my query design already has some calloout to the form&#39;s combobox. I don tknow if this might make some redundancy error. EDIT: Also tried deleting that criteria on the query design. still get the same error"}, {"owner": {"reputation": 1854, "user_id": 6071871, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IfFKy.jpg?s=128&g=1", "display_name": "ArcherBird", "link": "https://stackoverflow.com/users/6071871/archerbird"}, "reply_to_user": {"reputation": 287, "user_id": 8565299, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e36f101da38488b09818d1a06932847d?s=128&d=identicon&r=PG&f=1", "display_name": "dvd.Void", "link": "https://stackoverflow.com/users/8565299/dvd-void"}, "edited": false, "score": 0, "creation_date": 1541545565, "post_id": 53180365, "comment_id": 93253007, "body": "@dvd.Void This usually happens when there are not Parameters set up for the query. If you take a look at your query object&#39;s SQL, it should start with something like <code>PARAMETERS Vendor Text ( 255 );</code> If not, it would seem that no parameters are declared. Try adding that line, or Add the parameter using the Parameters ribbon control in the query&#39;s Design View editor."}, {"owner": {"reputation": 287, "user_id": 8565299, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e36f101da38488b09818d1a06932847d?s=128&d=identicon&r=PG&f=1", "display_name": "dvd.Void", "link": "https://stackoverflow.com/users/8565299/dvd-void"}, "edited": false, "score": 0, "creation_date": 1541546098, "post_id": 53180365, "comment_id": 93253175, "body": "You are correct, it didnt have that line. However with that line I dont get the error anymore but regardless of what I select on the drop down list I awlays get the values of the first entry on the table (the query isnt filtering anymore). If I add the &quot;Criteria&quot; on the design view (not the SQL) then I get the error again but now it asks for 2 parameters instead of 1. (Before it said Expected 1, now it says Expected 2_"}, {"owner": {"reputation": 1854, "user_id": 6071871, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IfFKy.jpg?s=128&g=1", "display_name": "ArcherBird", "link": "https://stackoverflow.com/users/6071871/archerbird"}, "reply_to_user": {"reputation": 287, "user_id": 8565299, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e36f101da38488b09818d1a06932847d?s=128&d=identicon&r=PG&f=1", "display_name": "dvd.Void", "link": "https://stackoverflow.com/users/8565299/dvd-void"}, "edited": false, "score": 0, "creation_date": 1541546314, "post_id": 53180365, "comment_id": 93253250, "body": "With a Parameter now declared in your query object, you should be using it somewhere in the <code>WHERE</code> clause, right? So somewhere in the SQL you should have <code>...WHERE table.vender = Vender...</code> My guess is that you have this hardcoded to something instead of using the Parameter....?"}, {"owner": {"reputation": 287, "user_id": 8565299, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e36f101da38488b09818d1a06932847d?s=128&d=identicon&r=PG&f=1", "display_name": "dvd.Void", "link": "https://stackoverflow.com/users/8565299/dvd-void"}, "edited": false, "score": 0, "creation_date": 1541546836, "post_id": 53180365, "comment_id": 93253388, "body": "THank you. Got it fixed. I was using the GUI to set up the Criteria and filters of the query. Had to set them manually via the SQL &quot;code&quot; or whatever. using WHERE statement.  Thanks!"}], "tags": [], "owner": {"reputation": 1854, "user_id": 6071871, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IfFKy.jpg?s=128&g=1", "display_name": "ArcherBird", "link": "https://stackoverflow.com/users/6071871/archerbird"}, "is_accepted": true, "score": 3, "last_activity_date": 1550354695, "last_edit_date": 1550354695, "creation_date": 1541539990, "answer_id": 53180365, "question_id": 53180275, "link": "https://stackoverflow.com/questions/53180275/ms-access-how-to-load-data-from-query-into-form/53180365#53180365", "title": "MS Access: How to load data from query into form", "body": "<p>You will need to use the table's ID field to grab the related record from your query into a recordset object. You can then use the fields of the recordset to set the value in each of the other fields you want to populate; you can add the if statements to check if the controls are blank if that is a condition you need.</p>\n\n<pre><code>    Dim rs As Recordset\n    Dim db as Database\n    Dim qry as QueryDef\n\n    Set db = CurrentDb\n    Set qry = db.QueryDefs(\"YourQueryName\")\n\n    qry.Parameters(\"ParamName\") = comboBox.Value '&lt;pass your parameter here&gt;\n    'repeat the above for any other parameters you need to pass\n\n    Set rs = qry.OpenRecordset\n\n    'for each of these, use your control names and whatever you named the fields from your query'\n    If Nz(Me.txtBox1.Value, \"\") = \"\" Then Me.txtBox1 = rs![fieldName1] \n    If Nz(Me.txtBox2.Value, \"\") = \"\" Then Me.txtBox2 = rs![fieldName2]\n    ...\n    ...\n    If Nz(Me.txtBoxN.Value, \"\") = \"\" Then Me.txtBoxN = rs![fieldNameN]\n\n    Set rs = Nothing\n    Set qry = Nothing\n    Set db = Nothing\n</code></pre>\n"}], "owner": {"reputation": 287, "user_id": 8565299, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e36f101da38488b09818d1a06932847d?s=128&d=identicon&r=PG&f=1", "display_name": "dvd.Void", "link": "https://stackoverflow.com/users/8565299/dvd-void"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1544, "favorite_count": 0, "accepted_answer_id": 53180365, "answer_count": 1, "score": 1, "last_activity_date": 1550354695, "creation_date": 1541539627, "last_edit_date": 1541544080, "question_id": 53180275, "link": "https://stackoverflow.com/questions/53180275/ms-access-how-to-load-data-from-query-into-form", "title": "MS Access: How to load data from query into form", "body": "<p>I have a form that helps the user add some data into a Database, however I noticed that a few of the fields on each product added are very similar. So I'm adding a second database of commonly used fields that can be pre-filled by selecting from a combo-box.<br>\nFor example if the user is adding Product XX-X but product XX-X is of the same family of YY-Y and I already have YY-Y's data in Database2, I want to just load those parameters. I made a query that returns the parameters as I want however I dont know how to add this to the FORM.<br>\nBasically I have a blank VBA code slot for \"ComboBox_Change\".<br>\nI want the ComboBox_Change function to load field X from query and paste it into field X1 on the current form.\nHope I'm explaining myself correctly.<br>\nThanks!  </p>\n\n<p><em>THANKS for the suggestion</em> this is the code so far that has an error</p>\n\n<pre><code>Private Sub LoadMatCB_Change()\nDim rs As Recordset\nDim db As Database\n\nSet db = CurrentDb\n\nSet rs = CurrentDb.OpenRecordset(\"VendorDeetsQuery\")\n\nIf Nz(Me.Input_Vendor.Value, \"\") = \"\" Then Me.Input_Vendor.Value = rs![Origin]\n\nSet rs = Nothing\nSet db = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "sas"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1541540798, "post_id": 53180226, "comment_id": 93251148, "body": "Sounds like there may be a problem with your code, which is why it&#39;s usually useful to include it in your question.  There&#39;s not much we can offer without knowing what your code does and how it does it."}, {"owner": {"reputation": 1, "user_id": 10597601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a173928af6ae0b4d735f12cd5c75e98?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/10597601/max"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1541541011, "post_id": 53180226, "comment_id": 93251242, "body": "Thanks Tim, I thought that would be too complicated..  I can&#39;t post more than 550 chars so here is formatting step1"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1541541446, "post_id": 53180226, "comment_id": 93251416, "body": "<i>Edit your question</i> - you can add code there and format it using the <code>{}</code> button"}, {"owner": {"reputation": 1, "user_id": 10597601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a173928af6ae0b4d735f12cd5c75e98?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/10597601/max"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1541541463, "post_id": 53180226, "comment_id": 93251424, "body": "found the error, Sorry for wasting your time"}, {"owner": {"reputation": 1, "user_id": 10597601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a173928af6ae0b4d735f12cd5c75e98?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/10597601/max"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1541541682, "post_id": 53180226, "comment_id": 93251514, "body": "Sorry, stupid mistake in SAS code :("}], "owner": {"reputation": 1, "user_id": 10597601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a173928af6ae0b4d735f12cd5c75e98?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/10597601/max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1586402888, "creation_date": 1541539422, "last_edit_date": 1586402888, "question_id": 53180226, "link": "https://stackoverflow.com/questions/53180226/sas-csv-data-disappears-after-vba-formatting", "title": "SAS/CSV data disappears after VBA formatting", "body": "<p>I am importing a table from a CSV file updated by a SAS script that skips line in order for me to then use VBA to put formulas to get different results and divide them. However, when I Refresh the SAS data from the CSV, I have, for example, my targets, and once the formatting VBA portion comes in, some of the SAS data disappears. Does anyone know why?</p>\n"}, {"tags": ["excel", "vba", "if-statement", "drop-down-menu"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 10291987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c714da1deecc278bc26304e4fcd6120?s=128&d=identicon&r=PG&f=1", "display_name": "Abby", "link": "https://stackoverflow.com/users/10291987/abby"}, "edited": false, "score": 0, "creation_date": 1541615082, "post_id": 53182794, "comment_id": 93279673, "body": "Ok, I deleted the exit subs, but no change. Definitely works the first time I use one of the dropdowns. Thanks anyway, Art."}, {"owner": {"reputation": 116, "user_id": 5982062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HFQvV.jpg?s=128&g=1", "display_name": "wallyeye", "link": "https://stackoverflow.com/users/5982062/wallyeye"}, "reply_to_user": {"reputation": 21, "user_id": 10291987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c714da1deecc278bc26304e4fcd6120?s=128&d=identicon&r=PG&f=1", "display_name": "Abby", "link": "https://stackoverflow.com/users/10291987/abby"}, "edited": false, "score": 0, "creation_date": 1541641683, "post_id": 53182794, "comment_id": 93289475, "body": "If you put a breakpoint on the target.column = 2 (select it and press F9), then change a value in column C, you can use the F8 key to step through the logic to see what isn\u2019t doing what you expect. From here the code looks ok"}, {"owner": {"reputation": 116, "user_id": 5982062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HFQvV.jpg?s=128&g=1", "display_name": "wallyeye", "link": "https://stackoverflow.com/users/5982062/wallyeye"}, "reply_to_user": {"reputation": 21, "user_id": 10291987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c714da1deecc278bc26304e4fcd6120?s=128&d=identicon&r=PG&f=1", "display_name": "Abby", "link": "https://stackoverflow.com/users/10291987/abby"}, "edited": false, "score": 0, "creation_date": 1541641949, "post_id": 53182794, "comment_id": 93289536, "body": "You also might need to turn events back on, you can use the immediate window (Carl-g) to run the application.enableevets= true"}, {"owner": {"reputation": 21, "user_id": 10291987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c714da1deecc278bc26304e4fcd6120?s=128&d=identicon&r=PG&f=1", "display_name": "Abby", "link": "https://stackoverflow.com/users/10291987/abby"}, "edited": false, "score": 0, "creation_date": 1541783311, "post_id": 53182794, "comment_id": 93347367, "body": "Adding application.enableevents = true at the end of each expression block worked. Really pleased to get this working, thanks so much for your time, Art."}], "tags": [], "owner": {"reputation": 116, "user_id": 5982062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HFQvV.jpg?s=128&g=1", "display_name": "wallyeye", "link": "https://stackoverflow.com/users/5982062/wallyeye"}, "is_accepted": false, "score": 0, "last_activity_date": 1541557223, "creation_date": 1541557223, "answer_id": 53182794, "question_id": 53180176, "link": "https://stackoverflow.com/questions/53180176/how-can-i-use-vba-to-enable-multiple-excel-drop-down-lists-that-enter-a-differen/53182794#53182794", "title": "How can I use VBA to enable multiple Excel drop down lists that enter a different value from what the user selects?", "body": "<p>You can remove the exit subs in the if statements, the logic will drop out anyway.  The current exit subs will not allow the application.enableevents= true to execute and the event processing will stop </p>\n\n<p>I can\u2019t seem to comment, don\u2019t think this is really a full answer for you.</p>\n"}], "owner": {"reputation": 21, "user_id": 10291987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c714da1deecc278bc26304e4fcd6120?s=128&d=identicon&r=PG&f=1", "display_name": "Abby", "link": "https://stackoverflow.com/users/10291987/abby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 144, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1541557223, "creation_date": 1541539214, "last_edit_date": 1541540859, "question_id": 53180176, "link": "https://stackoverflow.com/questions/53180176/how-can-i-use-vba-to-enable-multiple-excel-drop-down-lists-that-enter-a-differen", "title": "How can I use VBA to enable multiple Excel drop down lists that enter a different value from what the user selects?", "body": "<p>This is my first attempt at using VBA. I'm adapting a script offered by Contextures.com that goes with \"Excel drop down list automatically changes product name to code\" (<a href=\"https://www.youtube.com/watch?v=uLJEMnIT0zM\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=uLJEMnIT0zM</a>). I've successfully created on dropdown that adds the ID that is associated with the parameter type that a user selected (e.g. when the user selects \"Chlorophyll\" from a dropdown on the data entry Excel worksheet, Excel enters the ID number associated with that parameter name in the same cell, based on a list contained in a table on a second worksheet). However, when I try to add more options, the script stops working. The adapted code adds two ElseIf statements for other column dropdowns. </p>\n\n<p>When the script runs it doesn't report any errors. Also, oddly, it occasionally works on the first go. The code is below. </p>\n\n<p>Many thanks in advance for your assistance. </p>\n\n<hr>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\nIf Target.Cells.Count &gt; 1 Then GoTo exitHandler\n\nIf Target.Column = 2 Then\n    If Target.Value = \"\" Then GoTo exitHandler\n    Application.EnableEvents = False\n    Target.Value = Worksheets(\"CHLA Maps\").Range(\"B1\") _\n        .Offset(Application.WorksheetFunction _\n        .Match(Target.Value, Worksheets(\"CHLA Maps\").Range(\"paramTypeList\"), 0), 0)\nExit Sub\n\nElseIf Target.Column = 3 Then\n    If Target.Value = \"\" Then GoTo exitHandler\n    Application.EnableEvents = False\n    Target.Value = Worksheets(\"CHLA Maps\").Range(\"F1\") _\n        .Offset(Application.WorksheetFunction _\n        .Match(Target.Value, Worksheets(\"CHLA Maps\").Range(\"labMethodList\"), 0), 0)\n    Exit Sub    \nElseIf Target.Column = 4 Then\n    If Target.Value = \"\" Then GoTo exitHandler\n    Application.EnableEvents = False\n    Target.Value = Worksheets(\"CHLA Maps\").Range(\"J1\") _\n        .Offset(Application.WorksheetFunction _\n        .Match(Target.Value, Worksheets(\"CHLA Maps\").Range(\"parameterQCCodeList\"), 0), 0)\n    Exit Sub\nElse\n    Exit Sub   \nEnd If\nexitHandler:\n    Application.EnableEvents = True\n    Exit Sub\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 4, "creation_date": 1541541302, "post_id": 53180162, "comment_id": 93251357, "body": "Have you tried <code>.Columns(&quot;N:S&quot;).HorizontalAlignment = xlGeneral</code>?"}, {"owner": {"reputation": 663, "user_id": 7131122, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VRUK1MTcgY4/AAAAAAAAAAI/AAAAAAAAA_8/VlNsZARthCY/photo.jpg?sz=128", "display_name": "Christofer Weber", "link": "https://stackoverflow.com/users/7131122/christofer-weber"}, "edited": false, "score": 0, "creation_date": 1541542016, "post_id": 53180162, "comment_id": 93251659, "body": "<code>Range(&quot;N:P,R:S&quot;).HorizontalAlignment = xlGeneral</code> or if you have to refer to them as numbers, something like <code>Union(Range(Columns(14), Columns(16)), Range(Columns(18), Columns(19))).HorizontalAlignment = xlGeneral</code> Maybe?"}, {"owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1541601540, "post_id": 53180162, "comment_id": 93271990, "body": "@MathieuGuindon thanks a bunch!"}], "owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1586402924, "creation_date": 1541539175, "last_edit_date": 1586402924, "question_id": 53180162, "link": "https://stackoverflow.com/questions/53180162/is-there-a-way-to-truncate-this-horizontal-alignment", "title": "is there a way to truncate this horizontal alignment?", "body": "<p>I have to align a ton columns to general and left, and I tried doing things like <code>with ws</code> and then <code>.columns(1,3,10,15).horizontalalignment = xlGeneral</code> but it seems to only be allowing me to do each column alignment as one row of code at a time. </p>\n\n<p>How can I condense this: </p>\n\n<pre><code>.Columns(14).HorizontalAlignment = xlGeneral\n.Columns(15).HorizontalAlignment = xlGeneral\n.Columns(16).HorizontalAlignment = xlGeneral\n.Columns(18).HorizontalAlignment = xlGeneral\n.Columns(19).HorizontalAlignment = xlGeneral\n.Columns(17).HorizontalAlignment = xlLeft\n.Columns(20).HorizontalAlignment = xlLeft\n</code></pre>\n\n<p>to only two lines of code <code>xlGeneral</code> and <code>xlLeft</code> for the columns I specify?</p>\n"}, {"tags": ["excel", "vba", "file", "runtime"], "answers": [{"comments": [{"owner": {"reputation": 812, "user_id": 5457466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/438a24229b00e5d4327425c37518aca7?s=128&d=identicon&r=PG&f=1", "display_name": "Egalth", "link": "https://stackoverflow.com/users/5457466/egalth"}, "edited": false, "score": 0, "creation_date": 1541580455, "post_id": 53179969, "comment_id": 93261462, "body": "Exactly what I needed, thanks! +1 for the not-so-intuitive string concatenation that is omitted from the <a href=\"https://support.office.com/en-us/article/Shell-Function-FF2E4B1B-712D-4E34-AEA6-6832EADD3C63\" rel=\"nofollow noreferrer\">documentation</a>."}], "tags": [], "owner": {"reputation": 175, "user_id": 6847397, "user_type": "registered", "profile_image": "https://graph.facebook.com/865166940350454/picture?type=large", "display_name": "Nelman Jay Louie Vasquez", "link": "https://stackoverflow.com/users/6847397/nelman-jay-louie-vasquez"}, "is_accepted": true, "score": 1, "last_activity_date": 1541538250, "creation_date": 1541538250, "answer_id": 53179969, "question_id": 53179786, "link": "https://stackoverflow.com/questions/53179786/open-text-file-at-runtime-for-manual-editing/53179969#53179969", "title": "Open text file at runtime for manual editing", "body": "<pre><code>Dim yourTextFile As String: yourTextFile = \"C:\\Sample.txt\"\n\nCall Shell(\"notepad.exe \"\"\" &amp; yourTextFile &amp; \"\"\"\", vbNormalFocus)\n</code></pre>\n\n<p>Use <code>Shell</code> to open a selected text file.</p>\n"}], "owner": {"reputation": 812, "user_id": 5457466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/438a24229b00e5d4327425c37518aca7?s=128&d=identicon&r=PG&f=1", "display_name": "Egalth", "link": "https://stackoverflow.com/users/5457466/egalth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "accepted_answer_id": 53179969, "answer_count": 1, "score": 0, "last_activity_date": 1541538250, "creation_date": 1541537276, "question_id": 53179786, "link": "https://stackoverflow.com/questions/53179786/open-text-file-at-runtime-for-manual-editing", "title": "Open text file at runtime for manual editing", "body": "<p>The code snippet below is modified from a larger project where I collect data from text files and output that data to an Excel Table (VBA listobject). The code loops through all the text files in a specified folder looking for files that match certain conditions. Valid files have a header containing the tag <code>## DATA FILE ##</code> on the first line, and some metadata on the next few lines. I am using the <code>FileSystemObject</code> from Microsoft Scripting Runtime to open those files and loop through line by line. For this example I assume that I have a text file in the folder <code>C:\\MyFolder</code> with a valid tag on the first line, for example with the following content:</p>\n\n<pre><code>## DATA FILE ##\nVersion: 49\n\n123 456 789 Some information\n111 444 000 Further items\n</code></pre>\n\n<p>With this setup, the code below should execute smoothly and output \"Test passed\" to the immediate window. If the tag line is modified, the code should instead present a message box asking the user for further instructions.</p>\n\n<p>Now, if a text file does not contain the necessary tag on the first line, I would like to add the option to manually open and edit that file in Notepad at runtime, and then continue execution. I've prepared a Yes-No-Cancel message box that can be used to decide what to do, but how can I open the file for manual editing at runtime?</p>\n\n<pre><code>Option Explicit\n\nSub LoopThroughFiles()\n' Loops through text files looking for files matching some conditions.\n' Files that match are processed further.\n' For files that don't match, the user can choose to inspect and\n' modify the source file.\n' Requires that a reference is set to Tools -&gt; References\n'   -&gt; Microsoft Scripting Runtime\n\n    Dim FSO As FileSystemObject\n    Dim TSO As TextStream\n    Dim oFolder, oFile As Object\n    Dim sFileName, sLine, sMsg As String\n    Dim lMsg As Long\n    Const sPath As String = \"C:\\MyFolder\\\"\n\n    Set FSO = CreateObject(\"Scripting.FileSystemObject\")\n    Set oFolder = FSO.GetFolder(sPath)\n\n    ' Loop through files:\n    For Each oFile In oFolder.Files\n        sFileName = oFile.Name\n        ' Treat only text files:\n        If Right(sFileName, 4) = \".txt\" Then\n            Set TSO = FSO.OpenTextFile(sPath &amp; sFileName, ForReading)\n            ' Check that conditions are met:\n            sLine = TSO.ReadLine\n            If Not sLine = \"## DATA FILE ##\" Then\n                sMsg = \"The following file does not seem to \" &amp; _\n                        \"contain valid input data:\" &amp; vbNewLine &amp; vbNewLine\n                sMsg = sMsg &amp; sFileName &amp; vbNewLine &amp; vbNewLine\n                sMsg = sMsg &amp; \"Would you like to manually inspect \" &amp; _\n                        \"the file?\" &amp; vbNewLine &amp; _\n                        \"(Click No to continue running the script \" &amp; _\n                        \"; Cancel to exit.)\"\n                lMsg = MsgBox(sMsg, vbYesNoCancel)\n                Debug.Print lMsg\n                Stop\n                '\n                ' OPTION HERE TO MANUALLY OPEN AND EDIT THE TEXT FILE IN NOTEPAD\n                '\n            Else\n                Debug.Print \"Test passed\"\n                ' Other code here to further process valid data.\n            End If\n            TSO.Close\n        End If\n    Next oFile\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "powerpoint"], "owner": {"reputation": 11, "user_id": 7859479, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-u3F_N0vw-O8/AAAAAAAAAAI/AAAAAAAAK_A/spIhhNCEuWk/photo.jpg?sz=128", "display_name": "Meredith V.", "link": "https://stackoverflow.com/users/7859479/meredith-v"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 221, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1541536631, "creation_date": 1541536631, "question_id": 53179638, "link": "https://stackoverflow.com/questions/53179638/looping-through-ranges-to-print-specific-slides-in-powerpoint-with-vba", "title": "Looping through ranges to print specific slides in powerpoint with VBA", "body": "<p>I've tried to print with this, or a macro similar and it worked, I exported, then excel crashed.  I then was not able to get this to work after relaunching.</p>\n\n<p>The macro should loop a number of times input by the user, then prints the first slide (title) and 5 additional slides indexes in multiples of the number of times looped onto a 6 slide handout.  </p>\n\n<ul>\n<li>First page: 1, 3-7</li>\n<li>Second page: 1, 8-12</li>\n<li>Third page: 1, 13-17</li>\n<li>etc.</li>\n</ul>\n\n<p>This now throws an error:</p>\n\n<blockquote>\n  <p>Run-time error '-2147467259 (80004005)</p>\n  \n  <p>Method 'PrintOut' of object '_Presentation' failed</p>\n</blockquote>\n\n<p>Below is my script.  Ideas?</p>\n\n<pre><code>Sub CHPrint()\n\n    Dim oIndexArray(0 To 5) As Integer, slideIndexArray(0 To 5) As Integer, numCases As Integer\n\n    ' Prompt user for how many cases to print (# pages, # loops)\n    numCases = InputBox(\"How many cases to print?\")\n\n    ' Initialize first index of array to 1 (first slide).  This will not change.\n    slideIndexArray(0) = 1\n\n    ' Initialize other indices of array to the first set of slides to print (3-7)\n    For i = 1 To 5\n        oIndexArray(i) = 3 + (i - 1)\n        slideIndexArray(i) = oIndexArray(i)\n        Next i\n\n    ' For each loop, select slides to print (1&amp;3-7; 1&amp;8-12; 1&amp;13-17; etc.) and print\n    For i = 0 To numCases - 1\n\n        ActivePresentation.Slides.Range(slideIndexArray).Select\n\n        With ActivePresentation\n            With .PrintOptions\n                .ActivePrinter = \"LN104142 on LocalHost\"\n                '.ActivePrinter = \"Adobe PDF\"\n                .OutputType = ppPrintOutputSixSlideHandouts\n                .RangeType = ppPrintSelection\n                End With\n            .PrintOut  ' \"method 'printout' of object '_presentation' failed\"\n\n            End With\n\n            ' For each time through the first loop (i), reinitialize selection (1&amp;3-7; 1&amp;8-12; 1&amp;13-17; etc.)\n            For j = 1 To 5\n                slideIndexArray(j) = oIndexArray(j) + (5 * (i + 1))\n            Next j\n\n        Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "pdf", "printing"], "comments": [{"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1541536702, "post_id": 53179493, "comment_id": 93249385, "body": "You should share some code attempt before asking the question, or this would look like you&#39;re asking someone else to write the code for you. I suggest you start with <a href=\"https://stackoverflow.com/a/10382861/3111149\">knowing how to loop through files in a folder</a>, then reading about <a href=\"https://stackoverflow.com/a/22542835/3111149\">RegEx</a> to recognize the last versions, then making a Function which takes in input the current directory, stores all last version file names in a list and return it for using it as you wish (print it, open them etc.)"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1541536898, "post_id": 53179493, "comment_id": 93249482, "body": "Or more easily, while looping through each file you could just <a href=\"https://www.techonthenet.com/excel/formulas/split.php\" rel=\"nofollow noreferrer\">Split</a> each file name by the character <code>_</code>, create a dictionary (with unique values) of each left side of the file name, and then for each of those files get the latest revision by simply reading at the largest numerical value of <code>Replace(Split(fileName,&quot;_&quot;)(1), &quot;.pdf&quot;, &quot;&quot;)</code>."}], "owner": {"reputation": 1, "user_id": 9679396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/354118bfb7c44348745cfdc1f9dba98b?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur", "link": "https://stackoverflow.com/users/9679396/arthur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1541681773, "creation_date": 1541535995, "last_edit_date": 1541681773, "question_id": 53179493, "link": "https://stackoverflow.com/questions/53179493/vba-loop-through-files-and-batch-print-most-recent", "title": "VBA - loop through files and batch print most recent", "body": "<p>I have a working code where the user types the part number and the vba print's all pdf files inside the part number folder.</p>\n\n<p>When there is only one version of the files it is working great, but when a new version is added, I can't figure out how to print only the new version of files.</p>\n\n<p>For example: Part number 1012030. The folder would be \"C\\User\\1012030\\\"\nthen these files are inside:</p>\n\n<p>1000210669_E.pdf (old)<br>\n1000210669_01.pdf (old)                                                                1000210669_02.pdf (new)<br>\n1000210670_01.pdf (old) /1000210670_02.pdf (new)</p>\n\n<p>the first revision is always \"_E\", then comes \"_01\"; \"_02\" and so on..\nthe code would look the the first pdf, loop until it finds the newest revision, print it, move to next file and repeat..</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": false, "score": 1, "last_activity_date": 1541536177, "creation_date": 1541536177, "answer_id": 53179536, "question_id": 53179440, "link": "https://stackoverflow.com/questions/53179440/how-to-remove-zeros-from-the-beginning-of-a-string-using-if-statement/53179536#53179536", "title": "How to remove Zeros from the beginning of a string using IF statement", "body": "<p>Can be achieved without VBA:</p>\n\n<pre><code> =IF(RIGHT(AJ2,2)=\"HK\",1*LEFT(AJ2,FIND(\" \",AJ2))&amp;\" HK\",AJ2)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": false, "score": 0, "last_activity_date": 1541537056, "last_edit_date": 1541537056, "creation_date": 1541536644, "answer_id": 53179648, "question_id": 53179440, "link": "https://stackoverflow.com/questions/53179440/how-to-remove-zeros-from-the-beginning-of-a-string-using-if-statement/53179648#53179648", "title": "How to remove Zeros from the beginning of a string using IF statement", "body": "<p>I suggest to use this function</p>\n\n<pre><code>Function RemoveIt(s As String) As String\n\n    If Right(s, 2) = \"HK\" Then\n\n        Dim i As Long\n        Dim l As Long\n\n        l = Len(s)\n\n        For i = 1 To l\n            If Left(s, 1) = \"0\" Then\n                s = Right(s, Len(s) - 1)\n            Else\n                Exit For\n            End If\n        Next i\n    End If\n\n    RemoveIt = s\n\nEnd Function\n</code></pre>\n\n<p>This will also work for strings like <code>002382HK</code> or <code>00 2304 9HK</code></p>\n"}], "owner": {"reputation": 39, "user_id": 6823279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460f572ac64ab16c7a2982a1c3f07758?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Miller", "link": "https://stackoverflow.com/users/6823279/robert-miller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 1, "closed_date": 1542074966, "answer_count": 2, "score": -1, "last_activity_date": 1586402960, "creation_date": 1541535751, "last_edit_date": 1586402960, "question_id": 53179440, "link": "https://stackoverflow.com/questions/53179440/how-to-remove-zeros-from-the-beginning-of-a-string-using-if-statement", "closed_reason": "Needs more focus", "title": "How to remove Zeros from the beginning of a string using IF statement", "body": "<p>In column AJ I have a list of tickers:</p>\n\n<pre><code>02382 HK\n00700 HK\n0WI GR\n</code></pre>\n\n<p>IF the last two letters are HK I want to remove the zeros at the front. So the above should be:</p>\n\n<pre><code>2382 HK\n700 HK\n0WI GR\n</code></pre>\n\n<p>Thanks for your help</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 4777541, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/093930d1a4d1f600bf0f9c738ca866bf?s=128&d=identicon&r=PG&f=1", "display_name": "rtemen", "link": "https://stackoverflow.com/users/4777541/rtemen"}, "edited": false, "score": 0, "creation_date": 1541538136, "post_id": 53179217, "comment_id": 93250071, "body": "This may not work so easily. The top table may grow and shrink in length as the user works his task. So for example, if the bottom table is 3 worksheet rows below the top table, and the user adds 6 rows, then the 4th row in the top table picks up the taller row from where the bottom table used to start. I then would need to produce code to keep track of what row the bottom table starts on and if the top table grows more than 3 then change the row height. Then keep track of where the new table ends up and increase that row&#39;s height. I was hoping the add row function could automatically do it"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 115, "user_id": 4777541, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/093930d1a4d1f600bf0f9c738ca866bf?s=128&d=identicon&r=PG&f=1", "display_name": "rtemen", "link": "https://stackoverflow.com/users/4777541/rtemen"}, "edited": false, "score": 0, "creation_date": 1541540414, "post_id": 53179217, "comment_id": 93250987, "body": "If you set the table to a range, you can use the range\u2019s <code>rows.count</code> property to adjust for these changes"}], "tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 0, "last_activity_date": 1541534813, "creation_date": 1541534813, "answer_id": 53179217, "question_id": 53179158, "link": "https://stackoverflow.com/questions/53179158/how-to-keep-the-row-height-constant-when-a-table-is-pushed-down-on-the-sheet/53179217#53179217", "title": "How to keep the Row Height constant when a table is pushed down on the sheet", "body": "<p>I am not sure where <code>Target</code>'s range is in reference to the header of the table in question, but you could do something like</p>\n\n<pre><code>rows(target.row).rowheight = 22.5\n</code></pre>\n\n<p>If your header, for example, is always three rows below the <code>Target</code>, then you would just add 3:</p>\n\n<pre><code>rows(target.row + 3).rowheight = 22.5\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": true, "score": 2, "last_activity_date": 1541544143, "last_edit_date": 1541544143, "creation_date": 1541542107, "answer_id": 53180807, "question_id": 53179158, "link": "https://stackoverflow.com/questions/53179158/how-to-keep-the-row-height-constant-when-a-table-is-pushed-down-on-the-sheet/53180807#53180807", "title": "How to keep the Row Height constant when a table is pushed down on the sheet", "body": "<h1>HeaderRowRange.RowHeight</h1>\n\n<p>I've noticed, and you didn't mention, that the '30-height-row moves' into the first table. This should be corrected, too.</p>\n\n<pre><code>Option Explicit\n\nSub HeaderRowRangeRowHeight()\n\n  With Worksheets(\"Summary\")\n    .ListObjects(2).HeaderRowRange.RowHeight = 30\n    .ListObjects(1).DataBodyRange.RowHeight = 15\n    .ListObjects(1).TotalsRowRange.RowHeight = 15\n  End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 4777541, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/093930d1a4d1f600bf0f9c738ca866bf?s=128&d=identicon&r=PG&f=1", "display_name": "rtemen", "link": "https://stackoverflow.com/users/4777541/rtemen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 425, "favorite_count": 0, "accepted_answer_id": 53180807, "answer_count": 2, "score": 1, "last_activity_date": 1541544143, "creation_date": 1541534486, "question_id": 53179158, "link": "https://stackoverflow.com/questions/53179158/how-to-keep-the-row-height-constant-when-a-table-is-pushed-down-on-the-sheet", "title": "How to keep the Row Height constant when a table is pushed down on the sheet", "body": "<p>I have a sheet with 2 tables.\nEach table has a header that I want to be a height of 30 while all table rows are the standard 15.\nWhen I add a row to the top table, the bottom table gets pushed down.\nThe header Height on the bottom table picks up the height of the new spreadsheet row.\nIs there a way to make the bottom table keep its header height at 30?\nHere is my code to add rows to the top table.</p>\n\n<pre><code>            Set tblAssemblies = Worksheets(\"Summary\").ListObjects(\"Table1\")\n            Count = 1\n            Do\n                tblAssemblies.ListRows.Add AlwaysInsert:=True\n                Count = Count + 1\n            Loop While Count &lt;= Target.Value - tblAssembliesRows\n</code></pre>\n\n<p>This pushed the bottom table down, but not the formatting of the sheet row for the header height.\nAny Ideas?</p>\n\n<p>Rich</p>\n"}, {"tags": ["sql-server", "excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1541532787, "post_id": 53178736, "comment_id": 93247559, "body": "Please update your code to show exactly how you&#39;re building the SQL.  This is only half there...   If you <code>Debug.Print</code> the final SQL does it look as you expect?"}, {"owner": {"reputation": 21, "user_id": 9752213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4a52602cbd2e74e677520649afd396f?s=128&d=identicon&r=PG&f=1", "display_name": "prachi", "link": "https://stackoverflow.com/users/9752213/prachi"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1541533584, "post_id": 53178736, "comment_id": 93247913, "body": "If i write the SQL query it works perfectly fine. But in VB it is throwing error."}, {"owner": {"reputation": 470, "user_id": 3454994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5708db369f9b413996a10b1bf06ca40?s=128&d=identicon&r=PG&f=1", "display_name": "Dave Brown", "link": "https://stackoverflow.com/users/3454994/dave-brown"}, "edited": false, "score": 0, "creation_date": 1541585842, "post_id": 53178736, "comment_id": 93264175, "body": "There are two queries there (two selects) with no differentiation (i.e. GO type statements) to separate them. Are you trying to perform some kind of join? union? If you want the top 1 Test Date from the first query and the top 2 Test Date from the second query, try a UNION in between. Also, while it may not be affecting anything, you should put put spaces between things ([Test Date]from) etc."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 9752213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4a52602cbd2e74e677520649afd396f?s=128&d=identicon&r=PG&f=1", "display_name": "prachi", "link": "https://stackoverflow.com/users/9752213/prachi"}, "edited": false, "score": 0, "creation_date": 1541539969, "post_id": 53179078, "comment_id": 93250805, "body": "Automation Error"}, {"owner": {"reputation": 15219, "user_id": 894977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f18198ad9bdf73fa1d90956f7028254?s=128&d=identicon&r=PG", "display_name": "Cetin Basoz", "link": "https://stackoverflow.com/users/894977/cetin-basoz"}, "reply_to_user": {"reputation": 21, "user_id": 9752213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4a52602cbd2e74e677520649afd396f?s=128&d=identicon&r=PG&f=1", "display_name": "prachi", "link": "https://stackoverflow.com/users/9752213/prachi"}, "edited": false, "score": 0, "creation_date": 1541588239, "post_id": 53179078, "comment_id": 93265335, "body": "@prachi, what do you mean?."}, {"owner": {"reputation": 21, "user_id": 9752213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4a52602cbd2e74e677520649afd396f?s=128&d=identicon&r=PG&f=1", "display_name": "prachi", "link": "https://stackoverflow.com/users/9752213/prachi"}, "edited": false, "score": 0, "creation_date": 1541608787, "post_id": 53179078, "comment_id": 93276556, "body": "Throws an Automation Error"}, {"owner": {"reputation": 15219, "user_id": 894977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f18198ad9bdf73fa1d90956f7028254?s=128&d=identicon&r=PG", "display_name": "Cetin Basoz", "link": "https://stackoverflow.com/users/894977/cetin-basoz"}, "reply_to_user": {"reputation": 21, "user_id": 9752213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4a52602cbd2e74e677520649afd396f?s=128&d=identicon&r=PG&f=1", "display_name": "prachi", "link": "https://stackoverflow.com/users/9752213/prachi"}, "edited": false, "score": 0, "creation_date": 1541676667, "post_id": 53179078, "comment_id": 93301683, "body": "@prachi, I can&#39;t see your screen, what error it throws? And also I don&#39;t see the full code you are trying (neither your table structures)."}], "tags": [], "owner": {"reputation": 15219, "user_id": 894977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f18198ad9bdf73fa1d90956f7028254?s=128&d=identicon&r=PG", "display_name": "Cetin Basoz", "link": "https://stackoverflow.com/users/894977/cetin-basoz"}, "is_accepted": false, "score": 0, "last_activity_date": 1541534116, "creation_date": 1541534116, "answer_id": 53179078, "question_id": 53178736, "link": "https://stackoverflow.com/questions/53178736/sql-query-not-working-in-vba-throwing-automation-error/53179078#53179078", "title": "SQL Query not working in VBA. throwing Automation Error", "body": "<p>In your SQL you are missing field list after TOP 1 and then from before the subquery and alias for subquery. It should be something like:</p>\n\n<pre><code>mssql1 = \"select TOP 1 * from \" &amp; _ \n\" (select TOP 2 [Test Date] from [AllSamples].[dbo].[Results] \" &amp; _\n\" ... Order BY [Test Date] DESC) tmp Order BY [Test Date] ASC\"\n</code></pre>\n\n<p>And, do not forget to use parameters instead of those string concatenations to prevent SQL injection attack and other string problems.</p>\n"}], "owner": {"reputation": 21, "user_id": 9752213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4a52602cbd2e74e677520649afd396f?s=128&d=identicon&r=PG&f=1", "display_name": "prachi", "link": "https://stackoverflow.com/users/9752213/prachi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 106, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1541539956, "creation_date": 1541532575, "last_edit_date": 1541539956, "question_id": 53178736, "link": "https://stackoverflow.com/questions/53178736/sql-query-not-working-in-vba-throwing-automation-error", "title": "SQL Query not working in VBA. throwing Automation Error", "body": "<p>Can someone look up and tell me whats wrong in the following VB code </p>\n\n<pre><code>mssql1 = \"select TOP 1 [Test Date]from [AllSamples].[dbo].[Results](select TOP 2[Test Date] from [AllSamples].[dbo].[Results] where ([Sample ID] = '\" &amp; Split(Sheet1.Cells(i, 6), \"-\")(0) &amp; \"' And [Sample No.] = '\" &amp; Split(Sheet1.Cells(i, 6), \"-\")(1) &amp; \"') Order BY [Test Date] DESC) Order BY [Test Date] ASC\"\n</code></pre>\n\n<p>It is taking the tag number and splitting it accordingly into samples id and sample number. \nplease correct the query</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 10155313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b533c93c366ae8b07ed21d2f83a33ef?s=128&d=identicon&r=PG&f=1", "display_name": "sagittarius_88", "link": "https://stackoverflow.com/users/10155313/sagittarius-88"}, "edited": false, "score": 0, "creation_date": 1541535619, "post_id": 53179303, "comment_id": 93248880, "body": "Wow! That was amazing! Thank you very much. Could you explain it please?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 59, "user_id": 10155313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b533c93c366ae8b07ed21d2f83a33ef?s=128&d=identicon&r=PG&f=1", "display_name": "sagittarius_88", "link": "https://stackoverflow.com/users/10155313/sagittarius-88"}, "edited": false, "score": 1, "creation_date": 1541538247, "post_id": 53179303, "comment_id": 93250112, "body": "By using column H, I start the range at the next cell available after the previous file&#39;s name where filled. The rest is in line with what you wrote."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 3, "last_activity_date": 1541535145, "creation_date": 1541535145, "answer_id": 53179303, "question_id": 53178707, "link": "https://stackoverflow.com/questions/53178707/import-multiple-csv-files-while-adding-the-file-name-for-each-imported-file/53179303#53179303", "title": "Import multiple CSV files while adding the file name for each imported file", "body": "<p>Change this:</p>\n\n<pre><code>Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(0, 7).Value = myfiles(i)\n</code></pre>\n\n<p>to this:</p>\n\n<pre><code>Range(Range(\"H\" &amp; Rows.Count).End(xlUp).Offset(1), Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(0,7)).Value = myFiles(i)\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 10155313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b533c93c366ae8b07ed21d2f83a33ef?s=128&d=identicon&r=PG&f=1", "display_name": "sagittarius_88", "link": "https://stackoverflow.com/users/10155313/sagittarius-88"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 53179303, "answer_count": 1, "score": 0, "last_activity_date": 1586402996, "creation_date": 1541532465, "last_edit_date": 1586402996, "question_id": 53178707, "link": "https://stackoverflow.com/questions/53178707/import-multiple-csv-files-while-adding-the-file-name-for-each-imported-file", "title": "Import multiple CSV files while adding the file name for each imported file", "body": "<p>I've been trying to import multiple CSV files, each file has a unique name. What I'm trying to do is: Add a column with the file names filled all the way to end for each imported file.</p>\n\n<pre><code>Sub ImportMultipleCSV()\n\nDim myfiles\nDim i As Integer\nDim j As Integer\nDim Answer\n\nmyfiles = Application.GetOpenFilename(filefilter:=\"CSV Files (*.csv), *.csv\", MultiSelect:=True)\n\n\n    If IsArray(myfiles) Then\n    Answer = MsgBox(\"Delete Files after Import?\", vbYesNo + vbQuestion)\n        For i = LBound(myfiles) To UBound(myfiles)\n            With ActiveSheet.QueryTables.Add(Connection:= _\n                \"TEXT;\" &amp; myfiles(i), Destination:=Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1, 0))\n                .RefreshStyle = xlOverwriteCells\n                .AdjustColumnWidth = True\n                .TextFileStartRow = 2\n                .TextFileParseType = xlDelimited\n                .TextFileCommaDelimiter = True\n                .Refresh\n\n              'add file name to Seperate column\n\n             Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(0, 7).Value = myfiles(i)\n**^^ this line only adds the file name, but I want to fill down.**\n\n\n            End With\n\n            If Answer = vbYes Then\n                Kill myfiles(i)\n            End If\n        Next i\n\n    Else\n        MsgBox \"No File Selected\"\n    End If\n\n\nDim xConnect As Object\n    For Each xConnect In ActiveWorkbook.Connections\n        If xConnect.Name &lt;&gt; \"ThisWorkbookDataModel\" Then xConnect.Delete\n    Next xConnect\n\n\n'Range(\"C:C,E:E,G:G\").Delete\n\n\nEnd Sub\n</code></pre>\n\n<p>This is my output file I'm trying to achieve.\n<a href=\"https://i.stack.imgur.com/llner.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/llner.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Any help is appreciated. Thank you so much!</p>\n"}, {"tags": ["json", "excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1541532397, "post_id": 53178509, "comment_id": 93247388, "body": "Because you concatenate your URL before you set the values of your variables"}], "answers": [{"tags": [], "owner": {"reputation": 1845, "user_id": 8876953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c01635bcbcd8c68cfc963b5d497cdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Eller", "link": "https://stackoverflow.com/users/8876953/josh-eller"}, "is_accepted": true, "score": 0, "last_activity_date": 1541532650, "last_edit_date": 1541532650, "creation_date": 1541532298, "answer_id": 53178671, "question_id": 53178509, "link": "https://stackoverflow.com/questions/53178509/vba-excel-json-request-gives-an-error-because-of-0-in-cells-instead-of-values/53178671#53178671", "title": "VBA-Excel; JSON-request gives an error because of 0 in cells instead of values", "body": "<p>You're setting the values of your variables after putting them into the URL. Just move the URL creation line to after you've assigned all the other variables (ditto with the matchday variable).</p>\n\n<pre><code>strCompetition = Range(\"B2\").Value  \nstrSeason = Range(\"B4\").Value\nstrMatchDay = Range(\"B6\").Value\n\nmatchday=\" &amp; strMatchDay &amp; \"&amp;season=\" &amp; strSeason\nstrURL = \"https://api.football-data.org/v2/competitions/\" &amp; strSeason &amp; \"/matches?matchday=\" &amp; strMatchDay &amp; \"&amp;season=\" &amp; strSeason\n</code></pre>\n"}], "owner": {"reputation": 601, "user_id": 7959614, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f104f49cd87068e81f128afbda86a637?s=128&d=identicon&r=PG&f=1", "display_name": "HJA24", "link": "https://stackoverflow.com/users/7959614/hja24"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 20, "favorite_count": 0, "accepted_answer_id": 53178671, "answer_count": 1, "score": 0, "last_activity_date": 1541532650, "creation_date": 1541531627, "question_id": 53178509, "link": "https://stackoverflow.com/questions/53178509/vba-excel-json-request-gives-an-error-because-of-0-in-cells-instead-of-values", "title": "VBA-Excel; JSON-request gives an error because of 0 in cells instead of values", "body": "<p>I have written the following VBA-macro</p>\n\n<pre><code>Sub getMatches()\n\nDim strURL As String\nDim strJSON As String\nDim strCompetition As Integer  \nDim strSeason As Integer \nDim strMatchDay As Integer\nDim i As Integer\n\n'strURL = \"https://api.football-data.org/v2/competitions/2021/matches?matchday=1&amp;season=2019\"\nstrURL = \"https://api.football-data.org/v2/competitions/\" &amp; strSeason &amp; \"/matches?matchday=\" &amp; strMatchDay &amp; \"&amp;season=\" &amp; strSeason\nstrCompetition = Range(\"B2\").Value  \nstrSeason = Range(\"B4\").Value\nstrMatchDay = Range(\"B6\").Value\nMsgBox strCompetition\nMsgBox strSeason\nMsgBox strMatchDay\nMsgBox strURL\n\n\nSet MyRequest = CreateObject(\"WinHttp.WinHttpRequest.5.1\")\nMyRequest.Open \"Get\", strURL\nMyRequest.setRequestHeader \"X-Auth-Token\", \"personal_code\"\nMyRequest.Send\nDim Json As Object\nSet Json = JsonConverter.ParseJson(MyRequest.ResponseText)\nMsgBox MyRequest.ResponseText\n</code></pre>\n\n<p>Running this script, gives me the following output:</p>\n\n<pre><code>MsgBox strCompetition\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/L5kvy.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/L5kvy.jpg\" alt=\"enter image description here\"></a></p>\n\n<pre><code>MsgBox strSeason\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/BlYhZ.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BlYhZ.jpg\" alt=\"enter image description here\"></a></p>\n\n<pre><code>MsgBox strMatchDay\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/2hesf.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2hesf.jpg\" alt=\"enter image description here\"></a></p>\n\n<pre><code>MsgBox strURL\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/bDoot.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bDoot.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Why does the URL not contain the variables I declared earlier?\nI want the URL to defined as follows: <em>\"<a href=\"https://api.football-data.org/v2/competitions/2021/matches?matchday=1&amp;season=2019\" rel=\"nofollow noreferrer\">https://api.football-data.org/v2/competitions/2021/matches?matchday=1&amp;season=2019</a>\"</em></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13, "user_id": 10614963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ed9a03c6d297fb2bd3d01d9ab097ac1?s=128&d=identicon&r=PG&f=1", "display_name": "GBeltramini", "link": "https://stackoverflow.com/users/10614963/gbeltramini"}, "edited": false, "score": 0, "creation_date": 1541531487, "post_id": 53178472, "comment_id": 93246943, "body": "Production_Plan is a Workbook"}, {"owner": {"reputation": 13, "user_id": 10614963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ed9a03c6d297fb2bd3d01d9ab097ac1?s=128&d=identicon&r=PG&f=1", "display_name": "GBeltramini", "link": "https://stackoverflow.com/users/10614963/gbeltramini"}, "edited": false, "score": 0, "creation_date": 1541531497, "post_id": 53178472, "comment_id": 93246952, "body": "SAP_Comparison is a Sheet"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10614963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ed9a03c6d297fb2bd3d01d9ab097ac1?s=128&d=identicon&r=PG&f=1", "display_name": "GBeltramini", "link": "https://stackoverflow.com/users/10614963/gbeltramini"}, "edited": false, "score": 0, "creation_date": 1541532879, "post_id": 53178496, "comment_id": 93247593, "body": "What is the difference between using &quot;.Range&quot; and &quot;.Cells&quot; and &quot;Range&quot; and &quot;Cells&quot;?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 13, "user_id": 10614963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ed9a03c6d297fb2bd3d01d9ab097ac1?s=128&d=identicon&r=PG&f=1", "display_name": "GBeltramini", "link": "https://stackoverflow.com/users/10614963/gbeltramini"}, "edited": false, "score": 0, "creation_date": 1541532932, "post_id": 53178496, "comment_id": 93247613, "body": "I mean <code>Cells(x, y)</code> (unqualified with a worksheet reference) vs. <code>Production_Plan.Worksheets(&quot;Schedule&quot;).Cells(x, y)</code> (qualified with a specific worksheet in a specific workbook)"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 13, "user_id": 10614963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ed9a03c6d297fb2bd3d01d9ab097ac1?s=128&d=identicon&r=PG&f=1", "display_name": "GBeltramini", "link": "https://stackoverflow.com/users/10614963/gbeltramini"}, "edited": false, "score": 0, "creation_date": 1541533014, "post_id": 53178496, "comment_id": 93247653, "body": "When you use a <code>With</code> block the leading <code>.</code> on (eg) <code>.Cells()</code> &quot;connects&quot; that to the object specified by the <code>With</code> line"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 2, "last_activity_date": 1541533135, "last_edit_date": 1541533135, "creation_date": 1541531576, "answer_id": 53178496, "question_id": 53178472, "link": "https://stackoverflow.com/questions/53178472/set-range-doesnt-work-with-cells-inside/53178496#53178496", "title": "Set Range doesn&#39;t work with Cells() inside", "body": "<p>Unqualified Cells refers to the ActiveSheet, which will raise an error if that's not \"Schedule\"</p>\n\n<p>You need something like</p>\n\n<pre><code>With Production_Plan.Worksheets(\"Schedule\")\n    Set ColorPlan = .Range(.Cells(4, MonthS), .Cells(20, (MonthE - 1)))\nEnd With\n</code></pre>\n\n<p>or</p>\n\n<pre><code>Dim sht As Worksheet\n\nSet sht = Production_Plan.Worksheets(\"Schedule\")\nSet ColorPlan = sht.Range(sht.Cells(4, MonthS), sht.Cells(20, (MonthE - 1)))\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/questions/28439376/what-is-the-default-scope-of-worksheets-and-cells-and-range/28439984#28439984\">What is the default scope of worksheets and cells and range?</a></p>\n"}, {"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1541544044, "creation_date": 1541544044, "answer_id": 53181185, "question_id": 53178472, "link": "https://stackoverflow.com/questions/53178472/set-range-doesnt-work-with-cells-inside/53181185#53181185", "title": "Set Range doesn&#39;t work with Cells() inside", "body": "<p>You could use Cells to get address out of and feed Range with:</p>\n\n<pre><code>Set ColorPlan = Production_Plan.Worksheets(\"Schedule\").Range(Cells(4, MonthS).Address &amp; \u201c:\u201d &amp; Cells(20, (MonthE - 1)).Address)\n</code></pre>\n\n<p>This way you only have one \u201ctrue\u201d Range object and it\u2019s completely qualified </p>\n"}], "owner": {"reputation": 13, "user_id": 10614963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ed9a03c6d297fb2bd3d01d9ab097ac1?s=128&d=identicon&r=PG&f=1", "display_name": "GBeltramini", "link": "https://stackoverflow.com/users/10614963/gbeltramini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1586403031, "creation_date": 1541531451, "last_edit_date": 1586403031, "question_id": 53178472, "link": "https://stackoverflow.com/questions/53178472/set-range-doesnt-work-with-cells-inside", "title": "Set Range doesn&#39;t work with Cells() inside", "body": "<p>I am writing a code in which I set those two ranges:</p>\n\n<pre><code>Set ColorSAP = SAP_Comparison.Range(\"C3:AG19\")\nSet ColorPlan = Production_Plan.Worksheets(\"Schedule\").Range(Cells(4, \nMonthS), Cells(20, (MonthE - 1)))\n</code></pre>\n\n<p><code>MonthS</code> and <code>MonthE</code> are integers. </p>\n\n<p><code>Production_plan</code> is a workbook.</p>\n\n<p><code>SAP_Comparison</code> is a workbook.</p>\n\n<p>I have no idea why I get a error for the second but not for the first since they are very similar.\nI have even tested easier cases and this kind of usage do work.</p>\n\n<pre><code>Error: Run-Time '1004'\nApplication-defined or object-defined error.\n</code></pre>\n\n<p>How can I solve this?</p>\n"}, {"tags": ["vba", "ms-access-2010", "insert-into"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1541531296, "post_id": 53178297, "comment_id": 93246839, "body": "How is <code>NewItemCode(&quot;OD&quot;)</code> implemented? Also, if it&#39;s a &quot;sequential number&quot;, why isn&#39;t it an auto-number field in the table? You shouldn&#39;t even need to manage your primary key assignments."}], "owner": {"reputation": 11, "user_id": 10614883, "user_type": "registered", "profile_image": "https://graph.facebook.com/2382747028406672/picture?type=large", "display_name": "Mitchell Collins", "link": "https://stackoverflow.com/users/10614883/mitchell-collins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 19, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1541530832, "creation_date": 1541530832, "question_id": 53178297, "link": "https://stackoverflow.com/questions/53178297/insert-into-changing-first-entry-and-not-creating-new-entry", "title": "Insert Into Changing first entry and not creating new entry", "body": "<p>I am creating an access app to auto generate serial numbers for products. I am using the insert into command and it is just changing the first entry of the table rather than creating a new entry with the serial number that has been designated. When I go step by step I can see that all the entries have the desired values but when executed it only changes the first serial number. </p>\n\n<pre><code>    Function CreateRFBarrier(pfrm As Object, pValue As String) As Boolean\n\n    Dim db               As Database\n    Dim LInsert          As String\n    Dim LSerialNumber    As String\n    Dim LLoop            As Integer\n\n   On Error GoTo Err_Execute\n\n   Set db = CurrentDb()\n\n   LLoop = 1\n\n  'Create number of records based on BuildQuantity value\n   While LLoop &lt;= pfrm.BuildQuantity\n\n     'Get next SerialNumber value (sequential number)\n      LSerialNumber = NewItemCode(\"OD\")\n\n      If LSerialNumber = \"\" Then\n       GoTo Err_Execute\n      End If\n\n     'Create new record\n      LInsert = \"Insert into RFBarrier \"\n      LInsert = LInsert &amp; \" VALUES (\"\n      LInsert = LInsert &amp; \"'\" &amp; LSerialNumber &amp; \"'\"\n      LInsert = LInsert &amp; \", \" &amp; pfrm.WorkOrder\n      LInsert = LInsert &amp; \", \" &amp; pfrm.BuildQuantity\n      LInsert = LInsert &amp; \", \" &amp; pfrm.DateCreated &amp; \"\"\n      LInsert = LInsert &amp; \", \" &amp; pfrm.CreatedBy &amp; \")\"\n\n     db.Execute LInsert, dbFailOnError\n\n     LLoop = LLoop + 1\n\n   Wend\n\n   Set db = Nothing\n\n   CreateRFBarrier = True\n\n   Exit Function\n\nErr_Execute:\n   'An error occurred\n    CreateRFBarrier = False\n    MsgBox \"An error occurred while trying to add new RFBarrier serial numbers.\"\n\nEnd Function\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 865, "user_id": 10361731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8873db235bacaa9d53de9c31a0b8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Jchang43", "link": "https://stackoverflow.com/users/10361731/jchang43"}, "is_accepted": true, "score": 2, "last_activity_date": 1541533796, "last_edit_date": 1541533796, "creation_date": 1541533039, "answer_id": 53178834, "question_id": 53178276, "link": "https://stackoverflow.com/questions/53178276/create-dynamically-sized-array-to-store-row-counter/53178834#53178834", "title": "Create dynamically sized array to store row counter", "body": "<p>It's worth noting that you haven't even initialized row, and have just let vba implicitly declare it as a variant type for you. To avoid common problems that arise from typos, include Option Explicit at the top of your code and <code>Dim</code> every variable with the type beside it. For example: <code>Dim i as long</code>. <code>Dim i</code> will work, but it will declare it as a variant type</p>\n\n<p>To initialize an array in VBA you use <code>Dim row() as variant</code>. From there you can re-dimension its size using <code>Redim row(LboundX to UboundX)</code> but this will reset all the stored values to zero. To get around this use <code>Redim Preserve row(LBoundX to UBound X)</code>. </p>\n\n<p>If you wish to use a 2D array, add a comma and then put the bounds for the next dimension <code>Redim Preserve row(LBoundX to UBound X, LboundY to UBoundY)</code></p>\n\n<p>At the top of your code I would include </p>\n\n<pre><code> Dim row() as Variant\n Redim Preserve row(1 to 1)\n</code></pre>\n\n<p>Then within the loop I would change <code>row = i</code> to </p>\n\n<pre><code>row(Ubound(row)) = i \nRedim Preserve row(1 to Ubound(row) +1)\n</code></pre>\n\n<p>Now that you have an array though, the check you do below will no longer work and will likely throw an error because you there's no specified index. Instead I suggest changing it from  <code>If row = \"\" Then</code> to <code>If Counter = 0 Then</code>. </p>\n\n<p>I'm not sure what the intention is with <code>GetRowData(row)</code> but you can just access each row number via <code>row(i)</code>. It is worth noting however, that the row array will have Counter +1 number of items, but the last one will be blank. You could get around this by adding in an if statement within the already existing one that would look something like this:</p>\n\n<pre><code>If Counter = 0 Then\n    row(1) = i\nElse\n    ReDim Preserve row(1 To UBound(row) + 1)\n    row(UBound(row)) = i\nEnd If\n\nCounter = Counter + 1\n</code></pre>\n\n<p>By implementing this change, row should have exactly <code>Counter</code> number of items that all have a non-empty value</p>\n\n<p>I don't really suggest making a column array because it becomes more cumbersome to change the array size. <code>Redim</code> preserve or not only allows you to change the last dimension in the array, so to change the number of rows you would have to set the array equal to the transpose of itself, do the <code>redim</code> and then set it to the transpose of itself again. It's just needlessly messy. If you're pasting it to a sheet and need it to be in a column you could just transpose it at the end instead.</p>\n"}], "owner": {"reputation": 2183, "user_id": 1474921, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/629c3c899819f28cbf068691b1c7c618?s=128&d=identicon&r=PG", "display_name": "Jason Kelly", "link": "https://stackoverflow.com/users/1474921/jason-kelly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "accepted_answer_id": 53178834, "answer_count": 1, "score": 0, "last_activity_date": 1544710804, "creation_date": 1541530757, "last_edit_date": 1544710804, "question_id": 53178276, "link": "https://stackoverflow.com/questions/53178276/create-dynamically-sized-array-to-store-row-counter", "title": "Create dynamically sized array to store row counter", "body": "<p>The function below finds the first result.</p>\n\n<p>There could be duplicate rows with matching values that meet my if statements. How would I create an array to store the row numbers the search function found so that I can process the data later.</p>\n\n<p>How would I create the array size based on the number of results found in the for loop?</p>\n\n<p>I am assuming that the for loop counter will have some sort of role to play in this. Let's say the for loop found 2 matches in row numbers 56 and 98 matching my if statements:</p>\n\n<blockquote>\n  <p>array_example(counter, 0) = 56<br>\n  array_example(counter, 0) = 98</p>\n</blockquote>\n\n<p>The stored values would be:</p>\n\n<blockquote>\n  <p>array_example(1, 0) = 56<br>\n  array_example(2, 0) = 98</p>\n</blockquote>\n\n<pre><code>Private Sub Complex_Search(col1, cval1, col2, cval2)\n\n'MsgBox (col1 &amp; \" \" &amp; col2)\n'MsgBox (cval1 &amp; \" \" &amp; cval2)\n\nDim i\nDim lRow\nDim Counter\n\n    lRow = Cells(Rows.Count, 1).End(xlUp).row\n\n    Counter = 0\n\n    With Sheets(\"Office Spaces\")\n\n        For i = 2 To lRow\n\n            If LCase(.Cells(i, col1).Value) = LCase(cval1) And LCase(.Cells(i, col2).Value) = LCase(cval2) Then\n\n                row = i\n\n                Counter = Counter + 1\n\n            End If\n\n        Next i\n\n    End With\n\n    If row = \"\" Then\n\n        MsgBox (\"Search complete. 0 results found\")\n\n    Else\n        GetRowData (row)\n\n        UserForm1.resmax.Value = 1\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 1, "creation_date": 1541531049, "post_id": 53178259, "comment_id": 93246741, "body": "I am pretty sure that your <code>FileURL</code> needs to be the actual file that you are needing (which would end with .pdf) when using your API call <code>URLDownloadToFile</code> . You are likely just downloading an HTML webpage - and because your output file is <code>4750422330.pdf</code> you are storing an HTML page with a .pdf extension."}, {"owner": {"reputation": 15, "user_id": 7745808, "user_type": "registered", "profile_image": "https://graph.facebook.com/1267539596670898/picture?type=large", "display_name": "Suman", "link": "https://stackoverflow.com/users/7745808/suman"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1541566544, "post_id": 53178259, "comment_id": 93257303, "body": "&lt;a href=&quot;/expotr/expotr?action=com.expd.webapp.tracking.action.&zwnj;&#8203;document.DocumentIma&zwnj;&#8203;geDownloadWebAction&amp;&zwnj;&#8203;amp;Type=Image.Get&amp;a&zwnj;&#8203;mp;xref=IVP9OABdjwlQ&zwnj;&#8203;yfAP4d8VNzKeBtYse1Tl&zwnj;&#8203;CWJmb5gzyMxbwbgxBLP1&zwnj;&#8203;9w%3D%3D&quot; target=&quot;_blank&quot;&gt;Commercial Invoice&lt;/a&gt;"}, {"owner": {"reputation": 15, "user_id": 7745808, "user_type": "registered", "profile_image": "https://graph.facebook.com/1267539596670898/picture?type=large", "display_name": "Suman", "link": "https://stackoverflow.com/users/7745808/suman"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1541567414, "post_id": 53178259, "comment_id": 93257459, "body": "When i manually search above URL in internet browser, document get open and get option save in PDF, above is my HTML page link reference"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1541567589, "post_id": 53178259, "comment_id": 93257480, "body": "Right - but the url itself is to a webpage. It&#39;s not a direct link to your file, therefore you are not able to use <code>URLDownloadToFile</code>. A direct link to a file will always end with the file&#39;s extension. You may be able to scrape the html document&#39;s elements for the file&#39;s url, but I can&#39;t help you there without seeing the html code of the document."}, {"owner": {"reputation": 15, "user_id": 7745808, "user_type": "registered", "profile_image": "https://graph.facebook.com/1267539596670898/picture?type=large", "display_name": "Suman", "link": "https://stackoverflow.com/users/7745808/suman"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1541568838, "post_id": 53178259, "comment_id": 93257717, "body": "I have shared the HTML code in my previous comments"}, {"owner": {"reputation": 15, "user_id": 7745808, "user_type": "registered", "profile_image": "https://graph.facebook.com/1267539596670898/picture?type=large", "display_name": "Suman", "link": "https://stackoverflow.com/users/7745808/suman"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1541587223, "post_id": 53178259, "comment_id": 93264865, "body": "i have a similar script for different URL however file extension is &quot;jpg&quot;, this is working even though fileurl doesnt end with.jpg                                            pod = Trim(Sheets(&quot;PDF2Edoc&quot;).Cells(a, 1).Value) FileURL = &quot;<a href=\"http://spoton.co.in/SPOTTRACK/Advance/getpod.aspx?id=\" rel=\"nofollow noreferrer\">spoton.co.in/SPOTTRACK/Advance/getpod.aspx?id=</a>&quot; &amp; pod &amp; &quot;&amp;mPODDw=Y&quot;  DestinationFile = src &amp; pod &amp; &quot;.jpg&quot;  URLDownloadToFile 0, FileURL, DestinationFile, 0, 0"}, {"owner": {"reputation": 15, "user_id": 7745808, "user_type": "registered", "profile_image": "https://graph.facebook.com/1267539596670898/picture?type=large", "display_name": "Suman", "link": "https://stackoverflow.com/users/7745808/suman"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1541612893, "post_id": 53178259, "comment_id": 93278678, "body": "can you please advise what details you required to help me on this subject?"}, {"owner": {"reputation": 15, "user_id": 7745808, "user_type": "registered", "profile_image": "https://graph.facebook.com/1267539596670898/picture?type=large", "display_name": "Suman", "link": "https://stackoverflow.com/users/7745808/suman"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1541768790, "post_id": 53178259, "comment_id": 93339305, "body": "thank you for all your suggestion, i am able to find the solution, the issue was, i was not navigating documents link URL and waiting to web page to load because of that script downloading HTML page instead of actual documents, now its working without any error."}, {"owner": {"reputation": 15, "user_id": 7745808, "user_type": "registered", "profile_image": "https://graph.facebook.com/1267539596670898/picture?type=large", "display_name": "Suman", "link": "https://stackoverflow.com/users/7745808/suman"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1567170515, "post_id": 53178259, "comment_id": 101894805, "body": "Hello i am again facing same issue, file has been damaged, can someone help pleas, script already mentioned above, let me know if anything required to check from my side."}], "owner": {"reputation": 15, "user_id": 7745808, "user_type": "registered", "profile_image": "https://graph.facebook.com/1267539596670898/picture?type=large", "display_name": "Suman", "link": "https://stackoverflow.com/users/7745808/suman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 136, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1586403067, "creation_date": 1541530661, "last_edit_date": 1586403067, "question_id": 53178259, "link": "https://stackoverflow.com/questions/53178259/website-download-adobe-reader-could-not-open-pdf-because-it-is-either-not-a-supp", "title": "Website download adobe reader could not open PDF because it is either not a supported file type or because the file has been damaged", "body": "<p>Am trying to login company tracking website and download documents from file in C drive, while opening downloaded documents from C drive I am getting error i.e. </p>\n\n<blockquote>\n  <p><em>Adobe Reader could not open pdf because it is either not a supported file type or because the file has been damaged</em>  </p>\n</blockquote>\n\n<p>Can you advise is there any other way to download PDF file from website?</p>\n\n<pre><code>Option Explicit\n#If VBA7 Then\n        Private Declare PtrSafe Function URLDownloadToFile Lib \"urlmon\" Alias \"URLDownloadToFileA\" ( _\n        ByVal pCaller As LongPtr, _\n        ByVal szURL As String, _\n        ByVal szFileName As String, _\n        ByVal dwReserved As LongPtr, _\n        ByVal lpfnCB As LongPtr) As LongPtr\n#Else\n        Private Declare Function URLDownloadToFile Lib \"urlmon\" Alias \"URLDownloadToFileA\" ( _\n        ByVal pCaller As Long, _\n        ByVal szURL As String, _\n        ByVal szFileName As String, _\n        ByVal dwReserved As Long, _\n        ByVal lpfnCB As Long) As Long\n#End If\n\nSub DowloadSingleFile()\n    Dim FileURL As String\n    Dim DestinationFile As String\n\n    FileURL = \"https://expo.expeditors.com/expotr/expotr?action=com.expd.webapp.tracking.action.document.DocumentImageDownloadWebAction&amp;Type=Image.Get&amp;xref=IVP9OABdjwlQyfAP4d8VNzKeBtYse1TlCWJmb5gzyMxbwbgxBLP19w%3D%3D\"\n\n    DestinationFile = \"C:\\VBA\\4750422330.pdf\"\n\n    If URLDownloadToFile(0, FileURL, DestinationFile, 0, 0) = 0 Then\n        Debug.Print \"file download started\"\n    Else\n        Debug.Print \"file download not started\"\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 0, "last_activity_date": 1541529283, "creation_date": 1541529283, "answer_id": 53177948, "question_id": 53177811, "link": "https://stackoverflow.com/questions/53177811/vba-copy-paste-data-from-source-table-into-target-table-when-databodyrange-is-no/53177948#53177948", "title": "VBA Copy/Paste Data from Source Table into Target Table when DataBodyRange is Nothing", "body": "<p>I think what you have to do is insert a row first. Here is a simple example which hopefully you can adapt (Table 1 has 3 columns).</p>\n\n<pre><code>Sub x()\n\nDim l As ListObject\n\nSet l = Sheets(1).ListObjects(\"Table1\")\nIf l.DataBodyRange Is Nothing Then\n    l.ListRows.Add\n    Range(\"F1:H1\").Copy l.DataBodyRange(1, 1)\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 548115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe5e97a26c4d2f83d841ad78e52b6805?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/548115/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1840, "favorite_count": 0, "accepted_answer_id": 53177948, "answer_count": 1, "score": 0, "last_activity_date": 1586403103, "creation_date": 1541528698, "last_edit_date": 1586403103, "question_id": 53177811, "link": "https://stackoverflow.com/questions/53177811/vba-copy-paste-data-from-source-table-into-target-table-when-databodyrange-is-no", "title": "VBA Copy/Paste Data from Source Table into Target Table when DataBodyRange is Nothing", "body": "<p>I need help with resolving a DataBodyRange is Nothing error.</p>\n\n<p>I am trying to copy data from a filtered Source table to Target table.   The Target table data will be utilized for drop down menus.</p>\n\n<p>When I clear the Target table to prepare for the next Source data to be pasted, I sometimes get a run time error, which is based upon the DataBodyRange being Nothing.</p>\n\n<p>I know how to paste the data when the DataBodyRange has something.</p>\n\n<p>I need the code to paste the source data into the target table when the DataBodyRange is Nothing.</p>\n\n<p>See the ELSE statement below.</p>\n\n<pre><code>Sub Copy_With_AutoFilter()\n\nDim loSource As Excel.ListObject\nDim loTarget As Excel.ListObject\nDim SourceDataRowsCount As Long\nDim TargetDataRowsCount As Long\nDim myfilter As Range\nDim rng As Range\nDim EndRow As ListRow\n\n'Change ScreenUpdating, Calculation, EnableEvents, etc.\n    With Application\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n    ViewMode = ActiveWindow.View\n    ActiveWindow.View = xlNormalView\n    ActiveSheet.DisplayPageBreaks = False\n\n'Prepare to Copy Specific Data from Source Table\nSet loSource = Sheets(\"ProductData\").ListObjects(\"tblProductData\")\nSet myfilter = Range(\"ShipToNumber\")\n\n'Create the Filter for the Source Table &amp; Count Number of Cells\n    loSource.Range.AutoFilter Field:=3, Criteria1:=myfilter\n    SourceDataRowsCount = loSource.ListColumns(1).DataBodyRange.SpecialCells(xlCellTypeVisible).Count\n\n'Prepare to Paste that Data in Target Table\nSet loTarget = Sheets(\"ProductData\").ListObjects(\"tblMyProducts\")\n\n'Delete all Target table rows\n    If Not loTarget.DataBodyRange Is Nothing Then\n           loTarget.DataBodyRange.Delete\n           loTarget.Resize Range(\"$J$1:$Q$2\")\n    End If\n\n'Setup the Target Table\n    If SourceDataRowsCount &lt;&gt; 0 Then\n        Set rng = Range(\"tblMyProducts[#All]\").Resize(SourceDataRowsCount + 1, 8)\n        loTarget.Resize rng\n\n'Copy Data from Source Table to Target Table\n        loSource.DataBodyRange.SpecialCells(xlCellTypeVisible).Copy\n\n'Check to see if there is data in table\n    If Not loTarget.DataBodyRange Is Nothing Then\n        loTarget.DataBodyRange.PasteSpecial (xlPasteValues)\n    Else\n        'Set EndRow = loTarget.ListRows.Add\n        'NEED HELP HERE:  Code to Add the Copied Rows from the Source table when DatabodyRange is Nothing\n    End If\n\n'Restore ScreenUpdating, Calculation, EnableEvents, etc.\n        Sheets(\"ProductData\").ListObjects(\"tblProductData\").ShowAutoFilter = False\n        Application.CutCopyMode = False\n        ActiveWindow.View = ViewMode\n        With Application\n            .ScreenUpdating = True\n            .EnableEvents = True\n        End With\n    Else\n        MsgBox \"Sorry, this Ship To location has not ordered any products in the last six months.  Please contact customer service so that your tables can be updated.\"\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Thank you in advance.</p>\n\n<p>Michael</p>\n"}, {"tags": ["excel", "vba", "variables"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1541530461, "post_id": 53177548, "comment_id": 93246447, "body": "What happens when you <code>debug.print</code> your variables and their concatenation? Do you get what you expect?"}, {"owner": {"reputation": 11, "user_id": 10506245, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RoXeg.jpg?s=128&g=1", "display_name": "CaptainMacro", "link": "https://stackoverflow.com/users/10506245/captainmacro"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1541539134, "post_id": 53177548, "comment_id": 93250456, "body": "Sorry only 2 months new to VBA how do I use Debug.Print? I tried quickly and was not getting any results"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10506245, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RoXeg.jpg?s=128&g=1", "display_name": "CaptainMacro", "link": "https://stackoverflow.com/users/10506245/captainmacro"}, "edited": false, "score": 0, "creation_date": 1541540243, "post_id": 53177977, "comment_id": 93250915, "body": "Thanks you got me checking in  the right space, believe there was a missing backslash, i will try this later :)"}, {"owner": {"reputation": 11, "user_id": 10506245, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RoXeg.jpg?s=128&g=1", "display_name": "CaptainMacro", "link": "https://stackoverflow.com/users/10506245/captainmacro"}, "edited": false, "score": 0, "creation_date": 1541556870, "post_id": 53177977, "comment_id": 93255567, "body": "Thanks, got this working now, as mentioned it was a missing backslash which should have been in this const code at the end.....       Const toFolder As String = &quot;C:\\Users\\jblogs\\Documents\\VBA\\TFAR&quot;"}], "tags": [], "owner": {"reputation": 41, "user_id": 10614737, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Q-hgrSx3WDI/AAAAAAAAAAI/AAAAAAAAFvk/1aLxWsrs10k/photo.jpg?sz=128", "display_name": "Brent", "link": "https://stackoverflow.com/users/10614737/brent"}, "is_accepted": false, "score": 0, "last_activity_date": 1541529434, "creation_date": 1541529434, "answer_id": 53177977, "question_id": 53177548, "link": "https://stackoverflow.com/questions/53177548/open-workbook-command-using-variables-as-file-name/53177977#53177977", "title": "Open Workbook command using variables as file name", "body": "<p>Without having the exact spreadsheet in front of me, it's impossible to be certain as I can't reproduce your problem exactly, but it's probably something to do with a type conversion when you concatenate the numbers for fYear and fPeriod into the file name.  It could be a leading or trailing space inserted into the file name.  </p>\n\n<p>While the exact circumstances that compel me to do this are lost in the swirling mists of time, I always do a text conversion from integer to string when building a string with a file name in either an Excel formula or in VBA.  </p>\n\n<p>So I'd try this: </p>\n\n<pre><code>x = Application.WorksheetFunction.CountA(Range(\"A:A\"))\nfYear = Range(\"A\" &amp; Format(x, \"0\").Value\ny = Application.WorksheetFunction.CountA(Range(\"B:B\"))\nfPeriod = Range(\"B\" &amp; Format(y, \"0\").Value\n</code></pre>\n\n<p>That's assuming that x and y are integers.  </p>\n"}], "owner": {"reputation": 11, "user_id": 10506245, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RoXeg.jpg?s=128&g=1", "display_name": "CaptainMacro", "link": "https://stackoverflow.com/users/10506245/captainmacro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1541529434, "creation_date": 1541527631, "question_id": 53177548, "link": "https://stackoverflow.com/questions/53177548/open-workbook-command-using-variables-as-file-name", "title": "Open Workbook command using variables as file name", "body": "<p>I am building some code to open excel files in certain directory folders. I have some variables captured elsewhere and need to essentially concatenate the strings that make up the file name in the correct command line sytax.</p>\n\n<p>The problem is with  this code compilation, I need some help with  this command code to launch the workbook Open;</p>\n\n<pre><code>Workbooks.OpenText Filename:=(toFolder &amp; fYear &amp; fA &amp; fPeriod &amp; JEres) _\n</code></pre>\n\n<p>The line of command code is within this sub, all of the variables are defining correctly, I am failing to get the right code structure to launch the file.</p>\n\n<p>The file is txt so the large block of code below the open command is text to columns which is working fine. Everything works independently except the Workbooks.OpenText command.</p>\n\n<p>Any  suggestions please?</p>\n\n<p>Cheers!</p>\n\n<pre><code>Dim x As Integer\nDim y As Integer\nDim fYear As String\nDim fPeriod As String\nConst toFolder As String = \"C:\\Users\\jblogs\\Documents\\VBA\\TFAR\"\nConst fA As String = \"\\FA\\\"\nConst JEres As String = \"\\Constant_File_Name.txt\"\n\nx = Application.WorksheetFunction.CountA(Range(\"A:A\"))\nfYear = Range(\"A\" &amp; x).Value\ny = Application.WorksheetFunction.CountA(Range(\"B:B\"))\nfPeriod = Range(\"B\" &amp; y).Value\n\nWorkbooks.OpenText Filename:=(toFolder &amp; fYear &amp; fA &amp; fPeriod &amp; JEres) _\n    , Origin:=xlMSDOS, StartRow:=1, DataType:=xlDelimited, TextQualifier:= _\n    xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=False, Semicolon:=False _\n    , Comma:=False, Space:=False, Other:=True, OtherChar:=\"^\", FieldInfo _\n    :=Array(Array(1, 1), Array(2, 1), Array(3, 1), Array(4, 1), Array(5, 1), Array(6, 1), _\n    Array(7, 1), Array(8, 1), Array(9, 1), Array(10, 1), Array(11, 1), Array(12, 1), Array(13, 1 _\n    ), Array(14, 1), Array(15, 1), Array(16, 1), Array(17, 1), Array(18, 1), Array(19, 1), Array _\n    (20, 1), Array(21, 1), Array(22, 1), Array(23, 1), Array(24, 1), Array(25, 1), Array(26, 1), _\n    Array(27, 1), Array(28, 1), Array(29, 1), Array(30, 1), Array(31, 1), Array(32, 1), Array( _\n    33, 1), Array(34, 1), Array(35, 1), Array(36, 1), Array(37, 1), Array(38, 1), Array(39, 1), _\n    Array(40, 1), Array(41, 1), Array(42, 1)), TrailingMinusNumbers:=True`\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5038, "user_id": 4552529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7dff9245051269e55748c81670088e8?s=128&d=identicon&r=PG&f=1", "display_name": "Wizhi", "link": "https://stackoverflow.com/users/4552529/wizhi"}, "edited": false, "score": 0, "creation_date": 1541527612, "post_id": 53177304, "comment_id": 93245068, "body": "Everytime this statement is true : <code>If totalHrs &lt; 12 Then</code>, you copy from the column c &quot;<code>(rngcell.Offset(0, 1).Value)</code>&quot;, but sometimes column c is empty, then you get empty values in col F &amp; G."}, {"owner": {"reputation": 5, "user_id": 10575678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f47983d1aa59ac85070bd82b2afd4a27?s=128&d=identicon&r=PG&f=1", "display_name": "TepidSecretHack", "link": "https://stackoverflow.com/users/10575678/tepidsecrethack"}, "reply_to_user": {"reputation": 5038, "user_id": 4552529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7dff9245051269e55748c81670088e8?s=128&d=identicon&r=PG&f=1", "display_name": "Wizhi", "link": "https://stackoverflow.com/users/4552529/wizhi"}, "edited": false, "score": 0, "creation_date": 1541530956, "post_id": 53177304, "comment_id": 93246702, "body": "I&#39;ve edited the statement &quot;if column c is blank, ignore&quot;, I forgot I had removed that"}], "owner": {"reputation": 5, "user_id": 10575678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f47983d1aa59ac85070bd82b2afd4a27?s=128&d=identicon&r=PG&f=1", "display_name": "TepidSecretHack", "link": "https://stackoverflow.com/users/10575678/tepidsecrethack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1541530866, "creation_date": 1541526579, "last_edit_date": 1541530866, "question_id": 53177304, "link": "https://stackoverflow.com/questions/53177304/why-are-there-inconsistent-and-broken-cell-formulas-for-some-rows-and-not-others", "title": "Why are there inconsistent and broken cell formulas for some rows and not others?", "body": "<p><strong>Goal: Populate F and G columns with proper formulas depending on total PROD-TIME for a block</strong></p>\n\n<p>This is another issue that has come up after one of my previous questions:\n<a href=\"https://stackoverflow.com/questions/53049524/how-to-loop-through-blocks-of-rows-in-excel-dataset-instead-of-each-row-indivi\">How to loop through &quot;blocks&quot; of rows in excel dataset instead of each row individually (VBA)?</a> </p>\n\n<p>I have been able to loop through blocks of rows and can now get the sum of the PROD-TIME for that particular block. This sum is necessary to determine which formula needs to be used in the F and G columns.</p>\n\n<p>This is best illustrated in this workbook, \n<a href=\"https://www.dropbox.com/s/vgnqi00h8xosja3/wip%20Gantt%20Template.xlsx?dl=0\" rel=\"nofollow noreferrer\">https://www.dropbox.com/s/vgnqi00h8xosja3/wip%20Gantt%20Template.xlsx?dl=0</a> , where I have shown how I want the formulas to end up in the F and G columns. But for some reason when I run the macro, it just completely breaks. Some of the formulas don't even use reference cells and use the cell value instead, or reference cells don't even appear. Are the blank F and G columns confusing the macro? How can I make sure that every F and G cell gets filled with something? Errors are fine</p>\n\n<pre><code>Sub getStartEndDate()\n    Dim WrkSht As Excel.Worksheet\n    Dim RngColumn As Range, RngBlock As Range\n    Dim totalHrs As Integer 'total PROD-TIME for the given RngBlock\n    Dim lastRow As Long\n\n    lastRow = ActiveSheet.Cells.SpecialCells(xlCellTypeLastCell).Row\n    Set WrkSht = ActiveWorkbook.Worksheets(1)\n\n    ' Populate the last row by itself first since the With-statement below needs to reference rows below current row\n    Range(\"E\" &amp; lastRow).Formula = \"=ROUNDUP(D\" &amp; lastRow &amp; \"/12,0)\"\n    Range(\"G\" &amp; lastRow).Value = Range(\"C\" &amp; lastRow).Value\n    Range(\"F\" &amp; lastRow).Formula = \"=WORKDAY(G\" &amp; lastRow &amp; \", -E\" &amp; lastRow &amp; \")\"\n    Columns(\"F:F\").NumberFormat = \"yyyy-mm-dd\"\n\n    With WrkSht\n        Set RngColumn = .Range(\"B2:B\" &amp; lastRow)\n        'Starts the first block with the first cell in a column.\n        Set RngBlock = RngColumn.Cells(1)\n\n        'Checks every cell in a column.\n        For Each rngcell In RngColumn\n            If rngcell.Offset(0,1).Value &lt;&gt; \"\" Then\n                'Checks whether a cell's value equals the cell below it.\n                If rngcell.Value = rngcell.Offset(1, 0).Value Then\n                    'If equal, includes the cell below in the block.\n                    Set RngBlock = Union(RngBlock, rngcell.Offset(1, 0))\n                Else\n                    'If not equal, that means the block RngBlock ends\n                    ' totalHrs is the sum of the \"PROD-TIME\" for that particular block\n                    totalHrs = WorksheetFunction.Sum(Range(CStr(Trim(Chr(64 + RngBlock.Column + 2))) _\n                                &amp; CStr(Trim(Str(RngBlock.Row))) &amp; \":\" _\n                                &amp; CStr(Trim(Chr(64 + 2 + RngBlock.Column + RngBlock.Columns.Count - 1))) _\n                                &amp; CStr(Trim(Str(RngBlock.Row + RngBlock.Rows.Count - 1)))))\n\n                    If totalHrs &lt; 12 Then\n                        ' If total production time (PROD-TIME) is less than 12 hours, then the start and end date should be the same for all rows in that block\n                        rngcell.Offset(0, 4).Value = rngcell.Offset(0, 1).Value\n                        rngcell.Offset(0, 5).Value = rngcell.Offset(0, 1).Value\n                    Else\n                        ' If total production time is greater than 12 hours, then start and end dates are based on a different formula \n                        ' e.g. Given row 11, F column formula looks like: =WORKDAY(G11, -E11), G column looks like: =IF(B11=B12,F12,C11) \n                        rngcell.Offset(0, 4).Formula = \"=WORKDAY(\" &amp; rngcell.Offset(0, 5) &amp; \", -\" &amp; rngcell.Offset(0, 3) &amp; \")\"\n                        rngcell.Offset(0, 5).Formula = \"=IF(\" &amp; rngcell &amp; \"=\" &amp; rngcell.Offset(1, 0) &amp; \",\" &amp; rngcell.Offset(1, 4) &amp; \",\" &amp; rngcell.Offset(0, 1) &amp; \")\"\n                    End If\n\n                    'Starts the next block with the cell below.\n                    Set RngBlock = rngcell.Offset(1, 0)\n                End If\n            End If \n\n        Next rngcell\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 3, "creation_date": 1541526414, "post_id": 53177237, "comment_id": 93244491, "body": "If you want us to look at your code that may be causing issues, please <a href=\"https://stackoverflow.com/posts/53177237/edit\">edit</a> your question and add that code. If your issue is not related to specific code (which I assume to be the case with your <i>&quot;we don\u2019t believe the functions themselves are causing the issues&quot;</i> statement), then this should be posted to <a href=\"https://superuser.com\">Super User</a>. Thanks!"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1541526476, "post_id": 53177237, "comment_id": 93244517, "body": "There&#39;s nothing we can offer here without seeing the code."}, {"owner": {"reputation": 5, "user_id": 7406200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8250eefe0d1ff864ed197eb2edf48fa6?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel G", "link": "https://stackoverflow.com/users/7406200/daniel-g"}, "edited": false, "score": 0, "creation_date": 1541527232, "post_id": 53177237, "comment_id": 93244880, "body": "Code added to original post, thanks!"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1541528697, "post_id": 53177237, "comment_id": 93245612, "body": "That looks fine to me...   If the ranges passed in are always contiguous then you could maybe get a slight performance boost by reading the range value in a single operation, then looping over the resulting array to fill the dictionary.  To be on the safe side you could even check <code>rng.Areas.Count</code> to switch back to your original loop.  Might be worth checking each input cell for error values and skipping those if you want to avoid #VALUE outputs."}, {"owner": {"reputation": 5, "user_id": 7406200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8250eefe0d1ff864ed197eb2edf48fa6?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel G", "link": "https://stackoverflow.com/users/7406200/daniel-g"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1541530079, "post_id": 53177237, "comment_id": 93246255, "body": "Thanks for your feedback  That&#39;s a simple enough solution to try regarding the #values.  The bigger problem here interrupting workflows is the breaking of the files that use this code, which i realize may be a coincidence.  Do you have any insight into this?  I&#39;ll probably take @K.D\u1d00\u1d20\u026as recommendation and post to SuperUser as well."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1541541081, "post_id": 53177237, "comment_id": 93251270, "body": "I don&#39;t have any insight on why your files &quot;break&quot; - I&#39;ve only very rarely run into that problem, and only in workbooks with a lot of VBA which has been frequently revised/ added to."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 7406200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8250eefe0d1ff864ed197eb2edf48fa6?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel G", "link": "https://stackoverflow.com/users/7406200/daniel-g"}, "edited": false, "score": 0, "creation_date": 1547078579, "post_id": 53178109, "comment_id": 95072650, "body": "I implemented your changes here. However, Is there any reason this would work on my machine, but not another user&#39;s machine?   He&#39;s returning #value when using ConcatUniq.  He gave me control of his machine through MS Lync and I was able to step through the UDF by setting a random cell&#39;s formula using ConcatUniq.  Once stepping through, it exited the UDF after running &quot;Set dic = CreateObject(&quot;Scripting.Dictionary&quot;)"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 5, "user_id": 7406200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8250eefe0d1ff864ed197eb2edf48fa6?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel G", "link": "https://stackoverflow.com/users/7406200/daniel-g"}, "edited": false, "score": 0, "creation_date": 1547079802, "post_id": 53178109, "comment_id": 95072960, "body": "Are they on a Mac?  This code won&#39;t run there since there&#39;s no <code>CreateObject</code> - that&#39;s a Windows COM thing.  You can try this if you need cross-platform support:  <a href=\"https://github.com/VBA-tools/VBA-Dictionary\" rel=\"nofollow noreferrer\">github.com/VBA-tools/VBA-Dictionary</a>"}, {"owner": {"reputation": 5, "user_id": 7406200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8250eefe0d1ff864ed197eb2edf48fa6?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel G", "link": "https://stackoverflow.com/users/7406200/daniel-g"}, "edited": false, "score": 0, "creation_date": 1547486400, "post_id": 53178109, "comment_id": 95200884, "body": "They are not on a Mac.  This is why this is so strange. Apparently same version of Excel per IT, you open the file on my or another co-workers in my department&#39;s machine and it works fine. Opened from another departments machine, it errors out on creating a dictionary."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 5, "user_id": 7406200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8250eefe0d1ff864ed197eb2edf48fa6?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel G", "link": "https://stackoverflow.com/users/7406200/daniel-g"}, "edited": false, "score": 0, "creation_date": 1547489850, "post_id": 53178109, "comment_id": 95202292, "body": "Is it only CreateObject on a dictionary which fails?  Can you use (eg) <code>CreateObject(&quot;Excel.Application&quot;) </code> or <code>CreateObject(&quot;Scripting.FileSystemObject&quot;)</code> with no error?"}, {"owner": {"reputation": 5, "user_id": 7406200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8250eefe0d1ff864ed197eb2edf48fa6?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel G", "link": "https://stackoverflow.com/users/7406200/daniel-g"}, "edited": false, "score": 0, "creation_date": 1547500341, "post_id": 53178109, "comment_id": 95206637, "body": "I misspoke, It doesn&#39;t even fail. It simply exits the UDF function and goes straight to &#39;end sub&#39; after running the &#39;Create Object&#39; line.  I will try one of those and see what happens."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1541530837, "last_edit_date": 1541530837, "creation_date": 1541529968, "answer_id": 53178109, "question_id": 53177237, "link": "https://stackoverflow.com/questions/53177237/excel-intermittently-crashes-when-opening-network-file-enabling-content-with-u/53178109#53178109", "title": "Excel Intermittently Crashes When Opening Network File / Enabling Content With User Defined Functions", "body": "<p>To flesh out my comments above:</p>\n\n<pre><code>Function ConcatUniq(ByRef rng As Range, ByVal myJoin As String) As String\n    Dim cl As Range, data, r As Long, c As Long, v\n    Static dic As Object\n    If dic Is Nothing Then Set dic = CreateObject(\"Scripting.Dictionary\")\n    If rng.Areas.Count &gt; 1 Then\n        For Each cl In rng.Cells\n            v = cl.Value\n            If Not IsError(v) Then dic(v) = Empty\n        Next\n    Else\n        data = rng.Value\n        For r = 1 To UBound(data, 1)\n        For c = 1 To UBound(data, 2)\n            v = data(r, c)\n            If Not IsError(v) Then dic(v) = Empty\n        Next c\n        Next r\n    End If\n    ConcatUniq = Join$(dic.keys, myJoin)\n    dic.RemoveAll\nEnd Function\n</code></pre>\n\n<p>In my testing with a single-area range this is about twice as fast.</p>\n"}], "owner": {"reputation": 5, "user_id": 7406200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8250eefe0d1ff864ed197eb2edf48fa6?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel G", "link": "https://stackoverflow.com/users/7406200/daniel-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 302, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1586403139, "creation_date": 1541526282, "last_edit_date": 1586403139, "question_id": 53177237, "link": "https://stackoverflow.com/questions/53177237/excel-intermittently-crashes-when-opening-network-file-enabling-content-with-u", "title": "Excel Intermittently Crashes When Opening Network File / Enabling Content With User Defined Functions", "body": "<p>I have a file stored on our network that houses part number requests.  This file is shared between two departments that, according to IT, are all up to date on 64-bit versions of Excel. </p>\n\n<p>The file houses several simple user defined functions, such as ConcatUniq. \nThe file will open and function properly for weeks at a time, and then randomly will either crash upon opening, or crash upon enabling content.  <strong>We then rebuild the file from scratch, it will work for several weeks, then will crash again.</strong>   These are widely used functions, and we don\u2019t believe the functions themselves are causing the issues. </p>\n\n<p>Additionally, a colleague had issues with the ConcatUniq function returning correct values on some lines, but returining #value errors on other lines. For this, I created a separate sheet with the ConcatUniq UDF, and a loop that sets cell formulas as the ConcatUniq function and allows the UDF to be stepped through, while printing each value in the range. </p>\n\n<p>After saving and then sending this to a colleague to test, it crashed Excel upon opening.  Mine still opened fine, but crashed on enabling content.  This appears to be the bigger issue here, but nonetheless, sometimes the file crashes, sometimes it doesn\u2019t, sometimes the UDF works, and sometimes it doesn\u2019t. </p>\n\n<p>We are unsure as to if this is a problem with Excel / Add-ons, our network/firewall paramaters, or the VBA itself.  I don\u2019t believe this is any sort of compiler error, as the functions do work locally.  This problem seems to happen after these files are saved by users on the network.</p>\n\n<p>I am hoping for some guidance regarding where to look for an issue causing these symptoms (Excel, network/firewall, VBA).  Any help is greatly appreciated!</p>\n\n<p>As requested: </p>\n\n<pre><code>    Function ConcatUniq(ByRef rng As Range, _\n    ByVal myJoin As String) As String\nDim r As Range\nStatic dic As Object\nIf dic Is Nothing Then _\nSet dic = CreateObject(\"Scripting.Dictionary\")\nFor Each r In rng\n    dic(r.Value) = Empty\nNext\nConcatUniq = Join$(dic.keys, myJoin)\ndic.RemoveAll\nEnd Function\n\n'syntax = concatuniq(RANGE,\"delimeter\")\n</code></pre>\n"}, {"tags": ["html", "excel", "vba", "web-scraping"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1541525538, "post_id": 53177017, "comment_id": 93244055, "body": "Stack Overflow is not a code writing service, where you post a list of your requirements and language of choice someone writes the code for you. We&#39;re more than happy to help, but we expect you to make an effort to solve the problem yourself first. Once you&#39;ve done so, you can explain the problem you&#39;re having, include the <b>relevant</b> portions of your work, and ask a specific question, and we&#39;ll try to help."}, {"owner": {"reputation": 47, "user_id": 10400084, "user_type": "registered", "profile_image": "https://graph.facebook.com/1059708894189741/picture?type=large", "display_name": "\uae40\uae30\uc131", "link": "https://stackoverflow.com/users/10400084/%ea%b9%80%ea%b8%b0%ec%84%b1"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1541526472, "post_id": 53177017, "comment_id": 93244515, "body": "SORRY, KEN White..I&#39;ve already experienced a lot of failures and I&#39;ve been asking you for help. I do not attach my case after trial and error, so I think you misunderstood. So I tried to attach the failed logic again. I would appreciate it if you understood it well after many failures."}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1541538142, "creation_date": 1541538142, "answer_id": 53179949, "question_id": 53177017, "link": "https://stackoverflow.com/questions/53177017/file-download-and-open-through-vba/53179949#53179949", "title": "file download and open through VBA", "body": "<p>You could just grab the table by its id and then loop the table rows and table cells within rows.</p>\n\n<pre><code>Option Explicit\nPublic Sub GetInfo()\n    Dim IE As New InternetExplorer, hTable As HTMLTable\n    Const MAX_WAIT_SEC As Long = 5\n    Application.ScreenUpdating = False\n    With IE\n        .Visible = True\n        .navigate \"http://www.kobis.or.kr/kobis/business/stat/boxs/findFormerBoxOfficeList.do?loadEnd=0&amp;searchType=search&amp;sMultiMovieYn=&amp;sRepNationCd=&amp;sWideAreaCd=\"\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n        Set hTable = .document.getElementById(\"table_former\")\n\n        WriteTable hTable, 1, ThisWorkbook.Worksheets(\"Sheet1\")\n\n        .Quit\n        Application.ScreenUpdating = True\n    End With\n\nEnd Sub\n\n\nPublic Sub WriteTable(ByVal hTable As HTMLTable, Optional ByVal startRow As Long = 1, Optional ByVal ws As Worksheet)\n\n    If ws Is Nothing Then Set ws = ActiveSheet\n\n    Dim tSection As Object, tRow As Object, tCell As Object, tr As Object, td As Object, r As Long, c As Long, tBody As Object\n    r = startRow\n    With ws\n        Dim headers As Object, header As Object, columnCounter As Long\n        Set headers = hTable.getElementsByTagName(\"th\")\n        For Each header In headers\n            columnCounter = columnCounter + 1\n            .Cells(startRow, columnCounter) = header.innerText\n        Next header\n        startRow = startRow + 1\n        Set tBody = hTable.getElementsByTagName(\"tbody\")\n        For Each tSection In tBody               'HTMLTableSection\n            Set tRow = tSection.getElementsByTagName(\"tr\") 'HTMLTableRow\n            For Each tr In tRow\n                r = r + 1\n                Set tCell = tr.getElementsByTagName(\"td\")\n                c = 1\n                For Each td In tCell             'DispHTMLElementCollection\n                    .Cells(r, c).Value = td.innerText 'HTMLTableCell\n                    c = c + 1\n                Next td\n            Next tr\n        Next tSection\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>References (VBE> Tools > References):</strong></p>\n\n<ol>\n<li>Microsoft HTML Object Library</li>\n<li>Microsoft Internet Controls</li>\n</ol>\n"}], "owner": {"reputation": 47, "user_id": 10400084, "user_type": "registered", "profile_image": "https://graph.facebook.com/1059708894189741/picture?type=large", "display_name": "\uae40\uae30\uc131", "link": "https://stackoverflow.com/users/10400084/%ea%b9%80%ea%b8%b0%ec%84%b1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 228, "favorite_count": 0, "accepted_answer_id": 53179949, "answer_count": 1, "score": -1, "last_activity_date": 1541544318, "creation_date": 1541525381, "last_edit_date": 1541544318, "question_id": 53177017, "link": "https://stackoverflow.com/questions/53177017/file-download-and-open-through-vba", "title": "file download and open through VBA", "body": "<p>I want to download the Excel file attached to html via Excel vba and output it in Excel sheet. This homepage is a list of the current status of the box office that has been popular in Korean movie theaters.</p>\n\n<p><a href=\"http://www.kobis.or.kr/kobis/business/stat/boxs/findFormerBoxOfficeList.do?loadEnd=0&amp;searchType=search&amp;sMultiMovieYn=&amp;sRepNationCd=&amp;sWideAreaCd=\" rel=\"nofollow noreferrer\">http://www.kobis.or.kr/kobis/business/stat/boxs/findFormerBoxOfficeList.do?loadEnd=0&amp;searchType=search&amp;sMultiMovieYn=&amp;sRepNationCd=&amp;sWideAreaCd=</a></p>\n\n<h2>Attached file is Excel. I understand that downloading can be done using the click method through Internet search. However, an alert window appears during downloading of the file, and the date is inserted in the name of the Excel file to be downloaded. As a beginner in Excel VBA it is very difficult. So I left this question, and what logic would it be useful to implement to spread this file on an Excel sheet? I am a beginner in Excel VBA so if you give me a detailed answer, it will be really helpful.</h2>\n\n<pre><code>&lt;p class = \"btn_regi\"&gt;\n&lt;a href=\"#none\" class=\"btn_type01\" onclick=\"chkform('excel'); return false ;\"&gt; \n&lt;strong&gt; Excel &lt;/ strong&gt; &lt;/a&gt;\n&lt;/ p&gt;\n</code></pre>\n\n<p>The following logic I have coded myself until dawn. However, the logic was too inefficient and the results did not work so I asked for help.</p>\n\n<pre><code>Sub program_()\n\n        Application.ScreenUpdating = False\n        Application.Calculation = xlCalculationManual\n\n        Dim bridge As String\n\n        Dim WinHttp As New WinHttpRequest\n        Dim sResponse As String, html As New HTMLDocument, hStructure As Object, hTable As HTMLTable\n\n        Dim ws As Worksheet\n        Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n\n        Set WinHttp = CreateObject(\"WinHttp.WinHttpRequest.5.1\")\n\n        Dim Url As String\n        Url = \"http://www.kobis.or.kr/kobis/business/stat/boxs/findFormerBoxOfficeList.do?\"\n\n        Dim p1 As String 'parameter\n        Dim v1 As String\n        Dim p2 As String\n        Dim v2 As String\n        Dim p3 As String\n        Dim v3 As String\n        Dim p4 As String\n        Dim v4 As String\n        Dim p5 As String\n        Dim v5 As String\n        Dim v As Integer\n        Dim g As Integer\n\n        bridge = \"&amp;\"\n        p1 = \"loadEnd=\"\n        v1 = 0\n        p2 = \"searchType=\"\n        v2 = \"search\"\n        p3 = \"sMultiMovieYn=\"\n        v3 = \"\"\n        p4 = \"sRepNationCd=\"\n        v4 = \"\"\n        p5 = \"sWideAreaCd=\"\n        v5 = \"\"\n\n\n            With WinHttp\n\n                .Open \"get\", \"\" &amp; Url &amp; p1 &amp; v1 &amp; bridge &amp; p2 &amp; v2 &amp; bridge &amp; p3 &amp; v3 &amp; bridge &amp; p4 &amp; v4 &amp; bridge &amp; p5 &amp; v5 &amp; \"\"\n                .SetRequestHeader \"Referer\", \"http://www.kobis.or.kr/kobis/business/stat/boxs/findFormerBoxOfficeList.do?\"\n                .SetRequestHeader \"Content-Type\", \"application/x-www-form-urlencoded\"\n                .Send\n                .WaitForResponse ': DoEvents\n\n                sResponse = StrConv(.responseBody, vbUnicode)\n\n            Dim hforms As HTMLFormElement\n\n            With html\n                .body.innerHTML = sResponse\n                sResponse = \"\"\n\n\n                Set hTable = .getElementsByClassName(\"boardList03\")(0)\n            End With\n\n            Dim Arr0() As Variant\n            Dim tRow As Object, tCell As Object, tr As Object, td As Object, r As Long, c As Long\n            r = 0\n            With ws\n                Set tRow = hTable.getElementsByTagName(\"tbody\")(0).getElementsByTagName(\"tr\")\n\n                ReDim Arr0(tRow.Length - 1, 10)\n                For Each tr In tRow\n                    r = r + 1\n                    Set tCell = tr.getElementsByTagName(\"td\")\n\n                Dim j As Integer\n\n                    c = 1\n                    For Each td In tCell\n\n                        If td.ID = \"td_rank\" Then\n                        Arr0(r - 1, 0) = td.innerText\n                        End If\n\n                        If td.ID = \"td_movie\" Then\n                        Arr0(r - 1, 1) = td.getElementsByTagName(\"a\")(0).innerText\n                        End If\n\n                        If td.ID = \"td_openDt\" Then\n                        Arr0(r - 1, 2) = td.innerText\n                        End If\n\n                        If td.ID = \"td_salesAcc\" Then\n                        Arr0(r - 1, 3) = td.innerText\n                        End If\n\n                        If td.ID = \"td_audiAcc\" Then\n                        Arr0(r - 1, 4) = td.innerText\n                        End If\n\n                        If td.ID = \"td_scrnCnt\" Then\n                        Arr0(r - 1, 5) = td.innerText\n                        End If\n\n                        If td.ID = \"td_showCnt\" Then\n                        Arr0(r - 1, 6) = td.innerText\n                        End If\n\n                        c = c + 1\n                    Next td\n\n                Next tr\n\n                Dim k As Integer\n                Dim i As Integer\n\n                k = 0\n                For i = LBound(Arr0, 1) To UBound(Arr0, 1)\n\n                                           .Cells(2 + k + g, 2) = Arr0(i, 0)\n                                           .Cells(2 + k + g, 3) = Arr0(i, 1)\n\n                                           .Cells(2 + k + g, 4) = Arr0(i, 2)\n                                           .Cells(2 + k + g, 5) = Arr0(i, 3)\n                                           .Cells(2 + k + g, 6) = Arr0(i, 4)\n                                           .Cells(2 + k + g, 7) = Arr0(i, 5)\n                                           .Cells(2 + k + g, 8) = Arr0(i, 6)\n                        k = k + 1\n                Next i\n            End With\n\n        Erase Arr0\n\n        Set tRow = Nothing: Set tCell = Nothing: Set tr = Nothing: Set td = Nothing\n        Set hforms = Nothing\n        Set hTable = Nothing\n\n\n        Application.Calculation = xlCalculationAutomatic\n        Application.ScreenUpdating = True\n\n        End Sub\n</code></pre>\n"}]