[{"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 7015053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0df4c1d7ae7b917fc0de4893d2faf75?s=128&d=identicon&r=PG&f=1", "display_name": "Robert S", "link": "https://stackoverflow.com/users/7015053/robert-s"}, "edited": false, "score": 0, "creation_date": 1547155535, "post_id": 54120275, "comment_id": 95105788, "body": "This worked great and the file opens in the left monitor as intended.  One side note: when I clicked &quot;enable editing&quot;, it popped back on the right monitor.  Increasing the left shift fixed this for me.  However, in my opinion, it still should have worked just fine."}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 2, "last_activity_date": 1547078935, "creation_date": 1547078935, "answer_id": 54120275, "question_id": 54120018, "link": "https://stackoverflow.com/questions/54120018/workbookopen-event-doesnt-fire-when-opening-workbooks-in-protected-view/54120275#54120275", "title": "WorkbookOpen event doesn&#39;t fire when opening Workbooks in &quot;Protected View&quot;", "body": "<p>The WorkbookOpen event won't fire for workbooks opened in Protected View. You need the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/Excel.Application.ProtectedViewWindowOpen\" rel=\"nofollow noreferrer\">ProtectedViewWindowOpen event</a>.</p>\n\n<pre><code>Private Sub app_ProtectedViewWindowOpen(ByVal Pvw As ProtectedViewWindow) \n    If Not Win_Toggle = 1 Then Exit Sub\n\n    With app\n        .WindowState = xlNormal\n        .Left = -500\n        .WindowState = xlMaximized\n    End With        \nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 7015053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0df4c1d7ae7b917fc0de4893d2faf75?s=128&d=identicon&r=PG&f=1", "display_name": "Robert S", "link": "https://stackoverflow.com/users/7015053/robert-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "accepted_answer_id": 54120275, "answer_count": 1, "score": 2, "last_activity_date": 1547107810, "creation_date": 1547076973, "last_edit_date": 1547107810, "question_id": 54120018, "link": "https://stackoverflow.com/questions/54120018/workbookopen-event-doesnt-fire-when-opening-workbooks-in-protected-view", "title": "WorkbookOpen event doesn&#39;t fire when opening Workbooks in &quot;Protected View&quot;", "body": "<p>2 Monitor set-up.  1 Active workbook open in the right monitor.  I want to have newly opened workbooks open in the left monitor.  I found how to do this and it works but if the file opens in \"Protected View\", it doesn't fire.  </p>\n\n<p>If I click to enable editing, there's some screen flicker like it worked but the window ends up still on the right monitor.  Subsequently opening the file fires the macro correctly.  However, this won't work for me as I'm opening attachments in Outlook.  </p>\n\n<p>Any way around this?</p>\n\n<p>This is in the <code>\"ThisWorkbook\"</code> module of my <code>Personal.XLSB</code> file:</p>\n\n<pre><code>Private WithEvents app As Application\n\n\nPrivate Sub Workbook_Open()\n    Set app = Application\nEnd Sub\n\n\nPrivate Sub app_WorkbookOpen(ByVal Wb As Workbook)\n    If Not Win_Toggle = 1 Then Exit Sub\n\n    With app\n        .WindowState = xlNormal\n        .Left = -500\n        .WindowState = xlMaximized\n    End With\nEnd Sub\n</code></pre>\n\n<p>The toggle is of course set to 1..</p>\n\n<p>Ideally, it will fire on open and without me clicking \"enable editing\".</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1547075687, "post_id": 54119778, "comment_id": 95072010, "body": "Define issues? Error? Do some values get replaced and not others?"}, {"owner": {"reputation": 95, "user_id": 10065041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43c1168d8ae228c623246639b13fbb64?s=128&d=identicon&r=PG&f=1", "display_name": "dati_17", "link": "https://stackoverflow.com/users/10065041/dati-17"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1547075714, "post_id": 54119778, "comment_id": 95072020, "body": "no errors - nothing was replaced"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1547075716, "post_id": 54119778, "comment_id": 95072022, "body": "I would use <code>rep = Chr(32)</code> instead of <code>rep = &quot;&quot;</code>"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1547075756, "post_id": 54119778, "comment_id": 95072029, "body": "Have you manually looked up the values just as a sense check? (CTRL+F &gt; Find This)"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1547075783, "post_id": 54119778, "comment_id": 95072035, "body": "<code>Dim fnd as String, rep as String</code>"}, {"owner": {"reputation": 95, "user_id": 10065041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43c1168d8ae228c623246639b13fbb64?s=128&d=identicon&r=PG&f=1", "display_name": "dati_17", "link": "https://stackoverflow.com/users/10065041/dati-17"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1547075806, "post_id": 54119778, "comment_id": 95072043, "body": "yes that is how I am verifying - trying Chr(32) tip now"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1547075835, "post_id": 54119778, "comment_id": 95072049, "body": "Oh. The issue is prob the active work book. Use <code>For Each ws in wb</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1547076121, "post_id": 54119778, "comment_id": 95072109, "body": "Chr(32) (a space) is not the same as &quot;&quot; (an empty string)"}], "answers": [{"tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 1, "last_activity_date": 1547075998, "creation_date": 1547075998, "answer_id": 54119866, "question_id": 54119778, "link": "https://stackoverflow.com/questions/54119778/issues-with-find-and-replace-all-with-multiple-files-in-same-directory-excel-v/54119866#54119866", "title": "Issues with find and replace all with multiple files in same directory - Excel VBA", "body": "<p>Your code is relying on the <code>Active Workbook</code> which is the likely culprit. </p>\n\n<p>Change <code>For Each ws In ActiveWorkbook.Worksheets</code> to <code>For Each ws in wb.Worksheets</code> to explicitly refer to the workbook. </p>\n\n<p>You have also dimmed you strings <code>fnd</code> &amp; <code>rep</code> as variants. These should be strings and the proper way to shorthand declare two variables is <code>Dim fnd as String, rep as String</code>. The way you went about is actually declaring both variables as variant. </p>\n"}, {"tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": true, "score": 1, "last_activity_date": 1547078289, "last_edit_date": 1547078289, "creation_date": 1547077657, "answer_id": 54120090, "question_id": 54119778, "link": "https://stackoverflow.com/questions/54119778/issues-with-find-and-replace-all-with-multiple-files-in-same-directory-excel-v/54120090#54120090", "title": "Issues with find and replace all with multiple files in same directory - Excel VBA", "body": "<h1>Through Workbooks and Worksheets</h1>\n\n<pre><code>Sub UGA()\n 'PURPOSE: Loop through all Excel files in a user specified folder and perform a set task on them\n\n    Const fnd As String = \"find this\"\n    Const rep As String = \"\"\n    Const cStrExtensions As String = \"*.xls*\"\n\n    Dim ws As Worksheet\n    Dim strFolderPath As String     ' Search Folder\n    Dim strFileName As String       ' Current File Name (Workbook)\n\n    With Application\n        .ScreenUpdating = False\n        .DisplayAlerts = False\n    End With\n\n    On Error GoTo ProcedureExit\n\n    ' Choose Search Folder\n    With Application.FileDialog(msoFileDialogFolderPicker)\n        If .Show = False Then Exit Sub\n        strFolderPath = .SelectedItems(1) &amp; \"\\\"\n    End With\n\n    ' Loop through folder to determine Current File Name (Workbook).\n    strFileName = Dir(strFolderPath &amp; cStrExtensions)\n\n    ' Loop through files in folder.\n    Do While strFileName &lt;&gt; \"\"\n\n        ' Open each file in folder\n        Workbooks.Open strFolderPath &amp; strFileName\n\n        With ActiveWorkbook\n\n            ' Loop through each worksheet in ActiveWorkbook\n            For Each ws In .Worksheets\n                ws.Cells.Replace What:=fnd, Replacement:=rep, _\n                    LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=False, _\n                    SearchFormat:=False, ReplaceFormat:=False\n            Next\n            .Close True\n        End With\n\n        strFileName = Dir()\n\n        ' Exclude this workbook.\n        'If ThisWorkbook.Name = strFileName Then strFileName = Dir()\n\n    Loop\n\n    'Message Box when tasks are completed\n    MsgBox \"Complete!\"\n\nProcedureExit:\n\n  With Application\n    .ScreenUpdating = True\n    .DisplayAlerts = True\n  End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 10065041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43c1168d8ae228c623246639b13fbb64?s=128&d=identicon&r=PG&f=1", "display_name": "dati_17", "link": "https://stackoverflow.com/users/10065041/dati-17"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 54120090, "answer_count": 2, "score": 0, "last_activity_date": 1547107805, "creation_date": 1547075528, "last_edit_date": 1547107805, "question_id": 54119778, "link": "https://stackoverflow.com/questions/54119778/issues-with-find-and-replace-all-with-multiple-files-in-same-directory-excel-v", "title": "Issues with find and replace all with multiple files in same directory - Excel VBA", "body": "<p>code runs, however does not find/replace values.</p>\n\n<p>I believe issues are in the for loop with worksheets and replacement method</p>\n\n<pre><code>    Sub UGA()\n    'PURPOSE: Loop through all Excel files in a user specified folder and perform a set task on them\n\n    Dim wb As Workbook\n    Dim ws As Worksheet\n    Dim myPath, myFile, myExtension As String\n    Dim fnd, rep As Variant\n    Dim FldrPicker As FileDialog\n\n    'Loop through each Excel file in folder\n      Do While myFile &lt;&gt; \"\"\n        'Set variable equal to opened workbook\n          Set wb = Workbooks.Open(Filename:=myPath &amp; myFile)\n\n        'Ensure Workbook has opened before moving on to next line of code\n          DoEvents\n\n        'find and replace with blank\n          fnd = \"find this\"\n          rep = \"\"\n\n        'Loop through each worksheet in ActiveWorkbook\n          For Each ws In ActiveWorkbook.Worksheets\n                  ws.Cells.Replace What:=fnd, Replacement:=rep, _\n                  LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=False, _\n                  SearchFormat:=False, ReplaceFormat:=False\n          Next ws\n\n        'Save and Close Workbook\n          wb.Close SaveChanges:=True\n\n        'Ensure Workbook has closed before moving on to next line of code\n          DoEvents\n\n        'Get next file name\n          myFile = Dir\n      Loop\n\n    'Message Box when tasks are completed\n      MsgBox \"Complete!\"\n\n    End Sub\n</code></pre>\n\n<p>expected to find defined value and replace with blanks (\"\")</p>\n"}, {"tags": ["excel", "vba", "excel-formula", "ms-office"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 5, "creation_date": 1547073096, "post_id": 54119313, "comment_id": 95071284, "body": "how can <code>AND(B2&gt;10,A2=0,B2= &quot;&quot;)</code> ever be TRUE.  B2 can not be greater than 10 AND &quot;&quot; at the same time."}, {"owner": {"reputation": 1352, "user_id": 10814503, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QsZ5pJcPoLg/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jT3DgOvSVgL4Sa6iCfK8mLTYcOsw/mo/photo.jpg?sz=128", "display_name": "Angel M.", "link": "https://stackoverflow.com/users/10814503/angel-m"}, "edited": false, "score": 0, "creation_date": 1547073217, "post_id": 54119313, "comment_id": 95071320, "body": "Hi Rob and welcome to StackOverflow. One trick is to activate the Developer option in the menu, record a new macro, do the action you want and stop recording the macro. Then, the system has created the VBA code for you and you can start from something that works. Be careful because it works asuming you are in the same Tab, position..."}, {"owner": {"reputation": 371, "user_id": 6736247, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/02978b1fa42fb47db1cbb90c71664e8d?s=128&d=identicon&r=PG&f=1", "display_name": "Eleshar", "link": "https://stackoverflow.com/users/6736247/eleshar"}, "edited": false, "score": 0, "creation_date": 1547074024, "post_id": 54119313, "comment_id": 95071546, "body": "My guess is that a UDF can hardly be more efficient than a core formula."}], "answers": [{"tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 1, "last_activity_date": 1547076806, "last_edit_date": 1547076806, "creation_date": 1547074877, "answer_id": 54119677, "question_id": 54119313, "link": "https://stackoverflow.com/questions/54119313/new-to-vba-and-im-trying-to-create-a-function/54119677#54119677", "title": "New to VBA and I&#39;m trying to create a function", "body": "<p>If you do not want to supply an input to the UDF, you can grab the row number and worksheet using <code>Application.Caller</code>. Otherwise, you can add two arguments for the <code>A2</code> &amp; <code>B2</code> range and compare the value there.</p>\n\n<p>I have made no performance tests regarding the two methods, but I would imagine the one that does <strong>not</strong> use <code>Application.Caller</code> would be the one that has greater performance - but I figured another example wouldn't hurt.</p>\n\n<h1>Application.Caller Method</h1>\n\n<pre><code>Function myFunc() As String\n\n    Dim r As Long, ws As Worksheet\n    Set ws = Application.Caller.Worksheet\n    r = Application.Caller.Row\n\n    If ws.Cells(r, \"B\").Value &gt;= 65 And ws.Cells(r, \"A\").Value &gt;= 7 Then\n        myFunc = \"Greenbox\"\n    ElseIf ws.Cells(r, \"B\").Value &gt; 10 And ws.Cells(r, \"A\").Value = 0 Then\n        myFunc = \"Balance\"\n    '.... Continue\n    End If\n\nEnd Function\n</code></pre>\n\n<p>Which the worksheet formula would look like: <code>=myFunc()</code>. <em>(no arguments needed)</em></p>\n\n<hr>\n\n<h1>Function with Arguments Method</h1>\n\n<pre><code>Function myFunc(rngA As Range, rngB As Range) As String\n\n    If rngB.Value &gt;= 65 And rngA.Value &gt;= 7 Then\n        myFunc = \"Greenbox\"\n    ElseIf rngB.Value &gt; 10 And rngA.Value = 0 Then\n        myFunc = \"Balance\"\n    '.... Continue\n    End If\n\nEnd Function\n</code></pre>\n\n<p>Which the worksheet formula would look like: <code>=myFunc($A2, $B2)</code>.</p>\n\n<p>As already mentioned in the comments by Scott Craner, <code>AND(B2&gt;10,A2=0,B2= \"\")</code> isn't logically correct. <code>B2&gt;10</code> and <code>B2=\"\"</code> will never be <strong>True</strong> when used together with <code>AND</code>, so you may need to figure your intentions out with that one.</p>\n"}, {"tags": [], "owner": {"reputation": 14, "user_id": 9911263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b51873bd0f962910564fc0bc127cfc2?s=128&d=identicon&r=PG&f=1", "display_name": "Lamplighter", "link": "https://stackoverflow.com/users/9911263/lamplighter"}, "is_accepted": true, "score": 0, "last_activity_date": 1547079824, "creation_date": 1547079824, "answer_id": 54120386, "question_id": 54119313, "link": "https://stackoverflow.com/questions/54119313/new-to-vba-and-im-trying-to-create-a-function/54120386#54120386", "title": "New to VBA and I&#39;m trying to create a function", "body": "<p>Here's a go.  Total is the value returned in the cell with the function called.\nIt would be cell a2 and B would be cell b2 in the example\n=caseTest(A2,B2)</p>\n\n<p>Per Scott's note, &lt;10 is used rather than null.  Feel free to edit.</p>\n\n<p>There is also a default value if none of the conditions are met. Happy coding.</p>\n\n<pre><code>Function caseTest(A, B)\n\nDim scoreA As Integer, scoreB As Integer, result As String\n    scoreA = A.Value\nscoreB = B.Value\n\nIf ((scoreA &gt;= 7) And (scoreB &gt;= 65)) Then\n    Total = \"Greenbox\"\nElseIf ((scoreA = 0) And (scoreB &lt;10)) Then\n    Total = \"Balance\"\nElseIf ((scoreA &lt; 3) And (scoreB &gt;= 65)) Then\n    Total = \"Yellowbox\"\nElseIf ((scoreA &gt;= 7) And (scoreB &lt; 65)) Then\n    Total = \"Purplebox\"\nElseIf ((scoreA &lt;= 3) And (scoreA &gt;= 1) And (scoreB &lt; 65)) Then\n    Total = \"Orangebox\"\nElseIf ((scoreA &gt;= 3) And (scoreA &lt; 7) And (scoreB &gt;= 65))) Then\n    Total = \"Bluebox\"\nElseIf ((scoreA &gt;= 3) And (scoreA &lt; 7) And (scoreB &lt; 65))) Then\n    Total = \"Redbox\"\nElse\n    Total = \"default\"\nEnd If\n    caseTest = Total\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 10892331, "user_type": "registered", "profile_image": "https://graph.facebook.com/10101093662219052/picture?type=large", "display_name": "Rob Lee", "link": "https://stackoverflow.com/users/10892331/rob-lee"}, "edited": false, "score": 0, "creation_date": 1547128196, "post_id": 54121391, "comment_id": 95091324, "body": "Thank you - this is perfect"}], "tags": [], "owner": {"reputation": 106, "user_id": 5084013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a53c7e8d047c9b80d252bafdc888195?s=128&d=identicon&r=PG&f=1", "display_name": "Hansraj", "link": "https://stackoverflow.com/users/5084013/hansraj"}, "is_accepted": false, "score": 0, "last_activity_date": 1547089206, "creation_date": 1547089206, "answer_id": 54121391, "question_id": 54119313, "link": "https://stackoverflow.com/questions/54119313/new-to-vba-and-im-trying-to-create-a-function/54121391#54121391", "title": "New to VBA and I&#39;m trying to create a function", "body": "<p>if you need help on creating custom functions below link is an useful guide\n<a href=\"https://support.office.com/en-us/article/create-custom-functions-in-excel-2f06c10b-3622-40d6-a1b2-b6748ae8231f\" rel=\"nofollow noreferrer\">https://support.office.com/en-us/article/create-custom-functions-in-excel-2f06c10b-3622-40d6-a1b2-b6748ae8231f</a>.</p>\n\n<p>To answer your question, I have created a custom function based on what I deciphered from your formula. </p>\n\n<pre><code>Function Cust_SetBox(A as Range, B as Range) As String\n'function will receive two parameters A and B as ranges and return back a string\n   Application.Volatile 'this ensures that formula will update when cell values are modified\n\n   'Original formula\n   '=IF((AND(B2&gt;=65,A2&gt;=7)),\"Greenbox\",IF((AND(B2&gt;10,A2=0,B2= \"\")),\"Balance\",IF((AND(B2&gt;=65,A2&lt;3)),\"Yellowbox\",IF((AND(B2&lt;65,A2&gt;=7)),\"Purplebox\",IF((AND(B2&lt;65,A2&lt;=3,A2&gt;=1)),\"Orangebox\",\n   'IF(AND(B2&gt;=65,A2&lt;7,A2&gt;=3),\"Bluebox\",IF(AND(A2&lt;7,A2&gt;=3,B2&lt;65),\"Redbox\")))))))\n\n   'adding .value=\"\" condition as emtpy cells will show up as true while checking for X.Value&lt;n\n   If B.Value = \"\" And A.Value = \"\" Then\n       Cust_SetBox = \"Unknown\"\n   ElseIf (B.Value = \"\" Or B.Value &gt; 10) And A.Value = 0 Then 'you might want to check this condition as it is not clear from your formula\n       Cust_SetBox = \"Balance\"\n   ElseIf B.Value &gt;= 65 And B.Value &lt;&gt; \"\" Then\n       If A.Value &gt;= 7 Then\n           Cust_SetBox = \"Greenbox\"\n       ElseIf A.Value &lt; 3 Then\n           Cust_SetBox = \"Yellowbox\"\n       ElseIf A.Value &lt; 7 And A.Value &gt;= 3 Then\n           Cust_SetBox = \"Bluebox\"\n       End If\n   ElseIf B.Value &lt; 65 And B.Value &lt;&gt; \"\" Then\n       If A.Value &gt;= 7 Then\n           Cust_SetBox = \"Purplebox\"\n       ElseIf A.Value &lt;= 3 And A.Value &gt;= 1 Then\n           Cust_SetBox = \"Orangebox\"\n       ElseIf A.Value &lt; 7 And A.Value &gt;= 3 Then\n           Cust_SetBox = \"Redbox\"\n       End If\n   Else\n       Cust_SetBox = \"Unknown\"\n   End If\n\n\n\nEnd Function\n</code></pre>\nTo quickly add this function to your workbook. \nuse Alt+F11, insert a new module and add above code to the module. You should be able to use this new function as a formula.\nGo to any cell and type the below\n=Cust_SetBox(A1,B1)\nThe cell will show the value based on the logic above. Detailed explanation in the link above.\n\n<p><strong>Note</strong></p>\n\n<p>Make sure Calculation is set to automatically calculate (in Formulas menu -> Calculation options) else press F9 to calculate</p>\n\n<p>The workbook has to be saved as a macro enabled file else the function will not be available later.</p>\n"}], "owner": {"reputation": 3, "user_id": 10892331, "user_type": "registered", "profile_image": "https://graph.facebook.com/10101093662219052/picture?type=large", "display_name": "Rob Lee", "link": "https://stackoverflow.com/users/10892331/rob-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 1, "accepted_answer_id": 54120386, "answer_count": 3, "score": 0, "last_activity_date": 1547089206, "creation_date": 1547072805, "last_edit_date": 1547072972, "question_id": 54119313, "link": "https://stackoverflow.com/questions/54119313/new-to-vba-and-im-trying-to-create-a-function", "title": "New to VBA and I&#39;m trying to create a function", "body": "<p>I'm attempting to make a user-defined function that mimics my formula. I need something more efficient than my formula.</p>\n\n<p>I've tried VBA and using the above formula as is. This is ineffective for the larger datasets I'm working with.</p>\n\n<pre><code>=IF((AND(B2&gt;=65,A2&gt;=7)),\"Greenbox\",IF((AND(B2&gt;10,A2=0,B2= \"\")),\"Balance\",IF((AND(B2&gt;=65,A2&lt;3)),\"Yellowbox\",IF((AND(B2&lt;65,A2&gt;=7)),\"Purplebox\",IF((AND(B2&lt;65,A2&lt;=3,A2&gt;=1)),\"Orangebox\",IF(AND(B2&gt;=65,A2&lt;7,A2&gt;=3),\"Bluebox\",IF(AND(A2&lt;7,A2&gt;=3,B2&lt;65),\"Redbox\")))))))\n</code></pre>\n\n<p>A VBA function that mimics the formula.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1547072160, "post_id": 54119042, "comment_id": 95070949, "body": "Is there a problem with your existing code?"}, {"owner": {"reputation": 33, "user_id": 7751721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd7ee5cd202d4b07f59becf288c797db?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/7751721/gene"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1547073459, "post_id": 54119042, "comment_id": 95071389, "body": "It&#39;s not complete, as far as I know... All I did was wrap the i variable for loop inside of the j variable for loop and defined the values for the array..."}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1547140378, "post_id": 54119042, "comment_id": 95098895, "body": "you have to be careful of where you want to get your info from when you say  With ThisWorkbook.Sheets(&quot;Question2&quot;), then you have assignments and references inside a loop.  I would rather you type it out Explicitly what sheet until it works and then you can roll back through and use your WITH statements so you know exactly where the data is that you are referencing and exactly where you want it placed."}, {"owner": {"reputation": 33, "user_id": 7751721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd7ee5cd202d4b07f59becf288c797db?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/7751721/gene"}, "edited": false, "score": 0, "creation_date": 1547144764, "post_id": 54119042, "comment_id": 95101069, "body": "I agree with you on this... see below comments... But how do i explicitly call the userform1?  I tried Forms.UserForm1... but it did not work..."}], "answers": [{"comments": [{"owner": {"reputation": 67968, "user_id": 584192, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YBSIc.png?s=128&g=1", "display_name": "Samuel Liew", "link": "https://stackoverflow.com/users/584192/samuel-liew"}, "edited": false, "score": 0, "creation_date": 1547276685, "post_id": 54119650, "comment_id": 95145252, "body": "Comments are not for extended discussion; this conversation has been <a href=\"https://chat.stackoverflow.com/rooms/186582/discussion-on-answer-by-tim-williams-adding-multiple-columns-of-of-multiple-row\">moved to chat</a>."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1547074725, "creation_date": 1547074725, "answer_id": 54119650, "question_id": 54119042, "link": "https://stackoverflow.com/questions/54119042/adding-multiple-columns-of-of-multiple-row-values-into-an-array-of-custom-type/54119650#54119650", "title": "Adding multiple columns of of multiple row values into an array of custom type", "body": "<p>Something like this should work:</p>\n\n<pre><code>Public CEEStudent() As Student\n\n\n'***** MyType as an array\nPublic Sub fillCEEStudent()\n    Dim j As Long, i As Long\n\n    ReDim CEEStudent(20)\n\n    With ThisWorkbook.Sheets(\"Question1\")\n        j = 0\n        For i = 3 To 22\n            'might need to tweak the column positions\n            CEEStudent(j).StudentID = .Cells(i, \"C\").Value\n            CEEStudent(j).StudentGPA = .Cells(i, \"H\").Value\n            CEEStudent(j).ComprehensiveTaker = IIf(.Cells(i, \"G\").Value &lt;&gt; \"\", 1, 0)\n            CEEStudent(j).FinalScore = .Cells(i, \"I\").Value\n            j = j + 1\n        Next i\n    End With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 7751721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd7ee5cd202d4b07f59becf288c797db?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/7751721/gene"}, "edited": false, "score": 0, "creation_date": 1547099479, "post_id": 54121069, "comment_id": 95077003, "body": "The Custom Type and definitions are required unfortunately. I have been working on it,  but keep getting an &quot;Out of Range error&quot; on the line where you first attempt to assign a value to CEEStudent(0)."}, {"owner": {"reputation": 33, "user_id": 7751721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd7ee5cd202d4b07f59becf288c797db?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/7751721/gene"}, "edited": false, "score": 0, "creation_date": 1547099691, "post_id": 54121069, "comment_id": 95077059, "body": "BTW, it is only 2 E&#39;s i CEEStudent... Also, I did try running it as you typed it above and got the same error. The only difference is that I am declaring CEEStudent as type Student, which is defined publicly.  I think the issue is that you are comparing studentID to the actual row number, if I am correct. But the Student IDs are random numbers between 5 and 186 and not in any articular order (though they could be sorted as such."}, {"owner": {"reputation": 8696, "user_id": 10746224, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/znUL5.jpg?s=128&g=1", "display_name": "Lord Elrond", "link": "https://stackoverflow.com/users/10746224/lord-elrond"}, "reply_to_user": {"reputation": 33, "user_id": 7751721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd7ee5cd202d4b07f59becf288c797db?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/7751721/gene"}, "edited": false, "score": 0, "creation_date": 1547127122, "post_id": 54121069, "comment_id": 95090704, "body": "I understand now; I didn&#39;t realize that CEEStudent was defined elsewhere.  Can you open a blank workbook and see if you can run the macro in edit 1?"}, {"owner": {"reputation": 33, "user_id": 7751721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd7ee5cd202d4b07f59becf288c797db?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/7751721/gene"}, "edited": false, "score": 0, "creation_date": 1547130878, "post_id": 54121069, "comment_id": 95092995, "body": "I get the error &#39;Sub or Function Not Defined&#39; and it highlights the first CeeStudent(20) line in test()"}, {"owner": {"reputation": 8696, "user_id": 10746224, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/znUL5.jpg?s=128&g=1", "display_name": "Lord Elrond", "link": "https://stackoverflow.com/users/10746224/lord-elrond"}, "reply_to_user": {"reputation": 33, "user_id": 7751721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd7ee5cd202d4b07f59becf288c797db?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/7751721/gene"}, "edited": false, "score": 0, "creation_date": 1547131240, "post_id": 54121069, "comment_id": 95093254, "body": "Sorry I had them backwards.  I fixed it in EDIT1."}, {"owner": {"reputation": 33, "user_id": 7751721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd7ee5cd202d4b07f59becf288c797db?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/7751721/gene"}, "edited": false, "score": 0, "creation_date": 1547131584, "post_id": 54121069, "comment_id": 95093486, "body": "ok, will try it now. I added the original code that performs the intitial calculations on wb1... not thT IT WILL DIRECTLY HELP..."}, {"owner": {"reputation": 33, "user_id": 7751721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd7ee5cd202d4b07f59becf288c797db?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/7751721/gene"}, "edited": false, "score": 0, "creation_date": 1547131699, "post_id": 54121069, "comment_id": 95093577, "body": "Same thing: &#39;Compile Error Sub or Function not Defined&#39; Highlights the first CEEStudent"}, {"owner": {"reputation": 33, "user_id": 7751721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd7ee5cd202d4b07f59becf288c797db?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/7751721/gene"}, "edited": false, "score": 0, "creation_date": 1547132006, "post_id": 54121069, "comment_id": 95093766, "body": "This is driving me nuts... I have to follow these parameters: CEEStudent must be declared as a public variable of the type Student and then a userform that allows a user to input their student ID and displays back the corresponding final score and gpa of the student using the data in the workbook &quot;Question1&quot;, which the first row of data starts at C3 and goes down to C22 / Columns C - I"}], "tags": [], "owner": {"reputation": 8696, "user_id": 10746224, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/znUL5.jpg?s=128&g=1", "display_name": "Lord Elrond", "link": "https://stackoverflow.com/users/10746224/lord-elrond"}, "is_accepted": false, "score": 0, "last_activity_date": 1547131126, "last_edit_date": 1547131126, "creation_date": 1547086367, "answer_id": 54121069, "question_id": 54119042, "link": "https://stackoverflow.com/questions/54119042/adding-multiple-columns-of-of-multiple-row-values-into-an-array-of-custom-type/54121069#54121069", "title": "Adding multiple columns of of multiple row values into an array of custom type", "body": "<p>I don't really understand the Public student stuff at the beginning, and I don't think it is necessary to do what you need.  As long as you know how to setup a userform (which I know nothing about) The following code should do what you need.</p>\n\n<pre><code>sub macro()\n\nDim id as int, CEEEStudent() as variant, idRow as long, ws1 as Worksheet, ws2 as Worksheet\n\nSet ws1 = ThisWorkbook.Worksheets(\"Question 1\")\nSet ws2 = ThisWorkbook.Worksheets(\"Sheet where data goes\")\n\n'insert code for a userform and store studentid = id here\nid = ?\n\n\n'this checks each row on the sheet and compares it to id, when it finds a match the row is stored to idRow\nfor x = 1 to Cells(Rows.Count, 1).End(xlUp).Row\n    if id = ws1.cells(x, 1) Then\n    idRow = x\n    Else:\n    End if\nnext x\n\n'this stores the student's results to CEEEStudent(), each time a new student logs in it will overwrite the data from the previous student \nCEEEStudent(0) = ws1.Cells(idRow, 1).value\nCEEEStudent(1) = ws1.Cells(idRow, 5).value\nCEEEStudent(2) = ws1.Cells(idRow, 6).value\nCEEEStudent(3) = ws1.Cells(idRow, 7).value\n\nws2.activate\n\n'This sets the value and headers that the student will see.  Again this will be overwritten after every login.\n\nws2.Cells(1, 1).Value = \"Student ID\"\nws2.Cells(2, 1).Value = CEEEStudent(0)\n\nws2.Cells(1, 2).Value = \"Final Exam\"\nws2.Cells(2, 2).Value = CEEEStudent(1)\n\nws2.Cells(1, 3).Value = \"GPA\"\nws2.Cells(2, 3).Value = CEEEStudent(2)\n\nws2.Cells(1, 4).Value = \"Final Score\"\nws2.Cells(2, 4).Value = CEEEStudent(3)\n\n\n\n\nend sub\n</code></pre>\n\n<p>EDIT 1</p>\n\n<pre><code>Public Type Student\nStudentID As Integer ' Student ID\nFinalScore As Integer ' Studnts final score\nComprehensiveTaker As Integer ' Comprehensivetaker\nStudentGPA As Double ' Student's GPA\nEnd Type\n\nPublic CEEStudent(20) As Student\n\npublic Sub test()\n\nCells(1, 1).Value = CEEStudent(20).StudentID \nCells(1, 2).Value = CEEStudent(20).StudentGPA \nCells(1, 3).Value = CEEStudent(20).ComprehensiveTaker \nCells(1, 4).Value = CEEStudent(20).FinalScore                             \n\nEnd sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 7751721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd7ee5cd202d4b07f59becf288c797db?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/7751721/gene"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1547152974, "creation_date": 1547071377, "last_edit_date": 1547152974, "question_id": 54119042, "link": "https://stackoverflow.com/questions/54119042/adding-multiple-columns-of-of-multiple-row-values-into-an-array-of-custom-type", "title": "Adding multiple columns of of multiple row values into an array of custom type", "body": "<p>I have a worksheet that tracks  student test scores and gpa information. The worksheet layout is as follows:</p>\n\n<p>Student ID, Name, Test 1 Score, Test 2 Score, Final Exam Score, GPA and Final Score. There are 20 rows.</p>\n\n<p>I need to get the student id, whether or not they took the final exam, the gpa and the final score and store them in an array of custom type. Then there will be a form where a student inputs their id and it retrieves the appropriate data from the array.</p>\n\n<p>I put a sample two row table in and the vba code I have so far. </p>\n\n<p>My question is how do i get this data into the Array? </p>\n\n<p>I am totally confused at this point....</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;div id=\"good_5932\" align=center x:publishsource=\"Excel\"&gt;\r\n\r\n&lt;table border=0 cellpadding=0 cellspacing=0 width=611 class=xl635932\r\n style='border-collapse:collapse;table-layout:fixed;width:458pt'&gt;\r\n &lt;col class=xl635932 width=74 style='mso-width-source:userset;mso-width- \r\n alt:\r\n 2645;width:56pt'&gt;\r\n &lt;col class=xl635932 width=100 style='mso-width-source:userset;mso-width- \r\n alt:\r\n 3555;width:75pt'&gt;\r\n &lt;col class=xl635932 width=76 style='mso-width-source:userset;mso-width- \r\n alt:\r\n 2702;width:57pt'&gt;\r\n &lt;col class=xl635932 width=77 style='mso-width-source:userset;mso-width- \r\n alt:\r\n 2730;width:58pt'&gt;\r\n &lt;col class=xl635932 width=152 style='mso-width-source:userset;mso-width- \r\n alt:\r\n 5404;width:114pt'&gt;\r\n &lt;col class=xl635932 width=66 style='width:49pt'&gt;\r\n &lt;col class=xl695932 width=66 style='width:49pt'&gt;\r\n &lt;tr height=37 style='height:27.6pt'&gt;\r\n  &lt;td height=37 class=xl655932 width=74 \r\n  style='height:27.6pt;width:56pt'&gt;Student\r\n  ID&lt;/td&gt;\r\n  &lt;td class=xl655932 width=100 style='border-left:none;width:75pt'&gt;Student \r\n  Name&lt;/td&gt;\r\n  &lt;td class=xl665932 width=76 style='border-left:none;width:57pt'&gt;Test 1 \r\n  Score&lt;/td&gt;\r\n  &lt;td class=xl665932 width=77 style='border-left:none;width:58pt'&gt;Test 2 \r\n  Score&lt;/td&gt;\r\n  &lt;td class=xl665932 width=152 style='border- \r\n left:none;width:114pt'&gt;Comprehensive\r\n  Final&lt;/td&gt;\r\n  &lt;td class=xl665932 width=66 style='border-left:none;width:49pt'&gt;Student \r\n  GPA&lt;/td&gt;\r\n  &lt;td class=xl685932 width=66 style='border-left:none;width:49pt'&gt;Final \r\n  Score&lt;/td&gt;\r\n &lt;/tr&gt;\r\n &lt;tr height=19 style='height:14.4pt'&gt;\r\n  &lt;td height=19 class=xl645932 style='height:14.4pt;border- \r\n  top:none'&gt;5&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;Joe&lt;span\r\n  style='mso-spacerun:yes'&gt; &lt;/span&gt;&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;78&lt;/td&gt;\r\n  &lt;td class=xl675932 style='border-top:none;border-left:none'&gt;12&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;87&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;3.5&lt;/td&gt;\r\n  &lt;td class=xl675932 style='border-top:none;border-left:none'&gt;96&lt;/td&gt;\r\n &lt;/tr&gt;\r\n &lt;tr height=19 style='height:14.4pt'&gt;\r\n  &lt;td height=19 class=xl645932 style='height:14.4pt;border- \r\n  top:none'&gt;7&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;Hans&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;80&lt;/td&gt;\r\n  &lt;td class=xl675932 style='border-top:none;border-left:none'&gt;98&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;98&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;3.7&lt;/td&gt;\r\n  &lt;td class=xl675932 style='border-top:none;border-left:none'&gt;98&lt;/td&gt;\r\n &lt;/tr&gt;\r\n &lt;tr height=19 style='height:14.4pt'&gt;\r\n  &lt;td height=19 class=xl645932 style='height:14.4pt;border- \r\n  top:none'&gt;8&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;Ferris&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;92&lt;/td&gt;\r\n  &lt;td class=xl675932 style='border-top:none;border-left:none'&gt;56&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;51&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;3&lt;/td&gt;\r\n  &lt;td class=xl675932 style='border-top:none;border-left:none'&gt;66&lt;/td&gt;\r\n &lt;/tr&gt;\r\n &lt;tr height=19 style='height:14.4pt'&gt;\r\n  &lt;td height=19 class=xl645932 style='height:14.4pt;border- \r\n  top:none'&gt;10&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;Mike&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;45&lt;/td&gt;\r\n  &lt;td class=xl675932 style='border-top:none;border-left:none'&gt;87&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;87&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;2.6&lt;/td&gt;\r\n  &lt;td class=xl675932 style='border-top:none;border-left:none'&gt;87&lt;/td&gt;\r\n &lt;/tr&gt;\r\n &lt;tr height=19 style='height:14.4pt'&gt;\r\n  &lt;td height=19 class=xl645932 style='height:14.4pt;border- \r\n  top:none'&gt;15&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;Lauren&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;98&lt;/td&gt;\r\n  &lt;td class=xl675932 style='border-top:none;border-left:none'&gt;49&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;89&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;4&lt;/td&gt;\r\n  &lt;td class=xl675932 style='border-top:none;border-left:none'&gt;92&lt;/td&gt;\r\n &lt;/tr&gt;\r\n &lt;tr height=19 style='height:14.4pt'&gt;\r\n  &lt;td height=19 class=xl645932 style='height:14.4pt;border- \r\n top:none'&gt;62&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;Larry&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;75&lt;/td&gt;\r\n  &lt;td class=xl675932 style='border-top:none;border-left:none'&gt;85&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;65&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;3.9&lt;/td&gt;\r\n  &lt;td class=xl675932 style='border-top:none;border-left:none'&gt;75&lt;/td&gt;\r\n &lt;/tr&gt;\r\n &lt;tr height=19 style='height:14.4pt'&gt;\r\n  &lt;td height=19 class=xl645932 style='height:14.4pt;border- \r\n top:none'&gt;68&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;Tony&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;48&lt;/td&gt;\r\n  &lt;td class=xl675932 style='border-top:none;border-left:none'&gt;87&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;89&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;3.5&lt;/td&gt;\r\n  &lt;td class=xl675932 style='border-top:none;border-left:none'&gt;96&lt;/td&gt;\r\n &lt;/tr&gt;\r\n &lt;tr height=19 style='height:14.4pt'&gt;\r\n  &lt;td height=19 class=xl645932 style='height:14.4pt;border- \r\n top:none'&gt;85&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;Kevin&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;68&lt;/td&gt;\r\n  &lt;td class=xl675932 style='border-top:none;border-left:none'&gt;83&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;79&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;3.2&lt;/td&gt;\r\n  &lt;td class=xl675932 style='border-top:none;border-left:none'&gt;80&lt;/td&gt;\r\n &lt;/tr&gt;\r\n &lt;tr height=19 style='height:14.4pt'&gt;\r\n  &lt;td height=19 class=xl645932 style='height:14.4pt;border- \r\n  top:none'&gt;98&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;Sam&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;59&lt;/td&gt;\r\n  &lt;td class=xl675932 style='border-top:none;border-left:none'&gt;62&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;98&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;3.6&lt;/td&gt;\r\n  &lt;td class=xl675932 style='border-top:none;border-left:none'&gt;87&lt;/td&gt;\r\n &lt;/tr&gt;\r\n &lt;tr height=19 style='height:14.4pt'&gt;\r\n  &lt;td height=19 class=xl645932 style='height:14.4pt;border- \r\n top:none'&gt;101&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;Zibin&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;63&lt;/td&gt;\r\n  &lt;td class=xl675932 style='border-top:none;border-left:none'&gt;68&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;95&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;3.5&lt;/td&gt;\r\n  &lt;td class=xl675932 style='border-top:none;border-left:none'&gt;88&lt;/td&gt;\r\n &lt;/tr&gt;\r\n &lt;tr height=19 style='height:14.4pt'&gt;\r\n  &lt;td height=19 class=xl645932 style='height:14.4pt;border- \r\n  top:none'&gt;105&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;Ran&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;49&lt;/td&gt;\r\n  &lt;td class=xl675932 style='border-top:none;border-left:none'&gt;59&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;94&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;3.8&lt;/td&gt;\r\n  &lt;td class=xl675932 style='border-top:none;border-left:none'&gt;85&lt;/td&gt;\r\n &lt;/tr&gt;\r\n &lt;tr height=19 style='height:14.4pt'&gt;\r\n  &lt;td height=19 class=xl645932 style='height:14.4pt;border- \r\n  top:none'&gt;108&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;Donia&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;87&lt;/td&gt;\r\n  &lt;td class=xl675932 style='border-top:none;border-left:none'&gt;12&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;92&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;2.9&lt;/td&gt;\r\n  &lt;td class=xl675932 style='border-top:none;border-left:none'&gt;104&lt;/td&gt;\r\n &lt;/tr&gt;\r\n &lt;tr height=19 style='height:14.4pt'&gt;\r\n  &lt;td height=19 class=xl645932 style='height:14.4pt;border- \r\n  top:none'&gt;109&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;Kate&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;85&lt;/td&gt;\r\n  &lt;td class=xl675932 style='border-top:none;border-left:none'&gt;57&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;49&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;2.6&lt;/td&gt;\r\n  &lt;td class=xl675932 style='border-top:none;border-left:none'&gt;64&lt;/td&gt;\r\n &lt;/tr&gt;\r\n &lt;tr height=19 style='height:14.4pt'&gt;\r\n  &lt;td height=19 class=xl645932 style='height:14.4pt;border- \r\n  top:none'&gt;110&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;Sahar&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;45&lt;/td&gt;\r\n  &lt;td class=xl675932 style='border-top:none;border-left:none'&gt;59&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;87&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;2.7&lt;/td&gt;\r\n  &lt;td class=xl675932 style='border-top:none;border-left:none'&gt;81&lt;/td&gt;\r\n &lt;/tr&gt;\r\n &lt;tr height=19 style='height:14.4pt'&gt;\r\n  &lt;td height=19 class=xl645932 style='height:14.4pt;border- \r\n  top:none'&gt;115&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;Milos&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;21&lt;/td&gt;\r\n  &lt;td class=xl675932 style='border-top:none;border-left:none'&gt;49&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;&amp;nbsp;&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;3.8&lt;/td&gt;\r\n  &lt;td class=xl675932 style='border-top:none;border-left:none'&gt;35&lt;/td&gt;\r\n &lt;/tr&gt;\r\n &lt;tr height=19 style='height:14.4pt'&gt;\r\n  &lt;td height=19 class=xl645932 style='height:14.4pt;border- \r\n  top:none'&gt;125&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;Brian&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;49&lt;/td&gt;\r\n  &lt;td class=xl675932 style='border-top:none;border-left:none'&gt;98&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;&amp;nbsp;&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;3.9&lt;/td&gt;\r\n  &lt;td class=xl675932 style='border-top:none;border-left:none'&gt;74&lt;/td&gt;\r\n &lt;/tr&gt;\r\n &lt;tr height=19 style='height:14.4pt'&gt;\r\n  &lt;td height=19 class=xl645932 style='height:14.4pt;border- \r\n top:none'&gt;130&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;Zane&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;34&lt;/td&gt;\r\n  &lt;td class=xl675932 style='border-top:none;border-left:none'&gt;38&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;&amp;nbsp;&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;3.2&lt;/td&gt;\r\n  &lt;td class=xl675932 style='border-top:none;border-left:none'&gt;36&lt;/td&gt;\r\n &lt;/tr&gt;\r\n\r\n &lt;tr height=19 style='height:14.4pt'&gt;\r\n  &lt;td height=19 class=xl645932 style='height:14.4pt;border- \r\n  top:none'&gt;145&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;Istiak&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;91&lt;/td&gt;\r\n  &lt;td class=xl675932 style='border-top:none;border-left:none'&gt;87&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;&amp;nbsp;&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;3.1&lt;/td&gt;\r\n  &lt;td class=xl675932 style='border-top:none;border-left:none'&gt;89&lt;/td&gt;\r\n\r\n &lt;/tr&gt;\r\n &lt;tr height=19 style='height:14.4pt'&gt;\r\n  &lt;td height=19 class=xl645932 style='height:14.4pt;border- \r\n  top:none'&gt;150&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;Kumari&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;100&lt;/td&gt;\r\n  &lt;td class=xl675932 style='border-top:none;border-left:none'&gt;78&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;&amp;nbsp;&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;3&lt;/td&gt;\r\n  &lt;td class=xl675932 style='border-top:none;border-left:none'&gt;89&lt;/td&gt;\r\n &lt;/tr&gt;\r\n &lt;tr height=19 style='height:14.4pt'&gt;\r\n  &lt;td height=19 class=xl645932 style='height:14.4pt;border- \r\n  top:none'&gt;186&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;John&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;19&lt;/td&gt;\r\n  &lt;td class=xl675932 style='border-top:none;border-left:none'&gt;76&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;&amp;nbsp;&lt;/td&gt;\r\n  &lt;td class=xl645932 style='border-top:none;border-left:none'&gt;2.9&lt;/td&gt;\r\n  &lt;td class=xl675932 style='border-top:none;border-left:none'&gt;48&lt;/td&gt;\r\n &lt;/tr&gt;\r\n &lt;![if supportMisalignedColumns]&gt;\r\n &lt;tr height=0 style='display:none'&gt;\r\n  &lt;td width=74 style='width:56pt'&gt;&lt;/td&gt;\r\n  &lt;td width=100 style='width:75pt'&gt;&lt;/td&gt;\r\n  &lt;td width=76 style='width:57pt'&gt;&lt;/td&gt;\r\n  &lt;td width=77 style='width:58pt'&gt;&lt;/td&gt;\r\n  &lt;td width=152 style='width:114pt'&gt;&lt;/td&gt;\r\n  &lt;td width=66 style='width:49pt'&gt;&lt;/td&gt;\r\n  &lt;td width=66 style='width:49pt'&gt;&lt;/td&gt;\r\n &lt;/tr&gt;\r\n &lt;![endif]&gt;\r\n&lt;/table&gt;\r\n\r\n&lt;/div&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<pre><code>Option Explicit\n\n'***** MyType as an array\nPublic Type Student\nStudentID As Integer ' Student ID\nFinalScore As Integer ' Studnts final score\nComprehensiveTaker As Integer ' Comprehensivetaker\nStudentGPA As Double ' Student's GPA\nEnd Type\n\nPublic CEEStudent(20) As Student\n\nPublic Sub fillCEEStudent()\n\n    Dim j As Long, i As Long, CEEStudent(20) As Student\n            j = 0\n            i = 3\n\n          If j &lt; 21 And i &lt; 23 Then\n            j = j\n            i = i\n\n            CEEStudent(j).StudentID = Sheets(\"Question1\").Cells(i, 3).Value\n            CEEStudent(j).ComprehensiveTaker = IIf(Sheets(\"Question1\").Cells(i, 7).Value &lt;&gt; \"\", 1, 0)\n            CEEStudent(j).StudentGPA = Sheets(\"Question1\").Cells(i, 8).Value\n            CEEStudent(j).FinalScore = Sheets(\"Question1\").Cells(i, 9).Value\n          Else:\n            j = 0\n            i = 3\n\n         End If\n\n    Dim formNum As Integer, formScore As Integer, formGPA As Double, formInput As String\n\n    With VBAProject.UserForm1\n\n        formInput = 5 'VBAProject.UserForm1.TextBox1.Value\n\n        If IsNumeric(formInput) Then\n            formNum = formInput\n        Else\n            formNum = 0\n        End If\n\n        If formInput &lt;&gt; \"\" And formNum &gt; 0 Then\n                If CEEStudent(j).StudentID &gt; formNum Or CEEStudent(j).StudentID &lt; formNum Then\n                    VBAProject.UserForm1.TextBox2.Text = CStr(\" \")\n                    VBAProject.UserForm1.BackColor = vbRed\n                    VBAProject.UserForm1.StudentID.BackColor = vbRed\n                    VBAProject.UserForm1.TestScore.BackColor = vbRed\n                    VBAProject.UserForm1.GPA.BackColor = vbRed\n                    VBAProject.UserForm1.TextBox2.BackColor = vbRed\n                    VBAProject.UserForm1.TextBox3.BackColor = vbRed\n                Else:\n                    VBAProject.UserForm1.TextBox2.Text = CStr(CEEStudent(j).FinalScore)\n                    VBAProject.UserForm1.TextBox3.Text = CStr(CEEStudent(j).StudentGPA)\n                End If\n        Else:\n            formScore = 0\n        End If\n\n        VBAProject.UserForm1.TextBox2.Text = CStr(formScore)\n        VBAProject.UserForm1.TextBox3.Text = CStr(formGPA)\n\n        If VBAProject.UserForm1.TextBox2.Text &gt;= 95 Then\n           VBAProject.UserForm1.BackColor = vbGreen\n           VBAProject.UserForm1.TextBox2.BackColor = vbGreen\n           VBAProject.UserForm1.TextBox3.BackColor = vbGreen\n\n\n        If VBAProject.UserForm1.TextBox2.Text &lt; 95 And VBAProject.UserForm1.TextBox3.Text &gt; 3.5 Then\n           VBAProject.UserForm1.BackColor = vbBlue\n           VBAProject.UserForm1.TextBox2.BackColor = Gray\n           VBAProject.UserForm1.TextBox3.BackColor = Gray\n        Else:\n           VBAProject.UserForm1.BackColor = Gray\n           VBAProject.UserForm1.TextBox2.BackColor = Gray\n           VBAProject.UserForm1.TextBox3.BackColor = Gray\n\n        End If\n    End If\n  End With\nEnd Sub\n</code></pre>\n\n<p>****EDIT****<br>\nI added the HTML for the actual table in the snippet above... The table is in the worksheet named Question1 and starts with C2 being \"Student ID\" and then C3 being the first row of students.</p>\n\n<p>The above code compiles and runs but is not returning the Values. I added a button to open userForm1 on Sheet(\"Question2\"), click it and the form opens. enter the number 5 for student ID (Which matches my first row student info) and it returns 0 for score and GPA when it should return the actual figures.</p>\n\n<p>So, we are getting somewhere....</p>\n\n<p>Array :</p>\n\n<p>CEEStudent  {</p>\n\n<pre><code>(0)StudentID : 5\n   FinalScore : 96\n   ComprehensiveTaker : 1\n   StudentGPA : 3.6\n\n(1)StudentID : 7\n   FinalScore : 88\n   ComprehensiveTaker : 1\n   StudentGPA : 3.8\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1547071342, "post_id": 54118955, "comment_id": 95070640, "body": "Basically, are you just trying to add the formula <code>=IF(A1&lt;&gt;&quot;&quot;,&quot;Business Interruption&quot;,&quot;&quot;)</code> in <code>C1</code> and drag down?"}, {"owner": {"reputation": 29, "user_id": 10328624, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ix0Xp0iUgmM/AAAAAAAAAAI/AAAAAAAAAQk/vSXhsIEYzRs/photo.jpg?sz=128", "display_name": "Roaku Sezoire", "link": "https://stackoverflow.com/users/10328624/roaku-sezoire"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1547071802, "post_id": 54118955, "comment_id": 95070814, "body": "Hi Bruce, no I wish for each result in say sub Calc_Parish, for the Column C (resultant rows only) to populate with Business Interruption. Not to touch any other rows up above. I have data calculating above, thus this formula needs to only apply to the results in sub Calc_Parish."}], "owner": {"reputation": 29, "user_id": 10328624, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ix0Xp0iUgmM/AAAAAAAAAAI/AAAAAAAAAQk/vSXhsIEYzRs/photo.jpg?sz=128", "display_name": "Roaku Sezoire", "link": "https://stackoverflow.com/users/10328624/roaku-sezoire"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1547585420, "creation_date": 1547070986, "last_edit_date": 1547585420, "question_id": 54118955, "link": "https://stackoverflow.com/questions/54118955/how-to-code-for-each-result-in-column-to-paste-text", "title": "How to code for each result in column to paste text", "body": "<p><strong>Goal:</strong> I have a set of results appearing at the next empty row for columns A, B and D (below screenshot). For Column C, I would like to build a function that would, for each result in column say A (from my code), Column C would simply paste \"Business Interruption\". </p>\n\n<p><a href=\"https://i.stack.imgur.com/dKGKh.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dKGKh.jpg\" alt=\"enter image description here\"></a></p>\n\n<p><strong>My Current code looks as below</strong>: </p>\n\n<pre><code>Sub Calc_Parish()\n\n'Calculates the Parish for AICOW\n\nDim RPDataTbl As ListObject\n    Dim parishCol As ListColumn, AICOWcol As ListColumn\n    Dim copyRng As Range\n\n    Set RPDataTbl = Sheets(\"Risk Partner Data\").ListObjects(\"RPdata\")\n    With RPDataTbl\n        Set parishCol = .ListColumns(\"Parish &amp; Code\")\n        Set AICOWcol = .ListColumns(\"AICOW\")\n\n        .Range.AutoFilter Field:=AICOWcol.Index, Criteria1:=\"TRUE\"\n    End With\n\n    On Error Resume Next\n    Set copyRng = parishCol.DataBodyRange.SpecialCells(xlCellTypeVisible)\n    On Error GoTo 0\n\n    If Not copyRng Is Nothing Then\n        copyRng.Copy\n\n        With Sheets(\"Calc Data\")\n            .Cells(.Rows.Count, \"A\").End(xlUp).Offset(1).PasteSpecial xlPasteValues\n        End With\n\n        Application.CutCopyMode = False\n    End If\n\n    RPDataTbl.Range.AutoFilter Field:=AICOWcol.Index\n\nEnd Sub\n\nSub Calc_Buildno()\n\n' Calculates the Build # for AICOW\n\nDim RPDataTbl As ListObject\n    Dim BuildnoCol As ListColumn, AICOWcol As ListColumn\n    Dim copyRng As Range\n\n    Set RPDataTbl = Sheets(\"Risk Partner Data\").ListObjects(\"RPdata\")\n    With RPDataTbl\n        Set BuildnoCol = .ListColumns(\"Building ID 1\")\n        Set AICOWcol = .ListColumns(\"AICOW\")\n\n        .Range.AutoFilter Field:=AICOWcol.Index, Criteria1:=\"TRUE\"\n    End With\n\n    On Error Resume Next\n    Set copyRng = BuildnoCol.DataBodyRange.SpecialCells(xlCellTypeVisible)\n    On Error GoTo 0\n\n    If Not copyRng Is Nothing Then\n        copyRng.Copy\n\n        With Sheets(\"Calc Data\")\n            .Cells(.Rows.Count, \"B\").End(xlUp).Offset(1).PasteSpecial xlPasteValues\n        End With\n\n        Application.CutCopyMode = False\n    End If\n\n    RPDataTbl.Range.AutoFilter Field:=AICOWcol.Index\n\n' Need to add here the Insured Asset (Column C) as Business Interruption\n\nEnd Sub\n\nSub Calc_Cresta()\n\n' Calculates Cresta for AICOW\n\nDim RPDataTbl As ListObject\n    Dim CrestaCol As ListColumn, AICOW As ListColumn\n    Dim copyRng As Range\n\n    Set RPDataTbl = Sheets(\"Risk Partner Data\").ListObjects(\"RPdata\")\n    With RPDataTbl\n        Set CrestaCol = .ListColumns(\"Cresta\")\n        Set AICOWcol = .ListColumns(\"AICOW\")\n\n        .Range.AutoFilter Field:=AICOWcol.Index, Criteria1:=\"TRUE\"\n    End With\n\n    On Error Resume Next\n    Set copyRng = CrestaCol.DataBodyRange.SpecialCells(xlCellTypeVisible)\n    On Error GoTo 0\n\n    If Not copyRng Is Nothing Then\n        copyRng.Copy\n\n        With Sheets(\"Calc Data\")\n            .Cells(.Rows.Count, \"D\").End(xlUp).Offset(1).PasteSpecial xlPasteValues\n        End With\n\n        Application.CutCopyMode = False\n    End If\n\n    RPDataTbl.Range.AutoFilter Field:=AICOWcol.Index\n\nEnd Sub\n</code></pre>\n\n<p>I understand my code is bulky, but I dont know how to simplify it, so leaving it as is. Could someone please assist? Thank you. </p>\n"}, {"tags": ["html", "excel", "vba", "forms"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 2229959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0743b3038f440f98d129b7f6ecfbff2?s=128&d=identicon&r=PG", "display_name": "Bret", "link": "https://stackoverflow.com/users/2229959/bret"}, "edited": false, "score": 0, "creation_date": 1547116429, "post_id": 54119344, "comment_id": 95084725, "body": "That was an excellent explanation but also very helpful reply.I didn&#39;t know that a declaration type had to be that specific.and could make such a difference. The best, it does exactly what I was looking for: revealing the hidden field. I also started reading  developer.mozilla.org: Again, thanks for your explanation mister K. Davis. I learned something today. I cannot find an option to mark your answer as  the solution."}], "tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": true, "score": 3, "last_activity_date": 1547072957, "last_edit_date": 1592644375, "creation_date": 1547072957, "answer_id": 54119344, "question_id": 54118929, "link": "https://stackoverflow.com/questions/54118929/vba-make-hidden-field-visible-after-checking-radio-button/54119344#54119344", "title": "VBA: Make hidden field visible after checking radio button", "body": "<p>You have a couple issues with your code. The first one is that you are using the wrong type for your radio button element.</p>\n<p>While <code>htmlOption</code> is <em>technically</em> a <code>MSHTML.IHTMLElement</code>, it more specifically should be of type: <code>MSHTML.HTMLInputElement</code>. So change your declaration to:</p>\n<pre><code>Dim htmlOption As MSHTML.HTMLInputElement\n</code></pre>\n<p>For your actual issue, you should just use <code>.Click</code>. Taking a look at <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/click\" rel=\"nofollow noreferrer\">developer.mozilla.org</a>:</p>\n<blockquote>\n<p><em>The <code>HTMLElement.click()</code> method <strong>simulates a mouse click</strong> on an element.</em></p>\n<p><em>When <code>click()</code> is used with supported elements (such as an <code>&lt;input&gt;</code>), it <strong>fires the element's click event</strong>. This event then bubbles up to elements higher in the document tree (or event chain) and fires their click events.</em> <sub><em>(emphasis added)</em></sub></p>\n</blockquote>\n<p>So, you wouldn't need to use <code>.Checked = True</code>, because upon clicking the input element, you will not only solve your problem with the hidden area being revealed, you are also simultaneously changing the value to <code>True</code>.</p>\n<p>So you would just use this:</p>\n<pre><code>'Find the radio button . . .\nSet htmlOption = htmlDoc.getElementById(&quot;V1-1_True&quot;)\n'. . . and check it.\nhtmlOption.Click\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 2229959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0743b3038f440f98d129b7f6ecfbff2?s=128&d=identicon&r=PG", "display_name": "Bret", "link": "https://stackoverflow.com/users/2229959/bret"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "accepted_answer_id": 54119344, "answer_count": 1, "score": 3, "last_activity_date": 1547072957, "creation_date": 1547070760, "last_edit_date": 1547071548, "question_id": 54118929, "link": "https://stackoverflow.com/questions/54118929/vba-make-hidden-field-visible-after-checking-radio-button", "title": "VBA: Make hidden field visible after checking radio button", "body": "<p>I'm trying to fill out a form using VBA (just to get more skilled in programming with VBA). I noticed that the web form is not updating a hidden field when a radio button is checked via VBA.</p>\n\n<p>To be more specific, the hidden field doesn't become visible after checking the radio button.</p>\n\n<p>In my research to why that is I read that: \"Events won't (usually) fire when you change the data programmatically\". When this assumption is true, what's the difference between filling out a form manually or programmatically? But when this assumption is wrong, what adjustments do I need to make in my code in order to make hidden fields visible after clicking that radio button?</p>\n\n<p>The website I'm working with is from the Dutch Tax authorities: \n<a href=\"https://www.belastingdienst.nl/wps/wcm/connect/nl/auto-en-vervoer/content/hulpmiddel-motorrijtuigenbelasting-berekenen\" rel=\"nofollow noreferrer\">https://www.belastingdienst.nl/wps/wcm/connect/nl/auto-en-vervoer/content/hulpmiddel-motorrijtuigenbelasting-berekenen</a></p>\n\n<p>This is my code.</p>\n\n<pre><code>Sub Show_Hidden_Field()\n\n    'Declaration section\n    Dim htmlDoc As New MSHTML.HTMLDocument\n    Dim objShell, objShellWindows, objShellWindow As Object\n    Dim htmlOption As MSHTML.IHTMLElement\n\n    'Wait an extra 3 seconds so you can switch to the IE window\n    'and see what's going on\n    Application.Wait Now + TimeValue(\"0:00:03\")\n\n    'Find the correct Internet Explorer window\n    Set objShell = CreateObject(\"Shell.Application\")\n    Set objShellWindows = objShell.Windows\n\n    For Each objShellWindow In objShellWindows\n        If objShellWindow.Name = \"Internet Explorer\" Then\n            'Find this window\n            If objShellWindow.LocationURL = \"https://www.belastingdienst.nl/wps/wcm/connect/nl/auto-en-vervoer/content/hulpmiddel-motorrijtuigenbelasting-berekenen\" Then\n                'This the correct page. Get the content of page\n                Set htmlDoc = objShellWindow.document\n                Exit For\n            End If\n        End If\n    Next objShellWindow\n\n    'Find the radio button . . .\n    Set htmlOption = htmlDoc.getElementById(\"V1-1_True\")\n    '. . . and check it.\n    htmlOption.Checked = True\n\n    '**********************************************************************\n    'I've also tried these options without succes.\n    'htmlOption.Click\n    'htmlOption.FireEvent (\"onchange\")\n\n    'Or set the focus to another field\n    '**********************************************************************\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "answers": [{"comments": [{"owner": {"reputation": 447, "user_id": 2482985, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f6fcec1fa6a36d3bbe4dc6ff129fe1ef?s=128&d=identicon&r=PG", "display_name": "Geoffrey", "link": "https://stackoverflow.com/users/2482985/geoffrey"}, "edited": false, "score": 0, "creation_date": 1547150760, "post_id": 54124352, "comment_id": 95103823, "body": "This was a huge help, thank you! I went with your first response."}], "tags": [], "owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "is_accepted": true, "score": 1, "last_activity_date": 1547108045, "creation_date": 1547108045, "answer_id": 54124352, "question_id": 54118864, "link": "https://stackoverflow.com/questions/54118864/getting-data-out-of-an-array-and-writing-it-to-a-defined-cell/54124352#54124352", "title": "Getting data out of an array and writing it to a defined cell", "body": "<p>The question and the Data layout of text file is not clear. from What I understood from the requirement of \"match those results to a Defined Cell Name\", I think storing each lines is to an array is not required at all. However in your code </p>\n\n<ol>\n<li>I is not incremented</li>\n<li>typo of arrBP instead of arrAP is found</li>\n</ol>\n\n<p>Correcting the above may give you an array of each lines of the APPrices.txt for further processing.</p>\n\n<p>However if Data layout of text file and your requirement as below \n<a href=\"https://i.stack.imgur.com/ybYnh.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ybYnh.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>then may try simple code like without array</p>\n\n<pre><code> Option Base 0\n Public Sub ImportPrices_Click()\n''Declare Variables\nDim PathName As String\nDim FileName As String\n\nSet fs = CreateObject(\"Scripting.FileSystemObject\")\nPathName = \"C:\\Users\\user\\Desktop\"\nFileName = PathName &amp; \"\\\" &amp; \"APPrices.txt\"\nSet ap = fs.OpenTextFile(FileName, 1)\n\nDim Cols As Variant, Ln As String, Price As String, LocPin As String\n    Do While Not ap.AtEndOfStream\n    Ln = ap.ReadLine\n    Cols = Split(Ln, Chr(9))   ' each line is splited on tab ie Chr(9)\n    Price = Cols(7)\n    LocPin = Cols(3) &amp; Cols(4)\n    Debug.Print LocPin, Price\n    'you may match the locPin here and put the price the cells\n    Loop\nap.Close\n\nEnd Sub\n</code></pre>\n\n<p>Or else another easy method (Modify to requirement)</p>\n\n<pre><code>Sub test2()\nDim wb As Workbook\nDim Rng As Range, C As Range, LastRow As Long\nWorkbooks.OpenText FileName:=\"C:\\Users\\user\\Desktop\\APPrices.txt\", Origin:=437, _\n        StartRow:=1, DataType:=xlDelimited, TextQualifier:=xlDoubleQuote, _\n        ConsecutiveDelimiter:=False, Tab:=True, Semicolon:=False, Comma:=False _\n        , Space:=False, Other:=False, FieldInfo:=Array(Array(1, 1), Array(2, 1), _\n        Array(3, 1), Array(4, 1), Array(5, 1), Array(6, 1), Array(7, 1), Array(8, 1)), _\n        TrailingMinusNumbers:=True\nSet wb = ActiveWorkbook\n\n    For Each Rng In wb.ActiveSheet.UsedRange.Columns(8).Cells\n    Rng.Offset(, 1).FormulaR1C1 = \"=RC[-5]&amp;RC[-4]\"      'Create column  9 With concanted LOc &amp; Pin\n    Next\n\n    'Search Column 9 LOcPIN\n    For Each Rng In ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A2:A25\").Cells\n    Set C = wb.ActiveSheet.Columns(9).Find(Rng.Value) ', LookIn:=xlValues) ', Lookat:=xlWhole)\n        If Not C Is Nothing Then\n        Rng.Offset(, 1).Value = C.Offset(, -1).Value                        ' Price\n        End If\n    Next Rng\nwb.Close False\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 447, "user_id": 2482985, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f6fcec1fa6a36d3bbe4dc6ff129fe1ef?s=128&d=identicon&r=PG", "display_name": "Geoffrey", "link": "https://stackoverflow.com/users/2482985/geoffrey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 54124352, "answer_count": 1, "score": 1, "last_activity_date": 1547108045, "creation_date": 1547070503, "last_edit_date": 1547107790, "question_id": 54118864, "link": "https://stackoverflow.com/questions/54118864/getting-data-out-of-an-array-and-writing-it-to-a-defined-cell", "title": "Getting data out of an array and writing it to a defined cell", "body": "<p>I have a loop running, and I am trying to combine the results in the array, match those results to a Defined Cell Name, and write another result within the same array to the same cell as the defined name. It is pull data from a tab delimited text file.</p>\n\n<p>The array comes out like this</p>\n\n<p><code>\"01/08/2019 18:00:00   BRANDED                 LOC     PN      THE PRODUCT NAME        +3.46       ThePrice\"</code></p>\n\n<p>I need to concant LOC and PN in to the follow format \"LOC_PN\", find the Defined Cell with the \"LOC_PN\" name, and then write ThePrice to that cell on the ActiveSheet.</p>\n\n<pre><code>Public Sub ImportPrices_Click()\n    ''Declare Variables\n    Dim PathName As String\n    Dim FileName As String        \n\n    Set fs = CreateObject(\"Scripting.FileSystemObject\")\n\n    PathName = \"??????\"        \n\n    ''AP Prices\n    FileName = PathName &amp; \"\\\" &amp; \"APPrices.txt\"\n    Set AP = fs.OpenTextFile(FileName, 1)\n\n    Dim arrAP()\n    i = 0\n\n    Do While Not AP.AtEndOfStream\n        ReDim Preserve arrAP(i)\n        arrBP(i) = AP.ReadLine\n    Loop      \n\n    ap.Close\nEnd Sub\n</code></pre>\n\n<p>I appreciate your help ahead of time. I have been banging my head against my desk trying to figure out the writing part.</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "edited": false, "score": 0, "creation_date": 1547109830, "post_id": 54118727, "comment_id": 95080953, "body": "1. Try compact &amp; repair,  2. On Standard menu bar - click on Debug &gt; Compile Database."}, {"owner": {"reputation": 77, "user_id": 6471192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d47124594307f7ce56623e4367407cac?s=128&d=identicon&r=PG&f=1", "display_name": "John C", "link": "https://stackoverflow.com/users/6471192/john-c"}, "reply_to_user": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "edited": false, "score": 0, "creation_date": 1547186297, "post_id": 54118727, "comment_id": 95113333, "body": "Already compiled..."}, {"owner": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "edited": false, "score": 0, "creation_date": 1547186786, "post_id": 54118727, "comment_id": 95113495, "body": "That&#39;s strange. Can you add the screenshot of the error."}], "owner": {"reputation": 77, "user_id": 6471192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d47124594307f7ce56623e4367407cac?s=128&d=identicon&r=PG&f=1", "display_name": "John C", "link": "https://stackoverflow.com/users/6471192/john-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594619584, "creation_date": 1547069754, "last_edit_date": 1594619584, "question_id": 54118727, "link": "https://stackoverflow.com/questions/54118727/invalid-reference-when-checking-recordset-in-subform", "title": "Invalid Reference when checking recordset in subform", "body": "<p>I need to check to see if a subform has any records but receiving an Invalid Reference error at this line:</p>\n\n<p>If Me.frmReceiptsSubform_Cust.Form.Recordset.RecordCount = 0 Then</p>\n\n<p>It worked initially but now it always breaks on this line. Even tried rebooting my PC. Any assistance would be appreciated.</p>\n"}, {"tags": ["excel", "vba", "office365"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 2, "creation_date": 1547069287, "post_id": 54118570, "comment_id": 95069755, "body": "You want to <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">avoid using select</a> in your code. And you want to use <code>.FullSeriesCollection(i).Delete</code>"}, {"owner": {"reputation": 111, "user_id": 10339255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe3dcbed9bb2679366351ac32bdbf739?s=128&d=identicon&r=PG&f=1", "display_name": "AnalysisNerd", "link": "https://stackoverflow.com/users/10339255/analysisnerd"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1547069558, "post_id": 54118570, "comment_id": 95069863, "body": "Thanks @cybernetice.nomad but I amended it to &#39;If ActiveChart.FullSeriesCollection(i).HasDataLabels Then ActiveChart.FullSeriesCollection(i).Delete End If&#39;                                         (and it still doesn&#39;t work)"}, {"owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "edited": false, "score": 1, "creation_date": 1547069986, "post_id": 54118570, "comment_id": 95070039, "body": "If you step thru the code, does it enter the <code>If</code> block?"}, {"owner": {"reputation": 111, "user_id": 10339255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe3dcbed9bb2679366351ac32bdbf739?s=128&d=identicon&r=PG&f=1", "display_name": "AnalysisNerd", "link": "https://stackoverflow.com/users/10339255/analysisnerd"}, "reply_to_user": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "edited": false, "score": 0, "creation_date": 1547070168, "post_id": 54118570, "comment_id": 95070121, "body": "@Kubie, yes it appears to ."}, {"owner": {"reputation": 111, "user_id": 10339255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe3dcbed9bb2679366351ac32bdbf739?s=128&d=identicon&r=PG&f=1", "display_name": "AnalysisNerd", "link": "https://stackoverflow.com/users/10339255/analysisnerd"}, "reply_to_user": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "edited": false, "score": 0, "creation_date": 1547070307, "post_id": 54118570, "comment_id": 95070188, "body": "Yes  @Kubie, it does. (used a message box)."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 4, "creation_date": 1547070456, "post_id": 54118570, "comment_id": 95070258, "body": "Why not just do the whole chart: <code>activechart.applydatalabels xlDataLabelsShowNone</code>"}, {"owner": {"reputation": 111, "user_id": 10339255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe3dcbed9bb2679366351ac32bdbf739?s=128&d=identicon&r=PG&f=1", "display_name": "AnalysisNerd", "link": "https://stackoverflow.com/users/10339255/analysisnerd"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1547070568, "post_id": 54118570, "comment_id": 95070300, "body": "Thanks @Rory. It worked!"}, {"owner": {"reputation": 111, "user_id": 10339255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe3dcbed9bb2679366351ac32bdbf739?s=128&d=identicon&r=PG&f=1", "display_name": "AnalysisNerd", "link": "https://stackoverflow.com/users/10339255/analysisnerd"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1547070630, "post_id": 54118570, "comment_id": 95070325, "body": "@Rory would you like to post it as a solution or should I go ahead and do it? Thanks a lot for helping me"}, {"owner": {"reputation": 111, "user_id": 10339255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe3dcbed9bb2679366351ac32bdbf739?s=128&d=identicon&r=PG&f=1", "display_name": "AnalysisNerd", "link": "https://stackoverflow.com/users/10339255/analysisnerd"}, "reply_to_user": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "edited": false, "score": 0, "creation_date": 1547070652, "post_id": 54118570, "comment_id": 95070330, "body": "Also thanks @Kubie"}], "answers": [{"tags": [], "owner": {"reputation": 111, "user_id": 10339255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe3dcbed9bb2679366351ac32bdbf739?s=128&d=identicon&r=PG&f=1", "display_name": "AnalysisNerd", "link": "https://stackoverflow.com/users/10339255/analysisnerd"}, "is_accepted": true, "score": 1, "last_activity_date": 1547071054, "creation_date": 1547071054, "answer_id": 54118972, "question_id": 54118570, "link": "https://stackoverflow.com/questions/54118570/unable-to-delete-excel-chart-labels/54118972#54118972", "title": "Unable to delete Excel Chart Labels", "body": "<p>Thanks to @Rory's comment. Replace the if statement with the line of code below the comment. </p>\n\n<pre><code> Sub DeleteDataLabels()\n\n Sheets(\"Sheet1\").Select\n Call UnprotectSheet\n ActiveSheet.ChartObjects(\"Chart 2\").Activate\n\n\n SeriesCount = ActiveChart.SeriesCollection.Count\n MsgBox SeriesCount\n\n 'Replace the if statement with this line of code\n ActiveChart.ApplyDataLabels xlDataLabelsShowNone\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 10339255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe3dcbed9bb2679366351ac32bdbf739?s=128&d=identicon&r=PG&f=1", "display_name": "AnalysisNerd", "link": "https://stackoverflow.com/users/10339255/analysisnerd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 2, "accepted_answer_id": 54118972, "answer_count": 1, "score": 0, "last_activity_date": 1547071054, "creation_date": 1547068953, "question_id": 54118570, "link": "https://stackoverflow.com/questions/54118570/unable-to-delete-excel-chart-labels", "title": "Unable to delete Excel Chart Labels", "body": "<p>I am trying to delete all data labels in an Excel chart for each of the series but somehow my code doesn't delete any of the data labels on the chart. Please let me know if there is something lacking in my code below.  I am currently using Microsoft Office 365 and the file is an xlsb . </p>\n\n<p>Thanks in advance and really appreciate your help. </p>\n\n<pre><code>Sub DeleteDataLabels()\nSheets(\"Sheet1\").Select\nCall UnprotectSheet\nActiveSheet.ChartObjects(\"Chart 2\").Activate\n\n\nSeriesCount = ActiveChart.SeriesCollection.Count\nMsgBox SeriesCount\n\n' To delete the code\nFor i = 1 To SeriesCount\nActiveChart.SeriesCollection(i).Select\nActiveChart.ChartArea.Select\nIf ActiveChart.SeriesCollection(i).HasDataLabels Then\n            ActiveChart.SeriesCollection(i).DataLabels.Select\n            Selection.Delete\nEnd If\nNext i\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "http", "header"], "comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1547069702, "post_id": 54118535, "comment_id": 95069932, "body": "Run the <code>getAllResponseHeaders</code> method after submitting the web request. It should return a string with the header information."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 9937843, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-T8MYTSM7uwY/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0cKxqiTgAoi3_af_Q8weBQP0vqeg/mo/photo.jpg?sz=128", "display_name": "Mike Hillflag", "link": "https://stackoverflow.com/users/9937843/mike-hillflag"}, "edited": false, "score": 0, "creation_date": 1547093501, "post_id": 54118843, "comment_id": 95075670, "body": "Thank you Ryan, that was exactly what i was looking for!!! Many thanks!!!"}], "tags": [], "owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "is_accepted": true, "score": 1, "last_activity_date": 1549681826, "last_edit_date": 1549681826, "creation_date": 1547070415, "answer_id": 54118843, "question_id": 54118535, "link": "https://stackoverflow.com/questions/54118535/how-to-scrap-the-http-header-redirect-url/54118843#54118843", "title": "How to scrap the HTTP header? (Redirect URL?)", "body": "<p>If you want the header information, you can get that from the <code>getAllResponseHeaders</code> method.</p>\n\n<p>Here is a small demo:</p>\n\n<pre><code>Sub GetHeaders()\n    Dim headers As String\n\n    With CreateObject(\"MSXML2.ServerXMLHTTP\")\n        .Open \"GET\", \"https://stackoverflow.com/questions/54118535/excel-vba-how-to-scrap-the-http-header-webserver-answer-redirect-url\"\n        .send\n        headers = .getAllResponseHeaders\n        Debug.Print headers\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 9937843, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-T8MYTSM7uwY/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0cKxqiTgAoi3_af_Q8weBQP0vqeg/mo/photo.jpg?sz=128", "display_name": "Mike Hillflag", "link": "https://stackoverflow.com/users/9937843/mike-hillflag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 54118843, "answer_count": 1, "score": 0, "last_activity_date": 1549681826, "creation_date": 1547068819, "last_edit_date": 1547070517, "question_id": 54118535, "link": "https://stackoverflow.com/questions/54118535/how-to-scrap-the-http-header-redirect-url", "title": "How to scrap the HTTP header? (Redirect URL?)", "body": "<p>I've installed an add-on in my browser which let me see all the HTTP headers that go back and forth from my Firefox and a web server. </p>\n\n<p>This is a simple code I've used:</p>\n\n<pre><code>Set WinHttpReq = CreateObject(\"MSXML2.ServerXMLHTTP\")\nWinHttpReq.Open \"GET\", \"Initial_URL.com\", False\nWinHttpReq.Send\n</code></pre>\n\n<p>Below is the http header obtained:</p>\n\n<pre><code>https://Initial_URL.com\nHost: Initial_URL.com\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:56.0) Gecko/20100101 Firefox/56.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nGET: HTTP/1.1 302 Moved Temporarily\ncontent-length: 2361\ncontent-type: text/html\n\ndate: Wed, 09 Jan 2019 19:46:06 GMT\nlocation: Redirected_to.com\nSet-Cookie: PD-S-SESSION-ID=1_2_0_ud2NmPnh++62VQCPVkwxb8xp0wuMBDhqmfZiqltbPrgksUAf; \n</code></pre>\n\n<p>First part of the header is what the HTTP header has sent to the server, and then the answer from the server. </p>\n\n<p>I need to get some of these fields (e.g. location, Set-Cookie). \nI've parsed the WinHttpReq.ResponseText, but it is pure HTTP code, no headers at all.\nAny guidance?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1547068246, "post_id": 54118374, "comment_id": 95069319, "body": "Arrays are normally placed in multiple cells. <a href=\"https://stackoverflow.com/questions/50309355/excel-vba-print-array-to-worksheet\">This</a> may be of use"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1547068259, "post_id": 54118374, "comment_id": 95069326, "body": "&quot;in cell B1, insert the array&quot; - do you mean in range B1:B5 ?"}], "answers": [{"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 2, "last_activity_date": 1547069751, "last_edit_date": 1547069751, "creation_date": 1547068353, "answer_id": 54118438, "question_id": 54118374, "link": "https://stackoverflow.com/questions/54118374/how-to-insert-an-array-into-excel/54118438#54118438", "title": "How to insert an array into excel?", "body": "<p>You can use <code>Join()</code> to combine the array in a single cell.</p>\n\n<pre><code>Sub arr()\n\nDim arr() As Variant\nDim i As Long\narr = Array(1, 2, 3, 4, 5)\n\n    With ActiveSheet\n        .Range(\"B1\").Value = Join(arr, \",\")\n        ' The loop below will start in C1, and add a single array value until it's exhausted.\n        For i = LBound(arr) To UBound(arr)\n            .Cells(i + 1, 3).Value = arr(i)\n        Next i\n    End With\nEnd Sub\n</code></pre>\n\n<p>Or, for the \"vertical\" array, replace my <code>For i</code> loop with: <code>.Cells(1,3).resize(Ubound(arr)+1).Value = Application.Transpose(arr)</code> (Thanks @ScottCraner!)</p>\n\n<p><sub>(<a href=\"https://stackoverflow.com/a/18543538/4650297\">Thanks to @AndyG for the Join() idea</a>)</sub></p>\n"}, {"tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 0, "last_activity_date": 1547072117, "last_edit_date": 1547072117, "creation_date": 1547070648, "answer_id": 54118894, "question_id": 54118374, "link": "https://stackoverflow.com/questions/54118374/how-to-insert-an-array-into-excel/54118894#54118894", "title": "How to insert an array into excel?", "body": "<h1>Array To Range</h1>\n\n<pre><code>Sub ArrayToRange()\n\n    Const cString  As String = \"1,2,3,4,5\"\n\n    Dim arr As Variant\n    Dim vnt As Variant\n    Dim i As Integer\n    Dim cCell As String\n\n    ' Write list to 1D Array.\n    arr = Split(cString, \",\")\n\n    'arr = Array(1, 2, 3, 4, 5)\n\n  ' 1D Array - arr\n\n    ' Write to \"A1:A5\".\n    cCell = \"A1\"\n    Range(cCell).Resize(UBound(arr) + 1) = Application.Transpose(arr)\n\n    '' Write to \"B1:F1\", writes values as text.\n    'cCell = \"B1\"\n    'Range(cCell).Resize(, UBound(arr) + 1) = arr\n\n    ' Write to \"B1:F1\".\n    cCell = \"B1\"\n    Range(cCell).Resize(, UBound(arr) + 1) _\n            = Application.Transpose(Application.Transpose(arr))\n\n  ' 2D Array - vnt\n\n    ' Resize 2D Array.\n    ReDim vnt(1 To UBound(arr) + 1, 1 To 1)\n\n    ' Write from 1D to 2D array.\n    For i = 0 To UBound(arr)\n        vnt(i + 1, 1) = arr(i)\n    Next\n\n    ' Write to \"H1:H5\".\n    cCell = \"H1\"\n    Range(cCell).Resize(UBound(vnt)) = vnt\n\n    ' Write to  \"I1:M1\".\n    cCell = \"I1\"\n    Range(cCell).Resize(, UBound(vnt)) = Application.Transpose(vnt)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 10850056, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Pf3f2R8m0y8/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbgrQOtFS37Tnh5FaqZtI6oJIDvDQ/mo/photo.jpg?sz=128", "display_name": "GSC", "link": "https://stackoverflow.com/users/10850056/gsc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 54118438, "answer_count": 2, "score": 0, "last_activity_date": 1547072117, "creation_date": 1547068033, "last_edit_date": 1547068197, "question_id": 54118374, "link": "https://stackoverflow.com/questions/54118374/how-to-insert-an-array-into-excel", "title": "How to insert an array into excel?", "body": "<p>I am trying to insert a range of predetermined values into excel. Here is my code:</p>\n\n<pre><code>Sub arr()\n\nDim arr As Variant\nSet arr = [1,2,3,4,5]\n\n    With ActiveSheet\n\n        .Range(\"B1\").Value = arr\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>What I am trying to do is in cell B1, insert the array that I have above with the values 1 through 5. Also, if I wanted to display these values vertically, how would I go about that?</p>\n\n<p>Thanks,</p>\n\n<p>GSC</p>\n"}, {"tags": ["excel", "vba", "rowcount"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 9943422, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aRk12.jpg?s=128&g=1", "display_name": "jacob_m", "link": "https://stackoverflow.com/users/9943422/jacob-m"}, "edited": false, "score": 0, "creation_date": 1547239772, "post_id": 54118495, "comment_id": 95138681, "body": "Sorry for the delayed reply. It still does the same thing. At this point, however, I don&#39;t believe there was/ is a problem with this portion of code. I also just put random text in the K column beside of where there is text in the J column, switched the &quot;J&quot; for &quot;K&quot; in finalrow= and it worked fine. The difference is that column J is full of formulas from top to bottom. Does the row count look for formulas as well? If it does, is there a way around it?"}, {"owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "reply_to_user": {"reputation": 31, "user_id": 9943422, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aRk12.jpg?s=128&g=1", "display_name": "jacob_m", "link": "https://stackoverflow.com/users/9943422/jacob-m"}, "edited": false, "score": 0, "creation_date": 1547240197, "post_id": 54118495, "comment_id": 95138816, "body": "@jacob_m what formula is column J filled with?"}, {"owner": {"reputation": 31, "user_id": 9943422, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aRk12.jpg?s=128&g=1", "display_name": "jacob_m", "link": "https://stackoverflow.com/users/9943422/jacob-m"}, "edited": false, "score": 0, "creation_date": 1547241233, "post_id": 54118495, "comment_id": 95139224, "body": "something like &quot;=IF(B2=I2,&quot;&quot;,&quot;TON&quot;) &quot; except the numbers correspond to their row. sorry I&#39;m away from my computer but I believe that&#39;s it"}, {"owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "reply_to_user": {"reputation": 31, "user_id": 9943422, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aRk12.jpg?s=128&g=1", "display_name": "jacob_m", "link": "https://stackoverflow.com/users/9943422/jacob-m"}, "edited": false, "score": 0, "creation_date": 1547243285, "post_id": 54118495, "comment_id": 95139937, "body": "@jacob_m just updated my answer and added code to find the last row in column J using a loop, also initiated <code>finalrow = 1</code> at top"}], "tags": [], "owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "is_accepted": true, "score": 1, "last_activity_date": 1547563093, "last_edit_date": 1547563093, "creation_date": 1547068629, "answer_id": 54118495, "question_id": 54118172, "link": "https://stackoverflow.com/questions/54118172/row-counter-only-counting-top-row/54118495#54118495", "title": "Row Counter Only Counting? Top Row", "body": "<p>You can try this:</p>\n\n<pre><code>Option Explicit\nSub FindRow()\n\n    ' always use Longs over Integers\n    Dim finalrow As Long: finalrow = 1\n\n    ' you might not need this line tbh\n    Sheet29.Activate\n\n    With Sheet29\n\n        ' custom find last row\n        Do While True\n            finalrow = finalrow + 1\n            If Len(CStr(.Range(\"J\" &amp; finalrow).Value)) = 0 Then Exit Do\n        Loop\n\n        ' Len() is sometimes better then IsEmpty()\n        If Len(CStr(.Range(\"B2\").Value)) &gt; 0 Then\n            .Range(.Cells(1, 1), .Cells((finalrow - 1), 8)).Select\n        End If\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 9943422, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aRk12.jpg?s=128&g=1", "display_name": "jacob_m", "link": "https://stackoverflow.com/users/9943422/jacob-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 54118495, "answer_count": 1, "score": 0, "last_activity_date": 1547563093, "creation_date": 1547067106, "last_edit_date": 1547100534, "question_id": 54118172, "link": "https://stackoverflow.com/questions/54118172/row-counter-only-counting-top-row", "title": "Row Counter Only Counting? Top Row", "body": "<p>My code is supposed to select all of the items in A-H from the top of the sheet to the bottom most row containing text in the J column. However, now all it does is select the top row. This code has worked fine elsewhere for other purposes, but when I run it here it only selects the top row.</p>\n\n<p>Here is the code and what it currently does. The commented out bit does the same when it is ran in the place of the other <code>finalrow =</code>statement.</p>\n\n<pre><code>Option Explicit\n\nSub FindRow()\n\nDim reportsheet As Worksheet\nDim finalrow As Integer\n\nSet reportsheet = Sheet29\n\nSheet29.Activate\n'finalrow = Cells(Rows.Count, 10).End(xlUp).Row\nfinalrow = Range(\"J1048576\").End(xlUp).Row\n\n\n    If Not IsEmpty(Sheet29.Range(\"B2\").Value) Then\n         Range(Cells(1, 1), Cells(finalrow, 8)).Select\n\n    End If\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/XZQsC.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XZQsC.gif\" alt=\"enter image description here\"></a></p>\n\n<p>This is the excerpt of code with a row counter that works.</p>\n\n<pre><code>datasheet.Select\nfinalrow = Cells(Rows.Count, 1).End(xlUp).Row\n\n''loop through the rows to find the matching records\nFor i = 1 To finalrow\n    If Cells(i, 1) = item_code Then ''if the name in H1 matches the search name then\n        Range(Cells(i, 1), Cells(i, 9)).Copy ''copy columns 1 to 9 (A to I)\n        reportsheet.Select ''go to the report sheet\n        Range(\"A200\").End(xlUp).Offset(1, 0).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False ''find the first blank and paste info there\n        datasheet.Select ''go back to the data sheet and continue searching\n        End If\nNext i\n</code></pre>\n"}, {"tags": ["excel", "vba", "select"], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": false, "score": 4, "last_activity_date": 1547067021, "creation_date": 1547067021, "answer_id": 54118159, "question_id": 54118143, "link": "https://stackoverflow.com/questions/54118143/how-to-select-all-items-from-table-excluding-headers/54118159#54118159", "title": "How to select all items from table excluding headers?", "body": "<ol>\n<li>You normally don't need to <code>Select</code>.</li>\n<li>The <a href=\"https://docs.microsoft.com/en-us/office/vba/api/Excel.ListObject.DataBodyRange\" rel=\"nofollow noreferrer\"><code>DataBodyRange</code></a> \"represents the range of values, excluding the header row, in a table.\"</li>\n</ol>\n\n<p>Use <code>ActiveSheet.ListObjects(\"Table1\").DataBodyRange</code>.</p>\n"}], "owner": {"reputation": 23, "user_id": 10682956, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-eYH19KoFzJQ/AAAAAAAAAAI/AAAAAAAAGVc/0-bDyiMYXo4/photo.jpg?sz=128", "display_name": "Manuel Ramirez", "link": "https://stackoverflow.com/users/10682956/manuel-ramirez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1463, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1547105071, "creation_date": 1547066958, "last_edit_date": 1547105071, "question_id": 54118143, "link": "https://stackoverflow.com/questions/54118143/how-to-select-all-items-from-table-excluding-headers", "title": "How to select all items from table excluding headers?", "body": "<p>With this line you select all cells of table1, including headers:</p>\n\n<pre><code>ActiveSheet.ListObjects(\"Table1\").Range.Select\n</code></pre>\n\n<p>I need to select all objects save for the headers.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 266, "user_id": 10860682, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1p8ShEHvmxM/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYrC6ksVVo648mB97KGqwtUjVNJrA/mo/photo.jpg?sz=128", "display_name": "RCL", "link": "https://stackoverflow.com/users/10860682/rcl"}, "edited": false, "score": 0, "creation_date": 1547066565, "post_id": 54117971, "comment_id": 95068613, "body": "When do you want the userform to open? When you enter a value in a cell?"}, {"owner": {"reputation": 51, "user_id": 10891895, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sPFEZ.jpg?s=128&g=1", "display_name": "Ardnic", "link": "https://stackoverflow.com/users/10891895/ardnic"}, "reply_to_user": {"reputation": 266, "user_id": 10860682, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1p8ShEHvmxM/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYrC6ksVVo648mB97KGqwtUjVNJrA/mo/photo.jpg?sz=128", "display_name": "RCL", "link": "https://stackoverflow.com/users/10860682/rcl"}, "edited": false, "score": 0, "creation_date": 1547066973, "post_id": 54117971, "comment_id": 95068773, "body": "No. The Userform opens, once a specific button on a previously shown userform is clicked."}, {"owner": {"reputation": 266, "user_id": 10860682, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1p8ShEHvmxM/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYrC6ksVVo648mB97KGqwtUjVNJrA/mo/photo.jpg?sz=128", "display_name": "RCL", "link": "https://stackoverflow.com/users/10860682/rcl"}, "edited": false, "score": 0, "creation_date": 1547067522, "post_id": 54117971, "comment_id": 95068988, "body": "So you have 2 Userforms? The first one shows and there is a button on it and if you click it, it will show Form2?  In that case <code>Private Sub CommandButton1_Click()  Form2.label1.caption = CellValue   form2.show End Sub</code> In this case you just need to reference the cell correctly and you should get the value. Give it a go and show us what you have tried, the code and if you get stuck we can help you."}, {"owner": {"reputation": 51, "user_id": 10891895, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sPFEZ.jpg?s=128&g=1", "display_name": "Ardnic", "link": "https://stackoverflow.com/users/10891895/ardnic"}, "reply_to_user": {"reputation": 266, "user_id": 10860682, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1p8ShEHvmxM/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYrC6ksVVo648mB97KGqwtUjVNJrA/mo/photo.jpg?sz=128", "display_name": "RCL", "link": "https://stackoverflow.com/users/10860682/rcl"}, "edited": false, "score": 0, "creation_date": 1547068043, "post_id": 54117971, "comment_id": 95069225, "body": "That works perfectly! Thank you so much! :)"}], "answers": [{"tags": [], "owner": {"reputation": 266, "user_id": 10860682, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1p8ShEHvmxM/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYrC6ksVVo648mB97KGqwtUjVNJrA/mo/photo.jpg?sz=128", "display_name": "RCL", "link": "https://stackoverflow.com/users/10860682/rcl"}, "is_accepted": true, "score": 0, "last_activity_date": 1547068389, "creation_date": 1547068389, "answer_id": 54118445, "question_id": 54117971, "link": "https://stackoverflow.com/questions/54117971/how-to-execute-code-after-userform-is-opened/54118445#54118445", "title": "How to execute code after userform is opened?", "body": "<p>Posting comment answer here so this post can be marked as answered.</p>\n\n<pre><code>Private Sub CommandButton1_Click() \n Form2.label1.caption = CellValue \n form2.show \nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 10891895, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sPFEZ.jpg?s=128&g=1", "display_name": "Ardnic", "link": "https://stackoverflow.com/users/10891895/ardnic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 54118445, "answer_count": 1, "score": 1, "last_activity_date": 1547068389, "creation_date": 1547066287, "question_id": 54117971, "link": "https://stackoverflow.com/questions/54117971/how-to-execute-code-after-userform-is-opened", "title": "How to execute code after userform is opened?", "body": "<p>I hope this question is not too trivial as I am new to VBA.</p>\n\n<p>I want to make a label in a userform show data from a cell on a worksheet. The label should show this data directly when the userform opens.</p>\n\n<p>This thread probably gives me the answer:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/6858747/in-an-excel-userform-how-do-i-update-a-labels-caption#\">In an Excel UserForm, how do I update a label&#39;s caption?</a></p>\n\n<p>However I am confused regarding WHERE to put this code?!</p>\n\n<p>Should I put it into the Userform directly?\n-> this would make the most sense to me but does not work, as the code is not even executed then.\nShould I create a new module for this code?\n-> then how do I call this sub automatically after the userform opens?</p>\n\n<p>Thanks alot in advance!\nLeo</p>\n"}, {"tags": ["excel", "vba", "string", "range"], "answers": [{"comments": [{"owner": {"reputation": 1730, "user_id": 5691558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18305559850d1d9ce0aa697f3fa38a2c?s=128&d=identicon&r=PG&f=1", "display_name": "Ger Cas", "link": "https://stackoverflow.com/users/5691558/ger-cas"}, "edited": false, "score": 0, "creation_date": 1547075598, "post_id": 54118281, "comment_id": 95071983, "body": "Hi Storax, your solution works fine, may you see my update in my post. It could be possible to consider the case when the cells have 2 letters either?"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 1730, "user_id": 5691558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18305559850d1d9ce0aa697f3fa38a2c?s=128&d=identicon&r=PG&f=1", "display_name": "Ger Cas", "link": "https://stackoverflow.com/users/5691558/ger-cas"}, "edited": false, "score": 0, "creation_date": 1547104705, "post_id": 54118281, "comment_id": 95078657, "body": "@Ger Cas: If you have additional questions I&#39;d suggest to create a new post."}], "tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": false, "score": 1, "last_activity_date": 1547067600, "creation_date": 1547067600, "answer_id": 54118281, "question_id": 54117946, "link": "https://stackoverflow.com/questions/54117946/look-for-substring-within-excel-range-vba/54118281#54118281", "title": "Look for substring within Excel range VBA", "body": "<p>I modified your code based on the information that we have to look ar Range(\"A1:O4\")</p>\n\n<pre><code>Sub SelectRangeofSubString()\nDim rng As Range\nDim a, str1, stringtosearch, stringlength, pos\nDim i As Long, j As Long\n    Set rng = Range(\"A1:O4\")\n\n    a = rng ' Range(\"A1\").CurrentRegion\n    'aa = WorksheetFunction.Transpose(WorksheetFunction.Transpose(a))\n    For i = LBound(a, 1) To UBound(a, 1)\n        For j = LBound(a, 2) To UBound(a, 2)\n            str1 = str1 &amp; a(i, j)\n        Next\n    Next\n\n    stringtosearch = \"developed\"\n    stringlength = Len(stringtosearch)\n    pos = InStr(str1, stringtosearch)\n\n    Dim resRg As Range\n    Set resRg = rng.Item(pos)\n    For i = pos + 1 To pos + Len(stringtosearch) - 1\n        Set resRg = Union(resRg, rng.Item(i))\n    Next i\n    resRg.Select\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1730, "user_id": 5691558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18305559850d1d9ce0aa697f3fa38a2c?s=128&d=identicon&r=PG&f=1", "display_name": "Ger Cas", "link": "https://stackoverflow.com/users/5691558/ger-cas"}, "edited": false, "score": 0, "creation_date": 1547075619, "post_id": 54118500, "comment_id": 95071993, "body": "Hi Ryan, your solution works fine, may you see my update in my post. It could be possible to consider the case when the cells have 2 letters either?"}, {"owner": {"reputation": 1730, "user_id": 5691558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18305559850d1d9ce0aa697f3fa38a2c?s=128&d=identicon&r=PG&f=1", "display_name": "Ger Cas", "link": "https://stackoverflow.com/users/5691558/ger-cas"}, "edited": false, "score": 0, "creation_date": 1547090306, "post_id": 54118500, "comment_id": 95075038, "body": "Only can I say, wonderful! It works so nice. Thanks so much for your help Ryan. Regards"}, {"owner": {"reputation": 1730, "user_id": 5691558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18305559850d1d9ce0aa697f3fa38a2c?s=128&d=identicon&r=PG&f=1", "display_name": "Ger Cas", "link": "https://stackoverflow.com/users/5691558/ger-cas"}, "edited": false, "score": 0, "creation_date": 1547098499, "post_id": 54118500, "comment_id": 95076739, "body": "I only found an issue, with long substrings it seems is not selecting all the range for that string. For example if the substring to search within the range has a length of 2500 characters only selects 127 cells and should be 1250 cells, since each cell has 2 characters. May you help me to fix this? If not thanks anyway for your great help. You can test in a range from A1:AP50 (40 columns, 50 rows) and a substring of 1000 or more characters."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "reply_to_user": {"reputation": 1730, "user_id": 5691558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18305559850d1d9ce0aa697f3fa38a2c?s=128&d=identicon&r=PG&f=1", "display_name": "Ger Cas", "link": "https://stackoverflow.com/users/5691558/ger-cas"}, "edited": false, "score": 0, "creation_date": 1547125056, "post_id": 54118500, "comment_id": 95089489, "body": "@GerCas Only thing I can think that would cause that is if each cell contains a different number of characters in your range, check that first. I don&#39;t think this approach works unless each cell has the same number of characters in it."}, {"owner": {"reputation": 1730, "user_id": 5691558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18305559850d1d9ce0aa697f3fa38a2c?s=128&d=identicon&r=PG&f=1", "display_name": "Ger Cas", "link": "https://stackoverflow.com/users/5691558/ger-cas"}, "edited": false, "score": 0, "creation_date": 1547131317, "post_id": 54118500, "comment_id": 95093298, "body": "Yes Ryan. I&#39;m testing with hexadecimal number, all are of 2 characters. For example 01, A9, 12, 00, BD in each cell and all cells formated as text."}, {"owner": {"reputation": 1730, "user_id": 5691558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18305559850d1d9ce0aa697f3fa38a2c?s=128&d=identicon&r=PG&f=1", "display_name": "Ger Cas", "link": "https://stackoverflow.com/users/5691558/ger-cas"}, "edited": false, "score": 0, "creation_date": 1547164615, "post_id": 54118500, "comment_id": 95108675, "body": "I found the issue is because I use an inputbox to introduce the string to search and it seems inputbox doesn&#39;t allow more than 254 characters. Yhen instead to look for a string or more than 2000 characters, always will look for a string of 254 characters as maximum."}], "tags": [], "owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "is_accepted": true, "score": 1, "last_activity_date": 1547079553, "last_edit_date": 1547079553, "creation_date": 1547068643, "answer_id": 54118500, "question_id": 54117946, "link": "https://stackoverflow.com/questions/54117946/look-for-substring-within-excel-range-vba/54118500#54118500", "title": "Look for substring within Excel range VBA", "body": "<p>I made this ask into a little subroutine that will take a SearchRange and SearchString as parameters. </p>\n\n<p>The subroutine will select the cells where the first match was found. It should be easy to switch this around if you wanted to return the <code>Range</code> object instead.</p>\n\n<pre><code>Private Sub FindWord(SearchRange As Range, SearchString As String)\n    Dim LetterArray         As Variant\n    Dim RangeArray          As Variant\n    Dim ws                  As Worksheet\n    Dim Letter              As Range\n    Dim i                   As Long\n    Dim SelectedRng         As Range\n    Dim StringPosition      As Long\n    Dim LastSearchIndex     As Long\n\n    ReDim LetterArray(1 To SearchRange.Cells.Count)\n    ReDim RangeArray(1 To SearchRange.Cells.Count)\n    Set ws = SearchRange.Parent\n\n    For Each Letter In SearchRange\n        i = i + 1\n        LetterArray(i) = Letter.Value2\n        RangeArray(i) = Letter.Address\n    Next\n\n    StringPosition = InStr(1, Join(LetterArray, vbNullString), SearchString)\n    If StringPosition &lt;= 0 Then Exit Sub\n    LastSearchIndex = Len(SearchString) + StringPosition - 1\n\n    For i = StringPosition To LastSearchIndex\n        If SelectedRng Is Nothing Then\n            Set SelectedRng = ws.Range(RangeArray(i))\n        Else\n            Set SelectedRng = Union(SelectedRng, ws.Range(RangeArray(i)))\n        End If\n    Next\n\n    SelectedRng.Select\nEnd Sub\n\nSub SelectIt()\n    Dim rng As Range\n    Set rng = ThisWorkbook.Sheets(\"Sheet1\").Range(\"A1:D4\")\n\n    FindWord rng, \"developed\"\nEnd Sub\n</code></pre>\n\n<p><strong>Edit</strong></p>\n\n<hr>\n\n<p>Updated this to handle 2 or more characters in one cell. This should work for up to <code>N</code> characters, however I only briefly tested this out. I hope it helps. I'll leave the other method for posterity. </p>\n\n<p>I should mention this revised method does assume all cells have the same number of characters in them. If that isn't true, it likely won't work.</p>\n\n<pre><code>Private Sub FindWord(SearchRange As Range, SearchString As String, Optional CharacterLength As Long = 1)\n    Dim LetterArray         As Variant\n    Dim RangeArray          As Variant\n    Dim ws                  As Worksheet\n    Dim Letter              As Range\n    Dim i                   As Long\n    Dim SelectedRng         As Range\n    Dim StringPosition      As Long\n    Dim LastSearchIndex     As Long\n\n    ReDim LetterArray(1 To SearchRange.Cells.Count)\n    ReDim RangeArray(1 To SearchRange.Cells.Count)\n    Set ws = SearchRange.Parent\n\n    For Each Letter In SearchRange\n        i = i + 1\n        LetterArray(i) = Letter.Value2\n        RangeArray(i) = Letter.Address\n    Next\n\n    StringPosition = WorksheetFunction.RoundUp((InStr(1, Join(LetterArray, vbNullString), SearchString) / CharacterLength), 0)\n    If StringPosition &lt;= 0 Then Exit Sub\n    LastSearchIndex = WorksheetFunction.RoundUp((Len(SearchString) / CharacterLength), 0) + StringPosition - 1\n\n    For i = StringPosition To LastSearchIndex\n        If SelectedRng Is Nothing Then\n            Set SelectedRng = ws.Range(RangeArray(i))\n        Else\n            Set SelectedRng = Union(SelectedRng, ws.Range(RangeArray(i)))\n        End If\n    Next\n\n    SelectedRng.Select\nEnd Sub\n\nSub SelectIt()\n    Dim rng As Range\n    Set rng = ThisWorkbook.Sheets(\"Sheet1\").Range(\"A1:D4\")\n\n    FindWord rng, \"developed\", 2\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1730, "user_id": 5691558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18305559850d1d9ce0aa697f3fa38a2c?s=128&d=identicon&r=PG&f=1", "display_name": "Ger Cas", "link": "https://stackoverflow.com/users/5691558/ger-cas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 427, "favorite_count": 0, "accepted_answer_id": 54118500, "answer_count": 2, "score": 0, "last_activity_date": 1547107728, "creation_date": 1547066209, "last_edit_date": 1547107728, "question_id": 54117946, "link": "https://stackoverflow.com/questions/54117946/look-for-substring-within-excel-range-vba", "title": "Look for substring within Excel range VBA", "body": "<p>I have an input text string in a range (from A1 to AV1), each letter in one cell. The string is</p>\n\n<p><strong>From A1 to AV1 look like this</strong></p>\n\n<pre><code>  | A B C D E F G H I J K L M N O P Q R S T U V W X Y Z AA AB AC AD AE AF AG AH AI AJ AK AL AM AN AO AP AQ AR AS AT AU AV\n--------------------------------------------------------------------------------------------------------------------------\n1 | M i c r o s o f t E x c e l i s a s p r e a d s h e e  t  d  e  v  e  l  o  p  e  d  b  y  M  i  c  r  o  s  o  f  t\n</code></pre>\n\n<p>I want to be able to search for a substring and if found, select the range where the substring is present.  </p>\n\n<p>My current code below it works if the input text string is in the same row, but I'm stuck in how to do\nif the string is in different rows, for example if the same input text string is in range A1:O4 and I want to\nsearch the substring \"developed\" which begins in N2 and ends in G3.</p>\n\n<pre><code>Sub SelectRangeofSubString()\nRng = Range(\"A1:AV1\")\n\na = Range(\"A1\").CurrentRegion\naa = WorksheetFunction.Transpose(WorksheetFunction.Transpose(a))\nstr1 = Join(aa, \"\")\n\nStringToSearch = \"developed\"\nStringLength = Len(StringToSearch)\nPos = InStr(str1, StringToSearch)\n\nRange(Cells(1, Pos), Cells(1, Pos + StringLength - 1)).Select\n\nEnd Sub\n</code></pre>\n\n<p><strong>From A1 to O4 look like this</strong></p>\n\n<pre><code>  | A   B   C   D   E   F   G   H   I   J   K   L   M   N   O\n---------------------------------------------------------------\n1 | M   i   c   r   o   s   o   f   t   E   x   c   e   l   i\n2 | s   a   s   p   r   e   a   d   s   h   e   e   t   d   e\n3 | v   e   l   o   p   e   d   b   y   M   i   c   r   o   s\n4 | o   f   t                                               \n</code></pre>\n\n<p>Thanks for any help</p>\n\n<p><strong>Update</strong></p>\n\n<p>Thanks both. It works in both solutions. My last issue, I tried the same when each cell contains 2 letters, May you help me to select the range in this case too?</p>\n\n<p>For example the stringToSearch = \"developed\" and data is from range A1:H3</p>\n\n<pre><code>    A   B   C   D   E   F   G   H\n----------------------------------\n1 | Mi  cr  os  of  tE  xc  el  is\n2 | as  pr  ea  ds  he  et  de  ve\n3 | lo  pe  db  yM  ic  ro  so  ft\n</code></pre>\n"}, {"tags": ["excel", "vba", "conditional-formatting"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1547065640, "post_id": 54117778, "comment_id": 95068221, "body": "Does this require VBA? You can do this with Conditional Formatting."}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1547066292, "post_id": 54117778, "comment_id": 95068508, "body": "Agree with @tigeravatar that you can use Conditional Formatting."}, {"owner": {"reputation": 3, "user_id": 10863983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/142ca7620e43dff30d34ceeeadc047a3?s=128&d=identicon&r=PG&f=1", "display_name": "VBANoob", "link": "https://stackoverflow.com/users/10863983/vbanoob"}, "edited": false, "score": 0, "creation_date": 1547067140, "post_id": 54117778, "comment_id": 95068844, "body": "This macro will be used across multiple excel spreadsheets, which we receive weekly. Conditional Formatting may work, but won&#39;t I have to set that up in each new spreadsheet?"}, {"owner": {"reputation": 266, "user_id": 10860682, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1p8ShEHvmxM/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYrC6ksVVo648mB97KGqwtUjVNJrA/mo/photo.jpg?sz=128", "display_name": "RCL", "link": "https://stackoverflow.com/users/10860682/rcl"}, "edited": false, "score": 0, "creation_date": 1547067867, "post_id": 54117778, "comment_id": 95069147, "body": "The code above works for me. Nothing happens for you if run it?"}, {"owner": {"reputation": 3, "user_id": 10863983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/142ca7620e43dff30d34ceeeadc047a3?s=128&d=identicon&r=PG&f=1", "display_name": "VBANoob", "link": "https://stackoverflow.com/users/10863983/vbanoob"}, "edited": false, "score": 0, "creation_date": 1547068800, "post_id": 54117778, "comment_id": 95069578, "body": "No, the code above doesn&#39;t work for me unless the cell only contains &quot;trust&quot; or &quot;hope&quot;. I need to change the cell fill when &quot;trust&quot; or &quot;hope&quot; is a part of the cell&#39;s value (which is why I thought coding for a string would be ideal). For instance, if the cell value is &quot;Bob Hope&quot;, the cell should change to red, but it does not."}], "answers": [{"tags": [], "owner": {"reputation": 266, "user_id": 10860682, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1p8ShEHvmxM/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYrC6ksVVo648mB97KGqwtUjVNJrA/mo/photo.jpg?sz=128", "display_name": "RCL", "link": "https://stackoverflow.com/users/10860682/rcl"}, "is_accepted": true, "score": 0, "last_activity_date": 1547069108, "creation_date": 1547069108, "answer_id": 54118611, "question_id": 54117778, "link": "https://stackoverflow.com/questions/54117778/how-do-i-change-the-cell-fill-color-based-on-strings-sought-over-two-columns/54118611#54118611", "title": "How do I change the cell fill color based on strings sought over two columns?", "body": "<p>The code below should do the trick for you.</p>\n\n<pre><code>Sub FindTrustHope()\n\nDim B As Long, C As Long, i As Long\nDim findTrust As String\nDim findHope As String\nB = Cells(Rows.Count, \"B\").End(xlUp).Row\nC = Cells(Rows.Count, \"C\").End(xlUp).Row\nfindTrust = \"trust\"\nfindHope = \"hope\"\n    For i = B To 1 Step -1\n    If InStr(Cells(i, \"B\"), findTrust) &gt; 0 Or InStr(Cells(i, \"B\"), findHope) &gt; 0 Then\n        Cells(i, \"B\").Interior.Color = vbRed\n    End If\n    If InStr(Cells(i, \"C\"), findTrust) &gt; 0 Or InStr(Cells(i, \"C\"), findHope) &gt; 0 Then\n        Cells(i, \"C\").Interior.Color = vbRed\n    End If\n\nNext i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10863983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/142ca7620e43dff30d34ceeeadc047a3?s=128&d=identicon&r=PG&f=1", "display_name": "VBANoob", "link": "https://stackoverflow.com/users/10863983/vbanoob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 54118611, "answer_count": 1, "score": 0, "last_activity_date": 1547107713, "creation_date": 1547065411, "last_edit_date": 1547107713, "question_id": 54117778, "link": "https://stackoverflow.com/questions/54117778/how-do-i-change-the-cell-fill-color-based-on-strings-sought-over-two-columns", "title": "How do I change the cell fill color based on strings sought over two columns?", "body": "<p>I have two columns (B &amp; C) containing names, but I'm looking to make sure certain words are flagged for review by changing the cell fill color.</p>\n\n<p>It seems I'm not much familiar with VBA anymore, but I'm having to dabble some to get a much needed macro to work. Like I said above, I have two columns (B &amp; C) containing names, but I'm looking to make sure certain words are flagged for review by changing the cell fill color. The words I'm looking for are \"hope\" and \"trust\", and they're likely a part of some values.</p>\n\n<pre><code>Sub FindTrustHope()\n\nDim B As Long, C As Long, i As Long\nDim findTrust As String\nDim findHope As String\nB = Cells(Rows.Count, \"B\").End(xlUp).Row\nC = Cells(Rows.Count, \"C\").End(xlUp).Row\nfindTrust = \"trust\"\nfindHope = \"hope\"\n    For i = B To 1 Step -1\n    If Cells(i, \"B\") = findTrust Or Cells(i, \"B\") = findHope Then\n        Cells(i, \"B\").Interior.Color = vbRed\n    End If\n    If Cells(i, \"C\") = findTrust Or Cells(i, \"C\") = findHope Then\n        Cells(i, \"C\").Interior.Color = vbRed\n    End If\n\nNext i\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "user-defined-functions"], "comments": [{"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 1, "creation_date": 1547064527, "post_id": 54117470, "comment_id": 95067750, "body": "You are trying to assign a number to a range. ... .Row is a number and LookupRange is a range."}, {"owner": {"reputation": 72, "user_id": 10821072, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-n3JVp7YWGQY/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYFXnUK5Hv6BMoruvKO5nMTrt76qw/mo/photo.jpg?sz=128", "display_name": "Michael Smith", "link": "https://stackoverflow.com/users/10821072/michael-smith"}, "reply_to_user": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1547064683, "post_id": 54117470, "comment_id": 95067828, "body": "Ahhhh. How should I go about fixing that then?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1547064763, "post_id": 54117470, "comment_id": 95067867, "body": "You should know that by using activeSheet the minute a given sheet is inactive any cells on that sheet using this UDF may start calculating wrong results.  If you want to be safe you should use <code>Application.ThisCell.Parent</code> in place of <code>ActiveSheet</code>"}, {"owner": {"reputation": 72, "user_id": 10821072, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-n3JVp7YWGQY/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYFXnUK5Hv6BMoruvKO5nMTrt76qw/mo/photo.jpg?sz=128", "display_name": "Michael Smith", "link": "https://stackoverflow.com/users/10821072/michael-smith"}, "edited": false, "score": 0, "creation_date": 1547064975, "post_id": 54117470, "comment_id": 95067948, "body": "Tim, that is great advice. I knew of <code>ThisCell</code> but didn&#39;t know about <code>Parent</code>."}], "answers": [{"comments": [{"owner": {"reputation": 72, "user_id": 10821072, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-n3JVp7YWGQY/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYFXnUK5Hv6BMoruvKO5nMTrt76qw/mo/photo.jpg?sz=128", "display_name": "Michael Smith", "link": "https://stackoverflow.com/users/10821072/michael-smith"}, "edited": false, "score": 0, "creation_date": 1547129719, "post_id": 54117805, "comment_id": 95092250, "body": "I got another #VALUE error here unfortunately. The solution from Tim worked, FWIW!"}], "tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 0, "last_activity_date": 1547066829, "last_edit_date": 1547066829, "creation_date": 1547065549, "answer_id": 54117805, "question_id": 54117470, "link": "https://stackoverflow.com/questions/54117470/problem-with-udf-designed-to-concatenate-multiple-matches-in-vlookup/54117805#54117805", "title": "Problem with UDF designed to concatenate multiple matches in vlookup", "body": "<h1>Concatenate Multiple</h1>\n\n<p>When using Range or Cells etc. without qualifiers, they refer to the <code>ActiveSheet</code> of the <code>ActiveWorkbook</code>.</p>\n\n<h2>The Code</h2>\n\n<pre><code>Function EmailConcat(LookupValue As String)\n\n    Application.Volatile\n\n    Const cFirst As String = \"B5\"\n    Const cCol As Variant = \"O\"\n    Dim i As Long\n    Dim Result As String\n    Dim LastRow As Long\n\n    LastRow = Cells.Find(\"*\", , xlFormulas, xlWhole, xlByRows, xlPrevious).Row\n\n    For i = Range(cFirst).Row To LastRow\n        If Cells(i, Range(cFirst).Column) = LookupValue Then\n            Result = Result &amp; Cells(i, cCol) &amp; \"; \"\n        End If\n    Next i\n\n    EmailConcat = Left(Result, Len(Result) - 2)\n\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1547067774, "post_id": 54118178, "comment_id": 95069112, "body": "ThisCell. That&#39;s a new one. And even more impressive the sep-trick."}, {"owner": {"reputation": 72, "user_id": 10821072, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-n3JVp7YWGQY/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYFXnUK5Hv6BMoruvKO5nMTrt76qw/mo/photo.jpg?sz=128", "display_name": "Michael Smith", "link": "https://stackoverflow.com/users/10821072/michael-smith"}, "edited": false, "score": 0, "creation_date": 1547130111, "post_id": 54118178, "comment_id": 95092493, "body": "Thanks so much, Tim. This works perfectly. I don&#39;t quite understand why you have to add 4 to i in Cells(4 + i, 15) but not vals(i, 1) in the previous line. Could you please explain the logic there?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1547134708, "post_id": 54118178, "comment_id": 95095458, "body": "We picked up the range from B5 down, so the first element would be at index (1, 1) - need to adjust that index back to an actual row in Col15 by adding 4."}, {"owner": {"reputation": 72, "user_id": 10821072, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-n3JVp7YWGQY/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYFXnUK5Hv6BMoruvKO5nMTrt76qw/mo/photo.jpg?sz=128", "display_name": "Michael Smith", "link": "https://stackoverflow.com/users/10821072/michael-smith"}, "edited": false, "score": 0, "creation_date": 1547152889, "post_id": 54118178, "comment_id": 95104672, "body": "Ah, because we&#39;re selecting (1, 1) of the <code>vals</code> &quot;range&quot; first but then using <code>.Cells</code> the second time. Could you accomplish the same thing by replacing <code>.Cells(4 + i, 15)</code> with <code>vals(i, 14)</code> or would this not work because <code>vals</code> is just a column?"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1547067133, "creation_date": 1547067133, "answer_id": 54118178, "question_id": 54117470, "link": "https://stackoverflow.com/questions/54117470/problem-with-udf-designed-to-concatenate-multiple-matches-in-vlookup/54118178#54118178", "title": "Problem with UDF designed to concatenate multiple matches in vlookup", "body": "<p>Using <code>ThisCell</code> to ensure results are accurate, and reading the lookup column into an array for better performance:</p>\n\n<pre><code>Function EmailConcat(LookupValue As String)\n\n    Application.Volatile\n\n    Dim vals, rv, i As Long, sep As String\n\n    If LookupValue &lt;&gt; \"\" Then\n        With Application.ThisCell.Worksheet\n            vals = .Range(.Range(\"B5\"), .Cells(.Rows.Count, 2).End(xlUp))\n            For i = 1 To UBound(vals, 1)\n                If vals(i, 1) = LookupValue Then\n                    rv = rv &amp; sep &amp; .Cells(4 + i, 15).Value\n                    sep = \"; \"\n                End If\n            Next i\n        End With\n    End If\n    EmailConcat = rv\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 72, "user_id": 10821072, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-n3JVp7YWGQY/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYFXnUK5Hv6BMoruvKO5nMTrt76qw/mo/photo.jpg?sz=128", "display_name": "Michael Smith", "link": "https://stackoverflow.com/users/10821072/michael-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 1, "accepted_answer_id": 54118178, "answer_count": 2, "score": 1, "last_activity_date": 1547067133, "creation_date": 1547064113, "question_id": 54117470, "link": "https://stackoverflow.com/questions/54117470/problem-with-udf-designed-to-concatenate-multiple-matches-in-vlookup", "title": "Problem with UDF designed to concatenate multiple matches in vlookup", "body": "<p>For the life of me, I can't figure out why this isn't working. It gives me a #VALUE error.</p>\n\n<p>I'm using ActiveSheet because I'll put it on a number of different sheets, and I don't want to have to add a field in the function for that.</p>\n\n<p>LookupRange is designed to find the last row with data in it on ActiveSheet.</p>\n\n<p>My lookup values begin in B5 and extend indefinitely, and the desired matches are in Column O (15th column).</p>\n\n<pre><code>Function EmailConcat(LookupValue As String)\n\nApplication.Volatile\n\nDim i As Long\nDim Result As String\nDim LookupSheet As Worksheet\nDim LookupRange As Range\n\nSet LookupSheet = Application.ActiveSheet\n\nLookupRange = LookupSheet.Cells.Find(What:=\"*\", SearchOrder:=xlRows, _\n    SearchDirection:=xlPrevious, LookIn:=xlValues).Row\n\nFor i = 5 To LookupRange.Rows.Count\n    If LookupSheet.Cells(i, 2) = LookupValue Then\n\n    Result = Result &amp; LookupSheet.Cells(i, 15) &amp; \"; \"\n\n    End If\nNext i\n\nEmailConcat = Left(Result, Len(Result) - 2)\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba", "api", "authentication", "winhttprequest"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 9963710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8746c9c606860dcb284b2ecf7d786395?s=128&d=identicon&r=PG&f=1", "display_name": "bluequasi", "link": "https://stackoverflow.com/users/9963710/bluequasi"}, "is_accepted": false, "score": 0, "last_activity_date": 1547107894, "last_edit_date": 1547107894, "creation_date": 1547072405, "answer_id": 54119244, "question_id": 54117140, "link": "https://stackoverflow.com/questions/54117140/localbitcoins-authenticated-http-post-request-error/54119244#54119244", "title": "Localbitcoins authenticated HTTP POST request error", "body": "<p>It appears that after braking brains over an issue, one have to post the question on stackoverflow in order to have the revelation for the answer... I realized that I'm using an apikey that only can read from server so, naturally, cannot modify server data by a POST request. Creating and using the right key, with write rights, solved the issue!\nThe working code is:</p>\n\n<pre><code>Function PrivateLocalBTC(Method As String, endpoint As String, Optional params As String) As String\n'Method \"GET', \"POST\"\n'params format: \"argument1=value&amp;argument2=value&amp;....\"\n\nDim NonceUnique As String\nNonceUnique = CreateNonce(13)\nTradeApiSite = \"https://localbitcoins.com\"\napikey = \"...............\"\nsecretkey = \"............\"\n\nMessage = NonceUnique &amp; apikey &amp; endpoint &amp; params\napisign = ComputeHash_C(\"SHA256\", Message, secretkey, \"STRHEX\")\nIf params &lt;&gt; \"\" Then urlparams = \"?\" &amp; params\nUrl = TradeApiSite &amp; endpoint &amp; urlparams\n\nSet objHTTP = CreateObject(\"WinHttp.WinHttpRequest.5.1\")\nobjHTTP.Open Method, Url, False\nobjHTTP.setRequestHeader \"User-Agent\", \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)\"\nobjHTTP.setRequestHeader \"Content-Type\", \"application/x-www-form-urlencoded\"\nobjHTTP.setRequestHeader \"Apiauth-Key\", apikey\nobjHTTP.setRequestHeader \"Apiauth-Nonce\", NonceUnique\nobjHTTP.setRequestHeader \"Apiauth-Signature\", apisign\nobjHTTP.Send params\n\nobjHTTP.waitForResponse\nPrivateLocalBTC = objHTTP.ResponseText\nSet objHTTP = Nothing\nEnd Function\n</code></pre>\n\n<p>The only modification is \"objHTTP.Send params\". Be sure to use the correct api keys!</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10612380, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjXH2.jpg?s=128&g=1", "display_name": "NOLUP", "link": "https://stackoverflow.com/users/10612380/nolup"}, "is_accepted": false, "score": 0, "last_activity_date": 1567770156, "creation_date": 1567770156, "answer_id": 57821357, "question_id": 54117140, "link": "https://stackoverflow.com/questions/54117140/localbitcoins-authenticated-http-post-request-error/57821357#57821357", "title": "Localbitcoins authenticated HTTP POST request error", "body": "<p>I fixed error no. 41. I modified this example <a href=\"https://stackoverflow.com/questions/47046641/how-to-use-pagination-at-api-localbitcoin\">enter link description here</a>\nto show that works, (read my NOTE: comments to understand better where is the problem)\nRead my NOTE: comments.</p>\n\n<pre><code>&lt;?php\nfunction localbitcoins_query($path, array $req = Array()) { \n   $key='yourkey';\n   $secret='yoursecret';      \n\n   $array_mt = explode(' ', microtime());   \n   $nonce = $array_mt[1].substr($array_mt[0], 2, 6);   \n\n   $get = \"\";\n   if ($req) {\n      $get=http_build_query($req);\n   }\n   $postdata=$nonce.$key.$path.$get; // NOTE: here $postdata goes without '?' char before the parameters!\n\n   $sign = strtoupper(hash_hmac('sha256', $postdata, $secret)); \n\n   $headers = array(\n      'Apiauth-Signature:'.$sign,\n      'Apiauth-Key:'.$key,\n      'Apiauth-Nonce:'.$nonce\n   );\n   $ch = null;\n   $ch = curl_init('https://localbitcoins.com'.$path.( $get==\"\" ? \"\" : \"?\".$get)); // NOTE:  here it's necesary '?' char before the parameters!\n   curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);\n   curl_setopt($ch, CURLOPT_HTTPHEADER, $headers);\n   curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, TRUE);\n   curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 20);\n\n   $res = curl_exec($ch);\n   if ($res === false) throw new Exception('Curl error: '.curlerror($ch));\n   $dec = json_decode($res, true);   \n   if (!$dec) throw new Exception('Invalid data: '.$res);\n   curl_close($ch);   \n   return $dec;\n}\n\n$getinfo = array();\n$api_endpoint = '/api/dashboard/closed/';\n$array_params = array(    \"order_by\" =&gt; \"-closed_at\"\n                        , \"start_at\" =&gt; \"2019-08-14 18:00:26+00:00\" \n                        );\n$getinfo = localbitcoins_query($api_endpoint,$array_params);\necho \"&lt;pre&gt;\"; print_r($getinfo); echo \"&lt;/pre&gt;\"; \n?&gt;\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9963710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8746c9c606860dcb284b2ecf7d786395?s=128&d=identicon&r=PG&f=1", "display_name": "bluequasi", "link": "https://stackoverflow.com/users/9963710/bluequasi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 149, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1567770156, "creation_date": 1547062574, "last_edit_date": 1547063095, "question_id": 54117140, "link": "https://stackoverflow.com/questions/54117140/localbitcoins-authenticated-http-post-request-error", "title": "Localbitcoins authenticated HTTP POST request error", "body": "<p>I'm trying to send POST request to LocalBitcoins API server but I'm only receiving errors (41 and 43) despite the GET request works perfectly even with parameters (arguments).</p>\n\n<pre><code>Sub initrequest()\n\n'this is a POST request with no arguments  that results in error  \nJsonResponse = PrivateLocalBTC(\"POST\", \"/api/notifications/mark_as_read/9b9c2b5a16a3/\")\n\n'this is a GET request, with \"ads=..\" parameter, that works\n'JsonResponse = PrivateLocalBTC(\"GET\", \"/api/ad-get/\", \"ads=771318\")\n\nDebug.Print JsonResponse\n\nEnd Sub\n</code></pre>\n\n<p>and there is the HTTP request sub:</p>\n\n<pre><code>Function PrivateLocalBTC(Method As String, endpoint As String, Optional params As String) As String\n\nDim NonceUnique As String\nNonceUnique = CreateNonce(13)\nTradeApiSite = \"https://localbitcoins.com\"\napikey = \"...............\"\nsecretkey = \"............\"\n\nMessage = NonceUnique &amp; apikey &amp; endpoint &amp; params\napisign = ComputeHash_C(\"SHA256\", Message, secretkey, \"STRHEX\")\nIf params &lt;&gt; \"\" Then urlparams = \"?\" &amp; params\nUrl = TradeApiSite &amp; endpoint &amp; urlparams\n\nSet objHTTP = CreateObject(\"WinHttp.WinHttpRequest.5.1\")\nobjHTTP.Open Method, Url, False\nobjHTTP.setRequestHeader \"User-Agent\", \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)\"\nobjHTTP.setRequestHeader \"Content-Type\", \"application/x-www-form-urlencoded\"\nobjHTTP.setRequestHeader \"Apiauth-Key\", apikey\nobjHTTP.setRequestHeader \"Apiauth-Nonce\", NonceUnique\nobjHTTP.setRequestHeader \"Apiauth-Signature\", apisign\nobjHTTP.Send (\"\")\n\nobjHTTP.waitForResponse\nPrivateLocalBTC = objHTTP.ResponseText\nSet objHTTP = Nothing\nEnd Function\n</code></pre>\n\n<p>I've tried many variation putting endpoint, nonce, apikey in the request body at .Send command , urlencoding, but no positive result.</p>\n\n<p>ComputeHash_C, CreateNonce are separate functions. The code is inspired by the great shared work of <a href=\"https://github.com/krijnsent/crypto_vba\" rel=\"nofollow noreferrer\">https://github.com/krijnsent/crypto_vba</a> !</p>\n\n<p>LocalBitcoins API doc is here: <a href=\"https://localbitcoins.com/api-docs/\" rel=\"nofollow noreferrer\">https://localbitcoins.com/api-docs/</a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1547060828, "post_id": 54116632, "comment_id": 95066234, "body": "33 is the column number, or Column AG. Your code searches for CATS in column AG starting from row 1 to the last row with data and when found it assigns the found row number to lastRowSearchValue which is incorrect because lastRowSearchValue is a range. Correct would be Set lastRowSearchValue = .Cells(i, 33) to be able to continue with lastRowSearchValue.Copy"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5711863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31d5f655604c0b5b2c948e2f90ec9806?s=128&d=identicon&r=PG&f=1", "display_name": "drwonoski", "link": "https://stackoverflow.com/users/5711863/drwonoski"}, "edited": false, "score": 0, "creation_date": 1547061038, "post_id": 54116661, "comment_id": 95066314, "body": "so that&#39;s telling the code to search through all rows, from the end of the file up to the beginning, and look specifically for &quot;shortname&quot; in column 33?"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 0, "last_activity_date": 1547061424, "last_edit_date": 1547061424, "creation_date": 1547060498, "answer_id": 54116661, "question_id": 54116632, "link": "https://stackoverflow.com/questions/54116632/with-cellsrows-count-3-what-does-the-3-represent/54116661#54116661", "title": "With .Cells(Rows.Count, 3), what does the 3 represent?", "body": "<p><code>Cells(Row,Column)</code></p>\n\n<p>So it is the Column number.</p>\n\n<p>See: <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheet.cells\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/api/excel.worksheet.cells</a></p>\n\n<p>So <code>.Cells(Rows.Count, 33).End(xlUp).Row</code> is starting at the bottom of Column 33 and and searching up till it finds the first cell from the bottom that has a value.</p>\n\n<p>Then the loop is looping from the first Row to that last row and checking the value in that column on each row.</p>\n\n<p>If <code>.Cells(i, 33) = shortname</code> Then is then checking that cell, each one in that column if its value is the same as <code>shortname</code></p>\n\n<p>but this is probably an x/y problem as <code>lastRowSearchValue = i</code> does not return a range but a long:</p>\n\n<p>You want:</p>\n\n<pre><code>Set lastRowSearchValue = .Cells(i,33)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 0, "last_activity_date": 1547063535, "last_edit_date": 1547063535, "creation_date": 1547061465, "answer_id": 54116870, "question_id": 54116632, "link": "https://stackoverflow.com/questions/54116632/with-cellsrows-count-3-what-does-the-3-represent/54116870#54116870", "title": "With .Cells(Rows.Count, 3), what does the 3 represent?", "body": "<h1>Correcting Code</h1>\n\n<p><code>endRow</code> has to be declared as long because <code>.Rows.Count</code> exceeds the limit for <code>Integer</code>.\n33 is the column number, or Column <code>AG</code>. Your code searches for CATS in column <code>AG</code> starting from row 1 to the last row with data and when found it assigns the found row number to <code>lastRowSearchValue</code> which is incorrect because <code>lastRowSearchValue</code> is a range. Correct would be <code>Set lastRowSearchValue = .Cells(i, 33)</code> to be able to continue with <code>lastRowSearchValue.Copy</code>. It will continue searching until the end to find other occurrences of CATS. To stop this you can add the line <code>Exit For</code> to exit the loop when CATS was found. But since you do want to find the last occurrence, you don't wanna do that.</p>\n\n<p>I've chosen to declare lastRow as Long to get the last occurring row and then copy that row one row below. To make it less confusing, I have used the column letters.</p>\n\n<h2>The Code</h2>\n\n<pre><code>Sub CopyRowBelowWhenFound()\n\n    Dim shortname As String\n    Dim endRow As Long\n    Dim lastRow As Long\n    Dim i As Integer\n\n    shortname = \"CATS\"\n\n    With ActiveSheet\n        endRow = .Cells(.Rows.Count, \"AG\").End(xlUp).Row\n        For i = 1 To endRow\n            If .Cells(i, \"AG\") = shortname Then\n                lastRow = i\n            End If\n        Next i\n        With .Cells(lastRow, \"AG\")\n            .EntireRow.Copy .Offset(1, 0).EntireRow\n        End With\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1547063767, "post_id": 54117108, "comment_id": 95067450, "body": "lastRowSearchValue&amp;? LookIn is the third argument that is saved each time, although this will only fail if you have previously searched comments."}], "tags": [], "owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "is_accepted": false, "score": 0, "last_activity_date": 1547062436, "creation_date": 1547062436, "answer_id": 54117108, "question_id": 54116632, "link": "https://stackoverflow.com/questions/54116632/with-cellsrows-count-3-what-does-the-3-represent/54117108#54117108", "title": "With .Cells(Rows.Count, 3), what does the 3 represent?", "body": "<p>I assume you need cell rather row number. Anyway, the following code tries to find this cell:</p>\n\n<pre><code>Sub FFF()\n    Dim cell As Range, lastRowSearchValue&amp;\n    Set cell = Columns(33).Find(What:=\"CATS\", LookAt:=xlWhole, SearchDirection:=xlPrevious)\n    If Not cell Is Nothing Then\n        lastRowSearchValue = cell.Row\n    Else\n        MsgBox \"No value found\", vbExclamation\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5711863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31d5f655604c0b5b2c948e2f90ec9806?s=128&d=identicon&r=PG&f=1", "display_name": "drwonoski", "link": "https://stackoverflow.com/users/5711863/drwonoski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1508, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1547063535, "creation_date": 1547060368, "question_id": 54116632, "link": "https://stackoverflow.com/questions/54116632/with-cellsrows-count-3-what-does-the-3-represent", "title": "With .Cells(Rows.Count, 3), what does the 3 represent?", "body": "<p>I haven't been able to find an answer to what a single number represents here. I'm trying to find the row where the last occurrence of a string occurs, copy that entire row, and insert it below that row. To try and get the first part, where I can find the row value of the last occurrence, what does this \"3\" represent?</p>\n\n<pre><code>Dim shortname As String\nDim endRow As Integer\nDim lastRowSearchValue As Range\n\nshortname = \"CATS\"\n\nWith ActiveSheet\nendRow = .Cells(Rows.Count, 33).End(xlUp).Row\n    For i = 1 To endRow\n        If .Cells(i, 33) = shortname Then\n            lastRowSearchValue = i\n        End If\n    Next i\nEnd With\n\nlastRowSearchValue.Copy\n</code></pre>\n"}, {"tags": ["arrays", "vba", "sorting", "autocad"], "comments": [{"owner": {"reputation": 113, "user_id": 5410232, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vckO4.jpg?s=128&g=1", "display_name": "Weston E", "link": "https://stackoverflow.com/users/5410232/weston-e"}, "edited": false, "score": 0, "creation_date": 1547065268, "post_id": 54116495, "comment_id": 95068052, "body": "Does AutoCAD VBA require a multidimensional array?  If it supports user-defined types, that would make things easier."}, {"owner": {"reputation": 1, "user_id": 8537424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d8f9e8c53eabbeda9d6d7694a2ca3b8?s=128&d=identicon&r=PG&f=1", "display_name": "hardwiredstudios", "link": "https://stackoverflow.com/users/8537424/hardwiredstudios"}, "reply_to_user": {"reputation": 113, "user_id": 5410232, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vckO4.jpg?s=128&g=1", "display_name": "Weston E", "link": "https://stackoverflow.com/users/5410232/weston-e"}, "edited": false, "score": 0, "creation_date": 1547076832, "post_id": 54116495, "comment_id": 95072281, "body": "Oh yeah, of course. I forgot all about types. That will be neater code too. Thanks. I still need to get my head around how to group any same-size blocks though."}, {"owner": {"reputation": 113, "user_id": 5410232, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vckO4.jpg?s=128&g=1", "display_name": "Weston E", "link": "https://stackoverflow.com/users/5410232/weston-e"}, "edited": false, "score": 0, "creation_date": 1547128693, "post_id": 54116495, "comment_id": 95091611, "body": "Will AutoCAD VBA let you instantiate an Excel Application object?  If so, you could build a temporary worksheet and let Excel VBA do the sorting."}, {"owner": {"reputation": 1, "user_id": 8537424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d8f9e8c53eabbeda9d6d7694a2ca3b8?s=128&d=identicon&r=PG&f=1", "display_name": "hardwiredstudios", "link": "https://stackoverflow.com/users/8537424/hardwiredstudios"}, "reply_to_user": {"reputation": 113, "user_id": 5410232, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vckO4.jpg?s=128&g=1", "display_name": "Weston E", "link": "https://stackoverflow.com/users/5410232/weston-e"}, "edited": false, "score": 0, "creation_date": 1547129509, "post_id": 54116495, "comment_id": 95092118, "body": "Yeah it will and i was thinking of doing this but i thought excel couldn&#39;t sort things like this - i thought excel sorts the columns but the rows get screwed up as they&#39;re not exclusively tied? That&#39;s probably not the case but i don&#39;t know enough about it. Access would be good but means the user must have access installed."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8537424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d8f9e8c53eabbeda9d6d7694a2ca3b8?s=128&d=identicon&r=PG&f=1", "display_name": "hardwiredstudios", "link": "https://stackoverflow.com/users/8537424/hardwiredstudios"}, "edited": false, "score": 0, "creation_date": 1547321162, "post_id": 54131285, "comment_id": 95156034, "body": "Thanks for that code, that&#39;s awesome. Once i&#39;m back on that program i&#39;ll give it a go and see if i can get it sorted. thanks for all your help"}], "tags": [], "owner": {"reputation": 113, "user_id": 5410232, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vckO4.jpg?s=128&g=1", "display_name": "Weston E", "link": "https://stackoverflow.com/users/5410232/weston-e"}, "is_accepted": false, "score": 0, "last_activity_date": 1547132033, "creation_date": 1547132033, "answer_id": 54131285, "question_id": 54116495, "link": "https://stackoverflow.com/questions/54116495/vba-compare-elements-in-mutli-dimensional-array/54131285#54131285", "title": "VBA - compare elements in mutli-dimensional array", "body": "<p>Excel VBA lets you specify multiple sort keys (Sort.SortFields.Add) and also a sort range of any size (Sort.SetRange Range(\"A1:H200\")).</p>\n\n<p><a href=\"https://i.stack.imgur.com/NdMB8.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NdMB8.jpg\" alt=\"sample sort code\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 8537424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d8f9e8c53eabbeda9d6d7694a2ca3b8?s=128&d=identicon&r=PG&f=1", "display_name": "hardwiredstudios", "link": "https://stackoverflow.com/users/8537424/hardwiredstudios"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1547132033, "creation_date": 1547059681, "question_id": 54116495, "link": "https://stackoverflow.com/questions/54116495/vba-compare-elements-in-mutli-dimensional-array", "title": "VBA - compare elements in mutli-dimensional array", "body": "<p>In an AutoCAD VBA routine i have made, the program searches for dynamic blocks with a certain name and extracts some dynamic properties - width and height.</p>\n\n<p>What i have so far is a list of all the blocks and their properties but they are not sorted - if a block has the same width and height as another, it simply lists them individually. The block info is in the form of a multi-dimensional array, such as:</p>\n\n<p>PANEL(j, 0) = Panel_ref</p>\n\n<p>PANEL(j, 1) = width</p>\n\n<p>PANEL(j, 2) = height</p>\n\n<p><em>(j is just a counter within cycling through each block in the selection set.)</em></p>\n\n<p>What I would to do is be able to sort all these blocks into groups (not autocad groups) of the same size, so if there a few blocks that are 595x455 (width x height) for example, these should be grouped so that there are X number of them (say Panel_ref #1) and not individually tabled. I hope i'm being clear enough.</p>\n\n<p>So bascially, it would look like:</p>\n\n<p><em>Ref | Width | Height | Quantity</em></p>\n\n<p>1 | 600 | 800 | 3</p>\n\n<p>2 | 700 | 900 | 1</p>\n\n<p>3 | 650 | 1000 | 2</p>\n\n<p>instead of......</p>\n\n<p><em>Ref | Width | Height</em></p>\n\n<p>1 | 600 | 800</p>\n\n<p>2 | 600 | 800</p>\n\n<p>3 | 600 | 800</p>\n\n<p>4 | 700 | 900</p>\n\n<p>5 | 650 | 1000</p>\n\n<p>6 | 650 | 1000</p>\n\n<p>...as it is now. (sorry, i can't format this post any better)</p>\n\n<p>What is the best way to sort this data? I've seen array sorting code online but only for non multi-dim arrays.</p>\n\n<p>I guess i would need to cycle through the array, find the different \"sizes\" (width and height), store them somewhere and compare the each block to these? I was thinking of converting the width and height to a String (\"800 x 600\") as comparing these that way but i'm sure it can be done in their number (Double) format.</p>\n\n<p>If need be, i can post some code but thought it might be easier without for now.</p>\n\n<p>Thanks,</p>\n\n<p>Paul.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1547057270, "post_id": 54115845, "comment_id": 95064699, "body": "You have a few unqualified ranges, make sure you always give the sheet you expect the range to be on.  What line throws the error, the <code>.PasteSpecial</code> line?  Finally, what happens if <code>na</code> is <code>Nothing</code> ?  Add <code>Debug.Print na.Row</code> right before the <code>copy&#47;paste</code> lines and see what is output the second time. I&#39;m betting there&#39;s no row."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 2, "creation_date": 1547057362, "post_id": 54115845, "comment_id": 95064728, "body": "You need to code for the possibility of <code>na</code> &amp; <code>Aacts</code> not being found. <code>If Not na is Nothing Then....</code>. If your value is not found your paste line is actually being read as <code>Range(&quot;B&quot; &amp; Nothing + 2).Value = .....</code> and that&#39;s just nonsense. Def error worthy :P"}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1547057674, "post_id": 54115845, "comment_id": 95064872, "body": "&quot;&#39;Finds the cell with &#39;No_Account&#39; and names it id&quot;: Although I cannot see in the code where this is done, but if you have done it, it might be possible that you don&#39;t have any cells with &#39;No_Account&#39; anymore, which would mean &quot;na=Nothing&quot;."}, {"owner": {"reputation": 1, "user_id": 10891241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c28cb94421648e19e6ef0ca6a60a0479?s=128&d=identicon&r=PG&f=1", "display_name": "cpk24", "link": "https://stackoverflow.com/users/10891241/cpk24"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1547058203, "post_id": 54115845, "comment_id": 95065107, "body": "@urdearboy If I&#39;m understanding correctly, you are saying I need to add code in the case that &quot;No_Account&quot; and/or &quot;Accounts&quot; can&#39;t be found? That makes sense, but the entirety of the code relies on them being found; they should always be found in order to identify the row number I need later on in the code."}, {"owner": {"reputation": 1, "user_id": 10891241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c28cb94421648e19e6ef0ca6a60a0479?s=128&d=identicon&r=PG&f=1", "display_name": "cpk24", "link": "https://stackoverflow.com/users/10891241/cpk24"}, "reply_to_user": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1547058273, "post_id": 54115845, "comment_id": 95065142, "body": "@VBasic2008 Sorry, that is just a typo in the comment. &#39;id&#39; should actually read as &#39;na&#39;"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1547058536, "post_id": 54115845, "comment_id": 95065258, "body": "@cpk24. Right after you <code>Set na</code> try <code>Msgbox na</code> - if you get an error on the added line, then the issue is in fact that <code>na</code> is not being found. What you are saying only drives my point. If your code is dependent on these values being found, it follows that the code will have issues if they are <b>not</b> found."}, {"owner": {"reputation": 1, "user_id": 10891241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c28cb94421648e19e6ef0ca6a60a0479?s=128&d=identicon&r=PG&f=1", "display_name": "cpk24", "link": "https://stackoverflow.com/users/10891241/cpk24"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1547059055, "post_id": 54115845, "comment_id": 95065488, "body": "@urdearboy Okay, I added the message box and it looks like you are correct. The first time I ran it, I got a message box with the text &#39;No_Account&#39;. The second time I ran it, I got an error on the Msgbox na line of code. Do you know why this could be happening? Nothing is changing on the Org. worksheet in which I am using code to find the text &#39;No_Account&#39;. The words &#39;No_Account&#39; are still on the Org. worksheet."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1547060922, "post_id": 54115845, "comment_id": 95066279, "body": "You&#39;re looking for <code>No_Account</code> on worksheet <code>Org</code>, but then using the row number on sheet <code>Retail</code>.  What sheet does the <code>No_Account</code> exist on?"}, {"owner": {"reputation": 1, "user_id": 10891241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c28cb94421648e19e6ef0ca6a60a0479?s=128&d=identicon&r=PG&f=1", "display_name": "cpk24", "link": "https://stackoverflow.com/users/10891241/cpk24"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1547061140, "post_id": 54115845, "comment_id": 95066352, "body": "@tigeravatar When I am finding the cell it is only on the Org sheet. It then gets copy and pasted with the entirety of column A, to the Retail sheet. It&#39;s location remains the same on both sheets. But yes I am aware that I am finding it on the Org sheet and then using that row number on the Retail sheet."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1547062478, "post_id": 54115845, "comment_id": 95066906, "body": "You have a unqualified <code>ClearContents</code> in your code. After you run the code once, can you verify the values in question actually still exist or are you just assuming?"}, {"owner": {"reputation": 1, "user_id": 10891241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c28cb94421648e19e6ef0ca6a60a0479?s=128&d=identicon&r=PG&f=1", "display_name": "cpk24", "link": "https://stackoverflow.com/users/10891241/cpk24"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1547064067, "post_id": 54115845, "comment_id": 95067570, "body": "I can verify that the value &quot;No_Account&quot; does in fact still exist on the Org worksheet after running the code once @urdearboy"}], "owner": {"reputation": 1, "user_id": 10891241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c28cb94421648e19e6ef0ca6a60a0479?s=128&d=identicon&r=PG&f=1", "display_name": "cpk24", "link": "https://stackoverflow.com/users/10891241/cpk24"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1547056668, "creation_date": 1547056566, "last_edit_date": 1547056668, "question_id": 54115845, "link": "https://stackoverflow.com/questions/54115845/vba-code-breaks-after-first-run-error-91", "title": "VBA code breaks after first run - Error 91", "body": "<p>I am trying to semi-automate a file by using code to insert/copy/paste values and formulas. When I run this code once, it works fine. Trying to run the code any subsequent time results in a \"run-time error '91'.\" Debugging the error highlights the code in which I try to use the phrase 'na.Row' to recall the row number identified earlier in the code.</p>\n\n<p>Note: I am extremely new to VBA and have no prior coding background; I'm sure it could be much more clean and concise.</p>\n\n<pre><code>Sub AdvtoStd_Click()\n\n'Names the Worksheets\n\n    Dim ws As Worksheet\n    Set ws = Worksheets(\"Org\")\n\n    Dim ar As Worksheet\n    Set ar = Worksheets(\"Adv. Retrieve\")\n\n    Dim sr As Worksheet\n    Set sr = Worksheets(\"Std. Retrieve\")\n\n\n'Finds the cell with 'No_Account' and names it id\n\n    Dim na As Range\n    Set na = ws.Range(\"A:A\").Find(\"No_Account\", LookIn:=xlValues)\n\n    Dim Aacts As Range\n    Set Aacts = ar.Range(\"A:A\").Find(\"Accounts\", LookIn:=xlValues, LookAt:=xlWhole)\n\n\n'Clears the old numbers on the Retail worksheet\n\n    Worksheets(\"Retail\").Activate\n    Range(\"A4:E2000\").ClearContents\n\n'Copies the accounts from the Org to Retail worksheet\n\n    ws.Range(\"A4:A2000\").Copy\n    Sheets(\"Retail\").Range(\"A4:A2000\").PasteSpecial xlPasteValues\n\n'Inserts the VLookup into cells B4 and C4 + Inserts the Variance calculation in cell E4\n'Copies the VLookup and Variance calculation down to 'No_Account'\n\n    Sheets(\"Retail\").Range(\"B4\").Value = \"=VLOOKUP(A4,'Adv. Retrieve'!A:I,3,FALSE)\"\n    Sheets(\"Retail\").Range(\"C4\").Value = \"=VLOOKUP(A4,'Std. Retrieve'!A:I,3,FALSE)\"\n    Sheets(\"Retail\").Range(\"E4\").Value = \"=C4-B4\"\n    Sheets(\"Retail\").Range(\"B4:E4\").Copy\n    Sheets(\"Retail\").Range(\"B5\", Sheets(\"Retail\").Range(\"E\" &amp; na.Row)).PasteSpecial xlPasteFormulas\n\n'Calculates the TOTALs\n\n    Sheets(\"Retail\").Range(\"B\" &amp; na.Row + 2).Value = \"=SUM(OFFSET(B1,,,ROW()-1,1))\"\n    Sheets(\"Retail\").Range(\"C\" &amp; na.Row + 2).Value = \"=SUM(OFFSET(C1,,,ROW()-1,1))\"\n\n'Copies the Hyperion values\n\n    ar.Range(\"B\" &amp; Aacts.Row).Copy\n    Sheets(\"Retail\").Range(\"B\" &amp; na.Row + 3).PasteSpecial xlPasteValues\n</code></pre>\n\n<p>The error occurs in the part of the code in which I am trying to paste formulas in columns <code>B:E</code> down to the row number in which Account Names end in column <code>A</code>.</p>\n\n<p>Like I mentioned earlier, the code works exactly as desired when I open the file and run it once, but any secondary attempt to run the code produces the error '91'.</p>\n"}, {"tags": ["excel", "vba", "export-to-csv", "savefiledialog"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1547053368, "post_id": 54114962, "comment_id": 95062811, "body": "What I don&#39;t understand is that you copy a <i>Worksheet</i> and then later close the <i>Workbook</i>.  Now there is no workbook anymore to work with and the macro will stop: your Sheet2 part will not run. And you say it works?"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1547053595, "post_id": 54114962, "comment_id": 95062944, "body": "I also notice that (even if it would run) that after the copy, you have another worksheet in your workbook named &quot;Sheet x (2)&quot; and you don&#39;t delete that sheet (you save it, but that doesn&#39;t remove it). Now <code>Worksheets.Count</code> is incremented so you loop at least once more. The new sheet matches your <code>InStr</code> criterium and so the process repeats again and again. It repeats infinitely."}], "answers": [{"tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 1, "last_activity_date": 1547054146, "creation_date": 1547054146, "answer_id": 54115264, "question_id": 54114962, "link": "https://stackoverflow.com/questions/54114962/vba-script-to-export-sheets-as-csv-files-to-a-specific-location-after-deleting-r/54115264#54115264", "title": "VBA script to export sheets as CSV files to a specific location after deleting rows that are blank or &quot;blank&quot; but contain formula", "body": "<p>I think something like this is what you're looking for:</p>\n\n<pre><code>Sub createCSVfiles()\n\n    'Declare and set variables\n    Dim wb As Workbook\n    Dim ws As Worksheet\n    Dim wsTemp As Worksheet\n    Dim aSheets() As Variant\n    Dim vSheet As Variant\n    Dim sFilePath As String\n    Dim sNewFileName As String\n    Dim oShell As Object\n    Dim i As Long\n\n    'Select folder to save CSV files to\n    Set oShell = CreateObject(\"Shell.Application\")\n    On Error Resume Next\n    sFilePath = oShell.BrowseForFolder(0, \"Select folder to save csv files\", 0).Self.Path &amp; Application.PathSeparator\n    On Error GoTo 0\n    If Len(sFilePath) = 0 Then Exit Sub 'Pressed cancel\n\n    'Define sheet names here\n    aSheets = Array(\"Sheet1\", \"Sheet2\")\n\n    With Application\n        .Calculation = xlCalculationManual\n        .EnableEvents = False\n        .ScreenUpdating = False\n        .DisplayAlerts = False\n    End With\n\n    Set wb = ThisWorkbook\n\n    'Cycle through sheets\n    For Each vSheet In aSheets\n        'Test if sheet exists\n        Set ws = Nothing\n        On Error Resume Next\n        Set ws = wb.Sheets(vSheet)\n        On Error GoTo 0\n        If Not ws Is Nothing Then\n            'Sheet exists\n            ws.Copy\n            Set wsTemp = ActiveSheet\n\n            'Remove rows with blanks in column A\n            With wsTemp.Range(\"A1\", wsTemp.Cells(wsTemp.Rows.Count, \"A\").End(xlUp))\n                .AutoFilter 1, \"=\", xlFilterValues\n                .Offset(1).EntireRow.Delete\n                .AutoFilter\n            End With\n\n            'Save and close\n            wsTemp.Parent.SaveAs sFilePath &amp; wsTemp.Name &amp; \".csv\", xlCSV\n            wsTemp.Parent.Close False\n        End If\n    Next vSheet\n\n    'Clean\n    With Application\n        .Calculation = xlCalculationAutomatic\n        .EnableEvents = True\n        .ScreenUpdating = True\n        .DisplayAlerts = True\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5487125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23f7b0a3443a2184073d6a594d2c3f91?s=128&d=identicon&r=PG&f=1", "display_name": "James Paterson", "link": "https://stackoverflow.com/users/5487125/james-paterson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "accepted_answer_id": 54115264, "answer_count": 1, "score": 0, "last_activity_date": 1547054146, "creation_date": 1547052940, "question_id": 54114962, "link": "https://stackoverflow.com/questions/54114962/vba-script-to-export-sheets-as-csv-files-to-a-specific-location-after-deleting-r", "title": "VBA script to export sheets as CSV files to a specific location after deleting rows that are blank or &quot;blank&quot; but contain formula", "body": "<p>I am working on a VBA script to allow manipulation and export of a number of worksheets as csv files from an Excel workbook. I'd like to be able to export a list of specified sheets as csv files to a save location that is able to be selected, in addition any cell in a specific column that is blank but may contain a formula needs to be have the entire row deleted. The below script is what I currently have and it seems to work to a point but there are three main issues:</p>\n\n<ol>\n<li><p>The line below will remove lines if the cell in column A is really blank i.e contains no formula, but does not work if formula is present:                  <code>Columns(\"A\").SpecialCells(xlCellTypeBlanks).EntireRow.Delete</code> </p></li>\n<li><p>The cycling through the sheets is untidy but functional, is there a way to use a list of named sheets to make the script more concise?</p></li>\n<li><p>Ideally the save location would also be selectable from a choose file directory dialog box. Any suggestions on how to achieve this?</p></li>\n</ol>\n\n<p>Many thanks in advance.</p>\n\n<pre><code>Sub createCSVfiles()\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\n\n'Declare and set variables\nDim wb1 As Workbook, ws1 As Worksheet\nDim wbname As String, i As Integer\nSet wb1 = ThisWorkbook\n\n'Cycle through sheets\nFor i = 1 To Worksheets.Count\n    wbname = Worksheets(i).Name\n\n'Create Sheet1.csv\n  If InStr(1, (Worksheets(i).Name), \"Sheet1\", vbTextCompare) &gt; 0 Then\n       Worksheets(i).Copy\n       Columns(\"A\").SpecialCells(xlCellTypeBlanks).EntireRow.Delete\n       ActiveWorkbook.SaveAs Filename:=\"C:\\Users\\forename.surname\\Desktop\\export\\\" &amp; ActiveSheet.Name &amp; \".csv\", _\n       FileFormat:=xlCSV, CreateBackup:=False\n       ActiveWorkbook.Close\n      wb1.Activate\nEnd If\n\n'Create Sheet2.csv\nIf InStr(1, (Worksheets(i).Name), \"Sheet2\", vbTextCompare) &gt; 0 Then\n    Worksheets(i).Copy\n    ActiveWorkbook.SaveAs Filename:=\"C:\\Users\\forename.surname\\Desktop\\export\\\" &amp; ActiveSheet.Name &amp; \".csv\", _\n    FileFormat:=xlCSV, CreateBackup:=False\n    ActiveWorkbook.Close\n    wb.Activate\nEnd If\n\nNext i\n\n'Clean\nApplication.DisplayAlerts = True\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 20243, "user_id": 633098, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/73ed4ada98edd7d2b842ee5ddc24bf86?s=128&d=identicon&r=PG", "display_name": "silkfire", "link": "https://stackoverflow.com/users/633098/silkfire"}, "edited": false, "score": 1, "creation_date": 1547050886, "post_id": 54114272, "comment_id": 95061288, "body": "C# and Visual Studio has <i>nothing</i> to do with VBA."}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 3, "creation_date": 1547050905, "post_id": 54114272, "comment_id": 95061298, "body": "The adds are using integer math (I.e. adding integers <i>before</i> assigning to the long), avoid this by casting one of the values to long: <code>L = 2696&amp; + 2630 + ...</code>"}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1547051020, "post_id": 54114272, "comment_id": 95061363, "body": "Note that in VB.Net an int is 32 bits unlike VBA/6 where they are 16 bits."}, {"owner": {"reputation": 29, "user_id": 6381427, "user_type": "registered", "profile_image": "https://graph.facebook.com/990315537684585/picture?type=large", "display_name": "Brian Battles", "link": "https://stackoverflow.com/users/6381427/brian-battles"}, "edited": false, "score": 0, "creation_date": 1547051340, "post_id": 54114272, "comment_id": 95061565, "body": "Wondering if this is documented anywhere"}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 1, "creation_date": 1547052113, "post_id": 54114272, "comment_id": 95062075, "body": "Well any whole number literal &lt; 32768 is of type integer so when you add such numbers the result is going to need to also fit into an integer.  Not sure if that&#39;s documented anywhere, the types for literals are defined here: <a href=\"https://msdn.microsoft.com/en-us/library/ee199514.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/ee199514.aspx</a>"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1547052956, "post_id": 54114272, "comment_id": 95062551, "body": "An <i>Overflow Error</i> is something else than a <i>Line too long</i> error. The first means a result doesn&#39;t fit the left-hand variable, the second would be caught already <i>before</i> the code actually runs by the interpreter."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 6381427, "user_type": "registered", "profile_image": "https://graph.facebook.com/990315537684585/picture?type=large", "display_name": "Brian Battles", "link": "https://stackoverflow.com/users/6381427/brian-battles"}, "edited": false, "score": 0, "creation_date": 1547058032, "post_id": 54114997, "comment_id": 95065015, "body": "Interesting, I never realized VB was interpreting each number as an integer first, then trying to store them as a Long. Makes sense.  I do remember reading somewhere, a long time ago, there there&#39;s no longer any sense using regular integers in VB because the Intel CPU&#39;s internal guts always have to convert 16-bit integers to 32-bit long integers to do math anyway, so declare them as Integer instead of Long is actually not worth bothering. So I&#39;ve always declared all integers as Long since then."}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "reply_to_user": {"reputation": 29, "user_id": 6381427, "user_type": "registered", "profile_image": "https://graph.facebook.com/990315537684585/picture?type=large", "display_name": "Brian Battles", "link": "https://stackoverflow.com/users/6381427/brian-battles"}, "edited": false, "score": 0, "creation_date": 1547058909, "post_id": 54114997, "comment_id": 95065431, "body": "@BrianBattles I have updated answer with other details. But I wonder what is the use case of such addition? :)"}, {"owner": {"reputation": 29, "user_id": 6381427, "user_type": "registered", "profile_image": "https://graph.facebook.com/990315537684585/picture?type=large", "display_name": "Brian Battles", "link": "https://stackoverflow.com/users/6381427/brian-battles"}, "edited": false, "score": 0, "creation_date": 1547126735, "post_id": 54114997, "comment_id": 95090466, "body": "Hi Johny...  I dunno, I just found it leftover in some legacy code in an MS Access app where I work and wonder why it threw that error"}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "reply_to_user": {"reputation": 29, "user_id": 6381427, "user_type": "registered", "profile_image": "https://graph.facebook.com/990315537684585/picture?type=large", "display_name": "Brian Battles", "link": "https://stackoverflow.com/users/6381427/brian-battles"}, "edited": false, "score": 0, "creation_date": 1547133139, "post_id": 54114997, "comment_id": 95094478, "body": "@BrianBattles I see \ud83d\ude09"}], "tags": [], "owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "is_accepted": false, "score": 2, "last_activity_date": 1547058878, "last_edit_date": 1547058878, "creation_date": 1547053098, "answer_id": 54114997, "question_id": 54114272, "link": "https://stackoverflow.com/questions/54114272/maximum-length-of-addition-line-in-vba/54114997#54114997", "title": "Maximum length of addition line in VBA", "body": "<p>You need to use type literal:</p>\n\n<pre><code>Sub FFF()\n\n    Dim L As Long\n    Dim V As Variant\n\n    ' this works\n    L = 2696 + 2630 + 2860 + 2860 + 2860 + 2860 + 2795 + 2795 + 2630 + 2630 + 2630 + 263\n\n    ' this DOES NOT give an Overflow error\n    V = 2696&amp; + 2630&amp; + 2860&amp; + 2860&amp; + 2860&amp; + 2860&amp; + _\n        2795&amp; + 2795&amp; + 2630&amp; + 2630&amp; + 2630&amp; + 2630&amp;\n\n    MsgBox TypeName(V) '//Long\n\nEnd Sub\n</code></pre>\n\n<p><strong>UPDATE</strong></p>\n\n<p>It's interesting to note that if you declare your sum variable as <code>Variant</code>, then conversion to <code>Long</code> is done automatically. For instance, in the following code <code>sum</code> variable is <code>Integer</code> <em>before</em> the last addition - after that it has <code>Long</code> type:</p>\n\n<pre><code>Sub SSS()\n\n    Dim sum As Variant, arr As Variant, num As Variant\n\n    arr = Array(2696, 2630, 2860, 2860, 2860, 2860, _\n                2795, 2795, 2630, 2630, 2630, 2630)\n\n    For Each num In arr\n        '// sum is Integer before last addition\n        '// and Long - after it\n        sum = sum + num\n    Next\n\n    MsgBox TypeName(sum) '//Long\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "is_accepted": false, "score": 2, "last_activity_date": 1547053424, "creation_date": 1547053424, "answer_id": 54115087, "question_id": 54114272, "link": "https://stackoverflow.com/questions/54114272/maximum-length-of-addition-line-in-vba/54115087#54115087", "title": "Maximum length of addition line in VBA", "body": "<p>You need to specify the type of one of the elements in the expression, VBA should then use that type. I think literal whole numbers are implicitly Integers (16 bit), could be wrong.</p>\n\n<p>So something like this</p>\n\n<pre><code>Dim L As Long\nL = 2696&amp; + 2630 + 2860 + 2860 + 2860 + 2860 + 2795 + 2795 + 2630 + 2630 + 2630 + 2630\nDebug.Print L, TypeName(L)\n</code></pre>\n\n<p>Or this would work</p>\n\n<pre><code>Dim L As Long\nL = CLng(2696) + 2630 + 2860 + 2860 + 2860 + 2860 + 2795 + 2795 + 2630 + 2630 + 2630 + 2630\nDebug.Print L, TypeName(L)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "is_accepted": true, "score": 5, "last_activity_date": 1547054450, "creation_date": 1547054450, "answer_id": 54115338, "question_id": 54114272, "link": "https://stackoverflow.com/questions/54114272/maximum-length-of-addition-line-in-vba/54115338#54115338", "title": "Maximum length of addition line in VBA", "body": "<p>The <a href=\"https://msdn.microsoft.com/en-us/library/ee199514.aspx\" rel=\"noreferrer\">type of an integer literal</a> is an <code>Integer</code> (Max +32767):</p>\n\n<pre><code>?typename(2696)\nInteger\n</code></pre>\n\n<p>The result of adding <em>n</em> <code>Integer</code>s is also of type <code>Integer</code>:</p>\n\n<pre><code>?typename(2696 + 2630)\nInteger\n</code></pre>\n\n<p>As soon as the accumulation exceeds the bounds of an <code>Integer</code> you will get an Overflow exception, it does not matter that the variable you are assigning to is a <code>Long</code> because the accumulation is performed before the assignment.</p>\n\n<p>The way to fix this is to make one of the values in the addition a <code>Long</code> which you can easily do with the <code>&amp;</code> Type Suffix:</p>\n\n<pre><code>L = 2696&amp; + 2630 + ..\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 6381427, "user_type": "registered", "profile_image": "https://graph.facebook.com/990315537684585/picture?type=large", "display_name": "Brian Battles", "link": "https://stackoverflow.com/users/6381427/brian-battles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 54115338, "answer_count": 3, "score": 3, "last_activity_date": 1594619573, "creation_date": 1547050688, "last_edit_date": 1594619573, "question_id": 54114272, "link": "https://stackoverflow.com/questions/54114272/maximum-length-of-addition-line-in-vba", "title": "Maximum length of addition line in VBA", "body": "<p>Is there a maximum length of a line when adding numbers in VBA? For example in MS Access:</p>\n\n<pre><code> Dim L As Long\n\n    ' this works\n    L = 2696 + 2630 + 2860 + 2860 + 2860 + 2860 + 2795 + 2795 + 2630 + 2630 + 2630 + 263\n\n    ' this gives an Overflow error\n    L = 2696 + 2630 + 2860 + 2860 + 2860 + 2860 + 2795 + 2795 + 2630 + 2630 + 2630 + 2630\n\n    Debug.Print L\n</code></pre>\n\n<p>I have never seen this documented. Also, it doesn't throw an overflow error in C# in Visual Studio.</p>\n"}, {"tags": ["vba", "web-scraping", "drop-down-menu"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10890792, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214987079844508/picture?type=large", "display_name": "Abdullah Orhan", "link": "https://stackoverflow.com/users/10890792/abdullah-orhan"}, "edited": false, "score": 0, "creation_date": 1547058598, "post_id": 54116010, "comment_id": 95065295, "body": "my friend thanks for your comment but \u0131 have been learing vba just few days and your comment is so hard to understand for me :( so \u0131 guess \u0131 should learn vba-json language"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 3, "user_id": 10890792, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214987079844508/picture?type=large", "display_name": "Abdullah Orhan", "link": "https://stackoverflow.com/users/10890792/abdullah-orhan"}, "edited": false, "score": 0, "creation_date": 1547058670, "post_id": 54116010, "comment_id": 95065324, "body": "Yes. But if you later have specific questions on the code please ask."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 3, "user_id": 10890792, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214987079844508/picture?type=large", "display_name": "Abdullah Orhan", "link": "https://stackoverflow.com/users/10890792/abdullah-orhan"}, "edited": false, "score": 0, "creation_date": 1547064057, "post_id": 54116010, "comment_id": 95067563, "body": "Yes. As I show above. It is written in vba. It requires a little understanding of xmlhttp and Json. In Json [] denotes a collection you For Each over and {} is a dictionary you loop the keys of."}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 1, "creation_date": 1547076684, "post_id": 54116010, "comment_id": 95072249, "body": "I think I&#39;ve used that same JSON Parser before :D. Still, parsing JSON in VBA is not  a fun task"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1547077210, "post_id": 54116010, "comment_id": 95072360, "body": "@K.D\u1d00\u1d20\u026as  that\u2019s how I feel about Json and python at present. I think I must have missed a trick somewhere."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1547068181, "last_edit_date": 1547068181, "creation_date": 1547057289, "answer_id": 54116010, "question_id": 54114240, "link": "https://stackoverflow.com/questions/54114240/select-from-drop-down-list-in-internet-page/54116010#54116010", "title": "Select from Drop down list in Internet Page", "body": "<p>You can avoid opening a browser and use a faster method. That pages constructs a querystring which it uses in <a href=\"https://codingislove.com/http-requests-excel-vba/\" rel=\"nofollow noreferrer\">xhr requests</a> to update the table values. The response is json you can parse. For example with the left and right drop downs set as follows you can view the xhr in the network tab</p>\n\n<p><a href=\"https://i.stack.imgur.com/U6Sz9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/U6Sz9.png\" alt=\"enter image description here\"></a></p>\n\n<p>Example of the query string parameters:</p>\n\n<p><a href=\"https://i.stack.imgur.com/UVQSo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UVQSo.png\" alt=\"enter image description here\"></a></p>\n\n<p>The left dropdown generates:</p>\n\n<p><a href=\"https://www.isyatirim.com.tr/_layouts/15/IsYatirim.Website/Common/Data.aspx/MaliTabloShortTable?companyCode=EGEEN&amp;exchange=TRY&amp;year1=2018&amp;period1=6&amp;_=1547055336791\" rel=\"nofollow noreferrer\">https://www.isyatirim.com.tr/<em>layouts/15/IsYatirim.Website/Common/Data.aspx/MaliTabloShortTable?companyCode=EGEEN&amp;exchange=TRY&amp;year1=2018&amp;period1=6&amp;</em>=1547055336791</a></p>\n\n<p>The right generates:</p>\n\n<p><a href=\"https://www.isyatirim.com.tr/_layouts/15/IsYatirim.Website/Common/Data.aspx/MaliTabloShortTable?companyCode=EGEEN&amp;exchange=TRY&amp;year1=2018&amp;period1=3&amp;_=1547055336792\" rel=\"nofollow noreferrer\">https://www.isyatirim.com.tr/<em>layouts/15/IsYatirim.Website/Common/Data.aspx/MaliTabloShortTable?companyCode=EGEEN&amp;exchange=TRY&amp;year1=2018&amp;period1=3&amp;</em>=1547055336792</a></p>\n\n<p>Note that the currency is defined by (<code>mn $</code> versus <code>mn TL</code>):</p>\n\n<p><code>exchange: USD</code>  or <code>exchange=TRY</code></p>\n\n<p>Using <a href=\"https://github.com/VBA-tools/VBA-JSON/blob/master/JsonConverter.bas\" rel=\"nofollow noreferrer\">JSONConverter.bas</a> to parse the json, and adding the .bas to the project as well as reference via vbe > tools > references > <code>Microsoft Scripting Runtime</code>, you can parse out the values from the JSON. A reference to <code>Microsoft HTML Object Library</code> is also required.</p>\n\n<p>E.g. <strong>json response</strong> for first url</p>\n\n<p><img src=\"https://i.stack.imgur.com/mynoP.png\" width=\"200\"></p>\n\n<hr>\n\n<p><strong>VBA:</strong></p>\n\n<pre><code>Option Explicit   \nPublic Sub GetInfo()\n    Dim html As HTMLDocument, col As Collection\n    Set html = New HTMLDocument: Set col = New Collection\n    With CreateObject(\"MSXML2.XMLHTTP\")\n        .Open \"GET\", \"https://www.isyatirim.com.tr/_layouts/15/IsYatirim.Website/Common/Data.aspx/MaliTabloShortTable?companyCode=EGEEN&amp;exchange=TRY&amp;year1=2018&amp;period1=6&amp;_=1547055336791\", False\n        .send\n         col.Add JsonConverter.ParseJson(.responseText)(\"value\")\n        .Open \"GET\", \"https://www.isyatirim.com.tr/_layouts/15/IsYatirim.Website/Common/Data.aspx/MaliTabloShortTable?companyCode=EGEEN&amp;exchange=TRY&amp;year1=2018&amp;period1=3&amp;_=1547055336792\", False\n        .send\n        col.Add JsonConverter.ParseJson(.responseText)(\"value\")\n    End With\n    EmptyDict col\nEnd Sub\n\nPublic Sub EmptyDict(ByVal col As Object)\n    Dim item As Object, item2 As Object\n    For Each item In col\n       For Each item2 In item\n        Debug.Print item2(\"KT_TANIMI\"), item2(\"value1\")\n       Next\n    Next\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Output:</p>\n\n<p><img src=\"https://i.stack.imgur.com/pNzDd.png\" width=\"300\"></p>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 10890792, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214987079844508/picture?type=large", "display_name": "Abdullah Orhan", "link": "https://stackoverflow.com/users/10890792/abdullah-orhan"}, "is_accepted": false, "score": 0, "last_activity_date": 1547256529, "creation_date": 1547256529, "answer_id": 54156029, "question_id": 54114240, "link": "https://stackoverflow.com/questions/54114240/select-from-drop-down-list-in-internet-page/54156029#54156029", "title": "Select from Drop down list in Internet Page", "body": "<p>\u0131 did it with `</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Set HTMLdoc = ie.document\r\n    Set evtChange = HTMLdoc.createEvent(\"HTMLEvents\")\r\n    evtChange.initEvent \"change\", True, False\r\n    Set selectElement = HTMLdoc.getElementById(\"ddlMaliTabloDonem1\")\r\n     selectElement.Value = Range(\"B2\")\r\n     selectElement.dispatchEvent evtChange`</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>its working now but now there is a another problem :D</p>\n\n<p>\u0131 wanna take data \"amortisman giderleri\" but \u0131 dont know how can \u0131 take data from td(witout java pls :D)</p>\n\n<p><a href=\"https://hizliresim.com/nQEN6a\" rel=\"nofollow noreferrer\">https://hizliresim.com/nQEN6a</a></p>\n"}, {"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1547352368, "post_id": 54159295, "comment_id": 95161590, "body": "This appears to be an answer to a new question rather than an answer to your existing posted question"}], "tags": [], "owner": {"reputation": 3, "user_id": 10890792, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214987079844508/picture?type=large", "display_name": "Abdullah Orhan", "link": "https://stackoverflow.com/users/10890792/abdullah-orhan"}, "is_accepted": true, "score": 0, "last_activity_date": 1547293783, "creation_date": 1547293783, "answer_id": 54159295, "question_id": 54114240, "link": "https://stackoverflow.com/questions/54114240/select-from-drop-down-list-in-internet-page/54159295#54159295", "title": "Select from Drop down list in Internet Page", "body": "<p>it works </p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>For i = 0 To ie.document.getElementsByTagName(\"td\").Length - 1\r\nIf ie.document.getElementsByTagName(\"td\")(i).innerText = \"Amortisman Giderleri\" Then\r\nresult = ie.document.getElementsByTagName(\"td\")(i + 1).innerText\r\nRange(\"B11\").Value = result\r\nEnd If\r\nNext i</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}], "owner": {"reputation": 3, "user_id": 10890792, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214987079844508/picture?type=large", "display_name": "Abdullah Orhan", "link": "https://stackoverflow.com/users/10890792/abdullah-orhan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "accepted_answer_id": 54159295, "answer_count": 3, "score": -1, "last_activity_date": 1547293783, "creation_date": 1547050575, "last_edit_date": 1547057766, "question_id": 54114240, "link": "https://stackoverflow.com/questions/54114240/select-from-drop-down-list-in-internet-page", "title": "Select from Drop down list in Internet Page", "body": "<p>\u0131 am new vba and here. I am working on stocks and \u0131 need your helps.\nso firstly as you can see on tittle, \u0131 want to choose automaticly in down list what i write on my excel. So \u0131 need amortization information from this web site <a href=\"https://www.isyatirim.com.tr/tr-tr/analiz/hisse/Sayfalar/sirket-karti.aspx?hisse=EGEEN\" rel=\"nofollow noreferrer\">website</a> in \"MAL\u0130 TABLOLAR\"page amortization in turkish is amortisman and it is the end of the page.The cods that \u0131 write working halfway\n\u0131 can go just \"mali tablolar\" page and \u0131 cant choose date from down list.</p>\n\n<pre><code>Sub D\u00fc\u011fme2_T\u0131kla()\nsirketismi = Range(\"A2\")\n</code></pre>\n\n<p>Dim ie As New InternetExplorer\n    ie.Visible = True\n    ie.navigate (\"<a href=\"https://www.isyatirim.com.tr/tr-tr/analiz/hisse/Sayfalar/sirket-karti.aspx?hisse=\" rel=\"nofollow noreferrer\">https://www.isyatirim.com.tr/tr-tr/analiz/hisse/Sayfalar/sirket-karti.aspx?hisse=</a>\" &amp; sirketismi)</p>\n\n<pre><code>Do\nDoEvents\nLoop Until ie.readyState = READYSTATE_COMPLETE\n\nDim doc As HTMLDocument\nSet doc = ie.document\n\nDo Until Not ie.Busy\nDoEvents\nLoop\nie.document.all(\"page-4\").Click\nDo\nDoEvents\nLoop Until ie.readyState = READYSTATE_COMPLETE\n\n\n\n\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/KURRp.png\" rel=\"nofollow noreferrer\">html code image</a>\n <a href=\"https://drive.google.com/open?id=1nL9AZ7anhytz0vyMh8tObVkXVImof9xJ\" rel=\"nofollow noreferrer\">my excel link</a></p>\n\n<p>in epitome, i will write to a2 cell and this macro will take amortization info with correct date.\nSorry for bad english.\nI hope you understand me\nthanks for helps</p>\n"}, {"tags": ["excel", "vba", "interpolation", "linear-interpolation"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 5, "creation_date": 1547050992, "post_id": 54114190, "comment_id": 95061345, "body": "This <a href=\"https://stackoverflow.com/questions/53554615/interpolate-missing-data/53555197#53555197\">Interpolate missing Data</a> might give you an idea (actually the answer does a linear regression to interpolate the missing data). It is a similar (or even duplicate) question."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1547053305, "post_id": 54114190, "comment_id": 95062781, "body": "You can also look into <code>Forecast.Ets</code> function which has various options on how to deal with missing data points in a series. @P\u1d07\u029c, awesome solution tho! +1 for proper self promotion ;)"}, {"owner": {"reputation": 155, "user_id": 9901759, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216039690767111/picture?type=large", "display_name": "Yavuz Topal", "link": "https://stackoverflow.com/users/9901759/yavuz-topal"}, "edited": false, "score": 0, "creation_date": 1547069043, "post_id": 54114190, "comment_id": 95069657, "body": "Hi Peh, thanks for the quick reply. In fact, I have got two rows of data x=timeseries going from 1 day to 10 Years (discontinuously) and the corresponding variables y=interest rates. If one interest rate is missing, lets say at 6Months that rate would need to be interpolated by take one data point to the right (which is 3Months) and to the left (which is 12 Months) of the missing data. Can your provided example be used for that case as well, when you have two dependent variables? Thanx"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1547106156, "post_id": 54114190, "comment_id": 95079282, "body": "@YavuzTopal It&#39;s the same approach. My example uses <i>all</i> given data points to emulate the missing ones. If you want only the ones <i>left</i> and <i>right</i> just use only these 2 points to calculate slope and intersect."}, {"owner": {"reputation": 155, "user_id": 9901759, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216039690767111/picture?type=large", "display_name": "Yavuz Topal", "link": "https://stackoverflow.com/users/9901759/yavuz-topal"}, "edited": false, "score": 0, "creation_date": 1547111557, "post_id": 54114190, "comment_id": 95081862, "body": "you are right. my mistake. I have just seen it. Thank you for the advice. Shall I delete my post as it appears to be a duplicate?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 3, "creation_date": 1547113963, "post_id": 54114190, "comment_id": 95083254, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/53554615/interpolate-missing-data\">Interpolate missing Data</a>"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1547114005, "post_id": 54114190, "comment_id": 95083283, "body": "@YavuzTopal I started close-voting as duplicate. So the question remains but will be marked as a duplicate."}, {"owner": {"reputation": 155, "user_id": 9901759, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216039690767111/picture?type=large", "display_name": "Yavuz Topal", "link": "https://stackoverflow.com/users/9901759/yavuz-topal"}, "edited": false, "score": 0, "creation_date": 1547121632, "post_id": 54114190, "comment_id": 95087686, "body": "@Peh, Thank you. Could you quick tell me what factor in your code needs to be modified as to consider not the entire code but only the right and the left values to the blank?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1547123616, "post_id": 54114190, "comment_id": 95088748, "body": "find the cell/range with missing data eg <code>MyMissing</code>  and then expand it to the left and right <code>MyMissing.Offset(ColumnOffset:=-1).Resize(ColumnResize:=MyMi&zwnj;&#8203;ssing.Columns.Count + 2)</code> and use it instead of the original data points <code>DataRange.Rows(iRow)</code>. Instead of generating x values <code>ArrX</code> you should use the x values of your data (if you have)."}, {"owner": {"reputation": 155, "user_id": 9901759, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216039690767111/picture?type=large", "display_name": "Yavuz Topal", "link": "https://stackoverflow.com/users/9901759/yavuz-topal"}, "edited": false, "score": 0, "creation_date": 1547139008, "post_id": 54114190, "comment_id": 95098129, "body": "@Peh. I have posted an edited version of my code above and tried to implement the interpolation method &#39;y=y1 + (y2 \u2013 y1) * (x \u2013 x1) / (x2 \u2013 x1) with y being the missing component. I just doubt that it is will work I am sure there is something missing."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1547203115, "post_id": 54114190, "comment_id": 95120813, "body": "@YavuzTopal can you provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> with full example data. And a screenshot of your sheet (including some sentences of description) would also help a lot to understand what you are trying to do."}, {"owner": {"reputation": 155, "user_id": 9901759, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216039690767111/picture?type=large", "display_name": "Yavuz Topal", "link": "https://stackoverflow.com/users/9901759/yavuz-topal"}, "edited": false, "score": 1, "creation_date": 1547413361, "post_id": 54114190, "comment_id": 95175277, "body": "@Peh: I guess i have found the solution to my problem myself. A review and your thoughts are still welcomed. Thank you"}], "owner": {"reputation": 155, "user_id": 9901759, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216039690767111/picture?type=large", "display_name": "Yavuz Topal", "link": "https://stackoverflow.com/users/9901759/yavuz-topal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 350, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1547453596, "creation_date": 1547050395, "last_edit_date": 1547453596, "question_id": 54114190, "link": "https://stackoverflow.com/questions/54114190/how-to-linearly-interpolate-in-excel-based-on-empty-cells", "title": "how to linearly interpolate in excel based on empty cells", "body": "<p>The first macro runs a predefined check in order to find gaps in the data set y and z: we have data x which is the order running from 1-7. The values y and z are the values with gaps which are subject to interpolation with respect to x (order number).</p>\n\n<p>The solution is presented below</p>\n\n<p>e.g: </p>\n\n<pre><code>x     y    z  \n1     2    3    \n2     4    6    \n3     ?    8  ' interpolation of y  between x=2 and x=4    \n4     8    ?  ' interpolation of z between x=3 and x= 5    \n5     12   14\n</code></pre>\n\n<p>Edited version 2</p>\n\n<pre><code>Public Sub Interpol_Klicken()\n\nDim i As Long\nDim x1 As Double\nDim x2 As Double\nDim y1 As Double\nDim y2 As Double\nDim x As Double\nDim rngY As Range\nDim iCol  As Long\nDim iRow  As Long\n\nSet rngY = Worksheets(\"Z\").Range(\"A1:D10\")\n\n iRow = rngY.Rows.Count\n iCol = rngY.Columns.Count\n\n\n For iCol = 2 To rngY.Columns.Count\n For iRow = 2 To rngY.Rows.Count\n\n If rngY.Cells(iRow, iCol).Value = \"\" Then\n\n y2 = rngY.Cells(iRow, iCol).Offset(RowOffset:=1).Value\n y1 = rngY.Cells(iRow, iCol).Offset(RowOffset:=-1).Value\n\n x2 = rngY.Cells(iRow, 1).Offset(RowOffset:=1).Value\n x1 = rngY.Cells(iRow, 1).Offset(RowOffset:=-1).Value\n x = rngY.Cells(iRow, 1).Value\n\n rngY.Cells(iRow, iCol) = y1 + (y2 - y1) * (x - x1) / (x2 - x1)\n\n End If\n Next iRow\n Next iCol\n\n\n End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "powershell"], "owner": {"reputation": 11, "user_id": 10890596, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wtNMBUTN3nY/AAAAAAAAAAI/AAAAAAAABGk/PdssV1u8AAk/photo.jpg?sz=128", "display_name": "kir", "link": "https://stackoverflow.com/users/10890596/kir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1547051248, "creation_date": 1547049834, "last_edit_date": 1547051248, "question_id": 54114036, "link": "https://stackoverflow.com/questions/54114036/how-to-search-contain-text-in-column-and-return-data-in-new-column-using-powersh", "title": "How to search contain text in column and return data in new column using PowerShell?", "body": "<p>I have an Excel file with many columns, and I need to search and get data that contains a search text and return it to a new column. My data as below.</p>\n\n<p><strong>Column A:</strong></p>\n\n<pre>\nxxxxx\\detail\\A1\\yyyy\naaaaa\\detail\\A2\\zzzz\nA3\n</pre>\n\n<p>I want the following result.</p>\n\n<p><strong>Column B:</strong></p>\n\n<pre>\ndetail\\A1\ndetail\\A2\nA3\n</pre>\n\n<p>My code is below, but it returns the position of the search text instead.</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>$File = \"C:\\\\Testt.xlsx\"\n$SearchString = \"detail\\\" + \"*\"+ \"\\\"\n$Excel = New-Object -ComObject Excel.Application\n$Workbook = $Excel.Workbooks.Open($File)\nfor ($i = 1; $i -lt $($Workbook.Sheets.Count() + 1); $i++) {\n    $Range = $Workbook.Sheets.Item($i).Range(\"A:A\")\n    $Target = $Range.Find($SearchString)\n    $First = $Target\n    do {\n        Write-Host \"$i $($Target.AddressLocal())\"\n        $Target = $Range.FindNext($Target)\n    } while ($Target -ne $null -and $Target.AddressLocal() -ne $First.AddressLocal())\n}\n$Excel.Quit()\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 13, "user_id": 10890719, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/takWH.jpg?s=128&g=1", "display_name": "CaptCarlucci", "link": "https://stackoverflow.com/users/10890719/captcarlucci"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1547072105, "post_id": 54113892, "comment_id": 95070927, "body": "@BigBen I&#39;m not sure that&#39;s what i&#39;m looking for exactly. My VBA already creates the task, but it creates it in the default task folder when I&#39;m wanting it to be created in another folder. I&#39;m sure there is a simple way to do this, and maybe your answer gives that to me. However, I may need more hand-holding if that&#39;s the case."}], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 0, "last_activity_date": 1547080531, "last_edit_date": 1547080531, "creation_date": 1547074639, "answer_id": 54119635, "question_id": 54113892, "link": "https://stackoverflow.com/questions/54113892/how-do-i-move-a-new-outlook-task-into-a-non-default-task-folder/54119635#54119635", "title": "How do I move a new Outlook task into a non-default task folder?", "body": "<p>Just <code>Move</code> the <code>NewTask</code> to the folder in question.</p>\n\n<pre><code>Sub CreateNewTask(Item As Outlook.MailItem)\n    Dim myNamespace As Outlook.NameSpace\n    Dim myFolder As Outlook.Folder\n    Dim NewTask As Outlook.TaskItem\n\n    Set myNamespace = Application.GetNamespace(\"MAPI\")\n    Set myFolder = myNamespace.Folders(\"johndoe@outlook.com\").Folders(\"Certification Requests\")\n    Set NewTask = Application.CreateItem(olTaskItem)\n\n    With NewTask\n        .Subject = Item.Subject\n        .Body = Item.Body\n        .Importance = olImportanceHigh\n        .Save\n        .Move myFolder\n    End With\nEnd Sub\n</code></pre>\n\n<p>Alternately, you could <code>Add</code> a new task item in the folder.</p>\n\n<pre><code>Sub CreateNewTask(Item As Outlook.MailItem)\n    Dim myNamespace As Outlook.NameSpace\n    Dim myFolder As Outlook.Folder\n    Dim NewTask As Outlook.TaskItem\n\n    Set myNamespace = Application.GetNamespace(\"MAPI\")\n    Set myFolder = myNamespace.Folders(\"johndoe@outlook.com\").Folders(\"Certification Requests\")\n    Set NewTask = myFolder.Items.Add(olTaskItem)\n\n    With NewTask\n        .Subject = Item.Subject\n        .Body = Item.Body\n        .Importance = olImportanceHigh\n        .Save\n    End With\nEnd Sub\n</code></pre>\n\n<p>You may have to modify the <code>Set myFolder = \u2026</code> based on where your the \"Certification Requests\" folder is in the folder hierarchy).</p>\n"}], "owner": {"reputation": 13, "user_id": 10890719, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/takWH.jpg?s=128&g=1", "display_name": "CaptCarlucci", "link": "https://stackoverflow.com/users/10890719/captcarlucci"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 567, "favorite_count": 0, "accepted_answer_id": 54119635, "answer_count": 1, "score": 1, "last_activity_date": 1609083219, "creation_date": 1547049418, "last_edit_date": 1609083219, "question_id": 54113892, "link": "https://stackoverflow.com/questions/54113892/how-do-i-move-a-new-outlook-task-into-a-non-default-task-folder", "title": "How do I move a new Outlook task into a non-default task folder?", "body": "<p>I've created a task folder, &quot;Certification Requests&quot;, that is not connected to my primary tasks folder, which is tied to my inbox.</p>\n<p>I want new tasks that my VBA creates to drop into the new folder, rather than my primary task list.</p>\n<p>I have code but the tasks are creating in my primary task list. This script is running based upon a rule.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Sub CreateNewTask(Item As Outlook.MailItem)\n    Dim obApp As Object\n    Dim NewTask As TaskItem\n    \n    Set obApp = Outlook.Application\n    Set NewTask = obApp.CreateItem(olTaskItem)\n    \n    With NewTask\n        .Subject = Item.Subject\n        .Body = Item.Body\n        .Importance = olImportanceHigh\n        .Save\n    End With\n    \n    Set obApp = Nothing\n    Set NewTask = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "conditional"], "answers": [{"comments": [{"owner": {"reputation": 198, "user_id": 7102095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211015901574118/picture?type=large", "display_name": "Abd&#243;n Araya", "link": "https://stackoverflow.com/users/7102095/abd%c3%b3n-araya"}, "edited": false, "score": 0, "creation_date": 1547054377, "post_id": 54113909, "comment_id": 95063376, "body": "I&#39;m getting an &quot;argument not optional&quot; error highlighting DateSerial with <code>As Variant</code> and <code>As Range</code>."}, {"owner": {"reputation": 198, "user_id": 7102095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211015901574118/picture?type=large", "display_name": "Abd&#243;n Araya", "link": "https://stackoverflow.com/users/7102095/abd%c3%b3n-araya"}, "edited": false, "score": 0, "creation_date": 1547056249, "post_id": 54113909, "comment_id": 95064273, "body": "I just corrected it, the date converts itself to <code>dd&#47;mm&#47;yyyy</code> format, manually changing it solved it but now I get <code>Error 91 Object variable or with block variable not set</code> setting <code>Strict On</code> does not solve it."}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "reply_to_user": {"reputation": 198, "user_id": 7102095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211015901574118/picture?type=large", "display_name": "Abd&#243;n Araya", "link": "https://stackoverflow.com/users/7102095/abd%c3%b3n-araya"}, "edited": false, "score": 0, "creation_date": 1547057033, "post_id": 54113909, "comment_id": 95064591, "body": "@Abd&#243;nAraya There&#39;s no <code>Option Strict</code> in VBA"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 0, "creation_date": 1547058734, "post_id": 54113909, "comment_id": 95065353, "body": "<b>There&#39;s no Option Strict in VBA</b> ... Who has claimed that? However, you should use <i>Option Explicit</i>"}, {"owner": {"reputation": 198, "user_id": 7102095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211015901574118/picture?type=large", "display_name": "Abd&#243;n Araya", "link": "https://stackoverflow.com/users/7102095/abd%c3%b3n-araya"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1547058791, "post_id": 54113909, "comment_id": 95065377, "body": "@JohnyL Yep, my bad, confused the documentation. Got it to &quot;run&quot; but it doesn&#39;t pick up any row at all (it skips the entire code)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 1, "creation_date": 1547058981, "post_id": 54113909, "comment_id": 95065457, "body": "<b><i>(it skips the entire code)</i></b> Well, do you use breakpoints and step throught your own code (F8) ? Read up on VBA debugging before complaining that your OWN code does not work as you want it to.  <a href=\"http://www.cpearson.com/excel/debuggingvba.aspx\" rel=\"nofollow noreferrer\">cpearson.com/excel/debuggingvba.aspx</a>"}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1547059048, "post_id": 54113909, "comment_id": 95065485, "body": "@peakpeak <i>Who has claimed that?</i> What&#39;s your problem?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 0, "creation_date": 1547059225, "post_id": 54113909, "comment_id": 95065556, "body": "JohnyL, What is the question?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 198, "user_id": 7102095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211015901574118/picture?type=large", "display_name": "Abd&#243;n Araya", "link": "https://stackoverflow.com/users/7102095/abd%c3%b3n-araya"}, "edited": false, "score": 0, "creation_date": 1547108651, "post_id": 54113909, "comment_id": 95080377, "body": "@Abd&#243;nAraya Try to convert both your cell values <code>fechaIniTarget.Value</code> into date <code>cDate(fechaIniTarget.Value)</code> to ensure that these are dates and have no additional time part. Please tell us the result of <code>Debug.Print fechaIniTarget.Value, fechaFinTarget.Value</code> when your code fails."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 1, "last_activity_date": 1547049937, "last_edit_date": 1547049937, "creation_date": 1547049467, "answer_id": 54113909, "question_id": 54113822, "link": "https://stackoverflow.com/questions/54113822/run-code-when-the-rows-are-between-a-date-range/54113909#54113909", "title": "Run code when the rows are between a date range", "body": "<p>You compare a date <code>fechaIniTarget.Value</code> against a string <code>\"01/01/2018\"</code>. Use a real date with the <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/dateserial-function\" rel=\"nofollow noreferrer\">DateSerial function</a> instead to compare date against date.</p>\n\n<pre><code>If fechaIniTarget.Value = DateSerial(2018, 1, 1) And fechaFinTarget.Value = DateSerial(2018, 12, 31) Then\n</code></pre>\n\n<p>Also note that you used 2 times <code>fechaIniTarget</code> but I guess the second one should be <code>fechaFinTarget</code>.</p>\n\n<p>Also don't use <code>Variant</code> if not necessary. Instead declare your variables <code>As Range</code> here:</p>\n\n<pre><code>Dim fechaIniTarget As Range\nDim fechaFinTarget As Range\n</code></pre>\n"}], "owner": {"reputation": 198, "user_id": 7102095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211015901574118/picture?type=large", "display_name": "Abd&#243;n Araya", "link": "https://stackoverflow.com/users/7102095/abd%c3%b3n-araya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1547054689, "creation_date": 1547049214, "last_edit_date": 1547054689, "question_id": 54113822, "link": "https://stackoverflow.com/questions/54113822/run-code-when-the-rows-are-between-a-date-range", "title": "Run code when the rows are between a date range", "body": "<p>I want to run a code that transfers data from one sheet to another based on the year (eg 01/01/2018 - 31/1/2018).</p>\n\n<p>The sheet contains 2 columns with dates, start_date and end_date stored as dates, so I did an If statement but it doesn't seem to \"understand\" the dates values that I stored previously.</p>\n\n<pre><code>'Dates columns\nDim fechaIniTarget As Variant\nDim fechaFinTarget As Variant\n'Ini = start / Fin = end\nSet fechaIniTarget = Range(\"D2\")\nSet fechaFinTarget = Range(\"E2\")\n\nIf fechaIniTarget.Value = \"01/01/2018\" And fechaFinTarget.Value = \"31/12/2018\" Then\n\n   ' function\n\nMsgBox \"PROCESO COMPLETO\"\n\nEnd If\n</code></pre>\n\n<p>I tried parsing the dates as integer but it still doesn't work.</p>\n"}, {"tags": ["excel", "vba", "csv"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1547049713, "post_id": 54113593, "comment_id": 95060579, "body": "<code>&quot; &quot;</code> (a space) is not the same as <code>&quot;&quot;</code> (an empty string). <code>&quot;&quot;</code> <i>should</i> do what you want. Another option is to look for <code>&quot;,0,&quot;</code> in the csv and replace with <code>&quot;,,&quot;</code>"}, {"owner": {"reputation": 1, "user_id": 10890642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e8e9bba02f79f246cc83e8720b55c30?s=128&d=identicon&r=PG&f=1", "display_name": "tilsonz", "link": "https://stackoverflow.com/users/10890642/tilsonz"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1547052239, "post_id": 54113593, "comment_id": 95062155, "body": "Right. My equal in the table (input file) is =IF(C2=&quot;&quot;, &quot;&quot;, C11) however C11 contains the formula =IF(C2=&quot;&quot;, B11, INDEX(tblProductCode[AOC3],MATCH(C2,tblProductCode[Comodity]&zwnj;&#8203;,0)))"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1547053468, "post_id": 54113593, "comment_id": 95062875, "body": "What if you use one of the solutions <a href=\"https://stackoverflow.com/questions/10434335/text-file-in-vba-open-find-replace-saveas-close-file\">here</a> to edit the csv as a text file, replacing <code>&quot;,0,&quot;</code> with <code>&quot;,,&quot;</code>?"}, {"owner": {"reputation": 1, "user_id": 10890642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e8e9bba02f79f246cc83e8720b55c30?s=128&d=identicon&r=PG&f=1", "display_name": "tilsonz", "link": "https://stackoverflow.com/users/10890642/tilsonz"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1547055492, "post_id": 54113593, "comment_id": 95063940, "body": "That worked perfectly! Thank you so much!"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1547055629, "post_id": 54113593, "comment_id": 95064007, "body": "If you haven&#39;t done so already, I suggest you go vote up the answer with the solution that worked for you"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10890642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e8e9bba02f79f246cc83e8720b55c30?s=128&d=identicon&r=PG&f=1", "display_name": "tilsonz", "link": "https://stackoverflow.com/users/10890642/tilsonz"}, "edited": false, "score": 0, "creation_date": 1547052265, "post_id": 54114167, "comment_id": 95062172, "body": "unfortunately that does not remove the 0&#39;s either."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1547057210, "post_id": 54114167, "comment_id": 95064673, "body": "It&#39;s a string,  so use <code>csvVal = Replace(csvVal, &quot;,0,&quot;, &quot;,,&quot;)</code>  You need the <code>,</code>&#39;s to avoid turning <code>200</code> into <code>2</code>.  Also if the last item is a 0 it won`t replace that one, handle it separately"}], "tags": [], "owner": {"reputation": 265, "user_id": 10813013, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-x6NhmIsh3-8/AAAAAAAAAAI/AAAAAAAAAAA/Vw76fy-AnUc/photo.jpg?sz=128", "display_name": "W-hit", "link": "https://stackoverflow.com/users/10813013/w-hit"}, "is_accepted": false, "score": 0, "last_activity_date": 1547050290, "creation_date": 1547050290, "answer_id": 54114167, "question_id": 54113593, "link": "https://stackoverflow.com/questions/54113593/how-to-remove-a-number-using-vbnullstring/54114167#54114167", "title": "How to remove a number using vbNullString", "body": "<p>Try replacing:\n    csvVal.Replace What:=0, Replacement:=vbNullString, Lookat:=xlWhole\nwith\n    csvVal = Replace(csvVal, 0, \"\")</p>\n"}], "owner": {"reputation": 1, "user_id": 10890642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e8e9bba02f79f246cc83e8720b55c30?s=128&d=identicon&r=PG&f=1", "display_name": "tilsonz", "link": "https://stackoverflow.com/users/10890642/tilsonz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1547050290, "creation_date": 1547048436, "last_edit_date": 1547049649, "question_id": 54113593, "link": "https://stackoverflow.com/questions/54113593/how-to-remove-a-number-using-vbnullstring", "title": "How to remove a number using vbNullString", "body": "<p>I have simple code that creates a csv from a table that works perfectly but I need to iterate through the data in the table and remove any <code>0</code>'s (any cell that contains the number <code>0</code> as the table has equations) before it writes to the output file. I can't simply modify my equations in the table with an if statement to return <code>\" \"</code> as the output file I'm creating will simply add a space in the output csv, which is just as bad. I'm using the output file as a input file for a script using Pascal and it would just skew the data it's pasting because of the <code>\" \"</code> (space).</p>\n\n<p>I've tried using the below in my code and it does not work.</p>\n\n<pre><code>If csvVal = 0 Then\n      csvVal.Replace What:=0, Replacement:=vbNullString, Lookat:=xlWhole\nEnd If\n\nSub saveTableToCSV2()\n\n    Dim tbl As ListObject\n    Dim csvFilePath As String\n    Dim fNum As Integer\n    Dim tblArr\n    Dim rowArr\n    Dim csvVal\n    Dim csvVal2 As Object\n    Dim r As Range\n\n    Set tbl = Worksheets(\"FDA TOOL\").ListObjects(\"tblFDAinfo\")\n    csvFilePath = \"F:\\Scripting\\Import\\Wal-Mart\\Zac\\Audit_Tool2FDA.csv\"\n    tblArr = tbl.DataBodyRange.Value\n\n    fNum = FreeFile()\n    Open csvFilePath For Output As #fNum\n    For i = 1 To UBound(tblArr)\n        rowArr = Application.Index(tblArr, i, 0)\n        csvVal = VBA.Join(rowArr, \",\")\n        If csvVal = 0 Then\n            csvVal.Replace What:=0, Replacement:=vbNullString, Lookat:=xlWhole\n        End If\n        Print #1, csvVal\n    Next\n\n    Close #fNum\n    Set tblArr = Nothing\n    Set rowArr = Nothing\n    Set csvVal = Nothing\nEnd Sub\n</code></pre>\n\n<p>I'd like to remove any 0's before it writes to the output file. </p>\n\n<p>Below is what it is returning for the first line of the table.</p>\n\n<pre><code>REP,RAD,130,4,CT,RB1,,,200,PCS,ACC,17389,96R--CR,,,0,,,,,0,\n</code></pre>\n\n<p>I would like it to return:</p>\n\n<pre><code>REP,RAD,130,4,CT,RB1,,,200,PCS,ACC,17389,96R--CR,,,,,,,,,\n</code></pre>\n"}, {"tags": ["excel", "vba", "count", "delete-row", "countif"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1547047526, "post_id": 54113219, "comment_id": 95059121, "body": "Count only has one argument, looks like you need COUNTIF."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1547047683, "post_id": 54113219, "comment_id": 95059224, "body": "Are you trying to delete the rows, clear the values, or delete the named range?"}, {"owner": {"reputation": 13, "user_id": 10852727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c53ed65d3d46c7db038bdcf56a7265d8?s=128&d=identicon&r=PG&f=1", "display_name": "Kelso_Excels", "link": "https://stackoverflow.com/users/10852727/kelso-excels"}, "edited": false, "score": 0, "creation_date": 1547048403, "post_id": 54113219, "comment_id": 95059672, "body": "I am trying to delete the named range &quot;Remove_Allowances_Credits&quot;) which is equal to rows 156:171."}, {"owner": {"reputation": 13, "user_id": 10852727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c53ed65d3d46c7db038bdcf56a7265d8?s=128&d=identicon&r=PG&f=1", "display_name": "Kelso_Excels", "link": "https://stackoverflow.com/users/10852727/kelso-excels"}, "edited": false, "score": 0, "creation_date": 1547048923, "post_id": 54113219, "comment_id": 95060017, "body": "The answer provided by DavidN resolved the issue."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10852727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c53ed65d3d46c7db038bdcf56a7265d8?s=128&d=identicon&r=PG&f=1", "display_name": "Kelso_Excels", "link": "https://stackoverflow.com/users/10852727/kelso-excels"}, "edited": false, "score": 1, "creation_date": 1547048740, "post_id": 54113474, "comment_id": 95059910, "body": "Thank you! This did it! I am new to VBA and cannot wait to become better at it and contribute to this awesome community."}], "tags": [], "owner": {"reputation": 440, "user_id": 5128961, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SEr4k.gif?s=128&g=1", "display_name": "DavidN", "link": "https://stackoverflow.com/users/5128961/davidn"}, "is_accepted": true, "score": 1, "last_activity_date": 1547048877, "last_edit_date": 1547048877, "creation_date": 1547047991, "answer_id": 54113474, "question_id": 54113219, "link": "https://stackoverflow.com/questions/54113219/looking-to-delete-named-range2-when-all-values-in-named-range1-are-equal-to-n-a/54113474#54113474", "title": "Looking to delete named range2 when all values in named range1 are equal to \u201cN/A\u201d VBA Application.WorksheetFunction", "body": "<p>Try the following:</p>\n\n<pre><code>If Application.WorksheetFunction.COUNTA(Range(\"Allowances_Credits_Range\")) = \nApplication.WorksheetFunction.COUNTIF(Range(\"Allowances_Credits_Range\"), \"#N/A\")) Then\n\n    Workbooks(PharmacyPricingGuarantees2).Sheets(\"Pharmacy Pricing Guarantees\").Range(\"Remove_Allowances_Credits\").Delete\n\nEnd If\n</code></pre>\n\n<p>Firstly, you want to use <code>COUNTA</code> instead of <code>COUNT</code> for the first part.  <code>COUNT</code> only counts numerical values.  <code>COUNTA</code> counts all non-empty values (including #N/A).</p>\n\n<p>Secondly, you want to use the <code>COUNTIF</code> function to count values = #N/A.</p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 10852727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c53ed65d3d46c7db038bdcf56a7265d8?s=128&d=identicon&r=PG&f=1", "display_name": "Kelso_Excels", "link": "https://stackoverflow.com/users/10852727/kelso-excels"}, "edited": false, "score": 1, "creation_date": 1547048837, "post_id": 54113478, "comment_id": 95059973, "body": "Thank you for your response! This community of contributors is incredible. Thank you for your efforts and help."}], "tags": [], "owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "is_accepted": false, "score": 2, "last_activity_date": 1547048012, "creation_date": 1547048012, "answer_id": 54113478, "question_id": 54113219, "link": "https://stackoverflow.com/questions/54113219/looking-to-delete-named-range2-when-all-values-in-named-range1-are-equal-to-n-a/54113478#54113478", "title": "Looking to delete named range2 when all values in named range1 are equal to \u201cN/A\u201d VBA Application.WorksheetFunction", "body": "<p>Not entirely sure what you are trying to achieve, so I added a few different methods.</p>\n\n<pre><code>Sub Examples()\n    'Might need to change Workbook reference to PharmacyPricingGuarantees2?\n    Dim ws As Worksheet: Set ws = Thisworkbook.Sheets(\"Pharmacy Pricing Guarantees\")\n    If ws.Range(\"Allowances_Credits_Range\").Cells.Count = WorksheetFunction.CountIf(ws.Range(\"Allowances_Credits_Range\"), \"n/a\") Then\n        ws.Range(\"Remove_Allowances_Credits\").ClearContents  '&lt;-- Clear the values?\n        ws.Range(\"Remove_Allowances_Credits\").EntireRow.Delete '&lt;-- Delete the rows?\n        ThisWorkbook.Names(\"Remove_Allowances_Credits\").Delete '&lt;-- Delete the named range?\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10852727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c53ed65d3d46c7db038bdcf56a7265d8?s=128&d=identicon&r=PG&f=1", "display_name": "Kelso_Excels", "link": "https://stackoverflow.com/users/10852727/kelso-excels"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 54113474, "answer_count": 2, "score": 1, "last_activity_date": 1547048877, "creation_date": 1547046997, "last_edit_date": 1547047074, "question_id": 54113219, "link": "https://stackoverflow.com/questions/54113219/looking-to-delete-named-range2-when-all-values-in-named-range1-are-equal-to-n-a", "title": "Looking to delete named range2 when all values in named range1 are equal to \u201cN/A\u201d VBA Application.WorksheetFunction", "body": "<p>We are looking to delete an entire section of rows (named range  \u201cRemove_Allowances_Credits\u201d)  when all values in the section (named range \"Allowances_Credits_Range\") are equal to \u201cN/A\u201d.<br>\nFor example, we are looking to delete rows 156:171 when each value in C161:C170 equal \u201cN/A\u201d. How do I use application.worksheetFunction count and countif to accomplish this?</p>\n\n<pre><code>If Application.WorksheetFunction.Count(Range(\"Allowances_Credits_Range\")) = Application.WorksheetFunction.Count(Range(\"Allowances_Credits_Range\", \"n/a\")) Then\n\n    Workbooks(PharmacyPricingGuarantees2).Sheets(\"Pharmacy Pricing Guarantees\").Range(\"Remove_Allowances_Credits\").Delete\nEnd If\n</code></pre>\n\n<p>I am getting an Error 1004</p>\n\n<pre><code>If Application.WorksheetFunction.Count(Range(\"Allowances_Credits_Range\")) = Application.WorksheetFunction.Count(Range(\"Allowances_Credits_Range\", \"n/a\")) Then\n\n    Workbooks(PharmacyPricingGuarantees2).Sheets(\"Pharmacy Pricing Guarantees\").Range(\"Remove_Allowances_Credits\").Delete\nEnd If\n</code></pre>\n\n<p>To delete the named range \"Remove_Allowances_Credits\" \nI am getting an error 1004</p>\n"}, {"tags": ["excel", "vba", "userform"], "comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 1, "creation_date": 1547046282, "post_id": 54112940, "comment_id": 95058345, "body": "Not seeing anything obvious. One issue it could be is not referring to the correct workbook. If there is another workbook open with a sheet called <code>QA Data</code> it might cause an issue. Try updating this <code>Set ws = Worksheets(&quot;QA Data&quot;)</code> to <code>Set ws = Thisworkbook.Worksheets(&quot;QA Data&quot;)</code>. Also, make sure the data actually isn&#39;t there. It might be that the data is being appended farther down than expected."}, {"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1547047137, "post_id": 54112940, "comment_id": 95058899, "body": "I would agree with @RyanWildry. Alternatively, is it possibe users are renaming the worksheet? Maybe direct it to the sheetID name rather than the Name?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1547050624, "post_id": 54112940, "comment_id": 95061133, "body": "Your Find is missing the <code>After</code> argument (should be A1) so it&#39;s possible it&#39;s not finding the <i>last</i> row.  That could lead to overwriting existing data: I always check the row is really empty before writing anything."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1547053194, "post_id": 54112940, "comment_id": 95062713, "body": "I would try the <code>.end(xlup)</code> method of defining your rows.  Is it possible multiple users can be updating?"}, {"owner": {"reputation": 1, "user_id": 10890424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/898be36a98fd06ab0edd37cca74e8e49?s=128&d=identicon&r=PG&f=1", "display_name": "NTurecamo", "link": "https://stackoverflow.com/users/10890424/nturecamo"}, "edited": false, "score": 0, "creation_date": 1547059792, "post_id": 54112940, "comment_id": 95065780, "body": "Thank you all!  Ryan - I looked all the way to the end and the data was not there.  PGCodeRider - I don&#39;t think they are but I will modify it like you said just to be sure.  Nathan - Each user has their own spreadsheet, so it&#39;s not shared."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10890424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/898be36a98fd06ab0edd37cca74e8e49?s=128&d=identicon&r=PG&f=1", "display_name": "NTurecamo", "link": "https://stackoverflow.com/users/10890424/nturecamo"}, "edited": false, "score": 0, "creation_date": 1547077174, "post_id": 54117099, "comment_id": 95072353, "body": "Thank you Tate!  I will use the xlup, that seems more efficient and less error-prone.  Also the debug screen will definitely come in handy if this happens again."}], "tags": [], "owner": {"reputation": 1489, "user_id": 9206171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6b558dd95066c7057eadeda8218cb7?s=128&d=identicon&r=PG&f=1", "display_name": "Tate Garringer", "link": "https://stackoverflow.com/users/9206171/tate-garringer"}, "is_accepted": false, "score": 0, "last_activity_date": 1547062387, "creation_date": 1547062387, "answer_id": 54117099, "question_id": 54112940, "link": "https://stackoverflow.com/questions/54112940/excel-userform-occasionally-will-not-enter-data-into-the-spreadsheet/54117099#54117099", "title": "Excel userform occasionally will not enter data into the spreadsheet", "body": "<p>The line \n<pre><code>lRow = ws.Cells.Find(What:=\"*\", SearchOrder:=xlRows, _\n    SearchDirection:=xlPrevious, LookIn:=xlValues).Row + 1</pre></code> \nwill find a value that is not only at the last row, but also the last column in that row. \n<p>You can imagine it searching from <code>ws.Range($XFD$1048576)</code> to <code>ws.Range(\"$A$1\")</code> searching right to left, then moving up a row. So, if by chance, there existed a value at <code>ws.Range(\"$AA$57)</code> your output would end up on the 58th row.\n<p>A more consistent approach to finding the last row used for your purpose--since you're goal is to sequentially enter data into columns 1-13--would be to let <code>lRow = ws.Range(\"A\" &amp; Rows.Count).End(xlup).Row + 1</code>.\nWith this method, you're only searching column A for the last populated row and then stepping down one to the next empty row.\nTo further eliminate outlier errors, it may be in your best interest to <code>set ws = ThisWorkbook.Worksheets(\"QA Data\")</code>.\n<p>As far as suggestions for debugging an issue like this, you could create an additional worksheet, we'll call it \"Error\" for this example, and at the end of your code for CommandButton1_Click() add</p>\n\n<p><pre><code>With ThisWorkbook.Worksheets(\"Error\")\n    .Range(\"A\" &amp; .Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1) = \"Data Entry Point @ Row \" &amp; lRow\nEnd With</pre></code></p>\n\n<p>just to see where your data is ouputting.</p>\n"}], "owner": {"reputation": 1, "user_id": 10890424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/898be36a98fd06ab0edd37cca74e8e49?s=128&d=identicon&r=PG&f=1", "display_name": "NTurecamo", "link": "https://stackoverflow.com/users/10890424/nturecamo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1547062387, "creation_date": 1547046026, "last_edit_date": 1547046916, "question_id": 54112940, "link": "https://stackoverflow.com/questions/54112940/excel-userform-occasionally-will-not-enter-data-into-the-spreadsheet", "title": "Excel userform occasionally will not enter data into the spreadsheet", "body": "<p>The userform I created in Excel VBA to enter data into a database works, however occasionally my users report that data they've entered using the form does not populate on the spreadsheet.  I'm new to coding in Excel VBA and programming in general so I'm not sure the best way to troubleshoot a problem like this.</p>\n\n<p>Please note this problem is intermittent, so I don't know if it's something the user is doing or not doing.</p>\n\n<p>I originally thought the data might be populating at the bottom of the spreadsheet because of an error with the 'find first empty row in database section, however I did not find any data there.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim lRow As Long\nDim ws As Worksheet\nSet ws = Worksheets(\"QA Data\")\n\n'find first empty row in database\nlRow = ws.Cells.Find(What:=\"*\", SearchOrder:=xlRows, _\n    SearchDirection:=xlPrevious, LookIn:=xlValues).Row + 1\n\n'check for lookup code\nIf Trim(Me.txtLookup_Code.Value) = \"\" Then\n    Me.txtLookup_Code.SetFocus\n    MsgBox \"Please enter a Lookup Code\"\n    Exit Sub\nEnd If\n\n'copy the data to the database\n'use protect and unprotect lines,\n'   with your password\n'   if worksheet is protected\nWith ws\n'   .Unprotect Password:=\"password\"\n    .Cells(lRow, 1).Value = Me.txtLookup_Code.Value\n    .Cells(lRow, 2).Value = Me.cboCM_Name.Value\n    .Cells(lRow, 3).Value = Me.txtCM_Errors.Value\n    .Cells(lRow, 4).Value = Me.cboSP_Site.Value\n    .Cells(lRow, 6).Value = Me.cboChecklist_Type.Value\n    .Cells(lRow, 7).Value = Me.txtActivity_Description.Value\n    .Cells(lRow, 8).Value = Me.cboProcessor_Name.Value\n    .Cells(lRow, 9).Value = Me.txtCritical_Errors.Value\n    .Cells(lRow, 10).Value = Me.txtNon_Critical_Errors.Value\n    .Cells(lRow, 12).Value = Date\n    .Cells(lRow, 13).Value = Application.UserName\n'   .Protect Password:=\"password\"\nEnd With\n\n'clear the data\nMe.txtLookup_Code.Value = \"\"\nMe.cboCM_Name.Value = \"\"\nMe.txtCM_Errors.Value = \"\"\nMe.cboSP_Site.Value = \"\"\nMe.cboChecklist_Type.Value = \"\"\nMe.txtActivity_Description.Value = \"\"\nMe.cboProcessor_Name.Value = \"\"\nMe.txtCritical_Errors.Value = \"\"\nMe.txtNon_Critical_Errors.Value = \"\"\nMe.txtLookup_Code.SetFocus\n\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\nDim cName As Range\nDim cSite As Range\nDim cCheck As Range\nDim cProcessor As Range\nSet ws = Worksheets(\"Lists\")\n\nFor Each cName In ws.Range(\"CMName\")\n  With Me.cboCM_Name\n    .AddItem cName.Value\n    .List(.ListCount - 1, 1) = cName.Offset(0, 1).Value\n  End With\nNext cName\n\nFor Each cSite In ws.Range(\"SPSite\")\n    With Me.cboSP_Site\n        .AddItem cSite.Value\n        .List(.ListCount - 1, 1) = cSite.Offset(0, 1).Value\n    End With\nNext cSite\n\nFor Each cCheck In ws.Range(\"ChecklistType\")\n    With Me.cboChecklist_Type\n        .AddItem cCheck.Value\n        .List(.ListCount - 1, 1) = cCheck.Offset(0, 1).Value\n    End With\nNext cCheck\n\nFor Each cProcessor In ws.Range(\"ProcessorName\")\n    With Me.cboProcessor_Name\n        .AddItem cProcessor.Value\n        .List(.ListCount - 1, 1) = cProcessor.Offset(0, 1).Value\n    End With\nNext cProcessor\n\nMe.txtLookup_Code.SetFocus\n\nEnd Sub\n</code></pre>\n\n<p>I expect the spreadsheet to populate with the data that was entered when the \"Add\" button is pressed, however occasionally it will not work.</p>\n"}, {"tags": ["vba", "vbscript", "outlook", "lotus-notes", "read-unread"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10890371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ebf438aee26809804cab216691328e0?s=128&d=identicon&r=PG&f=1", "display_name": "DJTheri", "link": "https://stackoverflow.com/users/10890371/djtheri"}, "edited": false, "score": 0, "creation_date": 1547217778, "post_id": 54118392, "comment_id": 95128361, "body": "I believe you&#39;re suggesting I make changes to Outlook, which I mentioned I did not want to do.  If I&#39;m wrong, let me know."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 13, "user_id": 10890371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ebf438aee26809804cab216691328e0?s=128&d=identicon&r=PG&f=1", "display_name": "DJTheri", "link": "https://stackoverflow.com/users/10890371/djtheri"}, "edited": false, "score": 0, "creation_date": 1547220055, "post_id": 54118392, "comment_id": 95129696, "body": "No, I am suggesting doing this in your script."}, {"owner": {"reputation": 13, "user_id": 10890371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ebf438aee26809804cab216691328e0?s=128&d=identicon&r=PG&f=1", "display_name": "DJTheri", "link": "https://stackoverflow.com/users/10890371/djtheri"}, "edited": false, "score": 0, "creation_date": 1547240426, "post_id": 54118392, "comment_id": 95138899, "body": "Thanks.  Would you be able to show me where to modify the script?  I&#39;m only intermediately familiar w/ VBScript."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 13, "user_id": 10890371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ebf438aee26809804cab216691328e0?s=128&d=identicon&r=PG&f=1", "display_name": "DJTheri", "link": "https://stackoverflow.com/users/10890371/djtheri"}, "edited": false, "score": 0, "creation_date": 1547241116, "post_id": 54118392, "comment_id": 95139166, "body": "You would need to declare &quot;with events&quot; variable of type Outlook.Items and provide the ItemAdd event handler. You can then initialize it from the MAPIFolder.Items property, where MAPIFolder object is retreived from Application.Session.GetDefaultFolder(olFolderSentMail)."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": true, "score": 1, "last_activity_date": 1547068161, "creation_date": 1547068161, "answer_id": 54118392, "question_id": 54112578, "link": "https://stackoverflow.com/questions/54112578/send-emails-using-vbscript-but-leave-the-sent-item-as-unread/54118392#54118392", "title": "Send emails using VBScript, but leave the Sent Item as Unread?", "body": "<p>You can catch the <code>Items.ItemAdd</code> event on the sent Items folder and set the <code>MailItem.Unread</code> property to true. <code>MailItem</code> will be passed as a parameter to your event handler.</p>\n"}], "owner": {"reputation": 13, "user_id": 10890371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ebf438aee26809804cab216691328e0?s=128&d=identicon&r=PG&f=1", "display_name": "DJTheri", "link": "https://stackoverflow.com/users/10890371/djtheri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 54118392, "answer_count": 1, "score": 0, "last_activity_date": 1592694208, "creation_date": 1547044849, "last_edit_date": 1592694208, "question_id": 54112578, "link": "https://stackoverflow.com/questions/54112578/send-emails-using-vbscript-but-leave-the-sent-item-as-unread", "title": "Send emails using VBScript, but leave the Sent Item as Unread?", "body": "<p>I created an Excel document years ago which runs through a list of vendors we have in our system to send email messages.  At the time, we were using Lotus Notes &amp; have recently transitioned to Outlook.  I had to rewrite the script, using Outlook functions.  In it's current form, it works, but in Lotus when they emails were sent they appeared in a users Sent box, as unread.  Apparently, users have become attached to this function &amp; use it for different reporting purposes, so I'm wondering if I can somehow modify the code for similar results.  I suspect I can create some rules in Outlook to handle this, but that would mean creating the same rule for each individual &amp; then turnover.  It wouldn't be pretty.  Any help would be appreciated.</p>\n\n<pre><code>        Sub SendWithLotus()\n\n      Dim outobj, mailobj\n      Dim strFileText\n      Dim objFileToRead\n      Dim vaRecipient As Variant, vsMsg As Variant, vaCC As Variant, stSubject As Variant, vaBCC As Variant\n\n        Const stTitle As String = \"Preview?\"\n        If 1 = 1 Then\n            If MsgBox(\"Did you already preview your message?\", _\n            vbYesNo + vbInformation, stTitle) = vbNo Then _\n            Exit Sub\n        End If\n        Range(\"C2:C74\").Select\n        Selection.Sort Key1:=Range(\"C2\"), Order1:=xlAscending, Header:=xlNo, _\n    OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _\n    DataOption1:=xlSortNormal\n        Range(\"A1\").Select\n        Dim a As Integer\n        a = 0\n    Dim i As Integer\n    i = 2\n    Do Until IsEmpty(Range(\"C\" &amp; i).Value)\n\n    vaRecipient = Range(\"D\" &amp; i).Value\n    Range(\"A41\").Value = Range(\"F\" &amp; i).Value\n    vaMsg = Range(\"A83\").Value\n    vaCC = Range(\"A78\").Value\n    vaBCC = Range(\"H\" &amp; i).Value\n    stSubject = Range(\"E\" &amp; i).Value\n    stAttachment = Range(\"A113\").Value\n    stAttachment2 = Range(\"A114\").Value\n    stAttachment3 = Range(\"A115\").Value\n    stAttachment4 = Range(\"A116\").Value\n    stAttachment5 = Range(\"A117\").Value\n\n      Set outobj = CreateObject(\"Outlook.Application\")\n      Set mailobj = outobj.CreateItem(0)\n\n\n        With mailobj\n        .To = vaRecipient\n         If Range(\"B40\").Value = \"Yes\" Then\n                .cc = vaCC\n            End If\n        .bcc = vaBCC\n        .Subject = stSubject\n        .Body = vaMsg\n                'Add attachments\n        If stAttachment &lt;&gt; \"\" Then\n        .Attachments.Add (stAttachment)\n        End If\n\n        If stAttachment2 &lt;&gt; \"\" Then\n        .Attachments.Add (stAttachment2)\n        End If\n\n        If stAttachment3 &lt;&gt; \"\" Then\n        .Attachments.Add (stAttachment3)\n        End If\n\n        If stAttachment4 &lt;&gt; \"\" Then\n        .Attachments.Add (stAttachment4)\n        End If\n\n        If stAttachment5 &lt;&gt; \"\" Then\n        .Attachments.Add (stAttachment5)\n        End If\n        .Send\n\n      End With\n\n      'Clear the memory\n      Set outobj = Nothing\n      Set mailobj = Nothing\n\n           a = a + 1\n\n    'Activate Excel for the user.\n        AppActivate \"SendWithOutlook\"\n            i = i + 1\nLoop\n        Range(\"A41\").Value = \"\"\nMsgBox \"You have successfully sent \" &amp; a &amp; \" email(s).  Danny is Awesome.\", vbInformation\n\n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 439, "user_id": 8221156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0630c5eb8859be4063f55d8389373460?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/8221156/gene"}, "edited": false, "score": 0, "creation_date": 1547045032, "post_id": 54112492, "comment_id": 95057463, "body": "What&#39;s wrong with your code?"}, {"owner": {"reputation": 3, "user_id": 10884612, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Iw_cAXR8GtY/AAAAAAAAAAI/AAAAAAAAAFs/IkWD4l30iBc/photo.jpg?sz=128", "display_name": "Pooyan Haghpanah", "link": "https://stackoverflow.com/users/10884612/pooyan-haghpanah"}, "reply_to_user": {"reputation": 439, "user_id": 8221156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0630c5eb8859be4063f55d8389373460?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/8221156/gene"}, "edited": false, "score": 0, "creation_date": 1547045280, "post_id": 54112492, "comment_id": 95057631, "body": "ar = CountWorksheets()      -&gt; Error:Cant assign to array"}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1547045968, "last_edit_date": 1547045968, "creation_date": 1547045370, "answer_id": 54112757, "question_id": 54112492, "link": "https://stackoverflow.com/questions/54112492/how-to-return-array-in-function-in-vba-excel/54112757#54112757", "title": "How to return Array in function in VBA - Excel", "body": "<p>You need to return a variant or String(). Also, adjust your array to start at 1 </p>\n\n<pre><code>ReDim Arr(1 To size)\n</code></pre>\n\n<p>Otherwise you will have an empty position at start.Or, do the necessary substractions to start at 0.</p>\n\n<pre><code>Option Explicit\n\nPublic Function CountWorksheets() As Variant\n    Dim i, size As Integer\n    Dim Arr() As String\n    size = Worksheets.Count\n    ReDim Arr(1 To size)\n    For i = 1 To Worksheets.Count\n        Arr(i) = Worksheets(i).NAME\n    Next i\n    CountWorksheets = Arr\nEnd Function\n\nPrivate Sub RunLoc_Click()\n    Dim ar() As String\n    ReDim ar(Worksheets.Count)\n\n    ar = CountWorksheets\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10884612, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Iw_cAXR8GtY/AAAAAAAAAAI/AAAAAAAAAFs/IkWD4l30iBc/photo.jpg?sz=128", "display_name": "Pooyan Haghpanah", "link": "https://stackoverflow.com/users/10884612/pooyan-haghpanah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 54112757, "answer_count": 1, "score": 0, "last_activity_date": 1547046944, "creation_date": 1547044585, "last_edit_date": 1547046944, "question_id": 54112492, "link": "https://stackoverflow.com/questions/54112492/how-to-return-array-in-function-in-vba-excel", "title": "How to return Array in function in VBA - Excel", "body": "<p>the main goal is copying the worksheets name to an array, and array passes from function to main code to be able to track new added worksheets name to the array and work with them accordingly</p>\n\n<pre><code>Public Function CountWorksheets() As String\nDim i, size As Integer\nDim Arr() As String\nsize = Worksheets.Count\nReDim Arr(size)\nFor i = 1 To Worksheets.Count\n    Arr(i) = Worksheets(i).Name\nNext i\nCountWorksheets = Arr\nEnd Function\n\n\n\nPrivate Sub RunLoc_Click()\nDim ar() As String\nReDim ar(Worksheets.Count)\nj = 1\nIf Not IsEmpty(Location.Value) Then\n    RunLoc.Enabled = True\n    For i = 1 To Worksheets.Count\n        If Worksheets(i).Name = Location.Value Then\n            Worksheets(i).Select\n            Range(\"a1\").Select\n        End If\n    Next i\n    ar = CountWorksheets()\nEnd If\nTextBox1.Value = Location.Value\n\nEnd Sub\n</code></pre>\n\n<p>I expect to have the Arr and CountWorksheets with the same array recorded in both in function, and when CountWorksheets is called, the total of the array is copied to the new one which is named ar. </p>\n"}, {"tags": ["excel", "vba", "web-scraping"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1547048949, "post_id": 54112440, "comment_id": 95060036, "body": "What is the expected result please?"}, {"owner": {"reputation": 23, "user_id": 9651734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7c5aec94b55ebde4b7fd1ea1b279850?s=128&d=identicon&r=PG&f=1", "display_name": "plinius", "link": "https://stackoverflow.com/users/9651734/plinius"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1547053868, "post_id": 54112440, "comment_id": 95063106, "body": "Only date without code champiobship"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 9651734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7c5aec94b55ebde4b7fd1ea1b279850?s=128&d=identicon&r=PG&f=1", "display_name": "plinius", "link": "https://stackoverflow.com/users/9651734/plinius"}, "edited": false, "score": 0, "creation_date": 1547058208, "post_id": 54115237, "comment_id": 95065113, "body": "thanks, you&#39;ve got my mind, I just used the split with character separator ascii &quot;enter&quot;, ie Chr $ (13)"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1547055003, "last_edit_date": 1547055003, "creation_date": 1547054034, "answer_id": 54115237, "question_id": 54112440, "link": "https://stackoverflow.com/questions/54112440/children-nested-extract-data-without-tags-or-attributes/54115237#54115237", "title": "children nested extract data without tags or attributes", "body": "<p>You can get just the date with the following:</p>\n\n<pre><code>Option Explicit\nPublic Sub GetDate()\n    Dim ie As InternetExplorer\n    Set ie = New InternetExplorer\n    With ie\n        .Visible = True\n        .Navigate2 \"http://www.soccer-rating.com/Manchester-City/220/\"\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n        Debug.Print Split(.Document.querySelector(\".bigtable:nth-of-type(3) .bigtable tr:nth-of-type(1) td\").innerText, Chr$(32))(0)\n        .Quit\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>With xmlhttp request and no browser</p>\n\n<pre><code>Option Explicit    \nPublic Sub GetInfo()\n    Dim html As HTMLDocument\n    Set html = New HTMLDocument\n    With CreateObject(\"MSXML2.XMLHTTP\")\n        .Open \"GET\", \"http://www.soccer-rating.com/Manchester-City/220/\", False\n        .send\n        html.body.innerHTML = .responseText\n    End With\n    Debug.Print Split(html.getElementsByClassName(\"bigtable\")(3).getElementsByTagName(\"TD\")(0).innerText, Chr$(32))(0)\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Requires references to <code>Microsoft Internet Controls</code> and <code>Microsoft HTML Object Library</code></p>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 9651734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7c5aec94b55ebde4b7fd1ea1b279850?s=128&d=identicon&r=PG&f=1", "display_name": "plinius", "link": "https://stackoverflow.com/users/9651734/plinius"}, "is_accepted": false, "score": 0, "last_activity_date": 1547130928, "creation_date": 1547130928, "answer_id": 54130943, "question_id": 54112440, "link": "https://stackoverflow.com/questions/54112440/children-nested-extract-data-without-tags-or-attributes/54130943#54130943", "title": "children nested extract data without tags or attributes", "body": "<p>anyway I solved that</p>\n\n<blockquote>\n  <p>cells(i , 1) = split(td.getElementsBytagname(\"td\")(1).Children(0).innertext,Chr$(13))(1)</p>\n</blockquote>\n\n<p>where </p>\n\n<blockquote>\n  <p>Chr$(13)</p>\n</blockquote>\n\n<p>is \"enter\" in ASCII code</p>\n"}], "owner": {"reputation": 23, "user_id": 9651734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7c5aec94b55ebde4b7fd1ea1b279850?s=128&d=identicon&r=PG&f=1", "display_name": "plinius", "link": "https://stackoverflow.com/users/9651734/plinius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 54115237, "answer_count": 2, "score": 0, "last_activity_date": 1547130928, "creation_date": 1547044385, "last_edit_date": 1547046958, "question_id": 54112440, "link": "https://stackoverflow.com/questions/54112440/children-nested-extract-data-without-tags-or-attributes", "title": "children nested extract data without tags or attributes", "body": "<p>I can not extract with vba scraping data individually from a site </p>\n\n<p><a href=\"http://www.soccer-rating.com/Manchester-City/220/\" rel=\"nofollow noreferrer\">link to site soccer rating</a></p>\n\n<pre><code>&lt;tr bgcolor=\"#ffffff\"&gt;\n   &lt;td class=\"nomobil\"&gt;30&lt;/td&gt;\n   &lt;td&gt;\n     12.01.19\n     &lt;div class=\"ismobil\"&gt;UK3&lt;/div&gt;\n   &lt;/td&gt;\n   .\n   .\n   .\n   .\n   .\n&lt;/tr&gt;\n</code></pre>\n\n<p>inserting my code I extract both the date and the championship code</p>\n\n<pre><code>Dim objIE As Object\nDim itemEle As Object\ndim td as Object\ndim i as integer\n\nSet objIE = CreateObject(\"internetexplorer.application\")\nobjIE.Visible = True\nobjIE.navigate \"http://www.soccer-rating.com/Manchester-City/220/\"\nDo While objIE.Busy = True Or objIE.readyState &lt;&gt; 4: DoEvents: Loop\nSet itemEle = objIE.document.getElementsByclassname(\"bigtable\")(4)\ni = 0\nFor Each td In itemEle.getElementsBytagname(\"tr\")\n  If i &gt; 0 Then\n\n    cells(i , 1) = td.getElementsBytagname(\"td\")(1).Children(0).innertext\n  end if\n  i = i + 1\nnext td\n</code></pre>\n\n<p>in the first cell i found only championship code instead of the date</p>\n\n<p>if I took the baby off (0) I would have this:</p>\n\n<pre><code>Cells(1, 1) = td.getElementsBytagname(\"td\")(1).innertext\n</code></pre>\n\n<p>and I find myself in the cell (i, 1)</p>\n\n<p><a href=\"https://i.stack.imgur.com/GMip4.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GMip4.jpg\" alt=\"enter image description here\"></a> </p>\n"}, {"tags": ["vba", "variables", "colors", "cql", "coreldraw"], "comments": [{"owner": {"reputation": 229, "user_id": 3422687, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/1087712401/picture?type=large", "display_name": "user3422687", "link": "https://stackoverflow.com/users/3422687/user3422687"}, "edited": false, "score": 0, "creation_date": 1548076218, "post_id": 54112435, "comment_id": 95401952, "body": "Would appreciate any help please"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1548170524, "post_id": 54112435, "comment_id": 95442711, "body": "You might need to escape the string so you can include the variables into the Query. Try something like <code>ActivePage.Shapes.FindShapes(Query:=&quot;@fill.color = cmyk(&quot; &amp; a &amp; &quot;,&quot; &amp; b &amp; &quot;,&quot; &amp; c &amp; &quot;,&quot; &amp; d &amp; &quot;)&quot;).CreateSelection</code> and see if that gets you closer"}, {"owner": {"reputation": 229, "user_id": 3422687, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/1087712401/picture?type=large", "display_name": "user3422687", "link": "https://stackoverflow.com/users/3422687/user3422687"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1548176445, "post_id": 54112435, "comment_id": 95446226, "body": "you are a star thank you so much been racking my brains for a week on this"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1548178251, "post_id": 54112435, "comment_id": 95447130, "body": "Added as an answer. Let me know if that solves it for you :)"}], "answers": [{"tags": [], "owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "is_accepted": true, "score": 1, "last_activity_date": 1548178201, "creation_date": 1548178201, "answer_id": 54313559, "question_id": 54112435, "link": "https://stackoverflow.com/questions/54112435/coreldraw-vba-using-variables-in-cql/54313559#54313559", "title": "CorelDraw VBA Using variables in CQL", "body": "<p>It appears the answer to this one, is to escape the string, and concatenate the values into the query.</p>\n\n<p>From the comments, this should work:</p>\n\n<pre><code>ActivePage.Shapes.FindShapes(Query:=\"@fill.color = cmyk(\" &amp; a &amp; \",\" &amp; b &amp; \",\" &amp; c &amp; \",\" &amp; d &amp; \")\").CreateSelection\n</code></pre>\n"}], "owner": {"reputation": 229, "user_id": 3422687, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/1087712401/picture?type=large", "display_name": "user3422687", "link": "https://stackoverflow.com/users/3422687/user3422687"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 242, "favorite_count": 0, "accepted_answer_id": 54313559, "answer_count": 1, "score": 0, "last_activity_date": 1548178201, "creation_date": 1547044374, "last_edit_date": 1548076194, "question_id": 54112435, "link": "https://stackoverflow.com/questions/54112435/coreldraw-vba-using-variables-in-cql", "title": "CorelDraw VBA Using variables in CQL", "body": "<p>Guys Im Trying to use variables in my cql query</p>\n\n<p>If I Use the following it works as expected and selects all the objects with the same cmyk color</p>\n\n<pre><code>ActivePage.Shapes.FindShapes(Query:=\"@fill.color = cmyk(100,0,0,0)\").CreateSelection\n</code></pre>\n\n<p>I Want to use variables from an array that will find the color of one object and select all the other objects with the same color</p>\n\n<p>I have tried the following</p>\n\n<pre><code> Dim a, b, c, d\n a = 100\n b = 0\n c = 0\n d = 0\n ActivePage.Shapes.FindShapes(Query:=\"@fill.color = cmyk(a,b,c,d)\").CreateSelection\n</code></pre>\n\n<p>when I do this i get the following error</p>\n\n<p>identifier 'a' is not a member of global</p>\n\n<p>any ideas what is going on</p>\n\n<p>any help is appreciated</p>\n\n<p>mark</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1547044583, "post_id": 54112389, "comment_id": 95057175, "body": "Can you post the code as text in your post please,"}, {"owner": {"reputation": 1, "user_id": 10890055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af29070633b3d0113872b78434f09d04?s=128&d=identicon&r=PG&f=1", "display_name": "Will G.", "link": "https://stackoverflow.com/users/10890055/will-g"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1547133586, "post_id": 54112389, "comment_id": 95094772, "body": "Sub Button426_Click()  End Sub Sub MCO_Projects() &#39; &#39; MCO_Projects Macro &#39;  &#39;     ActiveSheet.ListObjects(&quot;Capacity_Model&quot;).Range.AutoFilter Field:=8, _         Criteria1:=&quot;MCO&quot;     ActiveWindow.SmallScroll Down:=9     ActiveWindow.SmallScroll ToRight:=-51     ActiveSheet.ListObjects(&quot;Capacity_Model&quot;).Range.AutoFilter Field:=18, _         Criteria1:=&quot;=Phase 2B&quot;, Operator:=xlOr, Criteria2:=&quot;=Phase 3&quot;     ActiveWindow.SmallScroll ToRight:=53     ActiveWindow.SmallScroll Down:=-6 End Sub"}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1547046698, "creation_date": 1547046698, "answer_id": 54113135, "question_id": 54112389, "link": "https://stackoverflow.com/questions/54112389/vba-how-to-filter-using-table-headings/54113135#54113135", "title": "VBA: How to filter using table headings", "body": "<p>As your table starts at column A you have a number of choices. For example, you can use ListColumns with index to return the column number for Product field in table. Repeat this logic for the other fields. If it didn't start at A you could use same principle with a subtraction for start column as adjustment.</p>\n\n<pre><code>table.ListColumns(\"Product\").Index  '&lt;== Gives your 8 for Field:=\n</code></pre>\n\n<p>You can also use Find on HeaderRowRange</p>\n\n<pre><code>Option Explicit\nPublic Sub Test()\n    Dim table As ListObject, field1 As Range, fieldFilter1 As Long\n    Set table = ActiveSheet.ListObjects(\"Capacity_Model\")\n\n    Set field1 = table.HeaderRowRange.Find(\"Product\")\n    If Not field1 Is Nothing Then\n        fieldFilter1 = field1.Column\n    End If\n    Debug.Print table.ListColumns(\"Product\").Index\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10890055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af29070633b3d0113872b78434f09d04?s=128&d=identicon&r=PG&f=1", "display_name": "Will G.", "link": "https://stackoverflow.com/users/10890055/will-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 526, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1547046698, "creation_date": 1547044208, "last_edit_date": 1547044458, "question_id": 54112389, "link": "https://stackoverflow.com/questions/54112389/vba-how-to-filter-using-table-headings", "title": "VBA: How to filter using table headings", "body": "<p>I've created a macro button named \u201cMCO Projects\u201d which when clicked will filter my spreadsheet to only filter active MCO projects (looks for \u201cMCO\u201d in the Product column H and Phase 2b and Phase 3 in Phase-Gate Phase column R). It works fine now. However, the issue I\u2019m having is if were to add a column to the spreadsheet before column H \"Field 8\" or between column H \"Field 8\" and column R \"Field 18\" (anything before the product column and the Phase-Gate Phase) it will throw off the macro calculation. For example, if I were to add a new column after column \u201cG\u201d it would mess up the macro and the projects would not filter correctly. </p>\n\n<p>The goal is when clicking the \"MCO Projects\" macro button to filter the table by Product(Header) to look for \"MCO\" (Currently Field \"8\"). And to filter the Phase-Gate Phase(Header)(Currently Field \"18\") to include both \"Phase 3\" and \"Phase 2b\". So does anyone know of a way for the macro to look specifically at the Product column? Regardless if a column were to be added or deleted? Any help/guidance that you can provide would be greatly appreciated.</p>\n\n<p>VBA Code<img src=\"https://i.stack.imgur.com/9SGxe.jpg\" alt=\"\"></p>\n\n<p>Table Screenshot<img src=\"https://i.stack.imgur.com/zoFJ2.jpg\" alt=\"\"></p>\n"}, {"tags": ["excel", "vba", "wildcard", "file-exists"], "comments": [{"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1547043625, "post_id": 54112131, "comment_id": 95056503, "body": "What do you mean with random? Any rules how the portion _0107_1999986 is derived resp. composed at run time of your code?"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1547044278, "post_id": 54112131, "comment_id": 95056955, "body": "See if this answer helps --&gt; <a href=\"https://stackoverflow.com/a/54101760/4839827\">stackoverflow.com/a/54101760/4839827</a>"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1547044331, "post_id": 54112131, "comment_id": 95056990, "body": "The documentation of <code>fileExists</code> does not say it accepts wildcards, only full file/pathnames. So you cannot use this method to determine if a file with a variable part in its filename exists."}, {"owner": {"reputation": 1, "user_id": 10890165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f112bdc727bd439bb7062c9ff4ebfeca?s=128&d=identicon&r=PG&f=1", "display_name": "HarNar", "link": "https://stackoverflow.com/users/10890165/harnar"}, "edited": false, "score": 0, "creation_date": 1547044488, "post_id": 54112131, "comment_id": 95057101, "body": "That&#39;s the issue, no rules that i could easily figure out on the &quot;_0107_1999986&quot; portion. As far as i can tell it is probably a proprietary tag that our vendor uses."}, {"owner": {"reputation": 18939, "user_id": 2756409, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UIrGI.jpg?s=128&g=1", "display_name": "TylerH", "link": "https://stackoverflow.com/users/2756409/tylerh"}, "edited": false, "score": 0, "creation_date": 1547044800, "post_id": 54112131, "comment_id": 95057321, "body": "I expect you could use a combination of two regular expressions to say if the file name begins with <code>Now, YYYYMMDD</code> and ends with <code>Now-1,YYYYMMDD</code>, then do whatever you need to. Have you worked with regex before?"}], "answers": [{"comments": [{"owner": {"reputation": 18939, "user_id": 2756409, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UIrGI.jpg?s=128&g=1", "display_name": "TylerH", "link": "https://stackoverflow.com/users/2756409/tylerh"}, "edited": false, "score": 1, "creation_date": 1547045372, "post_id": 54112655, "comment_id": 95057693, "body": "Have you tested this? The way the answer is worded makes it sound like you&#39;re just guessing."}, {"owner": {"reputation": 1, "user_id": 10890165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f112bdc727bd439bb7062c9ff4ebfeca?s=128&d=identicon&r=PG&f=1", "display_name": "HarNar", "link": "https://stackoverflow.com/users/10890165/harnar"}, "edited": false, "score": 0, "creation_date": 1547045619, "post_id": 54112655, "comment_id": 95057887, "body": "This is what I intially thought however, when using &quot;*&quot; in place of random porition the result is ALWAYS &quot;Check Later&quot;. Which shouldn&#39;t be the case."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1547046717, "post_id": 54112655, "comment_id": 95058626, "body": "I tested Paul&#39;s code and it&#39;s working for me. If there is a file like 20190109xyz20190108.csv in the directoy  I get the message &quot;Proceed&quot;. So, are you sure about the naming &lt;date&gt;*&lt;date -1&gt;.csv"}, {"owner": {"reputation": 1, "user_id": 10890165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f112bdc727bd439bb7062c9ff4ebfeca?s=128&d=identicon&r=PG&f=1", "display_name": "HarNar", "link": "https://stackoverflow.com/users/10890165/harnar"}, "reply_to_user": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1547047504, "post_id": 54112655, "comment_id": 95059106, "body": "@Storax Strange, still not working for me. I&#39;m sure about the naming convention. If I hardcode the &quot;xyz&quot; in the code results in proceed. Once i change the &quot;xyz&quot; to &quot;*&quot; it results in &quot;Check later&quot;."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1547048328, "post_id": 54112655, "comment_id": 95059615, "body": "Ok, then I do not know what &#39;s wrong. As said the code is working fine for me."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "reply_to_user": {"reputation": 1, "user_id": 10890165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f112bdc727bd439bb7062c9ff4ebfeca?s=128&d=identicon&r=PG&f=1", "display_name": "HarNar", "link": "https://stackoverflow.com/users/10890165/harnar"}, "edited": false, "score": 0, "creation_date": 1547058172, "post_id": 54112655, "comment_id": 95065092, "body": "@harnar you did change from FileExists to Dir, right?  This code <i>should</i> work for you?"}, {"owner": {"reputation": 1, "user_id": 10890165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f112bdc727bd439bb7062c9ff4ebfeca?s=128&d=identicon&r=PG&f=1", "display_name": "HarNar", "link": "https://stackoverflow.com/users/10890165/harnar"}, "edited": false, "score": 0, "creation_date": 1547147286, "post_id": 54112655, "comment_id": 95102231, "body": "I was able to figure out a workaround, appreciate the help!"}], "tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 0, "last_activity_date": 1547045093, "creation_date": 1547045093, "answer_id": 54112655, "question_id": 54112131, "link": "https://stackoverflow.com/questions/54112131/how-to-run-a-fileexists-check-with-a-partial-filename-wildcard/54112655#54112655", "title": "How to run a fileExists check with a partial filename wildcard?", "body": "<p>The following could work:</p>\n\n<pre><code>Sub Example()\n    Dim myPathAndFile, c\n\n    myPathAndFile = \"M:\\Fake\\FakeXfer\\\" + Format(Now, \"YYYYMMDD\") + \"*\" + Format(Now - 1, \"YYYYMMDD\") + \".csv\"\n\n    c = Dir(myPathAndFile)\n    If (c = \"\") Then\n        MsgBox \"Check Later\"\n    Else\n        MsgBox \"Proceed\"\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Possibly the wild card in the middle of the filename won't work. Then use it as the last part before the extension and iterate over the results to validate the last part of the name.</p>\n"}], "owner": {"reputation": 1, "user_id": 10890165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f112bdc727bd439bb7062c9ff4ebfeca?s=128&d=identicon&r=PG&f=1", "display_name": "HarNar", "link": "https://stackoverflow.com/users/10890165/harnar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1059, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1547045093, "creation_date": 1547043342, "last_edit_date": 1547044046, "question_id": 54112131, "link": "https://stackoverflow.com/questions/54112131/how-to-run-a-fileexists-check-with-a-partial-filename-wildcard", "title": "How to run a fileExists check with a partial filename wildcard?", "body": "<p>I have my fileExists code set up as below, however a portion of the file name (<code>_0107_1999986</code> below) is random and changes daily. Any idea how to wildcard that portion of the code so that the fileExists function results in a \"proceed\" if the other criteria is met? </p>\n\n<pre><code>Dim c As Boolean\n\nSet fs = CreateObject(\"Scripting.FileSystemObject\")\n\nc = fs.fileExists(\"M:\\Fake\\FakeXfer\\\" + Format(Now,\"YYYYMMDD\") + \"_0107_1999986\" + Format(Now-1, \"YYYYMMDD\") + \".csv\"\n\nIF Not c Then\n    MsgBox \"Check Later\"\nElse\n    MsgBox \"Proceed\"\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "rows"], "comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1547042182, "post_id": 54111624, "comment_id": 95055607, "body": "Have a look at the methods here --&gt; <a href=\"https://stackoverflow.com/questions/30959315/excel-vba-performance-1-million-rows-delete-rows-containing-a-value-in-less\" title=\"excel vba performance 1 million rows delete rows containing a value in less\">stackoverflow.com/questions/30959315/&hellip;</a>"}, {"owner": {"reputation": 189, "user_id": 9609148, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Pablo G", "link": "https://stackoverflow.com/users/9609148/pablo-g"}, "edited": false, "score": 1, "creation_date": 1547043192, "post_id": 54111624, "comment_id": 95056197, "body": "Did you try deleting the rows when a blank cell is found in the range in the loop instead of creating an array?"}, {"owner": {"reputation": 172, "user_id": 10627624, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-q24pnMMCBhM/AAAAAAAAAAI/AAAAAAAAAI0/9V6VmJktiDI/photo.jpg?sz=128", "display_name": "Alexey C", "link": "https://stackoverflow.com/users/10627624/alexey-c"}, "edited": false, "score": 0, "creation_date": 1547043203, "post_id": 54111624, "comment_id": 95056207, "body": "Your code works correctly on my PC. Are u sure, that u have list &quot;Quotation&quot; in your workbook?"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 9468822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/020dba9a3ed851ab7c208e2d88b1be77?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Gerry", "link": "https://stackoverflow.com/users/9468822/ben-gerry"}, "edited": false, "score": 0, "creation_date": 1547044435, "post_id": 54112195, "comment_id": 95057060, "body": "Thank you, Tiger. I will certainly review other options and just choose something a little quicker and easier. I like the way you have whittled down my code into something more compact. One question: your final row reads &quot;... rDel.EntireRow.Delete&quot; with rDel being your collection of rows to be deleted, right? So, in my original code, why does &quot;Amass.EntireRow.Delete&quot; not work? Is there something wrong with my range?"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 15, "user_id": 9468822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/020dba9a3ed851ab7c208e2d88b1be77?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Gerry", "link": "https://stackoverflow.com/users/9468822/ben-gerry"}, "edited": false, "score": 0, "creation_date": 1547044580, "post_id": 54112195, "comment_id": 95057170, "body": "@BenGerry I am unable to reproduce the error you&#39;re getting.  Your code runs fine in my test workbook."}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": false, "score": 1, "last_activity_date": 1547043609, "creation_date": 1547043609, "answer_id": 54112195, "question_id": 54111624, "link": "https://stackoverflow.com/questions/54111624/how-to-delete-many-rows-at-once-without-getting-an-error-regarding-delete-metho/54112195#54112195", "title": "How to delete many rows at once without getting an error regarding &#39;Delete method of the range class&#39;?", "body": "<p>I think something like this is what you're looking for:</p>\n\n<pre><code>Sub tgr()\n\n    Dim ws As Worksheet\n    Dim rCheck As Range\n    Dim rDel As Range\n\n    Set ws = ActiveWorkbook.Sheets(\"Quotation\")\n\n    For Each rCheck In ws.Range(\"I17\", ws.Cells(ws.Rows.Count, \"I\").End(xlUp)).Cells\n        If IsEmpty(rCheck) Then\n            If Not rDel Is Nothing Then Set rDel = Union(rDel, rCheck) Else Set rDel = rCheck\n        End If\n    Next rCheck\n\n    If Not rDel Is Nothing Then rDel.EntireRow.Delete\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 9468822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/020dba9a3ed851ab7c208e2d88b1be77?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Gerry", "link": "https://stackoverflow.com/users/9468822/ben-gerry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1547045657, "creation_date": 1547041671, "last_edit_date": 1547045657, "question_id": 54111624, "link": "https://stackoverflow.com/questions/54111624/how-to-delete-many-rows-at-once-without-getting-an-error-regarding-delete-metho", "title": "How to delete many rows at once without getting an error regarding &#39;Delete method of the range class&#39;?", "body": "<p>In this sheet, I am trying to search in a range for empty cells, and deleting their respective rows.</p>\n\n<pre><code>Sub Delete()\n\n'Amass row numbers\nDim B, Blank As Range\nDim Deletion() As Long\nDim D As Long\n\nSet Blank = Sheets(\"Quotation\").Range(\"I17:I3816\")\n\nD = 0\n\nFor Each B In Blank\n\n    If IsEmpty(B) Then\n\n        D = D + 1\n\n        ReDim Preserve Deletion(D)\n\n        Deletion(D) = B.Row\n\n    End If\n\nNext B\n\nDim Amass As Range\n\n'A starting point for the Amass range - should it need one pre-Union?\nSet Amass = Sheets(\"Quotation\").Range(\"10000:10000\")\n\n'Amass rows\nFor i = 1 To D\n\n    Set Amass = Union(Amass, Sheets(\"Quotation\").Range(Deletion(i) &amp; \":\" &amp; Deletion(i)))\n\nNext i\n\n'Delete rows\nAmass.EntireRow.Delete\n\nEnd Sub\n</code></pre>\n\n<p>It fails on the last action, with the error:</p>\n\n<blockquote>\n  <p>\"Delete method of the range class failed\"</p>\n</blockquote>\n\n<p>Am I using the array and \"ReDim Preserve\" correctly?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 332, "user_id": 5385295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f39bf2c6f6b71e1d81f6c49671ec7907?s=128&d=identicon&r=PG&f=1", "display_name": "David Brunning", "link": "https://stackoverflow.com/users/5385295/david-brunning"}, "edited": false, "score": 0, "creation_date": 1547041744, "post_id": 54111554, "comment_id": 95055326, "body": "In <code>Range(&quot;l2&quot;).Offset(((t - 1) * lngDataColumns) - 1, 0).Resize(lngDataColumns, 1).Value = _         Application.Transpose(Range(&quot;f1:h1&quot;).Value)</code>  Range(&quot;L2&quot;) and Range(&quot;F1:H1&quot;) are both in the same sheet. Are you copying the values to be transposed to L2? Or are you just not referencing the correct sheet?"}], "answers": [{"tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": false, "score": 1, "last_activity_date": 1547041791, "creation_date": 1547041791, "answer_id": 54111666, "question_id": 54111554, "link": "https://stackoverflow.com/questions/54111554/why-is-my-sub-deleting-a-row-of-data-in-my-other-sheet-vba/54111666#54111666", "title": "why is my sub, deleting a row of data in my other sheet - VBA", "body": "<p>To avoid this kind of issues, <strong>always qualify your objects fully</strong>.\nWhere you write <code>Range(\"A1\")</code>, you should instead write: </p>\n\n<pre><code>ThisWorkbook.Sheets(\"Your sheet\").Range(\"A1\")\n</code></pre>\n\n<p>Where: </p>\n\n<ul>\n<li><code>ThisWorkbook</code> qualifies the object in the workbook where the code is running (the default, instead, is <code>ActiveWorkbook</code> which might be something else in the moment where the code runs).</li>\n<li><code>Sheets(\"Your sheet\")</code> makes sure you run in the good worksheet.</li>\n</ul>\n\n<p>This is of course to be done everywhere you say just <code>Range(\"something\")</code>.</p>\n\n<p><strong>Tip:</strong> if you think your code would get heavy by doing this, then you can define your range on top of your code and use it by name lately, for example: </p>\n\n<pre><code>Dim myRng1 As Range: Set myRng1 = ThisWorkbook.Sheets(\"Your sheet\").Range(\"your range\")\n...\n...\nmyRng1.DoSomething()\nmyRng1.DoSomethingElse()\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1547046138, "creation_date": 1547046138, "answer_id": 54112973, "question_id": 54111554, "link": "https://stackoverflow.com/questions/54111554/why-is-my-sub-deleting-a-row-of-data-in-my-other-sheet-vba/54112973#54112973", "title": "why is my sub, deleting a row of data in my other sheet - VBA", "body": "<p>You can use:</p>\n\n<pre><code>Option Explicit\n\nSub Test()\n\n    With ws1\n        .Range(\"A1\").Select\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>If you use the name outside the brackets:</p>\n\n<p><a href=\"https://i.stack.imgur.com/A3nob.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/A3nob.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>or</p>\n\n<pre><code>Option Explicit\n\nSub Test()\n\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n        .Range(\"A1\").Select\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>you use the name in the brackets:</p>\n\n<p><a href=\"https://i.stack.imgur.com/WZ2HX.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WZ2HX.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6932188"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1547046965, "creation_date": 1547041438, "last_edit_date": 1547046965, "question_id": 54111554, "link": "https://stackoverflow.com/questions/54111554/why-is-my-sub-deleting-a-row-of-data-in-my-other-sheet-vba", "title": "why is my sub, deleting a row of data in my other sheet - VBA", "body": "<p>I have 2 sheets \"Ark1\" and \"Ark2\". i get my data from \"Ark2\" and put them in \"Ark1\". my \"Sub X\" fuction should transpose the data from horizontal to vertical with the dates. But when i run \"sub x\" it is deleting a row of data in \"Ark2\" where i get my data. I have all the code in one module. </p>\n\n<pre><code>    Sub x()\n\nDim lngDataColumns As Long\nDim lngDataRows As Long\n\nlngDataColumns = 3\nlngDataRows = 50\n\n\nFor t = 1 To lngDataRows\n\nRange(\"l2\").Offset(((t - 1) * lngDataColumns) - 1, 0).Resize(lngDataColumns, 1).Value = _\n        Application.Transpose(Range(\"f1:h1\").Value)\n\nRange(\"M2\").Offset(((t - 1) * lngDataColumns) - 1, 0).Resize(lngDataColumns, 1).Value = _\n        Application.Transpose(Range(\"f1:h1\").Offset(t).Value)\n\nNext t\n\nEnd Sub\n</code></pre>\n\n<p>Here is a pictuere of the deleted data. </p>\n\n<p><a href=\"https://i.stack.imgur.com/Fazqz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Fazqz.png\" alt=\"deleted data\"></a></p>\n\n<p>and here is a picture of what i wnat it to do in \"Ark1\" painted in colours.</p>\n\n<p>i hope you can help</p>\n\n<p><a href=\"https://i.stack.imgur.com/p3eCw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/p3eCw.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1547042266, "post_id": 54111524, "comment_id": 95055664, "body": "If you want to save space, try saving the file as <code>.xlsb</code>"}, {"owner": {"reputation": 9, "user_id": 10889887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d62db409a5d83e8f02231b55307f19ed?s=128&d=identicon&r=PG&f=1", "display_name": "Schattenreve", "link": "https://stackoverflow.com/users/10889887/schattenreve"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1547043702, "post_id": 54111524, "comment_id": 95056551, "body": "Will this format support all the pivot tables and slicers? The &quot;executive master&quot; created in the 5th step is about 30 Mo in size, the files that the macro creates from this master are 55 Mo..."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1547043798, "post_id": 54111524, "comment_id": 95056611, "body": "Yes, it does. :)"}, {"owner": {"reputation": 9, "user_id": 10889887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d62db409a5d83e8f02231b55307f19ed?s=128&d=identicon&r=PG&f=1", "display_name": "Schattenreve", "link": "https://stackoverflow.com/users/10889887/schattenreve"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1547043842, "post_id": 54111524, "comment_id": 95056644, "body": "Thank you, will try this :)"}, {"owner": {"reputation": 9, "user_id": 10889887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d62db409a5d83e8f02231b55307f19ed?s=128&d=identicon&r=PG&f=1", "display_name": "Schattenreve", "link": "https://stackoverflow.com/users/10889887/schattenreve"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1547044658, "post_id": 54111524, "comment_id": 95057220, "body": "Sadly did not even save 1kb :("}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1547045177, "post_id": 54111524, "comment_id": 95057554, "body": "You can check if there are excess formatting, review this --&gt; <a href=\"https://support.office.com/en-us/article/clean-excess-cell-formatting-on-a-worksheet-e744c248-6925-4e77-9d49-4874f7474738\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>. Also, if you are using pivottables, here are some space saving ideas --&gt; <a href=\"http://nhsexcel.com/massive-excel-spreadsheets-how-to-reduce-the-size-of-pivot-table-workbooks/\" rel=\"nofollow noreferrer\">nhsexcel.com/&hellip;</a>. Keep in mind, without the actual spreadsheet, it&#39;s hard to know for sure what&#39;s up."}, {"owner": {"reputation": 9, "user_id": 10889887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d62db409a5d83e8f02231b55307f19ed?s=128&d=identicon&r=PG&f=1", "display_name": "Schattenreve", "link": "https://stackoverflow.com/users/10889887/schattenreve"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1547049270, "post_id": 54111524, "comment_id": 95060274, "body": "I know that it is hard to spot the issue without the file, this contains way too much sensitive information though. Also, I am pretty sure that it has something to do with my macro, as if I o the same manually, the resulting files are ranging between 5 and 15 Mo. I am editing my initial request to attach my macro, I&#39;ve replaced all sensitive information of this macro to share with you."}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1552295084, "post_id": 54111524, "comment_id": 96939738, "body": "There is something obvious missing in this question.... The code!"}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 10889887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d62db409a5d83e8f02231b55307f19ed?s=128&d=identicon&r=PG&f=1", "display_name": "Schattenreve", "link": "https://stackoverflow.com/users/10889887/schattenreve"}, "edited": false, "score": 0, "creation_date": 1547105431, "post_id": 54113306, "comment_id": 95078948, "body": "There is no corrupted data in the files, I did plenty of checks."}], "tags": [], "owner": {"reputation": 11, "user_id": 9252551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eed77b204053a0ab7ab3439af66ba6fc?s=128&d=identicon&r=PG&f=1", "display_name": "Loading...", "link": "https://stackoverflow.com/users/9252551/loading"}, "is_accepted": false, "score": 1, "last_activity_date": 1547047337, "creation_date": 1547047337, "answer_id": 54113306, "question_id": 54111524, "link": "https://stackoverflow.com/questions/54111524/my-macro-makes-the-file-size-larger-although-it-deletes-information/54113306#54113306", "title": "My macro makes the file size larger although it deletes information", "body": "<p>Ran a quick test and it may be related to the data in the file being corrupted. </p>\n\n<ul>\n<li>\"TestSize1\" files are only containing data values</li>\n<li>\"TestSize2\" files are only containing of excel functions</li>\n<li>\"TestSize3\" files are only containing of formatting</li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/yUEPG.png\" rel=\"nofollow noreferrer\">Windows File Explorer - Test</a></p>\n\n<p>I am only seeing a minor increase in file size on the \"Values only\" or \"TestSize1\" workbook.  I do believe you shouldn't see a size increase unless the data in the workbook is corrupted for your case.  This file type just permits the additional save of features, such as Macros/VBA code. </p>\n\n<p><a href=\"http://www.excel4business.com/excel-blog/articles/2012/12/04/xlsb-as-an-alternative-to-xlsx-xlsm.html\" rel=\"nofollow noreferrer\">\"The first is the default XLSX, then there's XLSM which is identical to XLSX except it can contain macros...\"</a></p>\n\n<p>I would look into copying just the data values out into a New workbook and save that as <code>.xlsb</code>. It should reduce the size (obviously), but also it removes features that excel maybe misreading or corrupted.  After that open the <code>.xlsb</code> in a restarted window of excel (maybe restart your computer before as well to clear cache) and attempt saving back to whatever format you prefer. Add function and formatting to restore the document.</p>\n\n<p>This has worked for me, off and on, for recovering large <code>.csv</code> files.  I hope it works for you.</p>\n"}], "owner": {"reputation": 9, "user_id": 10889887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d62db409a5d83e8f02231b55307f19ed?s=128&d=identicon&r=PG&f=1", "display_name": "Schattenreve", "link": "https://stackoverflow.com/users/10889887/schattenreve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1210, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1552294979, "creation_date": 1547041341, "last_edit_date": 1547105798, "question_id": 54111524, "link": "https://stackoverflow.com/questions/54111524/my-macro-makes-the-file-size-larger-although-it-deletes-information", "title": "My macro makes the file size larger although it deletes information", "body": "<p>I am using a macro to create individual reports for different stakeholders in the company. The problem is that the files saved by the macro are larger than the parent files.\nPlease mind:</p>\n\n<ul>\n<li>There are no \"Empty lines\" taking up space.</li>\n<li>There are no connections to external sources in the outcome files.</li>\n<li>There is no macro in any file (original or outcome).</li>\n<li>I did see a very similar post from a couple of years ago but this had no satisfying answer. Although someone hinted at the command used to save, this is the one I use :<br>\nActiveWorkbook.SaveAs Filename:=\"C:\\path\\\" &amp; WR_Date &amp; \"<em>Monthly-Report</em>\" &amp; Partner &amp; \".xlsx \"</li>\n</ul>\n\n<p>(<a href=\"https://stackoverflow.com/questions/37348628/excel-macros-file-size\">Excel Macros file size</a>)</p>\n\n<p>Below is a recap of the steps done by the macro.</p>\n\n<ol>\n<li>Macro opens \"Master workbook\"</li>\n<li>Deletes all external connections (OLAP) </li>\n<li>Deletes calculations in the tables (copy as simple values)</li>\n<li>Deletes reconciliation table sheets</li>\n<li>Saves 4 files (Division master, Country master, Territory master, Partner master).</li>\n<li>Uses these master files to delete all irrelevant data for the stakeholder.</li>\n<li>Update all pivot caches (settings of all pivotes to not keep memory anyway.</li>\n<li>Protects all worksheets and the workbook.</li>\n<li>Saves the files with the correct names.</li>\n</ol>\n\n<p>As per the discussion in below comments, I am pasting my macro below. The replace all function was used to remove any kind of sensitive information, sometimes the result may be weirs but it should definitely be enough to spot the issue.</p>\n\n<p>I am pretty sure that the macro is causing this: if I replicate the steps done by the macro the size of the files is much smaller (5-15 Mo vs 50-60 Mo).</p>\n\n<p>Also, the territory reports are normal sized. The country and division files are bigger than their master file, the partner files are also too big.</p>\n\n<p>EDIT:\nAfter plenty of checks, I have found the begining of an answer, it seems to be related to the way the pivot tables are refreshed. My code was going like this:</p>\n\n<pre><code>ActiveWorkbook.RefreshAll\nFor Each pc In ActiveWorkbook.PivotCaches\n    pc.Refresh\nNext pc\n</code></pre>\n\n<p>I have now removed the \"Refresh all\" prior to refreshing the pivot cache and save about 20 Mo per Division and Country file. This is still not entirely satisfactory since the division and country files still are around the same size as their parent or bigger but these reports need to be posted today.</p>\n\n<p>I'll keep on looking but will definitely try to poste you a full resolution by next month!</p>\n"}, {"tags": ["excel", "vba", "loops"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1547041393, "post_id": 54111467, "comment_id": 95055129, "body": "<code>.Row</code> and <code>.Column</code>?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1547042946, "post_id": 54111467, "comment_id": 95056043, "body": "The index you&#39;d need to calculate, as youre using for each, it will be dependant on the collection your iterating.  In the question, you need to use the differences between myrange.cells(1,1).row and cell.row and myrange.cells(1,1).column and cell.column accordingly, not very readable :o)"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1547043259, "post_id": 54111467, "comment_id": 95056243, "body": "Also, you need to think about the index, in the question you&#39;re using a range, this will be looped horizontal then vertical, so in a 3x3 range, the 3rd index will be the last cell on the 1st row, not the last cell of the 1st column"}, {"owner": {"reputation": 43, "user_id": 4329947, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-m0SULvywgiU/AAAAAAAAAAI/AAAAAAAAAEk/qilZV6_Q2fM/photo.jpg?sz=128", "display_name": "John Owens", "link": "https://stackoverflow.com/users/4329947/john-owens"}, "edited": false, "score": 0, "creation_date": 1547224885, "post_id": 54111467, "comment_id": 95132379, "body": "the row or column doesn&#39;t matter. i just want to know if there&#39;s an index telling me the number of loops i&#39;ve done in the for each as i&#39;m going. i don&#39;t know how for each works &quot;under the hood&quot;, so to speak. What it&#39;s looping on in this case may be a range of cells, but that&#39;s just the example i&#39;m using to illustrate the question. It may not always be ranges that I am &quot;for-each&quot;ing through"}], "answers": [{"comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1547043637, "post_id": 54111692, "comment_id": 95056507, "body": "Be careful! There is no guarantee the for each will iterate sequentially over the collection or range. For example, the indexes of the elements of the for each could be 1, 7, 3, 8, 2,..."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1547044114, "post_id": 54111692, "comment_id": 95056826, "body": "This is true - which is why I specifired &quot;index of the loop it&#39;s in while executing&quot;. May I include your more exact comment in the answer, @PaulOgilvie?"}, {"owner": {"reputation": 43, "user_id": 4329947, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-m0SULvywgiU/AAAAAAAAAAI/AAAAAAAAAEk/qilZV6_Q2fM/photo.jpg?sz=128", "display_name": "John Owens", "link": "https://stackoverflow.com/users/4329947/john-owens"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1547225032, "post_id": 54111692, "comment_id": 95132462, "body": "@PaulOgilvie can you please elaborate on that? There must be some kind of lower level object that knows where the loop has been and where it&#39;s going."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1547226488, "post_id": 54111692, "comment_id": 95133233, "body": "The lower level data structure may be a linked list where items got added in the order they are created, or is an array where items get added in the first available free slot yet get an index that is last+1, or is some other data structure. Walking this data structure in the for-each retrieves the items in this internal order (next list element, next array element). But since we don&#39;t know the implementation of this lower level object, we don&#39;t know in which order the items are retrieved."}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 0, "last_activity_date": 1547041902, "creation_date": 1547041902, "answer_id": 54111692, "question_id": 54111467, "link": "https://stackoverflow.com/questions/54111467/can-i-reference-the-index-of-a-for-each-loop-without-a-counter/54111692#54111692", "title": "Can i reference the index of a &quot;for each&quot; loop without a counter?", "body": "<p>The general answer is, no, VBA does not provide a way to ascertain the \"index\" of the loop it's in while executing <code>For Each</code>. You might be able to calculate it, as is suggested in a comment, depending on what the object is. But there's nothing inherent in VBA that can do this for you. A counter is, indeed, the only way that \"always\" works.</p>\n"}], "owner": {"reputation": 43, "user_id": 4329947, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-m0SULvywgiU/AAAAAAAAAAI/AAAAAAAAAEk/qilZV6_Q2fM/photo.jpg?sz=128", "display_name": "John Owens", "link": "https://stackoverflow.com/users/4329947/john-owens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1547041902, "creation_date": 1547041131, "question_id": 54111467, "link": "https://stackoverflow.com/questions/54111467/can-i-reference-the-index-of-a-for-each-loop-without-a-counter", "title": "Can i reference the index of a &quot;for each&quot; loop without a counter?", "body": "<p>I am wondering if there is an index attribute for the object of a for each loop. </p>\n\n<p>The simple answer is to include a counter variable within the for each loop, independent from the loop itself (as i have done with the i variable in the code) and create the index as you go, but i'm wondering if there is a way of getting the index directly from the loop construct?</p>\n\n<pre><code>i = 1\nFor Each cell In rRange\n    MsgBox cell.Index???\n    MsgBox i\n\n    i = i + 1\nNext cell\n</code></pre>\n\n<p>Obviously, in the case of the code i have provided index is not an attribute I can use. Is there an attribute there which would work like this?</p>\n"}, {"tags": ["excel", "vba", "hidden", "countif"], "answers": [{"tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1547041272, "creation_date": 1547041272, "answer_id": 54111507, "question_id": 54111274, "link": "https://stackoverflow.com/questions/54111274/vba-count-cells-that-are-hidden-and-have-specific-value/54111507#54111507", "title": "VBA - Count cells that are hidden and have specific value", "body": "<p>You can use this code as a base, it counts hidden cells with value of <code>\"ABC\"</code> in specified range:</p>\n\n<pre><code>Sub CountHiddenCellsInRange()\n    Dim rng As Range, hiddenCells As Long, c As Range\n    hiddenCells = 0\n    Set rng = Range(\"A1:B5\")\n    For Each c In rng\n        If (Rows(c.Row).Hidden Or Columns(c.Column).Hidden) And c.Value = \"ABC\" Then hiddenCells = hiddenCells + 1\n    Next\n    MsgBox hiddenCells\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": true, "score": 3, "last_activity_date": 1547055337, "last_edit_date": 1547055337, "creation_date": 1547042598, "answer_id": 54111931, "question_id": 54111274, "link": "https://stackoverflow.com/questions/54111274/vba-count-cells-that-are-hidden-and-have-specific-value/54111931#54111931", "title": "VBA - Count cells that are hidden and have specific value", "body": "<h1>Special Cells feat. Areas</h1>\n\n<ul>\n<li>When you are selecting SpecialCells(<strong>12</strong>) or\nSpecialCells(<strong>xlCellTypeVisible</strong>) you are selecting the visible\ncells not the invisible that you need.</li>\n<li>Don't know exactly what's going on, but it seems like <strong>CountIf</strong>\ndoesn't work with non-contiguous ranges.</li>\n<li>So you could loop through the ranges in a non-contiguous range using\n<strong>Areas</strong>.</li>\n</ul>\n\n<h2>The Code</h2>\n\n<pre><code>Sub Count_hidden_ABC()\n\n    Dim s As Long\n    Dim Rg As Range\n    Dim rng As Range\n    Set Rg = Worksheets(\"Sheet1\").Range(\"G8:G255\")\n\n    For Each rng In Rg.SpecialCells(12).Areas\n        s = s + WorksheetFunction.CountIf(rng, \"ABC\")\n    Next\n\n    s = WorksheetFunction.CountIf(Rg, \"ABC\") - s\n    'Debug.Print s\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 201, "user_id": 7100507, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e7aa468c7675dded6914116fd960d45d?s=128&d=identicon&r=PG&f=1", "display_name": "Z117", "link": "https://stackoverflow.com/users/7100507/z117"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 189, "favorite_count": 0, "accepted_answer_id": 54111931, "answer_count": 2, "score": 1, "last_activity_date": 1547055337, "creation_date": 1547040487, "last_edit_date": 1547046978, "question_id": 54111274, "link": "https://stackoverflow.com/questions/54111274/vba-count-cells-that-are-hidden-and-have-specific-value", "title": "VBA - Count cells that are hidden and have specific value", "body": "<p>I'm trying to figure out how I can write a VBA code that counts how many of the cells in my range are hidden AND have a specific value.</p>\n\n<p>I've tried something like this, but it doesn't work:</p>\n\n<pre><code>Sub Count_hidden_ABC()\nDim s As Long\nDim Rg As Range\nSet Rg = Worksheets(\"Sheet1\").Range(\"G8:G255\")\ns = Application.WorksheetFunction.CountIfs(Rg, \"ABC\", Rg, SpecialValues(12))\n</code></pre>\n\n<p>or</p>\n\n<pre><code>Sub Count_hidden_ABC()\nDim s As Long\nDim Rg As Range\nSet Rg = Worksheets(\"Sheet1\").Range(\"G8:G255\")\ns = Rg.SpecialCells(12).Application.WorksheetFunction.CountIf(Rg, \"ABC\")\n</code></pre>\n\n<p>Anyone has a clue how to do this?</p>\n"}, {"tags": ["vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1547040504, "post_id": 54111135, "comment_id": 95054639, "body": "I&#39;m a bit confused. If the code is always importing the same file name then you mean you want to always create a new table with the same name? Or are you trying to <i>append</i> to the same table name?"}, {"owner": {"reputation": 25, "user_id": 10234429, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-04LGgTno7mw/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oViXq3frhTvWrTss7Zg8VvE3Fq9w/mo/photo.jpg?sz=128", "display_name": "Sushil Sharma", "link": "https://stackoverflow.com/users/10234429/sushil-sharma"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1547041279, "post_id": 54111135, "comment_id": 95055074, "body": "So if once i Import a csv file and I define it to strTable= &quot;StudentRecords&quot;, then the the imported excel file will be saved as &quot;StudentRecords&quot;. However when i import it next time a different csv file, it will also be saved as studentRecords so it will create duplicates table. When I import next time, I could set the strTable to a different name and it will be saved as different name in access. I am just looking for a quicker way if theres any to import excel files and save it as a new tables without changing the excel file name."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1547041546, "post_id": 54111135, "comment_id": 95055215, "body": "I&#39;m not understanding why you can&#39;t set strTable to the same value as the file name (strPathFile?). That also appears to be variable - changes each time? Or are you saying the csv file name is always &quot;StudentRecords&quot;? And what, all of a sudden, does Excel have to do with this? Are you looking for the <code>InputBox</code> function where you can type in a name?"}, {"owner": {"reputation": 25, "user_id": 10234429, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-04LGgTno7mw/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oViXq3frhTvWrTss7Zg8VvE3Fq9w/mo/photo.jpg?sz=128", "display_name": "Sushil Sharma", "link": "https://stackoverflow.com/users/10234429/sushil-sharma"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1547041961, "post_id": 54111135, "comment_id": 95055453, "body": "Csv file names are different but the table name in access is always the same.. e.g. if i import once it will be saved as studentrecords, if i import another csv at a different time it will be saved as studentrecords1 and so on..."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1547042482, "post_id": 54111135, "comment_id": 95055773, "body": "Yes, so assign the file name each time to <code>strTable</code>."}], "owner": {"reputation": 25, "user_id": 10234429, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-04LGgTno7mw/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oViXq3frhTvWrTss7Zg8VvE3Fq9w/mo/photo.jpg?sz=128", "display_name": "Sushil Sharma", "link": "https://stackoverflow.com/users/10234429/sushil-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1547040088, "creation_date": 1547040088, "question_id": 54111135, "link": "https://stackoverflow.com/questions/54111135/import-csv-file-from-vba-without-giving-a-table-name", "title": "Import csv file from vba without giving a table name", "body": "<p>I am trying to import a csv file from a directory into access database. I am able to import but whenever I import the name of the file gets changed and I dont want the filename to be changed. I want the table name as the same name as csv file. How do i do this? Here is my code:\nstrInitialDirectory = \"S:\\\"</p>\n\n<pre><code>strPathFile = ahtCommonFileOpenSave(InitialDir:=strInitialDirectory, _\n      Filter:=strFilter, OpenFile:=False, _\n      DialogTitle:=strBrowseMsg, _\n      Flags:=ahtOFN_HIDEREADONLY)\n\nIf strPathFile = \"\" Then\n      MsgBox \"No file was selected.\", vbOK, \"No Selection\"\n      Exit Sub\nEnd If\n\n' Replace tablename with the real name of the table into which\n' the data are to be imported\n  strTable = strPathFile\n\nDoCmd.TransferSpreadsheet acImport, acSpreadsheetTypeExcel9, strTable, strPathFile, blnHasFieldNames\n\nEnd Sub\n</code></pre>\n\n<p>If the csv file name is StudentRecords18/19.csv, then the table name should also be StudentRecords18/19. I can set this in strtable but I dont want to since I will importing different data each month hence it will contain the same table name with 1 and so on at the end but different data.. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1547039873, "post_id": 54110977, "comment_id": 95054232, "body": "Is <code>MapViewer1</code> still available?  Is the navigate line all one line or is the Sheets bit on a separate line?"}, {"owner": {"reputation": 25, "user_id": 5923460, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-GP0cRY5MihU/AAAAAAAAAAI/AAAAAAAAAj0/2xeHLnThQf0/photo.jpg?sz=128", "display_name": "\ud654\uc774\ud2b8\ucf00\uc774\ud06c", "link": "https://stackoverflow.com/users/5923460/%ed%99%94%ec%9d%b4%ed%8a%b8%ec%bc%80%ec%9d%b4%ed%81%ac"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1547040485, "post_id": 54110977, "comment_id": 95054625, "body": "The &quot;MapViewer1&quot; is available and <code>MapViewer1.Navigate (&quot;https:&#47;&#47;www.google.com&#47;maps&#47;d&#47;u&#47;0&#47;embed?mid=&quot; +  Sheets(&quot;Map&quot;).Range(&quot;D&quot; &amp; rowNum).Value)</code> is all one line"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1547041387, "post_id": 54110977, "comment_id": 95055125, "body": "Is the button on the same sheet as the webbrowser?"}, {"owner": {"reputation": 25, "user_id": 5923460, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-GP0cRY5MihU/AAAAAAAAAAI/AAAAAAAAAj0/2xeHLnThQf0/photo.jpg?sz=128", "display_name": "\ud654\uc774\ud2b8\ucf00\uc774\ud06c", "link": "https://stackoverflow.com/users/5923460/%ed%99%94%ec%9d%b4%ed%8a%b8%ec%bc%80%ec%9d%b4%ed%81%ac"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1547042397, "post_id": 54110977, "comment_id": 95055732, "body": "Yes. [filling15chars]"}, {"owner": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "edited": false, "score": 0, "creation_date": 1547053958, "post_id": 54110977, "comment_id": 95063162, "body": "@\ud654\uc774\ud2b8\ucf00\uc774\ud06c Can you tell whats the value in cell <code>Sheets(&quot;Map&quot;).Range(&quot;D1&quot;).Value</code>? Just trying to access the link in browser"}, {"owner": {"reputation": 25, "user_id": 5923460, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-GP0cRY5MihU/AAAAAAAAAAI/AAAAAAAAAj0/2xeHLnThQf0/photo.jpg?sz=128", "display_name": "\ud654\uc774\ud2b8\ucf00\uc774\ud06c", "link": "https://stackoverflow.com/users/5923460/%ed%99%94%ec%9d%b4%ed%8a%b8%ec%bc%80%ec%9d%b4%ed%81%ac"}, "edited": false, "score": 0, "creation_date": 1547080053, "post_id": 54110977, "comment_id": 95073033, "body": "No, sorry, I can&#39;t - due to the restrictions of data privacy. What I can tell you is that if you have a custom Google map with URL <code>https:&#47;&#47;www.google.com&#47;maps&#47;d&#47;u&#47;0&#47;embed?mid=xxxxxxxxxxxxxxxx&zwnj;&#8203;xxxxxxxxxxxxxxxxx</code>, the value was the <code>xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</code> part."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 5923460, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-GP0cRY5MihU/AAAAAAAAAAI/AAAAAAAAAj0/2xeHLnThQf0/photo.jpg?sz=128", "display_name": "\ud654\uc774\ud2b8\ucf00\uc774\ud06c", "link": "https://stackoverflow.com/users/5923460/%ed%99%94%ec%9d%b4%ed%8a%b8%ec%bc%80%ec%9d%b4%ed%81%ac"}, "edited": false, "score": 0, "creation_date": 1547080580, "post_id": 54111815, "comment_id": 95073157, "body": "The question is closed, but thank you for the willingness to help!"}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1547042249, "creation_date": 1547042249, "answer_id": 54111815, "question_id": 54110977, "link": "https://stackoverflow.com/questions/54110977/excel-vba-web-browser-run-time-error-424-object-required/54111815#54111815", "title": "Excel VBA Web Browser Run-time error &#39;424&#39; object required", "body": "<p>Not an answer, just somewhere to show code.</p>\n\n<p>I've tried the following, which allows me to debug each of the \"wrappers\" around the web browser, with the final object <code>w</code> being the browser.  Take a look at <code>Navigate2</code> also.  Check this code, make sure <code>s</code> and <code>o</code> and <code>w</code> are all populated.</p>\n\n<pre><code>Sub t()\n\nDim s As Shape\nDim o As OLEObject\nDim w As WebBrowser\n\nSet s = ActiveSheet.Shapes(\"mapviewer\")\nSet o = s.OLEFormat.Object\nSet w = o.Object\n\nw.Navigate \"www.google.co.uk\"\nw.Navigate2 \"\"  '   &lt;-- try this also\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 25, "user_id": 5923460, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-GP0cRY5MihU/AAAAAAAAAAI/AAAAAAAAAj0/2xeHLnThQf0/photo.jpg?sz=128", "display_name": "\ud654\uc774\ud2b8\ucf00\uc774\ud06c", "link": "https://stackoverflow.com/users/5923460/%ed%99%94%ec%9d%b4%ed%8a%b8%ec%bc%80%ec%9d%b4%ed%81%ac"}, "is_accepted": true, "score": 0, "last_activity_date": 1547079689, "creation_date": 1547079689, "answer_id": 54120372, "question_id": 54110977, "link": "https://stackoverflow.com/questions/54110977/excel-vba-web-browser-run-time-error-424-object-required/54120372#54120372", "title": "Excel VBA Web Browser Run-time error &#39;424&#39; object required", "body": "<p>I found out what was wrong for myself.</p>\n\n<p>It turned out that actually nothing was wrong with the workbook.<br>The computer which I worked on having the WebBrowser issue, had a registry key set to a value that disables some of the ActiveX controls.\n<hr>\nThe solution for anyone who would have the same problem with ActiveX can be found here: <a href=\"https://support.microsoft.com/en-us/help/2793374/cannot-insert-certain-scriptable-activex-controls-into-office-2013-doc\" rel=\"nofollow noreferrer\">LINK</a>.</p>\n"}], "owner": {"reputation": 25, "user_id": 5923460, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-GP0cRY5MihU/AAAAAAAAAAI/AAAAAAAAAj0/2xeHLnThQf0/photo.jpg?sz=128", "display_name": "\ud654\uc774\ud2b8\ucf00\uc774\ud06c", "link": "https://stackoverflow.com/users/5923460/%ed%99%94%ec%9d%b4%ed%8a%b8%ec%bc%80%ec%9d%b4%ed%81%ac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 509, "favorite_count": 0, "accepted_answer_id": 54120372, "answer_count": 2, "score": 0, "last_activity_date": 1547079689, "creation_date": 1547039520, "last_edit_date": 1547078890, "question_id": 54110977, "link": "https://stackoverflow.com/questions/54110977/excel-vba-web-browser-run-time-error-424-object-required", "title": "Excel VBA Web Browser Run-time error &#39;424&#39; object required", "body": "<p>I'm working with an Excel workbook that includes Google Maps in it. So far, everything worked correctly, but it suddenly started throwing a run-time error.</p>\n\n<p>The map is simply an ActiveX Microsoft Web Browser which is activated by a Button and reads a part of the map URL from a cell that is specified in a cell next to the Button.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n  Dim rowNum As Long\n  rowNum = Sheets(\"Map\").Range(\"B2\")\n  rowNum = rowNum - 43396\n  MapViewer1.Navigate (\"https://www.google.com/maps/d/u/0/embed?mid=\" + \nSheets(\"Map\").Range(\"D\" &amp; rowNum).Value)\n\nEnd Sub\n</code></pre>\n\n<p>So, as I said, this code worked for a long time, but it stopped and now reveals an error at the line \"MapViewer1.Navigate...\". Nobody else has modified the workbook's VBA. What can be the reason of that?</p>\n"}, {"tags": ["excel", "vba", "excel-formula", "vlookup"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1547039955, "post_id": 54110942, "comment_id": 95054289, "body": "You can use VLOOKUPS nested, so your first one will use MATCH in the column number part"}], "answers": [{"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1547040161, "creation_date": 1547040161, "answer_id": 54111166, "question_id": 54110942, "link": "https://stackoverflow.com/questions/54110942/vba-auto-vlookup-that-works-with-variable-range-in-multiple-different-sheets-ca/54111166#54111166", "title": "VBA Auto Vlookup That works with variable range in multiple different sheets, Can it be done?", "body": "<p>I have my data set up to simulate yours.</p>\n\n<p>I have my col x table in $G$3:$L$7 (im just using 1 to 5 as the left hand column for the VLOOKUP, in the example, looking for 3). and my translation table, the 2nd bit in $M$10:$N$13.</p>\n\n<p>Unfortunately I cant upload pictures at work.</p>\n\n<p>The formula is</p>\n\n<p><code>=VLOOKUP(VLOOKUP(3,$G$3:$L$7,MATCH(\"col 2\",$G$2:$L$2,0)),$M$10:$N$13,2,0)</code></p>\n"}], "owner": {"reputation": 59, "user_id": 3130187, "user_type": "registered", "profile_image": "https://graph.facebook.com/600561871/picture?type=large", "display_name": "Sniper", "link": "https://stackoverflow.com/users/3130187/sniper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1547046985, "creation_date": 1547039432, "last_edit_date": 1547046985, "question_id": 54110942, "link": "https://stackoverflow.com/questions/54110942/vba-auto-vlookup-that-works-with-variable-range-in-multiple-different-sheets-ca", "title": "VBA Auto Vlookup That works with variable range in multiple different sheets, Can it be done?", "body": "<p>I am trying to make The Vlookup Formula to work with multiple Excel Files (each File has a different columns arrangement),  the first row in all those Files has multiple IDs that represent a certain object.</p>\n\n<p>example (Words Translation):</p>\n\n<p>The Sheet is empty, only the top row has IDs, And each ID is in a separate Column.</p>\n\n<p>Let's say there is a Column with ID 10 And another Column with the ID 20 (Columns arrangement change with each file), And The Goal is to Vlookup what's in The Column that Contains The ID 10 and go to a Table array in another Sheet Called Transwords and look it up in both Columns A And B and get Translated word from The Second Column (which will be B in this case), then return the result in the first Sheet under the column that contains the ID 20.</p>\n\n<p>I have tried to do it myself but it didn't work because every excel file has different columns arrangement and I am trying to make the vlookup search columns with certain IDs , the columns could be A And E or D and F (it's the ID that matters) .. etc</p>\n\n<p>I asked a question earlier and got some help from the good people in here, but I didn't explain my problem well, they did help but they weren't aware of what I am trying to do.</p>\n\n<p>so my question is, Can it be done? Or I am trying to do something Impossible!</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1547040117, "post_id": 54110918, "comment_id": 95054404, "body": "Sumif() should do the trick.  that&#39;s just a formula in excel"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 10889751, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213560772596774/picture?type=large", "display_name": "Cuchy", "link": "https://stackoverflow.com/users/10889751/cuchy"}, "edited": false, "score": 0, "creation_date": 1547048877, "post_id": 54111355, "comment_id": 95059994, "body": "Hi Xabier,  I changed in your code:  &quot;=SUMIF(C[-7],R[-1]C[-7],C[-7])&quot;  to:  &quot;=SUMIF(C[-7],R[-1]C[-7],C[-0])&quot;  ... and it working as i want.  Can you please advise how to apply this also to SumUp Column &quot;J&quot; and column &quot;L&quot; and column &quot;P&quot;?  Thanks,  Peter."}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 25, "user_id": 10889751, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213560772596774/picture?type=large", "display_name": "Cuchy", "link": "https://stackoverflow.com/users/10889751/cuchy"}, "edited": false, "score": 0, "creation_date": 1547049002, "post_id": 54111355, "comment_id": 95060077, "body": "If my answer has helped, please could you mark my response as an answer? Thanks :) Regarding your comment I will reply when I&#39;m back on the laptop.."}, {"owner": {"reputation": 25, "user_id": 10889751, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213560772596774/picture?type=large", "display_name": "Cuchy", "link": "https://stackoverflow.com/users/10889751/cuchy"}, "edited": false, "score": 0, "creation_date": 1547049981, "post_id": 54111355, "comment_id": 95060743, "body": "Marked. I also already figured out how to apply your code for another columns, so thanks Xabier for help."}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": true, "score": 1, "last_activity_date": 1547040763, "creation_date": 1547040763, "answer_id": 54111355, "question_id": 54110918, "link": "https://stackoverflow.com/questions/54110918/sum-up-a-newly-inserted-blank-row/54111355#54111355", "title": "Sum up a newly inserted blank row", "body": "<p>The following code should help you achieve your expected results, when you insert a new row it adds a SumIf formula to that row summing the values from Column D, and finally it will do the same for the last row on your sheet:</p>\n\n<pre><code>Sub InsertRowsAtValueChangeColumnD()\n\n'--- INSERT CLEAR ROWS\n  Dim X As Long, LastRow As Long\n  Const DataCol As String = \"D\"\n  Const StartRow = 2\n  LastRow = Cells(Rows.Count, DataCol).End(xlUp).Row\n  Application.ScreenUpdating = False\n  For X = LastRow To StartRow + 1 Step -1\n    If Cells(X, DataCol).Value &lt;&gt; Cells(X - 1, DataCol).Value Then\n        Rows(X).Insert\n        Cells(X, \"K\").FormulaR1C1 = \"=SUMIF(C[-7],R[-1]C[-7],C[-7])\"\n    End If\n  Next\n  LastRow = Cells(Rows.Count, DataCol).End(xlUp).Row\n  Cells(LastRow + 1, \"K\").FormulaR1C1 = \"=SUMIF(C[-7],R[-1]C[-7],C[-7])\"\n  Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 164, "user_id": 6100889, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d668560e423af459bd8d8e701ac1cb72?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/6100889/tim"}, "is_accepted": false, "score": 0, "last_activity_date": 1547041031, "creation_date": 1547041031, "answer_id": 54111433, "question_id": 54110918, "link": "https://stackoverflow.com/questions/54110918/sum-up-a-newly-inserted-blank-row/54111433#54111433", "title": "Sum up a newly inserted blank row", "body": "<p>Try this put the code on your worksheet this will detect cell changes on column4 which is D. The active cell is for the cell that changed  and maybe you can put your logic in the if statement any problems please shout</p>\n\n<pre><code>    Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n     If (Target.Column = 4) Then\n     'MsgBox ActiveCell.Address\n      ActiveCell.EntireRow.Offset(1, 0).Insert\n      End If\n      End Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 10889751, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213560772596774/picture?type=large", "display_name": "Cuchy", "link": "https://stackoverflow.com/users/10889751/cuchy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 54111355, "answer_count": 2, "score": 0, "last_activity_date": 1547043291, "creation_date": 1547039358, "last_edit_date": 1547043291, "question_id": 54110918, "link": "https://stackoverflow.com/questions/54110918/sum-up-a-newly-inserted-blank-row", "title": "Sum up a newly inserted blank row", "body": "<p>I have 13 worksheets with similar data (each worksheet contains data for a different client). </p>\n\n<p>I need to do all these steps for each worksheet:</p>\n\n<ol>\n<li>Sort Data in Column \"D\" - Working </li>\n<li>Insert an empty row in each worksheet when a value has changed in column \"D\" - Working</li>\n<li>When a value has changed in Column \"D\" and I insert the empty row, all rows with same value in column \"D\" should Sum up in Column \"K\".</li>\n</ol>\n\n<p>In the screenshot below you can see the result of my code: a new row inserted after a value has changed in column \"D\". The red cells are what I need to do - Sum up.</p>\n\n<p>Screenshot with SumUp\n<a href=\"https://i.stack.imgur.com/AXpMF.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AXpMF.jpg\" alt=\"Screenshot with SumUp\"></a></p>\n\n<p>I run the below code after I sort all worksheets:</p>\n\n<pre><code>Sub InsertRowsAtValueChangeColumnD()\n\n'--- INSERT CLEAR ROWS\n\n  Dim X As Long, LastRow As Long\n  Const DataCol As String = \"D\"\n  Const StartRow = 2\n  LastRow = Cells(Rows.Count, DataCol).End(xlUp).Row\n  Application.ScreenUpdating = False\n  For X = LastRow To StartRow + 1 Step -1\n    If Cells(X, DataCol).Value &lt;&gt; Cells(X - 1, DataCol) Then Rows(X).Insert\n  Next\n  Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>I need to sum up after inserting the row.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10358702"}, "edited": false, "score": 0, "creation_date": 1547040565, "post_id": 54110970, "comment_id": 95054681, "body": "I placed the if wks.Range(Cells(1, columnOffset)).value &lt;&gt; &quot;&quot; then wks.Range(Cells(1, columnOffset)).value = Format(Now, &quot;dd-mm-yyyy hh:mm:ss&quot;) after the .Offset(0, columnOffset).PasteSpecial xlPasteValuesAndNumberFormats in my initial copy sub and it makes all initial cells 0 and the pasted cells 0 as well"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1547040717, "post_id": 54110970, "comment_id": 95054755, "body": "Check you are setting the range correctly. What is the value for columnOffset? Also, you may want to set the range like: <code>wks.Range(wks.Cells(1, columnOffset)).value</code> you should be explicit defining which worksheet you are updating."}], "tags": [], "owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "is_accepted": false, "score": 0, "last_activity_date": 1547039498, "creation_date": 1547039498, "answer_id": 54110970, "question_id": 54110865, "link": "https://stackoverflow.com/questions/54110865/cannot-create-a-timestamp-with-vba-by-using-a-called-function/54110970#54110970", "title": "Cannot create a timestamp with VBA by using a called function", "body": "<p>You need to update the cell, you aren't returning the value from the function. Try something like this with the existing code</p>\n\n<pre><code>wks.Range(Cells(1, columnOffset)).value = Timestamp(wks.Range(Cells(1, columnOffset)))\n</code></pre>\n\n<p>You could simplify this, not sure if the function is entirely needed, but it doesn't really matter. Something like should work too:</p>\n\n<pre><code>if wks.Range(Cells(1, columnOffset)).value &lt;&gt; \"\" then wks.Range(Cells(1, columnOffset)).value = Format(Now, \"dd-mm-yyyy hh:mm:ss\")\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10358702"}, "is_accepted": false, "score": 0, "last_activity_date": 1547043875, "creation_date": 1547043875, "answer_id": 54112272, "question_id": 54110865, "link": "https://stackoverflow.com/questions/54110865/cannot-create-a-timestamp-with-vba-by-using-a-called-function/54112272#54112272", "title": "Cannot create a timestamp with VBA by using a called function", "body": "<p>I change it to the following</p>\n\n<pre><code>If wks.Cells(1, lastColumn).Value = \"\" Then\nwks.Cells(1, lastColumn).Value = Format(Now, \"dd-mm-yyyy hh:mm:ss\")\nEnd If\n</code></pre>\n\n<p>So I have the following</p>\n\n<pre><code>Dim lastColumn As Long\nlastColumn = wks.Cells(2, wks.Columns.Count).End(xlToLeft).Column\nlastColumn = Application.Max(lastColumn + 1, wks.Columns(\"T\").Column)\n\nWith wks.Range(Cells(2, 5), Cells(lastrow, 5)) ' This is the range I need to copy in my case\n    Dim columnOffset As Long\n    columnOffset = lastColumn - .Columns(1).Column\n    If wks.Cells(1, lastColumn).Value = \"\" Then\n    wks.Cells(1, lastColumn).Value = Format(Now, \"dd-mm-yyyy hh:mm:ss\")\n    End If\n    .Copy\n    .Offset(0, columnOffset).PasteSpecial xlPasteValuesAndNumberFormats\n\n    Application.CutCopyMode = False\nEnd With\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10358702"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1547046993, "creation_date": 1547039203, "last_edit_date": 1547046993, "question_id": 54110865, "link": "https://stackoverflow.com/questions/54110865/cannot-create-a-timestamp-with-vba-by-using-a-called-function", "title": "Cannot create a timestamp with VBA by using a called function", "body": "<p>I have the following that creates a copy of a range. </p>\n\n<pre><code>Dim lastColumn As Long\nlastColumn = wks.Cells(2, wks.Columns.Count).End(xlToLeft).Column\nlastColumn = Application.Max(lastColumn + 1, wks.Columns(\"T\").Column)\n\nWith wks.Range(Cells(2, 5), Cells(lastrow, 5)) ' This is the range I need to copy in my case\n    Dim columnOffset As Long\n    columnOffset = lastColumn - .Columns(1).Column\n    Call Timestamp(wks.Range(Cells(1, columnOffset)))\n    .Copy\n    .Offset(0, columnOffset).PasteSpecial xlPasteValuesAndNumberFormats\n    Application.CutCopyMode = False\nEnd With\n</code></pre>\n\n<p>And I call the following function to create a timestamp above the copied cells, but I get an empty cell above the copied cells</p>\n\n<pre><code>Public Function Timestamp(Reference As Range)\nIf Reference.Value &lt;&gt; \"\" Then\nTimestamp = Format(Now, \"dd-mm-yyyy hh:mm:ss\")\nElse\nTimestamp = \"\"\nEnd If\nEnd Function\n</code></pre>\n\n<p>What I am doing wrong?\nthank you</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1547046321, "post_id": 54110633, "comment_id": 95058366, "body": "I haven&#39;t read through the question yet, but just looking at your code, you are doing <code>1000*10000</code> loops, or <code>10,000,000</code>. So you are performing <code>120,000,000</code> conditional statements (if, elseif) and changing the color index on a cell probably around <code>10,000,000</code> times as well. I think your entire approach to solving your problem needs some rethinking."}, {"owner": {"reputation": 11, "user_id": 10879621, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-07ftWBIL5vA/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcaw2HkkZjTqlTB1DCun8AWzfWfDeQ/mo/photo.jpg?sz=128", "display_name": "Amir Elkamel", "link": "https://stackoverflow.com/users/10879621/amir-elkamel"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1547046447, "post_id": 54110633, "comment_id": 95058454, "body": "It should only color the rows up to 1000 times, but is there any way to make this code run in under 10 minutes? It runs for a VERY long time but it still highlights everything, which is the biggest issue I am facing right now, the speed can be slow."}, {"owner": {"reputation": 8351, "user_id": 4279155, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/841b7391f3f7873bec1a8d9d8d2dc759?s=128&d=identicon&r=PG&f=1", "display_name": "Dominique", "link": "https://stackoverflow.com/users/4279155/dominique"}, "edited": false, "score": 1, "creation_date": 1547046573, "post_id": 54110633, "comment_id": 95058538, "body": "Why don&#39;t you use conditional formatting, based on a formula?"}, {"owner": {"reputation": 11, "user_id": 10879621, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-07ftWBIL5vA/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcaw2HkkZjTqlTB1DCun8AWzfWfDeQ/mo/photo.jpg?sz=128", "display_name": "Amir Elkamel", "link": "https://stackoverflow.com/users/10879621/amir-elkamel"}, "edited": false, "score": 0, "creation_date": 1547046883, "post_id": 54110633, "comment_id": 95058719, "body": "Could I do that using a macro? How would I translate 1 If loop to that? I would be able to translate it to the rest of the if loops but have no idea how to get started."}, {"owner": {"reputation": 968, "user_id": 5910169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a40180e3fa49fbf4e55145adf54d9?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Ball", "link": "https://stackoverflow.com/users/5910169/frank-ball"}, "edited": false, "score": 0, "creation_date": 1547047276, "post_id": 54110633, "comment_id": 95058974, "body": "Is there a specific reason for the 1,000 and 10,000 iterations?  From what you describe, it sounds like you should know how many rows you are iterating over and limit your loops to just the number of rows in your sheets.  By your logic, sheet C always has 1,000 rows and sheet B always has 10,000 rows.  You should only be iterating over the actual number of rows in each sheet and not just large number that makes sure that you cover everything."}, {"owner": {"reputation": 11, "user_id": 10879621, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-07ftWBIL5vA/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcaw2HkkZjTqlTB1DCun8AWzfWfDeQ/mo/photo.jpg?sz=128", "display_name": "Amir Elkamel", "link": "https://stackoverflow.com/users/10879621/amir-elkamel"}, "edited": false, "score": 0, "creation_date": 1547047412, "post_id": 54110633, "comment_id": 95059054, "body": "There are 498 rows in Sheet C currently, and 8954 in Sheet B, but I need the For loop maximums to be dynamic, because there might be more/less rows in either sheet on any given instance of this macro. My workaround for this was selecting large numbers that I knew the amount of rows would not surpass."}, {"owner": {"reputation": 968, "user_id": 5910169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a40180e3fa49fbf4e55145adf54d9?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Ball", "link": "https://stackoverflow.com/users/5910169/frank-ball"}, "edited": false, "score": 0, "creation_date": 1547047443, "post_id": 54110633, "comment_id": 95059068, "body": "You could also try doing a &quot;Find&quot; using the value in Sheets(&quot;C&quot;).Cells(j, 7) and then iterating over that result set.  Doing so would eliminate most of the checks that will result in a negative result."}, {"owner": {"reputation": 11, "user_id": 10879621, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-07ftWBIL5vA/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcaw2HkkZjTqlTB1DCun8AWzfWfDeQ/mo/photo.jpg?sz=128", "display_name": "Amir Elkamel", "link": "https://stackoverflow.com/users/10879621/amir-elkamel"}, "edited": false, "score": 0, "creation_date": 1547047906, "post_id": 54110633, "comment_id": 95059377, "body": "how would I go about doing that? The find function doesn&#39;t seem to be able to find values equal to or greater than, just equal to.  I am also open to the conditional formatting approach, but I have no idea how to incorporate multiple if statements to that."}, {"owner": {"reputation": 968, "user_id": 5910169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a40180e3fa49fbf4e55145adf54d9?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Ball", "link": "https://stackoverflow.com/users/5910169/frank-ball"}, "edited": false, "score": 0, "creation_date": 1547049174, "post_id": 54110633, "comment_id": 95060210, "body": "To get the actual number of rows in a sheets use: Sheets(&quot;C&quot;).UsedRange.Rows.Count (using the actual sheetname of course).  This will limit the number of rows to exactly what you need."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10879621, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-07ftWBIL5vA/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcaw2HkkZjTqlTB1DCun8AWzfWfDeQ/mo/photo.jpg?sz=128", "display_name": "Amir Elkamel", "link": "https://stackoverflow.com/users/10879621/amir-elkamel"}, "edited": false, "score": 0, "creation_date": 1547049168, "post_id": 54113630, "comment_id": 95060205, "body": "I am so lost, I am an excel vba newbie and have never worked with SQL. I will try to figure out your answer though, how do I start?"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 11, "user_id": 10879621, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-07ftWBIL5vA/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcaw2HkkZjTqlTB1DCun8AWzfWfDeQ/mo/photo.jpg?sz=128", "display_name": "Amir Elkamel", "link": "https://stackoverflow.com/users/10879621/amir-elkamel"}, "edited": false, "score": 0, "creation_date": 1547058284, "post_id": 54113630, "comment_id": 95065148, "body": "If running Excel in Windows, simply run VBA macro. Adjust Sheet namrs and columns in SQL string as needed."}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 0, "last_activity_date": 1547048556, "creation_date": 1547048556, "answer_id": 54113630, "question_id": 54110633, "link": "https://stackoverflow.com/questions/54110633/nested-for-loop-runs-painfully-slow-and-doesnt-work-properly/54113630#54113630", "title": "Nested For Loop runs painfully slow and doesn&#39;t work properly", "body": "<p>Consider avoiding nested <code>For</code> loops and run set-based operations such as tables in a relational database or data sets/data frames in analysis tools such as SAS, SPSS, Stata, Python's Pandas, R, Julia, and others. This allows you to merge or join these two sets of data by <em>account number</em> and <em>request type</em> and run any vectorized column operation much more efficient than iterative looping. However, you could run Excel's <code>INDEX...MATCH</code> but requires arrays or array formula for conditional date comparisons and missing values.</p>\n\n<p>Fortunately, if you use Excel for Windows, you can interface with the JET/ACE SQL Engine (.dll files) where you can join the two sheets of workbook and create a needed column as indicator for highlighting. Note: because Excel is not a database and hence does not conform to data integrity rules, be sure to format each column in a single data type (no mixing types), especially make date columns actual dates or leave blank, otherwise below logic will not work. </p>\n\n<hr>\n\n<p><strong>SQL</strong> <em>(turning <code>If</code> conditions to nested <code>IIF</code> or <code>CASE</code> in other RDBMS)</em></p>\n\n<p>Adjust actual column and sheet names as needed.</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT c.*, b.*, \n       IIF((b.[Appointment Date] &gt;= c.[Request Date]) OR (c.[Request Date] IS NULL), 0,\n           IIF(b.[Appointment Date] IS NULL, 1,\n               IIF((b.[Appointment Date] &lt; c.[Request Date]), 1, 0)\n               )\n           ) AS [highlight]                      \nFROM [SheetC$] c\nINNER JOIN [SheetB$] b\n   ON c.[Account #] = b.[Account #] AND c.[Request Type] = b.[Appointment Type]\n</code></pre>\n\n<p>Alternatively and ideally, import the two sheets in an actual database (or aforementioned analysis tool) like Excel's sibling, MS Access, and run same SQL query and have Access dump results back into Excel for highlighting purposes or keep in Access and run <a href=\"https://support.office.com/en-us/article/highlight-data-with-conditional-formatting-7f7c0bd4-7c37-421d-adad-a260125c8129\" rel=\"nofollow noreferrer\">conditional formatting</a> on a form or report!</p>\n\n<hr>\n\n<p><strong>VBA</strong> <em>(runs above query and dumps query output in an existing, blank Results worksheet)</em></p>\n\n<p>Use computed highlight row (with values 0 or 1) in <em>Results</em> sheet for yellow row highlighting.</p>\n\n<pre><code>Sub RunSQL()    \n    Dim conn As Object, rst As Object\n    Dim strConnection As String, strSQL As String\n    Dim i As Integer\n\n    Set conn = CreateObject(\"ADODB.Connection\")\n    Set rst = CreateObject(\"ADODB.Recordset\")\n\n    ' CONNECTION STRINGS (DRIVER VERSION COMMENTED OUT)\n'    strConnection = \"DRIVER={Microsoft Excel Driver (*.xls, *.xlsx, *.xlsm, *.xlsb)};\" _\n'                      &amp; \"DBQ=C:\\Path\\To\\Workbook.xlsm;\"\n    strConnection = \"Provider=Microsoft.ACE.OLEDB.12.0;\" _\n                       &amp; \"Data Source='C:\\Path\\To\\Workbook.xlsm';\" _\n                       &amp; \"Extended Properties=\"\"Excel 12.0;HDR=YES;\"\";\"\n\n    strSQL = \"SELECT c.*, b.*, \" _\n           &amp;  \"     IIF((b.[Appointment Date] &gt;= c.[Request Date]) OR (c.[Request Date] IS NULL), 0, \" _\n           &amp;  \"         IIF(b.[Appointment Date] IS NULL, 1, \" _\n           &amp;  \"             IIF((b.[Appointment Date] &lt; c.[Request Date]), 1, 0) \" _\n           &amp;  \"             ) \" _\n           &amp;  \"        ) AS [highlight]  \" _                     \n           &amp;  \" FROM [SheetC$] c \" _\n           &amp;  \" INNER JOIN [SheetB$] b \" _\n           &amp;  \"    ON c.[Account #] = b.[Account #] AND c.[Request Type] = b.[Appointment Type]\"  \n\n    ' OPEN CONNECTION\n    conn.Open strConnection\n    rst.Open strSQL, conn\n\n    ' COLUMN HEADERS\n    With Worksheet(\"Results\")\n        For i = 1 To rst.Fields.Count - 1\n           .Cells(1, i) = rst.Fields(i).Name\n        Next i        \n       ' DATA ROWS\n       .Range(\"A2\").CopyFromRecordset rst\n    End With\n\n    rst.Close: conn.Close    \n    Set rst = Nothing: Set conn = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10879621, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-07ftWBIL5vA/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcaw2HkkZjTqlTB1DCun8AWzfWfDeQ/mo/photo.jpg?sz=128", "display_name": "Amir Elkamel", "link": "https://stackoverflow.com/users/10879621/amir-elkamel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 173, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1547048556, "creation_date": 1547038438, "last_edit_date": 1547047086, "question_id": 54110633, "link": "https://stackoverflow.com/questions/54110633/nested-for-loop-runs-painfully-slow-and-doesnt-work-properly", "title": "Nested For Loop runs painfully slow and doesn&#39;t work properly", "body": "<p>The code I have scans for matches and does several things:</p>\n\n<ol>\n<li>First, it checks that appointment dates are on or after the request date of testing.</li>\n<li>Then, it makes sure the cell for the request isn't empty by making sure the exact code of the request is there (there are 6 columns for testing codes).</li>\n<li>Then, it makes sure the account number of the request and appointment are the same.</li>\n</ol>\n\n<p>Below are several conditions:</p>\n\n<ul>\n<li>If there is an appointment on or after the request date with the requested service, it should do nothing and move on to the next row. </li>\n<li><p>If there is missing appointments for services requested, it should highlight the cells yellow. </p></li>\n<li><p>If the request slot on Sheet C is blank, the code should do nothing. </p></li>\n<li><p>If the request slot is filled, but there is an appointment on or after the request date, for the same account #, and the request type/appointment type match, the code should do nothing. </p></li>\n<li><p>If there isn't, the request row should be highlighted in yellow.</p></li>\n</ul>\n\n<p><strong>Problem</strong></p>\n\n<p>Aside from highlighting them in red, which I can deal with, the code seems to highlight ALL the rows, instead of highlighting just the ones with services requested but missing appointments.</p>\n\n<p>The sheet for requests is C, and the sheet of ALL appointments scheduled is B. A nice touch would be to limit the <code>For</code> loops to only rows that contain data to make the process finish quicker (maybe add a progress bar? Excel and the VBA window both display not responding but the machines fans go faster so I know it's definitely doing something).</p>\n\n<p><strong>Data</strong> </p>\n\n<p>To make things slightly easier:</p>\n\n<ul>\n<li><p>On Sheet C (Request Sheet): </p>\n\n<pre><code>Account # = Column A\n\nRequest Date = Column G\n\nRequest Type = Columns H-M\n</code></pre></li>\n<li><p>On Sheet B (Master Appointment Sheet):</p>\n\n<pre><code>Account # = Column A (Must match Sheet C Column A)\n\nAppointment Date = Column L (Must be &gt;= (Greater or equal) to Sheet C Column G\n\nAppointment Type = Column P (Must match Sheet C Column H-M)\n</code></pre></li>\n</ul>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Sub check_for_copies()\n\nDim i As Long\nDim j As Long\n\nFor j = 2 To 1000\n\nFor i = 2 To 10000\n\n    If Sheets(\"C\").Cells(j, 7).Value &lt;= Sheets(\"B\").Cells(i, 12).Value And Sheets(\"C\").Cells(j, 1).Value = Sheets(\"B\").Cells(i, 1).Value And Sheets(\"C\").Cells(j, 8).Value = \"CR15\" And Sheets(\"C\").Cells(j, 8).Value = Sheets(\"B\").Cells(i, 16).Value Then\n        'do nothing\n    ElseIf Sheets(\"C\").Cells(j, 8).Value = \"\" Then\n        'do nothing\n    Else\n        Sheets(\"C\").Rows(j).Interior.ColorIndex = 3\n    End If\n\n\n    If Sheets(\"C\").Cells(j, 7).Value &lt;= Sheets(\"B\").Cells(i, 12).Value And Sheets(\"C\").Cells(j, 1).Value = Sheets(\"B\").Cells(i, 1).Value And Sheets(\"C\").Cells(j, 9).Value = \"TR15\" And Sheets(\"C\").Cells(j, 9).Value = Sheets(\"B\").Cells(i, 16).Value Then\n        'do nothing\n    ElseIf Sheets(\"C\").Cells(j, 9).Value = \"\" Then\n        'do nothing\n    Else\n        Sheets(\"C\").Rows(j).Interior.ColorIndex = 3\n    End If\n\n    If Sheets(\"C\").Cells(j, 7).Value &lt;= Sheets(\"B\").Cells(i, 12).Value And Sheets(\"C\").Cells(j, 1).Value = Sheets(\"B\").Cells(i, 1).Value And Sheets(\"C\").Cells(j, 10).Value = \"EEG60\" And Sheets(\"C\").Cells(j, 10).Value = Sheets(\"B\").Cells(i, 16).Value Then\n        'do nothing\n    ElseIf Sheets(\"C\").Cells(j, 10).Value = \"\" Then\n        'do nothing\n    Else\n        Sheets(\"C\").Rows(j).Interior.ColorIndex = 3\n    End If\n\n\n    If Sheets(\"C\").Cells(j, 7).Value &lt;= Sheets(\"B\").Cells(i, 12).Value And Sheets(\"C\").Cells(j, 1).Value = Sheets(\"B\").Cells(i, 1).Value And Sheets(\"C\").Cells(j, 11).Value = \"EMG15\" And Sheets(\"C\").Cells(j, 11).Value = Sheets(\"B\").Cells(i, 16).Value Then\n        'do nothing\n    ElseIf Sheets(\"C\").Cells(j, 11).Value = \"\" Then\n        'do nothing\n    Else\n        Sheets(\"C\").Rows(j).Interior.ColorIndex = 3\n    End If\n\n\n    If Sheets(\"C\").Cells(j, 7).Value &lt;= Sheets(\"B\").Cells(i, 12).Value And Sheets(\"C\").Cells(j, 1).Value = Sheets(\"B\").Cells(i, 1).Value And Sheets(\"C\").Cells(j, 12).Value = \"NV30\" And Sheets(\"C\").Cells(j, 12).Value = Sheets(\"B\").Cells(i, 16).Value Then\n        'do nothing\n    ElseIf Sheets(\"C\").Cells(j, 12).Value = \"\" Then\n        'do nothing\n    Else\n        Sheets(\"C\").Rows(j).Interior.ColorIndex = 3\n    End If\n\n\n    If Sheets(\"C\").Cells(j, 7).Value &lt;= Sheets(\"B\").Cells(i, 12).Value And Sheets(\"C\").Cells(j, 1).Value = Sheets(\"B\").Cells(i, 1).Value And Sheets(\"C\").Cells(j, 13).Value = \"NV45\" And Sheets(\"C\").Cells(j, 13).Value = Sheets(\"B\").Cells(i, 16).Value Then\n        'do nothing\n    ElseIf Sheets(\"C\").Cells(j, 13).Value = \"\" Then\n        'do nothing\n    Else\n        Sheets(\"C\").Rows(j).Interior.ColorIndex = 3\n    End If\n\nNext\n\nNext\n\nEnd Sub\n</code></pre>\n\n<p>The code is painfully slow and looks as if it's crashing excel. I've tried adding </p>\n\n<pre><code>Application.Calculation = false\nApplication.ScreenUpdating = false\nApplication.EnableEvents = false\n</code></pre>\n\n<p>but it doesn't seem to help!</p>\n"}, {"tags": ["vba", "object", "powerpoint"], "comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1547038118, "post_id": 54110475, "comment_id": 95053120, "body": "How is <code>myfilename</code> being populated? The error could be because the file doesn&#39;t exist?"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1547038320, "post_id": 54110475, "comment_id": 95053245, "body": "No, you would not get &quot;remote server machine not found.&quot; if <code>pptApp</code> was <code>Nothing</code>. You would get error 91."}, {"owner": {"reputation": 13, "user_id": 10828710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d052fa9fb1535d5a9202c7026ea17943?s=128&d=identicon&r=PG&f=1", "display_name": "Underhook32", "link": "https://stackoverflow.com/users/10828710/underhook32"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1547038487, "post_id": 54110475, "comment_id": 95053370, "body": "@Ryan thank you for the reply. I added the code of the file picker s8ub filepicker), which returns the variable &quot;myfilename&quot;. Also using &quot;?myfilename&quot; VBA returns a value when the error occurs."}, {"owner": {"reputation": 13, "user_id": 10828710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d052fa9fb1535d5a9202c7026ea17943?s=128&d=identicon&r=PG&f=1", "display_name": "Underhook32", "link": "https://stackoverflow.com/users/10828710/underhook32"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1547038551, "post_id": 54110475, "comment_id": 95053408, "body": "@GSerg: Thanks for the reply! Do you know what can be the problem then? Also why does the variable not return a value, when thsi error occurs?"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1547038922, "post_id": 54110475, "comment_id": 95053649, "body": "Please provide complete actual error messages and codes."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1547038964, "post_id": 54110475, "comment_id": 95053675, "body": "@Underhook32 thanks. Is <code>myfilename</code> declared as public? I don&#39;t see it declared anywhere. You may not have scope inside <code>Saveas_PDF</code>."}, {"owner": {"reputation": 13, "user_id": 10828710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d052fa9fb1535d5a9202c7026ea17943?s=128&d=identicon&r=PG&f=1", "display_name": "Underhook32", "link": "https://stackoverflow.com/users/10828710/underhook32"}, "edited": false, "score": 0, "creation_date": 1547039117, "post_id": 54110475, "comment_id": 95053773, "body": "Jap, sry forgot that Public myfilename As String"}, {"owner": {"reputation": 13, "user_id": 10828710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d052fa9fb1535d5a9202c7026ea17943?s=128&d=identicon&r=PG&f=1", "display_name": "Underhook32", "link": "https://stackoverflow.com/users/10828710/underhook32"}, "edited": false, "score": 0, "creation_date": 1547039172, "post_id": 54110475, "comment_id": 95053820, "body": "Code is complete now!"}, {"owner": {"reputation": 13, "user_id": 10828710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d052fa9fb1535d5a9202c7026ea17943?s=128&d=identicon&r=PG&f=1", "display_name": "Underhook32", "link": "https://stackoverflow.com/users/10828710/underhook32"}, "edited": false, "score": 0, "creation_date": 1547040087, "post_id": 54110475, "comment_id": 95054379, "body": "Any other ideas / suggestions? :)"}, {"owner": {"reputation": 13, "user_id": 10828710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d052fa9fb1535d5a9202c7026ea17943?s=128&d=identicon&r=PG&f=1", "display_name": "Underhook32", "link": "https://stackoverflow.com/users/10828710/underhook32"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1547124951, "post_id": 54110475, "comment_id": 95089438, "body": "@GSerg: Error is &quot;462: &quot;The remote server machine does not exist or is unavailable&quot;.  Can you help me? Also the PPT crashes, which might be important to know"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1547125804, "post_id": 54110475, "comment_id": 95089936, "body": "@Underhook32 Do you have <a href=\"https://stackoverflow.com/q/26030584/11683\">stray powerpoints</a> running?"}, {"owner": {"reputation": 13, "user_id": 10828710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d052fa9fb1535d5a9202c7026ea17943?s=128&d=identicon&r=PG&f=1", "display_name": "Underhook32", "link": "https://stackoverflow.com/users/10828710/underhook32"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1547130552, "post_id": 54110475, "comment_id": 95092769, "body": "@GSerg: Thanks for the quick reply. To what are you referring when you talk about &quot;stray powerpoints&quot;? I have one other PPT file open before starting the macro if that is what you meant"}, {"owner": {"reputation": 13, "user_id": 10828710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d052fa9fb1535d5a9202c7026ea17943?s=128&d=identicon&r=PG&f=1", "display_name": "Underhook32", "link": "https://stackoverflow.com/users/10828710/underhook32"}, "edited": false, "score": 0, "creation_date": 1547132184, "post_id": 54110475, "comment_id": 95093907, "body": "<a href=\"https://tagasanjose.blogspot.com/2014/09/powerpoint-crashes-on-close-vba.html\" rel=\"nofollow noreferrer\">tagasanjose.blogspot.com/2014/09/&hellip;</a>  I tried this workaround. So far my code works. But why does PPT crash??? very weird, really would like to understand"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10828710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d052fa9fb1535d5a9202c7026ea17943?s=128&d=identicon&r=PG&f=1", "display_name": "Underhook32", "link": "https://stackoverflow.com/users/10828710/underhook32"}, "edited": false, "score": 0, "creation_date": 1547040482, "post_id": 54111186, "comment_id": 95054623, "body": "Hi Cindy, thanks for the reply. I just commented out the line and tested the code again. Unfortunately after a couple of runs I get the error again :/"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 13, "user_id": 10828710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d052fa9fb1535d5a9202c7026ea17943?s=128&d=identicon&r=PG&f=1", "display_name": "Underhook32", "link": "https://stackoverflow.com/users/10828710/underhook32"}, "edited": false, "score": 0, "creation_date": 1547041071, "post_id": 54111186, "comment_id": 95054954, "body": "@Underhook32 The error is certainly because <i>something(s)</i> is/are being held open. If you comment out the If block <code>If IsAppRunning</code> does that change anything? How about if the <code>For Each</code> is reduced to only one or two executions? (<code>PP</code> might not be cleaned up adequately before the next loop...?)"}, {"owner": {"reputation": 13, "user_id": 10828710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d052fa9fb1535d5a9202c7026ea17943?s=128&d=identicon&r=PG&f=1", "display_name": "Underhook32", "link": "https://stackoverflow.com/users/10828710/underhook32"}, "edited": false, "score": 0, "creation_date": 1547042972, "post_id": 54111186, "comment_id": 95056068, "body": "1. First of all sry, did not know that, will follow that rule in the future!                2. I will test it. On question upfront. How can I make sure that &quot;PP&quot; gets cleared? is Set PP = Nothing not enough?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 13, "user_id": 10828710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d052fa9fb1535d5a9202c7026ea17943?s=128&d=identicon&r=PG&f=1", "display_name": "Underhook32", "link": "https://stackoverflow.com/users/10828710/underhook32"}, "edited": false, "score": 0, "creation_date": 1547043074, "post_id": 54111186, "comment_id": 95056130, "body": "I would expect it should be enough, but it may be a &quot;timing&quot; issue. If fewer loops don&#39;t cause a problem - no matter how often the entire macro is run, then sticking a <code>Do Events</code> in there might help."}, {"owner": {"reputation": 13, "user_id": 10828710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d052fa9fb1535d5a9202c7026ea17943?s=128&d=identicon&r=PG&f=1", "display_name": "Underhook32", "link": "https://stackoverflow.com/users/10828710/underhook32"}, "edited": false, "score": 0, "creation_date": 1547055072, "post_id": 54111186, "comment_id": 95063731, "body": "Thanks for the answer Cindy / besten Dank ;) Can you elaborate what you mean by &quot;timing&quot; issue?  I tested the code with only one loop, but I still get the error message. I also tried Do Events, but was not sure where to put it. Directly in front of the line that does not work?"}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 0, "last_activity_date": 1547040225, "creation_date": 1547040225, "answer_id": 54111186, "question_id": 54110475, "link": "https://stackoverflow.com/questions/54110475/vba-object-not-created/54111186#54111186", "title": "VBA Object not created?", "body": "<p>I believe the problem is due to the code in the question having two identical lines:</p>\n\n<pre><code>Set pptApp = New PowerPoint.Application\n</code></pre>\n\n<p>Each line will cause VBA to start up a new instance of PowerPoint, and it tries to assign them to the same object variable (<code>pptApp</code>). This is the cause of the remote server error.</p>\n\n<p>Comment out the second line that starts a new instance of PowerPoint and see if things don't work better - or at least differently. </p>\n"}], "owner": {"reputation": 13, "user_id": 10828710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d052fa9fb1535d5a9202c7026ea17943?s=128&d=identicon&r=PG&f=1", "display_name": "Underhook32", "link": "https://stackoverflow.com/users/10828710/underhook32"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1547041601, "creation_date": 1547037876, "last_edit_date": 1547041601, "question_id": 54110475, "link": "https://stackoverflow.com/questions/54110475/vba-object-not-created", "title": "VBA Object not created?", "body": "<p>in the following Code I <strong>sometimes, not always!</strong> get an error at \"Set PP = pptApp.Presentations.Open(pptVorlage)\". When I check the value of \"pptApp\" in the immediate window using \"?pptApp\", VBA can't return a value.</p>\n\n<p>What does this mean? Was the Object not created? Or set to null during the code?</p>\n\n<p>Thanks in advance!</p>\n\n<pre><code>Public myfilename As String\n\nSub Saveas_PDF()\n    Dim PP As PowerPoint.Presentation\n    Dim company As String\n    Set DropDown.ws_company = Tabelle2\n    company = DropDown.ws_company.Range(\"C2\").Value\n\n    Dim strPOTX As String\n    Dim strPfad As String\n    Dim pptApp As Object\n\n    Call filepicker\n\n    Dim Cell As Range\n\n    Set pptApp = New PowerPoint.Application\n\n    For Each Cell In DropDown.ws_company.Range(DropDown.ws_company.Cells(5, 3), DropDown.ws_company.Cells(Rows.Count, 3).End(xlUp)).SpecialCells(xlCellTypeVisible)\n        Dim pptVorlage As String\n        pptVorlage = myfilename\n\n        Set PP = pptApp.Presentations.Open(pptVorlage) 'sometimes error (remote server machine not found.) + pptApp seems to be empty?\n        PP.UpdateLinks\n        pptApp.Visible = True\n        Debug.Print (PP.Name)\n        AppActivate (PP.Name)\n        PP.Close\n        Set PP = Nothing\n    Next\n\n    Set pptApp = New PowerPoint.Application\n    If IsAppRunning(\"PowerPoint.Application\") Then\n        If pptApp.Windows.Count = 0 Then\n\n            pptApp.Quit\n        End If\n    End If\n\n    Set pptApp = Nothing\nEnd Sub\n\nSub filepicker()\n\n Dim i As Variant\n MsgBox (\"In the following dialog please choose the current file\")\n Dim myfilenamepicker As FileDialog\n Set myfilenamepicker = Application.FileDialog(msoFileDialogFilePicker)\n myfilenamepicker.InitialFileName = \"C:\\Users\\XY\"\n myfilenamepicker.Show\n If myfilenamepicker.SelectedItems.Count &lt;&gt; 0 Then\n myfilename = myfilenamepicker.SelectedItems(1)\n End If\n\n\nEnd Sub\n\nFunction IsAppRunning(ByVal sAppName) As Boolean\n    Dim oApp As Object\n    On Error Resume Next\n    Set oApp = GetObject(, sAppName)\n    If Not oApp Is Nothing Then\n    Set oApp = Nothing\n    IsAppRunning = True\n    End If\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel-formula"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1547036664, "post_id": 54109961, "comment_id": 95052253, "body": "Why not just use <code>IF</code> in formula?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1547037022, "post_id": 54109961, "comment_id": 95052485, "body": "Also, no need for the <code>End If</code> way of doing it, it&#39;s just <code>if....else...</code> like the 2nd part"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1547043430, "post_id": 54109961, "comment_id": 95056381, "body": "Your code is incomplete. We cannot help on just a snippet of your code. What is <code>state</code>, <code>resp</code>, <code>obj</code>? Where is <code>nextrec</code>?"}, {"owner": {"reputation": 3, "user_id": 2798634, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/471d2b46608512cde12f8c2a314d7d64?s=128&d=identicon&r=PG&f=1", "display_name": "user2798634", "link": "https://stackoverflow.com/users/2798634/user2798634"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1547045579, "post_id": 54109961, "comment_id": 95057848, "body": "@Nathan_Sav my problem is that i cant build the if formula to check all those settings, allways something missing"}, {"owner": {"reputation": 3, "user_id": 2798634, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/471d2b46608512cde12f8c2a314d7d64?s=128&d=identicon&r=PG&f=1", "display_name": "user2798634", "link": "https://stackoverflow.com/users/2798634/user2798634"}, "edited": false, "score": 0, "creation_date": 1547046943, "post_id": 54109961, "comment_id": 95058764, "body": "i tryed to simplify the best i can ..     fields status1 - can be &quot;idle&quot; or &quot;processing&quot;::: status2  - can be &quot;missed&quot; or &quot;ok&quot;:::::  finally i need to add a column to have the values &quot;idle but missed&quot; &quot;; idle ok&quot; ; &quot;ended missed&quot;; &quot;ended ok &quot;"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1547047512, "post_id": 54109961, "comment_id": 95059112, "body": "@user2798634 so you cant do the formula, but you&#39;ve had a go at the code?  <code>If(x=1,if(y=1,2,3),if(z=1,4,5),6)</code>  it would be along this sort of syntax"}], "answers": [{"tags": [], "owner": {"reputation": 440, "user_id": 5128961, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SEr4k.gif?s=128&g=1", "display_name": "DavidN", "link": "https://stackoverflow.com/users/5128961/davidn"}, "is_accepted": false, "score": 1, "last_activity_date": 1547050544, "creation_date": 1547050544, "answer_id": 54114235, "question_id": 54109961, "link": "https://stackoverflow.com/questions/54109961/converting-vba-into-formula/54114235#54114235", "title": "converting vba into formula", "body": "<p>This can be done with a single excel formula without the need for VBA.  The following formula should accomplish what your code does.</p>\n\n<p>Since you didn't provide a snip of sample data I'm going to assume that <code>comp, state, resp, obj</code> are values from other columns of the same row.  You can replace these values in my formula with the corresponding cell reference then drag down.</p>\n\n<pre><code>=IF(comp=\"AC\",\n    \"AC\",\n    IF(state=\"idle\",\n          IF(resp&gt;=obj,\"idle miss\",\"idle\"),\n          IF(resp&gt;=obj,\"ended miss\",\"ended ok\")\n      )\n    )\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 73, "user_id": 4000668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13e619952c837d01ba37821250a5728a?s=128&d=identicon&r=PG&f=1", "display_name": "Lcross Portugal", "link": "https://stackoverflow.com/users/4000668/lcross-portugal"}, "is_accepted": false, "score": 0, "last_activity_date": 1547069002, "creation_date": 1547069002, "answer_id": 54118586, "question_id": 54109961, "link": "https://stackoverflow.com/questions/54109961/converting-vba-into-formula/54118586#54118586", "title": "converting vba into formula", "body": "<p>@DavidN spot on , it is exactly how i need it ...for some reason i was not handling the multiple if statement the right way , i googled some examples but i just got even more messed up. has always the right way is the simple way. thanks.</p>\n"}], "owner": {"reputation": 3, "user_id": 2798634, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/471d2b46608512cde12f8c2a314d7d64?s=128&d=identicon&r=PG&f=1", "display_name": "user2798634", "link": "https://stackoverflow.com/users/2798634/user2798634"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1547069002, "creation_date": 1547036186, "question_id": 54109961, "link": "https://stackoverflow.com/questions/54109961/converting-vba-into-formula", "title": "converting vba into formula", "body": "<p>What i'd like is that i can put in a excel formula a check to all parameters like this code below. The code runs without error if put it in a loop, but its slow and i have a small data-set (around 1500 records).\nwhat i have similar to this is a code that put \"formula.local\" values on a predefine table (so it auto-completes).</p>\n\n<p>Bottom line i really need this code to runs faster... If there is a way to put it like a \"local.formula\", or even improve the code itself to run faster please let me know.\nIf this is not clear please tell me and i'll try to explain better.\nThanks.</p>\n\n<pre><code>If comp = \"AC\" Then\nCells(i, 77).Value = \"AC\"\nGoTo nextrec\nEnd If\nIf state = \"idle\" Then\n    If resp &gt;= obj Then\n        'idle but already miss deadline\n        Cells(i, 77).Value = \"idle miss\"\n    Else\n    'idle but ok \n        Cells(i, 77).Value = \"idle\"\n    End If\nElse\n'ended\n    If resp &gt;= obj Then\n        'ended miss deadline\n        Cells(i, 77).Value = \"ended missed\"\n    Else\n        'deadline ok \n        Cells(i, 77).Value = \"ended ok\"\n    End If\nEnd If\n</code></pre>\n"}, {"tags": ["javascript", "html", "vba", "internet-explorer", "dom-events"], "comments": [{"owner": {"reputation": 189, "user_id": 9609148, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Pablo G", "link": "https://stackoverflow.com/users/9609148/pablo-g"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1547047141, "post_id": 54109888, "comment_id": 95058900, "body": "@QHarr I added it in the question"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1547047470, "post_id": 54109888, "comment_id": 95059085, "body": "Is this a public or private url please? And should your referenced element change during the loop as currently only 2 elements are referenced even if more than once cell contains MRR?"}, {"owner": {"reputation": 189, "user_id": 9609148, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Pablo G", "link": "https://stackoverflow.com/users/9609148/pablo-g"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1547047557, "post_id": 54109888, "comment_id": 95059144, "body": "Unfortunately is private.. but I can show more of the code if needed"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1547047960, "post_id": 54109888, "comment_id": 95059421, "body": "Just trying to visualize as your first element looks like a dropdown not an input element. So, I would have expected something like ieDoc.querySelector(&quot;select[name=&#39;meetingQuestionAnswer(2206&zwnj;&#8203;74)&#39;]&#39;&quot;).click : ieDoc.querySelector(&quot;[name=&#39;meetingQuestionAnswer(220674)&#39;] [value=Yes]&quot;).Selected = True"}, {"owner": {"reputation": 189, "user_id": 9609148, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Pablo G", "link": "https://stackoverflow.com/users/9609148/pablo-g"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1547048201, "post_id": 54109888, "comment_id": 95059532, "body": "I&#39;m getting an error in method &#39;querySelector&#39; from the object &#39;JScriptTypeInfo&#39;"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1547048275, "post_id": 54109888, "comment_id": 95059578, "body": "It means it doesn\u2019t like that syntax. I\u2019ll have a look in a minute."}, {"owner": {"reputation": 189, "user_id": 9609148, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Pablo G", "link": "https://stackoverflow.com/users/9609148/pablo-g"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1547048322, "post_id": 54109888, "comment_id": 95059609, "body": "Thanks! The second line is working ok though. It changes the Yes/No value"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1547048571, "post_id": 54109888, "comment_id": 95059786, "body": "Is there another action that needs to happen? I have posted that answer below for the second part."}, {"owner": {"reputation": 189, "user_id": 9609148, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Pablo G", "link": "https://stackoverflow.com/users/9609148/pablo-g"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1547049002, "post_id": 54109888, "comment_id": 95060075, "body": "No.. it just saying yes to a first question so then the second one appears. If you say No then nothing happens"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1547049058, "post_id": 54109888, "comment_id": 95060123, "body": "And by saying yes to first is when second should appear?"}, {"owner": {"reputation": 189, "user_id": 9609148, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Pablo G", "link": "https://stackoverflow.com/users/9609148/pablo-g"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1547049164, "post_id": 54109888, "comment_id": 95060204, "body": "Exactly! If i see what&#39;s related to the first question regarding the code there&#39;s an event &#39;change&#39; associated to the element and the funtion eventHandle (posted in JavaScript code) to the event"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1547049295, "post_id": 54109888, "comment_id": 95060295, "body": "I don&#39;t see a change event in the js. However, you can then use .FireEvent &quot;onchange&quot; on the appropriate element to attempt to fire. Have you used this on the right element?"}, {"owner": {"reputation": 189, "user_id": 9609148, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Pablo G", "link": "https://stackoverflow.com/users/9609148/pablo-g"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1547049809, "post_id": 54109888, "comment_id": 95060631, "body": "That&#39;s the first thing I tried but didn&#39;t work either."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1547049989, "post_id": 54109888, "comment_id": 95060751, "body": "I would suggest trying selenium basic then if you are allowed to install."}], "answers": [{"comments": [{"owner": {"reputation": 189, "user_id": 9609148, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Pablo G", "link": "https://stackoverflow.com/users/9609148/pablo-g"}, "edited": false, "score": 0, "creation_date": 1547109225, "post_id": 54123676, "comment_id": 95080637, "body": "THANKS!!!! Worked perfectly! And thanks for the reference.. in my mind I knew I neede to do this but didn&#39;t know how."}, {"owner": {"reputation": 189, "user_id": 9609148, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Pablo G", "link": "https://stackoverflow.com/users/9609148/pablo-g"}, "edited": false, "score": 0, "creation_date": 1547201522, "post_id": 54123676, "comment_id": 95119877, "body": "I&#39;m having some problems with this again but I&#39;ll edit the code because I saw something it might help"}, {"owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "edited": false, "score": 0, "creation_date": 1548059036, "post_id": 54123676, "comment_id": 95392766, "body": "You need to inform us with the detailed example and steps, like where you have the issue and what did you tried till now. It can help us to understand the issue in better way."}], "tags": [], "owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "is_accepted": false, "score": 1, "last_activity_date": 1547104987, "creation_date": 1547104987, "answer_id": 54123676, "question_id": 54109888, "link": "https://stackoverflow.com/questions/54109888/onchange-event-in-javascript-dependent-option-list/54123676#54123676", "title": "onchange event in JavaScript - dependent option list", "body": "<p>Try to refer code example below may help to solve your issue.</p>\n\n<pre><code>Dim event_onChange As Object \nSet event_onChange = hdoc.createEvent(\"HTMLEvents\") \nevent_onChange.initEvent \"change\", True, False \n\nvSelect.dispatchEvent event_onChange \n</code></pre>\n\n<p>Reference:</p>\n\n<p><a href=\"https://codedocu.com/Office-365/Access/Controls/web-Browser/Vba,-HTMLSelect_colon_-FireEvent-OnChange-or-DispatchEvent?1890\" rel=\"nofollow noreferrer\">Vba, HTMLSelect: FireEvent OnChange or DispatchEvent</a></p>\n"}], "owner": {"reputation": 189, "user_id": 9609148, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Pablo G", "link": "https://stackoverflow.com/users/9609148/pablo-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 247, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1556230650, "creation_date": 1547035973, "last_edit_date": 1556230650, "question_id": 54109888, "link": "https://stackoverflow.com/questions/54109888/onchange-event-in-javascript-dependent-option-list", "title": "onchange event in JavaScript - dependent option list", "body": "<p>I am trying to automate some task in IE with information from an Excel file. My knowledge in VBA lets me get to a point where I answer to a question in the website with \"yes\" and that should open another question with more options to select.\nAs said I get to the first yes but then the other question doesn't appear.</p>\n\n<p>Here is part of the JavaScript code from the website and part of the HTML code:</p>\n\n<pre><code>    var elemData = jQuery.data( elem );\n\n    // If no elemData is found then we must be trying to bind to one of the\n    // banned noData elements\n    if ( !elemData ) {\n        return;\n    }\n\n    var events = elemData.events = elemData.events || {},\n        eventHandle = elemData.handle, eventHandle;\n\n    if ( !eventHandle ) {\n        elemData.handle = eventHandle = function() {\n            // Handle the second event of a trigger and when\n            // an event is called after a page has unloaded\n            return typeof jQuery !== \"undefined\" &amp;&amp; !jQuery.event.triggered ?\n                jQuery.event.handle.apply( eventHandle.elem, arguments ) :\n                undefined;\n        };\n</code></pre>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;p&gt;\r\n\t&lt;span class=\"i_lbReq\"&gt;First question&lt;/span&gt; //this line has the 'change: eventHandle' event/function associated to it\r\n    &lt;br&gt;&lt;/br&gt;\r\n\t&lt;select name=\"meetingQuestionAnswer(220674)\" class=\"auto-save\"&gt;\r\n    &lt;option value=\"\"&gt; --- --- &lt;/option&gt;\r\n    &lt;option value=\"Yes\" selected=\"\"&gt;Yes&lt;/option&gt;\r\n    &lt;option value=\"No\"&gt;No&lt;/option&gt;\r\n    &lt;option value=\"Pending\"&gt;Pending&lt;/option&gt;\r\n    &lt;/select&gt;\r\n &lt;/p&gt;\r\n&lt;div class=\"recursive-question\" id=\"meetingDependentQuestion(220674)\"&gt; //this line has the 'change: eventHandle' event/function associated to it\r\n&lt;div id=\"meetingQuestionAnswerDiv(221010)\"&gt;\r\n    \t&lt;input name=\"meetingQuestionValidatorRule(221010)\" type=\"hidden\" value=\"\"&gt;\r\n      &lt;input name=\"meetingQuestionReadOnly(221010)\" type=\"hidden\" value=\"\"&gt;\r\n      &lt;p&gt;\r\n\t&lt;span class=\"i_lb\"&gt;Dependent question 1&lt;/span&gt;\r\n        &lt;br&gt;&lt;/br&gt;\r\n        &lt;select name=\"meetingQuestionAnswer(221010)\" class=\"auto-save\"&gt;\r\n        &lt;option value=\"\" selected=\"\"&gt; --- --- &lt;/option&gt;\r\n        &lt;option value=\"Yes\"&gt;Yes&lt;/option&gt;\r\n        &lt;option value=\"No\"&gt;No&lt;/option&gt;\r\n        &lt;/select&gt;\r\n      &lt;/p&gt;\r\n\t&lt;div class=\"recursive-question\" id=\"meetingDependentQuestion(221010)\"&gt;\r\n        &lt;div id=\"meetingQuestionAnswerDiv(221011)\"&gt;\r\n    \t  &lt;input name=\"meetingQuestionValidatorRule(221011)\" type=\"hidden\" value=\"\"&gt;\r\n          &lt;input name=\"meetingQuestionReadOnly(221011)\" type=\"hidden\" value=\"\"&gt;\r\n          &lt;p&gt;\r\n            &lt;span class=\"i_lb\"&gt;Dependent question 2&lt;/span&gt;\r\n            &lt;br&gt;&lt;/br&gt;\r\n            &lt;select name=\"meetingQuestionAnswer(221011)\" class=\"auto-save\"&gt;\r\n            &lt;option value=\"\" selected=\"\"&gt; --- --- &lt;/option&gt;\r\n            &lt;option value=\"Yes\"&gt;Yes&lt;/option&gt;\r\n            &lt;option value=\"No\"&gt;No&lt;/option&gt;\r\n            &lt;/select&gt;\r\n          &lt;/p&gt;\r\n\t\t\t&lt;div class=\"recursive-question\" id=\"meetingDependentQuestion(221011)\"&gt;\r\n\t\t  &lt;/div&gt;\r\n\t\t&lt;/div&gt;\r\n   &lt;/div&gt;\r\n  &lt;/div&gt;\r\n &lt;/div&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>I have tried with VBA to use the method .FireEvent \"onchange\" on the first question element but it didn't work</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Dim ieApp As SHDocVw.InternetExplorer\r\nSet ieApp = IEWindowFromTitle(\"Profile Form Detail View\")\r\nIf Not ieApp Is Nothing Then\r\n    Set ieDoc = ieApp.document\r\nEnd If\r\n\r\n\r\nFor Each cell In GMF.Sheets(\"BUDGET\").Range(\"B4:B\" &amp; Cells(Rows.count, 2).End(xlUp).Row)\r\n    If cell.Value = \"MRR\" Then\r\n        ieDoc.getElementsByName(\"meetingQuestionAnswer(220674)\")(0).Value = \"Yes\" 'this works fine\r\n        ieDoc.getElementsByName(\"meetingQuestionAnswer(220674)\")(0).FireEvent \"onchange\" \r\n        ieDoc.getElementsByName(\"meetingQuestionAnswerDiv(221010)\")(0).Value = \"Yes\" 'this one never appears after saying yes in the previous question\r\n    End If\r\nNext cell</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 266, "user_id": 10860682, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1p8ShEHvmxM/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYrC6ksVVo648mB97KGqwtUjVNJrA/mo/photo.jpg?sz=128", "display_name": "RCL", "link": "https://stackoverflow.com/users/10860682/rcl"}, "edited": false, "score": 0, "creation_date": 1547033011, "post_id": 54108763, "comment_id": 95050118, "body": "Lol did you create a new account? Just a coincidence that this has the exact same <a href=\"https://stackoverflow.com/questions/54086935/transfer-data-from-one-workbook-to-another-using-vba/54087188?noredirect=1#comment95046351_54087188\">code</a>?"}, {"owner": {"reputation": 13, "user_id": 10889308, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-UM7VAdGcQdc/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcb--32kEoWR50kIdEgn4CmdRfZWuQ/mo/photo.jpg?sz=128", "display_name": "taco bell", "link": "https://stackoverflow.com/users/10889308/taco-bell"}, "reply_to_user": {"reputation": 266, "user_id": 10860682, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1p8ShEHvmxM/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYrC6ksVVo648mB97KGqwtUjVNJrA/mo/photo.jpg?sz=128", "display_name": "RCL", "link": "https://stackoverflow.com/users/10860682/rcl"}, "edited": false, "score": 0, "creation_date": 1547033156, "post_id": 54108763, "comment_id": 95050185, "body": "had to man! they didnt allow me to post another question"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10889308, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-UM7VAdGcQdc/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcb--32kEoWR50kIdEgn4CmdRfZWuQ/mo/photo.jpg?sz=128", "display_name": "taco bell", "link": "https://stackoverflow.com/users/10889308/taco-bell"}, "edited": false, "score": 0, "creation_date": 1547035069, "post_id": 54109090, "comment_id": 95051286, "body": "if i want to create a new excel workbook and then transfer the data what should i add to this code?"}, {"owner": {"reputation": 355, "user_id": 10374467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ovjw3.png?s=128&g=1", "display_name": "Thryn", "link": "https://stackoverflow.com/users/10374467/thryn"}, "reply_to_user": {"reputation": 13, "user_id": 10889308, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-UM7VAdGcQdc/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcb--32kEoWR50kIdEgn4CmdRfZWuQ/mo/photo.jpg?sz=128", "display_name": "taco bell", "link": "https://stackoverflow.com/users/10889308/taco-bell"}, "edited": false, "score": 0, "creation_date": 1547035368, "post_id": 54109090, "comment_id": 95051480, "body": "Set MyData = Workbooks.Add, and change the Save and Close methods to use the variable MyData. Also, It would be MyData.SaveAs(&quot;&lt;path&gt;&quot;)"}, {"owner": {"reputation": 13, "user_id": 10889308, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-UM7VAdGcQdc/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcb--32kEoWR50kIdEgn4CmdRfZWuQ/mo/photo.jpg?sz=128", "display_name": "taco bell", "link": "https://stackoverflow.com/users/10889308/taco-bell"}, "edited": false, "score": 0, "creation_date": 1547036362, "post_id": 54109090, "comment_id": 95052084, "body": "i am not sure if i got you"}], "tags": [], "owner": {"reputation": 355, "user_id": 10374467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ovjw3.png?s=128&g=1", "display_name": "Thryn", "link": "https://stackoverflow.com/users/10374467/thryn"}, "is_accepted": true, "score": 0, "last_activity_date": 1547033288, "creation_date": 1547033288, "answer_id": 54109090, "question_id": 54108763, "link": "https://stackoverflow.com/questions/54108763/transfer-multiple-columns-from-one-workbook-to-another/54109090#54109090", "title": "Transfer multiple columns from one workbook to another", "body": "<p>This part of your code </p>\n\n<pre><code>Set myWs = ThisWorkbook.Sheets(\"FinalinputFile\")\nSet MyData = Workbooks.Open(\"D:\\Desktop\\My\\MyData.xlsx\")\nSet DataWs = MyData.Sheets(\"Data\")\n</code></pre>\n\n<p>Is repeated even thought it's the same every time, your code should be just fine without it, so you can shorten it by removing the repetitions.</p>\n\n<p>Also, the code for closing the workbook is <code>Workbooks(\"MyData\").Close</code> but you would have to save it, and it's better to call the full name like <code>Workbooks(\"MyData\").Save</code></p>\n\n<p>So your final code would look something like</p>\n\n<pre><code>Sub transfer()\nDim MyData As Workbook\nDim DataWs As Worksheet\nDim myWs As Worksheet\nSet myWs = ThisWorkbook.Sheets(\"FinalinputFile\")\nSet MyData = Workbooks.Open(\"D:\\Desktop\\My\\MyData.xlsx\")\nSet DataWs = MyData.Sheets(\"Data\")\n\nmyWs.Range(\"C3:C11000\").Copy\nDataWs.Range(\"E2\").PasteSpecial xlPasteAll\nmyWs.Range(\"E3:E11000\").Copy\nDataWs.Range(\"F2\").PasteSpecial xlPasteAll\nmyWs.Range(\"G3:G11000\").Copy\nDataWs.Range(\"G2\").PasteSpecial xlPasteAll\nmyWs.Range(\"I3:I11000\").Copy\nDataWs.Range(\"H2\").PasteSpecial xlPasteAll\nmyWs.Range(\"K3:K11000\").Copy\nDataWs.Range(\"I2\").PasteSpecial xlPasteAll\nmyWs.Range(\"M3:M11000\").Copy\nDataWs.Range(\"J2\").PasteSpecial xlPasteAll\nmyWs.Range(\"U3:U11000\").Copy\nDataWs.Range(\"M2\").PasteSpecial xlPasteAll \n\nWorkbooks(\"MyData\").Save\nWorkbooks(\"MyData\").Close\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 0, "last_activity_date": 1547039495, "last_edit_date": 1547039495, "creation_date": 1547038683, "answer_id": 54110723, "question_id": 54108763, "link": "https://stackoverflow.com/questions/54108763/transfer-multiple-columns-from-one-workbook-to-another/54110723#54110723", "title": "Transfer multiple columns from one workbook to another", "body": "<h1>Paste Column Ranges</h1>\n\n<h2>Highlights</h2>\n\n<ul>\n<li>Assigned all values to constants.</li>\n<li>Added workbook open check.</li>\n<li>Reduced object references to one worksheet.</li>\n<li>Replaced Copy/Paste with Copy (Destination).</li>\n</ul>\n\n<p>Adjust the values in the constants section to fit your needs.</p>\n\n<h2>The Code</h2>\n\n<pre><code>Sub transfer()\n\n    ' Source\n    Const cSource As Variant = \"FinalinputFile\"   ' Worksheet Name/Index\n    Const cSFirst As Integer = 3                  ' First Row Number\n    Const cLast As Integer = 11000                ' Last Row Number\n    Const cSCols As String = \"C,E,G,I,K,M,U\"      ' Column List\n    ' Target\n    Const cPath As String = \"D:\\Desktop\\My\\\"      ' Workbook Path\n    Const cName As String = \"MyData.xlsx\"         ' Workbook Name\n    Const cTarget As Variant = \"Data\"             ' Worksheet Name/Index\n    Const cTFirst As Integer = 2                  ' First Row Number\n    Const cTCols As String = \"E,F,G,H,I,J,M\"      ' Column List\n\n    Dim DataWs As Worksheet   ' Target Worksheet\n    Dim vntS As Variant       ' Source Column Array\n    Dim vntT As Variant       ' Target Column Array\n    Dim i As Integer          ' Columns Counter\n\n    ' Check if Target Workbook is already open.\n    For i = 1 To Workbooks.Count\n        If Workbooks(i).Name = cName Then Exit For\n    Next\n\n    ' Create reference to Target Worksheet.\n    If i &gt; Workbooks.Count Then ' Target Workbook is not open.\n        Set DataWs = Workbooks.Open(cPath &amp; cName).Worksheets(cTarget)\n      Else                      ' Target Workbook is open.\n        Set DataWs = Workbooks(i).Worksheets(cTarget)\n    End If\n\n    ' Write Column Lists into Column Arrays.\n    vntS = Split(cSCols, \",\")\n    vntT = Split(cTCols, \",\")\n\n    ' Copy Source Column Ranges to Target Columns Ranges.\n    With ThisWorkbook.Sheets(cSource)\n        For i = 0 To UBound(vntS) ' or Ubound(vntT) - it's the same.\n            .Range(.Cells(cSFirst, vntS(i)), .Cells(cLast, vntS(i))).Copy _\n            DataWs.Cells(cTFirst, vntT(i))\n        Next\n    End With\n\n    ' Save and close Target Workbook using Parent property.\n    With DataWs.Parent\n        .Close True ' True saves the workbook.\n    End With\n\n    Set DataWs = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10889308, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-UM7VAdGcQdc/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcb--32kEoWR50kIdEgn4CmdRfZWuQ/mo/photo.jpg?sz=128", "display_name": "taco bell", "link": "https://stackoverflow.com/users/10889308/taco-bell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 54109090, "answer_count": 2, "score": 1, "last_activity_date": 1547039495, "creation_date": 1547032141, "last_edit_date": 1547038750, "question_id": 54108763, "link": "https://stackoverflow.com/questions/54108763/transfer-multiple-columns-from-one-workbook-to-another", "title": "Transfer multiple columns from one workbook to another", "body": "<p>I want to transfer multiple columns to a new workbook named \"My data\" to a specified respective columns. I've tried this code but its too long and i want to try to make it short and once the process is completed i want to close the new work book not sure how to do that as well.</p>\n\n<pre><code>Sub transfer()\nDim MyData As Workbook\nDim DataWs As Worksheet\nDim myWs As Worksheet\nSet myWs = ThisWorkbook.Sheets(\"FinalinputFile\")\nSet MyData = Workbooks.Open(\"D:\\Desktop\\My\\MyData.xlsx\")\nSet DataWs = MyData.Sheets(\"Data\")\nmyWs.Range(\"C3:C11000\").Copy\nDataWs.Range(\"E2\").PasteSpecial xlPasteAll\n\nSet myWs = ThisWorkbook.Sheets(\"FinalinputFile\")\nSet MyData = Workbooks.Open(\"D:\\Desktop\\My\\MyData.xlsx\")\nSet DataWs = MyData.Sheets(\"Data\")\nmyWs.Range(\"E3:E11000\").Copy\nDataWs.Range(\"F2\").PasteSpecial xlPasteAll\n\nSet myWs = ThisWorkbook.Sheets(\"FinalinputFile\")\nSet MyData = Workbooks.Open(\"D:\\Desktop\\My\\MyData.xlsx\")\nSet DataWs = MyData.Sheets(\"Data\")\nmyWs.Range(\"G3:G11000\").Copy\nDataWs.Range(\"G2\").PasteSpecial xlPasteAll\n\nSet myWs = ThisWorkbook.Sheets(\"FinalinputFile\")\nSet MyData = Workbooks.Open(\"D:\\Desktop\\My\\MyData.xlsx\")\nSet DataWs = MyData.Sheets(\"Data\")\nmyWs.Range(\"I3:I11000\").Copy\nDataWs.Range(\"H2\").PasteSpecial xlPasteAll\n\nSet myWs = ThisWorkbook.Sheets(\"FinalinputFile\")\nSet MyData = Workbooks.Open(\"D:\\Desktop\\My\\MyData.xlsx\")\nSet DataWs = MyData.Sheets(\"Data\")\nmyWs.Range(\"K3:K11000\").Copy\nDataWs.Range(\"I2\").PasteSpecial xlPasteAll\n\nSet myWs = ThisWorkbook.Sheets(\"FinalinputFile\")\nSet MyData = Workbooks.Open(\"D:\\Desktop\\My\\MyData.xlsx\")\nSet DataWs = MyData.Sheets(\"Data\")\nmyWs.Range(\"M3:M11000\").Copy\nDataWs.Range(\"J2\").PasteSpecial xlPasteAll\n\n\nSet myWs = ThisWorkbook.Sheets(\"FinalinputFile\")\nSet MyData = Workbooks.Open(\"D:\\Desktop\\My\\MyData.xlsx\")\nSet DataWs = MyData.Sheets(\"Data\")\nmyWs.Range(\"U3:U11000\").Copy\nDataWs.Range(\"M2\").PasteSpecial xlPasteAll\n\n\n  MyData.Save\n\n  End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 208, "user_id": 7430332, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/4MdKa.jpg?s=128&g=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/7430332/jonathan"}, "edited": false, "score": 0, "creation_date": 1547032065, "post_id": 54108257, "comment_id": 95049621, "body": "Hello, weekday is indeed working, though I am a bit disappointed by the unnecessary comment: my Google searches did not lead me there, neither did searches on stack overflow. I would wish I would get more empathy toward my own search."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 208, "user_id": 7430332, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/4MdKa.jpg?s=128&g=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/7430332/jonathan"}, "edited": false, "score": 3, "creation_date": 1547032278, "post_id": 54108257, "comment_id": 95049748, "body": "Apologies &quot;Find weekday in excel vba&quot; gave me 10,400,000 results in under 1/2 a second, the first being WEEKDAY"}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": true, "score": 3, "last_activity_date": 1547031028, "last_edit_date": 1547031028, "creation_date": 1547030544, "answer_id": 54108257, "question_id": 54108218, "link": "https://stackoverflow.com/questions/54108218/vba-get-the-week-day-number-from-a-date/54108257#54108257", "title": "vba: get the week day number from a date?", "body": "<p>A bit of googling would have found the <code>WEEKDAY</code> function</p>\n\n<p><code>weekday(date,vbMonday)</code></p>\n"}], "owner": {"reputation": 208, "user_id": 7430332, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/4MdKa.jpg?s=128&g=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/7430332/jonathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 440, "favorite_count": 0, "accepted_answer_id": 54108257, "answer_count": 1, "score": -3, "last_activity_date": 1547031172, "creation_date": 1547030415, "last_edit_date": 1547031172, "question_id": 54108218, "link": "https://stackoverflow.com/questions/54108218/vba-get-the-week-day-number-from-a-date", "title": "vba: get the week day number from a date?", "body": "<p>I would like to get the week day number from a date.</p>\n\n<p>E.g. :  if it is a Monday returns 1, if it is a Tuesday it returns 2, ... if it is a Sunday it returns 7.</p>\n\n<p>I was wondering if there is a direct function to obtain this, for instance:</p>\n\n<pre><code>DayNumber = Format(Date, &lt;format unknown to me&gt;)\n</code></pre>\n\n<p>The closest I could get is to use the function:</p>\n\n<pre><code>DayNumber = Format(Date, \"dddd\")\n</code></pre>\n\n<p>then loop through a predefined list of possible names, but I still wonder if there is a simpler way?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1547030602, "post_id": 54108154, "comment_id": 95048609, "body": "Try replacing the semi-colons with commas. (And using the Formula property rather than Value.) Oh, and you don&#39;t need the second loop."}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1547033147, "post_id": 54108154, "comment_id": 95050177, "body": "Some Scandinavian language require the semi-colon in place of the comma. On my comma-requiring PC assigning the &quot;=IF(1=1,1,0)&quot; works fine even when assigning to Value but using semi-colons fails with error 1004. That surprised me because I was expecting Excel to be able to recognize a Value as Text. Apparently the leading = sign prevents that. Presuming that Kondado knows that his PC needs semi-colons, it would appear that his version of Excel reacts differently from mine when a formula is (wrongly) assigned to Value."}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1547033260, "post_id": 54108154, "comment_id": 95050240, "body": "BTW, I wouldn&#39;t call a procedure &quot;Replace&quot; because &quot;Replace&quot; is both a VBA and Excel Object and using the name can cause misunderstandings (= crashes). Before using a name, select it and press F1."}, {"owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "reply_to_user": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1547037516, "post_id": 54108154, "comment_id": 95052781, "body": "@Variatus It&#39;s not that Kondado&#39;s Excel reacts differently. It&#39;s that although some setups use semi-colon as separator in formulas written in worksheet, VBA is the same for everyone and you must use commas."}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "reply_to_user": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 0, "creation_date": 1547082780, "post_id": 54108154, "comment_id": 95073543, "body": "@Egan Wolf Interesting thought but I stumble over the fact that the code assigns a string to the cells&#39;s Value property. Can&#39;t help feeling that Excel is stumbling over its own feet here."}, {"owner": {"reputation": 148, "user_id": 9022725, "user_type": "registered", "profile_image": "https://graph.facebook.com/997443353623413/picture?type=large", "display_name": "Kondado", "link": "https://stackoverflow.com/users/9022725/kondado"}, "reply_to_user": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 0, "creation_date": 1547124459, "post_id": 54108154, "comment_id": 95089189, "body": "@EganWolf Just saw Egan Wolf&#39;s comment -- didn&#39;t know that!"}], "answers": [{"comments": [{"owner": {"reputation": 148, "user_id": 9022725, "user_type": "registered", "profile_image": "https://graph.facebook.com/997443353623413/picture?type=large", "display_name": "Kondado", "link": "https://stackoverflow.com/users/9022725/kondado"}, "edited": false, "score": 0, "creation_date": 1547124286, "post_id": 54108427, "comment_id": 95089098, "body": "Thanks SJR and all others who have answered!!! The reason was using semi-colon instead of comma. I usually have to use semi-colon when typing the formula directly into Excel, but for some reason VBScript expects a simple comma.   I also re-checked the system settings, as I had also been experimenting with converting between CSV and Excel for some data analysis, but even if I changed the setting and restarted Excel it still expected a comma in VBScript. I had also checked Excels own settings in this aspect. Anyway, you saved my day!! Thanks again!"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 148, "user_id": 9022725, "user_type": "registered", "profile_image": "https://graph.facebook.com/997443353623413/picture?type=large", "display_name": "Kondado", "link": "https://stackoverflow.com/users/9022725/kondado"}, "edited": false, "score": 0, "creation_date": 1547131568, "post_id": 54108427, "comment_id": 95093477, "body": "My pleasure. As an addendum you can use <code>FormulaLocal</code> instead and retain your semi-colons."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 0, "last_activity_date": 1547031048, "creation_date": 1547031048, "answer_id": 54108427, "question_id": 54108154, "link": "https://stackoverflow.com/questions/54108154/simple-if-statement-for-activesheet-range-value-in-excel-vbs-triggers-1004-runt/54108427#54108427", "title": "Simple =IF Statement for ActiveSheet.Range.Value in Excel VBS triggers 1004 Runtime Error", "body": "<p>Your code could be reduced to the following as in addition to comments you don't need to activate sheets. See <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba?r=SearchResults&amp;s=1%7C271.1819\">how to avoid select</a>.</p>\n\n<p>This will also generally work for more complex formulae (such as your example) - Excel will work out the relative references.</p>\n\n<pre><code>Sub replace()\n\nDim ws As Worksheet\n\nFor Each ws In ActiveWorkbook.Worksheets\n    ws.Range(\"T5:T20\").Formula = \"=IF(1=1,1,0)\"\nNext ws\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 148, "user_id": 9022725, "user_type": "registered", "profile_image": "https://graph.facebook.com/997443353623413/picture?type=large", "display_name": "Kondado", "link": "https://stackoverflow.com/users/9022725/kondado"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 216, "favorite_count": 0, "accepted_answer_id": 54108427, "answer_count": 1, "score": 1, "last_activity_date": 1579793699, "creation_date": 1547030207, "last_edit_date": 1579793699, "question_id": 54108154, "link": "https://stackoverflow.com/questions/54108154/simple-if-statement-for-activesheet-range-value-in-excel-vbs-triggers-1004-runt", "title": "Simple =IF Statement for ActiveSheet.Range.Value in Excel VBS triggers 1004 Runtime Error", "body": "<p>Got the following code which DOES WORK as an Excel VBScript Macro:</p>\n\n<pre><code>Sub replace()\n    Dim ws As Worksheet\n\n    For Each ws In ActiveWorkbook.Worksheets\n        Sheets(ws.Name).Activate\n\n        Dim I\n        For I = 5 To 20\n            ActiveSheet.Range(\"T\" &amp; I).Value = \"=AVERAGE(3)\"\n        Next I\n    Next ws\nEnd Sub\n</code></pre>\n\n<p>Obviously <code>=AVERAGE(3)</code> is not meant to be useful in any way, but to show that this code above <strong>works</strong>, and the following chunk does <strong>not</strong>:</p>\n\n<pre><code>Sub replace()\n    Dim ws As Worksheet\n\n    For Each ws In ActiveWorkbook.Worksheets\n        Sheets(ws.Name).Activate\n\n        Dim I\n        For I = 5 To 20\n            ActiveSheet.Range(\"T\" &amp; I).Value = \"=IF(1=1;1;0)\"\n        Next I\n     Next ws\nEnd Sub\n</code></pre>\n\n<p>Actually there should be a way more complex formula where the <code>IF</code> is (which looks something like: <code>=IF(Q5&lt;&gt;0;IF(R5+S5&gt;Q5;\"ERROR\";IF(R5=\"\";S5/Q5;IF(Q5=R5;\"Coord.\";S5/(Q5-R5))));\"N/A\")</code>.</p>\n\n<p>The thing is, I narrowed it down until I saw that even that trivial <code>=IF(1=1;1;0)</code> statement fails with the 1004 runtime error.</p>\n\n<p>I don't think it's of importance to solve the issue, but the whole macro is just for the purpose of updating about 15 cells on each worksheet for about 31 worksheets. As I said, the first chunk works (with the <code>AVERAGE()</code> calculation) but the <code>=IF</code> does not work.</p>\n\n<hr>\n\n<p>For the sake of completeness, this was the code that I wanted to have:</p>\n\n<pre><code>Sub updCells()\n\n    Dim ws As Worksheet\n\n    For Each ws In ActiveWorkbook.Worksheets\n    Sheets(ws.Name).Activate\n\n        Dim I\n        For I = 5 To 20\n        ActiveSheet.Range(\"T\" &amp; I).Value = \"=IF(Q\" &amp; I &amp; \"&lt;&gt;0,IF(R\" &amp; I &amp; \"+S\" &amp; I &amp; \"&gt;Q\" &amp; I &amp; \",\"\"ERROR\"\",IF(R\" &amp; I &amp; \"=\"\"\"\",S\" &amp; I &amp; \"/Q\" &amp; I &amp; \",IF(Q\" &amp; I &amp; \"=R\" &amp; I &amp; \",\"\"Coord.\"\",S\" &amp; I &amp; \"/(Q\" &amp; I &amp; \"-R\" &amp; I &amp; \")))),\"\"N/A\"\")\"\n\n        Next I\n\n     Next ws\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "algorithm", "runtime", "stochastic"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 4, "creation_date": 1547031130, "post_id": 54108100, "comment_id": 95048938, "body": "Since your code works, this might be better asked at Code Review."}, {"owner": {"reputation": 729, "user_id": 10592083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4de56871e4961d2cf0476cbbdcc3d18?s=128&d=identicon&r=PG&f=1", "display_name": "J.schmidt", "link": "https://stackoverflow.com/users/10592083/j-schmidt"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1547031238, "post_id": 54108100, "comment_id": 95049006, "body": "Oh! Never heard of that. Thank you!"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1547032064, "post_id": 54108100, "comment_id": 95049620, "body": "You may try changing the first do while to be a for next loop from 0 to 10M"}, {"owner": {"reputation": 729, "user_id": 10592083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4de56871e4961d2cf0476cbbdcc3d18?s=128&d=identicon&r=PG&f=1", "display_name": "J.schmidt", "link": "https://stackoverflow.com/users/10592083/j-schmidt"}, "edited": false, "score": 0, "creation_date": 1547036061, "post_id": 54108100, "comment_id": 95051899, "body": "If I&#39;d use a next loop I would stil need a do while / do until loop so the array x() gets a value for every passing..."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1547221372, "post_id": 54108100, "comment_id": 95130436, "body": "@J.schmidt You&#39;ve been <a href=\"https://stackoverflow.com/users/10592083/j-schmidt?tab=activity&amp;sort=revisions\">bulk editing questions to add <code>excel-vba</code> tag</a>. Please read the <a href=\"https://stackoverflow.com/tags/excel-vba/info\">tag&#39;s description</a>. It has been marked for removal and should not be used. Please undo your edits."}, {"owner": {"reputation": 729, "user_id": 10592083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4de56871e4961d2cf0476cbbdcc3d18?s=128&d=identicon&r=PG&f=1", "display_name": "J.schmidt", "link": "https://stackoverflow.com/users/10592083/j-schmidt"}, "edited": false, "score": 0, "creation_date": 1547320173, "post_id": 54108100, "comment_id": 95155773, "body": "my bad! thanks for reminding."}], "owner": {"reputation": 729, "user_id": 10592083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4de56871e4961d2cf0476cbbdcc3d18?s=128&d=identicon&r=PG&f=1", "display_name": "J.schmidt", "link": "https://stackoverflow.com/users/10592083/j-schmidt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 335, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1547031140, "creation_date": 1547030010, "last_edit_date": 1547031140, "question_id": 54108100, "link": "https://stackoverflow.com/questions/54108100/excel-vba-implementing-box-muller-zigurrat-and-ratio-of-uniforms-algorithm", "title": "Excel VBA: Implementing Box Muller, Zigurrat and Ratio of Uniforms Algorithm", "body": "<p>This is a very specific question mixing up stochastic knowledge and VBA skills. So very exciting!</p>\n\n<p>I'm trying to compare several methods for generating standard, normally distributed numbers given a source of uniformly distributed random numbers. Therefore I'm implementing the <a href=\"https://en.wikipedia.org/wiki/Box%E2%80%93Muller_transform\" rel=\"nofollow noreferrer\">Box Muller Algorithm</a>, <a href=\"http://cis.poly.edu/~mleung/CS909/s04/Ziggurat.pdf\" rel=\"nofollow noreferrer\">Ziggurat Algorithm</a> and <a href=\"http://www2.econ.osaka-u.ac.jp/~tanizaki/class/2013/econome3/13.pdf\" rel=\"nofollow noreferrer\">Ratio of Uniforms Algorithm</a>. Every single implementation works great in terms of generating a clean standard, normally distribution. (checked by <a href=\"https://en.wikipedia.org/wiki/Shapiro%E2%80%93Wilk_test\" rel=\"nofollow noreferrer\">Shapiro-Wilk-Test</a>).</p>\n\n<p>What I want to find out: <strong>which is the quickest method</strong>?</p>\n\n<p>Testing every single program with a total of 10^7 generated numbers these are the run times:</p>\n\n<p><strong>Box-Muller: 3,7 seconds<br>\nZiggurat: 1,28 seconds<br>\nRatio of Uniforms: 10,77 seconds</strong></p>\n\n<p>Actually I am very happy about those readings, because I didn't expect it to be that fast. Of course the run time of every single method depends as well on my programm-skills and VBA knowledge. </p>\n\n<p><strong>My problem</strong>: after doing some research I found out that the Ratio of Uniforms Algorithm should be the quickest (about 3 to 4 times quicker than Box Muller). This information just leans on this <a href=\"https://stackoverflow.com/questions/7183229/what-is-the-fastest-method-of-sampling-random-values-from-a-gaussian-distributio\">stack</a>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Bk2GH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Bk2GH.png\" alt=\"enter image description here\"></a></p>\n\n<p>I am curious <strong>if this is just a wrong claim</strong> of this user or (what I do expect more) <strong>if my code is not perfectly implemented</strong>. Therefore I'll post my code and hope someone could help me with my question, if my code is just not good enough or if the Ratio of Uniforms just doesn't work that quick as mentioned.</p>\n\n<pre><code>Sub RatioUniforms()\n\nDim x(10000000) As Double\nDim passing As Long\nDim amount As Long: amount = 10000000\nDim u1 As Double\nDim u2 As Double\nDim v2 As Double\n\n    Do While passing &lt;= amount\n        Do\n            u1 = Rnd    'rnd= random number(0,1)\n        Loop Until u1 &lt;&gt; 0  'u1 musn't become 0\n        v2 = Rnd\n        u2 = (2 * v2 - 1) * (2 * exp(-1)) ^ (1 / 2)\n        If u1 ^ 2 &lt;= exp(-1 / 2 * u2 ^ 2 / u1 ^ 2) Then\n            x(passing) = u2 / u1\n            passing = passing + 1\n        End If\n    Loop\n\n End Sub\n</code></pre>\n\n<p>Thank you very much helping me on this toppic. Maybe some of you have tried those algorithms in VBA or other languages and can help me with there experience about the run time? If you need something else to know about my other implementations just let me know. Have a great day!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1547029493, "post_id": 54107874, "comment_id": 95047900, "body": "Are you sure you have different Excel instances? Or do you just have 2 files open in the same Excel instance? Can you please include in your question (<a href=\"https://stackoverflow.com/posts/54107874/edit\">edit</a>) how these 2 files are opened (manually or by code, if by code please post the relevant code part). \u2022 If it is the same Excel instance with 2 files you can easily access them by <code>Workbooks(&quot;OtherBook.xlsm&quot;).Worksheets(&quot;DesiredSheet&quot;)</code>."}, {"owner": {"reputation": 1048, "user_id": 9194464, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-seaWoF1hiDU/AAAAAAAAAAI/AAAAAAAAADo/raR_sZ3tMJo/photo.jpg?sz=128", "display_name": "Jorge Ribeiro", "link": "https://stackoverflow.com/users/9194464/jorge-ribeiro"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1547031312, "post_id": 54107874, "comment_id": 95049067, "body": "With document opened is very dificult, i will change requirements and the document must be closed.thanks"}], "answers": [{"tags": [], "owner": {"reputation": 172, "user_id": 10627624, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-q24pnMMCBhM/AAAAAAAAAAI/AAAAAAAAAI0/9V6VmJktiDI/photo.jpg?sz=128", "display_name": "Alexey C", "link": "https://stackoverflow.com/users/10627624/alexey-c"}, "is_accepted": true, "score": 3, "last_activity_date": 1547029625, "creation_date": 1547029625, "answer_id": 54107976, "question_id": 54107874, "link": "https://stackoverflow.com/questions/54107874/comunicate-between-different-opened-documents/54107976#54107976", "title": "Comunicate between different opened documents", "body": "<pre><code>Dim wb1 as Workbook    \nSet wb1 = Workbooks(\"Book1.xlsx\")\n\nDim wb2 as Workbook\nSet wb2 = Workbooks(\"Book2.xlsx\")\n</code></pre>\n\n<p>And then use constructions like this, for example:</p>\n\n<pre><code>wb2.Worksheets(\"Sheet1\").Range(\"A1\") = wb1.Worksheets(\"SomeSheet\").Range(\"C12\")\n</code></pre>\n"}], "owner": {"reputation": 1048, "user_id": 9194464, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-seaWoF1hiDU/AAAAAAAAAAI/AAAAAAAAADo/raR_sZ3tMJo/photo.jpg?sz=128", "display_name": "Jorge Ribeiro", "link": "https://stackoverflow.com/users/9194464/jorge-ribeiro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 54107976, "answer_count": 1, "score": -1, "last_activity_date": 1547031426, "creation_date": 1547029304, "last_edit_date": 1547031426, "question_id": 54107874, "link": "https://stackoverflow.com/questions/54107874/comunicate-between-different-opened-documents", "title": "Comunicate between different opened documents", "body": "<p>It is possible to comunicate between to sheets on separated excel files opened on same machine?</p>\n\n<p>I need to write a cell on another excel file.\nI cant find any way to do it, i need a tip to help.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 27, "user_id": 10754792, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3dueELk9_AI/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-g2fDQr2M9T9TctAdny_eodPKVxzQ/mo/photo.jpg?sz=128", "display_name": "Stefan", "link": "https://stackoverflow.com/users/10754792/stefan"}, "edited": false, "score": 0, "creation_date": 1547029649, "post_id": 54107737, "comment_id": 95048002, "body": "If I sort the data before running the code, so all the rows with the right criteria is in the top (it&#39;s about 5 lines), then the data I copied correct."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1547029865, "post_id": 54107737, "comment_id": 95048122, "body": "What happens if you move the line <code>ThisWorkbook.Sheets(&quot;Test&quot;).Range(&quot;H26&quot;).Offset((lastrow_Off&zwnj;&#8203;set + 1) - 26, 0).Insert</code> before <code>.AutoFilterMode = False</code>"}, {"owner": {"reputation": 27, "user_id": 10754792, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3dueELk9_AI/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-g2fDQr2M9T9TctAdny_eodPKVxzQ/mo/photo.jpg?sz=128", "display_name": "Stefan", "link": "https://stackoverflow.com/users/10754792/stefan"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1547029966, "post_id": 54107737, "comment_id": 95048187, "body": "Doens&#39;t work. The data is still not copied, and inserted."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1547030014, "post_id": 54107737, "comment_id": 95048222, "body": "<code>Debug.Print Range(&quot;C5:C&quot; &amp; lastrow).SpecialCells(xlCellTypeVisible).Address</code> gives you the correct address?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1547030063, "post_id": 54107737, "comment_id": 95048256, "body": "Also check what is the value of <code>lastrow</code>"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1547030082, "post_id": 54107737, "comment_id": 95048268, "body": "Have you stepped through to see what&#39;s going on? What happens if you paste rather than Insert?"}, {"owner": {"reputation": 27, "user_id": 10754792, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3dueELk9_AI/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-g2fDQr2M9T9TctAdny_eodPKVxzQ/mo/photo.jpg?sz=128", "display_name": "Stefan", "link": "https://stackoverflow.com/users/10754792/stefan"}, "edited": false, "score": 0, "creation_date": 1547032037, "post_id": 54107737, "comment_id": 95049606, "body": "Debug gives me $C$5:$C$252 which is the entire Column with data in it. And yes I have tried taking it step-by-step. And the data is filtered correctly and all."}, {"owner": {"reputation": 27, "user_id": 10754792, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3dueELk9_AI/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-g2fDQr2M9T9TctAdny_eodPKVxzQ/mo/photo.jpg?sz=128", "display_name": "Stefan", "link": "https://stackoverflow.com/users/10754792/stefan"}, "edited": false, "score": 0, "creation_date": 1547032275, "post_id": 54107737, "comment_id": 95049746, "body": "So when I use PasteSpecial it works. How can that be?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1547036172, "post_id": 54107737, "comment_id": 95051969, "body": "Can you try this for me? Replace <code>.Range(&quot;C5:C&quot; &amp; lastrow).SpecialCells(xlCellTypeVisible).Copy</code> with <code>Dim Rng as Range: Set Rng = .Range(&quot;C5:C&quot; &amp; lastrow).SpecialCells(xlCellTypeVisible)</code> And just before <code>ThisWorkbook.Sheets(&quot;Test&quot;).Range(&quot;H26&quot;).Offset((lastrow_Off&zwnj;&#8203;set + 1) - 26, 0).Insert</code>, type this <code>Rng.Copy: DoEvents</code> What happens?"}], "answers": [{"comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1547035118, "post_id": 54109594, "comment_id": 95051318, "body": "<code>You don&#39;t paste your data. The Insert-command simply creates a new (empty) line, that&#39;s all.</code> That is not true. If you copy the data, you can use <code>.Insert</code> to paste the copied cells :)"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1547035570, "post_id": 54109594, "comment_id": 95051606, "body": "@SiddharthRout: Hmm, you&#39;re right - but somehow it&#39;s not working when I make the <code>Copy</code> (without destination) and use <code>dest.Insert</code> afterwards. I will investigate..."}, {"owner": {"reputation": 27, "user_id": 10754792, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3dueELk9_AI/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-g2fDQr2M9T9TctAdny_eodPKVxzQ/mo/photo.jpg?sz=128", "display_name": "Stefan", "link": "https://stackoverflow.com/users/10754792/stefan"}, "edited": false, "score": 0, "creation_date": 1547035603, "post_id": 54109594, "comment_id": 95051627, "body": "Well then I should have been able to use Insert.  I just changed the insert to PasteSpecial."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1547036646, "post_id": 54109594, "comment_id": 95052246, "body": "<code>it seems that this is not working if a non-contiguous range was selected for copy</code> True but I crossed checked before. it is contiguous. See my 2nd comment and the reply to that in the comment section below the question"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1547036698, "post_id": 54109594, "comment_id": 95052272, "body": "My question was <code>Debug.Print Range(&quot;C5:C&quot; &amp; lastrow).SpecialCells(xlCellTypeVisible).Address gives you the correct address? \u2013 Siddharth Rout</code> and Stefan&#39;s answer was <code>Debug gives me $C$5:$C$252 which is the entire Column with data in it. And yes I have tried taking it step-by-step. And the data is filtered correctly and all. \u2013 Stefan 1 hour ago </code>"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1547037834, "post_id": 54109594, "comment_id": 95052949, "body": "Yes, I know - but my experiments showed me that as long as the range is contiguous, <code>Insert</code> copies the data, but if it is not, it doesn&#39;t."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1547043293, "post_id": 54109594, "comment_id": 95056266, "body": "Yup I agree with you :)"}], "tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": false, "score": 0, "last_activity_date": 1547037918, "last_edit_date": 1547037918, "creation_date": 1547034978, "answer_id": 54109594, "question_id": 54107737, "link": "https://stackoverflow.com/questions/54107737/autofilter-copy-and-the-insert-data-isnt-insert-even-though-the-code-runs-wit/54109594#54109594", "title": "Autofilter, copy and the insert. Data isn&#39;t insert even though the code runs without errors", "body": "<p>You don't paste your data. The <code>Insert</code>-command simply creates a new (empty) line, that's all.</p>\n\n<p>Change your code to</p>\n\n<pre><code>With wbk.Sheets(1)\n    .AutoFilterMode = False\n    .Range(\"A4:AL\" &amp; lastrow).AutoFilter Field:=37, Criteria1:=\"=NC\", Operator:=xlFilterValues\n    .Range(\"A4:AL\" &amp; lastrow).AutoFilter Field:=38, Criteria1:=\"=New\", Operator:=xlFilterValues\n\n    lastrow_Offset = ThisWorkbook.Sheets(\"Test\").Cells(Rows.Count, \"H\").End(xlUp).row\n    Dim destCell As Range\n    Set destCell = ThisWorkbook.Sheets(\"Test\").Range(\"H26\").Offset((lastrow_Offset + 1) - 26, 0)\n    .Range(\"C1:C\" &amp; lastrow).SpecialCells(xlCellTypeVisible).Copy destCell\n\n    .AutoFilterMode = False\nEnd With\n</code></pre>\n\n<p><strong>Update</strong>: as Siddharth Rout pointed out, I was wrong, the <code>Insert</code> pastes data. However, it seems that this is not working if a non-contiguous range was selected for copy - as it is the most cases for filtered data.</p>\n\n<p>In that case, either provide the destination-parameter already when copying the data (as I do in my code above) or use the <code>PasteSpecial</code>-method of the destination range. I prefer to use the first method as it doesn't keep the data in the paste-buffer, but that's a minor thing.</p>\n"}], "owner": {"reputation": 27, "user_id": 10754792, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3dueELk9_AI/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-g2fDQr2M9T9TctAdny_eodPKVxzQ/mo/photo.jpg?sz=128", "display_name": "Stefan", "link": "https://stackoverflow.com/users/10754792/stefan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1547037918, "creation_date": 1547028865, "question_id": 54107737, "link": "https://stackoverflow.com/questions/54107737/autofilter-copy-and-the-insert-data-isnt-insert-even-though-the-code-runs-wit", "title": "Autofilter, copy and the insert. Data isn&#39;t insert even though the code runs without errors", "body": "<p>Below code runs \"perfectly\". I can see that the data is filtered, and I can see that the correct range is selected. And I'm assuming that the data in the range is copied.</p>\n\n<p>However, when trying to insert the copied data, nothing appears. I can see that there is data in the range which is supposedly copied.</p>\n\n<p>The weird thing is that I know it worked at some point, and suddenly it didn't.</p>\n\n<pre><code>Const sFILE_PATH    As String = \"C:\\Downloads\\\"\nConst sEXTENSION    As String = \".xlsm\"\n\nDim lastrow As Long\nDim lastrow_Offset As Long\n\nDim wbk As Workbook\nDim sFileName As String\n\nsFileName = \"2018\"\n\nSet wbk = Workbooks(sFileName &amp; sEXTENSION)\n\n\nlastrow_Offset = ThisWorkbook.Sheets(\"Test\").Cells(Rows.Count, \"h\").End(xlUp).Row\nlastrow = wbk.Sheets(\"Acc\").Cells(Rows.Count, \"C\").End(xlUp).Row\n\nApplication.ScreenUpdating = False\n\n\n\n\nWith wbk.Sheets(\"Acc\")\n    .AutoFilterMode = False\n    .Range(\"A4:AL\" &amp; lastrow).AutoFilter Field:=37, Criteria1:=\"=NC\", Operator:=xlFilterValues\n    .Range(\"A4:AL\" &amp; lastrow).AutoFilter Field:=38, Criteria1:=\"=New\", Operator:=xlFilterValues\n\n\n\n     Debug.Print Range(\"C5:C\" &amp; lastrow).SpecialCells(xlCellTypeVisible).Address\n\n    .Range(\"C5:C\" &amp; lastrow).SpecialCells(xlCellTypeVisible).Copy\n\n\n\n    .AutoFilterMode = False\nEnd With\n\nThisWorkbook.Sheets(\"Test\").Range(\"H26\").Offset((lastrow_Offset + 1) - 26, 0).Insert\n\nApplication.ScreenUpdating = True\n</code></pre>\n"}, {"tags": ["html", "excel", "vba", "web-scraping"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 10888586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/784e1e8197fd16df41d16358d070ee06?s=128&d=identicon&r=PG&f=1", "display_name": "noel.H", "link": "https://stackoverflow.com/users/10888586/noel-h"}, "edited": false, "score": 0, "creation_date": 1547084034, "post_id": 54108777, "comment_id": 95073810, "body": "Thanks, it worked on my computer! but is there any method to interact with the drop down without using external library? I would like to make the macro usable for other user without  installing something new"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1547033524, "last_edit_date": 1547033524, "creation_date": 1547032182, "answer_id": 54108777, "question_id": 54107030, "link": "https://stackoverflow.com/questions/54107030/how-to-fill-in-html-autocomplete-fields-using-vba/54108777#54108777", "title": "How to fill in html autocomplete fields using vba?", "body": "<p>If using browser I would go with <a href=\"https://github.com/florentbr/SeleniumBasic/releases/tag/v2.0.9.0\" rel=\"nofollow noreferrer\">Selenium basic</a> automation as it is easy to trigger the events associated with the input fields. Note I am using the iframe src url direct to avoid having to navigate the iframe containing the form. After installing selenium you need to ensure latest Chrome and Chromedriver with chromedriver.exe in the same folder as the selenium executables. Also, go vbe > tools > references and add a reference to selenium type library.</p>\n\n<p>It is also possible, I think, to do a series POST xmlhttp request provided you can grab and pass on the right cookies.</p>\n\n<p>The lines in code below </p>\n\n<pre><code>.FindElementByCss(\"#ui-id-1 li.ui-menu-item\")\n</code></pre>\n\n<p>and</p>\n\n<pre><code>.FindElementByCss(\"#ui-id-2 li.ui-menu-item\")\n</code></pre>\n\n<p>select the first list element in the dropdowns.</p>\n\n<p>The drop down values are generated continuously from JSON repsonse to POST requests as you type. I have sent the entire required airport string in one go to ensure the first item is the desired.</p>\n\n<pre><code>Option Explicit\nPublic Sub GetInfo()\n    Dim d As WebDriver\n    Set d = New ChromeDriver\n    Const Url = \"https://applications.icao.int/icec\"\n    With d\n        .Start \"Chrome\"\n        .get Url\n        .FindElementByCss(\"[name=frm1]\").SendKeys \"AAD\"\n        .FindElementByCss(\"#ui-id-1 li.ui-menu-item\").Click\n        .FindElementByCss(\"[name=to1]\").SendKeys \"MGQ\"\n        .FindElementByCss(\"#ui-id-2 li.ui-menu-item\").Click\n        .FindElementById(\"computeByInput\").Click\n\n        Stop   'delete me later\n        .Quit\n    End With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1547109060, "post_id": 54123481, "comment_id": 95080574, "body": "nicely done there +1. Remember you can accept your own answer after two days. As a safety measure you might consider using a timed loop to avoid potential infinite loop."}, {"owner": {"reputation": 31, "user_id": 10888586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/784e1e8197fd16df41d16358d070ee06?s=128&d=identicon&r=PG&f=1", "display_name": "noel.H", "link": "https://stackoverflow.com/users/10888586/noel-h"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1547192436, "post_id": 54123481, "comment_id": 95115498, "body": "Thanks! I will implement the loop later."}], "tags": [], "owner": {"reputation": 31, "user_id": 10888586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/784e1e8197fd16df41d16358d070ee06?s=128&d=identicon&r=PG&f=1", "display_name": "noel.H", "link": "https://stackoverflow.com/users/10888586/noel-h"}, "is_accepted": true, "score": 1, "last_activity_date": 1548399138, "last_edit_date": 1548399138, "creation_date": 1547104097, "answer_id": 54123481, "question_id": 54107030, "link": "https://stackoverflow.com/questions/54107030/how-to-fill-in-html-autocomplete-fields-using-vba/54123481#54123481", "title": "How to fill in html autocomplete fields using vba?", "body": "<p>I have figured out how to do this with vba. \nEDIT: complete code requested</p>\n\n<pre><code>iedoc.getElementsByName(\"frm1\")(0).innerText = \"somecountry\"            ' enter string of country\nSet li_arr = iedoc.getElementById(\"ui-id-1\").getElementsByTagName(\"li\")\nDo While li_arr.Length = 0: DoEvents: Loop     ' wait for the drop down menu to come up\nli_arr(0).Click                                ' now click the first option\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 10888586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/784e1e8197fd16df41d16358d070ee06?s=128&d=identicon&r=PG&f=1", "display_name": "noel.H", "link": "https://stackoverflow.com/users/10888586/noel-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 950, "favorite_count": 0, "accepted_answer_id": 54123481, "answer_count": 2, "score": 2, "last_activity_date": 1548399138, "creation_date": 1547026708, "last_edit_date": 1547104029, "question_id": 54107030, "link": "https://stackoverflow.com/questions/54107030/how-to-fill-in-html-autocomplete-fields-using-vba", "title": "How to fill in html autocomplete fields using vba?", "body": "<p>I am writing a macro that enter data into a online calculator and get the computed results</p>\n\n<p>Link: <a href=\"https://www.icao.int/environmental-protection/CarbonOffset/Pages/default.aspx\" rel=\"nofollow noreferrer\">https://www.icao.int/environmental-protection/CarbonOffset/Pages/default.aspx</a></p>\n\n<p>I am trying to fill the values of \"from city/airport\" in the website.</p>\n\n<p>Here is my Code:</p>\n\n<pre><code>Sub get_CO2()\n Dim ie As Object\n  Set ie = New InternetExplorerMedium\n  ie.Navigate \"https://applications.icao.int/icec\"\n  Do While ie.ReadyState &lt;&gt; 4: DoEvents: Loop\n  ie.Visible = True\n  With ie.Document\n      .getElementById(\"passengerNo\").Value = 7\n      .getElementById(\"select1\").selectedIndex = 1\n      .getElementById(\"select2\").selectedIndex = 1\n      ' .getElementByName(\"frm1\").Value = \"XXX\"\n      ' .getElementByName(\"to1\").Value = \"XXX\"\n      .getElementById(\"computeByInput\").Click\n   End With\nEnd Sub \n</code></pre>\n\n<p>It is doesnt work. It shows \"object do not support this property or method\"\nHow can i fill in this kind of types? What function can i use? If the airport code is not known, is there anyway to enter the name of the country and just pick to first option showing up?</p>\n"}, {"tags": ["excel", "vba", "excel-formula", "excel-2010", "excel-2007"], "comments": [{"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 5, "creation_date": 1547026891, "post_id": 54107011, "comment_id": 95046337, "body": "Have you looked on here? I am sure this type of question has been asked and answered... What have you attempted so far?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1547027370, "post_id": 54107011, "comment_id": 95046659, "body": "For how many X do you plan to do this? Because this will be calculateable by VBA until about 8 Xes and then it will exceed time and memory and becomes impossible because of too many permutations that need to be calculated. See <a href=\"https://www.extendoffice.com/documents/excel/3657-excel-generate-all-permutations.html\" rel=\"nofollow noreferrer\">How To Generate Or List All Possible Permutations In Excel?</a>"}, {"owner": {"reputation": 35, "user_id": 9101903, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_o7ePckiToc/AAAAAAAAAAI/AAAAAAAAABI/TawcQFukdXE/photo.jpg?sz=128", "display_name": "Ankit Sagar", "link": "https://stackoverflow.com/users/9101903/ankit-sagar"}, "reply_to_user": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1547027929, "post_id": 54107011, "comment_id": 95047011, "body": "Actually i don&#39;t have much knowledge of excel. @solar mike andreas"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1547028852, "post_id": 54107011, "comment_id": 95047512, "body": "@AnkitSagar Please, can you answer my question? Because if you plan 8 or more X this is impossible. If you plan less then 8 start with the link in my comment."}, {"owner": {"reputation": 35, "user_id": 9101903, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_o7ePckiToc/AAAAAAAAAAI/AAAAAAAAABI/TawcQFukdXE/photo.jpg?sz=128", "display_name": "Ankit Sagar", "link": "https://stackoverflow.com/users/9101903/ankit-sagar"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1547029706, "post_id": 54107011, "comment_id": 95048021, "body": "@P\u1d07\u029c it is more than 8, is there anything around?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1547030384, "post_id": 54107011, "comment_id": 95048456, "body": "Hm just realized that the order might not be important and therefore more than 8 would be possible but still this will exceed fast if it is much more than 8 How many X do you have?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1547032025, "post_id": 54107011, "comment_id": 95049598, "body": "Hm just realized that the order might not be important and therefore more than 8 would be possible but still this will exceed fast if it is much more than 8 How many X do you have? \u2022 Another question: 3X results in a <code>a+b+c</code> combination will 4X result in <code>a+b+c+d</code>? Or is the maximum 3 combinations?"}, {"owner": {"reputation": 35, "user_id": 9101903, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_o7ePckiToc/AAAAAAAAAAI/AAAAAAAAABI/TawcQFukdXE/photo.jpg?sz=128", "display_name": "Ankit Sagar", "link": "https://stackoverflow.com/users/9101903/ankit-sagar"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1547036429, "post_id": 54107011, "comment_id": 95052135, "body": "@P\u1d07\u029c  I have 20 X.  my combination depends upon number of X."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1547038677, "post_id": 54107011, "comment_id": 95053495, "body": "@AnkitSagar Are you sure that this is what you want? Because for 20 it will result in <code>1,048,555</code> combinations (no order important, no repetitions) that&#39;s a lot and will probably already exceed the limits. This is already one full column of results. Everything below <code>823543</code> is known that it can be calculated in VBA. You should re-think if you really need <code>1,048,555</code> combinations and if that is the correct approach. What is the purpose of all that?"}, {"owner": {"reputation": 35, "user_id": 9101903, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_o7ePckiToc/AAAAAAAAAAI/AAAAAAAAABI/TawcQFukdXE/photo.jpg?sz=128", "display_name": "Ankit Sagar", "link": "https://stackoverflow.com/users/9101903/ankit-sagar"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1547115868, "post_id": 54107011, "comment_id": 95084378, "body": "@P\u1d07\u029c sorry, actually i want to do it for 20 X, with each X having maximum of 3 combination."}], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 0, "last_activity_date": 1547117091, "creation_date": 1547117091, "answer_id": 54126950, "question_id": 54107011, "link": "https://stackoverflow.com/questions/54107011/find-all-possible-combination-in-excel/54126950#54126950", "title": "Find all possible combination in excel", "body": "<p>This example produces the output in the immediate window. Adjust it to your output needs.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub Combine()\n    Dim ws As Worksheet\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n\n    Dim LastRow As Long\n    LastRow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row\n\n    Dim iRow As Long, jRow As Long, kRow As Long\n    For iRow = 2 To LastRow\n        For jRow = iRow + 1 To LastRow\n\n            'output 2-combos\n            Debug.Print ws.Cells(iRow, \"A\").Value &amp; \"+\" &amp; ws.Cells(jRow, \"A\").Value, ws.Cells(iRow, \"B\").Value + ws.Cells(jRow, \"B\").Value\n\n            For kRow = jRow + 1 To LastRow\n                'output 3-combos\n                Debug.Print ws.Cells(iRow, \"A\").Value &amp; \"+\" &amp; ws.Cells(jRow, \"A\").Value &amp; \"+\" &amp; ws.Cells(kRow, \"A\").Value, ws.Cells(iRow, \"B\").Value + ws.Cells(jRow, \"B\").Value + ws.Cells(kRow, \"B\").Value\n            Next kRow\n        Next jRow\n    Next iRow\nEnd Sub\n</code></pre>\n\n<p>So this \u2026<br>\n<a href=\"https://i.stack.imgur.com/NgXCj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NgXCj.png\" alt=\"enter image description here\"></a></p>\n\n<p>will output \u2026</p>\n\n<pre><code>a+b            3 \na+b+c          6 \na+b+d          7 \na+c            4 \na+c+d          8 \na+d            5 \nb+c            5 \nb+c+d          9 \nb+d            6 \nc+d            7 \n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 9101903, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_o7ePckiToc/AAAAAAAAAAI/AAAAAAAAABI/TawcQFukdXE/photo.jpg?sz=128", "display_name": "Ankit Sagar", "link": "https://stackoverflow.com/users/9101903/ankit-sagar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 54126950, "answer_count": 1, "score": -1, "last_activity_date": 1547117091, "creation_date": 1547026663, "last_edit_date": 1547027005, "question_id": 54107011, "link": "https://stackoverflow.com/questions/54107011/find-all-possible-combination-in-excel", "title": "Find all possible combination in excel", "body": "<p>I have excel data like this</p>\n\n<pre><code>X    Y\n\na    1\nb    2 \nc    3\n</code></pre>\n\n<p>I want to do all possible combination in Column X, and generating sum from column Y</p>\n\n<pre><code>a+b    3\na+c    4\na+b+c  6\nb+c    5\n</code></pre>\n\n\n\n\n\n"}, {"tags": ["excel", "vba", "powershell"], "comments": [{"owner": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 0, "creation_date": 1547028174, "post_id": 54106878, "comment_id": 95047152, "body": "The error message clearly says that <code>$excel.ActiveWorkbook</code> is empty. Try <code>$workbook.Save()</code> instead."}, {"owner": {"reputation": 1, "user_id": 5437668, "user_type": "registered", "profile_image": "https://graph.facebook.com/900204476716599/picture?type=large", "display_name": "Klinik", "link": "https://stackoverflow.com/users/5437668/klinik"}, "reply_to_user": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 0, "creation_date": 1547028713, "post_id": 54106878, "comment_id": 95047455, "body": "Hello Ansgar, Thanks for reply. With code: <code>$workbook.Save() $workbook.Close()</code>   I receive: <code>Method invocation failed because [System.__ComObject] doesn&#39;t contain a method named &#39;Save&#39;. At W:\\GDA_files\\SME_iQA\\iQA_NEW\\PrepareMacro.ps1:10 char:1 + $workbook.Save() + ~~~~~~~~~~~~~~~~     + CategoryInfo          : InvalidOperation: (Save:String) [], RuntimeException     + FullyQualifiedErrorId : MethodNotFound</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 3809926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pDOOC.jpg?s=128&g=1", "display_name": "NiallJudeDev", "link": "https://stackoverflow.com/users/3809926/nialljudedev"}, "is_accepted": false, "score": 0, "last_activity_date": 1547030864, "creation_date": 1547030864, "answer_id": 54108370, "question_id": 54106878, "link": "https://stackoverflow.com/questions/54106878/running-vba-macro-in-excel-error-during-saving-file/54108370#54108370", "title": "Running VBA macro in Excel - Error During Saving File", "body": "<p>Have you tried the code below?</p>\n\n<pre><code>$excel.Application.ActiveWorkbook.Save()\n</code></pre>\n\n<p>I am not sure how to Excel object is operating but ActiveWorkbook is definitely null in it's current form. So the call looks to be incorrectly formed. I would recommend running this on a single test-spreadsheet from Command Line step by step and you should come across the root of your error pretty quickly.</p>\n"}, {"tags": [], "owner": {"reputation": 355, "user_id": 10374467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ovjw3.png?s=128&g=1", "display_name": "Thryn", "link": "https://stackoverflow.com/users/10374467/thryn"}, "is_accepted": false, "score": 0, "last_activity_date": 1547031377, "creation_date": 1547031377, "answer_id": 54108536, "question_id": 54106878, "link": "https://stackoverflow.com/questions/54106878/running-vba-macro-in-excel-error-during-saving-file/54108536#54108536", "title": "Running VBA macro in Excel - Error During Saving File", "body": "<p>It's failing because you're launching you code outside of Excel, which mean that there isn't any Active Workbook at the time.\nAlso, it's always good to mention that you're using an application method when launching code from outside Excel, so it knows what you're trying to do.</p>\n\n<p>I would go for something like</p>\n\n<pre><code>$excel.Application.Workbooks(1).Save()\n</code></pre>\n\n<p>But if you already have a workbook opened it will fail.\nThe best thing would be to determine the name of the workbook and then call said name like </p>\n\n<pre><code>$excel.Application.Workbooks(\"&lt;workbook name&gt;\").Save()\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5437668, "user_type": "registered", "profile_image": "https://graph.facebook.com/900204476716599/picture?type=large", "display_name": "Klinik", "link": "https://stackoverflow.com/users/5437668/klinik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 346, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1547031377, "creation_date": 1547026235, "last_edit_date": 1547028110, "question_id": 54106878, "link": "https://stackoverflow.com/questions/54106878/running-vba-macro-in-excel-error-during-saving-file", "title": "Running VBA macro in Excel - Error During Saving File", "body": "<p>I am trying to create PowerShell Script which allows me to open excel file, run macro, then save file and close it. My code is below:</p>\n\n<pre><code>$excel = New-Object -ComObject Excel.Application\n$MacroName1 = \"Extraction_Tool.xlsm\"\n$currentExecutingPath = $fullPathIncFileName.Replace($currentScriptName, \"\") + $MacroName\n$ExcelFiles = Get-ChildItem -Path $currentExecutingPath\n\n$Workbook = $excel.Workbooks.Open($currentExecutingPath)\n\n$excel.Application.DisplayAlerts = $False\n$excel.Run(\"refreshall\")\n$excel.ActiveWorkbook.Save()\n$workbook.Close()\n$excel.Quit()\n</code></pre>\n\n<p>When I am running this script I receive error:</p>\n\n<pre>\nYou cannot call a method on a null-valued expression.\nAt W:\\GDA_files\\SME_iQA\\iQA_NEW\\PrepareMacro.ps1:10 char:1\n+ $excel.ActiveWorkbook.Save()\n+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    + CategoryInfo          : InvalidOperation: (:) [], RuntimeException\n    + FullyQualifiedErrorId : InvokeMethodOnNull\n</pre>\n\n<p>VBA macro (<code>refreshall</code>) takes about one minute. Do you think that script cannot save file because it is trying to do this while macro is running?</p>\n"}, {"tags": ["vba", "string", "colors", "selection", "coreldraw"], "comments": [{"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1547025755, "post_id": 54106606, "comment_id": 95045727, "body": "Why not to use native search by color?"}, {"owner": {"reputation": 266, "user_id": 10860682, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1p8ShEHvmxM/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYrC6ksVVo648mB97KGqwtUjVNJrA/mo/photo.jpg?sz=128", "display_name": "RCL", "link": "https://stackoverflow.com/users/10860682/rcl"}, "edited": false, "score": 0, "creation_date": 1547026834, "post_id": 54106606, "comment_id": 95046306, "body": "Sorry not really an answer but I don&#39;t know much about coreldraw. Is the VBA for coreldraw that much different than VBA in excel? Like does the <code>Split</code> function not exist in corel draw? If it does you can easily get the 4 digits between the 2nd and 6th comma using the split function."}, {"owner": {"reputation": 229, "user_id": 3422687, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/1087712401/picture?type=large", "display_name": "user3422687", "link": "https://stackoverflow.com/users/3422687/user3422687"}, "edited": false, "score": 0, "creation_date": 1547035898, "post_id": 54106606, "comment_id": 95051803, "body": "thanks for the comments Coreldraw VBA doesn&#39;t have all the commands excel does but in my case all the examples I found use cell references. I will try some research on the spilt function but didn&#39;t think it allowed splitting between deliminator"}, {"owner": {"reputation": 229, "user_id": 3422687, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/1087712401/picture?type=large", "display_name": "user3422687", "link": "https://stackoverflow.com/users/3422687/user3422687"}, "edited": false, "score": 0, "creation_date": 1547037350, "post_id": 54106606, "comment_id": 95052686, "body": "excuse my ignorance but what is the native search by color?"}], "answers": [{"tags": [], "owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "is_accepted": true, "score": 0, "last_activity_date": 1547567101, "creation_date": 1547567101, "answer_id": 54202225, "question_id": 54106606, "link": "https://stackoverflow.com/questions/54106606/coreldraw-vba-select-all-colour-cmyk/54202225#54202225", "title": "Coreldraw VBA select all colour CMYK", "body": "<p><code>Split</code> is a native VBA function, as @RCL mentioned. Try the below example:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Test()\n\n    Dim s As Shape\n    Dim value As String\n    Dim os As ShapeRange\n    Dim tmp\n\n    Set os = ActiveSelectionRange\n    If os.Count &lt; 1 Then MsgBox (\"Nothing selected!\"): Exit Sub\n    For Each s In os\n        value = s.Fill.UniformColor.ToString\n        tmp = Split(value, \",\")\n        MsgBox tmp(2) &amp; vbCrLf &amp; tmp(3) &amp; vbCrLf &amp; tmp(4) &amp; vbCrLf &amp; tmp(5)\n    Next s\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 229, "user_id": 3422687, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/1087712401/picture?type=large", "display_name": "user3422687", "link": "https://stackoverflow.com/users/3422687/user3422687"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 385, "favorite_count": 1, "accepted_answer_id": 54202225, "answer_count": 1, "score": 1, "last_activity_date": 1547567101, "creation_date": 1547025236, "question_id": 54106606, "link": "https://stackoverflow.com/questions/54106606/coreldraw-vba-select-all-colour-cmyk", "title": "Coreldraw VBA select all colour CMYK", "body": "<p>Guys i'm trying to select all colours of a certain colour in the current selection</p>\n\n<p>I use the following to find out the all the colours in the selection</p>\n\n<pre><code>Dim s As Shape\nDim value As String, os As ShapeRange\nSet os = ActiveSelectionRange\nIf os.Count &lt; 1 Then MsgBox (\"Nothing selected!\"): Exit Sub\nFor Each s In os\nvalue = s.Fill.UniformColor.ToString\nMsgBox (value)\nNext s\n</code></pre>\n\n<p>Problem is the value of the string is as follows</p>\n\n<p>CMYK,USER,0,84,80,100,000000000-0000-0000-0000-00000000000</p>\n\n<p>I need to extract the 4 digits between the 2nd and 6th comma so I have the cmyk colour and then i can do a find shapes using that</p>\n\n<p>I have been looking for ideas on string manipulation in VB but they seem to be for excel and not coreldraw</p>\n\n<p>Any Ideas??</p>\n\n<p>Any help appreciated</p>\n\n<p>Mark</p>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1547137899, "post_id": 54106518, "comment_id": 95097480, "body": "You can link from PowerPoint to the contents of a cell in an Excel spreadsheet, but you can&#39;t link to text in PPT, unfortunately. One possible approach would be to base any slides that need changing on a separate layout or even slidemaster and put the changeable text on the layout/slidemaster. And you could do updates using VBA as well, of course."}, {"owner": {"reputation": 17, "user_id": 9753997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f9457945d0595032b893635c0d4c88e?s=128&d=identicon&r=PG&f=1", "display_name": "CHsu", "link": "https://stackoverflow.com/users/9753997/chsu"}, "reply_to_user": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1547818670, "post_id": 54106518, "comment_id": 95334150, "body": "Thank you Steve - it was as I suspected."}], "owner": {"reputation": 17, "user_id": 9753997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f9457945d0595032b893635c0d4c88e?s=128&d=identicon&r=PG&f=1", "display_name": "CHsu", "link": "https://stackoverflow.com/users/9753997/chsu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 327, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1547024917, "creation_date": 1547024917, "question_id": 54106518, "link": "https://stackoverflow.com/questions/54106518/poiwerpoint-auto-updating-text-boxes", "title": "PoiwerPoint auto-updating text boxes", "body": "<p>I want to know if there is a way to link text boxes in PowerPoint in a similar fashion as Excel so that when I update one text box (for instance, changing the title of the presentation), the other linked text boxes will update by themselves. The purpose is to avoid having to go through the whole presentation to change manually every relevant slides. I don't think there is a build in function but I am fairly new to VBA in PowerPoint (have some experience with Excel already). Any input is very much appreciated, thank you!</p>\n"}, {"tags": ["excel", "vba", "ms-word", "footer"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1547025324, "post_id": 54106374, "comment_id": 95045477, "body": "Could you not just have the file name in the footer in your template?"}], "answers": [{"tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": false, "score": 0, "last_activity_date": 1547026224, "last_edit_date": 1547026224, "creation_date": 1547025879, "answer_id": 54106772, "question_id": 54106374, "link": "https://stackoverflow.com/questions/54106374/excel-vba-generate-footer-in-wordfile/54106772#54106772", "title": "Excel VBA: Generate Footer in WordFile", "body": "<p>Simply put a FILENAME field in the template's footer. That way, you don't need code to do the same thing. Instead, all you need do (after saving the file) is use:</p>\n\n<pre><code>Application.ScreenUpdating = False\nWith ActiveDocument\n  .Fields.Update\n  .PrintPreview\n  .ClosePrintPreview\nEnd With\nApplication.ScreenUpdating = True\n</code></pre>\n\n<p>then re-save to make the field update 'stick'.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10888614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d26a68c0f78ccab5cc1f2f2028ea6c0?s=128&d=identicon&r=PG&f=1", "display_name": "IonDOne", "link": "https://stackoverflow.com/users/10888614/iondone"}, "is_accepted": false, "score": 0, "last_activity_date": 1547026713, "creation_date": 1547026713, "answer_id": 54107032, "question_id": 54106374, "link": "https://stackoverflow.com/questions/54106374/excel-vba-generate-footer-in-wordfile/54107032#54107032", "title": "Excel VBA: Generate Footer in WordFile", "body": "<p>Thanks to <strong>marcroprod</strong> the issue is resolved.\nFor everyone with similar problems, here's the complete code now:</p>\n\n<pre><code>Public Function Txtmkr_SDD()\n\n\n    Dim appWord             As Object 'Word-Instance\n    Dim wdDoc               As Object 'Word-Document\n    Dim wdRngE              As Object 'Word-Range 1\n    Dim wdRngR              As Object 'Word-Range 2\n    Dim wdRngC              As Object 'Word-Range 3\n    Dim wdRngCN             As Object 'Word-Range 4\n\n    Dim wks                 As Worksheet 'Excel-Worksheet\n    Dim AdresseCE           As String\n    Dim neueAdresseCE       As Long\n    Dim Processname1        As String\n    Dim Processname2        As String\n    Dim Version             As String\n\n    '*** Word start ***\n    Set appWord = CreateObject(\"Word.Application\")\n\n    '*** opens File ***\n   Set wdDoc = appWord.Documents.Add(Template:=Worksheets(\"StartPage\").Cells(48, 4) &amp; \"\\Document_Templates\\SDD_Template.dotx\", NewTemplate:=False, DocumentType:=0)\n\n    '*** Word visible ***\n    appWord.Visible = True\n\n    '*** just in case Document is protected ***\n    'doc.Unprotect\n\n    '*** Jump to Textmarker in Word ***\n    '*** Check of existence ***\n    '*** Take Value from \"CopyData\" Cell \"B1\" and insert Textmarker ***\n    If wdDoc.Bookmarks.Exists(\"Processname1\") Then\n        With wdDoc.Bookmarks(\"Processname1\")\n            Set wdRngE = .Range\n            wdRngE.Text = Worksheets(\"CopyData\").Cells(1, 2).Value\n            wdDoc.Bookmarks.Add \"Processname1\", wdRngE\n        End With\n    Else\n        MsgBox \"Missing Link [Processname1].\"\n    End If\n\n      '*** Take Value from \"CopyData\" Cell \"B2\" and insert Textmarker ***\n    If wdDoc.Bookmarks.Exists(\"Processname2\") Then\n        With wdDoc.Bookmarks(\"Processname2\")\n            Set wdRngE = .Range\n            wdRngE.Text = Worksheets(\"CopyData\").Cells(2, 2).Value\n            wdDoc.Bookmarks.Add \"Processname2\", wdRngE\n        End With\n    Else\n        MsgBox \"Missing Link [Processname2].\"\n    End If\n\n\n      If wdDoc.Bookmarks.Exists(\"Version\") Then\n        With wdDoc.Bookmarks(\"Version\")\n            Set wdRngE = .Range\n            wdRngE.Text = Worksheets(\"CopyData\").Cells(3, 2).Value\n            wdDoc.Bookmarks.Add \"Version\", wdRngE\n        End With\n    Else\n        MsgBox \"Missing Link [Version].\"\n    End If\n\n\n          If wdDoc.Bookmarks.Exists(\"Create_Date\") Then\n        With wdDoc.Bookmarks(\"Create_Date\")\n            Set wdRngE = .Range\n            wdRngE.Text = Worksheets(\"CopyData\").Cells(4, 2).Value\n            wdDoc.Bookmarks.Add \"Create_Date\", wdRngE\n        End With\n    Else\n        MsgBox \"Missing Link [Create_Date].\"\n    End If\n\n\n              If wdDoc.Bookmarks.Exists(\"Author\") Then\n        With wdDoc.Bookmarks(\"Author\")\n            Set wdRngE = .Range\n            wdRngE.Text = Worksheets(\"CopyData\").Cells(6, 2).Value\n            wdDoc.Bookmarks.Add \"Author\", wdRngE\n        End With\n    Else\n        MsgBox \"Missing Link [Author].\"\n    End If\n\n\n   '*** Set Time_Date and SDD Path ***\n    Dim time_date As String\n    time_date = Format(Date, \"yyyy_mm_dd\")\n    Dim SDD As String\n\n    '*** Define SDD as RegularPath ***\n    SDD = (time_date &amp; \"_\" &amp; Worksheets(\"CopyData\").Cells(1, 2).Value &amp; \"_\" &amp; Worksheets(\"CopyData\").Cells(21, 2).Value &amp; \"_\" &amp; Worksheets(\"Helper#3\").Cells(3, 2).Value &amp; \"_\" &amp; \"V\" &amp; Worksheets(\"CopyData\").Cells(3, 2).Value &amp; \".docx\")\n\n    '*** Dim wdApp As Word.Application ***\n    Set wdApp = GetObject(, \"Word.Application\")\n    '*** Set up SavePath &amp; Filename ***\n    appWord.ActiveDocument.SaveAs Worksheets(\"Variables\").Cells(3, 8).Value &amp; \"\\\" &amp; (Worksheets(\"Setup#2_DirectoryList\").Cells(1, 1)) &amp; \"\\\" &amp; Worksheets(\"Setup#2_DirectoryList\").Cells(3, 3).Value &amp; \"\\\" &amp; Worksheets(\"Setup#2_DirectoryList\").Cells(14, 21).Value &amp; \"\\\" &amp; SDD\n\n    '*** Updating the Footer of the Document ***\n    Application.ScreenUpdating = False\n    With appWord.ActiveDocument\n        .Fields.Update\n        .PrintPreview\n        .ClosePrintPreview\n    End With\n    Application.ScreenUpdating = True\n\n    appWord.ActiveDocument.Save\n\n\n    '*** Word quit ***\n    appWord.ActiveDocument.Close\n    appWord.Quit\n\n    '*** disable Variables ***\n    Set wdRngE = Nothing\n    Set wdRngR = Nothing\n    Set wdRngC = Nothing\n    Set wdRngCN = Nothing\n    Set wdRng = Nothing\n    Set wdDoc = Nothing\n    Set appWord = Nothing\n    Set sFolder = Nothing\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10888614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d26a68c0f78ccab5cc1f2f2028ea6c0?s=128&d=identicon&r=PG&f=1", "display_name": "IonDOne", "link": "https://stackoverflow.com/users/10888614/iondone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1547026713, "creation_date": 1547024390, "last_edit_date": 1547024673, "question_id": 54106374, "link": "https://stackoverflow.com/questions/54106374/excel-vba-generate-footer-in-wordfile", "title": "Excel VBA: Generate Footer in WordFile", "body": "<p>I built an Excel-File with VBA, where you can generate Directories and put the correct Documents (Word- and Excel-Files) right into the correct Directory. So when you execute the Code(in Excel), you first have to choose your Root-Destination and then all Directories are created. After that, it get's Worddocuments from a Templatefolder, fills the Textmarks with Data from Excel and saves the file. This is working great, also thanks to this community.</p>\n\n<p>But now the Problem: I don't get it to work, to fill in the new filename in the footer of the word-document.</p>\n\n<p>This is the code for the complete function for now:</p>\n\n<pre><code>    Public Function Txtmkr_SDD()\n\n\n    Dim appWord             As Object 'Word-Instance\n    Dim wdDoc               As Object 'Word-Document\n    Dim wdRngE              As Object 'Word-Range 1\n    Dim wdRngR              As Object 'Word-Range 2\n    Dim wdRngC              As Object 'Word-Range 3\n    Dim wdRngCN             As Object 'Word-Range 4\n\n    Dim wks                 As Worksheet 'Excel-Worksheet\n    Dim AdresseCE           As String\n    Dim neueAdresseCE       As Long\n    Dim Processname1        As String\n    Dim Processname2        As String\n    Dim Version             As String\n\n    '*** Word start ***\n    Set appWord = CreateObject(\"Word.Application\")\n\n    '*** opens File ***\n   Set wdDoc = appWord.Documents.Add(Template:=Worksheets(\"StartPage\").Cells(48, 4) &amp; \"\\Document_Templates\\SDD_Template.dotx\", NewTemplate:=False, DocumentType:=0)\n\n    '*** Word visible ***\n    appWord.Visible = True\n\n    '*** just in case Document is protected ***\n    'doc.Unprotect\n\n    '*** Jump to Textmarker in Word ***\n    '*** Check of existence ***\n    '*** Take Value from \"CopyData\" Cell \"B1\" and insert Textmarker ***\n    If wdDoc.Bookmarks.Exists(\"Processname1\") Then\n        With wdDoc.Bookmarks(\"Processname1\")\n            Set wdRngE = .Range\n            wdRngE.Text = Worksheets(\"CopyData\").Cells(1, 2).Value\n            wdDoc.Bookmarks.Add \"Processname1\", wdRngE\n        End With\n    Else\n        MsgBox \"Missing Link [Processname1].\"\n    End If\n\n      '*** Take Value from \"CopyData\" Cell \"B2\" and insert Textmarker ***\n    If wdDoc.Bookmarks.Exists(\"Processname2\") Then\n        With wdDoc.Bookmarks(\"Processname2\")\n            Set wdRngE = .Range\n            wdRngE.Text = Worksheets(\"CopyData\").Cells(2, 2).Value\n            wdDoc.Bookmarks.Add \"Processname2\", wdRngE\n        End With\n    Else\n        MsgBox \"Missing Link [Processname2].\"\n    End If\n\n\n      If wdDoc.Bookmarks.Exists(\"Version\") Then\n        With wdDoc.Bookmarks(\"Version\")\n            Set wdRngE = .Range\n            wdRngE.Text = Worksheets(\"CopyData\").Cells(3, 2).Value\n            wdDoc.Bookmarks.Add \"Version\", wdRngE\n        End With\n    Else\n        MsgBox \"Missing Link [Version].\"\n    End If\n\n\n          If wdDoc.Bookmarks.Exists(\"Create_Date\") Then\n        With wdDoc.Bookmarks(\"Create_Date\")\n            Set wdRngE = .Range\n            wdRngE.Text = Worksheets(\"CopyData\").Cells(4, 2).Value\n            wdDoc.Bookmarks.Add \"Create_Date\", wdRngE\n        End With\n    Else\n        MsgBox \"Missing Link [Create_Date].\"\n    End If\n\n\n              If wdDoc.Bookmarks.Exists(\"Author\") Then\n        With wdDoc.Bookmarks(\"Author\")\n            Set wdRngE = .Range\n            wdRngE.Text = Worksheets(\"CopyData\").Cells(6, 2).Value\n            wdDoc.Bookmarks.Add \"Author\", wdRngE\n        End With\n    Else\n        MsgBox \"Missing Link [Author].\"\n    End If\n\n\n   '*** Set Time_Date and SDD Path ***\n    Dim time_date As String\n    time_date = Format(Date, \"yyyy_mm_dd\")\n    Dim SDD As String\n\n    '*** Define SDD as RegularPath ***\n    SDD = (time_date &amp; \"_\" &amp; Worksheets(\"CopyData\").Cells(1, 2).Value &amp; \"_\" &amp; Worksheets(\"CopyData\").Cells(21, 2).Value &amp; \"_\" &amp; Worksheets(\"Helper#3\").Cells(3, 2).Value &amp; \"_\" &amp; \"V\" &amp; Worksheets(\"CopyData\").Cells(3, 2).Value &amp; \".docx\")\n\n    '*** Dim wdApp As Word.Application ***\n    Set wdApp = GetObject(, \"Word.Application\")\n    '*** Set up SavePath &amp; Filename ***\n    appWord.ActiveDocument.SaveAs Worksheets(\"Variables\").Cells(3, 8).Value &amp; \"\\\" &amp; (Worksheets(\"Setup#2_DirectoryList\").Cells(1, 1)) &amp; \"\\\" &amp; Worksheets(\"Setup#2_DirectoryList\").Cells(3, 3).Value &amp; \"\\\" &amp; Worksheets(\"Setup#2_DirectoryList\").Cells(14, 21).Value &amp; \"\\\" &amp; SDD\n\n    '*** Word quit ***\n    appWord.ActiveDocument.Close\n    appWord.Quit\n\n    '*** disable Variables ***\n    Set wdRngE = Nothing\n    Set wdRngR = Nothing\n    Set wdRngC = Nothing\n    Set wdRngCN = Nothing\n    Set wdRng = Nothing\n    Set wdDoc = Nothing\n    Set appWord = Nothing\n    Set sFolder = Nothing\n\nEnd Function\n</code></pre>\n\n<p>Would be great if anyone could help me :-)</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1547024099, "post_id": 54106224, "comment_id": 95044802, "body": "<code>I need to change this to paste the values into ROW 2 ie, A2,B2,C2</code> So what problem are you facing?"}], "answers": [{"comments": [{"owner": {"reputation": 153, "user_id": 3310517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93d92fd6d4424455202e758e0c4942a2?s=128&d=identicon&r=PG&f=1", "display_name": "sakkthi", "link": "https://stackoverflow.com/users/3310517/sakkthi"}, "edited": false, "score": 0, "creation_date": 1547027181, "post_id": 54106427, "comment_id": 95046531, "body": "Thousands of Thanks. Great."}, {"owner": {"reputation": 153, "user_id": 3310517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93d92fd6d4424455202e758e0c4942a2?s=128&d=identicon&r=PG&f=1", "display_name": "sakkthi", "link": "https://stackoverflow.com/users/3310517/sakkthi"}, "edited": false, "score": 0, "creation_date": 1547033073, "post_id": 54106427, "comment_id": 95050141, "body": "How can I change that code to copy and paste only if the value changed is greater than Zero."}, {"owner": {"reputation": 46, "user_id": 10886850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9389aac3e43fe61da05262244c498703?s=128&d=identicon&r=PG&f=1", "display_name": "MikeyD", "link": "https://stackoverflow.com/users/10886850/mikeyd"}, "reply_to_user": {"reputation": 153, "user_id": 3310517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93d92fd6d4424455202e758e0c4942a2?s=128&d=identicon&r=PG&f=1", "display_name": "sakkthi", "link": "https://stackoverflow.com/users/3310517/sakkthi"}, "edited": false, "score": 1, "creation_date": 1547033389, "post_id": 54106427, "comment_id": 95050320, "body": "You will want to add in Target.Value &gt; 0 to either the original IF statement or create a new one"}, {"owner": {"reputation": 153, "user_id": 3310517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93d92fd6d4424455202e758e0c4942a2?s=128&d=identicon&r=PG&f=1", "display_name": "sakkthi", "link": "https://stackoverflow.com/users/3310517/sakkthi"}, "edited": false, "score": 0, "creation_date": 1547043048, "post_id": 54106427, "comment_id": 95056116, "body": "Thanks mickeyD.  Sorry to bother you further.  How can I loop this code for a range of cell values in same Column B,  ie B2 to B200.  Once again Thanks. I am new to this Vba coding."}, {"owner": {"reputation": 46, "user_id": 10886850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9389aac3e43fe61da05262244c498703?s=128&d=identicon&r=PG&f=1", "display_name": "MikeyD", "link": "https://stackoverflow.com/users/10886850/mikeyd"}, "reply_to_user": {"reputation": 153, "user_id": 3310517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93d92fd6d4424455202e758e0c4942a2?s=128&d=identicon&r=PG&f=1", "display_name": "sakkthi", "link": "https://stackoverflow.com/users/3310517/sakkthi"}, "edited": false, "score": 0, "creation_date": 1547047381, "post_id": 54106427, "comment_id": 95059040, "body": "You&#39;d want to take a different approach for this. As your spreadsheet will likely open/close several times, you&#39;d need to store your last value on a separate sheet [or you can do a text file] - I&#39;ll add another answer with some code for you"}], "tags": [], "owner": {"reputation": 46, "user_id": 10886850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9389aac3e43fe61da05262244c498703?s=128&d=identicon&r=PG&f=1", "display_name": "MikeyD", "link": "https://stackoverflow.com/users/10886850/mikeyd"}, "is_accepted": false, "score": 2, "last_activity_date": 1547024577, "creation_date": 1547024577, "answer_id": 54106427, "question_id": 54106224, "link": "https://stackoverflow.com/questions/54106224/how-to-fix-this-code-to-copy-values-into-columns/54106427#54106427", "title": "How to fix this code to copy values into columns?", "body": "<p>Is this what you're after?</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nDim v_target_row As Integer\n\nIf Target.Address = \"$B$2\" Then\n\n    v_target_row = 2\n\n    If Sheets(\"Sheet2\").Cells(v_target_row, 1) = \"\" Then\n        a = 0\n    Else\n        a = Sheets(\"Sheet2\").Cells(v_target_row, Sheets(\"Sheet2\").Columns.Count).End(xlToLeft).Column\n    End If\n    Sheets(\"Sheet2\").Cells(v_target_row, a + 1) = Sheets(\"Sheet1\").Range(\"B2\").Value\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 46, "user_id": 10886850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9389aac3e43fe61da05262244c498703?s=128&d=identicon&r=PG&f=1", "display_name": "MikeyD", "link": "https://stackoverflow.com/users/10886850/mikeyd"}, "is_accepted": true, "score": 1, "last_activity_date": 1547047485, "creation_date": 1547047485, "answer_id": 54113345, "question_id": 54106224, "link": "https://stackoverflow.com/questions/54106224/how-to-fix-this-code-to-copy-values-into-columns/54113345#54113345", "title": "How to fix this code to copy values into columns?", "body": "<p>Adding this answer for the request in the comments.</p>\n\n<p>You'll first want to create a sheet - can be a hidden sheet - this code will do it for you, but feel free to manually do it.</p>\n\n<pre><code>Sub Create_Hidden_Control_sheet()\n\n    Dim ws As Worksheet\n    With ThisWorkbook\n        Set ws = .Sheets.Add(After:=.Sheets(.Sheets.Count))\n    End With\n\n    ws.Name = \"Control\"\n\n    ws.Visible = xlSheetVeryHidden\n\n    ws.Range(\"A1\") = \"Last cell used\"\n    ws.Range(\"B1\") = 0\n\nEnd Sub\n</code></pre>\n\n<p>You'll use the cell B1 on this sheet to store the last column used.</p>\n\n<p>You'll want to change your worksheet_change to do something along the lines of this</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nDim a As Integer\n\nIf Target.Address = \"$B$2\" And Target.Value &gt; 0 Then\n\n    a = Sheets(\"Control\").Range(\"B1\") + 1\n\n    If a &gt; 10 Then\n        a = 1\n    End If\n\n    Sheets(\"Sheet2\").Cells(2, a) = Sheets(\"Sheet1\").Range(\"B2\").Value\n\n    Sheets(\"Control\").Range(\"B1\") = a\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 153, "user_id": 3310517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93d92fd6d4424455202e758e0c4942a2?s=128&d=identicon&r=PG&f=1", "display_name": "sakkthi", "link": "https://stackoverflow.com/users/3310517/sakkthi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 54113345, "answer_count": 2, "score": 0, "last_activity_date": 1547047485, "creation_date": 1547023828, "last_edit_date": 1547023957, "question_id": 54106224, "link": "https://stackoverflow.com/questions/54106224/how-to-fix-this-code-to-copy-values-into-columns", "title": "How to fix this code to copy values into columns?", "body": "<p>Whenever the value in cell B2 of sheet1 changes, value is copied and pasted into sheet2 column A in the next blank cell.\nI need to change this to paste the values into ROW 2 ie, A2,B2,C2.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Target.Address = \"$B$2\" Then\na = Sheets(\"Sheet2\").Cells(Rows.Count, \"A\").End(xlUp).Row + 1\nSheets(\"Sheet2\").Range(\"A\" &amp; a).Value = \nSheets(\"Sheet1\").Range(\"B2\").Value\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1547022557, "post_id": 54105402, "comment_id": 95044006, "body": "The best place to start is usually the design of the output sheet. Once you have the available data in one sheet and the picture of how they will look after processing in another you can decide on the steps to take, for example filtering. So you design the output sheet for that part of the project, until you have a step small enough to be able to tackle with the macro recorder."}], "owner": {"reputation": 23, "user_id": 7649217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d38fb9b497d269a68616e51955cf7a0f?s=128&d=identicon&r=PG&f=1", "display_name": "Duustin", "link": "https://stackoverflow.com/users/7649217/duustin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1547024695, "creation_date": 1547020271, "last_edit_date": 1547024695, "question_id": 54105402, "link": "https://stackoverflow.com/questions/54105402/reformatting-restructuring-filtering-data-in-existing-excel-file-and-appending-e", "title": "Reformatting/restructuring/filtering data in existing Excel file and appending/editing to a designated format of another existing excel file", "body": "<p>I have a Excel report that I want it to be reformatted, restructured, and filtered into a specific Excel format.\nThe original Excel report shows repetition of 2 columns per 11 rows like the example below:</p>\n\n<pre><code>row1 : var1   |var2|var3   |(Empty)|var5|var6|var7|var8   |var9|(Empty)|var11|\nrow2 : (Empty)|var2|(Empty)|var4   |var5|var6|var7|(Empty)|var9|var10  |var11|\n</code></pre>\n\n<p>I have a designated list of <code>row1:var1</code> variables and first I need to filter the other data out. </p>\n\n<p>Next I need to filter out the data that I need, which is <code>row1:var1</code>, <code>row2:var2</code>, <code>row1:var7</code>, <code>row2:var10</code>, <code>row1:var11</code>. Then I need to use these data and create them into a row and compare and fix the existing excel file with the designated format according to <code>row1:var1</code> variable. </p>\n\n<p>For example, if \"john\" is a common person in both of the excel files(as in <code>row1:var1</code>) but if \"john\" in my Excel file have different properties(as in all the cell data I need except for <code>row1:var1</code>), I would like to update those properties with the properties of the reporting Excel file.</p>\n\n<p>I have no clue where to start and I would greatly appreciate it if someone can help me out, even a little guidance. </p>\n\n<p>Thank you ahead of the response.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "edited": false, "score": 0, "creation_date": 1547025872, "post_id": 54105053, "comment_id": 95045780, "body": "On Column I do you have any cell with the text &quot;&lt;1st Shift&quot; or is it supposed to be &quot;1st Shift&quot;? Please could you provide a screenshot of how the data is displayed?"}, {"owner": {"reputation": 5, "user_id": 10888297, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-2jbYP1_Pfik/AAAAAAAAAAI/AAAAAAAACvs/AzVbMayikOg/photo.jpg?sz=128", "display_name": "Mohammed Sufiyan", "link": "https://stackoverflow.com/users/10888297/mohammed-sufiyan"}, "reply_to_user": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "edited": false, "score": 0, "creation_date": 1547032670, "post_id": 54105053, "comment_id": 95049939, "body": "Thank you Xabier for looking into this.  Yes the column has the text &quot;&lt;1st Shift&quot;. I&#39;m afraid as I&#39;m unable to attach the screenshot here."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 10888297, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-2jbYP1_Pfik/AAAAAAAAAAI/AAAAAAAACvs/AzVbMayikOg/photo.jpg?sz=128", "display_name": "Mohammed Sufiyan", "link": "https://stackoverflow.com/users/10888297/mohammed-sufiyan"}, "edited": false, "score": 0, "creation_date": 1547040551, "post_id": 54109717, "comment_id": 95054671, "body": "Thank you for helping me out with this but when I run this code it says compile error : Variable not defined This is highlighted when error Set Rng"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 5, "user_id": 10888297, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-2jbYP1_Pfik/AAAAAAAAAAI/AAAAAAAACvs/AzVbMayikOg/photo.jpg?sz=128", "display_name": "Mohammed Sufiyan", "link": "https://stackoverflow.com/users/10888297/mohammed-sufiyan"}, "edited": false, "score": 0, "creation_date": 1547040842, "post_id": 54109717, "comment_id": 95054840, "body": "@MohammedSufiyan I&#39;ve now updated my answer to include the declaration for all variables, it should now work for you as intended. :)"}, {"owner": {"reputation": 5, "user_id": 10888297, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-2jbYP1_Pfik/AAAAAAAAAAI/AAAAAAAACvs/AzVbMayikOg/photo.jpg?sz=128", "display_name": "Mohammed Sufiyan", "link": "https://stackoverflow.com/users/10888297/mohammed-sufiyan"}, "edited": false, "score": 0, "creation_date": 1547042367, "post_id": 54109717, "comment_id": 95055717, "body": "Thank you so much Xabier. This code seems to be not working for this criteria &quot;&lt;1st Shift&quot; but when I try all other conditions it works such as &quot;13 weeks - 18 weeks&quot;..... Do you think this lesser than sign &quot;&lt;&quot; would be an issue."}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 5, "user_id": 10888297, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-2jbYP1_Pfik/AAAAAAAAAAI/AAAAAAAACvs/AzVbMayikOg/photo.jpg?sz=128", "display_name": "Mohammed Sufiyan", "link": "https://stackoverflow.com/users/10888297/mohammed-sufiyan"}, "edited": false, "score": 0, "creation_date": 1547042678, "post_id": 54109717, "comment_id": 95055886, "body": "@MohammedSufiyan I&#39;ve tested this and I did not get a problem filtering for that specific Criteria, the &quot;&lt;&quot; doesn&#39;t cause me any issues,... I&#39;m unsure as to what to advise as I&#39;m not encountering any issues with it."}, {"owner": {"reputation": 5, "user_id": 10888297, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-2jbYP1_Pfik/AAAAAAAAAAI/AAAAAAAACvs/AzVbMayikOg/photo.jpg?sz=128", "display_name": "Mohammed Sufiyan", "link": "https://stackoverflow.com/users/10888297/mohammed-sufiyan"}, "edited": false, "score": 0, "creation_date": 1547055081, "post_id": 54109717, "comment_id": 95063737, "body": "I think i need one more help. Can you tell me how to add another criteria to this code pls"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 5, "user_id": 10888297, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-2jbYP1_Pfik/AAAAAAAAAAI/AAAAAAAACvs/AzVbMayikOg/photo.jpg?sz=128", "display_name": "Mohammed Sufiyan", "link": "https://stackoverflow.com/users/10888297/mohammed-sufiyan"}, "edited": false, "score": 0, "creation_date": 1547124465, "post_id": 54109717, "comment_id": 95089196, "body": "@MohammedSufiyan I&#39;ve now updated my answer to illustrate how to go about filtering with multiple criteria, hope this helps. :)"}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": true, "score": 0, "last_activity_date": 1547124437, "last_edit_date": 1547124437, "creation_date": 1547035371, "answer_id": 54109717, "question_id": 54105053, "link": "https://stackoverflow.com/questions/54105053/vba-autofilter-from-one-sheet-to-another/54109717#54109717", "title": "VBA Autofilter from one sheet to another", "body": "<p>I've tested the following and it works for me, I've altered the code you are using to make sure that it only copies rows if they match the criteria.</p>\n\n<p>Another thing to keep in mind is to steer away from using .Activate and .Select as these will only slow down your code, please have a look at the amended code below:</p>\n\n<pre><code>Sub copypaste()\nDim ws1 As Worksheet: Set ws1 = Worksheets(\"Sheet1\")\nDim ws2 As Worksheet: Set ws2 = Worksheets(\"Sheet2\")\nDim Rng As Range, LastRow As Long\n'declare and set the worksheets you are working with, amend as required\nws1.Cells.AutoFilter Field:=8, Criteria1:=\"&lt;1st Shift\"\n'filter Sheet1 Column H with criteria\nSet Rng = ws1.Range(\"B2\", Range(\"B2\").End(xlDown).End(xlToRight)).SpecialCells(xlCellTypeVisible)\n'set the range to be copied, only looking at the visible rows\nLastRow = ws1.Range(\"B1\").End(xlDown).Row\n'check the last row with data on Column B\nIf LastRow &lt;&gt; ws1.Rows.Count Then\n'check if there are any rows that match the criteria\n    Rng.Copy\n    'copy the range\n    ws2.Range(\"B7\").PasteSpecial xlPasteAll\n    'paste into Sheet2 cell B7\nElse\n    MsgBox \"Criteria not found\", vbInformation, \"Error\"\nEnd If\nws1.Cells.AutoFilter\n'remove the AutoFilter\nEnd Sub\n</code></pre>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>In the case where you have multiple criteria you can use the following code:</p>\n\n<pre><code>Sub copypaste()\nDim ws1 As Worksheet: Set ws1 = Worksheets(\"Sheet1\")\nDim ws2 As Worksheet: Set ws2 = Worksheets(\"Sheet2\")\nDim Rng As Range, LastRow As Long\n'declare and set the worksheets you are working with, amend as required\nws1.Cells.AutoFilter Field:=8, Criteria1:=\"5\", Operator:=xlOr, Criteria2:=\"&lt;1st Shift\"\n'filter Sheet1 Column H with criteria\nSet Rng = ws1.Range(\"B2\", Range(\"B2\").End(xlDown).End(xlToRight)).SpecialCells(xlCellTypeVisible)\n'set the range to be copied, only looking at the visible rows\nLastRow = ws1.Range(\"B1\").End(xlDown).Row\n'check the last row with data on Column B\nIf LastRow &lt;&gt; ws1.Rows.Count Then\n'check if there are any rows that match the criteria\n    Rng.Copy\n    'copy the range\n    ws2.Range(\"B7\").PasteSpecial xlPasteAll\n    'paste into Sheet2 cell B7\nElse\n    MsgBox \"Criteria not found\", vbInformation, \"Error\"\nEnd If\nws1.Cells.AutoFilter\n'remove the AutoFilter\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 10888297, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-2jbYP1_Pfik/AAAAAAAAAAI/AAAAAAAACvs/AzVbMayikOg/photo.jpg?sz=128", "display_name": "Mohammed Sufiyan", "link": "https://stackoverflow.com/users/10888297/mohammed-sufiyan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 54109717, "answer_count": 1, "score": 0, "last_activity_date": 1547124437, "creation_date": 1547018720, "last_edit_date": 1547026526, "question_id": 54105053, "link": "https://stackoverflow.com/questions/54105053/vba-autofilter-from-one-sheet-to-another", "title": "VBA Autofilter from one sheet to another", "body": "<p>I am very new to the VBA. I am looking at getting few data from sheet1 with filtered data to move to sheet2. The criteria works for other filter data other than this one \u201c&lt;1st shift\u201d\nPlease could you assist. \nI am using this code.</p>\n\n<pre><code>Sub copypaste() \n    Sheets(\"Sheet1\").Activate\n    Range(\"B2\", Range(\"B2\").End(xlDown).End(xlToRight)).Select\n    Selection.AutoFilter Field:=8, Criteria1:=\"&lt;1st Shift\u201d\n    Selection.Copy\n\n    Worksheets(\"Sheet2\").Activate\n    Range(\"B7\").PasteSpecial\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 1, "creation_date": 1547026392, "post_id": 54104533, "comment_id": 95046060, "body": "If your worksheet data are suitably structured, your can extract it via ADODB - without even having Excel installed. See: <a href=\"https://gregmaxey.com/word_tip_pages/import_excel_list_into_word_dropdownlist.html\" rel=\"nofollow noreferrer\">gregmaxey.com/word_tip_pages/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 615, "user_id": 6236294, "user_type": "registered", "accept_rate": 96, "profile_image": "https://graph.facebook.com/10204431270580592/picture?type=large", "display_name": "Ibn e Ashiq", "link": "https://stackoverflow.com/users/6236294/ibn-e-ashiq"}, "edited": false, "score": 0, "creation_date": 1547021459, "post_id": 54104788, "comment_id": 95043523, "body": "what is the meaning of run time <code>Error 13 type mismatch</code>? at <code>Set SECTOR = eXwb.Worksheets(&quot;Sheet4&quot;).Cells.Find(What:=TICKER).Offset(0, 2)</code> I manually checked and found Ticker is exist in workbook."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 615, "user_id": 6236294, "user_type": "registered", "accept_rate": 96, "profile_image": "https://graph.facebook.com/10204431270580592/picture?type=large", "display_name": "Ibn e Ashiq", "link": "https://stackoverflow.com/users/6236294/ibn-e-ashiq"}, "edited": false, "score": 0, "creation_date": 1547023036, "post_id": 54104788, "comment_id": 95044250, "body": "Did you define <code>SECTOR</code> as range? <code>Dim SECTOR As Range</code>"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 615, "user_id": 6236294, "user_type": "registered", "accept_rate": 96, "profile_image": "https://graph.facebook.com/10204431270580592/picture?type=large", "display_name": "Ibn e Ashiq", "link": "https://stackoverflow.com/users/6236294/ibn-e-ashiq"}, "edited": false, "score": 0, "creation_date": 1547023654, "post_id": 54104788, "comment_id": 95044560, "body": "Sorry there is a small change. I have updated the post. you may have to refresh it to see it"}, {"owner": {"reputation": 615, "user_id": 6236294, "user_type": "registered", "accept_rate": 96, "profile_image": "https://graph.facebook.com/10204431270580592/picture?type=large", "display_name": "Ibn e Ashiq", "link": "https://stackoverflow.com/users/6236294/ibn-e-ashiq"}, "edited": false, "score": 0, "creation_date": 1547023889, "post_id": 54104788, "comment_id": 95044681, "body": "what if <code>TICKER</code> actually don&#39;t exist in workbook? Does it tackle that too?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 615, "user_id": 6236294, "user_type": "registered", "accept_rate": 96, "profile_image": "https://graph.facebook.com/10204431270580592/picture?type=large", "display_name": "Ibn e Ashiq", "link": "https://stackoverflow.com/users/6236294/ibn-e-ashiq"}, "edited": false, "score": 0, "creation_date": 1547024024, "post_id": 54104788, "comment_id": 95044767, "body": "Yes.. <code>If Not SECTOR Is Nothing Then</code> checka if <code>.Find</code> returned something. You can add an <code>else</code> to that <code>If</code> if you want to do something for example let the user know that ticker was not found. I have updated the post to reflect that"}, {"owner": {"reputation": 615, "user_id": 6236294, "user_type": "registered", "accept_rate": 96, "profile_image": "https://graph.facebook.com/10204431270580592/picture?type=large", "display_name": "Ibn e Ashiq", "link": "https://stackoverflow.com/users/6236294/ibn-e-ashiq"}, "edited": false, "score": 0, "creation_date": 1547026049, "post_id": 54104788, "comment_id": 95045870, "body": "I just want to know why my macro is working without adding <code>Dim SECTOR As Range</code> line to the main code? with that I am getting <code>Compiler error Method or data not found</code> at <code>.Offset</code>."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 615, "user_id": 6236294, "user_type": "registered", "accept_rate": 96, "profile_image": "https://graph.facebook.com/10204431270580592/picture?type=large", "display_name": "Ibn e Ashiq", "link": "https://stackoverflow.com/users/6236294/ibn-e-ashiq"}, "edited": false, "score": 0, "creation_date": 1547026634, "post_id": 54104788, "comment_id": 95046197, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/186402/discussion-between-siddharth-rout-and-ibn-e-ashiq\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 1, "last_activity_date": 1547027702, "last_edit_date": 1547027702, "creation_date": 1547017523, "answer_id": 54104788, "question_id": 54104533, "link": "https://stackoverflow.com/questions/54104533/extracting-value-from-excel-without-activating-workbook/54104788#54104788", "title": "Extracting value from excel without activating workbook", "body": "<p>Just remove the line <code>eXwb.Activate</code>. Also remove <code>.Activate</code> from <code>eXwb.Worksheets(\"Sheet4\").Cells.Find(What:=TICKER).Offset(0, 2).Activate</code> Directly work with the range</p>\n\n<p>Your code can be written as</p>\n\n<pre><code>Set MyXL = GetObject(, \"Excel.Application\")\n\nIf MyXL.ActiveWorkbook.Name = \"LIST.xlsm\" Then\n    Set eXwb = GetObject(\"C:\\Users\\dell\\Desktop\\WEBD\\LIST.xlsm\")\nElse\n    Set eXwb = MyXL.Workbooks(\"LIST.xlsm\")\nEnd If\n\nDim SECTOR As Object '~~&gt; Code is run from MS Word\n\nSet SECTOR = eXwb.Worksheets(\"Sheet4\").Cells.Find(What:=TICKER)\n\n'~~&gt; Check if .Find returned something\nIf Not SECTOR Is Nothing Then\n    Set SECTOR = SECTOR.Offset(, 2)\n    MsgBox SECTOR.Value\nElse\n    MsgBox \"Ticker \" &amp; TICKER &amp; \" was not found\"\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 615, "user_id": 6236294, "user_type": "registered", "accept_rate": 96, "profile_image": "https://graph.facebook.com/10204431270580592/picture?type=large", "display_name": "Ibn e Ashiq", "link": "https://stackoverflow.com/users/6236294/ibn-e-ashiq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 0, "accepted_answer_id": 54104788, "answer_count": 1, "score": 1, "last_activity_date": 1582953851, "creation_date": 1547016332, "last_edit_date": 1582953851, "question_id": 54104533, "link": "https://stackoverflow.com/questions/54104533/extracting-value-from-excel-without-activating-workbook", "title": "Extracting value from excel without activating workbook", "body": "<p>I am working from <code>MS Word</code> and need to extract data from <code>Excel Workbook</code> using following code: </p>\n\n<p>It will <code>Find</code> TICKER in Workbook and if its found then it will set SECTOR variable using value from Workbook.</p>\n\n<pre><code>Set MyXL = GetObject(, \"Excel.Application\")\n\nIf MyXL.ActiveWorkbook.NAME = \"LIST.xlsm\" Then\nSet eXwb = GetObject(\"C:\\Users\\dell\\Desktop\\WEBD\\LIST.xlsm\")\nElse\nSet eXwb = MyXL.Workbooks(\"LIST.xlsm\")\neXwb.Activate\nEnd If\n\neXwb.Worksheets(\"Sheet4\").Cells.Find(What:=TICKER).Offset(0, 2).Activate ' Is there any oneline code to find and set SECTOR variable without activating workbook\nSet SECTOR = eXwb.Application.ActiveCell\n</code></pre>\n\n<p>Is there any possibility that I can extract data without activating eXwb workbook. \nIs there any one-line code to find and set SECTOR variable without activating workbook.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10887775, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-cmJEdyzUNxU/AAAAAAAAAAI/AAAAAAAAa_c/Enqhk7KkAi8/photo.jpg?sz=128", "display_name": "Norwegian Redhead", "link": "https://stackoverflow.com/users/10887775/norwegian-redhead"}, "edited": false, "score": 0, "creation_date": 1547066101, "post_id": 54105431, "comment_id": 95068422, "body": "Is there a way to do an index-match style paste, rather than the if &quot;Employee 1&quot; then. else &quot;Employee 2&quot; then..  else&quot;Employee 3&quot; then..."}, {"owner": {"reputation": 91, "user_id": 10546161, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4zdwlINpFD4/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAE_fkKxkVu18gFasOrUHarMMNZvQ/mo/photo.jpg?sz=128", "display_name": "Irregular Expression", "link": "https://stackoverflow.com/users/10546161/irregular-expression"}, "reply_to_user": {"reputation": 13, "user_id": 10887775, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-cmJEdyzUNxU/AAAAAAAAAAI/AAAAAAAAa_c/Enqhk7KkAi8/photo.jpg?sz=128", "display_name": "Norwegian Redhead", "link": "https://stackoverflow.com/users/10887775/norwegian-redhead"}, "edited": false, "score": 0, "creation_date": 1547108212, "post_id": 54105431, "comment_id": 95080170, "body": "Of course. Use For-Next loop with any conditions and indexes you want. E.g. For i = 1 To lastRow: Next i. And your condition inside a loop will be like: If Cells(i, 1).Value Then. It will iterate all rows in a table by first column. LastRow should be a result of Cells(ActiveSheet.Rows.Count, &quot;A&quot;).End(xlUp).Row expression or any other digit value for last iterated row."}], "tags": [], "owner": {"reputation": 91, "user_id": 10546161, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4zdwlINpFD4/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAE_fkKxkVu18gFasOrUHarMMNZvQ/mo/photo.jpg?sz=128", "display_name": "Irregular Expression", "link": "https://stackoverflow.com/users/10546161/irregular-expression"}, "is_accepted": false, "score": 0, "last_activity_date": 1547020407, "creation_date": 1547020407, "answer_id": 54105431, "question_id": 54103620, "link": "https://stackoverflow.com/questions/54103620/copy-row-to-a-position-dependent-on-criteria/54105431#54105431", "title": "Copy Row to a position dependent on criteria", "body": "<p>Maybe you could show your code and ask a concrete question about it? Because there's no problem in VBA to copy-paste any Range of Cells (or it's values, or it's formats etc.) with any logical conditions you need. MSDN has a clear example: <a href=\"https://docs.microsoft.com/ru-ru/office/vba/api/excel.range.copy\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/ru-ru/office/vba/api/excel.range.copy</a></p>\n"}], "owner": {"reputation": 13, "user_id": 10887775, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-cmJEdyzUNxU/AAAAAAAAAAI/AAAAAAAAa_c/Enqhk7KkAi8/photo.jpg?sz=128", "display_name": "Norwegian Redhead", "link": "https://stackoverflow.com/users/10887775/norwegian-redhead"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1547020407, "creation_date": 1547010977, "last_edit_date": 1547017513, "question_id": 54103620, "link": "https://stackoverflow.com/questions/54103620/copy-row-to-a-position-dependent-on-criteria", "title": "Copy Row to a position dependent on criteria", "body": "<p>I've searched all over but have yet to find someone who has been able to asnwer this. </p>\n\n<p>I'm in the process of trying to create a macro to streamline requesting days off, so to help modernize the payroll sheet while still allowing it to be compatible with the legacy system.</p>\n\n<p>I want to have this sheet be the input:\n<a href=\"https://i.stack.imgur.com/Yz15Y.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Yz15Y.png\" alt=\"enter image description here\"></a></p>\n\n<p>And then the macro (activated from a button click) </p>\n\n<p>would copy that data, find the associated employee, then paste to fit with the legacy system as shown below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/hleMJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hleMJ.png\" alt=\"enter image description here\"></a></p>\n\n<p>So the macro would match the respective employee of each entry, and paste the respective entry to the next entry in the log of the employee. Any idea of how to go about this?</p>\n\n<p>I am completely lost and not sure where to start.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1547008084, "post_id": 54103226, "comment_id": 95039032, "body": "I don&#39;t know enough VBA to give a formal answer, but the regex pattern you want to use here is <code>C\\d{6}$</code>.  This would match the names having the ID at the end (and if it fails, then you just pull over the entire original name)."}, {"owner": {"reputation": 237, "user_id": 10655442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4098121435f6fb51e6e714ca92ec6ab3?s=128&d=identicon&r=PG&f=1", "display_name": "DSM", "link": "https://stackoverflow.com/users/10655442/dsm"}, "reply_to_user": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1547009126, "post_id": 54103226, "comment_id": 95039275, "body": "Thank you for the hint @Tim Biegeleisen. I will try to do something with it!"}], "answers": [{"comments": [{"owner": {"reputation": 237, "user_id": 10655442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4098121435f6fb51e6e714ca92ec6ab3?s=128&d=identicon&r=PG&f=1", "display_name": "DSM", "link": "https://stackoverflow.com/users/10655442/dsm"}, "edited": false, "score": 0, "creation_date": 1547009746, "post_id": 54103394, "comment_id": 95039409, "body": "I don&#39;t think this answer works for me. For example, what if I had someones name which starts with the &quot;C&quot; and has 6 characters after it. This would flag it as &quot;Y&quot;."}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "reply_to_user": {"reputation": 237, "user_id": 10655442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4098121435f6fb51e6e714ca92ec6ab3?s=128&d=identicon&r=PG&f=1", "display_name": "DSM", "link": "https://stackoverflow.com/users/10655442/dsm"}, "edited": false, "score": 0, "creation_date": 1547009873, "post_id": 54103394, "comment_id": 95039443, "body": "@DSM: Sure, will come up with something soon."}, {"owner": {"reputation": 237, "user_id": 10655442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4098121435f6fb51e6e714ca92ec6ab3?s=128&d=identicon&r=PG&f=1", "display_name": "DSM", "link": "https://stackoverflow.com/users/10655442/dsm"}, "edited": false, "score": 0, "creation_date": 1547013366, "post_id": 54103394, "comment_id": 95040376, "body": "I am getting an error message, &quot;Type mismatched&quot; on this line <code>If Not IsNumeric(CInt(Mid(strCompare, j, 1))) Then Exit For</code>. Is this method checking each and every digit after &quot;C&quot;, so its looping 6 times every row for each digit? Would this be slow if I were to do this with data size of 40,000 rows?"}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "reply_to_user": {"reputation": 237, "user_id": 10655442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4098121435f6fb51e6e714ca92ec6ab3?s=128&d=identicon&r=PG&f=1", "display_name": "DSM", "link": "https://stackoverflow.com/users/10655442/dsm"}, "edited": false, "score": 0, "creation_date": 1547015241, "post_id": 54103394, "comment_id": 95040915, "body": "@It wouldn&#39;t be slow, it was half a second for 65000 rows, but I&#39;ve reduced it now to just check if all the 6 chars are numeric."}, {"owner": {"reputation": 237, "user_id": 10655442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4098121435f6fb51e6e714ca92ec6ab3?s=128&d=identicon&r=PG&f=1", "display_name": "DSM", "link": "https://stackoverflow.com/users/10655442/dsm"}, "edited": false, "score": 0, "creation_date": 1547015670, "post_id": 54103394, "comment_id": 95041044, "body": "works just fine now! Thank you. Could I know why you thought of looping through the 6 digits to check it 1 by 1? Is there any special reason behind it?"}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "reply_to_user": {"reputation": 237, "user_id": 10655442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4098121435f6fb51e6e714ca92ec6ab3?s=128&d=identicon&r=PG&f=1", "display_name": "DSM", "link": "https://stackoverflow.com/users/10655442/dsm"}, "edited": false, "score": 0, "creation_date": 1547015792, "post_id": 54103394, "comment_id": 95041083, "body": "@I&#39;ve recently seen some code where it was needed. I guess I&#39;m tired."}], "tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": true, "score": 1, "last_activity_date": 1547014878, "last_edit_date": 1547014878, "creation_date": 1547009229, "answer_id": 54103394, "question_id": 54103226, "link": "https://stackoverflow.com/questions/54103226/identifying-a-string-pattern-in-excel-vba/54103394#54103394", "title": "Identifying a string pattern in Excel VBA", "body": "<h1>Without RegExp</h1>\n\n<p>Checks if the first of the last seven chars is capital \"C\". If so, checks if the last 6 chars are numeric. Only then returns \"Y\".</p>\n\n<h2>The Code</h2>\n\n<pre><code>Sub LeftRightArray()\n\n    Const cSheet1 As Variant = \"Sheet1\"  ' Sheet Name/Index\n    Const cFirst As Integer = 2          ' Source First Row\n    Const cSourceC As Variant = \"A\"      ' Source Column\n    Const cTargetC As Variant = \"B\"      ' Target Column\n    Const cSearch As String = \"C\"        ' Search String\n\n    Dim lastR As Long     ' Source Last Row Number\n    Dim i As Long         ' Array Row Counter\n    Dim j As Integer\n    Dim vnt As Variant    ' Array\n    Dim strCompare        ' Compare String\n\n    ' Paste Source Range into Array\n    With Worksheets(cSheet1)\n        lastR = .Cells(.Rows.Count, cSourceC).End(xlUp).Row\n        vnt = .Range(.Cells(cFirst, cSourceC), .Cells(lastR, cSourceC))\n    End With\n\n    ' Change data in Array.\n    For i = 1 To UBound(vnt)\n        ' Check if C is the first char of last 7 chars.\n        If Left(Right(vnt(i, 1), 7), 1) = cSearch Then\n            ' Check if last 6 chars are numeric.\n            If IsNumeric(Right(vnt(i, 1), 6)) Then\n                vnt(i, 1) = \"Y\"\n              Else\n                vnt(i, 1) = \"N\"\n            End If\n          Else ' C is not the first letter of last 7 chars.\n            vnt(i, 1) = \"N\"\n        End If\n    Next\n\n    ' Paste Array into Target Range\n    With Worksheets(cSheet1).Cells(cFirst, cTargetC)\n        .Resize(UBound(vnt), UBound(vnt, 2)) = vnt\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 237, "user_id": 10655442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4098121435f6fb51e6e714ca92ec6ab3?s=128&d=identicon&r=PG&f=1", "display_name": "DSM", "link": "https://stackoverflow.com/users/10655442/dsm"}, "edited": false, "score": 0, "creation_date": 1547016456, "post_id": 54104374, "comment_id": 95041320, "body": "Oh, nice way to make use of the asterisk in the string."}, {"owner": {"reputation": 662, "user_id": 4688787, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Q3XlM.jpg?s=128&g=1", "display_name": "BOB", "link": "https://stackoverflow.com/users/4688787/bob"}, "reply_to_user": {"reputation": 237, "user_id": 10655442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4098121435f6fb51e6e714ca92ec6ab3?s=128&d=identicon&r=PG&f=1", "display_name": "DSM", "link": "https://stackoverflow.com/users/10655442/dsm"}, "edited": false, "score": 0, "creation_date": 1547017305, "post_id": 54104374, "comment_id": 95041668, "body": "I updated the answer for the case when you don&#39;t have a 6 number of digits after &quot;C&quot; char"}], "tags": [], "owner": {"reputation": 662, "user_id": 4688787, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Q3XlM.jpg?s=128&g=1", "display_name": "BOB", "link": "https://stackoverflow.com/users/4688787/bob"}, "is_accepted": false, "score": 1, "last_activity_date": 1547017456, "last_edit_date": 1547017456, "creation_date": 1547015469, "answer_id": 54104374, "question_id": 54103226, "link": "https://stackoverflow.com/questions/54103226/identifying-a-string-pattern-in-excel-vba/54104374#54104374", "title": "Identifying a string pattern in Excel VBA", "body": "<p>Use the following formula in column <code>C</code>:\n<code>=IFERROR(IF(AND(MID(A2,FIND(\"*\",A2)+1,1)=\"C\",LEN(A2)-(FIND(\"*\",A2)+1)=6),\"Y\",\"N\"),\"N\")</code></p>\n\n<p><strong>Alternative:</strong>\nPut this formula in column <code>B</code><br>\n<code>=IFERROR(IF(AND(MID(A2,FIND(\"*\",A2)+1,1)=\"C\",LEN(A2)-(FIND(\"*\",A2)+1)=6),MID(A2,FIND(\"*\",A2)+1,7),\"\"),\"\")</code></p>\n\n<p>and this formula in column<code>C</code><br>\n<code>=IF(LEN(B2)&lt;&gt;0,\"Y\",\"N\")</code></p>\n"}, {"comments": [{"owner": {"reputation": 237, "user_id": 10655442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4098121435f6fb51e6e714ca92ec6ab3?s=128&d=identicon&r=PG&f=1", "display_name": "DSM", "link": "https://stackoverflow.com/users/10655442/dsm"}, "edited": false, "score": 0, "creation_date": 1547016196, "post_id": 54104430, "comment_id": 95041224, "body": "Thanks for your answer. However, this only considers numerical values in the cells. So, for example, Janice*GH092123 would be flagged &quot;Y&quot; as well."}, {"owner": {"reputation": 66, "user_id": 6113778, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uAzrM.jpg?s=128&g=1", "display_name": "Ameen Ali Shaikh", "link": "https://stackoverflow.com/users/6113778/ameen-ali-shaikh"}, "reply_to_user": {"reputation": 237, "user_id": 10655442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4098121435f6fb51e6e714ca92ec6ab3?s=128&d=identicon&r=PG&f=1", "display_name": "DSM", "link": "https://stackoverflow.com/users/10655442/dsm"}, "edited": false, "score": 0, "creation_date": 1547017809, "post_id": 54104430, "comment_id": 95041881, "body": "Apologies. I have edited the answer. Had not seen the requirement of only matching the capital C"}], "tags": [], "owner": {"reputation": 66, "user_id": 6113778, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uAzrM.jpg?s=128&g=1", "display_name": "Ameen Ali Shaikh", "link": "https://stackoverflow.com/users/6113778/ameen-ali-shaikh"}, "is_accepted": false, "score": 1, "last_activity_date": 1547017767, "last_edit_date": 1547017767, "creation_date": 1547015836, "answer_id": 54104430, "question_id": 54103226, "link": "https://stackoverflow.com/questions/54103226/identifying-a-string-pattern-in-excel-vba/54104430#54104430", "title": "Identifying a string pattern in Excel VBA", "body": "<p>You can directly use the below excel formula as well. This formula can be used in VBA code after little modification.</p>\n\n<p><code>=IF(COUNT(FIND({0,1,2,3,4,5,6,7,8,9},A2))=0,\"N\",IF(EXACT(LEFT(B2,1),\"C\"),\"Y\",\"N\"))</code></p>\n\n<p>Note: A2 is the cell which contains your data, example: Joe*C5464647. Please refer snapshot.</p>\n\n<p><a href=\"https://i.stack.imgur.com/5T64a.jpg\" rel=\"nofollow noreferrer\">Excel Snapshot with data</a></p>\n"}], "owner": {"reputation": 237, "user_id": 10655442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4098121435f6fb51e6e714ca92ec6ab3?s=128&d=identicon&r=PG&f=1", "display_name": "DSM", "link": "https://stackoverflow.com/users/10655442/dsm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 705, "favorite_count": 0, "accepted_answer_id": 54103394, "answer_count": 3, "score": 0, "last_activity_date": 1547017767, "creation_date": 1547007964, "last_edit_date": 1547017539, "question_id": 54103226, "link": "https://stackoverflow.com/questions/54103226/identifying-a-string-pattern-in-excel-vba", "title": "Identifying a string pattern in Excel VBA", "body": "<p>I am trying to identify a column which has a special sort of string in it. For simplicity of the question here is a small sample size of the column I am working with. </p>\n\n<p><a href=\"https://i.stack.imgur.com/jsj2L.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jsj2L.png\" alt=\"pic1\"></a></p>\n\n<p>The column contains names of people, but we see some records have a special key id in the last 7 to 8 digits of the cell. The one I am interested in are the ones that start with an uppercase \"C\" followed by 6 numeric digits. </p>\n\n<p>I am trying to get results similar to this.</p>\n\n<p><a href=\"https://i.stack.imgur.com/AfgTM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AfgTM.png\" alt=\"pic2\"></a></p>\n\n<p>Column B (Cab ID) just takes the 7 digits from the right, which is easily done by excel functions in vba. I am trying to get column C (Flag), where I identify whether they are the records that I am interested in, which are the ones which start with an uppercase \"C\" and are followed by 6 numeric digits. If they are, I mark them down as \"Y\" else \"N\". </p>\n\n<p>If any extra details needs to be added, let me know and I will make a quick edit as soon as possible to the question.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1547006377, "post_id": 54102659, "comment_id": 95038715, "body": "When you type in the row below a table Excel will automatically expand the table to include that row, passing all the formats and even formulas into the new row. So, what does your button do that Excel doesn&#39;t do automatically?"}, {"owner": {"reputation": 1085, "user_id": 8505034, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/1588466231176126/picture?type=large", "display_name": "Rae Ian", "link": "https://stackoverflow.com/users/8505034/rae-ian"}, "reply_to_user": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1547011572, "post_id": 54102659, "comment_id": 95039877, "body": "Sorry just a newbie in excel and VBA.  Is that possible to append new row by just typing to the table ?"}, {"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1547019045, "post_id": 54102659, "comment_id": 95042420, "body": "What happens if the selection is outside your table?"}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 1, "creation_date": 1547020999, "post_id": 54102659, "comment_id": 95043308, "body": "yes, if you type in the row immediately below a table but within the columns covered by the table, the row will be added to the table automatically. If you copy data from elsewhere and paste into the row below the table, all the pasted rows will be added."}, {"owner": {"reputation": 1085, "user_id": 8505034, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/1588466231176126/picture?type=large", "display_name": "Rae Ian", "link": "https://stackoverflow.com/users/8505034/rae-ian"}, "edited": false, "score": 0, "creation_date": 1547021027, "post_id": 54102659, "comment_id": 95043318, "body": "As of now nothing. But I&#39;m planning to lock the other cells outside the table so that only the table can be modified. If it is possible. Still working on it"}, {"owner": {"reputation": 1085, "user_id": 8505034, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/1588466231176126/picture?type=large", "display_name": "Rae Ian", "link": "https://stackoverflow.com/users/8505034/rae-ian"}, "edited": false, "score": 0, "creation_date": 1547021117, "post_id": 54102659, "comment_id": 95043363, "body": "Is there any settings that I need to set? because my table isn&#39;t like that"}, {"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1547024381, "post_id": 54102659, "comment_id": 95044961, "body": "Could you rezize the table by the number of rows from <code>InputBox</code>?  Also, why the 50 row limit?"}, {"owner": {"reputation": 1085, "user_id": 8505034, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/1588466231176126/picture?type=large", "display_name": "Rae Ian", "link": "https://stackoverflow.com/users/8505034/rae-ian"}, "edited": false, "score": 0, "creation_date": 1547025066, "post_id": 54102659, "comment_id": 95045355, "body": "Just a validation for 50"}], "answers": [{"comments": [{"owner": {"reputation": 1085, "user_id": 8505034, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/1588466231176126/picture?type=large", "display_name": "Rae Ian", "link": "https://stackoverflow.com/users/8505034/rae-ian"}, "edited": false, "score": 0, "creation_date": 1547080407, "post_id": 54110440, "comment_id": 95073123, "body": "Woaah! This one saved me!"}], "tags": [], "owner": {"reputation": 266, "user_id": 10860682, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1p8ShEHvmxM/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYrC6ksVVo648mB97KGqwtUjVNJrA/mo/photo.jpg?sz=128", "display_name": "RCL", "link": "https://stackoverflow.com/users/10860682/rcl"}, "is_accepted": true, "score": 1, "last_activity_date": 1547037764, "creation_date": 1547037764, "answer_id": 54110440, "question_id": 54102659, "link": "https://stackoverflow.com/questions/54102659/excel-insert-multiple-rows-based-on-specific-values-to-the-last-row/54110440#54110440", "title": "Excel: Insert multiple rows based on specific values to the last row", "body": "<p>The code below assumes you only have 1 table in your worksheet. This will add new rows at the bottom of the table. But like it was mentioned in the comment section that the table should expand automatically by default.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim myTable As Object\nSet myTable = ActiveSheet.ListObjects(1)\nDim numLines As Integer\nnumLines = InputBox(\"How many lines..?\")\n\nFor i = 1 To numLines\n myTable.ListRows.Add alwaysinsert:=True\n\nNext i\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1085, "user_id": 8505034, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/1588466231176126/picture?type=large", "display_name": "Rae Ian", "link": "https://stackoverflow.com/users/8505034/rae-ian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 237, "favorite_count": 0, "accepted_answer_id": 54110440, "answer_count": 1, "score": 0, "last_activity_date": 1547037764, "creation_date": 1547002570, "last_edit_date": 1547025205, "question_id": 54102659, "link": "https://stackoverflow.com/questions/54102659/excel-insert-multiple-rows-based-on-specific-values-to-the-last-row", "title": "Excel: Insert multiple rows based on specific values to the last row", "body": "<p>This question may already answered by the other posts.\nHere's my problem</p>\n\n<p>Sheet1 : The picture illustrates the data table that I made. It consists 3 fields with 3 rows and 1 blank row.</p>\n\n<p><a href=\"https://i.stack.imgur.com/CvTVC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CvTVC.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/cICdJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cICdJ.png\" alt=\"enter image description here\"></a></p>\n\n<p>The button insert contains the code below</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim Answer As Integer\nDim NumLines As Integer\nDim count As Integer\n\nAnswer = InputBox(\"How many lines to insert? (50 lines maximum)\")\nNumLines = Int(Val(Answer))\nIf NumLines &gt; 50 Then\n   NumLines = 50\nEnd If\n'End sub exectuion if no lines to insert\nIf NumLines = 0 Then\n    GoTo EndInsertLines\nEnd If\n'Insert specified number of lines at the cursor\nDo\n    Selection.EntireRow.Insert\n    count = count + 1\nLoop While count &lt; NumLines\nEndInsertLines:\n\nEnd Sub\n</code></pre>\n\n<p>The above code will perform the insert rows based on the inputted values when the inputbox prompts to the user.</p>\n\n<p>What I'm aiming to do is,</p>\n\n<p>When I try to put my preferred value it will automatically add up to the last row of data.</p>\n\n<p>For example:\nThe number of rows that I want to add is 3.\nIt will automatically adds up 3 rows below of the last data registered on the table. As illustrated in the picture the last data is <em>Data3 located at column X</em> it should add up below of that data.</p>\n"}, {"tags": ["excel", "vba", "split"], "comments": [{"owner": {"reputation": 853, "user_id": 4421692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1ac72ff7addc80329a7641a65c4e919?s=128&d=identicon&r=PG&f=1", "display_name": "Samer Ayoub", "link": "https://stackoverflow.com/users/4421692/samer-ayoub"}, "edited": false, "score": 1, "creation_date": 1547000510, "post_id": 54102355, "comment_id": 95037692, "body": "split twice: first split on &quot;today&quot; to get a string of 2 elements, take the second and split it on &quot; &quot;"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1547010449, "post_id": 54102355, "comment_id": 95039580, "body": "Try <code>TextToColumns</code>. That is much faster. Posted a sample code"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1547017725, "post_id": 54102355, "comment_id": 95041845, "body": "Note that the code you posted uses these fancy quote marks<code>\u201c \u201d</code> in <code>\u201ctoday\u201d</code> but VBA only allows the simple ones <code>&quot; &quot;</code> you must replace them."}, {"owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "edited": false, "score": 0, "creation_date": 1547036179, "post_id": 54102355, "comment_id": 95051977, "body": "There are a lot of answers, and you seem to be too It seems lazy."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10862412"}, "is_accepted": false, "score": 0, "last_activity_date": 1547001571, "last_edit_date": 1547001571, "creation_date": 1547000996, "answer_id": 54102504, "question_id": 54102355, "link": "https://stackoverflow.com/questions/54102355/splitting-string-twice/54102504#54102504", "title": "Splitting string twice", "body": "<p>Split on \" today \" then split the second (1 in a zero-based 1-D array) on the space and ensure you are retrieving doubles and not text that only look like doubles.</p>\n\n<pre><code>Chicago today 1.01 1.33 1.90\nDallas today 1.76\nSan Antonio today 3.43 4.67 8.99 2.34 9.65 10.13\n\nfor i=1 to lastrow\n    arr1 = split(rasnge(\"A\" &amp; i), \" today \")\n    arr2 = split(arr1(1), \" \")\n    for j = lbound(arr2) to ubound(arr2)\n        debug.print cdbl(arr2(j))\n    next j\nnext i\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 0, "last_activity_date": 1547001474, "creation_date": 1547001474, "answer_id": 54102551, "question_id": 54102355, "link": "https://stackoverflow.com/questions/54102355/splitting-string-twice/54102551#54102551", "title": "Splitting string twice", "body": "<p><em>How about the following</em> </p>\n\n<p><em>Example</em></p>\n\n<pre><code>Option Explicit\nSub SplitName()\n    Dim City As String\n        City = ActiveCell.Value\n\n    Dim Rate() As String\n        Rate() = Split(City)\n\n    Dim i As Long\n    For i = LBound(Rate) To UBound(Rate)\n      Debug.Print Rate(i) ' Print to Immediate window\n      Cells(1, i + 1).Value = Rate(i)\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 0, "last_activity_date": 1547004800, "last_edit_date": 1547004800, "creation_date": 1547001493, "answer_id": 54102555, "question_id": 54102355, "link": "https://stackoverflow.com/questions/54102355/splitting-string-twice/54102555#54102555", "title": "Splitting string twice", "body": "<h1>Double Split</h1>\n\n<p>Splits cell values in a one-column range twice and copies the result to the calculated number of columns.</p>\n\n<h2>A Fast Version</h2>\n\n<pre><code>Sub SplitName()\n\n    ' Source\n    Const cSheet1 As Variant = \"Sheet1\"   ' Source Sheet Name/Index\n    Const cCol As Variant = \"A\"           ' Source Column Letter/Number\n    Const cFirst As Integer = 1           ' Source First Row\n    Const cSplit1 As String = \"today\"     ' First Split String\n    Const cSplit2 As String = \" \"         ' Second Split String\n    ' Target\n    Const cSheet2 As Variant = \"Sheet1\"   ' Target Sheet Name/Index\n    Const cFirstCell As String = \"B1\"     ' Target Range First Cell\n\n    Dim vntS As Variant   ' Source Array\n    Dim vnt1 As Variant   ' First Split Array\n    Dim vnt2 As Variant   ' Second Split Array\n    Dim vntT As Variant   ' Target Array\n    Dim lastR As Long     ' Source Last Row\n    Dim i As Long         ' Arrays Row Counter\n    Dim j As Integer      ' Target Array Column Counter\n\n    ' Paste Source Range into Source Array.\n    With Worksheets(cSheet1)\n        lastR = .Cells(.Rows.Count, cCol).End(xlUp).Row\n        vntS = .Range(.Cells(cFirst, cCol), .Cells(lastR, cCol))\n    End With\n\n    ' Calculate number of columns in Target Array.\n    For i = 1 To UBound(vntS)\n        vnt1 = Split(vntS(i, 1), cSplit1)\n        vnt2 = Split(Trim(vnt1(1)), cSplit2)\n        If j &lt; UBound(vnt2) Then\n            j = UBound(vnt2)\n        End If\n    Next\n    ' Increase the number by one because the first column will be the first\n    ' string from First Split Array, and by another one because the\n    ' Split Arrays are 0-based.\n    j = j + 2\n\n    ' Write Source Array to Target Array.\n    ReDim vntT(1 To UBound(vntS), 1 To j)\n    For i = 1 To UBound(vntS)\n        vnt1 = Split(vntS(i, 1), cSplit1)\n        vnt2 = Split(Trim(vnt1(1)), cSplit2)\n        vntT(i, 1) = Trim(vnt1(0))\n        For j = 0 To UBound(vnt2)\n            vntT(i, j + 2) = vnt2(j)\n        Next\n    Next\n\n    ' Paste Target Array into Target Range calculated from Target First Cell.\n    With Worksheets(cSheet2).Range(cFirstCell)\n        .Resize(UBound(vntT), UBound(vntT, 2)) = vntT\n    End With\n\nEnd Sub\n</code></pre>\n\n<h2>Just an Update of Given Code</h2>\n\n<pre><code>Sub SplitName()\n\n    Dim Cpty  As String\n    Dim i As Integer\n    Dim Rate As Variant\n    Dim Rate2 As Variant\n\n    Cpty = ActiveCell.Value\n\n    Rate = Split(Cpty, \"today\")\n    Rate2 = Split(Trim(Rate(1))) ' ***\n\n    ' Write City\n    Cells(1, 2).Value = Trim(Rate(0))\n\n    ' Write Numbers\n    For i = 0 To UBound(Rate2)\n        Cells(1, i + 3).Value = Rate2(i)\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p>*** The second split delimiter has been omitted, since the default is \" \".</p>\n"}, {"comments": [{"owner": {"reputation": 19, "user_id": 10887248, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216198017636472/picture?type=large", "display_name": "Juliana", "link": "https://stackoverflow.com/users/10887248/juliana"}, "edited": false, "score": 0, "creation_date": 1547049318, "post_id": 54103534, "comment_id": 95060313, "body": "Hey, thanks for answering. Just one question: What if I have n rates? I believe your code will work for 6 rates (3.43, 4.67, 8.99, 2.34, 9.65, 10.13), but if I had n, then I&#39;d have to create a loop to reach the nth value?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 19, "user_id": 10887248, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216198017636472/picture?type=large", "display_name": "Juliana", "link": "https://stackoverflow.com/users/10887248/juliana"}, "edited": false, "score": 0, "creation_date": 1547053273, "post_id": 54103534, "comment_id": 95062764, "body": "Technically yes but strangely, Replacing <code>Array(Array(1, 1), Array(2, 1), Array(3, 1), Array(4, 1), Array(5, _         1), Array(6, 1), Array(7, 1))</code>  with <code>Array(Array(1, 1))</code> also work :) Give it a try and let me know if it works for you? Else I will give you a slightly modified code."}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 1, "last_activity_date": 1547010916, "last_edit_date": 1547010916, "creation_date": 1547010377, "answer_id": 54103534, "question_id": 54102355, "link": "https://stackoverflow.com/questions/54102355/splitting-string-twice/54103534#54103534", "title": "Splitting string twice", "body": "<p>Can I play too? :)</p>\n\n<p>I feel this could be the fastest way?</p>\n\n<p><strong>Logic</strong>:</p>\n\n<ol>\n<li>In Column 1, Replace \" today \" with \"|\"</li>\n<li>Text To Columns on Col 1 with \"|\" as delimiter</li>\n<li>In Column 2, Replace \" \" with  \"|\"</li>\n<li>Text To Columns on Col 2 with \"|\" as delimiter</li>\n</ol>\n\n<p><strong>Code</strong>:</p>\n\n<pre><code>Sub Sample()\n    Dim ws As Worksheet\n\n    Set ws = Sheet1\n\n    With ws\n        .Columns(1).Replace What:=\" today \", Replacement:=\"|\", LookAt:=xlPart, _\n        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False\n\n        .Columns(1).TextToColumns Destination:=.Range(\"A1\"), DataType:=xlDelimited, _\n        TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _\n        Semicolon:=False, Comma:=False, Space:=False, Other:=True, OtherChar _\n        :=\"|\", FieldInfo:=Array(Array(1, 1), Array(2, 1)), TrailingMinusNumbers:=True\n\n        .Columns(2).Replace What:=\" \", Replacement:=\"|\", LookAt:=xlPart, _\n        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\n        ReplaceFormat:=False\n\n        .Columns(2).TextToColumns Destination:=.Range(\"B1\"), DataType:=xlDelimited, _\n        TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _\n        Semicolon:=False, Comma:=False, Space:=False, Other:=True, OtherChar _\n        :=\"|\", FieldInfo:=Array(Array(1, 1), Array(2, 1), Array(3, 1), Array(4, 1), Array(5, _\n        1), Array(6, 1), Array(7, 1)), TrailingMinusNumbers:=True\n    End With\nEnd Sub\n</code></pre>\n\n<p><strong>Screenshot</strong>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/s9rbE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/s9rbE.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1547023973, "creation_date": 1547023973, "answer_id": 54106256, "question_id": 54102355, "link": "https://stackoverflow.com/questions/54102355/splitting-string-twice/54106256#54106256", "title": "Splitting string twice", "body": "<p>Still time to play?</p>\n\n<p><strong>1st step:</strong> locate today in the string</p>\n\n<p><strong>2nd step:</strong> replace all ulterior space with special (unused) delimiter</p>\n\n<p><strong>3rd step:</strong> split on that special delimiter</p>\n\n<pre><code>Function SplitCities(ByVal sRow As String) As String()\n    Dim today_place As Long\n    'Step 1: Look for \"today\"\n    today_place = InStr(sRow, \"today\")\n    'Step 2: Replace the space after today by \"|\".\n    'Since Replace truncate the start of the string, I concatenate it using Left.\n    'Here I have removed \"today\" from the result, but you can use change the values to keep it (use -1 and 0 as offsets)\n    sRow = Left$(sRow, today_place - 2) &amp; Replace(sRow, \" \", \"|\", today_place + 5), \"|\"\n    'Step 3: Split the result\n    SplitCities = Split(sRow, \"|\")\nEnd Function\n</code></pre>\n\n<p>Use SplitCities instead of Split in your code.</p>\n"}], "owner": {"reputation": 19, "user_id": 10887248, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216198017636472/picture?type=large", "display_name": "Juliana", "link": "https://stackoverflow.com/users/10887248/juliana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 234, "favorite_count": 0, "answer_count": 5, "score": 1, "last_activity_date": 1547023973, "creation_date": 1546999667, "last_edit_date": 1547017631, "question_id": 54102355, "link": "https://stackoverflow.com/questions/54102355/splitting-string-twice", "title": "Splitting string twice", "body": "<p>I am trying to chop 400+ rows of strings which include both letters and numbers into various columns. The original strings looks something like this: </p>\n\n<pre><code>Chicago today 1.01 1.33 1.90\nDallas today 1.76\nSan Antonio today 3.43 4.67 8.99 2.34 9.65 10.13\n</code></pre>\n\n<p>Ideally, my final code would yield the names of the cities in column A and each subsequent float in a different column, like so:</p>\n\n<pre><code> A            B    C   D    E    F    G\nChicago     1.01 1.33 1.90\nDallas      1.76\nSan Antonio 3.43 4.67 8.99 2.34 9.65 10.13\n</code></pre>\n\n<p>I have used the word \"today\" as the delimiter because it is not at all important to the final product and I was able to split the names of the cities from the numbers, but all numbers now exist in column B instead of being spread across columns.I have tried using two delimiters: \"today\" and \" \" but then the two-word city names get split too.</p>\n\n<pre><code>Sub SplitName ( )\n\nDim Cpty  As String\nDim i As Integer\nDim Rate As Variant\n\nCpty = ActiveCell.Value\n\nRate = Split (City, \u201ctoday\u201d)\n\nFor i = 0 To UBound(Rate)\n    Cels(1, i+1).Value = Rate (i)\n\n\nNext i\n\n\nEnd Sub\n</code></pre>\n\n<p>Any help is appreciated, thanks!</p>\n"}, {"tags": ["excel", "vba"], "owner": {"reputation": 29, "user_id": 10328624, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ix0Xp0iUgmM/AAAAAAAAAAI/AAAAAAAAAQk/vSXhsIEYzRs/photo.jpg?sz=128", "display_name": "Roaku Sezoire", "link": "https://stackoverflow.com/users/10328624/roaku-sezoire"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1547017755, "creation_date": 1546998846, "last_edit_date": 1547017755, "question_id": 54102271, "link": "https://stackoverflow.com/questions/54102271/vba-help-solve-code-for-copying-filter-paste-into-rows-based-on-condition", "title": "VBA Help Solve Code for copying, filter, paste into rows based on condition", "body": "<p><strong>Goal:</strong> When there is a number in Worksheet RP, column W i.e. not blank, that particular row's data needs to be copied to the next empty row of worksheet Calc Data. However, the data in question is not in order, i.e. row A =/= ACC# Parish for the Worksheet RP. </p>\n\n<p>Thus needs to follow = if column W not blank, then copy column B(rows not blank), column D(rows not blank), column A(rows not blank), etc into Worksheet Calc at next empty row, columns A - P as applicable. </p>\n\n<p>Worksheet collects data in the below format\n<a href=\"https://i.stack.imgur.com/LVsxX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LVsxX.png\" alt=\"Calc Data, copying into last empty row here\"></a></p>\n\n<p>Worksheet with data that needs to be manipulated \n<a href=\"https://i.stack.imgur.com/e2KQ1.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/e2KQ1.jpg\" alt=\"Column in question\"></a></p>\n\n<p><strong>Help Solve Code:</strong> I have sorta started my code but I am stuck on how to continue, or even if I am on the right track! The list columns start to be out of range, and I am not sure how to get it to filter for non-blank ranges only, or how to copy the columns for the particular data into the end rows (A - Q) in a particular order!  </p>\n\n<pre><code>Dim RPDataTbl As ListObject\nDim parishCol As ListColumn, LossRentcol As ListColumn, parishcodeCol As ListColumn, buildnoCol As ListColumn, insuredassCol As ListColumn, crestaCol As ListColumn, basiscoverCol As ListColumn\n\nDim copyRng As Range\n\nSet RPDataTbl = Sheets(\"Risk Partner Data\").ListObjects(\"RPdata\")\nWith RPDataTbl\n    Set parishCol = .ListColumns(\"Parish\")\n    Set LossRentcol = .ListColumns(\"Loss of Income or Rent\")\n    Set parishcodeCol = .ListColumns(\"Parish Code\")\n    Set crestaCol = .ListColumns(\"Cresta\")\n    Set basiscoverCol = .ListColumns(\"Basis of Cover\")\n\n    .Range.AutoFilter Field:=LossRentcol.Index, Criteria1:= &lt;not blank?&gt;\nEnd With\n\nOn Error Resume Next\nSet copyRng = parishCol.DataBodyRange.SpecialCells(xlCellTypeVisible)\nOn Error GoTo 0\n\nIf Not copyRng Is Nothing Then\n    copyRng.Copy\n\n    With Sheets(\"Calc Data\")\n        .Cells(.Rows.Count, \"A\").End(xlUp).Offset(1).PasteSpecial xlPasteValues\n    End With\n\n    Application.CutCopyMode = False\nEnd If\n</code></pre>\n\n<p>Thank you to all in advance! </p>\n"}, {"tags": ["excel", "vba", "macos", "pdf"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1547044017, "post_id": 54101935, "comment_id": 95056760, "body": "I&#39;ve added the information to the question. FWIW I tested, it ran once and saved the file. I did some &quot;fiddling around&quot; and after that got exactly the same as you. I did some research (google) and turned up others with the same problem. It appears to be an issue with the Mac. I hope the additional tags I added might get an answer from others with a better idea. You might find Ron de Bruins info helpful; starting with <a href=\"https://www.rondebruin.nl/mac/mac020.htm\" rel=\"nofollow noreferrer\">rondebruin.nl/mac/mac020.htm</a> Ron tends to hang out on the Microsoft Answers site."}], "owner": {"reputation": 21, "user_id": 10887160, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-zGb_k0pmkeg/AAAAAAAAAAI/AAAAAAAAAAc/eeCiS5eWu2E/photo.jpg?sz=128", "display_name": "Kirk Bausch", "link": "https://stackoverflow.com/users/10887160/kirk-bausch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1593592392, "creation_date": 1546996071, "last_edit_date": 1593592392, "question_id": 54101935, "link": "https://stackoverflow.com/questions/54101935/vba-macro-to-generate-pdf-pc-and-mac", "title": "VBA Macro to generate pdf (PC and Mac)", "body": "<p>I have a simple code that runs and allows me to preview a doc via pdf. It works great on a PC but when using a Mac machine I get a </p>\n\n<blockquote>\n  <p>run time error: Error while printing.</p>\n</blockquote>\n\n<p><a href=\"https://i.stack.imgur.com/LV8zA.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LV8zA.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Is there a way to alter the this code to accomodate both PC and Mac? (Version 2016/365)</p>\n\n<p>Following code works for PC:</p>\n\n<pre><code>Sub ViewAsPDF()\n\n    Worksheets(\"Quote (2)\").ExportAsFixedFormat _\n            Type:=xlTypePDF, _\n            Filename:=\"Quote\" &amp; \"_\" &amp; Worksheets(\"Quote (2)\").Range(\"C8\") &amp; \"_\" &amp; Format(Now, \"MMDDYYYY_HHMM\"), _\n            Quality:=xlQualityStandard, IncludeDocProperties:=True, _\n            IgnorePrintAreas:=False, OpenAfterPublish:=True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["regex", "vba", "expression"], "comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1546996205, "post_id": 54101907, "comment_id": 95036772, "body": "What pattern do you have so far?"}, {"owner": {"reputation": 1, "user_id": 9249190, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/086826f397db67c00994a02ce9c278c6?s=128&d=identicon&r=PG&f=1", "display_name": "kola bola", "link": "https://stackoverflow.com/users/9249190/kola-bola"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1546996524, "post_id": 54101907, "comment_id": 95036827, "body": "Thanks. I have the following: ([.01-9]+\\+)"}, {"owner": {"reputation": 1, "user_id": 9249190, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/086826f397db67c00994a02ce9c278c6?s=128&d=identicon&r=PG&f=1", "display_name": "kola bola", "link": "https://stackoverflow.com/users/9249190/kola-bola"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1546996786, "post_id": 54101907, "comment_id": 95036881, "body": "^(?!\\&quot;[0.1-9]+\\+\\&quot;)([0.01-9]+\\+) but does not match 1.25+"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1546996811, "post_id": 54101907, "comment_id": 95036888, "body": "can you share you vba code?"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1546996844, "post_id": 54101907, "comment_id": 95036894, "body": "<a href=\"https://regex101.com/r/OEPWHB/1\" rel=\"nofollow noreferrer\">regex101.com/r/OEPWHB/1</a>"}, {"owner": {"reputation": 1, "user_id": 9249190, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/086826f397db67c00994a02ce9c278c6?s=128&d=identicon&r=PG&f=1", "display_name": "kola bola", "link": "https://stackoverflow.com/users/9249190/kola-bola"}, "edited": false, "score": 0, "creation_date": 1546996962, "post_id": 54101907, "comment_id": 95036927, "body": "It is a simple match and replace function"}, {"owner": {"reputation": 1, "user_id": 9249190, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/086826f397db67c00994a02ce9c278c6?s=128&d=identicon&r=PG&f=1", "display_name": "kola bola", "link": "https://stackoverflow.com/users/9249190/kola-bola"}, "edited": false, "score": 0, "creation_date": 1546997276, "post_id": 54101907, "comment_id": 95036989, "body": "I got it: thanks everyone for the help.   \u200b(?![\\&quot;])([0.1-9]+\\+)(?![\\&quot;])"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 9249190, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/086826f397db67c00994a02ce9c278c6?s=128&d=identicon&r=PG&f=1", "display_name": "kola bola", "link": "https://stackoverflow.com/users/9249190/kola-bola"}, "is_accepted": false, "score": 0, "last_activity_date": 1546998929, "last_edit_date": 1546998929, "creation_date": 1546997410, "answer_id": 54102094, "question_id": 54101907, "link": "https://stackoverflow.com/questions/54101907/vba-regular-expression-with-exclusion/54102094#54102094", "title": "VBA Regular Expression with exclusion", "body": "<p>I got it: thanks everyone for the help.</p>\n\n<p>This regexp seems to work:</p>\n\n<p>\u200b<code>(?![\\\"])([0.1-9]+\\\\+)(?![\\\"])</code></p>\n"}], "owner": {"reputation": 1, "user_id": 9249190, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/086826f397db67c00994a02ce9c278c6?s=128&d=identicon&r=PG&f=1", "display_name": "kola bola", "link": "https://stackoverflow.com/users/9249190/kola-bola"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1546998929, "creation_date": 1546995887, "question_id": 54101907, "link": "https://stackoverflow.com/questions/54101907/vba-regular-expression-with-exclusion", "title": "VBA Regular Expression with exclusion", "body": "<p>I am looking for RegExp that matches something like the following:</p>\n\n<p>25+ 1.25+ (any numeric format with plus sign to the right - no space between)</p>\n\n<p>but does not match the following:\n\"25+\" \"1.25+\" (any numeric format with plus sign to the right - no space between but within double quotes) </p>\n\n<p>ThanKs</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1546995421, "post_id": 54101791, "comment_id": 95036593, "body": "Have you tried recording a macro while performing the copy/paste process?"}, {"owner": {"reputation": 1085, "user_id": 8505034, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/1588466231176126/picture?type=large", "display_name": "Rae Ian", "link": "https://stackoverflow.com/users/8505034/rae-ian"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1546995661, "post_id": 54101791, "comment_id": 95036649, "body": "Yes sir, I tried to record a macro. Just testing it first before doing the macro"}], "answers": [{"tags": [], "owner": {"reputation": 3439, "user_id": 220034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2ee5c3aaab4812b216c03f81ae897b5?s=128&d=identicon&r=PG", "display_name": "Ass3mbler", "link": "https://stackoverflow.com/users/220034/ass3mbler"}, "is_accepted": true, "score": 2, "last_activity_date": 1546995907, "creation_date": 1546995907, "answer_id": 54101909, "question_id": 54101791, "link": "https://stackoverflow.com/questions/54101791/excel-screenshot-automatically-pastes-to-another-sheet-vba/54101909#54101909", "title": "Excel: Screenshot automatically pastes to another sheet VBA", "body": "<p>Assuming that your destination sheet (Checking) is in a variable named shtChecking, you can do it this way:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    shtAnalysis.Range(\"A10:U36\").CopyPicture format:=xlBitmap\n    MsgBox \"Snapshot copied to clipboard!\", vbInformation Or vbOKOnly, \"Snapshot\"\n    shtChecking.Paste Destination:=shtChecking.Range(\"F5\")\nEnd Sub\n</code></pre>\n\n<p>If you want to align the image with the cell \"F5\", in example</p>\n"}], "owner": {"reputation": 1085, "user_id": 8505034, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/1588466231176126/picture?type=large", "display_name": "Rae Ian", "link": "https://stackoverflow.com/users/8505034/rae-ian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "accepted_answer_id": 54101909, "answer_count": 1, "score": 0, "last_activity_date": 1547017770, "creation_date": 1546994754, "last_edit_date": 1547017770, "question_id": 54101791, "link": "https://stackoverflow.com/questions/54101791/excel-screenshot-automatically-pastes-to-another-sheet-vba", "title": "Excel: Screenshot automatically pastes to another sheet VBA", "body": "<p>I have here my draft code of screen shot for my sheet.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nshtAnalysis.Range(\"A10:U36\").CopyPicture format:=xlBitmap\nMsgBox \"Snapshot copied to clipboard!\", vbInformation Or vbOKOnly, \"Snapshot\"\n\nEnd Sub\n</code></pre>\n\n<p>What I'm aiming to do is when you click the button for screen shot\nThe code will do the screen shot and will paste it into another new sheet. </p>\n\n<p>I have 2 Sheets,\nthe first sheet, <strong><em>Analysis</em></strong> (Where the button for screen shot located)\nthe second sheet, <strong><em>Checking</em></strong> (Where the screen shot will be placed)</p>\n"}, {"tags": ["excel", "vba", "parsing", "runtime"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1546994175, "post_id": 54101604, "comment_id": 95036317, "body": "A screenshot of your data would be useful here."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1546994523, "post_id": 54101604, "comment_id": 95036388, "body": "...&quot;Each Category in row 1 is a series of merged cells&quot; is open to a few different interpretations"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10886950, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213375620528834/picture?type=large", "display_name": "Clamp", "link": "https://stackoverflow.com/users/10886950/clamp"}, "edited": false, "score": 0, "creation_date": 1547072391, "post_id": 54102368, "comment_id": 95071047, "body": "Thank you so much!  That is exactly what I was looking for and exactly what I was trying to describe!  I apologize for not initially including a photo of my data, but it totally slipped my mind.  Thank you for your time!"}], "tags": [], "owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "is_accepted": true, "score": 1, "last_activity_date": 1547003129, "last_edit_date": 1547003129, "creation_date": 1546999806, "answer_id": 54102368, "question_id": 54101604, "link": "https://stackoverflow.com/questions/54101604/how-to-parse-through-a-row-using-information-pulled-from-a-user-form/54102368#54102368", "title": "How to parse through a row using information pulled from a user form", "body": "<p>Welcome to SO.Though the requirement and worksheet Data layout is not clear, It assumed as below. \n<a href=\"https://i.stack.imgur.com/SFnWR.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SFnWR.jpg\" alt=\"enter image description here\"></a>\nCode used may be modified to your requirement and may be moved from Change Event of CATBOX to any suitable event</p>\n\n<pre><code>Private Sub CATBOX_Change()\nDim Rng As Range, SubRng As Range\nDim Rw As Long, ColSt As Long, ColEnd As Long, i As Long, ScatNo As Long\nDim Rag As Object\n\nWith ThisWorkbook.ActiveSheet\n\nSet Rng = .Rows(1).Find(What:=UserForm1.CATBOX.Value, LookIn:=xlValues, LookAt:=xlWhole, SearchOrder:=xlByRows, _\n            SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False)\n\nIf Rng Is Nothing Then Exit Sub\n\nSet Rng = Rng.MergeArea\nSet rngstart = Rng.Cells(1, 1)\nSet rngEnd = Rng.Cells(Rng.Rows.Count, Rng.Columns.Count)\nRw = Rng.Row + Rng.Rows.Count\nColSt = Rng.Column\nColEnd = Rng.Column + Rng.Columns.Count - 1\nDebug.Print Rw, ColSt, ColEnd\n\nSet Rng = .Range(.Cells(Rw, ColSt), .Cells(Rw, ColEnd))\nScatNo = 0\n   For Each SubRng In Rng\n        If SubRng.Value &lt;&gt; \"\" Then\n        ScatNo = ScatNo + 1\n        Set Rag = UserForm2.Controls.Add(\"Forms.Label.1\", \"Scat\" &amp; ScatNo)\n        Rag.Caption = SubRng.Value\n        Rag.Left = 70\n        Rag.Width = 50\n        Rag.Top = ScatNo * 30\n        End If\n   Next\nEnd With\nUserForm2.Show\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10886950, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213375620528834/picture?type=large", "display_name": "Clamp", "link": "https://stackoverflow.com/users/10886950/clamp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 54102368, "answer_count": 1, "score": 1, "last_activity_date": 1547017791, "creation_date": 1546993006, "last_edit_date": 1547017791, "question_id": 54101604, "link": "https://stackoverflow.com/questions/54101604/how-to-parse-through-a-row-using-information-pulled-from-a-user-form", "title": "How to parse through a row using information pulled from a user form", "body": "<p>I am attempting to create a userform which takes input from userform1 and passes it to userform2 which displays the information belonging to that set of data on userform2. The problem is that once the overall category is selected from row 1 (CATBOX), I need to limit the parser to the subcomponents in row 2 as there are other subcomponents in other categories on the same row. Each Category in row 1 is a series of merged cells. </p>\n\n<p>I have already tried using 'find' to find the value of <code>userform1!CATBOX</code> and return the position to get the starting column.  Then I tried to find the range of the merged cell so that I could get the end point.  I then tried to limit the parser to the range of columns on row 2 to collect my information.  I included the last bit of code to simply display the values of the start and end points onto userform2, it is not necessary to my code.</p>\n\n<pre><code>With ActiveSheet\n\n    Set ra = ActiveSheet.Cells.Find(What:=UserForm1!CATBOX.Value, After:=Range(\"A1\"), _\n            LookIn:=xlFormulas, LookAt:=xlWhole, SearchOrder:=xlByRows, _\n            SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False).Activate\n    Set rng = Range(ra)\n\n    If rng.MergeCells Then\n\n        Set rng = rng.MergeArea\n        Set rngStart = rng.Cells(1, 1)\n        Set rngEnd = rng.Cells(rng.Rows.Count, rng.Columns.Count)\n    End If\n\n\n    Set rag = UserForm2.Controls.Add(\"Forms.Label.1\", \"rag\", True)\n    With rag\n        .Caption = rngStart.Address\n        .Left = 10\n        .Width = 50\n        .Top = 50\n    End With\n\n    Set rag2 = UserForm2.Controls.Add(\"Forms.Label.1\", \"rag2\", True)\n    With rag2\n        .Caption = rngEnd.Address\n        .Left = 70\n        .Width = 50\n        .Top = 50\n    End With\n\n    End With\n</code></pre>\n\n<p>The result I am looking to get is the ability to parse that second row of information limited to the range of columns established by the merged category above it.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3439, "user_id": 220034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2ee5c3aaab4812b216c03f81ae897b5?s=128&d=identicon&r=PG", "display_name": "Ass3mbler", "link": "https://stackoverflow.com/users/220034/ass3mbler"}, "edited": false, "score": 1, "creation_date": 1546993011, "post_id": 54101566, "comment_id": 95036051, "body": "What do you mean with &quot;to reference&quot;?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1546995283, "post_id": 54101566, "comment_id": 95036558, "body": "&quot;cant seem to locate what I need.&quot; - can you explain it though?  Your question is maybe a little too brief..."}], "answers": [{"tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": true, "score": 1, "last_activity_date": 1546995514, "last_edit_date": 1546995514, "creation_date": 1546994575, "answer_id": 54101764, "question_id": 54101566, "link": "https://stackoverflow.com/questions/54101566/vba-how-to-reference-two-separate-open-workbooks-without-naming-them/54101764#54101764", "title": "VBA - How to reference two separate open workbooks without naming them?", "body": "<h1>Refer to Workbooks</h1>\n\n<p>If you know there are only two workbooks open, you can use the Index property.</p>\n\n<pre><code>Sub ReferToWorkbooks()\n\n    Dim wb1 As Workbook\n    Dim wb2 As Workbook\n\n    Set wb1 = Workbooks(1)\n    Set wb2 = Workbooks(2)\n\n    Debug.Print wb1.Name\n    Debug.Print wb2.Name\n\nEnd Sub\n</code></pre>\n\n<p>It is better to loop through all open workbooks and then create references to the ones you need.</p>\n\n<pre><code>Sub ReferToWorkbooks2()\n\n    Dim wb As Workbook\n\n    For Each wb In Workbooks\n        Debug.Print wb.Name\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>In case you have a worksheet in your code you use the Parent property:</p>\n\n<pre><code>Sub ReferToWorkbooks3()\n\n    Dim ws As Worksheet\n    Dim wb As Workbook\n\n    Set ws = Worksheets(\"Sheet1\")\n\n    Debug.Print ws.Parent.Name\n\n    ' or\n\n    Set wb = ws.Parent\n    Debug.Print wb.Name\n\nEnd Sub\n</code></pre>\n\n<p>In case you have a range in your code you use the Parent property twice:</p>\n\n<pre><code>Sub ReferToWorkbooks4()\n\n    Dim rng As Range\n    Dim wb As Workbook\n\n    Set rng = Range(\"A1\")\n\n    Debug.Print rng.Parent.Parent.Name\n\n    ' or\n\n    Set wb = rng.Parent.Parent\n    Debug.Print wb.Name\n\nEnd Sub\n</code></pre>\n\n<p>You should better explain the scenario where you might need this.</p>\n"}], "owner": {"reputation": 51, "user_id": 4151676, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000781809701/picture?type=large", "display_name": "Justin Captain Wypij", "link": "https://stackoverflow.com/users/4151676/justin-captain-wypij"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 54101764, "answer_count": 1, "score": 1, "last_activity_date": 1546995514, "creation_date": 1546992768, "question_id": 54101566, "link": "https://stackoverflow.com/questions/54101566/vba-how-to-reference-two-separate-open-workbooks-without-naming-them", "title": "VBA - How to reference two separate open workbooks without naming them?", "body": "<p>I have looked around for awhile and cant seem to locate what I need. </p>\n"}, {"tags": ["sql-server", "vba", "tsql", "ms-access", "pass-through"], "comments": [{"owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "edited": false, "score": 0, "creation_date": 1546992048, "post_id": 54101277, "comment_id": 95035825, "body": "Does the PassThru query run in a module that is then exited? thus dropping the connection?  Is there some other way that another module could drop the connection for this app?"}, {"owner": {"reputation": 11, "user_id": 8317465, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-zVUP-JwVEy8/AAAAAAAAAAI/AAAAAAAAD7U/sY5wQCnvYWk/photo.jpg?sz=128", "display_name": "Jordan H", "link": "https://stackoverflow.com/users/8317465/jordan-h"}, "reply_to_user": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "edited": false, "score": 0, "creation_date": 1546992611, "post_id": 54101277, "comment_id": 95035955, "body": "Perhaps. More specifically, the pass-through query definition is dynamically populated with a SQL string and then executed using DoCmd.RunSql(sql)."}, {"owner": {"reputation": 5227, "user_id": 1632534, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/84e7e39565f25e1ff84c7f2bf7876e94?s=128&d=identicon&r=PG", "display_name": "OzrenTkalcecKrznaric", "link": "https://stackoverflow.com/users/1632534/ozrentkalceckrznaric"}, "edited": false, "score": 2, "creation_date": 1546997454, "post_id": 54101277, "comment_id": 95037046, "body": "SQL Server drops global temporary tables when all sessions that use the table end. That&#39;s the way it works. You have to monitor your sessions and find out when do they get dropped. It&#39;s completely logical that re-querying the temp table resets the MS Access session timer."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 1, "creation_date": 1547017417, "post_id": 54101277, "comment_id": 95041712, "body": "Oh. A persistent temporary table?"}, {"owner": {"reputation": 62126, "user_id": 5089204, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/xGm6I.jpg?s=128&g=1", "display_name": "Shnugo", "link": "https://stackoverflow.com/users/5089204/shnugo"}, "edited": false, "score": 2, "creation_date": 1547022988, "post_id": 54101277, "comment_id": 95044227, "body": "Jordan, a temp table is a <i>temporary thing</i>... that is what it&#39;s meant to be... I would not hack around tricking out the wanted behaviour, just to simulate a persistant table. Why don&#39;t you create a normal table for this? You can 1) name it <i>tmpSomeSame</i>, 2) you might create a schema <i>tmp</i> and call your table <i>tmp.SomeName</i> and 3) (if this is a matter of rights) you can create a complete side-database on the same server and use <i>sideDb.dbo.SomeTable</i>."}, {"owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "edited": false, "score": 0, "creation_date": 1547063736, "post_id": 54101277, "comment_id": 95067437, "body": "+1 for Shnugo above.    If the  example was using a #temp table, then we have maybe some issues here. However, a ##temp table is global to all users - not just the current user connection. give that global ##temp tables vs that of  #temp is being used here, then I would create a permanent table - even if I had to drop it after its been used."}, {"owner": {"reputation": 11, "user_id": 8317465, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-zVUP-JwVEy8/AAAAAAAAAAI/AAAAAAAAD7U/sY5wQCnvYWk/photo.jpg?sz=128", "display_name": "Jordan H", "link": "https://stackoverflow.com/users/8317465/jordan-h"}, "edited": false, "score": 0, "creation_date": 1547070935, "post_id": 54101277, "comment_id": 95070473, "body": "OzrenTkalcecKrznaric - Appreciate the help. That&#39;s the way I understand it as well. I&#39;ll see if I can more closely monitor the temp table existence. Shnugo - The goal is to have a temporary (##global) table, yes. There is no &quot;hacking around&quot; to reference your assumed response. Ultimately, the question is to understand the mechanics how how to persist a temporary table as seen fit."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1547076374, "post_id": 54101277, "comment_id": 95072180, "body": "Not to be rude. But if multiple experienced users tell you &quot;this is not the correct usage for a ##temp table&quot;, it is worth listening to them. And what else than &quot;hacking around the normal behavior&quot; could requerying a temp table every 5 minutes, just to make it persist, be?"}], "owner": {"reputation": 11, "user_id": 8317465, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-zVUP-JwVEy8/AAAAAAAAAAI/AAAAAAAAD7U/sY5wQCnvYWk/photo.jpg?sz=128", "display_name": "Jordan H", "link": "https://stackoverflow.com/users/8317465/jordan-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 666, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1547071485, "creation_date": 1546990648, "last_edit_date": 1547071485, "question_id": 54101277, "link": "https://stackoverflow.com/questions/54101277/how-to-control-when-a-sql-server-temp-table-is-disconnected", "title": "How to control when a SQL Server temp table is disconnected?", "body": "<p>I'd like to control when a (global) temporary table in SQL Server is removed (session disconnected). The global temp table is created using MS Access pass through query. It seems to disconnect based on a timer and I'd like to have more control over when Access disconnects from the temp table.</p>\n\n<blockquote>\n  <ol>\n  <li>Pass through query ran in MS Access.</li>\n  <li>Temp table now available in SQL Server. (I.e., ##TempTable1)</li>\n  <li>30 minutes later, SQL Server temp table (##TempTable1) is no longer available.</li>\n  </ol>\n</blockquote>\n\n<p>Temp tables with other software, such as SSMS and Toad keep temp tables open until the session is completely closed. Access seems to remove temp table connection based on how long they've been created.</p>\n\n<p>I've tried keeping the pass through query results (the actual query results) open in <code>MS Access</code> to see if the temp table will continue to exist, without luck.</p>\n\n<p>I'm hoping for a setting/property where the pass through query keeps it's connection with SQL Server in order to persist the temp table on SQL Server.</p>\n\n<p><strong>[UPDATE]:</strong>\nAfter timing the exact persistence period, the temp table seems to still exist:</p>\n\n<ol>\n<li>Query the temp table (##TempTable1) in MS Access every 5 minutes</li>\n<li>Results present = temp table still exists</li>\n<li>TempTable1 has now persisted for 1h 20m</li>\n</ol>\n\n<p>Re-querying the temp table must be resetting some connection timer.</p>\n"}, {"tags": ["arrays", "vba"], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1546990500, "creation_date": 1546990500, "answer_id": 54101252, "question_id": 54101227, "link": "https://stackoverflow.com/questions/54101227/vba-function-seems-to-return-an-array-but-i-get-type-mismatch-array-or-user-de/54101252#54101252", "title": "VBA function seems to return an array but I get &quot;Type mismatch: array or user-defined type expected&quot;", "body": "<p>Though your code does nothing, this will stop the error:</p>\n\n<pre><code>Sub x()\n    Dim a() As Variant\n    z y(a)\nEnd Sub\n\nFunction y(a() As Variant) As Variant()\n    y = a\nEnd Function\n\nFunction z(a() As Variant) As Variant()\n    z = a\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 8724, "user_id": 619177, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/65d2dc7c8d335fa33854172a26fa46f5?s=128&d=identicon&r=PG", "display_name": "sigil", "link": "https://stackoverflow.com/users/619177/sigil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 54101252, "answer_count": 1, "score": 0, "last_activity_date": 1546990500, "creation_date": 1546990332, "question_id": 54101227, "link": "https://stackoverflow.com/questions/54101227/vba-function-seems-to-return-an-array-but-i-get-type-mismatch-array-or-user-de", "title": "VBA function seems to return an array but I get &quot;Type mismatch: array or user-defined type expected&quot;", "body": "<p>I have this set of VBA functions:</p>\n\n<pre><code>Sub x()\n    Dim a() As Variant\n    z y(a)\nEnd Sub\n\nFunction y(a() As Variant) As Variant\n    y = a\nEnd Function\n\nFunction z(a() As Variant) As Variant\n    z = a\nEnd Function\n</code></pre>\n\n<p>When I run <code>x()</code>, the line <code>z y(a)</code> throws an error:</p>\n\n<pre><code>Type mismatch: array or user-defined type expected\n</code></pre>\n\n<p>I guess this is happening because <code>z()</code> is expecting an array as an argument but the return value of <code>y()</code> is a variant, not an array.  I'm not sure how to make clear that <code>y()</code> returns an array of variants--did I declare it wrong?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 187, "user_id": 6582704, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/245727133ad197d1ad7fb043d4f4a704?s=128&d=identicon&r=PG&f=1", "display_name": "jh4", "link": "https://stackoverflow.com/users/6582704/jh4"}, "edited": false, "score": 0, "creation_date": 1547017794, "post_id": 54101197, "comment_id": 95041874, "body": "this works very well for me. Thank you so much for sharing the solution."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 3, "last_activity_date": 1546991502, "last_edit_date": 1546991502, "creation_date": 1546990072, "answer_id": 54101197, "question_id": 54101184, "link": "https://stackoverflow.com/questions/54101184/userform-date-not-showing-up-in-the-correct-format-in-spreadsheet/54101197#54101197", "title": "Userform Date not showing up in the correct format in spreadsheet", "body": "<p>VBA is US-EN centric and when it comes to dates it wants to assume <code>MM/DD/YYYY</code> when it tries to convert a string to a date.</p>\n\n<p>First we want to force the date by parsing the string coming in from the textbox:</p>\n\n<pre><code>Cells(emptyRow, 1).Value = DateSerial(Split(DateBox.Value,\"/\")(2),Split(DateBox.Value,\"/\")(1),Split(DateBox.Value,\"/\")(0))\n</code></pre>\n\n<p>Then format the cell after parsing the date:</p>\n\n<pre><code>Cells(emptyRow, 1).NumberFormat = \"d/m/yy\"\n</code></pre>\n\n<p>Or consider using a more accepted format for the date <code>dd mmm, yyyy</code> in your datebox.  This makes it less ambiguous.</p>\n\n<p>Thanks to chris neilsen for his help.</p>\n"}], "owner": {"reputation": 187, "user_id": 6582704, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/245727133ad197d1ad7fb043d4f4a704?s=128&d=identicon&r=PG&f=1", "display_name": "jh4", "link": "https://stackoverflow.com/users/6582704/jh4"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 54101197, "answer_count": 1, "score": 0, "last_activity_date": 1547017801, "creation_date": 1546989982, "last_edit_date": 1547017801, "question_id": 54101184, "link": "https://stackoverflow.com/questions/54101184/userform-date-not-showing-up-in-the-correct-format-in-spreadsheet", "title": "Userform Date not showing up in the correct format in spreadsheet", "body": "<p>I have a userform that has a textbox called 'DateBox'. I have the following code:</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n    DateBox.Value = Format(Date, \"d/m/yy\")\n</code></pre>\n\n<p>On form submit, I have the following code to update Sheet1's first empty cell with the Date as per the form.</p>\n\n<pre><code>   Cells(emptyRow, 1).Value = DateBox.Value \n</code></pre>\n\n<p>However, instead of d/m/yy, the spreadsheet shows m/d/yy. I have done some search and understand that this has something to do with the regional settings. I'm not sure changing the settings will be helpful for me as this form will be used by different groups of people with possibly different settings.</p>\n\n<p>I would like to know if there is a way I can hard code the date to appear in the desired format?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 2, "creation_date": 1546995150, "post_id": 54101170, "comment_id": 95036527, "body": "Why do you need to delete the collection? VBA should do garbage collection on unused items when they lose scope."}, {"owner": {"reputation": 46, "user_id": 10886850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9389aac3e43fe61da05262244c498703?s=128&d=identicon&r=PG&f=1", "display_name": "MikeyD", "link": "https://stackoverflow.com/users/10886850/mikeyd"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1547023939, "post_id": 54101170, "comment_id": 95044707, "body": "I don&#39;t necessarily need to delete it - but once my macro finishes running and I do my cleanup, that&#39;s when it locks up and takes a few minutes. Even when I leave it up to Excel to [STOP], it locks up for a few minutes emptying the collections."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1547036947, "post_id": 54101170, "comment_id": 95052436, "body": "I think you can safely skip this step, VBA should handle this for you."}], "owner": {"reputation": 46, "user_id": 10886850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9389aac3e43fe61da05262244c498703?s=128&d=identicon&r=PG&f=1", "display_name": "MikeyD", "link": "https://stackoverflow.com/users/10886850/mikeyd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1547017812, "creation_date": 1546989900, "last_edit_date": 1547017812, "question_id": 54101170, "link": "https://stackoverflow.com/questions/54101170/excel-vba-set-collection-nothing-taking-100-times-longer-than-creating-colle", "title": "Excel VBA - set collection = nothing taking 100 times longer than creating collection", "body": "<p>sorry if similar has already been posted - I couldn't find one.</p>\n\n<p>I have a need to have a collection of classes that each contains a collection of classes. There's expected to be a few hundred thousand entries to the collections.</p>\n\n<p>I am finding it's taking ~1 second to create all of the collections, but taking ~minutes to delete them afterwards.  </p>\n\n<p>Below is a snippet of random code that creates the issue I'm seeing.</p>\n\n<p>Is this expected?  Why does it take ~100 times longer to delete the collections vs creating it. Is there any way of speeding it up?</p>\n\n<p>Thanks</p>\n\n<p><strong>Module1:</strong></p>\n\n<pre><code>Private p_main_collection As Collection\n\nSub main()\n\nDebug.Print \"Starting: \" &amp; Now()\n\n    Set p_main_collection = New Collection\n\n    Dim i As Long\n    Dim j As Long\n\n    Dim v_class1 As Class1\n    Dim v_class2 As Class2\n\n    For i = 1 To 8\n\n        Set v_class1 = New Class1\n        p_main_collection.Add v_class1\n\n        v_class1.Num = i\n\n        For j = 1 To 50000\n\n            Set v_class2 = New Class2\n            v_class2.Num = j\n\n            v_class1.add_to_collection = v_class2\n\n        Next j\n\n    Next i\n\nDebug.Print \"Deleting: \" &amp; Now()\n    Set p_main_collection = Nothing\nDebug.Print \"Deleted: \" &amp; Now()\n\nEnd Sub\n</code></pre>\n\n<p><strong>Class1</strong></p>\n\n<pre><code>Private p_num As Integer\nPrivate p_collection As Collection\n\nPrivate Sub Class_Initialize()\n    Set p_collection = New Collection\nEnd Sub\n\nPublic Property Let Num(p_num_in As Integer)\n    p_num = p_num_in\nEnd Property\n\nPublic Property Get Num() As Integer\n    Num = p_num\nEnd Property\n\nPublic Property Let add_to_collection(p_collection_in As Class2)\n    p_collection.Add p_collection_in\nEnd Property\n</code></pre>\n\n<p><strong>Class2</strong></p>\n\n<pre><code>Private p_num As Long\n\nPublic Property Let Num(p_num_in As Long)\n    p_num = p_num_in\nEnd Property\n\nPublic Property Get Num() As Long\n    Num = p_num\nEnd Property\n</code></pre>\n\n<p><strong>Result</strong></p>\n\n<pre><code>Starting: 08/01/2019 23:15:01\nDeleting: 08/01/2019 23:15:02\nDeleted: 08/01/2019 23:16:19\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1546990494, "post_id": 54101164, "comment_id": 95035416, "body": "<a href=\"https://stackoverflow.com/a/35882736/4539709\">stackoverflow.com/a/35882736/4539709</a> is this what you trying to do?"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1546990755, "post_id": 54101164, "comment_id": 95035498, "body": "I don&#39;t think so, but am unsure. I am not well versed in Outlook VBA. Can you give an example of how to include that in a <code>.Body</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1546992323, "post_id": 54101332, "comment_id": 95035881, "body": "@Om3r thanks I actually got the body recreated. I only have one last issue and i&#39;m done - how do I embed a outlook email address using HTML? hmm"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 2, "creation_date": 1546992485, "post_id": 54101332, "comment_id": 95035925, "body": "Nvm. I got it. Thanks so much! Project finished <code>&lt;A href=mailto:urdearboy@needshelp.com&gt; Hyper Link Text Goes Here&lt;&#47;A&gt;</code>"}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": true, "score": 2, "last_activity_date": 1546991641, "last_edit_date": 1546991641, "creation_date": 1546990973, "answer_id": 54101332, "question_id": 54101164, "link": "https://stackoverflow.com/questions/54101164/add-hyper-link-web-to-outlook-email/54101332#54101332", "title": "Add hyper link (web) to Outlook email", "body": "<p><em>Try working with <strong><code>.HTMLBody</code></em></strong></p>\n\n<p><em>Example</em></p>\n\n<blockquote>\n<pre><code>.HTMLBody = \"&lt;A href=https://www.google.com/&gt; Click Here &lt;/A&gt;\"\n</code></pre>\n</blockquote>\n\n<p><strong><em><a href=\"https://docs.microsoft.com/en-us/previous-versions/office/developer/office-2003/aa171418(v=office.11)\" rel=\"nofollow noreferrer\">MSDN HTMLBody Property</a></em></strong></p>\n\n<p><em>Returns or sets a String representing the HTML body of the specified item. The HTMLBody property should be an HTML syntax string. Read/write.</em></p>\n\n<p><strong><em><a href=\"https://docs.microsoft.com/en-us/office/vba/api/Outlook.MailItem.Body\" rel=\"nofollow noreferrer\">MSDN .Body Property</a></em></strong></p>\n\n<p><em>Returns or sets a String representing the clear-text body of the Outlook item. Read/write.</em></p>\n"}], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 54101332, "answer_count": 1, "score": 2, "last_activity_date": 1592689753, "creation_date": 1546989861, "last_edit_date": 1592689753, "question_id": 54101164, "link": "https://stackoverflow.com/questions/54101164/add-hyper-link-web-to-outlook-email", "title": "Add hyper link (web) to Outlook email", "body": "<p>I am having issues embedding a hyperlink to some text like <a href=\"https://stackoverflow.com/questions/54101164/add-hyper-link-web-to-outlook-email\">this</a>.</p>\n\n<p>I am running the macro from Excel which creates a Outlook object and repeats for all values down column c. </p>\n\n<p>The below did not work so, <strong>how do I go about embedding a link here?</strong></p>\n\n<p><code>.Body = \"Click Here &lt;https://www.google.com/&gt;</code></p>\n\n<hr>\n\n<p>Code below</p>\n\n<pre><code>Dim OutApp As Object\nDim OutMail As Object\nDim cell As Range\n\nApplication.ScreenUpdating = False\nSet OutApp = CreateObject(\"Outlook.Application\")\n\nOn Error GoTo cleanup\nFor Each cell In Columns(\"B\").Cells.SpecialCells(xlCellTypeConstants)\n    If cell.Value Like \"?*@?*.?*\" And _\n       LCase(Cells(cell.Row, \"C\").Value) = \"yes\" Then\n\n        Set OutMail = OutApp.CreateItem(0)\n        On Error Resume Next\n        With OutMail\n\n            .SentOnBehalfOfName = \"urdearboy@needshelp.com\"\n            .to = cell.Value\n\n            .Subject = \"Subject\" &amp; Cells(cell.Row, \"D\").Value\n            .Body = \"Click Here &lt;https://www.google.com/&gt;\"\n\n             strLocation = \"C:\\Users\\hahayouthought\"\n            .Attachments.Add (strLocation)\n\n            .Display\n        End With\n        On Error GoTo 0\n        Set OutMail = Nothing\n    End If\nNext cell\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 3439, "user_id": 220034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2ee5c3aaab4812b216c03f81ae897b5?s=128&d=identicon&r=PG", "display_name": "Ass3mbler", "link": "https://stackoverflow.com/users/220034/ass3mbler"}, "edited": false, "score": 0, "creation_date": 1546990975, "post_id": 54101100, "comment_id": 95035561, "body": "It&#39;s correct to assume that the Projects and the Tasks sheet will be sorted by ProjectID?"}, {"owner": {"reputation": 13, "user_id": 10886896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/584e762c9acace559b0772ded16ee8f2?s=128&d=identicon&r=PG&f=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/10886896/pascal"}, "reply_to_user": {"reputation": 3439, "user_id": 220034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2ee5c3aaab4812b216c03f81ae897b5?s=128&d=identicon&r=PG", "display_name": "Ass3mbler", "link": "https://stackoverflow.com/users/220034/ass3mbler"}, "edited": false, "score": 0, "creation_date": 1546991101, "post_id": 54101100, "comment_id": 95035590, "body": "Yes, ProjectID is the main identifier of interest for both. Thanks for the answer"}, {"owner": {"reputation": 3439, "user_id": 220034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2ee5c3aaab4812b216c03f81ae897b5?s=128&d=identicon&r=PG", "display_name": "Ass3mbler", "link": "https://stackoverflow.com/users/220034/ass3mbler"}, "edited": false, "score": 0, "creation_date": 1546991118, "post_id": 54101100, "comment_id": 95035596, "body": "You are welcome, I&#39;ll post the code in minutes"}, {"owner": {"reputation": 13, "user_id": 10886896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/584e762c9acace559b0772ded16ee8f2?s=128&d=identicon&r=PG&f=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/10886896/pascal"}, "reply_to_user": {"reputation": 3439, "user_id": 220034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2ee5c3aaab4812b216c03f81ae897b5?s=128&d=identicon&r=PG", "display_name": "Ass3mbler", "link": "https://stackoverflow.com/users/220034/ass3mbler"}, "edited": false, "score": 0, "creation_date": 1546991219, "post_id": 54101100, "comment_id": 95035614, "body": "You&#39;re helping me a lot with this. Thank you so much."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10886896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/584e762c9acace559b0772ded16ee8f2?s=128&d=identicon&r=PG&f=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/10886896/pascal"}, "edited": false, "score": 0, "creation_date": 1546991742, "post_id": 54101393, "comment_id": 95035745, "body": "You&#39;re crazy. It worked. You can&#39;t believe how much you help me with this. Thanks!!!"}, {"owner": {"reputation": 3439, "user_id": 220034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2ee5c3aaab4812b216c03f81ae897b5?s=128&d=identicon&r=PG", "display_name": "Ass3mbler", "link": "https://stackoverflow.com/users/220034/ass3mbler"}, "reply_to_user": {"reputation": 13, "user_id": 10886896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/584e762c9acace559b0772ded16ee8f2?s=128&d=identicon&r=PG&f=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/10886896/pascal"}, "edited": false, "score": 0, "creation_date": 1546991790, "post_id": 54101393, "comment_id": 95035760, "body": "I&#39;m really happy it worked for you! You are welcome and have a nice day!"}, {"owner": {"reputation": 13, "user_id": 10886896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/584e762c9acace559b0772ded16ee8f2?s=128&d=identicon&r=PG&f=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/10886896/pascal"}, "edited": false, "score": 0, "creation_date": 1546991899, "post_id": 54101393, "comment_id": 95035796, "body": "You have one as well :)"}], "tags": [], "owner": {"reputation": 3439, "user_id": 220034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2ee5c3aaab4812b216c03f81ae897b5?s=128&d=identicon&r=PG", "display_name": "Ass3mbler", "link": "https://stackoverflow.com/users/220034/ass3mbler"}, "is_accepted": true, "score": 0, "last_activity_date": 1546991369, "creation_date": 1546991369, "answer_id": 54101393, "question_id": 54101100, "link": "https://stackoverflow.com/questions/54101100/building-a-to-do-list-with-vba-in-excel-how-to-insert-rows-dynamically/54101393#54101393", "title": "Building a To-Do List with vba in excel: How to insert rows dynamically?", "body": "<p>You can try with a double loop to process both worksheets (Projects and Tasks) this way:</p>\n\n<pre><code>    Public Sub DoResults()\n    Set P = Sheets(\"Projects\")\n    Set T = Sheets(\"Tasks\")\n    Set R = Sheets(\"Result\")\n\n    Dim row_p, row_t, row_r As Integer\n    Dim curr_project_id\n\n\n    row_p = 2\n    row_t = 2\n    row_r = 2\n\n    R.UsedRange.ClearContents\n\n    While (P.Range(\"A\" &amp; row_p) &lt;&gt; \"\")\n        curr_project_id = P.Range(\"A\" &amp; row_p)\n\n        'Copy the project row in the Results Sheet\n        P.Range(\"A\" &amp; row_p &amp; \":C\" &amp; row_p).Copy R.Range(\"A\" &amp; row_r)\n        row_r = row_r + 1\n\n        While (T.Range(\"A\" &amp; row_t) = curr_project_id)\n            T.Range(\"B\" &amp; row_p &amp; \":D\" &amp; row_p).Copy R.Range(\"D\" &amp; row_r)\n            row_t = row_t + 1\n            row_r = row_r + 1\n        Wend\n        row_p = row_p + 1\n    Wend\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10886896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/584e762c9acace559b0772ded16ee8f2?s=128&d=identicon&r=PG&f=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/10886896/pascal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 1, "accepted_answer_id": 54101393, "answer_count": 1, "score": 1, "last_activity_date": 1547017837, "creation_date": 1546989294, "last_edit_date": 1547017837, "question_id": 54101100, "link": "https://stackoverflow.com/questions/54101100/building-a-to-do-list-with-vba-in-excel-how-to-insert-rows-dynamically", "title": "Building a To-Do List with vba in excel: How to insert rows dynamically?", "body": "<p>First of all: I'm really sorry if this has been answered before. I've looked and found nothing that quite helped me. I'm a newbie and very grateful for any help. </p>\n\n<p>My problem : I have a sheet with projects that all have individual IDs, and another sheet with tasks that have also have individual Task-ID's and the ID of the project they belong to. There are some tasks belonging to a project.</p>\n\n<p>What I want to do is automatically sorting the tasks under the project they belong to, similar to a normal to-do list. </p>\n\n<p><a href=\"https://imgur.com/a/oeUFUuE\" rel=\"nofollow noreferrer\">Here is an imgur gallery of example pictures</a>  </p>\n\n<p>Again, any help would be appreciated. Thank you.</p>\n"}, {"tags": ["excel", "vba", "for-loop"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1546988433, "post_id": 54100922, "comment_id": 95034844, "body": "You are testing the same thing each loop, the name of the range.  So you are going to get the same response each time."}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1546990268, "post_id": 54100922, "comment_id": 95035359, "body": "The first loop <code>For each nm in ActiveWorkbook.Names</code> is to make sure the code is only looking at the name objects on the sheet FHLBCL. I imagine there is a better way to do that but I couldn&#39;t figure it out."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1546995441, "post_id": 54100922, "comment_id": 95036601, "body": "Try using <code>Dim cell As Variant</code> if if that helps"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1547020487, "post_id": 54100922, "comment_id": 95043076, "body": "I am slightly confused as to what you want... What is <code>[CL_AllCells]</code>?"}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1547039297, "post_id": 54100922, "comment_id": 95053889, "body": "@SiddharthRout  <code>[Cl_AllCells]</code> is the named range that holds all of the cells that are going to be edited with a UserForm.  Basically all I want is any cell with a defined name that starts with &quot;FHLB&quot; gets a value of &quot;NA&quot;"}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1547043695, "post_id": 54100922, "comment_id": 95056546, "body": "I cant figure this out, so Ive decided to abandon it and just write a line of code for each cell that starts with &quot;FHLB&quot; and gives it a value of &quot;NA&quot; when the User Form loads.  Thank you all for your assistance."}], "owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1547039150, "creation_date": 1546988240, "last_edit_date": 1547039150, "question_id": 54100922, "link": "https://stackoverflow.com/questions/54100922/vba-to-set-cell-value-based-on-cells-defined-name", "title": "VBA to set cell value based on cell&#39;s defined name", "body": "<p>I am trying to set a cell's value to \"NA\" based on the name object of the cell.</p>\n\n<p><strong>Step 1:</strong>  Get Defined Names of cells in Labeled FHLB in worksheet named FHLBCL - this works just fine.<br>\n<strong>Step 2</strong>  Set the value of the Cell to \"NA\" based on <code>If Left(nm.Name, 5) = \"FHLB_\" Then Cell.Value=\"NA\"</code>.  This is the step that is causing every cell in a named range to get the value of \"NA\" and I cannot figure out why.</p>\n\n<p><strong>CODE:</strong></p>\n\n<pre><code>Sub NamedRanges()\n    Dim nm As Name\n    Dim cell As Range\n\n    For Each nm In ActiveWorkbook.Names\n        If Left(nm.RefersTo, 8) = \"=FHLBCL!\" Then\n            For Each cell In [CL_AllCells]\n                If Left(nm.Name, 5) = \"FHLB_\" Then\n                    cell.Value = \"NA\"\n                Debug.Print UCase(\"Cell Name\") &amp; \": \" &amp; nm.Name &amp; \" and \" &amp; UCase(\"Refers to Cell\") &amp; \": \" &amp; nm.RefersTo\n                End If\n            Next cell\n        End If\n    Next nm\n\nEnd Sub\n</code></pre>\n\n<p>Thank you for your assistance.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11, "user_id": 10813040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73230d1e1193be51f1cf9eaefbe134b7?s=128&d=identicon&r=PG&f=1", "display_name": "Coding for a Cause", "link": "https://stackoverflow.com/users/10813040/coding-for-a-cause"}, "edited": false, "score": 0, "creation_date": 1546986807, "post_id": 54100675, "comment_id": 95034284, "body": "I failed to dimension doIt as  variant in the above example. The code had to be changed sorry."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1546986857, "post_id": 54100675, "comment_id": 95034313, "body": "Did that fix your problem?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1546989968, "post_id": 54100675, "comment_id": 95035281, "body": "Don&#39;t use globals to pass values between different methods - this is what parameters are for.  Unnecessary globals quickly lead to problems."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10813040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73230d1e1193be51f1cf9eaefbe134b7?s=128&d=identicon&r=PG&f=1", "display_name": "Coding for a Cause", "link": "https://stackoverflow.com/users/10813040/coding-for-a-cause"}, "edited": false, "score": 0, "creation_date": 1547059564, "post_id": 54101208, "comment_id": 95065693, "body": "The above was very helpful in getting past the RTE-13 issue."}, {"owner": {"reputation": 11, "user_id": 10813040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73230d1e1193be51f1cf9eaefbe134b7?s=128&d=identicon&r=PG&f=1", "display_name": "Coding for a Cause", "link": "https://stackoverflow.com/users/10813040/coding-for-a-cause"}, "edited": false, "score": 0, "creation_date": 1547059777, "post_id": 54101208, "comment_id": 95065775, "body": "&#39;Sub wdUpdateDataInText()  Dim cc As Word.ContentControls &#39; As Object if late-binding is used Dim evalData(0 To 2) As Variant &#39;changed to 2 and linked tables by hand evalData(0) = &quot; bidder&quot; evalData(1) = &quot; GTEP&quot; evalData(2) = &quot; delta&quot; &#39;evalData(3) = &quot; TABLE&quot;  Dim j As Variant Dim i As Integer i = 4     For Each j In evalData         With Word.Application.Documents(wdDocReport)         .SelectContentControlsByTitle(ControlThis &amp; j).Item(1).Range.Text = xlEvalSheet.Cells(5, i).Value         .Save         End With     Next End Sub&#39;"}, {"owner": {"reputation": 11, "user_id": 10813040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73230d1e1193be51f1cf9eaefbe134b7?s=128&d=identicon&r=PG&f=1", "display_name": "Coding for a Cause", "link": "https://stackoverflow.com/users/10813040/coding-for-a-cause"}, "edited": false, "score": 0, "creation_date": 1547060220, "post_id": 54101208, "comment_id": 95065953, "body": "Now I am receiving a compile error: Argument not found.   the debugger highlights the &#39;Sub doStuff(ContractLineItemNumber As Variant)&#39;  It seems that the &#39;doStuff Array(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;)&#39; may not be doing what we want..."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 11, "user_id": 10813040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73230d1e1193be51f1cf9eaefbe134b7?s=128&d=identicon&r=PG&f=1", "display_name": "Coding for a Cause", "link": "https://stackoverflow.com/users/10813040/coding-for-a-cause"}, "edited": false, "score": 0, "creation_date": 1547060884, "post_id": 54101208, "comment_id": 95066266, "body": "Please update your question if you want to add information - I can&#39;t read your code in a comment..."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1546990143, "creation_date": 1546990143, "answer_id": 54101208, "question_id": 54100675, "link": "https://stackoverflow.com/questions/54100675/two-different-arrays-feeding-one-subroutine-produced-rte-13-type-mismatch-with/54101208#54101208", "title": "Two different arrays feeding one subroutine produced RTE-13 &#39;Type Mismatch&#39; with Excel VBA", "body": "<p>Don't use globals to pass values between different methods - this is what parameters are for. Unnecessary globals quickly lead to problems. </p>\n\n<pre><code>Sub CommandButton1_Click()\n    DoStuff Array(\"Bobby\",\"Jane\",\"Lord Winter\",\"Jose\")\nEndSub\n\nSub CommandButton2_Click\n    DoStuff Array(\"Fluffy\", \"Fido\", \"Dog\")\nEnd Sub\n\nSub DoStuff(thisList As Variant)\n\n   'use thisList\n\nEnd sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10813040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73230d1e1193be51f1cf9eaefbe134b7?s=128&d=identicon&r=PG&f=1", "display_name": "Coding for a Cause", "link": "https://stackoverflow.com/users/10813040/coding-for-a-cause"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1547017890, "creation_date": 1546986652, "last_edit_date": 1547017890, "question_id": 54100675, "link": "https://stackoverflow.com/questions/54100675/two-different-arrays-feeding-one-subroutine-produced-rte-13-type-mismatch-with", "title": "Two different arrays feeding one subroutine produced RTE-13 &#39;Type Mismatch&#39; with Excel VBA", "body": "<p>This is a small example of my problem\nI have two buttons I push to run an analysis.\nButton 1 has a list of 4 people\nButton 2 has a list of 3 animals\nI cannot mix the lists or my analysis will have errors.</p>\n\n<p>Previously, I had good code. \nWhen I needed to change things it was getting hard to maintain.\nI moved it into subroutines for good configuration management.\nUnfortunately, I have difficulty passing certain variables between subroutines</p>\n\n<p>After doing some research I succeeded in making several variables public. The Variant seems to be special. Any suggestions?</p>\n\n<pre><code>Public thisList As Variant \nPublic xlEvalSheet As Worksheet\n\nSub CommandButton1_Click()\n    thisList(1) = \"Bobby\"\n    thisList(2) = \"Jane\"\n    thisList(3) = \"Lord Winter\"\n    thisList(4) = \"Jose\"\nCall DoStuff\nEndSub\n\nSub CommandButton2_Click\n    thisList(1) = \"Fluffy\"\n    thisList(2) = \"Fido\"\n    thisList(3) = \"Dog\"\nCall DoStuff\nEnd Sub\n\nSub DoStuff()\n    Dim k Ks Variant\n    Dim counterTemple as Integer\n    Dim evalTables (0 to 3) as Variant\nevalTables(0)= \"EvalTable1.xlsx\"\nevalTables(1)= \"EvalTable2.xlsx\"\nevalTables(2)= \"EvalTable3.xlsx\"\nevalTables(3)= \"EvalTable4.xlsx\"\n    For Each doIt in evalTables\n    strEvalTable = NetworkLocation &amp; doIt\n        counterTemple = 3 ' used inside the wdUpdateDataInText \n\n        For Each k In thisList\n        controlThis = k &amp; \"-\" &amp; counterTemple  'passes a string to the wdApp.contentcontrol\n            xlEvalSheet.Rows.Hidden = False\n            xlEvalSheet.Cells(1, 4).Value = k  'initialize k\n            xlEvalSheet.Calculate\n            DoEvents\n                Call wdUpdateDataInText 'this feeds data to MS Word ContentControls\n\n            currentDifference = xlEvalSheet.Cells(5, 6).Value  'stop blank tables from being produced\n            If currentDifference = 0 Then  \n                Else\n                Call PDFcrate 'produces tables as PDFs with FixedFormatExport \n            End If\n         Next  'repeats for each tab with name \"k\" in the workbooks\n     xlEval.Close\n     counterTemple = counterTemple + 1\n    next\nEnd Sub`\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1546984960, "post_id": 54100232, "comment_id": 95033616, "body": "Why don&#39;t you just do a <code>Find&#47;Replace</code> to get rid of all the decimal points, then just autofill the blanks in column A with what&#39;s above them?"}, {"owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "edited": false, "score": 0, "creation_date": 1546986993, "post_id": 54100232, "comment_id": 95034362, "body": "Have you ever used Power Query?"}, {"owner": {"reputation": 13, "user_id": 10886561, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Jpr7uncsoQ4/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcad8Y5XK50BvO74KWfGfYabaB4nHQ/mo/photo.jpg?sz=128", "display_name": "Yeti6916", "link": "https://stackoverflow.com/users/10886561/yeti6916"}, "edited": false, "score": 0, "creation_date": 1546987229, "post_id": 54100232, "comment_id": 95034440, "body": "I don&#39;t know what Power Query is. I was not exaggerating when I stated I basically have little to no excel/vba experience outside of very basic formulas (like sum)."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10886561, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Jpr7uncsoQ4/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcad8Y5XK50BvO74KWfGfYabaB4nHQ/mo/photo.jpg?sz=128", "display_name": "Yeti6916", "link": "https://stackoverflow.com/users/10886561/yeti6916"}, "edited": false, "score": 0, "creation_date": 1546985818, "post_id": 54100410, "comment_id": 95033928, "body": "I&#39;m not sure what these formulas are supposed to be doing. Could you elaborate on how they are supposed to work to create my desired outcome?"}], "tags": [], "owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "is_accepted": false, "score": 0, "last_activity_date": 1546988414, "last_edit_date": 1546988414, "creation_date": 1546985029, "answer_id": 54100410, "question_id": 54100232, "link": "https://stackoverflow.com/questions/54100232/copy-sheet-rows-to-new-sheet-based-on-split-cell-text/54100410#54100410", "title": "Copy Sheet Rows to New Sheet Based on Split Cell Text", "body": "<p>You can do this with two formulas.</p>\n\n<p>I'm assuming your data is in <code>Sheet1</code>.</p>\n\n<p>For the first columns, use the following formula:</p>\n\n<pre><code>=IF(ISBLANK(Sheet1!A2),A1,Sheet1!A2)\n</code></pre>\n\n<p>For the second one use:</p>\n\n<pre><code>=IFERROR(RIGHT(Sheet1!B2,LEN(Sheet1!B2)-FIND(\". \",Sheet1!B2)-1),Sheet1!B2)\n</code></pre>\n\n<p>And populate down.</p>\n\n<p>edit:</p>\n\n<p>The first formula will look at the corresponding cell in <code>Sheet1, column A</code>. If it is blank, it will take the value of the cell above where the formula is. If it isn't blank, it will take the value of the cell in <code>Sheet1, column A</code> that it just checked.</p>\n\n<p>The second formula looks for the string <code>\". \"</code> in the cells in <code>Sheet1 column B</code> and removes it and everything to the left of it from the text. If the string in question (<code>\". \"</code>) is not found (meaning there is no numbering in that given cell) it would return an error, so the whole thing is wrapped in an <code>IFERROR</code> statement which returns the value of the cell in <code>Sheet1 column B</code> if it is triggered.</p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 10886561, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Jpr7uncsoQ4/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcad8Y5XK50BvO74KWfGfYabaB4nHQ/mo/photo.jpg?sz=128", "display_name": "Yeti6916", "link": "https://stackoverflow.com/users/10886561/yeti6916"}, "edited": false, "score": 0, "creation_date": 1547045227, "post_id": 54101077, "comment_id": 95057590, "body": "This seems like what I could be looking for. Could you elaborate on the code VBasic2008? I like to also try and understand how the code is working instead of just using copy/paste."}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1547055157, "post_id": 54101077, "comment_id": 95063766, "body": "Excel 2003? Seriously?"}, {"owner": {"reputation": 13, "user_id": 10886561, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Jpr7uncsoQ4/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcad8Y5XK50BvO74KWfGfYabaB4nHQ/mo/photo.jpg?sz=128", "display_name": "Yeti6916", "link": "https://stackoverflow.com/users/10886561/yeti6916"}, "edited": false, "score": 0, "creation_date": 1547074284, "post_id": 54101077, "comment_id": 95071623, "body": "@VBasic2008: Thanks for the updated code with comments. I haven&#39;t been able to try it because more important matters came up, but if it works I&#39;ll mark the answer accordingly."}, {"owner": {"reputation": 13, "user_id": 10886561, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Jpr7uncsoQ4/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcad8Y5XK50BvO74KWfGfYabaB4nHQ/mo/photo.jpg?sz=128", "display_name": "Yeti6916", "link": "https://stackoverflow.com/users/10886561/yeti6916"}, "edited": false, "score": 0, "creation_date": 1547150960, "post_id": 54101077, "comment_id": 95103903, "body": "@VBasic2008: I implemented a version of your code that works perfectly well to copy the data in one sheet to the other, but I have an issue with how the split is happening. The split can&#39;t happen on vbLf. It needs to use a regular expression that would match the decimal and dot at the start of each sentence in a numbered list. How would I do that?"}], "tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": true, "score": 0, "last_activity_date": 1547048506, "last_edit_date": 1547048506, "creation_date": 1546989053, "answer_id": 54101077, "question_id": 54100232, "link": "https://stackoverflow.com/questions/54100232/copy-sheet-rows-to-new-sheet-based-on-split-cell-text/54101077#54101077", "title": "Copy Sheet Rows to New Sheet Based on Split Cell Text", "body": "<h1>Split Multi Line</h1>\n\n<p><a href=\"https://i.stack.imgur.com/XX5iw.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XX5iw.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>It is unclear which line separator occurs in the multi line cells. Choose one, <strong>vbLf</strong> worked for me.</p>\n\n<p>Adjust the values in the constants section to fit your needs.</p>\n\n<h2>The Code</h2>\n\n<pre><code>Sub SplitMultiLine()\n\n    Const cSheet1 As Variant = \"Sheet1\"   ' Source Worksheet Name/Index\n    Const cFirstR As Integer = 1          ' Source First Row Number\n    Const cFirstC As Variant = \"A\"        ' Source First Column Letter/Number\n    Const cLastC As Variant = \"C\"         ' Source Last Column Letter/Number\n    Const cMulti As Integer = 2           ' Multi Column\n    Const cSplit As String = vbLf         ' Split Char(vbLf, vbCrLf, vbCr)\n    Const cDot As String = \".\"            ' Dot Char (Delimiter)\n\n    Const cSheet2 As Variant = \"Sheet1\"   ' Target Worksheet Name/Index\n    Const cTarget As String = \"E1\"        ' Target First Cell Address\n\n    Dim vntS As Variant       ' Source Array\n    Dim vntSplit As Variant   ' Split Array\n    Dim vntT As Variant       ' Target Array\n    Dim lastR As Long         ' Source Last Row\n    Dim i As Long             ' Source Array Row Counter\n    Dim j As Integer          ' Source/Target Array Column Counter\n    Dim k As Long             ' Target Array Row Counter\n    Dim m As Integer          ' Split Array Row Counter\n\n    ' Paste Source Range into Source Array.\n    With Worksheets(cSheet1)\n        lastR = .Cells(.Rows.Count, cFirstC).End(xlUp).Row\n        vntS = .Range(.Cells(cFirstR, cFirstC), .Cells(lastR, cLastC))\n    End With\n\n    ' Count the number of rows in target array.\n    For i = 1 To UBound(vntS)\n        k = k + UBound(Split(vntS(i, cMulti), cSplit)) + 1\n    Next\n\n    ' Write from Source to Target Array.\n    ReDim vntT(1 To k, 1 To UBound(vntS, 2))\n    k = 0\n    For i = 1 To UBound(vntS)\n        k = k + 1\n        vntSplit = Split(vntS(i, cMulti), cSplit)\n        For m = 0 To UBound(vntSplit)\n            If InStr(vntSplit(m), cDot) &gt; 0 Then\n                vntT(k, cMulti) = Trim(Right(vntSplit(m), Len(vntSplit(m)) _\n                        - InStr(vntSplit(m), cDot)))\n              Else\n                vntT(k, cMulti) = vntSplit(m)\n            End If\n            For j = 1 To UBound(vntS, 2)\n                If j &lt;&gt; cMulti Then\n                    vntT(k, j) = vntS(i, j)\n                End If\n            Next\n            k = k + 1\n        Next\n        k = k - 1\n    Next\n\n    ' Paste Target Array into Target Range calculated from Target Frist Cell.\n    With Worksheets(cSheet2).Range(cTarget)\n        .Resize(UBound(vntT), UBound(vntT, 2)) = vntT\n    End With\n\nEnd Sub\n</code></pre>\n\n<h2>An Over-Commenting</h2>\n\n<pre><code>Sub SplitMultiLineOverCommented()\n\n    Const cSheet1 As Variant = \"Sheet1\"   ' Source Worksheet Name/Index\n    Const cFirstR As Integer = 1          ' Source First Row Number\n    Const cFirstC As Variant = \"A\"        ' Source First Column Letter/Number\n    Const cLastC As Variant = \"C\"         ' Source Last Column Letter/Number\n    Const cMulti As Integer = 2           ' Multi Column\n    Const cSplit As String = vbLf         ' Split Char(vbLf, vbCrLf, vbCr)\n    Const cDot As String = \".\"            ' Dot Char (Delimiter)\n\n    Const cSheet2 As Variant = \"Sheet1\"   ' Target Worksheet Name/Index\n    Const cTarget As String = \"E1\"        ' Target First Cell Address\n\n    Dim vntS As Variant       ' Source Array\n    Dim vntSplit As Variant   ' Split Array\n    Dim vntT As Variant       ' Target Array\n    Dim lastR As Long         ' Source Last Row\n    Dim i As Long             ' Source Array Row Counter\n    Dim j As Integer          ' Source/Target Array Column Counter\n    Dim k As Long             ' Target Array Row Counter\n    Dim m As Integer          ' Split Array Row Counter\n\n    ' Paste Source Range into Source Array.\n    With Worksheets(cSheet1)\n        ' The last row of data is usually calculated going from the bottom up,\n        ' it is like selecting the last cell and pressing CTRL UP and returning\n        ' =ROW() in Excel.\n        lastR = .Cells(.Rows.Count, cFirstC).End(xlUp).Row\n        ' Paste a range into an array actually means copying it. The array\n        ' created is a 1-based 2-dimensional array which has the same number\n        ' of rows and columns as the Source Range.\n        vntS = .Range(.Cells(cFirstR, cFirstC), .Cells(lastR, cLastC))\n    End With\n\n    ' Count the number of rows in Target Array.\n    ' You refer to the last row of the array with UBound(vntS) which is short\n    ' for UBound(vntS, 1) which reveals that it is referring to the first\n    ' dimension (rows).\n    For i = 1 To UBound(vntS)\n        ' We are splitting the string by cSplit which is the line\n        ' separator (delimiter). When you enter something into a cell and\n        ' hold left Alt and press ENTER, the vbLf character is set in place\n        ' of the line separator. But the data may have been imported from\n        ' another system that uses another line separator. When splitting the\n        ' string, a 0-based array is 'created' and its UBound is the last\n        ' row, but since it is 0-based we have to add 1.\n        k = k + UBound(Split(vntS(i, cMulti), cSplit)) + 1\n    Next\n\n    ' Write from Source to Target Array.\n    ' After we have calculated the number of rows, we have to resize the\n    ' Target Array. To avoid confusion, I always use '1 To' to be certain that\n    ' it is a 1-based array. Since the number columns of the Source Array and\n    ' the Target Array is the same, we use the UBound of the Source Array to\n    ' resize the second dimension of the Target Array - UBound(vntS, 2) where\n    ' 2 is indicating the second dimension, columns.\n    ReDim vntT(1 To k, 1 To UBound(vntS, 2))\n    ' We will use again k as the row counter since its value is no more\n    ' needed. This is what I have many times forgotten, so maybe it is\n    ' better to use a different variable.\n    k = 0\n    ' Loop through the columns of Source Array.\n    For i = 1 To UBound(vntS)\n        ' Increase the row of Target Array or e.g. align it for writing.\n        k = k + 1\n        ' Split the string (lines) in the Multi Column into the 0-based\n        ' Split Array.\n        vntSplit = Split(vntS(i, cMulti), cSplit)\n        ' Loop through the values of the Split Array\n        For m = 0 To UBound(vntSplit)\n            ' Check if value contains cDot. The Instr function returns 0 if\n            ' a string has not been found, it's like =FIND(\".\",A1) in Excel,\n            ' except that Excel would return an error if not found.\n            If InStr(vntSplit(m), cDot) &gt; 0 Then\n                ' If cDot was found then write the right part after cDot\n                ' to the current row of column cMulti but trim the result\n                ' (remove space before and after.\n                ' It's like =TRIM(RIGHT(A1,LEN(A1)-FIND(\".\",A1))) in Excel.\n                vntT(k, cMulti) = Trim(Right(vntSplit(m), Len(vntSplit(m)) _\n                        - InStr(vntSplit(m), cDot)))\n              Else\n                ' If cDot was not found then just write the value to the\n                ' current row.\n                vntT(k, cMulti) = vntSplit(m)\n            End If\n            ' Loop through all columns.\n            For j = 1 To UBound(vntS, 2)\n                If j &lt;&gt; cMulti Then\n                    ' Write to other columns (Not cMulti)\n                    vntT(k, j) = vntS(i, j)\n                End If\n            Next ' Next Source/Target Array Column\n            ' Increase the current row of Target Array before going to next\n            ' value in Split Array.\n            k = k + 1\n        Next ' Next Split Array Row\n        ' Since we have increased the last current row but haven't written to\n        ' it, we have to decrease one row because of the \"k = k + 1\" right below\n        ' \"For i = 1 To UBound(vntS)\" which increases the row of Target Array\n        ' for each next row in Source Array.\n        k = k - 1\n    Next ' Next Source Array Row\n\n    ' Paste Target Array into Target Range calculated from Target Frist Cell.\n    ' Like we pasted a range into an array, we can also paste an array into\n    ' a range, but it has to be the same size as the array, so by using\n    ' the Resize method we adjust the Target Range First Cell to the Target\n    ' Range, using the last row and column of the Target Array. Again,\n    ' remember UBound(vntT) is short for UBound(vntT, 1) (rows).\n    With Worksheets(cSheet2).Range(cTarget)\n        .Resize(UBound(vntT), UBound(vntT, 2)) = vntT\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10886561, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Jpr7uncsoQ4/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcad8Y5XK50BvO74KWfGfYabaB4nHQ/mo/photo.jpg?sz=128", "display_name": "Yeti6916", "link": "https://stackoverflow.com/users/10886561/yeti6916"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 54101077, "answer_count": 2, "score": 1, "last_activity_date": 1547048506, "creation_date": 1546984169, "last_edit_date": 1546985892, "question_id": 54100232, "link": "https://stackoverflow.com/questions/54100232/copy-sheet-rows-to-new-sheet-based-on-split-cell-text", "title": "Copy Sheet Rows to New Sheet Based on Split Cell Text", "body": "<p>I have a problem I need help with involving Excel and VBA. I know next to nothing about Excel/VBA, and I need a coding solution to help me avoid performing the extremely tedious task of doing this manually (think hundreds of lines that need to be parsed where one row could become multiple rows in a new sheet). I've been searching the web for solutions, but I just keep getting confused by the answers (because I don't know anything about VB and using it to program a macro in Excel), so I figured I'd seek help for my specific problem.</p>\n\n<p>Here is the rundown: I have a spreadsheet where I need to copy rows from a source sheet to a target sheet. The source sheet has 2 columns (A &amp; B) that can be thought of as a key/value pair where col A contains the key and col B contains the value. The problem lies with the values in col B. The values can either be a single line of text or a numbered list of different texts</p>\n\n<p>What I want to do is for each row in the source:</p>\n\n<ul>\n<li>split the values in col B to get an array of each individual value (if the value is in the form of a numbered list)</li>\n<li>create new rows in the target sheet by looping over the split array of values such that a new row will be created where:\nnew row col A = source row col A key and new row col B = current iteration index from the array of split values.</li>\n<li>if no numbered list, just copy the source row into target sheet</li>\n</ul>\n\n<p>Source</p>\n\n<p><code>\n    A     B\n    key1  1. text1\n          2. text2\n    key2  1. text3\n</code></p>\n\n<p>Target</p>\n\n<p><code>\n    A     B\n    key1  text1\n    key1  text2\n    key2  text3\n</code></p>\n\n<p>The numbered list in a cell will be multiple lines where each line of text is prepended by a decimal and a dot. This applies to single line cells as well.</p>\n\n<p>(Update) Bear in mind that the values in either col A or B are not simple text values. These are full on sentences. So, I'm not sure a simple formula is going to work.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 72, "user_id": 10821072, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-n3JVp7YWGQY/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYFXnUK5Hv6BMoruvKO5nMTrt76qw/mo/photo.jpg?sz=128", "display_name": "Michael Smith", "link": "https://stackoverflow.com/users/10821072/michael-smith"}, "edited": false, "score": 0, "creation_date": 1547041911, "post_id": 54100355, "comment_id": 95055434, "body": "Thanks so much for this. Can you explain the rationale behind the two On Error lines?  The typos were just me being a novice. :)"}, {"owner": {"reputation": 72, "user_id": 10821072, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-n3JVp7YWGQY/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYFXnUK5Hv6BMoruvKO5nMTrt76qw/mo/photo.jpg?sz=128", "display_name": "Michael Smith", "link": "https://stackoverflow.com/users/10821072/michael-smith"}, "edited": false, "score": 0, "creation_date": 1547042263, "post_id": 54100355, "comment_id": 95055661, "body": "I deactivated the On Error lines, and I&#39;m getting a subscript error (9) on the line: <code>FindRow = SearchRange.Find(What:=PINamesArray(x)).Row</code>. Thoughts?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 72, "user_id": 10821072, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-n3JVp7YWGQY/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYFXnUK5Hv6BMoruvKO5nMTrt76qw/mo/photo.jpg?sz=128", "display_name": "Michael Smith", "link": "https://stackoverflow.com/users/10821072/michael-smith"}, "edited": false, "score": 0, "creation_date": 1547043960, "post_id": 54100355, "comment_id": 95056724, "body": "You have to leave the on error lines- they&#39;re in case the find returns no results."}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": false, "score": 0, "last_activity_date": 1546984755, "creation_date": 1546984755, "answer_id": 54100355, "question_id": 54100189, "link": "https://stackoverflow.com/questions/54100189/how-to-find-each-item-in-a-column-in-a-delimited-list-from-a-userform-textbox/54100355#54100355", "title": "How to find each item in a column in a delimited list from a UserForm textbox", "body": "<p>Give this a shot - I had to change some variables around (and fix a lot of weird typos you had going on), but this worked in my testing:</p>\n\n<pre><code>Option Explicit\nPrivate Sub CommandButton1_Click()\n\nDim x As Long, ERow As Long\nDim PINamesArray As Variant\nDim size As Long\nDim SearchRange As Range\nDim FindRow As Long\n\nSet SearchRange = Range(\"D5:D2000\")\nERow = 1\n\nPINamesArray = Split(Me.PINames, \"; \")\n\nsize = UBound(PINamesArray) - LBound(PINamesArray) + 1\n\nFor x = 1 To size\n\n    On Error Resume Next\n    FindRow = SearchRange.Find(What:=PINamesArray(x)).Row\n    On Error GoTo 0\n\n    If FindRow &lt;&gt; 0 Then\n        Rows(FindRow).Copy\n        Worksheets(\"Dropped-NotSelected\").Cells(ERow, 1).PasteSpecial\n        ERow = ERow + 1\n        Rows(FindRow).Delete Shift:=xlShiftUp\n    End If\n\nNext x\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 72, "user_id": 10821072, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-n3JVp7YWGQY/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYFXnUK5Hv6BMoruvKO5nMTrt76qw/mo/photo.jpg?sz=128", "display_name": "Michael Smith", "link": "https://stackoverflow.com/users/10821072/michael-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1546984755, "creation_date": 1546983936, "question_id": 54100189, "link": "https://stackoverflow.com/questions/54100189/how-to-find-each-item-in-a-column-in-a-delimited-list-from-a-userform-textbox", "title": "How to find each item in a column in a delimited list from a UserForm textbox", "body": "<p>I'm creating a UserForm with a textbox that the user will fill in with a list of names delimited by \"; \". These names are found in Column D on my sheet. For each name, I'd like to copy and paste the whole row to another sheet and then delete the row in the original sheet. I am running into a couple of roadblocks that I haven't been able to solve.  </p>\n\n<pre><code>Private Sub OK_Click()\n\nApplication.Volatile\n\nDim x As Integer\nDim PINamesArray As String\nDim size As Long\nDim SearchRange As Range\nDim FindRow As Range\n\nSet SearchRange = Range(\"D5\", Range(\"D2000\").End(xlUp))\n\n\nPINamesArray = Split(Me.PINames, \"; \")\n\nsize = UBound(PINamesArray) - LBound(PINamesArray) + 1\n\nFor x = 1 To size\n\nSet FindRow = SearchRange.Find(x, LookIn:=xlValues, LookAt:=xlWhole)\n\nFindRow.Row\nRTBM = FindRow.Row\nRTBM.Copy\n.Paste Worksheets(\"Dropped-NotSelected\").Cells(ERow, 1)\nRTBM.Delete Shift:xlShiftUp\n\n\nEnd Sub\n</code></pre>\n\n<ol>\n<li>I want the Find function to look for the item in the delimited list that corresponds to that integer, not the integer itself.</li>\n<li>I know that there are probably multiple aspects of this code that aren't right, but I'm having trouble finding good examples to base off of.</li>\n</ol>\n"}, {"tags": ["excel", "vba", "shapes"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1546983799, "post_id": 54100081, "comment_id": 95033130, "body": "What is <code>.DrawingObject</code> and what is a <code>.Formula</code> in this context? More importantly, what is the Error you are getting? Could it be &quot;Application defined or object-defined error&quot; (like your <code>sh</code> doesn&#39;t have a <code>DrawingObject</code>)?"}, {"owner": {"reputation": 45, "user_id": 9765819, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211835480229822/picture?type=large", "display_name": "Farid Farmani", "link": "https://stackoverflow.com/users/9765819/farid-farmani"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1546984376, "post_id": 54100081, "comment_id": 95033376, "body": "The formula is something like &quot;=IMAGE1&quot;. The image is a name which is defined previously. drawingobject is the picture which is pasted as a drawingobject. I just don`t know how to call the shape which is placed inside a range without using its name."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1546995692, "post_id": 54100081, "comment_id": 95036657, "body": "Are you pasting the shape via code?  If Yes then it right after the paste you can use <code>Set sh = ActiveSheet.Shapes(ActiveSheet.Shapes.Count)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1205, "user_id": 8578580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a063b2c15a5847791ed1e0007d04b8c0?s=128&d=identicon&r=PG&f=1", "display_name": "TechnoDabbler", "link": "https://stackoverflow.com/users/8578580/technodabbler"}, "is_accepted": true, "score": 0, "last_activity_date": 1546991201, "last_edit_date": 1546991201, "creation_date": 1546989931, "answer_id": 54101175, "question_id": 54100081, "link": "https://stackoverflow.com/questions/54100081/how-to-assign-formula-to-an-anonymous-shape/54101175#54101175", "title": "How to assign formula to an anonymous shape?", "body": "<p>You can't identify a shape by using a range reference directly. What this example does is to look though all the shapes in a designated sheet ... and it finds the first shape where the top left corner of the shape is in the cell specified (ie. C2 for this example) ... and it returns that shape so that a formula can be assigned to it (in this example \"=B1\"). You should be able to take this and extend it for what you're trying to do. </p>\n\n<pre><code>Option Explicit\n\nPublic Sub AssignShapeFormulaExample()\n    Dim vShape As Shape\n    Dim vRange As Range\n    Dim vSheet As Worksheet\n\n    ' Setup objects for the active sheet and an example cell (where a shape exists)\n    Set vSheet = ActiveSheet\n    Set vRange = vSheet.Range(\"C2\")\n\n    Set vShape = FirstShapeInCell(vSheet, vRange)\n\n    If Not (vShape Is Nothing) Then\n        vShape.DrawingObject.Formula = \"=B1\"\n    End If\n\nEnd Sub\n\nFunction FirstShapeInCell(vSheet As Worksheet, vRange As Range) As Shape\n    Dim vShape As Shape\n    Dim vShapeTopLeft As Range\n    Dim vIntersect As Range\n\n    ' Loop though all shapes in the designated sheet\n    For Each vShape In vSheet.Shapes\n        ' Setup a range that contains the top left corner of the shape\n        With vShape\n            Set vShapeTopLeft = vSheet.Cells(.TopLeftCell.Row, .TopLeftCell.Column)\n        End With\n        'See whether the shape in the range specified as an input parameter\n        Set vIntersect = Application.Intersect(vRange, vShapeTopLeft)\n        If Not (vIntersect Is Nothing) Then\n            Set FirstShapeInCell = vShape\n            Exit Function\n        End If\n    Next\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 9765819, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211835480229822/picture?type=large", "display_name": "Farid Farmani", "link": "https://stackoverflow.com/users/9765819/farid-farmani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 54101175, "answer_count": 1, "score": 0, "last_activity_date": 1547017899, "creation_date": 1546983455, "last_edit_date": 1547017899, "question_id": 54100081, "link": "https://stackoverflow.com/questions/54100081/how-to-assign-formula-to-an-anonymous-shape", "title": "How to assign formula to an anonymous shape?", "body": "<p>I'm trying to assign a formula to an object but I'm getting errors every time. The main point is that each time I am copying an image I need to assign a formula to the newly posted item. Indeed, I don`t have a specific shape name for it so I can use. Any suggestions?</p>\n\n<pre><code>  Dim sh As Shape\n  Set sh = ActiveSheet.range(\"A\" &amp; Last_row ).Shape\n  sh.DrawingObject.Formula = \"=IMAGE\" &amp; Last_row \n</code></pre>\n"}, {"tags": ["excel", "vba", "validation"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1546985131, "post_id": 54100074, "comment_id": 95033674, "body": "Are you on Windows? That should be a backslash if yes."}, {"owner": {"reputation": 11, "user_id": 10146497, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155554333406911/picture?type=large", "display_name": "Sasha Twiggy", "link": "https://stackoverflow.com/users/10146497/sasha-twiggy"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1546986382, "post_id": 54100074, "comment_id": 95034133, "body": "@dwirony I&#39;m on a mac. Should it still be a backslash?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1546986724, "post_id": 54100074, "comment_id": 95034252, "body": "No a forward slash is correct then. I don&#39;t understand what you&#39;re trying to do here - what purpose does <code>c</code> serve in your <code>For Each</code> loop?"}, {"owner": {"reputation": 11, "user_id": 10146497, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155554333406911/picture?type=large", "display_name": "Sasha Twiggy", "link": "https://stackoverflow.com/users/10146497/sasha-twiggy"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1546987081, "post_id": 54100074, "comment_id": 95034390, "body": "@dwirony the c is supposed to represent each of the options in the data validation dropdown"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10146497, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155554333406911/picture?type=large", "display_name": "Sasha Twiggy", "link": "https://stackoverflow.com/users/10146497/sasha-twiggy"}, "edited": false, "score": 0, "creation_date": 1546991396, "post_id": 54100798, "comment_id": 95035651, "body": "This works! Thank you very much! So I basically needed to reset the c value within the for loop? Is that correct?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 11, "user_id": 10146497, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155554333406911/picture?type=large", "display_name": "Sasha Twiggy", "link": "https://stackoverflow.com/users/10146497/sasha-twiggy"}, "edited": false, "score": 0, "creation_date": 1546994205, "post_id": 54100798, "comment_id": 95036323, "body": "Sort of - you were iterating through a collection of the data validation items, but you needed to actually change the cell&#39;s value each time in your loop."}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": true, "score": 0, "last_activity_date": 1546987501, "creation_date": 1546987501, "answer_id": 54100798, "question_id": 54100074, "link": "https://stackoverflow.com/questions/54100074/excel-vba-loop-through-data-validation-options-and-save-as-new-workbook/54100798#54100798", "title": "Excel VBA loop through data validation options and save as new workbook", "body": "<p>Try this:</p>\n\n<pre><code>Sub loopthroughvalidationlist()\n\nDim inputRange As Range\nDim c As Range\nSet inputRange = Evaluate(Range(\"N12\").Validation.Formula1)\n\nFor Each c In inputRange\n    Cells(12, \"N\").Value = c.Value\n    Dim s As String\n    s = Cells(12, \"N\").Value &amp; \"postran\"\n    ActiveWorkbook.SaveCopyAs ThisWorkbook.Path &amp; \"/\" &amp; s\nNext c\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10146497, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155554333406911/picture?type=large", "display_name": "Sasha Twiggy", "link": "https://stackoverflow.com/users/10146497/sasha-twiggy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 511, "favorite_count": 0, "accepted_answer_id": 54100798, "answer_count": 1, "score": 0, "last_activity_date": 1547017906, "creation_date": 1546983379, "last_edit_date": 1547017906, "question_id": 54100074, "link": "https://stackoverflow.com/questions/54100074/excel-vba-loop-through-data-validation-options-and-save-as-new-workbook", "title": "Excel VBA loop through data validation options and save as new workbook", "body": "<p>I have a workbook with multiple sheets. For this project I am focusing in on one sheet called \"Report 3\".  On this sheet, there is a data validation cell (\"N12\"), populated by values on a different sheet.</p>\n\n<p>My goal is to loop through all possible values of the data validation cell and save each of these as a new workbook.  If possible, I would like to save it as a utf-16 txt file (but I haven't gotten that far in my code).  </p>\n\n<p>Here is the code I have so far. It works, but only for the first value of the data validation. My hunch is that it is getting tripped up on ActiveWorkbook.  </p>\n\n<p>I appreciate any insight and assistance.</p>\n\n<pre><code>Sub loopthroughvalidationlist()\n\nDim inputRange As Range\nDim c As Range\nSet inputRange = Evaluate(Range(\"N12\").Validation.Formula1)\n\nFor Each c In inputRange\n    Dim s As String\n    s = Cells(12, \"N\").Value &amp; \"postran\"\n    ActiveWorkbook.SaveCopyAs ThisWorkbook.Path &amp; \"/\" &amp; s\nNext c\n\nEnd Sub \n</code></pre>\n"}, {"tags": ["excel", "vba", "events", "automation", "worksheet"], "comments": [{"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 2, "creation_date": 1546982249, "post_id": 54099807, "comment_id": 95032483, "body": "Please share the two code snippets which work independently, and we will help you to put them together."}, {"owner": {"reputation": 79, "user_id": 9828454, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Assaf", "link": "https://stackoverflow.com/users/9828454/assaf"}, "reply_to_user": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1546984216, "post_id": 54099807, "comment_id": 95033293, "body": "just added them! thanks!"}, {"owner": {"reputation": 266, "user_id": 10860682, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1p8ShEHvmxM/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYrC6ksVVo648mB97KGqwtUjVNJrA/mo/photo.jpg?sz=128", "display_name": "RCL", "link": "https://stackoverflow.com/users/10860682/rcl"}, "edited": false, "score": 0, "creation_date": 1546984639, "post_id": 54099807, "comment_id": 95033489, "body": "All columns are on the same Worksheet?"}, {"owner": {"reputation": 79, "user_id": 9828454, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Assaf", "link": "https://stackoverflow.com/users/9828454/assaf"}, "edited": false, "score": 0, "creation_date": 1546984844, "post_id": 54099807, "comment_id": 95033561, "body": "yes, same worksheet"}], "answers": [{"comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1546985570, "post_id": 54100414, "comment_id": 95033840, "body": "Be sure to add a check for cases where <code>Target</code> is not just a single cell."}, {"owner": {"reputation": 79, "user_id": 9828454, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Assaf", "link": "https://stackoverflow.com/users/9828454/assaf"}, "edited": false, "score": 0, "creation_date": 1546986157, "post_id": 54100414, "comment_id": 95034048, "body": "i think my code worked but then I changed it. It doesn&#39;t work now, can you spot maybe what i did wrong?"}, {"owner": {"reputation": 266, "user_id": 10860682, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1p8ShEHvmxM/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYrC6ksVVo648mB97KGqwtUjVNJrA/mo/photo.jpg?sz=128", "display_name": "RCL", "link": "https://stackoverflow.com/users/10860682/rcl"}, "edited": false, "score": 0, "creation_date": 1546986312, "post_id": 54100414, "comment_id": 95034104, "body": "Hi when you say your code are you talking about the original code in your question? Or the provided answer? Also I won&#39;t be able to spot what you did wrong without seeing what you changed."}, {"owner": {"reputation": 79, "user_id": 9828454, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Assaf", "link": "https://stackoverflow.com/users/9828454/assaf"}, "edited": false, "score": 0, "creation_date": 1546986508, "post_id": 54100414, "comment_id": 95034174, "body": "i&#39;m talking about the exact same one you posted. maybe we should avoid using Intersect? maybe the use of Application.EnableEvent is wrong?"}, {"owner": {"reputation": 266, "user_id": 10860682, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1p8ShEHvmxM/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYrC6ksVVo648mB97KGqwtUjVNJrA/mo/photo.jpg?sz=128", "display_name": "RCL", "link": "https://stackoverflow.com/users/10860682/rcl"}, "edited": false, "score": 0, "creation_date": 1546986763, "post_id": 54100414, "comment_id": 95034267, "body": "When you say it does not work what do you mean? Nothing is happening? You get an error? Or did you got an error when you changed something? If you get an error because you modified more than 1 cell in 1 go then the <code>application.EnableEvents</code> is probably still set to <code>false</code> Set it back to <code>True</code> if that is the case.."}, {"owner": {"reputation": 79, "user_id": 9828454, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Assaf", "link": "https://stackoverflow.com/users/9828454/assaf"}, "edited": false, "score": 0, "creation_date": 1546986882, "post_id": 54100414, "comment_id": 95034320, "body": "I changed only one cell at a time. and by saying it doesn&#39;t work i mean that nothing is happening"}, {"owner": {"reputation": 266, "user_id": 10860682, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1p8ShEHvmxM/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYrC6ksVVo648mB97KGqwtUjVNJrA/mo/photo.jpg?sz=128", "display_name": "RCL", "link": "https://stackoverflow.com/users/10860682/rcl"}, "edited": false, "score": 1, "creation_date": 1546987169, "post_id": 54100414, "comment_id": 95034413, "body": "On the immediate window type <code>Application.EnableEvents=True</code> or exit the application and try again. Also you are only entering values in Col B and Col J?"}, {"owner": {"reputation": 79, "user_id": 9828454, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Assaf", "link": "https://stackoverflow.com/users/9828454/assaf"}, "edited": false, "score": 0, "creation_date": 1546987706, "post_id": 54100414, "comment_id": 95034604, "body": "I wrote Application.EnableEvents=True on the immediate window and restarted excel and it works now. thank you. Immediate window executes what is written there without being related to the macro?"}, {"owner": {"reputation": 266, "user_id": 10860682, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1p8ShEHvmxM/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYrC6ksVVo648mB97KGqwtUjVNJrA/mo/photo.jpg?sz=128", "display_name": "RCL", "link": "https://stackoverflow.com/users/10860682/rcl"}, "edited": false, "score": 0, "creation_date": 1546987987, "post_id": 54100414, "comment_id": 95034708, "body": "Happy to help, If this answer or any other one solved your issue, please mark it as accepted. Also yes you can execute code in the immediate window. If you want to read about the difference I suggest have a look at this thread. <a href=\"https://stackoverflow.com/questions/350227/how-does-the-vba-immediate-window-differ-from-the-application-runtime\">Imediate Window</a>"}, {"owner": {"reputation": 79, "user_id": 9828454, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Assaf", "link": "https://stackoverflow.com/users/9828454/assaf"}, "edited": false, "score": 0, "creation_date": 1546992658, "post_id": 54100414, "comment_id": 95035963, "body": "one last question, do I have to use xlsm (macro enables) files or can I use xlsx files? (and then use personal macro workbook)"}, {"owner": {"reputation": 266, "user_id": 10860682, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1p8ShEHvmxM/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYrC6ksVVo648mB97KGqwtUjVNJrA/mo/photo.jpg?sz=128", "display_name": "RCL", "link": "https://stackoverflow.com/users/10860682/rcl"}, "reply_to_user": {"reputation": 79, "user_id": 9828454, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Assaf", "link": "https://stackoverflow.com/users/9828454/assaf"}, "edited": false, "score": 0, "creation_date": 1547022606, "post_id": 54100414, "comment_id": 95044032, "body": "@Assaf you can get a macro to Run on <code>.xlsx</code> files without saving it but when you save it you will need to save it as <code>.xlsm</code> so I suggest you use <code>.xlsm</code>"}, {"owner": {"reputation": 79, "user_id": 9828454, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Assaf", "link": "https://stackoverflow.com/users/9828454/assaf"}, "edited": false, "score": 0, "creation_date": 1547030216, "post_id": 54100414, "comment_id": 95048357, "body": "thank you. I really appreciate all your time and help"}], "tags": [], "owner": {"reputation": 266, "user_id": 10860682, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1p8ShEHvmxM/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYrC6ksVVo648mB97KGqwtUjVNJrA/mo/photo.jpg?sz=128", "display_name": "RCL", "link": "https://stackoverflow.com/users/10860682/rcl"}, "is_accepted": true, "score": 2, "last_activity_date": 1546985050, "creation_date": 1546985050, "answer_id": 54100414, "question_id": 54099807, "link": "https://stackoverflow.com/questions/54099807/excel-2-worksheets-events-with-different-targets/54100414#54100414", "title": "Excel 2 Worksheets Events with Different Targets", "body": "<p>Copy the code in the <code>Worksheet_Change</code> event and that should fix your issue. This will trigger every time you enter a value for any cell and will only meet the condition if they intersect the range in the if statement.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n   If Not Intersect(Target, Me.Range(\"B2:B3000\")) Is Nothing Then\n      Application.EnableEvents = False\n      Cells(Target.Row, Target.Column - 1) = Target.Row\n      Application.EnableEvents = True\n   End If\n\n   If Not Intersect(Target, Me.Range(\"J2:J3000\")) Is Nothing Then\n       Application.EnableEvents = False\n       Cells(Target.Row, Target.Column + 1) = Date\n       Application.EnableEvents = True\n   End If\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 9828454, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Assaf", "link": "https://stackoverflow.com/users/9828454/assaf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 54100414, "answer_count": 1, "score": 1, "last_activity_date": 1547032355, "creation_date": 1546982061, "last_edit_date": 1547032355, "question_id": 54099807, "link": "https://stackoverflow.com/questions/54099807/excel-2-worksheets-events-with-different-targets", "title": "Excel 2 Worksheets Events with Different Targets", "body": "<p>I have an excel worksheet that I want to assign to it more than one Worksheet Event.\nTo be more specific, I want whenever a cell in column B is changed then one cell to the left (column A) gets the row number.\nAlso I want whenever a cell in column J is changed then one cell to the right (column K) gets today's date.</p>\n\n<p>It worked for me for both of them individually but I think I may be doing something wrong using them together.</p>\n\n<p>Any help will be much appreciated!</p>\n\n<pre><code>Private Sub AG1(ByVal a_Target As Range)\n   If Not Intersect(a_Target, Me.Range(\"B2:B3000\")) Is Nothing Then\n      Application.EnableEvents = False\n      Cells(a_Target.Row, a_Target.Column - 1) = a_Target.Row\n      Application.EnableEvents = True\n   End If \nEnd Sub\n\n\n\n\nPrivate Sub AG2(ByVal b_Target As Range)\n   If Not Intersect(b_Target, Me.Range(\"J2:J3000\")) Is Nothing Then\n       Application.EnableEvents = False\n       Cells(b_Target.Row, b_Target.Column + 1) = Date\n       Application.EnableEvents = True\n   End If\nEnd Sub\n</code></pre>\n\n<p><strong>edit - works now (I also added that column can be referred as letter):</strong></p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n\nApplication.EnableEvents = True\n\n   If Split(Cells(1, Target.Column).Address(True, False), \"$\")(0) = \"B\" Then\n      Application.EnableEvents = False\n      Cells(Target.Row, Target.Column - 1) = Target.Row\n      Application.EnableEvents = True\n\n   ElseIf Split(Cells(1, Target.Column).Address(True, False), \"$\")(0) = \"J\" Then\n       Application.EnableEvents = False\n       Cells(Target.Row, Target.Column + 1) = Date\n       Application.EnableEvents = True\n   End If\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10886504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/337fbc7ad5e947788bd5b8d771f85071?s=128&d=identicon&r=PG&f=1", "display_name": "user10886504", "link": "https://stackoverflow.com/users/10886504/user10886504"}, "edited": false, "score": 0, "creation_date": 1546984543, "post_id": 54100127, "comment_id": 95033443, "body": "but they are each under individual if statements, so how do I do this keeping the if statements"}, {"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "edited": false, "score": 0, "creation_date": 1546985776, "post_id": 54100127, "comment_id": 95033912, "body": "@June7 If <code>Me.Filter4</code> is null, <code>SaleMonth</code> will match everything regardless of the value of <code>Me.Filter5</code>."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1546985855, "post_id": 54100127, "comment_id": 95033938, "body": "Yeah, edited my answer already, and then I see you went similar route as well. Do wonder if OP really wants or needs pattern matching and really should use = instead. I suspect the code continues to truncate the extra <code>AND </code>."}], "tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": true, "score": 0, "last_activity_date": 1546987445, "last_edit_date": 1546987445, "creation_date": 1546983639, "answer_id": 54100127, "question_id": 54099662, "link": "https://stackoverflow.com/questions/54099662/using-or-in-form-filters/54100127#54100127", "title": "Using OR in form filters", "body": "<p>Need a pair of parens around the two OR criteria (all those original parens are not necessary). Which means you will need some more conditional code if you want to allow only one of the OR criteria to be provided. Since you are using LIKE with wildcard, why bother with conditionals at all? I prefer apostrophe delimiter.</p>\n\n<pre><code>strWhere = \"[PERSONNAME] Like '*\" &amp; Me.Filter3 &amp; \"*' AND ([SaleMonth] Like '*\" &amp; Me.Filter4 &amp; \"*' OR [PAIDMONTH] Like '*\" &amp; Me.Filter5 &amp; \"*')\" \n</code></pre>\n\n<p>On second thought, that probably won't work with OR. If the criteria used only AND then it would. Try:</p>\n\n<pre><code>If Not IsNull(Me.Filter3) Then\n    strWhere = strWhere &amp; \"[PERSONNAME] Like '*\" &amp; Me.Filter3 &amp; \"*' AND \"\nEnd If\nIf Not IsNull(Me.Filter4) And Not IsNull(Me.Filter5) Then\n    strWhere = strWhere &amp; \"([SaleMonth] Like '*\" &amp; Me.Filter4 &amp; \"*' OR [PAIDMONTH] Like '*\" &amp; Me.Filter5 &amp; \"*') AND \"\nElseIf Not IsNull(Me.Filter4) Then\n    strWhere = strWhere &amp; \"[SaleMonth] Like '*\" &amp; Me.Filter4 &amp; \"*' AND \"\nElseIf Not IsNull(Me.Filter5) Then\n    strWhere = strWhere &amp; \"[PAIDMONTH] Like '*\" &amp; Me.Filter5 &amp; \"*' AND \"\nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 10886504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/337fbc7ad5e947788bd5b8d771f85071?s=128&d=identicon&r=PG&f=1", "display_name": "user10886504", "link": "https://stackoverflow.com/users/10886504/user10886504"}, "edited": false, "score": 0, "creation_date": 1547043644, "post_id": 54100512, "comment_id": 95056514, "body": "it is giving ERROR 3450 - syntax error in query. Incomplete query clause. May be just a small missing syntax."}, {"owner": {"reputation": 3, "user_id": 10886504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/337fbc7ad5e947788bd5b8d771f85071?s=128&d=identicon&r=PG&f=1", "display_name": "user10886504", "link": "https://stackoverflow.com/users/10886504/user10886504"}, "edited": false, "score": 0, "creation_date": 1547043814, "post_id": 54100512, "comment_id": 95056623, "body": "@June7 looks like it is working. I am going to validate the results more because I have lot of records, but does look like it is working thank you."}, {"owner": {"reputation": 3, "user_id": 10886504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/337fbc7ad5e947788bd5b8d771f85071?s=128&d=identicon&r=PG&f=1", "display_name": "user10886504", "link": "https://stackoverflow.com/users/10886504/user10886504"}, "edited": false, "score": 0, "creation_date": 1547043909, "post_id": 54100512, "comment_id": 95056686, "body": "I do have the following as part of the code too, to truncate the extra And"}, {"owner": {"reputation": 3, "user_id": 10886504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/337fbc7ad5e947788bd5b8d771f85071?s=128&d=identicon&r=PG&f=1", "display_name": "user10886504", "link": "https://stackoverflow.com/users/10886504/user10886504"}, "edited": false, "score": 0, "creation_date": 1547043943, "post_id": 54100512, "comment_id": 95056710, "body": "lngLen = Len(strWhere) - 5     If lngLen &gt; 0 Then     &#39;Nah: there was nothing in the string.         &#39;MsgBox &quot;No criteria&quot;, vbInformation, &quot;Nothing to do.&quot;     &#39;Else                    &#39;Yep: there is something there, so remove the &quot; AND &quot; at the end.         strWhere = Left$(strWhere, lngLen)         &#39;For debugging, remove the leading quote on the next line. Prints to Immediate Window (Ctrl+G).         &#39;Debug.Print strWhere                  &#39;Finally, apply the string as the form&#39;s Filter.         Me.Filter = strWhere         Me.FilterOn = True     End If"}], "tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": false, "score": 0, "last_activity_date": 1546985711, "creation_date": 1546985711, "answer_id": 54100512, "question_id": 54099662, "link": "https://stackoverflow.com/questions/54099662/using-or-in-form-filters/54100512#54100512", "title": "Using OR in form filters", "body": "<p>As messy as it looks, I think you'll probably need to do something like the following to ensure that the parentheses are correct in all cases and to account for all possible combinations of <code>Null</code> and <code>Not Null</code> for the three variables whilst maintaining correct SQL:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>If Not IsNull(Me.Filter3) Then\n    strWhere = strWhere &amp; \"([PERSONNAME] Like '*\" &amp; Me.Filter3 &amp; \"*') \"\n    If (Not IsNull(Me.Filter4)) Or (Not IsNull(Me.Filter5)) Then \n        strWhere = strWhere &amp; \"AND \"\n    End If\nEnd If\nIf (Not IsNull(Me.Filter4)) And (Not IsNull(Me.Filter5)) Then\n    strWhere = strWhere &amp; \"(([SaleMonth] Like '*\" &amp; Me.Filter4 &amp; \"*') OR ([PAIDMONTH] Like '*\" &amp; Me.Filter5 &amp; \"*')) \"\nElseIf Not IsNull(Me.Filter4) Then\n    strWhere = strWhere &amp; \"([SaleMonth] Like '*\" &amp; Me.Filter4 &amp; \"*') \"\nElseIf Not IsNull(Me.Filter5) Then\n    strWhere = strWhere &amp; \"([PAIDMONTH] Like '*\" &amp; Me.Filter5 &amp; \"*') \"\nEnd If\n</code></pre>\n\n<p>Though, be aware that construction of SQL code in this manner is of course open to SQL injection.</p>\n"}], "owner": {"reputation": 3, "user_id": 10886504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/337fbc7ad5e947788bd5b8d771f85071?s=128&d=identicon&r=PG&f=1", "display_name": "user10886504", "link": "https://stackoverflow.com/users/10886504/user10886504"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 54100127, "answer_count": 2, "score": 0, "last_activity_date": 1556266863, "creation_date": 1546981410, "last_edit_date": 1556266863, "question_id": 54099662, "link": "https://stackoverflow.com/questions/54099662/using-or-in-form-filters", "title": "Using OR in form filters", "body": "<p>My goal is to get records where person name matches the filter, and either sale month is matching or paid month is matching.</p>\n\n<p>My filter is giving me results for all people and not filtering by Person Name.</p>\n\n<pre><code>If Not IsNull(Me.Filter3) Then\n    strWhere = strWhere &amp; \"([PERSONNAME] Like \"\"*\" &amp; Me.Filter3 &amp; \"*\"\") AND \"\nEnd If\nIf Not IsNull(Me.Filter4) Then\n    strWhere = strWhere &amp; \"([SaleMonth] Like \"\"*\" &amp; Me.Filter4 &amp; \"*\"\") OR \"\nEnd If\nIf Not IsNull(Me.Filter5) Then\n    strWhere = strWhere &amp; \"([PAIDMONTH] Like \"\"*\" &amp; Me.Filter5 &amp; \"*\"\") AND \"\nEnd If\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-2010", "excel-2016"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1546982598, "post_id": 54099601, "comment_id": 95032628, "body": "Can you share the spreadsheet?"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1546982992, "post_id": 54099601, "comment_id": 95032799, "body": "Without at least some sample data, and an explanation of what <code>UMAuthorization!Auth1</code> etc are (objects on your form maybe?) this Q is impossible to answer."}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1546983018, "post_id": 54099601, "comment_id": 95032810, "body": "Isn&#39;t ActiveCell a range object and UMAuthorization!Auth1 a value from your form?   You might try Activecell.value.   Also, when deleting cells and shifting up, you should start at the bottom of your data, so you do not miss any matches."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 3, "creation_date": 1546983149, "post_id": 54099601, "comment_id": 95032873, "body": "And BTW, code so reliant on Active Sheet, Active Cell is <i>always</i> fragile and hard to debug and maintain.  <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">See this</a> for ways to avoid them"}, {"owner": {"reputation": 11, "user_id": 10886325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/280bf82fac0098f1df0f526f49851aac?s=128&d=identicon&r=PG&f=1", "display_name": "GingerSnipSnap", "link": "https://stackoverflow.com/users/10886325/gingersnipsnap"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1546984865, "post_id": 54099601, "comment_id": 95033567, "body": "@Om3r and @chrisneilsen I cannot share the spreadsheet since it contains client data. Column A is just authorization codes. The form is looking for the authorization code that matches the number value in the cell Auth1 on the form. <code>UMAuthorization!Auth1</code> is the form value. The form is called <code>UMAuthorization</code>. <code>Auth1</code> is the a cell in the form <code>UMAuthorization</code>. The <code>!</code> symbol stands for single data type. I didn&#39;t write this macro, it predates me by a few years in this position."}, {"owner": {"reputation": 11, "user_id": 10886325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/280bf82fac0098f1df0f526f49851aac?s=128&d=identicon&r=PG&f=1", "display_name": "GingerSnipSnap", "link": "https://stackoverflow.com/users/10886325/gingersnipsnap"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1546984952, "post_id": 54099601, "comment_id": 95033610, "body": "Also @chrisneilsen thank you for the insight."}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1546985058, "post_id": 54099601, "comment_id": 95033648, "body": "You could try to change Do While UMAuthorization!Auth1 &lt;&gt; ActiveCell    to     Do While UMAuthorization!Auth1 &lt;&gt; ActiveCell.value"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1546985182, "post_id": 54099601, "comment_id": 95033689, "body": "@GingerSnipSnap you don&#39;t need to share the workbook itself, but please edit into your Q some representative data (doesn&#39;t have to be <i>real</i> data) that when you run your code on it you see the issue described in your Q.  And, you say <code>Auth1</code> is &quot;a cell in the form&quot;.  Well, forms don&#39;t have <i>cells</i>, they have TextBox&#39;s, ComboBoxes&#39;s, ListBoxes&#39;s etc.  Please be specific (and edit that info into your Q too)"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1546986499, "post_id": 54099601, "comment_id": 95034170, "body": "At first glance, your data appears to be numeric, and your form (forms always do this) data will be string.  Try changing the <code>Do While</code>tests to <code>... &lt;&gt; ActiveCell.Text</code>"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10886325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/280bf82fac0098f1df0f526f49851aac?s=128&d=identicon&r=PG&f=1", "display_name": "GingerSnipSnap", "link": "https://stackoverflow.com/users/10886325/gingersnipsnap"}, "edited": false, "score": 0, "creation_date": 1547047286, "post_id": 54100459, "comment_id": 95058982, "body": "this code didn&#39;t work for me either. At first, the code had excel hanging in a continuous &#39;busy&#39; stasis, so I had to Task Manager excel to force the quit. I restricted the ranges in the A column and it worked like it should, but again, the end result was the same. The selected data for deletion on the userform did not delete from userform or the spreadsheet."}], "tags": [], "owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "is_accepted": false, "score": 0, "last_activity_date": 1546985365, "creation_date": 1546985365, "answer_id": 54100459, "question_id": 54099601, "link": "https://stackoverflow.com/questions/54099601/do-while-loop-iterates-through-worksheet-till-done-never-matches-on-condition/54100459#54100459", "title": "Do While Loop iterates through worksheet till done, never matches on condition", "body": "<p>You chould replace the code between</p>\n\n<pre><code>Sheets(\"Main\").Unprotect\n</code></pre>\n\n<p>and </p>\n\n<pre><code>Sheets(\"Main\").protect\n</code></pre>\n\n<p>With this</p>\n\n<pre><code>With Worksheets(\"Main\").Range(\"A:A\")\n    Set c = .Find(UMAuthorization!Auth1, LookIn:=xlValues)\n    If Not c Is Nothing Then\n        Do\n            c.EntireRow.Delete Shift:=xlUp\n            Set c = .Find(UMAuthorization!Auth1, LookIn:=xlValues)\n        Loop While Not c Is Nothing\n    End If\nEnd With\n</code></pre>\n\n<p>It will find the value from your form and delete all rows that match in column A.</p>\n\n<p>You can restrict the range by changing column A to some range like A2:A200.</p>\n\n<p>If you want to only delete the first match then remove the do loop but keep the delete row line.</p>\n\n<p>Since I don't have your form, I tested this with a static value.</p>\n"}, {"comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1546988793, "post_id": 54100787, "comment_id": 95034950, "body": "Your suggestion to use <code>CInt</code> is (almost) a good one, except that some of the values   will exceed the capacity of an &#204;nteger<code>.  Use </code>CLng` instead"}, {"owner": {"reputation": 893, "user_id": 10794555, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0D8LRxW70DQ/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-icioZDBlm6V-nHzFzMNQ2LTv2Nmg/mo/photo.jpg?sz=128", "display_name": "Ama", "link": "https://stackoverflow.com/users/10794555/ama"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1546989069, "post_id": 54100787, "comment_id": 95035055, "body": "True! cLng will do then!"}], "tags": [], "owner": {"reputation": 893, "user_id": 10794555, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0D8LRxW70DQ/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-icioZDBlm6V-nHzFzMNQ2LTv2Nmg/mo/photo.jpg?sz=128", "display_name": "Ama", "link": "https://stackoverflow.com/users/10794555/ama"}, "is_accepted": false, "score": 0, "last_activity_date": 1546989519, "last_edit_date": 1546989519, "creation_date": 1546987450, "answer_id": 54100787, "question_id": 54099601, "link": "https://stackoverflow.com/questions/54099601/do-while-loop-iterates-through-worksheet-till-done-never-matches-on-condition/54100787#54100787", "title": "Do While Loop iterates through worksheet till done, never matches on condition", "body": "<p>This may have to do with the way Excel interprets your data. I can see you have a series of \"heading\" zeros in your data sample.</p>\n\n<p>The default object property for a Range Object such as ActiveCell is .value.\nI would try changing ActiveCell by ActiveCell.value2.\nFor information about the differences, see this related post: <a href=\"https://stackoverflow.com/questions/17359835/what-is-the-difference-between-text-value-and-value2\">What is the difference between .text, .value, and .value2?</a></p>\n\n<pre><code>Do While UMAuthorization!Auth1 &lt;&gt; ActiveCell.value2\n    ActiveCell.Offset(1, 0).Activate\nLoop\n</code></pre>\n\n<p>Another lead would be to run a cLng() to convert both variables into a number where \"heading\" zeros will be \"trimmed\".</p>\n\n<pre><code>Do While cLng(UMAuthorization!Auth1) &lt;&gt; cLng(ActiveCell)\n    ActiveCell.Offset(1, 0).Activate\nLoop\n</code></pre>\n\n<p>Alternatively, you could force the zeros to appear if the code has less than 7 digits:</p>\n\n<pre><code>Do While format(UMAuthorization!Auth1, \"0000000\") &lt;&gt; format(ActiveCell, \"0000000\")\n    ActiveCell.Offset(1, 0).Activate\nLoop\n</code></pre>\n\n<p>Let us know if the Loop is still runing for ever?</p>\n\n<p>More generally, I would recommend avoiding relying on .activate and ActiveCell object to scroll through your data as it is both slow and risky if the user clicks somewhere on the sheet whilst the Loop is running.\nYou can efficently extract your data into an array, process your array of data within VBA to identify the relevant Row(s) and then process the Sheet:\n(Note this will also allow you to see how Excel reads your data by throwing a debug.print on the data stored into the Array)</p>\n\n<pre><code>Dim mySheet as new worksheet\nset mySheet = ActiveSheet 'Or something else\n\nDim arrMyData() as variant 'Must be a variant\narrMyData = range(\"A2:A999\").Value2 'Adjust A999 with your case\n\ndim i as long\nfor i = lBound(arrMyData,1) to uBound(arrMyData,1)\n    debug.print \"Comparing \" &amp; arrMyData(i,1) &amp; \" with \" &amp; UMAuthorization!Auth1\n    if arrMyData(i,1) = UMAuthorization!Auth1 then\n    'if cLng(arrMyData(i,1)) = cLng(UMAuthorization!Auth1) then  &lt;- Use this line if the one aboe does not work\n        mySheet.Rows(i+1).delete Shift:=xlUp 'i+1 Because i=1 because your array starts at Row 2 (Cell A2)\n        Debug.Print \"Deleted row \" &amp; i+1\n    end if\nNext\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10886325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/280bf82fac0098f1df0f526f49851aac?s=128&d=identicon&r=PG&f=1", "display_name": "GingerSnipSnap", "link": "https://stackoverflow.com/users/10886325/gingersnipsnap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1547017912, "creation_date": 1546981201, "last_edit_date": 1547017912, "question_id": 54099601, "link": "https://stackoverflow.com/questions/54099601/do-while-loop-iterates-through-worksheet-till-done-never-matches-on-condition", "title": "Do While Loop iterates through worksheet till done, never matches on condition", "body": "<p>I have a userform that users enter data into cells that are then sorted onto an Excel spreadsheet 'Main'. </p>\n\n<p>If a user needs to delete an entry, they tab over till the offending entry is on the leftmost side of the userform and hit delete, an option box appears and asks them if they wish to delete 'yes' or 'no'. If they hit 'yes' the userform is supposed to clear the cells of the offending data while on the spreadsheet 'Main' it goes row by row and matches the value from the 'Auth1' to its counterpart somewhere in the 'A' column, deleting it.</p>\n\n<p>Neither is happening. Putting in breaks, and stepping through the code and program, I have a Do While Loop that goes until it runs out of cells to check and then proceeds with the rest of the code. </p>\n\n<p>It blew right passed the matching cell that no longer made the condition 'true'. </p>\n\n<p>The code snippet in question:</p>\n\n<pre><code>    Do While UMAuthorization!Auth1 &lt;&gt; ActiveCell\n        ActiveCell.Offset(1, 0).Activate\n    Loop\n</code></pre>\n\n<p>The 'Yes' sub in total</p>\n\n<pre><code> Private Sub DeleteYes_Click()\n   DeleteForm.Hide\n   CloseBook\n   OpenMinimized\n   Range(\"A2\").Select\n   Sheets(\"Main\").Unprotect\n       Do While UMAuthorization!Auth1 &lt;&gt; ActiveCell\n          ActiveCell.Offset(1, 0).Activate\n       Loop\n   ActiveCell.EntireRow.Delete Shift:=xlUp\n   Sheets(\"Main\").Protect\nSaveBook\n   Range(\"A2\").Select\n    If Auth2 &lt;&gt; \"\" Then\n        Do While UMAuthorization!Auth2 &lt;&gt; ActiveCell\n            ActiveCell.Offset(1, 0).Activate\n        Loop\n    Else\n        Do While UMAuthorization!Claim1 &gt; ActiveCell And ActiveCell &lt;&gt; \"\"\n            ActiveCell.Offset(1, 0).Activate\n        Loop\n    End If\nEnd Sub\n</code></pre>\n\n<p>We just updated to 2016 excel. This code runs perfectly on 2010. To me, it makes total sense. However, Excel 2016 isn't acknowledging it. I've checked references and tinkered with values, but I'm stumped here. Thoughts anyone? </p>\n\n<p>Edit: Here's some nonsensical sample data. Auth is column A. Row 1 is a static header. </p>\n\n<pre><code>1 Auth    Claim  TaxID    Type   AuthDate   \n2 0033087 154255 270275455    PT     08/25/18\n3 0094525 155512 545465646    PT     12/12/18\n4 0025125 555555 565445546    Acu    11/15/12\n5 9994313 354585 564645545    X      01/08/18\n6 5464654 111551 688558585    Chiro  09/15/09 \n7 9954545 445664 545665456    OT     05/30/15\n</code></pre>\n"}, {"tags": ["regex", "vba", "ms-access"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1546981361, "post_id": 54099493, "comment_id": 95032107, "body": "Concatenate your values inside your loop, then set X_FIND to that concatenated value after the loop. Better yet <a href=\"https://stackoverflow.com/questions/44979363/excel-vba-regex-function-that-returns-multiple-matches-into-a-single-cell/44979561\">toss the matches into an array and JOIN() the array at the end for your output</a>. The way you have it written now, you return the first match as the function return and then... your subsequent loops are ignored."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1546981910, "post_id": 54099493, "comment_id": 95032344, "body": "Also, make sure Global is set to <code>True</code>."}, {"owner": {"reputation": 7, "user_id": 10054559, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Bz4fnpmrRug/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7olHv2_aFLvgXIi-8Rucs289qtwBg/mo/photo.jpg?sz=128", "display_name": "CoderTanner", "link": "https://stackoverflow.com/users/10054559/codertanner"}, "edited": false, "score": 0, "creation_date": 1546984212, "post_id": 54099493, "comment_id": 95033290, "body": "I kind-of know what you mean, do you mind typing that? Sorry im a visual person so I want to see exactly what you mean. And I believe global is set to true?"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1546995721, "post_id": 54099493, "comment_id": 95036663, "body": "@CoderTanner The default value is <code>True</code> for <code>Global</code>, but you can override it to <code>False</code> in the 5th parameter of <code>X_FIND</code>. Double check you aren&#39;t."}, {"owner": {"reputation": 7, "user_id": 10054559, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Bz4fnpmrRug/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7olHv2_aFLvgXIi-8Rucs289qtwBg/mo/photo.jpg?sz=128", "display_name": "CoderTanner", "link": "https://stackoverflow.com/users/10054559/codertanner"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1547046494, "post_id": 54099493, "comment_id": 95058484, "body": "@JNevill Can you explain what you mean joining an array? Do you have an example?"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1547046884, "post_id": 54099493, "comment_id": 95058722, "body": "&quot;Joining&quot; an array here and in most languages is where you take a single dim array and turn it into a single string where each value of the array is in the string delimited by some character. So an array like <code>myArr=ARRAY(1,2,3,4)</code> that we join with <code>JOIN(myArr, &quot;,&quot;)</code> will result in a string like <code>1,2,3,4</code> that can be returned  here. You could also return the array itself, which might be the better solution depending on what your caller code needs."}, {"owner": {"reputation": 7, "user_id": 10054559, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Bz4fnpmrRug/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7olHv2_aFLvgXIi-8Rucs289qtwBg/mo/photo.jpg?sz=128", "display_name": "CoderTanner", "link": "https://stackoverflow.com/users/10054559/codertanner"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1547053733, "post_id": 54099493, "comment_id": 95063019, "body": "@JNevill  Okay that makes sense, im super new to functions so im just struggling to figure out how to implement an array and a join into the existing function. Do you have any links or anything so I can learn more about it. I just need to create the function for work purposes."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1547070021, "post_id": 54099493, "comment_id": 95070055, "body": "Might help to provide sample source data. And exactly how you are calling the function."}, {"owner": {"reputation": 7, "user_id": 10054559, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Bz4fnpmrRug/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7olHv2_aFLvgXIi-8Rucs289qtwBg/mo/photo.jpg?sz=128", "display_name": "CoderTanner", "link": "https://stackoverflow.com/users/10054559/codertanner"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 1, "creation_date": 1547071674, "post_id": 54099493, "comment_id": 95070767, "body": "@June7 So im calling the function from a query, &quot;X_FIND(STRING_SOURCE,PATTERN). and the query that im calling it from is a memo field with multiple possibilities. For this example ill say im just going to be finding phone numbers. In the memo field there could be o to 500 possible phone number patterns. So I want to gather all of them in one field concatenated together like JNevill was talking about. like &quot;111-111-1111, 222-222-2222, etc.&quot; hope that helps! Thanks!"}, {"owner": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "edited": false, "score": 0, "creation_date": 1547098921, "post_id": 54099493, "comment_id": 95076855, "body": "@CoderTanner Why do you want to use regex? As you mentioned, you have 0 to 500 possible phone number patterns and want to gather all of them in one field, so do you want phone number with specific patterns or just all in one string?"}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 10054559, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Bz4fnpmrRug/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7olHv2_aFLvgXIi-8Rucs289qtwBg/mo/photo.jpg?sz=128", "display_name": "CoderTanner", "link": "https://stackoverflow.com/users/10054559/codertanner"}, "edited": false, "score": 0, "creation_date": 1547139025, "post_id": 54122107, "comment_id": 95098142, "body": "It works! wow thanks! It gives me exactly what I needed so thank you! Do you know how I could make it so it doesnt have any duplicate returns? Example:  &quot;999-999-9998 abckd 999-999-9999 asdf 999-999-9998&quot; to return &quot;999-999-9998,999-999-9999&quot;. Maybe just an if statement in the &quot;x_FIND =&quot; Formula maybe?"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "reply_to_user": {"reputation": 7, "user_id": 10054559, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Bz4fnpmrRug/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7olHv2_aFLvgXIi-8Rucs289qtwBg/mo/photo.jpg?sz=128", "display_name": "CoderTanner", "link": "https://stackoverflow.com/users/10054559/codertanner"}, "edited": false, "score": 0, "creation_date": 1547152783, "post_id": 54122107, "comment_id": 95104633, "body": "See revised answer."}, {"owner": {"reputation": 7, "user_id": 10054559, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Bz4fnpmrRug/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7olHv2_aFLvgXIi-8Rucs289qtwBg/mo/photo.jpg?sz=128", "display_name": "CoderTanner", "link": "https://stackoverflow.com/users/10054559/codertanner"}, "edited": false, "score": 0, "creation_date": 1547163569, "post_id": 54122107, "comment_id": 95108421, "body": "Worked perfectly! Thanks!"}], "tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": true, "score": 0, "last_activity_date": 1547158950, "last_edit_date": 1547158950, "creation_date": 1547095743, "answer_id": 54122107, "question_id": 54099493, "link": "https://stackoverflow.com/questions/54099493/how-can-i-have-my-access-vba-regex-return-all-possible-matches-instead-of-only-t/54122107#54122107", "title": "How can I have my Access VBA regex return all possible matches instead of only the first match?", "body": "<p>I changed 1 line in the function:</p>\n\n<p><code>X_FIND = X_FIND &amp; \",\" &amp; m.value</code></p>\n\n<p>I tested the function with inputs:</p>\n\n<pre><code>Mid(X_FIND(\"999-999-9998 abckd 999-999-9999\", \"[0-9]{3}-[0-9]{3}-[0-9]{4}\"),2)\n</code></pre>\n\n<p>Returns string:</p>\n\n<p><code>999-999-9998,999-999-9999</code></p>\n\n<p>If there is possibility of duplicate phone numbers, use pattern:<br>\n<code>\"([0-9]{3}-[0-9]{3}-[0-9]{4})(?!.*?\\1.*$)\"</code></p>\n\n<p>Only the last match of each unique value will be returned. </p>\n\n<p>If you want to assure returns are in ascending order, will require more code, which is not simple as far as I can see, and involves writing the unique matches to array (this is easy with Split function) or collection and applying bubble sort or some other algorithm (this is the complicated part).</p>\n"}], "owner": {"reputation": 7, "user_id": 10054559, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Bz4fnpmrRug/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7olHv2_aFLvgXIi-8Rucs289qtwBg/mo/photo.jpg?sz=128", "display_name": "CoderTanner", "link": "https://stackoverflow.com/users/10054559/codertanner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 2, "accepted_answer_id": 54122107, "answer_count": 1, "score": 0, "last_activity_date": 1547158950, "creation_date": 1546980665, "last_edit_date": 1547070031, "question_id": 54099493, "link": "https://stackoverflow.com/questions/54099493/how-can-i-have-my-access-vba-regex-return-all-possible-matches-instead-of-only-t", "title": "How can I have my Access VBA regex return all possible matches instead of only the first match?", "body": "<p>This is my current code, it is only returning the first match, I need to return all matches. Example, [phone number 1] &amp; [phone number 2] &amp; [phone number 3]... but it is only returning [phone number 1]. </p>\n\n<pre><code>Public Function X_FIND( _\n    ByVal SourceString As String, _\n    ByVal Pattern As String, _\nOptional ByVal IgnoreCase As Boolean = True, _\n    Optional ByVal MultiLine As Boolean = True, _\n    Optional ByVal MatchGlobal As Boolean = True) As String\n\n    Dim re As New regexp\n        re.MultiLine = MultiLine\n        re.IgnoreCase = IgnoreCase\n        re.Global = MatchGlobal\n        re.Pattern = Pattern\n    Dim m\n    For Each m In re.Execute(SourceString)\n        X_FIND = m.Value\n    Next\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 3, "creation_date": 1546978376, "post_id": 54099005, "comment_id": 95030886, "body": "Quick test, add <code>Debug.Print SixTimeLastRow</code> right before the <code>.Copy</code> line and see what the Immediate Window outputs.  Also, try switching <code>ActiveSheet</code> to the sheet name itself, i.e. <code>Sheets(&quot;Sheet1&quot;).Range(...</code>."}, {"owner": {"reputation": 23, "user_id": 10186618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28e807a1453fe2bee9824d0323a8627e?s=128&d=identicon&r=PG&f=1", "display_name": "djarve", "link": "https://stackoverflow.com/users/10186618/djarve"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1547059852, "post_id": 54099005, "comment_id": 95065809, "body": "I added the Debug line right before the .Copy line and oddly enough, nothing printed. The code just returned the same 1004 error as before."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1547061118, "post_id": 54099005, "comment_id": 95066343, "body": "look at how you&#39;re setting the <code>SixTimesLastRow</code> variable. If the debug print is showing nothing, that variable isn&#39;t being set correctly. Step through with <code>F8</code> and when you get to that line see if you can determine why it&#39;s not being set correctly. Try also adding the workbook before the worksheet too, just to make sure it is looking to the correct sheet."}], "owner": {"reputation": 23, "user_id": 10186618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28e807a1453fe2bee9824d0323a8627e?s=128&d=identicon&r=PG&f=1", "display_name": "djarve", "link": "https://stackoverflow.com/users/10186618/djarve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1547059929, "creation_date": 1546978148, "last_edit_date": 1547059929, "question_id": 54099005, "link": "https://stackoverflow.com/questions/54099005/im-getting-a-1004-error-when-i-try-to-use-the-lastrow-variable-to-copy-and-past", "title": "I&#39;m getting a 1004 error when I try to use the LastRow variable to copy and paste data", "body": "<p>Thanks in advance for your help. The question I have is really about the 1004 error that I'm getting around the LastRow variable that I am trying to use. But I will do my best to explain everything. </p>\n\n<p>The code that I have:</p>\n\n<p>-First looks in a specific Windows folder and opens the most recently updated file in that folder and opens it. </p>\n\n<p>-The code then looks in a specific Outlook folder and opens the most email based on whether or not that email has an attachment.</p>\n\n<p>-The email attachment is extracted, saved in a folder, and opened. </p>\n\n<p>-At this point there should be 2 files open: the one from the email and the file that was opened from the Windows folder. </p>\n\n<p>-What I am trying to do is copy data from one file into the other and I'm trying to use the LastRow variable to do that. In the code below, everything runs fine until I get to the line that says <code>ActiveSheet.Range(\"$A$1:$AB\" &amp; SixTimesLastRow).Copy</code></p>\n\n<pre><code>    Const olFolderInbox As Integer = 6\n    '~~&gt; Path for the attachment\n    Const AttachmentPath As String = \"C:\\Users\\DJ.Oliver\\Documents\\Test\"\n    Option Explicit\n    Sub UpdateBusinessJustification()\n\n    Dim oOlAp As Object, oOlns As Object, oOlInb As Object, CABLastRow As Long, \n    SixTimesLastRow As Long, objDoc As Object, objWord As Object, objSelection \n    As Object, nonProdCount As Integer, nonProdDT As Integer\n    Dim oOlItm As Object, oOlAtch As Object, fname As String, sFound As String, \n    totalRowCount As Integer, wFound As String, wdRange As Word.Range, str As \n    String, nonProdCopyToWord As Long\n    Dim wb As Workbook, uRng As Range, tbl As Table, ProdCount As Integer, \n    ProdDT As Integer, myDate As Date, tableCount As Integer, MyPath As String, \n    MyFile As String, LatestFile As String\n    Dim LatestDate As Date, LMD As Date, CABPath As String, r As Range, x As \n    Variant, CopyCRRange As Range\n\n\n    MyPath = \"C:\\Users\\User\\Documents\\Reports\\\"\n    CABPath = \"C:\\Users\\User\\Documents\"\n\n\n    MyFile = Dir(MyPath &amp; \"\\CAB*.xlsx\", vbNormal)\n\n    If Len(MyFile) = 0 Then\n\n        MsgBox \"No files were found\u2026\", vbExclamation\n\n        Exit Sub\n\n    End If\n\n    Do While Len(MyFile) &gt; 0\n\n        LMD = FileDateTime(MyPath &amp; MyFile)\n\n        If LMD &gt; LatestDate Then\n\n            LatestFile = MyFile\n\n            LatestDate = LMD\n\n        End If\n\n        MyFile = Dir\n\n    Loop\n\n    'Open the latest CAB file\n\n    Workbooks.Open MyPath &amp; LatestFile\n\n    Dim ws As Worksheet\n    For Each ws In Worksheets\n        If ws.AutoFilterMode Then\n            ws.AutoFilterMode = False\n        End If\n    Next ws\n\n\n    '~~&gt; New File Name for the attachment\n    Dim NewFileName As String\n    NewFileName = \"MorningOps \" &amp; Format(Date, \"MM-DD-YYYY\")\n    '~~&gt; Get Outlook instance\n    Set oOlAp = GetObject(, \"Outlook.application\")\n    Set oOlns = oOlAp.GetNamespace(\"MAPI\")\n    Set oOlInb = oOlns.GetDefaultFolder(olFolderInbox).Folders(\"Daily CAB Reports\")\n\n\n    '~~&gt; Check if there are any actual unread emails\n    If oOlInb.Items.Restrict(\"[UnRead] = True\").Count = 0 Then\n        MsgBox \"NO Unread Email In Inbox\"\n        Exit Sub\n    End If\n\n    '~~&gt; Extract the attachment from the 1st unread email\n    For Each oOlItm In oOlInb.Items.Restrict(\"[UnRead] = True\")\n        '~~&gt; Check if the email actually has an attachment\n        If oOlItm.Attachments.Count &lt;&gt; 0 Then\n            For Each oOlAtch In oOlItm.Attachments\n                '~~&gt; Download the attachment\n                oOlAtch.SaveAsFile NewFileName &amp; oOlAtch.Filename\n                Exit For\n            Next\n        Else\n            MsgBox \"The First item doesn't have an attachment\"\n        End If\n        Exit For\n    Next\n\n    '~~&gt; Mark 1st unread email as read\n    For Each oOlItm In oOlInb.Items.Restrict(\"[UnRead] = True\")\n        oOlItm.UnRead = False\n        DoEvents\n        oOlItm.Save\n        Exit For\n        Next\n\n    '--&gt; Search for downloaded file and open without knowing exact filename\n    sFound = Dir(CABPath &amp; \"\\*Data Center CAB*.xlsx\")\n    If sFound &lt;&gt; \"\" Then\n    Workbooks.Open Filename:=sFound\n    End If\n\n    'Set uRng = ActiveSheet.Range(\"A1:A2\")\n\n    '--&gt; Set variable for last row in sheet containing data\n\n    Workbooks(LatestFile).Activate\n    CABLastRow = Sheets(\"CAB\").Cells(Rows.Count, 1).End(xlUp).Row\n    'Activate the latest CAB file and flear the contents\n    'Workbooks(LatestFile).Activate\n    Worksheets(\"CAB\").Range(\"$A$1:$AB\" &amp; CABLastRow).ClearContents\n\n    'Activate the 6x report and apply the filter to look for next week's changes\n    Workbooks(sFound).Activate\n    SixTimesLastRow = Sheets(\"Combined CAB Agenda\").Cells(Rows.Count, 1).End(xlUp).Row\n    ActiveSheet.Range(\"$A$1:$AB\" &amp; SixTimesLastRow).AutoFilter Field:=3, Criteria1:= _\n        xlFilterNextWeek, Operator:=xlFilterDynamic\n\n    'Copy next week changes from 6x daily report to CAB report\n    ActiveSheet.Range(\"$A$1:$AB\" &amp; SixTimesLastRow).Copy\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 2, "creation_date": 1546980999, "post_id": 54098838, "comment_id": 95031953, "body": "Which version of Word is this? Even though a specific language is applied to the entire document via the <code>Selection</code> object it does happen that the language formatting is not applied throughout. In some versions of Word a language format that was applied by Word - because the Word and WIndows language formats don&#39;t match - can&#39;t be overridden. My best guess would be that that&#39;s what&#39;s happening."}, {"owner": {"reputation": 13, "user_id": 4803979, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d25578b450e0985bff895f42a7bbae13?s=128&d=identicon&r=PG&f=1", "display_name": "Dor12126", "link": "https://stackoverflow.com/users/4803979/dor12126"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1547048793, "post_id": 54098838, "comment_id": 95059937, "body": "@CindyMeister office 2016"}], "owner": {"reputation": 13, "user_id": 4803979, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d25578b450e0985bff895f42a7bbae13?s=128&d=identicon&r=PG&f=1", "display_name": "Dor12126", "link": "https://stackoverflow.com/users/4803979/dor12126"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1554794050, "creation_date": 1546977243, "last_edit_date": 1554794050, "question_id": 54098838, "link": "https://stackoverflow.com/questions/54098838/word-macro-returning-error-about-tool-grammar", "title": "word macro returning error about tool grammar", "body": "<p>for some reason, when I'm running this VBA macro code:</p>\n\n<pre><code>Sub dor()\n\n    Dim DocStats As String\n    Dim MBTitle As String\n    Dim J As Integer\n\n\n    With Selection\n    .WholeStory\n    .LanguageID = wdEnglishUS\n    .HomeKey Unit:=wdStory\n    End With\n\n\n    MBTitle = \"Readability Statistics\"\n    DocStats = \"\"\n    With ActiveDocument.Content\n        For J = 1 To 10\n            'DocStats = DocStats &amp; .ReadabilityStatistics(J)\n            'DocStats = DocStats &amp; \": \"\n            DocStats = DocStats &amp; .ReadabilityStatistics(J).Value\n            DocStats = DocStats &amp; vbCrLf\n        Next J\n    End With\n\n\n    '~ Create a FileSystemObject\n    Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\n\n    '~ Provide file path\n    outFile = \"C:\\Users\\Dor\\Desktop\\UrisJobs\\work_prod\\docx\\all_files\\output\\\" &amp; ActiveDocument.Name &amp; \".txt\"\n\n\n    Dim fso As Object\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n\n    Dim objFile As Object\n    Set objFile = fso.CreateTextFile(outFile, True, True)\n\n    '~ Setting up file to write\n    '~ Set objFile = objFSO.CreateTextFile(outFile, True)\n\n\n    strComputer = \".\"\n\n\n        'Wscript.Echo objFile.Name  'Commented out\n\n        '~ Write to file\n    objFile.WriteLine DocStats\n\n\n    '~ Close the file\n    objFile.Close\n\n\nEnd Sub\n</code></pre>\n\n<p>I'm getting this error:</p>\n\n<blockquote>\n  <p>\"tool grammar statistics array cannot be run on a document that contains more than one language format\"</p>\n</blockquote>\n\n<p>I don't know why, but for some documents my code is working and for some - I'm getting this error.</p>\n"}, {"tags": ["c#", "excel", "vba"], "comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1546980913, "post_id": 54098734, "comment_id": 95031922, "body": "It&#39;s been a little while since I wrote a dll, but I seem to remember each member needs to be Public. Could be wrong, but maybe try changing <code>Activate</code> and <code>IsActive</code> to be public. Also, I seem to remember adding decorators like <code>[ComVisible(true)]</code> for individuals methods/function are those not required?"}, {"owner": {"reputation": 760, "user_id": 3166766, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/u1JFo.jpg?s=128&g=1", "display_name": "jDave1984", "link": "https://stackoverflow.com/users/3166766/jdave1984"}, "edited": false, "score": 0, "creation_date": 1546981108, "post_id": 54098734, "comment_id": 95032001, "body": "You only need the decorators for the class, but I&#39;ll try the public part."}], "owner": {"reputation": 760, "user_id": 3166766, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/u1JFo.jpg?s=128&g=1", "display_name": "jDave1984", "link": "https://stackoverflow.com/users/3166766/jdave1984"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1546976773, "creation_date": 1546976773, "question_id": 54098734, "link": "https://stackoverflow.com/questions/54098734/dll-cannot-write-to-file-because-it-is-being-used-by-another-process", "title": "DLL Cannot write to file because it is being used by another process", "body": "<p>I have a C# Library that is currently working, that I can call from VBA in an Excel Spreadsheet. I have been wanting to add Logging abilities to the library, so I've created this <code>Logger</code> class that can be initialized from VBA.</p>\n\n<pre><code>using System;\nusing System.IO;\nusing System.Reflection;\nusing System.Runtime.InteropServices;\nusing System.Text;\n\n/// &lt;summary&gt;\n/// Logger - Logging class for applications\n/// &lt;/summary&gt;\n[Serializable(), ClassInterface(ClassInterfaceType.AutoDual), ComVisible(true)]\npublic class Logger\n{\n    #region Constructors\n    /// &lt;summary&gt;\n    /// Initializes a new instance of the &lt;see cref=\"Logger\"/&gt; class\n    /// &lt;/summary&gt;\n    public Logger()\n    {\n    }\n\n    /// &lt;summary&gt;\n    /// Initializes a new instance of the &lt;see cref=\"Logger\"/&gt; class\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"logPath\"&gt;Path to write to&lt;/param&gt;\n    /// &lt;param name=\"message\"&gt;Initial message&lt;/param&gt;\n    public Logger(string logPath, string message)\n    {\n        this.Initialize(logPath, message);\n    }\n    #endregion\n\n    #region Properties\n    /// &lt;summary&gt;\n    /// Gets or sets a value indicating whether the logger is active\n    /// &lt;/summary&gt;\n    public bool Active { get; set; }\n\n    /// &lt;summary&gt;\n    /// Gets or sets the path for the Logger to use\n    /// &lt;/summary&gt;\n    public string LogPath { get; set; }\n    #endregion\n\n    #region Methods\n    /// &lt;summary&gt;\n    /// Initializes the logger. This method is for VBA use\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"logPath\"&gt;Path to write to&lt;/param&gt;\n    /// &lt;param name=\"message\"&gt;Initial Message&lt;/param&gt;\n    public void Initialize(string logPath, string message)\n    {\n        this.Activate(logPath);\n        this.ClearLog();\n        this.LogWrite(message);\n    }\n\n    /// &lt;summary&gt;\n    /// Writes the log\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"logMessage\"&gt;Message to send&lt;/param&gt;\n    public void LogWrite(string logMessage)\n    {\n        if (this.IsActive())\n        {\n            try\n            {\n                using (StreamWriter writer = File.AppendText(this.LogPath))\n                {\n                    Log(logMessage, writer);\n                }\n            }\n            catch (Exception ex)\n            {\n                throw ex;\n            }\n        }\n    }\n\n    /// &lt;summary&gt;\n    /// Writes the Log entry\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"logMessage\"&gt;Message to use&lt;/param&gt;\n    /// &lt;param name=\"writer\"&gt;&lt;/param&gt;\n    public void Log(string logMessage, TextWriter writer)\n    {\n        try\n        {\n            writer.Write(\"\\nLog Entry [{0} (1}] \", DateTime.Now.ToLongDateString(), DateTime.Now.ToLongTimeString());\n            writer.Write(\":: {0}\", logMessage);\n        }\n        catch (Exception e)\n        {\n            this.WriteErrorMessage(e);\n        }\n    }\n\n    /// &lt;summary&gt;\n    /// Writes a success message to the log\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"message\"&gt;Message to send&lt;/param&gt;\n    public void WriteSuccessMessage(string message)\n    {\n        if (this.IsActive())\n        {\n            try\n            {\n                using (StreamWriter writer = File.AppendText(this.LogPath))\n                {\n                    Log(\"***SUCCESS: \" + message + \"***\", writer);\n                }\n            }\n            catch (Exception e)\n            {\n                this.WriteErrorMessage(e);\n            }\n        }\n    }\n\n    /// &lt;summary&gt;\n    /// Handles logging of Error Messages\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"e\"&gt;Exception to pass&lt;/param&gt;\n    /// &lt;param name=\"message\"&gt;Message to send&lt;/param&gt;\n    public void WriteErrorMessage(Exception e, string message = null)\n    {\n        try\n        {\n            StringBuilder errorMessage = new StringBuilder();\n            errorMessage.Append(\"***ERROR\");\n            if (!string.IsNullOrWhiteSpace(message)) errorMessage.Append(\" [\" + message + \"]\");\n            errorMessage.Append(\"***\\n\");\n            errorMessage.Append(\"Exception Message: \" + e.Message);\n            errorMessage.Append(\"\\n\\tStack Trace:\\n\\t\\t\" + e.StackTrace);\n            errorMessage.Append(\"\\n\\t\\tInner Exception\\n\\t\\t\\t\" + e.InnerException);\n            errorMessage.Append(\"\\n***END ERROR***\");\n            this.LogWrite(errorMessage.ToString());\n        }\n        catch (Exception)\n        {\n            throw;\n        }\n    }\n\n    /// &lt;summary&gt;\n    /// Clears the file of any residual logging\n    /// &lt;/summary&gt;\n    public void ClearLog()\n    {\n        if (this.IsActive())\n        {\n            try\n            {\n                File.WriteAllText(this.LogPath, String.Empty);\n            }\n            catch(Exception e)\n            {\n                this.WriteErrorMessage(e);\n            }\n        }\n    }\n\n    /// &lt;summary&gt;\n    /// Checks to make sure the Logger is active by having both the &lt;see cref=\"Active\"/&gt; flag true and having a Logging path\n    /// &lt;/summary&gt;\n    /// &lt;returns&gt;&lt;see cref=\"bool\"/&gt;&lt;/returns&gt;\n    private bool IsActive() =&gt; this.Active &amp;&amp; !string.IsNullOrWhiteSpace(this.LogPath);\n\n    /// &lt;summary&gt;\n    /// Activates the Logger\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"logPath\"&gt;Path to use&lt;/param&gt;\n    private void Activate(string logPath)\n    {\n        this.Active = true;\n        this.LogPath = logPath;\n    }\n    #endregion\n}\n</code></pre>\n\n<p>I have used this class in other applications and it works great. However, when I try to initialize the <code>Logger</code> from within VBA, I get an error:</p>\n\n<pre><code>Global Log as Logger\nPublic Sub InitializeWorkbook()\n\n    Set Log = New Logger\n    Log.Initialize \"\\\\myPath\\Log.txt\", \"Logging is turned on\"\n\nEnd Sub\n</code></pre>\n\n<blockquote>\n  <p>The process cannot access the file '\\myPath\\Log.txt' because it is being used by another process</p>\n</blockquote>\n\n<p>The <code>Logger</code> class can create the text file, however I can't get past the error.</p>\n"}, {"tags": ["excel", "vba", "file", "filesystems", "directory"], "comments": [{"owner": {"reputation": 305, "user_id": 9437110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb42963fea25acac17f39c7f3738bd25?s=128&d=identicon&r=PG&f=1", "display_name": "user525966", "link": "https://stackoverflow.com/users/9437110/user525966"}, "edited": false, "score": 0, "creation_date": 1546976820, "post_id": 54098662, "comment_id": 95030189, "body": "@BigBen There are multiple such folders that may contain `\\SpecificFolder\\Finalized Plans` etc and there won&#39;t necessarily be any similarities at all between those folder names, could be anything."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 1, "creation_date": 1546980059, "post_id": 54098662, "comment_id": 95031568, "body": "Try using the <code>FileSystemObject</code>, specifically the FolderExists method. <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/folderexists-method\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/language/reference/&hellip;</a>. Alternatively, try getting all files, in all subfolders, e.g. recurse the directory. Then apply your logic of which files you want after you have the full list."}, {"owner": {"reputation": 305, "user_id": 9437110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb42963fea25acac17f39c7f3738bd25?s=128&d=identicon&r=PG&f=1", "display_name": "user525966", "link": "https://stackoverflow.com/users/9437110/user525966"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1546983684, "post_id": 54098662, "comment_id": 95033085, "body": "@RyanWildry I don&#39;t understand how this addresses this specific problem? I don&#39;t necessarily know the folder names ahead of time to check if they exist, I&#39;m trying to iterate through all files that have that pattern."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1546983933, "post_id": 54098662, "comment_id": 95033183, "body": "See my other comment, get all the files, then apply your pattern."}], "answers": [{"tags": [], "owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "is_accepted": false, "score": 1, "last_activity_date": 1546994516, "creation_date": 1546994516, "answer_id": 54101760, "question_id": 54098662, "link": "https://stackoverflow.com/questions/54098662/iterate-though-all-files-of-a-certain-path-in-excel-vba/54101760#54101760", "title": "Iterate though all files of a certain path in Excel VBA?", "body": "<p>Here is a very fast approach using WScript, which does support wildcards. </p>\n\n<pre><code>'Adapted from --&gt; https://stackoverflow.com/a/31132876/4839827\nPublic Sub GetAllFilesMatchingPattern(StartingFolder As String, FolderPattern As String)\n    If Right$(StartingFolder, 1) &lt;&gt; \"\\\" Then StartingFolder = StartingFolder &amp; \"\\\"\n    Dim StandardOutput As String\n    Dim ws             As Worksheet: Set ws = ThisWorkbook.Sheets(\"Sheet1\")\n    Dim Files          As Variant\n    StandardOutput = CreateObject(\"WScript.Shell\").Exec(\"CMD /C DIR \"\"\" &amp; StartingFolder &amp; FolderPattern &amp; \"\"\" /S /B /A:-D\").StdOut.ReadAll\n\n    If Not StandardOutput = vbNullString Then\n        Files = Split(StandardOutput, vbCrLf)\n        ws.Range(\"A1\").Resize(UBound(Files), 1).Value2 = Application.Transpose(Files)\n    End If\nEnd Sub\n\n\nSub Example()\n    GetAllFilesMatchingPattern \"H:\\\", \"*\\SpecificFolder\\Finalized Plans\\2019 Prefix*.xlsx\"\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1547006754, "creation_date": 1547006754, "answer_id": 54103103, "question_id": 54098662, "link": "https://stackoverflow.com/questions/54098662/iterate-though-all-files-of-a-certain-path-in-excel-vba/54103103#54103103", "title": "Iterate though all files of a certain path in Excel VBA?", "body": "<p>There are MANY ways to do this.  I think this will give you what you want.</p>\n\n<pre><code>Sub GetFilesInFolder(SourceFolderName As String, Subfolders As Boolean)\n\n'--- For Example:Folder Name= \"D:\\Folder Name\\\" and Flag as Yes or No\n\nDim FSO As Scripting.FileSystemObject\nDim SourceFolder As Scripting.folder, SubFolder As Scripting.folder\nDim FileItem As Scripting.File\n'Dim r As Long\n    Set FSO = New Scripting.FileSystemObject\n    Set SourceFolder = FSO.GetFolder(SourceFolderName)\n\n    '--- This is for displaying, whereever you want can be configured\n\n    r = 14\n    For Each FileItem In SourceFolder.Files\n        Cells(r, 2).Formula = r - 13\n        Cells(r, 3).Formula = FileItem.Name\n        Cells(r, 4).Formula = FileItem.Path\n        Cells(r, 5).Formula = FileItem.Size\n        Cells(r, 6).Formula = FileItem.Type\n        Cells(r, 7).Formula = FileItem.DateLastModified\n        Cells(r, 8).Formula = \"=HYPERLINK(\"\"\" &amp;amp; FileItem.Path &amp;amp; \"\"\",\"\"\" &amp;amp; \"Click Here to Open\" &amp;amp; \"\"\")\"\n\n        r = r + 1   ' next row number\n    Next FileItem\n\n    '--- This is the Function to go each and Every Folder and get the Files. This is a Nested-Function Calling.\n\n    If Subfolders = True Then\n        For Each SubFolder In SourceFolder.Subfolders\n            ListFilesInFolder SubFolder.Path, True\n        Next SubFolder\n    End If\n\n    Set FileItem = Nothing\n    Set SourceFolder = Nothing\n    Set FSO = Nothing\nEnd Sub\n</code></pre>\n\n<p>See the link below for all details.</p>\n\n<p><a href=\"http://learnexcelmacro.com/wp/2011/11/how-to-get-list-of-all-files-in-a-folder-and-sub-folders/\" rel=\"nofollow noreferrer\">http://learnexcelmacro.com/wp/2011/11/how-to-get-list-of-all-files-in-a-folder-and-sub-folders/</a></p>\n\n<p>Click the link titled 'Download Now' to download a samaple file.</p>\n"}], "owner": {"reputation": 305, "user_id": 9437110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb42963fea25acac17f39c7f3738bd25?s=128&d=identicon&r=PG&f=1", "display_name": "user525966", "link": "https://stackoverflow.com/users/9437110/user525966"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1547006754, "creation_date": 1546976458, "last_edit_date": 1546976892, "question_id": 54098662, "link": "https://stackoverflow.com/questions/54098662/iterate-though-all-files-of-a-certain-path-in-excel-vba", "title": "Iterate though all files of a certain path in Excel VBA?", "body": "<p>I am trying to iterate over a bunch of .xlsx files in a particular drive such that any file fits the following format:</p>\n\n<pre><code>H:\\[*FOLDER NAME*]\\SpecificFolder\\Finalized Plans\\2019 Prefix[*].xlsx\n</code></pre>\n\n<p>In other words inside folders on the H drive with subfolders <code>\\SpecificFolder\\Finalized Plans\\</code> containing <code>.xlsx</code> files starting with the literal phrase <code>\"2019 Prefix\"</code>. For example </p>\n\n<pre><code>H:\\Widget\\SpecificFolder\\Finalized Plans\\2019 Prefix Howdyado Neighbor.xlsx\n</code></pre>\n\n<p>or</p>\n\n<pre><code>H:\\Rofl672\\SpecificFolder\\Finalized Plans\\2019 Prefix Bob.xlsx\n</code></pre>\n\n<p>Is this something I can somehow iterate over using <code>Dir()</code>? Some other way?</p>\n\n<p>Is it something like <code>Dir(\"H:\\*\\SpecificFolder\\Finalized Plans\\2019 Prefix*.xlsx\")</code>? (this is what I tried and it gave me the error \"Bad file name or number\" so it may not be the right syntax)</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1546976448, "post_id": 54098605, "comment_id": 95030020, "body": "What do you want to do with this array?"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 1, "creation_date": 1546976785, "post_id": 54098605, "comment_id": 95030171, "body": "Why an array? Is this an interim step to some other thing?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1546977334, "post_id": 54098605, "comment_id": 95030416, "body": "to add to what others have written: Why VBA?"}], "answers": [{"tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": false, "score": 0, "last_activity_date": 1546977364, "creation_date": 1546977364, "answer_id": 54098859, "question_id": 54098605, "link": "https://stackoverflow.com/questions/54098605/array-of-row-numbers-meeting-a-criteria/54098859#54098859", "title": "Array of row numbers meeting a criteria", "body": "<p>If your values were in column A, this would fill an array with the matching row numbers and print them to the immediate window:</p>\n\n<pre><code>Sub FillArray()\n\nDim myarray As Variant\nDim i As Long\n\nReDim myarray(0 To 0)\n\nFor i = 1 To Cells(Rows.Count, 1).End(xlUp).Row\n    If Cells(i, 1).Value = \"01.03.2019\" Then 'Value to find\n        ReDim Preserve myarray(0 To UBound(myarray) + 1)\n        myarray(UBound(myarray) - 1) = i\n    End If\nNext i\n\nFor i = 0 To UBound(myarray)\n    Debug.Print myarray(i)\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 57, "user_id": 2784767, "user_type": "registered", "profile_image": "https://graph.facebook.com/565961996/picture?type=large", "display_name": "Rene Hanschke", "link": "https://stackoverflow.com/users/2784767/rene-hanschke"}, "edited": false, "score": 0, "creation_date": 1547028720, "post_id": 54098860, "comment_id": 95047459, "body": "That works just perfectly, thanks a lot, @user10862412!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10862412"}, "is_accepted": true, "score": 2, "last_activity_date": 1546977374, "creation_date": 1546977374, "answer_id": 54098860, "question_id": 54098605, "link": "https://stackoverflow.com/questions/54098605/array-of-row-numbers-meeting-a-criteria/54098860#54098860", "title": "Array of row numbers meeting a criteria", "body": "<p>It doesn't 'take a while' if you work from an array instead of the worksheet.</p>\n\n<pre><code>dim dt as long, i as long, j as long, tmp as variant, arr as variant\n\ndt = dateserial(2019, 1, 3)\n\nwith worksheets(\"sheet1\")\n\n    tmp = .range(.cells(1, \"A\"), .cells(.rows.count, \"A\").end(xlup)).value2\n\nend with\n\nredim arr(0)\n\nfor i=lbound(tmp, 1) to ubound(tmp, 1)\n    if tmp(i, 1) = dt then\n        redim preserve arr(j)\n        arr(j) = i   'collect row numbers\n        j=j+1\n    end if\nnext i\n\nfor i=lbound(arr) to ubound(arr)\n    debug.print arr(i)  'print row numbers\nnext i\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 2784767, "user_type": "registered", "profile_image": "https://graph.facebook.com/565961996/picture?type=large", "display_name": "Rene Hanschke", "link": "https://stackoverflow.com/users/2784767/rene-hanschke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 54098860, "answer_count": 2, "score": 0, "last_activity_date": 1546979000, "creation_date": 1546976240, "question_id": 54098605, "link": "https://stackoverflow.com/questions/54098605/array-of-row-numbers-meeting-a-criteria", "title": "Array of row numbers meeting a criteria", "body": "<p><br>\nI need to create an array consisting of row numbers that meet a specific criteria.<br>\nLet's say I got a list of dates:<br><br>\n01.03.2019<br>\n01.07.2019<br>\n01.03.2020<br>\n30.03.2019<br>\n01.03.2019<br>\n01.06.2019<br><br>\nNow, assuming I need the row numbers of 01.03.2019, my array would be [1,5].<br>\nIs there any decent method to do so? My list has many thousand entries, so I suppose looping through each cell would take a while. Any lean solution would be much appreciated.<br>\nI found this thread, but the answers are not yet validated: <a href=\"https://stackoverflow.com/questions/12921350/is-it-possible-to-fill-an-array-with-row-numbers-which-match-a-certain-criteria\">Is it possible to fill an array with row numbers which match a certain criteria without looping?</a></p>\n"}, {"tags": ["vba", "userform"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1546976381, "post_id": 54098578, "comment_id": 95029986, "body": "Can you <a href=\"https://stackoverflow.com/posts/54098578/edit\">edit</a> your question with the code you&#39;re using?"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1546978034, "post_id": 54098578, "comment_id": 95030738, "body": "Always Specify the workbook or worksheet your working on in a line of code"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 1, "creation_date": 1546978132, "post_id": 54098578, "comment_id": 95030780, "body": "look at the links on this answer <a href=\"https://stackoverflow.com/a/49548558/4539709\">stackoverflow.com/a/49548558/4539709</a>"}], "owner": {"reputation": 1, "user_id": 10782870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02226b7511072842cee1e46d02db4d6e?s=128&d=identicon&r=PG&f=1", "display_name": "Jason ", "link": "https://stackoverflow.com/users/10782870/jason"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1546976123, "creation_date": 1546976123, "question_id": 54098578, "link": "https://stackoverflow.com/questions/54098578/using-next-and-previous-buttons-in-vba", "title": "Using Next and Previous buttons in VBA", "body": "<p>I am trying to learn how to use VBA by watching YouTube. I created a userform in which has command buttons that you can look at next data and previous data that was inputted on the sheet. For some reason if I have another excel document open it is capturing that data as well. Does anyone know why it is doing that?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1546978501, "creation_date": 1546978501, "answer_id": 54099083, "question_id": 54098534, "link": "https://stackoverflow.com/questions/54098534/updating-an-excel-visual-basic-spreadsheet-generator-macro/54099083#54099083", "title": "Updating an Excel Visual Basic Spreadsheet Generator Macro", "body": "<p>Like this:</p>\n\n<pre><code>wsNew.Name = rngCrit\nwsNew.ListObjects.Add(xlSrcRange, wsNew.Range(\"A1\").CurrentRegion, , xlYes).Name = \"Table1\"\nwsNew.ListObjects(1).TableStyle = \"TableStyleMedium15\"\n'etc etc\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 10751099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaf74feb8c42b825484f38a66524230c?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan Hansen", "link": "https://stackoverflow.com/users/10751099/nathan-hansen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 21, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1546978501, "creation_date": 1546975929, "question_id": 54098534, "link": "https://stackoverflow.com/questions/54098534/updating-an-excel-visual-basic-spreadsheet-generator-macro", "title": "Updating an Excel Visual Basic Spreadsheet Generator Macro", "body": "<p>I use the following macro to split a spreadsheet and save the splits into individual files:</p>\n\n<pre><code>    Sub DistributeRows()\n    Dim wbNew As Workbook\n    Dim wsData As Worksheet\n    Dim wsCrit As Worksheet\n    Dim wsNew As Worksheet\n    Dim rngCrit As Range\n    Dim LastRow As Long\n\n    Set wsData = Worksheets(\"Sheet1\")\n    Set wsCrit = Worksheets.Add\n\n    LastRow = wsData.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n    wsData.Range(\"A1:A\" &amp; LastRow).AdvancedFilter Action:=xlFilterCopy, CopyToRange:=wsCrit.Range(\"A1\"), Unique:=True\n\n    Set rngCrit = wsCrit.Range(\"A2\")\n    While rngCrit.Value &lt;&gt; \"\"\n        Set wsNew = Worksheets.Add\n        wsData.Range(\"A1:AB\" &amp; LastRow).AdvancedFilter Action:=xlFilterCopy, CriteriaRange:=rngCrit.Offset(-1).Resize(2), CopyToRange:=wsNew.Range(\"A1\"), Unique:=True\n        wsNew.Name = rngCrit\n        wsNew.Copy\n        Set wbNew = ActiveWorkbook\n        wbNew.SaveAs \"C:\\Users\\nahansen\\Desktop\\Tornstrom Reports\\MMGS\" &amp; \"\\\" &amp; wsNew.Range(\"B2\") &amp; \"\\\" &amp; rngCrit &amp; \" - \" &amp; \"December 2018\"\n        wbNew.Close SaveChanges:=True\n        Application.DisplayAlerts = False\n        wsNew.Delete\n        rngCrit.EntireRow.Delete\n        Set rngCrit = wsCrit.Range(\"A2\")\n    Wend\n\n    wsCrit.Delete\n    Application.DisplayAlerts = True\nEnd Sub\n</code></pre>\n\n<p>I want to add some code to the while loop that will format the data as a table, such as Medium 15. I know the code has to go in the loop before the save statement, but I haven't been able to figure it out, as I am really new to VBA and I am modifying a macro someone else made and we've just been using by rote. The goal is to make it so we don't have to manually open hundreds of excel files and click on the format as table button.</p>\n\n<p>Any suggestions would be great.</p>\n"}]