[{"tags": ["html", "vba", "excel", "web-scraping"], "comments": [{"owner": {"reputation": 11755, "user_id": 4797603, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/AwTvE.jpg?s=128&g=1", "display_name": "Ronnie Royston", "link": "https://stackoverflow.com/users/4797603/ronnie-royston"}, "edited": false, "score": 1, "creation_date": 1463614676, "post_id": 37311575, "comment_id": 62144279, "body": "You&#39;ll want to use the MSXML library and do XHR to get the data you are after."}, {"owner": {"reputation": 307, "user_id": 5221266, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/6599b58fb516e1d9fa68956b52888301?s=128&d=identicon&r=PG&f=1", "display_name": "mrlemmer11", "link": "https://stackoverflow.com/users/5221266/mrlemmer11"}, "reply_to_user": {"reputation": 11755, "user_id": 4797603, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/AwTvE.jpg?s=128&g=1", "display_name": "Ronnie Royston", "link": "https://stackoverflow.com/users/4797603/ronnie-royston"}, "edited": false, "score": 0, "creation_date": 1463615168, "post_id": 37311575, "comment_id": 62144385, "body": "Ok, yes MSXML stuff looks familiar from my previous go at this type of stuff. I guess I need to learn how to use the MSXML2.XMLHTTP functions/features/objects (sorry not term savy) to be able to enter in my data into the form field and submit so that I can read/parse through the results..."}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1463618633, "post_id": 37311575, "comment_id": 62145234, "body": "How about using Power Query instead of VBA?"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1463667162, "post_id": 37311575, "comment_id": 62170866, "body": "It seems like you are just updating a database through a UI...can&#39;t you ask IT to just do an update query on the data set? Am I missing something?"}], "owner": {"reputation": 307, "user_id": 5221266, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/6599b58fb516e1d9fa68956b52888301?s=128&d=identicon&r=PG&f=1", "display_name": "mrlemmer11", "link": "https://stackoverflow.com/users/5221266/mrlemmer11"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 976, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1463614430, "creation_date": 1463613596, "last_edit_date": 1463614430, "question_id": 37311575, "link": "https://stackoverflow.com/questions/37311575/vba-web-scrape-into-excel-without-ie-open", "title": "VBA Web Scrape into Excel without IE open", "body": "<p>This is the code I have pieced together/written to launch a corporate site, adjust a drop down menu to \"SKU\", take the a SKU from column B in excel and hit the submit button. Afterwards, it find the 81st TD element and pastes that inner text into my excel and moves onto the next sku. </p>\n\n<p>The problem is that due to the query time, I need to wait 4 seconds for it to return data into the 81st TD element. With over 47k skus, this takes a long time to complete. I can multi box excel applications to 8 running an taking different chunks in increments of 6k each to spread the workload and this reduces my total run time to about 8 hours instead of 47 hours.</p>\n\n<p>Years ago, I was able to accomplish scraping data on thousands of pages without an IE window, but that was because each page contained the data in the html that I was directing excel to. Here, I only have 1 web address and it's the ASP query return results that I am interested in for each sku. </p>\n\n<p>Is there anyway to make this quicker by not running it inside of a IE window with regards to how i must enter data into a field each time in order to obtain my desired results for each sku? And also in regard to how the data I need is inside of the query return results?</p>\n\n<pre><code>Enum READYSTATE\nREADYSTATE_UNINITIALIZED = 0\nREADYSTATE_LOADING = 1\nREADYSTATE_LOADED = 2\nREADYSTATE_INTERACTIVE = 3\nREADYSTATE_COMPLETE = 4\nEnd Enum\n\nSub ImportZ2()\nDim ie As Object\nDim frm As Variant\nDim element As Variant\nDim subButton As Variant\nDim typeOption\nDim ws As Worksheet\nDim rowNumber, startRow, endRow, time1, time2, y, thisWebsite\nDim TDelements As IHTMLElementCollection\nDim TDelement As HTMLTableCell\nDim TD As Object\nDim LISTele As Variant\n\nthisWebsite = \"http://foo.bar.corporate.report.server\"\nstartRow = 1\nendRow = 6000\nrowNumber = startRow\n\nSet ws = ThisWorkbook.Worksheets(\"test\")\nSet ie = CreateObject(\"InternetExplorer.Application\")\n\nie.navigate thisWebsite\n\nWhile ie.READYSTATE &lt;&gt; 4: DoEvents: Wend\n\n\n    ie.Visible = False\n    Set typeOption = ie.document.getElementById(\"ctl32_ctl04_ctl03_ddValue\")\n\n\n    y = 5\n    colNumber = 6\n    rowNumber = rowNumber - 1\n    Do While rowNumber &lt; endRow\n        rowNumber = rowNumber + 1\n\n'this conditional allows the program to see if the data has already been\n'submitted for this sku, if it has then move on to the next sku, if their     \n'has been an error or no data entered yet, then it proceeds to submitting   \n'the query 'for this sku\n        If Len(ws.Cells(rowNumber, 6).Value) &lt; 30 Then\n\n'These IDs do not change. typeOption is a 2 choice dropdown and is required   \n'in order to search. frm is the field i enter my excel data into. subButton   \n'is to execute the search.\n            Set frm = ie.document.getElementById(\"ctl32_ctl04_ctl05_txtValue\")\n            Set subButton = ie.document.getElementById(\"ctl32_ctl04_ctl00\")\n\n            For Each LISTele In typeOption.getElementsByTagName(\"option\")\n                If LISTele.innerText = \"SKU\" Then LISTele.Selected = True: Exit For\n            Next\n\n            frm.Value = ws.Cells(rowNumber, 2).Value\n            subButton.Click\n\n'each query needs 4 seconds for the data in the 81st TD element to fully\n'load so i can put that into excel.\n            time1 = Now\n            time2 = Now + TimeValue(\"0:00:04\")\n            Do Until time1 &gt;= time2\n                DoEvents\n                time1 = Now()\n            Loop\n            Set TDelements = ie.document.getElementsByTagName(\"TD\")\n\n'query results do not have standard names, ids, or anything for the TD   \n'fields. each new query has different td information than the one prior.\n'example, i search 1 sku and the id for the 81st td = a838hs3bs80, i search \n'another sku or even the same one again and the id for the 81st td is now = \n'dj38s00283 \n\n'the only thing that stays the same is that its the 81st TD element that I   \n'want the innerText for\n            For Each TDelement In TDelements\n                If y &lt; 76 Then\n                    y = y + 1\n                Else\n                    If y &gt; 76 Then\n                        Exit For\n                    Else\n                        Debug.Print \"Processing row: \"; rowNumber\n                        ws.Cells(rowNumber, 6).Formula = Application.WorksheetFunction.Clean(TDelement.innerText)\n                        y = y + 1\n\n                        ws.Cells(rowNumber, 6).Select\n                    End If\n                End If\n                Next TDelement\n            Else\n            End If\n            y = 5\n        Loop\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1463612850, "post_id": 37311407, "comment_id": 62143856, "body": "You&#39;re using <code>R1C1</code> style, so just change that line to <code>Worksheets(&quot; Branded&quot;).Range(&quot;A1&quot;).FormulaR1C1</code>"}, {"owner": {"reputation": 333, "user_id": 6322284, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9eb44f00a59f8d34f5f0fb490313afd1?s=128&d=identicon&r=PG&f=1", "display_name": "TonyP", "link": "https://stackoverflow.com/users/6322284/tonyp"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1463613280, "post_id": 37311407, "comment_id": 62143954, "body": "@BruceWayne I am still getting the type mismatch error. I am also fine going completely away from R1C1 style. I am only doing it this way because I recorded a macro to get the basic part of the code."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1463613673, "post_id": 37311407, "comment_id": 62144068, "body": "You have a space in the worksheet name, is that the issue? <code>&quot; Branded&quot;</code> vs. <code>&quot;Branded&quot;</code>? (or perhaps the space in <code>&quot;]: [&quot;</code> should be <code>&quot;]:[&quot;</code>?"}, {"owner": {"reputation": 333, "user_id": 6322284, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9eb44f00a59f8d34f5f0fb490313afd1?s=128&d=identicon&r=PG&f=1", "display_name": "TonyP", "link": "https://stackoverflow.com/users/6322284/tonyp"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1463614291, "post_id": 37311407, "comment_id": 62144202, "body": "The space in the worksheet name is actually part of the name of the worksheet because of the way I created the worksheet. I did fix the other space though. It is still flagging the error though."}, {"owner": {"reputation": 103, "user_id": 5235105, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/54uMR.jpg?s=128&g=1", "display_name": "Wen21", "link": "https://stackoverflow.com/users/5235105/wen21"}, "edited": false, "score": 0, "creation_date": 1463618074, "post_id": 37311407, "comment_id": 62145099, "body": "try to use this: <code>Set r = Range(Selection, Selection.End(xlDown)) Set r2 = Range(Selection, Selection.End(xlDown))</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1463619058, "post_id": 37311407, "comment_id": 62145335, "body": "when using the range object in the formula remember that the defualt of the range object is its value, not its address.  So change the <code>r</code> and <code>r2</code> to <code>r.Address(1,1,xlR1C1)</code> and <code>r2.Address(1,1,xlR1C1)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 333, "user_id": 6322284, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9eb44f00a59f8d34f5f0fb490313afd1?s=128&d=identicon&r=PG&f=1", "display_name": "TonyP", "link": "https://stackoverflow.com/users/6322284/tonyp"}, "edited": false, "score": 0, "creation_date": 1463672401, "post_id": 37314117, "comment_id": 62175099, "body": "Brilliant. Thank you and Scott. This worked perfectly. I am officially one step closer to finally being done with this code!"}], "tags": [], "owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "is_accepted": true, "score": 1, "last_activity_date": 1463633192, "creation_date": 1463633192, "answer_id": 37314117, "question_id": 37311407, "link": "https://stackoverflow.com/questions/37311407/replacing-range-with-variables-syntax/37314117#37314117", "title": "Replacing range with variables syntax", "body": "<p>Your line is building a formula but passing a range into it instead of just the address of the range, use <code>.Address(ReferenceStyle:=xlR1C1</code>. Once that is there, remove the square parenthesis:-</p>\n\n<pre><code>Worksheets(\" Branded\").Range(\"A1\").Formula = \"=COUNTIFS(\" &amp; r.Address(ReferenceStyle:=xlR1C1) &amp; \":\" &amp; r2.Address(ReferenceStyle:=xlR1C1) &amp; \",RC2,R21C22:R71C22,R2C)\"\n</code></pre>\n\n<p>It shows up as a <code>#value</code> but then we don't have the full data set to test with.</p>\n"}, {"tags": [], "owner": {"reputation": 333, "user_id": 6322284, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9eb44f00a59f8d34f5f0fb490313afd1?s=128&d=identicon&r=PG&f=1", "display_name": "TonyP", "link": "https://stackoverflow.com/users/6322284/tonyp"}, "is_accepted": false, "score": 0, "last_activity_date": 1463680689, "creation_date": 1463680689, "answer_id": 37330793, "question_id": 37311407, "link": "https://stackoverflow.com/questions/37311407/replacing-range-with-variables-syntax/37330793#37330793", "title": "Replacing range with variables syntax", "body": "<p>I realized that I had made a mistake in the full line. With the above answer I figured out that it needs to be. </p>\n\n<pre><code> Worksheets(\" Branded\").Range(\"A1\").Formula = \"=COUNTIFS(\" &amp; r.Address(ReferenceStyle:=xlR1C1) &amp; \",RC2, \" &amp; r2.Address(ReferenceStyle:=xlR1C1) &amp; \",R2C)\"\n</code></pre>\n"}], "owner": {"reputation": 333, "user_id": 6322284, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9eb44f00a59f8d34f5f0fb490313afd1?s=128&d=identicon&r=PG&f=1", "display_name": "TonyP", "link": "https://stackoverflow.com/users/6322284/tonyp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 37314117, "answer_count": 2, "score": 0, "last_activity_date": 1463680689, "creation_date": 1463612402, "last_edit_date": 1463614369, "question_id": 37311407, "link": "https://stackoverflow.com/questions/37311407/replacing-range-with-variables-syntax", "title": "Replacing range with variables syntax", "body": "<p>I am trying to make a dynamic range to sort my database and I am getting a type mismatch error on the last line of this code. I am guessing it is coming from where I replaced the values with variables. Anyone have any tips on how to fix the syntax?</p>\n\n<pre><code>Sub Fake_Code()\nDim Row_Limit2 As Long\nDim Row_Limit1 As Long\nDim Current_Sheet As String\nDim r As Range\nDim r2 As Range\n\n    Cells.Find(What:=\"Title\", After:=ActiveCell, LookIn:=xlFormulas, _\n        LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n        MatchCase:=False, SearchFormat:=False).Activate\n        Range(Selection, Selection.End(xlDown)).Name = \"Range1\"\n            Set r = Range(\"Range1\")\n    Cells.Find(What:=\"Country\", After:=ActiveCell, LookIn:=xlFormulas, _\n        LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n        MatchCase:=False, SearchFormat:=False).Activate\n        Range(Selection, Selection.End(xlDown)).Name = \"Range2\"\n            Set r2 = Range(\"Range2\")\n\nRow_Limit1 = Worksheets(\" Branded\").Range(\"X:X\").Cells.SpecialCells(xlCellTypeConstants).Count\nRow_Limit2 = Worksheets(\" Branded\").Range(\"Y:Y\").Cells.SpecialCells(xlCellTypeConstants).Count\n\n'I need to make all of the below dynamic based on the variables above\n\nWorksheets(\" Branded\").Range(\"A1\").Formula = \"=COUNTIFS([\" &amp; r &amp; \"]: [\" &amp; r2 &amp; \"],RC2,R21C22:R71C22,R2C)\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 286, "user_id": 5261233, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/i5rHw.jpg?s=128&g=1", "display_name": "Histerical", "link": "https://stackoverflow.com/users/5261233/histerical"}, "edited": false, "score": 0, "creation_date": 1463610472, "post_id": 37311094, "comment_id": 62143180, "body": "Could you provide an example of what the code is working with?"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1463610622, "post_id": 37311094, "comment_id": 62143221, "body": "<i>VBA doesn&#39;t like my Do While</i> is not a problem description unless you tell us specificall what <i>VBA</i>  doesn&#39;t <b>like</b>. What does that mean <b>specifically</b>?"}, {"owner": {"reputation": 286, "user_id": 5261233, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/i5rHw.jpg?s=128&g=1", "display_name": "Histerical", "link": "https://stackoverflow.com/users/5261233/histerical"}, "edited": false, "score": 0, "creation_date": 1463610654, "post_id": 37311094, "comment_id": 62143235, "body": "Also if you want &quot;John Smith&quot; to equal &quot;John&quot; + &quot;Smith&quot;, you will need a space unless the cell value includes a space after &quot;John &quot;."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 3, "creation_date": 1463610849, "post_id": 37311094, "comment_id": 62143292, "body": "<code>&quot;John Smith&quot;</code> does not equal <code>&quot;John&quot; + &quot;Smith&quot;</code>.  In VBA <code>+</code> is only used for arithmetic.  You want <code>&quot;John&quot; &amp; &quot;Smith&quot;</code> since <code>&amp;</code> is the concatenation operator."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1463610945, "post_id": 37311094, "comment_id": 62143318, "body": "Do you plan on using the <code>For i = 1</code> loop? I don&#39;t think an <code>i</code> value is ever assigned?"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 1, "creation_date": 1463611256, "post_id": 37311094, "comment_id": 62143399, "body": "You have a <code>For Loop</code> that counts from <code>1 To Rows.Count</code> (but does nothing else) leaving <code>i</code> with a value of <code>Rows.Count + 1</code>.  You then have a <code>Do Loop</code> that tests values on row <code>i</code>.  But row <code>i</code> does not exist.  My guess is your <code>Do Loop</code> should be an <code>If</code> inside the <code>For Loop</code>."}, {"owner": {"reputation": 286, "user_id": 5261233, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/i5rHw.jpg?s=128&g=1", "display_name": "Histerical", "link": "https://stackoverflow.com/users/5261233/histerical"}, "reply_to_user": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1463611265, "post_id": 37311094, "comment_id": 62143402, "body": "@TonyDallimore makes an excellent point that I missed, but you will still need a space to make the concatenation work."}, {"owner": {"reputation": 286, "user_id": 5261233, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/i5rHw.jpg?s=128&g=1", "display_name": "Histerical", "link": "https://stackoverflow.com/users/5261233/histerical"}, "edited": false, "score": 0, "creation_date": 1463611406, "post_id": 37311094, "comment_id": 62143438, "body": "The <code>+</code> actually works for this code since he has added the <code>space(1)</code> in his code, but it is bad code, so it should be updated. Just thought I would note it."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 286, "user_id": 5261233, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/i5rHw.jpg?s=128&g=1", "display_name": "Histerical", "link": "https://stackoverflow.com/users/5261233/histerical"}, "edited": false, "score": 0, "creation_date": 1463611443, "post_id": 37311094, "comment_id": 62143448, "body": "@Histerical.  Whoops!  I notices the <code>+</code> but forgot the <code>&quot; &quot;</code> so &quot;John&quot; + &quot; &quot; + &quot;Smith&quot; or something simple variation."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 286, "user_id": 5261233, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/i5rHw.jpg?s=128&g=1", "display_name": "Histerical", "link": "https://stackoverflow.com/users/5261233/histerical"}, "edited": false, "score": 0, "creation_date": 1463611994, "post_id": 37311094, "comment_id": 62143593, "body": "@Histerical.  You are correct, <code>+</code> works for me with Excel 2016.  I cannot find anything in the documentation to justify this and I am sure it did not work with Excel 2003 which is the last version I used.  It will be Friday before I can find a copy of 2003 but I will report back when I can test this properly."}, {"owner": {"reputation": 3, "user_id": 6353333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3011a6c3dbabfdabc313d9c8108a1d1?s=128&d=identicon&r=PG&f=1", "display_name": "user6353333", "link": "https://stackoverflow.com/users/6353333/user6353333"}, "reply_to_user": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1463664978, "post_id": 37311094, "comment_id": 62168974, "body": "@TonyDallimore gets it. Thank you."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6353333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3011a6c3dbabfdabc313d9c8108a1d1?s=128&d=identicon&r=PG&f=1", "display_name": "user6353333", "link": "https://stackoverflow.com/users/6353333/user6353333"}, "edited": false, "score": 0, "creation_date": 1463663892, "post_id": 37311267, "comment_id": 62168036, "body": "That works, thank you. I tried using an If/Then function first with no success, but my it wouldn&#39;t work with my empty loop and (+) function."}], "tags": [], "owner": {"reputation": 206726, "user_id": 5459839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iehrR.jpg?s=128&g=1", "display_name": "trincot", "link": "https://stackoverflow.com/users/5459839/trincot"}, "is_accepted": true, "score": 1, "last_activity_date": 1463611517, "creation_date": 1463611517, "answer_id": 37311267, "question_id": 37311094, "link": "https://stackoverflow.com/questions/37311094/vba-code-for-conditional-loop/37311267#37311267", "title": "VBA Code for Conditional Loop", "body": "<p>Some issues:</p>\n\n<ul>\n<li>You must concatenate strings with <code>&amp;</code>. The plus (<code>+</code>) is for addition;</li>\n<li>Your <code>For</code> loop is not doing anything: its body is empty;</li>\n<li>Your <code>Do While</code> Loop will at most run once, because <code>i</code> is not incremented;</li>\n<li>It is a mystery why you would want two loops (<code>For</code> and <code>Do While</code>);</li>\n<li>A sheet has many rows of which you only use a fraction, so don't loop through all of them (<code>For</code>) and use <code>UsedRange</code>.</li>\n</ul>\n\n<p>Possible correction:</p>\n\n<pre><code>Sub ClearContentsLoop()\n    Dim i As Long\n\n    Application.ScreenUpdating = False\n    For i = 1 To ActiveSheet.UsedRange.Rows.Count\n        If Cells(i, 4).Value = Cells(i, 3).Value &amp; \" \" &amp; Cells(i, 2).Value Then\n            Cells(i, 4).ClearContents\n        End If\n    Next i\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 81, "user_id": 6023371, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HTTXG.png?s=128&g=1", "display_name": "UnEscapedCharacter", "link": "https://stackoverflow.com/users/6023371/unescapedcharacter"}, "is_accepted": false, "score": 0, "last_activity_date": 1463612093, "creation_date": 1463612093, "answer_id": 37311371, "question_id": 37311094, "link": "https://stackoverflow.com/questions/37311094/vba-code-for-conditional-loop/37311371#37311371", "title": "VBA Code for Conditional Loop", "body": "<p>There is a way to ignore the space in the values you are evaluating.  Try this:</p>\n\n<pre><code>Application.ScreenUpdating = False\n\n    Dim i As Long\n    For i = 1 To Rows.Count\n        If InStr(1, Cells(i, 4).Value, Cells(i, 2).Value, vbTextCompare) &gt; 0 And InStr(1, Cells(i, 4).Value, Cells(i, 3).Value, vbTextCompare) &gt; 0 Then Cells(i, 4).ClearContents\n    Next i\n\nApplication.ScreenUpdating = True\n</code></pre>\n\n<p><strong>Explanation:</strong></p>\n\n<p>By using the <strong>InStr</strong> function, you are testing for the presence of one text string inside of another, and if at least one match is found, then the function returns a non-zero value (the position where the match was found). In the above example, you are testing for the presence of the first name and last name at the same time, and if both are found, then the code clears out the contents of the cell.</p>\n\n<p>And, as was pointed out in the comments section, you need to do this inside the loop so that all cells down the length of the worksheet are evaluated and updated as specified.</p>\n\n<p>Be sure to test this on a COPY of your original data so that you don't lose the original values in case you want to roll back your changes!  ;)</p>\n"}], "owner": {"reputation": 3, "user_id": 6353333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3011a6c3dbabfdabc313d9c8108a1d1?s=128&d=identicon&r=PG&f=1", "display_name": "user6353333", "link": "https://stackoverflow.com/users/6353333/user6353333"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1127, "favorite_count": 0, "accepted_answer_id": 37311267, "answer_count": 2, "score": -1, "last_activity_date": 1463665230, "creation_date": 1463610374, "last_edit_date": 1463665230, "question_id": 37311094, "link": "https://stackoverflow.com/questions/37311094/vba-code-for-conditional-loop", "title": "VBA Code for Conditional Loop", "body": "<p>I am trying to create a conditional loop macro in Excel. Column B contains a last name, Column C contains a first name, and Column D contains a first and last name. I am trying to get the macro to detect when Column D = Column C + Column B.</p>\n\n<p>If D = C + B, then clear contents of D. </p>\n\n<p>So, the following works for a single row:</p>\n\n<pre><code>Sub ClearContentsD ()\n\nIf Range(\"D1\").Value = Range(\"C1\").Value + Space(1) + Range(\"B1\") Then Range(\"D1\").ClearContents\n\nEnd Sub\n</code></pre>\n\n<p>It does not work without the added Space(1), and I cannot get it to loop through the whole worksheet:</p>\n\n<pre><code>Sub ClearContentsLoop()\n\nApplication.ScreenUpdating = False\n\n    Dim i As Long\n    For i = 1 To Rows.Count\n\n    Next i\n\nDo While Cells(i, 4).Value = Cells(i, 3).Value + Space(1) + Cells(i, 2).Value\nCells(i, 4).ClearContents\n\nLoop\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>VBA doesn't like my Do While. Any help would be greatly appreciated. </p>\n\n<p>CJ</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 286, "user_id": 5261233, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/i5rHw.jpg?s=128&g=1", "display_name": "Histerical", "link": "https://stackoverflow.com/users/5261233/histerical"}, "edited": false, "score": 0, "creation_date": 1463610379, "post_id": 37310955, "comment_id": 62143150, "body": "I also tested both of your codes and they work just fine for me. I would still make the change I recommended in my answer. It is best to avoid <code>select</code> statements unless they are necessary."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6253382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4de423fe33a75808326ebeb6f5ba80f6?s=128&d=identicon&r=PG&f=1", "display_name": "Minute", "link": "https://stackoverflow.com/users/6253382/minute"}, "edited": false, "score": 0, "creation_date": 1463777458, "post_id": 37311004, "comment_id": 62226633, "body": "Thank you Histerical! changing it to just Row(NG) fixed it. I also removed the .select like you suggested."}], "tags": [], "owner": {"reputation": 286, "user_id": 5261233, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/i5rHw.jpg?s=128&g=1", "display_name": "Histerical", "link": "https://stackoverflow.com/users/5261233/histerical"}, "is_accepted": true, "score": 0, "last_activity_date": 1463609859, "creation_date": 1463609859, "answer_id": 37311004, "question_id": 37310955, "link": "https://stackoverflow.com/questions/37310955/excel-vba-row-select-with-variables-not-working-on-merged-cells-but-does-witho/37311004#37311004", "title": "Excel VBA: Row select with variables not working on merged cells, but does without variables", "body": "<p>Change:</p>\n\n<pre><code>Rows(NG &amp; \":\" &amp; NG).Select\nSelection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n</code></pre>\n\n<p>To:</p>\n\n<pre><code>Rows(NG).insert shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n</code></pre>\n\n<p><code>Rows</code> only needs 1 number in order for it to run, unless you have more than 1 row you are using.</p>\n"}], "owner": {"reputation": 13, "user_id": 6253382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4de423fe33a75808326ebeb6f5ba80f6?s=128&d=identicon&r=PG&f=1", "display_name": "Minute", "link": "https://stackoverflow.com/users/6253382/minute"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 265, "favorite_count": 0, "accepted_answer_id": 37311004, "answer_count": 1, "score": 1, "last_activity_date": 1463609859, "creation_date": 1463609560, "last_edit_date": 1531161705, "question_id": 37310955, "link": "https://stackoverflow.com/questions/37310955/excel-vba-row-select-with-variables-not-working-on-merged-cells-but-does-witho", "title": "Excel VBA: Row select with variables not working on merged cells, but does without variables", "body": "<p>I have two macros that should do the same thing, but they don't. The recorded macro works correctly and is what I am trying to emulate, but for some reason when I add in my variables it doesn't work the same way.</p>\n\n<p>This is the recorded macro:</p>\n\n<pre><code>Sub Macro8()\nRows(\"42:42\").Select\nSelection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\nEnd Sub\n</code></pre>\n\n<p>This works correctly when I run it. When I have a merged cell from F30:F42, it inserts the row and the merged cell then goes from F30:F43.</p>\n\n<p>This is my version:</p>\n\n<pre><code>Sub NewLine()\n\nDim NG As Long\nDim LRA As Long\nLRA = 0\n\nLRA = Range(\"C\" &amp; ActiveSheet.Rows.Count).End(xlUp).Row\n\nNG = LRA + 13 ' The 13 rows here are where I would enter my findings in\n\nRows(NG &amp; \":\" &amp; NG).Select\nSelection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n\nEnd Sub\n</code></pre>\n\n<p>NG = LRA + 13 correctly returns 42. The next line however selects rows 30 to 42, instead of just row 42. Because that line select 13 rows, it creates 13 rows on the next line of the macro.</p>\n\n<p>Unless my use of (NG &amp; \":\" &amp; NG) to replace (\"42:42\"), is incorrect, should it not do the same thing in both cases?</p>\n\n<p>Thanks in advance for any input, this is driving me nuts.</p>\n"}, {"tags": ["excel", "pivot-table", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1549, "user_id": 5896420, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/b86Xv.png?s=128&g=1", "display_name": "luckyguy73", "link": "https://stackoverflow.com/users/5896420/luckyguy73"}, "is_accepted": false, "score": 0, "last_activity_date": 1463634983, "creation_date": 1463634983, "answer_id": 37314415, "question_id": 37310876, "link": "https://stackoverflow.com/questions/37310876/using-filtertype-xlvalueisgreaterthan-in-excel-2016-vba/37314415#37314415", "title": "Using FilterType:=xlValueIsGreaterThan in Excel 2016 VBA", "body": "<p>test this in place of your last with statement</p>\n\n<pre><code>with .PivotFields(\"Name\").PivotFilters.Add2 _\n    Type:=xlValueIsGreaterThan, DataField:=ActiveSheet.PivotTables( _\n    \"PivotTable1\").PivotFields(\"Sum of Order Amount\"), Value1:=4000000\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5216974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d1f3e6be7b7b99d38dff1a0c95471ce?s=128&d=identicon&r=PG&f=1", "display_name": "Omer", "link": "https://stackoverflow.com/users/5216974/omer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 539, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1463634983, "creation_date": 1463609187, "last_edit_date": 1531161705, "question_id": 37310876, "link": "https://stackoverflow.com/questions/37310876/using-filtertype-xlvalueisgreaterthan-in-excel-2016-vba", "title": "Using FilterType:=xlValueIsGreaterThan in Excel 2016 VBA", "body": "<p>I have a table that looks like this </p>\n\n<pre><code>Name    Order Amount    Location\nGrace       120000       new jersey\nTom         200000       baltimore\nRick       5000000       hyderabad\nHari        600000       denver\nRaj        4000000       Delhi\nVictoria    300000       New York\n</code></pre>\n\n<p>I created a pivot with all 3 fields but I cannot successfully use the \nPivotFilters.Add FilterType:=xlValueIsGreaterThan </p>\n\n<p>option successfully...what I wrong with my code?</p>\n\n<pre><code> Sub addFields()\n  With ActiveSheet.PivotTables(1)\n'First row field\n  With .PivotFields(\"Name\")\n .Orientation = xlRowField\n .Position = 1\n  End With\n\n 'Report Filter field\n With .PivotFields(\"Location\")\n .Orientation = xlPageField\n  .Position = 1\n   End With\n\n  'Order Amount or numerical data  in the Values field\n   .AddDataField ActiveSheet.PivotTables(1).PivotFields(\"Order Amount\"), _\n   \"Sum of Amount\", xlSum\n   End With\n\n\n With .PivotFields(\"Sum of Amount\").PivotFilters.Add    filterType:=xlValueIsGreaterThan  DataField :=\"Sum of Amount\" value1:=4000000\n\n\n\n\n End With\n\n  End Sub\n</code></pre>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 286, "user_id": 5261233, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/i5rHw.jpg?s=128&g=1", "display_name": "Histerical", "link": "https://stackoverflow.com/users/5261233/histerical"}, "edited": false, "score": 0, "creation_date": 1463608716, "post_id": 37310462, "comment_id": 62142546, "body": "So you need to be on a specific cell when F2 is pressed?"}, {"owner": {"reputation": 1, "user_id": 6353222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cb9b8d320edc5e4d762c5b2877f10b9?s=128&d=identicon&r=PG&f=1", "display_name": "TMoon", "link": "https://stackoverflow.com/users/6353222/tmoon"}, "reply_to_user": {"reputation": 286, "user_id": 5261233, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/i5rHw.jpg?s=128&g=1", "display_name": "Histerical", "link": "https://stackoverflow.com/users/5261233/histerical"}, "edited": false, "score": 0, "creation_date": 1463672272, "post_id": 37310462, "comment_id": 62175009, "body": "No I just need to hit f2 on every cell in the I Column... I chose I12 as a test because that had a date that failed when we try the upload to the customer portal."}, {"owner": {"reputation": 286, "user_id": 5261233, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/i5rHw.jpg?s=128&g=1", "display_name": "Histerical", "link": "https://stackoverflow.com/users/5261233/histerical"}, "edited": false, "score": 0, "creation_date": 1463672921, "post_id": 37310462, "comment_id": 62175502, "body": "Sorry guess I should explain my question more, when F2 is pressed does a cell have to be selected. For instance if you just press F2 at the same spot in the code, but don&#39;t change what cell is selected, will that make a difference? Or does the individual cells need to be selected when F2 is pressed?"}, {"owner": {"reputation": 1, "user_id": 6353222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cb9b8d320edc5e4d762c5b2877f10b9?s=128&d=identicon&r=PG&f=1", "display_name": "TMoon", "link": "https://stackoverflow.com/users/6353222/tmoon"}, "reply_to_user": {"reputation": 286, "user_id": 5261233, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/i5rHw.jpg?s=128&g=1", "display_name": "Histerical", "link": "https://stackoverflow.com/users/5261233/histerical"}, "edited": false, "score": 0, "creation_date": 1463676082, "post_id": 37310462, "comment_id": 62177554, "body": "Well I believe it would need to be selected.. we have tried everything from reformatting the column to cutting and pasting just values, etc.. nothing works for the file upload to the customers portal.   So we literally have to go into the ship Date column and hit f2 then enter for the entire file (often 1000 lines) then save it then upload it."}, {"owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "edited": false, "score": 0, "creation_date": 1463972991, "post_id": 37310462, "comment_id": 62274972, "body": "@TMoon  I believe that in Excel the F2 just puts the active cell into edit mode-- you can then change it.  Is that what F2 is doing for you?  What is in the cell before you press F2? and what is it changed to after you press F2?  What part of the date is causing failure?  What part of the program creates that date?"}, {"owner": {"reputation": 1, "user_id": 6353222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cb9b8d320edc5e4d762c5b2877f10b9?s=128&d=identicon&r=PG&f=1", "display_name": "TMoon", "link": "https://stackoverflow.com/users/6353222/tmoon"}, "edited": false, "score": 0, "creation_date": 1464026811, "post_id": 37310462, "comment_id": 62303888, "body": "It is very strange on how this file is reacting.   I read in a file from their portal then check various thing in our system then determine an Estimated ship Date if one is not already present in the file.   When the date gets put into the table then extracted to Excel it is in the format of MM/DD/YY.   However when we upload it to the customers portal, all records where we put in a date bomb out on the upload."}, {"owner": {"reputation": 1, "user_id": 6353222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cb9b8d320edc5e4d762c5b2877f10b9?s=128&d=identicon&r=PG&f=1", "display_name": "TMoon", "link": "https://stackoverflow.com/users/6353222/tmoon"}, "edited": false, "score": 0, "creation_date": 1464026821, "post_id": 37310462, "comment_id": 62303895, "body": "We have tried everything in excel to changing the format of the columns to cutting the data and pasting as values, etc.. nothing works except selecting the sell and hitting F2.   we have noticed that it will change a date of 05/30/16 to 5/30/16 once the cell is selected and F2 is pressed."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6353222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cb9b8d320edc5e4d762c5b2877f10b9?s=128&d=identicon&r=PG&f=1", "display_name": "TMoon", "link": "https://stackoverflow.com/users/6353222/tmoon"}, "edited": false, "score": 0, "creation_date": 1463672203, "post_id": 37311039, "comment_id": 62174960, "body": "Thank you for the very quick reply.   I have tried the solution however I still get the &quot;Object does not support this property or method&quot;  could it be because I am launching Excel from an access form?"}], "tags": [], "owner": {"reputation": 1192, "user_id": 1744727, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8d02d3ecefb127c4467e9328308ffb12?s=128&d=identicon&r=PG", "display_name": "David", "link": "https://stackoverflow.com/users/1744727/david"}, "is_accepted": false, "score": 0, "last_activity_date": 1464002901, "last_edit_date": 1464002901, "creation_date": 1463610025, "answer_id": 37311039, "question_id": 37310462, "link": "https://stackoverflow.com/questions/37310462/ms-access-vba-to-open-an-excel-file-then-go-to-column-i-and-send-command-f2-and/37311039#37311039", "title": "MS Access VBA to Open an Excel file then go to Column I and send command F2 and Enter", "body": "<p>Basically sendkeys isn't a method of the range object. Sendkeys just sends strokes to applications. Try the method with this code:</p>\n\n<pre><code>Sub test()\n    Sheets(\"Sheet1\").Activate\n    Range(\"I12\").Select\n    Do\n        Application.SendKeys (\"{F2}\")\n        ActiveCell(2, 1).Select\n    Loop Until ActiveCell.Value = \"\"\nEnd Sub\n</code></pre>\n\n<p>Before this will work successfully, you may need to make sure that your Excel workbook is the active application, on top of all else.</p>\n\n<p>EDIT: You explained it wouldn't work, yes it's because you're launching from Access, so those steps need to be aimed at Excel. I used a sample provided by Trevor G <a href=\"http://www.access-programmers.co.uk/forums/showthread.php?t=251416\" rel=\"nofollow\">here</a> to build an example. This will get us closer to the goal, but I don't think it's a total solution yet:</p>\n\n<pre><code>Option Compare Database\n\nSub excelExport()\n    'Step 1: Declare variables\n    Dim MyDatabase As DAO.Database\n    Dim MyQueryDef As DAO.QueryDef\n    Dim MyRecordset As DAO.Recordset\n    'Step 2: Identify the database and query\n    Set MyDatabase = CurrentDb\n    Set MyQueryDef = MyDatabase.QueryDefs(\"Table1 Query\") 'Query name in the database\n    'Step 3: Open the query\n    Set MyRecordset = MyQueryDef.OpenRecordset\n\n    'Step 4: Create Excel\n    Dim xlApp As Object\n    Set xlApp = CreateObject(\"Excel.Application\")\n\n    Set objShell = CreateObject(\"WScript.Shell\")\n    objShell.AppActivate \"Microsoft Excel\"\n\n    With xlApp\n        .Visible = True\n        .Workbooks.Add\n        .Sheets(\"Sheet1\").Select\n        .Sheets(\"Sheet1\").Activate\n        'Step 5: Copy the recordset to Excel\n        .ActiveSheet.Range(\"A2\").CopyFromRecordset MyRecordset\n        'Step 6: Add column heading names to the spreadsheet\n        'For i = 1 To MyRecordset.Fields.Count\n        'xlApp.ActiveSheet.Cells(1, i).Value = MyRecordset.Fields(i - 1).Name\n        'Next i\n        .Cells.EntireColumn.AutoFit\n\n        .Range(\"A2\").Select\n\n        Do\n            .Application.SendKeys (\"{F2}\")\n            .Application.SendKeys (\"{ENTER}\")\n            .ActiveCell(2, 1).Select\n        Loop Until .ActiveCell.Value = \"\"\n\n    End With\nEnd Sub\n</code></pre>\n\n<p>I found that when F2 is first pressed, Excel becomes locked and no further code seems to run... but hitting enter once seems to help it along. I think to make the \"F2+enter\" loop work though, we may need to create and run an external VBScript (that can send the keys indiscriminately). However, when I tried to do this, I struggled to get the VBS to successfully bring Excel to front, which seems to be a common problem.</p>\n"}], "owner": {"reputation": 1, "user_id": 6353222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cb9b8d320edc5e4d762c5b2877f10b9?s=128&d=identicon&r=PG&f=1", "display_name": "TMoon", "link": "https://stackoverflow.com/users/6353222/tmoon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1375, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1464002901, "creation_date": 1463607228, "last_edit_date": 1463613980, "question_id": 37310462, "link": "https://stackoverflow.com/questions/37310462/ms-access-vba-to-open-an-excel-file-then-go-to-column-i-and-send-command-f2-and", "title": "MS Access VBA to Open an Excel file then go to Column I and send command F2 and Enter", "body": "<p>I have an access program that reads in a customer file and provides dates on when orders will be shipped.  The file needs to be fed back into the customers portal in a specific format.   When I change the date in the file to be fed back I have to go to the shipdate field and hit F2 then enter for the file to upload successfully.   often there are over 1000 lines that this needs to be done to.   When I run the code from access to export the table and open excel I receive the error  </p>\n\n<blockquote>\n  <p>\"Object does not support this property or method\"  </p>\n</blockquote>\n\n<p>Everything does change to <strong>BOLD</strong> however if I try to do a sendkey to the entire spreadsheet or a specific cell, I get the error...<br>\nAny help would be greatly appreciated, I have tried about everything and ready to pull my hair out. </p>\n\n<pre><code>.Range(.cells(1, 1), .cells(lngMaxRow + 1, lngMaxCol)).Font.Bold = True\n.Range(.cells(1, 1), .cells(lngMaxRow + 1, lngMaxCol)).SendKeys \"{F2}\", True\n.Range(\"I12\").SendKeys \"{F2}\", True\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 2, "creation_date": 1463605742, "post_id": 37310123, "comment_id": 62141288, "body": "Try <code>Set r = range(&quot;Win&quot;)</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 2, "creation_date": 1463605793, "post_id": 37310123, "comment_id": 62141308, "body": "@findwindow Dude I wish you would answer some of these.  we need to get you above 2000 so you can edit the questions."}, {"owner": {"reputation": 333, "user_id": 6322284, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9eb44f00a59f8d34f5f0fb490313afd1?s=128&d=identicon&r=PG&f=1", "display_name": "TonyP", "link": "https://stackoverflow.com/users/6322284/tonyp"}, "edited": false, "score": 0, "creation_date": 1463605889, "post_id": 37310123, "comment_id": 62141346, "body": "Brilliant. That got rid of my error message. When I mouse over the r to see if the code picked it up it isn&#39;t showing the name or anything. Is there a different way to check to see if it is working besides using the variable?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 2, "creation_date": 1463605972, "post_id": 37310123, "comment_id": 62141377, "body": "<code>for each c in r | debug.print c | next</code>?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1463605983, "post_id": 37310123, "comment_id": 62141382, "body": "You could <code>Debug.Print r.Address</code> it will show you the range address in the immediate window."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1463606029, "post_id": 37310123, "comment_id": 62141410, "body": "@ScottCraner it&#39;s not really deserving of points/more of a comment."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1463606131, "post_id": 37310123, "comment_id": 62141455, "body": "@findwindow I disagree, It corrected the problem.  So defacto it was the correct answer and would close this question off the unanswered list."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1463606184, "post_id": 37310123, "comment_id": 62141480, "body": "@ScottCraner well, this has been answered a million times before. Besides, I am just here to troll."}, {"owner": {"reputation": 333, "user_id": 6322284, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9eb44f00a59f8d34f5f0fb490313afd1?s=128&d=identicon&r=PG&f=1", "display_name": "TonyP", "link": "https://stackoverflow.com/users/6322284/tonyp"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 2, "creation_date": 1463606207, "post_id": 37310123, "comment_id": 62141487, "body": "It is working perfectly. Thank you both very much. @Findwindow I have found out that if you are online my questions get answered much more clearly and quickly than any other time.."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1463606324, "post_id": 37310123, "comment_id": 62141545, "body": "@TonyP lol I am pretty sure you mean Scott."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1463606362, "post_id": 37310123, "comment_id": 62141566, "body": "Tony - please come back in ten minutes and mark @findwindow answer as correct, so this can be removed from the unanswered queue."}, {"owner": {"reputation": 333, "user_id": 6322284, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9eb44f00a59f8d34f5f0fb490313afd1?s=128&d=identicon&r=PG&f=1", "display_name": "TonyP", "link": "https://stackoverflow.com/users/6322284/tonyp"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1463606401, "post_id": 37310123, "comment_id": 62141583, "body": "@findwindow Actually you are the only one to ever answer my questions. This is the first time I have seen Scott."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1463606460, "post_id": 37310123, "comment_id": 62141617, "body": "@TonyP !!!!!! well, you&#39;re missing out. Scott&#39;s far far better than I."}, {"owner": {"reputation": 333, "user_id": 6322284, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9eb44f00a59f8d34f5f0fb490313afd1?s=128&d=identicon&r=PG&f=1", "display_name": "TonyP", "link": "https://stackoverflow.com/users/6322284/tonyp"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1463606468, "post_id": 37310123, "comment_id": 62141620, "body": "@ScottCraner I am planning on it. If my questions get answered I never leave them unanswered.  Would either of you be willing to help me with the next step in my code? I need to figure out how to put the variables I just created in my other code."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1463606574, "post_id": 37310123, "comment_id": 62141664, "body": "@findwindow that depends on what you are asking.  I personally am doing as little as possible right now."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1463606658, "post_id": 37310123, "comment_id": 62141707, "body": "@TonyP please ask a new question."}, {"owner": {"reputation": 333, "user_id": 6322284, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9eb44f00a59f8d34f5f0fb490313afd1?s=128&d=identicon&r=PG&f=1", "display_name": "TonyP", "link": "https://stackoverflow.com/users/6322284/tonyp"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1463606691, "post_id": 37310123, "comment_id": 62141723, "body": "Am I doing what? @findwindow"}], "answers": [{"comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1463607520, "post_id": 37310244, "comment_id": 62142080, "body": "lol This is so not worth 4 upvotes. I mean, <a href=\"http://stackoverflow.com/questions/34028430/deleting-via-autofilter-takes-too-long\">this</a> only got the same number of votes and is much much more impressive. Edit: also, whoever did that left me a comment but deleted it before I can catch it..."}, {"owner": {"reputation": 81, "user_id": 6023371, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HTTXG.png?s=128&g=1", "display_name": "UnEscapedCharacter", "link": "https://stackoverflow.com/users/6023371/unescapedcharacter"}, "edited": false, "score": 0, "creation_date": 1463608222, "post_id": 37310244, "comment_id": 62142351, "body": "LOL  do you want me to downvote it?   I won&#39;t do it unless you&#39;re OK with that..."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 81, "user_id": 6023371, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HTTXG.png?s=128&g=1", "display_name": "UnEscapedCharacter", "link": "https://stackoverflow.com/users/6023371/unescapedcharacter"}, "edited": false, "score": 0, "creation_date": 1463608322, "post_id": 37310244, "comment_id": 62142393, "body": "@UnEscapedCharacter I am ok with that."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1463608396, "post_id": 37310244, "comment_id": 62142418, "body": "@DirkReichel are you doing that?"}, {"owner": {"reputation": 81, "user_id": 6023371, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HTTXG.png?s=128&g=1", "display_name": "UnEscapedCharacter", "link": "https://stackoverflow.com/users/6023371/unescapedcharacter"}, "edited": false, "score": 0, "creation_date": 1463608531, "post_id": 37310244, "comment_id": 62142470, "body": "@findwindow just tried that but I guess I am still too new on SO but thanks for your support, feel free to return the favor anytime, LOL"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 81, "user_id": 6023371, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HTTXG.png?s=128&g=1", "display_name": "UnEscapedCharacter", "link": "https://stackoverflow.com/users/6023371/unescapedcharacter"}, "edited": false, "score": 0, "creation_date": 1463608601, "post_id": 37310244, "comment_id": 62142503, "body": "@UnEscapedCharacter oh. So you can upvote but not down... come back when you can^^"}], "tags": [], "owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "is_accepted": true, "score": 6, "last_activity_date": 1463608309, "last_edit_date": 1463608309, "creation_date": 1463606215, "answer_id": 37310244, "question_id": 37310123, "link": "https://stackoverflow.com/questions/37310123/naming-dynamic-range-and-turning-it-into-a-variable/37310244#37310244", "title": "Naming Dynamic Range and turning it into a variable", "body": "<p>Because Scott says so. Try <code>Set r = range(\"Win\")</code></p>\n\n<p>To test if <code>r</code> picked up the range correctly, one could do</p>\n\n<pre><code>for each c in r\n    debug.print c\nnext\n</code></pre>\n\n<p>Edit: or if you're cool like Dirk,</p>\n\n<pre><code>Set r = [Win]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 81, "user_id": 6023371, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HTTXG.png?s=128&g=1", "display_name": "UnEscapedCharacter", "link": "https://stackoverflow.com/users/6023371/unescapedcharacter"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 2, "creation_date": 1463607232, "post_id": 37310349, "comment_id": 62141961, "body": "Glad to help, just don&#39;t forget to keep track of all the object variables in the code... give them a name that is easy to understand, like &quot;rngMyEmployeeStatus&quot; and so on...!  ;)"}], "tags": [], "owner": {"reputation": 81, "user_id": 6023371, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HTTXG.png?s=128&g=1", "display_name": "UnEscapedCharacter", "link": "https://stackoverflow.com/users/6023371/unescapedcharacter"}, "is_accepted": false, "score": 5, "last_activity_date": 1463606702, "creation_date": 1463606702, "answer_id": 37310349, "question_id": 37310123, "link": "https://stackoverflow.com/questions/37310123/naming-dynamic-range-and-turning-it-into-a-variable/37310349#37310349", "title": "Naming Dynamic Range and turning it into a variable", "body": "<p>Replace the code with this:</p>\n\n<pre><code>    Dim r As Range\nCells.Find(What:=\"EE status\", After:=ActiveCell, LookIn:=xlFormulas, _\n    LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n    MatchCase:=False, SearchFormat:=False).Activate\nSet r = Range(Selection, Selection.End(xlDown))\nr.Name = \"Win\"\n</code></pre>\n\n<p><strong>Explanation:</strong></p>\n\n<p>You cannot use the SET command with the name property of the range object.  The object needs to be populated with the range selection first, then you can just use the property of the object to assign a value to it, in this case the Name property of it.</p>\n\n<p>Hope that helps!</p>\n"}], "owner": {"reputation": 333, "user_id": 6322284, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9eb44f00a59f8d34f5f0fb490313afd1?s=128&d=identicon&r=PG&f=1", "display_name": "TonyP", "link": "https://stackoverflow.com/users/6322284/tonyp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 37310244, "answer_count": 2, "score": 2, "last_activity_date": 1463608309, "creation_date": 1463605660, "question_id": 37310123, "link": "https://stackoverflow.com/questions/37310123/naming-dynamic-range-and-turning-it-into-a-variable", "title": "Naming Dynamic Range and turning it into a variable", "body": "<p>I am trying to name a range based on a .Find then define that range as my variable so I can enter the variable into a different function. When I run the code I get a type mismatch error.</p>\n\n<pre><code>Sub Faked()\nDim r As Range\nCells.Find(What:=\"EE status\", After:=ActiveCell, LookIn:=xlFormulas, _\n    LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n    MatchCase:=False, SearchFormat:=False).Activate\n    Range(Selection, Selection.End(xlDown)).Name = \"Win\"\nSet r = (\"Win\")\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "type-conversion", "vba"], "comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1463605407, "post_id": 37310007, "comment_id": 62141104, "body": "have you looked at Workbook.UsedRange"}, {"owner": {"reputation": 123, "user_id": 6190062, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ecacb85aa6e43a64450919689ec38b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Davey ", "link": "https://stackoverflow.com/users/6190062/davey"}, "reply_to_user": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1463605472, "post_id": 37310007, "comment_id": 62141139, "body": "I looked into that but I thought that selected all cells with values in the workbook. Wasn&#39;t sure how to apply that to just 1 column"}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1463605599, "post_id": 37310007, "comment_id": 62141203, "body": "Workbook.UsedRange.Rows.Count = now you have the total number of rows and you can just set the column."}, {"owner": {"reputation": 123, "user_id": 6190062, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ecacb85aa6e43a64450919689ec38b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Davey ", "link": "https://stackoverflow.com/users/6190062/davey"}, "reply_to_user": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1463605889, "post_id": 37310007, "comment_id": 62141345, "body": "Sorry I&#39;m still new to VBA, and this is probably a dumb question, but what do you mean to set the column? If I know that then I can proceed with the rest"}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1463606018, "post_id": 37310007, "comment_id": 62141402, "body": "Something like EmailAddresses = Join(Application.Transpose(Range(&quot;P2:P&quot; &amp; Cstr(ActiveWorkbook.UsedRange.Rows.Count) ).Value), &quot;; &quot;)"}, {"owner": {"reputation": 123, "user_id": 6190062, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ecacb85aa6e43a64450919689ec38b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Davey ", "link": "https://stackoverflow.com/users/6190062/davey"}, "reply_to_user": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1463606273, "post_id": 37310007, "comment_id": 62141521, "body": "I got a runtime error &#39;438&#39; Object does not support this property or method, with that line of code highlighted"}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 1, "creation_date": 1463606430, "post_id": 37310007, "comment_id": 62141600, "body": "My bad, UsedRange is a worksheet property not a workbook Try: EmailAddresses = Join(Application.Transpose(Range(&quot;P2:P&quot; &amp; Cstr(ActiveSheet.UsedRange.Rows.Count) ).Value), &quot;; &quot;)"}, {"owner": {"reputation": 123, "user_id": 6190062, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ecacb85aa6e43a64450919689ec38b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Davey ", "link": "https://stackoverflow.com/users/6190062/davey"}, "reply_to_user": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1463606780, "post_id": 37310007, "comment_id": 62141760, "body": "Thank you so much! That did the job, everything worked perfectly!"}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 1, "last_activity_date": 1463608224, "last_edit_date": 1463608224, "creation_date": 1463607171, "answer_id": 37310445, "question_id": 37310007, "link": "https://stackoverflow.com/questions/37310007/converting-a-dynamic-range-into-a-string-type/37310445#37310445", "title": "Converting a Dynamic Range into a string type", "body": "<p>If the addresses are not the result of formulas, try a simple loop:</p>\n\n<pre><code>Sub dural()\n    Dim EmailAddresses As String\n    EmailAddresses = \"\"\n    For Each r In Range(\"P:P\").Cells.SpecialCells(xlCellTypeConstants)\n        If r.Value &lt;&gt; \"\" Then\n            EmailAddresses = EmailAddresses &amp; \";\" &amp; r.Value\n        End If\n    Next r\n    EmailAddresses = Mid(EmailAddresses, 2)\nEnd Sub\n</code></pre>\n\n<p>You might even do away with the test against <strong>\"\"</strong> if there are no <em>Nulls</em> in the column.</p>\n"}], "owner": {"reputation": 123, "user_id": 6190062, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ecacb85aa6e43a64450919689ec38b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Davey ", "link": "https://stackoverflow.com/users/6190062/davey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "accepted_answer_id": 37310445, "answer_count": 1, "score": 0, "last_activity_date": 1463608224, "creation_date": 1463605187, "last_edit_date": 1531164843, "question_id": 37310007, "link": "https://stackoverflow.com/questions/37310007/converting-a-dynamic-range-into-a-string-type", "title": "Converting a Dynamic Range into a string type", "body": "<p>I have a column of string types (email addresses) that potentially can change in length, in that people can add or remove email addresses in this column. (The range of the column is dynamic) Currently, I have code that takes a fixed range and converts the range into a long string delimited by semicolons. Is there a way that I can grab all the cells with values in this column and convert the range into a string type?</p>\n\n<p>My current code</p>\n\n<pre><code>EmailAddresses = Join(Application.Transpose(Range(\"P2:P12\").Value), \"; \")\n</code></pre>\n\n<p>If I change the range to \"P:P\" I receive a runtime error that I'm out of memory...given that it's making a string out of blank cells</p>\n"}, {"tags": ["excel", "vba", "charts", "colors"], "answers": [{"comments": [{"owner": {"reputation": 906, "user_id": 3876796, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6baa712de45532fa50e686c8e26debee?s=128&d=identicon&r=PG&f=1", "display_name": "Othmane", "link": "https://stackoverflow.com/users/3876796/othmane"}, "edited": false, "score": 0, "creation_date": 1463621248, "post_id": 37311339, "comment_id": 62145882, "body": "Yes I have also tried with it but it still gives a black color, so it doesn&#39;t work. This is pretty bizarre! I don&#39;t know what to do, I have seen somewhere in the internet that this a bug in vba but I still wait for a way to do this ! Thanks!"}, {"owner": {"reputation": 906, "user_id": 3876796, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6baa712de45532fa50e686c8e26debee?s=128&d=identicon&r=PG&f=1", "display_name": "Othmane", "link": "https://stackoverflow.com/users/3876796/othmane"}, "edited": false, "score": 0, "creation_date": 1463628622, "post_id": 37311339, "comment_id": 62147598, "body": "When I use a MsgBox to print the value of src.Format.Line.ForeColor.RGB and src.Format.Fill.ForeColor.RGB I get 16777215 and 0 respectively, which is non understandable !"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1463611937, "creation_date": 1463611937, "answer_id": 37311339, "question_id": 37309958, "link": "https://stackoverflow.com/questions/37309958/set-color-of-chart-lines-and-markers-according-to-the-color-of-other-lines-and-m/37311339#37311339", "title": "Set Color of Chart lines and markers according to the color of other lines and markers in vba", "body": "<p>Should this line:</p>\n\n<pre><code>dst.Format.Line.ForeColor.RGB = src.Format.Fill.ForeColor.RGB\n</code></pre>\n\n<p>instead be:</p>\n\n<pre><code>dst.Format.Line.ForeColor.RGB = src.Format.Line.ForeColor.RGB\n</code></pre>\n"}], "owner": {"reputation": 906, "user_id": 3876796, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6baa712de45532fa50e686c8e26debee?s=128&d=identicon&r=PG&f=1", "display_name": "Othmane", "link": "https://stackoverflow.com/users/3876796/othmane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 717, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1463634211, "creation_date": 1463604960, "last_edit_date": 1463634211, "question_id": 37309958, "link": "https://stackoverflow.com/questions/37309958/set-color-of-chart-lines-and-markers-according-to-the-color-of-other-lines-and-m", "title": "Set Color of Chart lines and markers according to the color of other lines and markers in vba", "body": "<p>I am trying to set the color of even lines and markers according to the color of odd lines and colors.</p>\n\n<p>Let's say, my table looks like this (speed1, performance1, speed2, performance2,.....)\nWhen I plot a line chart It just gives every line a different color. In my case I want to give every two columns (speed and performance) a single color. So, for that I try every time to take the color of a line and the color of its markers, and then assign these colors to the following line (color of odd columns to even columns).</p>\n\n<p>This is my code:</p>\n\n<pre><code>Sub ChangeColors()\n\n Dim cht As Chart\n Dim ser As Series\n\n Set cht = ActiveChart\nFor i = 1 To cht.SeriesCollection.Count\n If (i Mod 2) = 0 Then\n Set dst = cht.SeriesCollection(i)\n Set src = cht.SeriesCollection(i - 1)\n dst.Format.Line.Visible = msoFalse\n dst.Format.Line.Visible = msoTrue\n dst.Format.Line.ForeColor.RGB = src.Format.Line.ForeColor.RGB\n dst.Format.Fill.ForeColor.RGB = src.Format.Fill.ForeColor.RGB\n End If\nNext i\nEnd Sub\n</code></pre>\n\n<p>The problem is that at the end all the even lines become black. However, when I try to pick a RGB color (for instance, RGB(255, 0, 0)) an assign it to the even lines they all become red, so it works.</p>\n\n<p><strong>UPDATE:</strong>\nWhen I use a MsgBox to print the value of src.Format.Line.ForeColor.RGB and src.Format.Fill.ForeColor.RGB I get 16777215 and 0 respectively for all lines. So I don't understand why these values and why they are the same for all lines ?</p>\n\n<p>Does anyone know what is the problem with my code ?</p>\n\n<p>Thank you !</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 1, "creation_date": 1463604399, "post_id": 37309715, "comment_id": 62140620, "body": "Google is your friend: <a href=\"https://www.google.com/#q=open+workbook+vba+stackoverflow\" rel=\"nofollow noreferrer\">google.com/#q=open+workbook+vba+stackoverflow</a>"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1463637591, "post_id": 37309715, "comment_id": 62150165, "body": "why not simply using cross-workbooks connections: in any relevant cell of workbookA you want to type <code>=&#39;[workbookN]sheetM&#39;!B14</code>. you set it once and it&#39;ll keep the wanted connection for ever!"}], "answers": [{"comments": [{"owner": {"reputation": 1549, "user_id": 3529833, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/74c547cbe8476f731f97005480dda6aa?s=128&d=identicon&r=PG&f=1", "display_name": "Mojimi", "link": "https://stackoverflow.com/users/3529833/mojimi"}, "edited": false, "score": 0, "creation_date": 1463629284, "post_id": 37309983, "comment_id": 62147748, "body": "Thanks! That&#39;s all I needed to know"}], "tags": [], "owner": {"reputation": 186, "user_id": 1830045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c865a8284788cfa4224af877204fff28?s=128&d=identicon&r=PG", "display_name": "Spencer Ogden", "link": "https://stackoverflow.com/users/1830045/spencer-ogden"}, "is_accepted": true, "score": 1, "last_activity_date": 1463605076, "creation_date": 1463605076, "answer_id": 37309983, "question_id": 37309715, "link": "https://stackoverflow.com/questions/37309715/importing-data-from-another-open-workbook/37309983#37309983", "title": "Importing data from another open Workbook", "body": "<p>Your question is a bit vague to give a specific answer, but some general pointers:</p>\n\n<ol>\n<li>Yes, it is possible open two workbooks at the same time. You will want to add a macro module to WorkbookA.</li>\n<li>Use a for loop to loop over the column headings. Append the path where these files can be found and open using <a href=\"https://msdn.microsoft.com/en-us/library/office/ff194819.aspx\" rel=\"nofollow\">Workbooks.Open</a>. That will return a reference to the second workbook you can dig into for your data.</li>\n<li>Use ThisWorkbook to refer to WorkbookA.</li>\n<li>Use <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839657.aspx\" rel=\"nofollow\">.Close</a> to close each workbook when you are done.</li>\n</ol>\n"}], "owner": {"reputation": 1549, "user_id": 3529833, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/74c547cbe8476f731f97005480dda6aa?s=128&d=identicon&r=PG&f=1", "display_name": "Mojimi", "link": "https://stackoverflow.com/users/3529833/mojimi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 37309983, "answer_count": 1, "score": 0, "last_activity_date": 1463605076, "creation_date": 1463603972, "question_id": 37309715, "link": "https://stackoverflow.com/questions/37309715/importing-data-from-another-open-workbook", "title": "Importing data from another open Workbook", "body": "<p>I have a workbook(workbookA) which contains data extracted from 10 other workbooks, each line has a column identifying from which workbook they came from.</p>\n\n<p>The problem is that, in some columns of workbookA, the values are incorrect and need to be re-imported</p>\n\n<p>I know how to do loops and set values in VBA, just now how to work with 2 workbooks at the same time</p>\n\n<p>So, for each cell in workbookA, i would find its match from the reference workbook, through a UID, and then replace the value in workbookA</p>\n\n<p>If its possible for it to open the workbook too, that would be even better, automate the whole process</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6352993, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6oUIBb6zV7k/AAAAAAAAAAI/AAAAAAAABfs/12oJZriTE_4/photo.jpg?sz=128", "display_name": "Paul Bernert", "link": "https://stackoverflow.com/users/6352993/paul-bernert"}, "edited": false, "score": 0, "creation_date": 1463604905, "post_id": 37309713, "comment_id": 62140854, "body": "Brilliant! Thank you so much! The SUMIFS() was exactly what I was looking for! I&#39;m not surprised it was that easy. Cheers!"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 3, "user_id": 6352993, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6oUIBb6zV7k/AAAAAAAAAAI/AAAAAAAABfs/12oJZriTE_4/photo.jpg?sz=128", "display_name": "Paul Bernert", "link": "https://stackoverflow.com/users/6352993/paul-bernert"}, "edited": false, "score": 0, "creation_date": 1463604968, "post_id": 37309713, "comment_id": 62140881, "body": "@PaulBernert please mark as correct, by clicking the check mark by the answer.  It is something only you can do.  It will mark this question as being answered."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1463604084, "last_edit_date": 1463604084, "creation_date": 1463603969, "answer_id": 37309713, "question_id": 37309464, "link": "https://stackoverflow.com/questions/37309464/calculate-cell-sumcells-script-across-hundreds-of-small-sets/37309713#37309713", "title": "Calculate &quot;cell/sum(cells)&quot; script across hundreds of small sets", "body": "<p>Use <a href=\"https://support.office.com/en-us/article/SUMIF-function-169b8c99-c05c-4483-a712-1697a653039b\" rel=\"nofollow\">SUMIF()</a>:</p>\n\n<pre><code>=H3/SUMIF(C:C,C3,H:H)\n</code></pre>\n\n<p>It will now group the it by the state.  </p>\n\n<p>If you want to group it further then use <a href=\"https://support.office.com/en-us/article/SUMIFS-function-c9e748f5-7ea7-455d-9406-611cebce642b\" rel=\"nofollow\">SUMIFS()</a>:</p>\n\n<pre><code>=H3/SUMIFS(H:H,C:C,C3,A:A,2015)\n</code></pre>\n\n<p>This will group it by the state and year 2015.</p>\n"}], "owner": {"reputation": 3, "user_id": 6352993, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6oUIBb6zV7k/AAAAAAAAAAI/AAAAAAAABfs/12oJZriTE_4/photo.jpg?sz=128", "display_name": "Paul Bernert", "link": "https://stackoverflow.com/users/6352993/paul-bernert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 37309713, "answer_count": 1, "score": 0, "last_activity_date": 1463604084, "creation_date": 1463603108, "last_edit_date": 1531161705, "question_id": 37309464, "link": "https://stackoverflow.com/questions/37309464/calculate-cell-sumcells-script-across-hundreds-of-small-sets", "title": "Calculate &quot;cell/sum(cells)&quot; script across hundreds of small sets", "body": "<p>I'm new here, and would greatly appreciate some help with this problem. I'm trying to take a column (Column H in this case) that's split up by blank rows into a few hundred sets of 21 cells each and find the portion of each cell to that set.</p>\n\n<p><a href=\"http://i.stack.imgur.com/5SyDw.png\" rel=\"nofollow\">Picture - Objective: Take a cell and divide it against 21 other cells in that set. Skip the blank row and repeat the same process several hundred times.</a></p>\n\n<p>For example, I want to find out: \"In 2015, what portion of Alabama employees were in Management Occupations?\" and come to the conclusion that 3.669% were in management (Solution example would be cell [I3]). I want to calculate that for all states across all occupations across all years.</p>\n\n<p>I am currently doing this by typing out what's found in column K to get the solutions found in column I, but that is very laborious and seems inefficient. How would I go about getting solutions found in Column I in the easiest way possible?</p>\n\n<p>Please note that the groups must be broken up by state, which is why there are blank rows between each state. </p>\n\n<p>Thank you very much, and if you need a further explanation of what I'm trying to accomplish, please let me know and I'll respond immediately!</p>\n"}, {"tags": ["vba", "button", "runtime", "mouseevent"], "answers": [{"tags": [], "owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "is_accepted": false, "score": 0, "last_activity_date": 1463635008, "creation_date": 1463635008, "answer_id": 37314423, "question_id": 37309158, "link": "https://stackoverflow.com/questions/37309158/how-to-add-a-click-event-to-a-finish-button-at-run-time-in-vba-excel/37314423#37314423", "title": "How to add a click event to a Finish button at run time in vba excel?", "body": "<p>I can find now way to assign code to a dynamically created button (which is what you are doing).</p>\n\n<p>I would recommend making the button in Design mode and setting <code>Visible=False</code>. Then when ready make it visible.</p>\n\n<pre><code>Sub code()\nDim i As Integer, j As Integer, pctCompl As Single\n\nSheet1.Cells.Clear\n\nFor i = 1 To 100\n    For j = 1 To 300\n        Cells(5, 19).Value = j\n    Next j\n    pctCompl = i\n    progress pctCompl\nNext i\n\n'Dim cCont As control\n\n'Set cCont = Progress_Bar.Controls.Add _\n'        (\"Forms.CommandButton.1\", \"CopyOf\")\n\n'With cCont\n'    .Caption = \"Finish\"\n'    .AutoSize = True\n'    .Top = 84\n'    .Left = 258\n'    .Height = 18\n'    .Width = 66\n'End With\nCopyOf.Visible = True\n\nEnd Sub\n\nPrivate Sub CopyOf_Click()\nUnload Me\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1463636297, "creation_date": 1463636297, "answer_id": 37314686, "question_id": 37309158, "link": "https://stackoverflow.com/questions/37309158/how-to-add-a-click-event-to-a-finish-button-at-run-time-in-vba-excel/37314686#37314686", "title": "How to add a click event to a Finish button at run time in vba excel?", "body": "<p>You can use a class with a <code>WithEvents</code> button field to capture events from dynamically-added userform controls.</p>\n\n<p>Here's a simple example:</p>\n\n<p>--clsCB</p>\n\n<pre><code>Option Explicit\n\nPublic WithEvents CB As MSForms.CommandButton\nPublic frm As UserForm\n\nPrivate Sub CB_Click()\n    MsgBox \"clicked button - \" &amp; CB.Caption\n    Unload frm\nEnd Sub\n</code></pre>\n\n<p>--UserForm</p>\n\n<pre><code>Option Explicit\n\nDim o As clsCB\n\nPrivate Sub UserForm_Activate()\n    Dim cCont As Control\n    Set cCont = Me.Controls.Add(\"Forms.CommandButton.1\", \"CopyOf\")\n    With cCont\n        .Caption = \"Finish\"\n        .Top = 100\n        .Left = 100\n    End With\n    Set o = New clsCB\n    Set o.CB = cCont\n    Set o.frm = Me\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6352963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/189a622d1aa06d7d2757acde723e6d86?s=128&d=identicon&r=PG&f=1", "display_name": "Syed", "link": "https://stackoverflow.com/users/6352963/syed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 307, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1463636297, "creation_date": 1463602062, "last_edit_date": 1463636111, "question_id": 37309158, "link": "https://stackoverflow.com/questions/37309158/how-to-add-a-click-event-to-a-finish-button-at-run-time-in-vba-excel", "title": "How to add a click event to a Finish button at run time in vba excel?", "body": "<p>I have made a userform in which it shows a loading screen when the loading is completed it stops and a finish button appears, \nbut ....\nI have tried everything on my mind to assign an event to it that when clicked it closes the progress bar and a new userform which I have already created should appear \nI think its simple but I am not catching the problem help me catch the problem \nthe code is below</p>\n\n<p>Thanks in advance</p>\n\n<pre><code>Sub ProgressBar_Click()\nProgress_Bar.Show\nEnd Sub\n\nSub code()\nDim i As Integer, j As Integer, pctCompl As Single\n\nSheet1.Cells.Clear\n\nFor i = 1 To 100\n    For j = 1 To 300\n        Cells(5, 19).Value = j\n    Next j\n    pctCompl = i\n    progress pctCompl\nNext i\n\nDim cCont As control\n\nSet cCont = Progress_Bar.Controls.Add _\n            (\"Forms.CommandButton.1\", \"CopyOf\")\n\nWith cCont\n    .Caption = \"Finish\"\n    .AutoSize = True\n    .Top = 84\n    .Left = 258\n    .Height = 18\n    .Width = 66\nEnd With\n\nEnd Sub\n\nSub progress(pctCompl As Single)\n    Progress_Bar.text.Caption = pctCompl &amp; \"% Completed\"\n    Progress_Bar.bar.Width = pctCompl * 2\n\n    DoEvents\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1463603201, "post_id": 37309110, "comment_id": 62140026, "body": "Are you sure there&#39;s no other code anywhere and nothing else going on?  I just put this code into Excel 2013 and it works fine."}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1463604618, "post_id": 37309110, "comment_id": 62140725, "body": "Also, who is on the computer in question with the access to close excel?  Why don&#39;t you just run this on a computer you control?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6352971"}, "reply_to_user": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1463604755, "post_id": 37309110, "comment_id": 62140790, "body": "Thanks for replying.  I have re-made the file several times to try and ensure this was not the case -- so for you, it continually keeps you from closing your file until A1 is blank?"}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1463605027, "post_id": 37309110, "comment_id": 62140898, "body": "Possibly, it continually keeps me from closing the file until A1 is NOT blank i.e.  it continually keeps me from closing the file WHILE A1 is blank"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6352971"}, "reply_to_user": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1463605182, "post_id": 37309110, "comment_id": 62140989, "body": "That is exactly what I&#39;m trying to get it to do. I just tried my code on a different machine and it still closes on the second try without protest.  For your other question: It needs to run on the computer it is currently on. Also, we&#39;re not sure if it&#39;s a person or a random weird computer fluke closing it. Either way, I&#39;d like to try to something similar to this code working for a first test to see if it fixes it."}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1463605335, "post_id": 37309110, "comment_id": 62141061, "body": "Are you in Excel 2016?  If so, see here: <a href=\"http://stackoverflow.com/questions/35607938/excel-2016-workbook-beforeclose-event-firing-every-other-time-bug\" title=\"excel 2016 workbook beforeclose event firing every other time bug\">stackoverflow.com/questions/35607938/&hellip;</a>  This appears to be a bug."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6352971"}, "reply_to_user": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1463606854, "post_id": 37309110, "comment_id": 62141793, "body": "Hmm thank you, I do have the misfortune of working with the 2016 version.  Do I just need to copy the code from your link? I&#39;m having issues understanding how to fix this..."}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1463608398, "post_id": 37309110, "comment_id": 62142420, "body": "The link suggests that there is no fix.  The comments from the OP state that he posted the issue elsewhere and as of April 13th there was no solution.  They installed an update which made it a little better (so it triggered every other time), but still did not fix the issue.  Might be out of luck until Microsoft deals with it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6352971"}, "reply_to_user": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1463663592, "post_id": 37309110, "comment_id": 62167791, "body": "Wow that&#39;s crazy! Thank you for all your insight and responses.   Do you think that there is any other way to do what I&#39;m asking?"}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1463672375, "post_id": 37309110, "comment_id": 62175087, "body": "One thing you could do is hide Excel so that if someone is going on the machine, unless they go to task manager, they won&#39;t see it so couldn&#39;t close it."}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1463672451, "post_id": 37309110, "comment_id": 62175142, "body": "Or if you want to try something a bit strange, in the Before_close event you could open another version of the same workbook and then close the one they just tried to close.  Test to see if the Before_close event works on this new workbook."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6352971"}, "edited": false, "score": 0, "creation_date": 1463602604, "post_id": 37309314, "comment_id": 62139725, "body": "Hmmm, your idea might work. Can you tell me more? Forsure it would be great to use the two together."}, {"owner": {"reputation": 481, "user_id": 4005346, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c4884ea80a661457a46d7b1f11660089?s=128&d=identicon&r=PG&f=1", "display_name": "minzchickenflavor", "link": "https://stackoverflow.com/users/4005346/minzchickenflavor"}, "edited": false, "score": 0, "creation_date": 1463604416, "post_id": 37309314, "comment_id": 62140628, "body": "like i said i am a unix/linux person and haven&#39;t used windows for quite a while but it should work"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6352971"}, "edited": false, "score": 0, "creation_date": 1463604633, "post_id": 37309314, "comment_id": 62140734, "body": "So look into batch scripts to keep an excel file open...  If I used your example, would I just=replace notepad with &quot;excel&quot; and test.txt with myfile?"}], "tags": [], "owner": {"reputation": 481, "user_id": 4005346, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c4884ea80a661457a46d7b1f11660089?s=128&d=identicon&r=PG&f=1", "display_name": "minzchickenflavor", "link": "https://stackoverflow.com/users/4005346/minzchickenflavor"}, "is_accepted": false, "score": 0, "last_activity_date": 1463604333, "last_edit_date": 1463604333, "creation_date": 1463602564, "answer_id": 37309314, "question_id": 37309110, "link": "https://stackoverflow.com/questions/37309110/keeping-an-excel-file-open-except-in-event-of-power-loss/37309314#37309314", "title": "Keeping an Excel file open except in event of power loss", "body": "<p>sorry i am a unix kind of person but does it really need to be opened the whole time or is it enough if it reopens as soon as it is closed. because then i would but it in a batch script. a simple loop. </p>\n\n<p>for example this </p>\n\n<pre><code>:loop \nstart /wait test.txt\ngoto loop\n</code></pre>\n\n<p>will open text.txt in notepad because notepad is the default program for <code>txt</code> files.</p>\n\n<p>you can also specify what program shall be used like:</p>\n\n<pre><code>:loop \nstart /wait notepad test.txt\ngoto loop\n</code></pre>\n\n<p>i guess you could do the same with excel.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6352971"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1463604333, "creation_date": 1463601896, "question_id": 37309110, "link": "https://stackoverflow.com/questions/37309110/keeping-an-excel-file-open-except-in-event-of-power-loss", "title": "Keeping an Excel file open except in event of power loss", "body": "<p>I want to keep an Excel file open, even if a user clicks \"X\". I know that they could end the process from the task manager, but I do not think that will be the case.</p>\n\n<p>Basically, an Excel sheet needs to be open 24/7 to acquire data in real time from another source. Someone or something is shutting down Excel once in a while and messing this up. I want to see if a little bit of simple VBA code will fix it.</p>\n\n<p>From my research so far, I added this code:</p>\n\n<pre><code>Sub Workbook_BeforeClose(Cancel As Boolean)\n    'Step 1: Check to see if cell C7 is blank\n    If Sheets(\"Sheet1\").Range(\"A1\").Value = \"\" Then\n    'Step 2: If cell is blank, cancel the close and tell user\n        Cancel = True\n        MsgBox \"Cell A1 cannot be blank\"\n    'Step 3: If cell is not blank, save and close\n    Else\n        ActiveWorkbook.Close SaveChanges:=True\n    End If\nEnd Sub\n</code></pre>\n\n<p>And it works the first time I click X! But then, I just click it again and it lets me close everything without any message displaying. P.S. I have also tried this with just \"cancel = True\" in the sub. This also did not work.</p>\n\n<p>What am I doing wrong here? Thanks a lot guys!</p>\n"}, {"tags": ["excel", "vba", "cells", "separator", "language-translation"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1463605734, "post_id": 37309087, "comment_id": 62141282, "body": "Your question is unclear in view of your last line.  However, Regular Expressions would probably be the easiest way to go.  If you clarify your problem, and  post your code and associated problems, some one will be happy to help you.  Also, please read the HELP topics for <a href=\"http://stackoverflow.com/help/how-to-ask\">How do I Ask a Good Question</a>, and also <a href=\"http://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a>"}], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 5816736, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/UhUjQ.png?s=128&g=1", "display_name": "ADrex", "link": "https://stackoverflow.com/users/5816736/adrex"}, "edited": false, "score": 0, "creation_date": 1463658355, "post_id": 37312914, "comment_id": 62163739, "body": "Truth is I didn&#39;t even knew where to begin, I just wanted to know if it was possible first, I will try to learn the things you said and post the codes once I have it."}], "tags": [], "owner": {"reputation": 84, "user_id": 6348806, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gFPTP.png?s=128&g=1", "display_name": "Shirayuki", "link": "https://stackoverflow.com/users/6348806/shirayuki"}, "is_accepted": false, "score": 1, "last_activity_date": 1463624468, "creation_date": 1463624468, "answer_id": 37312914, "question_id": 37309087, "link": "https://stackoverflow.com/questions/37309087/separators-and-word-postioning-in-excel-vba/37312914#37312914", "title": "Separators and word postioning in excel vba", "body": "<p>Technically, yes, you can do it by first counting the number of times comma (\",\") appears plus 1, it will be the number of set of words you need to swap.</p>\n\n<p>Afterward, just split the original string into smaller parts by delimiter \",\" and swap each set, put them together again and you're done.</p>\n\n<p>I can give you the algorithm and whatsnot, but without seeing the actual codes, I guess you want someone else to ... write it for you?</p>\n"}], "owner": {"reputation": 85, "user_id": 5816736, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/UhUjQ.png?s=128&g=1", "display_name": "ADrex", "link": "https://stackoverflow.com/users/5816736/adrex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 184, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1463624468, "creation_date": 1463601792, "question_id": 37309087, "link": "https://stackoverflow.com/questions/37309087/separators-and-word-postioning-in-excel-vba", "title": "Separators and word postioning in excel vba", "body": "<p>What excel vba code could invert the position of two words in a cell if they are separated by a space, like this:</p>\n\n<pre><code>\"Broom eletric\"\n</code></pre>\n\n<p>to</p>\n\n<pre><code>\"Eletric broom\"\n</code></pre>\n\n<p>And not to separate words when they are separated by \",\" like this:</p>\n\n<pre><code>\"Broom, eletric\" '(this one remains as it is)\n</code></pre>\n\n<p>And if there are lots of words in a cell, it will apply the rules to them all, like this:</p>\n\n<pre><code>\"Broom eletric, eraser, documents,  part computer\"\n</code></pre>\n\n<p>to</p>\n\n<pre><code>\"Eletric broom, eraser, documents, computer part\"\n</code></pre>\n\n<p>Plus: the separators should be \",\" and \"and\" </p>\n"}, {"tags": ["excel", "vbscript", "vba"], "comments": [{"owner": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 1, "creation_date": 1463656090, "post_id": 37309050, "comment_id": 62162190, "body": "Please show the exact error(s)."}, {"owner": {"reputation": 109, "user_id": 3930324, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/d11c85203d3d0654318673e43004a748?s=128&d=identicon&r=PG&f=1", "display_name": "midiman", "link": "https://stackoverflow.com/users/3930324/midiman"}, "reply_to_user": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 0, "creation_date": 1463667642, "post_id": 37309050, "comment_id": 62171296, "body": "@AnsgarWiechers Added the details from the error dialogue box."}, {"owner": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 0, "creation_date": 1463668203, "post_id": 37309050, "comment_id": 62171726, "body": "<a href=\"http://stackoverflow.com/q/20514548/1630171\">Maybe related</a>."}], "owner": {"reputation": 109, "user_id": 3930324, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/d11c85203d3d0654318673e43004a748?s=128&d=identicon&r=PG&f=1", "display_name": "midiman", "link": "https://stackoverflow.com/users/3930324/midiman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1292, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1463668349, "creation_date": 1463601638, "last_edit_date": 1531161705, "question_id": 37309050, "link": "https://stackoverflow.com/questions/37309050/excel-call-was-rejected-by-callee-error", "title": "Excel Call was rejected by callee Error", "body": "<p>I've written a vbs that essentially opens Excel in the background, runs a macro on it and then saves it by appending the value of a cell to it's name. However, and this only occurs sometimes, I get a error on the bolded lines...</p>\n\n<blockquote>\n  <p>Line: 23<br>\n  Char: 3<br>\n  Error: Call was rejected by callee.<br>\n  Code: 80010001<br>\n  Source: (null)  </p>\n</blockquote>\n\n<pre><code>Option Explicit\n\nExcelMacroExample\n\nSub ExcelMacroExample() \n\n  Dim objExcel  \n  Dim objApp  \n  Dim objWorkbook\n  Dim objSheet\n  Dim SI\n  Dim scriptdir\n  Dim oFSO\n  Set oFSO = CreateObject(\"Scripting.FileSystemObject\")\n  scriptdir = oFSO.GetParentFolderName(WScript.ScriptFullName)\n\n  Set objExcel = CreateObject(\"Excel.Application\")\n  Set objWorkbook = objExcel.Workbooks.Open(scriptdir & \"\\SCORECARD.xlsm\")\n\n  objExcel.Run \"RefreshConns\"\n  WScript.Sleep 90000 \n\n  <b>Set objSheet = objWorkbook.Worksheets(\"Cover\")</b>\n\n  <b>SI = objSheet.Cells(4, 2).Value</b>\n\n  objExcel.ActiveWorkbook.SaveAs scriptdir & \"\\Scorecards\\\" & \"SCORECARD_\" & SI & \"_\" & Year(Now()) & Month(Now()) & Day(Now()) & \"_\" & Hour(Now()) & Minute(Now()) &\".xlsm\", 52\n\n  objExcel.ActiveWorkbook.Close\n  objExcel.Quit   \n\n  MsgBox(\"Successfully generated profiling scorecard.\")\n\nEnd Sub</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 1549, "user_id": 5896420, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/b86Xv.png?s=128&g=1", "display_name": "luckyguy73", "link": "https://stackoverflow.com/users/5896420/luckyguy73"}, "is_accepted": true, "score": 1, "last_activity_date": 1463638057, "last_edit_date": 1463638057, "creation_date": 1463637723, "answer_id": 37315022, "question_id": 37309039, "link": "https://stackoverflow.com/questions/37309039/how-to-alter-my-vba-code-so-it-only-creates-a-workbook-one-time-than-a-workshee/37315022#37315022", "title": "How to alter my VBA code so it only creates a workbook one time, than a worksheet for every other option", "body": "<p>try this.  when i tested it i found that it accomplished what you are asking for</p>\n\n<pre><code>Sub Worksheet_Create()\n\nDim cell As Range\nDim counter As Long\nDim Dashboard As Worksheet\nDim newWB As Workbook\nDim wb1 As Workbook\n\nSet wb1 = ThisWorkbook\nSet newWB = Workbooks.Add\nSet Dashboard = wb1.Sheets(\"Business Plans\")\n\nApplication.DisplayAlerts = False\n\nFor Each cell In wb1.Worksheets(\"dd\").Range(\"$C3:$C75\")\n    If cell.Value = \"\" Then\n        counter = counter + 1\n        Application.StatusBar = \"Processing file: \" &amp; counter &amp; \"/1042\"\n    Else\n        counter = counter + 1\n        Application.StatusBar = \"Processing file: \" &amp; counter &amp; \"/1042\"\n\n        With Dashboard\n        .Range(\"$A$2\").Value = cell.Value\n            With wb1\n                .Worksheets(\"Business Plans\").Copy After:=newWB.Worksheets(1)\n                ActiveSheet.Cells.Copy\n                ActiveSheet.Range(\"A1\").PasteSpecial Paste:=xlValues\n                ActiveSheet.Name = cell.Value\n            End With\n            Application.CutCopyMode = False\n        End With\n    End If\nNext cell\n\nApplication.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 151, "user_id": 3666237, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/45ba9c861d3ec2d51f40bc99f63dcb1c?s=128&d=identicon&r=PG&f=1", "display_name": "user3666237", "link": "https://stackoverflow.com/users/3666237/user3666237"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 37315022, "answer_count": 1, "score": 0, "last_activity_date": 1463638057, "creation_date": 1463601589, "last_edit_date": 1463602219, "question_id": 37309039, "link": "https://stackoverflow.com/questions/37309039/how-to-alter-my-vba-code-so-it-only-creates-a-workbook-one-time-than-a-workshee", "title": "How to alter my VBA code so it only creates a workbook one time, than a worksheet for every other option", "body": "<p>I'm working on a VBA code that for each drop down selection it copies the sheet as values creates a worksheet for each option in the drop down list in a new workbook.  The problem is everything seems to be working fine in my code except that for each drop down option it's creating a totally separate workbook.  My drop down selection is like 80 options and can grow.  So I don't need 80 different workbooks.  I need one new workbook with the 80 worksheets for each drop down selection.  How can I alter my code so that it creates a new workbook one time than for each drop down selection is a worksheet in that workbook?</p>\n\n<p>Here's my code</p>\n\n<pre><code>Sub Worksheet_Create()\n\nDim cell As Range\nDim counter As Long\nDim Dashboard As Worksheet\n\nSet Dashboard = Sheets(\"Business Plans\")\n\nFor Each cell In Worksheets(\"dd\").Range(\"$C3:$C75\")\n    If cell.Value = \"\" Then\n        counter = counter + 1\n        Application.StatusBar = \"Processing file: \" &amp; counter &amp; \"/1042\"\n    Else\n        counter = counter + 1\n        Application.StatusBar = \"Processing file: \" &amp; counter &amp; \"/1042\"\n\n        Application.DisplayAlerts = False\n\n        With Dashboard\n        .Range(\"$A$2\").Value = cell.Value\n            With ThisWorkbook\n                .Worksheets(\"Business Plans\").Copy\n                ActiveSheet.Cells.Copy\n                ActiveSheet.Range(\"A1\").PasteSpecial Paste:=xlValues\n                ActiveSheet.Name = cell.Value\n            End With\n            Application.CutCopyMode = False\n\n        End With\n    End If\nNext cell\n\nApplication.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 81, "user_id": 5548278, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/73oLZ.jpg?s=128&g=1", "display_name": "TheAverageBear", "link": "https://stackoverflow.com/users/5548278/theaveragebear"}, "is_accepted": false, "score": 0, "last_activity_date": 1463601718, "creation_date": 1463601718, "answer_id": 37309069, "question_id": 37308984, "link": "https://stackoverflow.com/questions/37308984/loop-through-i-1-to-n-rows-find-last-used-column-in-each-row-and-copy-its-dat/37309069#37309069", "title": "loop through i = 1 to n rows, find last used column in each row and copy its data to column AA1 same row VBA?", "body": "<p>To find last column LETTER on this row</p>\n\n<pre><code>LastColLtr = Split(Cells(1, Range(\"ZZ\" &amp; RN1).End(xlToLeft).Column).Address, \"$\")(1)\n</code></pre>\n\n<p>To find last column NUMBER on this row</p>\n\n<pre><code>LastColNum = Range(\"ZZ\" &amp; RN1).End(xlToLeft).Column\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "is_accepted": false, "score": 0, "last_activity_date": 1463602415, "creation_date": 1463602415, "answer_id": 37309266, "question_id": 37308984, "link": "https://stackoverflow.com/questions/37308984/loop-through-i-1-to-n-rows-find-last-used-column-in-each-row-and-copy-its-dat/37309266#37309266", "title": "loop through i = 1 to n rows, find last used column in each row and copy its data to column AA1 same row VBA?", "body": "<pre><code>dim i as long\ni = 1\n\ndo until isempty(activesheet.cells(i, 1).value)\n  dim v as variant\n\n  if isempty(activesheet.cells(i, 2).value) then\n    v = activesheet.cells(i, 1).value\n  else\n    v = activesheet.cells(i, 1).end(xltoright).value\n  end if\n\n  activesheet.cells(i, \"AB\").value = v\n  i = i + 1\nloop\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6237460, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YU6nc.jpg?s=128&g=1", "display_name": "taniaspot", "link": "https://stackoverflow.com/users/6237460/taniaspot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 875, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1463602415, "creation_date": 1463601420, "last_edit_date": 1463601477, "question_id": 37308984, "link": "https://stackoverflow.com/questions/37308984/loop-through-i-1-to-n-rows-find-last-used-column-in-each-row-and-copy-its-dat", "title": "loop through i = 1 to n rows, find last used column in each row and copy its data to column AA1 same row VBA?", "body": "<p>I am stuck with a part where I 'd like macro to loop through variable number of rows. I need to find last used column in each row and copy its content to column AA1 same row. Number of columns in each rows is also variable and will change as the number of columns is a result of text to copy action. I will never know how much rows and columns I will have.</p>\n\n<p>The reason for this is that the last used column will have a key that I will be using later to vlookup data from another sheet.\nKindly help. I tried to record this by selecting colum AA1 first and then going left with ctrl+shiftlike this, then pasting it to column 'AB1' that way I would have all the codes in one column. But when I try to loop it does not work. </p>\n\n<pre><code>Range(\"AA1\").Select\nRange(Selection, Selection.End(xlToLeft)).Select\nSelection.Copy\nRange(\"AB1\").Select\nActiveSheet.Paste\n</code></pre>\n\n<p><a href=\"http://i.stack.imgur.com/CrZNW.jpg\" rel=\"nofollow\">example picture</a></p>\n\n<p>Here is what I put together so far for this loop:</p>\n\n<pre><code>Sub newmak()\n\nDim i\nDim n\nn = Range(\"A\" &amp; Range(\"A:A\").Rows.Count).End(xlUp).Row\n\nFor i = 1 To n\n\n'==================================that part is not working\n\n                        Cells(i, Columns.Count).Select\n                        Selection.Copy\n                        Range(\"a\" &amp; i, 27).Select '&lt;--??\n                        Selection.PasteSpecial\n\n'==================================\n\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 4, "last_activity_date": 1463600130, "creation_date": 1463600130, "answer_id": 37308644, "question_id": 37308598, "link": "https://stackoverflow.com/questions/37308598/excel-vba-using-formula-with-dynamic-ranges/37308644#37308644", "title": "Excel VBA: Using .formula with dynamic ranges", "body": "<p>It is looking for the address and the default of a range object is value:</p>\n\n<pre><code>Range(\"F5\").Formula = \"=Average(\" &amp; c.Address(0,0) &amp; \")\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 81, "user_id": 5548278, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/73oLZ.jpg?s=128&g=1", "display_name": "TheAverageBear", "link": "https://stackoverflow.com/users/5548278/theaveragebear"}, "is_accepted": false, "score": 1, "last_activity_date": 1568642499, "last_edit_date": 1568642499, "creation_date": 1463601168, "answer_id": 37308927, "question_id": 37308598, "link": "https://stackoverflow.com/questions/37308598/excel-vba-using-formula-with-dynamic-ranges/37308927#37308927", "title": "Excel VBA: Using .formula with dynamic ranges", "body": "<p>If the range to be averaged is the only data on the sheet, you can find the \"last row\" and \"last column\", then use those variables in the formula.</p>\n\n<p>To find last row:</p>\n\n<pre><code>LastRow = Cells.Find(\"*\", Range(\"A1\"), xlFormulas, xlPart, _\n        xlByRows, xlPrevious, False, False).Row\n</code></pre>\n\n<p>To find last column letter:</p>\n\n<pre><code>LastCol = Split(Cells(1, ActiveSheet.Cells.Find(What:=\"*\", _\n    SearchDirection:=xlPrevious, _\n    SearchOrder:=xlByColumns).Column).Address, \"$\")(1)\n</code></pre>\n\n<p>The formula in would change from:</p>\n\n<pre><code>\"=AVERAGE(H5:K5)\"\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>\"=AVERAGE(H5:\" &amp; LastCol &amp; Last Row &amp; \")\"\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 6352777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e17a95168451b85cc9e38527883f1da?s=128&d=identicon&r=PG&f=1", "display_name": "Alec Holmes", "link": "https://stackoverflow.com/users/6352777/alec-holmes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6924, "favorite_count": 2, "accepted_answer_id": 37308644, "answer_count": 2, "score": 2, "last_activity_date": 1568642499, "creation_date": 1463599992, "question_id": 37308598, "link": "https://stackoverflow.com/questions/37308598/excel-vba-using-formula-with-dynamic-ranges", "title": "Excel VBA: Using .formula with dynamic ranges", "body": "<p>I'm trying to average some data sets which are in their own columns. The number of data sets may change, so the number of columns I average needs to be dynamic. </p>\n\n<p>Also, I have multiple sets of data sets on each sheet, and because the data sets are dynamic, I add columns to the sheet earlier in the code, so I can't hardcode the starting point for the data set. In other words, I can't just say...</p>\n\n<p><code>Range(\"L5\").formula = \"=AVERAGE(H5:K5)\"</code> </p>\n\n<p>... because I can't know for sure that the data sets start at H5. It might start at F5, or G5, etc.</p>\n\n<p>So I'm trying pass the a starting point as an argument in an As Range variable, but I don't know how interface this with a .formula.</p>\n\n<p>The following code doesn't work. I'm guessing because I can't put a range variable in a string like this.</p>\n\n<pre><code>Sub Average()\nDim c As Range\n\nSet c = Range(\"B5:B10\")\n\nRange(\"F5\").FormulaR1C1 = \"=Average(\" &amp; c &amp; \")\"\n</code></pre>\n\n<p>Is there any way to use ranges with excel formulas like this?</p>\n"}, {"tags": ["vba", "excel", "paste"], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 6316145, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/ea15e8fb821f09a4d0a1eb4105d07166?s=128&d=identicon&r=PG&f=1", "display_name": "Hags", "link": "https://stackoverflow.com/users/6316145/hags"}, "edited": false, "score": 0, "creation_date": 1463599665, "post_id": 37308441, "comment_id": 62138199, "body": "It keeps saying &quot;Application-defined or object defined error&quot;"}, {"owner": {"reputation": 17, "user_id": 6316145, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/ea15e8fb821f09a4d0a1eb4105d07166?s=128&d=identicon&r=PG&f=1", "display_name": "Hags", "link": "https://stackoverflow.com/users/6316145/hags"}, "edited": false, "score": 0, "creation_date": 1463599728, "post_id": 37308441, "comment_id": 62138232, "body": "For some reason it is bringing an error still...is there another way to select the entire column and paste the values over the formula?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 17, "user_id": 6316145, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/ea15e8fb821f09a4d0a1eb4105d07166?s=128&d=identicon&r=PG&f=1", "display_name": "Hags", "link": "https://stackoverflow.com/users/6316145/hags"}, "edited": false, "score": 0, "creation_date": 1463599799, "post_id": 37308441, "comment_id": 62138271, "body": "@Hags - Did you post all of your code? If not, please post the rest (edit into your OP). What line does it show that error on? Do you have a sheet called &quot;MoM&quot;?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1463599802, "post_id": 37308441, "comment_id": 62138274, "body": "<code>.Range(&quot;H2:H&quot;)</code> does not have an end row."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1463599857, "post_id": 37308441, "comment_id": 62138301, "body": "@ScottCraner - D&#39;oh! Fixed, although it will do the entire Column H. (I&#39;ll edit to include a <code>lastRow</code> variable)."}, {"owner": {"reputation": 17, "user_id": 6316145, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/ea15e8fb821f09a4d0a1eb4105d07166?s=128&d=identicon&r=PG&f=1", "display_name": "Hags", "link": "https://stackoverflow.com/users/6316145/hags"}, "edited": false, "score": 0, "creation_date": 1463599894, "post_id": 37308441, "comment_id": 62138326, "body": "Sheets(&quot;MoM&quot;).Select  Range(&quot;H2&quot;).Select ActiveCell.FormulaR1C1 = &quot;=VLOOKUP(C[-7],&#39;Table Array&#39;!C[-7]:C[2],8,FALSE)&quot; Range(&quot;H2&quot;).Select Selection.AutoFill Destination:=Range(&quot;H2:H&quot; &amp; Range(&quot;A&quot; &amp; Rows.Count).End(xlUp).Row), Type:=xlFillSeries  If ActiveSheet.AutoFilterMode Then ActiveSheet.ShowAllData"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1463599942, "post_id": 37308441, "comment_id": 62138356, "body": "I would not bother, when assigning the values it does not take that much more time to simply <code>.Range(&quot;H2:H&quot; &amp; .Rows.Count).Value</code>"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 1, "last_activity_date": 1463599898, "last_edit_date": 1463599898, "creation_date": 1463599424, "answer_id": 37308441, "question_id": 37308330, "link": "https://stackoverflow.com/questions/37308330/how-can-i-copy-a-column-with-formulas-and-paste-those-values-in-the-same-exact-c/37308441#37308441", "title": "How can I copy a column with formulas and paste those values in the same exact column using VBA?", "body": "<p>Is what you have not working?  If you want to remove the formula, but keep the values, a super quick way is to just set the range equal to itself:</p>\n\n<pre><code>Dim lastRow&amp;\nWith Sheets(\"MoM\")\n     lastRow = .Cells(.Rows.Count,8).End(xlUp).Row\n    .Range(\"H2:H\" &amp; lastRow).Value = .Range(\"H2:H\" &amp; lastRow).Value\nEnd With\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1463599816, "post_id": 37308492, "comment_id": 62138277, "body": "Nice, I was keeping it simple, but I like how you did the <code>.End(xlUp)</code> in the range."}], "tags": [], "owner": {"reputation": 1192, "user_id": 1744727, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8d02d3ecefb127c4467e9328308ffb12?s=128&d=identicon&r=PG", "display_name": "David", "link": "https://stackoverflow.com/users/1744727/david"}, "is_accepted": true, "score": 1, "last_activity_date": 1463599575, "creation_date": 1463599575, "answer_id": 37308492, "question_id": 37308330, "link": "https://stackoverflow.com/questions/37308330/how-can-i-copy-a-column-with-formulas-and-paste-those-values-in-the-same-exact-c/37308492#37308492", "title": "How can I copy a column with formulas and paste those values in the same exact column using VBA?", "body": "<pre><code>With Worksheets(\"MoM\").Range(\"H2\", Worksheets(\"MoM\").Range(\"H65536\").End(xlUp))\n    .Value = .Value\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 6316145, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/ea15e8fb821f09a4d0a1eb4105d07166?s=128&d=identicon&r=PG&f=1", "display_name": "Hags", "link": "https://stackoverflow.com/users/6316145/hags"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 37308492, "answer_count": 2, "score": 0, "last_activity_date": 1463599898, "creation_date": 1463599014, "last_edit_date": 1463599178, "question_id": 37308330, "link": "https://stackoverflow.com/questions/37308330/how-can-i-copy-a-column-with-formulas-and-paste-those-values-in-the-same-exact-c", "title": "How can I copy a column with formulas and paste those values in the same exact column using VBA?", "body": "<pre><code>Sheets(\"MoM\").Select\nRange(\"H2:H\").Copy\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _ :=False, Transpose:=False\nApplication.CutCopyMode = False\n</code></pre>\n\n<p>All I want to do is remove the VLOOKUP Formula by pasting the values within the same column starting at \"H2\" and ending at the last cell with a formula in it. </p>\n"}, {"tags": ["vba", "excel", "vbscript"], "comments": [{"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1463598950, "post_id": 37308087, "comment_id": 62137792, "body": "This post of mine might help: <a href=\"http://yoursumbuddy.com/get-unique-per-row-values-removeduplicates/\" rel=\"nofollow noreferrer\">yoursumbuddy.com/get-unique-per-row-values-removeduplicates</a>"}], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 4841392, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh5.googleusercontent.com/-fnysJRo6f90/AAAAAAAAAAI/AAAAAAAAAno/NhX7skEy9fE/photo.jpg?sz=128", "display_name": "Laleh H", "link": "https://stackoverflow.com/users/4841392/laleh-h"}, "edited": false, "score": 0, "creation_date": 1463650245, "post_id": 37316078, "comment_id": 62158022, "body": "your selection solution works perfect! thanks for this. :)"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 1, "last_activity_date": 1463641329, "creation_date": 1463641329, "answer_id": 37316078, "question_id": 37308087, "link": "https://stackoverflow.com/questions/37308087/how-to-remove-duplicate-values-in-certain-columns-without-selection-in-excel-vbs/37316078#37316078", "title": "How to remove duplicate values in certain columns without selection in Excel VBS?", "body": "<p>you have to hardcode the range, like :</p>\n\n<pre><code>with Worksheets(\"MySheet\") '&lt;~~ change the worksheet name as per your actual one\n    Set r = .Range(\"A2:C2\", .Cells(.Rows.Count, \"A\").End(xlUp)) '&lt;~~ assuming data are beginning from row 2, otherwise simply change row reference\nend with\n</code></pre>\n\n<p>please consider it's always much safer to explicitly reference the <code>Worksheet</code> name in any <code>Range</code></p>\n\n<p>this should specially apply to <code>restoreOriginalValues()</code> sub since:</p>\n\n<ul>\n<li><p><code>Address</code> property of <code>Range</code> object would store the \"pure\" range cells address without any sheet reference</p></li>\n<li><p><code>restoreOriginalValues</code> could be possibly called after some \"sheet-jumping\"</p></li>\n</ul>\n\n<p>so that you'd better define a module scoped <code>Worksheet</code> variable and then use it</p>\n\n<pre><code>Private originalValues()\nPrivate originalRange As String\nPrivate mySht As Worksheet '&lt; ~~ set module scoped `Worksheet` variable\n\nSub removeDupes()\n\n'... code\n\n originalRange = dataRng.Address '&lt;~~ store the \"pure\" range cells address without any sheet reference\n\n'... code\n\nEnd Sub\n\n\nPrivate Sub restoreOriginalValues()\n    mySht.Range(originalRange).Value = originalValues '&lt; ~~ combine module scoped `Worksheet` and `originalRange` variables \nEnd Sub\n</code></pre>\n\n<p>here follows an alternative approach looping through cells instead of using arrays. it's just for reference since arrays are surely faster where lots of data are concerned </p>\n\n<pre><code>Option Explicit\n\n    Private originalValues()\n    Private originalRange As String\n    Private mySht As Worksheet\n\n    Sub removeDupes()\n        Dim cell As Range, compCell As Range\n        Dim headerRng As Range, dataRng As Range\n\n        Set mySht = Worksheets(\"MyData\")\n\n        With mySht '&lt;~~ change the worksheet name as per your actual one\n            Set headerRng = .Range(\"A2:C2\") '&lt;~~ change the header columns reference as per your needs\n            Set dataRng = Range(headerRng.Offset(1), .Cells(.Rows.Count, headerRng.Columns(1).Column).End(xlUp)) '&lt;~~ set data range from row below headers to the row with last non empty cell in first header column\n\n            'store the values for an undo\n            originalValues = dataRng.Value\n            originalRange = dataRng.Address\n\n            For Each cell In dataRng '&lt;~~ loop through every cell\n                Set compCell = IIf(IsEmpty(cell.Offset(-1)), cell.End(xlUp), cell.Offset(-1)) '&lt;~~ set the cell whose value is to compare the current cell value to\n                If cell.Value = compCell.Value Then cell.ClearContents '&lt;~~ clear current cell only if its value is the same of its \"comparing\" cell one\n            Next cell\n\n        End With\n\n        restoreOriginalValues\n\n    End Sub\n\n\n    Private Sub restoreOriginalValues()\n        mySht.Range(originalRange).Value = originalValues\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 4841392, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh5.googleusercontent.com/-fnysJRo6f90/AAAAAAAAAAI/AAAAAAAAAno/NhX7skEy9fE/photo.jpg?sz=128", "display_name": "Laleh H", "link": "https://stackoverflow.com/users/4841392/laleh-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1329, "favorite_count": 1, "accepted_answer_id": 37316078, "answer_count": 1, "score": 1, "last_activity_date": 1463668175, "creation_date": 1463598152, "last_edit_date": 1463668175, "question_id": 37308087, "link": "https://stackoverflow.com/questions/37308087/how-to-remove-duplicate-values-in-certain-columns-without-selection-in-excel-vbs", "title": "How to remove duplicate values in certain columns without selection in Excel VBS?", "body": "<p>Assume that this is my data in Excel <a href=\"http://i.stack.imgur.com/G5zb8.jpg\" rel=\"nofollow\">Data containing duplicate values in the first three columns</a>.\nAs you can see the values in the first three columns are repeated for a number of rows.</p>\n\n<p>I want to remove the duplicate values in them just like this screenshot \n<a href=\"http://i.stack.imgur.com/hOeDs.jpg\" rel=\"nofollow\">duplicate values are removed using a macro</a></p>\n\n<p>I decided to use a macro that does this for me automatically and I found this VBS code that removes the duplicate values. What the macro actually does is that it removes the repeating values in the selected area where the cursor is in, so each time the macro runs I have to select the area that I would like the values to be removed. But, what I want is to remove the duplicates from the columns A, B, and C whether or not they are selected and no matter how many rows there are. And, I want it to work on open automatically. </p>\n\n<p>I considered using Range() instead of Selection() e.g. I put something like <code>Set r = Columns(\"A:C\").Select</code> but that didn't work. Is there a way to do this in VBS? </p>\n\n<pre><code>Option Explicit\n\nPrivate originalValues()\nPrivate originalRange As String\n\nSub removeDupes()\n Dim r As Range 'target range\n Dim arr() 'array to hold values\n Dim i As Long, j As Long, k As Long 'loop control\n Dim upper1D As Long, upper2D As Long, lower2D As Long 'array bounds\n Dim s As String 'temp string to compare values \n\n  Set r = Selection.Resize(Cells.SpecialCells(xlLastCell).Row)\n\n  If r.Rows.Count = 1 Then Exit Sub 'if the target range is only 1 row then quit\n   arr = r.Value 'copy the values in r to the array\n\n 'store the values for an undo\noriginalValues = r.Value\noriginalRange = r.Address\n\nupper1D = UBound(arr) 'get the upper bound of the array's 1st dimension\nupper2D = UBound(arr, 2) 'get the upper bound of the array's 2nd dimension\nlower2D = LBound(arr, 2) 'get the lower bound of the array's 2nd dimension\n\n 'loop through 'rows' in the array\nFor i = LBound(arr) To upper1D\n     'loop through all the 'columns' in the current row\n    For j = lower2D To upper2D\n        s = arr(i, j) 'record the current array component value in s\n         'Check to see if duplicates exists in the target range\n        If Application.CountIf(r.Columns(j), s) &gt; 1 _\n        And LenB(s) Then\n             'Duplicate found: if the end of the array has not ye been reached then\n             'loop through the remaining rows for this column, clearing duplicates\n            If i &lt; upper1D Then\n                For k = i + 1 To upper1D\n                    If arr(k, j) = s Then arr(k, j) = \"\"\n                Next k\n            End If\n        End If\n    Next j\nNext i\n 'copy array back to target range\nr.Value = arr\nApplication.OnUndo \"Undo remove duplicates\", \"restoreOriginalValues\"\n End Sub\n\n Private Sub restoreOriginalValues()\n  Range(originalRange).Value = originalValues\n End Sub\n</code></pre>\n\n<p>Thanks,\nLaleh</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1463597671, "post_id": 37307819, "comment_id": 62137094, "body": "<a href=\"http://codereview.stackexchange.com/q/87818/23788\">A reusable ProgressIndicator</a> might be more like what you&#39;re looking for."}], "answers": [{"tags": [], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "is_accepted": false, "score": 0, "last_activity_date": 1463597631, "creation_date": 1463597631, "answer_id": 37307946, "question_id": 37307819, "link": "https://stackoverflow.com/questions/37307819/run-worksheet-open-code-with-a-userform-active/37307946#37307946", "title": "Run Worksheet_Open code with a userform active", "body": "<p>You should put the code in the UseForm Activate event handler which would trigger on Workbook Open event handler :)</p>\n"}], "owner": {"reputation": 651, "user_id": 4315769, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/36a8ccef18d7fe530fdd36d405fe6b05?s=128&d=identicon&r=PG&f=1", "display_name": "Grafit", "link": "https://stackoverflow.com/users/4315769/grafit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1463597631, "creation_date": 1463597248, "last_edit_date": 1531164843, "question_id": 37307819, "link": "https://stackoverflow.com/questions/37307819/run-worksheet-open-code-with-a-userform-active", "title": "Run Worksheet_Open code with a userform active", "body": "<p>My program calls 7 subroutines in the workbook_open event. I want to show a progress bar (with a 'Done' button when the progress is 100%) but when I show the progress bar, it doesn't run the workbook_open event anymore until I close the userform, then it goes on running. Is there a way to show a userform with the code running in the background?</p>\n\n<pre><code>Private Sub Workbook_Open()\n    frmProgress.Show\n\n    'Here it stops running the code\n\n    frmProgress.lblTask = \"Updating pivottables...\"\n    Call updatePivots\n    ufProgress.Label1.BackColor = &amp;H8000000D\n    frmProgress.lblTask = \"Updating data...\"\n    Call updateData\n    ufProgress.Label2.BackColor = &amp;H8000000D\n\n    'Some More code\n\n    frmProgress.lblTask = \"Done!\"\nEnd Sub\n</code></pre>\n\n<p>I know the changing of the colors and the multiple labels are not efficient, I'm working on that.</p>\n"}, {"tags": ["vba", "macros", "openoffice.org", "openoffice-calc", "openoffice-basic"], "answers": [{"tags": [], "owner": {"reputation": 10032, "user_id": 5100564, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZZ7Z5.png?s=128&g=1", "display_name": "Jim K", "link": "https://stackoverflow.com/users/5100564/jim-k"}, "is_accepted": true, "score": 1, "last_activity_date": 1463753779, "creation_date": 1463753779, "answer_id": 37349062, "question_id": 37307610, "link": "https://stackoverflow.com/questions/37307610/openoffice-basic-how-to-insert-checkbox-in-sheet/37349062#37349062", "title": "OpenOffice BASIC how to insert checkbox in sheet", "body": "<p>To create check boxes manually, see <a href=\"https://help.libreoffice.org/Common/Form_Controls\" rel=\"nofollow\">here</a>.  To create check boxes dynamically:</p>\n\n<pre><code>Sub CreateCheckbox\n  oDoc = ThisComponent\n  oSheet = oDoc.Sheets.getByIndex(0)\n  oDrawPage = oSheet.DrawPage  'Was oDrawPage = oDoc.getDrawPage()\n  oCheckboxModel = AddNewCheckbox(\"Checkbox_1\", \"Check this box\", oDoc, oDrawPage)\nEnd Sub\n\nFunction AddNewCheckbox(sName As String, sLabel As String, _\n    oDoc As Object, oDrawPage As Object) As Object\n  oControlShape = oDoc.createInstance(\"com.sun.star.drawing.ControlShape\")\n  aPoint = CreateUnoStruct(\"com.sun.star.awt.Point\")\n  aSize = CreateUnoStruct(\"com.sun.star.awt.Size\")\n  aPoint.X = 1000\n  aPoint.Y = 1000\n  aSize.Width = 3000\n  aSize.Height = 1000\n  oControlShape.setPosition(aPoint)\n  oControlShape.setSize(aSize)\n\n  oButtonModel = CreateUnoService(\"com.sun.star.form.component.CheckBox\")\n  oButtonModel.Name = sName\n  oButtonModel.Label = sLabel\n\n  oControlShape.setControl(oButtonModel)\n  oDrawPage.add(oControlShape)\n\n  AddNewCheckbox = oButtonModel\nEnd Function\n</code></pre>\n\n<p>This code was adapted from <a href=\"https://forum.openoffice.org/en/forum/viewtopic.php?f=45&amp;t=46391\" rel=\"nofollow\">https://forum.openoffice.org/en/forum/viewtopic.php?f=45&amp;t=46391</a>.</p>\n"}], "owner": {"reputation": 942, "user_id": 2190492, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/fd3e5e7a4418f3d5872e086f00936f42?s=128&d=identicon&r=PG", "display_name": "user2190492", "link": "https://stackoverflow.com/users/2190492/user2190492"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1196, "favorite_count": 0, "accepted_answer_id": 37349062, "answer_count": 1, "score": 0, "last_activity_date": 1463753779, "creation_date": 1463596475, "question_id": 37307610, "link": "https://stackoverflow.com/questions/37307610/openoffice-basic-how-to-insert-checkbox-in-sheet", "title": "OpenOffice BASIC how to insert checkbox in sheet", "body": "<p>I'm using OpenOffice Calc.\nAnd I am writing macro's in OpenOffice BASIC.\nI need the right code to insert a checkbox in the sheet.</p>\n\n<p>I now have</p>\n\n<pre><code>Dim Doc as Object\nDoc = ThisComponent\nDim cbName As Object\ncbName = \"checkbox_name\"\n\nDim oCheckBoxModel as Object\n\n// dlg is a dialog, (don't know how to create a checkbox else)\noCheckBoxModel = dlg.getmodel().createInstance( \"com.sun.star.awt.UnoControlCheckBoxModel\" )\noCheckBoxModel.PositionX = 100\noCheckBoxModel.PositionY = 100\noCheckBoxModel.Width = 50\noCheckBoxModel.Height = 30\noCheckBoxModel.Label = id\noCheckBoxModel.Name = cbName\noCheckBoxModel.Enabled = True\noCheckBoxModel.TabIndex = 1\nDoc.Sheets().insertByName( cbName, oCheckBoxModel ) // This line is totally wrong, but I hope it's clear what I want to do\n</code></pre>\n\n<p>So I want to create a checkbox, and then insert it into the sheet. (In a specific cell, or just by setting a X and Y position).\nI searched on the internet, but I only find information about inserting controls into a dialog, not into a sheet</p>\n"}, {"tags": ["vba", "excel", "sumifs"], "comments": [{"owner": {"reputation": 286, "user_id": 5261233, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/i5rHw.jpg?s=128&g=1", "display_name": "Histerical", "link": "https://stackoverflow.com/users/5261233/histerical"}, "edited": false, "score": 0, "creation_date": 1463596671, "post_id": 37307401, "comment_id": 62136585, "body": "You could use <code>Sheets(1)</code> or whatever the sheet number reference is in your workbook. There are a lot of things you could potentially do, but hard to say without more information."}, {"owner": {"reputation": 1192, "user_id": 1744727, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8d02d3ecefb127c4467e9328308ffb12?s=128&d=identicon&r=PG", "display_name": "David", "link": "https://stackoverflow.com/users/1744727/david"}, "edited": false, "score": 0, "creation_date": 1463597687, "post_id": 37307401, "comment_id": 62137107, "body": "View the answer to this question for an idea of how to reference sheets by number within a formula: <a href=\"http://stackoverflow.com/questions/19790985/referencing-sheets-by-number-instead-of-name-in-cells\" title=\"referencing sheets by number instead of name in cells\">stackoverflow.com/questions/19790985/&hellip;</a>"}, {"owner": {"reputation": 25, "user_id": 6316308, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/231572a02ff447ef13a5d9c763906245?s=128&d=identicon&r=PG&f=1", "display_name": "Fcarboni", "link": "https://stackoverflow.com/users/6316308/fcarboni"}, "edited": false, "score": 0, "creation_date": 1463597752, "post_id": 37307401, "comment_id": 62137140, "body": "i would basicly need in my summary sheet in cell B3 to do a sumifs(B2006:B3005(over all sheets), where summaryA3 =  all sheets A2006:A3005 and summary B2 = all sheets B2005)"}, {"owner": {"reputation": 25, "user_id": 6316308, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/231572a02ff447ef13a5d9c763906245?s=128&d=identicon&r=PG&f=1", "display_name": "Fcarboni", "link": "https://stackoverflow.com/users/6316308/fcarboni"}, "edited": false, "score": 0, "creation_date": 1463597904, "post_id": 37307401, "comment_id": 62137226, "body": "Thanks David, I dont think I can use this as the workbook could have 3 sheets or 300 sheets, this is unknown un till the first macro is run so cant reference sheet numbers, also if it is run once, then again, it creates new sheets and deletes the old ones which shifts on the sheet numbers, thatsthe main reason I need a loop for all sheets in the workbook!"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1463598137, "post_id": 37307401, "comment_id": 62137346, "body": "Google &quot;3d SUMIFS&quot;.  It will show how to use a formula for this."}, {"owner": {"reputation": 25, "user_id": 6316308, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/231572a02ff447ef13a5d9c763906245?s=128&d=identicon&r=PG&f=1", "display_name": "Fcarboni", "link": "https://stackoverflow.com/users/6316308/fcarboni"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1463680961, "post_id": 37307401, "comment_id": 62180159, "body": "Thanks @ScottCraner for suggestion, I have the folowing but its errors on the formular, any Ideas?"}, {"owner": {"reputation": 25, "user_id": 6316308, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/231572a02ff447ef13a5d9c763906245?s=128&d=identicon&r=PG&f=1", "display_name": "Fcarboni", "link": "https://stackoverflow.com/users/6316308/fcarboni"}, "edited": false, "score": 0, "creation_date": 1463680971, "post_id": 37307401, "comment_id": 62180167, "body": "Sheets(&quot;Summary&quot;).Range(&quot;AI3:AI150&quot;).Name = &quot;Invoices&quot;  Range(&quot;B3&quot;).formula = &quot;=SUMPRODUCT(SUMIF(INDIRECT(&quot; &#39;&quot;&amp;Invoices&amp;&quot;&#39;!&quot;&amp;&quot;A2006:A3005&quot;),A3,INDIRECT(&quot;&#39;&quot;&amp;Invoices&amp;&quot;&#39;!&zwnj;&#8203;&quot;&amp;&quot;B2006:B3005&quot;)))&quot;"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1463681264, "post_id": 37307401, "comment_id": 62180356, "body": "Does the formula work if you enter it directly to the sheet?  Make it work in the sheet first then record a macro pasting the formula in a cell, Excel will then create the proper form for vba."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1463681697, "post_id": 37307401, "comment_id": 62180615, "body": "Try this formula <code>&quot;=SUMPRODUCT(SUMIF(INDIRECT(&quot;&quot;&#39;&quot;&quot; &amp; Invoices &amp; &quot;&quot;&#39;!B2006:B3005&quot;&quot;),A3))&quot;</code>"}, {"owner": {"reputation": 25, "user_id": 6316308, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/231572a02ff447ef13a5d9c763906245?s=128&d=identicon&r=PG&f=1", "display_name": "Fcarboni", "link": "https://stackoverflow.com/users/6316308/fcarboni"}, "edited": false, "score": 0, "creation_date": 1463681868, "post_id": 37307401, "comment_id": 62180721, "body": "its not working on the sheet, its reconising that its a formula and reconising my list but brings up #Ref"}, {"owner": {"reputation": 25, "user_id": 6316308, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/231572a02ff447ef13a5d9c763906245?s=128&d=identicon&r=PG&f=1", "display_name": "Fcarboni", "link": "https://stackoverflow.com/users/6316308/fcarboni"}, "edited": false, "score": 0, "creation_date": 1463682809, "post_id": 37307401, "comment_id": 62181210, "body": "I think its close but its still not quite there"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1463682918, "post_id": 37307401, "comment_id": 62181252, "body": "Then there is a misspelling in one or more of the sheet names in the Invoices range.  Make sure that they are spelled exactly the same and there are no spaces that are not in both."}, {"owner": {"reputation": 25, "user_id": 6316308, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/231572a02ff447ef13a5d9c763906245?s=128&d=identicon&r=PG&f=1", "display_name": "Fcarboni", "link": "https://stackoverflow.com/users/6316308/fcarboni"}, "edited": false, "score": 0, "creation_date": 1463683137, "post_id": 37307401, "comment_id": 62181358, "body": "TOP Man the range was selecting a blank cell so would crash out"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1463684113, "post_id": 37307401, "comment_id": 62181919, "body": "Now write an answer telling us what you did for future searches.  then in two days, if no one else comes up with a better method, mark it as correct."}], "answers": [{"tags": [], "owner": {"reputation": 25, "user_id": 6316308, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/231572a02ff447ef13a5d9c763906245?s=128&d=identicon&r=PG&f=1", "display_name": "Fcarboni", "link": "https://stackoverflow.com/users/6316308/fcarboni"}, "is_accepted": true, "score": 0, "last_activity_date": 1463754065, "creation_date": 1463754065, "answer_id": 37349183, "question_id": 37307401, "link": "https://stackoverflow.com/questions/37307401/sumifs-to-loop-all-sheets/37349183#37349183", "title": "sumifs to loop all sheets", "body": "<p>Thanks, so for anyone else who needs this, this is how it was done in full\nmy original formula was </p>\n\n<pre><code>\"=SUMPRODUCT(SUMIF(INDIRECT(\" '\"&amp;Invoices&amp;\"'!\"&amp;\"A2006:A3005\"),A3,INDIRECT(\"'\"&amp;Invoices&amp;\"'!\"&amp;\"B2006:B3005\")))\" \n</code></pre>\n\n<p>this worked when putting straight into a cell but as you can see, when adding it to VBA it reads it as a comment. To fix this, every time you use a \"  you need to add extra \" as shown bellow (apart form before the\" = at the start and after the )\" at the end of the formula)</p>\n\n<pre><code> *****'list all the sheet names in cell AI1 of the sheet summary*****\nFor i = 1 To Sheets.Count\nSheets(\"Summary\").Range(\"AI1\")(i, 1).Value = Sheets(i).Name\nNext i\n***'clear the first 3 entries in AI as i didnt need the first three sheet names***\nSheets(\"Summary\").Select\nSheets(\"Summary\").Range(\"AI1:AI3\").Clear\n***'select the first sheet name, which is in AI4 as we cleard the first 3 to the last used cell, e.g Ctrl.Shift.down*** \nSheets(\"Summary\").Activate\nSheets(\"summary\").Range(ActiveSheet.Range(\"AI4\"),    ActiveSheet.Range(\"AI4\").End(xlDown)).Select\n***' Name the range invoices***\nSelection.Name = \"Invoices\"\n' ***Formula to do a sumIf looping all the shets in the named range Invoices***\nSheets(\"summary\").Range(\"B3\").Formula = \"=SUMPRODUCT(SUMIF(INDIRECT(\"\"'\"\"&amp;Invoices&amp;\"\"'!$A$2006:$A$3005\"\"),$A3,INDIRECT(\"\"'\"\"&amp;Invoices&amp;\"\"'!B$2006:B$3005\"\")))\"\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 6316308, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/231572a02ff447ef13a5d9c763906245?s=128&d=identicon&r=PG&f=1", "display_name": "Fcarboni", "link": "https://stackoverflow.com/users/6316308/fcarboni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 205, "favorite_count": 0, "accepted_answer_id": 37349183, "answer_count": 1, "score": 1, "last_activity_date": 1463754065, "creation_date": 1463595849, "question_id": 37307401, "link": "https://stackoverflow.com/questions/37307401/sumifs-to-loop-all-sheets", "title": "sumifs to loop all sheets", "body": "<p>I have been searching different forums and cant seem to find my answer.\nI have rather basic VBA knowledge and build most of my code from bits online!</p>\n\n<p>Regardless of cell references as I would be able to work these out at a later date.\nPlease can you let me how I would make a sumifs formula reference across multiple sheets. \nThis is being build into a template and there would be a different number of sheets with different names each time it is run so I would be not be able to reference the sheets.</p>\n\n<p>sorry thats a bit vague\nthanks in advanced</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1463596426, "creation_date": 1463596426, "answer_id": 37307586, "question_id": 37307340, "link": "https://stackoverflow.com/questions/37307340/return-entire-row-from-index-match-function-excel/37307586#37307586", "title": "Return Entire Row from Index Match Function Excel", "body": "<p>I would use SUMPRODUCT:</p>\n\n<pre><code>=SUMPRODUCT(($A$3:$A$10=$I3)*($B$3:$G$10=J$2))&gt;0\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/kiWbX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kiWbX.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 6352544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8de2b6d145fe2795545f1046c3241fee?s=128&d=identicon&r=PG&f=1", "display_name": "epw", "link": "https://stackoverflow.com/users/6352544/epw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 497, "favorite_count": 1, "accepted_answer_id": 37307586, "answer_count": 1, "score": 0, "last_activity_date": 1463614778, "creation_date": 1463595617, "last_edit_date": 1531161705, "question_id": 37307340, "link": "https://stackoverflow.com/questions/37307340/return-entire-row-from-index-match-function-excel", "title": "Return Entire Row from Index Match Function Excel", "body": "<p>In Table 1:</p>\n\n<ul>\n<li>I have Product Segments 1-6 for Companies</li>\n<li>1-8. Each have different products that they list, not necessarily in the same order.\n1-8. Each have different products that they list, not necessarily in the same order.</li>\n</ul>\n\n<p>In Table 2:</p>\n\n<ul>\n<li>I would like to return a \"True\" or \"False\" if the company lists Product Segments A-F as one of their products. For example, in Table 2 for Product Segment A, company 1 would return \"True\" and company 4 would return \"False\"</li>\n</ul>\n\n<p>I feel like an <code>=MATCH(J$2,INDEX($B$3:$G$10,MATCH($I3,$A$3:$A$10,0)),0)</code> function is exactly what I'm looking for, but unfortunately I cannot return an array with excel's INDEX function.</p>\n\n<p>Any suggestions would be highly appreciated.</p>\n\n<p>Please refer to the image below:\n<a href=\"http://i.stack.imgur.com/491Wk.jpg\" rel=\"nofollow\">http://i.stack.imgur.com/491Wk.jpg</a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 2, "creation_date": 1463592597, "post_id": 37306437, "comment_id": 62134353, "body": "you should tell us which line is producing the error.   You can also use the Trim function to remove leading and trailing whitespaces.  I am assuming it is the line r = cell.Value  that is producing the error.   Are all cell values integers?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1463592948, "post_id": 37306437, "comment_id": 62134556, "body": "Wait - you declare <code>r</code>, never give it a value, then set a cell equal to the non-existent value? What&#39;s the line there for?  Also, do you need VBA? I think you could do this with a simple <code>CountIf()</code>? <code>=CountIf(&quot;E:E&quot;,&quot;*123*&quot;)</code> where you&#39;re searching for the Account &quot;123&quot;. If it finds a match in Column E, the value will be greater than 1.  You can then just do <code>=If(CountIf(&quot;E:E&quot;,&quot;*123*&quot;)&gt;1,&quot;Match found&quot;,&quot;NO match&quot;)</code>."}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1463593183, "post_id": 37306437, "comment_id": 62134680, "body": "cell is also returning an array....."}, {"owner": {"reputation": 29, "user_id": 6352401, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e795fc030ec7af5ca211b048d84c5b4f?s=128&d=identicon&r=PG&f=1", "display_name": "erikasoladams", "link": "https://stackoverflow.com/users/6352401/erikasoladams"}, "edited": false, "score": 0, "creation_date": 1463593351, "post_id": 37306437, "comment_id": 62134777, "body": "The error is Run-time error &#39;13&#39; Type mismatch...so yes it has something to do with the type. I just tried to convert the cell value into an integer with cInt(cell.Value) but the same error popped up."}, {"owner": {"reputation": 29, "user_id": 6352401, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e795fc030ec7af5ca211b048d84c5b4f?s=128&d=identicon&r=PG&f=1", "display_name": "erikasoladams", "link": "https://stackoverflow.com/users/6352401/erikasoladams"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1463593560, "post_id": 37306437, "comment_id": 62134896, "body": "@BruceWayne I need to do this in VBA because it is part of a larger macro that is called on when a button is pushed. It will check if the registration number already exists on another sheet and exit sub if it does - disallowing the user from entering the registration twice. And Ive given r the range(&quot;A19&quot;).value"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1463593574, "post_id": 37306437, "comment_id": 62134904, "body": "Oh, I think you just got it backwards - switch out for this line, <code>r = Range(&quot;A19&quot;).Value</code>"}], "answers": [{"tags": [], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "is_accepted": true, "score": 0, "last_activity_date": 1463593651, "last_edit_date": 1463593651, "creation_date": 1463592994, "answer_id": 37306616, "question_id": 37306437, "link": "https://stackoverflow.com/questions/37306437/msgbox-error-if-the-number-entered-in-certain-cell-is-a-duplicate-of-a-number-in/37306616#37306616", "title": "MsgBox Error if the number entered in certain cell is a duplicate of a number in column on another worksheet?", "body": "<pre><code>Private Sub morestuff()\n    Dim r As Integer\n    Dim regisRange As Range\n    Dim rcell As Range\n    Set regisRange = ThisWorkbook.Sheets(\"Sheet1\").Columns(2)\n    r = Range(\"A19\").Value\n    For Each rcell In regisRange.Cells\n        If Trim(rcell.Value) = r Then\n            MsgBox \"The Registration Number is already in use.\"\n            Exit Sub\n        End If\n    Next rcell\nEnd Sub\n</code></pre>\n\n<p>This should work :)</p>\n\n<p>there were quite a few things wrong. Incorrect sheet reference, not naming an object, and an incorrect cell reference. </p>\n\n<p>I obviously changed things to make it work in my workbook, replace values to suite your needs</p>\n\n<p><a href=\"https://i.stack.imgur.com/vulkb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vulkb.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 0, "last_activity_date": 1463593792, "creation_date": 1463593792, "answer_id": 37306872, "question_id": 37306437, "link": "https://stackoverflow.com/questions/37306437/msgbox-error-if-the-number-entered-in-certain-cell-is-a-duplicate-of-a-number-in/37306872#37306872", "title": "MsgBox Error if the number entered in certain cell is a duplicate of a number in column on another worksheet?", "body": "<p>If I may suggest instead just doing a <code>CountIf()</code>?</p>\n\n<pre><code>Dim r$\nr = Range(\"A19\").Value\n\nnumberOfDuplicates = WorksheetFunction.CountIf(Range(\"E:E\"), \"*\" &amp; r &amp; \"*\")\nIf numberOfDuplicates &gt; 0 Then\n    MsgBox \"The registration number is already in use\"\nEnd If\n</code></pre>\n\n<p>This avoids having to loop through an entire column, or do a \"for each x\", which should save time.</p>\n\n<p>May need to tweak this, perhaps like <code>r = Trim(Range(\"A19\").Value)</code>. Also, make sure you add the Worksheet references. Otherwise, this should work for you.</p>\n"}], "owner": {"reputation": 29, "user_id": 6352401, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e795fc030ec7af5ca211b048d84c5b4f?s=128&d=identicon&r=PG&f=1", "display_name": "erikasoladams", "link": "https://stackoverflow.com/users/6352401/erikasoladams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 37306616, "answer_count": 2, "score": 0, "last_activity_date": 1463593792, "creation_date": 1463592451, "last_edit_date": 1463592514, "question_id": 37306437, "link": "https://stackoverflow.com/questions/37306437/msgbox-error-if-the-number-entered-in-certain-cell-is-a-duplicate-of-a-number-in", "title": "MsgBox Error if the number entered in certain cell is a duplicate of a number in column on another worksheet?", "body": "<p>I have a VBA script that will enter all new registration numbers (with registars information) on one page and copy and paste the information into other worksheets for storing.</p>\n\n<p>I just need to make sure that the new registration number (cell A19 on Welcome sheet) is not already in the column that stores registration numbers (column B or 2 on Registration sheet). If values are the same, exit sub.</p>\n\n<p>BONUS: would be nice if I can account for an accidental space after the newly entered numbers so 1478(space) wont be added if 1478(withoutspace) exists.</p>\n\n<p>Here is the script that says error 13 type mismatch when I run it:</p>\n\n<pre><code>Dim r As Integer\nDim regisRange As Range\nSet regisRange = Worksheets(\"Registration\").Columns(2)\nRange(\"A19\").Value = r\nFor Each cell In regisRange\n    If r = cell.Value Then\n        MsgBox \"The Registration Number is already in use.\"\n        Exit Sub\n    End If\nNext cell\n</code></pre>\n"}, {"tags": ["vba", "excel", "case-sensitive", "case-insensitive"], "comments": [{"owner": {"reputation": 1293, "user_id": 2665195, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8rUmZ.png?s=128&g=1", "display_name": "Instant Breakfast", "link": "https://stackoverflow.com/users/2665195/instant-breakfast"}, "edited": false, "score": 1, "creation_date": 1463592842, "post_id": 37306329, "comment_id": 62134492, "body": "This line pushes everything to lower case: <code>Words = Split(LCase(activecell.Value))</code>"}, {"owner": {"reputation": 85, "user_id": 5816736, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/UhUjQ.png?s=128&g=1", "display_name": "ADrex", "link": "https://stackoverflow.com/users/5816736/adrex"}, "reply_to_user": {"reputation": 1293, "user_id": 2665195, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8rUmZ.png?s=128&g=1", "display_name": "Instant Breakfast", "link": "https://stackoverflow.com/users/2665195/instant-breakfast"}, "edited": false, "score": 0, "creation_date": 1463592934, "post_id": 37306329, "comment_id": 62134548, "body": "Should I delete it or change it?"}, {"owner": {"reputation": 1293, "user_id": 2665195, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8rUmZ.png?s=128&g=1", "display_name": "Instant Breakfast", "link": "https://stackoverflow.com/users/2665195/instant-breakfast"}, "edited": false, "score": 1, "creation_date": 1463593012, "post_id": 37306329, "comment_id": 62134591, "body": "It think if you remove <code>LCase</code> it should work as you intend. Like this: <code>Words = Split(activecell.Value)</code>"}, {"owner": {"reputation": 85, "user_id": 5816736, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/UhUjQ.png?s=128&g=1", "display_name": "ADrex", "link": "https://stackoverflow.com/users/5816736/adrex"}, "reply_to_user": {"reputation": 1293, "user_id": 2665195, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8rUmZ.png?s=128&g=1", "display_name": "Instant Breakfast", "link": "https://stackoverflow.com/users/2665195/instant-breakfast"}, "edited": false, "score": 0, "creation_date": 1463593250, "post_id": 37306329, "comment_id": 62134712, "body": "Words = Split(activecell.Value) worked perfectly. Thank you. If you post it as answer I will mark you."}], "answers": [{"tags": [], "owner": {"reputation": 1293, "user_id": 2665195, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8rUmZ.png?s=128&g=1", "display_name": "Instant Breakfast", "link": "https://stackoverflow.com/users/2665195/instant-breakfast"}, "is_accepted": true, "score": 2, "last_activity_date": 1463767962, "last_edit_date": 1463767962, "creation_date": 1463593532, "answer_id": 37306789, "question_id": 37306329, "link": "https://stackoverflow.com/questions/37306329/why-this-code-is-making-the-codes-change-to-proper-case/37306789#37306789", "title": "Why this code is making the codes change to Proper case?", "body": "<p>You have made all of your content lowercase when you split it into an array.</p>\n\n<p>Remove <code>LCase</code> when you split the cell content to <code>Words</code> and it should work as you intend:</p>\n\n<pre><code>Words = Split(activecell.Value)\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 5816736, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/UhUjQ.png?s=128&g=1", "display_name": "ADrex", "link": "https://stackoverflow.com/users/5816736/adrex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 37306789, "answer_count": 1, "score": 0, "last_activity_date": 1463767962, "creation_date": 1463592118, "last_edit_date": 1531164843, "question_id": 37306329, "link": "https://stackoverflow.com/questions/37306329/why-this-code-is-making-the-codes-change-to-proper-case", "title": "Why this code is making the codes change to Proper case?", "body": "<p>This code is translating all the words in a cell, but only the first should be forced to Proper case, the other words should keep the case written by the user, but instead it is forcing the first word to proper case and all the other words in the cell to lower case. All the other words should mantain its original case. </p>\n\n<pre><code>Sub TraAdd()\n\n    Dim translate As Object 'scritping.Dictionary\n\n    Set translate = CreateObject(\"Scripting.Dictionary\")\n\n    translate(\"modens\") = \"modems\"\n    translate(\"Modens\") = \"Modems\"\n    translate(\"modens,\") = \"modems,\"\n    translate(\"Modens,\") = \"Modems,\"\n    translate(\"Fruteira,\") = \"Fruit bowl,\"\n    translate(\"fruteira,\") = \"fruit bowl,\"\n    translate(\"Fruteira\") = \"Fruit bowl\"\n    translate(\"fruteira\") = \"fruit bowl\"\n    translate(\"muletas\") = \"crutches\"\n    translate(\"Muletas\") = \"Crutches\"\n    translate(\"muletas,\") = \"crutches,\"\n    translate(\"Muletas,\") = \"Crutches,\"\n\n\n    Dim Words As Variant\n    Dim I As Integer\n    Words = Split(LCase(activecell.Value))\n\n\n    For I = LBound(Words) To UBound(Words)\n        If translate(Words(I)) &lt;&gt; \"\" Then Words(I) = translate(Words(I))\n    Next\n    activecell.Value = Join(Words)\n    activecell.Value = Ucase$(Left$(activecell.Value, 1)) &amp; Right$(activecell.Value, Len(activecell.Value) - 1)\n\nEnd Sub\n</code></pre>\n\n<p>Any ideas?</p>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 1, "creation_date": 1463595977, "post_id": 37306279, "comment_id": 62136172, "body": "why not simply select the whole range and then let the sub act for the first and last column instead of dealing with non-contiguous ranges?"}, {"owner": {"reputation": 724, "user_id": 3112610, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/VcnQ4.jpg?s=128&g=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/3112610/adam"}, "reply_to_user": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1463596350, "post_id": 37306279, "comment_id": 62136400, "body": "@DirkReichel Interesting idea.  I could do that.  It would take a bit of rewriting, but at least I can see exactly how that would work.  Still would like to know how to do it with disjoint ranges, though."}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1463596564, "post_id": 37306279, "comment_id": 62136532, "body": "another question... assuming the values you provided are in A1:B8 then you simply doing the same like (starting in C2) <code>=IF(B2=&quot;&quot;,(A2-A1)&#47;(A3-A1)*(B3-B1)+B1,B2)</code>, am I correct?"}, {"owner": {"reputation": 724, "user_id": 3112610, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/VcnQ4.jpg?s=128&g=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/3112610/adam"}, "reply_to_user": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1463597133, "post_id": 37306279, "comment_id": 62136830, "body": "Not quite - I hadn&#39;t shown this, but the script works if I am missing multiple values in column B.  I edited the question to show that better."}], "answers": [{"comments": [{"owner": {"reputation": 724, "user_id": 3112610, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/VcnQ4.jpg?s=128&g=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/3112610/adam"}, "edited": false, "score": 0, "creation_date": 1463593836, "post_id": 37306357, "comment_id": 62135062, "body": "If I add <code>secondCol = Selection.Areas(2)</code> it looks like it is successfully reading the values from the second column, but I can&#39;t act on them as locations.  (For instance, the fifth cell of ht esecond column in my example is blank, so when <code>i=5</code> the test  <code>IsEmpty(secondCol(i, 1))</code> correctly returns true, but <code>secondCol(i, 1).Font.Bold = True</code> gives a <i>424: object required</i> error."}, {"owner": {"reputation": 455, "user_id": 6282596, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7646135fdc5025d023566a59d70f7fa8?s=128&d=identicon&r=PG&f=1", "display_name": "Weasemunk", "link": "https://stackoverflow.com/users/6282596/weasemunk"}, "edited": false, "score": 0, "creation_date": 1463594601, "post_id": 37306357, "comment_id": 62135439, "body": "Just at a brief glance, first you might try setting a watch for secondCol (right click and &quot;Add Watch&quot;), then you can step through your program and see whether it correctly sets an object reference. Also is secondCol a 1D or 2D array?"}, {"owner": {"reputation": 724, "user_id": 3112610, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/VcnQ4.jpg?s=128&g=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/3112610/adam"}, "edited": false, "score": 0, "creation_date": 1463596271, "post_id": 37306357, "comment_id": 62136349, "body": "With selection = &quot;$A$2:$A$8,$C$2:$C$8&quot;, <code>secondCol = Selection.Areas(2)</code> is a 1-D array that doesn&#39;t appear to &quot;remember&quot;&quot; where the cells it came from are."}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "reply_to_user": {"reputation": 724, "user_id": 3112610, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/VcnQ4.jpg?s=128&g=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/3112610/adam"}, "edited": false, "score": 1, "creation_date": 1463600173, "post_id": 37306357, "comment_id": 62138489, "body": "@Adam <code>secondCol = Selection.Areas(2)</code> will only hold the values... you need <code>Set secondCol = Selection.Areas(2)</code>!"}, {"owner": {"reputation": 724, "user_id": 3112610, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/VcnQ4.jpg?s=128&g=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/3112610/adam"}, "reply_to_user": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 1, "creation_date": 1463600840, "post_id": 37306357, "comment_id": 62138830, "body": "Yes!  Thank you cxw &amp; @DirkReichel"}], "tags": [], "owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "is_accepted": true, "score": 3, "last_activity_date": 1463592203, "creation_date": 1463592203, "answer_id": 37306357, "question_id": 37306279, "link": "https://stackoverflow.com/questions/37306279/group-two-non-adjacent-columns-into-2d-array-for-excel-vba-script/37306357#37306357", "title": "Group two non-adjacent columns into 2d array for Excel VBA Script", "body": "<p>You're dealing with \"disjoint ranges.\"  Use the <code>Areas</code> collection, e.g., as described <a href=\"http://www.mrexcel.com/forum/excel-questions/620713-disjoint-range.html#post3077768\" rel=\"nofollow\">here</a>.  The first column should be in <code>Selection.Areas(1)</code> and the second column should be in <code>Selection.Areas(2)</code>.</p>\n"}], "owner": {"reputation": 724, "user_id": 3112610, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/VcnQ4.jpg?s=128&g=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/3112610/adam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1039, "favorite_count": 0, "accepted_answer_id": 37306357, "answer_count": 1, "score": 1, "last_activity_date": 1463597180, "creation_date": 1463591933, "last_edit_date": 1531161705, "question_id": 37306279, "link": "https://stackoverflow.com/questions/37306279/group-two-non-adjacent-columns-into-2d-array-for-excel-vba-script", "title": "Group two non-adjacent columns into 2d array for Excel VBA Script", "body": "<p>I think this question might be related to <a href=\"https://stackoverflow.com/questions/1796852/ms-excel-2-columns-into-a-2-dimensional-array\">Ms Excel -&gt; 2 columns into a 2 dimensional array</a> but I can't quite make the connection.</p>\n\n<p>I have a VBA script for filling missing missing data.  I select two adjacent columns, and it finds any gaps in the second column and linearly interpolates based on (possibly irregular) spacing in the first column.  For instance, I could use it on this data:</p>\n\n<pre><code>1    7\n2    14\n3    21\n5    35\n5.1    \n6    42\n7\n8     \n9    45\n</code></pre>\n\n<p>to get this output</p>\n\n<pre><code>1    7\n2    14\n3    21\n5    35\n5.1  35.7  &lt;---1/10th the way between 35&amp;42\n6    42\n7    43   &lt;-- 1/3 the way between 42 &amp; 45\n8    44   &lt;-- 2/3 the way between 42 &amp; 45 \n9    45\n</code></pre>\n\n<p>This is very useful for me.</p>\n\n<p>My trouble is that it only works on contiguous columns.  I would like to be able to select two columns that are not adjacent to each other and have it work the same way. My code starts out like this:</p>\n\n<pre><code>Dim addr As String\naddr = Selection.Address\n\nDim nR As Long\nDim nC As Long\n\n'Reads Selected Cells' Row and Column Information\nnR = Range(addr).Rows.Count   \nnC = Range(addr).Columns.Count\n</code></pre>\n\n<p>When I run this with contiguous columns selected, <code>addr</code> shows up in the Locals window with a value like <code>\"$A$2:$B$8\"</code> and <code>nC</code> = 2</p>\n\n<p>When I run this with <em>non</em>-contiguous columns selected, <code>addr</code> shows up in the Locals window with a value like <code>\"$A$2:$A$8,$C$2:$C$8\"</code> and <code>nC</code> = 1.</p>\n\n<p>Later on in the script, I collect the values in each column into an array.  Here's how I deal with the second column, for example:</p>\n\n<pre><code> 'Creates a Column 2 (col1) array, determines cells needed to interpolate for, changes font to bold and red, and reads its values\n        Dim col2() As Double\n        ReDim col2(0 To nR + 1)\n        i = 1\n        Do Until i &gt; nR\n            If IsEmpty(Selection(i, 2)) Or Selection(i, 2) = 0 Or Selection(i, 2) = -901 Then\n                Selection(i, 2).Font.Bold = True\n                Selection(i, 2).Font.Color = RGB(255, 69, 0)\n                col2(i) = 9999999\n            Else\n                col2(i) = Selection(i, 2)\n            End If\n\n            i = i + 1\n            Loop\n</code></pre>\n\n<p>This is also busted, because even if my selection is <code>\"$A$2:$A$8,$C$2:$C$8\"</code> VBA will treat <code>Selection(1,2)</code> as a reference to <code>$B$2</code>, not the desired <code>$C$2</code>.  </p>\n\n<p>Anyone have a suggestion for how I can get VBA to treat non-contiguous selection the way it treats contiguous?</p>\n"}, {"tags": ["mysql", "vba", "excel"], "comments": [{"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1463590000, "post_id": 37305487, "comment_id": 62132894, "body": "Clearly something has changed... verify that <code>itemcode</code> definitely exists, is long enough for the data and typed correctly."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1463617237, "post_id": 37305487, "comment_id": 62144892, "body": "MySQL frontend? Did you mean backend? And what is the error?"}, {"owner": {"reputation": 11, "user_id": 6351928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675c07696b17e4cc9f8546b1c6a63b64?s=128&d=identicon&r=PG&f=1", "display_name": "M.Suchard", "link": "https://stackoverflow.com/users/6351928/m-suchard"}, "edited": false, "score": 0, "creation_date": 1463684753, "post_id": 37305487, "comment_id": 62182283, "body": "Hi, Thanks for getting back to me. I didn&#39;t see the response. My mistake it&#39;s a MYSQL back end using ACCESS as a front end. I have verified the datatype as VARCHAR(25) and the number of characters to be brought into the field is 11."}, {"owner": {"reputation": 11, "user_id": 6351928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675c07696b17e4cc9f8546b1c6a63b64?s=128&d=identicon&r=PG&f=1", "display_name": "M.Suchard", "link": "https://stackoverflow.com/users/6351928/m-suchard"}, "edited": false, "score": 0, "creation_date": 1463684802, "post_id": 37305487, "comment_id": 62182313, "body": "The error is the script is failing at inserting ITEMCODE into the table. ITEMCODE is a field in the table and it is written out in the code. And I am not seeing the issue."}, {"owner": {"reputation": 439, "user_id": 2419939, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RHUKa.jpg?s=128&g=1", "display_name": "Ivan Laharnar mink.si", "link": "https://stackoverflow.com/users/2419939/ivan-laharnar-mink-si"}, "edited": false, "score": 0, "creation_date": 1463751686, "post_id": 37305487, "comment_id": 62212750, "body": "check itemcode field. Can you paste here your table tbl_Invoice structure?"}, {"owner": {"reputation": 11, "user_id": 6351928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675c07696b17e4cc9f8546b1c6a63b64?s=128&d=identicon&r=PG&f=1", "display_name": "M.Suchard", "link": "https://stackoverflow.com/users/6351928/m-suchard"}, "edited": false, "score": 0, "creation_date": 1464031625, "post_id": 37305487, "comment_id": 62306483, "body": "Hello,  Thanks for the response.  This text box won&#39;t let me copy/paste the table structure.  I can write it out: Column Name: itemcode, Datatype: VARCHAR(25).  Does this help? Thanks again."}, {"owner": {"reputation": 439, "user_id": 2419939, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RHUKa.jpg?s=128&g=1", "display_name": "Ivan Laharnar mink.si", "link": "https://stackoverflow.com/users/2419939/ivan-laharnar-mink-si"}, "edited": false, "score": 0, "creation_date": 1464104001, "post_id": 37305487, "comment_id": 62341798, "body": "Check the Case-sensitive of the field itemcode."}, {"owner": {"reputation": 11, "user_id": 6351928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675c07696b17e4cc9f8546b1c6a63b64?s=128&d=identicon&r=PG&f=1", "display_name": "M.Suchard", "link": "https://stackoverflow.com/users/6351928/m-suchard"}, "edited": false, "score": 0, "creation_date": 1464125707, "post_id": 37305487, "comment_id": 62353775, "body": "Hi. I checked the table and I can&#39;t find any comments or notation that field itemcode is case sensitive.  Can you advise on where to look?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6351928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675c07696b17e4cc9f8546b1c6a63b64?s=128&d=identicon&r=PG&f=1", "display_name": "M.Suchard", "link": "https://stackoverflow.com/users/6351928/m-suchard"}, "edited": false, "score": 0, "creation_date": 1463685141, "post_id": 37310587, "comment_id": 62182494, "body": "Thanks for that, I see where the redundant &quot;&amp;&quot; was.  I tried running the the script with the new line. And I still get the same error."}], "tags": [], "owner": {"reputation": 439, "user_id": 2419939, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RHUKa.jpg?s=128&g=1", "display_name": "Ivan Laharnar mink.si", "link": "https://stackoverflow.com/users/2419939/ivan-laharnar-mink-si"}, "is_accepted": false, "score": 0, "last_activity_date": 1463607809, "creation_date": 1463607809, "answer_id": 37310587, "question_id": 37305487, "link": "https://stackoverflow.com/questions/37305487/mysql-access-macro-error-unknown-column-in-field-list/37310587#37310587", "title": "MYSQL-Access-Macro Error Unknown column in field list", "body": "<p>Look at the variable fname , there you have redundant \" &amp; \" . I think it should be:</p>\n\n<pre><code>rec.Open (\"Insert into tbl_Invoice       (invoiceNumber,invoiceDate,invoiceAmount,invoiceDescription,invoiceFAU,invoiceCostCenter,invoiceProject,itemcode,invoicecFName,invoicecLName, invoicecAddr1, invoicecAddr2, invoicecCity, invoicecState, invoicecZIP, invoicecEmail, invoicecPhone) Values ('\" &amp; InstData(2) &amp; \"','\" &amp; invoiceDate &amp; \"','\" &amp; InstData(11) &amp; \"','Data Services','T6','T6','DATASL','40070DATASL','\" &amp; fname &amp; \"','\" &amp; lname &amp; \"','\" &amp; InstData(4) &amp; \"', '\" &amp; InstData(5) &amp; \"', '\" &amp; InstData(6) &amp; \"', '\" &amp; InstData(7) &amp; \"', '\" &amp; InstData(8) &amp; \"', '\" &amp; InstData(10) &amp; \"', '\" &amp;  InstData(9) &amp; \"')\"), conn\n</code></pre>\n\n<p>Tell me if I'm right, or mark a vote up!</p>\n"}], "owner": {"reputation": 11, "user_id": 6351928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675c07696b17e4cc9f8546b1c6a63b64?s=128&d=identicon&r=PG&f=1", "display_name": "M.Suchard", "link": "https://stackoverflow.com/users/6351928/m-suchard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 163, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1463607809, "creation_date": 1463589461, "last_edit_date": 1463606319, "question_id": 37305487, "link": "https://stackoverflow.com/questions/37305487/mysql-access-macro-error-unknown-column-in-field-list", "title": "MYSQL-Access-Macro Error Unknown column in field list", "body": "<p>I am trying to run an Excel macro that imports data from a csv file into an Access database, MySQL front end. The macro code is not new-we've been using this for a couple of years, the table in the Access DB is not new, and the csv files with which the data is used to be brought into the Access table is also unchanged (meaning same rows, same data types). </p>\n\n<p>I am stumped as the error appears to be something of an anomaly and I have tried several fixes to correct the error. I have attached a copy of the error as well as the code below. The issue with the column referenced below as well error message attached, \"itemcode\", this column is in the database. </p>\n\n<p>Clearly, there is something that I am missing. Any insights are greatly appreciated. Thank you.</p>\n\n<pre><code>'Read in Current .csv file\n'Data Services\n NumRows = Application.CountA(Range(\"A:A\"))\n For iCount = 1 To NumRows \n Dim InstData(11)\n InstData(1) = Range(\"A\" &amp; iCount) 'Date\n    invoiceDate = Format(InstData(1), \"yyyy/mm/dd\")\n InstData(2) = Range(\"B\" &amp; iCount) 'Invoice Number\n InstData(3) = Range(\"C\" &amp; iCount) 'names\n    flname() = Split(InstData(3), \",\")\n    lname = flname(0)\n    fname = flname(1)\n InstData(4) = Range(\"D\" &amp; iCount) 'Address1\n InstData(5) = Range(\"E\" &amp; iCount) 'Address2\n InstData(6) = Range(\"F\" &amp; iCount) 'City\n InstData(7) = Range(\"G\" &amp; iCount) 'State\n InstData(8) = Format(Range(\"H\" &amp; iCount), \"00000\") 'postal code\n InstData(9) = Range(\"I\" &amp; iCount) 'phone\n InstData(10) = Range(\"J\" &amp; iCount) 'email\n InstData(11) = Range(\"K\" &amp; iCount) 'amount\n\n Set conn = New ADODB.Connection\n Set rec = New ADODB.Recordset\n conn.Open \"Dsn=HERIpub\"\nrec.Open (\"Insert into tbl_Invoice       (invoiceNumber,invoiceDate,invoiceAmount,invoiceDescription,invoiceFAU,invoiceCostCenter,invoiceProject,itemcode,invoicecFName,invoicecLName, invoicecAddr1, invoicecAddr2, invoicecCity, invoicecState, invoicecZIP, invoicecEmail, invoicecPhone) Values ('\" &amp; InstData(2) &amp; \"','\" &amp; invoiceDate &amp; \"','\" &amp; InstData(11) &amp; \"','Data Services','T6','T6','DATASL','40070DATASL','\" &amp; fname &amp; \"'\" &amp; \",'\" &amp; lname &amp; \"','\" &amp; InstData(4) &amp; \"', '\" &amp; InstData(5) &amp; \"', '\" &amp; InstData(6) &amp; \"', '\" &amp; InstData(7) &amp; \"', '\" &amp; InstData(8) &amp; \"', '\" &amp; InstData(10) &amp; \"', '\" &amp;  InstData(9) &amp; \"')\"), conn\n</code></pre>\n\n<p><a href=\"http://i.stack.imgur.com/j3a73.png\" rel=\"nofollow\">macro error</a></p>\n"}, {"tags": ["vba", "sorting"], "answers": [{"tags": [], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "is_accepted": false, "score": 1, "last_activity_date": 1463590209, "last_edit_date": 1463590209, "creation_date": 1463589268, "answer_id": 37305406, "question_id": 37305209, "link": "https://stackoverflow.com/questions/37305209/short-sort-max-min-code-also-error-subscript-out-of-range/37305406#37305406", "title": "Short Sort Max, Min code. Also Error Subscript out of range", "body": "<p>Your issue for the out of bounds is because Columns in worksheets are by default multidimensional arrays</p>\n\n<pre><code>Sub Sort_Max_Min()\n    Dim i, j As Integer\n    Dim arrayOne As Variant\n    Dim temp As Variant\n    arrayOne = Range(\"C2:C16\")\n\n    For i = 1 To 13\n        For j = 1 To 13\n        If arrayOne(j, 1) &lt; arrayOne(j + 1, 1) Then\n            temp = arrayOne(j,1)\n            arrayOne(j, 1) = arrayOne(j + 1, 1)\n            arrayOne(j + 1, 1) = temp\n        End If\n    Next j\n    Next i\n\n    Range(\"D2:D16\") = arrayOne\n\nEnd Sub\n</code></pre>\n\n<p>I ran this code and it executed in 0 seconds. Not bad but I am sure there is an easier way to sort. I am still learning and experimenting with different sorting techniques so I am by far not and expert</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6340488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iNy1a.jpg?s=128&g=1", "display_name": "Anoriw", "link": "https://stackoverflow.com/users/6340488/anoriw"}, "is_accepted": false, "score": 0, "last_activity_date": 1463590207, "last_edit_date": 1463590207, "creation_date": 1463589530, "answer_id": 37305515, "question_id": 37305209, "link": "https://stackoverflow.com/questions/37305209/short-sort-max-min-code-also-error-subscript-out-of-range/37305515#37305515", "title": "Short Sort Max, Min code. Also Error Subscript out of range", "body": "<p>You are out of range when <code>j = 14</code>, because you have <code>j+1 = 15</code>, which is out of range.</p>\n\n<p>And yes, there is a better way to do it ;)\nKeep the hard work.</p>\n"}], "owner": {"reputation": 159, "user_id": 6321786, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/1436417930/picture?type=large", "display_name": "Mauro Augusto", "link": "https://stackoverflow.com/users/6321786/mauro-augusto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1463590209, "creation_date": 1463588677, "question_id": 37305209, "link": "https://stackoverflow.com/questions/37305209/short-sort-max-min-code-also-error-subscript-out-of-range", "title": "Short Sort Max, Min code. Also Error Subscript out of range", "body": "<pre><code>Option Base 1\n\nSub Sort_Max_Min()  \nDim i, j As Integer  \nDim arrayOne As Variant  \nDim temp As Variant  \n\n\nReDim arrayOne(15)\narrayOne = Range(\"C2:C16\")\n\nFor i = 1 To 14\n    For j = 1 To 14\n    If arrayOne(j) &lt; arrayOne(j + 1) Then\n        temp = arrayOne(j)\n        arrayOne(j) = arrayOne(j + 1)\n        arrayOne(j + 1) = temp\n    End If\nNext j  \nNext i\n\nRange(\"D2:D16\") = arrayOne\n\nEnd Sub\n</code></pre>\n\n<p>So I have this little code going where im trying to sort 15 values from max to min. I Have random integer values in cells C2:C16. I am getting a \"Subscript out of range error\" that I can't seem to pick up on but I dont think my array indexes are going out of bounds.</p>\n\n<p>Also is there a better way to do this. I Don't think it is the most efficient to make i and j go from 1 to 14. Please help!</p>\n\n<p>(Btw im using this in another much larger code which is why I have variants going and not just integers... I dont think that's important though. I just want to get it down but I am still new to vb regardless ; _ ;    )</p>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 1378, "user_id": 3501751, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cJ4g9.jpg?s=128&g=1", "display_name": "Charlie", "link": "https://stackoverflow.com/users/3501751/charlie"}, "edited": false, "score": 0, "creation_date": 1463588935, "post_id": 37305025, "comment_id": 62132305, "body": "I think the length of range is different than what you&#39;re writing. I believe it should be Resize(UBound(arrayToWrite)+1)."}, {"owner": {"reputation": 979, "user_id": 3136924, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/1232991106/picture?type=large", "display_name": "Alexander Starbuck", "link": "https://stackoverflow.com/users/3136924/alexander-starbuck"}, "reply_to_user": {"reputation": 1378, "user_id": 3501751, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cJ4g9.jpg?s=128&g=1", "display_name": "Charlie", "link": "https://stackoverflow.com/users/3501751/charlie"}, "edited": false, "score": 0, "creation_date": 1463589057, "post_id": 37305025, "comment_id": 62132378, "body": "Charlie, I don&#39;t think that is the problem. Isn&#39;t &quot;normal&quot; VB behavior in sich a case that everything after the boundary gets cut off? I that case I would only lose the last value but I can&#39;t get anything! Just the first valueof  array budget(1,1) gets written through all the rows"}, {"owner": {"reputation": 1378, "user_id": 3501751, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cJ4g9.jpg?s=128&g=1", "display_name": "Charlie", "link": "https://stackoverflow.com/users/3501751/charlie"}, "edited": false, "score": 0, "creation_date": 1463589668, "post_id": 37305025, "comment_id": 62132716, "body": "I agree - I knew there was some issue if the range doesn&#39;t match the array - looks like someone caught it below."}], "answers": [{"comments": [{"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1463592760, "post_id": 37305429, "comment_id": 62134447, "body": "you should note that writing in a single row, having a only one dimension works. <code>[A1:B1] = Array(1, 2)</code> does exactly what it looks like ;)"}], "tags": [], "owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "is_accepted": true, "score": 4, "last_activity_date": 1463590955, "last_edit_date": 1463590955, "creation_date": 1463589327, "answer_id": 37305429, "question_id": 37305025, "link": "https://stackoverflow.com/questions/37305025/vba-code-wont-write-array-to-range-only-its-first-element/37305429#37305429", "title": "VBA code won&#39;t write array to range, only it&#39;s first element", "body": "<p>If you want to write an array to a range, the array must have two dimensions. Even if you only wish to write a single column.</p>\n\n<p>Change</p>\n\n<pre><code>ReDim arrayToWrite(1 To (lastCol - 2) * (lastRow - 1))\n</code></pre>\n\n<p>to</p>\n\n<pre><code>ReDim arrayToWrite(1 To (lastCol - 2) * (lastRow - 1), 1 To 1)\n</code></pre>\n\n<p>and</p>\n\n<pre><code>arrayToWrite(i + k) = budgets(i, j)\n</code></pre>\n\n<p>to</p>\n\n<pre><code>arrayToWrite(i + k, 1) = budgets(i, j)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 979, "user_id": 3136924, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/1232991106/picture?type=large", "display_name": "Alexander Starbuck", "link": "https://stackoverflow.com/users/3136924/alexander-starbuck"}, "edited": false, "score": 0, "creation_date": 1463590776, "post_id": 37305760, "comment_id": 62133330, "body": "Dirk, thank you for your reply! I can&#39;t believe how stupid I was - the arrayToWrite &quot;stretches&quot; in the direction of rows and not columns! That&#39;s why It kept getting only the first value. I understand your solution, but also, could I have done it by assigning values to this array differently in the first place? ( arrayToWrite(i + k) = budgets(i, j) )"}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "reply_to_user": {"reputation": 979, "user_id": 3136924, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/1232991106/picture?type=large", "display_name": "Alexander Starbuck", "link": "https://stackoverflow.com/users/3136924/alexander-starbuck"}, "edited": false, "score": 0, "creation_date": 1463590935, "post_id": 37305760, "comment_id": 62133419, "body": "no... a 1d-array will always &quot;stretch&quot; by columns (1 row height). To use it without transpose, you need a second dimension like @jkpieterse showed pretty well ;)"}, {"owner": {"reputation": 979, "user_id": 3136924, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/1232991106/picture?type=large", "display_name": "Alexander Starbuck", "link": "https://stackoverflow.com/users/3136924/alexander-starbuck"}, "edited": false, "score": 0, "creation_date": 1463591394, "post_id": 37305760, "comment_id": 62133671, "body": "In that case we misunderstood each other. I thought it stretched by columns, thats why I sorted my code like that. Ok thanks ;)"}], "tags": [], "owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "is_accepted": false, "score": 1, "last_activity_date": 1463592089, "last_edit_date": 1463592089, "creation_date": 1463590324, "answer_id": 37305760, "question_id": 37305025, "link": "https://stackoverflow.com/questions/37305025/vba-code-wont-write-array-to-range-only-its-first-element/37305760#37305760", "title": "VBA code won&#39;t write array to range, only it&#39;s first element", "body": "<p>simply use transpose... change</p>\n\n<pre><code>Ws.Range(\"E2\").Resize(UBound(arrayToWrite)).Value = arrayToWrite\n</code></pre>\n\n<p>to</p>\n\n<pre><code>Ws.Range(\"E2\").Resize(UBound(arrayToWrite)).Value = Application.Transpose(arrayToWrite)\n</code></pre>\n\n<p>Hint: there is no need for <code>ReDim budgets(1 To lastrow - 1, 1 To lastcol - 2)</code>.<br>\nIf <code>budgets</code> is a variant then <code>budgets = Ws.Range(\"C2:AU265\")</code> will automatically set the ranges (upper left cell (in this case C2) will be <code>(1, 1)</code>).</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>Assuming you only want to write down all columns (one after another) below each other, you can shorten the macro a bit like that:</p>\n\n<pre><code>Private Sub procedure()\n\n  Dim inArr As Variant, outArr() As Variant\n  Dim i As Long, j As Long, k As Long\n\n  With Sheet19\n    .Activate\n    inArr = .Range(, .Cells(2, 3), .Cells(.Cells.Find(\"*\", , , , 1, 2).Row, .Cells.Find(\"*\", , , , 2, 2).Column)).Value\n  End With\n\n  ReDim outArr(1 To UBound(inArr) * UBound(inArr, 2))\n  k = 1\n\n  For j = 1 To UBound(inArr, 2)\n    For i = 1 To UBound(inArr)\n      k = k + 1\n      arrayToWrite(k) = budgets(i, j)\n    Next i\n  Next j\n\n  Sheet6.Range(\"E2:E\" &amp; UBound(arrayToWrite)).Value = Application.Transpose(arrayToWrite)\n\nEnd Sub\n</code></pre>\n\n<p>And if you want each row transposed and below each other than simply switch the two <code>For...</code>-lines. (Still the code does basically the same like before)</p>\n"}], "owner": {"reputation": 979, "user_id": 3136924, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/1232991106/picture?type=large", "display_name": "Alexander Starbuck", "link": "https://stackoverflow.com/users/3136924/alexander-starbuck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2711, "favorite_count": 1, "accepted_answer_id": 37305429, "answer_count": 2, "score": 3, "last_activity_date": 1463592089, "creation_date": 1463588156, "last_edit_date": 1463591055, "question_id": 37305025, "link": "https://stackoverflow.com/questions/37305025/vba-code-wont-write-array-to-range-only-its-first-element", "title": "VBA code won&#39;t write array to range, only it&#39;s first element", "body": "<p>I need to do the following:</p>\n\n<ul>\n<li>lift the range C2:AU264 into an 2D array </li>\n<li>create another 1D array, (1 To 11880) </li>\n<li>fill second array with values from the first one (\"transpose\")</li>\n<li>write array 2 back to the sheet</li>\n</ul>\n\n<p>Here is the code I am using:</p>\n\n<pre><code>Private Ws As Worksheet\nPrivate budgets() As Variant\nPrivate arrayToWrite() As Variant\nPrivate lastrow As Long\nPrivate lastcol As Long\n\nPrivate Sub procedure()\nApplication.ScreenUpdating = False\n\nSet Ws = Sheet19\nWs.Activate\n\nlastrow = Ws.Cells.Find(\"*\", searchorder:=xlByRows, searchdirection:=xlPrevious).row\nlastcol = Ws.Cells.Find(\"*\", searchorder:=xlByColumns, searchdirection:=xlPrevious).Column\n\nReDim budgets(1 To lastrow - 1, 1 To lastcol - 2)\nbudgets= Ws.Range(\"C2:AU265\")\n\nReDim arrayToWrite(1 To (lastCol - 2) * (lastRow - 1))\n\nk = 0\nFor j = 1 To UBound(budgets, 2)\n    For i = 1 To UBound(budgets, 1)\n      arrayToWrite(i + k) = budgets(i, j)\n    Next i\n    k = k + lastrow - 1\nNext j\n\n\nSet Ws = Sheet6\nWs.Activate\n\nWs.Range(\"E2\").Resize(UBound(arrayToWrite)).Value = arrayToWrite\n\n\n'For i = 1 To UBound(arrayToWrite)\n    'Ws.Range(Cells(i + 1, 5).Address).Value = arrayToWrite(i)\n'Next i\n\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>This just writes the first value from the range C2:AU264 (the first element of the first array) through the whole range E2:E11881. If however, I un-comment the For loop just before the end of my script and do it that way, it does work, but is slow. How can I write the array correctly using the first statement?</p>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 1378, "user_id": 3501751, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cJ4g9.jpg?s=128&g=1", "display_name": "Charlie", "link": "https://stackoverflow.com/users/3501751/charlie"}, "edited": false, "score": 0, "creation_date": 1463588041, "post_id": 37304707, "comment_id": 62131711, "body": "Are you able to even create a text box with a scroll bar in PowerPoint? I haven&#39;t seen that."}, {"owner": {"reputation": 156, "user_id": 2992493, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5egxV.jpg?s=128&g=1", "display_name": "Rubi Shnol", "link": "https://stackoverflow.com/users/2992493/rubi-shnol"}, "reply_to_user": {"reputation": 1378, "user_id": 3501751, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cJ4g9.jpg?s=128&g=1", "display_name": "Charlie", "link": "https://stackoverflow.com/users/3501751/charlie"}, "edited": false, "score": 0, "creation_date": 1463588625, "post_id": 37304707, "comment_id": 62132114, "body": "You need to set ScrollBars parameter of the textbox accordingly"}, {"owner": {"reputation": 1378, "user_id": 3501751, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cJ4g9.jpg?s=128&g=1", "display_name": "Charlie", "link": "https://stackoverflow.com/users/3501751/charlie"}, "edited": false, "score": 0, "creation_date": 1463589102, "post_id": 37304707, "comment_id": 62132405, "body": "OK - is there a reason you can&#39;t make it look you&#39;re scrolling by using built in animations (or just multiple slides that you transition through)? I agree there&#39;s no PPT event for mousescroll."}, {"owner": {"reputation": 156, "user_id": 2992493, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5egxV.jpg?s=128&g=1", "display_name": "Rubi Shnol", "link": "https://stackoverflow.com/users/2992493/rubi-shnol"}, "reply_to_user": {"reputation": 1378, "user_id": 3501751, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cJ4g9.jpg?s=128&g=1", "display_name": "Charlie", "link": "https://stackoverflow.com/users/3501751/charlie"}, "edited": false, "score": 0, "creation_date": 1463593071, "post_id": 37304707, "comment_id": 62134617, "body": "I don&#39;t get your point. I need to scroll a textbox in my custom form with the mouse wheel."}, {"owner": {"reputation": 1378, "user_id": 3501751, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cJ4g9.jpg?s=128&g=1", "display_name": "Charlie", "link": "https://stackoverflow.com/users/3501751/charlie"}, "edited": false, "score": 0, "creation_date": 1463607063, "post_id": 37304707, "comment_id": 62141877, "body": "OK sorry I assumed it was a textbox on a slide. The scrollbar event on a form should work - what have you tried? I assume something like this <a href=\"https://msdn.microsoft.com/en-us/library/office/gg278741.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/gg278741.aspx</a>?"}, {"owner": {"reputation": 156, "user_id": 2992493, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5egxV.jpg?s=128&g=1", "display_name": "Rubi Shnol", "link": "https://stackoverflow.com/users/2992493/rubi-shnol"}, "reply_to_user": {"reputation": 1378, "user_id": 3501751, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cJ4g9.jpg?s=128&g=1", "display_name": "Charlie", "link": "https://stackoverflow.com/users/3501751/charlie"}, "edited": false, "score": 0, "creation_date": 1463642960, "post_id": 37304707, "comment_id": 62153087, "body": "I think you still don&#39;t get me. Scroll event is not the same as mouse wheel."}, {"owner": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "edited": false, "score": 0, "creation_date": 1463656365, "post_id": 37304707, "comment_id": 62162389, "body": "Looks like the only way to do this is via WinAPI : <a href=\"http://www.ozgrid.com/forum/showthread.php?t=184493\" rel=\"nofollow noreferrer\">ozgrid.com/forum/showthread.php?t=184493</a>"}, {"owner": {"reputation": 1378, "user_id": 3501751, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cJ4g9.jpg?s=128&g=1", "display_name": "Charlie", "link": "https://stackoverflow.com/users/3501751/charlie"}, "edited": false, "score": 0, "creation_date": 1463661123, "post_id": 37304707, "comment_id": 62165851, "body": "I&#39;m sorry - you&#39;re right. I don&#39;t know what&#39;s wrong with me."}, {"owner": {"reputation": 156, "user_id": 2992493, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5egxV.jpg?s=128&g=1", "display_name": "Rubi Shnol", "link": "https://stackoverflow.com/users/2992493/rubi-shnol"}, "reply_to_user": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "edited": false, "score": 0, "creation_date": 1463669132, "post_id": 37304707, "comment_id": 62172444, "body": "@JamieG This is an extremely old solution and no surprise it&#39;s not functioning"}], "owner": {"reputation": 156, "user_id": 2992493, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5egxV.jpg?s=128&g=1", "display_name": "Rubi Shnol", "link": "https://stackoverflow.com/users/2992493/rubi-shnol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 229, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1463587238, "creation_date": 1463587238, "question_id": 37304707, "link": "https://stackoverflow.com/questions/37304707/vba-mousewheel-event-in-powerpoint", "title": "VBA: MouseWheel Event in PowerPoint", "body": "<p>Is there any way to scroll a text box with the mouse wheel in PowerPoint? The existing solutions don't seem to address other apps, not PowerPoint.</p>\n\n<p>There is no <code>MouseWheel</code> event available.</p>\n"}, {"tags": ["bash", "excel", "vba"], "comments": [{"owner": {"reputation": 1641, "user_id": 4559724, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RxNcM.jpg?s=128&g=1", "display_name": "SaintHax", "link": "https://stackoverflow.com/users/4559724/sainthax"}, "edited": false, "score": 0, "creation_date": 1463586568, "post_id": 37304331, "comment_id": 62130743, "body": "You don&#39;t need the bash tag, or the bash code-- just what you have, what you need, and how to do it in excel-vba"}, {"owner": {"reputation": 1591, "user_id": 5636645, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZUJXP.png?s=128&g=1", "display_name": "neo33", "link": "https://stackoverflow.com/users/5636645/neo33"}, "reply_to_user": {"reputation": 1641, "user_id": 4559724, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RxNcM.jpg?s=128&g=1", "display_name": "SaintHax", "link": "https://stackoverflow.com/users/4559724/sainthax"}, "edited": false, "score": 0, "creation_date": 1463587184, "post_id": 37304331, "comment_id": 62131144, "body": "that was because, I wanted to show what I have tried."}], "answers": [{"comments": [{"owner": {"reputation": 1591, "user_id": 5636645, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZUJXP.png?s=128&g=1", "display_name": "neo33", "link": "https://stackoverflow.com/users/5636645/neo33"}, "edited": false, "score": 0, "creation_date": 1463587049, "post_id": 37304551, "comment_id": 62131055, "body": "this really helped me, I really appreciate the help, I just have a doubt, could you please tell me, what is the meaning of the last number I mean the 9999?"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 1591, "user_id": 5636645, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZUJXP.png?s=128&g=1", "display_name": "neo33", "link": "https://stackoverflow.com/users/5636645/neo33"}, "edited": false, "score": 0, "creation_date": 1463587459, "post_id": 37304551, "comment_id": 62131311, "body": "The <b>9999</b> is just a huge number to define the maximum number of characters to pickup after that last backslash"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 2, "last_activity_date": 1463586812, "creation_date": 1463586812, "answer_id": 37304551, "question_id": 37304331, "link": "https://stackoverflow.com/questions/37304331/how-to-get-the-same-output-using-excel-vba-code/37304551#37304551", "title": "How to get the same output using Excel-VBA code?", "body": "<p>With data in column <strong>A</strong>, in <strong>B1</strong> enter:</p>\n\n<pre><code>=MID(A1,FIND(CHAR(1),SUBSTITUTE(A1,\"\\\",CHAR(1),LEN(A1)-LEN(SUBSTITUTE(A1,\"\\\",\"\"))))+1,9999)\n</code></pre>\n\n<p>and copy down.</p>\n\n<p><a href=\"https://i.stack.imgur.com/DQpgU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DQpgU.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1591, "user_id": 5636645, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZUJXP.png?s=128&g=1", "display_name": "neo33", "link": "https://stackoverflow.com/users/5636645/neo33"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 37304551, "answer_count": 1, "score": 1, "last_activity_date": 1463586812, "creation_date": 1463586116, "last_edit_date": 1531164843, "question_id": 37304331, "link": "https://stackoverflow.com/questions/37304331/how-to-get-the-same-output-using-excel-vba-code", "title": "How to get the same output using Excel-VBA code?", "body": "<p>I am working with an excel file, it only has one column as follows:</p>\n\n<pre><code>Type\nA:\\AAA\\AD\\RER\\TES\\11111\\&amp;DD&amp;MM&amp;AA.EXT\nC:\\AAA\\CD\\RES\\TES\\33333\\&amp;DD&amp;MM&amp;AA.EXT\nC:\\CCC\\DF\\WSD\\&amp;DD&amp;MM&amp;AA&amp;SQ2.TXT\nC:\\DDDD\\RT\\FDG\\334455&amp;DD&amp;MM&amp;AA&amp;SQ2.TXT\nC:\\DDD\\YU\\DFS\\55555&amp;DD&amp;MM&amp;AA&amp;SQ2.TXT\nC:\\RRR\\ER\\SDF\\55555&amp;DD&amp;MM&amp;AA&amp;SQ2.TXT\nC:\\TTT\\CD\\ERW\\55555&amp;DD&amp;MM&amp;AA&amp;SQ2.TXT\nC:\\YYY\\YU\\WET\\555555&amp;DD&amp;MM&amp;AA.EXT\n</code></pre>\n\n<p>I would like to extract the following output:</p>\n\n<pre><code>&amp;DD&amp;MM&amp;AA.EXT\n&amp;DD&amp;MM&amp;AA.EXT\n&amp;DD&amp;MM&amp;AA&amp;.TXT\n334455&amp;DD&amp;MM&amp;AA&amp;.TXT\n55555&amp;DD&amp;MM&amp;AA&amp;.TXT\n55555&amp;DD&amp;MM&amp;AA&amp;.TXT\n55555&amp;DD&amp;MM&amp;AA&amp;.TXT\n555555&amp;DD&amp;MM&amp;AA.EXT\n</code></pre>\n\n<p>The approach that I followed to extract it was using bash since I am a beginner in the usage of excel, my command was the following:</p>\n\n<pre><code>rev colum.txt | tr -d \" \" | cut -d \"\\\\\" -f1 | rev | sed \"s/SQ2//\"\n</code></pre>\n\n<p>The problem with this is that I would like to achieve the same result using a macros of excel, I don't know how to program it, I would like to appreciate a suggestion of how to transform this bash code to Excel-VBA, supposing that the column that contains the data is the column A.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1463586306, "post_id": 37304322, "comment_id": 62130553, "body": "press F9 if I remember well"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1463586542, "post_id": 37304322, "comment_id": 62130724, "body": "Wait - are you looking for a VB code that will re-enable auto calculation, or just asking how to recalculate a cell?  Also, please post the code you do have as it will help us understand where you&#39;re coming from."}, {"owner": {"reputation": 3, "user_id": 6341518, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KSEbP.png?s=128&g=1", "display_name": "xiaoxu", "link": "https://stackoverflow.com/users/6341518/xiaoxu"}, "edited": false, "score": 0, "creation_date": 1463672920, "post_id": 37304322, "comment_id": 62175500, "body": "I just ask how to recalculate a cell, thank you.@BruceWayne"}], "answers": [{"comments": [{"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1463589517, "post_id": 37304343, "comment_id": 62132636, "body": "That won&#39;t help Excel realise the UDF has been edited. Especially since for that line to do anything the UDF must be called.AFAIK editing a UDF does not trigger a recalc, nor does it &quot;dirty&quot; the cells containing it."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 0, "last_activity_date": 1463586153, "creation_date": 1463586153, "answer_id": 37304343, "question_id": 37304322, "link": "https://stackoverflow.com/questions/37304322/how-can-excel-vba-function-auto-calculate-itself-after-i-change-the-function-cod/37304343#37304343", "title": "how can Excel VBA function AUTO CALCULATE itself after I change the function code?", "body": "<p>Just add:</p>\n\n<p><code>Application.Calculation = xlCalculationAutomatic</code></p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 6341518, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KSEbP.png?s=128&g=1", "display_name": "xiaoxu", "link": "https://stackoverflow.com/users/6341518/xiaoxu"}, "edited": false, "score": 0, "creation_date": 1463671901, "post_id": 37305469, "comment_id": 62174692, "body": "I Press Control+Shift+F9 after modifying the function, but the cell&#39;s value does not change."}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "reply_to_user": {"reputation": 3, "user_id": 6341518, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KSEbP.png?s=128&g=1", "display_name": "xiaoxu", "link": "https://stackoverflow.com/users/6341518/xiaoxu"}, "edited": false, "score": 0, "creation_date": 1463672839, "post_id": 37305469, "comment_id": 62175445, "body": "What about control+alt+shift F9 ?"}], "tags": [], "owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "is_accepted": true, "score": 1, "last_activity_date": 1463589418, "creation_date": 1463589418, "answer_id": 37305469, "question_id": 37304322, "link": "https://stackoverflow.com/questions/37304322/how-can-excel-vba-function-auto-calculate-itself-after-i-change-the-function-cod/37305469#37305469", "title": "how can Excel VBA function AUTO CALCULATE itself after I change the function code?", "body": "<p>Press Control+Shift+F9 after modifying the function.</p>\n"}], "owner": {"reputation": 3, "user_id": 6341518, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KSEbP.png?s=128&g=1", "display_name": "xiaoxu", "link": "https://stackoverflow.com/users/6341518/xiaoxu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 37305469, "answer_count": 2, "score": -2, "last_activity_date": 1463589418, "creation_date": 1463586097, "question_id": 37304322, "link": "https://stackoverflow.com/questions/37304322/how-can-excel-vba-function-auto-calculate-itself-after-i-change-the-function-cod", "title": "how can Excel VBA function AUTO CALCULATE itself after I change the function code?", "body": "<p>I have wrote a  Excel VBA function and used it in many cells. However I find the function is wrong now. Then I alter the function code, but the cells' value does not change automaticly unless I click the cell again. It's so boring and meaningless.</p>\n\n<p>How can Excel VBA function AUTO CALCULATE itself after I change the function ?\n`</p>\n"}, {"tags": ["vba", "shell", "excel"], "comments": [{"owner": {"reputation": 1378, "user_id": 3501751, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cJ4g9.jpg?s=128&g=1", "display_name": "Charlie", "link": "https://stackoverflow.com/users/3501751/charlie"}, "edited": false, "score": 0, "creation_date": 1463586985, "post_id": 37304080, "comment_id": 62131027, "body": "Have you tried calling something trivial like notepad to make sure it&#39;s working?"}, {"owner": {"reputation": 53, "user_id": 6330370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/451809c0b2c5c2a3fd9276f4156cd909?s=128&d=identicon&r=PG&f=1", "display_name": "BluK", "link": "https://stackoverflow.com/users/6330370/bluk"}, "reply_to_user": {"reputation": 1378, "user_id": 3501751, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cJ4g9.jpg?s=128&g=1", "display_name": "Charlie", "link": "https://stackoverflow.com/users/3501751/charlie"}, "edited": false, "score": 0, "creation_date": 1463589108, "post_id": 37304080, "comment_id": 62132409, "body": "If I try running Notepad in the Shell, it opens Notepad and it does freeze the macro, until I close Notepad. The difference wih my case is that there isn&#39;t a proper application opening. It&#39;s just a shell being prompted. Would that make a difference in the way the code understands it ?"}, {"owner": {"reputation": 1378, "user_id": 3501751, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cJ4g9.jpg?s=128&g=1", "display_name": "Charlie", "link": "https://stackoverflow.com/users/3501751/charlie"}, "edited": false, "score": 0, "creation_date": 1463589894, "post_id": 37304080, "comment_id": 62132841, "body": "Yes I believe WaitForSingleObject looks for very specific exit conditions. I would try putting a System Exit in your script to make it look like your script has &quot;failed&quot; and then detect the WAIT_FAILED. That might be easier than trying to get it to register as a &quot;success.&quot;"}, {"owner": {"reputation": 53, "user_id": 6330370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/451809c0b2c5c2a3fd9276f4156cd909?s=128&d=identicon&r=PG&f=1", "display_name": "BluK", "link": "https://stackoverflow.com/users/6330370/bluk"}, "reply_to_user": {"reputation": 1378, "user_id": 3501751, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cJ4g9.jpg?s=128&g=1", "display_name": "Charlie", "link": "https://stackoverflow.com/users/3501751/charlie"}, "edited": false, "score": 0, "creation_date": 1463638835, "post_id": 37304080, "comment_id": 62150697, "body": "I&#39;m not sure I understand. Could you develop ?"}, {"owner": {"reputation": 1378, "user_id": 3501751, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cJ4g9.jpg?s=128&g=1", "display_name": "Charlie", "link": "https://stackoverflow.com/users/3501751/charlie"}, "edited": false, "score": 0, "creation_date": 1463661325, "post_id": 37304080, "comment_id": 62166021, "body": "I&#39;m happy to help but I need to see what you&#39;re calling. Can you tell me more about what SYNCHRONIZE is and post any relevant code or links?"}, {"owner": {"reputation": 53, "user_id": 6330370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/451809c0b2c5c2a3fd9276f4156cd909?s=128&d=identicon&r=PG&f=1", "display_name": "BluK", "link": "https://stackoverflow.com/users/6330370/bluk"}, "reply_to_user": {"reputation": 1378, "user_id": 3501751, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cJ4g9.jpg?s=128&g=1", "display_name": "Charlie", "link": "https://stackoverflow.com/users/3501751/charlie"}, "edited": false, "score": 0, "creation_date": 1463672790, "post_id": 37304080, "comment_id": 62175400, "body": "What I&#39;m calling is not a script of my own, it&#39;s a compiled program (.exe). So I don&#39;t have latitude to change the way it behaves. SYNCHRONIZE is just a part of the code I copied from<code>ShellAndWait</code>. From what I understand from the <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms687032(v=vs.85).aspx\" rel=\"nofollow noreferrer\">Windows support</a>, it is necessary for WaitForSingleObject to work. I&#39;m afraid it&#39;s not that helpful :s"}, {"owner": {"reputation": 1378, "user_id": 3501751, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cJ4g9.jpg?s=128&g=1", "display_name": "Charlie", "link": "https://stackoverflow.com/users/3501751/charlie"}, "edited": false, "score": 0, "creation_date": 1463674384, "post_id": 37304080, "comment_id": 62176503, "body": "Makes sense. Sorry I&#39;m out of suggestions. If you&#39;re trying to wait on a program you can&#39;t control and it&#39;s not outputting the correct exist signal then I think you&#39;re stuck."}, {"owner": {"reputation": 53, "user_id": 6330370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/451809c0b2c5c2a3fd9276f4156cd909?s=128&d=identicon&r=PG&f=1", "display_name": "BluK", "link": "https://stackoverflow.com/users/6330370/bluk"}, "reply_to_user": {"reputation": 1378, "user_id": 3501751, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cJ4g9.jpg?s=128&g=1", "display_name": "Charlie", "link": "https://stackoverflow.com/users/3501751/charlie"}, "edited": false, "score": 0, "creation_date": 1463742232, "post_id": 37304080, "comment_id": 62206335, "body": "No worries. I&#39;ll keep trying different things and see if something works."}], "answers": [{"tags": [], "owner": {"reputation": 53, "user_id": 6330370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/451809c0b2c5c2a3fd9276f4156cd909?s=128&d=identicon&r=PG&f=1", "display_name": "BluK", "link": "https://stackoverflow.com/users/6330370/bluk"}, "is_accepted": true, "score": 0, "last_activity_date": 1464096913, "creation_date": 1464096913, "answer_id": 37415254, "question_id": 37304080, "link": "https://stackoverflow.com/questions/37304080/wait-until-process-is-finished-running/37415254#37415254", "title": "Wait until process is finished running", "body": "<p>So, I kept searching and I found a bit of code that worked.\nI actually found it <a href=\"http://www.devhut.net/2014/10/20/vba-wmi-determine-if-a-process-is-running-or-not/\" rel=\"nofollow\">here</a>.</p>\n"}], "owner": {"reputation": 53, "user_id": 6330370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/451809c0b2c5c2a3fd9276f4156cd909?s=128&d=identicon&r=PG&f=1", "display_name": "BluK", "link": "https://stackoverflow.com/users/6330370/bluk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7750, "favorite_count": 0, "accepted_answer_id": 37415254, "answer_count": 1, "score": 1, "last_activity_date": 1464096913, "creation_date": 1463585474, "last_edit_date": 1531164843, "question_id": 37304080, "link": "https://stackoverflow.com/questions/37304080/wait-until-process-is-finished-running", "title": "Wait until process is finished running", "body": "<p>I'm launching a program from a VBA macro and I need to wait for it to finish running before I can go and post-process the resulting data.\nSo far, I've been satisfied with the following as the running time was pretty consistent (about 2sec.) :</p>\n\n<pre><code>    While FileLen(outputFilename) &lt; 9000 And (Timer - Chrono) &lt; 10\n    Wend\n</code></pre>\n\n<p>Indeed I've observed that all the result data is written in one go and before that, the output size doesn't exceed 9Ko.\nAnyway, for some reason, the program isn't consistent anymore so I looked a bit more into a clean solution to wait for the shell process to stop.\nI found ideas about <code>WaitForSingleObject</code> and the module <code>ShellAndWait</code> which I found <a href=\"http://www.cpearson.com/excel/ShellAndWait.aspx\" rel=\"nofollow noreferrer\">here</a>. <a href=\"https://stackoverflow.com/questions/1439200/vba-shell-and-wait-with-exit-code\">This post</a> is what helped me with finding some functions.</p>\n\n<p>My problem now is that the macro keeps running while the Shell is still open. From what I understand, <code>WaitForSingleObject</code> returns 0, which should mean the Shell is closed (or finished running), but it's not.\nMore specifically, in <code>ShellAndWait</code>,</p>\n\n<pre><code>WaitRes = WaitForSingleObject(ProcHandle, DEFAULT_POLL_INTERVAL)\n</code></pre>\n\n<p>raises 0.\nI tried to extract the significant part of the code by adapting it a bit :</p>\n\n<pre><code>Private Declare Function WaitForSingleObject Lib \"kernel32\" (ByVal hHandle As Long, ByVal dwMilliseconds As Long) As Long\nPrivate Declare Function OpenProcess Lib \"kernel32\" (ByVal dwDesiredAccess As Long, ByVal bInheritHandle As Long, ByVal dwProcessId As Long) As Long\nPrivate Declare Function CloseHandle Lib \"kernel32\" (ByVal hObject As Long) As Long\n\nPrivate Const SYNCHRONIZE = &amp;H100000\nPublic Const INFINITE = &amp;HFFFF\nPublic Const PROCESS_ALL_ACCESS = &amp;H1F0FFF\n\nSub launch()\n\nanalysisPath = \"Path to the files to feed to the programm\"\nShellCommand = \"Program to run + arguments\"\n\nChDrive ThisWorkbook.Path\nChDir analysisPath\n\nfileID = Shell(ShellCommand, vbNormalFocus)\n\nProcHandle = OpenProcess(SYNCHRONIZE, False, fileID)\n\nIf ProcHandle&lt;&gt;0 Then\n    WaitRes = WaitForSingleObject(ProcHandle, INFINITE)\nElse\n    MsgBox \"Failed running Nastran\"\nEnd If\nfileID = CloseHandle(ProcHandle)\n\nEnd Sub\n</code></pre>\n\n<p>And <code>WaitRes</code>still raises 0.\nAm I using <code>WaitForSingleObject</code> wrong and if so, could you point me in the right direction ?</p>\n\n<p>edit : It also doesn't work with the solution accepted in <a href=\"https://stackoverflow.com/questions/5968356/how-to-programmatically-wait-for-shell-command-to-finish-running?rq=1\">this post</a> (meaning the shell runs but doesn't stop the macro to keep going). Could it be due to the specific program I'm running which would behave strangely ?</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 8457, "user_id": 1680271, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/6b51bd7f9fff8a9f4e61f74d3b5421b1?s=128&d=identicon&r=PG", "display_name": "CathalMF", "link": "https://stackoverflow.com/users/1680271/cathalmf"}, "edited": false, "score": 0, "creation_date": 1463584986, "post_id": 37303867, "comment_id": 62129605, "body": "What software or coding language are you using. We need more information in the question and in the tags."}, {"owner": {"reputation": 17, "user_id": 6316145, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/ea15e8fb821f09a4d0a1eb4105d07166?s=128&d=identicon&r=PG&f=1", "display_name": "Hags", "link": "https://stackoverflow.com/users/6316145/hags"}, "reply_to_user": {"reputation": 8457, "user_id": 1680271, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/6b51bd7f9fff8a9f4e61f74d3b5421b1?s=128&d=identicon&r=PG", "display_name": "CathalMF", "link": "https://stackoverflow.com/users/1680271/cathalmf"}, "edited": false, "score": 0, "creation_date": 1463585166, "post_id": 37303867, "comment_id": 62129717, "body": "This is VBA in Excel"}], "answers": [{"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1463586090, "post_id": 37304168, "comment_id": 62130419, "body": "For more tips on finding the last row, I suggest looking over <a href=\"http://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba\">this thread</a>"}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 1, "last_activity_date": 1463585672, "creation_date": 1463585672, "answer_id": 37304168, "question_id": 37303867, "link": "https://stackoverflow.com/questions/37303867/how-do-i-fill-down-the-rest-of-a-column-in-the-next-available-cell/37304168#37304168", "title": "How do I fill down the rest of a column in the next available cell?", "body": "<p>You can use this:</p>\n\n<pre><code>Dim lStartRow             As Long\nDim lEndRow               As Long\nWith Sheets(\"CDGL Data\")\n    lStartRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row + 1\n    lEndRow = Application.Max(.Range(\"B\" &amp; .Rows.Count).End(xlUp).Row, .Range(\"C\" &amp; .Rows.Count).End(xlUp).Row)\n    .Range(.Cells(lStartRow, \"A\"), .Cells(lEndRow, \"A\")).Value2 = \"April\"\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 6316145, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/ea15e8fb821f09a4d0a1eb4105d07166?s=128&d=identicon&r=PG&f=1", "display_name": "Hags", "link": "https://stackoverflow.com/users/6316145/hags"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 37304168, "answer_count": 1, "score": 0, "last_activity_date": 1463611760, "creation_date": 1463584861, "last_edit_date": 1463611760, "question_id": 37303867, "link": "https://stackoverflow.com/questions/37303867/how-do-i-fill-down-the-rest-of-a-column-in-the-next-available-cell", "title": "How do I fill down the rest of a column in the next available cell?", "body": "<p>I am using the following code for assigning a value.</p>\n\n<pre><code>    Sheets(\"CDGL Data\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1).Formula= \"April\"\n</code></pre>\n\n<p>I need the <code>\"April\"</code> to fill down to the rest of my adjacent rows in blank Cells among the Cells that have values in them. </p>\n\n<p>Example:\n<code>Cell A899</code> is blank, <code>Cell B899</code> has a value, <code>Cell C899</code> has a value\n<code>\"April\"</code> needs to be put into that blank <code>cell A899</code>. </p>\n\n<p>Please help!</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1463588714, "post_id": 37303784, "comment_id": 62132171, "body": "Not sure if I&#39;m missing something, but to <i>analyze</i> the validation rules, you can simply open the linked tables in the frontend in design view. Those properties will be read-only, but to see them it&#39;s enough."}, {"owner": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1463589522, "post_id": 37303784, "comment_id": 62132640, "body": "@Andre perhaps you&#39;re right. I&#39;ve always been cautious accessing backend objects while in shared mode because I&#39;ve had it drop connections before, but that may have been before we split the db. Checking a back up copy will get me what I need without risk. Maybe I&#39;ll test these solutions on a weekend though just to better understand how shared mode is affected during design changes. I&#39;ll delete this question since it&#39;s pretty clear I&#39;m just confused. :)"}], "answers": [{"comments": [{"owner": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "edited": false, "score": 0, "creation_date": 1463586511, "post_id": 37304020, "comment_id": 62130701, "body": "Thanks for the suggestion, however the destination table is the most heavily used. There is some link or aggregation of this data in most forms so any time I enter design mode the connections are dropped. Assuming my backups have been made, do I have any backdoor options at all in shared mode?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "edited": false, "score": 1, "creation_date": 1463587734, "post_id": 37304020, "comment_id": 62131503, "body": "Even though the backend file is in use, you should be able to make a simple file copy of it. It may not contain the exact last tenths of a second changes but should be readable anyway. Check the main tables and/or run a repair/compact on it."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 2, "last_activity_date": 1463585290, "creation_date": 1463585290, "answer_id": 37304020, "question_id": 37303784, "link": "https://stackoverflow.com/questions/37303784/safety-of-using-validationrule-to-extract-current-setting-on-back-end-table-du/37304020#37304020", "title": "Safety of using `ValidationRule` to extract current setting on back-end table during active connections", "body": "<p>You can just open the backend(s) with Access in shared mode to study the table designs.</p>\n\n<p>Changes can be made as well, if the table is not in use.</p>\n\n<p>But I would certainly <em>wait to off-hours</em> and start with creating a backup of the backend(s), open the backend(s) exclusively, make the changes, and test.</p>\n"}], "owner": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23, "favorite_count": 0, "accepted_answer_id": 37304020, "answer_count": 1, "score": 0, "last_activity_date": 1463585290, "creation_date": 1463584619, "question_id": 37303784, "link": "https://stackoverflow.com/questions/37303784/safety-of-using-validationrule-to-extract-current-setting-on-back-end-table-du", "title": "Safety of using `ValidationRule` to extract current setting on back-end table during active connections", "body": "<p>I have inherited databases in Access (2000 and 2007-2010) that have validation rules set on the tables. One or more rules are blocking a handful of records during an append. I don't see any issues with the data, so I need to understand which rules are set in order to troubleshoot.</p>\n\n<p>The append destination database is split (v2000). The back end is in a shared location on a P2P and each user has a local front end.</p>\n\n<p>I'd really like to fix this today, instead of waiting until off-hours to enter design mode in the back end. I don't want to break any connections, or risk corruption. </p>\n\n<p>I'm considering writing code using the <code>ValidationRule</code> property in VBA to see if I can return the current rule (not even sure if that will work), but am worried that it will interrupt connections. </p>\n\n<p>I know that using any of the built-in \"Database Tools\" causes interruptions, I'm not clear on whether it's due to the routine or accessing these settings in general that requires exclusive use. I also know that any DDL action can cause issues during non-exclusive use, and returning the property value seems to ride that line.</p>\n\n<p>Does anyone know whether this is safe?</p>\n"}, {"tags": ["sql", "sql-server", "vba", "sql-server-2008", "ms-access"], "comments": [{"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1463584275, "post_id": 37303620, "comment_id": 62129107, "body": "Where are you stuck? creating the form, connecting to sqlserver, applying the filter, something else?"}, {"owner": {"reputation": 13, "user_id": 6291844, "user_type": "registered", "profile_image": "https://graph.facebook.com/538641909642295/picture?type=large", "display_name": "Daniel Jones", "link": "https://stackoverflow.com/users/6291844/daniel-jones"}, "reply_to_user": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1463584483, "post_id": 37303620, "comment_id": 62129264, "body": "Sorry, I shouldve probably been more clear. Creating the form is my main issue. I&#39;m not sure how I would combine the rows to display how I wish, or get the FieldName records to actively work as shown above."}, {"owner": {"reputation": 1378, "user_id": 3501751, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cJ4g9.jpg?s=128&g=1", "display_name": "Charlie", "link": "https://stackoverflow.com/users/3501751/charlie"}, "edited": false, "score": 0, "creation_date": 1463587247, "post_id": 37303620, "comment_id": 62131182, "body": "I&#39;m still not clear on the issue. Do you need help with the SQL query or the form? Is this the type of form you&#39;re creating <a href=\"https://support.office.com/en-us/article/Create-a-form-that-contains-a-subform-a-one-to-many-form-ddf3822f-8aba-49cb-831a-1e74d6f5f06b\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>?"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6291844, "user_type": "registered", "profile_image": "https://graph.facebook.com/538641909642295/picture?type=large", "display_name": "Daniel Jones", "link": "https://stackoverflow.com/users/6291844/daniel-jones"}, "edited": false, "score": 0, "creation_date": 1463647400, "post_id": 37304585, "comment_id": 62155987, "body": "Thank you so much! This has got me exactly what I wanted. However, I also require to be able to join onto our Orderline table. I would need to join on orderline, which is displayed in this table as           &lt;orderline = 485040867&gt;   But displayed in the orderline table as just 485040867 under the orderline column. I have tried to join on orderline with a LIKE statement, something akin to            SELECT * FROM orderline ol INNER JOIN Audit a ON &#39;%&#39; + a.PK + &#39;%&#39; LIKE ol.orderline  But this has not worked."}, {"owner": {"reputation": 2024, "user_id": 3205951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdd2c0675c7b50095f548f73d6ae5b3c?s=128&d=identicon&r=PG", "display_name": "Raul Sebastian", "link": "https://stackoverflow.com/users/3205951/raul-sebastian"}, "reply_to_user": {"reputation": 13, "user_id": 6291844, "user_type": "registered", "profile_image": "https://graph.facebook.com/538641909642295/picture?type=large", "display_name": "Daniel Jones", "link": "https://stackoverflow.com/users/6291844/daniel-jones"}, "edited": false, "score": 0, "creation_date": 1463649653, "post_id": 37304585, "comment_id": 62157571, "body": "Simplest way, remove the unwanted characters, as these seem to be static: <code>SELECT CAST(REPLACE(REPLACE(PK,&#39;&lt;orderline=&#39;,&#39;&#39;),&#39;&gt;&#39;,&#39;&#39;) AS int) AS Orderline</code>"}, {"owner": {"reputation": 13, "user_id": 6291844, "user_type": "registered", "profile_image": "https://graph.facebook.com/538641909642295/picture?type=large", "display_name": "Daniel Jones", "link": "https://stackoverflow.com/users/6291844/daniel-jones"}, "edited": false, "score": 0, "creation_date": 1463652214, "post_id": 37304585, "comment_id": 62159455, "body": "Thank you so much again! This has provided me with all I should (hopefully) need! Time to get building this form...  This question can now be closed."}], "tags": [], "owner": {"reputation": 2024, "user_id": 3205951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdd2c0675c7b50095f548f73d6ae5b3c?s=128&d=identicon&r=PG", "display_name": "Raul Sebastian", "link": "https://stackoverflow.com/users/3205951/raul-sebastian"}, "is_accepted": true, "score": 0, "last_activity_date": 1463586912, "creation_date": 1463586912, "answer_id": 37304585, "question_id": 37303620, "link": "https://stackoverflow.com/questions/37303620/using-table-data-in-ssms08-as-an-03-access-form-header-and-combining-several-r/37304585#37304585", "title": "Using table data in SSMS&#39;08 as an &#39;03 access form header and combining several rows into one. Audit table", "body": "<p>I have used your example input for a variable table like this:</p>\n\n<pre><code>DECLARE @t TABLE (\n    PK NVARCHAR(255),\n    FieldName NVARCHAR(255),\n    OldValue NVARCHAR(255),\n    NewValue NVARCHAR(255),\n    UpdateDate DATETIME\n)\n\nINSERT INTO @t VALUES \n    ('&lt;orderline=485040867&gt;', 'qty', NULL, '1', '2016-04-28 03:24:57.490'),\n    ('&lt;orderline=485040867&gt;', 'qtyrec', NULL, '0', '2016-04-28 03:24:57.490'),\n    ('&lt;orderline=485040867&gt;', 'statcode', NULL, 'NP', '2016-04-28 03:24:57.490'),\n    ('&lt;orderline=485040867&gt;', 'qtyrec', '0', '1', '2016-05-03 09:09:04.223'),\n    ('&lt;orderline=485040867&gt;', 'statcode', 'RD', 'RC', '2016-05-03 09:09:04.223'),\n    ('&lt;orderline=485040867&gt;', 'batch', NULL, 'MRP280416A', '2016-04-28 17:01:57.160'),\n    ('&lt;orderline=485040867&gt;', 'statcode', 'NP', 'OR', '2016-04-28 17:01:57.160'),\n    ('&lt;orderline=485040867&gt;', 'statcode', 'OR', 'RD', '2016-04-29 05:06:29.100');\n</code></pre>\n\n<p>I think you would want to group by PK and UpdateDate. So I used a subselect for each column like this:</p>\n\n<pre><code>SELECT a.PK\n, (SELECT TOP 1 NewValue\n    FROM @t b\n    WHERE b.FieldName = 'qty'\n    AND b.PK = a.PK\n    AND b.UpdateDate &lt;= a.UpdateDate\n    ORDER BY b.UpdateDate DESC) AS qty\n, (SELECT TOP 1 NewValue\n    FROM @t b\n    WHERE b.FieldName = 'qtyrec'\n    AND b.PK = a.PK\n    AND b.UpdateDate &lt;= a.UpdateDate\n    ORDER BY b.UpdateDate DESC) AS qtyrec\n, (SELECT TOP 1 NewValue\n    FROM @t b\n    WHERE b.FieldName = 'statcode'\n    AND b.PK = a.PK\n    AND b.UpdateDate &lt;= a.UpdateDate\n    ORDER BY b.UpdateDate DESC) AS statcode\n, (SELECT TOP 1 NewValue\n    FROM @t b\n    WHERE b.FieldName = 'batch'\n    AND b.PK = a.PK\n    AND b.UpdateDate &lt;= a.UpdateDate\n    ORDER BY b.UpdateDate DESC) AS batch\n, a.UpdateDate\nFROM (\n    SELECT PK\n    , UpdateDate\n    FROM @t\n    GROUP BY PK, UpdateDate\n) a\n</code></pre>\n\n<p>This is not really fast. You could alternatively use an outer apply like following example</p>\n\n<pre><code>SELECT a.PK\n, qty.NewValue AS qty\n, qtyrec.NewValue AS qtyrec\n, statcode.NewValue AS statcode\n, batch.NewValue AS batch\n, a.UpdateDate\nFROM (\n    SELECT PK\n    , UpdateDate\n    FROM @t\n    GROUP BY PK, UpdateDate\n) a\nOUTER APPLY (\n    SELECT TOP 1 OldValue, NewValue\n    FROM @t b\n    WHERE b.FieldName = 'qty'\n    AND b.PK = a.PK\n    AND b.UpdateDate &lt;= a.UpdateDate\n    ORDER BY b.UpdateDate DESC\n) qty\nOUTER APPLY (\n    SELECT TOP 1 OldValue, NewValue\n    FROM @t b\n    WHERE b.FieldName = 'qtyrec'\n    AND b.PK = a.PK\n    AND b.UpdateDate &lt;= a.UpdateDate\n    ORDER BY b.UpdateDate DESC\n) qtyrec\nOUTER APPLY (\n    SELECT TOP 1 OldValue, NewValue\n    FROM @t b\n    WHERE b.FieldName = 'statcode'\n    AND b.PK = a.PK\n    AND b.UpdateDate &lt;= a.UpdateDate\n    ORDER BY b.UpdateDate DESC\n) statcode\nOUTER APPLY (\n    SELECT TOP 1 OldValue, NewValue\n    FROM @t b\n    WHERE b.FieldName = 'batch'\n    AND b.PK = a.PK\n    AND b.UpdateDate &lt;= a.UpdateDate\n    ORDER BY b.UpdateDate DESC\n) batch\n</code></pre>\n\n<p>but there didn't seem to be any difference in runtimes/io, just the query plan is different. I couldn't come up with a good pivot solution, but you could take a look at this <a href=\"https://technet.microsoft.com/en-us/library/ms177410(v=sql.105).aspx\" rel=\"nofollow\">https://technet.microsoft.com/en-us/library/ms177410(v=sql.105).aspx</a> </p>\n"}], "owner": {"reputation": 13, "user_id": 6291844, "user_type": "registered", "profile_image": "https://graph.facebook.com/538641909642295/picture?type=large", "display_name": "Daniel Jones", "link": "https://stackoverflow.com/users/6291844/daniel-jones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "accepted_answer_id": 37304585, "answer_count": 1, "score": 1, "last_activity_date": 1594642119, "creation_date": 1463584163, "last_edit_date": 1594642119, "question_id": 37303620, "link": "https://stackoverflow.com/questions/37303620/using-table-data-in-ssms08-as-an-03-access-form-header-and-combining-several-r", "title": "Using table data in SSMS&#39;08 as an &#39;03 access form header and combining several rows into one. Audit table", "body": "<p>I have an audit table which displays data as so:</p>\n\n<pre><code> PK                      FieldName  OldValue    NewValue    UpdateDate   \n ----------------------------------------------------------------------  \n\n &lt;orderline=485040867&gt;   qtyrec     0           1           2016-05-03 09:09:04.223  \n &lt;orderline=485040867&gt;   statcode   RD          RC          2016-05-03 09:09:04.223  \n &lt;orderline=485040867&gt;   qty        NULL        1           2016-04-28 03:24:57.490  \n &lt;orderline=485040867&gt;   qtyrec     NULL        0           2016-04-28 03:24:57.490  \n &lt;orderline=485040867&gt;   statcode   NULL        NP          2016-04-28 03:24:57.490  \n &lt;orderline=485040867&gt;   batch      NULL        MRP280416A  2016-04-28 17:01:57.160  \n &lt;orderline=485040867&gt;   statcode   NP          OR          2016-04-28 17:01:57.160  \n &lt;orderline=485040867&gt;   statcode   OR          RD          2016-04-29 05:06:29.100   \n</code></pre>\n\n<p>As may hopefully be clear from this, this table logs when various things are updated or inserted for an orderline. Recieved quantity for example. What I would like to do is create a form in access to display all changes which occured at a given date + time on one row for any order.\nThis would involve using the records in the FieldName column as column headers and my end product would hopefully look something along the lines of</p>\n\n<pre><code>PK                       qty    qtyrec    statcode    batch      Updatedate\norderline = 485040867    1      0         NP                     2016-04-28 03:24:57.490\norderline = 485040867    1      0         OR          MRP280416A 2016-04-28 17:01:57.160\norderline = 485040867    1      1         RC          MRP280416A 2016-05-03 09:09:04.223\n</code></pre>\n"}, {"tags": ["vba", "excel", "stored-procedures"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1463584450, "post_id": 37303490, "comment_id": 62129234, "body": "How are you actually <b>calling</b> this routine?"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 1, "creation_date": 1463584550, "post_id": 37303490, "comment_id": 62129311, "body": "You have to pass a worksheet to you procedure, not a worksheet name, ie <code>Call Import(WorkSheets(&quot;MAIN&quot;))</code> and not <code>Call Import(&quot;MAIN&quot;)</code>"}, {"owner": {"reputation": 1256, "user_id": 3128069, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/4cdd27382d73700ac43edb0becdc1a7b?s=128&d=identicon&r=PG&f=1", "display_name": "phillipsK", "link": "https://stackoverflow.com/users/3128069/phillipsk"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1463585887, "post_id": 37303490, "comment_id": 62130280, "body": "@Rory Sub Main()  Import &quot;MAIN&quot;  End Sub"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1463586042, "post_id": 37303490, "comment_id": 62130387, "body": "Then see all the other answers. ;)"}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1463584847, "creation_date": 1463584847, "answer_id": 37303861, "question_id": 37303490, "link": "https://stackoverflow.com/questions/37303490/type-mismatch-on-passing-sheetname-to-procedure/37303861#37303861", "title": "Type mismatch on passing sheetname to procedure", "body": "<p>You must first check your <strong>calling routine</strong>:</p>\n\n<pre><code>Sub ROUTINE()\n    Dim ws As Worksheet\n    Set ws = Sheets(\"MAIN\")\n    Call import(ws)\nEnd Sub\n</code></pre>\n\n<p>is needed.  The following will definitely fail:</p>\n\n<pre><code>Sub NotVeryGood()\n    Dim ws As String\n    ws = \"MAIN\"\n    Call import(ws)\nEnd Sub\n</code></pre>\n\n<p><em>(Your Import expects an <strong>Object</strong> rather than the <strong>Name</strong> of the Object)</em></p>\n"}, {"tags": [], "owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "is_accepted": true, "score": 1, "last_activity_date": 1463584902, "creation_date": 1463584902, "answer_id": 37303879, "question_id": 37303490, "link": "https://stackoverflow.com/questions/37303490/type-mismatch-on-passing-sheetname-to-procedure/37303879#37303879", "title": "Type mismatch on passing sheetname to procedure", "body": "<p>Here is a simple example of how to pass a worksheet</p>\n\n<pre><code>Sub Main()\n    GetName ThisWorkbook.Worksheets(1)\nEnd Sub\n\nFunction GetName(wb As Worksheet)\n    MsgBox wb.Name\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "is_accepted": false, "score": 2, "last_activity_date": 1463585038, "creation_date": 1463585038, "answer_id": 37303922, "question_id": 37303490, "link": "https://stackoverflow.com/questions/37303490/type-mismatch-on-passing-sheetname-to-procedure/37303922#37303922", "title": "Type mismatch on passing sheetname to procedure", "body": "<p>The answer to @Rory's question is important.</p>\n\n<p>In your code you have:</p>\n\n<pre><code>Sub Import(sheetname As Worksheet)\n</code></pre>\n\n<p>That's cool <em>if</em> you call the Import sub like this (just sample code):</p>\n\n<pre><code>For Each oSheet in oWorkbook\n    Import oSheet \nNext\n</code></pre>\n\n<p>On the other hand, if you want to call Import like this:</p>\n\n<pre><code>strSheet = InputBox(\"Type the name of the sheet to import\")\nImport strSheet\n</code></pre>\n\n<p>Then your code needs to be this:</p>\n\n<pre><code>Sub Import(sheetname As String)\nDim oSheet as Worksheet\nSet oSheet = Sheets(sheetname)\n</code></pre>\n"}], "owner": {"reputation": 1256, "user_id": 3128069, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/4cdd27382d73700ac43edb0becdc1a7b?s=128&d=identicon&r=PG&f=1", "display_name": "phillipsK", "link": "https://stackoverflow.com/users/3128069/phillipsk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "accepted_answer_id": 37303879, "answer_count": 3, "score": 0, "last_activity_date": 1463585038, "creation_date": 1463583838, "question_id": 37303490, "link": "https://stackoverflow.com/questions/37303490/type-mismatch-on-passing-sheetname-to-procedure", "title": "Type mismatch on passing sheetname to procedure", "body": "<p>I apologize I'm sure I am overlooking something simple but too much time has gone by and I cannot figure out why I cannot pass the worksheet titled <code>MAIN</code> as a parameter to the argument of my <code>Import</code> procedure below. MAIN is a worksheet within the workbook.</p>\n\n<p>My goal is to have a universal procedure called <code>Import</code> where I can pass any worksheet within the same workbook and easily store the below column cell relationships into an array by simply passing the worksheet name as a parameter arguement.</p>\n\n<pre><code>Sub Import(sheetname As Worksheet)\n\n'Debug.Print (sheetname)\n\n        cName = \"Fund ID\"\n        cA = sheetname.Rows.Find(What:=UCase(cName), LookAt:=xlWhole, SearchDirection:=xlNext).Column\n    cName = \"CUSIP\"\n    cB = sheetname.Rows.Find(What:=UCase(cName), LookAt:=xlWhole, SearchDirection:=xlNext).Column\n    cName = \"Description\"\n    cC = sheetname.Rows.Find(What:=UCase(cName), LookAt:=xlWhole, SearchDirection:=xlNext).Column\n    cName = \"Security Type\"\n    cD = sheetname.Rows.Find(What:=UCase(cName), LookAt:=xlWhole, SearchDirection:=xlNext).Column\n    cName = \"Currency\"\n    cE = sheetname.Rows.Find(What:=UCase(cName), LookAt:=xlWhole, SearchDirection:=xlNext).Column\n    cName = \"Price Date\"\n    cF = sheetname.Rows.Find(What:=UCase(cName), LookAt:=xlWhole, SearchDirection:=xlNext).Column\n    cName = \"Current Price\"\n    cG = sheetname.Rows.Find(What:=UCase(cName), LookAt:=xlWhole, SearchDirection:=xlNext).Column\n    cName = \"Prior Price\"\n    cH = sheetname.Rows.Find(What:=UCase(cName), LookAt:=xlWhole, SearchDirection:=xlNext).Column\n    cName = \"Change Price (%)\"\n    cI = sheetname.Rows.Find(What:=UCase(cName), LookAt:=xlWhole, SearchDirection:=xlNext).Column\n    cName = \"Change Price (%)\"\n    cJ = sheetname.Rows.Find(What:=UCase(cName), LookAt:=xlWhole, SearchDirection:=xlNext).Column\n    cName = \"BPS Impact\"\n    cK = sheetname.Rows.Find(What:=UCase(cName), LookAt:=xlWhole, SearchDirection:=xlNext).Column\n    cName = \"Source\"\n    cL = sheetname.Rows.Find(What:=UCase(cName), LookAt:=xlWhole, SearchDirection:=xlNext).Column\n    cName = \"Comment\"\n    cM = sheetname.Rows.Find(What:=UCase(cName), LookAt:=xlWhole, SearchDirection:=xlNext).Column\n\n\n\nLastRow = Range(\"b65000\").End(xlUp).Row\n    For r = 2 To LastRow\n            Row = Row + 1\n                aRecon1(Row, 1) = CStr(Cells(r, cA)) 'Fund ID ' added string value method\n               'aRecon1(Row, 1) = Cells(r, cA)            'Fund ID\n                aRecon1(Row, 2) = Cells(r, cB)            'CUSIP\n                aRecon1(Row, 3) = Cells(r, cC)            'Description\n                aRecon1(Row, 4) = Cells(r, cD)            'Security Type\n                aRecon1(Row, 5) = Cells(r, cE)            'Currency\n                aRecon1(Row, 6) = Cells(r, cF)            'Price Date\n                aRecon1(Row, 7) = Cells(r, cG).Value      'Current Price\n                'Debug.Print (Cells(r, cG).Value)\n                                                                                    Debug.Print (Cells(r, cG).Value)\n                    'Debug.Print (Cells(r, cG))\n                aRecon1(Row, 8) = Cells(r, cH).Value      'Prior Price\n                aRecon1(Row, 9) = Cells(r, cI)            'Change Price (%)\n                aRecon1(Row, 10) = Cells(r, cJ)           'BPS Impact\n                aRecon1(Row, 11) = Cells(r, cK)           'Source\n                                                                                    Debug.Print (Cells(r, cK))\n                aRecon1(Row, 12) = Cells(r, cL)          \n\n\n    Next r\n\nSheets(\"Macro\").Activate\n</code></pre>\n"}, {"tags": ["vba", "find", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "is_accepted": false, "score": 0, "last_activity_date": 1463585375, "creation_date": 1463585375, "answer_id": 37304040, "question_id": 37303361, "link": "https://stackoverflow.com/questions/37303361/word-vba-select-the-rest-of-the-word-from-find/37304040#37304040", "title": "Word VBA - select the rest of the word from Find", "body": "<p>Perhaps you can select the found word portion, then expand it to the whole word?</p>\n\n<p><code>Selection.Expand Unit:=wdWord</code></p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 6351669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa9432727cbb08ae173de205fcc8b367?s=128&d=identicon&r=PG&f=1", "display_name": "V.F", "link": "https://stackoverflow.com/users/6351669/v-f"}, "edited": false, "score": 0, "creation_date": 1463600438, "post_id": 37306560, "comment_id": 62138632, "body": "Thank you so much. I have another quick question, if the word end with a line break, can I make rng.MoveEndUntil(&quot; .,;vbNewLine) so it can include line break?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 3, "user_id": 6351669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa9432727cbb08ae173de205fcc8b367?s=128&d=identicon&r=PG&f=1", "display_name": "V.F", "link": "https://stackoverflow.com/users/6351669/v-f"}, "edited": false, "score": 0, "creation_date": 1463602220, "post_id": 37306560, "comment_id": 62139531, "body": "What happens when you try? And I&#39;d tend to try with Chr(13) instead of vbNewLine..."}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 0, "last_activity_date": 1463592853, "creation_date": 1463592853, "answer_id": 37306560, "question_id": 37303361, "link": "https://stackoverflow.com/questions/37303361/word-vba-select-the-rest-of-the-word-from-find/37306560#37306560", "title": "Word VBA - select the rest of the word from Find", "body": "<p>You can still use <code>MoveEndUntil</code>. If you look at the Help topic for the method, you'll see that the first parameter, named <em>CSet</em>, can hold multiple characters. So it can look for a space as well as a period, a comma, a semicolon, etc.</p>\n\n<p>While testing your code, it also came to my attention that, as it stands, it will go into a continuous loop - always finding only the first instance. So I've taken care of that with the <code>Collapse</code> method so that the next Find sequence starts immediately after the last \"found\" range.</p>\n\n<pre><code>Dim rng As word.Range\nDim SearchString As String\n\nSet rng = ActiveDocument.content\nSearchString = \"AB-\"\nWith rng.Find\n    Do While .Execute(findText:=SearchString, Forward:=True) = True\n      rng.MoveEndUntil (\" .,;!\")\n      MsgBox rng.Text\n      rng.Collapse wdCollapseEnd\n    Loop\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6351669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa9432727cbb08ae173de205fcc8b367?s=128&d=identicon&r=PG&f=1", "display_name": "V.F", "link": "https://stackoverflow.com/users/6351669/v-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 574, "favorite_count": 0, "accepted_answer_id": 37306560, "answer_count": 2, "score": 0, "last_activity_date": 1463602319, "creation_date": 1463583555, "last_edit_date": 1463602319, "question_id": 37303361, "link": "https://stackoverflow.com/questions/37303361/word-vba-select-the-rest-of-the-word-from-find", "title": "Word VBA - select the rest of the word from Find", "body": "<p>I try to use Find.FindText in Word VBA to find the first few letters of a word, then select the rest of that word. For example, if I have:\n\"Hello , AB-1234-123 check\"</p>\n\n<p>I would find \"AB-\" then select the rest of the word to get \"AB-1234-123\". I cannot use space as my MoveEndUntil(\"  \") because, sometimes, the word ends with a period.</p>\n\n<p>So far, my code is </p>\n\n<pre><code>SearchString = \"AB-\"\nWith Rng.Find\nDo While .Execute(FindText:=SearchString, Forward:=True) = True\n         Rng.MoveEndUntil (\" \")\n         MsgBox (Rng.Text)\nLoop\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "excel", "foreach"], "answers": [{"comments": [{"owner": {"reputation": 808, "user_id": 2615836, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Oryma.jpg?s=128&g=1", "display_name": "Codes with Hammer", "link": "https://stackoverflow.com/users/2615836/codes-with-hammer"}, "edited": false, "score": 0, "creation_date": 1463582819, "post_id": 37303047, "comment_id": 62127917, "body": "OK, I&#39;ll drop a <code>With</code> into this part and give your code a try."}, {"owner": {"reputation": 808, "user_id": 2615836, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Oryma.jpg?s=128&g=1", "display_name": "Codes with Hammer", "link": "https://stackoverflow.com/users/2615836/codes-with-hammer"}, "edited": false, "score": 0, "creation_date": 1463582954, "post_id": 37303047, "comment_id": 62128042, "body": "Winner winner chicken dinner. Thanks very much.  (Silly single character error.)"}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 1, "last_activity_date": 1463582766, "creation_date": 1463582766, "answer_id": 37303047, "question_id": 37302713, "link": "https://stackoverflow.com/questions/37302713/foreach-over-excel-cells-only-returns-the-first-row-in-run-but-works-properly-w/37303047#37303047", "title": "Foreach over Excel cells only returns the first row in run, but works properly when stepping through the method", "body": "<p>The most likely cause is that you haven't qualified the second <code>Range</code> call (or <code>Rows</code>). Use:</p>\n\n<pre><code>For Each indexCell in ThisWorkbook.Worksheets(\"History\").Range(\"A2:A\" &amp; ThisWorkbook.Worksheets(\"History\").Range(\"A\" &amp; ThisWorkbook.Worksheets(\"History\").Rows.Count).End(xlUp).Row).Cells\n</code></pre>\n\n<p>Using a variable for the worksheet would simplify things!</p>\n"}, {"tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": false, "score": 0, "last_activity_date": 1463583212, "creation_date": 1463583212, "answer_id": 37303210, "question_id": 37302713, "link": "https://stackoverflow.com/questions/37302713/foreach-over-excel-cells-only-returns-the-first-row-in-run-but-works-properly-w/37303210#37303210", "title": "Foreach over Excel cells only returns the first row in run, but works properly when stepping through the method", "body": "<pre><code>With ThisWorkbook.Worksheets(\"History\")\n    For Each indexCell in .Range(\"A2:A\" &amp; .Range(\"A\" &amp; Rows.Count).End(xlUp).Row).Cells\n        ....\n    Next\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 808, "user_id": 2615836, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/Oryma.jpg?s=128&g=1", "display_name": "Codes with Hammer", "link": "https://stackoverflow.com/users/2615836/codes-with-hammer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 37303047, "answer_count": 2, "score": 0, "last_activity_date": 1463583212, "creation_date": 1463582041, "question_id": 37302713, "link": "https://stackoverflow.com/questions/37302713/foreach-over-excel-cells-only-returns-the-first-row-in-run-but-works-properly-w", "title": "Foreach over Excel cells only returns the first row in run, but works properly when stepping through the method", "body": "<p>I'm using an Excel spreadsheet as a data table for time period history.  The structure is this:</p>\n\n<pre><code>ID  Person      Start   End\n1   Alan        5/1     5/3\n2   Bobbi       5/3     5/4\n3   Chuck       5/1     5/2\n5   Eugenia     5/3     5/6\n6   Chuck       5/10    5/12\n</code></pre>\n\n<p><code>Start</code> and <code>End</code> are formatted as Date fields.</p>\n\n<p>I wrote a method in a VBA module to query this table and return all rows for a given person, such as <code>Chuck</code>.  In SQL, this is easy enough (<code>select fields from History where Person = something</code>).  I am currently using a <code>foreach</code> loop and testing the value of <code>Person</code>.  My loop reads as follows:</p>\n\n<pre><code>Public Sub UpdatePeriod(currentPeriod as timePeriod)\n\nDim indexCell As Range\nDim colPeriods As New Collection\nDim priorPeriod As timePeriod\n\nFor Each indexCell in ThisWorkbook.Worksheets(\"History\").Range(\"A2:A\" &amp; Range(\"A\" &amp; Rows.Count).End(xlUp).Row).Cells\n    If Not (indexCell Is Nothing) And IsNumeric(indexCell) = True Then\n        Set priorPeriod = GetPeriodObject(indexCell)\n        If (priorPeriod.Person = currentPeriod.Person) Then\n            colPeriods.Add priorPeriod\n        End If\n    End If\nNext\n\n'Do stuff with the entries in colPeriods....\nEnd Sub\n</code></pre>\n\n<p>I have set up the spreadsheet so that a certain sheet's <code>Worksheet_Change</code> event handler will pass a <code>timePeriod</code> object to this method.  So far, everything works properly (though there's probably a better way).</p>\n\n<p>When I test the method without breaking before the <code>For Each</code>, the loop only goes over row 2 (as row 1 contains the headers).  But when I do break before the loop, the loop properly goes over all rows.</p>\n\n<p>How do I improve this method to return all rows of interest?</p>\n\n<p>(Note: The project is using VBA as a prototype, and eventually will be a proper application with a proper database.  I aim to make the data interface look exactly the same as the application implementation.)</p>\n"}, {"tags": ["excel", "vba", "email", "outlook", "email-attachments"], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 6190062, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ecacb85aa6e43a64450919689ec38b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Davey ", "link": "https://stackoverflow.com/users/6190062/davey"}, "edited": false, "score": 0, "creation_date": 1463582610, "post_id": 37302823, "comment_id": 62127742, "body": "for &quot;path to file&quot; what should I put since my path is dynamic? the file name is changing"}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "reply_to_user": {"reputation": 123, "user_id": 6190062, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ecacb85aa6e43a64450919689ec38b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Davey ", "link": "https://stackoverflow.com/users/6190062/davey"}, "edited": false, "score": 0, "creation_date": 1463582754, "post_id": 37302823, "comment_id": 62127861, "body": "What file are you adding as an attachment?"}, {"owner": {"reputation": 123, "user_id": 6190062, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ecacb85aa6e43a64450919689ec38b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Davey ", "link": "https://stackoverflow.com/users/6190062/davey"}, "edited": false, "score": 0, "creation_date": 1463582868, "post_id": 37302823, "comment_id": 62127958, "body": "an excel file. The command button I click is inside the workbook that I&#39;m trying to attach."}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "reply_to_user": {"reputation": 123, "user_id": 6190062, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ecacb85aa6e43a64450919689ec38b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Davey ", "link": "https://stackoverflow.com/users/6190062/davey"}, "edited": false, "score": 2, "creation_date": 1463583006, "post_id": 37302823, "comment_id": 62128089, "body": "In that case use <code>Application.ActiveWorkbook.FullName</code> to add the (most recently saved, so you might want to add an <code>ActiveWorkbook.Save</code> command before you do the attach) current file to the email: <code>.Attachments.Add Application.ActiveWorkbook.FullName</code>"}, {"owner": {"reputation": 123, "user_id": 6190062, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ecacb85aa6e43a64450919689ec38b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Davey ", "link": "https://stackoverflow.com/users/6190062/davey"}, "edited": false, "score": 0, "creation_date": 1463583629, "post_id": 37302823, "comment_id": 62128601, "body": "That worked perfectly! Thank you so much for your help! I could not figure this out. Thanks!"}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "reply_to_user": {"reputation": 123, "user_id": 6190062, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ecacb85aa6e43a64450919689ec38b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Davey ", "link": "https://stackoverflow.com/users/6190062/davey"}, "edited": false, "score": 1, "creation_date": 1463583689, "post_id": 37302823, "comment_id": 62128655, "body": "No problem. If it solved your question, please mark the answer with the check mark so others can see that easily too :)"}], "tags": [], "owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "is_accepted": true, "score": 11, "last_activity_date": 1463582312, "creation_date": 1463582312, "answer_id": 37302823, "question_id": 37302602, "link": "https://stackoverflow.com/questions/37302602/sending-email-attachments-from-excel-via-vba/37302823#37302823", "title": "Sending email attachments from Excel via VBA", "body": "<p>You need the <code>Attachments.Add</code> code inserted into the MailItem setup:</p>\n\n<pre><code>With objOutlookMsg\n    Set objOutlookRecip = .Recipients.Add(\"blah@blah\")\n    objOutlookRecip.Type = olTo\n   .Subject = \"Blah \" &amp; WeekendingDate\n   .Body = \"blah blah blah\"\n'Add attachments to the message [some code]\n   .Attachments.Add \"pathToFile\"\n   For Each objOutlookRecip In .Recipients\n       objOutlookRecip.Resolve\n   Next\n   If DisplayMsg Then\n       .Display\n   Else\n       .Save\n   End If\nEnd With\nSet objOutlook = Nothing\n</code></pre>\n\n<p>In one of my own scripts I pass a collection of attachments to the MailItem to be attached using a Dictionary object and the following code:</p>\n\n<pre><code>With oMailItem\n        Set .SendUsingAccount = oOutlook.Session.Accounts.Item(iAccount)\n        .To = EmailData(\"To\")\n        .CC = EmailData(\"CC\")\n        .BCC = EmailData(\"BCC\")\n        .Subject = EmailData(\"Subject\")\n        .Body = EmailData(\"Body\")\n        sAttachArray = Split(EmailData(\"AttachmentPaths\"), \";\")\n        For Each sAttachment In sAttachArray\n            .Attachments.Add(sAttachment)\n        Next\n        .Recipients.ResolveAll\n        .Display    ' debug mode - uncomment this to see email before it's sent out\n    End With\n</code></pre>\n"}], "owner": {"reputation": 123, "user_id": 6190062, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ecacb85aa6e43a64450919689ec38b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Davey ", "link": "https://stackoverflow.com/users/6190062/davey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94326, "favorite_count": 5, "accepted_answer_id": 37302823, "answer_count": 1, "score": 6, "last_activity_date": 1549375109, "creation_date": 1463581781, "last_edit_date": 1549375109, "question_id": 37302602, "link": "https://stackoverflow.com/questions/37302602/sending-email-attachments-from-excel-via-vba", "title": "Sending email attachments from Excel via VBA", "body": "<p>I've written a macro that at the click of a button it sends an automated email via Outlook. Everything runs smoothly except I just can't figure out how to attach a file to the email. Everywhere I've looked, example code for attaching files to an email is for static named files, as in, you're sending the same file name, with the same path every time. </p>\n\n<p>If it makes it more convenient, the button that runs this macro is inside the workbook that I'm trying to attach. I'm not sure if opening a Windows Explorer window is easiest and attaching the file that way would be best.</p>\n\n<pre><code>Sub mySub\n    Dim objOutlook As Outlook.Application\n    Dim objOutlookMsg As Outlook.MailItem\n    Dim objOutlookRecip As Outlook.recipient\n    Dim objOutlookAttach As Outlook.Attachment\n    Dim WeekendingDate As Date\n\n    With Worksheets(\"Macro Buttons\")\n        WeekendingDate = Range(\"N2\").Value\n    End With\n\n    Set objOutlook = CreateObject(\"Outlook.Application\")\n\n    Set objOutlookMsg = objOutlook.CreateItem(olMailItem)\n\n    With objOutlookMsg\n        Set objOutlookRecip = .Recipients.Add(\"blah@blah\")\n        objOutlookRecip.Type = olTo\n       .Subject = \"Blah \" &amp; WeekendingDate\n       .Body = \"blah blah blah\"\n\n       'Add attachments to the message\n       [some code]\n\n\n       For Each objOutlookRecip In .Recipients\n           objOutlookRecip.Resolve\n       Next\n       If DisplayMsg Then\n           .Display\n       Else\n           .Save\n       End If\n    End With\n    Set objOutlook = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "csv", "vba"], "answers": [{"comments": [{"owner": {"reputation": 311, "user_id": 6346514, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27cfbe4a59ba97775b430e17ca7361fa?s=128&d=identicon&r=PG&f=1", "display_name": "Jonnyboi", "link": "https://stackoverflow.com/users/6346514/jonnyboi"}, "edited": false, "score": 0, "creation_date": 1463583364, "post_id": 37303218, "comment_id": 62128376, "body": "Thanks Jack, I would like to add the loop through the folder with the within my function. Some of these don&#39;t need to be looped, just the wildcard values need to be."}], "tags": [], "owner": {"reputation": 56, "user_id": 6349118, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0SqEI.png?s=128&g=1", "display_name": "JackIsJack", "link": "https://stackoverflow.com/users/6349118/jackisjack"}, "is_accepted": false, "score": 1, "last_activity_date": 1463583230, "last_edit_date": 1495535317, "creation_date": 1463583230, "answer_id": 37303218, "question_id": 37302534, "link": "https://stackoverflow.com/questions/37302534/excel-function-search-for-max-wildcard/37303218#37303218", "title": "Excel Function, Search for Max wildcard (*)", "body": "<p>You can loop through all files in your folder and calculate the maximum yourself ?</p>\n\n<p>Method for loop :</p>\n\n<p><a href=\"https://stackoverflow.com/questions/10380312/loop-through-files-in-a-folder-using-vba\">Loop through files in a folder using VBA?</a></p>\n"}, {"tags": [], "owner": {"reputation": 311, "user_id": 6346514, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27cfbe4a59ba97775b430e17ca7361fa?s=128&d=identicon&r=PG&f=1", "display_name": "Jonnyboi", "link": "https://stackoverflow.com/users/6346514/jonnyboi"}, "is_accepted": true, "score": 0, "last_activity_date": 1463590247, "creation_date": 1463590247, "answer_id": 37305734, "question_id": 37302534, "link": "https://stackoverflow.com/questions/37302534/excel-function-search-for-max-wildcard/37305734#37305734", "title": "Excel Function, Search for Max wildcard (*)", "body": "<p>Following code will return the max time when using wildcards in the path   </p>\n\n<pre><code>Public Function GetFileDate(strFile As String) As Date\n\n\n        Dim lastDate As Date\n        Dim FileName As String\n        Dim FilePath As String\n\n        FileName = Split(strFile, \"\\\")(UBound(Split(strFile, \"\\\")))\n        FilePath = Replace(strFile, FileName, vbNullString)\n\n        FileName = Dir(FilePath &amp; FileName)\n\n        Do While FileName &lt;&gt; vbNullString\n\n            If lastDate &lt; FileDateTime(FilePath &amp; FileName) Then\n                lastDate = FileDateTime(FilePath &amp; FileName)\n            End If\n\n            FileName = Dir\n        Loop\n\n        GetFileDate = lastDate\n\n    End Function\n</code></pre>\n"}], "owner": {"reputation": 311, "user_id": 6346514, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27cfbe4a59ba97775b430e17ca7361fa?s=128&d=identicon&r=PG&f=1", "display_name": "Jonnyboi", "link": "https://stackoverflow.com/users/6346514/jonnyboi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 37305734, "answer_count": 2, "score": 1, "last_activity_date": 1463590247, "creation_date": 1463581617, "last_edit_date": 1531161705, "question_id": 37302534, "link": "https://stackoverflow.com/questions/37302534/excel-function-search-for-max-wildcard", "title": "Excel Function, Search for Max wildcard (*)", "body": "<p>I have the following function that searches for a file paths, modified file date. However if my file has a wildcard at the end then this function returns a <code>12:00</code>.\nThis is because the file with the wildcard will have many options in the path and it is not sure what value to return.</p>\n\n<p>How can I tell this function to grab the <code>max</code> wildcard file path name.</p>\n\n<p>Ex: <code>*Stack/Over/Flow_*.csv* (a1)</code>  will return <code>12:00(a2)</code> because the actual folder will contain <code>*Stack/Over/Flow_1.csv*, *Stack/Over/Flow_2.csv*, *Stack/Over/Flow_3.csv.*</code>   . The work-around I have is just changing the file card path to a 1 , and it will return a proper value. But I would like the <code>max</code> of this wildcard.</p>\n\n<p>Is it possible to return the <code>max</code> of whichever modified date is greater of each of these? Or do you recommend just changing the wildcard (*) to a 1 and using function as it is?</p>\n\n<pre><code> Public Function getmodifieddateoffile(FilePath As String)\n\n    On Error GoTo ExitWithError\n\n    If FilePath = \"\" Then\n        Exit Function\n    End If\n    If Dir(FilePath) &lt;&gt; \"\" Then\n    'This creates an instance of the MS Scripting Runtime FileSystemObject class\n    Set oFS = CreateObject(\"Scripting.FileSystemObject\")\n\n    getmodifieddateoffile = oFS.GetFile(FilePath).DateLastModified\n    Else\n    End If\n\n    Exit Function\n    ExitWithError:\n\n    End Function\n</code></pre>\n\n<p>Any help would be greatly appreciated.</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1463581669, "post_id": 37302477, "comment_id": 62127004, "body": "Not in the way you described.  Consider a subform for the other record source."}], "answers": [{"tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 1, "last_activity_date": 1463581694, "creation_date": 1463581694, "answer_id": 37302559, "question_id": 37302477, "link": "https://stackoverflow.com/questions/37302477/multiple-detail-sections-on-a-form/37302559#37302559", "title": "Multiple detail sections on a form", "body": "<p>You can have one detail section only, but several subforms.</p>\n"}], "owner": {"reputation": 375, "user_id": 3216034, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/eb061981ca8df90d46d66da96a0b0577?s=128&d=identicon&r=PG&f=1", "display_name": "jpl458", "link": "https://stackoverflow.com/users/3216034/jpl458"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1356, "favorite_count": 0, "accepted_answer_id": 37302559, "answer_count": 1, "score": 0, "last_activity_date": 1594023265, "creation_date": 1463581472, "last_edit_date": 1594023265, "question_id": 37302477, "link": "https://stackoverflow.com/questions/37302477/multiple-detail-sections-on-a-form", "title": "Multiple detail sections on a form", "body": "<p>ACCESS 2010, windows 7</p>\n\n<p>Is it possible to have multiple detail sections on a form each with a different record source (Different query for each section). If so, how is it done?</p>\n\n<p>Thanks</p>\n\n<p>jpl</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1463583192, "post_id": 37302225, "comment_id": 62128238, "body": "Not really sure what to say other than that the value in your list doesn&#39;t match the one on the sheet. You are best placed to figure out why with some debugging... ;)"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1463583641, "post_id": 37302225, "comment_id": 62128612, "body": "To make it so the code will not stop when it does not find the value do not use WorksheetFunction.  use <code>Application.Match(...</code> and declare strResult as a variant.  This will allow the error to pass into the variable.  Then you can test whether the variable is an error or not before assigning it to the caption."}, {"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "edited": false, "score": 0, "creation_date": 1463595298, "post_id": 37302225, "comment_id": 62135807, "body": "I found the error. Some of the cells in the range had leading spaces. But the spaces do not remain when they are loaded into the listbox. When it tries to match the listbox value to the value in the range it errors because the range value has a leading space but the listbox value does not. I&#39;ll need a different approach. Thanks!"}, {"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1463673414, "post_id": 37302225, "comment_id": 62175863, "body": "use <code>Trim()</code> to remove the space"}, {"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "reply_to_user": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1463679545, "post_id": 37302225, "comment_id": 62179369, "body": "@Raystafarian The trim function will not work because I am putting the range of data into a listbox and the listbox removes the spaces. Therefore, when I lookup the value I click on in the listbox it does not find it because I am trying to find the listbox value (NO leading space) in the range (leading space)."}, {"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1463679645, "post_id": 37302225, "comment_id": 62179418, "body": "I&#39;m saying trim the range - why do you need leading or trailing spaces?"}, {"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "edited": false, "score": 0, "creation_date": 1463679754, "post_id": 37302225, "comment_id": 62179478, "body": "Sorry, I figured you meant that after posting but I tried that, too. I must have done something wrong."}], "owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1463580803, "creation_date": 1463580803, "last_edit_date": 1531164843, "question_id": 37302225, "link": "https://stackoverflow.com/questions/37302225/match-function-returning-run-time-error", "title": "Match Function returning Run-time error", "body": "<p>I have a column with unique values. I populate a listbox on a userform with those values and return data from another column to a label caption when a value from the listbox is clicked with the following code:</p>\n\n<pre><code>With Table\n    Set rngNum = .ListColumns(.ListColumns(strNum).Range.column).DataBodyRange\n    Set rngVal = .ListColumns(.ListColumns(strVal).Range.column).DataBodyRange\nEnd With\nWith Worksheet\n        strResult = wf.Index(.Range(rngVal.address), wf.Match(lstVal.List(lstVal.ListIndex), .Range(rngNum.address), 0)) --Error occurs here!\nEnd With\n    lblDescription.Caption = strResult\n</code></pre>\n\n<p>The code has worked perfectly for several months until recently I get a <code>Run-time error '1004': Unable to get the Match property of the WorksheetFunction class</code> on the line noted above. </p>\n\n<p>The error occurs when I click on certain values in the listbox. Most of the values in the range are numbers stored as text but there a few that are not. Originally, I thought that was the problem. But, strangely, of the values that are not stored as text, one of them gives the error and the other doesn't. The table is exported from the Internet. Not sure what I am missing. Any help is appreciated! Let me know if you need additional information. Thank you!</p>\n"}, {"tags": ["excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1463580999, "post_id": 37302032, "comment_id": 62126508, "body": "What happens if you use just the password as the third argument, like this? <code>.OpenCurrentDatabase(&quot;O:\\2016\\DatabaseName.accdb&quot;, False, &quot;XXXX&quot;)</code>"}, {"owner": {"reputation": 40, "user_id": 3952630, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/56c03a6ca7cf5183653132c118cf40a6?s=128&d=identicon&r=PG&f=1", "display_name": "branden", "link": "https://stackoverflow.com/users/3952630/branden"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1464003948, "post_id": 37302032, "comment_id": 62289572, "body": "HansUp - using your suggestion avoided the password prompt, but still gave me the error &quot;run-time error....&quot; shown above"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7194691, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/77f9153b249ff35e3cadf6998e24add4?s=128&d=identicon&r=PG", "display_name": "Mirko M", "link": "https://stackoverflow.com/users/7194691/mirko-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1479822025, "last_edit_date": 1479822025, "creation_date": 1479820691, "answer_id": 40742909, "question_id": 37302032, "link": "https://stackoverflow.com/questions/37302032/run-a-access-savedexport-from-excel/40742909#40742909", "title": "Run a Access SavedExport from Excel", "body": "<p>There is a distinct possibility that the error is based on remnants of the old 8-character name system, if you possibly at some time have renamed/altered your saved export.</p>\n\n<p>Try renaming your saved export now to a name that begins with a different combination of initial characters than what you've used before. (i.e. not from <code>SavedExportName</code> to <code>SavedExportNameNEW</code>, but from <code>SavedExportName</code> to for instance <code>NewSavedExportName</code>).</p>\n\n<p>That did the trick for me!</p>\n\n<p>In fact, using MS VBA 7.1 in MS Access 2007-2013, I have, with success, completely omitted most of the code that you're using, and this simple line does it all:</p>\n\n<pre><code>DoCmd.RunSavedImportExport (\"NameOfSavedExport\")\n</code></pre>\n\n<p>(Not sure if the parenthesis are needed, but it Works!)\n(That being said - I'm running it from within the DB, so you might need most of Your original code after all...)</p>\n\n<p>Hope this helps!</p>\n"}], "owner": {"reputation": 40, "user_id": 3952630, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/56c03a6ca7cf5183653132c118cf40a6?s=128&d=identicon&r=PG&f=1", "display_name": "branden", "link": "https://stackoverflow.com/users/3952630/branden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 566, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1593957660, "creation_date": 1463580361, "last_edit_date": 1593957660, "question_id": 37302032, "link": "https://stackoverflow.com/questions/37302032/run-a-access-savedexport-from-excel", "title": "Run a Access SavedExport from Excel", "body": "<p>I am trying (and failing) to write a macro in Excel that would:\n1. Open a Database that has a password\n2. Run a savedexport</p>\n\n<p>So far I have the following, but it still prompts for the password, and gives an error: </p>\n\n<pre><code>&gt;\"Run-time error '31599':\n\n&gt;The specified name \" cannot be set due to one of the following reasons:\n\n&gt;* The specified name is not unique.\n&gt;* The specified name is blank.\n&gt;* The specified name does not follow [Name of My Database] object-naming rules.\n</code></pre>\n\n<p>MACRO</p>\n\n<pre><code>Sub RunSavedExport()\n\n'Open DB and run procedure\nSet objAccess = CreateObject(\"Access.Application\")\nIf Not objAccess Is Nothing Then\n\n    With objAccess\n        .OpenCurrentDatabase \"O:\\2016\\DatabaseName.accdb\", False, \"MS Access;PWD=XXXX\"\n    .DoCmd.SetWarnings False\n    .DoCmd.RunSavedImportExport \"SavedExportName\"\n    .DoCmd.SetWarnings True\n\n\n    End With\nEnd If\n\n\n'Close Access\nIf Not objAccess Is Nothing Then\n    With objAccess\n        .CloseCurrentDatabase\n        .Quit\n    End With\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "edited": false, "score": 0, "creation_date": 1463581228, "post_id": 37301928, "comment_id": 62126686, "body": "Aside from your core question. you have started a <code>with</code> statement and then not used it. you should put a full stop before <code>Range</code> (i.e. <code>With Sheets(&quot;Vertical&quot;)    score = .Range(&quot;C3&quot;).Value</code>"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 6341252, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e963c72ec61ab494d477fb253b9a11e9?s=128&d=identicon&r=PG&f=1", "display_name": "Lilou", "link": "https://stackoverflow.com/users/6341252/lilou"}, "edited": false, "score": 0, "creation_date": 1463581167, "post_id": 37302191, "comment_id": 62126644, "body": "Okay that worked except it attributed the wrong result to 0.6*hydraulic and 0.3* hydraulic so I modified it a bit to include these :         Case (0.3 * hydraulic) To (0.59 * hydraulic)         result = &quot;0.3&quot;         Case (0.6 * hydraulic) To (0.99 * hydraulic)         result = &quot;0.6&quot;         Case Is &gt;= hydraulic         result = &quot;1&quot;"}], "tags": [], "owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "is_accepted": false, "score": 1, "last_activity_date": 1463580716, "creation_date": 1463580716, "answer_id": 37302191, "question_id": 37301928, "link": "https://stackoverflow.com/questions/37301928/comparing-two-cells-using-select-case-or-if-then-vba/37302191#37302191", "title": "Comparing two cells using Select Case or If Then VBA", "body": "<p>Your problem in the Select Case statements is that once a condition is met, it quits comparing. So when your condition is...say 0.8, the following code says \"Is it greater than or equal to 0.3 * Hydraulic? Yes\" and then never compares the 0.6 * Hydraulic. </p>\n\n<pre><code>Case Is &gt;= 0.3 * hydraulic\n    result = \"0.3\"\nCase Is &gt;= 0.6 * hydraulic\n</code></pre>\n\n<p>You need to put a limit on the first comparison like this:</p>\n\n<pre><code>Case (0.3 * hydraulic) To (0.6 * hydraulic)\n    result = \"0.3\"\nCase (0.6 * hydraulic) To 1\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "edited": false, "score": 0, "creation_date": 1463580861, "post_id": 37302201, "comment_id": 62126401, "body": "I don&#39;t think that&#39;s the case. In your change to his code, values between .3 * hydraulic and .6 * hydraulic are ignored."}], "tags": [], "owner": {"reputation": 567, "user_id": 5805795, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5e306c676900f1dc3f798f3915879f03?s=128&d=identicon&r=PG&f=1", "display_name": "jcarroll", "link": "https://stackoverflow.com/users/5805795/jcarroll"}, "is_accepted": false, "score": 0, "last_activity_date": 1463580736, "creation_date": 1463580736, "answer_id": 37302201, "question_id": 37301928, "link": "https://stackoverflow.com/questions/37301928/comparing-two-cells-using-select-case-or-if-then-vba/37302201#37302201", "title": "Comparing two cells using Select Case or If Then VBA", "body": "<p>Using the first bit of code you posted, I think your >= is backwards. It should be &lt;=.</p>\n\n<pre><code>Sub Salmonpool_depth1()\n\nDim score As Variant, result As String\n\nWith Sheets(\"Vertical\")\n\n    score = Range(\"C3\").Value\n\n    Select Case score\n        Case Is = \"\"\n            result = \"\"\n        Case Is &lt;= (0.3 * Range(\"B3\").Value)\n            result = \"0.3\"\n        Case Is &gt;= (0.6 * Range(\"B3\").Value)\n            result = \"0.6\"\n        Case Is &gt;= Range(\"B3\").Value\n            result = \"1\"\n        Case Else\n            result = \"0\"\n    End Select\n\nRange(\"C8\").Value = result\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 286, "user_id": 5261233, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/i5rHw.jpg?s=128&g=1", "display_name": "Histerical", "link": "https://stackoverflow.com/users/5261233/histerical"}, "edited": false, "score": 0, "creation_date": 1463581010, "post_id": 37302297, "comment_id": 62126514, "body": "Your answer is correct, but @tim&#39;s answer is the better solution for this instance."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 286, "user_id": 5261233, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/i5rHw.jpg?s=128&g=1", "display_name": "Histerical", "link": "https://stackoverflow.com/users/5261233/histerical"}, "edited": false, "score": 0, "creation_date": 1463581089, "post_id": 37302297, "comment_id": 62126579, "body": "Well its worth pointing out that case select needs to be ordered appropriately. I intentionally didnt include a range via TO because i felt as if the issue was the lack of that understanding"}, {"owner": {"reputation": 286, "user_id": 5261233, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/i5rHw.jpg?s=128&g=1", "display_name": "Histerical", "link": "https://stackoverflow.com/users/5261233/histerical"}, "edited": false, "score": 0, "creation_date": 1463581144, "post_id": 37302297, "comment_id": 62126624, "body": "I agree with your statement, definitely need to understand how the syntax works in order to get your code to work. Excellent point."}, {"owner": {"reputation": 33, "user_id": 6341252, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e963c72ec61ab494d477fb253b9a11e9?s=128&d=identicon&r=PG&f=1", "display_name": "Lilou", "link": "https://stackoverflow.com/users/6341252/lilou"}, "edited": false, "score": 0, "creation_date": 1463581280, "post_id": 37302297, "comment_id": 62126718, "body": "Thanks for the clarification, I hadn&#39;t thought of changing the order."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1463581398, "post_id": 37302297, "comment_id": 62126796, "body": "Youre welcome. Though you should incorporate a combination of my answer and @Tim &#39;s. The To operator with Select Case can really help address ranges of values. I would alter it to say .3 to .59 though..."}, {"owner": {"reputation": 33, "user_id": 6341252, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e963c72ec61ab494d477fb253b9a11e9?s=128&d=identicon&r=PG&f=1", "display_name": "Lilou", "link": "https://stackoverflow.com/users/6341252/lilou"}, "edited": false, "score": 0, "creation_date": 1463581711, "post_id": 37302297, "comment_id": 62127036, "body": "Yes I&#39;d already commented that otherwise it attributed the wrong result to 0.3 and 0.6 multiples."}], "tags": [], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "is_accepted": true, "score": 1, "last_activity_date": 1463580947, "creation_date": 1463580947, "answer_id": 37302297, "question_id": 37301928, "link": "https://stackoverflow.com/questions/37301928/comparing-two-cells-using-select-case-or-if-then-vba/37302297#37302297", "title": "Comparing two cells using Select Case or If Then VBA", "body": "<p>the problem is that if its greater than .03 then it will always stop there. SELECT CASE Statements exit when one of the conditions evaluates to try. You would need to order it in such a fashion:</p>\n\n<pre><code>    Case Is &gt;= hydraulic\n         result = \"1\"\n    Case Is &gt;= 0.6 * hydraulic\n         result = \"0.6\"\n    Case Is &gt;= 0.3 * Range(\"B3\").Value\n         result = \"0.3\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 6300645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6266ff4e72f3a46d4f4454e567f48ce1?s=128&d=identicon&r=PG&f=1", "display_name": "gualdhar", "link": "https://stackoverflow.com/users/6300645/gualdhar"}, "is_accepted": false, "score": 0, "last_activity_date": 1463595052, "creation_date": 1463595052, "answer_id": 37307207, "question_id": 37301928, "link": "https://stackoverflow.com/questions/37301928/comparing-two-cells-using-select-case-or-if-then-vba/37307207#37307207", "title": "Comparing two cells using Select Case or If Then VBA", "body": "<p>I know that Tim, Doug and JC have all answered your question for cases, but as you said your if statements were also giving improper results, and I'm not sure anyone addressed that.  As written, changing the order would fix the result, but the more elegant solution is using the Else If statement. That way, you get a situation similar to using Case, where it checks each statement until one is right, does the section of code in that section, and skips ahead to End If when its done. It would look something like this:</p>\n\n<pre><code>If pool &gt;= hydraulic Then\n    Range(\"C8\").Value = 1\nElse If pool &gt;= 0.6 * hydraulic Then\n    Range(\"C8\").Value = 0.6\nElse If pool &gt;= 0.3 * hydraulic Then\n    Range(\"C8\").Value = 0.3\nElse If pool &lt; 0.3 * hydraulic Then\n    Range(\"C8\").Value = 0\nElse If pool = \"\" Then\n    Range(\"C8\").Value = \"\"\nEnd If\n</code></pre>\n\n<p>This way, lets say pool was 0.7*hydraulic, it would throw False for the first If statement, then True for the next Else If line, set C8 to 0.6, and move to the End If line. Your way (putting End If after each If statement) checks each If statement sequentially, whether something passes the previous statement or not. You can also make this more robust by requiring multiple conditionals to pass each if:</p>\n\n<pre><code>If pool &gt;= hydraulic Then\n    Range(\"C8\").Value = 1\nElse If pool &gt;= 0.6 * hydraulic And pool &lt; hydraulic Then\n    Range(\"C8\").Value = 0.6\nElse If pool &gt;= 0.3 * hydraulic And pool &lt; 0.6 * hydraulic Then\n    Range(\"C8\").Value = 0.3\nElse If pool &lt; 0.3 * hydraulic Then\n    Range(\"C8\").Value = 0\nElse If pool = \"\" Then\n    Range(\"C8\").Value = \"\"\nEnd If\n</code></pre>\n\n<p>With this snipet, you can reorder the conditionals however you like, and it will only pass if it falls within that specific range. And, if you like, you can place an Else line by itself at the end of the section that will be run if none of the If or Else If statements pass:</p>\n\n<pre><code>If pool &gt;= hydraulic Then\n    Range(\"C8\").Value = 1\nElse If pool &gt;= 0.6 * hydraulic And pool &lt; hydraulic Then\n    Range(\"C8\").Value = 0.6\nElse If pool &gt;= 0.3 * hydraulic And pool &lt; 0.6 * hydraulic Then\n    Range(\"C8\").Value = 0.3\nElse If pool &lt; 0.3 * hydraulic Then\n    Range(\"C8\").Value = 0\nElse If pool = \"\" Then\n    Range(\"C8\").Value = \"\"\nElse\n    Range(\"C8\").Value = \"Invalid Entry\"\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 6341252, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e963c72ec61ab494d477fb253b9a11e9?s=128&d=identicon&r=PG&f=1", "display_name": "Lilou", "link": "https://stackoverflow.com/users/6341252/lilou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1381, "favorite_count": 0, "accepted_answer_id": 37302297, "answer_count": 4, "score": 0, "last_activity_date": 1463595052, "creation_date": 1463580153, "question_id": 37301928, "link": "https://stackoverflow.com/questions/37301928/comparing-two-cells-using-select-case-or-if-then-vba", "title": "Comparing two cells using Select Case or If Then VBA", "body": "<p>I am trying to get different results in cell \"C8\" depending on the relationship between the values of the cells \"B3\" and \"C3\"</p>\n\n<p>I first tried with a basic Select Case :</p>\n\n<pre><code>    Sub Salmonpool_depth1()\nDim score As Variant, result As String\nWith Sheets(\"Vertical\")\n    score = Range(\"C3\").Value\nSelect Case score\n    Case Is = \"\"\n        result = \"\"\n    Case Is &gt;= 0.3 * Range(\"B3\").Value\n        result = \"0.3\"\n    Case Is &gt;= 0.6 * Range(\"B3\").Value\n        result = \"0.6\"\n    Case Is &gt;= Range(\"B3\").Value\n        result = \"1\"\n    Case Else\n        result = \"0\"\nEnd Select\nRange(\"C8\").Value = result\nEnd With\nEnd Sub\n</code></pre>\n\n<p>But it always gave me the result 0.3 as a result if any conditions were filled other than the last one, it did give me 0 when the last condition was filled.</p>\n\n<p>I then tried by defining B3 and C3 as variables</p>\n\n<pre><code>Sub Salmonpool_depth2()\nDim pool As Variant, result As String, hydraulic As Variant\nWith Sheets(\"Vertical\")\n    pool = Range(\"C3\").Value\n    hydraulic = Range(\"B3\").Value\nSelect Case pool\n    Case Is = \"\"\n        result = \"\"\n    Case Is &gt;= 0.3 * hydraulic\n        result = \"0.3\"\n    Case Is &gt;= 0.6 * hydraulic\n        result = \"0.6\"\n    Case Is &gt;= hydraulic\n        result = \"1\"\n    Case Else\n        result = \"0\"\nEnd Select\nRange(\"C8\").Value = result\nEnd With\nEnd Sub\n</code></pre>\n\n<p>But that also gave me 0.3 or 0 as a result as above</p>\n\n<p>I then tried with If Then statements instead :</p>\n\n<pre><code>Sub Salmonpool_depth3()\nDim hydraulic As Variant, pool As Variant\nhydraulic = Range(\"B3\").Value\npool = Range(\"C3\").Value\n\nIf pool &gt;= hydraulic Then\nRange(\"C8\").Value = 1\nEnd If\nIf pool &gt;= 0.6 * hydraulic Then\nRange(\"C8\").Value = 0.6\nEnd If\nIf pool &gt;= 0.3 * hydraulic Then\nRange(\"C8\").Value = 0.3\nEnd If\nIf pool &lt; 0.3 * hydraulic Then\nRange(\"C8\").Value = 0\nEnd If\nIf pool = \"\" Then\nRange(\"C8\").Value = \"\"\nEnd If\nEnd Sub\n</code></pre>\n\n<p>But that also gives me 0.3 or 0 as above.</p>\n\n<p>Does anyone have any idea how to change this? It must be in the way that I ask the question as the program does not understand.</p>\n\n<p>Lilou</p>\n"}, {"tags": ["vba", "excel", "row"], "answers": [{"tags": [], "owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "is_accepted": false, "score": 0, "last_activity_date": 1463580272, "creation_date": 1463580272, "answer_id": 37301994, "question_id": 37301759, "link": "https://stackoverflow.com/questions/37301759/macro-vba-code-to-select-a-row-x-row-below-the-one-selected/37301994#37301994", "title": "Macro VBA code to select a row X row below the one selected", "body": "<p>Like this?</p>\n\n<pre><code>Rows(RowSelected1 + 44).Select\nRange(\"B\" &amp; ActiveCell.Row &amp; \":DJ\" &amp; ActiveCell.Row).Select\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 170, "user_id": 5777509, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/4889f934de948e93e876a60724bf5247?s=128&d=identicon&r=PG&f=1", "display_name": "johankr", "link": "https://stackoverflow.com/users/5777509/johankr"}, "is_accepted": false, "score": 0, "last_activity_date": 1463583508, "creation_date": 1463583508, "answer_id": 37303339, "question_id": 37301759, "link": "https://stackoverflow.com/questions/37301759/macro-vba-code-to-select-a-row-x-row-below-the-one-selected/37303339#37303339", "title": "Macro VBA code to select a row X row below the one selected", "body": "<pre><code>Dim i As Integer\n\nRowSelected1 = InputBox(\"Enter row Jan\")\nRows(RowSelected1).Select\n\nFor i = 1 to 11\nRowselected1 = Rowselected1 + 44\n'Do whatever you want to do using Rowselected1 to refer to the row\nNext i\n</code></pre>\n\n<p>Alternatively you can use Offset in a loop over the months:</p>\n\n<pre><code>ActiveCell.Offset(44,0).Select\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6351368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02aca0b56b0516d8788f81a56d923f9a?s=128&d=identicon&r=PG&f=1", "display_name": "MorganeB", "link": "https://stackoverflow.com/users/6351368/morganeb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2835, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1463584736, "creation_date": 1463579746, "last_edit_date": 1463584736, "question_id": 37301759, "link": "https://stackoverflow.com/questions/37301759/macro-vba-code-to-select-a-row-x-row-below-the-one-selected", "title": "Macro VBA code to select a row X row below the one selected", "body": "<p>I need your help.</p>\n\n<p>I have a worksheet to update from another one.\nBasically is it all the months and the rows are moving from a month to a month because same month LY disappear and same month next year is a rota.\nHowever on this worksheet the format is fixed depending it is 28 or 31 days per month.</p>\n\n<p>so I have a macro asking to enter the row number for Jan :</p>\n\n<pre><code> RowSelected1 = InputBox(\"Enter row Jan\")\n Rows(RowSelected1).Select\n Range(\"B\" &amp; ActiveCell.Row &amp; \":DJ\" &amp; ActiveCell.Row).Select\n</code></pre>\n\n<p>But instead to do that for every month, I would like from RowSelected1 (January) to count 44 rows and copy this 44th row with the same code as above.</p>\n\n<p>And then count again 44 and copy </p>\n\n<p>etc etc</p>\n\n<p>Do you have anything to help me on that?</p>\n\n<p>Many thanks\nM.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 2, "creation_date": 1463755077, "post_id": 37301701, "comment_id": 62215100, "body": "You need to provide some additional information if you&#39;re looking for a solution. What&#39;s the code? What happens if you don&#39;t run the print area part of the code? Does it happen on every machine? What about different versions of excel?"}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1463940796, "post_id": 37301701, "comment_id": 62266959, "body": "Can you post your code so we can see what is going on?  There may be an issue with the opening or losing of the workbooks.  You can try setting the activePrinter or the the paperSize something like this  <code>ActiveWorkbook.Sheets(&quot;Name&quot;).PageSetup.PaperSize = xlPaperLegal</code>"}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1464083874, "post_id": 37301701, "comment_id": 62327111, "body": "Perhaps you can check the Names collection at both workbook and worksheet level <i>after</i> you&#39;ve run the VBA. If you find there are multiple Print_Area names or any other weird Name entries then that might be your culprit. The giveaway is that the problem is eliminated by restarting Excel which suggests that Names from the workbooks you iterate through in the process are polluting your Names collection in the main workbook that has the Print Preview problem."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2299169"}, "edited": false, "score": 0, "creation_date": 1464095100, "post_id": 37301701, "comment_id": 62335121, "body": "As you found the piece of code causing the trouble, why don&#39;t you try commenting just parts of it to see which code line is giving the headache?"}, {"owner": {"reputation": 717, "user_id": 5363379, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a0abd0a1495ff633ee9f3c0d06d50c6c?s=128&d=identicon&r=PG&f=1", "display_name": "tjb1", "link": "https://stackoverflow.com/users/5363379/tjb1"}, "edited": false, "score": 2, "creation_date": 1464095416, "post_id": 37301701, "comment_id": 62335414, "body": "The line causing the issue is this <code>Selection.AutoFill Destination:=Range(Cells(2, &quot;BA&quot;), Cells(lastrow, &quot;BC&quot;)), Type:=xlFillDefault</code>"}, {"owner": {"reputation": 717, "user_id": 5363379, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a0abd0a1495ff633ee9f3c0d06d50c6c?s=128&d=identicon&r=PG&f=1", "display_name": "tjb1", "link": "https://stackoverflow.com/users/5363379/tjb1"}, "edited": false, "score": 0, "creation_date": 1464099193, "post_id": 37301701, "comment_id": 62338250, "body": "Ok the main culprit here seems to be this code <code>=SUMIFS(BA:BA,B:B,BF2,D:D,BH2)</code> that is filled in column BC.  Print preview works fine if that is set to 0.  The odd thing is that the formula doesn&#39;t remain all the way to end, the last sub that runs copies everything and pastes values to remove the formula so the values don&#39;t change when working with the data."}, {"owner": {"reputation": 717, "user_id": 5363379, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a0abd0a1495ff633ee9f3c0d06d50c6c?s=128&d=identicon&r=PG&f=1", "display_name": "tjb1", "link": "https://stackoverflow.com/users/5363379/tjb1"}, "edited": false, "score": 2, "creation_date": 1464102835, "post_id": 37301701, "comment_id": 62340942, "body": "Ok, it seems any formula put into column &quot;BC&quot; prevents Print Preview from working and causes me to get the message &quot;Microsoft Excel has stopped working&quot; when I close the workbook.  I&#39;ve tried moving that formula to &quot;BB&quot;, deleting all further references to the formula in the code and nothing seems to work.  I&#39;ve also tried rebuilding the workbook as new.  Even worse, if I step through each sub then Print Preview works fine but if I just run it without breaks then it doesn&#39;t.  Think it&#39;s time to give up on this issue..."}], "answers": [{"comments": [{"owner": {"reputation": 717, "user_id": 5363379, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a0abd0a1495ff633ee9f3c0d06d50c6c?s=128&d=identicon&r=PG&f=1", "display_name": "tjb1", "link": "https://stackoverflow.com/users/5363379/tjb1"}, "edited": false, "score": 0, "creation_date": 1463844103, "post_id": 37352634, "comment_id": 62242489, "body": "I will give the calculation settings a try Monday.  I know this issue happens before saving and after using save as.  The document will still print if you click print even with the display/paper size failing."}, {"owner": {"reputation": 717, "user_id": 5363379, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a0abd0a1495ff633ee9f3c0d06d50c6c?s=128&d=identicon&r=PG&f=1", "display_name": "tjb1", "link": "https://stackoverflow.com/users/5363379/tjb1"}, "edited": false, "score": 0, "creation_date": 1464089344, "post_id": 37352634, "comment_id": 62330857, "body": "Adding this to each sheet did not fix it unfortunately."}], "tags": [], "owner": {"reputation": 455, "user_id": 6282596, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7646135fdc5025d023566a59d70f7fa8?s=128&d=identicon&r=PG&f=1", "display_name": "Weasemunk", "link": "https://stackoverflow.com/users/6282596/weasemunk"}, "is_accepted": false, "score": 0, "last_activity_date": 1463765641, "creation_date": 1463765641, "answer_id": 37352634, "question_id": 37301701, "link": "https://stackoverflow.com/questions/37301701/print-preview-issues-after-running-large-amount-of-vba/37352634#37352634", "title": "Print Preview issues after running large amount of VBA", "body": "<p>I believe you're looking for some type of refresh action that can re-sync the preview display with the data on the sheet. You might want to try this at the end:</p>\n\n<pre><code>ActiveSheet.EnableCalculation = False  \nActiveSheet.EnableCalculation = True\n</code></pre>\n\n<p>If that doesn't work, see if manually saving fixes the issue. You can try calling <code>Application.Save</code> at the end.</p>\n"}, {"comments": [{"owner": {"reputation": 717, "user_id": 5363379, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a0abd0a1495ff633ee9f3c0d06d50c6c?s=128&d=identicon&r=PG&f=1", "display_name": "tjb1", "link": "https://stackoverflow.com/users/5363379/tjb1"}, "edited": false, "score": 0, "creation_date": 1463844374, "post_id": 37359703, "comment_id": 62242593, "body": "I will look into adding the print preview VBA.  Right now the sheets that are usually printed are generated from a list so I use a template that is copied.  It creates on average 1-12 sheets from the list, copies data from an older workbook, loops through around 3,000 rows to populate the created sheets then loops through around 40,000 rows to add more information to the sheets.  It would probably benefit from a rewrite now that the feature creep has ended but I don&#39;t see myself having the time for that..."}, {"owner": {"reputation": 699, "user_id": 6301880, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10209513398494710/picture?type=large", "display_name": "Andy", "link": "https://stackoverflow.com/users/6301880/andy"}, "reply_to_user": {"reputation": 717, "user_id": 5363379, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a0abd0a1495ff633ee9f3c0d06d50c6c?s=128&d=identicon&r=PG&f=1", "display_name": "tjb1", "link": "https://stackoverflow.com/users/5363379/tjb1"}, "edited": false, "score": 0, "creation_date": 1463855187, "post_id": 37359703, "comment_id": 62245983, "body": "Agreed @tjb1, that time is a rare resource. What I would do in your situation is not attempt a whole rewrite, but start with a testable copy of the original code saved to your desktop (vice a network server or something). Then, try simple changes as you have time. For example, the VBA code <code>ActiveSheet.PrintPreview</code> relies on an older, less memory intensive Print Preview, which may be enough to fix the glitch."}], "tags": [], "owner": {"reputation": 699, "user_id": 6301880, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/10209513398494710/picture?type=large", "display_name": "Andy", "link": "https://stackoverflow.com/users/6301880/andy"}, "is_accepted": false, "score": 0, "last_activity_date": 1463812445, "creation_date": 1463812445, "answer_id": 37359703, "question_id": 37301701, "link": "https://stackoverflow.com/questions/37301701/print-preview-issues-after-running-large-amount-of-vba/37359703#37359703", "title": "Print Preview issues after running large amount of VBA", "body": "<p>\"Print preview occurs automatically when you choose File --> Print. Another option is to use the Page Layout view (the icon on the right side of the status bar). To get the old-style print preview, you need to use VBA. The following statement displays a print preview of the active sheet: <code>ActiveSheet.PrintPreview</code> \"</p>\n\n<p>Quoted from <strong><em>Microsoft Excel 2013 Power Programming with VBA</em></strong> by John Walkenbach, pages 956-957.</p>\n\n<p>That being said, I tested your issue above by recording a relatively complex macro that creates a new sheet, performs 25 automatic actions, and shows a print preview, then closes the print preview when I click OK on a MsgBox. I iterated the program to do this 1000 times. I never had an issue with the PrintPreview. </p>\n"}, {"comments": [{"owner": {"reputation": 630, "user_id": 2226467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qy8wF.jpg?s=128&g=1", "display_name": "Mukesh Adhvaryu", "link": "https://stackoverflow.com/users/2226467/mukesh-adhvaryu"}, "edited": false, "score": 0, "creation_date": 1464343366, "post_id": 37418425, "comment_id": 62457949, "body": "Alas you have discovered horrors of doevents. I am not saying it 100% evil but in most cases it creates more problems than it solves. Upvote for knowing doevents"}], "tags": [], "owner": {"reputation": 717, "user_id": 5363379, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a0abd0a1495ff633ee9f3c0d06d50c6c?s=128&d=identicon&r=PG&f=1", "display_name": "tjb1", "link": "https://stackoverflow.com/users/5363379/tjb1"}, "is_accepted": true, "score": 3, "last_activity_date": 1464105195, "creation_date": 1464105195, "answer_id": 37418425, "question_id": 37301701, "link": "https://stackoverflow.com/questions/37301701/print-preview-issues-after-running-large-amount-of-vba/37418425#37418425", "title": "Print Preview issues after running large amount of VBA", "body": "<p>It seems that removing all instances of <code>DoEvents</code> has fixed the issue...</p>\n\n<p>Print Preview works correctly and Excel does not crash when exiting the workbook anymore.</p>\n"}, {"comments": [{"owner": {"reputation": 717, "user_id": 5363379, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a0abd0a1495ff633ee9f3c0d06d50c6c?s=128&d=identicon&r=PG&f=1", "display_name": "tjb1", "link": "https://stackoverflow.com/users/5363379/tjb1"}, "edited": false, "score": 0, "creation_date": 1464197879, "post_id": 37425322, "comment_id": 62390440, "body": "I was able to fix it yesterday by removing all <code>DoEvents</code> from the code.  I don&#39;t know if they were in bad spots or what the issue was but removing them restored everything back to normal.  I did play around quite a bit with that section of code and still had issues even with removing error handling all together."}], "tags": [], "owner": {"reputation": 1024, "user_id": 6040823, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/DDCAB.jpg?s=128&g=1", "display_name": "Jason Brady", "link": "https://stackoverflow.com/users/6040823/jason-brady"}, "is_accepted": false, "score": 0, "last_activity_date": 1464131188, "creation_date": 1464131188, "answer_id": 37425322, "question_id": 37301701, "link": "https://stackoverflow.com/questions/37301701/print-preview-issues-after-running-large-amount-of-vba/37425322#37425322", "title": "Print Preview issues after running large amount of VBA", "body": "<p>Its kind of a shot in the dark, but I tried cleaning up your code a little bit. See if that has any affect at all.</p>\n\n<pre><code>Sub Test()\n\nDim wb1 As Workbook, wb2 As Workbook\nDim ws1 As Worksheet, ws2 As Worksheet\nDim isWS As Boolean\n\nOn Error GoTo sub_err\n\nSet wb1 = Workbooks.Open(Filename)\nSet wb2 = ThisWorkbook\n\nFor i = LBound(sArray) To UBound(sArray) 'Loops through array, copies available data from last report\n    ShtName = sArray(i, 0)\n    isWS = True\n    Set ws1 = wb1.Sheets(ShtName)\n\n    If isWS Then\n        Set ws2 = wb2.Sheets(ShtName)\n\n        ws1.Columns(\"A:U\").Copy\n        ws2.Columns(\"BE:BV\").PasteSpecial xlPasteValues\n        Application.CutCopyMode = False\n        lastrow = ws2.Cells(ws2.Rows.Count, \"BE\").End(xlUp).Row\n        ws2.Range(\"BA2:BC2\").AutoFill Destination:=ws2.Range(ws2.Cells(2, \"BA\"), ws2.Cells(lastrow, \"BC\")), Type:=xlFillDefault\n    End If\n    DoEvents\nNext i\n\nwb1.Close False\n\nws2.Activate\n\nsub_exit:\nExit Sub\n\nsub_err:\nIf Err.Number = 9 Then\n    isWS = False\n    Resume Next\nElse\n    MsgBox \"Error: \" &amp; Err.Number &amp; vbNewLine &amp; Err.Description\n    Resume sub_exit\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>The big thing I did was split off your error handling, this way it only resumes next when you don't find the sheet in wb1 and all other errors (none error 9 errors) will still show your error message.</p>\n\n<p>I also made sure all your Range(), Cells(), and Columns() were referencing the correct sheet (just incase excel is getting confused) and I assumed the active sheet was the correct sheet, but you may want to verify this in the code to make sure it's doing the correct thing in the correct sheet.</p>\n\n<p>Now the copy code only runs if <code>isWS = true</code>, and it will always be true unless an error 9 code is thrown. The only thing I didn't know was if wb2 would always have a sheet name equal to <code>ShtName</code> but I'm guessing it will since it's inside your if <code>err.number = 0</code></p>\n\n<p>I'm not sure if this will change anything for you, but I'd be curious to hear your results other way.</p>\n"}], "owner": {"reputation": 717, "user_id": 5363379, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a0abd0a1495ff633ee9f3c0d06d50c6c?s=128&d=identicon&r=PG&f=1", "display_name": "tjb1", "link": "https://stackoverflow.com/users/5363379/tjb1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2091, "favorite_count": 0, "accepted_answer_id": 37418425, "answer_count": 4, "score": 7, "last_activity_date": 1464131188, "creation_date": 1463579616, "last_edit_date": 1531161705, "question_id": 37301701, "link": "https://stackoverflow.com/questions/37301701/print-preview-issues-after-running-large-amount-of-vba", "title": "Print Preview issues after running large amount of VBA", "body": "<p>I have an Excel workbook in which almost everything is automated.  It opens other workbooks, copies data from them, closes them and then loops through the data several times to generate reports that we print and use.  Almost every time after running all the VBA and then trying to print, print preview gets stuck either finding the printer or loading page sizes as seen in the picture.  Closing Excel and reopening the document restores print preview to normal functionality.  The only thing related to printing that the VBA does is change the print area.  I have not had this issue with any other documents that run VBA.  Is this just a bug or possibly something in the code?</p>\n\n<p><a href=\"https://i.stack.imgur.com/wLq5c.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wLq5c.png\" alt=\"Issue\"></a></p>\n\n<p>This is the code that causes print preview to fail to load in some way.  If I skip this section then it works as intended...  I would like to have this code function in some way as it's still needed.</p>\n\n<pre><code>    Set wb1 = Workbooks.Open(FileName)\n    Set wb2 = ThisWorkbook\n\n    For i = LBound(sArray) To UBound(sArray) 'Loops through array, copies available data from last report\n        ShtName = sArray(i, 0)\n        On Error Resume Next\n            wb1.Sheets(ShtName).Activate\n            If Err.Number = 0 Then\n                wb1.Sheets(ShtName).Activate\n                Columns(\"A:U\").Copy\n                wb2.Sheets(ShtName).Activate\n                Columns(\"BE:BV\").Select\n                Selection.PasteSpecial xlPasteValues\n                Application.CutCopyMode = False\n                lastrow = Cells(Rows.Count, \"BE\").End(xlUp).Row\n                Range(\"BA2:BC2\").Select\n                Selection.AutoFill Destination:=Range(Cells(2, \"BA\"), Cells(lastrow, \"BC\")), Type:=xlFillDefault\n            End If\n        On Error GoTo 0\n\n        DoEvents\n\n    Next i\n\n    wb1.Close False\n\n    Sheet2.Activate\n</code></pre>\n\n<p>I've tried commenting out \"On Error Resume Next\", \"On Error Goto 0\", \"If...\", \"End If\", and \"DoEvents\".  Print Preview still fails with those removed and just doing the copy and paste from the previous sheet. </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6318608, "user_type": "registered", "profile_image": "https://graph.facebook.com/10101004412396355/picture?type=large", "display_name": "Alex Kwok", "link": "https://stackoverflow.com/users/6318608/alex-kwok"}, "edited": false, "score": 0, "creation_date": 1463630565, "post_id": 37301853, "comment_id": 62148065, "body": "Tried but the Data Link Properties dialog box still pops up.  Closing the box will trigger &quot;Microsoft Visual Basic for Applications - Run-time error &#39;1004&#39;: Application-defined or object-defined error&quot;"}], "tags": [], "owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "is_accepted": false, "score": 0, "last_activity_date": 1463579985, "creation_date": 1463579985, "answer_id": 37301853, "question_id": 37301602, "link": "https://stackoverflow.com/questions/37301602/excel-vba-workbook-open-loop-stopped-by-data-link-properties-box/37301853#37301853", "title": "Excel VBA workbook.open loop stopped by Data Link Properties box", "body": "<p>Try adding the following qualifier to your workbooks.open statement:</p>\n\n<p><code>Application.Workbooks.Open Filename:=\"yourfilehere.xlsx\", UpdateLinks:=False</code></p>\n"}], "owner": {"reputation": 1, "user_id": 6318608, "user_type": "registered", "profile_image": "https://graph.facebook.com/10101004412396355/picture?type=large", "display_name": "Alex Kwok", "link": "https://stackoverflow.com/users/6318608/alex-kwok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 382, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1463579985, "creation_date": 1463579379, "last_edit_date": 1495541763, "question_id": 37301602, "link": "https://stackoverflow.com/questions/37301602/excel-vba-workbook-open-loop-stopped-by-data-link-properties-box", "title": "Excel VBA workbook.open loop stopped by Data Link Properties box", "body": "<p>I'm trying to use VBA to combine 184 Excel workbooks (8 worksheets each) into one master workbook (with 8 worksheets) by copying the non-empty rows (except header rows) on worksheets of the 184 workbooks and pasting them onto corresponding worksheets of the master workbook. </p>\n\n<p>I try to do this with a \"for loop\" and \"workbook.open()\", but the Data Link Properties dialog box pops up in the middle of the looping process (after it has opened the 170th workbook), stopping the automation.  </p>\n\n<p>I found a <a href=\"https://stackoverflow.com/questions/30828540/suppressing-the-data-link-properties-dialog-box-in-excel-using-vba\">post</a> facing similar situation, but no good answer was given.  Would be grateful if anyone could enlighten me with solution. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 461, "user_id": 6933790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef7fb7c460676595845863a65a6461b?s=128&d=identicon&r=PG&f=1", "display_name": "J Reid", "link": "https://stackoverflow.com/users/6933790/j-reid"}, "edited": false, "score": 0, "creation_date": 1554833823, "post_id": 37301441, "comment_id": 97894184, "body": "Found an answer here <a href=\"https://superuser.com/questions/1347262/how-can-i-modify-the-applies-to-property-of-a-cells-conditional-formatting-ru\" title=\"how can i modify the applies to property of a cells conditional formatting ru\">superuser.com/questions/1347262/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 558, "user_id": 6350909, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/YP243.jpg?s=128&g=1", "display_name": "twgardner2", "link": "https://stackoverflow.com/users/6350909/twgardner2"}, "edited": false, "score": 0, "creation_date": 1463607196, "post_id": 37301728, "comment_id": 62141942, "body": "I read Dick Kusleika&#39;s post, which is pretty good stuff. This is a tough one. Unfortunately, the conditional formatting I&#39;m working on is a color scale, which he discusses doesn&#39;t work with the code above, as it is a separate object (ColorScale vs. FormatConditions). If I get around to it, I may try to convert your code to work with ColorScale."}], "tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": false, "score": 0, "last_activity_date": 1463579670, "creation_date": 1463579670, "answer_id": 37301728, "question_id": 37301441, "link": "https://stackoverflow.com/questions/37301441/use-vba-to-update-conditional-formatting-ranges/37301728#37301728", "title": "Use VBA to Update Conditional Formatting Ranges?", "body": "<p>This is a little convoluted since there isn't really any great way to loop through <code>formatconditions</code> in a sheet. But, you can loop through specialcells and then loop through their <code>formatconditions</code> and dig in from there:</p>\n\n<pre><code>Sub test()\n    Dim ws As Worksheet\n    Set ws = ThisWorkbook.Sheets(\"Sheet1\")\n\n    Dim rngCell As Range\n    Dim lng As Long\n\n    For Each rngCell In ws.Cells.SpecialCells(xlCellTypeAllFormatConditions).Cells\n        For lng = 1 To rngCell.FormatConditions.Count\n            On Error Resume Next\n            Debug.Print rngCell.FormatConditions(lng).Formula1, rngCell.FormatConditions(lng).AppliesTo.Address\n        Next lng\n    Next rngCell\nEnd Sub\n</code></pre>\n\n<p>I poached the <code>specialcells()</code> idea from <a href=\"http://dailydoseofexcel.com/archives/2010/04/16/listing-format-conditions/\" rel=\"nofollow\">Dick Kusleika's excellent post on this very subject</a> at dailydoseofexcel.com blog.</p>\n"}, {"tags": [], "owner": {"reputation": 185, "user_id": 3433702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rS4c5.jpg?s=128&g=1", "display_name": "Vijay Dodamani", "link": "https://stackoverflow.com/users/3433702/vijay-dodamani"}, "is_accepted": false, "score": 0, "last_activity_date": 1541161206, "creation_date": 1541161206, "answer_id": 53118521, "question_id": 37301441, "link": "https://stackoverflow.com/questions/37301441/use-vba-to-update-conditional-formatting-ranges/53118521#53118521", "title": "Use VBA to Update Conditional Formatting Ranges?", "body": "<p>You can use code as below: Here Based on condition Highlighted the row in yellow color. You can use your formatting</p>\n\n<pre><code>LastColumnARows = WB_Source.Sheets(SheetName.Name).range(\"A\" &amp; Rows.Count).End(xlUp).Row  \n\n                    With WB_Source.Sheets(SheetName.Name)\n\n                        For i = 2 To LastColumnARows\n                            If .range(\"A\" &amp; i).Value &gt; [Condition] Then\n                                With .range(\"A\" &amp; i &amp; \":E\" &amp; i)\n                                    .Interior.Color = vbYellow\n                                    .Font.Color = vbBlack\n                                End With\n                            End If\n                        Next i\n                    End With\n</code></pre>\n"}], "owner": {"reputation": 558, "user_id": 6350909, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/YP243.jpg?s=128&g=1", "display_name": "twgardner2", "link": "https://stackoverflow.com/users/6350909/twgardner2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3052, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1541161206, "creation_date": 1463578947, "last_edit_date": 1531164843, "question_id": 37301441, "link": "https://stackoverflow.com/questions/37301441/use-vba-to-update-conditional-formatting-ranges", "title": "Use VBA to Update Conditional Formatting Ranges?", "body": "<p>I'm trying to update the conditional formatting range for about 30 rows of data on a worksheet. Every month I update the data and I want to run a macro to adjust the ranges to incorporate the new month. I've already done this for my charts by updating the end of the series ranges by looping through the ChartObjects and SeriesCollection.</p>\n\n<p>To do this on conditional formatting, everything I've found requires hardcoding a range (either a cell reference or a named range), e.g.:</p>\n\n<pre><code>With Worksheets(1).Range(\"e1:e10\").FormatConditions(1) \n</code></pre>\n\n<p>I'd prefer to just loop through the collection of conditional formatting for the worksheet, but I can't find any evidence of this collection existing in the Excel VBA Object Model. Am I missing something here?</p>\n"}, {"tags": ["excel", "runtime-error", "vba"], "comments": [{"owner": {"reputation": 2058, "user_id": 4721734, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/514054622e745c08541d6b1674b8ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "M&#225;t&#233; Juh&#225;sz", "link": "https://stackoverflow.com/users/4721734/m%c3%a1t%c3%a9-juh%c3%a1sz"}, "edited": false, "score": 0, "creation_date": 1463581126, "post_id": 37301330, "comment_id": 62126607, "body": "if you have any time this type of problem you should paste the formula manually to the cell to see whether it&#39;s correct. That&#39;s the easiest way to find the error in it."}], "answers": [{"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 0, "last_activity_date": 1463580635, "creation_date": 1463580635, "answer_id": 37302156, "question_id": 37301330, "link": "https://stackoverflow.com/questions/37301330/runtime-error-1004-when-putting-formula-into-cell/37302156#37302156", "title": "Runtime error 1004 when putting formula into cell", "body": "<p>It appears you left in part of the LEFT statement. You need:</p>\n\n<pre><code>ActiveCell.formular1c1 = _\n    \"=IF(IsError(VLOOKUP(RC[3],TransactionTypes!C:C[1],2,0)),\"\"MISC\"\",IF(ISNUMBER(SEARCH(\"\"AX\"\",RC[2])),\"\"Amex\"\",VLOOKUP(RC[3],TransactionTypes!C:C[1],2,0)))\"\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4027274, "user_type": "registered", "profile_image": "https://graph.facebook.com/776793820/picture?type=large", "display_name": "Peter Eden", "link": "https://stackoverflow.com/users/4027274/peter-eden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 143, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1463580635, "creation_date": 1463578632, "last_edit_date": 1531161705, "question_id": 37301330, "link": "https://stackoverflow.com/questions/37301330/runtime-error-1004-when-putting-formula-into-cell", "title": "Runtime error 1004 when putting formula into cell", "body": "<p>I have just changed my code where I put a formula into a cell and it now brings up Runtime error 1004 (Application defined or Object defined error).\nMy new code is:</p>\n\n<pre><code>ActiveCell.FormulaR1C1 = _\n    \"=IF(IsError(VLOOKUP(RC[3],TransactionTypes!C:C[1],2,0)),\"\"MISC\"\",IF(ISNUMBER(SEARCH(\"\"AX\"\",(RC[2],2))),\"\"Amex\"\",VLOOKUP(RC[3],TransactionTypes!C:C[1],2,0)))\"\n</code></pre>\n\n<p>The code that previously worked fine was:</p>\n\n<pre><code>'ActiveCell.FormulaR1C1 = _\n    \"=IF(IsError(VLOOKUP(RC[3],TransactionTypes!C:C[1],2,0)),\"\"MISC\"\",IF(LEFT(RC[2],2)=\"\"AX\"\",\"\"Amex\"\",VLOOKUP(RC[3],TransactionTypes!C:C[1],2,0)))\"\n</code></pre>\n\n<p>The part I changed was  IF(LEFT(RC[2],2)=\"\"AX\"\",\"\"Amex\"\"  into IF(ISNUMBER(SEARCH(\"\"AX\"\",(RC[2],2))),\"\"Amex\"\"   but I can't see why this is throwing up the error.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 6258179, "user_type": "registered", "accept_rate": 77, "profile_image": "https://graph.facebook.com/717193235050415/picture?type=large", "display_name": "Joseph Lin", "link": "https://stackoverflow.com/users/6258179/joseph-lin"}, "edited": false, "score": 0, "creation_date": 1463579163, "post_id": 37301473, "comment_id": 62125120, "body": "It is still saying rw1 is a mismatch"}, {"owner": {"reputation": 79, "user_id": 6258179, "user_type": "registered", "accept_rate": 77, "profile_image": "https://graph.facebook.com/717193235050415/picture?type=large", "display_name": "Joseph Lin", "link": "https://stackoverflow.com/users/6258179/joseph-lin"}, "edited": false, "score": 0, "creation_date": 1463579951, "post_id": 37301473, "comment_id": 62125738, "body": "Thank you for responding me so quick. now it is saying the LastRow = Cells Sentence is a type mismatch now."}, {"owner": {"reputation": 742, "user_id": 4830209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f36c805d87474402708042645313a454?s=128&d=identicon&r=PG&f=1", "display_name": "Sun", "link": "https://stackoverflow.com/users/4830209/sun"}, "reply_to_user": {"reputation": 79, "user_id": 6258179, "user_type": "registered", "accept_rate": 77, "profile_image": "https://graph.facebook.com/717193235050415/picture?type=large", "display_name": "Joseph Lin", "link": "https://stackoverflow.com/users/6258179/joseph-lin"}, "edited": false, "score": 0, "creation_date": 1463580098, "post_id": 37301473, "comment_id": 62125821, "body": "What is it supposed to be the lastrow of? Sheet Database? Also, what is Count?"}, {"owner": {"reputation": 79, "user_id": 6258179, "user_type": "registered", "accept_rate": 77, "profile_image": "https://graph.facebook.com/717193235050415/picture?type=large", "display_name": "Joseph Lin", "link": "https://stackoverflow.com/users/6258179/joseph-lin"}, "edited": false, "score": 0, "creation_date": 1463580373, "post_id": 37301473, "comment_id": 62126026, "body": "Yes, it supposed to read until the last row of database within column P to CO, I realized the contradiction of r2 and lastRow there. The Count is just something I copy from the Internet, I am very new to VBA."}, {"owner": {"reputation": 742, "user_id": 4830209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f36c805d87474402708042645313a454?s=128&d=identicon&r=PG&f=1", "display_name": "Sun", "link": "https://stackoverflow.com/users/4830209/sun"}, "reply_to_user": {"reputation": 79, "user_id": 6258179, "user_type": "registered", "accept_rate": 77, "profile_image": "https://graph.facebook.com/717193235050415/picture?type=large", "display_name": "Joseph Lin", "link": "https://stackoverflow.com/users/6258179/joseph-lin"}, "edited": false, "score": 0, "creation_date": 1463580495, "post_id": 37301473, "comment_id": 62126100, "body": "I guess in your case you can just have <code>lastrow = 5000</code> then, and also delete the row <code>Loop</code>"}, {"owner": {"reputation": 79, "user_id": 6258179, "user_type": "registered", "accept_rate": 77, "profile_image": "https://graph.facebook.com/717193235050415/picture?type=large", "display_name": "Joseph Lin", "link": "https://stackoverflow.com/users/6258179/joseph-lin"}, "edited": false, "score": 0, "creation_date": 1463580902, "post_id": 37301473, "comment_id": 62126430, "body": "Thanks, it is now running, but it seems like it takes a long time."}, {"owner": {"reputation": 742, "user_id": 4830209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f36c805d87474402708042645313a454?s=128&d=identicon&r=PG&f=1", "display_name": "Sun", "link": "https://stackoverflow.com/users/4830209/sun"}, "reply_to_user": {"reputation": 79, "user_id": 6258179, "user_type": "registered", "accept_rate": 77, "profile_image": "https://graph.facebook.com/717193235050415/picture?type=large", "display_name": "Joseph Lin", "link": "https://stackoverflow.com/users/6258179/joseph-lin"}, "edited": false, "score": 0, "creation_date": 1463581428, "post_id": 37301473, "comment_id": 62126824, "body": "Well, I would think that this is mostly due to the fact that you use the .copy method. It would be better to use something like <code>Workbook1.Worksheets(&quot;ABC&quot;).Range(&quot;A1:A10&quot;).Value = Workbook2.Worksheets(&quot;DEF&quot;).Range(&quot;A3:A13&quot;).Value</code>. This directly sets the values instead of first copying then pasting the data. If that does not speed it up, try adding <code>rw1 = 0</code> before this row: <code>rw1 = r1.FindNext().Row</code>, but this one is just a guess. I can&#39;t really test it now."}, {"owner": {"reputation": 79, "user_id": 6258179, "user_type": "registered", "accept_rate": 77, "profile_image": "https://graph.facebook.com/717193235050415/picture?type=large", "display_name": "Joseph Lin", "link": "https://stackoverflow.com/users/6258179/joseph-lin"}, "edited": false, "score": 0, "creation_date": 1463582193, "post_id": 37301473, "comment_id": 62127416, "body": "I have change the copy sentence to value, however, it is still very slow, I updated the code up there. Can you check if there is anyway to optimize the architecture?"}, {"owner": {"reputation": 742, "user_id": 4830209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f36c805d87474402708042645313a454?s=128&d=identicon&r=PG&f=1", "display_name": "Sun", "link": "https://stackoverflow.com/users/4830209/sun"}, "reply_to_user": {"reputation": 79, "user_id": 6258179, "user_type": "registered", "accept_rate": 77, "profile_image": "https://graph.facebook.com/717193235050415/picture?type=large", "display_name": "Joseph Lin", "link": "https://stackoverflow.com/users/6258179/joseph-lin"}, "edited": false, "score": 0, "creation_date": 1463582542, "post_id": 37301473, "comment_id": 62127675, "body": "first, you need to switch it around to <code>r3.Value = sheets(&quot;database&quot;)......</code> because you want to write into r3. What I do not get is, why do you loop through all rows in Database, but do not update your r3-Range? the text you are looking for, does it only exist once in database? If so, you don&#39;t need the for-loop. another thing, you should define r3 as range(&quot;F2:T2&quot;)"}, {"owner": {"reputation": 79, "user_id": 6258179, "user_type": "registered", "accept_rate": 77, "profile_image": "https://graph.facebook.com/717193235050415/picture?type=large", "display_name": "Joseph Lin", "link": "https://stackoverflow.com/users/6258179/joseph-lin"}, "edited": false, "score": 0, "creation_date": 1463582762, "post_id": 37301473, "comment_id": 62127868, "body": "The text string that I am looking for only exist within the range of P:CO in sheet database. So you meant I should delete the for and lastrow statement? And how do I update the r3 range?"}, {"owner": {"reputation": 742, "user_id": 4830209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f36c805d87474402708042645313a454?s=128&d=identicon&r=PG&f=1", "display_name": "Sun", "link": "https://stackoverflow.com/users/4830209/sun"}, "reply_to_user": {"reputation": 79, "user_id": 6258179, "user_type": "registered", "accept_rate": 77, "profile_image": "https://graph.facebook.com/717193235050415/picture?type=large", "display_name": "Joseph Lin", "link": "https://stackoverflow.com/users/6258179/joseph-lin"}, "edited": false, "score": 0, "creation_date": 1463584663, "post_id": 37301473, "comment_id": 62129374, "body": "No don&#39;t touch the set r3 above, but set it again in the for loop."}, {"owner": {"reputation": 79, "user_id": 6258179, "user_type": "registered", "accept_rate": 77, "profile_image": "https://graph.facebook.com/717193235050415/picture?type=large", "display_name": "Joseph Lin", "link": "https://stackoverflow.com/users/6258179/joseph-lin"}, "edited": false, "score": 0, "creation_date": 1463585077, "post_id": 37301473, "comment_id": 62129659, "body": "Please check my latest edit, I am not quite sure this is right, the result is not what I expected, it only return value in F2."}, {"owner": {"reputation": 742, "user_id": 4830209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f36c805d87474402708042645313a454?s=128&d=identicon&r=PG&f=1", "display_name": "Sun", "link": "https://stackoverflow.com/users/4830209/sun"}, "reply_to_user": {"reputation": 79, "user_id": 6258179, "user_type": "registered", "accept_rate": 77, "profile_image": "https://graph.facebook.com/717193235050415/picture?type=large", "display_name": "Joseph Lin", "link": "https://stackoverflow.com/users/6258179/joseph-lin"}, "edited": false, "score": 0, "creation_date": 1463585364, "post_id": 37301473, "comment_id": 62129880, "body": "Ok first, the first &#39;set r3&#39;, change the range from F2 to F2:T2, second delete the for/next loop. Thirdly, replace the &#39;if rw1 &lt;&gt;0 then&#39; by &#39;do while rw1 &lt;&gt;0&#39;, and replace the &#39;end if&#39; by &#39;loop&#39;"}, {"owner": {"reputation": 79, "user_id": 6258179, "user_type": "registered", "accept_rate": 77, "profile_image": "https://graph.facebook.com/717193235050415/picture?type=large", "display_name": "Joseph Lin", "link": "https://stackoverflow.com/users/6258179/joseph-lin"}, "edited": false, "score": 0, "creation_date": 1463585830, "post_id": 37301473, "comment_id": 62130236, "body": "Please check update, I don&#39;t think the loop is working, no it only copies data from Column A in Database to F2:T2 in Reports. And in this case what is the point of defining last row."}, {"owner": {"reputation": 742, "user_id": 4830209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f36c805d87474402708042645313a454?s=128&d=identicon&r=PG&f=1", "display_name": "Sun", "link": "https://stackoverflow.com/users/4830209/sun"}, "reply_to_user": {"reputation": 79, "user_id": 6258179, "user_type": "registered", "accept_rate": 77, "profile_image": "https://graph.facebook.com/717193235050415/picture?type=large", "display_name": "Joseph Lin", "link": "https://stackoverflow.com/users/6258179/joseph-lin"}, "edited": false, "score": 0, "creation_date": 1463586098, "post_id": 37301473, "comment_id": 62130425, "body": "Ok I&#39;ll have to take a look at it on the PC later, and the lastrow is not needed anymore"}, {"owner": {"reputation": 79, "user_id": 6258179, "user_type": "registered", "accept_rate": 77, "profile_image": "https://graph.facebook.com/717193235050415/picture?type=large", "display_name": "Joseph Lin", "link": "https://stackoverflow.com/users/6258179/joseph-lin"}, "edited": false, "score": 0, "creation_date": 1463586244, "post_id": 37301473, "comment_id": 62130507, "body": "Thank you so much! I think the problem might be the set r3 in the loop sentence,"}, {"owner": {"reputation": 742, "user_id": 4830209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f36c805d87474402708042645313a454?s=128&d=identicon&r=PG&f=1", "display_name": "Sun", "link": "https://stackoverflow.com/users/4830209/sun"}, "reply_to_user": {"reputation": 79, "user_id": 6258179, "user_type": "registered", "accept_rate": 77, "profile_image": "https://graph.facebook.com/717193235050415/picture?type=large", "display_name": "Joseph Lin", "link": "https://stackoverflow.com/users/6258179/joseph-lin"}, "edited": false, "score": 0, "creation_date": 1463596280, "post_id": 37301473, "comment_id": 62136357, "body": "Sorry I won&#39;t make it today anymore, but what you can try is declare one more range variable (eg tmpRng) and  \u02cbset tmprng = r1.find ...` , next you change <code>rw1 = tmprng.row</code>, and the line before <code>loop</code> you change to <code>tmprng = r1.findnext(tmprng)</code>. After that you insert the line <code>if not tmprng is nothing then rw1 = tmprng.row</code>"}, {"owner": {"reputation": 79, "user_id": 6258179, "user_type": "registered", "accept_rate": 77, "profile_image": "https://graph.facebook.com/717193235050415/picture?type=large", "display_name": "Joseph Lin", "link": "https://stackoverflow.com/users/6258179/joseph-lin"}, "edited": false, "score": 0, "creation_date": 1463596647, "post_id": 37301473, "comment_id": 62136574, "body": "Ok, i&#39;ll try that and let you know. Thank you still! if you got anytime to have a look of the code, I will totally appreciate that!"}, {"owner": {"reputation": 79, "user_id": 6258179, "user_type": "registered", "accept_rate": 77, "profile_image": "https://graph.facebook.com/717193235050415/picture?type=large", "display_name": "Joseph Lin", "link": "https://stackoverflow.com/users/6258179/joseph-lin"}, "edited": false, "score": 0, "creation_date": 1463625017, "post_id": 37301473, "comment_id": 62146770, "body": "it is still not working after I edited the code as you said. If you got time, please take a look at it on PC please. Now the result is just values that from A1 in sheet database copied to F:T range in sheet reports, and the loop won&#39;t stop resulting more than 10000 observation. I have to manually stop it."}, {"owner": {"reputation": 79, "user_id": 6258179, "user_type": "registered", "accept_rate": 77, "profile_image": "https://graph.facebook.com/717193235050415/picture?type=large", "display_name": "Joseph Lin", "link": "https://stackoverflow.com/users/6258179/joseph-lin"}, "edited": false, "score": 0, "creation_date": 1463669033, "post_id": 37301473, "comment_id": 62172376, "body": "Actually, there&#39;s one little thing that I forgot to mention in my question, which is how to erase the previous content before print out the contents of  other macros. I have several macros of this format, only cell changes in the searchValue sentence. I need to bounce among them, since the contents have different numbers of row, which could cause a problem. I have tried to insert clearcontents statement in the front of this code and in between the do.loop, and it just cleared everything altogether, is there any simple code that could be embedded here to achieve that? Thanks!"}, {"owner": {"reputation": 742, "user_id": 4830209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f36c805d87474402708042645313a454?s=128&d=identicon&r=PG&f=1", "display_name": "Sun", "link": "https://stackoverflow.com/users/4830209/sun"}, "reply_to_user": {"reputation": 79, "user_id": 6258179, "user_type": "registered", "accept_rate": 77, "profile_image": "https://graph.facebook.com/717193235050415/picture?type=large", "display_name": "Joseph Lin", "link": "https://stackoverflow.com/users/6258179/joseph-lin"}, "edited": false, "score": 0, "creation_date": 1463669695, "post_id": 37301473, "comment_id": 62172888, "body": "what do you mean by previous content? what area exactly do you want to clear?"}, {"owner": {"reputation": 79, "user_id": 6258179, "user_type": "registered", "accept_rate": 77, "profile_image": "https://graph.facebook.com/717193235050415/picture?type=large", "display_name": "Joseph Lin", "link": "https://stackoverflow.com/users/6258179/joseph-lin"}, "edited": false, "score": 0, "creation_date": 1463670059, "post_id": 37301473, "comment_id": 62173205, "body": "Sorry, don&#39;t mind me. It is probably because my computer was having a strike, it works now, thank you!!! I really appreciate your help!"}], "tags": [], "owner": {"reputation": 742, "user_id": 4830209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f36c805d87474402708042645313a454?s=128&d=identicon&r=PG&f=1", "display_name": "Sun", "link": "https://stackoverflow.com/users/4830209/sun"}, "is_accepted": true, "score": 1, "last_activity_date": 1463648902, "last_edit_date": 1463648902, "creation_date": 1463579028, "answer_id": 37301473, "question_id": 37301104, "link": "https://stackoverflow.com/questions/37301104/create-macro-to-find-text-string-within-a-range-and-return-data-from-matched-row/37301473#37301473", "title": "Create Macro to Find Text String Within a Range and Return Data From Matched Rows", "body": "<p><strong>Final Edit:</strong></p>\n\n<p>I forgot to check for whether that particular cell had already been found (now with FirstAddress). The infinite loop was due to the code finding the same entries over and over.</p>\n\n<p>I tested the following code, and it works for me.</p>\n\n<pre><code>Sub joseph()\n\nDim awb As Workbook\nDim cm, db, rp As Worksheet 'committees, database, reports\n\nDim tmpRng As Range\nDim firstAddress As String\nDim tmpRow As Integer\n\nDim r As Integer\n\nDim searchValue As String\n\n\n    Set awb = ThisWorkbook\n\n    With awb\n        Set cm = .Worksheets(\"Committees\")\n        Set db = .Worksheets(\"Database\")\n        Set rp = .Worksheets(\"Reports\")\n    End With\n\n    searchValue = cm.Range(\"A2\").Value\n\n    tmpRow = 0\n    r = 2\n\n    With db\n\n        Set tmpRng = .Range(\"P2:CP5000\").Find(searchValue, _\n            LookIn:=xlValues, LookAt:=xlWhole, SearchDirection:=xlNext, MatchCase:=False)\n\n        If Not tmpRng Is Nothing Then\n\n            firstAddress = tmpRng.Address\n\n            Do\n                tmpRow = tmpRng.Row\n                rp.Range(\"F\" &amp; r &amp; \":T\" &amp; r).Value = .Range(\"A\" &amp; tmpRow &amp; \":O\" &amp; tmpRow).Value\n                r = r + 1\n                Set tmpRng = .Range(\"P2:CP5000\").FindNext(tmpRng)\n            Loop While Not tmpRng Is Nothing And tmpRng.Address &lt;&gt; firstAddress\n\n        End If\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>Initial replies and edits:</strong></p>\n\n<p>Try changing this line</p>\n\n<pre><code>Set rw1 = .FindNext(rw1)\n</code></pre>\n\n<p>to</p>\n\n<pre><code>rw1 = r1.FindNext().Row\n</code></pre>\n\n<p>rw1 is not a Range, therefore type mismatch. Let me know if this works.</p>\n\n<p><strong>Edit</strong>: also change this line:</p>\n\n<pre><code>If Not rw1 Is Nothing Then\n</code></pre>\n\n<p>to</p>\n\n<pre><code>if rw1 &lt;&gt; 0 then\n</code></pre>\n\n<p>and add this line</p>\n\n<pre><code>rw1 = 0\n</code></pre>\n\n<p>before this line:</p>\n\n<pre><code>rw1 = r1.Find(What:=r2.Value, After:=r1(1)).Row\n</code></pre>\n\n<p><strong>Edit2:</strong> about the for loop and updating r3\nIf the text string exists multiple times, you must keep the for-loop, and you can update the r3 range by declaring a row variable, e.g. </p>\n\n<pre><code>Dim tmpRow = 2 as integer\n</code></pre>\n\n<p>and then inside your for-loop you write before <code>rw1 = 0</code></p>\n\n<pre><code>tmpRow = tmpRow + 1\nset r3 = thisWorkbook.Sheets(\"Reports\").Range(\"F\" &amp; tmprow &amp; \":T\" &amp; tmprow)\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 6258179, "user_type": "registered", "accept_rate": 77, "profile_image": "https://graph.facebook.com/717193235050415/picture?type=large", "display_name": "Joseph Lin", "link": "https://stackoverflow.com/users/6258179/joseph-lin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 246, "favorite_count": 0, "accepted_answer_id": 37301473, "answer_count": 1, "score": 1, "last_activity_date": 1463648902, "creation_date": 1463578121, "last_edit_date": 1463593687, "question_id": 37301104, "link": "https://stackoverflow.com/questions/37301104/create-macro-to-find-text-string-within-a-range-and-return-data-from-matched-row", "title": "Create Macro to Find Text String Within a Range and Return Data From Matched Rows", "body": "<p>Good morning, I am building a macro that will find a certain text from cell A2 sheet named Committees withing the range of P2:CP5000 in sheet called database, and return data of column A:O in the same rows from all the rows that contain this text string, and print it out started from cell F2 on the sheet called reports. Here is what I have done based on some suggestions. However, it is not returning expected values, it copies data from column A in Database to F:T in reports. Also I think the loop is not working since it won't stop after the last row in range r1.</p>\n\n<pre><code>Sub Macro1()\n\nDim r1 As Range, r2 As Range, r3 As Range\nDim rw1 As Long\nDim tmpRow As Long\n\ntmpRow = 2\nSet r2 = Sheets(\"Committees\").Range(\"A2\")\nSet r1 = Sheets(\"Database\").Range(\"P2:CO5000\")\nSet r3 = ThisWorkbook.Sheets(\"Reports\").Range(\"F2:T2\")\n\nrw1 = 0\nrw1 = r1.Find(What:=r2.Value, After:=r1(1)).Row\n\nDo While rw1 &lt;&gt; 0\nr3.Value = Sheets(\"Database\").Range(\"A\" &amp; rw1 &amp; \":O\" &amp; rw1).Value\ntmpRow = tmpRow + 1\nSet r3 = ThisWorkbook.Sheets(\"Reports\").Range(\"F\" &amp; tmpRow &amp; \":T\" &amp; tmpRow)\nrw1 = 0\nrw1 = r1.FindNext().Row\nLoop\nEnd Sub\n</code></pre>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 2788, "user_id": 4139024, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/qOcL9.jpg?s=128&g=1", "display_name": "blckbird", "link": "https://stackoverflow.com/users/4139024/blckbird"}, "edited": false, "score": 0, "creation_date": 1463578398, "post_id": 37301045, "comment_id": 62124571, "body": "What are you trying to do?"}, {"owner": {"reputation": 664, "user_id": 376904, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YA2VE.png?s=128&g=1", "display_name": "CS.", "link": "https://stackoverflow.com/users/376904/cs"}, "edited": false, "score": 0, "creation_date": 1463578966, "post_id": 37301045, "comment_id": 62124982, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/office/ff195193(v=office.14).aspx\" rel=\"nofollow noreferrer\">Range(&quot;A1:A20&quot;).Value</a> returns an array of type Variant. You are trying to assign it to an array of type String. End statement is not required here. Have a look at the <a href=\"https://msdn.microsoft.com/en-us/library/752y8abs.aspx\" rel=\"nofollow noreferrer\">If Then Else</a> syntax"}, {"owner": {"reputation": 15, "user_id": 6351159, "user_type": "registered", "profile_image": "https://graph.facebook.com/1725517834403807/picture?type=large", "display_name": "Ahmed Touk", "link": "https://stackoverflow.com/users/6351159/ahmed-touk"}, "edited": false, "score": 0, "creation_date": 1463582789, "post_id": 37301045, "comment_id": 62127898, "body": "I am trying to check if each number in the array is greater than 10. If it is I&#39;ll add 1 to it."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 6351159, "user_type": "registered", "profile_image": "https://graph.facebook.com/1725517834403807/picture?type=large", "display_name": "Ahmed Touk", "link": "https://stackoverflow.com/users/6351159/ahmed-touk"}, "edited": false, "score": 0, "creation_date": 1463582951, "post_id": 37301789, "comment_id": 62128040, "body": "Thank you so much I understand the logic here but why did you have to define &quot;rng As Range&quot; and what if I had a huge swathe of numbers in the row and I didn&#39;t want to check the end of the column is there a way to do that?"}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "reply_to_user": {"reputation": 15, "user_id": 6351159, "user_type": "registered", "profile_image": "https://graph.facebook.com/1725517834403807/picture?type=large", "display_name": "Ahmed Touk", "link": "https://stackoverflow.com/users/6351159/ahmed-touk"}, "edited": false, "score": 0, "creation_date": 1463583405, "post_id": 37301789, "comment_id": 62128412, "body": "@Ahmed Touk I generally define range variables and then use it. Later on during testing somehow I did not use it. It is redundant now. I shall edit my post. If my answer meets your requirement then here in Stack Overflow saying thanks is by ticking a mark below lower triangle and accepting the Answer."}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "reply_to_user": {"reputation": 15, "user_id": 6351159, "user_type": "registered", "profile_image": "https://graph.facebook.com/1725517834403807/picture?type=large", "display_name": "Ahmed Touk", "link": "https://stackoverflow.com/users/6351159/ahmed-touk"}, "edited": false, "score": 0, "creation_date": 1463583712, "post_id": 37301789, "comment_id": 62128677, "body": "@Ahmed Touk Regarding your second point if it is only one row you can transpose from row to column. Please put a new question for that showing representative sample data so that your requirements are fully understood."}], "tags": [], "owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "is_accepted": true, "score": 0, "last_activity_date": 1463583458, "last_edit_date": 1463583458, "creation_date": 1463579798, "answer_id": 37301789, "question_id": 37301045, "link": "https://stackoverflow.com/questions/37301045/run-time-error-13-trying-to-change-variables-to-an-array/37301789#37301789", "title": "Run-time error 13 trying to change variables to an array", "body": "<p>Do you want something like this:</p>\n\n<pre><code>Sub Dothis()\n   Dim test() As String\n   Dim element As Variant\n   Dim element2 As Variant\n\n   Dim i As Integer\n   element = ActiveSheet.Range(\"A1:A20\")\n\n   For i = 20 To 10 Step -1\n   element(i, 1) = element(i, 1) + 1\n   Debug.Print element(i, 1)\n   Next i\n   element2 = element\n   For i = 1 To 20\n   Debug.Print element2(i, 1)\n   ActiveSheet.Range(\"B1:B20\") = element2\n   Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 6351159, "user_type": "registered", "profile_image": "https://graph.facebook.com/1725517834403807/picture?type=large", "display_name": "Ahmed Touk", "link": "https://stackoverflow.com/users/6351159/ahmed-touk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 37301789, "answer_count": 1, "score": -1, "last_activity_date": 1463584010, "creation_date": 1463577963, "last_edit_date": 1531164843, "question_id": 37301045, "link": "https://stackoverflow.com/questions/37301045/run-time-error-13-trying-to-change-variables-to-an-array", "title": "Run-time error 13 trying to change variables to an array", "body": "<p>This is my first day of coding and I am trying to add the values of cells A1 to A20 to an array, it is giving me a \"Run-time error '13': Type mismatch\" on line 4.</p>\n\n<pre><code>Option Explicit\n\nSub Dothis()\nDim test() As String\nDim element As Variant\ntest() = Range(\"A1:A20\").Value\nFor Each element In test\n    If (element &gt; 10) Then element = element + 1\n    End\nNext element\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "textbox", "copy-paste", "userform"], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 5500328, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/bb42ef98a3379c6f5906c6440c7f16fa?s=128&d=identicon&r=PG&f=1", "display_name": "user5500328", "link": "https://stackoverflow.com/users/5500328/user5500328"}, "edited": false, "score": 0, "creation_date": 1463579327, "post_id": 37301016, "comment_id": 62125243, "body": "It works but the problem is, when it automatically paste the clipboard content once the userform that contains the textbox initializes. What I was hoping to do is to only paste the content once the textbox is clicked."}, {"owner": {"reputation": 2788, "user_id": 4139024, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/qOcL9.jpg?s=128&g=1", "display_name": "blckbird", "link": "https://stackoverflow.com/users/4139024/blckbird"}, "reply_to_user": {"reputation": 47, "user_id": 5500328, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/bb42ef98a3379c6f5906c6440c7f16fa?s=128&d=identicon&r=PG&f=1", "display_name": "user5500328", "link": "https://stackoverflow.com/users/5500328/user5500328"}, "edited": false, "score": 0, "creation_date": 1463587237, "post_id": 37301016, "comment_id": 62131179, "body": "That&#39;s not in your question. So it&#39;s not in my answer."}], "tags": [], "owner": {"reputation": 2788, "user_id": 4139024, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/qOcL9.jpg?s=128&g=1", "display_name": "blckbird", "link": "https://stackoverflow.com/users/4139024/blckbird"}, "is_accepted": false, "score": 0, "last_activity_date": 1463577891, "creation_date": 1463577891, "answer_id": 37301016, "question_id": 37300883, "link": "https://stackoverflow.com/questions/37300883/automatically-paste-a-copied-text-on-clipboard-to-a-textbox/37301016#37301016", "title": "Automatically paste a copied text on clipboard to a textbox", "body": "<p>If the values are in your clipboard you can implement the following function: </p>\n\n<pre><code>Private Sub TextBox1_Enter()\n    UserForm1.TextBox1.Paste\nEnd Sub\n</code></pre>\n\n<p>This will paste the content of your clipboard into the text box when you are entering the text box.</p>\n"}], "owner": {"reputation": 47, "user_id": 5500328, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/bb42ef98a3379c6f5906c6440c7f16fa?s=128&d=identicon&r=PG&f=1", "display_name": "user5500328", "link": "https://stackoverflow.com/users/5500328/user5500328"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3396, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1463577891, "creation_date": 1463577547, "question_id": 37300883, "link": "https://stackoverflow.com/questions/37300883/automatically-paste-a-copied-text-on-clipboard-to-a-textbox", "title": "Automatically paste a copied text on clipboard to a textbox", "body": "<p>I was wondering if it is possible to automatically paste a copied text to a textbox once clicked.</p>\n\n<p>For example:\nIF I copy(ctrl+c) a series of numbers from a notepad, once I go to my workform and click on the blank text box it will automatically paste(ctrl+v) copied numbers on the box </p>\n"}, {"tags": ["vba", "excel", "paste", "sendkeys"], "comments": [{"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1463577130, "post_id": 37300564, "comment_id": 62123646, "body": "Hi Jason, what exactly is the problem here?"}, {"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1463577886, "post_id": 37300564, "comment_id": 62124211, "body": "a) what is in E5:G5? These are cells across three columns. Are they connected? Do the contain ONE text value? b) don&#39;t use SendKeys, don&#39;t use Selection. Please state exactly what is in E5:G5. I&#39;m sure there&#39;s a whole lotta better way to do this."}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1463577366, "creation_date": 1463577366, "answer_id": 37300788, "question_id": 37300564, "link": "https://stackoverflow.com/questions/37300564/vba-sendkeys-paste-syntax-error-while-replacing-excel-cells/37300788#37300788", "title": "VBA - SendKeys Paste Syntax Error - While replacing excel cells", "body": "<p>Rather than <strong>copying</strong> the block of three cells and then trying to determine where to paste them is different worksheets, get the three cells into an array and then decide where the array should be deposited in each of the other sheets.</p>\n"}, {"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 0, "last_activity_date": 1463578624, "creation_date": 1463578624, "answer_id": 37301325, "question_id": 37300564, "link": "https://stackoverflow.com/questions/37300564/vba-sendkeys-paste-syntax-error-while-replacing-excel-cells/37301325#37301325", "title": "VBA - SendKeys Paste Syntax Error - While replacing excel cells", "body": "<p>You don't need to copy and paste - something like this should do:</p>\n\n<pre><code>Dim avSheets, vSheet\nDim sWord                 As String\n\navSheets = Array(\"New Project Schedule\", \"Out of Scope\")\n\nsWord = Range(\"E5:G5\").Value\n\nFor Each vSheet In avSheets\n    With Sheets(vSheet).Cells\n        .Replace What:=\"New Merchant\", Replacement:=sWord, _\n                 LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=False, _\n                 SearchFormat:=False, ReplaceFormat:=False\n        .Replace What:=\"Merchant\", Replacement:=sWord, LookAt:=xlPart, _\n                 SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False\n    End With\nNext vSheet\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6351117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cba06379057147747fa0cae4d6b2a96c?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/6351117/jason"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "accepted_answer_id": 37301325, "answer_count": 2, "score": 0, "last_activity_date": 1463582182, "creation_date": 1463576833, "last_edit_date": 1463582182, "question_id": 37300564, "link": "https://stackoverflow.com/questions/37300564/vba-sendkeys-paste-syntax-error-while-replacing-excel-cells", "title": "VBA - SendKeys Paste Syntax Error - While replacing excel cells", "body": "<p>I'm trying to use SendKeys to copy a word from one cell into the replace (CTRL+F) function. </p>\n\n<p>The copy bit is fine but this spreadsheet is going to be used as a template so the variable is what is in that cell meaning i'm using send keys.</p>\n\n<p>I'm open to other ideas.</p>\n\n<p>Code is below.</p>\n\n<pre><code>  Range(\"E5:G5\").Select\nSelection.Copy\nSheets(\"New Project Schedule\").Select\nSelection.Replace What:=\"New Merchant\", Replacement:= SendKeys \"^v\" , LookAt= _\n    :=xlPart, SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\n    ReplaceFormat:=False\nSheets(\"Out of Scope\").Select\nSelection.Replace What:=\"New Merchant\", Replacement:= SendKeys \"^v\", LookAt= _\n    :=xlPart, SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\n    ReplaceFormat:=False\nSheets(\"New Project Schedule\").Select\nSelection.Replace What:=\"Merchant\", Replacement:= SendKeys \"^v\", LookAt:= _\n    xlPart, SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\n    ReplaceFormat:=False\nSheets(\"Out of Scope\").Select\nSelection.Replace What:=\"Merchant\", Replacement:= SendKeys \"^v\", LookAt:=\n    xlPart , SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\n    ReplaceFormat:=False\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 6204232, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8MkAb.png?s=128&g=1", "display_name": "AdrianJG", "link": "https://stackoverflow.com/users/6204232/adrianjg"}, "edited": false, "score": 0, "creation_date": 1463577385, "post_id": 37300592, "comment_id": 62123816, "body": "By get the file from the current directory i mean, that if the excel sheet is in a folder, i would like the url to direct like this: &quot;currentfolder\\imagenes\\image.png&quot; so that it can work in every computer. I&#39;ve been trying to use a vbs macro to change every image in the column to urls, like this:"}, {"owner": {"reputation": 53, "user_id": 6204232, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8MkAb.png?s=128&g=1", "display_name": "AdrianJG", "link": "https://stackoverflow.com/users/6204232/adrianjg"}, "edited": false, "score": 0, "creation_date": 1463577390, "post_id": 37300592, "comment_id": 62123819, "body": "Sub ReplacePictures()     For Each wShape In ActiveSheet.Shapes         If (wShape.Type = 13) Then             wShape.TopLeftCell = &quot;url&quot;             wShape.Delete         End If     Next wShape End Sub"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 53, "user_id": 6204232, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8MkAb.png?s=128&g=1", "display_name": "AdrianJG", "link": "https://stackoverflow.com/users/6204232/adrianjg"}, "edited": false, "score": 0, "creation_date": 1463577764, "post_id": 37300592, "comment_id": 62124109, "body": "Updated the answer with a formula to use the current workbook&#39;s path"}, {"owner": {"reputation": 53, "user_id": 6204232, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8MkAb.png?s=128&g=1", "display_name": "AdrianJG", "link": "https://stackoverflow.com/users/6204232/adrianjg"}, "edited": false, "score": 0, "creation_date": 1463578814, "post_id": 37300592, "comment_id": 62124873, "body": "Hello and thanks for your answer but whenever i try to use the formula in my cells, excel shows this on the cells: #####."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 53, "user_id": 6204232, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8MkAb.png?s=128&g=1", "display_name": "AdrianJG", "link": "https://stackoverflow.com/users/6204232/adrianjg"}, "edited": false, "score": 0, "creation_date": 1463579014, "post_id": 37300592, "comment_id": 62125011, "body": "What about if you break it up <code>=text((2*row())-1, &quot;000&quot;)</code> and <code>=LEFT(CELL(&quot;filename&quot;, A1), FIND(&quot;[&quot;,CELL(&quot;filename&quot;,A1))-1)</code> Do those give you reasonable outputs?"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 53, "user_id": 6204232, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8MkAb.png?s=128&g=1", "display_name": "AdrianJG", "link": "https://stackoverflow.com/users/6204232/adrianjg"}, "edited": false, "score": 0, "creation_date": 1463579844, "post_id": 37300592, "comment_id": 62125661, "body": "Which one, of those two formulas, shows ` #&#191;NOMBRE?`?"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 53, "user_id": 6204232, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8MkAb.png?s=128&g=1", "display_name": "AdrianJG", "link": "https://stackoverflow.com/users/6204232/adrianjg"}, "edited": false, "score": 0, "creation_date": 1463579896, "post_id": 37300592, "comment_id": 62125696, "body": "In order for that <code>Cell(&quot;Filename&quot;)</code> formula to work correctly, the workbook must be saved. Otherwise you will get an error."}, {"owner": {"reputation": 53, "user_id": 6204232, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8MkAb.png?s=128&g=1", "display_name": "AdrianJG", "link": "https://stackoverflow.com/users/6204232/adrianjg"}, "edited": false, "score": 0, "creation_date": 1463580033, "post_id": 37300592, "comment_id": 62125785, "body": "Hello, both of them show that and the document is indeed saved. :-/"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 53, "user_id": 6204232, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8MkAb.png?s=128&g=1", "display_name": "AdrianJG", "link": "https://stackoverflow.com/users/6204232/adrianjg"}, "edited": false, "score": 0, "creation_date": 1463580136, "post_id": 37300592, "comment_id": 62125854, "body": "Are you using a locale that requires semi-colons to separate formula parameters? like: <code>=text((2*row())-1; &quot;000&quot;)</code> Other than that, I have no idea why such a simple formula would fail."}, {"owner": {"reputation": 53, "user_id": 6204232, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8MkAb.png?s=128&g=1", "display_name": "AdrianJG", "link": "https://stackoverflow.com/users/6204232/adrianjg"}, "edited": false, "score": 0, "creation_date": 1463580390, "post_id": 37300592, "comment_id": 62126037, "body": "I&#39;m not an expert in using excel with formulas but i think i&#39;m inserting them right :-/ It should be working..."}], "tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": true, "score": 2, "last_activity_date": 1463579022, "last_edit_date": 1463579022, "creation_date": 1463576879, "answer_id": 37300592, "question_id": 37300409, "link": "https://stackoverflow.com/questions/37300409/excel-add-url-with-increment-in-all-rows-of-a-column/37300592#37300592", "title": "Excel add url with increment in all rows of a column", "body": "<p>You could use a formula:</p>\n\n<pre><code>=\"'currdir\\imagenes\\image\" &amp; text((2*row())-1, \"000\") &amp; \".png'\"\n</code></pre>\n\n<p>And just copy that down your rows (assuming we are starting in row 1 here, otherwise you'll have to adjust that formula.</p>\n\n<p>To make this dynamically use the path of the current workbook you can use the <code>Cell()</code> formula with some <code>Left()</code> and <code>Find()</code> string manipulation:</p>\n\n<pre><code>=\"'\" &amp; LEFT(CELL(\"filename\", A1), FIND(\"[\",CELL(\"filename\",A1))-1) &amp; \"imagenes\\image\" &amp; text((2*row())-1, \"000\") &amp; \".png'\"\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 6204232, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8MkAb.png?s=128&g=1", "display_name": "AdrianJG", "link": "https://stackoverflow.com/users/6204232/adrianjg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 279, "favorite_count": 0, "accepted_answer_id": 37300592, "answer_count": 1, "score": 0, "last_activity_date": 1463579022, "creation_date": 1463576441, "last_edit_date": 1531161705, "question_id": 37300409, "link": "https://stackoverflow.com/questions/37300409/excel-add-url-with-increment-in-all-rows-of-a-column", "title": "Excel add url with increment in all rows of a column", "body": "<p>I would like to know how can run a function to add an url in every row for a column where there are only images in every row, in which for every row the number at the end of the file name would increment by 2 and to get the file from the current directory of the excel file, something like this:</p>\n\n<pre><code>'currdir\\imagenes\\image001.png' \n'currdir\\imagenes\\image003.png' \n'currdir\\imagenes\\image005.png' \n</code></pre>\n\n<p>And so on...</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 1, "creation_date": 1463575360, "post_id": 37299945, "comment_id": 62122303, "body": "You can use a variable and a loop."}], "answers": [{"tags": [], "owner": {"reputation": 1435, "user_id": 62872, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04664c4ea53aaa32816a75e7c6449ec1?s=128&d=identicon&r=PG", "display_name": "Paul Ellery", "link": "https://stackoverflow.com/users/62872/paul-ellery"}, "is_accepted": false, "score": 2, "last_activity_date": 1463575541, "creation_date": 1463575541, "answer_id": 37300067, "question_id": 37299945, "link": "https://stackoverflow.com/questions/37299945/vba-to-loop-round-worksheets-by-index-number/37300067#37300067", "title": "VBA to loop round worksheets by index number", "body": "<p>Use a simple for loop:</p>\n\n<pre><code>For i = 1 To 12\n    Worksheets(i).Range(\"A1\").Value = \"Hello\"\nNext\n</code></pre>\n\n<p>Although you may want to check that the sheets exist first...</p>\n"}, {"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1463576477, "last_edit_date": 1463576477, "creation_date": 1463576152, "answer_id": 37300294, "question_id": 37299945, "link": "https://stackoverflow.com/questions/37299945/vba-to-loop-round-worksheets-by-index-number/37300294#37300294", "title": "VBA to loop round worksheets by index number", "body": "<p>You can do this without a loop ! :</p>\n\n<pre><code>Sub ALLpoi()\n    Sheets(Array(\"Sheet1\", \"Sheet2\", \"Sheet3\")).Select\n    Range(\"A1\").Select\n    Selection.Value = \"Hello\"\nEnd Sub\n</code></pre>\n\n<p>This is one case in which using <code>Selection</code> is good.  In this case <code>Selection</code> can span cells on different worksheets <em>(unlike a range)</em></p>\n"}, {"tags": [], "owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "is_accepted": false, "score": 1, "last_activity_date": 1463577896, "last_edit_date": 1463577896, "creation_date": 1463577078, "answer_id": 37300669, "question_id": 37299945, "link": "https://stackoverflow.com/questions/37299945/vba-to-loop-round-worksheets-by-index-number/37300669#37300669", "title": "VBA to loop round worksheets by index number", "body": "<p>There are two options (from my expirience) to do what you asking for: <br></p>\n\n<p><strong>1) using loop (several variants)</strong></p>\n\n<pre><code>Sub test1()\n    Dim i%\n    For i = 1 To 12\n        Worksheets(i).[A1].Value2 = \"Hello\"\n    Next\nEnd sub\n</code></pre>\n\n<p>or</p>\n\n<pre><code>Sub test2()\n    Dim i%: i = 1\n    While i &lt; 13\n         Worksheets(i).[A1].Value2 = \"Hello\": i = i + 1\n    Wend\nEnd Sub\n</code></pre>\n\n<p>or</p>\n\n<pre><code>Sub test3()\n    Dim i%: i = 1\n    Do While i &lt; 13\n        Worksheets(i).[A1].Value2 = \"Hello\": i = i + 1\n    Loop\nEnd Sub\n</code></pre>\n\n<p>or</p>\n\n<pre><code>Sub test4()\n    Dim i%: i = 1\n    Do Until i = 13\n        Worksheets(i).[A1].Value2 = \"Hello\": i = i + 1\n    Loop\nEnd Sub\n</code></pre>\n\n<p>or</p>\n\n<pre><code>Sub test5()\n    Dim i%: i = 1\n    Do\n        Worksheets(i).[A1].Value2 = \"Hello\": i = i + 1\n    Loop Until i = 13\nEnd Sub\n</code></pre>\n\n<p><strong>2) without loop</strong></p>\n\n<pre><code>Sub test()\n    Worksheets(Array(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12)).Select\n    [A1].Activate: ActiveCell.Value2 = \"Hello\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 6349656, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pEsjxu7kpDQ/AAAAAAAAAAI/AAAAAAAAJTs/9B2n6cu2Uk4/photo.jpg?sz=128", "display_name": "Levent Nergiz", "link": "https://stackoverflow.com/users/6349656/levent-nergiz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1312, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1463579465, "creation_date": 1463575207, "last_edit_date": 1531164843, "question_id": 37299945, "link": "https://stackoverflow.com/questions/37299945/vba-to-loop-round-worksheets-by-index-number", "title": "VBA to loop round worksheets by index number", "body": "<p>How do I change a cell in particular sheets using the worksheet index number</p>\n\n<p>For example:</p>\n\n<pre><code>Worksheets(1).Range(\"A1\").Value = \"Hello\"\n</code></pre>\n\n<p>I want to do this for worksheets from 1 to 12</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "edited": false, "score": 0, "creation_date": 1463641678, "post_id": 37299781, "comment_id": 62152227, "body": "seems like <code>Wb1.Sheets(1).Range(&quot;A2&quot;).Range(.Cells(1, 1), .End(xlDown).Cells(1, 39)).Copy wb2.Sheets(2).Range(&quot;B5&quot;)</code> is not right. Can you help me out here?"}], "tags": [], "owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "is_accepted": true, "score": 1, "last_activity_date": 1463574805, "creation_date": 1463574805, "answer_id": 37299781, "question_id": 37299516, "link": "https://stackoverflow.com/questions/37299516/copy-from-a-open-workbook-with-variable-name-into-the-workbook-i-run-the-macro-f/37299781#37299781", "title": "Copy from a open workbook with variable name into the workbook I run the macro from", "body": "<p>Look through the open workbooks and select the one which matches your requirements:</p>\n\n<pre><code>For Each wB in Application.Workbooks\n    If Left(wB.Name, 21) = \"Open Order Monitoring\" Then\n        Set Wb1 = wB\n        Exit For\n    End If\nNext\n</code></pre>\n\n<p>That will give you the first open workbook starting with that name and set it to Wb1 for you.</p>\n"}], "owner": {"reputation": 319, "user_id": 6285207, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/SuUxm.png?s=128&g=1", "display_name": "Bluesector", "link": "https://stackoverflow.com/users/6285207/bluesector"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 539, "favorite_count": 0, "accepted_answer_id": 37299781, "answer_count": 1, "score": 0, "last_activity_date": 1463574805, "creation_date": 1463574145, "question_id": 37299516, "link": "https://stackoverflow.com/questions/37299516/copy-from-a-open-workbook-with-variable-name-into-the-workbook-i-run-the-macro-f", "title": "Copy from a open workbook with variable name into the workbook I run the macro from", "body": "<p>I want to make a macro that copies data from an open workbook that I receive via Email. The workbook name always starts with \"Open Order Monitoring\"[...] and end with a variable. I want the macro to recognize the first three words and then choose the right open workbook to copy from. I want to run the macro from the workbook the data gets pasted in:</p>\n\n<pre><code>Sub CopyData()\nDim Wb1 As Workbook, wb2 As Workbook\n\n'Copy from open workbook that always start with the name \n'Open Order Monitoring[...]'. I need a variable\nSet Wb1 = XXXXXXXX 'needs a variable here I think\n\n'Paste into the Workbook I run the macro from (aka ThisWorkbook??)\nSet Wb2 = ThisWorkbook\n\n'Copy Data from Wb1.Sheet1 to Wb2.sheet2\nWb1.Sheets(1).Range(\"A2\").Range(.Cells(1, 1), \n.End(xlDown).Cells(1, 39)).Copy wb2.Sheets(2).Range(\"B5\")\n\nEnd Sub\n</code></pre>\n\n<p>I don't know much about VBA...</p>\n\n<p>tl;dr - Copy from one open workbook (with variable name) into another open workbook (I run the macro from)</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1463573327, "post_id": 37298867, "comment_id": 62120806, "body": "1: What exactly do you want to check with <code>IsEmpty(ra)</code>? 2: Don&#39;t use field names <code>name</code>, it&#39;s a reserved word."}, {"owner": {"reputation": 25, "user_id": 3569647, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/db427040dbb35d473e0ee8d2972449b0?s=128&d=identicon&r=PG&f=1", "display_name": "user3569647", "link": "https://stackoverflow.com/users/3569647/user3569647"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1463575682, "post_id": 37298867, "comment_id": 62122558, "body": "I wan to check if the table &quot;Archive&quot; is empty or not"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 3569647, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/db427040dbb35d473e0ee8d2972449b0?s=128&d=identicon&r=PG&f=1", "display_name": "user3569647", "link": "https://stackoverflow.com/users/3569647/user3569647"}, "edited": false, "score": 0, "creation_date": 1463575611, "post_id": 37299835, "comment_id": 62122515, "body": "yes but I want not just to check if &quot;ra!name&quot; is empty but all the table &quot;Archive&quot;"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 25, "user_id": 3569647, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/db427040dbb35d473e0ee8d2972449b0?s=128&d=identicon&r=PG&f=1", "display_name": "user3569647", "link": "https://stackoverflow.com/users/3569647/user3569647"}, "edited": false, "score": 0, "creation_date": 1463576187, "post_id": 37299835, "comment_id": 62122916, "body": "A field can be Null or have a value, not &quot;empty&quot;. If you mean if no records exists, see edit."}, {"owner": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "reply_to_user": {"reputation": 25, "user_id": 3569647, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/db427040dbb35d473e0ee8d2972449b0?s=128&d=identicon&r=PG&f=1", "display_name": "user3569647", "link": "https://stackoverflow.com/users/3569647/user3569647"}, "edited": false, "score": 1, "creation_date": 1463576333, "post_id": 37299835, "comment_id": 62123014, "body": "@user3569647 &quot;all the table&quot;? If no records exist then <code>if ra.recordcount=0 then... </code> would tell you if the table is empty, but also the <code>do while not ra.EOF</code> would prevent you from entering the loop if Archive is empty anyway."}, {"owner": {"reputation": 25, "user_id": 3569647, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/db427040dbb35d473e0ee8d2972449b0?s=128&d=identicon&r=PG&f=1", "display_name": "user3569647", "link": "https://stackoverflow.com/users/3569647/user3569647"}, "edited": false, "score": 0, "creation_date": 1463577028, "post_id": 37299835, "comment_id": 62123577, "body": "ahhh, exactly that was my problem"}, {"owner": {"reputation": 25, "user_id": 3569647, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/db427040dbb35d473e0ee8d2972449b0?s=128&d=identicon&r=PG&f=1", "display_name": "user3569647", "link": "https://stackoverflow.com/users/3569647/user3569647"}, "edited": false, "score": 0, "creation_date": 1463579339, "post_id": 37299835, "comment_id": 62125256, "body": "how can I check if a row &quot;X&quot; contains a value &quot;y&quot;?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1463584610, "post_id": 37299835, "comment_id": 62129355, "body": "Loop the <i>Fields</i> collection of the record (row)."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 0, "last_activity_date": 1463576185, "last_edit_date": 1463576185, "creation_date": 1463574941, "answer_id": 37299835, "question_id": 37298867, "link": "https://stackoverflow.com/questions/37298867/how-to-express-if-the-an-access-tabel-is-empty/37299835#37299835", "title": "How to express if the an access tabel is empty", "body": "<p>You probably think of something like this:</p>\n\n<pre><code>Set rs = db.OpenRecordset(\"All\")\nSet ra = db.OpenRecordset(\"Archive\")\nIf ra.RecordCount &gt; 0 Then    \n    Do While Not (rs.EOF Or ra.EOF)\n        If IsNull(ra!name.Value) Then\n            ' do something A\n        ElseIf ra!name.Value &lt;&gt; rs!name.Value Then\n            ' do something B\n        Else\n            ' do nothing\n        End If\n        ra.MoveNext\n        rs.MoveNext\n    Loop\nEnd If\nrs.Close\nra.Close\n\nSet rs = Nothing\nSet ra = Nothing\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 3569647, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/db427040dbb35d473e0ee8d2972449b0?s=128&d=identicon&r=PG&f=1", "display_name": "user3569647", "link": "https://stackoverflow.com/users/3569647/user3569647"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 37299835, "answer_count": 1, "score": 0, "last_activity_date": 1594642123, "creation_date": 1463572500, "last_edit_date": 1594642123, "question_id": 37298867, "link": "https://stackoverflow.com/questions/37298867/how-to-express-if-the-an-access-tabel-is-empty", "title": "How to express if the an access tabel is empty", "body": "<p>I'm trying to run the following code, and I got two problems as below:</p>\n\n<pre><code>Set rs = db.OpenRecordset(\"All\")\nDo While Not rs.EOF\n\nSet ra = db.OpenRecordset(\"Archive\")\nDo While Not ra.EOF\n\nif IsEmpty(ra) then    ' is this expression correct? \"problem 1\"\n\ndo something A\n\nelseif ra!name &lt;&gt; rs!name the ' and here the program don't respect \"&lt;&gt;\" \"Problem 2\"\n\ndo something B\n\nElse\n\nEnd If\n\nra.MoveNext\nLoop\n\n\nrs.MoveNext\nLoop\nrs.Close\nEnd Function\n</code></pre>\n\n<p>Does somebody have a suggestion ?</p>\n\n<p>Thank you</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1463572905, "post_id": 37298816, "comment_id": 62120484, "body": "immediately after you set mnthfld, use <code>msgbox mnthfld</code> to display the overall string you&#39;ve concocted and post that so it&#39;s easy to detect any syntax errors..."}, {"owner": {"reputation": 147, "user_id": 6318893, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/14a16578c4694a8c6f09f0165d99ba38?s=128&d=identicon&r=PG&f=1", "display_name": "zkhan", "link": "https://stackoverflow.com/users/6318893/zkhan"}, "reply_to_user": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1463574962, "post_id": 37298816, "comment_id": 62122025, "body": "The select and from commands are omitted from the snapshot, however that is not the cause of the error."}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1463575750, "post_id": 37298816, "comment_id": 62122614, "body": "at least one <code>[expirydate]</code> is missing the closing <code>]</code>..."}], "answers": [{"tags": [], "owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "is_accepted": false, "score": 1, "last_activity_date": 1463576033, "creation_date": 1463576033, "answer_id": 37300249, "question_id": 37298816, "link": "https://stackoverflow.com/questions/37298816/sql-vba-query-expression-syntax-error/37300249#37300249", "title": "sql vba query expression syntax error", "body": "<p>Each instance of IIf requires 3 parameters (bool_test, value_if_true, value_if_false)</p>\n\n<p>I've converted the below string to be syntactically correct; you'll need to review it to make sure it's what you expected it to be doing though!</p>\n\n<p><code>IIf([issuedate]&lt;= #11/30/2015#,IIf([expirydate] &lt;= #11/30/2015#, 0, IIf([expirydate] &lt;=#11/30/2015#,(([expirydate]-#11/30/2015#+1)/([expirydate]-[effectivedate]+1)),[grosspremium])),0) as [EP M11 2015]</code></p>\n"}, {"comments": [{"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1463576256, "post_id": 37300292, "comment_id": 62122963, "body": "Still missing the closing <code>]</code> on <code>[expirydate]</code> on the final nested IIf ;)"}, {"owner": {"reputation": 4301, "user_id": 4381330, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4373cf5624ae7b7e77bd2017abad9850?s=128&d=identicon&r=PG&f=1", "display_name": "Mincong Huang", "link": "https://stackoverflow.com/users/4381330/mincong-huang"}, "reply_to_user": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1463576329, "post_id": 37300292, "comment_id": 62123010, "body": "You&#39;re right, @Dave, but it is forgetten from the question :("}], "tags": [], "owner": {"reputation": 4301, "user_id": 4381330, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4373cf5624ae7b7e77bd2017abad9850?s=128&d=identicon&r=PG&f=1", "display_name": "Mincong Huang", "link": "https://stackoverflow.com/users/4381330/mincong-huang"}, "is_accepted": true, "score": 1, "last_activity_date": 1463576711, "last_edit_date": 1463576711, "creation_date": 1463576149, "answer_id": 37300292, "question_id": 37298816, "link": "https://stackoverflow.com/questions/37298816/sql-vba-query-expression-syntax-error/37300292#37300292", "title": "sql vba query expression syntax error", "body": "<p>Add a <code>]</code> in statement <code>[expirydate &lt;=#\" &amp; useDateUpper</code> and remove the <code>,0</code> from <code>[grosspremium]),0</code> should work. Final query looks like :</p>\n\n<pre><code>SELECT \nIIf\n(\n    [issuedate] &lt;= #11/30/2015#, \n    IIf\n    (\n        [expirydate] &lt;= #11/30/2015#, \n        0, \n        IIf\n        (\n            [expirydate] &lt;=#11/30/2015#,\n            ([expirydate]-#\"11/30/2015\"#+1)/([expirydate]-[effectivedate]+1),\n            [grosspremium]\n        )\n    ),\n    0\n) as [EP M11 2015]\n</code></pre>\n"}], "owner": {"reputation": 147, "user_id": 6318893, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/14a16578c4694a8c6f09f0165d99ba38?s=128&d=identicon&r=PG&f=1", "display_name": "zkhan", "link": "https://stackoverflow.com/users/6318893/zkhan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 37300292, "answer_count": 2, "score": 0, "last_activity_date": 1593958604, "creation_date": 1463572356, "last_edit_date": 1593958604, "question_id": 37298816, "link": "https://stackoverflow.com/questions/37298816/sql-vba-query-expression-syntax-error", "title": "sql vba query expression syntax error", "body": "<p>I'm trying to run the following through vba sq in access but get an error \"Extra ) in query expression '0)'\". Following is the query expression:</p>\n\n<pre><code>mnthfld = \"SELECT IIf([issuedate] &lt;= #\" &amp; useDateUpper &amp; \"#,\" &amp; _\n    \"IIf([expirydate] &lt;= #\" &amp; useDateUpper &amp; \"#, 0, IIf([expirydate &lt;=#\" &amp; useDateUpper &amp; \"#,\" &amp; _\n    \"([expirydate]-#\" &amp; useDateUpper &amp; \"#+1)/([expirydate]-[effectivedate]+1),[grosspremium]),0),0) as 'EP M\" &amp; _\n    Format(useDateLower, \"mm yyyy\") &amp; \"' FROM tblEpData\"\n</code></pre>\n\n<blockquote>\n  <p>Any help is appreciated. My hunch is that I'm using brackets wrongly in the subtraction and division parts.</p>\n</blockquote>\n\n<p>UPDATE:</p>\n\n<p>Snapshot of the mnthfield string on one iteration:</p>\n\n<pre><code>IIf([issuedate] &lt;= #11/30/2015#,IIf([expirydate] &lt;= #11/30/2015#, 0, IIf([expirydate &lt;=#11/30/2015#,([expirydate]-#11/30/2015#+1)/([expirydate]-[effectivedate]+1),[grosspremium]),0,0)) as [EP M11 2015]\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1463572626, "post_id": 37298599, "comment_id": 62120250, "body": "Why would you need to loop through the array of error messages if you know (presumably by the value of txtNo) which one of the messages you want to use? You could drop the For and Next lines, along with the Exit Function and have no change to the functionality"}, {"owner": {"reputation": 2073, "user_id": 4591111, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/62089c80204c2d11acf86f9ca66f93d9?s=128&d=identicon&r=PG&f=1", "display_name": "yuro", "link": "https://stackoverflow.com/users/4591111/yuro"}, "reply_to_user": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1463572887, "post_id": 37298599, "comment_id": 62120466, "body": "@Dave Yes, the variable <code>txtNo</code> contains the number in the array. Do you have an idea for a better solution?"}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1463572950, "post_id": 37298599, "comment_id": 62120522, "body": "See Gary&#39;s Student&#39;s answer..."}], "answers": [{"comments": [{"owner": {"reputation": 2073, "user_id": 4591111, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/62089c80204c2d11acf86f9ca66f93d9?s=128&d=identicon&r=PG&f=1", "display_name": "yuro", "link": "https://stackoverflow.com/users/4591111/yuro"}, "edited": false, "score": 0, "creation_date": 1463573231, "post_id": 37298989, "comment_id": 62120728, "body": "Thanks. I had this defined before and had a strange error message, however, now it works :)"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 2073, "user_id": 4591111, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/62089c80204c2d11acf86f9ca66f93d9?s=128&d=identicon&r=PG&f=1", "display_name": "yuro", "link": "https://stackoverflow.com/users/4591111/yuro"}, "edited": false, "score": 0, "creation_date": 1463573304, "post_id": 37298989, "comment_id": 62120780, "body": "@yuro  Thank you for the feedback!"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 2, "last_activity_date": 1463573226, "last_edit_date": 1463573226, "creation_date": 1463572875, "answer_id": 37298989, "question_id": 37298599, "link": "https://stackoverflow.com/questions/37298599/returning-value-from-array-in-vba/37298989#37298989", "title": "Returning value from Array in VBA", "body": "<p>The usual way to to pass an <strong>index</strong> to the UDF.  That way, you don't need a loop:</p>\n\n<pre><code>Public Function TellMe(indx as Long) as String\n    ary = Array(\"Mike\", \"James\", \"Paul\", \"William\")\n    TellMe = ary(indx)\nEnd Function\n\nSub MAIN()\n    MsgBox TellMe(2)\nEnd Sub\n</code></pre>\n\n<p><em>Remember, the default indexing is zero-based............so expect \"Paul\"</em></p>\n"}], "owner": {"reputation": 2073, "user_id": 4591111, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/62089c80204c2d11acf86f9ca66f93d9?s=128&d=identicon&r=PG&f=1", "display_name": "yuro", "link": "https://stackoverflow.com/users/4591111/yuro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 37298989, "answer_count": 1, "score": 0, "last_activity_date": 1463573226, "creation_date": 1463571803, "question_id": 37298599, "link": "https://stackoverflow.com/questions/37298599/returning-value-from-array-in-vba", "title": "Returning value from Array in VBA", "body": "<p>I have defined a message function to put different messages in it. That means when I call this function in a form, then just the corresponding chosen message has to display on the screen. Here my example:</p>\n\n<pre><code>'Thats the message sub\nPublic Sub MsgString(txtNo As Byte)\n    MsgBox MsgTxt(txtNo)\nEnd Sub\n\n'Thats the message function to return the corresponding value, which is chosen\n Private Function MsgTxt(txtNo As Byte) As String\n     Dim arrMsgTxt() As Variant\n     arrMsgTxt = Array(\"error message number one\", \"error message number two\", \"error message number three\")\n\n     For txtNo = LBound(arrMsgTxt) To UBound(arrMsgTxt)\n            MsgTxt = arrMsgTxt(txtNo)\n            Exit Function\n     Next txtNo\n End Function\n</code></pre>\n\n<p>Is there a better way to solve it? Currently, I need to exit the function after the instantiated value.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1370, "user_id": 2717068, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1443043394/picture?type=large", "display_name": "Lubo\u0161 Suk", "link": "https://stackoverflow.com/users/2717068/lubo%c5%a1-suk"}, "edited": false, "score": 0, "creation_date": 1463573157, "post_id": 37298439, "comment_id": 62120674, "body": "I have seen many similar questions on this site, and i edited their question to format their code to be readable, but still there are more and more new apearing, please format your code, then maybe you get your advice."}, {"owner": {"reputation": 1370, "user_id": 2717068, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1443043394/picture?type=large", "display_name": "Lubo\u0161 Suk", "link": "https://stackoverflow.com/users/2717068/lubo%c5%a1-suk"}, "edited": false, "score": 0, "creation_date": 1463573352, "post_id": 37298439, "comment_id": 62120828, "body": "By that error, are you sure your paths are correct?"}, {"owner": {"reputation": 57, "user_id": 6067021, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2dc8bb1e4c8d0cfc84bd3a61fcac9f37?s=128&d=identicon&r=PG&f=1", "display_name": "James Jordan", "link": "https://stackoverflow.com/users/6067021/james-jordan"}, "reply_to_user": {"reputation": 1370, "user_id": 2717068, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1443043394/picture?type=large", "display_name": "Lubo\u0161 Suk", "link": "https://stackoverflow.com/users/2717068/lubo%c5%a1-suk"}, "edited": false, "score": 0, "creation_date": 1463573502, "post_id": 37298439, "comment_id": 62120927, "body": "@Lubos, yes there are similar questions. But I have tried debug this problem in the code. But no luck! The code format is better now. No?"}, {"owner": {"reputation": 57, "user_id": 6067021, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2dc8bb1e4c8d0cfc84bd3a61fcac9f37?s=128&d=identicon&r=PG&f=1", "display_name": "James Jordan", "link": "https://stackoverflow.com/users/6067021/james-jordan"}, "reply_to_user": {"reputation": 1370, "user_id": 2717068, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1443043394/picture?type=large", "display_name": "Lubo\u0161 Suk", "link": "https://stackoverflow.com/users/2717068/lubo%c5%a1-suk"}, "edited": false, "score": 0, "creation_date": 1463573684, "post_id": 37298439, "comment_id": 62121077, "body": "@ Lubos, Yes.I have copied the Location under properties on the file."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1463577086, "post_id": 37298439, "comment_id": 62123614, "body": "Try defining the desktop path using <code>MyPath = CreateObject(&quot;WScript.Shell&quot;).specialfolders(&quot;Desktop&quot;) &amp; &quot;\\Test Dir\\GA Test\\&quot;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 6067021, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2dc8bb1e4c8d0cfc84bd3a61fcac9f37?s=128&d=identicon&r=PG&f=1", "display_name": "James Jordan", "link": "https://stackoverflow.com/users/6067021/james-jordan"}, "edited": false, "score": 0, "creation_date": 1463574813, "post_id": 37299550, "comment_id": 62121896, "body": "Thanks Doug, but my I am a beginner with VBA and hence I am more confused. Especially with the Do While Loop where you mention &quot; Some Code&quot;."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 57, "user_id": 6067021, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2dc8bb1e4c8d0cfc84bd3a61fcac9f37?s=128&d=identicon&r=PG&f=1", "display_name": "James Jordan", "link": "https://stackoverflow.com/users/6067021/james-jordan"}, "edited": false, "score": 0, "creation_date": 1463574862, "post_id": 37299550, "comment_id": 62121933, "body": "&quot;some code&quot; means &quot;fill in this space with what you need the code to do&quot;"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 57, "user_id": 6067021, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2dc8bb1e4c8d0cfc84bd3a61fcac9f37?s=128&d=identicon&r=PG&f=1", "display_name": "James Jordan", "link": "https://stackoverflow.com/users/6067021/james-jordan"}, "edited": false, "score": 0, "creation_date": 1463575456, "post_id": 37299550, "comment_id": 62122382, "body": "@JamesJordan I have edited it with more comments so that it is more clear for you what some parts do"}, {"owner": {"reputation": 57, "user_id": 6067021, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2dc8bb1e4c8d0cfc84bd3a61fcac9f37?s=128&d=identicon&r=PG&f=1", "display_name": "James Jordan", "link": "https://stackoverflow.com/users/6067021/james-jordan"}, "edited": false, "score": 0, "creation_date": 1463575482, "post_id": 37299550, "comment_id": 62122407, "body": "Thanks Doug. But I am still no closer to the solution."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 57, "user_id": 6067021, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2dc8bb1e4c8d0cfc84bd3a61fcac9f37?s=128&d=identicon&r=PG&f=1", "display_name": "James Jordan", "link": "https://stackoverflow.com/users/6067021/james-jordan"}, "edited": false, "score": 0, "creation_date": 1463576008, "post_id": 37299550, "comment_id": 62122785, "body": "@JamesJordan try this"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 57, "user_id": 6067021, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2dc8bb1e4c8d0cfc84bd3a61fcac9f37?s=128&d=identicon&r=PG&f=1", "display_name": "James Jordan", "link": "https://stackoverflow.com/users/6067021/james-jordan"}, "edited": false, "score": 0, "creation_date": 1463576832, "post_id": 37299550, "comment_id": 62123426, "body": "@JamesJordan  I removed an End If that was not needed. You can see edited code"}, {"owner": {"reputation": 57, "user_id": 6067021, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2dc8bb1e4c8d0cfc84bd3a61fcac9f37?s=128&d=identicon&r=PG&f=1", "display_name": "James Jordan", "link": "https://stackoverflow.com/users/6067021/james-jordan"}, "edited": false, "score": 0, "creation_date": 1463577242, "post_id": 37299550, "comment_id": 62123706, "body": "@ Doug. We have taken a BIG step forward. The macro ran without any error and it was pretty neat seeing that the macro took 2.08secs! Thanks!! But, the data from the template file pasted everything into one column. All the data on the template sheet was in 4 columns. Actually, there are many files (templates) that need to be pasted on different master workbook on different sheets (sheet 5, sheet 7, sheet 13 etc.). How can I copy and paste the exact columns and rows for each template sheet?"}, {"owner": {"reputation": 57, "user_id": 6067021, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2dc8bb1e4c8d0cfc84bd3a61fcac9f37?s=128&d=identicon&r=PG&f=1", "display_name": "James Jordan", "link": "https://stackoverflow.com/users/6067021/james-jordan"}, "edited": false, "score": 0, "creation_date": 1463577488, "post_id": 37299550, "comment_id": 62123885, "body": "Basically, I need to copy and paste Xrows &amp; Ycolumns from a template sheet into Xrows &amp; Ycolumns on &quot;different&quot; sheets within the Master Workbook."}, {"owner": {"reputation": 57, "user_id": 6067021, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2dc8bb1e4c8d0cfc84bd3a61fcac9f37?s=128&d=identicon&r=PG&f=1", "display_name": "James Jordan", "link": "https://stackoverflow.com/users/6067021/james-jordan"}, "edited": false, "score": 0, "creation_date": 1463577715, "post_id": 37299550, "comment_id": 62124071, "body": "Should I post this question as Answered? Then post a new question about  pasting the copy and pasting the data into different locations etc?"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 57, "user_id": 6067021, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2dc8bb1e4c8d0cfc84bd3a61fcac9f37?s=128&d=identicon&r=PG&f=1", "display_name": "James Jordan", "link": "https://stackoverflow.com/users/6067021/james-jordan"}, "edited": false, "score": 0, "creation_date": 1463579074, "post_id": 37299550, "comment_id": 62125051, "body": "i can fix the offset issue. hold please"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 57, "user_id": 6067021, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2dc8bb1e4c8d0cfc84bd3a61fcac9f37?s=128&d=identicon&r=PG&f=1", "display_name": "James Jordan", "link": "https://stackoverflow.com/users/6067021/james-jordan"}, "edited": false, "score": 0, "creation_date": 1463579336, "post_id": 37299550, "comment_id": 62125254, "body": "@JamesJordan I have included some offset logic for you to use to get the desired results. And yes please mark as answered when you figure it out."}, {"owner": {"reputation": 57, "user_id": 6067021, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2dc8bb1e4c8d0cfc84bd3a61fcac9f37?s=128&d=identicon&r=PG&f=1", "display_name": "James Jordan", "link": "https://stackoverflow.com/users/6067021/james-jordan"}, "edited": false, "score": 0, "creation_date": 1463579397, "post_id": 37299550, "comment_id": 62125304, "body": "@ Doug. Thanks a lot. I will keep this as answered and post another question to get the location copy and paste of data right. Cheers!"}, {"owner": {"reputation": 57, "user_id": 6067021, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2dc8bb1e4c8d0cfc84bd3a61fcac9f37?s=128&d=identicon&r=PG&f=1", "display_name": "James Jordan", "link": "https://stackoverflow.com/users/6067021/james-jordan"}, "edited": false, "score": 0, "creation_date": 1463580453, "post_id": 37299550, "comment_id": 62126077, "body": "Ok, I will hold... I really appreciate your help."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 57, "user_id": 6067021, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2dc8bb1e4c8d0cfc84bd3a61fcac9f37?s=128&d=identicon&r=PG&f=1", "display_name": "James Jordan", "link": "https://stackoverflow.com/users/6067021/james-jordan"}, "edited": false, "score": 0, "creation_date": 1463581023, "post_id": 37299550, "comment_id": 62126524, "body": "@JamesJordan, I have already included the offset logic. Please review code"}, {"owner": {"reputation": 57, "user_id": 6067021, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2dc8bb1e4c8d0cfc84bd3a61fcac9f37?s=128&d=identicon&r=PG&f=1", "display_name": "James Jordan", "link": "https://stackoverflow.com/users/6067021/james-jordan"}, "edited": false, "score": 0, "creation_date": 1463584871, "post_id": 37299550, "comment_id": 62129515, "body": "Thanks Doug. I will give it a try... You have been very helpful."}], "tags": [], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "is_accepted": true, "score": 1, "last_activity_date": 1463579285, "last_edit_date": 1463579285, "creation_date": 1463574233, "answer_id": 37299550, "question_id": 37298439, "link": "https://stackoverflow.com/questions/37298439/copying-data-from-many-workbooks-to-a-summary-workbook-with-excel-vba-run-time/37299550#37299550", "title": "Copying data from many workbooks to a summary workbook with Excel-VBA. Run time errors", "body": "<p>Here is a template for what you'd like done. NOTE that forward slashes can cause run time error b/c vba handles them in an annoying way. </p>\n\n<pre><code> Sub DougsLoop()\n     Dim wbk As Workbook\n     Dim Filename As String\n     Dim path As String\n     Dim rCell As Range\n     Dim rRng As Range\n     Dim wsO As Worksheet\n     Dim StartTime As Double\n     Dim SecondsElapsed As Double\n     Dim sheet As Worksheet\n\n     Application.ScreenUpdating = False 'these three statements help performance by disabling the self titled in each, remeber to re-enable at end of code\n     Application.DisplayAlerts = False\n     Application.Calculation = xlCalculationManual\n\n     StartTime = Timer 'Starts timer to see how long code takes to execute. I like having this in macors that loop through files\n\n     path = \"C:\\Users\\jjordan\\Desktop\\Test Dir\\GA Test\" &amp; \"\\\" 'pay attention to this line of code********\n     Filename = Dir(path &amp; \"*.xl??\")\n     Set wsO = ThisWorkbook.Sheets(\"Sheet5\")\n\n     Do While Len(Filename) &gt; 0 'this tells the code to stop when there are no more files in the destination folder\n         DoEvents\n         Set wbk = Workbooks.Open(path &amp; Filename, True, True)\n             For Each sheet In ActiveWorkbook.Worksheets\n                Set rRng = sheet.Range(\"a2:n100\")\n                For Each rCell In rRng.Cells\n                    wsO.Cells(wsO.Rows.count, 1).End(xlUp).Offset(1, 0).Value = rCell\n                Next rCell\n             Next\n         wbk.Close False\n         Filename = Dir\n     Loop\n\n     Application.ScreenUpdating = True\n     Application.DisplayAlerts = True\n     Application.Calculation = xlCalculationAutomatic\n     SecondsElapsed = Round(Timer - StartTime, 2)\n     MsgBox \"This code ran successfully in \" &amp; SecondsElapsed &amp; \" seconds\", vbInformation\n End Sub\n</code></pre>\n\n<p>alter to this to your needs and you'll find it works perfectly :)</p>\n\n<p>EDIT: Also in your code you make use of COPY &amp; PASTE a lot. Try avoid doing this in the future. Try doing something:</p>\n\n<pre><code> ThisWorkbook.Sheets(\"Sheet1\").Range(\"a1\").Value = OtherWork.Sheets(\"Sheet1\").Range(\"a1\").Value\n</code></pre>\n\n<p>This is more efficient and wont bog down your code as much. </p>\n\n<p>here is some offset logic</p>\n\n<pre><code> wsO.Cells(wsO.Rows.count, 1).End(xlUp).Offset(1, 0).Value =\n wsO.Cells(wsO.Rows.count, 1).End(xlUp).Offset(0, 1).Value = \n wsO.Cells(wsO.Rows.count, 1).End(xlUp).Offset(0, 2).Value = \n</code></pre>\n\n<p>notice the Offset(x,y) value? Essentially x is down and y is right. this is of course referencing the original position. So to get a value to go in the same row but three columns over you would use \"Offset(0,3)\" etc etc</p>\n\n<p>Ill let you alter your code to do this. :)</p>\n\n<p>I guess actually trying to piece it together was a struggle? Here this version assumes the macro is in the master workbook(and that youre running it form the master). If you want to change go ahead, but this is as far as I go. At some point, you'll have to experiment on your own. </p>\n"}], "owner": {"reputation": 57, "user_id": 6067021, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2dc8bb1e4c8d0cfc84bd3a61fcac9f37?s=128&d=identicon&r=PG&f=1", "display_name": "James Jordan", "link": "https://stackoverflow.com/users/6067021/james-jordan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1014, "favorite_count": 0, "accepted_answer_id": 37299550, "answer_count": 1, "score": 0, "last_activity_date": 1463579346, "creation_date": 1463571371, "last_edit_date": 1463579346, "question_id": 37298439, "link": "https://stackoverflow.com/questions/37298439/copying-data-from-many-workbooks-to-a-summary-workbook-with-excel-vba-run-time", "title": "Copying data from many workbooks to a summary workbook with Excel-VBA. Run time errors", "body": "<p>I have files in a folder and I want to copy data from these files and paste them into another Master workbook sheet.</p>\n\n<p>I keep getting a runtime <code>error \u20181004\u2019</code>: Sorry we couldn\u2019t find C:\\Users\\jjordan\\Desktop\\Test Dir\\MASTER`, It is possible it was moved, renamed or deleted. </p>\n\n<p>The error is highlighted on this line of code: <code>Workbooks.Open SumPath &amp; SumName</code></p>\n\n<p>I have seen other questions similar to this on the web, I have tried making various changes. But still without success. Please advise.</p>\n\n<ul>\n<li>Dir for source files: <code>C:\\Users\\ jjordan \\Desktop\\Test Dir\\GA Test\\</code></li>\n<li>Dir for Master file:   <code>C:\\Users\\ jjordan \\Desktop\\Test Dir\\MASTER\\</code></li>\n<li>Source filenames differ, but all end in <code>\"*.xlsx.\"</code></li>\n<li>Master filename: <code>\" MASTER \u2013 Data List - 2016.xlsm \"</code> \u2018macro file</li>\n<li>Source worksheet name = <code>\"Supplier_Comments\"</code></li>\n<li><p>Master worksheet name = <code>\"Sheet5\"</code></p>\n\n<pre><code>Option Explicit\n\n Sub GetDataFromMaster()\n\n      Dim MyPath As String\n      Dim SumPath As String\n      Dim MyName As String\n      Dim SumName As String\n      Dim MyTemplate As String\n      Dim SumTemplate As String\n      Dim myWS As Worksheet\n      Dim sumWS As Worksheet\n\n     'Define folders and filenames\n      MyPath = \"C:\\Users\\jjordan\\Desktop\\Test Dir\\GA Test\\\"\n      SumPath = \"C:\\Users\\jjordan\\Desktop\\Test Dir\\MASTER\\\"\n\n      MyTemplate = \"*.xlsx\"  'Set the template.\n     SumTemplate = \"MASTER \u2013 Data List - 2016.xlsm\"\n\n     'Open the template file and get the Worksheet to put the data into\n     SumName = Dir(SumPath &amp; SumTemplate)\n     Workbooks.Open SumPath &amp; SumName\n     Set sumWS = ActiveWorkbook.Worksheets(\"Sheet5\")\n\n     'Open each source file, copying the data from each into the template file\n     MyName = Dir(MyPath &amp; MyTemplate)    'Retrieve the first file\n\n     Do While MyName &lt;&gt; \"\"\n\n    'Open the source file and get the worksheet with the data we want.\n     Workbooks.Open MyPath &amp; MyName\n     Set myWS = ActiveWorkbook.Worksheets(\"Suppliers_Comment\")\n    'Copy the data from the source and paste at the end of sheet 5\n     myWS.Range(\"A2:N100\").Copy\n     sumWS.Range(\"A65536\").End(xlUp).Offset(1, 0).PasteSpecial         Paste:=xlPasteValues\n     'Close the current sourcefile and get the next\n     Workbooks(MyName).Close SaveChanges:=False        'close\n     MyName = Dir                    'Get next file\n     Loop\n    'Now all sourcefiles are copied into the Template file. Close and save it\n     Workbooks(SumName).Close SaveChanges:=True\n\nEnd Sub\n</code></pre></li>\n</ul>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 6188549, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kjVlCZwsSto/AAAAAAAAAAI/AAAAAAAAAVs/X6eKFL6tStM/photo.jpg?sz=128", "display_name": "Hamid Ganai", "link": "https://stackoverflow.com/users/6188549/hamid-ganai"}, "edited": false, "score": 0, "creation_date": 1463575374, "post_id": 37298779, "comment_id": 62122319, "body": "@cundy I have one more question the excel sheet I am copying have formulas which derive data from previous sheets. can these formula refrences get updated automatically somehow?"}, {"owner": {"reputation": 98, "user_id": 6192281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f573a80b8dba72de5f7bc6ebb6377c5?s=128&d=identicon&r=PG&f=1", "display_name": "Cudny", "link": "https://stackoverflow.com/users/6192281/cudny"}, "reply_to_user": {"reputation": 7, "user_id": 6188549, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kjVlCZwsSto/AAAAAAAAAAI/AAAAAAAAAVs/X6eKFL6tStM/photo.jpg?sz=128", "display_name": "Hamid Ganai", "link": "https://stackoverflow.com/users/6188549/hamid-ganai"}, "edited": false, "score": 0, "creation_date": 1463666877, "post_id": 37298779, "comment_id": 62170599, "body": "You can change references in whole sheet simply using CTRL+H if i understood you correctly. If you want to add it to macro, use macro recorder and modify outcome for your needs."}], "tags": [], "owner": {"reputation": 98, "user_id": 6192281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f573a80b8dba72de5f7bc6ebb6377c5?s=128&d=identicon&r=PG&f=1", "display_name": "Cudny", "link": "https://stackoverflow.com/users/6192281/cudny"}, "is_accepted": false, "score": 3, "last_activity_date": 1463572276, "creation_date": 1463572276, "answer_id": 37298779, "question_id": 37298219, "link": "https://stackoverflow.com/questions/37298219/i-want-to-copy-the-content-of-immediate-previous-sheet-to-new-sheet-within-same/37298779#37298779", "title": "I want to copy the content of immediate previous sheet to new sheet within same work book", "body": "<p>Macro will ask you for name for new sheet and then copy last sheet.</p>\n\n<pre><code>Sub AddNewSheet()\nsheet_name_to_create = InputBox(\"Enter Sheet Name\")\nFor rep = 1 To (Worksheets.Count)\n    If LCase(Sheets(rep).Name) = LCase(sheet_name_to_create) Then\n    MsgBox \" This Sheet already exists\"\n    Exit Sub\n    End If\nNext\nSheets(Sheets.Count).Copy After:=Sheets(Sheets.Count)\nSheets(Sheets.Count).Name = sheet_name_to_create\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 6188549, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kjVlCZwsSto/AAAAAAAAAAI/AAAAAAAAAVs/X6eKFL6tStM/photo.jpg?sz=128", "display_name": "Hamid Ganai", "link": "https://stackoverflow.com/users/6188549/hamid-ganai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 403, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1463585973, "creation_date": 1463570770, "last_edit_date": 1463585973, "question_id": 37298219, "link": "https://stackoverflow.com/questions/37298219/i-want-to-copy-the-content-of-immediate-previous-sheet-to-new-sheet-within-same", "title": "I want to copy the content of immediate previous sheet to new sheet within same work book", "body": "<p>My work book have total of 7 sheets four of which are hidden. I want to </p>\n\n<ol>\n<li>Create A new Sheet using VBA</li>\n<li>copy all contents of Last sheet to above created new sheet</li>\n</ol>\n\n<p>i tried  using below code</p>\n\n<pre><code>sheet_name_to_create = InputBox(\"Enter Sheet Name\")\n\nFor rep = 1 To (Worksheets.count)\nIf LCase(Sheets(rep).Name) = LCase(sheet_name_to_create) Then\nMsgBox \" This Sheet already exists\"\nExit Sub\nEnd If\nNext\nActiveSheets.copy After:=Sheets(Sheets.count)\nSheets(ActiveSheet.Name).Name = sheet_name_to_create\n</code></pre>\n\n<p>but this code create new copies of all existing sheets(all 7 sheet i have in workbook).</p>\n\n<p>Please suggest the best possible soln.</p>\n\n<p>Thanks in advance for all your help!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1463573902, "post_id": 37298168, "comment_id": 62121245, "body": "Please read <a href=\"http://stackoverflow.com/help/how-to-ask\">How to Ask</a> and take the <a href=\"http://stackoverflow.com/tour\">Tour</a>. SO is not a code-server where you place orders for code/methods to do something. It is here to help you write your own code."}], "answers": [{"tags": [], "owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "is_accepted": false, "score": 1, "last_activity_date": 1463571220, "creation_date": 1463571220, "answer_id": 37298378, "question_id": 37298168, "link": "https://stackoverflow.com/questions/37298168/how-to-write-a-vba-code/37298378#37298378", "title": "how to write a vba code", "body": "<p>Turn on the Macro Recorder,  manually do what you are describing,  then look at the code generated by the recorder. You will have the steps you need.</p>\n"}], "owner": {"reputation": 1, "user_id": 6350544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d7876f20b9498766cfa6ed495230aa8?s=128&d=identicon&r=PG&f=1", "display_name": "Natarajan", "link": "https://stackoverflow.com/users/6350544/natarajan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1463571220, "creation_date": 1463570630, "question_id": 37298168, "link": "https://stackoverflow.com/questions/37298168/how-to-write-a-vba-code", "title": "how to write a vba code", "body": "<p>I am receiving 2 Excel workbooks namely DutyRoster, GangRoster. In DutyRoster Col-A: Locations (office, kitchen, accomodation, etc), Col-B:Shift (Morning/Night) Col-C: Date and Time (m:dd:yyyy hh:mm), Col-D: Number of people (in numbers).\nIn GangRoster, Months, dates and gang names (a, b, c, d). Ex. Row-2 January, Row-4:dates (1,2,3,...), Row-5: Gang-A, Row-6: Gang-B,.....\nI have to update datas in a separate Workbook (Master) in which Col-A: Locations (from 5th row), Row-2: Date, Row-3: Shift, Row-4: Gang (Row-2,3,4 from Col-B).\nHow to write a vba code or use a function to get the datas automatically for 'Master'from DutyRoster and GangRoster? </p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 127019, "user_id": 59303, "user_type": "moderator", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/gIt1g.png?s=128&g=1", "display_name": "ChrisF", "link": "https://stackoverflow.com/users/59303/chrisf"}, "edited": false, "score": 0, "creation_date": 1463570500, "post_id": 37297980, "comment_id": 62118792, "body": "What&#39;s the problem? If either text box is empty the code returns without doing anything. You don&#39;t need the <code>Else</code> just add your code that uses these values after the if statement."}, {"owner": {"reputation": 102, "user_id": 6350601, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/qRneh.jpg?s=128&g=1", "display_name": "Wolfie84367", "link": "https://stackoverflow.com/users/6350601/wolfie84367"}, "reply_to_user": {"reputation": 127019, "user_id": 59303, "user_type": "moderator", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/gIt1g.png?s=128&g=1", "display_name": "ChrisF", "link": "https://stackoverflow.com/users/59303/chrisf"}, "edited": false, "score": 0, "creation_date": 1463571858, "post_id": 37297980, "comment_id": 62119711, "body": "When I try to run the report with the fields blank I get the msgbox,, but when both textboxes have dates in the msgbox still shows but it should show the report"}], "answers": [{"comments": [{"owner": {"reputation": 102, "user_id": 6350601, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/qRneh.jpg?s=128&g=1", "display_name": "Wolfie84367", "link": "https://stackoverflow.com/users/6350601/wolfie84367"}, "edited": false, "score": 0, "creation_date": 1463577831, "post_id": 37299050, "comment_id": 62124167, "body": "The code you posted works, however When (me.txtStart.Value) textbox is empty, it doesn&#39;t recognise it as empty and runs the report."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 102, "user_id": 6350601, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/qRneh.jpg?s=128&g=1", "display_name": "Wolfie84367", "link": "https://stackoverflow.com/users/6350601/wolfie84367"}, "edited": false, "score": 0, "creation_date": 1463579020, "post_id": 37299050, "comment_id": 62125016, "body": "@Wolfie84367: <code>txtStart</code> should be a date field that accepts only NULL (empty) or a date. There should be no ambiguity possible. This is easiest done by assigning a &quot;Date&quot; format to the <code>Format</code> property of the textbox."}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 2, "last_activity_date": 1463573013, "creation_date": 1463573013, "answer_id": 37299050, "question_id": 37297980, "link": "https://stackoverflow.com/questions/37297980/if-then-else-function-in-access/37299050#37299050", "title": "If, then, else function in access", "body": "<p>Just use</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>If IsNull(Me.txtStart.Value) Or IsNull(Me.txtEnd.Value) Then\n    MsgBox \"Please ensure that both date fields are populated\"\n    Exit Sub\nEnd If\n' open the report here\n</code></pre>\n\n<p>No need to use <code>Else</code> after an <code>Exit Sub</code>. </p>\n\n<p>Actually I prefer this coding style for initial checks over large <code>Else</code> cases.</p>\n"}], "owner": {"reputation": 102, "user_id": 6350601, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/qRneh.jpg?s=128&g=1", "display_name": "Wolfie84367", "link": "https://stackoverflow.com/users/6350601/wolfie84367"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 446, "favorite_count": 0, "accepted_answer_id": 37299050, "answer_count": 1, "score": 0, "last_activity_date": 1463573013, "creation_date": 1463570166, "last_edit_date": 1463572080, "question_id": 37297980, "link": "https://stackoverflow.com/questions/37297980/if-then-else-function-in-access", "title": "If, then, else function in access", "body": "<p>I am using the below code in access.</p>\n\n<p>I am trying to set it so that the 2 text boxes can not be left blank, if they have dates in then it will proceed to generate a report.</p>\n\n<pre><code>    If IsNull(Me.txtStart.Value) Then\n    MsgBox \"Please ensure that both date fields are populated\"\n    Exit Sub\nElseIf IsNull(Me.txtEnd.Value) Then\n    MsgBox \"Please ensure that both date fields are populated\"\n    Exit Sub\nElse\nEnd If\n</code></pre>\n\n<p>Thank you in advance </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1370, "user_id": 2717068, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1443043394/picture?type=large", "display_name": "Lubo\u0161 Suk", "link": "https://stackoverflow.com/users/2717068/lubo%c5%a1-suk"}, "edited": false, "score": 1, "creation_date": 1463570543, "post_id": 37297857, "comment_id": 62118824, "body": "if sheets are on same index, you can use <code>Sheets(&quot;sheetNumber&quot;)</code> (without &quot;&quot;, so e.g Sheets(2)"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 1, "creation_date": 1463570575, "post_id": 37297857, "comment_id": 62118848, "body": "<code>Just hit me up if you need clarifications.</code> absolutely 100% need clarifications."}], "answers": [{"tags": [], "owner": {"reputation": 1370, "user_id": 2717068, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1443043394/picture?type=large", "display_name": "Lubo\u0161 Suk", "link": "https://stackoverflow.com/users/2717068/lubo%c5%a1-suk"}, "is_accepted": false, "score": 0, "last_activity_date": 1463570763, "creation_date": 1463570763, "answer_id": 37298218, "question_id": 37297857, "link": "https://stackoverflow.com/questions/37297857/sheets-that-have-almost-the-same-name/37298218#37298218", "title": "Sheets that have almost the same name", "body": "<p>As i said in comment, you can use sheets by number, or you can use something like this</p>\n\n<pre><code>Sub findSheet()\n\nDim sheetSubName As String\nsheetSubName = \"fluff\"\n\nDim currentSheet As Worksheet\n\nFor Each currentSheet In Sheets\n\n    If currentSheet.Name Like sheetSubName &amp; \"*\" Then\n        MsgBox \"do some stuff\"\n    End If\n\nNext currentSheet\n\nEnd Sub\n</code></pre>\n\n<p>When you comparing sheet name to string and regular character (in my example * so its anything). So this macro will work with sheet fluff, fluffy fluffiest etc.</p>\n\n<p>And everything to looping via <code>Sheets</code> (all sheet in workbook) and comparing their names via <code>Like</code> (something like = ) but it can use some basic regular expression. </p>\n"}, {"comments": [{"owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "edited": false, "score": 1, "creation_date": 1463572886, "post_id": 37298249, "comment_id": 62120463, "body": "will be better to remove casecensitivity using <code>Lcase</code> or <code>Ucase</code>, or <code>option compare text</code>, e.g. <code>Lcase(ws.Name) Like &quot;documents*&quot;</code>, otherwise might be some problems"}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": true, "score": 3, "last_activity_date": 1463572966, "last_edit_date": 1463572966, "creation_date": 1463570856, "answer_id": 37298249, "question_id": 37297857, "link": "https://stackoverflow.com/questions/37297857/sheets-that-have-almost-the-same-name/37298249#37298249", "title": "Sheets that have almost the same name", "body": "<p>Use a wildcard character to get the sheet first:</p>\n\n<pre><code>Function GetDocumentSheet(ByRef wb As Workbook) As Worksheet\n\n    For Each ws In wb.Sheets\n        If LCase$(ws.Name) Like \"documents*\" Then\n            Set GetDocumentSheet = ws\n            GoTo SheetFound:\n        End If\n    Next\n\n    Set GetDocumentSheet = Nothing\n\nSheetFound:    \nEnd Function\n</code></pre>\n\n<p>In your code:</p>\n\n<pre><code>Set mySheet = GetDocumentSheet(x) '// where 'x' is your workbook object\n</code></pre>\n\n<p>Then reference</p>\n\n<pre><code>mySheet.UsedRange\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 6222804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a11d01c9d735b1753ef31832256f8692?s=128&d=identicon&r=PG&f=1", "display_name": "Cheno Arias", "link": "https://stackoverflow.com/users/6222804/cheno-arias"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 37298249, "answer_count": 2, "score": 1, "last_activity_date": 1463572966, "creation_date": 1463569831, "question_id": 37297857, "link": "https://stackoverflow.com/questions/37297857/sheets-that-have-almost-the-same-name", "title": "Sheets that have almost the same name", "body": "<p>Im trying to open and copy the cells from a sheet from a different excel file. I have no problem in opening, copying and closing the excel file that I need.In this case, I have <code>With x.Sheets(\"Documents\").UsedRange</code>. Most files that I needed to copy the cells from have \"Documents\" as a sheet name, but some have \"Documents\" + other different characters (example, \"DocuemntsEX\"). When I tried to copy, it shows 'Subscript Out-of-range' since the \"DocumentEX\" is different from \"Document\". Is there any way that I can retain the specific name of the sheet, since most of the files have that name? Is there any code that can help me to access those sheet with a different sheetname? Just hit me up if you need clarifications. </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 1, "last_activity_date": 1463569821, "creation_date": 1463569821, "answer_id": 37297853, "question_id": 37297755, "link": "https://stackoverflow.com/questions/37297755/refuse-save-if-cell-contains-text/37297853#37297853", "title": "Refuse save if cell contains text", "body": "<p>Try this instead rather than looping:</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n\n    Cancel = Not Sheet1.Range(\"A1:A5000\").Find(\"Fill in a comment\") Is Nothing\n    If Cancel Then MsgBox \"Fill in a comment\", vbCritical, \"Error!\"\n\nEnd Sub\n</code></pre>\n\n<p>It uses the <code>.Find()</code> method to look for <code>\"Fill in a comment\"</code> and if it isn't <code>Nothing</code> then <code>Cancel</code> is set to <code>True</code></p>\n\n<p>Then, we test the value of <code>Cancel</code> to see if we need to display the message box.</p>\n\n<p>Doing it this way also makes sure that you don't get 500 message boxes if you have <code>\"Fill in a comment\"</code> written in 500 different cells in that range...</p>\n"}], "owner": {"reputation": 11, "user_id": 6350517, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/06ffdb3da5bcf8f0c9fd1c987880bb42?s=128&d=identicon&r=PG&f=1", "display_name": "donkeykong", "link": "https://stackoverflow.com/users/6350517/donkeykong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1487268653, "creation_date": 1463569583, "last_edit_date": 1531161705, "question_id": 37297755, "link": "https://stackoverflow.com/questions/37297755/refuse-save-if-cell-contains-text", "title": "Refuse save if cell contains text", "body": "<p>I have this code, that refuses and cancels to save a workbook if a cell contains a specific text. the code is working fine, but if i want it to refuse saving if some cells in a range contains specific text then it is not working. my code below that is working:</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\nIf Sheets(\"Sheet1\").Range(\"A1\").Value = \"Fill in a comment\" Then\n    Cancel = True\n    Response = MsgBox(\"Fill in a comment\", vbCritical, \"Error!\")\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>the code that i tried to make it work but its not</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean\n\n For Each c In Sheet1.Range(\"A1:A5000\")\n        If c.Value = \"Fill in a comment\" Then\n             Cancel = True\n              Response = MsgBox(\"Fill in a comment\", vbCritical, \"Error!\")\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>do you guys have any ideas?</p>\n"}, {"tags": ["vba", "function", "excel"], "comments": [{"owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "edited": false, "score": 0, "creation_date": 1463570619, "post_id": 37297739, "comment_id": 62118874, "body": "Look into the Microsoft Scripting Runtime (File Scripting Object (FSO)). It really good for folder and file navigation and manipulation."}, {"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "reply_to_user": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "edited": false, "score": 1, "creation_date": 1463574454, "post_id": 37297739, "comment_id": 62121632, "body": "@GaryEvans I think you meant File SYSTEM object <a href=\"https://msdn.microsoft.com/en-us/library/aa242706%28v=vs.60%29.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/aa242706%28v=vs.60%29.aspx</a>"}, {"owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "edited": false, "score": 1, "creation_date": 1463578079, "post_id": 37297739, "comment_id": 62124361, "body": "Yes sorry, File System Object (has features like FolderExists and FileExists that can help here). Although looking at the question, I think you will need to open each file, the Author is stored within the file as a proprietary property. The fact that you see it in Explorer properties window is more down to good integration."}, {"owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "edited": false, "score": 1, "creation_date": 1463578557, "post_id": 37297739, "comment_id": 62124687, "body": "Try this: <a href=\"http://stackoverflow.com/questions/5651890/using-vba-to-get-extended-file-attributes\" title=\"using vba to get extended file attributes\">stackoverflow.com/questions/5651890/&hellip;</a>"}, {"owner": {"reputation": 179, "user_id": 3891475, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3833b60e0c1468cc250b6afea0ba18af?s=128&d=identicon&r=PG&f=1", "display_name": "Adavid02", "link": "https://stackoverflow.com/users/3891475/adavid02"}, "reply_to_user": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "edited": false, "score": 0, "creation_date": 1464025597, "post_id": 37297739, "comment_id": 62303290, "body": "@Tim I get an &quot;object does not support this method&quot; error using the syntax objFile.BuiltinDocumentProperties(&quot;Owner&quot;)"}, {"owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "edited": false, "score": 1, "creation_date": 1464028118, "post_id": 37297739, "comment_id": 62304614, "body": "Owner is a filesystem property. Author is a document property. To find out the Owner you can query the filesystem: <code>objFolder.GetDetailsOf(objFolderItem, xx)</code>. To get Author, you have to open/read it from the document, and that will vary depending on file type. If it is an Office file and you don&#39;t want to actually open it, use the <a href=\"https://www.microsoft.com/en-us/download/details.aspx?id=8422\" rel=\"nofollow noreferrer\">Microsoft Developer Support OLE File Property Reader</a>"}, {"owner": {"reputation": 179, "user_id": 3891475, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3833b60e0c1468cc250b6afea0ba18af?s=128&d=identicon&r=PG&f=1", "display_name": "Adavid02", "link": "https://stackoverflow.com/users/3891475/adavid02"}, "reply_to_user": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "edited": false, "score": 0, "creation_date": 1464174296, "post_id": 37297739, "comment_id": 62373407, "body": "@Tim Thanks for the resource. I got the  Microsoft Developer Support OLE File Property Reader, but Im having trouble figuring out how to use it to get the owner property. That&#39;s my lack of knowledge so I&#39;d say your comment suffices as the answer."}, {"owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "edited": false, "score": 0, "creation_date": 1464188780, "post_id": 37297739, "comment_id": 62384654, "body": "The Scripting Guys have an excellent tutorial on the use of <a href=\"https://technet.microsoft.com/en-us/library/ee692828.aspx\" rel=\"nofollow noreferrer\">DSOFile.dll</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "is_accepted": false, "score": 1, "last_activity_date": 1464189420, "last_edit_date": 1464189420, "creation_date": 1464189029, "answer_id": 37441158, "question_id": 37297739, "link": "https://stackoverflow.com/questions/37297739/modify-excel-vba-function-for-file-properties/37441158#37441158", "title": "Modify Excel VBA Function for File Properties", "body": "<p>In fact, <a href=\"https://technet.microsoft.com/en-us/library/ee692828.aspx\" rel=\"nofollow\">The Scripting Guys</a> have exactly the code you are looking for: </p>\n\n<pre><code>Set objFile = CreateObject(\"DSOFile.OleDocumentProperties\")\nobjFile.Open(\"C:\\Scripts\\New_users.xls\")\nDebug.Print \"Author: \" &amp; objFile.SummaryProperties.Author\n</code></pre>\n\n<p>Even though this does not require adding a reference to DSOFile.dll, it does require that it be installed so your workbook is still not very portable. You could add a function that looks for DSOFile.dll and directs the user to the download page if it is not found.</p>\n\n<p>I would still recommend late binding like this because you shouldn't run into any version dependencies this way. If you specifically add a reference to DSOFile.dll and a new version comes out, it may not have exactly the same name and then your code breaks. </p>\n\n<p>Of course, I <em>would</em> recommend initially adding a reference when first writing the code so you can take advantage of Intellisense, but make sure to change it to late binding once your code is written.</p>\n\n<p>Early binding:</p>\n\n<pre><code>Dim objFile As New DSOFile.OleDocumentProperties\nobjFile.Open(\"C:\\Scripts\\New_users.xls\")\n</code></pre>\n\n<p>Then change it to Late binding:</p>\n\n<pre><code>Dim objFile As Object 'New DSOFile.OleDocumentProperties\nSet objFile = CreateObject(\"DSOFile.OleDocumentProperties\")\nobjFile.Open(\"C:\\Scripts\\New_users.xls\")\n</code></pre>\n"}], "owner": {"reputation": 179, "user_id": 3891475, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3833b60e0c1468cc250b6afea0ba18af?s=128&d=identicon&r=PG&f=1", "display_name": "Adavid02", "link": "https://stackoverflow.com/users/3891475/adavid02"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5405, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1464189420, "creation_date": 1463569534, "question_id": 37297739, "link": "https://stackoverflow.com/questions/37297739/modify-excel-vba-function-for-file-properties", "title": "Modify Excel VBA Function for File Properties", "body": "<p>How can I modify this code to give details of each file in the object folder?\nCurrently when I run it I just get the details of the folder and not the files in the folder. The specific details I need are the owner, author, date modified, and name. I don't know if this can be done within the function, but I would like to hyperlink to the name to the actual file so I would also need the name's path. </p>\n\n<pre><code>    Option Explicit \n\nType FileAttributes \n    Name As String \n    Size As String \n    FileType As String \n    DateModified As Date \n    DateCreated As Date \n    DateAccessed As Date \n    Attributes As String \n    Status As String \n    Owner As String \n    Author As String \n    Title As String \n    Subject As String \n    Category As String \n    Comments As String \n    Keywords As String \nEnd Type \n\nPublic Function GetFileAttributes(strFilePath As String) As FileAttributes \n     ' Shell32 objects\n    Dim objShell As Shell32.Shell \n    Dim objFolder As Shell32.Folder \n    Dim objFolderItem As Shell32.FolderItem \n\n     ' Other objects\n    Dim strPath As String \n    Dim strFileName As String \n    Dim i As Integer \n\n     ' If the file does not exist then quit out\n    If Dir(strFilePath) = \"\" Then Exit Function \n\n     ' Parse the file name out from the folder path\n    strFileName = strFilePath \n    i = 1 \n    Do Until i = 0 \n        i = InStr(1, strFileName, \"\\\", vbBinaryCompare) \n        strFileName = Mid(strFileName, i + 1) \n    Loop \n    strPath = Left(strFilePath, Len(strFilePath) - Len(strFileName) - 1) \n\n     ' Set up the shell32 Shell object\n    Set objShell = New Shell \n\n     ' Set the shell32 folder object\n    Set objFolder = objShell.Namespace(strPath) \n\n     ' If we can find the folder then ...\n    If (Not objFolder Is Nothing) Then \n\n         ' Set the shell32 file object\n        Set objFolderItem = objFolder.ParseName(strFileName) \n\n         ' If we can find the file then get the file attributes\n        If (Not objFolderItem Is Nothing) Then \n\n            GetFileAttributes.Name = objFolder.GetDetailsOf(objFolderItem, 0) \n            GetFileAttributes.Size = objFolder.GetDetailsOf(objFolderItem, 1) \n            GetFileAttributes.FileType = objFolder.GetDetailsOf(objFolderItem, 2) \n            GetFileAttributes.DateModified = CDate(objFolder.GetDetailsOf(objFolderItem, 3)) \n            GetFileAttributes.DateCreated = CDate(objFolder.GetDetailsOf(objFolderItem, 4)) \n            GetFileAttributes.DateAccessed = CDate(objFolder.GetDetailsOf(objFolderItem, 5)) \n            GetFileAttributes.Attributes = objFolder.GetDetailsOf(objFolderItem, 6) \n            GetFileAttributes.Status = objFolder.GetDetailsOf(objFolderItem, 7) \n            GetFileAttributes.Owner = objFolder.GetDetailsOf(objFolderItem, 8) \n            GetFileAttributes.Author = objFolder.GetDetailsOf(objFolderItem, 9) \n            GetFileAttributes.Title = objFolder.GetDetailsOf(objFolderItem, 10) \n            GetFileAttributes.Subject = objFolder.GetDetailsOf(objFolderItem, 11) \n            GetFileAttributes.Category = objFolder.GetDetailsOf(objFolderItem, 12) \n            GetFileAttributes.Comments = objFolder.GetDetailsOf(objFolderItem, 14) \n            GetFileAttributes.Keywords = objFolder.GetDetailsOf(objFolderItem, 40) \n\n        End If \n\n        Set objFolderItem = Nothing \n\n    End If \n\n    Set objFolder = Nothing \n    Set objShell = Nothing \n\nEnd Function \n</code></pre>\n"}, {"tags": ["vba", "ms-word", "word-2007", "word-2003"], "comments": [{"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 1, "creation_date": 1463570816, "post_id": 37297731, "comment_id": 62119012, "body": "Put it inside the button&#39;s click event? Not clear what you&#39;re asking..."}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1463571650, "post_id": 37297731, "comment_id": 62119562, "body": "It makes more sense now.  Wasn&#39;t sure if you were asking how to make the button fire the macro or if you were asking how to make it work through all the checkboxes."}, {"owner": {"reputation": 615, "user_id": 6236294, "user_type": "registered", "accept_rate": 96, "profile_image": "https://graph.facebook.com/10204431270580592/picture?type=large", "display_name": "Ibn e Ashiq", "link": "https://stackoverflow.com/users/6236294/ibn-e-ashiq"}, "reply_to_user": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1463571821, "post_id": 37297731, "comment_id": 62119691, "body": "step 1: user checked marks  step 2: user click <code>ok</code> step 3: after ok vba will perform macro on marked countries"}], "answers": [{"comments": [{"owner": {"reputation": 615, "user_id": 6236294, "user_type": "registered", "accept_rate": 96, "profile_image": "https://graph.facebook.com/10204431270580592/picture?type=large", "display_name": "Ibn e Ashiq", "link": "https://stackoverflow.com/users/6236294/ibn-e-ashiq"}, "edited": false, "score": 0, "creation_date": 1463574038, "post_id": 37298594, "comment_id": 62121343, "body": "how do I <code>Select All</code> checkbox in single click."}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "reply_to_user": {"reputation": 615, "user_id": 6236294, "user_type": "registered", "accept_rate": 96, "profile_image": "https://graph.facebook.com/10204431270580592/picture?type=large", "display_name": "Ibn e Ashiq", "link": "https://stackoverflow.com/users/6236294/ibn-e-ashiq"}, "edited": false, "score": 1, "creation_date": 1463574434, "post_id": 37298594, "comment_id": 62121622, "body": "Add a checkbox called Select All and in its click event, where its value is true, set all the individual checkboxes to true.  You could use similar code to the answer provided above."}, {"owner": {"reputation": 615, "user_id": 6236294, "user_type": "registered", "accept_rate": 96, "profile_image": "https://graph.facebook.com/10204431270580592/picture?type=large", "display_name": "Ibn e Ashiq", "link": "https://stackoverflow.com/users/6236294/ibn-e-ashiq"}, "edited": false, "score": 0, "creation_date": 1463639293, "post_id": 37298594, "comment_id": 62150891, "body": "I think <code>Select All</code> is another question that&#39;s why I added new question. kindly take a look at my Question related to Select All.<a href=\"http://stackoverflow.com/questions/37315117/more-than-one-select-all-checkboxes-for-each-frame\">Link</a>"}], "tags": [], "owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "is_accepted": true, "score": 1, "last_activity_date": 1463571793, "creation_date": 1463571793, "answer_id": 37298594, "question_id": 37297731, "link": "https://stackoverflow.com/questions/37297731/perform-a-macro-by-checkbox-input/37298594#37298594", "title": "Perform a macro by Checkbox Input", "body": "<p>Try iterating over the controls and firing the macro where the checkbox is set to True:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim ctl As Control\nDim j As Long\nFor Each ctl In Me.Controls\n    If TypeOf ctl Is MSForms.CheckBox Then\n        If Me.Controls(ctl.Name).Value = True Then\n            ' Fire macro with ctl.Caption to identify the country\n        End If\n    End If\nNext    \nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 615, "user_id": 6236294, "user_type": "registered", "accept_rate": 96, "profile_image": "https://graph.facebook.com/10204431270580592/picture?type=large", "display_name": "Ibn e Ashiq", "link": "https://stackoverflow.com/users/6236294/ibn-e-ashiq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 655, "favorite_count": 0, "accepted_answer_id": 37298594, "answer_count": 1, "score": 0, "last_activity_date": 1463583258, "creation_date": 1463569491, "last_edit_date": 1463583258, "question_id": 37297731, "link": "https://stackoverflow.com/questions/37297731/perform-a-macro-by-checkbox-input", "title": "Perform a macro by Checkbox Input", "body": "<p>I have <code>Check-Boxes</code> with caption of country Names and a <code>OK</code> button on <code>User-form</code>,</p>\n\n<p><a href=\"https://i.stack.imgur.com/m0LEo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/m0LEo.png\" alt=\"enter image description here\"></a></p>\n\n<p>User will <code>Mark</code> required <code>Check-Boxes</code> and click <code>OK</code> to submit the form.</p>\n\n<p><strong>Expected Result:</strong> For each checked <code>Box</code> there is a <code>Macro</code> to perform. </p>\n\n<p>How do I make <code>OK</code> button to perform macro on Selected Countries which are Check-Marked by User?</p>\n\n<p>and </p>\n\n<p>Is the following code correctly handle the situation? or there is other way of doing that?</p>\n\n<pre><code>If ActiveDocument.CeemeaFinallist.EasternEurope(\"CheckBox1\").CheckBox.Value = True Then\nApplication.Run MacroName:=\"Normal.NewMacros.CEEMEA2\"\nElse\nEnd If\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/95C2n.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/95C2n.png\" alt=\"enter image description here\"></a></p>\n\n<p>How do I <code>Select all</code> <code>Check-Boxes</code> at once?</p>\n"}, {"tags": ["excel", "vba", "charts"], "comments": [{"owner": {"reputation": 7547, "user_id": 6019417, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/nA455.jpg?s=128&g=1", "display_name": "J. Chomel", "link": "https://stackoverflow.com/users/6019417/j-chomel"}, "edited": false, "score": 0, "creation_date": 1463571962, "post_id": 37297498, "comment_id": 62119782, "body": "Hi Brian, it&#39;s not very clear what&#39;s you&#39;re trying. Could you post an image of what your data looks like?"}], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 5956071, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a942991f3b19567185f3dad2076f194e?s=128&d=identicon&r=PG", "display_name": "Brian", "link": "https://stackoverflow.com/users/5956071/brian"}, "edited": false, "score": 0, "creation_date": 1463573751, "post_id": 37299165, "comment_id": 62121122, "body": "Ah excellent.  Yes that was what I was trying to do. Now I need to put in some error checking around existing sheets rather than add a new one each iteration, but that is great thanks."}], "tags": [], "owner": {"reputation": 879, "user_id": 6340326, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QaG3S.png?s=128&g=1", "display_name": "Carrosive", "link": "https://stackoverflow.com/users/6340326/carrosive"}, "is_accepted": true, "score": 0, "last_activity_date": 1463573325, "creation_date": 1463573325, "answer_id": 37299165, "question_id": 37297498, "link": "https://stackoverflow.com/questions/37297498/excel-2007-create-a-number-of-charts-with-vba/37299165#37299165", "title": "Excel 2007 Create a number of charts with VBA", "body": "<p>Where a range is referenced you are able to use a variable to 'move' the reference on each iteration. \nTake for example you want to insert some text into the first 10 Rows of Column A, you could write:</p>\n\n<pre><code>Range(\"A1\").Value = \"Hello\"\nRange(\"A2\").Value = \"Hello\"\nRange(\"A3\").Value = \"Hello\"\nRange(\"A4\").Value = \"Hello\"\netc...\n</code></pre>\n\n<p>Instead you could use a loop which 'moves' the <code>Range</code> reference down a row on each iteration by using the loop variable <code>i</code>:</p>\n\n<pre><code>For i = 1 to 10\n    Range(\"A\" &amp; i).Value = \"Hello\"\nNext i\n</code></pre>\n\n<p>You can also adjust the reference in line if required to achieve a desired result, for example <code>Range(\"A\" &amp; i * 2).Value = \"Hello\"</code> will add text to the even rows 2-20 by multiplying the value of <code>i</code> by 2.</p>\n\n<p>Where you want to repeat the loop for each row you have in your data, you can find the row number of the bottom row using <code>Range(\"\").End(xlDown).Row</code> whilst putting the top cell reference in the <code>\"\"</code> marks , in your case \"A3\"</p>\n\n<p>Putting all this together, you're looking for something along the lines of:</p>\n\n<pre><code>for i = 3 to Range(\"A3\").End(xlDown).Row   'Loop for each row from 3 to the bottom\n    Charts.Add\n    ActiveChart.ChartType = xlColumnClustered\n    ActiveChart.SetSourceData Source:=Sheets(\"Data\").Range(\"A\" &amp; i)\n    ActiveChart.SeriesCollection(1).Name = \"='Data'!$A\" &amp; i\n    ActiveChart.SeriesCollection(1).Values = \"='Data'!$MO\" &amp; i &amp; \":$RY\" &amp; i\n    ActiveChart.SeriesCollection(1).XValues = \"='Data'!$MO$1:$RY$1\"\n    ActiveChart.Name = Sheets(\"Data\").Range(\"A\" &amp; i)\nnext i\n</code></pre>\n\n<p>You will probably need to tweak the above if it doesn't work exactly how you expected, but I hope this helps you to figure it out.</p>\n"}], "owner": {"reputation": 121, "user_id": 5956071, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a942991f3b19567185f3dad2076f194e?s=128&d=identicon&r=PG", "display_name": "Brian", "link": "https://stackoverflow.com/users/5956071/brian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 37299165, "answer_count": 1, "score": 1, "last_activity_date": 1528937782, "creation_date": 1463568884, "last_edit_date": 1592644375, "question_id": 37297498, "link": "https://stackoverflow.com/questions/37297498/excel-2007-create-a-number-of-charts-with-vba", "title": "Excel 2007 Create a number of charts with VBA", "body": "<p>I have been trying to create a number of charts using VBA.  I used the Macro record function to get started but have not progressed much.</p>\n<p>I have a variable data set for which I need to chart each row.  One cell is the series name, the data is a (fixed) range of cells on the same row and plotted against a series of dates (top row).</p>\n<p>So what I have is this (for a single chart)</p>\n<pre><code>Charts.Add\nActiveChart.ChartType = xlColumnClustered\nActiveChart.SetSourceData Source:=Sheets(&quot;Data&quot;).Range(&quot;A3&quot;)\nActiveChart.SeriesCollection(1).Name = &quot;='Data'!$A$3&quot;\nActiveChart.SeriesCollection(1).Values = &quot;='Data'!$MO$3:$RY$3&quot;\nActiveChart.SeriesCollection(1).XValues = &quot;='Data'!$MO$1:$RY$1&quot;\nActiveChart.Name = Sheets(&quot;Data&quot;).Range(&quot;A3&quot;)\n</code></pre>\n<p>If <code>A3</code> is the first cell with the name data in, I want to loop round each row generating a new chart for each series.</p>\n<p>I have managed to get the start point in from an input box, but that is not really necessary. It is for me to use not for others. I'd be happy if it started at a fixed point and cycled through until it reaches a blank cell.</p>\n<p>The bit I cannot do, is work out how to generate the cell ranges for each iteration.</p>\n<h3>screenshot of data</h3>\n<p><img src=\"https://i.stack.imgur.com/uMu9n.png\" alt=\"screenshot of data\" /></p>\n<h3>Screenshot of example Chart</h3>\n<p><img src=\"https://i.stack.imgur.com/f7vdY.png\" alt=\"Screenshot of example Chart\" /></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1463567076, "post_id": 37296461, "comment_id": 62116465, "body": "Could you post your real code please as that clearly won&#39;t run."}], "answers": [{"tags": [], "owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "is_accepted": true, "score": 0, "last_activity_date": 1463568117, "creation_date": 1463568117, "answer_id": 37297190, "question_id": 37296461, "link": "https://stackoverflow.com/questions/37296461/rage-to-table-on-all-sheets/37297190#37297190", "title": "rage to table on all sheets", "body": "<p>Try replacing following line</p>\n\n<pre><code>.ListObjects.Add(xlSrcRange, .Range(\"A2005:AD3005\"), , xlYes).ListObjects.TableStyle = \"TableStyleMedium9\"\n</code></pre>\n\n<p>to</p>\n\n<pre><code>.ListObjects.Add(xlSrcRange, .Range(\"A2005:AD3005\"), , xlYes).TableStyle = \"TableStyleMedium9\"\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 6316308, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/231572a02ff447ef13a5d9c763906245?s=128&d=identicon&r=PG&f=1", "display_name": "Fcarboni", "link": "https://stackoverflow.com/users/6316308/fcarboni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 37297190, "answer_count": 1, "score": -1, "last_activity_date": 1463568117, "creation_date": 1463566094, "last_edit_date": 1463567400, "question_id": 37296461, "link": "https://stackoverflow.com/questions/37296461/rage-to-table-on-all-sheets", "title": "rage to table on all sheets", "body": "<p>With the following VBA I am trying to loop through all sheets (except the two mentioned) and insert a table in the range A2005toAD3005.</p>\n\n<pre><code>For Each wsvar5 In ThisWorkbook.Sheets\n    With wsvar5\n        If wsvar5.Name &lt;&gt; \"timekeeper code\" And wsvar5.Name &lt;&gt; \"Bill Date\" Then\n            .ListObjects.Add(xlSrcRange, .Range(\"A2005:AD3005\"), , xlYes).ListObjects.TableStyle = \"TableStyleMedium9\"\n        End If\n    End With\nNext wsvar5\nEnd Sub\n</code></pre>\n\n<p>this works for the first sheet and then stops and throws up the following <a href=\"http://i.stack.imgur.com/IfYKv.png\" rel=\"nofollow\">Error</a>\nthis does not over lap any tables as it works on the first sheet and all other sheets are in the same format.</p>\n\n<p>Ive had a search online and can't seem to find the right fix!</p>\n\n<p>Thanks in advanced</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 307, "user_id": 2307513, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1365051299/picture?type=large", "display_name": "Bart Koolhaas", "link": "https://stackoverflow.com/users/2307513/bart-koolhaas"}, "edited": false, "score": 0, "creation_date": 1463575780, "post_id": 37297168, "comment_id": 62122633, "body": "Thanks Macro Man! Hmmmm, the value in the cell (y2) is just the number of seconds, not the time the procedure started. Im not sure how the Earliest Time value can ever be the same, as &quot;Now&quot; as used to start the timer is quite different from the &quot;Now&quot; used to stop the timer (the difference between the two is stored in cell y2). So if this would be the case, the code should never work. I suspect you are correct, that the issue lies in the rounding... But referencing to the cell as in your example doesnt work unfortunately :("}, {"owner": {"reputation": 307, "user_id": 2307513, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1365051299/picture?type=large", "display_name": "Bart Koolhaas", "link": "https://stackoverflow.com/users/2307513/bart-koolhaas"}, "edited": false, "score": 0, "creation_date": 1463577968, "post_id": 37297168, "comment_id": 62124275, "body": "Right; I had tried storing the time in that public variable as well. Somehow it results in the timer no longer counting second by second, but racing like a stopwatch. I then need to press break for the code to stop executing/looping. I then thought to use an IF statement to only update the StartTime variable if its 0 (i.e. new). This also fails to work.. :("}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 0, "last_activity_date": 1463576736, "last_edit_date": 1592644375, "creation_date": 1463568067, "answer_id": 37297168, "question_id": 37296401, "link": "https://stackoverflow.com/questions/37296401/vba-runtime-1004-error/37297168#37297168", "title": "VBA runtime 1004 error", "body": "<p>The <em>[Earliest Time]</em> value should be the same as originally set when scheduling the sub to <code>False</code>. Times are rounded to the nearest second which is why you're probably getting away with it sometimes. Seeing as you assign the value of the time to a cell, reference that cell instead of setting the time in your code:</p>\n<pre><code>Public StartTime As Single\nPublic FinalTime As Single\n\nSub starttimer()\n\nStartTime = Now + TimeValue(&quot;00:00:01&quot;)\nApplication.OnTime StartTime, &quot;nexttick&quot;\n\nEnd Sub\n\nSub Nexttick()\nSheet1.Range(&quot;y2&quot;).Value = Sheet1.Range(&quot;y2&quot;).Value + TimeValue(&quot;00:00:01&quot;)\nstarttimer\nEnd Sub\n\nSub Stoptimer()\nWith ThisWorkbook.Worksheets(&quot;Home&quot;)\nApplication.OnTime StartTime, &quot;nexttick&quot;, , False\nEnd With\n    Sheets(&quot;Log&quot;).Range(&quot;c10000&quot;).End(xlUp).Offset(1, 0) = Format(Sheet1.Range(&quot;y2&quot;).Value, &quot;h:mm:ss&quot;)\n\n    Sheets(&quot;Home&quot;).Range(&quot;y2&quot;).Value = 0\nEnd Sub\n</code></pre>\n<hr />\n<p><em><strong>Reference:</strong></em> <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196165.aspx#Anchor_1\" rel=\"nofollow noreferrer\">Application.OnTime Method (Excel)</a></p>\n<blockquote>\n<p>The value of <em>EarliestTime</em> is rounded to the closest second.</p>\n<p>Set <em>Schedule</em> to <strong>false</strong> to clear a procedure previously set with the same\n<em>Procedure</em> and <em>EarliestTime</em> values.</p>\n</blockquote>\n"}], "owner": {"reputation": 307, "user_id": 2307513, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1365051299/picture?type=large", "display_name": "Bart Koolhaas", "link": "https://stackoverflow.com/users/2307513/bart-koolhaas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 283, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1463576736, "creation_date": 1463565977, "last_edit_date": 1463566296, "question_id": 37296401, "link": "https://stackoverflow.com/questions/37296401/vba-runtime-1004-error", "title": "VBA runtime 1004 error", "body": "<p>I'm having problems with a runtime 1004 error in VBA. I made a time registration tool, to measure time needed for specific actions. The weird thing is, that the code works perfectly 9 out of 10 times. Just that 1 out of 10 times it generates this runtime error. I cannot see what is causing this problem! I don't do anything different, yet it generates this error once in a while.... </p>\n\n<p>I did google and searched for this runtime error in combination with the Application.Ontime function, but I think its defined the way it should? Below is  the code, which I in turn found somewhere else on the net. There is a worksheet with commandbuttons (each for a specific activity) and once pressed, the StartTimer procedure is called (in a seperate module), press again and the StopTimer procedure (in a seperate module) is called. The error is (sometimes) generated in the StopTimer sub.</p>\n\n<pre><code>Public StartTime As Single\nPublic FinalTime As Single\n\nSub starttimer()\n\nApplication.OnTime Now + TimeValue(\"00:00:01\"), \"nexttick\"\n\nEnd Sub\n\nSub Nexttick()\nSheet1.Range(\"y2\").Value = Sheet1.Range(\"y2\").Value + TimeValue(\"00:00:01\")\nstarttimer\nEnd Sub\n\nSub Stoptimer()\nWith ThisWorkbook.Worksheets(\"Home\")\nApplication.OnTime Now + TimeValue(\"00:00:01\"), \"nexttick\", , False\nEnd With\n    Sheets(\"Log\").Range(\"c10000\").End(xlUp).Offset(1, 0) = Format(Sheet1.Range(\"y2\").Value, \"h:mm:ss\")\n\n    Sheets(\"Home\").Range(\"y2\").Value = 0\nEnd Sub\n</code></pre>\n\n<p>Its driving me nuts, especially since it works most of the time! Hope someone can help me out here :)</p>\n\n<p>Thanks in advance!!</p>\n\n<p>Bart</p>\n\n<p><a href=\"http://i.stack.imgur.com/R9PTb.jpg\" rel=\"nofollow\">Runtime error</a></p>\n\n<p><a href=\"http://i.stack.imgur.com/Bw1V9.jpg\" rel=\"nofollow\">Code thats generating the error</a></p>\n"}, {"tags": ["xml", "excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 6349965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/812bea65d17f9b9fc31078cf5f94664a?s=128&d=identicon&r=PG&f=1", "display_name": "Acla", "link": "https://stackoverflow.com/users/6349965/acla"}, "edited": false, "score": 0, "creation_date": 1463580233, "post_id": 37297058, "comment_id": 62125923, "body": "Unfortunately this excel add-in is not working with 64-bit."}, {"owner": {"reputation": 879, "user_id": 6340326, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QaG3S.png?s=128&g=1", "display_name": "Carrosive", "link": "https://stackoverflow.com/users/6340326/carrosive"}, "reply_to_user": {"reputation": 21, "user_id": 6349965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/812bea65d17f9b9fc31078cf5f94664a?s=128&d=identicon&r=PG&f=1", "display_name": "Acla", "link": "https://stackoverflow.com/users/6349965/acla"}, "edited": false, "score": 0, "creation_date": 1463581499, "post_id": 37297058, "comment_id": 62126889, "body": "@Acla can you elaborate on that with a specific error message? I&#39;m guessing that your specific macro is 32-bit and you&#39;re trying to add it to a 64-bit installation of Excel? Try adding <code>PtrSafe</code> after any <code>Declare</code> statements"}], "tags": [], "owner": {"reputation": 879, "user_id": 6340326, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QaG3S.png?s=128&g=1", "display_name": "Carrosive", "link": "https://stackoverflow.com/users/6340326/carrosive"}, "is_accepted": false, "score": 1, "last_activity_date": 1463567728, "creation_date": 1463567728, "answer_id": 37297058, "question_id": 37295877, "link": "https://stackoverflow.com/questions/37295877/xml-export-with-excel-vba-code/37297058#37297058", "title": "XML export with Excel vba code", "body": "<p>I think you may be getting confused between saving an <code>XML Data</code> file and an <code>Excel Add-In</code> (you may have seen this called an <code>XML Add-in</code>).</p>\n\n<p>By using <code>Save As</code> and selecting the <code>XML Data</code> file type, Excel will produce an XML file with the data contained only on your worksheets and so no VBA is saved. An <code>Excel Add-In</code> though is a file containing macro information so you can quite easily add the macros it contains to another installation of Excel, I believe this is the goal you are trying to achieve.</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/gg597509(v=office.14).aspx\" rel=\"nofollow\">This webpage</a> helped me a lot when I first learned how to create add-ins, and it also includes information on creating custom ribbon UI's for your macros; <a href=\"https://support.office.com/en-gb/article/Add-or-remove-add-ins-64d3d147-98fb-4b82-8833-709d54e3ace1\" rel=\"nofollow\">And this webpage</a> contains instructions on adding / removing Add-ins.</p>\n"}], "owner": {"reputation": 21, "user_id": 6349965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/812bea65d17f9b9fc31078cf5f94664a?s=128&d=identicon&r=PG&f=1", "display_name": "Acla", "link": "https://stackoverflow.com/users/6349965/acla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 320, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1463567728, "creation_date": 1463564668, "last_edit_date": 1463566008, "question_id": 37295877, "link": "https://stackoverflow.com/questions/37295877/xml-export-with-excel-vba-code", "title": "XML export with Excel vba code", "body": "<p>I would like to ask if it's somehow possible to include some <a href=\"/questions/tagged/vba\" class=\"post-tag\" title=\"show questions tagged &#39;vba&#39;\" rel=\"tag\">vba</a> code in an XML file? </p>\n\n<p>After an export of my excel file to xml I cannot see it. </p>\n\n<p>My goal is to create excel with macros from xml.</p>\n"}, {"tags": ["sql", "ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 5277443, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0a08d8ebd41566c7276476c6aa3ff090?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/5277443/peter"}, "edited": false, "score": 0, "creation_date": 1463570736, "post_id": 37296208, "comment_id": 62118957, "body": "Thanks a lot for the quick response. I added the VBA Function as modul and I can see it under the access objetives as modul. But in the query i get the error: &quot;Function unknown&quot;. What do I have to follow when I add the modul?"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 21, "user_id": 5277443, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0a08d8ebd41566c7276476c6aa3ff090?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/5277443/peter"}, "edited": false, "score": 0, "creation_date": 1463572457, "post_id": 37296208, "comment_id": 62120135, "body": "@Peter: the function can&#39;t &quot;be&quot; a module, it must be inside a module. Like in this example: <a href=\"http://www.techonthenet.com/access/tutorials/vbabasics2010/basics01.php\" rel=\"nofollow noreferrer\">techonthenet.com/access/tutorials/vbabasics2010/basics01.php</a> . Open the Immediate Window with Ctrl+G, type <code>? SplitPipes(&quot;abc|def&quot;, 1) &lt;return&gt;</code>. Does that work?"}, {"owner": {"reputation": 21, "user_id": 5277443, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0a08d8ebd41566c7276476c6aa3ff090?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/5277443/peter"}, "edited": false, "score": 0, "creation_date": 1463574684, "post_id": 37296208, "comment_id": 62121797, "body": "Hi, i added it in a module. Here a Screenshot: <a href=\"https://www.dropbox.com/s/fhj82rwki39a2hn/Unbenannt6.PNG?dl=0\" rel=\"nofollow noreferrer\">dropbox.com/s/fhj82rwki39a2hn/Unbenannt6.PNG?dl=0</a>"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 21, "user_id": 5277443, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0a08d8ebd41566c7276476c6aa3ff090?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/5277443/peter"}, "edited": false, "score": 0, "creation_date": 1463576797, "post_id": 37296208, "comment_id": 62123404, "body": "@Peter: Ah, I see. Giving the module the same name as the function can confuse Access. Rename the module to e.g. <code>mSplit</code>. --- After that, calling the function from a query should work. If not, please edit your question and add the full SQL of the SELECT query."}, {"owner": {"reputation": 21, "user_id": 5277443, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0a08d8ebd41566c7276476c6aa3ff090?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/5277443/peter"}, "edited": false, "score": 0, "creation_date": 1463647765, "post_id": 37296208, "comment_id": 62156246, "body": "Now it works. Thanks a lot. One more question. Sometimes the Pipe delimited field has less values and less Pipes. Then the VBA function does not work. It is possible to add a error handling for this?"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 21, "user_id": 5277443, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0a08d8ebd41566c7276476c6aa3ff090?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/5277443/peter"}, "edited": false, "score": 0, "creation_date": 1463652411, "post_id": 37296208, "comment_id": 62159571, "body": "@Peter: yes: by checking <code>UBound(arSplit)</code>, see edit."}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 3, "last_activity_date": 1463655727, "last_edit_date": 1463655727, "creation_date": 1463565493, "answer_id": 37296208, "question_id": 37295807, "link": "https://stackoverflow.com/questions/37295807/parse-a-pipe-delimited-field-into-seperate-fields-ms-access-2007-2013/37296208#37296208", "title": "Parse a PIPE delimited field into seperate fields (MS ACCESS 2007-2013)", "body": "<p>You need a VBA function in a standard module to implement the splitting, e.g.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Function SplitPipes(str As String, i As Long) As String\n\n    Dim arSplit As Variant\n\n    arSplit = Split(str, \"|\")\n    ' Check that arSplit has enough elements\n    If i - 1 &lt;= UBound(arSplit) Then\n        ' Split creates a 0-based array, but it is easier to start with index 1 in the query\n        SplitPipes = arSplit(i - 1)\n    Else\n        ' out of elements -&gt; return empty string\n        SplitPipes = \"\"\n    End If\n\nEnd Function\n</code></pre>\n\n<p>Then you can use this function for every single field like this:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT SplitPipes([Strategic Group],1) AS Destination, \n       SplitPipes([Strategic Group],2) AS SE,\n       ...\nFROM yourTable;\n</code></pre>\n\n<p><s>Note that the function currently has no error handling whatsoever.</s> Added :)</p>\n"}], "owner": {"reputation": 21, "user_id": 5277443, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0a08d8ebd41566c7276476c6aa3ff090?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/5277443/peter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1022, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1463655727, "creation_date": 1463564518, "last_edit_date": 1463565750, "question_id": 37295807, "link": "https://stackoverflow.com/questions/37295807/parse-a-pipe-delimited-field-into-seperate-fields-ms-access-2007-2013", "title": "Parse a PIPE delimited field into seperate fields (MS ACCESS 2007-2013)", "body": "<p>I have a database in MC Access 2017-2013 where the fields are stored as a PIPE delimited string. Now I want a way to parse these fields in a SELECT query in separate fields.</p>\n\n<p>Here an example of my database and the PIPE delimited field:\n<a href=\"https://i.stack.imgur.com/4VqAN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4VqAN.png\" alt=\"Database Example\"></a></p>\n\n<p>The field contains 9 Pipes. So I want to separate the field in 10 fields.</p>\n\n<p>Here an example of the Output:\n<a href=\"https://i.stack.imgur.com/EDyaP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EDyaP.png\" alt=\"Output Example\"></a></p>\n\n<p>I would be great, if someone could help me.<br>\nThanks,\nPeter</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "is_accepted": true, "score": 4, "last_activity_date": 1463564633, "creation_date": 1463564633, "answer_id": 37295862, "question_id": 37295188, "link": "https://stackoverflow.com/questions/37295188/excel-macro-to-rename-the-file-extension/37295862#37295862", "title": "Excel macro to rename the file extension", "body": "<p>Try following code:</p>\n\n<pre><code>Sub RenameFiles()\n    Dim StrFile As String, newName As String\n    Dim filePath As Variant\n    filePath = ActiveWorkbook.Path &amp; \"\\\"\n    StrFile = Dir(filePath &amp; \"*.xml\")\n    Do While Len(StrFile) &gt; 0\n        newName = Replace(StrFile, \".xml\", \".qml\")\n        Name filePath &amp; StrFile As filePath &amp; newName\n        StrFile = Dir\n    Loop\nEnd Sub\n</code></pre>\n\n<p><strong>NOTE</strong>: Code will rename all <code>.xml</code> files to <code>.qml</code> so its better to take the back up before executing the code.</p>\n"}], "owner": {"reputation": 137, "user_id": 5969580, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/666cb6d60f25b477159cd3b68a1393ba?s=128&d=identicon&r=PG&f=1", "display_name": "Siraj", "link": "https://stackoverflow.com/users/5969580/siraj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5687, "favorite_count": 1, "accepted_answer_id": 37295862, "answer_count": 1, "score": 0, "last_activity_date": 1463589448, "creation_date": 1463562961, "last_edit_date": 1463589448, "question_id": 37295188, "link": "https://stackoverflow.com/questions/37295188/excel-macro-to-rename-the-file-extension", "title": "Excel macro to rename the file extension", "body": "<p>I am naive to scripts, and I started working with Excel macros. I am looking for a macro to rename only the file extension from *.xml to *.qml. The *.xml file is in the same workbook path. So, I appreciate if anyone could help in this.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 1, "creation_date": 1463563424, "post_id": 37294473, "comment_id": 62113966, "body": "It&#39;s very unclear what you are trying to achieve and there are a number of issues with your code, including using x when it&#39;s never declared, initialised or set to anything, using Lastrow_Y without ever setting it to the last row...  First all the issues need fixed, and then if you can explain clearly what it is you want to achieve and what you have tried to do it, we can assist."}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1463566547, "post_id": 37294473, "comment_id": 62116069, "body": "Where is <code>d</code> set before this line? <code>Set x = Master_workbook.Sheets(&quot;WWF&quot;).Range(&quot;AY&quot; &amp; d)</code>  Was this meant to be <code>c</code>?  You should really use more meaningful variable names so that it&#39;s clear what each variable represents."}, {"owner": {"reputation": 153, "user_id": 4863712, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/14fb10132886c0ea33bef2046a7c9d2f?s=128&d=identicon&r=PG&f=1", "display_name": "buddha sreekanth", "link": "https://stackoverflow.com/users/4863712/buddha-sreekanth"}, "reply_to_user": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1463566899, "post_id": 37294473, "comment_id": 62116319, "body": "@Dave  still is there anything to be clear? could you please let me know."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1463567570, "post_id": 37294473, "comment_id": 62116830, "body": "You have given code which presumably doesn&#39;t do what you want it to -- what is the actual problem with the code? Is there any specific issue beyond the fact that it doesn&#39;t work? Also -- maybe put <code>Option Explicit</code> at the top of your module and see if it compiles. The comments make it clear that you aren&#39;t using that. For code of this complexity that is almost asking for a bug."}, {"owner": {"reputation": 153, "user_id": 4863712, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/14fb10132886c0ea33bef2046a7c9d2f?s=128&d=identicon&r=PG&f=1", "display_name": "buddha sreekanth", "link": "https://stackoverflow.com/users/4863712/buddha-sreekanth"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1463572286, "post_id": 37294473, "comment_id": 62120010, "body": "@JohnColeman The code works fine but When I run the code it should create a new workbook with the names of <code>Y</code> column which are not in <code>X</code> column rather it creating again with the names in the <code>Y</code> column."}], "answers": [{"comments": [{"owner": {"reputation": 153, "user_id": 4863712, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/14fb10132886c0ea33bef2046a7c9d2f?s=128&d=identicon&r=PG&f=1", "display_name": "buddha sreekanth", "link": "https://stackoverflow.com/users/4863712/buddha-sreekanth"}, "edited": false, "score": 0, "creation_date": 1463580763, "post_id": 37297184, "comment_id": 62126325, "body": "its working perfect. Thank you vey much for your help. Is there any other way to get folder without giving the path, <code>Set folder = fso.GetFolder(&lt;path to your .xlsx files here&gt;)</code>? please let me know"}, {"owner": {"reputation": 153, "user_id": 4863712, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/14fb10132886c0ea33bef2046a7c9d2f?s=128&d=identicon&r=PG&f=1", "display_name": "buddha sreekanth", "link": "https://stackoverflow.com/users/4863712/buddha-sreekanth"}, "edited": false, "score": 0, "creation_date": 1463581389, "post_id": 37297184, "comment_id": 62126789, "body": "every month i need to run this code. I have to change the path in the code  everytime instead of changing the code, it would be better to put something else."}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "reply_to_user": {"reputation": 153, "user_id": 4863712, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/14fb10132886c0ea33bef2046a7c9d2f?s=128&d=identicon&r=PG&f=1", "display_name": "buddha sreekanth", "link": "https://stackoverflow.com/users/4863712/buddha-sreekanth"}, "edited": false, "score": 0, "creation_date": 1463581730, "post_id": 37297184, "comment_id": 62127045, "body": "or define a new folder each month? Start by defining the folder name you want to use with (for example) <code>folderName = &quot;C:\\temp\\&quot; &amp; MonthName(Month(Now),True) &amp; Year(Now)</code> followed by a <code>objFSO.CreateFolder(folderName)</code> so that if it&#39;s run once a month it creates a folder (currently it&#39;d be &quot;May2016&quot;) for you to place the work into?"}, {"owner": {"reputation": 153, "user_id": 4863712, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/14fb10132886c0ea33bef2046a7c9d2f?s=128&d=identicon&r=PG&f=1", "display_name": "buddha sreekanth", "link": "https://stackoverflow.com/users/4863712/buddha-sreekanth"}, "edited": false, "score": 0, "creation_date": 1464082493, "post_id": 37297184, "comment_id": 62326106, "body": "I have some problem with the code which you have written. I have modified your code according to my need but now i need that if the workbook or file is existed it should have to re-execute the file or workbook again rather its executing only once, if i run the macro multiple times. could you please help me out."}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "reply_to_user": {"reputation": 153, "user_id": 4863712, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/14fb10132886c0ea33bef2046a7c9d2f?s=128&d=identicon&r=PG&f=1", "display_name": "buddha sreekanth", "link": "https://stackoverflow.com/users/4863712/buddha-sreekanth"}, "edited": false, "score": 0, "creation_date": 1464086163, "post_id": 37297184, "comment_id": 62328662, "body": "I haven&#39;t seen what you modified the code to be so can&#39;t really advise on that... perhaps post a new question with the code included so the full context is given?"}, {"owner": {"reputation": 153, "user_id": 4863712, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/14fb10132886c0ea33bef2046a7c9d2f?s=128&d=identicon&r=PG&f=1", "display_name": "buddha sreekanth", "link": "https://stackoverflow.com/users/4863712/buddha-sreekanth"}, "edited": false, "score": 0, "creation_date": 1464090603, "post_id": 37297184, "comment_id": 62331778, "body": "Now I have edited your code. and I want to see the newbook_scm to be executed again when I run the macro for the first time it works fine but if i ran the macro for multiple times its not replace the newbook_scm with old one."}], "tags": [], "owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "is_accepted": true, "score": 1, "last_activity_date": 1463568111, "creation_date": 1463568111, "answer_id": 37297184, "question_id": 37294473, "link": "https://stackoverflow.com/questions/37294473/how-to-put-rest-of-uniques-values-in-array-if-condition-is-not-equal-using-vba-e/37297184#37297184", "title": "How to put rest of uniques values in array if condition is not equal using vba excel", "body": "<p>Seems to me like it'd be a lot easier to check the current folder for which files you have already created, then just create the ones in range Y that aren't already there?</p>\n\n<pre><code>Option Explicit\n\nDim fso : Set fso = CreateObject(\"Scripting.FileSystemObject\")\nDim folder : Set folder = fso.GetFolder(&lt;path to your .xlsx files here&gt;)\nDim file, fileNames, lastRowY, row, checkFile, newBook\nFor Each file in folder.Files\n    If Right(file.Name, 4) = \"xlsx\" Then\n        fileNames = fileNames &amp; file.Name &amp; \";\"         ' will give a list of all filenames\n    End If\nNext\n\nWith Master_workbook.Worksheets(\"FBI\")\n       lastRowY = .Cells(.Rows.Count, \"AY\").End(xlUp).Row\nEnd With\n\nFor row = 2 to lastRowY\n    checkFile = Master_workbook.Worksheets(\"FBI\").Range(\"AY\").Value\n    If Instr(fileNames, checkFile) = 0 Then\n       Set newBook = Workbooks.Add\n       ' do whatever with newBook\n       newBook.SaveAs (checkFile &amp; \".xlsx\")\n       newBook.Close\n    End If\nNext\n</code></pre>\n"}], "owner": {"reputation": 153, "user_id": 4863712, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/14fb10132886c0ea33bef2046a7c9d2f?s=128&d=identicon&r=PG&f=1", "display_name": "buddha sreekanth", "link": "https://stackoverflow.com/users/4863712/buddha-sreekanth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 37297184, "answer_count": 1, "score": 0, "last_activity_date": 1463568111, "creation_date": 1463561048, "last_edit_date": 1463566610, "question_id": 37294473, "link": "https://stackoverflow.com/questions/37294473/how-to-put-rest-of-uniques-values-in-array-if-condition-is-not-equal-using-vba-e", "title": "How to put rest of uniques values in array if condition is not equal using vba excel", "body": "<p>I have two different uniques values( X, Y) which I have already done so far. I want to put the remaining uniques values in array if condition <code>x&lt;&gt;y</code> is not equal and need to create a workbook with array values(rest of uniques values).</p>\n\n<p>Ex: </p>\n\n<pre><code>X               Y\nSAP           Siemens\nSiemens       otto\nOtto          Allianz AG\nAccenture     Oracle\nOracle        Capgemini\nTCS           Daimler\nInfosys       Akka\n</code></pre>\n\n<p>I already have workbook as \"Siemens.xlsx\", \"Oracle.xlsx\",\"Otto.xlsx\". Now i need the rest of unique values of column Y in array. My expected result should be \"Akka.xlsx\", \"Allainz AG. xlsx\", \"Daimler.xlsx\".</p>\n\n<p>Code:</p>\n\n<pre><code>Sub array()\n\n    Dim y as range\n    Dim c as integer\n    Dim Lastrow_Y As Integer\n    Dim Lastrow_X As Integer\n    Dim rngFilter_Y as range\n    Dim rngCopy as range\n    Dim NewBook as workbook\n\n    With Master_workbook.Worksheets(\"FBI\")\n            Sheets(\"FBI\").Columns(\"C:C\").AdvancedFilter Action:=xlFilterCopy, _\n             CopyToRange:=.Range(\"AZ1\"), Unique:=True\n             Lastrow_Y = .Cells(.Rows.Count, \"AY\").End(xlUp).Row\n   End with\n\n   With Master_workbook.Worksheets(\"WWF\")\n            Sheets(\"WWF\").Columns(\"d:d\").AdvancedFilter Action:=xlFilterCopy, _\n             CopyToRange:=.Range(\"AY1\"), Unique:=True\n             Lastrow_X = .Cells(.Rows.Count, \"AY\").End(xlUp).Row\n   End with\n\n    For c = 2 To Lastrow_Y\n                    Set y = Master_workbook.Sheets(\"FBI\").Range(\"AZ\" &amp; c)\n                    Set x = Master_workbook.Sheets(\"WWF\").Range(\"AY\" &amp; c) \n                        If x = y Then\n                        set NewBook = workbooks.add\n                            with NewBook \n                              .Title = y    NewBook.Worksheets.Add(After:=.Sheets(.Sheets.Count)).Name = \"www\"\n                             With rngFilter_Y\n\n                                    .AutoFilter field:=32, Criteria1:=\"&lt;&gt;(a)  0 - 360\", Operator:=xlFilterValues\n                                    .AutoFilter field:=37, Criteria1:=y.Value, Operator:=xlFilterValues\n\n                                    Set rngCopy = .SpecialCells(xlCellTypeVisible)\n                                                        .AutoFilter ' Switch off AutoFilter\n                             End With\n                        .SaveAs Filename:= Y &amp; \".xlsx\"\n\n                         rngCopy.Copy NewBook.Worksheets(\"www\").Cells(1, 1)\n\n                        Else\n                        End If\n       Next    \n\n    End sub\n</code></pre>\n\n<p>I would really appreciate if anyone help me out of this. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1463560627, "post_id": 37293876, "comment_id": 62112109, "body": "What do you mean by &quot;it doesn&#39;t work?&quot;"}, {"owner": {"reputation": 4930, "user_id": 5276188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N2sAW.jpg?s=128&g=1", "display_name": "Doktor OSwaldo", "link": "https://stackoverflow.com/users/5276188/doktor-oswaldo"}, "edited": false, "score": 1, "creation_date": 1463560892, "post_id": 37293876, "comment_id": 62112267, "body": "one possible easier Approach ist to lock the worksheet and protect it with a Password. <a href=\"https://msdn.microsoft.com/en-us/library/office/ff840611.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff840611.aspx</a>"}, {"owner": {"reputation": 51, "user_id": 4920140, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6b68cf54bc6278adb517a1075a4a5d66?s=128&d=identicon&r=PG&f=1", "display_name": "Ikanagura", "link": "https://stackoverflow.com/users/4920140/ikanagura"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1463561160, "post_id": 37293876, "comment_id": 62112441, "body": "@MacroMan : Error 400 :/ DoktorOSwaldo : Error 400 too, I placed it at the end of the macro Test(), it is ok ?"}, {"owner": {"reputation": 51, "user_id": 4920140, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6b68cf54bc6278adb517a1075a4a5d66?s=128&d=identicon&r=PG&f=1", "display_name": "Ikanagura", "link": "https://stackoverflow.com/users/4920140/ikanagura"}, "edited": false, "score": 0, "creation_date": 1463561298, "post_id": 37293876, "comment_id": 62112535, "body": "Me culpa, it works, thanks !"}], "answers": [{"tags": [], "owner": {"reputation": 156, "user_id": 6219524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be82ab7ad90aa19b4df8add5fcc2d244?s=128&d=identicon&r=PG&f=1", "display_name": "csanjose", "link": "https://stackoverflow.com/users/6219524/csanjose"}, "is_accepted": false, "score": 0, "last_activity_date": 1463561008, "creation_date": 1463561008, "answer_id": 37294458, "question_id": 37293876, "link": "https://stackoverflow.com/questions/37293876/vba-saving-a-workbook-without-ability-to-change-content/37294458#37294458", "title": "VBA - Saving a workbook without ability to change content", "body": "<pre><code>ActiveWorkbook.ChangeFileAccess Mode:=xlReadOnly\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 4920140, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6b68cf54bc6278adb517a1075a4a5d66?s=128&d=identicon&r=PG&f=1", "display_name": "Ikanagura", "link": "https://stackoverflow.com/users/4920140/ikanagura"}, "edited": false, "score": 1, "creation_date": 1463561499, "post_id": 37294547, "comment_id": 62112663, "body": "Thanks, I found a solution but I will need this solution in the future ! :)"}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 2, "last_activity_date": 1463561241, "creation_date": 1463561241, "answer_id": 37294547, "question_id": 37293876, "link": "https://stackoverflow.com/questions/37293876/vba-saving-a-workbook-without-ability-to-change-content/37294547#37294547", "title": "VBA - Saving a workbook without ability to change content", "body": "<p>If you want to make the workbook <em>un-saveable</em> you can do the following instead:</p>\n\n<p>In the <code>ThisWorkbook</code> module use:</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n\n Cancel = True\n\nEnd Sub\n</code></pre>\n\n<p>Then got to the immediate window (press <kbd>Ctrl</kbd> + <kbd>G</kbd>) and type:</p>\n\n<p><code>Application.EnableEvents = False</code> - hit <kbd>Enter</kbd><br>\n   <code>ThisWorkbook.Save</code> - hit <kbd>Enter</kbd><br>\n   <code>Application.EnableEvents = True</code> - hit <kbd>Enter</kbd>  </p>\n\n<p>Now when a user tries to save the workbook it will simply cancel the save, meaning the data can't be <em>permanently</em> overwritten.</p>\n"}, {"tags": [], "owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "is_accepted": false, "score": 0, "last_activity_date": 1463562537, "creation_date": 1463562537, "answer_id": 37295026, "question_id": 37293876, "link": "https://stackoverflow.com/questions/37293876/vba-saving-a-workbook-without-ability-to-change-content/37295026#37295026", "title": "VBA - Saving a workbook without ability to change content", "body": "<p>Read-only is a file system permission not one controlled by Excel</p>\n\n<p>Read-only recommended is the Excel controlled version of it in with the user is prompted to open it as read-only (but they can choose no).</p>\n\n<p>To save a copy of a workbook as read-only recommended you need to: -</p>\n\n<ol>\n<li>Save a copy using <code>SaveCopyAs</code></li>\n<li>Open the copy</li>\n<li>Save the copy using <code>SaveAs</code> with the property <code>ReadOnlyRecommended</code> set to true</li>\n<li>Delete the previous copy made in the first instruction</li>\n</ol>\n\n<p>Below is a small example of this:-\n    Public Sub Make_Copy_ReadOnlyRec()\n    Dim WkBk As Excel.Workbook</p>\n\n<pre><code>'Using SaveCopyAs\nThisWorkbook.SaveCopyAs Environ(\"UserProfile\") &amp; \"\\Desktop\\Temp.xlsm\"\n\n'Open the copy\nSet WkBk = Application.Workbooks.Open(Environ(\"UserProfile\") &amp; \"\\Desktop\\Temp.xlsm\")\n\n    'Use save as to make it read only recommended\n    WkBk.SaveAs Environ(\"UserProfile\") &amp; \"\\Desktop\\Sample.xlsm\", XlFileFormat.xlOpenXMLWorkbookMacroEnabled, , , True\n\n    'Close the now read only recommended copy\n    WkBk.Close\nSet WkBk = Nothing\n\n'Delete the original copy\nKill Environ(\"UserProfile\") &amp; \"\\Desktop\\Temp.xlsm\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 4920140, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6b68cf54bc6278adb517a1075a4a5d66?s=128&d=identicon&r=PG&f=1", "display_name": "Ikanagura", "link": "https://stackoverflow.com/users/4920140/ikanagura"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 670, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1463562537, "creation_date": 1463559302, "question_id": 37293876, "link": "https://stackoverflow.com/questions/37293876/vba-saving-a-workbook-without-ability-to-change-content", "title": "VBA - Saving a workbook without ability to change content", "body": "<p>I have a macro which create a copy of a workbook in VBA. I want this copy \"Read Only\", but the property <code>ReadOnly := True</code> dosen't work.\nCan you help me ? Here's the code :</p>\n\n<p>The first macro :</p>\n\n<pre><code>Sub SaveXL()\n\nDim Nom2 As String\nDim Jour2 As String\nDim FPath2 As String\nJour2 = Format(Now(), \"yyyymmdd - h\\hmm\")\nNom2 = Jour2 &amp; \" Pricelist\"\nFPath2 = Sheets(\"PARAM\").Range(\"B33\").Value\nOn Error GoTo fin4\nfichier = Application.GetSaveAsFilename(FPath2 &amp; Nom2, \"Fichiers Excel (*.xls), *.xls\")\nIf fichier &lt;&gt; \"Faux\" Then\n    ActiveWorkbook.SaveCopyAs fichier\n    VBA.SetAttr fichier, vbReadOnly\n    Test GetAName(fichier)\nElse\n    MsgBox \"Le fichier n'a pas \u00e9t\u00e9 enregistr\u00e9\"\nEnd If\nExit Sub\nfin4:         MsgBox \"La cr\u00e9ation de l'excel a \u00e9chou\u00e9\"\nEnd Sub\n</code></pre>\n\n<p>The second :</p>\n\n<pre><code>Sub Test(targetWorkbookName As String)\nDim F As Integer, C As Integer, derniereligne\nDim targetWorkbook As Workbook\nOn Error Resume Next\nSet targetWorkbook = Workbooks(targetWorkbookName)\nOn Error GoTo 0\nIf (targetWorkbook Is Nothing) Then _\n    Set targetWorkbook = Workbooks.Open(Filename := targetWorkbookName, ReadOnly := True)\n\nFor F = 1 To Sheets.Count\n    ActiveSheet.Select\n    For C = 15 To 2 Step -1\n        ActiveSheet.Columns(C).Select\n        Selection.End(xlDown).Select\n        derniereligne = ActiveCell.Row\n        If ActiveSheet.Columns(C).Hidden = True Then\n            ActiveSheet.Columns(C).Delete\n        End If\n    Next C\nNext F\nApplication.DisplayAlerts = False\nSheets(\"PARAM\").Delete\n ActiveWorkbook.ActiveSheet.Shapes.Range(Array(\"Button 2\")).Select\n            Selection.Delete\n ActiveWorkbook.ActiveSheet.Shapes.Range(Array(\"Button 9\")).Select\n            Selection.Delete\n\ntargetWorkbook.SaveAs Filename:=targetWorkbookName,    FileFormat:=xlOpenXMLWorkbook\nEnd Sub\n</code></pre>\n\n<p>Thanks !</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 1, "last_activity_date": 1463558513, "creation_date": 1463558513, "answer_id": 37293628, "question_id": 37293553, "link": "https://stackoverflow.com/questions/37293553/expected-array-in-simple-cycle/37293628#37293628", "title": "Expected array in simple cycle", "body": "<p>You didn't declare your variables as arrays. You need:</p>\n\n<pre><code>Dim C_1(1 to 11) As Double \nDim C_2(1 to 11) As Double\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6346494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5eacd9d82b183c12fb2245796fb2d809?s=128&d=identicon&r=PG&f=1", "display_name": "Klara W.", "link": "https://stackoverflow.com/users/6346494/klara-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "closed_date": 1463558954, "answer_count": 1, "score": 0, "last_activity_date": 1463558513, "creation_date": 1463558315, "last_edit_date": 1531164843, "question_id": 37293553, "link": "https://stackoverflow.com/questions/37293553/expected-array-in-simple-cycle", "closed_reason": "Duplicate", "title": "Expected array in simple cycle", "body": "<p>Please, could your find what is wrong? \nI have simple VBA makro but still Expected array.</p>\n\n<pre><code>Dim C_1 As Double \nDim C_2 As Double\n\n    For k = 1 To 6\n        C_1(k) = 19\n        C_2(k) = 11\n    Next k\n\n     For k = 7 To 11\n        C_1(k) = 29\n        C_2(k) = 19\n    Next k\n</code></pre>\n\n<p>Thanks a lot</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 10287, "user_id": 2545784, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4zVa6.png?s=128&g=1", "display_name": "LS_\u1d05\u1d07\u1d20", "link": "https://stackoverflow.com/users/2545784/ls-%e1%b4%85%e1%b4%87%e1%b4%a0"}, "edited": false, "score": 0, "creation_date": 1463557638, "post_id": 37292961, "comment_id": 62110243, "body": "Why don&#39;t you use a PivotTable?"}, {"owner": {"reputation": 1843, "user_id": 5793786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77c8c934fd9b5dcd38885b22e9bdeff7?s=128&d=identicon&r=PG", "display_name": "Maarten van Stam", "link": "https://stackoverflow.com/users/5793786/maarten-van-stam"}, "edited": false, "score": 0, "creation_date": 1463557924, "post_id": 37292961, "comment_id": 62110421, "body": "Are you sure your variable a does not exceed 32,767 on large sheets as it is defined as Integer?"}, {"owner": {"reputation": 43, "user_id": 6176543, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154057635899787/picture?type=large", "display_name": "Sarahjem", "link": "https://stackoverflow.com/users/6176543/sarahjem"}, "reply_to_user": {"reputation": 10287, "user_id": 2545784, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4zVa6.png?s=128&g=1", "display_name": "LS_\u1d05\u1d07\u1d20", "link": "https://stackoverflow.com/users/2545784/ls-%e1%b4%85%e1%b4%87%e1%b4%a0"}, "edited": false, "score": 1, "creation_date": 1463558678, "post_id": 37292961, "comment_id": 62110895, "body": "@LS_dev, I can&#39;t use a PivotTable, this task should be automatized and in a sp&#233;cifique format @ Maartenvan Stam, no it doesn&#39;t exceed 2000 lines, I just tried Long definition, i still have the same problem"}, {"owner": {"reputation": 4930, "user_id": 5276188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N2sAW.jpg?s=128&g=1", "display_name": "Doktor OSwaldo", "link": "https://stackoverflow.com/users/5276188/doktor-oswaldo"}, "edited": false, "score": 0, "creation_date": 1463571602, "post_id": 37292961, "comment_id": 62119527, "body": "how does it behave badly ? does it just skip the Clients, or what wrong results are you getting ?"}, {"owner": {"reputation": 43, "user_id": 6176543, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154057635899787/picture?type=large", "display_name": "Sarahjem", "link": "https://stackoverflow.com/users/6176543/sarahjem"}, "edited": false, "score": 0, "creation_date": 1463574233, "post_id": 37292961, "comment_id": 62121472, "body": "it just skip the client yes and dont reflect it in the result sheet, like it doesn&#39;t exist."}, {"owner": {"reputation": 4930, "user_id": 5276188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N2sAW.jpg?s=128&g=1", "display_name": "Doktor OSwaldo", "link": "https://stackoverflow.com/users/5276188/doktor-oswaldo"}, "edited": false, "score": 0, "creation_date": 1463579803, "post_id": 37292961, "comment_id": 62125625, "body": "ok since it also skips the a = a+1 part, it has to be in the line While Cells(i, 6) &lt;&gt; &quot;&quot;. this should work, but try to replace it with While Cells(i, 6).value &lt;&gt; vbNullString  maybe it is a strange vba bug"}, {"owner": {"reputation": 43, "user_id": 6176543, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154057635899787/picture?type=large", "display_name": "Sarahjem", "link": "https://stackoverflow.com/users/6176543/sarahjem"}, "reply_to_user": {"reputation": 4930, "user_id": 5276188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N2sAW.jpg?s=128&g=1", "display_name": "Doktor OSwaldo", "link": "https://stackoverflow.com/users/5276188/doktor-oswaldo"}, "edited": false, "score": 0, "creation_date": 1463583459, "post_id": 37292961, "comment_id": 62128454, "body": "@DoktorOswaldo, i found the problem, some clients had no names only ID Codes, so when ever the macro found &quot;NA&quot; it add it to the first ID Code, i missed up choosing my Key, thanks for lighting that up."}], "owner": {"reputation": 43, "user_id": 6176543, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154057635899787/picture?type=large", "display_name": "Sarahjem", "link": "https://stackoverflow.com/users/6176543/sarahjem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 332, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1463561908, "creation_date": 1463556662, "last_edit_date": 1463561908, "question_id": 37292961, "link": "https://stackoverflow.com/questions/37292961/average-function-on-vba", "title": "Average function on VBA", "body": "<p>I'm using the average function in a loop,which calculate the average of amounts for a same client per month ( its not a monthly average, it only consider the open days) and it works perfectly on a 5000 lines sheet, but ones i used it in a 56703 lines sheet, it didn't work so well, and misses some clients. Why does it do that ? how can i fix it </p>\n\n<pre><code>    Sub calcav()\n    Dim i As Long\n    Dim j As Long\n    Dim a As Integer\n\n   Sheets(\"Source\").Activate\n   a = 2\n   i = 2\n   While Cells(i, 6) &lt;&gt; \"\"\n   j = i\n      While Cells(i, 6) = Cells(i + 1, 6) And Month(Cells(i, 18)) =Month(Cells(i + 1, 18))\n   i = i + 1\n      Wend\n    Sheets(\"Average\").Cells(a, 1) = Cells(i, 6).Value\n    Sheets(\"Average\").Cells(a, 2) = Month(Cells(i, 18))\n    Sheets(\"Average\").Cells(a, 3) = Year(Cells(i, 18))\n    Sheets(\"Average\").Cells(a, 4)   =Application.WorksheetFunction.Average(Range(\"V\" &amp; j &amp; \":V\" &amp; i))\n    Sheets(\"Average\").Cells(a, 5) = Left(Cells(i, 20).Value, 3)\n    a = a + 1\n\n   i = i + 1\n   Wend\n\n   End Sub\n</code></pre>\n"}, {"tags": ["vba"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 6349303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1232795f8c8b03500bfadcf65b543297?s=128&d=identicon&r=PG&f=1", "display_name": "Billy Bob", "link": "https://stackoverflow.com/users/6349303/billy-bob"}, "edited": false, "score": 0, "creation_date": 1463578107, "post_id": 37292757, "comment_id": 62124387, "body": "I was just about to ask. Brilliant!"}], "tags": [], "owner": {"reputation": 192, "user_id": 2717382, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JmAXt.jpg?s=128&g=1", "display_name": "Skaterhaz", "link": "https://stackoverflow.com/users/2717382/skaterhaz"}, "is_accepted": false, "score": 0, "last_activity_date": 1463556048, "creation_date": 1463556048, "answer_id": 37292757, "question_id": 37292489, "link": "https://stackoverflow.com/questions/37292489/choose-between-two-cells-to-copy-and-paste/37292757#37292757", "title": "Choose between two cells to copy and paste", "body": "<p>If you only want one cell copied then</p>\n\n<pre><code>If wS1.Range(\"U2\").Value = \"\" Then\n   wS1.Range(\"V2\").Copy Destination:= wS2.Range(\"R3\")\nElse\n   wS1.Range(\"U2\").Copy Destination:= wS2.Range(\"R3\")\nEnd if\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 602, "user_id": 4749854, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e9c0c863ac5565809a701836f90157da?s=128&d=identicon&r=PG&f=1", "display_name": "IIJHFII", "link": "https://stackoverflow.com/users/4749854/iijhfii"}, "is_accepted": true, "score": 0, "last_activity_date": 1463561185, "creation_date": 1463561185, "answer_id": 37294524, "question_id": 37292489, "link": "https://stackoverflow.com/questions/37292489/choose-between-two-cells-to-copy-and-paste/37294524#37294524", "title": "Choose between two cells to copy and paste", "body": "<p>As an addition to Skaterhaz' answer, you can use a loop to go through a range of cells in the columns, say 1 to 200:</p>\n\n<pre><code>Sub Copy_Loop()\n\nDim i as Long\n\n    For i = 1 to 200\n        If wS1.Range(\"U\" &amp; i).Value = \"\" Then\n            wS1.Range(\"V\" &amp; i).Copy Destination:= wS2.Range(\"R\" &amp; (i+1))\n        Else\n            wS1.Range(\"U\" &amp; i).Copy Destination:= wS2.Range(\"R\" &amp; (i+1))\n        End if\n    Next i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 6349303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1232795f8c8b03500bfadcf65b543297?s=128&d=identicon&r=PG&f=1", "display_name": "Billy Bob", "link": "https://stackoverflow.com/users/6349303/billy-bob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 37294524, "answer_count": 2, "score": 1, "last_activity_date": 1463561185, "creation_date": 1463555231, "question_id": 37292489, "link": "https://stackoverflow.com/questions/37292489/choose-between-two-cells-to-copy-and-paste", "title": "Choose between two cells to copy and paste", "body": "<p>I've only just starting to pick up VBA and Python so forgive my ignorance. I'm trying to code something that can choose between two cells and paste the cell that is not blank. </p>\n\n<p>Currently what i came up with is this: </p>\n\n<pre><code>Sub ManualCopyEqual()\n    Set wS1 = Sheets(\"Neptune\")\n    Set wS2 = Sheets(\"Contact\")\n\n    wS1.Range(\"U2:U102\").Copy\n    wS2.Range(\"R3:R102\").PasteSpecial Paste:=xlFormulas, Operation:=xlNone, SkipBlanks:=         False, Transpose:=False\n\nEnd Sub\n</code></pre>\n\n<p>This allows me to copy the row U from wS1 and paste to wS2. However, I would like to code something that will enable me to copy information from row V if the cell in row U is empty. </p>\n\n<p>In other words, if U2 is empty, how do I code such that V2 is copied to R3 instead of copying the blank U2 into R3?</p>\n\n<p>Any help would be so much appreciated!! :)</p>\n\n<p>Regards, \nBills</p>\n"}, {"tags": ["ms-access", "vba", "word-2010"], "comments": [{"owner": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 0, "creation_date": 1463556370, "post_id": 37292257, "comment_id": 62109515, "body": "What is the exact error message you get? Also your loop seems to just move through the records of the open recordset without using any of the data.."}, {"owner": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 0, "creation_date": 1463556490, "post_id": 37292257, "comment_id": 62109575, "body": "Also, should you have that forward slash in the <code>db</code> address? <code>OpenDatabase(&quot;C:\\User&#47;012886\\...</code>"}, {"owner": {"reputation": 13, "user_id": 6349269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35f97f50604c284e805bbe8ddf6eaa6b?s=128&d=identicon&r=PG&f=1", "display_name": "H.Schilling", "link": "https://stackoverflow.com/users/6349269/h-schilling"}, "reply_to_user": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 0, "creation_date": 1463557415, "post_id": 37292257, "comment_id": 62110118, "body": "Hi, I get the message: bad Syntax in From condition"}, {"owner": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 0, "creation_date": 1463558031, "post_id": 37292257, "comment_id": 62110489, "body": "What happens when you run the query <code>SELECT * FROM ITZ-EMV-Messungen</code> in Access? Does it run ok?"}, {"owner": {"reputation": 13, "user_id": 6349269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35f97f50604c284e805bbe8ddf6eaa6b?s=128&d=identicon&r=PG&f=1", "display_name": "H.Schilling", "link": "https://stackoverflow.com/users/6349269/h-schilling"}, "reply_to_user": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 0, "creation_date": 1463558398, "post_id": 37292257, "comment_id": 62110712, "body": "I get the same error"}, {"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 1, "creation_date": 1463558736, "post_id": 37292257, "comment_id": 62110921, "body": "Try bracketing: [ITZ-EMV-Messungen] I reckon it is the dash."}, {"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1463558808, "post_id": 37292257, "comment_id": 62110964, "body": "Just guessing, but you seem to be mixing up late and early binding."}, {"owner": {"reputation": 13, "user_id": 6349269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35f97f50604c284e805bbe8ddf6eaa6b?s=128&d=identicon&r=PG&f=1", "display_name": "H.Schilling", "link": "https://stackoverflow.com/users/6349269/h-schilling"}, "edited": false, "score": 0, "creation_date": 1463560278, "post_id": 37292257, "comment_id": 62111902, "body": "thank you that was the solution"}], "answers": [{"tags": [], "owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "is_accepted": true, "score": 0, "last_activity_date": 1463563498, "creation_date": 1463563498, "answer_id": 37295392, "question_id": 37292257, "link": "https://stackoverflow.com/questions/37292257/select-acces-datatbase-in-word-2010/37295392#37295392", "title": "Select acces datatbase in word 2010", "body": "<p>Try bracketing: [ITZ-EMV-Messungen] I reckon it is the dash.</p>\n"}], "owner": {"reputation": 13, "user_id": 6349269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35f97f50604c284e805bbe8ddf6eaa6b?s=128&d=identicon&r=PG&f=1", "display_name": "H.Schilling", "link": "https://stackoverflow.com/users/6349269/h-schilling"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 37295392, "answer_count": 1, "score": 1, "last_activity_date": 1594651431, "creation_date": 1463554424, "last_edit_date": 1594651431, "question_id": 37292257, "link": "https://stackoverflow.com/questions/37292257/select-acces-datatbase-in-word-2010", "title": "Select acces datatbase in word 2010", "body": "<p>I have to select some rows from an access in <code>word 2010 in vba</code>, now i would like to select some things but I get an error which says my Select is wrong can you help me ? </p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim jahr As String\nDim LfdNummer As Integer\nDim db As DAO.Database\nDim rs As DAO.Recordset\nDim strSql As String\njahr = TextBox1\nLfdNummer = TextBox2\n\n\n\n\nPrivate Sub CommandButton1_Click()\nDim jahr As String\nDim LfdNummer As Integer\nDim db As DAO.Database\nDim rs As DAO.Recordset\nDim strSql As String\njahr = TextBox1\nLfdNummer = TextBox2\n\n\n\n\nSet db = CreateObject(\"DAO.DBEngine.120\").OpenDatabase(\"C:\\User/012886\\Documents\\Hendrik\\trilux\\EMV\\Beispiel_EMV.accdb\")\n\n' Daten lesen und weiterverwenden -&gt; \u00fcber Recordset\n\nSet rs = db.OpenRecordset(\"SELECT * FROM ITZ-EMV-Messungen\")\nDo While Not rs.EOF\n\n  rs.MoveNext\nLoop\n\n\n rs.Close\n db.Close\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "range", "named-ranges", "vba"], "answers": [{"comments": [{"owner": {"reputation": 34, "user_id": 5665422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-ZjJuNkfFnlA/AAAAAAAAAAI/AAAAAAAAABw/2xNy6z_ACgw/photo.jpg?sz=128", "display_name": "S rick", "link": "https://stackoverflow.com/users/5665422/s-rick"}, "edited": false, "score": 0, "creation_date": 1463580714, "post_id": 37292282, "comment_id": 62126278, "body": "Would the range be split up into several non-continuous sections? Is there a way to mimic the cells shifting upward like on a spredsheet?"}, {"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "reply_to_user": {"reputation": 34, "user_id": 5665422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-ZjJuNkfFnlA/AAAAAAAAAAI/AAAAAAAAABw/2xNy6z_ACgw/photo.jpg?sz=128", "display_name": "S rick", "link": "https://stackoverflow.com/users/5665422/s-rick"}, "edited": false, "score": 0, "creation_date": 1463591996, "post_id": 37292282, "comment_id": 62134014, "body": "@Srick - add <code>debug.print aRange.address</code> to the end of the routine and you will see how aRange gets &quot;split&quot;. Depending on what you are trying to accomplish, you are probably better off using an array of type Variant."}, {"owner": {"reputation": 34, "user_id": 5665422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-ZjJuNkfFnlA/AAAAAAAAAAI/AAAAAAAAABw/2xNy6z_ACgw/photo.jpg?sz=128", "display_name": "S rick", "link": "https://stackoverflow.com/users/5665422/s-rick"}, "edited": false, "score": 0, "creation_date": 1463639043, "post_id": 37292282, "comment_id": 62150778, "body": "Ok so looping through the range values and storing them in an array. I&#39;m trying to move a range from several workbooks to one master workbook however I&#39;m finding certain user input on the sourcebooks makes the procedure buggy, I want to remove things like blanks and other qualifiers that would normally be filtered on the sourcebook. Thanks for your help !"}], "tags": [], "owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "is_accepted": true, "score": 0, "last_activity_date": 1463555553, "last_edit_date": 1463555553, "creation_date": 1463554565, "answer_id": 37292282, "question_id": 37292069, "link": "https://stackoverflow.com/questions/37292069/how-can-i-delete-rows-from-a-set-range-object/37292282#37292282", "title": "How can I delete rows from a set range object", "body": "<p>If you want to delete the rows in the worksheet, based on a value, then code such as the following will do that ...</p>\n\n<pre><code>Sub DeleteRows()\nDim aRange As Range, aRow As Range, aCell As Range\n    Set aRange = Range(\"A1:E5\")\n    For Each aRow In aRange.Rows\n        For Each aCell In aRow.Cells\n            If aCell.Value = \"Somestring\" Then\n                aRow.EntireRow.Delete\n                Exit For\n            End If\n        Next aCell\n    Next aRow\nEnd Sub\n</code></pre>\n\n<p>If you want to change the range that an object is referencing in VBA, based on a value, then code such as the following will do that ...</p>\n\n<pre><code>Sub DeleteRowsInObject()\nDim aRange As Range, aRow As Range, aCell As Range\nDim bRange As Range, found As Boolean\n    Set aRange = Range(\"A1:E5\")\n    For Each aRow In aRange.Rows\n        found = False\n        For Each aCell In aRow.Cells\n            If aCell.Value = \"Somestring\" Then found = True\n        Next aCell\n        If Not found Then\n            If bRange Is Nothing Then\n                Set bRange = aRow\n            Else\n                Set bRange = Union(bRange, aRow)\n            End If\n        End If\n    Next aRow\n    Set aRange = bRange\n    Set bRange = Nothing\nEnd Sub\n</code></pre>\n\n<p>You need to be careful with a Range object that is non-continuous with it's rows / columns as some of the normal properties / methods don't necessarily provide the values you would expect.</p>\n"}, {"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 1, "last_activity_date": 1463555465, "creation_date": 1463555465, "answer_id": 37292564, "question_id": 37292069, "link": "https://stackoverflow.com/questions/37292069/how-can-i-delete-rows-from-a-set-range-object/37292564#37292564", "title": "How can I delete rows from a set range object", "body": "<p>If you are going to delete, you should loop backwards through the rows:</p>\n\n<pre><code>Dim Lrange                As Range\nDim n                     As Long\nSet Lrange = Range(\"A1:E5\")\n\nFor n = Lrange.Rows.Count To 1 Step -1\n    If Lrange.Cells(n, 3).Value = \"Somestring\" Then\n        Lrange.Rows(n).Delete\n    End If\nNext\n</code></pre>\n\n<p>for example.</p>\n"}], "owner": {"reputation": 34, "user_id": 5665422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-ZjJuNkfFnlA/AAAAAAAAAAI/AAAAAAAAABw/2xNy6z_ACgw/photo.jpg?sz=128", "display_name": "S rick", "link": "https://stackoverflow.com/users/5665422/s-rick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6556, "favorite_count": 0, "accepted_answer_id": 37292282, "answer_count": 2, "score": 0, "last_activity_date": 1463555553, "creation_date": 1463553738, "last_edit_date": 1531164843, "question_id": 37292069, "link": "https://stackoverflow.com/questions/37292069/how-can-i-delete-rows-from-a-set-range-object", "title": "How can I delete rows from a set range object", "body": "<p>Once I set a range variable in vba is there a way of deleting rows and/or columns cells from it based on a value?</p>\n\n<p>For example:</p>\n\n<pre><code>Dim Lrange as Range\n\nSet Lrange = Range(\"A1:E5\")\n\nFor each row in Lrange\n   If cell(Lrange.row, 3).value = \"Somestring\" Then\n       LRange.row.delete\n   End if\nNext\n</code></pre>\n\n<p>Is this possible or would I have to store it in worksheet to manipulate the range?</p>\n\n<p>Any suggestions are welcome!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 137, "user_id": 5969580, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/666cb6d60f25b477159cd3b68a1393ba?s=128&d=identicon&r=PG&f=1", "display_name": "Siraj", "link": "https://stackoverflow.com/users/5969580/siraj"}, "edited": false, "score": 0, "creation_date": 1463556718, "post_id": 37291997, "comment_id": 62109708, "body": "Excellent, it works seamlessly. Thanks a lot for your instant response."}], "tags": [], "owner": {"reputation": 156, "user_id": 6219524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be82ab7ad90aa19b4df8add5fcc2d244?s=128&d=identicon&r=PG&f=1", "display_name": "csanjose", "link": "https://stackoverflow.com/users/6219524/csanjose"}, "is_accepted": true, "score": 0, "last_activity_date": 1463555003, "last_edit_date": 1463555003, "creation_date": 1463553533, "answer_id": 37291997, "question_id": 37291553, "link": "https://stackoverflow.com/questions/37291553/excel-macro-to-find-and-replace-multiple-strings-in-any-text-file/37291997#37291997", "title": "Excel macro to find and replace multiple strings in any text file", "body": "<pre><code>Sub ReplaceStringInFile()\n\nDim sBuf As String\nDim sTemp As String\nDim sFileName As String\nDim FileExt(2) As String\n\nruta = Application.ActiveWorkbook.Path\n\nChDrive ruta\nChDir ruta\n\nFileExt(1) = \"txt\"\nFileExt(2) = \"xml\"\n\nFor i = 1 To 2\n\n  sFileName = Dir(\"*.\" &amp; FileExt(i))\n\n  Do\n\n    If sFileName = \"\" Then Exit Do\n\n    sTemp = \"\"\n    Open sFileName For Input As #1\n      Do Until EOF(1)\n        Line Input #1, sBuf\n        sTemp = sTemp &amp; sBuf &amp; vbCrLf\n      Loop\n    Close #1\n\n    sTemp = Replace(sTemp, \"THIS\", \"THAT\")\n\n    Open sFileName For Output As #1\n      Print #1, sTemp\n    Close #1\n\n    sFileName = Dir()\n\n  Loop\n\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1522348107, "creation_date": 1522348107, "answer_id": 49562829, "question_id": 37291553, "link": "https://stackoverflow.com/questions/37291553/excel-macro-to-find-and-replace-multiple-strings-in-any-text-file/49562829#49562829", "title": "Excel macro to find and replace multiple strings in any text file", "body": "<p>You can iterate through items in an array!!</p>\n\n<pre><code>Sub FindAndReplaceText()\n\n Dim FileName As String\n Dim FolderPath As String\n Dim FSO As Object\n Dim I As Integer\n Dim SearchForWords As Variant\n Dim SubstituteWords As Variant\n Dim Text As String\n Dim TextFile As Object\n\n  'Change these arrays to word you want to find and replace\n  SearchForWords = Array(\"string1\", \"string2\", \"string3\")\n  SubstituteWords = Array(\"string100\", \"string200\", \"string300\")\n\n  'Change the folder path to where your text files are.\n   FolderPath = \"C:\\your_path_here\\\"\n\n     Set FSO = CreateObject(\"Scripting.FileSystemObject\")\n\n     FolderPath = IIf(Right(FolderPath, 1) &lt;&gt; \"\\\", FolderPath &amp; \"\\\", FolderPath)\n     FileName = Dir(FolderPath &amp; \"\\*.txt\")\n\n     Do While FileName &lt;&gt; \"\"\n       FileSpec = FolderPath &amp; FileName\n        'Read all the file's text into a string variable.\n         Set TextFile = FSO.OpenTextFile(FileSpec, 1, False)\n           Text = TextFile.ReadAll\n         TextFile.Close\n\n        'Scan the string for words to replace and write the string back to the file.\n         Set TextFile = FSO.OpenTextFile(FileSpec, 2, False)\n           For I = 0 To UBound(SearchForWords)\n           Debug.Print Text\n             Replace Text, SearchForWords(I), SubstituteWords(I)\n           Debug.Print Text\n           Next I\n         TextFile.Write Text\n         TextFile.Close\n       FileName = Dir()\n     Loop\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 137, "user_id": 5969580, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/666cb6d60f25b477159cd3b68a1393ba?s=128&d=identicon&r=PG&f=1", "display_name": "Siraj", "link": "https://stackoverflow.com/users/5969580/siraj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3124, "favorite_count": 0, "accepted_answer_id": 37291997, "answer_count": 2, "score": 2, "last_activity_date": 1522348107, "creation_date": 1463551748, "last_edit_date": 1463584925, "question_id": 37291553, "link": "https://stackoverflow.com/questions/37291553/excel-macro-to-find-and-replace-multiple-strings-in-any-text-file", "title": "Excel macro to find and replace multiple strings in any text file", "body": "<p>I am naive to scripts, but I used below code from your site to replace strings in a text file and it works fine. But, I don't want specify a file name, it should ready any file like (*.txt or *.xml). So, I appreciate if anyone could help in this.</p>\n\n<p>Thanks</p>\n\n<pre><code>Sub ReplaceStringInFile()\n\nDim sBuf As String\nDim sTemp As String\nDim iFileNum As Integer\nDim sFileName As String\n\n' Edit as needed\nsFileName = \"C:\\Temp\\test.txt\"\n\niFileNum = FreeFile\nOpen sFileName For Input As iFileNum\n\nDo Until EOF(iFileNum)\nLine Input #iFileNum, sBuf\nsTemp = sTemp &amp; sBuf &amp; vbCrLf\nLoop\nClose iFileNum\n\nsTemp = Replace(sTemp, \"THIS\", \"THAT\")\n\niFileNum = FreeFile\nOpen sFileName For Output As iFileNum\nPrint #iFileNum, sTemp\nClose iFileNum\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 318, "user_id": 1570670, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/3xMxf.jpg?s=128&g=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/1570670/tyler"}, "edited": false, "score": 0, "creation_date": 1463552111, "post_id": 37291538, "comment_id": 62107186, "body": "What does the above code do &amp; where should I place it in my code?"}, {"owner": {"reputation": 56, "user_id": 6349118, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0SqEI.png?s=128&g=1", "display_name": "JackIsJack", "link": "https://stackoverflow.com/users/6349118/jackisjack"}, "reply_to_user": {"reputation": 318, "user_id": 1570670, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/3xMxf.jpg?s=128&g=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/1570670/tyler"}, "edited": false, "score": 0, "creation_date": 1463579402, "post_id": 37291538, "comment_id": 62125309, "body": "first line means : cell A1 in sheet DZ get the value of cell C1 in sheet GP Data"}], "tags": [], "owner": {"reputation": 56, "user_id": 6349118, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0SqEI.png?s=128&g=1", "display_name": "JackIsJack", "link": "https://stackoverflow.com/users/6349118/jackisjack"}, "is_accepted": true, "score": 2, "last_activity_date": 1463552211, "last_edit_date": 1463552211, "creation_date": 1463551674, "answer_id": 37291538, "question_id": 37291335, "link": "https://stackoverflow.com/questions/37291335/macro-to-insert-data-into-next-blank-row-or-column-in-another-sheet/37291538#37291538", "title": "Macro to insert data into next blank row or column in another sheet?", "body": "<p>Do not use : <code>.Select, .Copy, .Paste</code> method</p>\n\n<p>Most of the time, you can use this pattern (only 1 line) :</p>\n\n<pre><code>Sheets(\"DZ\").Range(\"A1\").Value = Sheets(\"GP Data\").Range(\"C1\").Value\n</code></pre>\n\n<p>(1 cell)</p>\n\n<pre><code>Sheets(\"DZ\").Range(\"B1:B4\").Value = Sheets(\"GP Data\").Range(\"A1:A4\").Value\n</code></pre>\n\n<p>(multiple cells - be sure source and cible are the same size)</p>\n"}], "owner": {"reputation": 318, "user_id": 1570670, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/3xMxf.jpg?s=128&g=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/1570670/tyler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1869, "favorite_count": 0, "accepted_answer_id": 37291538, "answer_count": 1, "score": 0, "last_activity_date": 1463589846, "creation_date": 1463550826, "last_edit_date": 1463589846, "question_id": 37291335, "link": "https://stackoverflow.com/questions/37291335/macro-to-insert-data-into-next-blank-row-or-column-in-another-sheet", "title": "Macro to insert data into next blank row or column in another sheet?", "body": "<p>I have 5 sheets in this workbook, GP Data is the input sheet in this workbook,\nand the other 4 sheets requires me to copy paste data from specific cells of the GP Data Sheet and update into the next blank row of the remaining sheets. </p>\n\n<p>Column A in SheetX,Y,Z is the date which is dragged down from the previous date every time I copy the data over similarly to Row 6 in Raw Sheet.</p>\n\n<pre><code>Sub Prism2ndStep()\n'\n' Prism2ndStep Macro\n'\n\n'\n    Range(\"P12:R14\").Select\n    Selection.Copy\n    Sheets(\"RAW\").Select\n    Range(\"DC7\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Range(\"CZ6:DB6\").Select\n    Application.CutCopyMode = False\n    Selection.AutoFill Destination:=Range(\"CZ6:DE6\"), Type:=xlFillDefault\n    Range(\"CZ6:DE6\").Select\n    Sheets(\"GP Data\").Select\n    Range(\"S12:S14\").Select\n    Selection.Copy\n    Sheets(\"DX\").Select\n    Range(\"B39\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=True\n    Sheets(\"GP Data\").Select\n    Range(\"T12:T14\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"DY\").Select\n    Range(\"B39\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=True\n    Sheets(\"GP Data\").Select\n    Range(\"U12:U14\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"DZ\").Select\n    Range(\"B39\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=True\n    Range(\"A38\").Select\n    Application.CutCopyMode = False\n    Selection.AutoFill Destination:=Range(\"A38:A39\"), Type:=xlFillDefault\n    Range(\"A38:A39\").Select\n    Sheets(\"DY\").Select\n    Range(\"A38\").Select\n    Selection.AutoFill Destination:=Range(\"A38:A39\"), Type:=xlFillDefault\n    Range(\"A38:A39\").Select\n    Sheets(\"DX\").Select\n    Range(\"A38\").Select\n    Selection.AutoFill Destination:=Range(\"A38:A39\"), Type:=xlFillDefault\n    Range(\"A38:A39\").Select\n    Sheets(\"GP Data\").Select\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1370, "user_id": 2717068, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1443043394/picture?type=large", "display_name": "Lubo\u0161 Suk", "link": "https://stackoverflow.com/users/2717068/lubo%c5%a1-suk"}, "edited": false, "score": 0, "creation_date": 1463549800, "post_id": 37291084, "comment_id": 62106301, "body": "its because you using <code>sheetChange</code> event. Are you using form controls or activex dropdown?"}, {"owner": {"reputation": 123, "user_id": 4965462, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3b30437ca3531b905b87aa937564211b?s=128&d=identicon&r=PG&f=1", "display_name": "kera_404", "link": "https://stackoverflow.com/users/4965462/kera-404"}, "reply_to_user": {"reputation": 1370, "user_id": 2717068, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1443043394/picture?type=large", "display_name": "Lubo\u0161 Suk", "link": "https://stackoverflow.com/users/2717068/lubo%c5%a1-suk"}, "edited": false, "score": 0, "creation_date": 1463550161, "post_id": 37291084, "comment_id": 62106442, "body": "I am using Data Validation to create DropBox and VBA to code it."}, {"owner": {"reputation": 1370, "user_id": 2717068, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1443043394/picture?type=large", "display_name": "Lubo\u0161 Suk", "link": "https://stackoverflow.com/users/2717068/lubo%c5%a1-suk"}, "edited": false, "score": 0, "creation_date": 1463550756, "post_id": 37291084, "comment_id": 62106661, "body": "Hmm then im not sure what you try to achieve. Data validation will not create dropbox, its only for cell value limitation... But if you wana to validate input value of combobox, i would use rather VBA than data validation. Or if you need data validation, try to pin worksheetCalculate event after dropbox value change"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1463662245, "post_id": 37291084, "comment_id": 62166745, "body": "did you try as per my suggestion?"}, {"owner": {"reputation": 123, "user_id": 4965462, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3b30437ca3531b905b87aa937564211b?s=128&d=identicon&r=PG&f=1", "display_name": "kera_404", "link": "https://stackoverflow.com/users/4965462/kera-404"}, "edited": false, "score": 0, "creation_date": 1463729991, "post_id": 37291084, "comment_id": 62198370, "body": "I used this Sub, Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range). Customized using Select Case and it worked."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1464815209, "post_id": 37291084, "comment_id": 62644462, "body": "Suit yourself. But using a data validation in UI would call for Validation object once in VBA"}], "answers": [{"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1463552917, "creation_date": 1463552917, "answer_id": 37291835, "question_id": 37291084, "link": "https://stackoverflow.com/questions/37291084/selecting-elements-of-dropbox-via-vba/37291835#37291835", "title": "Selecting Elements of dropbox via VBA", "body": "<p>you can exploit <a href=\"https://msdn.microsoft.com/en-us/library/office/ff821214.aspx\" rel=\"nofollow\">Validation</a> object like follows</p>\n\n<pre><code>Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)\n    With Range(\"D4\")            \n        If .Validation.IgnoreBlank And IsEmpty(.Cells) Or Not .Validation.Value Then\n            MsgBox (\"no Item selected\")\n        Else\n            MsgBox (\"Item \" &amp; WorksheetFunction.Match(.Value, Range(.Validation.Formula1), 0))\n        End If            \n    End With    \nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 123, "user_id": 4965462, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3b30437ca3531b905b87aa937564211b?s=128&d=identicon&r=PG&f=1", "display_name": "kera_404", "link": "https://stackoverflow.com/users/4965462/kera-404"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 351, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1463552917, "creation_date": 1463549714, "last_edit_date": 1463550373, "question_id": 37291084, "link": "https://stackoverflow.com/questions/37291084/selecting-elements-of-dropbox-via-vba", "title": "Selecting Elements of dropbox via VBA", "body": "<p>I am working in excel, and my purpose is to create a drop-box(at cell say <code>D4</code>) of certain values present in range (say)<code>A1:A3</code>. Now using <code>VBA</code>, while selecting each Item from the drop down list, it should display a particular message. When I choose an item from the drop-box, compiler shows no error but at the same time, it displays nothing.</p>\n\n<pre><code>Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)\n    Select Case Range(\"D4\")\n     Case \"Item 1\"\n      MsgBox (\"Item 1\")\n     Case \"Item 2\"\n      MsgBox (\"Item 2\")\n     Case \"Item 3\"\n      MsgBox (\"Item 3\")\n    End Select\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "ole"], "comments": [{"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 0, "creation_date": 1463547211, "post_id": 37290269, "comment_id": 62105402, "body": "Do you mean hyperlink something like \t&lt;C:\\Users\\kakka_000\\Pictures\\2016-04\\P4100003_08042016.JPG&gt; for embedded pictures or shapes from PC."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1463551597, "post_id": 37290269, "comment_id": 62106984, "body": "Please post the code you are using"}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "reply_to_user": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 0, "creation_date": 1463581699, "post_id": 37290269, "comment_id": 62127026, "body": "Sorry! Code is:                                      ActiveSheet.OLEObjects.Add(Filename:= _         &quot;https://...dummylink&quot; _         , Link:=False, DisplayAsIcon:=False).Select        x = Selection.Name     Selection.Verb Verb:=xlPrimary                                                                                                                                                                                              @skkakkar Kind of, I noticed after retriving the object is stored in the temp folder."}], "answers": [{"comments": [{"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1463582215, "post_id": 37293158, "comment_id": 62127434, "body": "I tried the solution provided in the link, but, I keep getting a &#39;1004 Unable to get the object property of the OLEObject class&#39;"}, {"owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "reply_to_user": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1463582455, "post_id": 37293158, "comment_id": 62127608, "body": "Hmm, you have an interesting object there. I would recommend working on the steps rather than pursuing this option. But it would be useful to understand your issue a bit more as others may have an answer, Could you write out the steps needed to get the object into the excel file."}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1463582600, "post_id": 37293158, "comment_id": 62127735, "body": "I get it with the following code:  ActiveSheet.OLEObjects.Add(Filename:= _ &quot;https://...dummylink&quot; _ , Link:=False, DisplayAsIcon:=False).Select x = Selection.Name Selection.Verb Verb:=xlPrimary                                                      Interesting thing, I just spotted that, if I ran it standalone, it doesn&#39;t retrieve the object, however, there is some other data that I need to gather from the same domain and when running that one first I can run this one."}, {"owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "reply_to_user": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1463635520, "post_id": 37293158, "comment_id": 62149399, "body": "Sorry Sgdva, I&#39;ve just done another test to ensure what I&#39;m saying is correct. You will never get the path of the embedded object because it is embedded (<code>Link:=False</code>). Embedding places a copy of the source into the Excel file and does not retain the path. If you link to it (<code>Link:=True</code>) then you will be able to get the path from <code>.SourceName</code> as you suspected."}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1463677952, "post_id": 37293158, "comment_id": 62178505, "body": "Don&#39;t worry! Saddly, If I set the Link:= True, the object is not downloaded to the hard drive, it&#39;s just a &quot;.tmp&quot; file in the local temp folder."}], "tags": [], "owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "is_accepted": false, "score": 3, "last_activity_date": 1463557236, "last_edit_date": 1495541702, "creation_date": 1463557236, "answer_id": 37293158, "question_id": 37290269, "link": "https://stackoverflow.com/questions/37290269/excel-ole-objects-embedded-path-location/37293158#37293158", "title": "Excel OLE Objects Embedded Path Location", "body": "<p>Looking at the icon in your image, you have inserted an object that is a file and not ticked 'Link to file' meaning (as you referenced) it is embedded, it has no path as it exists within the file.</p>\n\n<p>I found a previous question answered <a href=\"https://stackoverflow.com/questions/29913191/save-as-an-excel-file-embedded-in-another-excel-file\">here</a> but could not get this to run for me without popping up a dialog box.</p>\n\n<p>There is more than likely another way to do this but in Word a had similar problem and I solved it using the below steps: -</p>\n\n<ol>\n<li>Select and copy the object</li>\n<li>Create a new document (workbook)</li>\n<li>Paste the object in</li>\n<li>Save the new document (workbook) as HTML</li>\n<li>Look through the saved package for the only image file (as it was the only thing in the file)</li>\n<li>Move that to a location so I could use it elsewhere</li>\n<li>Delete the new document (workbook) and HTML copy of it</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "is_accepted": true, "score": 0, "last_activity_date": 1463882168, "creation_date": 1463882168, "answer_id": 37369794, "question_id": 37290269, "link": "https://stackoverflow.com/questions/37290269/excel-ole-objects-embedded-path-location/37369794#37369794", "title": "Excel OLE Objects Embedded Path Location", "body": "<p>It seems there's no other way than to work around with the temp files, I got an answer here <a href=\"http://www.mrexcel.com/forum/excel-questions/941857-ole-objects-path-file-location.html#post4528535\" rel=\"nofollow\">(click)</a> on a workaround code to do so, thanks again!</p>\n"}], "owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2397, "favorite_count": 1, "accepted_answer_id": 37369794, "answer_count": 2, "score": 2, "last_activity_date": 1473440007, "creation_date": 1463545382, "last_edit_date": 1473440007, "question_id": 37290269, "link": "https://stackoverflow.com/questions/37290269/excel-ole-objects-embedded-path-location", "title": "Excel OLE Objects Embedded Path Location", "body": "<p>As the title states, I haven't found a way to retrive either the name of the embedded object or its path (attached image) <a href=\"https://i.stack.imgur.com/QLubo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QLubo.png\" alt=\"Sample Screenshot\"></a></p>\n\n<p>In the example provided, I would like to get either the full path location or the 67CE8... name at least -since I know those are stored in the Temp folder-, so I could save them automatically by VBA.\nI have tried \".SourceName\", without luck since it seems only to get hyperlink (but there is no real hyperlink hence err 1004).\n<br><strong>EDIT For code that was in comments</strong>:</p>\n\n<pre><code>ActiveSheet.OLEObjects.Add(Filename:= _ \"https://...dummylink\" _ , Link:=False, DisplayAsIcon:=False).Select x = Selection.Name Selection.Verb Verb:=xlPrimary\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "is_accepted": false, "score": 0, "last_activity_date": 1463554040, "creation_date": 1463554040, "answer_id": 37292165, "question_id": 37289851, "link": "https://stackoverflow.com/questions/37289851/copying-a-row-in-excel-that-match-appropriate-filters/37292165#37292165", "title": "Copying a Row in Excel that match appropriate filters", "body": "<p>I am assuming that your data is consistent i.e. you are looking for <code>Fruit</code> in one column, <code>Apple</code> in another column and likewise for <code>TRUE</code> and <code>&lt;4</code>.<br>\nHere in the code I am looking for <code>Fruit in Column A</code>, <code>Apple in Column B</code>, <code>TRUE in Column C</code> and <code>&lt;4 in Column D</code>. You can change column numbers as required.<br>\nI've named the sheet where data is as <code>Data</code> and the sheet to paste copied rows as <code>Results</code></p>\n\n<pre><code>Sub CopyRow()\n    Dim LastRowCurr As Long, LastRowResult As Long\n    Dim LastColumn As Long\n    Dim i As Long\n    Dim currWS As Worksheet, resultWS As Worksheet\n    Dim MyRange As Range\n\n    Set currWS = ThisWorkbook.Sheets(\"Data\")      '---&gt; sheet where data is\n    Set resultWS = ThisWorkbook.Sheets(\"Results\") '---&gt; sheet to paste copied rows\n\n    lastRow = currWS.Cells(Rows.Count, \"A\").End(xlUp).Row\n    LastRowResult = resultWS.Cells(Rows.Count, \"A\").End(xlUp).Row\n\n    With currWS\n        For i = 4 To lastRow\n            'change column numbers in the below line as required\n            If .Cells(i, 1).Value = \"Fruit\" And .Cells(i, 2).Value = \"Apple\" And .Cells(i, 3).Value = True And .Cells(i, 4).Value &lt; 4 Then\n                .Rows(i).Copy Destination:=resultWS.Range(\"A\" &amp; LastRowResult)\n                LastRowResult = LastRowResult + 1\n            End If\n        Next i\n    End With\nEnd Sub\n</code></pre>\n\n<p>I guess this is what you want.</p>\n"}, {"tags": [], "owner": {"reputation": 2780, "user_id": 1294909, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZWPz.jpg?s=128&g=1", "display_name": "Moosli", "link": "https://stackoverflow.com/users/1294909/moosli"}, "is_accepted": false, "score": 0, "last_activity_date": 1463555818, "creation_date": 1463555818, "answer_id": 37292684, "question_id": 37289851, "link": "https://stackoverflow.com/questions/37289851/copying-a-row-in-excel-that-match-appropriate-filters/37292684#37292684", "title": "Copying a Row in Excel that match appropriate filters", "body": "<p>you have to add another loop for the <code>.find</code> function. On your Code it only looks once for <em>Apples</em>. What you have to do is, you have to add another loop and repeat the <em>.find</em> function until you this <em>.find</em> function gives your the first match again . Try something like this:</p>\n\n<pre><code>Sub Database_RoundedRectangle1_Click()\nDim c As Range, i As Long\nDim SrchRng, strSearch\nDim wsResults As Worksheet\nDim firstAddress\nSet SrchRng = ActiveSheet.Range(\"A1:T60\", ActiveSheet.Range(\"A60:T60\").End(xlUp))\n\nSet wsResults = ThisWorkbook.Worksheets(\"Results\")\n\nFor Each strSearch In Array(\"Apple\")\n\n\n    Set c = SrchRng.Find(strSearch, LookIn:=xlValues, LookAt:=xlWhole)\n    If Not c Is Nothing Then\n        firstAddress = c.Address\n        Do\n            c.EntireRow.Copy wsResults.UsedRange.Cells(wsResults.UsedRange.Rows.Count + 1, 1)\n            Set c = SrchRng.FindNext(c)\n        Loop While Not c Is Nothing And c.Address &lt;&gt; firstAddress\n    End If\nNext strSearch\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6348712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8da067e6668fbfbce851bcf48dc82d5?s=128&d=identicon&r=PG&f=1", "display_name": "Alan W", "link": "https://stackoverflow.com/users/6348712/alan-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1463555818, "creation_date": 1463542731, "last_edit_date": 1531161705, "question_id": 37289851, "link": "https://stackoverflow.com/questions/37289851/copying-a-row-in-excel-that-match-appropriate-filters", "title": "Copying a Row in Excel that match appropriate filters", "body": "<p>For a project I am working on, I am attempting to copy a row from an excel spreadsheet, only if the correct criteria are met. </p>\n\n<p>For example,</p>\n\n<p>I need to copy a row that has the following items in them:</p>\n\n<p>Fruit, Apple, True, Cell&lt;4</p>\n\n<p>I've tried using something like</p>\n\n<pre><code>Sub Database_RoundedRectangle1_Click()\nDim c As Range, i As Long\nDim SrchRng, strSearch\n\nSet SrchRng = ActiveSheet.Range(\"A4:T60\", ActiveSheet.Range(\"A60:T60\").End(xlUp))\n\nFor Each strSearch In Array(\"Apple\")\n\n    Set c = SrchRng.Find(strSearch, LookIn:=xlValues)\n    If Not c Is Nothing Then c.EntireRow.Copy\n    Sheets(\"Results\").Paste\nNext strSearch\n\n\nEnd Sub\n</code></pre>\n\n<p>But the problem with this is that it only searches for a single criteria: Apple. I need the script to scan the whole row for all filters to be correct, then copy the row.</p>\n\n<p>The script I used also only copies the row once, and does not seem to copy all rows that include Apple.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "edited": false, "score": 0, "creation_date": 1463543773, "post_id": 37289740, "comment_id": 62104395, "body": "Read up on the <a href=\"https://en.m.wikipedia.org/wiki/Newton%27s_method\" rel=\"nofollow noreferrer\">Newton-Raphson method</a>. It&#39;s simple to code, and you are almost there."}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 5912333, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh3.googleusercontent.com/-T4lCUns4p0E/AAAAAAAAAAI/AAAAAAAAADc/bC2W5hg47xc/photo.jpg?sz=128", "display_name": "Mofasa E", "link": "https://stackoverflow.com/users/5912333/mofasa-e"}, "edited": false, "score": 0, "creation_date": 1463583280, "post_id": 37292116, "comment_id": 62128309, "body": "Thanks, I will give it a shot!"}], "tags": [], "owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "is_accepted": true, "score": 3, "last_activity_date": 1463557438, "last_edit_date": 1463557438, "creation_date": 1463553878, "answer_id": 37292116, "question_id": 37289740, "link": "https://stackoverflow.com/questions/37289740/finding-the-x-intercept-of-a-4th-degree-polynomial-using-small-increments/37292116#37292116", "title": "Finding the x intercept of a 4th degree polynomial using small increments", "body": "<p>Your method suffers from two problems:</p>\n\n<ol>\n<li>You assume a step size to change x. The step could be too large, causing you to \"walk past\" the value your are looking for. To deal with this, you make a small step size, which can mean an excessively large number of iterations are needed to find the solution.</li>\n<li>You always assume the same direction to change x. Even with seemingly small values for your step size, you could \"walk past\" the solution, and have no means to change direction. Or, your initial guess may be on the wrong side of the solution, and you never find an answer.</li>\n</ol>\n\n<p>The <a href=\"https://en.m.wikipedia.org/wiki/Newton%27s_method\" rel=\"nofollow\">Newton-Raphson method</a> handles both of these issues neatly. You do still need to choose your initial guess somewhat close to the root you are looking for. </p>\n\n<p>This method does have potential problems, but for polynomials such as the one you are dealing with, it is quite good.</p>\n\n<p>Below is a simple VBA sub that implements this method. It solves your problem in 4 iterations. I recommend adjusting the initial guess (xii) a lot to see how it impacts the solution you get.</p>\n\n<pre><code>Sub SimpleNewtonRaphson()\nConst Tol As Double = 1E-06\nConst MaxIter As Long = 50\nDim xi As Double, xii As Double, deriv As Double\nDim IterCount As Long\n' Initialize\n    xi = 0#\n    xii = 1#\n    IterCount = 0\n\n' Method\n    Do While IterCount &lt; MaxIter And Abs(xii - xi) &gt; Tol\n        xi = xii\n        deriv = myDeriv(xi)\n        If deriv = 0# Then Exit Do\n        xii = xi - myFunc(xi) / deriv\n        IterCount = IterCount + 1\n    Loop\n\n' Results\n    If deriv = 0 Then MsgBox \"Ran into a 0 derivative, modify initial guess\"\n    If IterCount &gt;= MaxIter Then MsgBox \"MaxIterations reached\"\n    If Abs(xii - xi) &lt;= Tol Then MsgBox \"Solution found @\" &amp; vbCrLf &amp; \"F(\" &amp; xii &amp; \") = \" &amp; myFunc(xii)\n\nEnd Sub\n</code></pre>\n\n<p>... and two VBA functions for your equation and it's derivative ...</p>\n\n<pre><code>Function myFunc(x As Double) As Double\nConst A As Double = 0.000200878\nConst B As Double = -0.002203704\nConst C As Double = 0.0086\nConst D As Double = -0.02333\nConst E = 0.02033\n\nmyFunc = A * x ^ 4 + B * x ^ 3 + C * x ^ 2 + D * x + E\n\nEnd Function\n\nFunction myDeriv(x As Double) As Double\nConst A As Double = 0.000200878\nConst B As Double = -0.002203704\nConst C As Double = 0.0086\nConst D As Double = -0.02333\n\nmyDeriv = 4 * A * x ^ 3 + 3 * B * x ^ 2 + 2 * C * x + D\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 5912333, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh3.googleusercontent.com/-T4lCUns4p0E/AAAAAAAAAAI/AAAAAAAAADc/bC2W5hg47xc/photo.jpg?sz=128", "display_name": "Mofasa E", "link": "https://stackoverflow.com/users/5912333/mofasa-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 1, "accepted_answer_id": 37292116, "answer_count": 1, "score": 0, "last_activity_date": 1463557438, "creation_date": 1463541947, "last_edit_date": 1531164843, "question_id": 37289740, "link": "https://stackoverflow.com/questions/37289740/finding-the-x-intercept-of-a-4th-degree-polynomial-using-small-increments", "title": "Finding the x intercept of a 4th degree polynomial using small increments", "body": "<p>I am trying to find the x intercept of a 4th degree function by incrementing the x value. I feel like this way doesnt work always and isnt the most efficient way to do this, is there another way I am missing?</p>\n\n<p>My code is:</p>\n\n<pre><code>Sub Findintercept()\n    Dim equation As Double, x As Double, A As Double, B As Double, C As Double, D As Double, E As Double\n    A = 0.000200878\n    B = -0.002203704\n    C = 0.0086\n    D = -0.02333\n    E = 0.02033\n    x = 0\n    equation = A * x ^ 4 + B * x ^ 3 + C * x ^ 2 + D * x + E\n    While (equation &gt; 0.00001 Or equation &lt; -0.00001)\n        If (x &gt; 5) Then\n            MsgBox \"Could not find intercept\"\n            equation = 0\n        Else\n            x = x + 0.0001\n            equation = A * x ^ 4 + B * x ^ 3 + C * x ^ 2 + D * x + E\n        End If\n    Wend\n    MsgBox x\nEnd Sub\n</code></pre>\n\n<p>Sometimes it fails to find the intercept hence the IF condition in the while loop. (Im always expecting the intercept to be less than 5!</p>\n"}, {"tags": ["vba", "excel", "if-statement", "for-loop", "return"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 5276159, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-YmVyc6NEdzs/AAAAAAAAAAI/AAAAAAAAADU/MdDVLPK_QUE/photo.jpg?sz=128", "display_name": "TheBSITGuy", "link": "https://stackoverflow.com/users/5276159/thebsitguy"}, "edited": false, "score": 0, "creation_date": 1463558676, "post_id": 37288941, "comment_id": 62110892, "body": "My God.  Damn.  That makes so much sense.  I&#39;ll see what happens if I do &quot;Exit Function.&quot;  Thanks so much, Mat&#39;s Mug.  Appreciate it.  :)"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 2, "last_activity_date": 1463536499, "creation_date": 1463536499, "answer_id": 37288941, "question_id": 37288670, "link": "https://stackoverflow.com/questions/37288670/vba-cannot-return-value-from-within-if-statement-inside-for-loop/37288941#37288941", "title": "VBA - Cannot return Value from within If Statement inside For Loop", "body": "<blockquote>\n<pre><code>    checkConvert = newName           'Supposed to return\n                                     'value.  Doesn't\n                                     'work.\n    MsgBox checkConvert              'But MsgBox works.\n</code></pre>\n</blockquote>\n\n<p>It looks like you're under the impression that <em>assigning</em> a function's return value immediately returns. That's not how VBA works.</p>\n\n<p>You've assigned a return value, but the code keeps running because, well, an assignment is just that: an <em>assignment</em>.</p>\n\n<p>If you want to exit the function immediately after setting its return value, you need to do so explicitly:</p>\n\n<pre><code>    checkConvert = newName\n    Exit Function\n</code></pre>\n\n<p>The return values that \"work\", only work out of sheer luck. You're assigning the return value inside a loop, and never jumping out of it, so the value that's returned by the function is whatever value <code>checkConvert</code> was last assigned to, in the last iteration.</p>\n"}], "owner": {"reputation": 15, "user_id": 5276159, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-YmVyc6NEdzs/AAAAAAAAAAI/AAAAAAAAADU/MdDVLPK_QUE/photo.jpg?sz=128", "display_name": "TheBSITGuy", "link": "https://stackoverflow.com/users/5276159/thebsitguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 851, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1463536499, "creation_date": 1463534451, "question_id": 37288670, "link": "https://stackoverflow.com/questions/37288670/vba-cannot-return-value-from-within-if-statement-inside-for-loop", "title": "VBA - Cannot return Value from within If Statement inside For Loop", "body": "<p>I have a method called \"checkConvert\" which is supposed to return a String.</p>\n\n<p>I have created a For Loop which at the end of the loop returns a value as checkConvert.  Also, inside that For Loop, I have setup a Case and inside that Case, another For loop with If Statements inside.  Inside those If Statements, I have also tried to return a value as checkConvert, however it does NOT work at all.</p>\n\n<pre><code>For i = val To lastColumn_source\n    For j = 1 To 3\n        Dim cellValue As String\n        cellValue = salesSource.Cells(j, i).Value\n\n        Select Case i\n            Case 1\n                Dim match As Boolean\n                match = False                'Default is false.  \n                                             'Equating two cells = false.\n\n                For x = 1 To lastRow_check\n                    If cellValue = sourceCheck.Cells(x, 1) Then\n                        CRMDest.Cells(j, 2) = newName\n                        match = True         'Match is found.  Thus, true.\n                    End If\n                    If x = lastRow_check And match = False Then\n                        checkConvert = newName           'Supposed to return\n                                                         'value.  Doesn't\n                                                         'work.\n                        MsgBox checkConvert              'But MsgBox works.\n                    End If\n                 Next x\n            Case 2                                'Several more cases follow.\n            Case 13\n                 checkConvert = \"End of Program.\"        'Returns String\n                                                         'to \"end program.\"\n                                                         'This one works.\n        End Select\n\n        checkConvert = \"Move.\"                           'This return also\n                                                         'works.\n    Next j\nNext i\n</code></pre>\n"}, {"tags": ["regex", "excel", "vba"], "comments": [{"owner": {"reputation": 69261, "user_id": 557445, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/93a0d4a722b2fae0bf159c9283fe1aff?s=128&d=identicon&r=PG", "display_name": "Rion Williams", "link": "https://stackoverflow.com/users/557445/rion-williams"}, "edited": false, "score": 0, "creation_date": 1463533873, "post_id": 37288579, "comment_id": 62101942, "body": "Can you provide an example of what some of your sample input might look like and what you would expect to capture from it? Is there a single word on each line? Knowing these details can affect how the expression is built."}, {"owner": {"reputation": 389, "user_id": 4320631, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/yfkVD.png?s=128&g=1", "display_name": "Bill Vallance", "link": "https://stackoverflow.com/users/4320631/bill-vallance"}, "reply_to_user": {"reputation": 69261, "user_id": 557445, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/93a0d4a722b2fae0bf159c9283fe1aff?s=128&d=identicon&r=PG", "display_name": "Rion Williams", "link": "https://stackoverflow.com/users/557445/rion-williams"}, "edited": false, "score": 0, "creation_date": 1463537371, "post_id": 37288579, "comment_id": 62102779, "body": "I just tried this pattern <code>&quot;trust| tr[^a-z]| tr$&quot;</code> and it seemed to do the trick.  Any suggestions for improvement?"}, {"owner": {"reputation": 13556, "user_id": 1400971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/825a9bf179b05302991fbbf9551355ac?s=128&d=identicon&r=PG", "display_name": "Ro Yo Mi", "link": "https://stackoverflow.com/users/1400971/ro-yo-mi"}, "edited": false, "score": 0, "creation_date": 1463544533, "post_id": 37288579, "comment_id": 62104615, "body": "In your sample text <code>Johnson **Tr**</code> is not a desired match because <code>tr</code> is bracketed by <code>**</code>?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1463544545, "post_id": 37288579, "comment_id": 62104619, "body": "<i>I&#39;m sorry to ask the group this question without spending the proper amount of time educating myself, by this is a time-sensitive project for which I need your expertise.</i> If time is of the essence, and you don&#39;t know what you don&#39;t know, then it&#39;s usually time to hire someone."}, {"owner": {"reputation": 389, "user_id": 4320631, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/yfkVD.png?s=128&g=1", "display_name": "Bill Vallance", "link": "https://stackoverflow.com/users/4320631/bill-vallance"}, "reply_to_user": {"reputation": 13556, "user_id": 1400971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/825a9bf179b05302991fbbf9551355ac?s=128&d=identicon&r=PG", "display_name": "Ro Yo Mi", "link": "https://stackoverflow.com/users/1400971/ro-yo-mi"}, "edited": false, "score": 1, "creation_date": 1463577111, "post_id": 37288579, "comment_id": 62123629, "body": "@Ro Yo Mi the asterisks were meant to draw attention to what I am trying to match - I wasn&#39;t trying to match them.  Sorry for the confusion."}], "answers": [{"comments": [{"owner": {"reputation": 389, "user_id": 4320631, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/yfkVD.png?s=128&g=1", "display_name": "Bill Vallance", "link": "https://stackoverflow.com/users/4320631/bill-vallance"}, "edited": false, "score": 0, "creation_date": 1463578025, "post_id": 37289927, "comment_id": 62124325, "body": "Thanks a lot, @Ro Yo Mi, for the very complete answer.  That&#39;s exactly what I needed."}], "tags": [], "owner": {"reputation": 13556, "user_id": 1400971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/825a9bf179b05302991fbbf9551355ac?s=128&d=identicon&r=PG", "display_name": "Ro Yo Mi", "link": "https://stackoverflow.com/users/1400971/ro-yo-mi"}, "is_accepted": true, "score": 1, "last_activity_date": 1463544272, "last_edit_date": 1592644375, "creation_date": 1463543191, "answer_id": 37289927, "question_id": 37288579, "link": "https://stackoverflow.com/questions/37288579/excel-2007-vba-regex-help-needed/37289927#37289927", "title": "Excel 2007 VBA RegEx Help Needed", "body": "<p>I would rewrite your expression that finds <code>trust</code> and <code>tr</code> where they not preceded or followed by a other letters by using the <code>\\b</code> is a word boundary assertion. <code>\\b</code> matches at a position that is aptly called a &quot;word boundary&quot;.</p>\n<p>There are three different positions that qualify as word boundaries:</p>\n<ul>\n<li>Before the first character in the string, if the first character is a\nword character.</li>\n<li>After the last character in the string, if the last\ncharacter is a word character.</li>\n<li>Between two characters in the string,\nwhere one is a word character and the other is not a word character.</li>\n</ul>\n<p>For more information on word boundaries then see also <a href=\"http://www.regular-expressions.info/wordboundaries.html\" rel=\"nofollow noreferrer\">regular-expressions.info</a>. I'm not affiliated with that site.</p>\n<pre><code>\\b(?:trust|tr)\\b\n</code></pre>\n<p><img src=\"https://www.debuggex.com/i/L9GfjTfMPdpKAgCd.png\" alt=\"Regular expression visualization\" /></p>\n<p>After viewing the above, if you're still set on requiring the <code>tr</code> preceded by a space, then use this <code>\\b(?:trust|\\str)\\b</code></p>\n<h1>Examples</h1>\n<p><strong>Live Demo</strong></p>\n<p><a href=\"https://regex101.com/r/xM4fR9/1\" rel=\"nofollow noreferrer\">https://regex101.com/r/xM4fR9/1</a></p>\n<p>Note: I am assuming you're using the case insensitive flag for this</p>\n<h1>Explanation</h1>\n<pre><code>NODE                     EXPLANATION\n----------------------------------------------------------------------\n  \\b                       the boundary between a word char (\\w) and\n                           something that is not a word char\n----------------------------------------------------------------------\n  (?:                      group, but do not capture:\n----------------------------------------------------------------------\n    trust                    'trust'\n----------------------------------------------------------------------\n   |                        OR\n----------------------------------------------------------------------\n    tr                       'tr'\n----------------------------------------------------------------------\n  )                        end of grouping\n----------------------------------------------------------------------\n  \\b                       the boundary between a word char (\\w) and\n                           something that is not a word char\n----------------------------------------------------------------------\n</code></pre>\n<h1>Or</h1>\n<p>The <code>\\b(?:trust|tr)\\b</code> expression isn't the most efficient, but it is readable.</p>\n<p>A functionally identical, but more efficient regular expression would be:</p>\n<pre><code>\\btr(?:ust)?\\b\n</code></pre>\n<p><img src=\"https://www.debuggex.com/i/tNtBjE25Ebo7I30r.png\" alt=\"Regular expression visualization\" /></p>\n<p>Here we're still using the <code>\\b</code> word boundary, but we've just made the <code>ust</code> part of the word <code>trust</code> optional with the <code>(?: ... )?</code> construct.</p>\n"}], "owner": {"reputation": 389, "user_id": 4320631, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/yfkVD.png?s=128&g=1", "display_name": "Bill Vallance", "link": "https://stackoverflow.com/users/4320631/bill-vallance"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 37289927, "answer_count": 1, "score": -1, "last_activity_date": 1463544272, "creation_date": 1463533651, "last_edit_date": 1463535449, "question_id": 37288579, "link": "https://stackoverflow.com/questions/37288579/excel-2007-vba-regex-help-needed", "title": "Excel 2007 VBA RegEx Help Needed", "body": "<p>I'm working on an Excel 2007 VBA project that my client wants done yesterday and I need to use RegEx to locate strings within some pretty challenging data.  This is my first exposure to RegEx so I'm stuck doing something I think is simple (maybe not) and I'm clueless.</p>\n\n<p>I've added the reference to the VBScript RegEx engine (5.5) and RegEx is working O.K. in Excel - I just don't know how to construct the pattern statement.  I need to locate occurrences of the word \"trust\" in a range of cells on a worksheet.  In some of my data this word has been abbreviated \"Tr\".  I have constructed the following RegEx statement to locate the word \"trust\" and all words that start with a space and contain \"tr\".</p>\n\n<pre><code>\"trust| tr\"\n</code></pre>\n\n<p>Unfortuantely, this matches any word that contains \"tr\", like \"trail\", \"tree\", and so on.  What I want to match is \" tr\" - meaning it has a leading space, the \"tr\", and nothing else in the word.  Can somebody tell me what I need to do to make this happen?</p>\n\n<p>I'm also going to need RegEx patterns for street addresses, city, state, and zip plus last name and first name.  If there's a resource someone can point me to for these expressions I'd appreciate the help.  I'm sorry to ask the group this question without spending the proper amount of time educating myself, by this is a time-sensitive project for which I need your expertise.</p>\n\n<p>Thanks In Advance -</p>\n\n<p>PS - Here a sample of data that I'm working with.  I have this type of data present in 5 columns over 4,000 rows.</p>\n\n<pre><code>Jones Family **Trust**\n3420 E Ave of the Ftns\n3420 E Avenue of the Fountain\n320 E ARROWHEAD **TRAILHEAD**\n501 S 29TH ST\nPO BOX 13422\n71343 W Paradise Dr\n152035 S 29TH ST\n124 Owl Grove Pl\nJohnson **Tr**\n1900 E Arrowhead **Trl**\n1900 E ARROWHEAD **TRL**\n</code></pre>\n\n<p>This is a sample from a column that predominantly contains street addresses.  Other columns contain client names without addresses.  So not every cell contains data that starts with a number.</p>\n"}, {"tags": ["vba", "excel", "worksheet"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6348185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11ab78f78269de83fa4f367305217ae5?s=128&d=identicon&r=PG", "display_name": "Adam F", "link": "https://stackoverflow.com/users/6348185/adam-f"}, "edited": false, "score": 0, "creation_date": 1463697401, "post_id": 37290718, "comment_id": 62188067, "body": "Hey Ashton, Thanks heaps for your response, your code completes all the tasks but it does not prefill the new &quot;Template&quot; tab with the information collected on the &quot;Index&quot; tab in the original spread sheet. i.e call A2 on the &quot;Index&quot; tab should populate into cell F2 on the &quot;Template tab of the first workbook created, and then B2 into F3 and B3 into F4 and then B4 into F5. once this is correct it needs to move to the next line and complete for A3 to F2 in the same pattern. Thanks heaps for helping me out."}], "tags": [], "owner": {"reputation": 1549, "user_id": 5896420, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/b86Xv.png?s=128&g=1", "display_name": "luckyguy73", "link": "https://stackoverflow.com/users/5896420/luckyguy73"}, "is_accepted": false, "score": 0, "last_activity_date": 1463547966, "creation_date": 1463547966, "answer_id": 37290718, "question_id": 37288066, "link": "https://stackoverflow.com/questions/37288066/vb-macro-to-create-new-workbooks-and-prefill-the-new-workbooks-from-the-master-s/37290718#37290718", "title": "VB Macro to create new workbooks and prefill the new workbooks from the master sheet", "body": "<p>try this    </p>\n\n<pre><code>Sub temp()\nDim wb As Workbook, sh1 As Worksheet, lr As Long, rng As Range, x as long\nSet sh1 = Sheets(\"Index\") 'Edit sheet name\nSet sh2 = Sheets(\"B2\") 'Edit sheet name\nSet sh3 = Sheets(\"Data\") 'Edit sheet name\nlr = sh1.Cells(Rows.Count, \"A\").End(xlUp).Row\nSet rng = sh1.Range(\"A2:A\" &amp; lr)\nx = 2\nFor Each c In rng\n    Sheets(\"Template\").Copy 'Edit sheet name\n    Set wb = ActiveWorkbook\n    wb.Sheets(1).Range(\"F\" &amp; x) = c.Value\n    x = x + 1\n    sh2.Copy After:=wb.Sheets(1)\n    sh3.Copy After:=wb.Sheets(2)\n    wb.SaveAs c.Value &amp; \".xlsx\"\n    wb.Close False\nNext\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6348185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11ab78f78269de83fa4f367305217ae5?s=128&d=identicon&r=PG", "display_name": "Adam F", "link": "https://stackoverflow.com/users/6348185/adam-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 550, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1463589341, "creation_date": 1463529487, "last_edit_date": 1463589341, "question_id": 37288066, "link": "https://stackoverflow.com/questions/37288066/vb-macro-to-create-new-workbooks-and-prefill-the-new-workbooks-from-the-master-s", "title": "VB Macro to create new workbooks and prefill the new workbooks from the master sheet", "body": "<p>I have a macro which works as follows:</p>\n\n<p>I have a workbook which has four tabs in it, \n*Index - Contains a list of Building Information ( 5 Columns in total starting from A finishing E, some months there can be 3 rows and other months there could be 100 rows\n*Template - a template page with basic building info\n*Data - A checklist\n*B2 - Another checklist</p>\n\n<p>what I need the macro to do is to create a new workbook which contains worksheets \"Template\" \"Data\" and \"B2\"</p>\n\n<p>The new workbooks need to be named in accordance with the building name contained in column A on the index worksheet</p>\n\n<p>I then need the list located on the index tab to copy to cells F2, F3, F4, F5, F6 F5 on the template tab for each new workbook ( one for each header )</p>\n\n<p>Below is the code which works but currently only prefills to cell F2 on the template worksheet in the new workbook</p>\n\n<pre><code>    Sub temp()\nDim wb As Workbook, sh1 As Worksheet, lr As Long, rng As Range\nSet sh1 = Sheets(\"Index\") 'Edit sheet name\nSet sh2 = Sheets(\"B2\") 'Edit sheet name\nSet sh3 = Sheets(\"Data\") 'Edit sheet name\nlr = sh1.Cells(Rows.Count, \"A\").End(xlUp).Row\nSet rng = sh1.Range(\"A2:A\" &amp; lr)\n    For Each c In rng\n        Sheets(\"Template\").Copy 'Edit sheet name\n        Set wb = ActiveWorkbook\n        wb.Sheets(1).Range(\"F2\") = c.Value\n        sh2.Copy After:=wb.Sheets(1)\n        sh3.Copy After:=wb.Sheets(2)\n        wb.SaveAs c.Value &amp; \".xlsx\"\n        wb.Close False\n    Next\nEnd Sub\n</code></pre>\n\n<p>Thanks heaps... im sure I have got 90% of this done just the finishing touches </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 1, "creation_date": 1463525810, "post_id": 37287512, "comment_id": 62100049, "body": "is the name cell a range of cells or just one cell?"}, {"owner": {"reputation": 5081, "user_id": 1010405, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/uJsDG.gif?s=128&g=1", "display_name": "NoChance", "link": "https://stackoverflow.com/users/1010405/nochance"}, "reply_to_user": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1463525899, "post_id": 37287512, "comment_id": 62100079, "body": "Good question. In this case, the name refers to a single cell. However, it would be nice to know how to know if it refers to a range. Maybe I could add an IF statement to check the RefresToRange?"}, {"owner": {"reputation": 289, "user_id": 6279098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07a18aebddf7d8f53729ccf79b32a67b?s=128&d=identicon&r=PG&f=1", "display_name": "mhyst", "link": "https://stackoverflow.com/users/6279098/mhyst"}, "edited": false, "score": 0, "creation_date": 1463525919, "post_id": 37287512, "comment_id": 62100084, "body": "Are you sure it isn&#39;t ActiveSheet instead of ActiveWorkBook?"}, {"owner": {"reputation": 5081, "user_id": 1010405, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/uJsDG.gif?s=128&g=1", "display_name": "NoChance", "link": "https://stackoverflow.com/users/1010405/nochance"}, "reply_to_user": {"reputation": 289, "user_id": 6279098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07a18aebddf7d8f53729ccf79b32a67b?s=128&d=identicon&r=PG&f=1", "display_name": "mhyst", "link": "https://stackoverflow.com/users/6279098/mhyst"}, "edited": false, "score": 0, "creation_date": 1463526279, "post_id": 37287512, "comment_id": 62100204, "body": "@mhyst, ActiveWorkbook is a superset that contains all sheets - I am not getting compile error. The error is that the value stored in the property &quot;value&quot; is a range not a plain value."}, {"owner": {"reputation": 289, "user_id": 6279098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07a18aebddf7d8f53729ccf79b32a67b?s=128&d=identicon&r=PG&f=1", "display_name": "mhyst", "link": "https://stackoverflow.com/users/6279098/mhyst"}, "edited": false, "score": 0, "creation_date": 1463526591, "post_id": 37287512, "comment_id": 62100286, "body": "Then you should print all the names to see what is the problem. Perhaps there are some names whose value you cannot change. Or perhaps you have to consider each name as a Range object and then use n.Range(1,1).value or n.Range(&quot;A1&quot;).value"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1463529211, "post_id": 37287512, "comment_id": 62100910, "body": "Consider giving the <b>EoinS</b> answer the checkmark.............it is the better answer."}], "answers": [{"comments": [{"owner": {"reputation": 5081, "user_id": 1010405, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/uJsDG.gif?s=128&g=1", "display_name": "NoChance", "link": "https://stackoverflow.com/users/1010405/nochance"}, "edited": false, "score": 0, "creation_date": 1463528191, "post_id": 37287605, "comment_id": 62100671, "body": "Excellent answer, thanks. I think the property name &quot;Value&quot; is a bit misleading..."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 5081, "user_id": 1010405, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/uJsDG.gif?s=128&g=1", "display_name": "NoChance", "link": "https://stackoverflow.com/users/1010405/nochance"}, "edited": false, "score": 0, "creation_date": 1463529038, "post_id": 37287605, "comment_id": 62100868, "body": "@NoChance  Consider marking <b>EoinS</b>&#39;s answer as the best answer."}, {"owner": {"reputation": 5081, "user_id": 1010405, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/uJsDG.gif?s=128&g=1", "display_name": "NoChance", "link": "https://stackoverflow.com/users/1010405/nochance"}, "edited": false, "score": 0, "creation_date": 1463529361, "post_id": 37287605, "comment_id": 62100947, "body": "I will. His answer pointed out an important point indeed. Your remark is beautiful (I have no other description now!). Thx."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 3, "last_activity_date": 1463527024, "last_edit_date": 1463527024, "creation_date": 1463526332, "answer_id": 37287605, "question_id": 37287512, "link": "https://stackoverflow.com/questions/37287512/how-to-loop-through-named-cells-and-list-value-for-each/37287605#37287605", "title": "How to loop through named cells and list value for each", "body": "<p>That is because the Value of a Name is its augmented Address in formula form..............you need:</p>\n\n<pre><code>Sub ListVarsWithValue()\n    Dim n As Name\n    Dim Count As Integer\n    Dim s As String\n    s = \"\"\n    For Each n In ActiveWorkbook.Names\n        s = s &amp; n.Name &amp; \"=\" &amp; n.Value &amp; \"-\" &amp; Range(n.Value).Value &amp; vbCrLf\n    Next n\n    MsgBox s\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/FVwa3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FVwa3.png\" alt=\"enter image description here\"></a></p>\n\n<p>The logic is:</p>\n\n<p><code>Range(n.Value).Value</code> is like:<br><code>Range(\"Sheet4!$B$4\").Value</code> is like:<br><code>bee</code> which is the actual cell content!</p>\n"}, {"comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 2, "creation_date": 1463528940, "post_id": 37287865, "comment_id": 62100846, "body": "Your answer is better than mine."}], "tags": [], "owner": {"reputation": 4316, "user_id": 6005451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b5d2854ebcf1678d4fab4f7bedd6b9f?s=128&d=identicon&r=PG&f=1", "display_name": "EoinS", "link": "https://stackoverflow.com/users/6005451/eoins"}, "is_accepted": true, "score": 2, "last_activity_date": 1463528365, "last_edit_date": 1463528365, "creation_date": 1463528175, "answer_id": 37287865, "question_id": 37287512, "link": "https://stackoverflow.com/questions/37287512/how-to-loop-through-named-cells-and-list-value-for-each/37287865#37287865", "title": "How to loop through named cells and list value for each", "body": "<p>Name represents a defined name for a range of cells.  When you run this on your activeworkbook you are going to pull Print_Areas and xlfn.countifs_ and other weird name objects you didn't even know about.  Also if your range is more than one cell then range(n.value).value will not work.  There are two many unknowns to try to pull value for each name.</p>\n\n<p>I would throw a test in your sub to make sure there is a value.  This is quick and dirty but you get the idea.</p>\n\n<pre><code>Sub sdf()\nOn Error Resume Next ''shouldn't use this but demonstrates how to get what you need\nFor Each n In ActiveWorkbook.Names\nIf Not IsError(Range(n.Value).Value) Then  ''just try something like this\nDebug.Print n.Name &amp; n.Value &amp; Range(n.Value).Value\nEnd If\nNext\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5081, "user_id": 1010405, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/uJsDG.gif?s=128&g=1", "display_name": "NoChance", "link": "https://stackoverflow.com/users/1010405/nochance"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "accepted_answer_id": 37287865, "answer_count": 2, "score": 2, "last_activity_date": 1463528879, "creation_date": 1463525741, "last_edit_date": 1463528879, "question_id": 37287512, "link": "https://stackoverflow.com/questions/37287512/how-to-loop-through-named-cells-and-list-value-for-each", "title": "How to loop through named cells and list value for each", "body": "<p>I wanted to get the value of each named cell. I started with the code below.\nIts able to list cells with names but does not show the correct value. In the variable <code>n.value</code> I get a reference such as <code>=Orders!$G$8</code>, whereas I was expecting $25 because $25 is what the cell really contains.</p>\n\n<p><strong>The question is:</strong></p>\n\n<p>How to get the value contained using the \"Names\" collection in the for loop?</p>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>Sub ListVarsWithValue()\n    Dim n As Name\n    Dim Count As Integer\n    Dim s As String\n    s=\"\"\n    For Each n In ActiveWorkbook.Names\n        s = s +  n.Name + \"=\" + n.Value + chr(10) '&lt;-- n.value not OK\n    Next n\n    MsgBox s\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 286, "user_id": 5261233, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/i5rHw.jpg?s=128&g=1", "display_name": "Histerical", "link": "https://stackoverflow.com/users/5261233/histerical"}, "edited": false, "score": 0, "creation_date": 1463525546, "post_id": 37287334, "comment_id": 62099967, "body": "If we could get some sample data of what you are trying to accomplish, that would be extremely helpful for us to be able to help you. Also, there are a few lines of your code that could easily be removed by moving them, it is very helpful when writing to try not to duplicate code."}, {"owner": {"reputation": 276, "user_id": 4885960, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/478d641800a96aa96167f35401a7e7aa?s=128&d=identicon&r=PG&f=1", "display_name": "NuWin", "link": "https://stackoverflow.com/users/4885960/nuwin"}, "edited": false, "score": 0, "creation_date": 1463526651, "post_id": 37287334, "comment_id": 62100306, "body": "I&#39;m kind of confused. You want to create new workbooks/sheets for each selected item in the combobox or export as PDF?"}, {"owner": {"reputation": 151, "user_id": 3666237, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/45ba9c861d3ec2d51f40bc99f63dcb1c?s=128&d=identicon&r=PG&f=1", "display_name": "user3666237", "link": "https://stackoverflow.com/users/3666237/user3666237"}, "reply_to_user": {"reputation": 276, "user_id": 4885960, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/478d641800a96aa96167f35401a7e7aa?s=128&d=identicon&r=PG&f=1", "display_name": "NuWin", "link": "https://stackoverflow.com/users/4885960/nuwin"}, "edited": false, "score": 0, "creation_date": 1463579177, "post_id": 37287334, "comment_id": 62125130, "body": "@NuWin No What I want is for each selection in my drop down I want to create a tab for it but I want all the data to just be values.  Currently each drop down trigger lookup formulas for data manipulation.  I will preferably want the newly created tabs in a new workbook but the same workbook will be fine as well."}, {"owner": {"reputation": 151, "user_id": 3666237, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/45ba9c861d3ec2d51f40bc99f63dcb1c?s=128&d=identicon&r=PG&f=1", "display_name": "user3666237", "link": "https://stackoverflow.com/users/3666237/user3666237"}, "reply_to_user": {"reputation": 286, "user_id": 5261233, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/i5rHw.jpg?s=128&g=1", "display_name": "Histerical", "link": "https://stackoverflow.com/users/5261233/histerical"}, "edited": false, "score": 0, "creation_date": 1463579298, "post_id": 37287334, "comment_id": 62125227, "body": "@Histerical  So for example drop down selection number 1,  I want to first create a new workbook that&#39;s going to contain all of the drop down selection tabs.  So as drop down selection 1 is selected, I want to take that data and paste as values in a tab for it.  Than loop to selection 2 and take that data and paste as values in a seperate tab for it as well.  I want to do this for all drop down selections."}], "answers": [{"comments": [{"owner": {"reputation": 151, "user_id": 3666237, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/45ba9c861d3ec2d51f40bc99f63dcb1c?s=128&d=identicon&r=PG&f=1", "display_name": "user3666237", "link": "https://stackoverflow.com/users/3666237/user3666237"}, "edited": false, "score": 0, "creation_date": 1463579020, "post_id": 37294277, "comment_id": 62125015, "body": "N thanks for the effort but your code has me loss  can you please explain it"}, {"owner": {"reputation": 226, "user_id": 3664754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea2cda4b82993a659ee7779a46e3a146?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas N.", "link": "https://stackoverflow.com/users/3664754/andreas-n"}, "reply_to_user": {"reputation": 151, "user_id": 3666237, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/45ba9c861d3ec2d51f40bc99f63dcb1c?s=128&d=identicon&r=PG&f=1", "display_name": "user3666237", "link": "https://stackoverflow.com/users/3666237/user3666237"}, "edited": false, "score": 0, "creation_date": 1463580649, "post_id": 37294277, "comment_id": 62126216, "body": "I&#39;ve made an edit with an attempt, but I would be better able to help you if you could let me know where you get lost"}, {"owner": {"reputation": 151, "user_id": 3666237, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/45ba9c861d3ec2d51f40bc99f63dcb1c?s=128&d=identicon&r=PG&f=1", "display_name": "user3666237", "link": "https://stackoverflow.com/users/3666237/user3666237"}, "edited": false, "score": 0, "creation_date": 1463581552, "post_id": 37294277, "comment_id": 62126927, "body": "I get an error at the line that say Hardcode.  I don&#39;t know if I&#39;m suppose to customize it.  Just to paraphrase what I want to do is each drop down selection alters the data, and for each drop down selection I want to first create a new workbook and a new tab in that workbook for each drop down selection."}, {"owner": {"reputation": 226, "user_id": 3664754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea2cda4b82993a659ee7779a46e3a146?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas N.", "link": "https://stackoverflow.com/users/3664754/andreas-n"}, "reply_to_user": {"reputation": 151, "user_id": 3666237, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/45ba9c861d3ec2d51f40bc99f63dcb1c?s=128&d=identicon&r=PG&f=1", "display_name": "user3666237", "link": "https://stackoverflow.com/users/3666237/user3666237"}, "edited": false, "score": 0, "creation_date": 1463582980, "post_id": 37294277, "comment_id": 62128064, "body": "I fear that I am now the lost one. For each drop down, a new workbook should be created (n possible values would give n unique workbooks), each with a tab for every possible value of the drop down? if that is correct, then what should be in each tab?"}, {"owner": {"reputation": 151, "user_id": 3666237, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/45ba9c861d3ec2d51f40bc99f63dcb1c?s=128&d=identicon&r=PG&f=1", "display_name": "user3666237", "link": "https://stackoverflow.com/users/3666237/user3666237"}, "edited": false, "score": 0, "creation_date": 1463583731, "post_id": 37294277, "comment_id": 62128700, "body": "I just want one new workbook, and for each dropdown selection I want a separate worksheet or tab with the data as values in that new workbook.  The reason why is each drop down selection changes the dashboard and I want to share that snap shot for each dropdown by itself"}, {"owner": {"reputation": 226, "user_id": 3664754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea2cda4b82993a659ee7779a46e3a146?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas N.", "link": "https://stackoverflow.com/users/3664754/andreas-n"}, "reply_to_user": {"reputation": 151, "user_id": 3666237, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/45ba9c861d3ec2d51f40bc99f63dcb1c?s=128&d=identicon&r=PG&f=1", "display_name": "user3666237", "link": "https://stackoverflow.com/users/3666237/user3666237"}, "edited": false, "score": 0, "creation_date": 1463642464, "post_id": 37294277, "comment_id": 62152760, "body": "and that is what the code does. if the data itself is not filtered you can just replace the application of the autofilter within the for loop, with an update to the dropdown that triggers the recalculation. The uKey variable will still be the relevant value"}], "tags": [], "owner": {"reputation": 226, "user_id": 3664754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea2cda4b82993a659ee7779a46e3a146?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas N.", "link": "https://stackoverflow.com/users/3664754/andreas-n"}, "is_accepted": false, "score": 0, "last_activity_date": 1463580518, "last_edit_date": 1495540364, "creation_date": 1463560490, "answer_id": 37294277, "question_id": 37287334, "link": "https://stackoverflow.com/questions/37287334/macro-that-loops-through-drop-down-and-creates-a-worksheet-for-each-drop-down-se/37294277#37294277", "title": "Macro that loops through drop down and creates a worksheet for each drop down selection", "body": "<p>I think you are looking for something like the below (adapted from <a href=\"https://stackoverflow.com/questions/26277590/copying-dynamic-rows-into-new-workbook-and-save-it/26279596#26279596\">copying-dynamic-rows-into-new-workbook-and-save-it</a>).</p>\n\n<pre><code>Option Explicit\nSub grabber()\n    Dim thisWb As Workbook: Set thisWb = ThisWorkbook\n    Dim thisWs As Worksheet: Set thisWs = thisWb.Worksheets(\"dd\") 'replace with relevant name\n    Dim newBook As Workbook\n    Dim newws As Worksheet\n    Dim pathToNewWb As String\n    Dim uKeys\n    Dim currentPath, columnWithKey, numCols, numRows, uKey, dataStartRow, columnKeyName\n\n    'nobody likes flickering screens\n    Application.ScreenUpdating = False\n    'remove any filter applied to the data\n    thisWs.AutoFilterMode = False\n\n    'get the path of the workbook folder\n    currentPath = Application.ThisWorkbook.Path\n\n    'Set the stage\n    '###Hardcode###\n    columnKeyName = \"Facility\" 'name of the column with the facility values\n    dataStartRow = 4 'this is a pure guess, correct as relevenat. Use the header row index\n    pathToNewWb = currentPath &amp; \"/Business Plans.xlsx\" ' where to put the new excel, if you want a saveas prompt you should google \"Application.FileDialog(msoFileDialogSaveAs)\"\n    uKeys = Range(\"Facilities\").Value\n    '###Hardcode End###\n    columnWithKey = thisWs.Range(dataStartRow &amp; \":\" &amp; dataStartRow).Find(what:=columnKeyName, LookIn:=xlValues).Column\n    numCols = thisWs.UsedRange.Columns.Count\n\n    'extract the index of the last used row in the worksheet\n    numRows = thisWs.UsedRange.Rows.Count\n\n    'create the new workbook\n    Set newBook = Workbooks.Add\n\n    'loop the facilities, and do the work\n    For Each uKey In uKeys\n\n        'Filter the keys column for a unique key\n        thisWs.Range(thisWs.Cells(dataStartRow, 1), thisWs.Cells(numRows, numCols)).AutoFilter field:=columnWithKey, Criteria1:=uKey\n\n        'copy the sheet\n        thisWs.UsedRange.Copy\n\n        'Create a new ws for the facility, and paste as values\n        Set newws = newBook.Worksheets.Add\n        With newws\n            .Name = uKey 'I assume the name of the facility is the relevant sheet name\n            .Range(\"A1\").PasteSpecial xlPasteValues\n        End With\n\n        'remove autofilter (paranoid parrot)\n        thisWs.AutoFilterMode = False\n\n    Next uKey\n\n    'save the new workbook\n    newBook.SaveAs pathToNewWb\n    newBook.Close\n\nEnd Sub\n</code></pre>\n\n<p>EDIT:</p>\n\n<p>As I have not seen your data, I would not be surprised if it requires some revision.</p>\n\n<p>First I try to \"frame\" the range of the worksheet \"dd\" that contains the data (the ###Hardcode### bit), define the path for the output, and identify the column that can be filtered for the values corresponding to the named range \"Facilities\". </p>\n\n<p>I retrieve the values of the named range \"Facilities\" (into uKeys), and create the output workbook (newBook). Then we go through each value (uKey) from the uKeys in the for loop. Within the loop, I apply an autofilter for the uKey. The filtration is followed by creation of a sheet (newWs) in newBook, and a copy paste of the filtered worksheet \"dd\" into newWs. we then turn off the autofilter, and the worksheet \"dd\" is returned to its unfiltered state.</p>\n\n<p>At the end we save newBook to the desired location, and close it.</p>\n"}], "owner": {"reputation": 151, "user_id": 3666237, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/45ba9c861d3ec2d51f40bc99f63dcb1c?s=128&d=identicon&r=PG&f=1", "display_name": "user3666237", "link": "https://stackoverflow.com/users/3666237/user3666237"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1207, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1463580518, "creation_date": 1463524687, "last_edit_date": 1463533217, "question_id": 37287334, "link": "https://stackoverflow.com/questions/37287334/macro-that-loops-through-drop-down-and-creates-a-worksheet-for-each-drop-down-se", "title": "Macro that loops through drop down and creates a worksheet for each drop down selection", "body": "<p>So I have a dashboard sheet named \"Business Plans\" where I have a dropdown in cell A2 that's a dropdown selection of a range called \"Facilities\" and all dashboard data are driven off of lookups.  What I want to do is First create a new workbook than a new tab for each dropdown selection with the tab in the same format but the data pasted as values.  I attempted the following code that I created to save every dropdown selection as PDF but I have been unsuccessful.  Any insight on how I can get this code working will be great.</p>\n\n<pre><code>  Sub Worksheet_Generator()\n\n    Dim cell As Range\n    Dim wsSummary As Worksheet\n    Dim counter As Long\n\n    Set wsSummary = Sheets(\"Business Plans\")\n\n    For Each cell In Worksheets(\"dd\").Range(\"$C3:$C75\")\n        If cell.Value = \"\" Then\n            counter = counter + 1\n            Application.StatusBar = \"Processing file: \" &amp; counter &amp; \"/1042\"\n        Else\n            counter = counter + 1\n            Application.StatusBar = \"Processing file: \" &amp; counter &amp; \"/1042\"\n\n            With wsSummary\n                .Range(\"$A$2\").Value = cell.Value\n                ActiveSheet.Copy After:=Worksheets(Worksheets.Count)\n                ActiveSheet.Copy\n                With ActiveSheet.UsedRange\n                    .Value = .Value\n                End With\n            End With\n        End If\n    Next cell\n\nSet wsSummary = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1463520803, "post_id": 37286521, "comment_id": 62098192, "body": "Does the code give an error?  If so, what is the error and in what line does it occur?  Does it produce a different result than you expect?  If so, what result does it produce and what result do you expect?"}, {"owner": {"reputation": 47, "user_id": 1836885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0d74d932809793a4e8d42b4490b58fe?s=128&d=identicon&r=PG", "display_name": "Sam M", "link": "https://stackoverflow.com/users/1836885/sam-m"}, "reply_to_user": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1463521238, "post_id": 37286521, "comment_id": 62098387, "body": "It doesn&#39;t produce any error and result. I expect the code to automatically put in the value in, for e.g. T3 and U3 cells from R3 when user enters &quot;Add&quot; in V3. Please let me know if I can clarify anything further."}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1463521539, "post_id": 37286521, "comment_id": 62098514, "body": "What happens when you step through the code when you have entered, &quot;Add&quot; into one of the cells in column V?  Also, does the code definitely run on the event or is it not even being triggered?"}, {"owner": {"reputation": 1831, "user_id": 2967019, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rnBqX.jpg?s=128&g=1", "display_name": "mrbungle", "link": "https://stackoverflow.com/users/2967019/mrbungle"}, "edited": false, "score": 0, "creation_date": 1463523402, "post_id": 37286521, "comment_id": 62099257, "body": "Shouldn&#39;t <code>Range(&quot;J4&quot;).Value</code> be <code>Range(&quot;J4&quot;).Formula</code>?"}, {"owner": {"reputation": 47, "user_id": 1836885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0d74d932809793a4e8d42b4490b58fe?s=128&d=identicon&r=PG", "display_name": "Sam M", "link": "https://stackoverflow.com/users/1836885/sam-m"}, "reply_to_user": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1463582262, "post_id": 37286521, "comment_id": 62127469, "body": "@OpiesDad: I am not very familiar with excel VBA but after doing some research, I figured out that you can step through the code by hitting F8 for every line of code. However, its not working for me and I could not figure out why. Nothing happens on either hitting F8 or Debug&gt;Step Into. I tried adding &quot;Add&quot; and nothing happens on entering the value in any cell in range &quot;R:R&quot;. The expectation is that the code should definitely run once &quot;Add&quot; is entered in any cell in range &quot;V:V&quot; and a value is entered in corresponding cell in Range &quot;R:R&quot;."}, {"owner": {"reputation": 47, "user_id": 1836885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0d74d932809793a4e8d42b4490b58fe?s=128&d=identicon&r=PG", "display_name": "Sam M", "link": "https://stackoverflow.com/users/1836885/sam-m"}, "reply_to_user": {"reputation": 1831, "user_id": 2967019, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rnBqX.jpg?s=128&g=1", "display_name": "mrbungle", "link": "https://stackoverflow.com/users/2967019/mrbungle"}, "edited": false, "score": 0, "creation_date": 1463582464, "post_id": 37286521, "comment_id": 62127614, "body": "@mrbungle The range (&quot;J4&quot;) and (&quot;J5&quot;) is working fine. However, I took that out of the code now since not having that is not an big issue. I modified the code in my original question above. The main issue is the &quot;Add&quot; issue as I have described above."}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1463589503, "post_id": 37286521, "comment_id": 62132627, "body": "That code should run every time any change in any cell in the worksheet happens.  Where do you have the code?  I don&#39;t think F8 will work to start an event procedure.  Instead, put a break point in by left-clicking in the margin to the left of the first line (Set KeyCells...).  This should create a red dot and highlight the row red.  Then, change any cell in the worksheet.  The code should &quot;break&quot; on this line (showing a yellow arrow pointing to the line and yellow highlighting).  Then you can step through the code with F8."}, {"owner": {"reputation": 47, "user_id": 1836885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0d74d932809793a4e8d42b4490b58fe?s=128&d=identicon&r=PG", "display_name": "Sam M", "link": "https://stackoverflow.com/users/1836885/sam-m"}, "reply_to_user": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1463591316, "post_id": 37286521, "comment_id": 62133617, "body": "@OpiesDad I have the code in the worksheet code area (under Microsoft excel objects &gt; Sheet 1). I have a worksheet named &quot;Sheet 1&quot; where I would like this code to work, so I have placed code in that worksheet."}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1463591803, "post_id": 37286521, "comment_id": 62133912, "body": "Did the break point work/does the code get executed upon changing anything in the sheet?  What happens when you step through the code with the break point?"}, {"owner": {"reputation": 47, "user_id": 1836885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0d74d932809793a4e8d42b4490b58fe?s=128&d=identicon&r=PG", "display_name": "Sam M", "link": "https://stackoverflow.com/users/1836885/sam-m"}, "reply_to_user": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1463591837, "post_id": 37286521, "comment_id": 62133931, "body": "@OpiesDad I just tried as you suggested - left clicking on the left margin for &quot;Set Keycells&quot; line in the code. It was highlighted in red with a red dot in the margin on the left. I then changed a cell in the worksheet but the there was not any yellow highlighting or a yellow arrow. It remained red."}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1463592692, "post_id": 37286521, "comment_id": 62134412, "body": "Do you have macros enabled?  it doesn&#39;t look like your event is firing."}, {"owner": {"reputation": 47, "user_id": 1836885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0d74d932809793a4e8d42b4490b58fe?s=128&d=identicon&r=PG", "display_name": "Sam M", "link": "https://stackoverflow.com/users/1836885/sam-m"}, "reply_to_user": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1463592766, "post_id": 37286521, "comment_id": 62134452, "body": "@OpiesDad I am not sure why breakpoint was not working but I have another copy of the spreadsheet and when I tried it there, it worked and gave me an error &quot;object required&quot;. On hitting the debug in the error message, this line of the code was highlighted &quot;For Each r In Inte&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 1836885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0d74d932809793a4e8d42b4490b58fe?s=128&d=identicon&r=PG", "display_name": "Sam M", "link": "https://stackoverflow.com/users/1836885/sam-m"}, "edited": false, "score": 0, "creation_date": 1463596245, "post_id": 37307309, "comment_id": 62136338, "body": "Thank you so much for explaining. Its making somewhat more sense now. You code is working great if I comment out this line - &quot;r.Offset(0, -1).Value = LCase(r.Offset(0, -4)).Value&quot; since its giving an error of &quot;Object Required&quot;. I don&#39;t have much knowledge about VBA, so I am assuming that uncommenting this line out would not affect anything. Is that correct?"}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "reply_to_user": {"reputation": 47, "user_id": 1836885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0d74d932809793a4e8d42b4490b58fe?s=128&d=identicon&r=PG", "display_name": "Sam M", "link": "https://stackoverflow.com/users/1836885/sam-m"}, "edited": false, "score": 0, "creation_date": 1463596492, "post_id": 37307309, "comment_id": 62136494, "body": "Well, it wouldn&#39;t put the lower case value in the cell that you want.  I accidentally forgot a parenthesis in that line.  See update."}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "reply_to_user": {"reputation": 47, "user_id": 1836885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0d74d932809793a4e8d42b4490b58fe?s=128&d=identicon&r=PG", "display_name": "Sam M", "link": "https://stackoverflow.com/users/1836885/sam-m"}, "edited": false, "score": 0, "creation_date": 1463596525, "post_id": 37307309, "comment_id": 62136511, "body": "If this solves the problem, consider marking this as the answer."}, {"owner": {"reputation": 47, "user_id": 1836885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0d74d932809793a4e8d42b4490b58fe?s=128&d=identicon&r=PG", "display_name": "Sam M", "link": "https://stackoverflow.com/users/1836885/sam-m"}, "edited": false, "score": 0, "creation_date": 1463596695, "post_id": 37307309, "comment_id": 62136598, "body": "I figured why this is giving an error. It should be &quot; r.Offset(0, -1).Value = LCase(r.Offset(0, -4).Value)&quot;. You are awesome OpiesDad. Thank you for all your help."}], "tags": [], "owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "is_accepted": true, "score": 1, "last_activity_date": 1463596456, "last_edit_date": 1463596456, "creation_date": 1463595506, "answer_id": 37307309, "question_id": 37286521, "link": "https://stackoverflow.com/questions/37286521/add-a-value-in-a-cell-based-on-changes-to-another-cell/37307309#37307309", "title": "Add a value in a cell based on changes to another cell", "body": "<p>There are a few things going on here.  I'm not really sure what you're trying to do, but I'll explain what your code is doing and maybe that will help.</p>\n\n<p>First, you mentioned in comments that the event is not firing.  This is because you have disabled events and then not captured any errors.  So, if you have an error in the code and then stop running it, the events are not turned back on.  There is no point in turning off the events in this code.  Excel isn't going to capture any additional events until after this event code is finished running.  If you feel that you must, then add an error handler and turn the events back on if there's an error or remember to do it manually.</p>\n\n<p>The second problem that you have is that your code won't logically work.  You have set 'Inte' to be the intersection of column R and the target, but then you set 'Inter' to be the intersection of column V and the target.  The target is whatever cell was just changed, so unless you are changing multiple cells at once, only one of them will have a value, the other one will be Nothing.</p>\n\n<p>The statement \"For Each r In Inte\" will throw an error if 'Inte' is Nothing and the following statement, \"For Each r1 In Inter\" will throw an error if 'Inter' is Nothing, and so you will get at error here.  You have checked for 'Inter' being nothing, but would also need to check for 'Inte' being nothing.</p>\n\n<p>With that said, even if you had this check, you would never run this code because one of them is always Nothing.</p>\n\n<p>Assuming that there was somehow something in both of these cells, the code you've written will loop through each 'Inte' Cell and for each 'Inte' Cell, it will loop through each cell in 'Inter'.  Then, whenever 'Inter' is 'Add', it will run the code, setting some value.  So, if there are ANY cells that have the value of 'Add' in column V, EVERY row in range 'Inte' will be updated.  I doubt this is what is intended.</p>\n\n<p>I don't think you quite understand what the \"Worksheet_Change\" event does.  It will fire EVERY time you change a cell.  So, if you change Cell V15, it will run with Target being cell V15.  Then, if you change cell R15, it will run again with Target being cell R15.  So it only fires for one cell at a time (unless you change multiple cells at the exact same time)</p>\n\n<p>Perhaps, this is what you are trying to do:</p>\n\n<pre><code> Private Sub Worksheet_Change(ByVal Target As Range)\n     Dim KeyCells As Range\n     Dim A As Range, B As Range, Inte As Range, r As Range, r1 As Range, Inter As Range\n     Dim ws As Worksheet\n\n     Set ws = Target.Worksheet\n     Set KeyCells = Range(\"A9:E9\")\n     Set A = Range(\"R:R\")\n     Set B = Range(\"V:V\")\n     Set Inte = Intersect(A, Target)\n     Set Inter = Intersect(B, Target)\n\n     If Inter Is Nothing Then\n          'Do nothing\n     Else\n          For Each r In Inter\n                If r.Value = \"Add\" Then\n                     r.Offset(0, -2).Value = r.Offset(0,-4).Value\n                     r.Offset(0, -1).Value = lCase(r.Offset(0,-4).Value)\n                End If\n\n          Next r\n      End If\n      If Inte Is Nothing Then\n          'Do Nothing\n      Else\n           For Each r In Inte\n                 If ws.Range(\"V\" &amp; r.Row) = \"Add\" Then\n                      r.Offset(0, 2).Value = r.Value\n                      r.Offset(0, 3).Value = LCase(r.Value)\n                 End If\n           Next r\n      End If\n\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 1836885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0d74d932809793a4e8d42b4490b58fe?s=128&d=identicon&r=PG", "display_name": "Sam M", "link": "https://stackoverflow.com/users/1836885/sam-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "accepted_answer_id": 37307309, "answer_count": 1, "score": 1, "last_activity_date": 1463596456, "creation_date": 1463520445, "last_edit_date": 1531164843, "question_id": 37286521, "link": "https://stackoverflow.com/questions/37286521/add-a-value-in-a-cell-based-on-changes-to-another-cell", "title": "Add a value in a cell based on changes to another cell", "body": "<p>I need some advice regarding what am I doing wrong in the code below. What I am trying to do is that if user enters <code>\"Add\"</code> any cell in <code>Range (\"V\"V\")</code>, and then enter any value in the corresponding cell in Range <code>(\"R:R\")</code>, then the value of corresponding cell in <code>Range T (=r.offset (0,2))</code> gets the same value as the cell in <code>R:R</code>, and the corresponding cell in <code>Range U (=r.offset (0,3))</code> get the same value as <code>R:R</code> cell but in lower case.</p>\n\n<p>Modified the code below by taking out all extra stuff.  </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim KeyCells As Range\nDim A As Range, B As Range, Inte As Range, r As Range, r1 As Range, Inter As Range\n\n    Set KeyCells = Range(\"A9:E9\")\n    Set A = Range(\"R:R\")\n    Set B = Range(\"V:V\")\n    Set Inte = Intersect(A, Target)\n    Set Inter = Intersect(B, Target)\n     Application.EnableEvents = True\n\n    If Inter Is Nothing Then Exit Sub\n    Application.EnableEvents = False\n        For Each r In Inte\n        For Each r1 In Inter\n        If r1.Value = \"Add\" Then\n            r.Offset(0, 2).Value = r.Value\n            r.Offset(0, 3).Value = LCase(r.Value)\n            End If\n        Next r1\n        Next r\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 286, "user_id": 5261233, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/i5rHw.jpg?s=128&g=1", "display_name": "Histerical", "link": "https://stackoverflow.com/users/5261233/histerical"}, "edited": false, "score": 0, "creation_date": 1463521206, "post_id": 37286392, "comment_id": 62098366, "body": "I think we need a little more information on what you mean by selecting multiple rows. So if you select A1 and B5, you want it to run from A1 and B5 but have the same result with the different columns?"}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 1, "creation_date": 1463521697, "post_id": 37286392, "comment_id": 62098574, "body": "The first problem that you are having is that you are using &quot;ActiveCell&quot;.  ActiveCell is only 1 cell and is defined as the upper-left most cell in the selected cells.  You want to use &quot;Selection.&quot; instead of &quot;ActiveCell.&quot;"}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 1, "creation_date": 1463521787, "post_id": 37286392, "comment_id": 62098618, "body": "The second problem that you may have is if the user selects a disjointed range.  To get past this, use the split function: rangeArray = Split(Selection.Address,&quot;,&quot;) and then loop through the Array."}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 1, "creation_date": 1463521967, "post_id": 37286392, "comment_id": 62098698, "body": "Once you get the rows, loop through them BACKWARDS, so that you don&#39;t change the row numbers of the ones above it.  Then you can modify the code that you&#39;ve provided to do the desired merging."}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1463522002, "post_id": 37286392, "comment_id": 62098708, "body": "I&#39;m not particularly in the mood to write the code, and it will be instructive for you to do it yourself.  If you get stuck on a specific part, feel free to post another question."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6347856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/280f36dd0db640356dbfd3b570d96a0f?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/6347856/james"}, "edited": false, "score": 0, "creation_date": 1463582046, "post_id": 37286685, "comment_id": 62127301, "body": "Currently I have one row with data. I would like to have one cell for columns A:I and 8 cells for colums J:Q relative to the one cell in A:I              Example: On a blank work sheet if I merged cells A1:A8 repeated the process through column I, I would have my result."}, {"owner": {"reputation": 286, "user_id": 5261233, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/i5rHw.jpg?s=128&g=1", "display_name": "Histerical", "link": "https://stackoverflow.com/users/5261233/histerical"}, "reply_to_user": {"reputation": 11, "user_id": 6347856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/280f36dd0db640356dbfd3b570d96a0f?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/6347856/james"}, "edited": false, "score": 0, "creation_date": 1463582243, "post_id": 37286685, "comment_id": 62127460, "body": "So you want A1:A8 to be merged for instance and every column through I to be the same way? I&#39;m confused about what you mean for J:Q."}, {"owner": {"reputation": 11, "user_id": 6347856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/280f36dd0db640356dbfd3b570d96a0f?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/6347856/james"}, "edited": false, "score": 0, "creation_date": 1463582315, "post_id": 37286685, "comment_id": 62127500, "body": "Correct for A1:A8 to be merged. I used the inserting rows technique because I need to apply this to over 100 rows that already have data."}, {"owner": {"reputation": 286, "user_id": 5261233, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/i5rHw.jpg?s=128&g=1", "display_name": "Histerical", "link": "https://stackoverflow.com/users/5261233/histerical"}, "reply_to_user": {"reputation": 11, "user_id": 6347856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/280f36dd0db640356dbfd3b570d96a0f?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/6347856/james"}, "edited": false, "score": 0, "creation_date": 1463582518, "post_id": 37286685, "comment_id": 62127648, "body": "Could you provide a before and after screenshot of what you are trying to do? I am a little confused about the J:Q part of your comment. Also with the code I provided it will add the rows and merge A:I on whatever rows are selected."}, {"owner": {"reputation": 11, "user_id": 6347856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/280f36dd0db640356dbfd3b570d96a0f?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/6347856/james"}, "edited": false, "score": 0, "creation_date": 1463582949, "post_id": 37286685, "comment_id": 62128036, "body": "What 163:170 look like is what row 171 will look like after my marco is applied. It works when one cell is selected but would like it to work when multiple cells are selected."}, {"owner": {"reputation": 286, "user_id": 5261233, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/i5rHw.jpg?s=128&g=1", "display_name": "Histerical", "link": "https://stackoverflow.com/users/5261233/histerical"}, "reply_to_user": {"reputation": 11, "user_id": 6347856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/280f36dd0db640356dbfd3b570d96a0f?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/6347856/james"}, "edited": false, "score": 0, "creation_date": 1463583018, "post_id": 37286685, "comment_id": 62128095, "body": "Would you be selecting cells in the same row? That would make the code not work correctly for what I posted, I would have to weed out duplicate rows to get that to work."}, {"owner": {"reputation": 11, "user_id": 6347856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/280f36dd0db640356dbfd3b570d96a0f?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/6347856/james"}, "edited": false, "score": 0, "creation_date": 1463583322, "post_id": 37286685, "comment_id": 62128343, "body": "I think I can explain this much simpler. 1. Select row 1 . 2. Insert 7 rows. 3. Merge cells for A1:A8 (Repeat for B1:I8). Done. Repeat. Select Row 9 insert 7 rows. Select A:9:A17 merge cells (Repeat for B9:I17)"}, {"owner": {"reputation": 11, "user_id": 6347856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/280f36dd0db640356dbfd3b570d96a0f?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/6347856/james"}, "edited": false, "score": 0, "creation_date": 1463583351, "post_id": 37286685, "comment_id": 62128364, "body": "I need to select cells in same column not row"}, {"owner": {"reputation": 286, "user_id": 5261233, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/i5rHw.jpg?s=128&g=1", "display_name": "Histerical", "link": "https://stackoverflow.com/users/5261233/histerical"}, "reply_to_user": {"reputation": 11, "user_id": 6347856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/280f36dd0db640356dbfd3b570d96a0f?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/6347856/james"}, "edited": false, "score": 0, "creation_date": 1463583984, "post_id": 37286685, "comment_id": 62128903, "body": "I think I understand what you are wanting with J:Q, took me a few times of reading over your post and comments to make sense of it. Sounds like you just want J:Q to not be merged like A:I. Have you tried using the code in my above answer? It should work as you have asked, for every cell you select, it will merge A:I and add the 7 rows below the selected cell."}, {"owner": {"reputation": 286, "user_id": 5261233, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/i5rHw.jpg?s=128&g=1", "display_name": "Histerical", "link": "https://stackoverflow.com/users/5261233/histerical"}, "reply_to_user": {"reputation": 11, "user_id": 6347856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/280f36dd0db640356dbfd3b570d96a0f?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/6347856/james"}, "edited": false, "score": 0, "creation_date": 1463586484, "post_id": 37286685, "comment_id": 62130681, "body": "I updated my post with a lot more code, this was a fun little project that had a few challenges. I was able to use some code I&#39;ve used before to get it to work. I hope this is what you are looking for."}, {"owner": {"reputation": 11, "user_id": 6347856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/280f36dd0db640356dbfd3b570d96a0f?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/6347856/james"}, "edited": false, "score": 0, "creation_date": 1463595883, "post_id": 37286685, "comment_id": 62136117, "body": "Worked! Thank You Histerical"}, {"owner": {"reputation": 286, "user_id": 5261233, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/i5rHw.jpg?s=128&g=1", "display_name": "Histerical", "link": "https://stackoverflow.com/users/5261233/histerical"}, "reply_to_user": {"reputation": 11, "user_id": 6347856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/280f36dd0db640356dbfd3b570d96a0f?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/6347856/james"}, "edited": false, "score": 0, "creation_date": 1463596406, "post_id": 37286685, "comment_id": 62136434, "body": "You bet! Good luck with your future programming, Excel is a fun tool. Don&#39;t forget to mark the answer."}], "tags": [], "owner": {"reputation": 286, "user_id": 5261233, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/i5rHw.jpg?s=128&g=1", "display_name": "Histerical", "link": "https://stackoverflow.com/users/5261233/histerical"}, "is_accepted": false, "score": 0, "last_activity_date": 1463586435, "last_edit_date": 1463586435, "creation_date": 1463521252, "answer_id": 37286685, "question_id": 37286392, "link": "https://stackoverflow.com/questions/37286392/excel-vba-macro-from-one-cell-to-multiple-cells/37286685#37286685", "title": "Excel VBA macro from one cell to multiple cells", "body": "<p>I have made a few adjustments to make more sense of this code and make it much easier to read through. This doesn't answer your original question as I need a little more information to understand what you trying to do. But this should help myself and others read through your code easier.</p>\n\n<p>I made a guess at what you were looking for and pasted some code that should work for you, if you want every column from A to I in the row you select to be merged with the 7 inserted rows below.</p>\n\n<pre><code>    Sub splitrowsandmerge()\n'\n' splitrowsandmerge Macro\n' add 7 rows and merge 8 rows for first 9 columns\n'\n' Keyboard Shortcut: Ctrl+Shift+E\n'\n\nDim RowArray() As Integer\n\ncheck = 0\n\nFor Each cell In Selection\n    If firstTime &lt;&gt; 1 Then\n        ReDim RowArray(0) As Integer\n        RowArray(0) = cell.Row\n        firstTime = 1\n    Else\n\n        For i = LBound(RowArray) To UBound(RowArray)\n            If RowArray(i) = cell.Row Then\n                check = 1\n                Exit For\n            End If\n        Next i\n\n        If check &lt;&gt; 1 Then\n            addOne = addOne + 1\n            ReDim Preserve RowArray(addOne) As Integer\n            RowArray(addOne) = cell.Row\n        End If\n\n        check = 0\n    End If\nNext cell\n\nRowArray = BubbleSrt(RowArray, False)\nFor i = LBound(RowArray) To UBound(RowArray)\n\n    startCell = RowArray(i)\n    Rows(startCell + 1).EntireRow.Resize(7).Insert\n\n    With Range(Cells(startCell, 1), Cells(startCell + 7, 9))\n        .HorizontalAlignment = xlCenter\n        .VerticalAlignment = xlTop\n        .WrapText = True\n        .Orientation = 0\n        .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = False\n    End With\n\n    For j = 1 To 9\n        Range(Cells(startCell, j), Cells(startCell + 7, j)).Merge\n    Next j\nNext i\n\nEnd Sub\n\nPublic Function BubbleSrt(ArrayIn, Ascending As Boolean)\n\nDim SrtTemp As Variant\nDim i As Long\nDim j As Long\n\n\nIf Ascending = True Then\n    For i = LBound(ArrayIn) To UBound(ArrayIn)\n         For j = i + 1 To UBound(ArrayIn)\n             If ArrayIn(i) &gt; ArrayIn(j) Then\n                 SrtTemp = ArrayIn(j)\n                 ArrayIn(j) = ArrayIn(i)\n                 ArrayIn(i) = SrtTemp\n             End If\n         Next j\n     Next i\nElse\n    For i = LBound(ArrayIn) To UBound(ArrayIn)\n         For j = i + 1 To UBound(ArrayIn)\n             If ArrayIn(i) &lt; ArrayIn(j) Then\n                 SrtTemp = ArrayIn(j)\n                 ArrayIn(j) = ArrayIn(i)\n                 ArrayIn(i) = SrtTemp\n             End If\n         Next j\n     Next i\nEnd If\n\nBubbleSrt = ArrayIn\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6347856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/280f36dd0db640356dbfd3b570d96a0f?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/6347856/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 951, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1463586435, "creation_date": 1463519880, "last_edit_date": 1531164843, "question_id": 37286392, "link": "https://stackoverflow.com/questions/37286392/excel-vba-macro-from-one-cell-to-multiple-cells", "title": "Excel VBA macro from one cell to multiple cells", "body": "<p>This macro works if you apply to one cell at a time (or if you drag across multiple rows, will work on the row of the top-left-most cell). Is there a way I can further tweak it to get my macro to apply the changes to the rows of all selected cells so that the user can make changes to rows in bulk?</p>\n\n<p>I recorded a macro that will split what exist as one row into 8 rows for the last <code>columns J:Q</code>\nMy logic was to insert 7 rows above a selected cell (which exist below the cell that will be merged) and then merge the rows with the original existing row for <code>columns A:I</code></p>\n\n<p>This will give me one cell for <code>A:I</code> and 8 rows for <code>J:Row</code> End </p>\n\n<pre><code>*See macro below\n\n\n\nSub splitrowsandmerge()\n'\n' splitrowsandmerge Macro\n' add 7 rows and merge 8 rows for first 9 columns\n'\n' Keyboard Shortcut: Ctrl+Shift+E\n'\nActiveCell.Offset(1, 0).Rows(\"1:1\").EntireRow.Select\nSelection.Insert Shift:=xlDown\nSelection.Insert Shift:=xlDown\nSelection.Insert Shift:=xlDown\nSelection.Insert Shift:=xlDown\nSelection.Insert Shift:=xlDown\nSelection.Insert Shift:=xlDown\nSelection.Insert Shift:=xlDown\nActiveCell.Offset(-1, 0).Range(\"A1:A8\").Select\nWith Selection\n    .HorizontalAlignment = xlCenter\n    .VerticalAlignment = xlTop\n    .WrapText = True\n    .Orientation = 0\n    .AddIndent = False\n    .IndentLevel = 0\n    .ShrinkToFit = False\n    .ReadingOrder = xlContext\n    .MergeCells = False\nEnd With\nSelection.Merge\nActiveCell.Offset(0, 1).Range(\"A1:A8\").Select\nWith Selection\n    .HorizontalAlignment = xlCenter\n    .VerticalAlignment = xlTop\n    .WrapText = True\n    .Orientation = 0\n    .AddIndent = False\n    .IndentLevel = 0\n    .ShrinkToFit = False\n    .ReadingOrder = xlContext\n    .MergeCells = False\nEnd With\nSelection.Merge\nActiveCell.Offset(0, 1).Range(\"A1:A8\").Select\nWith Selection\n    .HorizontalAlignment = xlCenter\n    .VerticalAlignment = xlTop\n    .WrapText = True\n    .Orientation = 0\n    .AddIndent = False\n    .IndentLevel = 0\n    .ShrinkToFit = False\n    .ReadingOrder = xlContext\n    .MergeCells = False\nEnd With\nSelection.Merge\nActiveCell.Offset(0, 1).Range(\"A1:A8\").Select\nWith Selection\n    .HorizontalAlignment = xlCenter\n    .VerticalAlignment = xlTop\n    .WrapText = True\n    .Orientation = 0\n    .AddIndent = False\n    .IndentLevel = 0\n    .ShrinkToFit = False\n    .ReadingOrder = xlContext\n    .MergeCells = False\nEnd With\nSelection.Merge\nActiveCell.Offset(0, 1).Range(\"A1:A8\").Select\nWith Selection\n    .HorizontalAlignment = xlCenter\n    .VerticalAlignment = xlTop\n    .WrapText = True\n    .Orientation = 0\n    .AddIndent = False\n    .IndentLevel = 0\n    .ShrinkToFit = False\n    .ReadingOrder = xlContext\n    .MergeCells = False\nEnd With\nSelection.Merge\nActiveCell.Offset(0, 1).Range(\"A1:A8\").Select\nWith Selection\n    .HorizontalAlignment = xlCenter\n    .VerticalAlignment = xlTop\n    .WrapText = True\n    .Orientation = 0\n    .AddIndent = False\n    .IndentLevel = 0\n    .ShrinkToFit = False\n    .ReadingOrder = xlLTR\n    .MergeCells = False\nEnd With\nSelection.Merge\nActiveCell.Offset(0, 1).Range(\"A1:A8\").Select\nWith Selection\n    .HorizontalAlignment = xlCenter\n    .VerticalAlignment = xlTop\n    .WrapText = True\n    .Orientation = 0\n    .AddIndent = False\n    .IndentLevel = 0\n    .ShrinkToFit = False\n    .ReadingOrder = xlContext\n    .MergeCells = False\nEnd With\nSelection.Merge\nActiveCell.Offset(0, 1).Range(\"A1:A8\").Select\nWith Selection\n    .HorizontalAlignment = xlCenter\n    .VerticalAlignment = xlTop\n    .WrapText = True\n    .Orientation = 0\n    .AddIndent = False\n    .IndentLevel = 0\n    .ShrinkToFit = False\n    .ReadingOrder = xlContext\n    .MergeCells = False\nEnd With\nSelection.Merge\nActiveCell.Offset(0, 1).Range(\"A1:A8\").Select\nWith Selection\n    .HorizontalAlignment = xlCenter\n    .VerticalAlignment = xlTop\n    .WrapText = True\n    .Orientation = 0\n    .AddIndent = False\n    .IndentLevel = 0\n     .ShrinkToFit = False\n    .ReadingOrder = xlContext\n    .MergeCells = False\nEnd With\nSelection.Merge\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 17990, "user_id": 5827958, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/V9KEl.png?s=128&g=1", "display_name": "zondo", "link": "https://stackoverflow.com/users/5827958/zondo"}, "edited": false, "score": 0, "creation_date": 1463533803, "post_id": 37286303, "comment_id": 62101930, "body": "While this code snippet may solve the question, <a href=\"http://meta.stackexchange.com/questions/114762/explaining-entirely-code-based-answers\">including an explanation</a> really helps to improve the quality of your post. Remember that you are answering the question for readers in the future, and those people might not know the reasons for your code suggestion."}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 0, "last_activity_date": 1463519484, "creation_date": 1463519484, "answer_id": 37286303, "question_id": 37286088, "link": "https://stackoverflow.com/questions/37286088/regular-expression-in-api-google-maps/37286303#37286303", "title": "regular expression in API google maps", "body": "<p>try this instead:</p>\n\n<pre><code>regex.Pattern = \"(?:\"\"lng\"\" : )([^\\n\\r]+)\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1463543942, "post_id": 37288457, "comment_id": 62104462, "body": "Very nice solution! +1"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1463532697, "creation_date": 1463532697, "answer_id": 37288457, "question_id": 37286088, "link": "https://stackoverflow.com/questions/37286088/regular-expression-in-api-google-maps/37288457#37288457", "title": "regular expression in API google maps", "body": "<p>Using RegEx on json will eventually drive you crazy...</p>\n\n<pre><code>Sub Test()\n\n    Dim j, s As Object\n    j = \"{location : {lat : -33.4419266, lng : -70.64956029999999}}\"\n\n    Set s = CreateObject(\"scriptcontrol\")\n    s.Language = \"javascript\"\n\n    s.eval \"var o = (\" &amp; j &amp; \");\"\n\n    Debug.Print s.eval(\"o.location.lng\") '&gt;&gt; -70.6495603\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6347769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bccedb9f14b0cc2881a799804d150a91?s=128&d=identicon&r=PG", "display_name": "sebastian azocar", "link": "https://stackoverflow.com/users/6347769/sebastian-azocar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 201, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1463532697, "creation_date": 1463518481, "last_edit_date": 1531164843, "question_id": 37286088, "link": "https://stackoverflow.com/questions/37286088/regular-expression-in-api-google-maps", "title": "regular expression in API google maps", "body": "<p>I need to extract the data \" lng\" from the API Geocode </p>\n\n<pre><code>\"location\" : {\n               \"lat\" : -33.4419266,\n               \"lng\" : -70.64956029999999\n              },\n</code></pre>\n\n<p>and, I tried this: </p>\n\n<pre><code>regex.Pattern = \"location(?:.|\\n)*?\"\"lng\"\".*?([0-9]+)\": regex.Global = False\n</code></pre>\n\n<p>but for moment, I get \"70\" and not \"-70.64956029999999\". \nHow I can get the full number? Thanks</p>\n"}, {"tags": ["excel", "vba", "pdf"], "comments": [{"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 1, "creation_date": 1463520392, "post_id": 37285833, "comment_id": 62097997, "body": "This site is not to write code for you.  Start by writing some VBA code and then post a question when you have a specific question that you can&#39;t figure out.  For sending an email from Excel, start here: <a href=\"http://excel-macro.tutorialhorizon.com/excel-vba-send-a-excel-workbook-as-attachment-in-mail-from-ms-outlook-using-excel/\" rel=\"nofollow noreferrer\">excel-macro.tutorialhorizon.com/&hellip;</a>"}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1463520505, "post_id": 37285833, "comment_id": 62098051, "body": "To assign the checkboxes to a pdf file, you need to name each checkbox, and then check to see if it&#39;s checked when making an email.  If checked, attach the appropriate file, if not, then don&#39;t.  I&#39;d make constant variables with the filepath for each attachment."}], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 1, "last_activity_date": 1463793996, "creation_date": 1463793996, "answer_id": 37357988, "question_id": 37285833, "link": "https://stackoverflow.com/questions/37285833/from-excel-to-outlook-how-to-do-the-link-especially-with-files-such-as-pdf/37357988#37357988", "title": "From Excel to Outlook: how to do the link especially with files such as PDF", "body": "<p>Your approach is almost right, but off a bit.  Please see the link below.  You should find your answer there.</p>\n\n<p><a href=\"http://www.rondebruin.nl/win/s1/outlook/amail6.htm\" rel=\"nofollow\">http://www.rondebruin.nl/win/s1/outlook/amail6.htm</a></p>\n"}], "owner": {"reputation": 101, "user_id": 5744351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e0912dba8f4464ffdfe5abef5d2f69a?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/5744351/pierre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1463793996, "creation_date": 1463517498, "question_id": 37285833, "link": "https://stackoverflow.com/questions/37285833/from-excel-to-outlook-how-to-do-the-link-especially-with-files-such-as-pdf", "title": "From Excel to Outlook: how to do the link especially with files such as PDF", "body": "<p><strong><em>First a few words of context:</em></strong></p>\n\n<p>In my company we always have to attach 3 PDF files when it comes to sending an e-mail (by Outlook) to a client regarding a product. Sometimes when we speak about several products, we have to send even more PDF files. Hopefully some files are redundant because they are \"family\" of products but still it's really a mess. </p>\n\n<p>Then I got the idea of creating an excel sheet with the list of all the products and all the associated PDFs to send. The idea is to tick the box of which files we want to send then click on the big email icon and all the chosen documents will be already attached to an e-mail in Outlook. After that all you have to do is to write the name of the client and you're done: send it!.</p>\n\n<p>Having an idea is great but implementing it is better. That's where my Excel and VBA skills are lacking.</p>\n\n<p><strong>Here are the questions:</strong> </p>\n\n<p>1.how to assign a pdf files to a \"box\" </p>\n\n<p>2.how to create the link from Excel to an email in Outlook by simply clicking on the mail icon so that all chosen documents are attached in the email? </p>\n\n<p>Here are the pictures that will help you understand the issue. </p>\n\n<p><a href=\"https://i.stack.imgur.com/X56gx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/X56gx.png\" alt=\"Excel example\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/bExWw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bExWw.png\" alt=\"Outlook example\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1463518476, "post_id": 37285772, "comment_id": 62097092, "body": "Did you mean to increment <code>x</code> instead of <code>counter</code> ?"}, {"owner": {"reputation": 49, "user_id": 5912333, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh3.googleusercontent.com/-T4lCUns4p0E/AAAAAAAAAAI/AAAAAAAAADc/bC2W5hg47xc/photo.jpg?sz=128", "display_name": "Mofasa E", "link": "https://stackoverflow.com/users/5912333/mofasa-e"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1463525178, "post_id": 37285772, "comment_id": 62099873, "body": "Oh yes, thats a typo!"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1463526149, "post_id": 37285772, "comment_id": 62100157, "body": "In your question, or in your actual code?  It would help if you could provide some sample input: what are the various values in <code>results2</code> ?"}, {"owner": {"reputation": 49, "user_id": 5912333, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh3.googleusercontent.com/-T4lCUns4p0E/AAAAAAAAAAI/AAAAAAAAADc/bC2W5hg47xc/photo.jpg?sz=128", "display_name": "Mofasa E", "link": "https://stackoverflow.com/users/5912333/mofasa-e"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1463537123, "post_id": 37285772, "comment_id": 62102718, "body": "results2 are just coefficients of a 4th degree polynomial"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1463596287, "post_id": 37285772, "comment_id": 62136360, "body": "Maybe start here: <a href=\"https://www.google.com/?gws_rd=ssl#q=quartic+equation+solver+VBA\" rel=\"nofollow noreferrer\">google.com/?gws_rd=ssl#q=quartic+equation+solver+VBA</a>"}], "owner": {"reputation": 49, "user_id": 5912333, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh3.googleusercontent.com/-T4lCUns4p0E/AAAAAAAAAAI/AAAAAAAAADc/bC2W5hg47xc/photo.jpg?sz=128", "display_name": "Mofasa E", "link": "https://stackoverflow.com/users/5912333/mofasa-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 375, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1463537280, "creation_date": 1463517180, "last_edit_date": 1531164843, "question_id": 37285772, "link": "https://stackoverflow.com/questions/37285772/find-x-intercept-of-4th-degree-polynomial", "title": "Find x intercept of 4th degree polynomial", "body": "<p>I have a 4th degree polynomial and I am trying to find the first x intercept using the following code:</p>\n\n<pre><code>Function Findintercept(results2 As Variant) As Double\n    Dim equation As Double, x As Double\n    'equation = results2(1)*x^4 + results2(2)*x^3 + results2(3)*x^2 + results2(4)*x + results2(5)\n    x = 0\n    equation = results(1) * x ^ 4 + results(2) * x ^ 3 + results(3) * x ^ 2 + results(4) * x + results(5)\n    While (equation &gt; 0.01 Or equation &lt; -0.01)\n        x = x + 0.001\n        equation = results2(1) * x ^ 4 + results2(2) * x ^ 3 + results2(3) * x ^ 2 + results2(4) * x + results2(5)\n    Wend\n    Findintercept = x\nEnd Function\n</code></pre>\n\n<p>The idea is to keep looping through all values of x until the equation becomes 0 and then return this value of x. Does my logic work? I just need the first x intercept! The result doesnt have to be 0 EXACTLY, just close enough?</p>\n\n<p>results2 contains the coefficients of a 4th degree polynomial</p>\n\n<pre><code>Sample values of results2 = {-933302, 22776, 1408.6, -95.787, 1.3348}\n</code></pre>\n\n<p>The function should find the x intercept.. for above sample about 1.26?</p>\n"}, {"tags": ["excel", "vba", "pdf"], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 6296540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9899701d1666a561e7e8532e4bfd7272?s=128&d=identicon&r=PG&f=1", "display_name": "ectrimm", "link": "https://stackoverflow.com/users/6296540/ectrimm"}, "edited": false, "score": 0, "creation_date": 1463518523, "post_id": 37285813, "comment_id": 62097110, "body": "The code for RDB_Create_PDF is too long to post. However, your suggestion seems to work, although all of the information on the original sheet is deleted after I run the sub."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 17, "user_id": 6296540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9899701d1666a561e7e8532e4bfd7272?s=128&d=identicon&r=PG&f=1", "display_name": "ectrimm", "link": "https://stackoverflow.com/users/6296540/ectrimm"}, "edited": false, "score": 0, "creation_date": 1463518623, "post_id": 37285813, "comment_id": 62097156, "body": "That&#39;s likely happening somewhere in your called Sub"}, {"owner": {"reputation": 17, "user_id": 6296540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9899701d1666a561e7e8532e4bfd7272?s=128&d=identicon&r=PG&f=1", "display_name": "ectrimm", "link": "https://stackoverflow.com/users/6296540/ectrimm"}, "edited": false, "score": 0, "creation_date": 1463518867, "post_id": 37285813, "comment_id": 62097285, "body": "Here is a sample of the code (in the second grey box): <a href=\"http://stackoverflow.com/questions/36647945/solved-compile-on-demand-disabled\" title=\"solved compile on demand disabled\">stackoverflow.com/questions/36647945/&hellip;</a>"}, {"owner": {"reputation": 17, "user_id": 6296540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9899701d1666a561e7e8532e4bfd7272?s=128&d=identicon&r=PG&f=1", "display_name": "ectrimm", "link": "https://stackoverflow.com/users/6296540/ectrimm"}, "edited": false, "score": 0, "creation_date": 1463519131, "post_id": 37285813, "comment_id": 62097402, "body": "I think I figured it out. Myvar was set to = &quot;&quot;."}, {"owner": {"reputation": 17, "user_id": 6296540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9899701d1666a561e7e8532e4bfd7272?s=128&d=identicon&r=PG&f=1", "display_name": "ectrimm", "link": "https://stackoverflow.com/users/6296540/ectrimm"}, "edited": false, "score": 0, "creation_date": 1463519297, "post_id": 37285813, "comment_id": 62097470, "body": "Thanks for your help."}, {"owner": {"reputation": 17, "user_id": 6296540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9899701d1666a561e7e8532e4bfd7272?s=128&d=identicon&r=PG&f=1", "display_name": "ectrimm", "link": "https://stackoverflow.com/users/6296540/ectrimm"}, "edited": false, "score": 0, "creation_date": 1463520309, "post_id": 37285813, "comment_id": 62097962, "body": "Do I even really need RDB_Create_PDF?  Can I not do everything within the Sub?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 17, "user_id": 6296540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9899701d1666a561e7e8532e4bfd7272?s=128&d=identicon&r=PG&f=1", "display_name": "ectrimm", "link": "https://stackoverflow.com/users/6296540/ectrimm"}, "edited": false, "score": 0, "creation_date": 1463522252, "post_id": 37285813, "comment_id": 62098812, "body": "No and Yes, although having the functionality as a separate procedure helps keep your code easier to follow."}, {"owner": {"reputation": 17, "user_id": 6296540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9899701d1666a561e7e8532e4bfd7272?s=128&d=identicon&r=PG&f=1", "display_name": "ectrimm", "link": "https://stackoverflow.com/users/6296540/ectrimm"}, "edited": false, "score": 0, "creation_date": 1463578492, "post_id": 37285813, "comment_id": 62124631, "body": "Okay. Thanks for all your help."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1463517400, "creation_date": 1463517400, "answer_id": 37285813, "question_id": 37285309, "link": "https://stackoverflow.com/questions/37285309/how-do-i-align-saving-a-pdf-file-with-the-correct-active-worksheet/37285813#37285813", "title": "How do I align saving a pdf file with the correct active worksheet?", "body": "<pre><code>RDB_Create_PDF(Range(ws.PageSetup.PrintArea), _\n               \"N:\\Excel\\VBA\\\" &amp; CleanStr(ws.Name) &amp; \".pdf\", True, True)\n</code></pre>\n\n<p>here <code>Range</code> will default to the ActiveSheet and not to <code>ws</code></p>\n\n<pre><code>RDB_Create_PDF(ws.Range(ws.PageSetup.PrintArea), _\n               \"N:\\Excel\\VBA\\\" &amp; CleanStr(ws.Name) &amp; \".pdf\", True, True)\n</code></pre>\n\n<p>is probably what you want but hard to tell for sure without posting the code for <code>RDB_Create_PDF</code></p>\n"}], "owner": {"reputation": 17, "user_id": 6296540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9899701d1666a561e7e8532e4bfd7272?s=128&d=identicon&r=PG&f=1", "display_name": "ectrimm", "link": "https://stackoverflow.com/users/6296540/ectrimm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 37285813, "answer_count": 1, "score": 0, "last_activity_date": 1463517400, "creation_date": 1463515519, "last_edit_date": 1463515958, "question_id": 37285309, "link": "https://stackoverflow.com/questions/37285309/how-do-i-align-saving-a-pdf-file-with-the-correct-active-worksheet", "title": "How do I align saving a pdf file with the correct active worksheet?", "body": "<p>I am trying to save a series of worksheets into individual files named for each Excel sheet. </p>\n\n<pre><code>For Each ws In ActiveWorkbook.Sheets \n    fileName = RDB_Create_PDF(Range(ws.PageSetup.PrintArea), \"N:\\Excel\\VBA\\\" &amp; CleanStr(ws.Name) &amp; \".pdf\", True, True)\nNext\n</code></pre>\n\n<p>. The problem is that the printarea and the filename change for each <code>ws</code>\u00a0, but it saves only the information from the current active worksheet\u2014i.e., I get the same worksheet information saved with different printarea ranges and different filenames. How would I get the active worksheet to align with the printarea and filename as the ws changes? </p>\n"}, {"tags": ["vba", "vlookup", "excel-indirect"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1463515675, "post_id": 37285302, "comment_id": 62095625, "body": "One too many <code>)</code> on the end remove one."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1463515740, "post_id": 37285302, "comment_id": 62095648, "body": "<code>&quot;=VLOOKUP(A&quot; &amp; n &amp; &quot;,INDIRECT(&quot;&quot;&#39;&quot;&quot; &amp; B1 &amp; &quot;&quot;&#39;!A1:H76&quot;&quot;),3,0)&quot;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1549, "user_id": 5896420, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/b86Xv.png?s=128&g=1", "display_name": "luckyguy73", "link": "https://stackoverflow.com/users/5896420/luckyguy73"}, "is_accepted": true, "score": 1, "last_activity_date": 1463557320, "creation_date": 1463557320, "answer_id": 37293186, "question_id": 37285302, "link": "https://stackoverflow.com/questions/37285302/vba-using-vlookup-of-indirect-range-for-formula-in-cell/37293186#37293186", "title": "VBA using vlookup of indirect range for formula in cell", "body": "<p>this is what you wanted, where sheet name is in b1 and table array A1:H76 is in cell b2</p>\n\n<pre><code>Dim n As Long\n\nFor n = 6 To 77\n\nRange(\"c\" &amp; n).Formula = \"=VLOOKUP(a\" &amp; n &amp; \", INDIRECT(\"\"'\"\" &amp; b1 &amp; \"\"'!\"\" &amp; b2),3,0)\"\n\nNext n\n</code></pre>\n"}], "owner": {"reputation": 135, "user_id": 5393024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c1e9bf18905dd5ba898a5dbbf42513a?s=128&d=identicon&r=PG&f=1", "display_name": "Meghan", "link": "https://stackoverflow.com/users/5393024/meghan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 830, "favorite_count": 0, "accepted_answer_id": 37293186, "answer_count": 1, "score": 2, "last_activity_date": 1463557320, "creation_date": 1463515499, "question_id": 37285302, "link": "https://stackoverflow.com/questions/37285302/vba-using-vlookup-of-indirect-range-for-formula-in-cell", "title": "VBA using vlookup of indirect range for formula in cell", "body": "<p>I'm sure it's an error with the way I'm using my quotes and apostrophes but for the life of me I can't fix it. I'm running a loop in VBA to add a vlookup in an indirect range. When I just use an indirect cell based on the row number I'm in, I have no errors (see below):</p>\n\n<pre><code>For n = 6 To 77\n    Range(\"A\" &amp; n).Formula = \"=IF(INDIRECT(\"\"'\"\" &amp; B1 &amp; \"\"'!A\" &amp; n &amp; \"\"\")=\"\"\"\",\"\"\"\",INDIRECT(\"\"'\"\" &amp; B1 &amp; \"\"'!A\" &amp; n &amp; \"\"\"))\"\nNext n\n</code></pre>\n\n<p>Where B1 is the cell with the name of the sheet I want to reference. </p>\n\n<p>When I try to incorporate the same logic into a VLOOKUP, I get a run-time error:</p>\n\n<pre><code>For n = 6 To 77\n    Range(\"C\" &amp; n).Formula = \"=VLOOKUP(A\" &amp; n &amp; \",INDIRECT(\"\"'\"\" &amp; B1 &amp; \"\"'!A1:H76\"\"\" &amp; \"),3,0))\"\nNext n\n</code></pre>\n\n<p>I'm sure it's something with the quotes but I just can't figure it out, please help!</p>\n"}]