[{"tags": ["excel", "vba", "range"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1573080038, "post_id": 58739498, "comment_id": 103768909, "body": "What&#39;s the problem/question here? Here <code>LastRow = Cells.Find(What:=&quot;*&quot;, SearchDirection:=xlPrevious, SearchOrder:=xlByRows).Row</code> your <code>Cells</code> is not scoped to the <code>With</code> block, and you should check you got a hit before trying to access the <code>Row</code> property"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1573080131, "post_id": 58739498, "comment_id": 103768929, "body": "Side note: you <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">don&#39;t need to activate and select in your code</a>"}, {"owner": {"reputation": 41, "user_id": 8756684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce04ee9492c7165001e6f3dd611100d7?s=128&d=identicon&r=PG&f=1", "display_name": "Reg Chand", "link": "https://stackoverflow.com/users/8756684/reg-chand"}, "edited": false, "score": 0, "creation_date": 1573080505, "post_id": 58739498, "comment_id": 103769042, "body": "how do I get range from &quot;data&quot; sheet where range is &quot;A2:A250&quot; and enter it in Sheet Journal e.g. if I enter date Sheets(&quot;Journal&quot;).rng.Value = dte instead of rng if I enter A2:A10&quot; it works."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 8756684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce04ee9492c7165001e6f3dd611100d7?s=128&d=identicon&r=PG&f=1", "display_name": "Reg Chand", "link": "https://stackoverflow.com/users/8756684/reg-chand"}, "edited": false, "score": 0, "creation_date": 1573082072, "post_id": 58739698, "comment_id": 103769459, "body": "What a legend, that you so much :)"}], "tags": [], "owner": {"reputation": 58, "user_id": 5189499, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-qS5vwcaML3w/AAAAAAAAAAI/AAAAAAAADPI/1cgSVqyCYpw/photo.jpg?sz=128", "display_name": "James", "link": "https://stackoverflow.com/users/5189499/james"}, "is_accepted": true, "score": 1, "last_activity_date": 1573081456, "creation_date": 1573081456, "answer_id": 58739698, "question_id": 58739498, "link": "https://stackoverflow.com/questions/58739498/excel-vba-define-and-enter-data-from-range-in-another-worksheet/58739698#58739698", "title": "excel vba define and enter data from range in another worksheet", "body": "<p>the rng variable isn't being set on the Journal worksheet, so you can fill it that way.  If you make the range name a variable, it can be used in the statement</p>\n\n<pre><code>Sub CreateJnl()\n\n    Dim dte As String, strRange As String\n    Dim LastRow As Long\n    Dim rng As Range\n    Dim ws As Worksheet\n\n    Application.Calculation = xlManual\n    Application.ScreenUpdating = False\n\n    Sheets(\"Journal\").Cells.ClearContents\n\n    Set ws = ThisWorkbook.Sheets(\"Data\")\n\n    With ws\n        If Application.WorksheetFunction.CountA(.Cells) &lt;&gt; 0 Then\n            LastRow = .Cells.Find(What:=\"*\", SearchDirection:=xlPrevious, _\n            SearchOrder:=xlByRows).Row\n            Range(\"A2\").Resize(LastRow).Select\n            MsgBox \"The data range address is \" &amp; Selection.Address(0, 0) &amp; \".\", _\n            vbInformation, \"Data-Contatining range address:\"\n        Else\n            LastRow = 1\n        End If\n\n        If Not LastRow &lt; 3 Then\n            'Set rng = .Range(\"A2:A\" &amp; LastRow)\n            strRange = \"A2:A\" &amp; LastRow\n            'Debug.Print rng.Address\n        Else\n            MsgBox \"No Data found beyond A3\"\n        End If\n    End With\n\n    dte = InputBox(\"Please Enter Date: \", Default:=Format(Now, \"dd/mm/yyyy\"))\n    Sheets(\"Journal\").Activate\n    Sheets(\"Journal\").Range(strRange).Value = dte\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 8756684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce04ee9492c7165001e6f3dd611100d7?s=128&d=identicon&r=PG&f=1", "display_name": "Reg Chand", "link": "https://stackoverflow.com/users/8756684/reg-chand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 58739698, "answer_count": 1, "score": 0, "last_activity_date": 1573083431, "creation_date": 1573079924, "last_edit_date": 1573083431, "question_id": 58739498, "link": "https://stackoverflow.com/questions/58739498/excel-vba-define-and-enter-data-from-range-in-another-worksheet", "title": "excel vba define and enter data from range in another worksheet", "body": "<p>I have two sheets \nfirst sheet gets data from SQL table so the range always changes depending on data size\nI have determined what the range is for cell A2: endxldown</p>\n\n<p>In sheet 2 I have a date form which promts user to enter a date when user enters the date e.g. today,\nexcel needs to enter this date in sheet 2 e.g. sheet 1 has data range of A2:A20 so sheet 2 will enter todays dats in range A2:A20</p>\n\n<p>This gives me range in sheet 1;</p>\n\n<pre><code>Sub findlastrow()\nDim LastRow As Long\n\nWith Worksheets(\"Data\").Activate\nLastRow = Cells.Find(What:=\"*\", SearchDirection:=xlPrevious, _\nSearchOrder:=xlByRows).Row\nRange(\"A1\").Resize(LastRow).Select\nMsgBox \"The data range address is \" &amp; Selection.Address(0, 0) &amp; \".\", _\nvbInformation, \"Data-Contatining range address:\"\nEnd With\n\n\nEnd Sub\n</code></pre>\n\n<p>Answer = A2:A251</p>\n\n<p>The below code is suppose to enter date in range A2:A251</p>\n\n<pre><code>Sub CreateJnl()\n\nDim dte As String\nDim LastRow As Long\nDim rng As Range\nDim ws As Worksheet\n\n\n\n\nApplication.Calculation = xlManual\nApplication.ScreenUpdating = False\n\nSheets(\"Journal\").Cells.ClearContents\n\nSet ws = ThisWorkbook.Sheets(\"Data\")\n\nWith ws\nIf Application.WorksheetFunction.CountA(.Cells) &lt;&gt; 0 Then\nLastRow = Cells.Find(What:=\"*\", SearchDirection:=xlPrevious, _\nSearchOrder:=xlByRows).Row\nRange(\"A2\").Resize(LastRow).Select\nMsgBox \"The data range address is \" &amp; Selection.Address(0, 0) &amp; \".\", _\nvbInformation, \"Data-Contatining range address:\"\n\n    Else\n        LastRow = 1\n    End If\n\n    If Not LastRow &lt; 3 Then\n        Set rng = .Range(\"A2:A\" &amp; LastRow)\n\n        Debug.Print rng.Address\n    Else\n        MsgBox \"No Data found beyond A3\"\n    End If\nEnd With\n\n\n\ndte = InputBox(\"Please Enter Date: \", Default:=Format(Now, \"dd/mm/yyyy\"))\nSheets(\"Journal\").rng.Value = dte\n\n\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1573079589, "post_id": 58739404, "comment_id": 103768754, "body": "Please <a href=\"https://stackoverflow.com/posts/58739404/edit\">edit</a> the question end fix the formatting. All code must be preceded by four spaces, or use the <code>{}</code> button in the edit toolbar."}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1573079689, "post_id": 58739404, "comment_id": 103768795, "body": "Have you tried using <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/ubound-function\" rel=\"nofollow noreferrer\"><code>UBOUND()</code></a> and <code>LBOUND()</code> to find the size of the array?"}], "answers": [{"tags": [], "owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "is_accepted": true, "score": 2, "last_activity_date": 1573096242, "creation_date": 1573096242, "answer_id": 58741438, "question_id": 58739404, "link": "https://stackoverflow.com/questions/58739404/how-to-convert-array-from-x-yz-dimensions-into-x-y-dimensions/58741438#58741438", "title": "How to convert array from (x,y)(z) dimensions into (x,y) dimensions?", "body": "<p>Each element of the Bloomberg array is returning 2 sets of data.  The key is to have your array have double the number of elements of the top level Bloomberg array.</p>\n\n<pre><code>Sub ConvertBloombergTestData()\n    Dim r As Variant\n    r = getBloombergTestData\n\n    Dim Values  As Variant\n    Dim n As Long\n    Dim j As Long\n    Dim Item\n    ReDim Values(1 To (UBound(r) + 1) * 2, 1 To 2)\n    For n = LBound(r) To UBound(r)\n        j = j + 1\n        Item = r(n, 0)\n        Values(j, 1) = Item(0)\n        Values(j, 2) = Item(1)\n        Item = r(n, 1)\n        j = j + 1\n        Values(j, 1) = Item(0)\n        Values(j, 2) = Item(1)\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>Not knowing the the array nesting but knowing that we are returning pairs of data, we could add all the data to a collection and create our array bu iterating over the collection.</p>\n\n<pre><code>Sub Test()\n    Dim r As Variant, Values  As Variant\n    r = getBloombergTestData\n    Values = ConvertBloombergArrayTo2d(r)\nEnd Sub\n\nFunction ConvertBloombergArrayTo2d(BloombergArray)\n    Dim Map As New Collection\n\n    FlattenArray Map, BloombergArray\n\n    Dim Results As Variant\n    ReDim Results(1 To Map.Count / 2, 1 To 2)\n    Dim n As Long, j As Long\n\n    For n = 1 To Map.Count Step 2\n        j = j + 1\n        Results(j, 1) = Map.Item(n)\n        Results(j, 2) = Map.Item(n + 1)\n    Next\n    ConvertBloombergArrayTo2d = Results\nEnd Function\n\nSub FlattenArray(Map As Collection, Element As Variant)\n    If Right(TypeName(Element), 2) = \"()\" Then\n        Dim Item\n        For Each Item In Element\n            FlattenArray Map, Item\n        Next\n    Else\n        Map.Add Element\n    End If\nEnd Sub\n</code></pre>\n\n<h2><a href=\"https://i.stack.imgur.com/iO8NA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/iO8NA.png\" alt=\"Locals Window\"></a></h2>\n"}], "owner": {"reputation": 35, "user_id": 10864046, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sCp2s9Wzvus/AAAAAAAAAAI/AAAAAAAABw8/0tBTf9FGOXs/photo.jpg?sz=128", "display_name": "adam t", "link": "https://stackoverflow.com/users/10864046/adam-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 58741438, "answer_count": 1, "score": 2, "last_activity_date": 1573096846, "creation_date": 1573079316, "last_edit_date": 1573096846, "question_id": 58739404, "link": "https://stackoverflow.com/questions/58739404/how-to-convert-array-from-x-yz-dimensions-into-x-y-dimensions", "title": "How to convert array from (x,y)(z) dimensions into (x,y) dimensions?", "body": "<p>I am working with Bloomberg's API in VBA and I want to be able to take in the arrays that the API gives out from requesting historical data and put it into a table that has field names. However, the array that the API gives me is given in this format: (x,y)(Z) but I cannot use that for inserting into a table. I also want to be able to add another piece of data into the array while I convert from one form to another</p>\n\n<p>I have tried just going through the Bloomberg array and replacing each element in a different array, but the main issues I have are not being able to know how big I need the array to be and how I am going to loop through the bloomberg API without going out of index and getting an error. I have tried using Ubound, but it does not work the way I have intended. </p>\n\n<p>This is the code  I have tried using to convert my array and then insert it. It just puts in blank values and does not put in anything into the table</p>\n\n<pre><code>Sub mWriteToTable(vTableName As String, ByVal vArray As Variant, vCUSIPS As Variant, vFields As Variant)\nOn Error GoTo ErrorHandler\n    Dim db As DAO.Database\n    Dim rs As DAO.Recordset\n    Dim x As Long, y As Long\n    Dim TEST As String\n    Dim DataArray() As Variant\n\n    Set db = CurrentDb\n    Set rs = db.OpenRecordset(vTableName, dbOpenDynaset, dbSeeChanges)\n    TEST = \"\"\n    Dim xBound As Integer, yBound As Integer, ThirdBound As Integer, fieldcount As Integer, NewBoundY As Integer, Z As Integer\n\n    Dim Boundarynum As Integer\n    Boundarynum = 0\n    Dim Boundarynum1 As Integer\n    Boundarynum1 = 0\n    fieldcount = UBound(vFields, 1) + 1\n    xBound = UBound(vArray, 1)\n    yBound = UBound(vArray, 2)\n    NewBoundY = fieldcount * (fieldcount + 1)\n    ReDim DataArray(0 To 20, 0 To (xBound + 1))\n    'using a static size for the array for now. Will try and make it the same size as the bloomberg array\n\n\n   'TRANSFORMING ARRAY FROM BLOOMBERG\n\n\n    For x = 0 To xBound\n        For y = 0 To NewBoundY\n            For Boundarynum1 = 0 To yBound\n        On Error Resume Next\n        DataArray(Boundarynum, Boundarynum1) = vArray(x, y)(Boundarynum1)\n\n        Next\n        Boundarynum = Boundarynum + 1\n       Next\n            Next\n    'TRANSFORMING ARRAY FROM BLOOMBERG\n\n    'set CUSIP in array\n    y = 0\n    Dim counter As Integer\n    counter = 0\n    For Z = 0 To 20\n\n    If DataArray(Z, 0) = \"\" Then\n    Debug.Print (\"\")\n    counter = 1\n    ElseIf counter = 1 And DataArray(Z, 0) &lt;&gt; \"\" Then\n    y = y + 1\n    DataArray(Z, 3) = vCUSIPS(y)\n    counter = 0\n    Else\n     DataArray(Z, 3) = vCUSIPS(y)\n        End If\n        Next\n    'set CUSIP in array\n\n   For x = 0 To 20\n\n        With rs\n            .AddNew\n            For y = 0 To yBound\n\n'                    On Error GoTo Line1\n'                     If vArray(x, y) = \"NA\" Then\n'                    TEST = \"This is a test\"\n'                    End If\n'Line1:\n\n                    .fields(y) = DataArray(x, y)\n\n\n\n\n\n\n\n            Next\n            .Update\n\n\n        End With\n    Next\n    'Call fImmediateWindow(vArray)\n\nErrorHandler:\n\n    If Err.Number &lt;&gt; 0 Then\n        Dim vMsg As String\n        vMsg = \"Error # \" &amp; Str(Err.Number) &amp; \" was generated by \" &amp; Err.Source &amp; Chr(13) &amp; \"Error Line: \" &amp; Erl &amp; Chr(13) &amp; Err.Description\n        MsgBox vMsg, , \"Error\", Err.HelpFile, Err.HelpContext\n    End If\n\n    rs.Close\n    Set rs = Nothing\n    db.Close\n    Set db = Nothing\nEnd Sub\n'''\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/gffeO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gffeO.png\" alt=\"enter image description here\"></a></p>\n\n<p>This is the way the Bloomberg Array looks when I get it. I am unsure of how to really work around this. The array from the program above just becomes blank.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 1, "creation_date": 1573080145, "post_id": 58739341, "comment_id": 103768936, "body": "Its because you have linked the spreadsheet cells directly to the Textbox.  What you should do instead is to have a set of local variables which are used to capture info from the spreadsheet and display it in the text box but which are not written back to the spreadsheet until you click OK or not written back to the spreadsheet if you click cancel."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1573081361, "post_id": 58739341, "comment_id": 103769259, "body": "<a href=\"https://rubberduckvba.wordpress.com/2017/10/25/userform1-show/\" rel=\"nofollow noreferrer\">This article</a> should help. <a href=\"https://rubberduckvba.wordpress.com/2018/05/08/apply-logic-for-userform-dialog/\" rel=\"nofollow noreferrer\">This one</a> too."}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 1, "last_activity_date": 1573236521, "last_edit_date": 1573236521, "creation_date": 1573233621, "answer_id": 58771177, "question_id": 58739341, "link": "https://stackoverflow.com/questions/58739341/userform-initialize-without-rewriting-data-in-the-cell/58771177#58771177", "title": "Userform initialize without rewriting data in the cell", "body": "<p>The <code>TextBox.Enter</code> event isn't fired when the user presses <kbd>Enter</kbd>, but when <em>the control</em> is entered - that is, when it gets the focus and a caret/cursor starts blinking inside it. You'll want to update the backing variable when the value is <em>modified</em>:</p>\n\n<pre><code>Private Sub TextBox14_Enter()\n    'runs when the control gets focus\nEnd Sub\n\nPrivate Sub TextBox14_Exit()\n    'runs when the control loses focus\nEnd Sub\n\nPrivate Sub TextBox14_Change()\n    'runs whenever the value changes (real-time)\nEnd Sub\n</code></pre>\n\n<p>So in this case I'd go with the <code>TextBox.Change</code> event handler, and make it update the variable (not the worksheet):</p>\n\n<pre><code>Private ProjectClass As String\n\nPrivate Sub TextBox14_Change()\n    ProjectClass = TextBox14.Text\nEnd Sub\n</code></pre>\n\n<p>Now the problem is that the <code>ProjectClass</code> value needs to be accessible from outside the form, so that the caller can set an initial value. One way to do this could be to expose it as a property - one property (get+let) for each field you want to seed a value for:</p>\n\n<pre><code>Public Property Get ProjClass() As String\n    ProjClass = ProjectClass\nEnd Property\n\nPublic Property Let ProjClass(ByVal value As String)\n    ProjectClass = value\n    ApplyModelProperties\nEnd Property\n\nPrivate Sub ApplyModelProperties()\n    TextBox14.Text = ProjectClass\n    '...\nEnd Sub\n</code></pre>\n\n<p>Now from outside the form, at the call site (the code that's showing this dialog), you can seed the value from the worksheet, and the form never needs to know or care that a worksheet was involved:</p>\n\n<pre><code>With New UserForm1\n    .ProjClass = ThisWorkbook.Worksheets(\"Other Data\").Range(\"L49\").Value\n    .Show\n    MsgBox .ProjClass\nEnd With\n</code></pre>\n\n<p>Note that because the value is exposed as a property, the calling code doesn't need to know about <code>TextBox14</code> anymore.</p>\n"}], "owner": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 58771177, "answer_count": 1, "score": 1, "last_activity_date": 1573236521, "creation_date": 1573078891, "last_edit_date": 1573231210, "question_id": 58739341, "link": "https://stackoverflow.com/questions/58739341/userform-initialize-without-rewriting-data-in-the-cell", "title": "Userform initialize without rewriting data in the cell", "body": "<p>I have been wondering about this one for a while now. </p>\n\n<p>Let's say I have a formula in A1, Worksheet(\"Main\")</p>\n\n<pre><code>=IF(B2=\"English\";\"Good morning\";\"Guten Morgan\")\n</code></pre>\n\n<p>Then I have userform with code:</p>\n\n<pre><code>Private Sub TextBox1_Change()\nThisWorkbook.Worksheets(\"Main\").Range(\"A1\").Value = Me.TextBox1.Text\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\nMe.TextBox1.Text = ThisWorkbook.Worksheets(\"Main\").Range(\"A1\").Value\nEnd Sub\n</code></pre>\n\n<p>How can I make it work so, that if I don't input anything into textbox, it will keep displaying functions result. If I will start to type text into textbox it will input my typed text to A1. Now if I open the userform it will overwrite A1 with the text in textbox and there will be no formula anymore. So if I change language in B2 result will no longer be interfaced into textbox. </p>\n\n<p>Can be also some other approach with VBA. Everything is acceptable as long as logic will work.</p>\n\n<p>I have tried to use textbox properly, something like linkedsource or similar, but it is crashing excel workbook sometimes. That's why I am trying to avoid it.</p>\n\n<hr>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Thank you for suggestions! I have tried to implement this somehow but still don't get it. I am creating variable where I want to store result from <code>ThisWorkbook.Worksheets(\"Other Data\").Range(\"L49\").Value</code> then I would like to use it in <code>Userform Me.TextBox14.Text</code> to be displayed. Then once it is changed in Me.TextBox14.Text and Enter button has been pressed it should change also in <code>ThisWorkbook.Worksheets(\"Other Data\").Range(\"L49\").Value</code>.</p>\n\n<p>Here is my current code I am trying to play with:</p>\n\n<pre><code>Private ProjectClass As String\n\nPrivate Sub TextBox14_Enter()\nThisWorkbook.Worksheets(\"Other Data\").Range(\"L49\").Value = ProjectClass\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\nMe.TextBox14.Text = ProjectClass\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1573078253, "post_id": 58739201, "comment_id": 103768317, "body": "Consider getting rid of that inner <code>For</code> loop and instead using <code>Range.Find()</code> Like. <code>foundCell = Range(&quot;A1:A&quot; &amp; Sheet2LastRow&quot;).Find(Worksheets(&quot;Sheet1&quot;).Cells(j, 1).Value)</code> Then you can do <code>foundCell.Offset(, 2).Value = Worksheets(&quot;Sheet2&quot;).Cells(i, 2).Value</code> and so on. That should dramatically improve performance."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1573078995, "post_id": 58739201, "comment_id": 103768567, "body": "Can there be multiple matches for a given sheet1 value?  If only a single match then <code>Application.Match()</code> is probably the fastest approach."}, {"owner": {"reputation": 1, "user_id": 12334645, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OjFxoDw-so4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rckjulJ8d_zeZnC5av1uC9sa-qdJw/photo.jpg?sz=128", "display_name": "Ryan", "link": "https://stackoverflow.com/users/12334645/ryan"}, "edited": false, "score": 0, "creation_date": 1573079565, "post_id": 58739201, "comment_id": 103768748, "body": "Thanks for fast reply, there can be only 1 match between sheet1 and sheet2, sheet2 is basicly the master database that has 42000 unique numbers in column A. What would be the best way to implement application? And is it easy to look in a seperate workbook instead of sheet2?"}, {"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1573088770, "post_id": 58739201, "comment_id": 103770960, "body": "&quot;Would also be nice if Sheet2 could be a seperate workbook&quot; Easy. <code>Dim wb As Workbook Set wb = Workbooks.Add</code> then just declare your new worksheet, replace that in your code, and viola"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12334645, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OjFxoDw-so4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rckjulJ8d_zeZnC5av1uC9sa-qdJw/photo.jpg?sz=128", "display_name": "Ryan", "link": "https://stackoverflow.com/users/12334645/ryan"}, "edited": false, "score": 0, "creation_date": 1573113542, "post_id": 58740828, "comment_id": 103777485, "body": "I&#39;m getting a  out of range error on set ws1 = wb1. Worksheet(&#39;&#39;sheet1&quot;) any quick fix?"}, {"owner": {"reputation": 1, "user_id": 12334645, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OjFxoDw-so4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rckjulJ8d_zeZnC5av1uC9sa-qdJw/photo.jpg?sz=128", "display_name": "Ryan", "link": "https://stackoverflow.com/users/12334645/ryan"}, "edited": false, "score": 0, "creation_date": 1573115393, "post_id": 58740828, "comment_id": 103778349, "body": "Also out of range error on ws1newdata(rw, 1) =newdata(1,1) when I temporarily fixed the code with excel.activesheet on previous comment"}, {"owner": {"reputation": 1, "user_id": 12334645, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OjFxoDw-so4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rckjulJ8d_zeZnC5av1uC9sa-qdJw/photo.jpg?sz=128", "display_name": "Ryan", "link": "https://stackoverflow.com/users/12334645/ryan"}, "edited": false, "score": 0, "creation_date": 1573131384, "post_id": 58740828, "comment_id": 103786911, "body": "Program basicly tells me ws1range. Value = empty     any way to fix this?"}], "tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": false, "score": 1, "last_activity_date": 1573091321, "creation_date": 1573091321, "answer_id": 58740828, "question_id": 58739201, "link": "https://stackoverflow.com/questions/58739201/vba-excel-matching-values-in-sheets-and-copy-rows/58740828#58740828", "title": "VBA Excel Matching value&#39;s in sheets and copy rows", "body": "<p>Any reference to a worksheet or cell in VBA is a slow operation.  Only doing a few won't be noticable, but doing many will slow for code down.  Here, in your for loop, you are doing up to 42,000 * 1,000 * 8  = 332,000,000</p>\n\n<p>The key to fast code is to reduce the number of sheet references as much as possible.  Common techniques include</p>\n\n<ul>\n<li>Moving large blocks of data to / from a Variant Array (and looping that variant array without referencing the sheet)</li>\n<li>Using Range.Find to avoid a loop</li>\n<li>Using VLookup / HLookup / Match to avoid a loop</li>\n<li>Using Range.SpecialCells to reduce the size of a range reference</li>\n<li>Avoid Active: here you have implicit references to the ActiveWorkbook</li>\n</ul>\n\n<p>In your case I'd suggest a combination of a Variant Array and Match, somethng like this</p>\n\n<pre><code>Sub CheckAML()\n    Dim wb1 As Workbook, wb2 As Workbook\n    Dim ws1 As Worksheet, ws2 As Worksheet\n    Dim j As Long\n    Dim ws1Range As Range\n    Dim ws1Data As Variant\n    Dim ws1NewData As Variant\n    Dim ws2Range As Range\n    Dim rw As Variant\n    Dim Newdata As Variant\n\n    Set wb1 = ThisWorkbook 'the workbook containing the code\n    Set wb2 = Application.Workbooks(\"NameOfWorkbook.xlsm\")\n    Set ws1 = wb1.Worksheets(\"Sheet1\")\n    Set ws2 = wb2.Worksheets(\"Sheet2\")\n\n    With ws1\n        Set ws1Range = .Range(.Cells(1, 1), .Cells(.Rows.Count, 1).End(xlUp))\n    End With\n\n    With ws2\n        Set ws2Range = .Range(.Cells(1, 1), .Cells(.Rows.Count, 1).End(xlUp))\n    End With\n\n    ws1Data = ws1Range.Value\n    ws1NewData = ws1Range.Offset(0, 2).Resize(, 3).Formula\n\n    For j = 1 To UBound(ws1Data, 1)\n        rw = Application.Match(ws1Data(j, 1), ws2Range, 0)\n        If Not IsError(rw) Then\n            Newdata = ws2.Cells(rw, 2).Resize(, 3).Value\n            ws1NewData(rw, 1) = Newdata(1, 1)\n            ws1NewData(rw, 2) = Newdata(1, 2)\n            ws1NewData(rw, 3) = Newdata(1, 3)\n        End If\n    Next\n\n    ws1Range.Offset(, 2).Resize(, 3).Formula = ws1NewData\n\nEnd Sub\n</code></pre>\n\n<p><Sub>Note: this will preserve any existing data and formulas on ws1, and only overwrite where there is a match</sub></p>\n"}], "owner": {"reputation": 1, "user_id": 12334645, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OjFxoDw-so4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rckjulJ8d_zeZnC5av1uC9sa-qdJw/photo.jpg?sz=128", "display_name": "Ryan", "link": "https://stackoverflow.com/users/12334645/ryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573091321, "creation_date": 1573078017, "last_edit_date": 1573078275, "question_id": 58739201, "link": "https://stackoverflow.com/questions/58739201/vba-excel-matching-values-in-sheets-and-copy-rows", "title": "VBA Excel Matching value&#39;s in sheets and copy rows", "body": "<p>Im pretty new into programming with VBA in excel I got my code working but its just too slow.</p>\n\n<p>Could you guys help me speeding up my task.</p>\n\n<p>Sheet2 has around 42.000 items and sheet1 varies from 100 to 1000</p>\n\n<p>Basicly I look for a value in 2 sheets when there is a match I copy the info into sheet1 from sheet2.</p>\n\n<p>See my code below.</p>\n\n<pre><code>Sub CheckAML()\n\nDim i As Long\nDim j As Long\nSheet1LastRow = Worksheets(\"Sheet1\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nSheet2LastRow = Worksheets(\"Sheet2\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nApplication.ScreenUpdating = False\n\n    For j = 1 To Sheet1LastRow\n        For i = 1 To Sheet2LastRow\n            If Worksheets(\"Sheet1\").Cells(j, 1).Value = Worksheets(\"Sheet2\").Cells(i, 1).Value Then\n                Worksheets(\"Sheet1\").Cells(j, 3).Value = Worksheets(\"Sheet2\").Cells(i, 2).Value\n                Worksheets(\"Sheet1\").Cells(j, 4).Value = Worksheets(\"Sheet2\").Cells(i, 3).Value\n                Worksheets(\"Sheet1\").Cells(j, 5).Value = Worksheets(\"Sheet2\").Cells(i, 4).Value\n            Else\n            End If\n    Next i\nNext j\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>Would also be nice if Sheet2 could be a seperate workbook.</p>\n"}, {"tags": ["vba", "performance", "loops"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1573077839, "post_id": 58739116, "comment_id": 103768170, "body": "Instead of that inner <code>for</code> loop use <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.find\" rel=\"nofollow noreferrer\"><code>Range.Find()</code></a> it&#39;s like a million times quicker for finding a match inside of a range. If you are really stuck on that inner <code>for</code> loop then use an <code>exit for</code> after setting <code>Cells(i,83)</code> value so it will bounce out to the next iteration."}, {"owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "edited": false, "score": 0, "creation_date": 1573088548, "post_id": 58739116, "comment_id": 103770922, "body": "&quot;oading an array with 40k+ items seems like the wrong route to take&quot; - did you actually try doing it or do you just seem to think so without any real data to support it?"}, {"owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "edited": false, "score": 0, "creation_date": 1573100817, "post_id": 58739116, "comment_id": 103773355, "body": "Working with arrays is much faster. In the code below the first part is almost instantaneous. The second one takes ages.  Sub ReadRange()      Dim rng As Range     Dim arr As Variant      Set rng = Range(&quot;A1:A50000&quot;)     arr = Application.Transpose(rng.Value)      For a = 1 To 50000         arr(a) = Rnd     Next      MsgBox &quot;End&quot;      For a = 1 To 50000         Cells(a, 1) = Rnd     Next      MsgBox &quot;End&quot;  End Sub"}, {"owner": {"reputation": 51, "user_id": 8671544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/806c9327b94a8c442bed3251d2a87070?s=128&d=identicon&r=PG&f=1", "display_name": "dusty_j", "link": "https://stackoverflow.com/users/8671544/dusty-j"}, "reply_to_user": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "edited": false, "score": 0, "creation_date": 1573150264, "post_id": 58739116, "comment_id": 103797104, "body": "@MichalRosa sorry I should have clarified, I did try an array first, and gave up before actually compiling it successfully. I am not too familiar with how they operate but have used them successfully in the past on a much smaller scale. the table referenced during the 2nd forLoop is over 40k rows currently but is ever growing, I was just worried that 40k + would overload it and cause it to run even slower"}, {"owner": {"reputation": 51, "user_id": 8671544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/806c9327b94a8c442bed3251d2a87070?s=128&d=identicon&r=PG&f=1", "display_name": "dusty_j", "link": "https://stackoverflow.com/users/8671544/dusty-j"}, "reply_to_user": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "edited": false, "score": 0, "creation_date": 1573151030, "post_id": 58739116, "comment_id": 103797452, "body": "also @MichalRosa I don&#39;t quite understand your code suggestion above. what is the &#39;Rnd&quot; variable. what does transposing the array do?"}, {"owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "edited": false, "score": 0, "creation_date": 1573158309, "post_id": 58739116, "comment_id": 103800511, "body": "It&#39;s just an example.  RND is not a variable, it&#39;s a function.  The example just shows that filling a 50000 spaces array with a random variable is almost instantaneous while filling cells with the same function takes for ages.  Just read the ranges into array, perform your calculations directly on the arrays and print the output.  It&#39;s much faster."}], "answers": [{"tags": [], "owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "is_accepted": false, "score": 0, "last_activity_date": 1573168569, "last_edit_date": 1573168569, "creation_date": 1573168010, "answer_id": 58758130, "question_id": 58739116, "link": "https://stackoverflow.com/questions/58739116/alternative-for-nested-for-loops-for-faster-run-time/58758130#58758130", "title": "alternative for nested for loops for faster run time", "body": "<p>This ia just a proof of concept, you will need to adjust variables and ranges to suit your needs.</p>\n\n<pre><code>Sub ProofOfConcept()\n\n    Dim rngList As Range\n    Dim rngMatch As Range\n\n    Dim arrList As Variant\n    Dim arrMatch As Variant\n\n    Set rngList = Range(\"A1:A50000\")\n    arrList = Application.Transpose(rngList.Value)\n\n    Set rngMatch = Range(\"C1:D15000\")\n    arrMatch = Application.Transpose(rngMatch.Value)\n\n    For a = 1 To 15000\n        For b = 1 To 50000\n            If arrMatch(1, a) = arrList(b) Then\n                arrMatch(2, a) = \"Match found\"\n                GoTo skip\n            End If\n        Next\nskip:\n    Next\n\n    rngMatch = WorksheetFunction.Transpose(arrMatch)\n\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 8671544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/806c9327b94a8c442bed3251d2a87070?s=128&d=identicon&r=PG&f=1", "display_name": "dusty_j", "link": "https://stackoverflow.com/users/8671544/dusty-j"}, "is_accepted": false, "score": 0, "last_activity_date": 1573230012, "creation_date": 1573230012, "answer_id": 58770288, "question_id": 58739116, "link": "https://stackoverflow.com/questions/58739116/alternative-for-nested-for-loops-for-faster-run-time/58770288#58770288", "title": "alternative for nested for loops for faster run time", "body": "<p>thanks @Michal</p>\n\n<p>played with it a bit. I trimmed down the run time from almost an hour to about 7 or 8 min using this code. works beautifully!!</p>\n\n<pre><code>Dim promoList As Range\nDim rngMatch As Range\nDim arrList As Variant\nDim arrMatch As Variant\nDim z\n\n\nSet promoList = Sheets(\"promosheet table\").Range(\"A1:A\" &amp; lastcollateralRow)\narrList = Application.Transpose(promoList.Value)\nSet rngMatch = Sheets(\"Mft rpt\").Range(\"K2:K\" &amp; lastRow)\narrMatch = Application.Transpose(rngMatch.Value)\nFor z = LBound(arrMatch) To UBound(arrMatch)\n    arrMatch(z) = Replace(Replace(arrMatch(z), \" \", \"\"), \"-\", \"\")\nNext\n\nFor A = 1 To lastRow\n    If Cells(A + 1, 83).Value &lt;&gt; \"\" Then GoTo skip:\n    Sheets(\"mft rpt\").Cells(A + 1, 83) = \"No Record\"\n    For b = 1 To lastcollateralRow + 1\n        If arrMatch(A) = promoList(b) Then\n            Sheets(\"mft rpt\").Cells(A + 1, 83) = promoList(b, 3)\n            GoTo skip\n        End If\n    Next\nskip:\nNext\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 8671544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/806c9327b94a8c442bed3251d2a87070?s=128&d=identicon&r=PG&f=1", "display_name": "dusty_j", "link": "https://stackoverflow.com/users/8671544/dusty-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1573230012, "creation_date": 1573077538, "question_id": 58739116, "link": "https://stackoverflow.com/questions/58739116/alternative-for-nested-for-loops-for-faster-run-time", "title": "alternative for nested for loops for faster run time", "body": "<p>I have a nested for loop that first runs through 10-15k rows, compares a cell in that row to another table that is 40k+ rows, if it finds a match, it returns that match, otherwise \"no record\" is written in a cell. the code works fine, just investigating an alternative approach to make it run faster. currently, 13000 lines takes about 50 min to an hour to run. I've looked into arrays, but loading an array with 40k+ items seems like the wrong route to take. the report is often run bits at a time, so when it is first created it may have 2k rows, then 3k rows may be added to it later, the code below will skip over rows it has already checked and pick up where it left off. any help is appreciated</p>\n\n<pre><code>For i = 2 To lastRow\n    If Cells(i, 83).Value &lt;&gt; \"\" Then GoTo NextIteration:\n    Sheets(\"mft Rpt\").Cells(i, 83) = \"No Record\"\n    model = Sheets(\"MFT RPT\").Cells(i, 11).Value\n    trimModel = Replace(Replace(model, \" \", \"\"), \"-\", \"\")\n    For j = 1 To lastCollateralRow\n        If trimModel = Sheets(\"Promosheet Table\").Cells(j, 1).Value Then\n            Sheets(\"MFT RPT\").Cells(i, 83) = Sheets(\"promosheet Table\").Cells(j, 3).Value\n        End If\n    Next j\nNextIteration:\nNext i\n</code></pre>\n"}, {"tags": ["excel", "vba", "macos"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1573079056, "post_id": 58739035, "comment_id": 103768585, "body": "FWIW a <code>Property Get</code> member should be trivial code that runs instantaneously, without any side-effects on global or instance state, and doesn&#39;t raise any errors. This isn&#39;t it. Consider making it a <code>Function</code>."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6051025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48cde77b36b3392235729a82b5d9c855?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/6051025/matt"}, "edited": false, "score": 1, "creation_date": 1573081750, "post_id": 58739574, "comment_id": 103769389, "body": "Thank you so very much!  Iterating with <code>For Each...Next</code> reduced the time to less than 5sec.  For what it&#39;s worth, Tim Hall&#39;s dictionary took much longer to populate than the one I had found on here in my case."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 3, "user_id": 6051025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48cde77b36b3392235729a82b5d9c855?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/6051025/matt"}, "edited": false, "score": 0, "creation_date": 1573084740, "post_id": 58739574, "comment_id": 103770093, "body": "Interesting. Consider opening an issue on the VBA-Tools/Dictionary repository, since (AFAIK) that code is actively maintained, and performance improvements would greatly benefit the VBA community as a whole!"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 0, "last_activity_date": 1573080538, "creation_date": 1573080538, "answer_id": 58739574, "question_id": 58739035, "link": "https://stackoverflow.com/questions/58739035/vba-excel-mac-dictionary-class-on-mac-get-keys-attribute/58739574#58739574", "title": "VBA Excel Mac Dictionary Class on Mac Get Keys() Attribute", "body": "<p>No, you can't avoid iterating the items. Under Windows you could probably leverage <code>CopyMemory</code> Win32 API to bulk-copy arrays, but I wouldn't trust these functions to work on a Mac.</p>\n\n<p>Consider swapping your <code>KeyValuePair</code>-based <code>Dictionary</code> with <a href=\"https://github.com/VBA-tools/VBA-Dictionary\" rel=\"nofollow noreferrer\">Tim Hall's drop-in <code>Dictionary</code> replacement</a>.</p>\n\n<p>Now, hard to tell without seeing the class' <code>[_NewEnum]</code> implementation and default member (you have those?), but as far as I can tell you're iterating an object collection with a <code>For...Next</code> loop - and that is the slowest possible way to iterate any object collection.</p>\n\n<p>Object collections <em>want</em> to be iterated with <code>For Each...Next</code>. Just that, <a href=\"https://analystcave.com/vba-for-loop-vs-for-each-loop/\" rel=\"nofollow noreferrer\">could slash the run time by several orders of magnitude</a>.</p>\n\n<p>Updating the <code>Application</code> UI and running <code>DoEvents</code> (even once every 5K iterations) is further slowing down the loop... and this isn't the kind of thing you want to be doing in a <code>Property Get</code> member anyway.</p>\n\n<p>Looks like <code>KeyValuePairs</code> is a collection of <code>KeyValuePair</code> objects? 135K of them means quite a lot of overhead - in .NET a <code>KeyValuePair</code> is a <code>struct</code> (value type), not an <code>object</code> (reference type); they are optimized differently, and perform differently too. Regardless, if you have a collection of <code>KeyValuePair</code> objects, the fastest way to iterate them is with a <code>For Each</code> loop.</p>\n\n<pre><code>ReDim result(0 To KeyValuePairs.Count - 1)\nDim i As Long\nDim kvp As KeyValuePair\nFor Each kvp In KeyValuePairs\n    result(i) = kvp.Key\n    i = i + 1\nNext\n</code></pre>\n\n<p>Moreover, because of how arrays work in VBA and all the headaches associated with <em>typed</em> arrays, I'd think <em>returning</em> one would be safer if wrapped in a <code>Variant</code> pointer, or \"returned\" through a <code>ByRef</code> parameter (but that wouldn't work for a <code>Property Get</code> member).</p>\n"}], "owner": {"reputation": 3, "user_id": 6051025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48cde77b36b3392235729a82b5d9c855?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/6051025/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 58739574, "answer_count": 1, "score": 0, "last_activity_date": 1581926569, "creation_date": 1573077155, "last_edit_date": 1581926569, "question_id": 58739035, "link": "https://stackoverflow.com/questions/58739035/vba-excel-mac-dictionary-class-on-mac-get-keys-attribute", "title": "VBA Excel Mac Dictionary Class on Mac Get Keys() Attribute", "body": "<p>The Get Keys() attribute is slow with a decent sized data set.  Is there a way to assign keys without looping through each record individually?</p>\n\n<p>I can only find examples of for or do loops to assign keys individually.</p>\n\n<pre><code>\nPublic Property Get Keys() As String()\n\n'Here is the existing code (status bar updated only so the user knows the\n'program is still working).\n\n    Dim vlist() As String, i As Long, myKey As Variant, myArr() As Variant, okVP As KeyValuePair, StatBar As String\n    StatBar = Application.StatusBar\n\n    If Me.Count &gt; 0 Then\n        ReDim vlist(0 To Me.Count - 1)        \n\n        For i = LBound(vlist) To UBound(vlist)\n            Set okVP = KeyValuePairs(i + 1)\n            vlist(i) = okVP.Key\n            If i Mod 5000 = 0 Then\n                Application.StatusBar = StatBar &amp; \": \" &amp; \"Gathering Keys: \" &amp; Format(i, \"#,##0\") &amp; \" of \" &amp; Format(UBound(vlist), \"#,##0\")\n'                Debug.Print i &amp; \" of \" &amp; UBound(vlist)\n                DoEvents\n            End If\n        Next i\n        Keys = vlist\n    End If\n    Application.StatusBar = StatBar\nEnd Property\n</code></pre>\n\n<p>Current approach takes >5 min for ~135K records.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1573077959, "post_id": 58738824, "comment_id": 103768214, "body": "Try <code>Range(&quot;E14&quot;).Formula = &quot;=VLOOKUP(F6,&#39;Super Admin&#39;!A1118:M1221,MATCH(J6,&#39;Super Admin&#39;!A1118:M1118,0),0)]</code>&quot;. Side note: <code>Range(&quot;E14&quot;).Activate</code> is superfluous"}, {"owner": {"reputation": 1, "user_id": 12329656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39c3b46f22b96ae698365c0c01891404?s=128&d=identicon&r=PG&f=1", "display_name": "Rusty", "link": "https://stackoverflow.com/users/12329656/rusty"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1573167050, "post_id": 58738824, "comment_id": 103803669, "body": "No that does not work      I can get E14 to display the results of the v look up  what I need now is the cell that excel is getting the information to display in the vlookup needs to be changed when E14 text changes"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1573168015, "post_id": 58738824, "comment_id": 103803948, "body": "I&#39;m not sure I follow... Can you <a href=\"https://stackoverflow.com/posts/58738824/edit\">edit your question</a> to include sample data and expected outcome?"}], "owner": {"reputation": 1, "user_id": 12329656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39c3b46f22b96ae698365c0c01891404?s=128&d=identicon&r=PG&f=1", "display_name": "Rusty", "link": "https://stackoverflow.com/users/12329656/rusty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573076147, "creation_date": 1573076059, "last_edit_date": 1573076147, "question_id": 58738824, "link": "https://stackoverflow.com/questions/58738824/save-data-to-a-particular-cell-with-vlookup", "title": "Save data to a particular cell with vlookup", "body": "<p>On sheet1 I have a cell that displays notes I have one cell with a drop down list for years and another with a drop down that has the months.  The third cell displays the notes for the year and month.  I built the cod to display the correct month and years notes.  what I would like to know how to do is once the notes appear in the cell I would like to be able to changed the notes or add to the notes then have that saved to the table it is pulling from so if I go back to that month and years notes it shows up with the changes.    Here is the code that pulls the information from the other sheet and displays it.  </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    On Error Resume Next\n\n        If Range(Year, Month) Is Nothing Then Exit Sub\n\n    On Error GoTo 0\n\n    If Not Intersect(Target, Range(Year, Month)) Is Nothing Then\n\n        Range(\"E14\").Formula = [VLOOKUP(F6,'Super Admin'!A1118:M1221,MATCH(J6,'Super Admin'!A1118:M1118,0),0)]\n        Range(\"E14\").Activate\n        SendKeys \"{F2}\"\n        Application.ScreenUpdating = True\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1573075108, "post_id": 58738633, "comment_id": 103767219, "body": "Use <code>Application.Match</code> to return the row number, then build the range address with <code>&quot;B&quot;</code> and use <code>Select</code>."}, {"owner": {"reputation": 1, "user_id": 12334330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d73bd30799910fa48c50089a15bcc76?s=128&d=identicon&r=PG&f=1", "display_name": "IdleMike1", "link": "https://stackoverflow.com/users/12334330/idlemike1"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1573079087, "post_id": 58738633, "comment_id": 103768593, "body": "Thanks! Would you be able to help me with the total VBA code you would build using the above examples?"}], "owner": {"reputation": 1, "user_id": 12334330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d73bd30799910fa48c50089a15bcc76?s=128&d=identicon&r=PG&f=1", "display_name": "IdleMike1", "link": "https://stackoverflow.com/users/12334330/idlemike1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573075190, "creation_date": 1573075057, "last_edit_date": 1573075190, "question_id": 58738633, "link": "https://stackoverflow.com/questions/58738633/how-to-create-vba-to-navigate-directly-to-the-first-row-containing-a-specified-v", "title": "How to create VBA to navigate directly to the first row containing a specified value", "body": "<p>I am looking to create a VBA macro I can attach to a button at the top of my worksheet in Excel 2010 that navigates to the first row containing a specific value located in column H. </p>\n\n<p>(<strong><em>Note</em></strong>: there are several rows with what looks to be empty cells within the visible range because there are a few hidden columns containing formulas that span the whole dataset range. So if the dataset range was from A1:J2000, then rows 900 through 920 may \"appear\" empty though there are some hidden columns with with formulas. I mention this because the code that attempts to search by a \"control-shift-down\" method will not work because that would stop short of the actual true range of the dataset.)</p>\n\n<p>I've attempted researching this and have found some scripts that either return the number of the row or something that inserts data. But, nothing for just navigating to the first row that contains a specific value.</p>\n\n<p>In summation, what I would like is the VBA macro to find the first row which contains the word \"re-populate\" in column H. When that row is found, I would like the VBA macro to select the cell within column B of the corresponding row where the result was located.</p>\n\n<p>Example: If the macro found the word \"re-populate\" in cell H864, then it would navigate to cell B864.</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 567, "user_id": 9221467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7617a21b1802c874e04be0db0f58ea0b?s=128&d=identicon&r=PG&f=1", "display_name": "SRT HellKitty", "link": "https://stackoverflow.com/users/9221467/srt-hellkitty"}, "edited": false, "score": 0, "creation_date": 1573074864, "post_id": 58738541, "comment_id": 103767128, "body": "you want a VBA code to save a file once an hour?"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 3, "creation_date": 1573075155, "post_id": 58738541, "comment_id": 103767243, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/51830119/saving-outlook-attachment-locally-via-vba\">Saving outlook attachment locally via VBA</a>"}], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1573121609, "creation_date": 1573121609, "answer_id": 58746459, "question_id": 58738541, "link": "https://stackoverflow.com/questions/58738541/auto-save-email-attachment/58746459#58746459", "title": "Auto Save Email Attachment", "body": "<p>To handle incoming emails you need to hook into the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/outlook.application.newmailex\" rel=\"nofollow noreferrer\">NewMailEx</a> event of the <code>Applicaiton</code> class. The <code>NewMailEx</code> event fires when a new message arrives in the Inbox and before client rule processing occurs. You can use the Entry ID returned in the <code>EntryIDCollection</code> array to call the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/outlook.namespace.getitemfromid\" rel=\"nofollow noreferrer\">NameSpace.GetItemFromID</a> method and process the item. For users with an Exchange Server account (non-Cached Exchange Mode or Cached Exchange Mode), the event will fire only for messages that arrive at the server after Outlook has started. The event will not fire for messages that are synchronized in Cached Exchange Mode immediately after Outlook starts, nor for messages that are already on the server when Outlook starts in non-Cached Exchange Mode.</p>\n\n<p>After retrieving the incoming email you can save attachments to a disk:</p>\n\n<pre><code>Public Sub saveAttachtoDisk(itm As Outlook.MailItem)\nDim objAtt As Outlook.Attachment\nDim saveFolder As String\nsaveFolder = \"c:\\temp\"\n     For Each objAtt In itm.Attachments\n          objAtt.SaveAsFile saveFolder &amp; \"\\\" &amp; objAtt.DisplayName\n          Set objAtt = Nothing\n     Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 3155215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59d30facdec0c189fec57b753f5bc4a6?s=128&d=identicon&r=PG&f=1", "display_name": "user3155215", "link": "https://stackoverflow.com/users/3155215/user3155215"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1573121609, "creation_date": 1573074660, "last_edit_date": 1573075108, "question_id": 58738541, "link": "https://stackoverflow.com/questions/58738541/auto-save-email-attachment", "title": "Auto Save Email Attachment", "body": "<p>I need a simple code to save a file that is received by email every hour - I want to save it to a folder on the desktop under the same name whenever saved.</p>\n\n<p>So far I have the following:</p>\n\n<pre><code>Public Sub saveAttachtoDisk(itm As Outlook.MailItem)\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1573074569, "post_id": 58738509, "comment_id": 103767019, "body": "Have you tried restarting Excel?"}], "answers": [{"comments": [{"owner": {"reputation": 137, "user_id": 1370889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f84dc878c1e5ca883f0225746aeab7fd?s=128&d=identicon&r=PG&f=1", "display_name": "pankevedmo", "link": "https://stackoverflow.com/users/1370889/pankevedmo"}, "edited": false, "score": 0, "creation_date": 1573077115, "post_id": 58738639, "comment_id": 103767906, "body": "I simply activate the recorder button, selected one interval of cells with mouse, and then stop the recorder. where did I go wrong?  I think it may be some kind of settings of how the recorder reads and write my actions..."}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "reply_to_user": {"reputation": 137, "user_id": 1370889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f84dc878c1e5ca883f0225746aeab7fd?s=128&d=identicon&r=PG&f=1", "display_name": "pankevedmo", "link": "https://stackoverflow.com/users/1370889/pankevedmo"}, "edited": false, "score": 0, "creation_date": 1573089724, "post_id": 58738639, "comment_id": 103771132, "body": "I don&#39;t know what an &quot;interval&quot; of cells is. If you mean a range, i.e. several cells in a row and/or column, then the resulting code will depend on what exactly is in that range. if the code returns <code>DataFields</code> , then you selected something in a PivotTable, which is not the same as selecting ordinary cells."}], "tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": false, "score": 2, "last_activity_date": 1573075114, "creation_date": 1573075114, "answer_id": 58738639, "question_id": 58738509, "link": "https://stackoverflow.com/questions/58738509/excel-vba-is-not-recording-macro-properly/58738639#58738639", "title": "Excel VBA is not recording macro properly", "body": "<p>The \"awkward code\" is a formula in R1C1 notation. This is the easiest way to create formulas with relative references in VBA. </p>\n\n<p>The macro recorder is not a perfect tool. Many things that run fine while recording a macro will not run when the recorded macro is played back. Also, there are some activities that the macro recorder does not register at all. In these cases you need to consult the VBA documentation and correct the code manually. </p>\n\n<p>Your code snippet about the Range Select lacks a lot of detail to determine what went wrong. Without seeing your data and knowing more about your exact steps, it will not be possible to troubleshoot.</p>\n"}], "owner": {"reputation": 137, "user_id": 1370889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f84dc878c1e5ca883f0225746aeab7fd?s=128&d=identicon&r=PG&f=1", "display_name": "pankevedmo", "link": "https://stackoverflow.com/users/1370889/pankevedmo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 309, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573075114, "creation_date": 1573074521, "last_edit_date": 1573074594, "question_id": 58738509, "link": "https://stackoverflow.com/questions/58738509/excel-vba-is-not-recording-macro-properly", "title": "Excel VBA is not recording macro properly", "body": "<p>Had some troubles while recording macro on my Excel. I followed some tutorials on youtube but I still did fail to record and then execute Macro properly.\nHere's an example: when I am recording the action of selecting one interval, it should be ends up with something like that in the VBA editor: Range(\"C3:E7\").Select; instead, in the VBA editor I find Range(\"C3:E7\").DataFields, which obviously doesnt work when executed. </p>\n\n<p>Similarly, when I try to record the action of calculating an average from an interval, it ends up with some awkard code like\nBold. = \"=AVERAGE(R[-2]C[-1]:R[1]C[-1])\"</p>\n\n<p>What am I miss? is there something I didnt get?</p>\n\n<p>Thank you for your help in advance.</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1573088732, "post_id": 58738309, "comment_id": 103770951, "body": "So what happens when you run that code?"}, {"owner": {"reputation": 1, "user_id": 12334335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea186b7635726ae2baafa638a3c43ab8?s=128&d=identicon&r=PG&f=1", "display_name": "jAlex", "link": "https://stackoverflow.com/users/12334335/jalex"}, "reply_to_user": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1573144779, "post_id": 58738309, "comment_id": 103794485, "body": "So i create rule and choose to run this script.  When I get sent a meeting and i decline it my calendar doesn&#39;t show the meeting anymore."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1573145472, "post_id": 58738309, "comment_id": 103794851, "body": "If you display a message box (MsgBox &quot;Test&quot;) in CopyMeetingtoAppointment, does it get displayed?"}, {"owner": {"reputation": 1, "user_id": 12334335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea186b7635726ae2baafa638a3c43ab8?s=128&d=identicon&r=PG&f=1", "display_name": "jAlex", "link": "https://stackoverflow.com/users/12334335/jalex"}, "reply_to_user": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1573146393, "post_id": 58738309, "comment_id": 103795384, "body": "I&#39;m not sure how to do that, this is my first time using vba. Can you provide some details how to display a message box?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12334335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea186b7635726ae2baafa638a3c43ab8?s=128&d=identicon&r=PG&f=1", "display_name": "jAlex", "link": "https://stackoverflow.com/users/12334335/jalex"}, "edited": false, "score": 0, "creation_date": 1573144839, "post_id": 58746345, "comment_id": 103794523, "body": "I did do this and when I get sent a meeting and I decline it, its now longer on my calendar.  I did add this registry key; HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\16.0\\Outlook\\Sec&zwnj;&#8203;urity DWORD: EnableUnsafeClientMailRules Value: 1"}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1573121225, "creation_date": 1573121225, "answer_id": 58746345, "question_id": 58738309, "link": "https://stackoverflow.com/questions/58738309/outlook-2016-calendar-declined-meetings/58746345#58746345", "title": "outlook 2016 calendar declined meetings", "body": "<p>You must create a rule for handling incoming items with the 'run script' Action and select this script.</p>\n"}], "owner": {"reputation": 1, "user_id": 12334335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea186b7635726ae2baafa638a3c43ab8?s=128&d=identicon&r=PG&f=1", "display_name": "jAlex", "link": "https://stackoverflow.com/users/12334335/jalex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1573121225, "creation_date": 1573073554, "last_edit_date": 1573073728, "question_id": 58738309, "link": "https://stackoverflow.com/questions/58738309/outlook-2016-calendar-declined-meetings", "title": "outlook 2016 calendar declined meetings", "body": "<p>I'm on Windows 10 using Outlook 2016 and want to keep declined meetings on my calendar.</p>\n\n<p>I've tried the code from this site: <a href=\"https://www.slipstick.com/outlook/calendar/meeting-cancellation-calendar/\" rel=\"nofollow noreferrer\">https://www.slipstick.com/outlook/calendar/meeting-cancellation-calendar/</a></p>\n\n<pre><code>    Sub CopyMeetingtoAppointment(oRequest As MeetingItem)\n\n    If oRequest.MessageClass &lt;&gt; \"IPM.Schedule.Meeting.Canceled\" Then\n    Exit Sub\n    End If\n\n    Dim oAppt As AppointmentItem\n    Dim cAppt As AppointmentItem\n\n    Set cAppt = oRequest.GetAssociatedAppointment(True)\n    Set oAppt = Application.CreateItem(olAppointmentItem)\n\n        oAppt.Subject = \"(Rule) Canceled: \" &amp; cAppt.Subject\n        oAppt.Start = cAppt.Start\n        oAppt.Duration = cAppt.Duration\n        oAppt.Location = cAppt.Location\n        oAppt.Display\n        oAppt.Save\n\n       Set oAppt = Nothing\n       Set cAppt = Nothing\n    End Sub\n</code></pre>\n\n<p>I'm expecting my calendar to show my declined meetings.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1573072436, "post_id": 58737982, "comment_id": 103766166, "body": "You create <code>IE</code> but you don&#39;t send it to a URL?  Also -you&#39;re quitting IE <i>inside the loop</i>, so the second time around it will be gone."}, {"owner": {"reputation": 21, "user_id": 12322805, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDAwT8hOQMRPhIR4Dv381ea-4Lih06d2FBveTqF=k-s128", "display_name": "Jason Avery", "link": "https://stackoverflow.com/users/12322805/jason-avery"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1573073010, "post_id": 58737982, "comment_id": 103766405, "body": "Sorry, when removing commented-out code, I accidentally removed the code in question: &quot;IE.navigate CAGE&quot;. I want to prevent 500 windows of IE being open at the end, so I used QUIT inside the loop. Do you recommend something different?"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 12322805, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDAwT8hOQMRPhIR4Dv381ea-4Lih06d2FBveTqF=k-s128", "display_name": "Jason Avery", "link": "https://stackoverflow.com/users/12322805/jason-avery"}, "edited": false, "score": 0, "creation_date": 1573073561, "post_id": 58738226, "comment_id": 103766624, "body": "Do you have a recommended command to prevent 500 pages from being open at the loop?"}, {"owner": {"reputation": 21, "user_id": 12322805, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDAwT8hOQMRPhIR4Dv381ea-4Lih06d2FBveTqF=k-s128", "display_name": "Jason Avery", "link": "https://stackoverflow.com/users/12322805/jason-avery"}, "edited": false, "score": 0, "creation_date": 1573075763, "post_id": 58738226, "comment_id": 103767452, "body": "After some checks, I realized that if I never set it to visible, I won&#39;t have to worry about the windows popping up. Thanks for the help, I appreciate it."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1573073146, "creation_date": 1573073146, "answer_id": 58738226, "question_id": 58737982, "link": "https://stackoverflow.com/questions/58737982/iterative-ie-navigate-issue/58738226#58738226", "title": "Iterative IE Navigate Issue", "body": "<p>The first time through the loop, you call </p>\n\n<pre><code>IE.Quit\n</code></pre>\n\n<p>so your loop will fail on the second iteration</p>\n"}], "owner": {"reputation": 21, "user_id": 12322805, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDAwT8hOQMRPhIR4Dv381ea-4Lih06d2FBveTqF=k-s128", "display_name": "Jason Avery", "link": "https://stackoverflow.com/users/12322805/jason-avery"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1573073146, "creation_date": 1573071943, "last_edit_date": 1573072979, "question_id": 58737982, "link": "https://stackoverflow.com/questions/58737982/iterative-ie-navigate-issue", "title": "Iterative IE Navigate Issue", "body": "<p>I am trying to retrieve the attributes for roughly 500 CAGE codes from the DLA and record them in my spreadsheet. I've been able to get it to work for one iteration, but, on second iteration, get the error \"method navigate of object iwebbrowser2 failed\"</p>\n\n<p>Note the code doesn't work unless you've already opened the website before and haven't closed the browser (you need to accept the terms and conditions).</p>\n\n<p>The cell B2 = <a href=\"https://cage.dla.mil/Search/Results?q=07187&amp;page=1\" rel=\"nofollow noreferrer\">https://cage.dla.mil/Search/Results?q=07187&amp;page=1</a>\nThe cell B3 = <a href=\"https://cage.dla.mil/Search/Results?q=00198&amp;page=1\" rel=\"nofollow noreferrer\">https://cage.dla.mil/Search/Results?q=00198&amp;page=1</a></p>\n\n<pre><code>Sub NSCM2()\n\n'Initialize\nDim IE As Object\nDim CAGE As String\nDim rowNeeded As String\nDim i As Integer\nDim sDD0 As String\nDim sDD1 As String\nDim sDD2 As String\nDim sDD3 As String\nDim sDD4 As String\nDim Doc As HTMLDocument\n\n'Create IE Object\nSet IE = CreateObject(\"INTERNETEXPLORER.APPLICATION\")\n\n'Loop for All Codes\nFor i = 1 To 10\n\n  'Retrieve CAGE Code\n  rowNeeded = CStr(i + 1)\n  CAGE = Range(\"B\" &amp; rowNeeded).Value\n\n'Navigate to Cage Code general Page\nIE.navigate CAGE\n\n  'Wait\n  Do\n    DoEvents\n    Loop Until IE.readyState = 4\n    Application.Wait (Now + TimeValue(\"0:00:03\"))\n\n  'Follow link to details page\n  For Each ele In IE.document.getElementsByTagName(\"a\")\n      If InStr(ele.innerText, \"Details\") &gt; 0 Then ele.Click\n  Next\n\n  'Wait\n  Do\n    DoEvents\n    Loop Until IE.readyState = 4\n    Application.Wait (Now + TimeValue(\"0:00:03\"))\n\n  'Pull needed values\n  Set Doc = IE.document\n\n  sDD0 = Doc.getElementsByTagName(\"span\")(11).innerText\n  sDD1 = Doc.getElementsByTagName(\"span\")(15).innerText\n  sDD2 = Doc.getElementsByTagName(\"span\")(17).innerText\n  sDD3 = Doc.getElementsByTagName(\"span\")(19).innerText\n  sDD4 = Doc.getElementsByTagName(\"span\")(20).innerText\n\n  'Close IE\n  IE.Quit\n\n  'Insert URL\n  Range(\"F\" &amp; rowNeeded) = sDD0\n\n  'Insert Address, comma separated\n  If sDD1 = \"\" And sDD2 = \"\" And sDD3 = \"\" Then\n    Range(\"G\" &amp; rowNeeded) = sDD4\n    ElseIf sDD1 = \"\" And sDD2 = \"\" Then\n    Range(\"G\" &amp; rowNeeded) = sDD3 &amp; \", \" &amp; sDD4\n    ElseIf sDD1 = \"\" And sDD3 = \"\" Then\n    Range(\"G\" &amp; rowNeeded) = sDD2 &amp; \", \" &amp; sDD4\n    ElseIf sDD1 = \"\" Then\n    Range(\"G\" &amp; rowNeeded) = sDD2 &amp; \",\" &amp; sDD3 &amp; \", \" &amp; sDD4\n    Else\n    Range(\"G\" &amp; rowNeeded) = sDD1 &amp; \", \" &amp; sDD2 &amp; \", \" &amp; sDD3 &amp; \", \" &amp; sDD4\n    End If\n\n  'Insert Address Check\n  Range(\"H\" &amp; rowNeeded) = sDD1 &amp; \";\" &amp; sDD2 &amp; \";\" &amp; sDD3 &amp; \";\" &amp; sDD4\n\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 4, "creation_date": 1573070972, "post_id": 58737708, "comment_id": 103765498, "body": "And you need them in an array? What have you tried?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1573073624, "post_id": 58737708, "comment_id": 103766657, "body": "What&#39;s the function of this button, and where is it located - on a form or on a worksheet?  It would be better to give the user a second control to pick the range of numbers (1000&#39;s, 2000&#39;s,etc) and then just have the spin button go from 0-99 - you can use a formula to get the final number from the two controls."}, {"owner": {"reputation": 1, "user_id": 12334147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8260cf4e5a9c3462081d2d02f5008a9?s=128&d=identicon&r=PG&f=1", "display_name": "JM00", "link": "https://stackoverflow.com/users/12334147/jm00"}, "edited": false, "score": 0, "creation_date": 1573168048, "post_id": 58737708, "comment_id": 103803957, "body": "I thought of having a second control to pick the first digit, but as the first digit will soon go from 1 to 9, I thought this would be a bit much. But yes, for future reference I think having two controls would be beneficial. Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 859, "user_id": 12287457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d389583f0df341fc39dd1e352a08794?s=128&d=identicon&r=PG&f=1", "display_name": "GWD", "link": "https://stackoverflow.com/users/12287457/gwd"}, "is_accepted": false, "score": 0, "last_activity_date": 1573073979, "creation_date": 1573073979, "answer_id": 58738399, "question_id": 58737708, "link": "https://stackoverflow.com/questions/58737708/is-there-a-way-to-have-a-custom-non-consecutive-number-range-for-an-excel-spin/58738399#58738399", "title": "Is there a way to have a custom, non-consecutive number range for an Excel spin button?", "body": "<p>You can assign the following macro to your spin button:</p>\n\n<pre><code>Sub SB()\nDim rng As Range\nDim i As Long\nSet rng = Application.Worksheets(\"Sheet1\").Range(\"C7\") '&lt;-- input the Cell and worksheet\n                                                   'your spin Button is assigned to here\ni = rng.Value\n\nIf i &lt; 1000 Then\n    i = 1000\nElseIf i &gt; 1099 And i &lt; 1550 Then\n    i = 2000\nElseIf i &lt; 2000 And i &gt;= 1550 Then\n    i = 1099\nElseIf i &gt; 2099 Then\n    i = 2099\nEnd If\n\nrng.Value = i\nEnd Sub\n</code></pre>\n\n<p>It will just prevent the cell from taking any other values than the ones in your desired interval, and all inputs from 1100 to 1549 will jump to 2000 while the inputs from 1550 to 1999 will jump to 1000.</p>\n"}], "owner": {"reputation": 1, "user_id": 12334147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8260cf4e5a9c3462081d2d02f5008a9?s=128&d=identicon&r=PG&f=1", "display_name": "JM00", "link": "https://stackoverflow.com/users/12334147/jm00"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1573073979, "creation_date": 1573070688, "question_id": 58737708, "link": "https://stackoverflow.com/questions/58737708/is-there-a-way-to-have-a-custom-non-consecutive-number-range-for-an-excel-spin", "title": "Is there a way to have a custom, non-consecutive number range for an Excel spin button?", "body": "<p>I have an Excel spin button that needs to start at 1000, then go up (by increments of 1) to 1099. However, instead of going to 1100 after 1099, I need the next number to be 2000 (then process repeats of going to 2099). By only inputting a SpinButton1.Min and Max, the button circles through many numbers that I do not need. </p>\n\n<p>Is there a VBA formula that will let me input a custom number range for the spin putting. Specifically, the range would be [1000-1099] [2000-2099].</p>\n\n<p>Thanks!   </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1573069672, "post_id": 58737313, "comment_id": 103764978, "body": "Is there always a space after the chapter number and before the chapter title?"}, {"owner": {"reputation": 859, "user_id": 12287457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d389583f0df341fc39dd1e352a08794?s=128&d=identicon&r=PG&f=1", "display_name": "GWD", "link": "https://stackoverflow.com/users/12287457/gwd"}, "edited": false, "score": 0, "creation_date": 1573071107, "post_id": 58737313, "comment_id": 103765568, "body": "I still don&#39;t quite understand your input format, are there dots between the numbers or not?"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 3, "creation_date": 1573071126, "post_id": 58737313, "comment_id": 103765577, "body": "Try regex pattern <code>^(\\d+)\\.(\\d+)\\.(\\d+).*(\\d+)$</code>."}], "answers": [{"tags": [], "owner": {"reputation": 859, "user_id": 12287457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d389583f0df341fc39dd1e352a08794?s=128&d=identicon&r=PG&f=1", "display_name": "GWD", "link": "https://stackoverflow.com/users/12287457/gwd"}, "is_accepted": false, "score": 0, "last_activity_date": 1573070196, "last_edit_date": 1573070196, "creation_date": 1573069899, "answer_id": 58737537, "question_id": 58737313, "link": "https://stackoverflow.com/questions/58737313/vba-how-to-find-entire-number-in-a-string-and-set-to-variable/58737537#58737537", "title": "VBA how to find entire number in a string and set to variable", "body": "<p>One, admittedly not very beautiful solution I can think of right away would be to use <code>Replace</code> to remove all non-numeric characters.</p>\n\n<pre><code>Dim str As String\n\nstr = Replace(str, \" \", \"\") '&lt;- to remove the random spaces\nstr = LCase(str) '&lt;- making everything lower case\n\nFor i = 97 To 122\n    str = Replace(str, Chr(i), \"\")\nNext i\n</code></pre>\n\n<p><code>Chr(i)</code> with i from 97 to 122 will be every Character of the standard Alphabet.\nThis does not work if special Characters appear in the Chapter Name String. If the Chapter name contains numbers these will remain, but you could detect that case because <code>UBound</code> of the split array will be 1 greater than usual.</p>\n\n<p>Also if you can quickly scan all the cells with your data for other unwanted Characters like - / or whatever might occur, you can also get rid of them with <code>Replace</code></p>\n\n<p>Performance of this solution might not be great but for a quick fix it might do..</p>\n"}], "owner": {"reputation": 313, "user_id": 9711276, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lHtza.png?s=128&g=1", "display_name": "Kenny", "link": "https://stackoverflow.com/users/9711276/kenny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573070196, "creation_date": 1573068721, "last_edit_date": 1573068916, "question_id": 58737313, "link": "https://stackoverflow.com/questions/58737313/vba-how-to-find-entire-number-in-a-string-and-set-to-variable", "title": "VBA how to find entire number in a string and set to variable", "body": "<p>I have a list that was copied from a 'table of contents' page to column D. Unfortunately, each cell contains the chapter number, chapter name, and the page number. </p>\n\n<p>3.14.4   chapter name placeholder.140</p>\n\n<p>Sometimes there is a space between the page number and the last character. other times there is not.</p>\n\n<p>I've tried </p>\n\n<pre><code>Function john(txt As String) As Long\nDim x\nx = Split(Trim(txt), Chr(32))\njohn = Val(x(UBound(x)))\nEnd Function\n</code></pre>\n\n<p>Which does work but I'd like to be able to apply this to the chapter number as well afterwards.</p>\n\n<pre><code>Private Sub FIND_LAST_NUMBER()\n\nDim A As String\nDim B As Integer\nDim C As String\nDim D As String\n\nx = 3\n\nDo While ActiveSheet.Cells(x, 4).Value &lt;&gt; \"\"\n\nA = Range(\"D\" &amp; x).Value\nA = Trim(A)\nB = Len(A)\nFor Position = B To 1 Step -1\n    C = Mid(A, Position, 1)\n    'MsgBox C\n    If C &lt;&gt; \" \" Then\n        D = Right(A, B - Position)\n        Range(\"E\" &amp; x).Value = C\n    GoTo LastLine\n  'Exit Sub\nEnd If\nNext Position\n\nLastLine:\n    x = x + 1\n\nLoop\n\nEnd Sub \n</code></pre>\n\n<p>but I'm trying to figure out how to get all of the number instead of only the last digit of the page number from the original cell</p>\n\n<p>I am obviously not getting something here.</p>\n\n<p>Any tips or tricks will be greatly appreciated</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1573068513, "post_id": 58737226, "comment_id": 103764526, "body": "Which line throws the error?"}, {"owner": {"reputation": 189, "user_id": 5221310, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2838fa0055eb15c38ba2dd372c6ae68d?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Parisi", "link": "https://stackoverflow.com/users/5221310/aaron-parisi"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1573069005, "post_id": 58737226, "comment_id": 103764719, "body": "The first paste special"}], "answers": [{"comments": [{"owner": {"reputation": 189, "user_id": 5221310, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2838fa0055eb15c38ba2dd372c6ae68d?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Parisi", "link": "https://stackoverflow.com/users/5221310/aaron-parisi"}, "edited": false, "score": 0, "creation_date": 1573069952, "post_id": 58737447, "comment_id": 103765092, "body": "Ok; do you know a way to cut and paste while preserving the comment?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 189, "user_id": 5221310, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2838fa0055eb15c38ba2dd372c6ae68d?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Parisi", "link": "https://stackoverflow.com/users/5221310/aaron-parisi"}, "edited": false, "score": 1, "creation_date": 1573069979, "post_id": 58737447, "comment_id": 103765102, "body": "You&#39;d have to use the normal paste instead of pastespecial (so you can&#39;t just keep values, you&#39;ll get formats too)."}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 0, "last_activity_date": 1573069846, "last_edit_date": 1573069846, "creation_date": 1573069463, "answer_id": 58737447, "question_id": 58737226, "link": "https://stackoverflow.com/questions/58737226/pastespecial-error-when-cutting-instead-of-copying/58737447#58737447", "title": "PasteSpecial error when cutting instead of copying", "body": "<p>Paste Special only works with copy, and not cut. You can't do this manually either. </p>\n\n<p>If you comment out the first Paste Special, the second one will fail too.</p>\n"}], "owner": {"reputation": 189, "user_id": 5221310, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2838fa0055eb15c38ba2dd372c6ae68d?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Parisi", "link": "https://stackoverflow.com/users/5221310/aaron-parisi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 58737447, "answer_count": 1, "score": -1, "last_activity_date": 1573069846, "creation_date": 1573068332, "last_edit_date": 1573069021, "question_id": 58737226, "link": "https://stackoverflow.com/questions/58737226/pastespecial-error-when-cutting-instead-of-copying", "title": "PasteSpecial error when cutting instead of copying", "body": "<p>I have a \"calendar\" and sometimes I have \"tasks\" (with comments) that I want to move to a different date on the calendar.  I can do it successfully (keeping the comment) but then I have to go back and delete the original location.  When I try the following with ctrl-x instead of ctrl-c, I get an error <code>PasteSpecial method of range class failed</code> on the first PasteSpecial call</p>\n\n<pre><code>Sub PasteasValue()\n\n    Application.EnableEvents = False\n\n    Selection.PasteSpecial xlPasteComments\n    Selection.PasteSpecial Paste:=xlPasteValues\n\n    Call ShapeThem(Selection)\n\n    Application.EnableEvents = True\n\n\nEnd Sub\n</code></pre>\n\n<p>I'm not sure what is fundamentally different when I cut vs copy.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1573068310, "post_id": 58737163, "comment_id": 103764440, "body": "<code>Range.Find</code> returns a <code>Range</code>, not an address string, and not a value either. If you want the address of the range returned, that would be <code>FirstCell.Address</code> - beware though, if <code>Range.Find</code> doesn&#39;t find anything, that member call will raise error 91. Also, consider making the <code>Range.Find</code> call conditional to the <code>InputBox</code> not being cancelled."}, {"owner": {"reputation": 3, "user_id": 12334022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d706f918a625fabb077b7f69bad335fe?s=128&d=identicon&r=PG&f=1", "display_name": "VbaBeginner23", "link": "https://stackoverflow.com/users/12334022/vbabeginner23"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1573068476, "post_id": 58737163, "comment_id": 103764508, "body": "Hi Mathieu, thanks for the help! so I changed where it says &quot;Set FirstCell = Range... &quot; to &quot;Set FirstCell.Address = Range...&quot; and I get the error &quot;Assignment to constant not permitted&quot;"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1573069121, "post_id": 58737163, "comment_id": 103764758, "body": "You can&#39;t assign to <code>Range.Address</code>..."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 12334022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d706f918a625fabb077b7f69bad335fe?s=128&d=identicon&r=PG&f=1", "display_name": "VbaBeginner23", "link": "https://stackoverflow.com/users/12334022/vbabeginner23"}, "edited": false, "score": 0, "creation_date": 1573069673, "post_id": 58737380, "comment_id": 103764979, "body": "This is great! a couple additional q&#39;s about it. So for the last line that has the msgbox: so my goal here is to find the address from the find function and load that into a variable and then from there copy all cells below and to the left of it. could I declare a variable at the top and say &quot;findResult.address = (name of variable) and then variable.range plus end xl down/end xl left and then copy that?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 3, "user_id": 12334022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d706f918a625fabb077b7f69bad335fe?s=128&d=identicon&r=PG&f=1", "display_name": "VbaBeginner23", "link": "https://stackoverflow.com/users/12334022/vbabeginner23"}, "edited": false, "score": 0, "creation_date": 1573069780, "post_id": 58737380, "comment_id": 103765018, "body": "You need to take it the other way around, <code>someRange.Address = (whatever)</code> is not legal, because <code>Range.Address</code> is read-only. You want <code>someVariable = someRange.Address</code>. The target of an assignment is always on the left-hand side of the <code>=</code> assignment operator."}, {"owner": {"reputation": 3, "user_id": 12334022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d706f918a625fabb077b7f69bad335fe?s=128&d=identicon&r=PG&f=1", "display_name": "VbaBeginner23", "link": "https://stackoverflow.com/users/12334022/vbabeginner23"}, "edited": false, "score": 0, "creation_date": 1573069863, "post_id": 58737380, "comment_id": 103765058, "body": "Also some cases might not have a cell with 50 days overdue, but it would have something with 49 days and another with 52 days for example. I want the code to find the first cell equal to or greater than whatever value is put into the input box. Do you know how I could incorporate that into the Find process?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 3, "user_id": 12334022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d706f918a625fabb077b7f69bad335fe?s=128&d=identicon&r=PG&f=1", "display_name": "VbaBeginner23", "link": "https://stackoverflow.com/users/12334022/vbabeginner23"}, "edited": false, "score": 0, "creation_date": 1573069865, "post_id": 58737380, "comment_id": 103765059, "body": "FWIW I don&#39;t think the address is relevant for that task. You have a full-fledged <code>Range</code> object, its address is just metadata. <code>findResult.Offset(ColumnOffset:=-1)</code> gets you a <code>Range</code> that&#39;s exactly 1 column to the left of <code>findResult</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 3, "user_id": 12334022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d706f918a625fabb077b7f69bad335fe?s=128&d=identicon&r=PG&f=1", "display_name": "VbaBeginner23", "link": "https://stackoverflow.com/users/12334022/vbabeginner23"}, "edited": false, "score": 0, "creation_date": 1573069934, "post_id": 58737380, "comment_id": 103765088, "body": "<code>Range.Find</code> isn&#39;t going to handle fuzzy matches AFAIK. You&#39;re going to have to iterate the cells and determine if they&#39;re within the acceptable range of values."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 0, "last_activity_date": 1573069098, "creation_date": 1573069098, "answer_id": 58737380, "question_id": 58737163, "link": "https://stackoverflow.com/questions/58737163/finding-a-value-using-an-input-box/58737380#58737380", "title": "Finding a value using an input box", "body": "<p><code>Range.Find</code> returns a <code>Range</code> reference, not a value, and not an address. You can get the address of any <code>Range</code> object through its <code>Address</code> property.</p>\n\n<p>Split up your code, you have way too many things going on in a single instruction:</p>\n\n<pre><code>Dim userInput As Variant\nuserInput = InputBox(...)\nIf StrPtr(userInput) = 0 Then\n    'inputbox was cancelled\n    Exit Sub\nEnd If\n\nDim findResult As Range\nSet findResult = ActiveSheet.Range(\"L:L\").Find(CStr(userInput), ...)\n\nIf findResult Is Nothing Then\n    'did not find anything\n    Exit Sub\nEnd If\n\nMsgBox findResult.Address\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 12334022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d706f918a625fabb077b7f69bad335fe?s=128&d=identicon&r=PG&f=1", "display_name": "VbaBeginner23", "link": "https://stackoverflow.com/users/12334022/vbabeginner23"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 58737380, "answer_count": 1, "score": 0, "last_activity_date": 1573072753, "creation_date": 1573068066, "last_edit_date": 1573072753, "question_id": 58737163, "link": "https://stackoverflow.com/questions/58737163/finding-a-value-using-an-input-box", "title": "Finding a value using an input box", "body": "<p>So I get these canned reports that have a lot of transactions on them and I've written a macro that adds a column (always in Column L) that calculates how old each transaction is and then sorts them newest to oldest.</p>\n\n<p>My goal is to add an input box where the end-user can specify a number of days overdue (say 50), and then the code will find the first instance of that value and copy everything in that row to the end and move it to a new sheet.</p>\n\n<p>Here is my current sub just finding the data (ignore the columnheadings part as that's just copying over the headings)</p>\n\n<pre><code>Sub FindAndCopyData()\n\nDim ColumnHeadings As Range\n\nDim FirstCell As Range\n\nSet ColumnHeadings = Range(\"A1:L1\")\n\nColumnHeadings.Copy Sheets(\"Overdue Receipts\").Range(\"A1\")\n\nSet FirstCell = Range(\"L:L\").Find(What:=InputBox(\"How many days overdue\"), LookIn:=xlValues, LookAt:=xlWhole)\nEnd Sub\n</code></pre>\n\n<p>This is just returning the value of whatever I put into the input box instead of the address where that value first shows up. Thankful for any help!</p>\n"}, {"tags": ["excel", "vba", "combobox", "userform"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1573072143, "post_id": 58737073, "comment_id": 103766050, "body": "The value being looked-up should be in the first column of your lookup table.  Also - are <code>Sheets(1)</code> and <code>Worksheets(&quot;sheet1&quot;)</code> the same sheet?"}], "answers": [{"tags": [], "owner": {"reputation": 316, "user_id": 12131488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EVDpB.jpg?s=128&g=1", "display_name": "SmileyFtW", "link": "https://stackoverflow.com/users/12131488/smileyftw"}, "is_accepted": false, "score": 0, "last_activity_date": 1573072629, "last_edit_date": 1573072629, "creation_date": 1573072269, "answer_id": 58738050, "question_id": 58737073, "link": "https://stackoverflow.com/questions/58737073/populate-textboxes-based-on-combobox-value/58738050#58738050", "title": "Populate textboxes based on Combobox value", "body": "<p>Assuming your combo is not multiselect then load it with all of your range and just show the columns you are interested in. Make the number of columns in the ComboBox the same number of columns in your range.</p>\n\n<pre><code>ComboBox1.List = Sheets(1).Range(\"A15:K39\").Value\nComboBox1.ColumnCount=11\nComboBox.ColumnWidths=\"0,0,100,0,0,0,0,0,0,0,0\"\nTextBox1.Value=ComboBox1.List(ComboBox.ListIndex,2) 'the columns are zero-based\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 521, "user_id": 12268796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LVipW.jpg?s=128&g=1", "display_name": "barneyos", "link": "https://stackoverflow.com/users/12268796/barneyos"}, "is_accepted": false, "score": 0, "last_activity_date": 1573072757, "creation_date": 1573072757, "answer_id": 58738155, "question_id": 58737073, "link": "https://stackoverflow.com/questions/58737073/populate-textboxes-based-on-combobox-value/58738155#58738155", "title": "Populate textboxes based on Combobox value", "body": "<p>Try maybe this:</p>\n\n<pre><code>TextBox1.Text = Application.WorksheetFunction.VLookup(ComboBox1.List(ComboBox1.ListIndex, 0), Range(\"C15:K39\"), 1, False)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 12333804, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157689408681425/picture?type=large", "display_name": "Marty", "link": "https://stackoverflow.com/users/12333804/marty"}, "is_accepted": false, "score": 0, "last_activity_date": 1573075146, "creation_date": 1573075146, "answer_id": 58738647, "question_id": 58737073, "link": "https://stackoverflow.com/questions/58737073/populate-textboxes-based-on-combobox-value/58738647#58738647", "title": "Populate textboxes based on Combobox value", "body": "<p>Thank you guys,\nI ended up going with this</p>\n\n<pre><code>Private Sub ComboBox1_Change()\nDim myRange As Range, f As Range\n\n    Set myRange = Worksheets(\"Sheet2\").Range(\"A2:B26\")\n\n    Set f = myRange.Find(What:=ComboBox1.Value, LookIn:=xlValues, Lookat:=xlWhole, MatchCase:=False) '&lt;--| try and find combobox selected value\n    If f Is Nothing Then\n        TextBox1.Value = \"\"\n    Else '&lt;--| ... otherwise...\n        TextBox1.Value = f.Offset(, 1)\n        TextBox2.Value = f.Offset(, 2)\n        TextBox3.Value = f.Offset(, 3)\n    End If\nEnd Sub\n</code></pre>\n\n<p>I had 3 textboxes that i populated with three different columns once an option is chosen from the Combobox.</p>\n\n<p>What i am trying to do is have two last textboxes that I would eventually write numbers in and that would automatically update the corresponding cells.</p>\n\n<p>The Problem I face is updating the cell that relates to the value entered on the combobox.\nThe code below is very rudimentary and i am wondering if i should do the same manually. First part of the code populates three first textboxes, second part is supposed to populate corresponding cells with value I enter depending on the combobox selection. Please let me know if i am not clear enough.</p>\n\n<pre><code>Private Sub OK_Click()\n    Sheets(\"Sheet1\").Range(\"C9\") = TextBox4.value\n    Sheets(\"Sheet1\").Range(\"D9\") = TextBox5.value\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12333804, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157689408681425/picture?type=large", "display_name": "Marty", "link": "https://stackoverflow.com/users/12333804/marty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 133, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1573075146, "creation_date": 1573067638, "last_edit_date": 1573072670, "question_id": 58737073, "link": "https://stackoverflow.com/questions/58737073/populate-textboxes-based-on-combobox-value", "title": "Populate textboxes based on Combobox value", "body": "<p>I am trying to populate a textbox based on the selection i made on the combobox. It would basically look up the combobox value and return the assigned value from the column (the 3rd) I chose. I have some code done but it returns a type mismatch error</p>\n\n<pre><code>Private Sub UserForm_Initialize()\nComboBox1.List = Sheets(1).Range(\"C15:C39\").Value\nEnd Sub\n\nPrivate Sub ComboBox1_Change()\nTextBox1.Text = Application.VLookup(ComboBox1.Value, Worksheets(\"sheet1\").Range(\"A15:K39\"), 3, False)\nEnd Sub\n</code></pre>\n\n<p>Can anyone let me know what's wrong and if there is a better way to go about this?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1633, "user_id": 12001122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ec161ec6ec2ddb3c5ea5989f03fe053?s=128&d=identicon&r=PG&f=1", "display_name": "Jonas", "link": "https://stackoverflow.com/users/12001122/jonas"}, "edited": false, "score": 1, "creation_date": 1573067534, "post_id": 58737017, "comment_id": 103764126, "body": "How do the 11 sheets (which are the targeted ones) differ from the others? You will have to set up a loop to automate this process. Therefor we need some conditions."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1573067694, "post_id": 58737017, "comment_id": 103764193, "body": "<a href=\"https://stackoverflow.com/questions/40459845/how-do-i-use-referstorange\" title=\"how do i use referstorange\">stackoverflow.com/questions/40459845/how-do-i-use-referstora&zwnj;&#8203;nge</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1573068800, "post_id": 58737017, "comment_id": 103764649, "body": "Each <code>Name</code> has a <code>RefersToRange</code> property that gives you a <code>Range</code> object, and every <code>Range</code> has a <code>Parent</code> property that gives you the <code>Worksheet</code> it belongs to."}, {"owner": {"reputation": 246, "user_id": 11605997, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-TwdSZ-SRvJ8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfDo0lDLtbMVWGoNWRiAw5xw5BvWg/mo/photo.jpg?sz=128", "display_name": "John Carty", "link": "https://stackoverflow.com/users/11605997/john-carty"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1573074712, "post_id": 58737017, "comment_id": 103767078, "body": "@MathieuGuindon this is exactly what I needed. If you want to move this to a response I will mark it as accepted."}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 1, "last_activity_date": 1573075185, "creation_date": 1573075185, "answer_id": 58738650, "question_id": 58737017, "link": "https://stackoverflow.com/questions/58737017/get-named-range-values/58738650#58738650", "title": "Get Named Range Values", "body": "<p>Each <code>Name</code> has a <code>RefersToRange</code> property that gives you a <code>Range</code> object, and every <code>Range</code> has a <code>Parent</code> property that gives you the <code>Worksheet</code> it belongs to.</p>\n\n<p>So if you have a <code>Name</code> object, you can always know what sheet it's referring to.</p>\n"}], "owner": {"reputation": 246, "user_id": 11605997, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-TwdSZ-SRvJ8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfDo0lDLtbMVWGoNWRiAw5xw5BvWg/mo/photo.jpg?sz=128", "display_name": "John Carty", "link": "https://stackoverflow.com/users/11605997/john-carty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 58738650, "answer_count": 1, "score": 1, "last_activity_date": 1573075185, "creation_date": 1573067384, "last_edit_date": 1573072708, "question_id": 58737017, "link": "https://stackoverflow.com/questions/58737017/get-named-range-values", "title": "Get Named Range Values", "body": "<p>I have two workbooks that have a lot of the same named ranges and I need to move values from the second workbook to the first. I can do this by specifying which sheet the range is on and the name of range, but there are about 200 named ranges spread out over 20-something sheets and I only need the named ranges that are on 11 of those sheets. I could take the time to figure it out and hard code moving each one, but would really like it to be a mostly automated process. That way if a new range is added it can just be done automatically and I don't have to update the code.</p>\n\n<p>The code I have so far is:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>For Each Name In sheetList\n    Set sheet2vals = sheet2.Sheets(Name).Range(rangename)\n    Set sheet1vals = sheet1.Sheets(Name).Range(rangename)\n    sheet2vals.Copy sheet1vals\nNext Name\n</code></pre>\n\n<p>sheetList is an array of sheet names where all the ranges are stored. That part works exactly as I need it, I just need to find a way to pull the ranges from each of the sheets and move them. However, the only way I can seem to find to get the list of named ranges is by pulling at the Workbook level, which doesn't tell me what sheet it is on.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12333849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71de012799382845d8d022d49babd21d?s=128&d=identicon&r=PG&f=1", "display_name": "Bruce", "link": "https://stackoverflow.com/users/12333849/bruce"}, "edited": false, "score": 0, "creation_date": 1573165536, "post_id": 58753626, "comment_id": 103803185, "body": "I can&#39;t use power query because the destination worksheet has to loaded back into a database that won&#39;t allow for it."}], "tags": [], "owner": {"reputation": 38, "user_id": 12149490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcb1504eabe74a84e31fe62fc55027d4?s=128&d=identicon&r=PG&f=1", "display_name": "Yosh", "link": "https://stackoverflow.com/users/12149490/yosh"}, "is_accepted": false, "score": 0, "last_activity_date": 1573145842, "creation_date": 1573145842, "answer_id": 58753626, "question_id": 58736712, "link": "https://stackoverflow.com/questions/58736712/copy-from-one-workbook-to-another-workbook-for-a-range-where-the-last-cell-in-ra/58753626#58753626", "title": "Copy from one workbook to another workbook for a range where the last cell in range varies", "body": "<p>I do not understand what you want that <a href=\"https://www.howtoexcel.org/power-query/the-complete-guide-to-power-query/\" rel=\"nofollow noreferrer\">Power Query</a> cannot do. Use tables and Queries and connections and you should be fine.  </p>\n"}], "owner": {"reputation": 1, "user_id": 12333849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71de012799382845d8d022d49babd21d?s=128&d=identicon&r=PG&f=1", "display_name": "Bruce", "link": "https://stackoverflow.com/users/12333849/bruce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573145842, "creation_date": 1573066120, "last_edit_date": 1573082266, "question_id": 58736712, "link": "https://stackoverflow.com/questions/58736712/copy-from-one-workbook-to-another-workbook-for-a-range-where-the-last-cell-in-ra", "title": "Copy from one workbook to another workbook for a range where the last cell in range varies", "body": "<p>I am trying to copy data from one workbook to another for specific ranges where the last row varies.</p>\n\n<p>I have tried a few different expressions for where 'H', but have defaulted for now as a workaround to the ending of said column to 10000. I am stumped.</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Sub Copy_Workbook1()\n  Workbooks(\"Raw Bulk Upload report.xlsx\").Worksheets(\"ETPP Bulk Upload\").Range(\"f4:H10000).Copy _\n    Workbooks(\"ETPP Bulk Upload List.xlsm\").Worksheets(\"TCExport\").Range(\"B2\")\n  Workbooks(\"Raw Bulk Upload report.xlsx\").Worksheets(\"ETPP Bulk Upload\").Range(\"V4:V100000\").Copy _\n    Workbooks(\"ETPP Bulk Upload List.xlsm\").Worksheets(\"TCExport\").Range(\"e2\")\n  Workbooks(\"Raw Bulk Upload report.xlsx\").Worksheets(\"ETPP Bulk Upload\").Range(\"AR4:AU100000\").Copy _\n    Workbooks(\"ETPP Bulk Upload List.xlsm\").Worksheets(\"TCExport\").Range(\"H2\")\n  Workbooks(\"Raw Bulk Upload report.xlsx\").Worksheets(\"ETPP Bulk Upload\").Range(\"AJ4:AJ100000\").Copy _\n    Workbooks(\"ETPP Bulk Upload List.xlsm\").Worksheets(\"TCExport\").Range(\"L2\")\n  Workbooks(\"Raw Bulk Upload report.xlsx\").Worksheets(\"ETPP Bulk Upload\").Range(\"AX4:AX100000\").Copy _\n    Workbooks(\"ETPP Bulk Upload List.xlsm\").Worksheets(\"TCExport\").Range(\"M2\")\nEnd Sub\n</code></pre>\n\n<p>Copy data from column ranges where it will go to last cell and then paste to another workbook.</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1573069837, "post_id": 58736468, "comment_id": 103765042, "body": "With a code of xAE, I do not think &#174; is special.  There are many frequently used characters (perhaps not in the US but definitely in Europe) in the range xA0 to XFF.  I doubt <code>PublishObjects</code>, the function behind <code>RangeToHtml</code>, treats ASCII characters differently from other Unicode characters.  If it did, there would have been multiple complaints long ago."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1573069878, "post_id": 58736468, "comment_id": 103765065, "body": "Do you mean you have a string \u201cabcdefghijk&#174;\u201d with \u201cabcdefghijk\u201d having one font size and \u201c&#174;\u201d having another?  I imagine that is an unusual requirement and a faulty conversion might not have been noticed.  Why not replace \u201c&#174;\u201d with one of the lesser used ASCII characters and see what happens?"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1573069907, "post_id": 58736468, "comment_id": 103765079, "body": "If memory serves, <code>RangeToHtml</code> outputs the Html to a text file which it deletes before exiting.  I suggest removing the file delete and then finding the relevant string within the Html.  Including that string in your question might help."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "edited": false, "score": 0, "creation_date": 1573070255, "post_id": 58736468, "comment_id": 103765215, "body": "@EugeneAstafiev  I do not understand why you have removed the Outlook tag."}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "edited": false, "score": 0, "creation_date": 1573070848, "post_id": 58736468, "comment_id": 103765442, "body": "The Outlook object model is not related to the Excel&#39;s <code>Range</code> class and HTML markup."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "edited": false, "score": 0, "creation_date": 1573072868, "post_id": 58736468, "comment_id": 103766340, "body": "@EugeneAstafiev  The posted code runs under Outlook and is part of a routine that creates an MailItem from an Excel range.  I have never seen a RangeToHtml question that was linked to an Outlook macro,  Outlook is specifically mentioned in the question."}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "edited": false, "score": 0, "creation_date": 1573073938, "post_id": 58736468, "comment_id": 103766781, "body": "It is a part of a routine, but the question is related to using the Excel object model. There are no Outlook specific questions."}, {"owner": {"reputation": 21, "user_id": 10930425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eae7a311d7a614d29e4ee6b9c6bcc9de?s=128&d=identicon&r=PG&f=1", "display_name": "M. Isaacs", "link": "https://stackoverflow.com/users/10930425/m-isaacs"}, "edited": false, "score": 0, "creation_date": 1573226022, "post_id": 58736468, "comment_id": 103824182, "body": "any characters i insert are doing the same.  I tried putting a bunch of space between  &quot;abcdefg&quot;  and the \u201c&#174;\u201d  but the \u201c&#174;\u201d still changes text size and type once in the email.  I tried removing the &#39;kill tempfile command in the RangeToHtml code but I don&#39;t know where to locate the file it is creating."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1573333521, "post_id": 58736468, "comment_id": 103850494, "body": "The Html file is in the Windows temporary file.  If you cannot find the Windows temporary file, I suggest replacing <code>Environ$(&quot;temp&quot;)</code> with the name of a specific folder for example your desktop."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 1, "creation_date": 1573333796, "post_id": 58736468, "comment_id": 103850554, "body": "@M.Isaacs  It appears the <code>PublishObjects</code> does not handle character-level font-size changes.  How complicated is your range?  It is easy to perform most Excel to Html conversions using VBA but the conversion becomes slow if the Excel range uses too many character level formats."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1573334142, "post_id": 58736468, "comment_id": 103850636, "body": "How many people use RangeToHtml as part of a Excel routine?  Ron de Bruin&#39;s routine is specifically about getting a range into Outlook.  By removing the Outlook tag you ensure this question is not seen by the people most likely to be able to help.  I would not have see the question if I first looked after you removed the tag."}, {"owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "edited": false, "score": 1, "creation_date": 1574167048, "post_id": 58736468, "comment_id": 104127477, "body": "Sounds like a somewhat similar issue to this question where altering the RangeToHTML function worked so maybe this will work for you: <a href=\"https://stackoverflow.com/questions/56546903/create-email-from-excel-vba-to-include-range-with-conditional-formatting\" title=\"create email from excel vba to include range with conditional formatting\">stackoverflow.com/questions/56546903/&hellip;</a>"}], "owner": {"reputation": 21, "user_id": 10930425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eae7a311d7a614d29e4ee6b9c6bcc9de?s=128&d=identicon&r=PG&f=1", "display_name": "M. Isaacs", "link": "https://stackoverflow.com/users/10930425/m-isaacs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1583834496, "creation_date": 1573065027, "last_edit_date": 1583834496, "question_id": 58736468, "link": "https://stackoverflow.com/questions/58736468/converting-special-characters-in-range-to-html", "title": "Converting special characters in Range to HTML", "body": "<p>Using Function RangetoHTML(OutBody As Range)' Changed by Ron de Bruin 28-Oct-2006. This function converts an excel sheet in my workbook into an Outlook email. </p>\n\n<p>Works fine for most of it, however,  I have a special character (registered mark) after a text string. On the excel sheet, I have font size as '11' but when it converts to Outlook,  the font size increases to match the text next to it.  Since everything else works fine, thinking it's because it's a 'special character' that was inserted,  and assuming the problem is with the below function. (which I didn't write).</p>\n\n<p>Can the code below be modified to allow for the correct sizing of the special character?  </p>\n\n<pre><code>OutBody.Copy\nSet TempWB = Workbooks.Add(1)\nWith TempWB.Sheets(1)\n    .Cells(1).PasteSpecial Paste:=8\n    .Cells(1).PasteSpecial xlPasteValues, , False, False\n    .Cells(1).PasteSpecial xlPasteFormats, , False, False\n    .Cells(1).Select\n    Application.CutCopyMode = False\n    On Error Resume Next\n    .DrawingObjects.Visible = True\n    .DrawingObjects.Delete\n    On Error GoTo 0\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 2, "creation_date": 1573065154, "post_id": 58736406, "comment_id": 103763114, "body": "Store the &quot;associated division&quot; as the <i>value</i> in the dictionary (rather than leaving the value empty)? Your question is really too vague to answer. Whether or not you would want to create a second dictionary depends on what you would want to <i>do</i> with it."}, {"owner": {"reputation": 101, "user_id": 10560279, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wQzGnSqEnR8/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCnU-kGzjWDce6CKHogb6TgxMv8iw/mo/photo.jpg?sz=128", "display_name": "Sudio", "link": "https://stackoverflow.com/users/10560279/sudio"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1573065263, "post_id": 58736406, "comment_id": 103763158, "body": "Ahh, good suggestion. All I need to do is grab the division that the branch is assigned so that I can put that value in another cell."}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 10560279, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wQzGnSqEnR8/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCnU-kGzjWDce6CKHogb6TgxMv8iw/mo/photo.jpg?sz=128", "display_name": "Sudio", "link": "https://stackoverflow.com/users/10560279/sudio"}, "edited": false, "score": 0, "creation_date": 1573065748, "post_id": 58736516, "comment_id": 103763361, "body": "Gotcha. I was just trying to print the all unique branches. My next line of code was Range(dataRange) = data  to print this out"}], "tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": true, "score": 1, "last_activity_date": 1573065212, "creation_date": 1573065212, "answer_id": 58736516, "question_id": 58736406, "link": "https://stackoverflow.com/questions/58736406/do-i-need-to-create-a-second-scripting-dictionary/58736516#58736516", "title": "Do I need to create a second Scripting.Dictionary?", "body": "<p>Why not store the division in the dictionary entry for that branch instead of storing an <code>EMPTY</code> value:</p>\n\n<pre><code>Dim data(), dict As Object, r As Long\nSet dict = CreateObject(\"Scripting.Dictionary\")\n\ndata = Sheets(\"Employee\").UsedRange.Columns(5)\n\nFor each rngCell in data\n    dict(rngCell.value) = rngCell.offset(,1).value\nNext\n\ndata = WorksheetFunction.Transpose(dict.Keys())\n</code></pre>\n\n<p>I'm not sure what you are trying to accomplish here so I can't comment on the rest of the code (the transpose afterwards), but at least you have everything in the same spot.</p>\n"}], "owner": {"reputation": 101, "user_id": 10560279, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wQzGnSqEnR8/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCnU-kGzjWDce6CKHogb6TgxMv8iw/mo/photo.jpg?sz=128", "display_name": "Sudio", "link": "https://stackoverflow.com/users/10560279/sudio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 58736516, "answer_count": 1, "score": 0, "last_activity_date": 1582127396, "creation_date": 1573064763, "last_edit_date": 1582127396, "question_id": 58736406, "link": "https://stackoverflow.com/questions/58736406/do-i-need-to-create-a-second-scripting-dictionary", "title": "Do I need to create a second Scripting.Dictionary?", "body": "<p>I have a table that contains an employee's details, like the division and branch they are assigned to.</p>\n\n<p>I'm grabbing unique branches with the code below.</p>\n\n<pre><code>Dim data(), dict As Object, r As Long\nSet dict = CreateObject(\"Scripting.Dictionary\")\n\ndata = Sheets(\"Employee\").UsedRange.Columns(5).Value\n\nFor r = 1 To UBound(data)\n    dict(data(r, 1)) = Empty\nNext\n\ndata = WorksheetFunction.Transpose(dict.Keys())\n</code></pre>\n\n<p>To grab the associated division that each branch belongs to (the column to the left in the table), should I create a second scripting dictionary, or is there an easier or more efficient way?</p>\n"}, {"tags": ["html", "vba", "web-scraping"], "comments": [{"owner": {"reputation": 1853, "user_id": 8099744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/789f02ce08565883147629e6065606e6?s=128&d=identicon&r=PG&f=1", "display_name": "Sureshmani", "link": "https://stackoverflow.com/users/8099744/sureshmani"}, "edited": false, "score": 0, "creation_date": 1573066654, "post_id": 58736342, "comment_id": 103763759, "body": "Are you getting any errors or just null ? I would try with getElementByxpath(&quot;//section[@class=&#39;product_options&#39;]//vue-&zwnj;&#8203;product-options&quot;).ge&zwnj;&#8203;tAttribute(&quot;sku&quot;)"}, {"owner": {"reputation": 43, "user_id": 11958760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38b463bccb4f34ac4217d65481ad6d21?s=128&d=identicon&r=PG&f=1", "display_name": "justinpete", "link": "https://stackoverflow.com/users/11958760/justinpete"}, "reply_to_user": {"reputation": 1853, "user_id": 8099744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/789f02ce08565883147629e6065606e6?s=128&d=identicon&r=PG&f=1", "display_name": "Sureshmani", "link": "https://stackoverflow.com/users/8099744/sureshmani"}, "edited": false, "score": 0, "creation_date": 1573067551, "post_id": 58736342, "comment_id": 103764131, "body": "@Sureshmani I was get null returns. However, getElementByxpath gives me an Sub or Function not defined error - I have not used that method in the past so perhaps I need a reference for that"}, {"owner": {"reputation": 1853, "user_id": 8099744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/789f02ce08565883147629e6065606e6?s=128&d=identicon&r=PG&f=1", "display_name": "Sureshmani", "link": "https://stackoverflow.com/users/8099744/sureshmani"}, "edited": false, "score": 0, "creation_date": 1573067921, "post_id": 58736342, "comment_id": 103764293, "body": "you are right. that&#39;s probably not a valid sub. can you try with getElementsByTagName(&#39;vue-product-options&#39;).getAttribute(&quot;sk&zwnj;&#8203;u&quot;)"}, {"owner": {"reputation": 43, "user_id": 11958760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38b463bccb4f34ac4217d65481ad6d21?s=128&d=identicon&r=PG&f=1", "display_name": "justinpete", "link": "https://stackoverflow.com/users/11958760/justinpete"}, "reply_to_user": {"reputation": 1853, "user_id": 8099744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/789f02ce08565883147629e6065606e6?s=128&d=identicon&r=PG&f=1", "display_name": "Sureshmani", "link": "https://stackoverflow.com/users/8099744/sureshmani"}, "edited": false, "score": 0, "creation_date": 1573068667, "post_id": 58736342, "comment_id": 103764592, "body": "Dang that gets me &quot;Object doesn&#39;t support this property or method&quot; I feel like these are close but just something just slightly off"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 11958760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38b463bccb4f34ac4217d65481ad6d21?s=128&d=identicon&r=PG&f=1", "display_name": "justinpete", "link": "https://stackoverflow.com/users/11958760/justinpete"}, "edited": false, "score": 0, "creation_date": 1573065759, "post_id": 58736460, "comment_id": 103763364, "body": "My mistake, I tagged VBA but didn&#39;t mention it in the comment. I&#39;m trying to pull into excel using vba macro."}], "tags": [], "owner": {"reputation": 76, "user_id": 7547087, "user_type": "registered", "profile_image": "https://graph.facebook.com/1090583001053173/picture?type=large", "display_name": "Ashwin Rao K", "link": "https://stackoverflow.com/users/7547087/ashwin-rao-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1573065007, "creation_date": 1573065007, "answer_id": 58736460, "question_id": 58736342, "link": "https://stackoverflow.com/questions/58736342/how-do-you-pull-an-attribute-from-html-using-vba/58736460#58736460", "title": "How do you pull an attribute from html using vba", "body": "<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;!DOCTYPE html&gt;\r\n&lt;html&gt;\r\n&lt;head&gt;\r\n&lt;script src=\"https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js\"&gt;&lt;/script&gt;\r\n&lt;script&gt;\r\n$(document).ready(function(){\r\n  $(\"button\").click(function(){\r\n    alert($(\".sdfv\").attr(\"sku\"));\r\n  });\r\n});\r\n&lt;/script&gt;\r\n&lt;/head&gt;\r\n&lt;body&gt;\r\n\r\n&lt;vue-product-options class=\"sdfv\" sku=\"CS060120\"&gt;&lt;/vue-product-options&gt;\r\n\r\n&lt;button&gt;Click the button to get sku value&lt;/button&gt;\r\n\r\n&lt;/body&gt;\r\n&lt;/html&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1574738782, "post_id": 58739535, "comment_id": 104328493, "body": "did you try this?"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1573080186, "creation_date": 1573080186, "answer_id": 58739535, "question_id": 58736342, "link": "https://stackoverflow.com/questions/58736342/how-do-you-pull-an-attribute-from-html-using-vba/58739535#58739535", "title": "How do you pull an attribute from html using vba", "body": "<p>Try using attribute selector</p>\n\n<pre><code>Debug.Print ie.document.querySelector(\"[sku]\").getAttribute(\"sku\")\n</code></pre>\n\n<p>If you need to be more specific you can add the type selector so it becomes </p>\n\n<pre><code>Debug.Print ie.document.querySelector(\"vue-product-options[sku]\").getAttribute(\"sku\")\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 11958760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38b463bccb4f34ac4217d65481ad6d21?s=128&d=identicon&r=PG&f=1", "display_name": "justinpete", "link": "https://stackoverflow.com/users/11958760/justinpete"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1573080186, "creation_date": 1573064503, "last_edit_date": 1573065723, "question_id": 58736342, "link": "https://stackoverflow.com/questions/58736342/how-do-you-pull-an-attribute-from-html-using-vba", "title": "How do you pull an attribute from html using vba", "body": "<p>I need to pull the sku (CS060120) from this section of html (edit:) Using VBA</p>\n\n<p>tried getAttribute and getElementsbyTag(and Class)Name but I am not able to get the return I am looking for. Anyone know how to do this?</p>\n\n<pre><code>&lt;section class=\"product_options\"&gt;\n    &lt;header&gt;\n        &lt;h1&gt;\n            60' x 120' NiceRink CS Liner\n        &lt;/h1&gt;\n    &lt;/header&gt;\n    &lt;vue-product-options \n        v-bind:product-opts=\"[]\" \n        v-bind:configurable-payload=\"{&amp;quot;product_option&amp;quot;:{&amp;quot;extension_attributes&amp;quot;:{&amp;quot;configurable_item_options&amp;quot;:[]}}}\" \n        v-bind:liner-types=\"{&amp;quot;good&amp;quot;:16,&amp;quot;better&amp;quot;:14,&amp;quot;best&amp;quot;:15}\" \n        v-bind:is-folded-or-rolled-liner-sku=\"false\" \n        v-bind:bundle-payload=\"{&amp;quot;product_option&amp;quot;:{&amp;quot;extension_attributes&amp;quot;:{&amp;quot;bundle_options&amp;quot;:[]}}}\" \n        v-bind:tier-prices=\"[]\" \n        v-bind:is-wholesale-only=\"false\" \n        v-bind:prices-index=\"{}\" \n        v-bind:options-map=\"{}\" \n        v-bind:is-configurable=\"false\" \n        v-bind:is-rink-liner=\"false\" \n        v-bind:is-liner-sku=\"true\" \n        v-bind:is-bundle=\"false\" product-type=\"undefined\" price=\"612\" sku=\"CS060120\" image=\"https://www.nicerink.com/media/catalog/product/l/i/liner_1.jpg\" magento-base-url=\"https://www.nicerink.com\" name=\"60' x 120' NiceRink CS Liner\"&gt;\n    &lt;/vue-product-options&gt;\n    &lt;div class=\"product_options_panel package_cta\"&gt;\n        &lt;h3&gt;\n            Looking for a full Rink Package?\n        &lt;/h3&gt;\n\n        &lt;p&gt;\n            We've got you covered!\n        &lt;/p&gt;\n\n        &lt;a class=\"button dark\" href=\"/rink-builder\"&gt;\n            Rink Packages\n        &lt;/a&gt;\n    &lt;/div&gt;\n&lt;/section&gt;\n</code></pre>\n\n<p>This is what I'm trying:</p>\n\n<pre><code>ieDoc.getElementsByClassName(\"product_options\")(0).getAttribute(\"sku\")\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1573064387, "post_id": 58736265, "comment_id": 103762733, "body": "What is the error message? Note - instead of using the <code>Worksheet_HyperLink</code> event, you might be better off using the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.workbook.sheetfollowhyperlink\" rel=\"nofollow noreferrer\"><code>Workbook_SheetFollowHyperlink</code></a> event. Then you&#39;ll only have one code instance (in the <code>ThisWorkbook</code> module), instead of code in multiple sheet modules."}, {"owner": {"reputation": 15, "user_id": 12322597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68b3833c60184bbce314fc75a1ecc9df?s=128&d=identicon&r=PG&f=1", "display_name": "Keeyask", "link": "https://stackoverflow.com/users/12322597/keeyask"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1573064901, "post_id": 58736265, "comment_id": 103762992, "body": "it gives a reference isn&#39;t valid msg. then a run-time error &#39;1004&#39;: Method &#39;range&#39; of object&#39;_worksheet failed. it highlights the set r= range(target.subaddress) part when I hit debug"}, {"owner": {"reputation": 15, "user_id": 12322597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68b3833c60184bbce314fc75a1ecc9df?s=128&d=identicon&r=PG&f=1", "display_name": "Keeyask", "link": "https://stackoverflow.com/users/12322597/keeyask"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1573065026, "post_id": 58736265, "comment_id": 103763052, "body": "honestly I am a complete rookie here I have no idea what you mean by using the workbook sheetfollowhyperlink lol"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 12322597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68b3833c60184bbce314fc75a1ecc9df?s=128&d=identicon&r=PG&f=1", "display_name": "Keeyask", "link": "https://stackoverflow.com/users/12322597/keeyask"}, "edited": false, "score": 0, "creation_date": 1573066787, "post_id": 58736642, "comment_id": 103763828, "body": "cool thanks! , that&#39;s a much better way to do it instead of adding my original code to every sheet. so as far as the code in the module that creates the hyperlink cell; is there a way to get that to move along the tabs as well or do I need to have the link in place in row A for every tab? my first sheet contains about 3000 rows."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 15, "user_id": 12322597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68b3833c60184bbce314fc75a1ecc9df?s=128&d=identicon&r=PG&f=1", "display_name": "Keeyask", "link": "https://stackoverflow.com/users/12322597/keeyask"}, "edited": false, "score": 0, "creation_date": 1573066878, "post_id": 58736642, "comment_id": 103763863, "body": "Do you mean loop through each worksheet and create the hyperlinks in column A?"}, {"owner": {"reputation": 15, "user_id": 12322597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68b3833c60184bbce314fc75a1ecc9df?s=128&d=identicon&r=PG&f=1", "display_name": "Keeyask", "link": "https://stackoverflow.com/users/12322597/keeyask"}, "edited": false, "score": 0, "creation_date": 1573067309, "post_id": 58736642, "comment_id": 103764034, "body": "ya so when cells B-&gt;E are cut and pasted to the next tab, a hyperlink gets created in cell A to be able to cut and paste into the next tab. if that is too much I am ok with pre-created links that are on column A in every tab. its just the module I have now only creates links on the first sheet, when I try to use it to create links on the second sheet that&#39;s when that error msg comes up when I try to use that link"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 15, "user_id": 12322597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68b3833c60184bbce314fc75a1ecc9df?s=128&d=identicon&r=PG&f=1", "display_name": "Keeyask", "link": "https://stackoverflow.com/users/12322597/keeyask"}, "edited": false, "score": 0, "creation_date": 1573067477, "post_id": 58736642, "comment_id": 103764108, "body": "Ah... so you need to rewrite <code>HyperActive</code> to work on a specific range, as opposed to <code>Selection</code>."}, {"owner": {"reputation": 15, "user_id": 12322597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68b3833c60184bbce314fc75a1ecc9df?s=128&d=identicon&r=PG&f=1", "display_name": "Keeyask", "link": "https://stackoverflow.com/users/12322597/keeyask"}, "edited": false, "score": 0, "creation_date": 1573068222, "post_id": 58736642, "comment_id": 103764403, "body": "the workbook doesn&#39;t contain any chart sheets, its honestly just 4 columns in every sheet A B C D E. B-&gt;E is just filled with data for about 3000 rows. I want column A to be filled with hyperlinks to move the row from one sheet to the next. every tab is a department at work and the idea is when each department is done with a specific thing that is in the row, they click the link and it moves over to the next tab so that department can see it when they open their tab."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 15, "user_id": 12322597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68b3833c60184bbce314fc75a1ecc9df?s=128&d=identicon&r=PG&f=1", "display_name": "Keeyask", "link": "https://stackoverflow.com/users/12322597/keeyask"}, "edited": false, "score": 0, "creation_date": 1573068379, "post_id": 58736642, "comment_id": 103764469, "body": "See my 2nd edit. Though I&#39;m not sure the text of the newly created hyperlink will be right. When you click a hyperlink, do you want that hyperlink to remain on the current sheet, or move to the next one? Should the newly created hyperlink have the same text as the clicked hyperlink?"}, {"owner": {"reputation": 15, "user_id": 12322597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68b3833c60184bbce314fc75a1ecc9df?s=128&d=identicon&r=PG&f=1", "display_name": "Keeyask", "link": "https://stackoverflow.com/users/12322597/keeyask"}, "edited": false, "score": 0, "creation_date": 1573069253, "post_id": 58736642, "comment_id": 103764821, "body": "right on! its working , it creates a hyperlink when moving the data across the tabs but I was using the module to create the initial link in the first tab but now it gives me a msg ( argument not optional )"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 15, "user_id": 12322597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68b3833c60184bbce314fc75a1ecc9df?s=128&d=identicon&r=PG&f=1", "display_name": "Keeyask", "link": "https://stackoverflow.com/users/12322597/keeyask"}, "edited": false, "score": 0, "creation_date": 1573069336, "post_id": 58736642, "comment_id": 103764848, "body": "So keep that original <code>HyperActive</code> code and rename the new one to something else."}, {"owner": {"reputation": 15, "user_id": 12322597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68b3833c60184bbce314fc75a1ecc9df?s=128&d=identicon&r=PG&f=1", "display_name": "Keeyask", "link": "https://stackoverflow.com/users/12322597/keeyask"}, "edited": false, "score": 0, "creation_date": 1573069338, "post_id": 58736642, "comment_id": 103764850, "body": "i feel guilty taking up so much of your time, ill try to work on the rest on my own. thank you so much for your help i really appreciate it . Cheers from the deep north of Canada!"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 15, "user_id": 12322597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68b3833c60184bbce314fc75a1ecc9df?s=128&d=identicon&r=PG&f=1", "display_name": "Keeyask", "link": "https://stackoverflow.com/users/12322597/keeyask"}, "edited": false, "score": 0, "creation_date": 1573069369, "post_id": 58736642, "comment_id": 103764860, "body": "Canada, eh? Making me want some poutine and Tim Hortons :-)"}, {"owner": {"reputation": 15, "user_id": 12322597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68b3833c60184bbce314fc75a1ecc9df?s=128&d=identicon&r=PG&f=1", "display_name": "Keeyask", "link": "https://stackoverflow.com/users/12322597/keeyask"}, "edited": false, "score": 1, "creation_date": 1573069490, "post_id": 58736642, "comment_id": 103764912, "body": "if i could send you some i would!"}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 0, "last_activity_date": 1573068345, "last_edit_date": 1592644375, "creation_date": 1573065782, "answer_id": 58736642, "question_id": 58736265, "link": "https://stackoverflow.com/questions/58736265/how-to-create-hyperlink-linked-to-macro-code-to-cut-and-paste/58736642#58736642", "title": "how to create hyperlink linked to macro code to cut and paste?", "body": "<p>I'd suggest using the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.workbook.sheetfollowhyperlink\" rel=\"nofollow noreferrer\"><code>Workbook_SheetFollowHyperlink</code></a> event here. This is the <em>workbook</em>-level event, as opposed to the <em>worksheet</em>-level <code>Worksheet_FollowHyperlink</code> event.</p>\n<p>From the docs:</p>\n<blockquote>\n<p>Occurs when you choose any hyperlink in Microsoft Excel...</p>\n<p><strong>Parameters</strong></p>\n<p><strong><code>Sh</code></strong> :    The <code>Worksheet</code> object that contains the hyperlink</p>\n<p><strong><code>Target</code></strong>: The <code>Hyperlink</code> object that represents the destination of the hyperlink</p>\n</blockquote>\n<p>Add the following code to the <code>ThisWorkbook</code> module (not the sheet code module).</p>\n<pre><code>Private Sub Workbook_SheetFollowHyperlink(ByVal Sh As Object, ByVal Target As Hyperlink)\n    If Sh.Index = Me.Worksheets.Count Then Exit Sub ' Do nothing if `Sh` is the last worksheet\n      \n    Dim nextWs As Worksheet\n    Set nextWs = Me.Worksheets(Sh.Index + 1)\n    \n    With nextWs\n        Dim lastRow As Long\n        lastRow = .Range(&quot;B&quot; &amp; .Rows.Count).End(xlUp).Row\n    End With\n                \n    Dim rng As Range\n    Set rng = Sh.Range(Target.SubAddress)\n\n    rng.Offset(, 1).Resize(1, 4).Cut Destination:=nextWs.Range(&quot;B&quot; &amp; lastRow + 1)\n    \n    Application.CutCopyMode = False\nEnd Sub\n</code></pre>\n<p>IMPORTANT NOTE: In its current state, this assumes that the workbook only has <em>worksheets</em> (no chart sheets, for example).</p>\n<hr />\n<p><strong>EDIT</strong>: You can use this revised code if the workbook contains other sheet types besides worksheets:</p>\n<pre><code>Private Sub Workbook_SheetFollowHyperlink(ByVal Sh As Object, ByVal Target As Hyperlink)\n    Dim indx As Long\n    indx = GetWorksheetIndex(Sh)\n    \n    If indx = Me.Worksheets.Count Then Exit Sub\n    \n    Dim rng As Range\n    Set rng = Sh.Range(Target.SubAddress)\n      \n    Dim nextWs As Worksheet\n    Set nextWs = Me.Worksheets(indx + 1)\n    \n    With nextWs\n        Dim lastRow As Long\n        lastRow = .Range(&quot;B&quot; &amp; .Rows.Count).End(xlUp).Row\n    End With\n    \n    rng.Offset(, 1).Resize(1, 4).Cut Destination:=nextWs.Range(&quot;B&quot; &amp; lastRow + 1)\n    \n    Application.CutCopyMode = False\nEnd Sub\n\nPrivate Function GetWorksheetIndex(ByVal ws As Worksheet) As Long\n    Dim w As Worksheet\n\n    For Each w In ws.Parent.Worksheets\n        Dim counter As Long\n        counter = counter + 1\n        \n        If w.Name = ws.Name Then\n            GetWorksheetIndex = counter\n            Exit Function\n        End If\n    Next w\nEnd Function\n</code></pre>\n<p><strong>2nd EDIT</strong>:</p>\n<p>I think you can rewrite <code>HyperActive</code> to something like this:</p>\n<pre><code>Sub HyperActive(ByVal rng As Range)\n    Dim ws As Worksheet\n    Set ws = rng.Parent\n    \n    Dim fullAddress As String\n    fullAddress = &quot;'&quot; &amp; ws.Name &amp; &quot;'!&quot; &amp; rng.Address\n    \n    ws.Hyperlinks.Add Anchor:=rng, Address:=&quot;&quot;, SubAddress:=fullAddress, TextToDisplay:=rng.Text\nEnd Sub\n</code></pre>\n<p>Then in the main <code>Workbook_SheetFollowHyperlink</code> code, add the following line:</p>\n<pre><code>HyperActive rng:=nextWs.Range(&quot;A&quot; &amp; lastRow + 1)\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 12322597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68b3833c60184bbce314fc75a1ecc9df?s=128&d=identicon&r=PG&f=1", "display_name": "Keeyask", "link": "https://stackoverflow.com/users/12322597/keeyask"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 58736642, "answer_count": 1, "score": 1, "last_activity_date": 1573068345, "creation_date": 1573064182, "last_edit_date": 1573064250, "question_id": 58736265, "link": "https://stackoverflow.com/questions/58736265/how-to-create-hyperlink-linked-to-macro-code-to-cut-and-paste", "title": "how to create hyperlink linked to macro code to cut and paste?", "body": "<p>Very new to excel coding here and I am banging my head against the wall trying to get this done by googling, but it seems like every time I push the rug down form one spot it pops up from another lol\nI have an excel sheet with 5 tabs on it, coloum A in each one is where I want the clickable cell to be. When that cell is clicked, I want it to cut the 4 cells to the right of it on the same row and paste it on the next tab. So clicking A1 would cut B1,C1,D1,E1 and paste it on the next tab, but on the next empty row available. \nSame thing with the next tab until that row has made it to the final tab\nAll the data is on the first sheet, all the other ones are empty. So once i click it on the first sheet I want it to move to the next one, then when I click it on the next one I want it to move to the third one.</p>\n\n<p>So far I have a code that creates hyperllinks on the cells I highlight, but it displays (sheet name! cell number) , I want to display a specific txt instead of that , like ( complete) or ( received ).the display varies for each tab.\nThe code that I have in the first sheet works to move the cut row to the second sheet, but I tried pasting that code in the next sheet to move it to the 3rd sheet but I keep getting an error.</p>\n\n<p>Thanks in advance for helping! I feel guilty asking this , usually I would sit and learn the whole process but I am just crunched for time here.</p>\n\n<p>code in module</p>\n\n<pre><code>Sub HyperActive()\n    Dim nm As String\n\n    nm = ActiveSheet.Name &amp; \"!\"\n    For Each r In Selection\n        t = r.Text\n        addy = nm &amp; r.Address(0, 0)\n        ActiveSheet.Hyperlinks.Add Anchor:=r, Address:=\"\", SubAddress:= _\n            addy, TextToDisplay:=r.Text\n    Next r\nEnd Sub\n</code></pre>\n\n<p>code in sheet</p>\n\n<pre><code>Private Sub Worksheet_FollowHyperlink(ByVal Target As Hyperlink)\n    Dim r As Range\n\n    Set r = Range(Target.SubAddress)\n\n    r.Offset(0, 1).Resize(1, 4).Cut\n    Sheets(\"Wash Bay\").Select\n    Worksheets(\"Wash Bay\").Range(\"B\" &amp; Rows.Count).End(xlUp).Offset(1).Select\n    ActiveSheet.Paste\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["html", "vba", "screen-scraping"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 4, "creation_date": 1573062540, "post_id": 58735799, "comment_id": 103761894, "body": "You&#39;re not waiting for the search results to load after you submit the query..."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1573063194, "post_id": 58735799, "comment_id": 103762182, "body": "^^ Also, don&#39;t use sendKeys to submit."}], "owner": {"reputation": 1, "user_id": 6545082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aea89f270b47fed727b3ad3a367eb9a2?s=128&d=identicon&r=PG&f=1", "display_name": "J. Levitt", "link": "https://stackoverflow.com/users/6545082/j-levitt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573065580, "creation_date": 1573062193, "last_edit_date": 1573065580, "question_id": 58735799, "link": "https://stackoverflow.com/questions/58735799/scraping-data-using-html-using-vba-object-variable-or-with-block-variable-not-s", "title": "Scraping Data Using HTML Using VBA- Object Variable or With Block Variable Not Set", "body": "<p>Trying to bing something (don't judge me, Google was a little more difficult to do) and simply create a message box of the first description listed. The key, however, is that I want to directly type something into the search bar and then search it (not simply fill in a string portion of a URL). I was making decent progress, but now cannot get rid of the error (runtime error 91) \"Object Variable or With Block variable not set.\"</p>\n\n<p>Basically, I have called <code>getElementsByClassName</code> on the HTML doc of the searched results, and filled out the class that I want. I know this returns a collection of elements (as the names of the classes of the search results are mostly the same), so I index into the first class it gives me. Then I simply want to print out that HTML by MsgBoxing the innerHtml of that element. However, I end up with the same error above. I have also tried adding, after I have called on <code>getElementsByClassName</code>, a <code>.getElementsByTagName</code> instead of <code>.innerText</code> and end up with the same error. In other words, it seems like every time I use this element variable with another dot method, this error comes up. Not sure how to fix.</p>\n\n<pre><code>Sub test()\n\n    Dim ie As Object\n    Dim element As Object\n    Dim text As String\n\n\n    Set ie = CreateObject(\"InternetExplorer.Application\")\n\n    my_url = \"https://www.bing.com\"\n    ie.Visible = True\n    ie.navigate my_url\n\n    Do While ie.Busy\n            DoEvents\n    Loop\n    Wait 1\n\n    ie.Document.getElementById(\"sb_form_q\").Value = \"123\"\n\n    ' Pressing enter\n    SendKeys \"{ENTER}\"\n\n    Set element = ie.Document.getElementsByClassName(\"b_caption\")(0)\n    MsgBox (element.innerHTML)\nEnd Sub\n</code></pre>\n\n<pre><code>\nSub Wait(seconds As Integer)\n\n    Application.Wait Now + TimeValue(\"00:00:0\" &amp; CStr(seconds))\n\nEnd Sub\n</code></pre>\n\n<p>I simply want a MsgBox of the caption of the first search result on bing. If someone could help, that would be awesome! Clearly I'm somewhat new at webscraping and I am hoping to use the concepts I learn on this project to update a wayy out-of-date system. Thanks!</p>\n"}, {"tags": ["excel", "vba", "selenium"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1573260675, "post_id": 58735778, "comment_id": 103836697, "body": "so the popups don&#39;t appear with python? What do they say? Anything relevant?"}, {"owner": {"reputation": 84, "user_id": 12090086, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDKgbv1I4Un6pxIOgBAN-PZSSbSmQeG7NeYjije=k-s128", "display_name": "Blake Daniel", "link": "https://stackoverflow.com/users/12090086/blake-daniel"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1573487467, "post_id": 58735778, "comment_id": 103888969, "body": "Yeah, the popups appear with both, however it seems I can&#39;t locate the class &quot;popupText&quot; in VBA Selenium. I tried the same code in python and it worked fine yet failed in VBA..."}], "answers": [{"tags": [], "owner": {"reputation": 84, "user_id": 12090086, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDKgbv1I4Un6pxIOgBAN-PZSSbSmQeG7NeYjije=k-s128", "display_name": "Blake Daniel", "link": "https://stackoverflow.com/users/12090086/blake-daniel"}, "is_accepted": false, "score": 0, "last_activity_date": 1573242210, "creation_date": 1573242210, "answer_id": 58772879, "question_id": 58735778, "link": "https://stackoverflow.com/questions/58735778/how-to-grab-innerhtml-with-selenium-vba/58772879#58772879", "title": "How to grab innerHTML with Selenium VBA", "body": "<p>Figured out a workaround to this, it seems like there is an issue with the selenium vba add-in. The workaround:</p>\n\n<pre><code>sel.SwitchToDefaultContent\ninner_text = Right(sel.PageSource, 1000)\n</code></pre>\n\n<p>Instead I grabbed the page_source after switching to default content (the popup text happened to be at the very end of the html) I then continue to check if a popup (4 different pop_up options) is in the inner_text variable. Then continue from there.</p>\n\n<p>The reason I think this is an issue with the VBA Selenium add-in is I replicated the above code with Python and it worked great... so not sure what was going on there. VBA Selenium is dated about 4 years.</p>\n"}], "owner": {"reputation": 84, "user_id": 12090086, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDKgbv1I4Un6pxIOgBAN-PZSSbSmQeG7NeYjije=k-s128", "display_name": "Blake Daniel", "link": "https://stackoverflow.com/users/12090086/blake-daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 219, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1573242210, "creation_date": 1573062102, "last_edit_date": 1573125952, "question_id": 58735778, "link": "https://stackoverflow.com/questions/58735778/how-to-grab-innerhtml-with-selenium-vba", "title": "How to grab innerHTML with Selenium VBA", "body": "<p>I'm trying to grab the innerHTML if a popup comes up while doing a task in chrome and then based on the innerHTML either click okay and save or exit. The problem where I am running into is just before the possible pop-up I am in an iframe and need to switch back to the main body. I'm using selenium:</p>\n\n<pre><code>main body (possible pop_up *i think*)\n   iframe (I am here)\n</code></pre>\n\n<p>Below is some of the code I have, taken out the non-necessary lines:</p>\n\n<pre><code>Dim sel As Selenium.ChromeDriver\nDim pop as Object    \n\nSet sel = New Selenium.ChromeDriver\n\nsel.Get URL\n' Switch to iframe\nSet iframe = sel.FindElementByTag(\"iframe\", 10000)\nsel.SwitchToFrame iframe, 5000\n\ncode...\n\n' Where the popups sometimes show up\nOn Error Resume Next\nsel.SwitchToDefaultContent\nSet pop = sel.FindElementsByClass(\"popupText\", 2000) *Error Could not locate class=popupText\nOn error goto 0\n</code></pre>\n\n<p>I get this error if I turn off on error resume next even if there are popups. Below is the HTML:</p>\n\n<pre><code>&lt;span class=\"popupText\"&gt;\n  &lt;br /&gt;\n  *Text* \n  &lt;br /&gt;\n  &lt;br /&gt;\n  *Text*\n&lt;/span&gt;\n</code></pre>\n\n<p>I've tried a couple of other things: not using switchtodefaultcontent, and using switchtoparenframe and nothing seems to work.</p>\n\n<p>There is also a .SwitchToAlert feature in selenium that is not working either...</p>\n\n<pre><code>strAlert = sel.SwitchToAlert.Text 'Get nothing\nsel.SwitchToAlert.Accept          'Does not do anything\n</code></pre>\n"}, {"tags": ["excel", "vba", "userform"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1573063328, "post_id": 58735750, "comment_id": 103762250, "body": "See <a href=\"https://rubberduckvba.wordpress.com/2018/01/12/progress-indicator/\" rel=\"nofollow noreferrer\">this article</a> (I wrote it)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1573063893, "post_id": 58735750, "comment_id": 103762500, "body": "Does it update if you remove or comment-out the <code>Application.ScreenUpdating = False</code> instruction?"}], "owner": {"reputation": 13, "user_id": 12298513, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-pdTXl8TYloQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfWcZhl9nOARqwPuCRSf3ypGH55Gg/photo.jpg?sz=128", "display_name": "Jorge Jimenez", "link": "https://stackoverflow.com/users/12298513/jorge-jimenez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573063285, "creation_date": 1573062017, "last_edit_date": 1573063285, "question_id": 58735750, "link": "https://stackoverflow.com/questions/58735750/why-progress-bar-not-showing-progress-on-bar", "title": "Why progress bar not showing progress on bar?", "body": "<p>My progress bar is not working, I don't know how to show the progress label </p>\n\n<p>I already tried to modify where the loop finish</p>\n\n<pre><code>Sub ShowUserForm()\n\n    UserForm1.Show\n\nEnd Sub\n\n\n\nSub Main()\n\n    Dim Counter As Integer\n\n    Dim PctDone As Single\n\n    Dim RngToCheck As Range, RngToPaste As Range\n\n    Set RngToCheck = Application.InputBox(Prompt:=\"Enter range\", Type:=8)\n\n    Dim inttofind As String\n\n    inttofind = InputBox(\"Give your indicator\")\n\n\n\n\n\nApplication.ScreenUpdating = False\n\n    Counter = 1\n\n\n\n    Dim i As Long\n\n        For i = RngToCheck.Rows.Count To 1 Step -1\n\n            If RngToCheck(i).Value = inttofind Then\n\n                RngToCheck(i).Offset(1).EntireRow.Insert\n\n                Set RngToPaste = RngToCheck(i).Offset(1)\n\n                CopyAlmostEntireRow RngToCheck(i), RngToPaste\n\n                RngToPaste.EntireRow.Font.Color = RGB(255, 0, 0)\n\n                Counter = Counter + 1\n\n        End If\n\n        Next i\n\n\n\n        PctDone = i / RngToCheck.Rows.Count\n\n\n\n        UpdateProgressBar PctDone\n\n    Unload UserForm1\n\nEnd Sub\n\n\n\nSub UpdateProgressBar(PctDone As Single)\n\n    With UserForm1\n\n\n\n        .FrameProgress.Caption = Format(PctDone, \"0%\")\n\n        .LabelProgress.Width = PctDone * _\n\n            (.FrameProgress.Width - 10)\n\n    End With\n\n\n\n    DoEvents\n\nEnd Sub\n\nSub CopyAlmostEntireRow(FromRow As Range, ToRow As Range)\n\n    Dim FromRange As Range\n\n    Dim ToRange As Range\n\n\n\n    Set FromRange = FromRow.Worksheet.Range(\"A\" &amp; FromRow.Row &amp; \":AR\" &amp; FromRow.Row)\n\n    Set ToRange = ToRow.Worksheet.Range(\"A\" &amp; ToRow.Row &amp; \":AR\" &amp; ToRow.Row)\n\n    ToRange.Value = FromRange.Value\n\n\n\n    Set FromRange = FromRow.Worksheet.Range(\"AV\" &amp; FromRow.Row &amp; \":ED\" &amp; FromRow.Row)\n\n    Set ToRange = ToRow.Worksheet.Range(\"AV\" &amp; ToRow.Row &amp; \":ED\" &amp; ToRow.Row)\n\n    ToRange.Value = FromRange.Value\n\n\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 2, "last_activity_date": 1573062073, "creation_date": 1573062073, "answer_id": 58735771, "question_id": 58735693, "link": "https://stackoverflow.com/questions/58735693/copy-data-from-one-sheet-and-paste-that-data-in-all-worksheets/58735771#58735771", "title": "Copy data from one sheet and paste that data in all worksheets", "body": "<p>You need to loop from <code>3</code> to the <code>Count</code> of the <code>Worksheets</code>, and then use <code>i</code> within the loop. Or maybe that should be <code>4</code>, not sure if I am reading \" 'SAMPLE' is sheet number 1 and after leaving 2 sheets\" correctly.</p>\n\n<pre><code>Sub Copy\n\n    ThisWorkbook.Worksheets(\"SAMPLE\").Range(\"Y1:BA151\").Copy\n\n    Dim i as Long\n    For i = 3 to ThisWorkbook.Worksheets.Count\n         ThisWorkbook.Worksheets(i).Range(\"Y1\").PasteSpecial xlPasteAll\n    Next\n\n    Application.CutCopyMode = False\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 11542140, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTkSASrLazo/AAAAAAAAAAI/AAAAAAAAABQ/pdJs1QIx6OY/photo.jpg?sz=128", "display_name": "Arshit patel", "link": "https://stackoverflow.com/users/11542140/arshit-patel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23, "favorite_count": 0, "accepted_answer_id": 58735771, "answer_count": 1, "score": 1, "last_activity_date": 1573062073, "creation_date": 1573061768, "last_edit_date": 1573061850, "question_id": 58735693, "link": "https://stackoverflow.com/questions/58735693/copy-data-from-one-sheet-and-paste-that-data-in-all-worksheets", "title": "Copy data from one sheet and paste that data in all worksheets", "body": "<p>I have a sheet in which formulas are stored now I want that formulas to be copied and paste in all the other worksheets that I have in my workbook</p>\n\n<p>I have such 70 sheets in which data need to be copied.</p>\n\n<p>sheet name from which data will be copied is \"SAMPLE\"\ndata should be copied from sheet number 3\n(\"SAMPLE\" is sheet number 1 and after leaving 2 sheets, data need to be copy in each sheet in range of \"Y1:BA151\"</p>\n\n<p>I have tried following code</p>\n\n<pre><code>Sub COPY()\n\n Dim WS_Count As Integer\n     Dim I As Integer\n\n\n     WS_Count = ActiveWorkbook.Worksheets.Count\n\n\n     For I = 1 To 70\n\n       Worksheets(\"SAMPLE\").Range(\"Y1:BA151\").COPY\n\n\n\n     Next I\n\n  End Sub\n</code></pre>\n\n<p>but I am begginer so i am lacking somewhere, kindly help with this.\nin advance thx.</p>\n"}, {"tags": ["vba", "ms-access", "ms-access-2007"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 12333230, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-NTfCyV3ZipY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reye05ySvzBr5pyjEiewfG4bYRiYQ/photo.jpg?sz=128", "display_name": "Vedika Naik", "link": "https://stackoverflow.com/users/12333230/vedika-naik"}, "edited": false, "score": 0, "creation_date": 1573131010, "post_id": 58736105, "comment_id": 103786719, "body": "Hi Mike, This creates password to protect code. I am looking for password protect on Design view, where we drag and drop the buttons and text boxes etc."}, {"owner": {"reputation": 126, "user_id": 9335838, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O7emd.png?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9335838/mike"}, "reply_to_user": {"reputation": 11, "user_id": 12333230, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-NTfCyV3ZipY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reye05ySvzBr5pyjEiewfG4bYRiYQ/photo.jpg?sz=128", "display_name": "Vedika Naik", "link": "https://stackoverflow.com/users/12333230/vedika-naik"}, "edited": false, "score": 0, "creation_date": 1618015488, "post_id": 58736105, "comment_id": 118482691, "body": "Convert the .accdb to an .accde which is encrypted internally and forms are non-editable (even by you, so keep the original .accdb for development and release the .accde to your end-users)"}], "tags": [], "owner": {"reputation": 126, "user_id": 9335838, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O7emd.png?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9335838/mike"}, "is_accepted": false, "score": 0, "last_activity_date": 1573063527, "creation_date": 1573063527, "answer_id": 58736105, "question_id": 58735648, "link": "https://stackoverflow.com/questions/58735648/is-it-possible-to-password-protect-design-view-in-ms-access-or-through-code/58736105#58736105", "title": "Is it possible to password protect Design view in MS Access? or through code?", "body": "<p>Open the Access program without a database</p>\n\n<p>Now choose menu File -> Open</p>\n\n<p>In the file open dialog box, bottom right, immediately to the left of the Cancel button, change the \"Open\" dropdown to \"Open Exclusive\"</p>\n\n<p>Hold down the left Shift key so your startup code doesn't run</p>\n\n<p>Now choose your database file, and click Open button (after you have already changed it's dropdown to \"Open Exclusive\")</p>\n\n<p>NOw Click the \"File\" menu from under the Office 2013 ribbon. </p>\n\n<p>There is a very large button that says \"Encrypt with Password\". </p>\n\n<p>Click that and enter your secret database password.</p>\n\n<p>After clicking \"Ok\" button close the database and re-open it.</p>\n\n<p>Now nobody can change the form design (unless they know the password you have set)</p>\n"}], "owner": {"reputation": 11, "user_id": 12333230, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-NTfCyV3ZipY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reye05ySvzBr5pyjEiewfG4bYRiYQ/photo.jpg?sz=128", "display_name": "Vedika Naik", "link": "https://stackoverflow.com/users/12333230/vedika-naik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 634, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573076925, "creation_date": 1573061566, "last_edit_date": 1573076925, "question_id": 58735648, "link": "https://stackoverflow.com/questions/58735648/is-it-possible-to-password-protect-design-view-in-ms-access-or-through-code", "title": "Is it possible to password protect Design view in MS Access? or through code?", "body": "<p>I have searched for similar problems, but haven't got the answer I am looking for. </p>\n\n<p>I am trying to <strong>Disable the Design View</strong> option present in Ribbon Toolbar in MS Access by using <strong>VBA code</strong>, so that users cant access it. I am using MS Access 2007. </p>\n\n<p>I have tried the code provided <a href=\"https://stackoverflow.com/questions/15957315/disabling-design-view-in-ms-access\">here</a>, but that did not work for me.</p>\n\n<p>I have also tried File->options method to remove the Design view from Ribbon. But with this step, user can get back the Design view with little surfing and hence not opting for this solution.</p>\n\n<p>Is there any way to make the Design View <strong>Password Protected</strong> like how we do for code part?</p>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1573061385, "post_id": 58735550, "comment_id": 103761351, "body": "Only a <code>Range</code> object has an address property. Though to be honest I&#39;d use <code>Application.Match</code> here instead of looping. Or you could use <code>Range.Find</code> - and then test the <code>.Address</code> of the result."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1573061595, "post_id": 58735550, "comment_id": 103761456, "body": "A good read: <a href=\"http://www.cpearson.com/excel/ArraysAndRanges.aspx\" rel=\"nofollow noreferrer\">Arrays and Ranges in VBA</a>"}, {"owner": {"reputation": 23, "user_id": 11967249, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBVhOtVceBdYxDqni_dZt6WN-5q5auKk5Nd8eCHjw=k-s128", "display_name": "Crownicus", "link": "https://stackoverflow.com/users/11967249/crownicus"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1573128521, "post_id": 58735550, "comment_id": 103785326, "body": "I&#39;ve managed to do this a different way, by copying the entire row using an incremented row number. It&#39;s less elegant but suitable for this purpose."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 11967249, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBVhOtVceBdYxDqni_dZt6WN-5q5auKk5Nd8eCHjw=k-s128", "display_name": "Crownicus", "link": "https://stackoverflow.com/users/11967249/crownicus"}, "edited": false, "score": 0, "creation_date": 1573128592, "post_id": 58735810, "comment_id": 103785376, "body": "This looks like the neatest solution but I&#39;m struggling to understand the construct of it. Like the &#39;If Not F Is Nothing&#39;, does that mean if the values in the range are not blank?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 23, "user_id": 11967249, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBVhOtVceBdYxDqni_dZt6WN-5q5auKk5Nd8eCHjw=k-s128", "display_name": "Crownicus", "link": "https://stackoverflow.com/users/11967249/crownicus"}, "edited": false, "score": 0, "creation_date": 1573128746, "post_id": 58735810, "comment_id": 103785469, "body": "@Tom no,  that just checks if the <code>Find</code> is successful."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1573142265, "post_id": 58735810, "comment_id": 103793078, "body": "Object-type variables are <code>Nothing</code> if they&#39;re not set to some object - <code>Find()</code> returns <code>Nothing</code> if it doesn&#39;t make a match to a cell in the search range."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 2, "last_activity_date": 1573062222, "creation_date": 1573062222, "answer_id": 58735810, "question_id": 58735550, "link": "https://stackoverflow.com/questions/58735550/getting-the-cell-reference-for-a-cell-thats-found-by-looping-through-an-array/58735810#58735810", "title": "Getting the cell reference for a cell that&#39;s found by looping through an array?", "body": "<p>As BigBen notes you can use <code>Match()</code>:</p>\n\n<pre><code>Dim m\n\nWith Range(\"S2:S10\")\n    m = Application.Match(\"Completed.\",.cells, 0)\n    If Not IsError(m) Then Range(\"A1\").value = .Cells(m).Address \nEnd With\n</code></pre>\n\n<p>or <code>Find()</code>:</p>\n\n<pre><code>Dim f As Range\n\nSet f = Range(\"S2:S10\").Find(\"Completed.\", lookat:=xlWhole)\nIf Not f Is Nothing Then Range(\"A1\").value = f.Address \n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 11967249, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBVhOtVceBdYxDqni_dZt6WN-5q5auKk5Nd8eCHjw=k-s128", "display_name": "Crownicus", "link": "https://stackoverflow.com/users/11967249/crownicus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573062222, "creation_date": 1573061183, "question_id": 58735550, "link": "https://stackoverflow.com/questions/58735550/getting-the-cell-reference-for-a-cell-thats-found-by-looping-through-an-array", "title": "Getting the cell reference for a cell that&#39;s found by looping through an array?", "body": "<p>I'm building a macro that needs to find a row based on the value in one column, then find the start of the data in that row, then cut that information and paste it onto a different sheet. I'm falling at the first hurdle because although I can get my array to loop through the column and find instances of the value, I can't seem to then get the cell reference of the value.</p>\n\n<p>I've tried using the Range.Address function but that gets me a runtime error 424 Object required error. I'm not sure how to get the address. The code has found the value in the array, so it must know where that value is stored. Here's what I have so far</p>\n\n<pre><code>Dim element As Variant\nDim checker As Boolean\nDim elementAddr As String\n\nMyArray = Range(\"S2:S10\").Value2\n\nFor Each element In MyArray\n    If element = \"Completed.\" Then\n    elementAddr = element.Address\n    Worksheets(\"Test\").Range(\"A1\").Value = elementAddr\n    Exit For\n    End If\nNext element\n\nEnd Sub\n</code></pre>\n\n<p>So other than the error when trying to get the reference, the array loop works perfectly. Once the loop has found a cell in the array that says \"Completed.\", how can I then grab the reference of that cell as a string?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1573061196, "post_id": 58735536, "comment_id": 103761260, "body": "Yes, this is possible - but note that SO is not meant to be a code-writing service. Have you tried any of this yourself, even with just taking a stab via the macro recorder?"}, {"owner": {"reputation": 1, "user_id": 10317630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91d48fbd23266e4acc3c0964cd0c9631?s=128&d=identicon&r=PG&f=1", "display_name": "ifreeraom", "link": "https://stackoverflow.com/users/10317630/ifreeraom"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1573063660, "post_id": 58735536, "comment_id": 103762406, "body": "Thank you for the quick response. I have tried with some success. Importing a text file and sperating the extensions out that way. Then using some conditional formatting but it definitely does not come out very clean."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1573063702, "post_id": 58735536, "comment_id": 103762422, "body": "Can you <a href=\"https://stackoverflow.com/posts/58735536/edit\">edit</a> your question with what you have tried, instead of in a comment? Thanks!"}, {"owner": {"reputation": 1, "user_id": 10317630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91d48fbd23266e4acc3c0964cd0c9631?s=128&d=identicon&r=PG&f=1", "display_name": "ifreeraom", "link": "https://stackoverflow.com/users/10317630/ifreeraom"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1573063723, "post_id": 58735536, "comment_id": 103762433, "body": "It is def not my intent to use this as a code writing service. Even a quick example of any of the elements would go a long ways for me. Again thank you for your response."}], "owner": {"reputation": 1, "user_id": 10317630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91d48fbd23266e4acc3c0964cd0c9631?s=128&d=identicon&r=PG&f=1", "display_name": "ifreeraom", "link": "https://stackoverflow.com/users/10317630/ifreeraom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573065669, "creation_date": 1573061138, "last_edit_date": 1573065669, "question_id": 58735536, "link": "https://stackoverflow.com/questions/58735536/indent-specific-cells-in-excel-bold-text-highlight-row-and-move-files-extensio", "title": "Indent specific cells in excel, bold text, highlight row and move files extension to next row", "body": "<p>Is there a way to do the following with VBA and excel - </p>\n\n<p>I have a large number if files names with extensions in column A. There are also folder names that do not contain extensions. </p>\n\n<p>My goal is to have - </p>\n\n<ol>\n<li>The extensions move to the next column</li>\n<li>Indent (add two or three spaces) to the rows in column A that had an extension</li>\n<li>Format the rows that only had folder names (no extensions) to a specific fill color and bold the text</li>\n</ol>\n\n<p>I have tried the following already without VBA - </p>\n\n<ol>\n<li>I open the list in excel from a txt file which allows me separate the extensions into the next column. </li>\n<li>Used conditional formatting to then highlight and bold the rows that do not contain anything in column B now.</li>\n</ol>\n\n<p>I have not found a way to indent though without VBA </p>\n\n<p><a href=\"https://i.stack.imgur.com/9zvQB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9zvQB.png\" alt=\"Example of info in column A\"></a></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 299, "user_id": 4915866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77575943b43a3ad4dbc87592b9f5be9d?s=128&d=identicon&r=PG&f=1", "display_name": "akshay", "link": "https://stackoverflow.com/users/4915866/akshay"}, "edited": false, "score": 0, "creation_date": 1573110719, "post_id": 58742466, "comment_id": 103776186, "body": "Problem is I have an image at the top and it has to scale/bleed full width at the top. But there is a white space at right which is frustrating.."}], "tags": [], "owner": {"reputation": 1205, "user_id": 8578580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a063b2c15a5847791ed1e0007d04b8c0?s=128&d=identicon&r=PG&f=1", "display_name": "TechnoDabbler", "link": "https://stackoverflow.com/users/8578580/technodabbler"}, "is_accepted": false, "score": 1, "last_activity_date": 1573104484, "creation_date": 1573104484, "answer_id": 58742466, "question_id": 58735468, "link": "https://stackoverflow.com/questions/58735468/excel-print-to-pdf-adding-white-spaces-margins-on-right/58742466#58742466", "title": "Excel print to pdf adding white spaces/margins on right?", "body": "<p>One option is to equally balance the white margins on either side of the data using .CenterHorizontally, such as:</p>\n\n<pre><code>Sub generatepdf()\n\n    With ActiveSheet.PageSetup\n        .Zoom = False\n        .FitToPagesTall = False\n        .FitToPagesWide = 1\n        .LeftMargin = Application.CentimetersToPoints(0)\n        .RightMargin = Application.CentimetersToPoints(0)\n        .CenterHorizontally = True\n        .CenterVertically = True\n    End With\n\n    Range(\"b3:j43\").ExportAsFixedFormat xlTypePDF, Filename:=Range(\"c11\").Value &amp; \"-\" &amp; Range(\"c16\").Value, openafterpublish:=True\n\nEnd Sub\n</code></pre>\n\n<p>Another option is, if the data doesn't change width, to use .Zoom and tune the width manually. How I can't see VBA providing access to any finer control than this. Cheers.</p>\n"}], "owner": {"reputation": 299, "user_id": 4915866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77575943b43a3ad4dbc87592b9f5be9d?s=128&d=identicon&r=PG&f=1", "display_name": "akshay", "link": "https://stackoverflow.com/users/4915866/akshay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573125960, "creation_date": 1573060875, "last_edit_date": 1573125960, "question_id": 58735468, "link": "https://stackoverflow.com/questions/58735468/excel-print-to-pdf-adding-white-spaces-margins-on-right", "title": "Excel print to pdf adding white spaces/margins on right?", "body": "<p>I have the following VBA code:</p>\n\n<pre><code>Sub generatepdf()\n\nWith ActiveSheet.PageSetup\n.Zoom = False\n.FitToPagesTall = False\n.FitToPagesWide = 1\n.LeftMargin = Application.CentimetersToPoints(0)\n.RightMargin = Application.CentimetersToPoints(0)\n\nEnd With\n\nRange(\"b3:j43\").ExportAsFixedFormat xlTypePDF, Filename:=Range(\"c11\").value &amp; \"-\" &amp; Range(\"c16\").value, openafterpublish:=True\n\nEnd Sub\n</code></pre>\n\n<p>Whenever I run the code and make pdf, there are white margins on right. Event normal print or save as pdf generating these white spaces.</p>\n\n<p>Tried seetings in page layout and all, still cannot resolve the issue.</p>\n"}, {"tags": ["excel", "vba", "colors"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1573060644, "post_id": 58735401, "comment_id": 103760973, "body": "Use <code>Cells</code> instead of <code>Columns</code>. See <a href=\"https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-excel-with-vba\">this question</a> for how to find the last row so you&#39;re not looping through all rows. Though conditional formatting could handle this coloring."}, {"owner": {"reputation": 45, "user_id": 12333424, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WuumeO7NKyM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc7tRBsFvnibZKl7n2i3XHAxvIXRg/photo.jpg?sz=128", "display_name": "cd3091", "link": "https://stackoverflow.com/users/12333424/cd3091"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1573064032, "post_id": 58735401, "comment_id": 103762570, "body": "Thank you, using Cells helped."}, {"owner": {"reputation": 45, "user_id": 12333424, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WuumeO7NKyM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc7tRBsFvnibZKl7n2i3XHAxvIXRg/photo.jpg?sz=128", "display_name": "cd3091", "link": "https://stackoverflow.com/users/12333424/cd3091"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1573064128, "post_id": 58735401, "comment_id": 103762605, "body": "To make the code simpler, is there a way to combine the 2 if statements and then color them red?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1573064174, "post_id": 58735401, "comment_id": 103762627, "body": "Yes - you could use <code>Or</code>."}, {"owner": {"reputation": 45, "user_id": 12333424, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WuumeO7NKyM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc7tRBsFvnibZKl7n2i3XHAxvIXRg/photo.jpg?sz=128", "display_name": "cd3091", "link": "https://stackoverflow.com/users/12333424/cd3091"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1573064830, "post_id": 58735401, "comment_id": 103762955, "body": "Hi BigBen, can you specify where to put Or? I tried to place in 2 ways but errors occurred."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 12333424, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WuumeO7NKyM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc7tRBsFvnibZKl7n2i3XHAxvIXRg/photo.jpg?sz=128", "display_name": "cd3091", "link": "https://stackoverflow.com/users/12333424/cd3091"}, "edited": false, "score": 0, "creation_date": 1573066848, "post_id": 58736501, "comment_id": 103763849, "body": "Keep getting the syntax error starting the first sentence even with parantheses. I looked into the link, thanks!"}, {"owner": {"reputation": 45, "user_id": 12333424, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WuumeO7NKyM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc7tRBsFvnibZKl7n2i3XHAxvIXRg/photo.jpg?sz=128", "display_name": "cd3091", "link": "https://stackoverflow.com/users/12333424/cd3091"}, "edited": false, "score": 0, "creation_date": 1573067061, "post_id": 58736501, "comment_id": 103763935, "body": "Never mind. No error anymore with a space between Or and _  .. Thank you!"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 45, "user_id": 12333424, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WuumeO7NKyM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc7tRBsFvnibZKl7n2i3XHAxvIXRg/photo.jpg?sz=128", "display_name": "cd3091", "link": "https://stackoverflow.com/users/12333424/cd3091"}, "edited": false, "score": 0, "creation_date": 1573067104, "post_id": 58736501, "comment_id": 103763956, "body": "Yes... that is an important space :)"}, {"owner": {"reputation": 45, "user_id": 12333424, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WuumeO7NKyM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc7tRBsFvnibZKl7n2i3XHAxvIXRg/photo.jpg?sz=128", "display_name": "cd3091", "link": "https://stackoverflow.com/users/12333424/cd3091"}, "edited": false, "score": 0, "creation_date": 1573067292, "post_id": 58736501, "comment_id": 103764028, "body": "Haha, yeah. It&#39;s crazy.. Hope to become better one day like you are."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 45, "user_id": 12333424, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WuumeO7NKyM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc7tRBsFvnibZKl7n2i3XHAxvIXRg/photo.jpg?sz=128", "display_name": "cd3091", "link": "https://stackoverflow.com/users/12333424/cd3091"}, "edited": false, "score": 0, "creation_date": 1573067580, "post_id": 58736501, "comment_id": 103764140, "body": "Ha, flattering :)"}, {"owner": {"reputation": 45, "user_id": 12333424, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WuumeO7NKyM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc7tRBsFvnibZKl7n2i3XHAxvIXRg/photo.jpg?sz=128", "display_name": "cd3091", "link": "https://stackoverflow.com/users/12333424/cd3091"}, "edited": false, "score": 0, "creation_date": 1573136458, "post_id": 58736501, "comment_id": 103789680, "body": "Hi BigBen, I&#39;m trying to find the last row up to where column 1 displays only a number. I used the code in the link that you provided:         If Application.WorksheetFunction.CountA(.Cells) &lt;&gt; 0 Then         lastrow = .Cells.Find(What:=&quot;*&quot;, _             After:=.Range(&quot;A1&quot;), _             Lookat:=xlPart, _             LookIn:=xlFormulas, _             SearchOrder:=xlByRows, _             SearchDirection:=xlPrevious, _             MatchCase:=False).Row     Else         lastrow = 1     End If                                           How do I tweak it to do that? Thanks"}, {"owner": {"reputation": 45, "user_id": 12333424, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WuumeO7NKyM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc7tRBsFvnibZKl7n2i3XHAxvIXRg/photo.jpg?sz=128", "display_name": "cd3091", "link": "https://stackoverflow.com/users/12333424/cd3091"}, "edited": false, "score": 0, "creation_date": 1573136620, "post_id": 58736501, "comment_id": 103789787, "body": "So that it doesn&#39;t color the rows whose column 1 has non numeric characters. Also, let me know if I&#39;m breaking any rules in the website."}, {"owner": {"reputation": 45, "user_id": 12333424, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WuumeO7NKyM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc7tRBsFvnibZKl7n2i3XHAxvIXRg/photo.jpg?sz=128", "display_name": "cd3091", "link": "https://stackoverflow.com/users/12333424/cd3091"}, "edited": false, "score": 0, "creation_date": 1573136945, "post_id": 58736501, "comment_id": 103789979, "body": "Got it. Will do."}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 2, "last_activity_date": 1573065164, "creation_date": 1573065164, "answer_id": 58736501, "question_id": 58735401, "link": "https://stackoverflow.com/questions/58735401/fixing-a-simple-vba-code-with-if-statements-to-color-columns/58736501#58736501", "title": "Fixing a simple VBA code with if statements to color columns", "body": "<p>You want to check the <code>.Value</code> of each individual cell.</p>\n\n<p>Thus,</p>\n\n<pre><code>If Not IsEmpty(Columns(\"AB\").Value) And Not IsEmpty(Columns(\"CD\").Value)\n</code></pre>\n\n<p>becomes</p>\n\n<pre><code>If Not IsEmpty(Cells(i, \"AB\").Value) And Not IsEmpty(Cells(i, \"CD\").Value)\n</code></pre>\n\n<p>and similarly for </p>\n\n<pre><code>If Not IsEmpty(Columns(\"PQ\").Value) And Not IsEmpty(Columns(\"RS\").Value)\n</code></pre>\n\n<hr>\n\n<p>You could combine the <code>If</code> statements (though I'm not sure it helps with readability). Use parentheses to enclose each condition:</p>\n\n<pre><code>If (Not IsEmpty(Cells(i, \"AB\").Value) And Not IsEmpty(Cells(i, \"CD\").Value)) Or _\n   (Not IsEmpty(Cells(i, \"PQ\").Value) And Not IsEmpty(Cells(i, \"RS\").Value)) Then\n</code></pre>\n\n<p>More important would be to find the last row and loop to that instead of through all the rows. See <a href=\"https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-excel-with-vba\">this question</a> for how to do that.</p>\n"}, {"comments": [{"owner": {"reputation": 45, "user_id": 12333424, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WuumeO7NKyM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc7tRBsFvnibZKl7n2i3XHAxvIXRg/photo.jpg?sz=128", "display_name": "cd3091", "link": "https://stackoverflow.com/users/12333424/cd3091"}, "edited": false, "score": 0, "creation_date": 1573066307, "post_id": 58736554, "comment_id": 103763615, "body": "I&#39;m trying to combine statements in If and color the cells, so that I don&#39;t have to write for coloring after each if statements."}], "tags": [], "owner": {"reputation": 1633, "user_id": 12001122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ec161ec6ec2ddb3c5ea5989f03fe053?s=128&d=identicon&r=PG&f=1", "display_name": "Jonas", "link": "https://stackoverflow.com/users/12001122/jonas"}, "is_accepted": false, "score": 0, "last_activity_date": 1573065389, "creation_date": 1573065389, "answer_id": 58736554, "question_id": 58735401, "link": "https://stackoverflow.com/questions/58735401/fixing-a-simple-vba-code-with-if-statements-to-color-columns/58736554#58736554", "title": "Fixing a simple VBA code with if statements to color columns", "body": "<p>If I got your question right, this would be an approach to compare the cells in the same row and colour them red if they contain the same value:</p>\n\n<pre><code>Option Explicit\n\nSub ColorCol()\n\nDim i As Long\n\nFor i = 2 To 6\n\n    If Cells(i, 2).Value = Cells(i, 3).Value Then\n       Cells(i, 2).Interior.Color = vbRed\n       Cells(i, 3).Interior.Color = vbRed\n    End If\n\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 12333424, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WuumeO7NKyM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc7tRBsFvnibZKl7n2i3XHAxvIXRg/photo.jpg?sz=128", "display_name": "cd3091", "link": "https://stackoverflow.com/users/12333424/cd3091"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 58736501, "answer_count": 2, "score": 0, "last_activity_date": 1573065389, "creation_date": 1573060591, "last_edit_date": 1573060697, "question_id": 58735401, "link": "https://stackoverflow.com/questions/58735401/fixing-a-simple-vba-code-with-if-statements-to-color-columns", "title": "Fixing a simple VBA code with if statements to color columns", "body": "<p>this is my first time posting. I want to fix a code to color the columns correctly, and also to make the code simpler. Really appreciate your feedbacks.</p>\n\n<p>This is for Excel VBA. Color is coded for the whole columns regardless of if statements.</p>\n\n<p>No error message but the code colors the 2 whole columns red when I want them red if both the 2 corresponding cells in a row have the value.</p>\n\n<pre><code>Sub ColorCol()\n\nDim i As Long\n\nFor i = 2 To Rows.Count\n\n    If Not IsEmpty(Columns(\"AB\").Value) And Not IsEmpty(Columns(\"CD\").Value) Then\n        Cells(i, 2).Interior.Color = vbRed\n        Cells(i, 3).Interior.Color = vbRed\n    End If\n    If Not IsEmpty(Columns(\"PQ\").Value) And Not IsEmpty(Columns(\"RS\").Value) Then\n        Cells(i, 2).Interior.Color = vbRed\n        Cells(i, 3).Interior.Color = vbRed\n    End If\n\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1573060591, "post_id": 58735220, "comment_id": 103760945, "body": "Search for and rename Normal.dotm so that Word will generate a new, default Normal.dotm, then see if the problem goes away..."}, {"owner": {"reputation": 23, "user_id": 7474963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69acdcd6ad49cee240cd55dd9985d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/7474963/james"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1574285056, "post_id": 58735220, "comment_id": 104182270, "body": "I deleted the .dotm and I&#39;ve waited quite a while with no further occurrences of the issue, looks like that solved it - thank you!"}], "owner": {"reputation": 23, "user_id": 7474963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69acdcd6ad49cee240cd55dd9985d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/7474963/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573060540, "creation_date": 1573059906, "last_edit_date": 1573060540, "question_id": 58735220, "link": "https://stackoverflow.com/questions/58735220/word-macro-enabled-document-corruption-issue", "title": "Word Macro Enabled Document Corruption Issue", "body": "<p>I'm having a quite puzzling issue with a Word VBA Application I'm developing for my employer and I'm hoping someone has experienced this issue and knows of a solution as I can't find a cause anywhere.</p>\n\n<p>Approximately every other day that I work on the document (.docm) I save my changes prior to closing the document and when I come back to the file it will not open.  I get stuck on the loading screen and the application hangs.</p>\n\n<p>The only solution I've identified is opening word (not the document) in Safe Mode, closing; and asking a colleague to open the file, save it under a new document name, and send it back to me.  </p>\n\n<p>Rebooting doesn't fix the issue and the original file seems to be permanently corrupted for me even though my colleague can open the file.  I've also tried deleting word's document cache in the Microsoft Upload Center to no avail and if I don't follow the exact order of opening word in safe mode on it's own prior to opening the replacement file my colleague sends me the replacement file will not open either and I have to start the process again with a second new file from my colleague.</p>\n\n<p>This happens about 2-3 times a week, thank you in advance!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "edited": false, "score": 0, "creation_date": 1573058888, "post_id": 58734651, "comment_id": 103760015, "body": "So did you already remove the shortcut to the macro?"}], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 3708012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39b03c60a6751d4b014d1b6d4cc7f5?s=128&d=identicon&r=PG&f=1", "display_name": "Ghislain", "link": "https://stackoverflow.com/users/3708012/ghislain"}, "is_accepted": true, "score": 0, "last_activity_date": 1573059263, "creation_date": 1573059263, "answer_id": 58735037, "question_id": 58734651, "link": "https://stackoverflow.com/questions/58734651/reset-macro-onkey-assignment-to-default-does-not-work-for-recorded-macros/58735037#58735037", "title": "Reset Macro OnKey-Assignment to Default does not work for Recorded Macros", "body": "<p>In the macro list menu available from your Developer Ribbon tab, select your corresponding macro, then <code>Option...</code> and delete the shortcut you set.</p>\n"}, {"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 0, "last_activity_date": 1573061705, "last_edit_date": 1573061705, "creation_date": 1573060687, "answer_id": 58735422, "question_id": 58734651, "link": "https://stackoverflow.com/questions/58734651/reset-macro-onkey-assignment-to-default-does-not-work-for-recorded-macros/58735422#58735422", "title": "Reset Macro OnKey-Assignment to Default does not work for Recorded Macros", "body": "<p>The macro recorder always includes a hidden member attribute for the assigned hotkey, and there's nothing in the IDE to modify or otherwise manipulate it. You could export the code file, edit it (remove the hidden <code>Attribute</code> line), and re-import it into your VBA project... but that's quite a pain in the neck.</p>\n\n<p>Get <a href=\"http://rubberduckvba.com\" rel=\"nofollow noreferrer\">Rubberduck</a> (free, open-source VBIDE add-in project that I manage), and then you can do this:</p>\n\n<pre><code>'@ExcelHotkey(\"y\")\nPublic Sub MyAwesomeMacro()\n    'do stuff...\nEnd Sub\n</code></pre>\n\n<p>That annotation/comment can then be turned into the very same hidden member attribute Excel uses when you record macros and assign a hotkey (via static code analysis; see <a href=\"https://stackoverflow.com/a/58600561/1188513\">this post</a> for all the details).</p>\n\n<p>The lowecase \"y\" is what makes the hotkey Ctrl+y. If you want the hotkey to be Ctrl+Shift+y, simply make it a capital \"Y\":</p>\n\n<pre><code>'@ExcelHotkey(\"Y\")\nPublic Sub MyAwesomeMacro()\n    'do stuff...\nEnd Sub\n</code></pre>\n\n<p>The advantages of this approach are numerous:</p>\n\n<ul>\n<li>No obscure hidden member attributes to manipulate.</li>\n<li>No need to export/edit/import anything.</li>\n<li>Obscure hidden member attributes are surfaced/documented.</li>\n<li>No need for any <code>Application.OnKey</code> hack.</li>\n<li>You get an inspection result whenever attributes &amp; annotations disagree, and you get to synchronize the values with a single click.</li>\n</ul>\n\n<p>If all you want is to remove the hotkey attribute, then simply run code inspections; Rubberduck will tell you when there's a hidden attribute without a corresponding annotation comment, and you can then decide whether to remove the attribute or add a corresponding annotation comment.</p>\n\n<hr>\n\n<p><sub>Note: the feature will work perfectly fine for OP's needs (<em>removing</em> the hidden attribute), but a <a href=\"https://github.com/rubberduck-vba/Rubberduck/issues/5268\" rel=\"nofollow noreferrer\">regression bug was filed</a>, since <em>adding</em> the hidden attribute is broken in v2.4.1.5170.</sub></p>\n"}], "owner": {"reputation": 13, "user_id": 4196260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be8d00cf2b4a68101375d4f462c6b1c2?s=128&d=identicon&r=PG&f=1", "display_name": "luke", "link": "https://stackoverflow.com/users/4196260/luke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "accepted_answer_id": 58735037, "answer_count": 2, "score": 0, "last_activity_date": 1573061705, "creation_date": 1573057807, "last_edit_date": 1573057889, "question_id": 58734651, "link": "https://stackoverflow.com/questions/58734651/reset-macro-onkey-assignment-to-default-does-not-work-for-recorded-macros", "title": "Reset Macro OnKey-Assignment to Default does not work for Recorded Macros", "body": "<p>In Excel 2016, a few days ago, by mistake I assigned a macro to Ctrl+y in the Macro-Recorder window.</p>\n\n<p>Now, I would like to reset Ctrl+y to its default behaviour.</p>\n\n<p>For this I found the following code:</p>\n\n<pre><code>Sub keys_deleteHotKeys()\n   ' https://www.excelcampus.com/vba/keyboard-shortcut-run-macro/\n    Application.OnKey \"^y\", \"\"\n    Call Application.OnKey(\"^y\")\nEnd Sub\n</code></pre>\n\n<p>Unfortunately, the above Sub has no effect.</p>\n\n<p>Does excel follow a different way of handling macro to key assignments when done in the Macro Recorder window as compared to a VBA <code>Application.OnKey</code> assignment?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1573058390, "post_id": 58734630, "comment_id": 103759686, "body": "I&#39;m surprised your code runs as is. Where <code>wb2ws</code> is a string, it cannot have a Range property <code>wb2ws.Range(\u2026</code> should --&gt; error.  Do you have error checking disabled?  Also, the reason you state is not a reason to need a column letter. Just use the column number."}, {"owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "edited": false, "score": 0, "creation_date": 1573058490, "post_id": 58734630, "comment_id": 103759760, "body": "Your assignment of <code>wb2ws</code> doesn&#39;t work. You need to declare it as an object <code>Dim wb2ws As Worksheet</code> and then assign it properly with a <code>Set</code> statement <code>Set wb2ws = ThisWorkbook.Sheet2 &#39;replace with your desired worksheet</code>"}, {"owner": {"reputation": 559, "user_id": 2008785, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/293283bdafd5f34db8eb38a26d101c5f?s=128&d=identicon&r=PG", "display_name": "Kamui", "link": "https://stackoverflow.com/users/2008785/kamui"}, "edited": false, "score": 0, "creation_date": 1573058580, "post_id": 58734630, "comment_id": 103759815, "body": "Sorry, I was retyping the code and left out the reference where I set wb2ws = wb2.Worksheets where wb2 is the name of my other workbook."}, {"owner": {"reputation": 559, "user_id": 2008785, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/293283bdafd5f34db8eb38a26d101c5f?s=128&d=identicon&r=PG", "display_name": "Kamui", "link": "https://stackoverflow.com/users/2008785/kamui"}, "edited": false, "score": 0, "creation_date": 1573058658, "post_id": 58734630, "comment_id": 103759854, "body": "I&#39;ve never touched error checking so I don&#39;t know how to tell if it&#39;s disabled or not."}, {"owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "edited": false, "score": 0, "creation_date": 1573058789, "post_id": 58734630, "comment_id": 103759949, "body": "Try to <code>Debug.Print</code> or <code>MsgBox</code> <code>wb2wsrange.Address</code> to get to the bottom of this. The problem is most likely finding the correct range"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1573058842, "post_id": 58734630, "comment_id": 103759991, "body": "To reiterate a previous comment, there is no need for a column letter. Column numbers work quite well in <code>Cells</code> or <code>Columns</code> calls. Even better, work with the <code>Range</code> object that is the result of <code>Find</code> - though test that <code>Find</code> is successful first, otherwise the range will be <code>Nothing</code>."}, {"owner": {"reputation": 559, "user_id": 2008785, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/293283bdafd5f34db8eb38a26d101c5f?s=128&d=identicon&r=PG", "display_name": "Kamui", "link": "https://stackoverflow.com/users/2008785/kamui"}, "edited": false, "score": 0, "creation_date": 1573059132, "post_id": 58734630, "comment_id": 103760150, "body": "I tried the MsgBox wb2wsrange.Address and it always returns $A$10 - but the &quot;Date&quot; is not always in this cell. It returns this even if the &quot;Date&quot; is in $B$10. Why is this?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1573066170, "post_id": 58734630, "comment_id": 103763555, "body": "<code>wb2ws = wb2.Worksheets(&quot;Name of Desired Worksheet in Separate Workbook&quot;)</code> should still be returning an error, unless you have error checking turned off. Usually better to copy/paste code, so we can all start with the same data.  Retyping frequently results in transcription errors."}, {"owner": {"reputation": 559, "user_id": 2008785, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/293283bdafd5f34db8eb38a26d101c5f?s=128&d=identicon&r=PG", "display_name": "Kamui", "link": "https://stackoverflow.com/users/2008785/kamui"}, "edited": false, "score": 0, "creation_date": 1573066640, "post_id": 58734630, "comment_id": 103763756, "body": "Why would it return an error? The goal of wb2ws is to indicate what worksheet in another workbook I am working in. I have a larger loop that will change this value based on what sheet I&#39;m currently in."}, {"owner": {"reputation": 559, "user_id": 2008785, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/293283bdafd5f34db8eb38a26d101c5f?s=128&d=identicon&r=PG", "display_name": "Kamui", "link": "https://stackoverflow.com/users/2008785/kamui"}, "edited": false, "score": 0, "creation_date": 1573067382, "post_id": 58734630, "comment_id": 103764065, "body": "I think the issue is somehow caused by the fact that the match value I&#39;m using is &quot;Date&quot;. When I use any other string it matches to the correct column.   When I try to find the column associated with the &quot;Date&quot; string, I always get the first one. Thoughts?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1573067391, "post_id": 58734630, "comment_id": 103764071, "body": "You have declared it as a <code>Worksheet</code>.  It is an object and must be <code>Set</code>, else you will get a <code>91</code> error."}, {"owner": {"reputation": 559, "user_id": 2008785, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/293283bdafd5f34db8eb38a26d101c5f?s=128&d=identicon&r=PG", "display_name": "Kamui", "link": "https://stackoverflow.com/users/2008785/kamui"}, "edited": false, "score": 0, "creation_date": 1573067743, "post_id": 58734630, "comment_id": 103764210, "body": "OK I added the Set notation. But I think I found the issue: When I use &quot;Date&quot; as my match value I always get &quot;1&quot;, but if I use any other string e.g. &quot;SKU&quot; then I get the correct column reference. But &quot;Date&quot; does not always appear in column 1 in each sheet, so I&#39;m really confused by this. I checked and the cells in column 1 are always formatted as &quot;General&quot; - could this be an issue? Like somehow VBA thinks there is a match because General could signify a Date format?? Even though I am searching for a Date string?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1573068041, "post_id": 58734630, "comment_id": 103764328, "body": "Because your code was not returning an error before you added the <code>Set</code> keyword, I suspect there is something else going on either with your data or your code.  And no, <code>.Find(What:=&quot;Date&quot;, \u2026</code> will not be triggered by anything other than &quot;Date&quot; in the cell. You haven&#39;t created merged cells, have you?"}, {"owner": {"reputation": 559, "user_id": 2008785, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/293283bdafd5f34db8eb38a26d101c5f?s=128&d=identicon&r=PG", "display_name": "Kamui", "link": "https://stackoverflow.com/users/2008785/kamui"}, "edited": false, "score": 0, "creation_date": 1573068111, "post_id": 58734630, "comment_id": 103764359, "body": "No merged cells ):. But I find it really odd that searching for &quot;Date&quot; doesn&#39;t work while searching for any other string produces the correct results."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 559, "user_id": 2008785, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/293283bdafd5f34db8eb38a26d101c5f?s=128&d=identicon&r=PG", "display_name": "Kamui", "link": "https://stackoverflow.com/users/2008785/kamui"}, "edited": false, "score": 0, "creation_date": 1573068202, "post_id": 58734630, "comment_id": 103764393, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/201964/discussion-between-ron-rosenfeld-and-kamui\">continue this discussion in chat</a>."}], "answers": [{"comments": [{"owner": {"reputation": 559, "user_id": 2008785, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/293283bdafd5f34db8eb38a26d101c5f?s=128&d=identicon&r=PG", "display_name": "Kamui", "link": "https://stackoverflow.com/users/2008785/kamui"}, "edited": false, "score": 0, "creation_date": 1573060693, "post_id": 58735188, "comment_id": 103760999, "body": "I tried: wb2wsdatecolnum = Application.Match(&quot;Date&quot;, wb2ws.Range(&quot;A10:C11&quot;), 0), but I get an empty result even though &quot;Date&quot; is in the range I specified. :("}, {"owner": {"reputation": 61, "user_id": 3708012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39b03c60a6751d4b014d1b6d4cc7f5?s=128&d=identicon&r=PG&f=1", "display_name": "Ghislain", "link": "https://stackoverflow.com/users/3708012/ghislain"}, "reply_to_user": {"reputation": 559, "user_id": 2008785, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/293283bdafd5f34db8eb38a26d101c5f?s=128&d=identicon&r=PG", "display_name": "Kamui", "link": "https://stackoverflow.com/users/2008785/kamui"}, "edited": false, "score": 0, "creation_date": 1573115017, "post_id": 58735188, "comment_id": 103778165, "body": "<code>Dim wb2wsdatecolnum As Double</code>"}], "tags": [], "owner": {"reputation": 61, "user_id": 3708012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39b03c60a6751d4b014d1b6d4cc7f5?s=128&d=identicon&r=PG&f=1", "display_name": "Ghislain", "link": "https://stackoverflow.com/users/3708012/ghislain"}, "is_accepted": false, "score": 0, "last_activity_date": 1573059806, "creation_date": 1573059806, "answer_id": 58735188, "question_id": 58734630, "link": "https://stackoverflow.com/questions/58734630/return-column-letter-associated-with-match-in-range/58735188#58735188", "title": "Return Column Letter Associated with Match In Range", "body": "<p><code>Find</code> returns a <code>Range</code> including the cells where \"Date\" is found. So it will return one cell (A3 or D6).</p>\n\n<p><code>Application.Match</code> seem more appropriate to your need.</p>\n"}], "owner": {"reputation": 559, "user_id": 2008785, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/293283bdafd5f34db8eb38a26d101c5f?s=128&d=identicon&r=PG", "display_name": "Kamui", "link": "https://stackoverflow.com/users/2008785/kamui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573067583, "creation_date": 1573057751, "last_edit_date": 1573067583, "question_id": 58734630, "link": "https://stackoverflow.com/questions/58734630/return-column-letter-associated-with-match-in-range", "title": "Return Column Letter Associated with Match In Range", "body": "<p>I am using VBA to create a macro to automate the creation of an import sheet into a system.</p>\n\n<p>I need to pull in a date value from a separate workbook that is open, which has multiple tabs. Each tab has the date listed in a different row or column, which will always be somewhere in the range A10:C11. </p>\n\n<p>I basically want to find the column letter that the \"Date\" falls under so I can iterate over all rows in this column at a later point.</p>\n\n<p>So I try to do this:</p>\n\n<pre><code>Dim wb2 As Workbook\nSet wb2 = Workbooks(\"Workbook Name.xlsx\")\nDim wb2ws As Worksheet\nDim wb2wsrange As Range\nDim wb2wsdatecolnum As Long\nDim wb2wsdatecollet As String\n\nSet wb2ws = wb2.Worksheets(\"Name of Desired Worksheet in Separate Workbook\")\nSet wb2wsrange = wb2ws.Range(\"A10:C11\").Find(What:=\"Date\", LookIn:=xlValues, \nLookAt:=xlWhole)\nwb2wsdatecolnum = wb2wsrange.Column\nwb2wsdatecollet = Split(wb2ws.Cells(1, wb2wsdatecolnum).Address, \"$\")(1)\n</code></pre>\n\n<p>Where I referenced finding the column letter from here:\n<a href=\"https://www.thespreadsheetguru.com/the-code-vault/vba-code-to-convert-column-number-to-letter-or-letter-to-number\" rel=\"nofollow noreferrer\">https://www.thespreadsheetguru.com/the-code-vault/vba-code-to-convert-column-number-to-letter-or-letter-to-number</a></p>\n\n<p>The problem is: wb2wsdatecolnum always returns \"1\" even if the \"Date\" value falls in column B or C. I don't know why. This in turn causes wb2wsdatecollet to return \"A\" even when it should be \"B\" or \"C\".</p>\n\n<p>Any thoughts why this is happening?</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1573061009, "post_id": 58734561, "comment_id": 103761152, "body": "Why are you adding &quot;&lt;PLACEHOLER&gt;&quot; to the text that replaces? The document doesn&#39;t contain these? There would certainly be a better way to code this if that&#39;s the case..."}, {"owner": {"reputation": 2142, "user_id": 3308951, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iUOnA.png?s=128&g=1", "display_name": "SyntaxVoid supports Monica", "link": "https://stackoverflow.com/users/3308951/syntaxvoid-supports-monica"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1573061312, "post_id": 58734561, "comment_id": 103761315, "body": "@CindyMeister, I add <code>&lt;PLACEHOLDER&gt;</code> after every replace so the <i>next</i> find-and-replace will be able to &quot;find&quot; it and know where to insert the text. It&#39;s replaced each time, and the final one is replaced with a new line (<code>chr(11)</code>) which is why no <code>&lt;PLACEHOLDER&gt;</code>s appear in the final document. This is the approach I came up with, but I&#39;m not very familiar with vba so there probably is a better way"}], "answers": [{"comments": [{"owner": {"reputation": 2142, "user_id": 3308951, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iUOnA.png?s=128&g=1", "display_name": "SyntaxVoid supports Monica", "link": "https://stackoverflow.com/users/3308951/syntaxvoid-supports-monica"}, "edited": false, "score": 0, "creation_date": 1573059662, "post_id": 58734773, "comment_id": 103760441, "body": "Unfortunately, this still results in the styles all being merged to whatever the final style is."}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1573060823, "post_id": 58734773, "comment_id": 103761059, "body": "You need Chr(13)"}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1573061103, "post_id": 58734773, "comment_id": 103761209, "body": "@CindyMeister Whoops.  Read that as vbCrLf."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1573062268, "post_id": 58734773, "comment_id": 103761775, "body": "@Freeflow No, Word doesn&#39;t not recognize that correctly. That&#39;s Chr(13) &amp; Chr(10) and Word does NOT use Chr(10) for anything."}, {"owner": {"reputation": 3865, "user_id": 5211752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9hLRL.png?s=128&g=1", "display_name": "Timothy Rylatt", "link": "https://stackoverflow.com/users/5211752/timothy-rylatt"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1573066659, "post_id": 58734773, "comment_id": 103763763, "body": "@CindyMeister actually changing Chr(11) to vbCr works perfectly. I tested my answer before posting. Whether it is supposed to work is another matter."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1573066819, "post_id": 58734773, "comment_id": 103763835, "body": "@TimothyRylatt Well, I tested the original code with both vbCr as well as Chr(13) and saw exactly the same behavior as the OP described - the styles applied to the entire document. Perhaps it&#39;s related to the version(s) of Word we&#39;re using..."}, {"owner": {"reputation": 3865, "user_id": 5211752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9hLRL.png?s=128&g=1", "display_name": "Timothy Rylatt", "link": "https://stackoverflow.com/users/5211752/timothy-rylatt"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1573066866, "post_id": 58734773, "comment_id": 103763855, "body": "@CindyMeister I\u2019m using O365."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 2142, "user_id": 3308951, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iUOnA.png?s=128&g=1", "display_name": "SyntaxVoid supports Monica", "link": "https://stackoverflow.com/users/3308951/syntaxvoid-supports-monica"}, "edited": false, "score": 0, "creation_date": 1573067059, "post_id": 58734773, "comment_id": 103763934, "body": "I tested in Word 2010. No idea what @SyntaxVoid is using?"}, {"owner": {"reputation": 2142, "user_id": 3308951, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iUOnA.png?s=128&g=1", "display_name": "SyntaxVoid supports Monica", "link": "https://stackoverflow.com/users/3308951/syntaxvoid-supports-monica"}, "edited": false, "score": 0, "creation_date": 1573067321, "post_id": 58734773, "comment_id": 103764044, "body": "My word version is Word 2016 MSO 16.0.4738.1000 - 64 bit."}, {"owner": {"reputation": 3865, "user_id": 5211752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9hLRL.png?s=128&g=1", "display_name": "Timothy Rylatt", "link": "https://stackoverflow.com/users/5211752/timothy-rylatt"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1573069482, "post_id": 58734773, "comment_id": 103764909, "body": "@CindyMeister interesting. In 30 years of working with VBA and Word I&#39;ve never known Word to not convert vbCr correctly when used in a string."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1573076514, "post_id": 58734773, "comment_id": 103767688, "body": "I can&#39;t recall it, either. But I also can&#39;t remember using a paragraph as part of literal replacement text. OTOH, I also can&#39;t remember every bit of code I&#39;ve used... :-) But I do have vague memories of a discussion around this or a very similar point, where ^p was required - just no details."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1573309577, "post_id": 58734773, "comment_id": 103844505, "body": "@yokki and all: I&#39;ve updated my answer to include the information of our version research in this discussion."}], "tags": [], "owner": {"reputation": 3865, "user_id": 5211752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9hLRL.png?s=128&g=1", "display_name": "Timothy Rylatt", "link": "https://stackoverflow.com/users/5211752/timothy-rylatt"}, "is_accepted": false, "score": 0, "last_activity_date": 1573058227, "creation_date": 1573058227, "answer_id": 58734773, "question_id": 58734561, "link": "https://stackoverflow.com/questions/58734561/finding-and-replacing-with-vba-for-word-overwrites-previous-style/58734773#58734773", "title": "Finding and Replacing with VBA for Word overwrites previous style", "body": "<p>The problem is caused by your use of <code>Chr(11)</code> which is a manual line break. This results in all of the text being in a single paragraph. When the paragraph style is applied it applies to the entire paragraph.</p>\n\n<p>Replace <code>Chr(11)</code> with <code>vbCr</code> to ensure that each piece of text is in a separate paragraph.</p>\n"}, {"comments": [{"owner": {"reputation": 2142, "user_id": 3308951, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iUOnA.png?s=128&g=1", "display_name": "SyntaxVoid supports Monica", "link": "https://stackoverflow.com/users/3308951/syntaxvoid-supports-monica"}, "edited": false, "score": 0, "creation_date": 1573066912, "post_id": 58736665, "comment_id": 103763879, "body": "A very descriptive answer! I had no idea about the <code>&quot;^p&quot;</code> character. Both of your solutions works nicely and I will be using the range method~"}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 1, "last_activity_date": 1573309524, "last_edit_date": 1573309524, "creation_date": 1573065918, "answer_id": 58736665, "question_id": 58734561, "link": "https://stackoverflow.com/questions/58734561/finding-and-replacing-with-vba-for-word-overwrites-previous-style/58736665#58736665", "title": "Finding and Replacing with VBA for Word overwrites previous style", "body": "<p><strong>Update</strong> from discussion in comments on another answer. The problem described below applies to Word 2016 and earlier. Starting in <strong><em>Office 365</em></strong> (and probably Word 2019, but that's not been confirmed) the <code>Replace</code> behavior has been changed to \"convert\" ANSI 13 to a \"real\" paragraph mark, so the problem in the question would not occur.</p>\n\n<p><strong>Answer</strong></p>\n\n<p>The reason for the odd formatting behavior is the use of <code>Chr(11)</code>, which inserts a new line (Shift + Enter) instead of a new paragraph. So a paragraph style applied to any part of this text formats the entire text with the same style.</p>\n\n<p>In this particular case (working with <code>Replace</code>), <code>vbCr</code> or the equivalent <code>Chr(13)</code> also don't work because these are not really Word's native paragraph. A paragraph is much more than just ANSI code 13 - it contains paragraph formatting information. So, while the code is running, Word is not really recognizing these as true paragraph marks and the paragraph style assignment is being applied to \"everything\".</p>\n\n<p>What does work is to use the string <code>^p</code>, which in Word's Find/Replace is the \"alias\" for a complete paragraph mark. So, for example:</p>\n\n<pre><code>replace_stuff \"&lt;PLACEHOLDER&gt;\", section_names(i) &amp; \"^p\" &amp; \"&lt;PLACEHOLDER&gt;\", wdStyleHeading2\nreplace_stuff \"&lt;PLACEHOLDER&gt;\", section_bodies(i) &amp; \"^p\" &amp; \"&lt;PLACEHOLDER&gt;\", wdStyleNormal\n</code></pre>\n\n<p>There is, however, a more efficient way to build a document than inserting a placeholder for each new item and using Find/Replace to replace the placeholder with the document content. The more conventional approach is to work with a <code>Range</code> object (think of it like an invisible selection)...</p>\n\n<p>Assign content to the <code>Range</code>, format it, collapse (like pressing right-arrow for a selection) and repeat. Here's an example that returns the same result as the (corrected) code in the question:</p>\n\n<pre><code>Sub main()\n  Dim rng As Range\n\n  Set rng = ActiveDocument.content\n  Dim section_names(2) As String\n  section_names(0) = \"Introduction\"\n  section_names(1) = \"Background\"\n  section_names(2) = \"Conclusion\"\n\n  Dim section_bodies(2) As String\n  section_bodies(0) = \"This is the body text for the introduction! Fetched from some file.\"\n  section_bodies(1) = \"And Background... I have no issue fetching data from the files.\"\n  section_bodies(2) = \"And for the conclusion... But I want the styles to 'stick'!\"\n\n  Dim i As Integer\n  For i = 0 To 2\n    BuildParagraph section_names(i), wdStyleHeading2, rng\n    BuildParagraph section_bodies(i), wdStyleNormal, rng\n  Next i\nEnd Sub\n\nSub BuildParagraph(para_text As String, para_style As Long, rng As Range)\n        rng.Text = para_text\n        rng.style = para_style\n        rng.InsertParagraphAfter\n        rng.Collapse wdCollapseEnd\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2142, "user_id": 3308951, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iUOnA.png?s=128&g=1", "display_name": "SyntaxVoid supports Monica", "link": "https://stackoverflow.com/users/3308951/syntaxvoid-supports-monica"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 412, "favorite_count": 0, "accepted_answer_id": 58736665, "answer_count": 2, "score": 0, "last_activity_date": 1573309524, "creation_date": 1573057470, "last_edit_date": 1573057588, "question_id": 58734561, "link": "https://stackoverflow.com/questions/58734561/finding-and-replacing-with-vba-for-word-overwrites-previous-style", "title": "Finding and Replacing with VBA for Word overwrites previous style", "body": "<p>I'm writing a VBA script to generate word documents from an already defined template. In it, I need to be able to write headings along with a body for each heading. As a small example, I have a word document that contains only <code>&lt;PLACEHOLDER&gt;</code>. For each heading and body I need to write, I use the find-and-replace feature in VBA to find <code>&lt;PLACEHOLDER&gt;</code> and replace it with the heading name, a newline, and then <code>&lt;PLACEHOLDER&gt;</code> again. This is repeated until each heading name and body is written and then the final <code>&lt;PLACEHOLDER&gt;</code> is replaced with a newline. </p>\n\n<p>The text replacing works fine, but the style I specify gets overwritten by the <em>next</em> call to the replacement. This results in everything I just replaced having the style of whatever my <em>last</em> call to my replacement function is. </p>\n\n<p>VBA code (run <code>main</code>)</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nSub replace_stuff(search_string As String, replace_string As String, style As Integer)\n    With ActiveDocument.Range.Find\n        .Text = search_string\n        .Replacement.Text = replace_string\n        .Replacement.style = style\n        .Forward = True\n        .Wrap = wdFindContinue\n        .Format = True\n        .MatchWholeWord = False\n        .MatchSoundsLike = False\n        .MatchAllWordForms = False\n        .Execute Replace:=wdReplaceAll\n    End With\nEnd Sub\n\nSub main()\n    Dim section_names(2) As String\n    section_names(0) = \"Introduction\"\n    section_names(1) = \"Background\"\n    section_names(2) = \"Conclusion\"\n\n    Dim section_bodies(2) As String\n    section_bodies(0) = \"This is the body text for the introduction! Fetched from some file.\"\n    section_bodies(1) = \"And Background... I have no issue fetching data from the files.\"\n    section_bodies(2) = \"And for the conclusion... But I want the styles to 'stick'!\"\n\n    Dim i As Integer\n    For i = 0 To 2\n        ' Writes each section name as wsStyleHeading2, and then the section body as wdStyleNormal\n        Call replace_stuff(\"&lt;PLACEHOLDER&gt;\", section_names(i) &amp; Chr(11) &amp; \"&lt;PLACEHOLDER&gt;\", wdStyleHeading2)\n        Call replace_stuff(\"&lt;PLACEHOLDER&gt;\", section_bodies(i) &amp; Chr(11) &amp; \"&lt;PLACEHOLDER&gt;\", wdStyleNormal)\n    Next i\n    Call replace_stuff(\"&lt;PLACEHOLDER&gt;\", Chr(11), wdStyleNormal)\n\nEnd Sub\n\n</code></pre>\n\n<p><strong>Input document:</strong> A word document with only <code>&lt;PLACEHOLDER&gt;</code> in it.</p>\n\n<pre><code>&lt;PLACEHOLDER&gt;\n</code></pre>\n\n<p><strong>Expected Output:</strong>\nI expect that each heading will be displayed in the style I specified and can be viewed from the navigation pane like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/7Ls25.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7Ls25.png\" alt=\"expected output\"></a></p>\n\n<p><strong>Actual Output:</strong> However what I actually get is everything as <code>wdStyleNormal</code> style like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/05AyV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/05AyV.png\" alt=\"actual\"></a></p>\n\n<p><strong>I think the problem can be solved by inserting a paragraph break between every style transition</strong>, but when I try using <code>vbCrLF</code> or <code>Chr(10) &amp; Chr(13)</code> or <code>vbNewLine</code> instead of the <code>chr(11)</code> I am using now, Each line begins with a boxed question mark like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/yRcV8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yRcV8.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1573058464, "post_id": 58734477, "comment_id": 103759742, "body": "Why not just use a custom number format?"}, {"owner": {"reputation": 1, "user_id": 12333110, "user_type": "registered", "profile_image": "https://graph.facebook.com/1143570816033679/picture?type=large", "display_name": "Ziqi Zhang", "link": "https://stackoverflow.com/users/12333110/ziqi-zhang"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1573089298, "post_id": 58734477, "comment_id": 103771047, "body": "Do you mean cells(j,6).numberformat=\u201c#,##0\u201d ? Where should I put it? I tried immediately after \u201cfor\u201d and before \u201cnext\u201d, didn\u2019t work in both cases."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1573094947, "post_id": 58734477, "comment_id": 103772235, "body": "Do you perhaps have <i>text-that-looks-like-a-number</i>? Also, <code>Round</code> behaves slightly differently than <code>WorksheetFunction.Round</code>."}], "answers": [{"tags": [], "owner": {"reputation": 1205, "user_id": 8578580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a063b2c15a5847791ed1e0007d04b8c0?s=128&d=identicon&r=PG&f=1", "display_name": "TechnoDabbler", "link": "https://stackoverflow.com/users/8578580/technodabbler"}, "is_accepted": false, "score": 0, "last_activity_date": 1573094261, "creation_date": 1573094261, "answer_id": 58741185, "question_id": 58734477, "link": "https://stackoverflow.com/questions/58734477/why-my-code-always-return-integer-but-if-you-click-on-the-cells-it-shows-desire/58741185#58741185", "title": "why my code always return integer but if you click on the cells, it shows desired format in the input box under the menu?", "body": "<p>Maybe reset the cell number format at the same time ...</p>\n\n<pre><code>Sub unitchange()\n    Dim j As Integer\n    Dim u As Integer\n    u = Cells(Rows.Count, 1).End(xlUp).Row + 1\n    For j = 4 To u\n        Cells(j, 6) = Round((Cells(j, 6) / 100000000), 2)\n        Cells(j, 6).NumberFormat = \"General\"\n    Next j\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12333110, "user_type": "registered", "profile_image": "https://graph.facebook.com/1143570816033679/picture?type=large", "display_name": "Ziqi Zhang", "link": "https://stackoverflow.com/users/12333110/ziqi-zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573125969, "creation_date": 1573057183, "last_edit_date": 1573125969, "question_id": 58734477, "link": "https://stackoverflow.com/questions/58734477/why-my-code-always-return-integer-but-if-you-click-on-the-cells-it-shows-desire", "title": "why my code always return integer but if you click on the cells, it shows desired format in the input box under the menu?", "body": "<p>I'm using sumif function in a for loop trying to divide every number in a column by 100000000 to adjust for its unit and round the final results to 2 decimal places. VBA always return me integers but if I click on the cells, the disired form appears in the input box under the menu.</p>\n\n<p>I've tried to round the results inside the for loop, it didn't work.</p>\n\n<p>Following is what I have tried,</p>\n\n<pre><code>Sub unitchange()\nDim j As Integer\nDim u As Integer\nu = Cells(Rows.Count, 1).End(xlUp).Row + 1\nFor j = 4 To u\nCells(j, 6) = Round((Cells(j, 6) / 100000000), 2)\nNext j\nEnd Sub\n</code></pre>\n\n<p>I expect to have results appear on the worksheet rounded to two decimal places without having to click on it. Thanks.</p>\n"}, {"tags": ["excel", "vba", "user-defined-functions"], "comments": [{"owner": {"reputation": 1633, "user_id": 12001122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ec161ec6ec2ddb3c5ea5989f03fe053?s=128&d=identicon&r=PG&f=1", "display_name": "Jonas", "link": "https://stackoverflow.com/users/12001122/jonas"}, "edited": false, "score": 0, "creation_date": 1573057376, "post_id": 58734466, "comment_id": 103759107, "body": "Where does position come from / how will the function be executed?"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1573057479, "post_id": 58734466, "comment_id": 103759171, "body": "Why not just save the data to a sheet someplace?"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1573057656, "post_id": 58734466, "comment_id": 103759265, "body": "Not like that, no. For an example like this, you may want to consider using an array variable."}, {"owner": {"reputation": 311, "user_id": 520305, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c6fdd9ea94ec6d22f8f877323601b698?s=128&d=identicon&r=PG", "display_name": "Alan", "link": "https://stackoverflow.com/users/520305/alan"}, "edited": false, "score": 0, "creation_date": 1573057689, "post_id": 58734466, "comment_id": 103759281, "body": "i wanted to make it simple by removing other info but what I want to do is eventually split() a global string variable into an array and return whatever position has been requested. i.e. Test_Global_Var(2) will return position 2 from an array called variable_name_array."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1573058419, "post_id": 58734466, "comment_id": 103759714, "body": "This can work with a simple IF - E.g. <code>If position = 1 Then position_1 = position</code>"}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1573064642, "post_id": 58734466, "comment_id": 103762859, "body": "Use an array for global variables <code>Public position() as String</code> and assign it with <code>position = Array(..)</code> in the initialization code."}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1573064741, "post_id": 58734466, "comment_id": 103762912, "body": "<code>VBA</code> Does not let you do: <code>Debug.Print ThisWorkbook.variable_name</code> if <code>variable_name</code> is a string variable. You can try <code>Debug.Print Eval(&quot;ThisWorkbook.&quot; &amp; variable_name)</code> though."}, {"owner": {"reputation": 311, "user_id": 520305, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c6fdd9ea94ec6d22f8f877323601b698?s=128&d=identicon&r=PG", "display_name": "Alan", "link": "https://stackoverflow.com/users/520305/alan"}, "reply_to_user": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1573064966, "post_id": 58734466, "comment_id": 103763017, "body": "@ja72 That&#39;s exactly what I&#39;m trying to do, how to I get from a string to an variable.  I just tried the Eval() and it gave me a &quot;Compile Error: Sub or Function Not Defined&quot;"}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1573066286, "post_id": 58734466, "comment_id": 103763603, "body": "Since VBA does not have full reflection other than <code>CallByName</code> and <code>TypeName</code> functions, you only option is to use some kind of collection object, such as an <code>Array</code> or a <code>Collection</code> or a <code>Dictionary</code> to associate an index to a value."}, {"owner": {"reputation": 311, "user_id": 520305, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c6fdd9ea94ec6d22f8f877323601b698?s=128&d=identicon&r=PG", "display_name": "Alan", "link": "https://stackoverflow.com/users/520305/alan"}, "edited": false, "score": 0, "creation_date": 1573068385, "post_id": 58734466, "comment_id": 103764475, "body": "So is it possible to do what I want with either an <code>array</code>, <code>collection</code> or <code>dictionary</code>?  I&#39;m unsure of how to solve it with any of them"}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1573073139, "post_id": 58734466, "comment_id": 103766459, "body": "You are missing the return type for your function. Is it <code>Function Test_Global_Var(position as Integer) As String</code> ?"}, {"owner": {"reputation": 311, "user_id": 520305, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c6fdd9ea94ec6d22f8f877323601b698?s=128&d=identicon&r=PG", "display_name": "Alan", "link": "https://stackoverflow.com/users/520305/alan"}, "edited": false, "score": 0, "creation_date": 1573073365, "post_id": 58734466, "comment_id": 103766546, "body": "It&#39;s nothing at the moment as I&#39;m just trying to get it to print to the immediate window. do I needed it I&#39;m just doing a Debug.Print? When I get it working then I&#39;ll build up the function."}], "answers": [{"comments": [{"owner": {"reputation": 311, "user_id": 520305, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c6fdd9ea94ec6d22f8f877323601b698?s=128&d=identicon&r=PG", "display_name": "Alan", "link": "https://stackoverflow.com/users/520305/alan"}, "edited": false, "score": 0, "creation_date": 1573064288, "post_id": 58734786, "comment_id": 103762674, "body": "I&#39;m not sure if this is what I&#39;m looking for either.  I&#39;ve updated my questions to try and explain it in more detail.  If your solution or my updated problem does work maybe you could explain to me in more detail?"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1573058283, "creation_date": 1573058283, "answer_id": 58734786, "question_id": 58734466, "link": "https://stackoverflow.com/questions/58734466/passing-parameter-into-function-to-create-variable-name/58734786#58734786", "title": "Passing parameter into function to create variable name", "body": "<p>It is possible to consider a global dictionary variable and pass data through it from the UDF. \nFirst add reference to Microsoft Scripting Runtime:</p>\n\n<p><a href=\"https://i.stack.imgur.com/4WH8v.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4WH8v.png\" alt=\"enter image description here\"></a></p>\n\n<p>Thus, build the dictionary like this:</p>\n\n<pre><code>Public myDictionary As Dictionary\n</code></pre>\n\n<p>To initialize the <code>myDictionary</code> variable, consider adding it to a <code>Workbook_Open</code> event:</p>\n\n<pre><code>Private Sub Workbook_Open()\n    Set myDictionary = New Dictionary\nEnd Sub\n</code></pre>\n\n<p>Then the UDF would look like this:</p>\n\n<pre><code>Public Function FillDicitonary(myVal As Long) As String\n\n    If myDictionary.Exists(myVal) Then\n        myDictionary(myVal) = \"position \" &amp; myVal\n    Else\n        myDictionary.Add myVal, \"position \" &amp; myVal\n    End If\n    FillDicitonary = \"Filled with \" &amp; myVal\n\nEnd Function\n</code></pre>\n\n<p>And it would overwrite every key in the dictionary, if it exists. At the end, the values could be printed:</p>\n\n<pre><code>Public Sub PrintDictionary()\n\n    Dim myKey As Variant\n    For Each myKey In myDictionary\n        Debug.Print myDictionary(myKey)\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 311, "user_id": 520305, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c6fdd9ea94ec6d22f8f877323601b698?s=128&d=identicon&r=PG", "display_name": "Alan", "link": "https://stackoverflow.com/users/520305/alan"}, "edited": false, "score": 0, "creation_date": 1573075481, "post_id": 58738618, "comment_id": 103767350, "body": "Thanks for this I\u2019ll have a look at it tomorrow and hopefully it will fulfil my problem then help me build my solution \ud83d\udc4d\ud83c\udffb"}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "reply_to_user": {"reputation": 311, "user_id": 520305, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c6fdd9ea94ec6d22f8f877323601b698?s=128&d=identicon&r=PG", "display_name": "Alan", "link": "https://stackoverflow.com/users/520305/alan"}, "edited": false, "score": 0, "creation_date": 1573079537, "post_id": 58738618, "comment_id": 103768737, "body": "I guess  you can put emoji in comments now \ud83d\ude0a."}, {"owner": {"reputation": 311, "user_id": 520305, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c6fdd9ea94ec6d22f8f877323601b698?s=128&d=identicon&r=PG", "display_name": "Alan", "link": "https://stackoverflow.com/users/520305/alan"}, "edited": false, "score": 0, "creation_date": 1573120068, "post_id": 58738618, "comment_id": 103780741, "body": "This works like a treat, one option I want to look at is, if possible. Let says the initial variant is called 1_postion and I create 30 of them, 2_position, 3_position, etc.  Is it possible to not only pass in a array position via 1_position(1) for example but also a parameter to ask for different variables without having to repeat the code 30 times.  What I mean is pass in 2 paramaters which will be 1: the variable number and 2: the position in that variable?"}, {"owner": {"reputation": 311, "user_id": 520305, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c6fdd9ea94ec6d22f8f877323601b698?s=128&d=identicon&r=PG", "display_name": "Alan", "link": "https://stackoverflow.com/users/520305/alan"}, "edited": false, "score": 0, "creation_date": 1573120225, "post_id": 58738618, "comment_id": 103780840, "body": "What I&#39;m trying to do is create the variable name from a parameter aswell as value in the array position passed in as a parameter too. e.g. (i)_position(j) where i is the variable array and j is the position in that array"}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "reply_to_user": {"reputation": 311, "user_id": 520305, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c6fdd9ea94ec6d22f8f877323601b698?s=128&d=identicon&r=PG", "display_name": "Alan", "link": "https://stackoverflow.com/users/520305/alan"}, "edited": false, "score": 0, "creation_date": 1573135514, "post_id": 58738618, "comment_id": 103789074, "body": "So you want a 2D array now? It would be accessed with <code>.Position(i,j)</code>. The details aren&#39;t clear, so I suggest you post a new question as a follow up to this question."}, {"owner": {"reputation": 311, "user_id": 520305, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c6fdd9ea94ec6d22f8f877323601b698?s=128&d=identicon&r=PG", "display_name": "Alan", "link": "https://stackoverflow.com/users/520305/alan"}, "edited": false, "score": 0, "creation_date": 1573136502, "post_id": 58738618, "comment_id": 103789710, "body": "Ok will do, but not a 2d array more so a way to pass in a parameter to change the named of the variable being accessed."}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "reply_to_user": {"reputation": 311, "user_id": 520305, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c6fdd9ea94ec6d22f8f877323601b698?s=128&d=identicon&r=PG", "display_name": "Alan", "link": "https://stackoverflow.com/users/520305/alan"}, "edited": false, "score": 0, "creation_date": 1573136828, "post_id": 58738618, "comment_id": 103789909, "body": "How is that different? Instead of using multiple variables, use one array variable. Unless they are all different sizes, then it becomes messy. Then you need a <code>Collection</code> of arrays or something similar. Remember, any time you feel you need to repeat code, stop and think about how to commonize the code using variable arrays."}, {"owner": {"reputation": 311, "user_id": 520305, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c6fdd9ea94ec6d22f8f877323601b698?s=128&d=identicon&r=PG", "display_name": "Alan", "link": "https://stackoverflow.com/users/520305/alan"}, "edited": false, "score": 0, "creation_date": 1573138955, "post_id": 58738618, "comment_id": 103791104, "body": "Ah ok, I know what you&#39;re saying now, so using a 2d array I could have the first element as my different variable and the 2nd dimension as my value per say.  Could you get your code to work like that above with a 2d array?"}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "reply_to_user": {"reputation": 311, "user_id": 520305, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c6fdd9ea94ec6d22f8f877323601b698?s=128&d=identicon&r=PG", "display_name": "Alan", "link": "https://stackoverflow.com/users/520305/alan"}, "edited": false, "score": 0, "creation_date": 1573147886, "post_id": 58738618, "comment_id": 103796121, "body": "A 2D array will require a <code>ReDim</code> statement to allocate space before use, and you can no longer use the <code>Array()</code> statement for storing values. The answer would be substantially different just because the piping of information flow would be different."}, {"owner": {"reputation": 311, "user_id": 520305, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c6fdd9ea94ec6d22f8f877323601b698?s=128&d=identicon&r=PG", "display_name": "Alan", "link": "https://stackoverflow.com/users/520305/alan"}, "edited": false, "score": 0, "creation_date": 1573207572, "post_id": 58738618, "comment_id": 103814808, "body": "Thanks I&#39;ve created a new question to find the solution.  Cheers for the help so far @ja72.  <a href=\"https://stackoverflow.com/questions/58764370/how-to-convert-into-handling-a-2d-3d-array\" title=\"how to convert into handling a 2d 3d array\">stackoverflow.com/questions/58764370/&hellip;</a>"}], "tags": [], "owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "is_accepted": true, "score": 0, "last_activity_date": 1573075004, "creation_date": 1573075004, "answer_id": 58738618, "question_id": 58734466, "link": "https://stackoverflow.com/questions/58734466/passing-parameter-into-function-to-create-variable-name/58738618#58738618", "title": "Passing parameter into function to create variable name", "body": "<p>The code below produces the following debug output</p>\n\n<pre><code>2 values defined.\nThisWorkbook.Position(0)\nFirst Value\nThisWorkbook.Position(1)\nSecond Value\n</code></pre>\n\n<p>It uses a private array in the workbook named <code>m_position</code>. The contents are accessed by a global property <code>ThisWorkbook.Position(index)</code>. </p>\n\n<p>In a <strong>module</strong> have the following code:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub Test()    \n    If ThisWorkbook.NoValues Then\n        ThisWorkbook.FillValues \"First Value\", \"Second Value\"\n    End If\n\n    Debug.Print CStr(ThisWorkbook.Count) &amp; \" values defined.\"\n\n    Test_Global_Var 0\n    Test_Global_Var 1\nEnd Sub\n\nPublic Sub Test_Global_Var(ByVal index As Long)\n    ' Part of a UDF\n    Debug.Print \"ThisWorkbook.Position(\" &amp; CStr(index) &amp; \")\"\n    Debug.Print ThisWorkbook.Position(index)\n\nEnd Sub\n</code></pre>\n\n<p>In <strong>ThisWorkbook</strong> have the following code:</p>\n\n<pre><code>Option Explicit\n\nPrivate m_position() As Variant\n\nPrivate Sub Workbook_Open()\n    Call DefaultValues\nEnd Sub\n\n\nPublic Property Get Position(ByVal index As Long) As Variant\n    Position = m_position(index)\nEnd Property\n\nPublic Sub DefaultValues()\n    m_position = Array(\"First\", \"Second\")\nEnd Sub\n\nPublic Sub FillValues(ParamArray args() As Variant)\n    m_position = args\nEnd Sub\n\nPublic Property Get Count() As Long\n    Count = UBound(m_position) - LBound(m_position) + 1\nEnd Property\n\nPublic Property Get NoValues() As Boolean\n    On Error GoTo ArrUndefined:\n    Dim n As Long\n    n = UBound(m_position)\n    NoValues = False\n    On Error GoTo 0\n    Exit Sub\nArrUndefined:\n    NoValues = True\n    On Error GoTo 0\nEnd Property\n</code></pre>\n\n<p>PS. In VBA never use <code>Integer</code>, but instead use <code>Long</code>. <code>Integer</code> is a 16bit type, while <code>Long</code> is the standard 32bit type that <em>all</em> other programming languages consider as an <code>integer</code>.</p>\n"}], "owner": {"reputation": 311, "user_id": 520305, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c6fdd9ea94ec6d22f8f877323601b698?s=128&d=identicon&r=PG", "display_name": "Alan", "link": "https://stackoverflow.com/users/520305/alan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 58738618, "answer_count": 2, "score": 0, "last_activity_date": 1581869993, "creation_date": 1573057149, "last_edit_date": 1581869993, "question_id": 58734466, "link": "https://stackoverflow.com/questions/58734466/passing-parameter-into-function-to-create-variable-name", "title": "Passing parameter into function to create variable name", "body": "<p>I want to use global variables in my workbook and in the ThisWorkbook code. I declared the following varaibles</p>\n\n<pre><code>Public position_1 as string\nPublic position_2 as string\n</code></pre>\n\n<p>If I want to see the value of those variables I believe they need to be fully qualified so</p>\n\n<pre><code>Debug.Print ThisWorkbook.position_1\nDebug.Print ThisWorkbook.position_2\n</code></pre>\n\n<p>I have written a UDF which I will pass in an integer to represent which variable I am looking for.  I will only be passing in a single number and not a full variable name.  I am trying to find a way to use this integer to concatenate with \"position_\" to display the value of the global variable, ThisWorkbook.position_1, ThisWorkbook.position_2, etc.</p>\n\n<pre><code>Function Test_Global_Var(position as Integer)\n    Dim variable_name As String\n    variable_name = \"position_\" &amp; position\n    Debug.Print ThisWorkbook.variable_name\nEnd Function\n</code></pre>\n\n<p>So when I call</p>\n\n<pre><code>Test_Global_Var(1) \n</code></pre>\n\n<p>my immediate window should display the value of </p>\n\n<pre><code>ThisWorkbook.position_1\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 2, "creation_date": 1573056941, "post_id": 58734387, "comment_id": 103758890, "body": "Try changing the range string to <code>&quot;A2:F2, H2:H2&quot;</code>"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1573058215, "post_id": 58734387, "comment_id": 103759571, "body": "You may also want ot take a look at <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">this</a>"}, {"owner": {"reputation": 1445, "user_id": 3435347, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7116abf09795963b952af3357ea20c14?s=128&d=identicon&r=PG&f=1", "display_name": "aab", "link": "https://stackoverflow.com/users/3435347/aab"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1573058377, "post_id": 58734387, "comment_id": 103759669, "body": "@braX it still only selects column <code>A</code> to <code>F</code>. This is how I&#39;ve modified it: <code>enodebdata.Range(enodebdata.Range(&quot;A2:F2, H2:H2&quot;), enodebdata.Range(&quot;A2:F2, H2:H2&quot;).End(xlDown).Range(&quot;F2&quot;)).Select</code>"}, {"owner": {"reputation": 1445, "user_id": 3435347, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7116abf09795963b952af3357ea20c14?s=128&d=identicon&r=PG&f=1", "display_name": "aab", "link": "https://stackoverflow.com/users/3435347/aab"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1573058430, "post_id": 58734387, "comment_id": 103759726, "body": "@cybernetic.nomad thanks for the link. Good to know"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1573059530, "post_id": 58734387, "comment_id": 103760369, "body": "That <code>.Range(&quot;F2&quot;)</code> doesn&#39;t look right. Why not find the last row and specify the range that way?"}, {"owner": {"reputation": 1445, "user_id": 3435347, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7116abf09795963b952af3357ea20c14?s=128&d=identicon&r=PG&f=1", "display_name": "aab", "link": "https://stackoverflow.com/users/3435347/aab"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1573060913, "post_id": 58734387, "comment_id": 103761108, "body": "@SJR I don&#39;t think I understand what you mean? How do you mean?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1573064710, "post_id": 58734387, "comment_id": 103762892, "body": "See GMalc&#39;s answer."}], "answers": [{"tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": true, "score": 2, "last_activity_date": 1573062927, "creation_date": 1573062927, "answer_id": 58735976, "question_id": 58734387, "link": "https://stackoverflow.com/questions/58734387/excel-vba-select-multiple-columns/58735976#58735976", "title": "Excel VBA select multiple columns", "body": "<p>Try <code>Union</code>.</p>\n\n<pre><code>Dim lrow As Long\nlrow = enodebdata.UsedRange.Rows.Count\n\n    Union(enodebdata.Range(\"A2:F\" &amp; lrow), enodebdata.Range(\"H2:H\" &amp; lrow)).Select\n</code></pre>\n"}], "owner": {"reputation": 1445, "user_id": 3435347, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7116abf09795963b952af3357ea20c14?s=128&d=identicon&r=PG&f=1", "display_name": "aab", "link": "https://stackoverflow.com/users/3435347/aab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 340, "favorite_count": 0, "accepted_answer_id": 58735976, "answer_count": 1, "score": 0, "last_activity_date": 1573062927, "creation_date": 1573056856, "last_edit_date": 1573056899, "question_id": 58734387, "link": "https://stackoverflow.com/questions/58734387/excel-vba-select-multiple-columns", "title": "Excel VBA select multiple columns", "body": "<p>I'm trying to select multiple columns, i.e. Column <code>A</code> to Column <code>F</code> and Column <code>H</code> using the following formula:</p>\n\n<pre><code>enodebdata.Range(enodebdata.Range(\"A2:F2, H2\"), enodebdata.Range(\"A2:F2, H2\").End(xlDown).Range(\"F2\")).Select\n</code></pre>\n\n<p>The problem is it only selects Columns <code>A</code> to <code>F</code> and gives the following error: </p>\n\n<blockquote>\n  <p>Runtime error 424, Object required`.</p>\n</blockquote>\n\n<p>What am I missing?</p>\n"}, {"tags": ["sql", "excel", "vba", "ado", "listobject"], "comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1573059505, "post_id": 58734267, "comment_id": 103760355, "body": "I&#39;ve run into some weird issue placing the start of my table somewhere else than A1 with ADO. E.g. inserting rows before the start of the table decrements the <code>RecordCount</code>. If you can reorient the table to start on A1, that might help. Alternatively, have you considered using Advanced Filter, or another method to achieve similar results?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1573059790, "post_id": 58734267, "comment_id": 103760509, "body": "@RyanWildry - Thanks. Yes, I can use advanced filter or another option. My colleague built via ADO since its faster in general, though not without its quirks, as I have also discovered in the past."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1573061749, "post_id": 58734267, "comment_id": 103761540, "body": "Let us know if moving the table to start in A1 works."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1573143043, "post_id": 58734267, "comment_id": 103793513, "body": "@RyanWildry - What do you know. That solved it. However, that&#39;s a pretty crappy solution, considering that workbook designs can have tables anywhere! If someone can post a more robust and dynamic solution, that would be great."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1573159593, "post_id": 58734267, "comment_id": 103801033, "body": "Try leaving off the <code>LockType</code>. E.g. open the recordset like: <code>rs.Open strSQL, cnn, adOpenStatic</code>"}], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1573059091, "creation_date": 1573056450, "last_edit_date": 1573059091, "question_id": 58734267, "link": "https://stackoverflow.com/questions/58734267/ado-query-of-listobject-returning-only-null-values-for-wrong-recordcount", "title": "ADO Query of ListObject Returning Only NULL Values For Wrong RecordCount", "body": "<p>I have the following procedure meant to query a ListObject via ADO.</p>\n\n<pre><code>Dim cnn As ADODB.Connection\nSet cnn = New ADODB.Connection\ncnn.ConnectionString = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp; ThisWorkbook.FullName &amp; \";Extended Properties=\"\"Excel 12.0;HDR=Yes;IMEX=1\"\";\"\ncnn.Open\n\nDim tblRange As String\ntblRange = quoteWK.ListObjects(\"quoteWKStateInfo\").Range().Address(False, False)\n\nDim strSQL As String\nstrSQL = \"SELECT WkStateCd FROM [quoteWK$\" &amp; tblRange &amp; \"]\"\n\nDim rs As ADODB.Recordset\nSet rs = New ADODB.Recordset\n\nrs.Open strSQL, cnn, adOpenStatic, adLockPessimistic\n</code></pre>\n\n<p>However, the recordset is only returning 23 records, when the table has 198. Also, the value for each field is null (<code>debug.print rs.Fields(0).Value</code>).</p>\n\n<p>I have searched online quite a bit but cannot see the issue. I have also played with <code>CursorType</code> and <code>LockType</code>. Below I have placed what I think is important information as well as a picture of the table.</p>\n\n<pre><code>?tblRange | Q4:AG206\n?strSQL | SELECT WkStateCd FROM [quoteWK$Q4:AG206]\n?rs.Fields(0).Value | Null\n?rs.RecordCount | 23 \n?rs.Fields.Count | 1 'this is correct\n</code></pre>\n\n<p>Also, FWIW, when I run a <code>SELECT DISTINCT</code> against the table, I get no records returned. There are 15 distinct states in the WkStateCd column.</p>\n\n<p><a href=\"https://i.stack.imgur.com/8SPg7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8SPg7.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1633, "user_id": 12001122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ec161ec6ec2ddb3c5ea5989f03fe053?s=128&d=identicon&r=PG&f=1", "display_name": "Jonas", "link": "https://stackoverflow.com/users/12001122/jonas"}, "edited": false, "score": 0, "creation_date": 1573057601, "post_id": 58734242, "comment_id": 103759230, "body": "For that you have to implement some sort of counter as integer and include the integer into your filename like e.g. <code>Call fso.CopyFile(&quot;R:\\ASP\\PCQ_BEHESP\\SuiviPCQAssignations\\TABLEAU&zwnj;&#8203;PCQ&quot; + integer_var + &quot;.xlsm&quot;</code>"}, {"owner": {"reputation": 65, "user_id": 12297683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UYb16.png?s=128&g=1", "display_name": "Codingnoob", "link": "https://stackoverflow.com/users/12297683/codingnoob"}, "reply_to_user": {"reputation": 1633, "user_id": 12001122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ec161ec6ec2ddb3c5ea5989f03fe053?s=128&d=identicon&r=PG&f=1", "display_name": "Jonas", "link": "https://stackoverflow.com/users/12001122/jonas"}, "edited": false, "score": 0, "creation_date": 1573060193, "post_id": 58734242, "comment_id": 103760721, "body": "@Phanti it&#39;s not working :/"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1573061449, "post_id": 58734242, "comment_id": 103761382, "body": "There is a built in VBA function to do this. <code>FileCopy &quot;SourceFilePathHere&quot;, &quot;DestinationFilePathHere&quot;</code>. Also, if you are looking to replace the file you are copying to the destination, you can use the overwrite paramter of CopyFile. Set the last parameter as <code>true</code>. E.g. <code>fso.CopyFile &quot;FirstPath&quot;,&quot;SecondPath&quot;,true</code>"}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 12297683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UYb16.png?s=128&g=1", "display_name": "Codingnoob", "link": "https://stackoverflow.com/users/12297683/codingnoob"}, "edited": false, "score": 0, "creation_date": 1573059003, "post_id": 58734668, "comment_id": 103760087, "body": "it&#39;s giving me error 13 at this line  Call fso.CopyFile(&quot;R:\\ASP\\PCQ_BEHESP\\SuiviPCQAssignations\\TABLEAU&zwnj;&#8203;PCQ&quot; + integer_var + &quot;.xlsm&quot;"}, {"owner": {"reputation": 1633, "user_id": 12001122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ec161ec6ec2ddb3c5ea5989f03fe053?s=128&d=identicon&r=PG&f=1", "display_name": "Jonas", "link": "https://stackoverflow.com/users/12001122/jonas"}, "reply_to_user": {"reputation": 65, "user_id": 12297683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UYb16.png?s=128&g=1", "display_name": "Codingnoob", "link": "https://stackoverflow.com/users/12297683/codingnoob"}, "edited": false, "score": 0, "creation_date": 1573060321, "post_id": 58734668, "comment_id": 103760786, "body": "try again with <code>Dim counter_var as string</code>"}, {"owner": {"reputation": 65, "user_id": 12297683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UYb16.png?s=128&g=1", "display_name": "Codingnoob", "link": "https://stackoverflow.com/users/12297683/codingnoob"}, "edited": false, "score": 0, "creation_date": 1573061323, "post_id": 58734668, "comment_id": 103761318, "body": "Just like the code you wrote above? I copy pasted the whole block, it&#39;s not working.."}, {"owner": {"reputation": 65, "user_id": 12297683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UYb16.png?s=128&g=1", "display_name": "Codingnoob", "link": "https://stackoverflow.com/users/12297683/codingnoob"}, "edited": false, "score": 0, "creation_date": 1573062878, "post_id": 58734668, "comment_id": 103762040, "body": "&#39;&#39;File not found&#39;&#39;, everything is correct, idk why they say the file is not found.."}, {"owner": {"reputation": 65, "user_id": 12297683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UYb16.png?s=128&g=1", "display_name": "Codingnoob", "link": "https://stackoverflow.com/users/12297683/codingnoob"}, "edited": false, "score": 1, "creation_date": 1573063075, "post_id": 58734668, "comment_id": 103762128, "body": "ohhh we wrote counter_var at the wrong place, now it&#39;s working :)"}, {"owner": {"reputation": 65, "user_id": 12297683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UYb16.png?s=128&g=1", "display_name": "Codingnoob", "link": "https://stackoverflow.com/users/12297683/codingnoob"}, "edited": false, "score": 0, "creation_date": 1573063107, "post_id": 58734668, "comment_id": 103762138, "body": "counter_var should go at destination path and not source"}], "tags": [], "owner": {"reputation": 1633, "user_id": 12001122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ec161ec6ec2ddb3c5ea5989f03fe053?s=128&d=identicon&r=PG&f=1", "display_name": "Jonas", "link": "https://stackoverflow.com/users/12001122/jonas"}, "is_accepted": true, "score": 0, "last_activity_date": 1573063628, "last_edit_date": 1573063628, "creation_date": 1573057880, "answer_id": 58734668, "question_id": 58734242, "link": "https://stackoverflow.com/questions/58734242/how-to-copy-a-file-from-one-directory-to-another-with-vba/58734668#58734668", "title": "How to copy a file from one directory to another with VBA", "body": "<p>Increase the counter by 1 after each sub execution within a cell value. That way you have the current count stored outside your function.</p>\n\n<p>Grab it, use it, increase it.</p>\n\n<pre><code>Sub CopierFichier()\n\nDim counter_var As String\nDim fso As Object\nSet fso = VBA.CreateObject(\"Scripting.FileSystemObject\")\n\ncounter_var = Cells(1, 1).Value\n\nCall fso.CopyFile(\"R:\\ASP\\PCQ_BEHESP\\SuiviPCQAssignations\\TABLEAUPCQ.xlsm\", \"V:\\DGI\\11000_Surveillance\\11200_InstallationsSousPression\\PCQ\\Suivi\\TABLEAUPCQ_COPIE_\" + counter_var + \".xlsm\")\n\nCells(1, 1).Value = Cells(1, 1).Value + 1\n\nEnd Sub\n\n</code></pre>\n\n<p>I corrected the small error. </p>\n"}], "owner": {"reputation": 65, "user_id": 12297683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UYb16.png?s=128&g=1", "display_name": "Codingnoob", "link": "https://stackoverflow.com/users/12297683/codingnoob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 212, "favorite_count": 0, "accepted_answer_id": 58734668, "answer_count": 1, "score": 0, "last_activity_date": 1573063628, "creation_date": 1573056381, "last_edit_date": 1573057454, "question_id": 58734242, "link": "https://stackoverflow.com/questions/58734242/how-to-copy-a-file-from-one-directory-to-another-with-vba", "title": "How to copy a file from one directory to another with VBA", "body": "<p>I want to be able to copy an excel file from one folder to another one. But, everytime it copies it, I want to change the name to TABLEAUPCQ1, TABLEAUPCQ2, TABLEAUPCQ3, and so on..</p>\n\n<p>the reason is, I cant overwrite the excel file if someone is already using it in that other path.. </p>\n\n<pre><code>Sub CopierFichier()\n\nDim fso As Object\nSet fso = VBA.CreateObject(\"Scripting.FileSystemObject\")\n\nCall fso.CopyFile(\"R:\\ASP\\PCQ_BEHESP\\SuiviPCQAssignations\\TABLEAUPCQ.xlsm\", \"V:\\DGI\\11000_Surveillance\\11200_InstallationsSousPression\\PCQ\\Suivi\\TABLEAUPCQ.xlsm\")\n\nEnd Sub\n\n\n</code></pre>\n"}, {"tags": ["excel", "vba", "userform"], "comments": [{"owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "edited": false, "score": 1, "creation_date": 1573055087, "post_id": 58733770, "comment_id": 103757833, "body": "You need a <code>Set</code> statement on that line of code.  For example, <code>Set newInstanceOfMe.targetWksht = targetWksht</code>."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1573055296, "post_id": 58733770, "comment_id": 103757937, "body": "Side note: use <code>Long</code> instead of <code>Integer</code>: <a href=\"https://stackoverflow.com/questions/26409117/why-use-integer-instead-of-long\" title=\"why use integer instead of long\">stackoverflow.com/questions/26409117/&hellip;</a>"}, {"owner": {"reputation": 41, "user_id": 12095973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/738467fbbc1372d880fb9a00077dffcc?s=128&d=identicon&r=PG&f=1", "display_name": "Adrien", "link": "https://stackoverflow.com/users/12095973/adrien"}, "reply_to_user": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "edited": false, "score": 0, "creation_date": 1573055452, "post_id": 58733770, "comment_id": 103758019, "body": "@BrianMStafford Works perfect now, thanks! Sorry for that dumb question, I&#39;m still new to VBA and don&#39;t get all the subtleties between &quot;Set xx = yy&quot; and &quot;xx = yy&quot; but I get why we need one here."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1573055549, "post_id": 58733770, "comment_id": 103758080, "body": "<code>Set</code> is used for <code>Object</code> variables."}, {"owner": {"reputation": 194, "user_id": 9390758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8f7f95c8a370a7e9afb4f728c5a0bcc?s=128&d=identicon&r=PG&f=1", "display_name": "SlappedProgrammer", "link": "https://stackoverflow.com/users/9390758/slappedprogrammer"}, "edited": false, "score": 0, "creation_date": 1573055551, "post_id": 58733770, "comment_id": 103758081, "body": "You need to use the Set keyword when dealing with objects."}, {"owner": {"reputation": 41, "user_id": 12095973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/738467fbbc1372d880fb9a00077dffcc?s=128&d=identicon&r=PG&f=1", "display_name": "Adrien", "link": "https://stackoverflow.com/users/12095973/adrien"}, "edited": false, "score": 0, "creation_date": 1573055716, "post_id": 58733770, "comment_id": 103758181, "body": "Thank you for these fast and clear answers. The code runs very well now."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1573067723, "post_id": 58733770, "comment_id": 103764202, "body": "There are no dumb questions =)"}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 5, "last_activity_date": 1573059030, "creation_date": 1573059030, "answer_id": 58734975, "question_id": 58733770, "link": "https://stackoverflow.com/questions/58733770/vba-userform-gives-run-time-error-91-for-one-of-its-parameters/58734975#58734975", "title": "VBA UserForm gives run-time error 91 for one of its parameters", "body": "<blockquote>\n<pre><code>newInstanceOfMe.targetWksht = targetWksht\n</code></pre>\n</blockquote>\n\n<p>This statement produces an error-level <em>code quality</em> inspection result for <a href=\"http://rubberduckvba.com/Inspections/Details/ValueRequired\" rel=\"noreferrer\"><em>Value Required</em></a> inspection in Rubberduck (an open-source VBIDE add-in project I manage). The inspection explains the situation as follows:</p>\n\n<blockquote>\n  <p><strong>Object used where a value is required</strong></p>\n  \n  <p>The VBA compiler does not raise an error if an object is used in a place that requires a value type and the object's declared type does not have a suitable default member. Under almost all circumstances, this leads to a run-time error 91 'Object or With block variable not set' or 438 'Object doesn't support this property or method' depending on whether the object has the value 'Nothing' or not, which is harder to detect and indicates a bug.</p>\n</blockquote>\n\n<p>There are two types of assignments in VBA: <em>value assignment</em> (<code>Let</code>), and <em>reference assignment</em> (<code>Set</code>). The <code>Let</code> keyword is redundant/optional/obsolete for value assignments:</p>\n\n<pre><code>Dim foo As Long\nfoo = 2 + 2\nLet foo = 2 + 2 '&lt;~ exactly equivalent to the above\n</code></pre>\n\n<p>So unless the <code>Set</code> keyword is present, VBA attempts to make a value assignment. If the object has a <em>default member</em>, that might just work - the VBA specs define how <em>let-coercion</em> mechanisms make that happen. That's how you can assign a <code>Range</code> to a value:</p>\n\n<pre><code>Sheet1.Range(\"A1\") = 42\n</code></pre>\n\n<p>That's <em>implicitly</em> assigning to <code>Range.Value</code>, via an implicit member call to <code>Range.[_Default]</code>, a hidden property of the <code>Range</code> class.</p>\n\n<p>If the right-hand side of the assignment was also an object, then let-coercion would be happening on both sides of the operator:</p>\n\n<pre><code>Sheet1.Range(\"A1\") = Sheet1.Range(\"B1\") '&lt;~ implicit default member calls galore!\nSheet1.Range(\"A1\").Value = Sheet1.Range(\"B1\").Value\n</code></pre>\n\n<p>But we're not looking at a <code>Range</code> here, we're looking at a <code>UserForm</code>, and a <code>UserForm</code> does not have a default member, so let-coercion can't happen... but the compiler won't validate that, so the code gets to run anyway... and blows up at run-time instead.</p>\n\n<p>So, we're looking at a <code>Let</code> assignment with both sides holding an object reference, for a class type that doesn't define a default member.</p>\n\n<pre><code>Something.SomeObject = someOtherObject\n</code></pre>\n\n<p>But VBA doesn't care that there's no default member - because there's no <code>Set</code> keyword, it tries as hard as it can to do what you told it to do, and coerce these objects into values... and fails, obviously.</p>\n\n<p>If <code>Something.SomeObject</code> (left-hand side) is <code>Nothing</code>, then the let-coercion attempt will try to invoke the inexistent default member -- but since the object reference is <code>Nothing</code>, the call is invalid, and error 91 is raised.</p>\n\n<p>If <code>Something.SomeObject</code> is already holding a valid object reference, then the let-coercion attempt will go one step further, and fail with error 438 because there's no default member to invoke.</p>\n\n<p>If <code>Something.SomeObject</code> <em>has</em> a default member (and the reference isn't <code>Nothing</code>), then the value assignment succeeds, no error is raised... but no object reference was assigned, and this might be a subtle bug!</p>\n\n<p>Adding a <code>Set</code> keyword makes the assignment a <em>reference assignment</em>, and now everything works fine.</p>\n"}], "owner": {"reputation": 41, "user_id": 12095973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/738467fbbc1372d880fb9a00077dffcc?s=128&d=identicon&r=PG&f=1", "display_name": "Adrien", "link": "https://stackoverflow.com/users/12095973/adrien"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 325, "favorite_count": 1, "accepted_answer_id": 58734975, "answer_count": 1, "score": 1, "last_activity_date": 1573059030, "creation_date": 1573054833, "last_edit_date": 1573054862, "question_id": 58733770, "link": "https://stackoverflow.com/questions/58733770/vba-userform-gives-run-time-error-91-for-one-of-its-parameters", "title": "VBA UserForm gives run-time error 91 for one of its parameters", "body": "<p>I am trying to create multiple instances of the same modeless UserForm in excel-VBA, with parameters, through a Sub. </p>\n\n<p>I can make it work with two of the three parameters I want to assign, but the third one keeps returning me </p>\n\n<blockquote>\n  <p>\"Run-time Error '91': Object variable or With block variable not set\"</p>\n</blockquote>\n\n<p>and I can't figure out why.\nIt may be an obvious typo that I didn't see, but I really can't point out the problem.\nHere is my code:</p>\n\n<pre><code>Sub AskToClose(targetWksht As Worksheet, targetRow As Integer, test As String)\n    Dim newInstanceOfMe As Object\n\n    Set newInstanceOfMe = UserForms.Add(\"MOVE_TO_CLOSED\") 'MOVE_TO_CLOSED is the name of my UserForm\n\n    newInstanceOfMe.targetWksht = targetWksht 'If I comment this line it works just fine, otherwise Run-time error 91\n    newInstanceOfMe.targetRow = targetRow\n    newInstanceOfMe.test = test\n\n    newInstanceOfMe.Show vbModeless\nEnd Sub\n\n_____________________________________________________________________\n\nSub test()\n    Dim openWksht As Worksheet\n\n    Set openWksht = Worksheets(\"OPEN WO\") 'The worksheet exists and works just fine everywhere else\n\n    Call AskToClose(openWksht, 2, \"test 2\")\n    Call AskToClose(openWksht, 3, \"test 3\")\n    Call AskToClose(openWksht, 4, \"test 4\")\n\n    Set openWksht = Nothing 'I tried to comment this line just in case, same result...\nEnd Sub\n\n_____________________________________________________________________\n'My MOVE_TO_CLOSED UserForm parameters\nPublic targetWksht As Worksheet\nPublic targetRow As Integer\nPublic test As String\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1573054981, "post_id": 58733760, "comment_id": 103757765, "body": "Unsure what the specific problem is, but you might want to give <a href=\"https://rubberduckvba.wordpress.com/2017/10/25/userform1-show/\" rel=\"nofollow noreferrer\">this article</a> a read about why <code>Unload Me</code> and <code>Form_Splash.Show</code> aren&#39;t the best practice."}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 2, "creation_date": 1573055082, "post_id": 58733760, "comment_id": 103757829, "body": "Replace <code>Unload Me</code> with <code>Me.Hide</code>. <code>Unload</code> means to remove the form object from memory which is a bad idea while the form is still active."}], "owner": {"reputation": 81, "user_id": 9958363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bdf0b437d462e775960a3c9835102f6?s=128&d=identicon&r=PG&f=1", "display_name": "Pat", "link": "https://stackoverflow.com/users/9958363/pat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573062898, "creation_date": 1573054808, "last_edit_date": 1573062898, "question_id": 58733760, "link": "https://stackoverflow.com/questions/58733760/code-runs-differently-with-without-breakpoint", "title": "code runs differently with/without breakpoint", "body": "<p>I'm creating a user form (with SAVE button that writes to Excel sheet and RETURN button that goes back to a splash page) and want to set/check a flag if there are unsaved changes on the form.  I'm getting different functionality of the code depending on whether a breakpoint is set or not.</p>\n\n<p>Here is the relevant portion of code:</p>\n\n<pre><code>Public saveFlag as Boolean\n\nPrivate Sub UserForm_Initialize()    \n    initializeCMAValues Me\n    initializeTeamValues Me, getRowNum(\"CMA\", \"Team\", False)\n    ' getRowNum is a function that returns the row to read from\n    ' in this case, the row with name=CMA, type=Team, createRow=False\n\n    saveFlag = False\nEnd Sub\n\nPrivate Sub btn_Return_Click()\n    ' Check for unsaved data\n    If saveFlag Then\n        If MsgBox(\"You have unsaved information on the form.  Do you wish to save it?\", vbYesNo, \"Unsaved Data\") = vbYes Then\n            btn_Save_Click\n        End If\n    End If\n\n    ' Return to splash form\n    Unload Me\n    Form_Splash.Show\nEnd Sub\n</code></pre>\n\n<p>If I enter the form and select RETURN, I get the msgbox prompt.  If I set a breakpoint at the <code>saveFlag = False</code> line, enter form, select RETURN (invoking breakpoint), continue running, then it runs as I would expect (i.e., no msgbox).</p>\n\n<p>Instead of a public saveFlag variable, I've tried writing the flag to a non-visible label on the form; I've also tried writing to a cell on the Excel sheet.  Both gave the same results of this different behavior with and without the breakpoint.</p>\n\n<p>I've also run the code with the initializeTeamValues line commented out and then the code runs fine.  I've triple checked that this subroutine only fills values into the textboxes on the form, nothing else.</p>\n\n<p>Some research turned up a vague answer related to OLE pushing values onto the stack.  I then tried putting the \"saveFlag = False\" line at the beginning of the subroutine.  Same results.</p>\n\n<p>Ideas of why the varying behavior?  Is there a better/alternate way to check for unsaved data?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1573054739, "post_id": 58733718, "comment_id": 103757619, "body": "Does the path end with  \\ ?"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 1, "creation_date": 1573054861, "post_id": 58733718, "comment_id": 103757702, "body": "What are the values of A26 and B26? All of this code is essentially equal to the single line <code>If Dir(ThisWorkbook.Sheets(&quot;Sheet1&quot;).Range(&quot;A26&quot;))&lt;&gt; &quot;&quot; Then FileCopy ThisWorkbook.Sheets(&quot;Sheet1&quot;).Range(&quot;A26&quot;), ThisWorkbook.Sheets(&quot;Sheet1&quot;).Range(&quot;B26&quot;) &amp; ThisWorkbook.Sheets(&quot;Sheet1&quot;).Range(&quot;A26&quot;)</code> I&#39;m not suggesting you change to that, but does that make sense for what you are trying to do?"}, {"owner": {"reputation": 3, "user_id": 11317644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c04eba12eba6c8c18e6a282bd324547?s=128&d=identicon&r=PG&f=1", "display_name": "rob_is_great", "link": "https://stackoverflow.com/users/11317644/rob-is-great"}, "edited": false, "score": 0, "creation_date": 1573056258, "post_id": 58733718, "comment_id": 103758482, "body": "Maybe it doesn&#39;t make sense for what I am trying to do, and I just noticed that. I probably don&#39;t need the if statement at all. Cell A26 contains the file path for the source file, and cell B26 contains the destination file path (pointing to a folder with no file in it at present)."}], "owner": {"reputation": 3, "user_id": 11317644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c04eba12eba6c8c18e6a282bd324547?s=128&d=identicon&r=PG&f=1", "display_name": "rob_is_great", "link": "https://stackoverflow.com/users/11317644/rob-is-great"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573054688, "creation_date": 1573054662, "last_edit_date": 1573054688, "question_id": 58733718, "link": "https://stackoverflow.com/questions/58733718/copy-file-based-upon-file-path-in-cell-to-destination-file-path-specified-in-ano", "title": "Copy file based upon file path in cell to destination file path specified in another cell?", "body": "<p>I have a reasonably regular monthly process where I am trying to move files from one folder to another. It is several files in several different source folders to several destination folders. To save myself time I'd like to create a Macro in a third sort of directory file that copies the files based upon the given file path in one cell (we'll call this the \"source\") to the file path given in some other cell (\"destination\"). I wanted to start this using just one source file being moved to one destination path, with the idea that I can later duplicate the macro for several of these files. I have put together some code using something similar found here, but it isn't seeming to find either the file or path.</p>\n\n<pre><code>Dim rngFile As Range, cel As Range\nDim desPath As String, filename As String\n\nSet rngFile = ThisWorkbook.Sheets(\"Sheet1\").Range(\"A26\")\n\ndesPath = ThisWorkbook.Sheets(\"Sheet1\").Range(\"B26\") 'change to a valid path\n\nFor Each cel In rngFile\n    If Dir(cel) &lt;&gt; \"\" Then\n        filename = Dir(cel) 'Returns the filename\n        FileCopy cel, desPath &amp; filename 'copy to folder\n    End If\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1573055182, "post_id": 58733648, "comment_id": 103757884, "body": "<code>Set sinepRng = Range(&quot;A1:A14&quot;).Find(&quot;b&quot;).FindNext(sinepRng)</code> looks very suspect."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1573055849, "post_id": 58733648, "comment_id": 103758245, "body": "Remove the <code>.Find(&quot;b&quot;)</code> part of that line."}, {"owner": {"reputation": 1, "user_id": 12332907, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eKOtv.png?s=128&g=1", "display_name": "hoodoo", "link": "https://stackoverflow.com/users/12332907/hoodoo"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1573111412, "post_id": 58733648, "comment_id": 103776476, "body": "@Rory thanks, that did it! I don&#39;t know why I imagined I needed to restate the .Find in that line."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 12332907, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eKOtv.png?s=128&g=1", "display_name": "hoodoo", "link": "https://stackoverflow.com/users/12332907/hoodoo"}, "is_accepted": false, "score": 0, "last_activity_date": 1573111507, "creation_date": 1573111507, "answer_id": 58743825, "question_id": 58733648, "link": "https://stackoverflow.com/questions/58733648/how-to-find-values-in-a-range-with-findnext/58743825#58743825", "title": "How to find values in a range with .FindNext?", "body": "<p>Thanks @Rory for the solution.</p>\n\n<p>I had to remove <code>.find(\"b\")</code> from the line <code>Set sinepRng = Range(\"A1:A14\").Find(\"b\").FindNext(sinepRng)</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 12332907, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eKOtv.png?s=128&g=1", "display_name": "hoodoo", "link": "https://stackoverflow.com/users/12332907/hoodoo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1605704831, "creation_date": 1573054417, "last_edit_date": 1605704831, "question_id": 58733648, "link": "https://stackoverflow.com/questions/58733648/how-to-find-values-in-a-range-with-findnext", "title": "How to find values in a range with .FindNext?", "body": "<p>I need to find cells with a value of &quot;b&quot; in range A1:A14. There are three such values in that range.<br />\nIf a value is found, then set B2 to &quot;yes&quot;, and then offset one row below.</p>\n<p>In this code I wrote the <code>findNext</code> function doesn't work.</p>\n<pre><code>Sub sinep()\n\nDim sinepRng As Range\nDim rangeRover As Range\n\nSet rangeRover = Range(&quot;B2&quot;)\nSet sinepRng = Range(&quot;A1:A14&quot;).Find(&quot;b&quot;, LookIn:=xlValues)\n\nIf Not sinepRng Is Nothing Then\n    firstAddress = sinepRng.Address\n    MsgBox &quot;first address &quot; &amp; firstAddress\n    Do\n    rangeRover.Value = &quot;yes&quot;\n    Set rangeRover = rangeRover.Offset(1, 0)\n    Set sinepRng = Range(&quot;A1:A14&quot;).Find(&quot;b&quot;).FindNext(sinepRng)\n    MsgBox &quot;third address &quot; &amp; sinepRng.Address\n    If sinepRng Is Nothing Then\n        MsgBox &quot;isnothing&quot;\n        GoTo DoneFinding\n        End If\n    Loop While sinepRng.Address &lt;&gt; firstAddress\n    End If\nDoneFinding:\n</code></pre>\n<p>This code does work.</p>\n<pre><code>Sub nag()\n\nDim rangeRover As Range\nSet rangeRover = Range(&quot;B2&quot;)\n\nWith Worksheets(1).Range(&quot;a1:a500&quot;)\n     Set c = .Find(&quot;b&quot;, LookIn:=xlValues)\n     If Not c Is Nothing Then\n        firstAddress = c.Address\n        Do\n            rangeRover.Value = &quot;yes&quot;\n            Set rangeRover = rangeRover.Offset(1, 0)\n            Set c = .FindNext(c)\n        If c Is Nothing Then\n            GoTo DoneFinding\n        End If\n        Loop While c.Address &lt;&gt; firstAddress\n      End If\nDoneFinding:\nEnd With\n\nEnd Sub\n</code></pre>\n<p>I figure the problem lies within the <code>findNext</code>. I tried modifying it without success. I also tried using <code>Find</code> with After parameter.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1573054415, "post_id": 58733602, "comment_id": 103757426, "body": "Might be worth giving <a href=\"https://rubberduckvba.wordpress.com/2017/10/25/userform1-show/\" rel=\"nofollow noreferrer\">this article</a> a read for more detail on why not to <code>Unload Me</code> or <code>UserForm1.Show</code>."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1573054426, "post_id": 58733602, "comment_id": 103757437, "body": "Do something like this for each control - <code>txtDimension = &quot;&quot;</code>"}, {"owner": {"reputation": 79, "user_id": 12232855, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nkzr1.jpg?s=128&g=1", "display_name": "Malachilee", "link": "https://stackoverflow.com/users/12232855/malachilee"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1573056269, "post_id": 58733602, "comment_id": 103758485, "body": "@BigBen I have read that article, it helped me on another part of this project, but it is well above my current skillset though. I&#39;ve been trying to apply it to my reset button, but no luck.:("}, {"owner": {"reputation": 79, "user_id": 12232855, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nkzr1.jpg?s=128&g=1", "display_name": "Malachilee", "link": "https://stackoverflow.com/users/12232855/malachilee"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1573057515, "post_id": 58733602, "comment_id": 103759190, "body": "@braX That worked! Thank you"}], "owner": {"reputation": 79, "user_id": 12232855, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nkzr1.jpg?s=128&g=1", "display_name": "Malachilee", "link": "https://stackoverflow.com/users/12232855/malachilee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573054386, "creation_date": 1573054293, "last_edit_date": 1573054386, "question_id": 58733602, "link": "https://stackoverflow.com/questions/58733602/how-to-save-workbook-and-clear-userform-with-a-commandbutton", "title": "How to save workbook and clear userform with a CommandButton?", "body": "<p>I'm trying to save my excel workbook and clear my userform inputs with a reset button. </p>\n\n<p>I've tried a few different things like <code>ThisWorkbook.Save</code> and  <code>UserForm1.Show</code> but its not working right.  The code posted looks like it saves and reloads the userform, but then it closes. What am I missing?</p>\n\n<pre><code>Private Sub CommandButton11_Click()\n    Application.ScreenUpdating = False\n    Unload Me\n    UserForm1.Show\n    Application.ScreenUpdating = True\n    ThisWorkbook.Save\nEnd Sub\n</code></pre>\n\n<p>I would like the user to input data into the form then click the reset button so that it saves and clears the form to be used agian.</p>\n\n<p><a href=\"https://i.stack.imgur.com/R5Pzv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/R5Pzv.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 11285985, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-m2VTRGwGY8I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3renUEBHBsJ9plMrFkRqnHg9xFaaFA/mo/photo.jpg?sz=128", "display_name": "SmackedHard", "link": "https://stackoverflow.com/users/11285985/smackedhard"}, "edited": false, "score": 0, "creation_date": 1573055027, "post_id": 58733606, "comment_id": 103757799, "body": "Eugene, 1. The reports come it at completely different times it should only be moving one item at a time. That is good to know though -- is there a work around for this ? 2. I tried hard coding it just now -- same issue. Though since the directory already exists that line shouldn&#39;t even be running ?"}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 27, "user_id": 11285985, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-m2VTRGwGY8I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3renUEBHBsJ9plMrFkRqnHg9xFaaFA/mo/photo.jpg?sz=128", "display_name": "SmackedHard", "link": "https://stackoverflow.com/users/11285985/smackedhard"}, "edited": false, "score": 0, "creation_date": 1573055119, "post_id": 58733606, "comment_id": 103757846, "body": "As a workaround, you may use a timer for checking the number of items and processing new ones."}, {"owner": {"reputation": 27, "user_id": 11285985, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-m2VTRGwGY8I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3renUEBHBsJ9plMrFkRqnHg9xFaaFA/mo/photo.jpg?sz=128", "display_name": "SmackedHard", "link": "https://stackoverflow.com/users/11285985/smackedhard"}, "edited": false, "score": 0, "creation_date": 1573065044, "post_id": 58733606, "comment_id": 103763059, "body": "Solved: I was missing a closing paren in my if statement causing the path issue. Item add doesn&#39;t seem to trigger when rules are manually run but it does work when it runs automatically."}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": true, "score": 0, "last_activity_date": 1573055165, "last_edit_date": 1573055165, "creation_date": 1573054298, "answer_id": 58733606, "question_id": 58733359, "link": "https://stackoverflow.com/questions/58733359/code-doesnt-execute-when-moved-by-inbox-rule/58733606#58733606", "title": "Code doesn&#39;t execute when moved by inbox rule", "body": "<blockquote>\n  <ol>\n  <li>The code doesn't run when the rule moves the email only when I manually move the email.</li>\n  </ol>\n</blockquote>\n\n<p>If multiple items are moved to a folder, the <code>ItemAdd</code> event may not be fired. This is a known issue in Outlook.</p>\n\n<p>Another possible cause is that an Outlook rule is run before <code>Application_Startup</code>. </p>\n\n<blockquote>\n  <ol start=\"2\">\n  <li>It creates the new directories just fine and saves the first emails attachment however additional emails gives a path/access error</li>\n  </ol>\n</blockquote>\n\n<p>Make sure you use symbols allowed in the path or files. I'd suggest trying to create the same path manually to make only allowed symbols were used in the path.</p>\n"}], "owner": {"reputation": 27, "user_id": 11285985, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-m2VTRGwGY8I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3renUEBHBsJ9plMrFkRqnHg9xFaaFA/mo/photo.jpg?sz=128", "display_name": "SmackedHard", "link": "https://stackoverflow.com/users/11285985/smackedhard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18, "favorite_count": 0, "accepted_answer_id": 58733606, "answer_count": 1, "score": 0, "last_activity_date": 1573055165, "creation_date": 1573053518, "last_edit_date": 1573054572, "question_id": 58733359, "link": "https://stackoverflow.com/questions/58733359/code-doesnt-execute-when-moved-by-inbox-rule", "title": "Code doesn&#39;t execute when moved by inbox rule", "body": "<p>I have a few daily reports (excel files) that are emailed to me. An inbox rule moves the email to an outlook folder titled \"Daily Reports\" </p>\n\n<p>When the email is moved into the folder by the rule, I would like the attachments to be automatically saved to a folder and organized by date. Something like: C:\\Desktop\\ReportName\\2019\\11-2019\\11-05-2019 Report Name.xlsx</p>\n\n<p>However, I am having a couple of issues. </p>\n\n<ol>\n<li>The code doesn't run when the rule moves the email only when I manually move the email. </li>\n<li>It creates the new directories just fine and saves the first emails attachment  however additional emails gives a path/access error referencing this line \"\n     MkDir (\"C:\\Users\\username\\Desktop\\Outlook Test Folder\\\" &amp; Format(Date, \"YYYY\"))\"</li>\n</ol>\n\n<pre><code>Private WithEvents olItems As Outlook.Items\n\nPrivate Sub Application_Startup()\n    Dim objNS As Outlook.NameSpace\n\n    Set objNS = GetNamespace(\"MAPI\")\n    Set olItems = objNS.GetDefaultFolder(olFolderInbox).Parent.Folders(\"Daily Reports\").Items\n    Set objNS = Nothing\nEnd Sub\n\nPrivate Sub olItems_ItemAdd(ByVal Item As Object)\n    Dim NewMail As Outlook.MailItem\n    Dim Atts As Attachments\n    Dim strPath As String\n    Dim attName As String\n\n    If Item.Class = olMail Then\n        Set NewMail = Item\n    End If\n\n    If Dir(\"C:\\Users\\username\\Desktop\\Outlook Test Folder\\\" &amp; Format(Date, \"YYYY\"), vbDirectory) = \"\" Then\n        MkDir (\"C:\\Users\\username\\Desktop\\Outlook Test Folder\\\" &amp; Format(Date, \"YYYY\"))\n    End If\n\n    If Dir(\"C:\\Users\\username\\Desktop\\Outlook Test Folder\\\" &amp; Format(Date, \"YYYY\" &amp; \"\\\" &amp; Format(Date, \"MM-YYYY\")), vbDirectory) = \"\" Then\n        MkDir (\"C:\\Users\\username\\Desktop\\Outlook Test Folder\\\" &amp; Format(Date, \"YYYY\") &amp; \"\\\" &amp; Format(Date, \"MM-YYYY\"))\n    End If\n\n    If InStr(LCase(Item.Subject), \"daily applications was executed at\") &gt; 0 Then\n       strPath = \"C:\\Users\\username\\Desktop\\Outlook Test Folder\\\" &amp; Format(Date, \"YYYY\") &amp; \"\\\" &amp; Format(Date, \"MM-YYYY\")\n       attName = \" Daily Applications.Xlsx\"\n    ElseIf InStr(LCase(Item.Subject), \"dailyopenedcalls was executed at\") &gt; 0 Then\n            strPath = \"C:\\Users\\username\\Desktop\\Outlook Test Folder\\\" &amp; Format(Date, \"YYYY\") &amp; \"\\\" &amp; Format(Date, \"MM-YYYY\")\n            attName = \" Daily Opened Calls.Xlsx\"\n    End If\n\n    Set Atts = Item.Attachments\n\n    If Atts.Count &gt; 0 Then\n        For Each Att In Atts\n            If InStr(LCase(Att.FileName), \".xlsx\") &gt; 0 Then\n                Att.SaveAsFile strPath &amp; \"\\\" &amp; Format(Date, \"mm-dd-yyyy\") &amp; attName\n            End If\n        Next\n    End If\n\nEnd Sub\n```\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1573052293, "post_id": 58732837, "comment_id": 103756068, "body": "On which line is the error?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1573052422, "post_id": 58732837, "comment_id": 103756138, "body": "You can&#39;t compare <code>Target.Value</code> to a string if <code>Target</code> is a multi-cell range. What is the address of <code>Target</code>?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1573052529, "post_id": 58732837, "comment_id": 103756199, "body": "Also - <code>Range(Target.Address)</code> is redundant. Just use <code>Target</code>."}, {"owner": {"reputation": 13, "user_id": 12232909, "user_type": "registered", "profile_image": "https://graph.facebook.com/10162311653990277/picture?type=large", "display_name": "Andrius Gataveckas", "link": "https://stackoverflow.com/users/12232909/andrius-gataveckas"}, "edited": false, "score": 0, "creation_date": 1573052595, "post_id": 58732837, "comment_id": 103756232, "body": "My bad, the error shows up on the third line of the newly added block, which is this:         Case &quot;Included&quot;"}, {"owner": {"reputation": 13, "user_id": 12232909, "user_type": "registered", "profile_image": "https://graph.facebook.com/10162311653990277/picture?type=large", "display_name": "Andrius Gataveckas", "link": "https://stackoverflow.com/users/12232909/andrius-gataveckas"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1573052985, "post_id": 58732837, "comment_id": 103756472, "body": "@BigBen sorry, I don&#39;t think I get your first comment. This is probably one of my first codes, I don&#39;t think I am comparing anything here, but instead I want to say that if there is a specific value within a specific cell, then unhide a specific row."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1573053262, "post_id": 58732837, "comment_id": 103756662, "body": "What is <code>Target.Address</code>? <code>Case &quot;Included&quot;</code> compares <code>Target.Value</code> to the string <code>&quot;Included&quot;</code>. But if <code>Target</code> actually is multiple cells, then this comparison will fail."}, {"owner": {"reputation": 13, "user_id": 12232909, "user_type": "registered", "profile_image": "https://graph.facebook.com/10162311653990277/picture?type=large", "display_name": "Andrius Gataveckas", "link": "https://stackoverflow.com/users/12232909/andrius-gataveckas"}, "edited": false, "score": 0, "creation_date": 1573054254, "post_id": 58732837, "comment_id": 103757309, "body": "The address is a cell at B13 and yes, there are more cells, B13:B23 contains all values as &quot;Not included&quot; by default. I somehow have a feeling, that addressing a specific cell with Target.Column And Target.Row does not work as expected, but I don&#39;t know how to specify it otherwise. Thanks."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1573054774, "post_id": 58732837, "comment_id": 103757650, "body": "You are right. If your range is <code>B13:B23</code>, then its <code>.Row</code> is 13 and its <code>.Column</code> is 2. Are you concerned with the entire range <code>B13:B23</code>, or do you just want to work with <code>B13</code>?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1573055422, "post_id": 58732837, "comment_id": 103758004, "body": "You probably need to toggle <code>Application.EnableEvents</code> to <code>False</code> at the beginning and then to <code>True</code> at the end. <code>[B13:B23].Value = &quot;Not included&quot;</code> - any time you modify the sheet within the worksheet_change event, the event fires again. Is that what you want?"}, {"owner": {"reputation": 13, "user_id": 12232909, "user_type": "registered", "profile_image": "https://graph.facebook.com/10162311653990277/picture?type=large", "display_name": "Andrius Gataveckas", "link": "https://stackoverflow.com/users/12232909/andrius-gataveckas"}, "edited": false, "score": 0, "creation_date": 1573112042, "post_id": 58732837, "comment_id": 103776794, "body": "I only want to work with B13 and yes, every time my top level drop down is changed, I basically revert the selections made in the section to blanks or default values, such as &quot;Not included&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 12232909, "user_type": "registered", "profile_image": "https://graph.facebook.com/10162311653990277/picture?type=large", "display_name": "Andrius Gataveckas", "link": "https://stackoverflow.com/users/12232909/andrius-gataveckas"}, "is_accepted": false, "score": 0, "last_activity_date": 1573126092, "creation_date": 1573126092, "answer_id": 58747808, "question_id": 58732837, "link": "https://stackoverflow.com/questions/58732837/run-time-error-13-type-mismatch-when-hiding-unhiding-rows/58747808#58747808", "title": "Run time error &#39;13&#39; type mismatch when hiding/unhiding rows", "body": "<p>I have eventually managed to overcome the error by changing the mentioned block of the code to this:</p>\n\n<pre><code>    If Range(\"B13\").Value = \"Included\" Then\n    [9:9].EntireRow.Hidden = False\n    Else\n    [9:9].EntireRow.Hidden = True\n    End If\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 12232909, "user_type": "registered", "profile_image": "https://graph.facebook.com/10162311653990277/picture?type=large", "display_name": "Andrius Gataveckas", "link": "https://stackoverflow.com/users/12232909/andrius-gataveckas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573126092, "creation_date": 1573051974, "last_edit_date": 1573053147, "question_id": 58732837, "link": "https://stackoverflow.com/questions/58732837/run-time-error-13-type-mismatch-when-hiding-unhiding-rows", "title": "Run time error &#39;13&#39; type mismatch when hiding/unhiding rows", "body": "<p>I have built a dynamic excel form, where all the relevant rows unhide only when you make a selection from a drop down list. Everything was working fine, until I have decided to add more rows and want them to be hidden within the section, until a specific selection is made. In other words, my sections unhide based on the top selection, but now there is a need to keep some rows hidden within those sections, until a drop down triggers them to unhide.</p>\n\n<p>I have tried to break down the section unhiding in to pieces, like instead of unhiding whole 10 rows, I only unhide some first rows and then the rest ones, while keeping the middle ones hidden, until they are triggered by another selection.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Column = 2 And Target.Row = 2 Then\n       Select Case Target.Value\n        Case \"New deployment\"\n            [3:3].EntireRow.Hidden = False\n        Case Else\n            [3:76].EntireRow.Hidden = True\n            [B5:B11].ClearContents\n            [B31:B38].ClearContents\n            [B40:B46].ClearContents\n            [B13:B23].Value = \"Not included\"\n            [B48:B58].Value = \"Not included\"\n            [B3:B3].Value = \"Please select\"\n       End Select\n    End If    \n    If Target.Column = 2 And Target.Row = 3 Then\n            Select Case Target.Value\n            Case \"One device\"\n                [4:29].EntireRow.Hidden = False\n                [8:9].EntireRow.Hidden = True\n                [30:76].EntireRow.Hidden = True\n                [B31:B38].ClearContents\n                [B40:B46].ClearContents\n                [B48:B58].Value = \"Not included\"\n            Case \"Two devices\"\n                [4:29].EntireRow.Hidden = True\n                [30:64].EntireRow.Hidden = False\n                [34:35].EntireRow.Hidden = True\n                [43:44].EntireRow.Hidden = True\n                [B5:B11].ClearContents\n                [B13:B23].Value = \"Not included\"\n            Case Else\n                [4:76].EntireRow.Hidden = True\n                [B5:B11].ClearContents\n                [B31:B38].ClearContents\n                [B40:B46].ClearContents\n                [B13:B23].Value = \"Not included\"\n                [B48:B58].Value = \"Not included\"\n           End Select\n        End If\n\n        If Target.Column = 2 And Target.Row = 2 Then\n           Select Case Target.Value\n            Case \"Modification\"\n                [65:70].EntireRow.Hidden = False\n            Case Else\n                [65:70].EntireRow.Hidden = True\n           End Select\n        End If\n\n        If Target.Column = 2 And Target.Row = 2 Then\n           Select Case Target.Value\n            Case \"Disconnect\"\n                [71:76].EntireRow.Hidden = False\n            Case Else\n                [71:76].EntireRow.Hidden = True\n           End Select\n        End If\n\n        If Target.Column = 2 And Target.Row = 13 Then\n           Select Case Target.Value\n            Case \"Included\"\n                [9:9].EntireRow.Hidden = False\n            Case Else\n                [9:9].EntireRow.Hidden = True\n           End Select\n        End If\n\n        If Not Application.Intersect([B5:B5], Range(Target.Address)) Is Nothing Then\n           [B6:B7].ClearContents\n        End If\n\n        If Not Application.Intersect([B31:B31], Range(Target.Address)) Is Nothing Then\n           [B32:B33].ClearContents\n        End If\n\n        If Not Application.Intersect([B40:B40], Range(Target.Address)) Is Nothing Then\n           [B41:B42].ClearContents\n        End If\n\n        If Not Application.Intersect([B6:B6], Range(Target.Address)) Is Nothing Then\n           [B7:B7].ClearContents\n        End If\n\n        If Not Application.Intersect([B32:B32], Range(Target.Address)) Is Nothing Then\n           [B33:B33].ClearContents\n        End If\n\n        If Not Application.Intersect([B41:B41], Range(Target.Address)) Is Nothing Then\n           [B42:B42].ClearContents\n        End If\n    End Sub\n</code></pre>\n\n<p>The </p>\n\n<blockquote>\n  <p>mismatch error '13'</p>\n</blockquote>\n\n<p>began to appear as soon as I have added the following block:</p>\n\n<pre><code>If Target.Column = 2 And Target.Row = 13 Then\n   Select Case Target.Value\n    Case \"Included\"\n        [9:9].EntireRow.Hidden = False\n    Case Else\n        [9:9].EntireRow.Hidden = True\n   End Select\nEnd If\n</code></pre>\n"}, {"tags": ["excel", "vba", "list", "validation"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1573051787, "post_id": 58732695, "comment_id": 103755776, "body": "You could do this using the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheet.change\" rel=\"nofollow noreferrer\"><code>worksheet_change()</code></a> event. When the cell containing your first drop down experiences a change, that event will fire and the code inside of it&#39;s subroutine will run. In there you can define your second list based off of <code>Target.Value</code> (what was chosen in the first list that fired that event. Best of luck!"}, {"owner": {"reputation": 356, "user_id": 9635098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a781d7fd3cacab5fbc08554bc8dfb759?s=128&d=identicon&r=PG&f=1", "display_name": "Beek", "link": "https://stackoverflow.com/users/9635098/beek"}, "edited": false, "score": 0, "creation_date": 1573051945, "post_id": 58732695, "comment_id": 103755869, "body": "One way would be to use named ranges. something like this: <a href=\"https://trumpexcel.com/dependent-drop-down-list-in-excel/\" rel=\"nofollow noreferrer\">trumpexcel.com/dependent-drop-down-list-in-excel</a>"}], "owner": {"reputation": 11, "user_id": 11633717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc27a15e8e22bd30771be3806222cefd?s=128&d=identicon&r=PG&f=1", "display_name": "usuario_estudo", "link": "https://stackoverflow.com/users/11633717/usuario-estudo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573054007, "creation_date": 1573051654, "last_edit_date": 1573054007, "question_id": 58732695, "link": "https://stackoverflow.com/questions/58732695/how-can-i-create-a-dependent-list-using-data-validation-in-vba", "title": "How can I create a dependent list using data validation in VBA?", "body": "<p>I'm creating a drop down list using the code above:</p>\n\n<pre><code>            For Each Value In wb1.Range(\"B6:B\" &amp; LastRow)\n            Lista = Lista &amp; \",\" &amp; Value\n            Next Value\n\n            Lista2 = Lista &amp; \",\" &amp; \",A,B,C,D,E,F,G\"\n\n            With Cells(30,39).Validation\n            .Delete\n            .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _\n            xlBetween, Formula1:=Lista2\n            End With\n</code></pre>\n\n<p>But now I'm trying to create a dependent list using VBA. I want to put conditions for my list, being dependent on the value of the left column.</p>\n\n<p>If left column value is \"AL\" or \"SD\" I want to have Lista &amp; \",\" &amp; \",A,B\" list selection, if \"PC\" I want to have \"C,D,E\" and if it's \"LV\" I want it to have \"F,G\"</p>\n\n<p>Could someone please help me with this?</p>\n"}, {"tags": ["python", "excel", "vba"], "comments": [{"owner": {"reputation": 11919, "user_id": 9183344, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U7r5r.png?s=128&g=1", "display_name": "r.ook", "link": "https://stackoverflow.com/users/9183344/r-ook"}, "edited": false, "score": 0, "creation_date": 1573052169, "post_id": 58732637, "comment_id": 103755993, "body": "You should be able to accomplish this by <code>shell.Run &quot;py &quot;&quot;&quot; &amp; scriptPath &amp; &quot;&quot;&quot;&quot;</code>.  <code>ModuleNotFoundError</code> sounds to me you are using a <code>venv</code> of some sort?"}, {"owner": {"reputation": 1, "user_id": 12326807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f94f1067037674204428d09a445f0595?s=128&d=identicon&r=PG&f=1", "display_name": "svzap", "link": "https://stackoverflow.com/users/12326807/svzap"}, "reply_to_user": {"reputation": 11919, "user_id": 9183344, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U7r5r.png?s=128&g=1", "display_name": "r.ook", "link": "https://stackoverflow.com/users/9183344/r-ook"}, "edited": false, "score": 0, "creation_date": 1573058606, "post_id": 58732637, "comment_id": 103759829, "body": "Hi r.ook! I am new to coding so forgive me. I developed the script in VSCode with Python3. Is there a way to run it as Jupyter notebook or in VSCode instead of Python 3 from the command line? I think that is why it cannot find the packages."}, {"owner": {"reputation": 11919, "user_id": 9183344, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U7r5r.png?s=128&g=1", "display_name": "r.ook", "link": "https://stackoverflow.com/users/9183344/r-ook"}, "edited": false, "score": 0, "creation_date": 1573058787, "post_id": 58732637, "comment_id": 103759946, "body": "That&#39;s not what I mean.  If you see <code>ModuleNotFoundError</code> for a module like <code>pandas</code>, it probably means your PATH environment probably isn&#39;t set up right, or you&#39;re using a <code>venv</code> and forgot to activate it.  It would also help if you included a snippet of your python script in the question, so that a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> is shown."}, {"owner": {"reputation": 1, "user_id": 12326807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f94f1067037674204428d09a445f0595?s=128&d=identicon&r=PG&f=1", "display_name": "svzap", "link": "https://stackoverflow.com/users/12326807/svzap"}, "reply_to_user": {"reputation": 11919, "user_id": 9183344, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U7r5r.png?s=128&g=1", "display_name": "r.ook", "link": "https://stackoverflow.com/users/9183344/r-ook"}, "edited": false, "score": 0, "creation_date": 1573063907, "post_id": 58732637, "comment_id": 103762510, "body": "I added the path environment &quot;C:\\Program Files\\Python37&quot; to control panel-&gt;user accounts-&gt;change my env variables. I cannot add it to control panel-&gt;systems-&gt;advanced system settings because I do not have the admin rights to access it. I will check if the venv is active."}, {"owner": {"reputation": 1, "user_id": 12326807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f94f1067037674204428d09a445f0595?s=128&d=identicon&r=PG&f=1", "display_name": "svzap", "link": "https://stackoverflow.com/users/12326807/svzap"}, "reply_to_user": {"reputation": 11919, "user_id": 9183344, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U7r5r.png?s=128&g=1", "display_name": "r.ook", "link": "https://stackoverflow.com/users/9183344/r-ook"}, "edited": false, "score": 0, "creation_date": 1573127004, "post_id": 58732637, "comment_id": 103784462, "body": "The solution was to activate the environment, thanks!"}], "owner": {"reputation": 1, "user_id": 12326807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f94f1067037674204428d09a445f0595?s=128&d=identicon&r=PG&f=1", "display_name": "svzap", "link": "https://stackoverflow.com/users/12326807/svzap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 199, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1612372801, "creation_date": 1573051436, "last_edit_date": 1573060312, "question_id": 58732637, "link": "https://stackoverflow.com/questions/58732637/running-python-script-from-excel-using-vba-working-with-network-paths-module", "title": "Running Python script from Excel using vba (working with network paths) - Module Not Found Error", "body": "<p>I am trying to run a Python script from Excel VBA. The script and the excel workbook are saved in different network folders. </p>\n\n<p>The script works when run in VS Code or Jupyter (python37). </p>\n\n<p>For the purpose of testing the macro, I am currently using a simpler script (see below).</p>\n\n<pre><code>import pandas as pd\n\ntest = {'clmn1': ['a','b'], 'clmn2': [1,2]}\n\ndf = pd.DataFrame.from_dict(test)\n\ndf.to_excel('test_script.xlsx')\n</code></pre>\n\n<p>I have tested different solutions but I cannot make it work.\nThe one below returns ModuleNotFoundError for pandas. </p>\n\n<pre><code>Dim shell As Object\nDim exePath, scriptPath As String\n\nSet shell = VBA.CreateObject(\"Wscript.Shell\")\n\nexePath = \"\"\"&lt; python exe path&gt;\"\"\"\nscriptPath = \"&lt;python script network path&gt;\"\n\nshell.Run \"cmd /k\" &amp; \" \" &amp; exePath &amp; \" \" &amp; scriptPath\n</code></pre>\n\n<p>I would be happy with any other solution that allows me to press a button in excel and run the script.</p>\n"}, {"tags": ["excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 859, "user_id": 12287457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d389583f0df341fc39dd1e352a08794?s=128&d=identicon&r=PG&f=1", "display_name": "GWD", "link": "https://stackoverflow.com/users/12287457/gwd"}, "edited": false, "score": 0, "creation_date": 1573050374, "post_id": 58732190, "comment_id": 103754945, "body": "There needs to be a Range Object to use copy on. Your Code is trying to Copy the Excel_App, this can not work..."}, {"owner": {"reputation": 13, "user_id": 10226211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/930bffd96fd0e3d1509156472e761ece?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/10226211/sebastian"}, "reply_to_user": {"reputation": 859, "user_id": 12287457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d389583f0df341fc39dd1e352a08794?s=128&d=identicon&r=PG&f=1", "display_name": "GWD", "link": "https://stackoverflow.com/users/12287457/gwd"}, "edited": false, "score": 0, "creation_date": 1573050482, "post_id": 58732190, "comment_id": 103755016, "body": "@GWD I am really unfamiliar with VBA could you suggest some code that might work"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10226211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/930bffd96fd0e3d1509156472e761ece?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/10226211/sebastian"}, "edited": false, "score": 0, "creation_date": 1573051371, "post_id": 58732371, "comment_id": 103755502, "body": "Man, this works perfect, if only the columns were adjusted and also the headings from the access table didn&#39;t transfer over"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 13, "user_id": 10226211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/930bffd96fd0e3d1509156472e761ece?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/10226211/sebastian"}, "edited": false, "score": 0, "creation_date": 1573051419, "post_id": 58732371, "comment_id": 103755539, "body": "This is also possible. I updated the code and it will transfer the headings. What do you mean with <i>columns were adjusted</i>?"}, {"owner": {"reputation": 13, "user_id": 10226211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/930bffd96fd0e3d1509156472e761ece?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/10226211/sebastian"}, "edited": false, "score": 0, "creation_date": 1573051775, "post_id": 58732371, "comment_id": 103755766, "body": "Thanks, and I meant to make everything fit accordingly to display in a cell"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 13, "user_id": 10226211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/930bffd96fd0e3d1509156472e761ece?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/10226211/sebastian"}, "edited": false, "score": 0, "creation_date": 1573052069, "post_id": 58732371, "comment_id": 103755932, "body": "I added code to <i>autofit</i> the columms. Is that what you are after?"}, {"owner": {"reputation": 13, "user_id": 10226211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/930bffd96fd0e3d1509156472e761ece?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/10226211/sebastian"}, "edited": false, "score": 0, "creation_date": 1573052495, "post_id": 58732371, "comment_id": 103756185, "body": "Absolutely! Man I tried giving your comment a up-vote but am unable too because my rep. inst high enough, but thanks again for all the help and quick responses!"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 13, "user_id": 10226211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/930bffd96fd0e3d1509156472e761ece?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/10226211/sebastian"}, "edited": false, "score": 0, "creation_date": 1573052551, "post_id": 58732371, "comment_id": 103756206, "body": "You can always <a href=\"https://stackoverflow.com/help/someone-answers\">accept</a> the answer."}, {"owner": {"reputation": 13, "user_id": 10226211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/930bffd96fd0e3d1509156472e761ece?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/10226211/sebastian"}, "edited": false, "score": 0, "creation_date": 1573131029, "post_id": 58732371, "comment_id": 103786727, "body": "after adding the following code to my vba I am getting a run time error 3008 that a table that I am using is already open by another user or interface and cannot be manipulated pro-grammatically? I am unsure what is causing this issue as there was not issue to this before I added the code you provided. I will post the following code above underneath my existing code. Is there anyway you can help me solve this issue? thanks!"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 13, "user_id": 10226211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/930bffd96fd0e3d1509156472e761ece?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/10226211/sebastian"}, "edited": false, "score": 0, "creation_date": 1573131109, "post_id": 58732371, "comment_id": 103786757, "body": "Please create a new question because this is a different issue."}, {"owner": {"reputation": 13, "user_id": 10226211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/930bffd96fd0e3d1509156472e761ece?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/10226211/sebastian"}, "edited": false, "score": 0, "creation_date": 1573131837, "post_id": 58732371, "comment_id": 103787124, "body": "opps I am just now seeing this after I added it? Should I delete this and create a new question? How will I be sure you will be able to help and see the new question I am asking?"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 13, "user_id": 10226211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/930bffd96fd0e3d1509156472e761ece?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/10226211/sebastian"}, "edited": false, "score": 0, "creation_date": 1573132994, "post_id": 58732371, "comment_id": 103787722, "body": "Link to this question but of course other users might be quicker than me. That should not be a big deal."}, {"owner": {"reputation": 13, "user_id": 10226211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/930bffd96fd0e3d1509156472e761ece?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/10226211/sebastian"}, "edited": false, "score": 0, "creation_date": 1573134353, "post_id": 58732371, "comment_id": 103788430, "body": "<a href=\"https://stackoverflow.com/questions/58749900/run-time-error-3006-when-trying-to-run-a-delete-query-error-is-saying-that-the\" title=\"run time error 3006 when trying to run a delete query error is saying that the\">stackoverflow.com/questions/58749900/&hellip;</a>"}, {"owner": {"reputation": 13, "user_id": 10226211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/930bffd96fd0e3d1509156472e761ece?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/10226211/sebastian"}, "edited": false, "score": 0, "creation_date": 1573136050, "post_id": 58732371, "comment_id": 103789418, "body": "did you have a chance to look at this?"}, {"owner": {"reputation": 13, "user_id": 10226211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/930bffd96fd0e3d1509156472e761ece?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/10226211/sebastian"}, "edited": false, "score": 0, "creation_date": 1580735827, "post_id": 58732371, "comment_id": 106183680, "body": "any chance you can give me a hand with this code? What I am trying to accomplish now is to perform a santy check after the new window in excel opens up perform a conditional formatting rule basically stating if Column name1 + Column name2 + Column name3 + Column name4 doesn&#39;t equal Column nameX highlight &#39;yellow&#39;"}], "tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": true, "score": 1, "last_activity_date": 1573052029, "last_edit_date": 1573052029, "creation_date": 1573050476, "answer_id": 58732371, "question_id": 58732190, "link": "https://stackoverflow.com/questions/58732190/copy-table-from-access-table-and-paste-into-blank-excel-file/58732371#58732371", "title": "Copy table from access table and paste into blank excel file", "body": "<p>This could be a way</p>\n\n<pre><code>Private Sub Command27_Click()\n    Dim dbs As dao.Database\n    Dim Response As Integer\n    Dim strSQL As String\n    Dim Query1 As String\n\n    Dim LTotal As String\n    Dim Excel_App As Excel.Application 'Creates Blank Excel File\n    Dim strTable As String ' Table in access\n\n\n    strTable = \"tbPrintCenter05Que\" 'Access Query I am trying to copy\n    Set Excel_App = CreateObject(\"Excel.Application\")\n    Set dbs = CurrentDb\n\n    Dim rs As dao.Recordset\n    Set rs = dbs.OpenRecordset(strTable)\n\n    Excel_App.Visible = True\n\n    Dim wkb As Excel.Workbook\n    Set wkb = Excel_App.Workbooks.Add\n\n    Dim rg As Excel.Range\n    Dim i As Long\n    ' Add the headings\n    For i = 0 To rs.Fields.Count - 1\n        wkb.Sheets(1).Cells(1, i + 1).Value = rs.Fields(i).Name\n    Next i\n\n    Set rg = wkb.Sheets(1).Cells(2, 1)\n    rg.CopyFromRecordset rs\n\n    ' make pretty\n    rg.CurrentRegion.EntireColumn.AutoFit\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10226211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/930bffd96fd0e3d1509156472e761ece?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/10226211/sebastian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 1, "accepted_answer_id": 58732371, "answer_count": 1, "score": 0, "last_activity_date": 1613256594, "creation_date": 1573049908, "last_edit_date": 1573053170, "question_id": 58732190, "link": "https://stackoverflow.com/questions/58732190/copy-table-from-access-table-and-paste-into-blank-excel-file", "title": "Copy table from access table and paste into blank excel file", "body": "<p>I am trying to accomplish the transfer of results from an access table into a blank Excel file that is not going to be saved. Basically I have a button on an access form that when pressed its action is going to just preview all the records in the access table in excel. This is the way the user wants it set up. </p>\n\n<p>Right now I have code that will open a blank excel file but I am having troubles writing code that will copy the table from access and paste it into excel, say Cell \"A1\"</p>\n\n<pre><code>Private Sub Command27_Click()\nDim dbs As DAO.Database\nDim Response As Integer\nDim strSQL As String\nDim Query1 As String\n    Dim LTotal As String\n    Dim Excel_App As Excel.Application 'Creates Blank Excel File\n    Dim strTable As String ' Table in access\n\n\n     strTable = \"tbPrintCenter05Que\" 'Access table I am trying to copy\n     Set Excel_App = CreateObject(\"Excel.Application\")\n     Set dbs = CurrentDb\n\n     Excel_App.Visible = True\n     Excel_App.Workbooks.Add\nWith Excel_App\n.Columns(\"A:ZZ\").ColumnWidth = 25\n.Copy ' Getting error on this line \n.Range (\"A\")\n.Paste\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "server", "ftp", "find"], "comments": [{"owner": {"reputation": 144837, "user_id": 850848, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c287735beca76400cb9b6d08bf591cb9?s=128&d=identicon&r=PG", "display_name": "Martin Prikryl", "link": "https://stackoverflow.com/users/850848/martin-prikryl"}, "edited": false, "score": 1, "creation_date": 1573050095, "post_id": 58732121, "comment_id": 103754769, "body": "No. There&#39;s not."}, {"owner": {"reputation": 144837, "user_id": 850848, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c287735beca76400cb9b6d08bf591cb9?s=128&d=identicon&r=PG", "display_name": "Martin Prikryl", "link": "https://stackoverflow.com/users/850848/martin-prikryl"}, "edited": false, "score": 0, "creation_date": 1573053139, "post_id": 58732121, "comment_id": 103756576, "body": "Even the Java question you have added, does not show any better way (except for speeding it up by multithreading)."}, {"owner": {"reputation": 11, "user_id": 12223782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d1a4940ccf374ac5e38adfa95838e1d?s=128&d=identicon&r=PG&f=1", "display_name": "MBMSOFT", "link": "https://stackoverflow.com/users/12223782/mbmsoft"}, "reply_to_user": {"reputation": 144837, "user_id": 850848, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c287735beca76400cb9b6d08bf591cb9?s=128&d=identicon&r=PG", "display_name": "Martin Prikryl", "link": "https://stackoverflow.com/users/850848/martin-prikryl"}, "edited": false, "score": 0, "creation_date": 1573055385, "post_id": 58732121, "comment_id": 103757988, "body": "I might try and another way  if the speed is some acceptable one,"}, {"owner": {"reputation": 11, "user_id": 12223782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d1a4940ccf374ac5e38adfa95838e1d?s=128&d=identicon&r=PG&f=1", "display_name": "MBMSOFT", "link": "https://stackoverflow.com/users/12223782/mbmsoft"}, "reply_to_user": {"reputation": 144837, "user_id": 850848, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c287735beca76400cb9b6d08bf591cb9?s=128&d=identicon&r=PG", "display_name": "Martin Prikryl", "link": "https://stackoverflow.com/users/850848/martin-prikryl"}, "edited": false, "score": 0, "creation_date": 1573055536, "post_id": 58732121, "comment_id": 103758065, "body": "Maybe it will be enough if i get ipv4 connected to wireless, so it will reduce number of tries to hconnection open"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1573064377, "post_id": 58732121, "comment_id": 103762725, "body": "There obviously is a better way though: <code>InternetConnect</code> is a high level API function. If you first try to establish a low-level TCP connection to probe open ports you can increase speed. Google for a port scanner. I won&#39;t be providing code, as VBA port scanners are nearly exclusively malicious. It&#39;s a great way to get your machine flagged when used on a corporate network"}, {"owner": {"reputation": 144837, "user_id": 850848, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c287735beca76400cb9b6d08bf591cb9?s=128&d=identicon&r=PG", "display_name": "Martin Prikryl", "link": "https://stackoverflow.com/users/850848/martin-prikryl"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1573065230, "post_id": 58732121, "comment_id": 103763146, "body": "@ErikA While <code>InternetConnect</code> is a high level function, in this case, it will fail on the very first thing it does. So I do not think that using another API will speed the process up."}], "owner": {"reputation": 11, "user_id": 12223782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d1a4940ccf374ac5e38adfa95838e1d?s=128&d=identicon&r=PG&f=1", "display_name": "MBMSOFT", "link": "https://stackoverflow.com/users/12223782/mbmsoft"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1593732080, "creation_date": 1573049704, "last_edit_date": 1593732080, "question_id": 58732121, "link": "https://stackoverflow.com/questions/58732121/vba-search-for-ftp-server-in-network", "title": "vba search for ftp server in network", "body": "<p>vba isue...\nI need to find ftp server in wireless network, so i need to check ip addresses from let say 192.168.1.1 to 192.168.1.50 on ftp port 2211.\nif i go with loop for each address  and  open</p>\n\n<pre><code> ' Open Internet Connecion\n    hOpen = InternetOpen(\"FTP\", 1, \"\", vbNullString, 0)\n\n    ' Connect to FTP\n    hConnection = InternetConnect(hOpen, hostName, FTP_PORT, username, password, INTERNET_SERVICE_FTP, IIf(PassiveConnection, INTERNET_FLAG_PASSIVE, 0), 0)\n</code></pre>\n\n<p>it takes to much time.\nIs there any faster way to detect where is ftp server in network\nActually I need to get files from android device (e.g. smartphone or tablet) from their ftp server turned on (only way to connect to them) which are connected to wireless LAN. But their IP address is always different. I need user friendly form which will detect their ftp server.\nThis question is similar to this thread: <a href=\"https://stackoverflow.com/questions/24082077/java-find-server-in-network\">Java - Find Server in network</a> ,\nbut I needed it in vba \nThanks </p>\n"}, {"tags": ["vba", "runtime-error", "userform"], "comments": [{"owner": {"reputation": 648, "user_id": 6626183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a57210a6e0933a32691c61eba6f218df?s=128&d=identicon&r=PG&f=1", "display_name": "Hel O&#39;Ween", "link": "https://stackoverflow.com/users/6626183/hel-oween"}, "edited": false, "score": 0, "creation_date": 1573047469, "post_id": 58731355, "comment_id": 103753359, "body": "Can you please add both the code how you load/show <code>userform1</code> and the code before and after <code>userform2.show</code> to your question?"}, {"owner": {"reputation": 103, "user_id": 7284609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/394123266587eb71e83fa5cdf9103e2f?s=128&d=identicon&r=PG&f=1", "display_name": "YPi", "link": "https://stackoverflow.com/users/7284609/ypi"}, "reply_to_user": {"reputation": 648, "user_id": 6626183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a57210a6e0933a32691c61eba6f218df?s=128&d=identicon&r=PG&f=1", "display_name": "Hel O&#39;Ween", "link": "https://stackoverflow.com/users/6626183/hel-oween"}, "edited": false, "score": 0, "creation_date": 1573048053, "post_id": 58731355, "comment_id": 103753680, "body": "@Hel O&#39;Ween done."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1573048568, "post_id": 58731355, "comment_id": 103753968, "body": "And you get a <a href=\"https://excelmacromastery.com/vba-type-mismatch/\" rel=\"nofollow noreferrer\">run time error 13</a> at the line <code>userform2.show</code>? What is in the initialize event of Userform2?"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1573049290, "post_id": 58731355, "comment_id": 103754317, "body": "In order to stop at the error in userform2 change your settings to <i>Break in class module</i>, look <a href=\"https://www.techrepublic.com/blog/five-apps/five-tips-for-handling-errors-in-vba/\" rel=\"nofollow noreferrer\">here</a>"}, {"owner": {"reputation": 103, "user_id": 7284609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/394123266587eb71e83fa5cdf9103e2f?s=128&d=identicon&r=PG&f=1", "display_name": "YPi", "link": "https://stackoverflow.com/users/7284609/ypi"}, "reply_to_user": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1573050441, "post_id": 58731355, "comment_id": 103754982, "body": "@Storax: Gotcha! The error was in the labelfield2.caption line since only part of them were filled! I probably need to build some code to check for filled cells on the sheet and hiding empty labelingfields.  Thanks!"}], "owner": {"reputation": 103, "user_id": 7284609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/394123266587eb71e83fa5cdf9103e2f?s=128&d=identicon&r=PG&f=1", "display_name": "YPi", "link": "https://stackoverflow.com/users/7284609/ypi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573050100, "creation_date": 1573047129, "last_edit_date": 1573050100, "question_id": 58731355, "link": "https://stackoverflow.com/questions/58731355/cant-open-userform2-while-userform1-code-is-running", "title": "Can&#39;t open userform2 while userform1 code is running", "body": "<p>I'm trying to add some stuff to my existing code to further automate things. \nI have a userform1 with some code. If a certain event while running the code happens I need to open a new userform2 where the user has to use some checkboxes to alter some values on the sheet used by userform1. after the user is done I want them to close userform2 and the code to continue running(userform1 paused/hidden?).\nBut I can't get userform2 to open. It shows runtime error 13 with highlighting </p>\n\n<pre><code>    userform2.show \n</code></pre>\n\n<p>I've already tried putting both userforms as modeless.\nI've tried</p>\n\n<pre><code>me.hide \n</code></pre>\n\n<p>before opening userform2. </p>\n\n<p>Is there a way to open userform2 and continue the code after closing it or do I need to find another way?</p>\n\n<p>Code to summon userform1:</p>\n\n<pre><code>Button on Excel Sheet_click()\nwith combobox1\n.additem XX\n.\n.\nend with\n\nwith combobox2\n.additem XX\n.\n.\nend with\n\nwith combobox2\n.additem XX\n.\n.\nend with\n\nuserform1.show\nend sub\n</code></pre>\n\n<p>code to summon userform2 (or not) in part:</p>\n\n<pre><code>if sheet1.range(\"a1\") = 1 then\n do this\nelseif sheet1.range(\"a1\") &gt; 1 then\nuserform1.hide\nuserform2.show  'highlighted when runtime error 13 pops up\nend if\n</code></pre>\n\n<p>Initialize event of userform2:</p>\n\n<pre><code>Private Sub UserForm2_Initialize()\nDim DBB As Worksheet\nSet DBB = ThisWorkbook.Sheets(\"BB\")\nWith userform2\n    .labelfield1.Caption = DBB.Range(\"D5\")\n    .\n    .\n\n    .labelfield2.Caption = DBB.Range(\"D5\") - DBB.Range(\"D10\")\n    .\n    .\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1573050378, "post_id": 58731306, "comment_id": 103754947, "body": "What modification have you tried?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1573050388, "post_id": 58731306, "comment_id": 103754952, "body": "First step: Remove <code>On Error Resume Next</code> and run the code. Do you get errors? If yes, those need to be handled, first. Second step: Look at the VBA Help for <code>Worksheets.Add</code>"}, {"owner": {"reputation": 13, "user_id": 10099245, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Bk8mlAY7WK0/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oIjgCaaygHp2pQ6AtU3XZyBiVoFg/mo/photo.jpg?sz=128", "display_name": "reji mathew", "link": "https://stackoverflow.com/users/10099245/reji-mathew"}, "edited": false, "score": 0, "creation_date": 1573052241, "post_id": 58731306, "comment_id": 103756038, "body": "I don&#39;t get any error message. I need help to get the VBA code to add separate worksheets for each table."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10099245, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Bk8mlAY7WK0/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oIjgCaaygHp2pQ6AtU3XZyBiVoFg/mo/photo.jpg?sz=128", "display_name": "reji mathew", "link": "https://stackoverflow.com/users/10099245/reji-mathew"}, "edited": false, "score": 0, "creation_date": 1573056720, "post_id": 58732868, "comment_id": 103758755, "body": "Thank you very much. It worked I could get word tables into separate excel worksheets. I really appreciate with word VBA code."}], "tags": [], "owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "is_accepted": true, "score": 1, "last_activity_date": 1573052085, "creation_date": 1573052085, "answer_id": 58732868, "question_id": 58731306, "link": "https://stackoverflow.com/questions/58731306/extract-word-tables-to-separate-excel-worsheets-using-vba-code/58732868#58732868", "title": "Extract word tables to separate excel worsheets using VBA code", "body": "<p>This doesn't solve your specific issue regarding renaming the sheets. However, I think once you have the data in Excel, you can use some VBA to iterate back through the sheets to do the rename process. Here's the Word VBA (run from Word) code to get each table from Word to Excel in a new sheet.</p>\n\n<pre><code>Option Explicit\n\n'Run this from Word VBA\nPublic Sub GetTables()\n    Dim Table      As Table\n    Dim Doc        As Document: Set Doc = ThisDocument\n    Dim xl         As Object: Set xl = CreateObject(\"Excel.Application\")\n    Dim wb         As Object: Set wb = xl.Workbooks.Add\n    Dim ws         As Object\n\n    For Each Table In Doc.Tables\n        Table.Range.Copy\n        Set ws = wb.Sheets.Add()\n        ws.Paste\n    Next\n\n    xl.Visible = True\n    wb.Save\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10099245, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Bk8mlAY7WK0/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oIjgCaaygHp2pQ6AtU3XZyBiVoFg/mo/photo.jpg?sz=128", "display_name": "reji mathew", "link": "https://stackoverflow.com/users/10099245/reji-mathew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 58732868, "answer_count": 1, "score": 1, "last_activity_date": 1573052085, "creation_date": 1573046980, "last_edit_date": 1573050415, "question_id": 58731306, "link": "https://stackoverflow.com/questions/58731306/extract-word-tables-to-separate-excel-worsheets-using-vba-code", "title": "Extract word tables to separate excel worsheets using VBA code", "body": "<p>I have word document with 278 tables, and need to extract 278 tables into different excel worksheets.Also I need to extract a key word from the header description file for naming the worksheets</p>\n\n<p>I have a VBA code in excel to extract the word file tables into one excel sheet.</p>\n\n<pre><code>  Sub ImportWordTable()\n\n          Dim wdDoc As Object\n          Dim wdFileName As Variant\n          Dim tableNo As Long 'table number in Word\n          Dim iRow As Long 'row index in Excel\n          Dim iCol As Long 'column index in Excel\n          Dim resultRow As Long\n          Dim tableStart As Long\n          Dim tableTot As Long\n          Dim wkSht As Worksheet\n\n  On Error Resume Next\n      wdFileName = Application.GetOpenFilename(\"Word files (*.doc),*.doc\", , _\n   \"Browse for file containing table to be imported\")\n\n  If wdFileName = False Then Exit Sub '(user cancelled import file browser)\n  Set wkSht = ActiveSheet\nwkSht.Range(\"A:AZ\").ClearContents\n\nSet wdDoc = GetObject(wdFileName) 'open Word file\n\n    With wdDoc\ntableNo = wdDoc.Tables.Count\ntableTot = wdDoc.Tables.Count\nIf tableNo = 0 Then\n  MsgBox \"This document contains no tables\", _\n    vbExclamation, \"Import Word Table\"\nElseIf tableNo &gt; 1 Then\n  tableNo = InputBox(\"This Word document contains \" &amp; tableNo &amp; \" tables.\" &amp; vbCrLf &amp; _\n    \"Enter the table to start from\", \"Import Word Table\", \"1\")\nEnd If\nresultRow = 4\n\nFor tableStart = 1 To tableTot\n  With .Tables(tableStart)\n    'copy cell contents from Word table cells to Excel cells\n    For iRow = 1 To .Rows.Count\n      For iCol = 1 To .Columns.Count\n        wkSht.Cells(resultRow, iCol) = WorksheetFunction.Clean(.Cell(iRow, iCol).Range.Text)\n      Next iCol\n      resultRow = resultRow + 1\n    Next iRow\n  End With\n  resultRow = resultRow + 1\n  With wkSht\n    .Range(.Cells(resultRow, 1), .Cells(resultRow, iCol)).Interior.ColorIndex = 15\n  End With\n  resultRow = resultRow + 1\nNext tableStart\n   End With\n\nEnd Sub\n</code></pre>\n\n<p>I would like to modify the code so that I can get each table in separate excel worksheet.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 2, "creation_date": 1573046648, "post_id": 58731152, "comment_id": 103752822, "body": "If you want the formula to update, use: <code>=A1&amp;TEXT(NOW(), &quot;YYYYMMDHH:MM:SS&quot;)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 1, "last_activity_date": 1573046648, "creation_date": 1573046648, "answer_id": 58731215, "question_id": 58731152, "link": "https://stackoverflow.com/questions/58731152/adding-a-formatted-date-to-vba-excel-formula-formatnow-yyyymmdhhmmss/58731215#58731215", "title": "adding a formatted date to VBA excel formula &quot;(Format(Now, &quot;YYYYMMDHH:MM:SS&quot;))&quot;", "body": "<p>If you want the datetime to be hard-coded:</p>\n\n<pre><code>HSBC.Sheets(1).Range(\"AJ1\").Formula = \"=A1&amp;\"\"\" &amp; (Format(Now, \"YYYYMMDHH:MM:SS\")) &amp; \"\"\"\"\n</code></pre>\n\n<p>If you want the formula to update, just use <code>TEXT</code> to format <code>NOW</code>, as pointed out in a comment.</p>\n"}], "owner": {"reputation": 655, "user_id": 5183031, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ea1e2e43efd4e65f4b06cff36e36f1f6?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Riply", "link": "https://stackoverflow.com/users/5183031/mr-riply"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 58731215, "answer_count": 1, "score": 0, "last_activity_date": 1573046657, "creation_date": 1573046423, "last_edit_date": 1573046657, "question_id": 58731152, "link": "https://stackoverflow.com/questions/58731152/adding-a-formatted-date-to-vba-excel-formula-formatnow-yyyymmdhhmmss", "title": "adding a formatted date to VBA excel formula &quot;(Format(Now, &quot;YYYYMMDHH:MM:SS&quot;))&quot;", "body": "<p>To simplify, I have a formula in excel that works, test formula, e.g. <code>=A1&amp;NOW()</code>which gives the the following result <code>IT43775.5901537037</code>. </p>\n\n<p>I would like to get <code>IT2019082112:30:01</code>, therefore i tried the formula below using VBA, as I need this to be in VBA, but but unsuccessfully.</p>\n\n<pre><code>HSBC.Sheets(1).Range(\"AJ1\").Formula = \"=A1\" &amp; (Format(Now, \"YYYYMMDHH:MM:SS\"))\n</code></pre>\n"}, {"tags": ["excel", "vba", "production"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1573045669, "post_id": 58730841, "comment_id": 103752227, "body": "What do you want to do with the selected rows?"}, {"owner": {"reputation": 13, "user_id": 11858686, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-UKt9gJmeV7w/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdTPz7QBRxkVWdkpZegXnWiObG56w/photo.jpg?sz=128", "display_name": "Wojtek Ziolkowski", "link": "https://stackoverflow.com/users/11858686/wojtek-ziolkowski"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1573045704, "post_id": 58730841, "comment_id": 103752249, "body": "@BigBen, That&#39;s a part of a bigger macro, Lets imagine you&#39;ve got a production plan where you  certain cells represent a product. When you select these cells and then run it you send link to production drawing associated with the cell to the printer."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1573046015, "post_id": 58730841, "comment_id": 103752416, "body": "How many cells do you want to select? And are you selecting the entire row, or just cells in a certain column, e.g. A2, A5, A1456, and A2354?"}, {"owner": {"reputation": 13, "user_id": 11858686, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-UKt9gJmeV7w/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdTPz7QBRxkVWdkpZegXnWiObG56w/photo.jpg?sz=128", "display_name": "Wojtek Ziolkowski", "link": "https://stackoverflow.com/users/11858686/wojtek-ziolkowski"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1573046445, "post_id": 58730841, "comment_id": 103752694, "body": "@Big Ben, It will be condition based, but in general I won&#39;t have to select all row, just the cells defined by intersect of rows from the array and certain column numbers."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1573046487, "post_id": 58730841, "comment_id": 103752719, "body": "Then build up a range address with the columns in question and the row numbers in the array, and then select from there."}, {"owner": {"reputation": 13, "user_id": 11858686, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-UKt9gJmeV7w/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdTPz7QBRxkVWdkpZegXnWiObG56w/photo.jpg?sz=128", "display_name": "Wojtek Ziolkowski", "link": "https://stackoverflow.com/users/11858686/wojtek-ziolkowski"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1573047123, "post_id": 58730841, "comment_id": 103753139, "body": "@BigBen. Hmm so basically I need to define a range, add all addresses to that range and then select this range. I will try it, thanks."}], "owner": {"reputation": 13, "user_id": 11858686, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-UKt9gJmeV7w/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdTPz7QBRxkVWdkpZegXnWiObG56w/photo.jpg?sz=128", "display_name": "Wojtek Ziolkowski", "link": "https://stackoverflow.com/users/11858686/wojtek-ziolkowski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573054660, "creation_date": 1573045395, "last_edit_date": 1573054660, "question_id": 58730841, "link": "https://stackoverflow.com/questions/58730841/vba-and-excel-add-to-selection-cells-from-array", "title": "VBA and Excel - add to selection cells from array()", "body": "<p>Firstly, I would like to thank you in advance for all the answers. </p>\n\n<p>I've got an \"end\" array which contains row numbers. </p>\n\n<pre><code>  If OptionButton1 = True Then\n\n    Dim arraydodrukowania() As String\n    ReDim arraydodrukowania(1 To o, 1 To 2)\n\n    For j = LBound(array1) To UBound(array1)\n\n  If array1(j, 9) = 1 And array1(j, 8) = ComboBox2.Value Then\n\n arraydodrukowania(j, 1) = array1(j, 9)\n arraydodrukowania(j, 2) = array1(j, 2)\n\n\nElse\nEnd If\n</code></pre>\n\n<p>what I want to do is to select all rows defined by array values </p>\n\n<p>I know that the selection method should be avoided, but it can not be omitted at this occasion. </p>\n\n<p>So, in other words, I need a code which will loop trough the array and will add row no defined by the value in the array to selection. \nThe result would be (for example) row no. 2, 5, 1456, 2354 are selected. </p>\n\n<p>the problem here is that the number of rows that needs to be selected varies. </p>\n\n<p>So </p>\n\n<pre><code>For j = LBound(array1) To UBound(array1)\n    array1(j,1).&lt;ADD TO SELECTION&gt;\n\nnext j\n</code></pre>\n\n<p>Any ideas? </p>\n"}, {"tags": ["excel", "vba", "outlook", "filepicker"], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 1, "last_activity_date": 1573045814, "creation_date": 1573045814, "answer_id": 58730958, "question_id": 58730772, "link": "https://stackoverflow.com/questions/58730772/filepicker-in-macro-opens-dialogbox-in-background/58730958#58730958", "title": "FilePicker in Macro opens dialogbox in background", "body": "<p>The issue is caused by the fact that Excel windows don't know anything about Outlook windows. You must set a parent window to your child window dialog if you want to keep it always on top of another window.  For example:</p>\n\n<pre><code>Public Declare Function SetForegroundWindow _\nLib \"user32\" (ByVal hwnd As Long) As Long\n\nPublic Sub Bring_to_front()\n    Dim setFocus As Long\n\n    ThisWorkbook.Worksheets(\"Sheet1\").Activate\n    setfocus = SetForegroundWindow(Application.hwnd)\nEnd Sub\n</code></pre>\n\n<p>In your case it will be a dialog window:</p>\n\n<pre><code>Private Declare Function FindWindowA Lib \"user32\" (ByVal class As String, ByVal caption As String) As Long\nPrivate Declare Function SetForegroundWindow Lib \"user32\" (ByVal win As Long) As Long\n\nDim hxl As Long\n\nSet objExcel = New Excel.Application\nSet fd = xl.FileDialog(msoFileDialogFilePicker)\nhxl = FindWindowA(\"XLMAIN\", \"Excel\")\nIf (hxl &lt;&gt; 0) Then\n    res = SetForegroundWindow(hxl)\nEnd If\nWith fd\n.Filters.Clear\n .InitialFileName = SigFolder2\n .AllowMultiSelect = False\n .Title = \"Select Signature File\"\nEnd With\nres = fd.Show\n</code></pre>\n"}], "owner": {"reputation": 117, "user_id": 4502721, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh3.googleusercontent.com/-lrJuzGlmiPc/AAAAAAAAAAI/AAAAAAAAABA/DblLhIv7y1c/photo.jpg?sz=128", "display_name": "Amrita Deb", "link": "https://stackoverflow.com/users/4502721/amrita-deb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 286, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1600338204, "creation_date": 1573045176, "last_edit_date": 1573050479, "question_id": 58730772, "link": "https://stackoverflow.com/questions/58730772/filepicker-in-macro-opens-dialogbox-in-background", "title": "FilePicker in Macro opens dialogbox in background", "body": "<p>I have developed a Outlook macro that lets the user choose and open an excel file.</p>\n\n<p>The problem is the file dialog box doesnot open on top of everything but in the background. This way, to the user it looks like the Outlook application is stuck whereas its just waiting for the user to choose a file in the Filepicker dialog box behind all other windows.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>Dim SigFolder2 As String\nDim fd As Office.FileDialog\nDim selectedItem As Variant\nDim ExcelFileName As String\nDim FileName As String\nDim objExcel As New Excel.Application\nDim exWb As Excel.Workbook\n\n\n'Suggested Folder--Downloads\nSigFolder2 = \"C:\\Users\\\" &amp; Environ(\"UserName\") &amp; \"\\Downloads\\\"\n\n'Dialog Settings\n\nSet fd = objExcel.FileDialog(msoFileDialogFilePicker)\nWith fd\n.Filters.Clear\n .InitialFileName = SigFolder2\n .AllowMultiSelect = False\n .Title = \"Select Signature File\"\nEnd With\n\n'Getting the file\nIf fd.Show = -1 Then\n    For Each selectedItem In fd.SelectedItems\n        SigFolder = selectedItem\n    Next\nElse\nExit Sub\nEnd If\n\nExcelFileName = SigFolder\nFileName = Left(fso.GetFileName(ExcelFileName), InStr(fso.GetFileName(ExcelFileName), \".\") - 1)\nDebug.Print ExcelFileName 'file Path with filename\n</code></pre>\n\n<p>Is there any way to correct this?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 10618, "user_id": 2018133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e3fd4734236360fc59fa597dc8f9ffa7?s=128&d=identicon&r=PG", "display_name": "Geert Bellekens", "link": "https://stackoverflow.com/users/2018133/geert-bellekens"}, "edited": false, "score": 3, "creation_date": 1573046053, "post_id": 58730310, "comment_id": 103752441, "body": "You might want to look into editing the underlying xml file yourself. There are libraries that can help you with that. Often this is much faster than using the API"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1573047017, "post_id": 58730310, "comment_id": 103753062, "body": "Have you tried deleting the data from the worksheets first (<code>Worksheet.Rows.Delete</code> and/or <code>Worksheet.Columns.Delete</code>)?  Deleting 999 empty worksheets only takes about 9.7 seconds"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 1, "creation_date": 1573050996, "post_id": 58730310, "comment_id": 103755301, "body": "Depending on the workbook specifics, it might be faster to turn the problem on its head. Instead of deleting what you don&#39;t need, maybe try copying out to a new workbook what you need to keep."}], "owner": {"reputation": 1, "user_id": 9077729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fde327a6da29f513c7f000652c0552ea?s=128&d=identicon&r=PG&f=1", "display_name": "Ner", "link": "https://stackoverflow.com/users/9077729/ner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 114, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1581561501, "creation_date": 1573043683, "last_edit_date": 1581561501, "question_id": 58730310, "link": "https://stackoverflow.com/questions/58730310/how-to-speed-up-deletion-of-worksheets-in-a-large-excel-file", "title": "How to speed up deletion of Worksheets in a large Excel file?", "body": "<p>Deleting sheets in large (>25 MB) Excel workbooks is quite slow (multiple seconds).</p>\n\n<p>This is the case if I delete the sheets manually as well as via VBA. </p>\n\n<p>I want to delete (~10) worksheets with previous results in a >25 MB Excel file via a VBA script. </p>\n\n<p>How do I speed up the deletion of worksheets?</p>\n\n<p>Running O365</p>\n\n<p>I implemented the \"usual\" tricks to increase VBA speed</p>\n\n<pre><code>Application.Calculation = xlCalculationManual\nApplication.EnableEvents = False\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\n</code></pre>\n\n<p>VBA code to delete sheets: <code>ThisWorkbook.Worksheets(SheetProjectResults).Delete</code></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 12328137, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-i67AotmT74g/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf4UPpgB_muddLzLnDcRwqBlS1liQ/photo.jpg?sz=128", "display_name": "emre y", "link": "https://stackoverflow.com/users/12328137/emre-y"}, "edited": false, "score": 0, "creation_date": 1573115394, "post_id": 58735969, "comment_id": 103778350, "body": "thank you very much, it works but causes run-time error&#39;1004&#39; aplication-defined or object-defined error"}, {"owner": {"reputation": 428, "user_id": 10569362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb9c61d2dbd18a14e34005ab752e682e?s=128&d=identicon&r=PG&f=1", "display_name": "patel", "link": "https://stackoverflow.com/users/10569362/patel"}, "reply_to_user": {"reputation": 15, "user_id": 12328137, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-i67AotmT74g/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf4UPpgB_muddLzLnDcRwqBlS1liQ/photo.jpg?sz=128", "display_name": "emre y", "link": "https://stackoverflow.com/users/12328137/emre-y"}, "edited": false, "score": 0, "creation_date": 1573116607, "post_id": 58735969, "comment_id": 103778946, "body": "which separator did you use?"}, {"owner": {"reputation": 15, "user_id": 12328137, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-i67AotmT74g/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf4UPpgB_muddLzLnDcRwqBlS1liQ/photo.jpg?sz=128", "display_name": "emre y", "link": "https://stackoverflow.com/users/12328137/emre-y"}, "edited": false, "score": 0, "creation_date": 1573128018, "post_id": 58735969, "comment_id": 103785033, "body": "hi, before i used &quot;&lt;&quot;, but now i am using chr(10) as separator and there is no problem now thank you very much again"}], "tags": [], "owner": {"reputation": 428, "user_id": 10569362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb9c61d2dbd18a14e34005ab752e682e?s=128&d=identicon&r=PG&f=1", "display_name": "patel", "link": "https://stackoverflow.com/users/10569362/patel"}, "is_accepted": true, "score": 0, "last_activity_date": 1573062882, "creation_date": 1573062882, "answer_id": 58735969, "question_id": 58730078, "link": "https://stackoverflow.com/questions/58730078/how-do-i-get-source-code-into-a-column-in-excel-vba/58735969#58735969", "title": "How do I get source code into a column in Excel vba?", "body": "<p>to do what you want you need a valid line separator, if yow know it you can try this code</p>\n\n<pre><code>Sub Tester()\ns = GetSource(\"https://www.google.com/\")\nseparator=\"?\" '&lt;&lt;&lt; to changed\narr = Split(s, separator)\nFor r = 0 To UBound(arr)\n  Cells(r + 1, 1) = arr(r)\nNext\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 12328137, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-i67AotmT74g/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf4UPpgB_muddLzLnDcRwqBlS1liQ/photo.jpg?sz=128", "display_name": "emre y", "link": "https://stackoverflow.com/users/12328137/emre-y"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 58735969, "answer_count": 1, "score": 0, "last_activity_date": 1573125994, "creation_date": 1573042879, "last_edit_date": 1573125994, "question_id": 58730078, "link": "https://stackoverflow.com/questions/58730078/how-do-i-get-source-code-into-a-column-in-excel-vba", "title": "How do I get source code into a column in Excel vba?", "body": "<p>How can I paste source code into a column(column C) not into a cell(C1)?</p>\n\n<pre><code>Sub Tester()\nRange(\"c1\").Value = GetSource(\"https://www.yahoo.com/\")\nEnd Sub\n\n\nFunction GetSource(sURL As String) As String\n\nDim oXHTTP As Object\n\nSet oXHTTP = CreateObject(\"MSXML2.XMLHTTP\")\noXHTTP.Open \"GET\", sURL, False\noXHTTP.send\nGetSource = oXHTTP.responsetext\nSet oXHTTP = Nothing\n\nEnd Function\n</code></pre>\n\n<p><strong>Want this</strong>\n<a href=\"https://i.stack.imgur.com/vpvuv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vpvuv.png\" alt=\"want this\"></a></p>\n\n<p><strong>Not like this</strong>\n<a href=\"https://i.stack.imgur.com/CFknL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CFknL.png\" alt=\"[not like this\"></a></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 6320231, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f13345bbd5d806bce9a4abcf9b7ddfff?s=128&d=identicon&r=PG&f=1", "display_name": "James Hurst", "link": "https://stackoverflow.com/users/6320231/james-hurst"}, "edited": false, "score": 0, "creation_date": 1573044628, "post_id": 58730163, "comment_id": 103751648, "body": "Thanks, the &#39;ws.Name = Replace(help_name(UBound(help_name)), &quot;.bom&quot;, &quot;&#39; part is highlighed as error"}, {"owner": {"reputation": 63, "user_id": 6320231, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f13345bbd5d806bce9a4abcf9b7ddfff?s=128&d=identicon&r=PG&f=1", "display_name": "James Hurst", "link": "https://stackoverflow.com/users/6320231/james-hurst"}, "edited": false, "score": 0, "creation_date": 1573046560, "post_id": 58730163, "comment_id": 103752763, "body": "So the issue seems to be the CSV file name, there is a hidden number after the .bom in the file name, do you know how to remove this when renaming using the replace technique you have used?"}, {"owner": {"reputation": 77, "user_id": 10010199, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3uK6o060DtE/AAAAAAAAAAI/AAAAAAAAAEY/9VOm6jNZEAM/photo.jpg?sz=128", "display_name": "St3ve", "link": "https://stackoverflow.com/users/10010199/st3ve"}, "reply_to_user": {"reputation": 63, "user_id": 6320231, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f13345bbd5d806bce9a4abcf9b7ddfff?s=128&d=identicon&r=PG&f=1", "display_name": "James Hurst", "link": "https://stackoverflow.com/users/6320231/james-hurst"}, "edited": false, "score": 0, "creation_date": 1573051046, "post_id": 58730163, "comment_id": 103755333, "body": "I&#39;m sorry to hear about it. In case you don&#39;t care for anything that comes after the &#39;.bom&#39; then you could use something like  ws.Name = Left(help_name(UBound(help_name)), InStr(1, help_name(UBound(help_name), &quot;.bom&quot;, vbTextCompare) - 1))"}, {"owner": {"reputation": 77, "user_id": 10010199, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3uK6o060DtE/AAAAAAAAAAI/AAAAAAAAAEY/9VOm6jNZEAM/photo.jpg?sz=128", "display_name": "St3ve", "link": "https://stackoverflow.com/users/10010199/st3ve"}, "reply_to_user": {"reputation": 63, "user_id": 6320231, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f13345bbd5d806bce9a4abcf9b7ddfff?s=128&d=identicon&r=PG&f=1", "display_name": "James Hurst", "link": "https://stackoverflow.com/users/6320231/james-hurst"}, "edited": false, "score": 0, "creation_date": 1573053881, "post_id": 58730163, "comment_id": 103757088, "body": "Sorry, I made a super-stupid typo. I updated the post and here is what it should look have like: ws.Name = Left(help_name(UBound(help_name)), InStr(1, help_name(UBound(help_name)), &quot;.bom&quot;, vbTextCompare) - 1)"}, {"owner": {"reputation": 63, "user_id": 6320231, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f13345bbd5d806bce9a4abcf9b7ddfff?s=128&d=identicon&r=PG&f=1", "display_name": "James Hurst", "link": "https://stackoverflow.com/users/6320231/james-hurst"}, "edited": false, "score": 0, "creation_date": 1573054124, "post_id": 58730163, "comment_id": 103757227, "body": "Thats sorted it, thanks... Thats the beginning of what i need this to do, no doubt i will help later on"}, {"owner": {"reputation": 77, "user_id": 10010199, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3uK6o060DtE/AAAAAAAAAAI/AAAAAAAAAEY/9VOm6jNZEAM/photo.jpg?sz=128", "display_name": "St3ve", "link": "https://stackoverflow.com/users/10010199/st3ve"}, "reply_to_user": {"reputation": 63, "user_id": 6320231, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f13345bbd5d806bce9a4abcf9b7ddfff?s=128&d=identicon&r=PG&f=1", "display_name": "James Hurst", "link": "https://stackoverflow.com/users/6320231/james-hurst"}, "edited": false, "score": 0, "creation_date": 1573054602, "post_id": 58730163, "comment_id": 103757527, "body": "Great, I&#39;m happy to hear that :-)"}], "tags": [], "owner": {"reputation": 77, "user_id": 10010199, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3uK6o060DtE/AAAAAAAAAAI/AAAAAAAAAEY/9VOm6jNZEAM/photo.jpg?sz=128", "display_name": "St3ve", "link": "https://stackoverflow.com/users/10010199/st3ve"}, "is_accepted": true, "score": 1, "last_activity_date": 1573053815, "last_edit_date": 1573053815, "creation_date": 1573043181, "answer_id": 58730163, "question_id": 58729767, "link": "https://stackoverflow.com/questions/58729767/import-csv-to-new-worksheet/58730163#58730163", "title": "Import CSV to new worksheet", "body": "<p>I hope this helps :-) </p>\n\n<p>if you paste it before the with statement and then replace the 'ThisWorkbook.Sheets(\"Sheet2\")' with 'ws' in the with statement, I believe it should do what you need.</p>\n\n<pre><code>Dim ws As Worksheet 'variable that will contain the new sheet\n\nDim help_name() As String 'helper string array that will contain the full path of your file\nhelp_name = Split(fstr, \"\\\") 'populating the variable with the full path, each '\\' creates a new item\n\nSet ws = ThisWorkbook.Sheets.Add 'adding a new sheet to your workbook\n'Original not reliable option 'ws.Name = Replace(help_name(UBound(help_name)), \".bom\", \"\", , , vbTextCompare) 'naming the new sheet with the name of the file and removing the '.bom'\n    'ubound returns the highest position of the array, which is always name of the file\nws.Name = Left(help_name(UBound(help_name)), InStr(1, help_name(UBound(help_name)), \".bom\", vbTextCompare) - 1) 'updated hopefully more reliable option of naming the sheet\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 6320231, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f13345bbd5d806bce9a4abcf9b7ddfff?s=128&d=identicon&r=PG&f=1", "display_name": "James Hurst", "link": "https://stackoverflow.com/users/6320231/james-hurst"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 0, "accepted_answer_id": 58730163, "answer_count": 1, "score": 0, "last_activity_date": 1609843226, "creation_date": 1573041807, "last_edit_date": 1609843226, "question_id": 58729767, "link": "https://stackoverflow.com/questions/58729767/import-csv-to-new-worksheet", "title": "Import CSV to new worksheet", "body": "<p>I create a CSV BOM exported from CREO. I have a command button on my master worksheet, which will import the CSV to a new worksheet and name the worksheet with the CSV file name.</p>\n<p>The issue is the import won't add the date to a new worksheet, instead it will open a new workbook.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Sub load_csv()\n    Dim fStr As String\n\n    With Application.FileDialog(msoFileDialogFilePicker)\n        .Show\n        If .SelectedItems.Count = 0 Then\n            'MsgBox &quot;Cancel Selected&quot;\n            Exit Sub\n        End If\n        'fStr is the file path and name of the file you selected.\n        fStr = .SelectedItems(1)\n    End With\n    \n    Dim ws As Worksheet 'variable that will contain the new sheet\n\n    Dim help_name() As String 'helper string array that will contain the full path of your file\n    help_name = Split(fStr, &quot;\\&quot;) 'populating the variable with the full path, each '\\' creates a new item\n        \n    Set ws = ThisWorkbook.Sheets.Add 'adding a new sheet to your workbook\n    ws.Name = Replace(help_name(UBound(help_name)), &quot;.bom&quot;, &quot;&quot;, , , vbTextCompare) 'naming the new sheet with the name of the file and removing the '.bom'\n    'ubound returns the highest position of the array, which is always name of the file\n\n    With ThisWorkbook.Sheets(&quot;Sheet2&quot;).QueryTables.Add(Connection:= _\n      &quot;TEXT;&quot; &amp; fStr, Destination:=ThisWorkbook.Sheets(&quot;Sheet2&quot;).Range(&quot;$A$1&quot;))\n        .Name = &quot;CAPTURE&quot;\n        .FieldNames = True\n        .RowNumbers = False\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = False\n        .RefreshStyle = xlInsertDeleteCells\n        .SavePassword = False\n        .SaveData = True\n        .AdjustColumnWidth = True\n        .RefreshPeriod = 0\n        .TextFilePromptOnRefresh = False\n        .TextFilePlatform = 437\n        .TextFileStartRow = 1\n        .TextFileParseType = xlDelimited\n        .TextFileTextQualifier = xlTextQualifierDoubleQuote\n        .TextFileConsecutiveDelimiter = False\n        .TextFileTabDelimiter = True\n        .TextFileSemicolonDelimiter = False\n        .TextFileCommaDelimiter = True\n        .TextFileSpaceDelimiter = False\n        .TextFileColumnDataTypes = Array(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1)\n        .TextFileTrailingMinusNumbers = True\n        .Refresh BackgroundQuery:=False\n        'ActiveWorkbook.Save\n    End With\n\nEnd Sub\n</code></pre>\n<p>I created code to import the CSV to 'Sheet2' however I would like this added as a new worksheet and then that worksheet renamed to the file name without .BOM at the end.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 2, "creation_date": 1573041344, "post_id": 58729441, "comment_id": 103749891, "body": "You got a bit quote happy there: <code>&quot;=&quot;&quot;D&quot;&quot;&amp;AC2 &amp; REPT(&quot;&quot; &quot;&quot;,12 - LEN(AC2))&amp;REPT(&quot;&quot; &quot;&quot;, 20)&amp;T2&amp;REPT(&quot;&quot; &quot;&quot;, 3 - LEN(T2))&amp;AD2&amp;REPT(&quot;&quot; &quot;&quot;, 2 - LEN(AD2))&amp;REPT(&quot;&quot; &quot;&quot;,12)&quot;</code>"}, {"owner": {"reputation": 10618, "user_id": 2018133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e3fd4734236360fc59fa597dc8f9ffa7?s=128&d=identicon&r=PG", "display_name": "Geert Bellekens", "link": "https://stackoverflow.com/users/2018133/geert-bellekens"}, "edited": false, "score": 0, "creation_date": 1573041376, "post_id": 58729441, "comment_id": 103749903, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/9024724/how-do-i-put-double-quotes-in-a-string-in-vba\">How do I put double quotes in a string in vba?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1573041509, "post_id": 58729615, "comment_id": 103749996, "body": "Why would you downvote and not clarify why you think the answer is wrong?"}], "tags": [], "owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "is_accepted": true, "score": 1, "last_activity_date": 1573041357, "creation_date": 1573041357, "answer_id": 58729615, "question_id": 58729441, "link": "https://stackoverflow.com/questions/58729441/excel-formula-escape-characters/58729615#58729615", "title": "Excel formula escape characters", "body": "<p>In VBA you'll need quotation marks around a quotation mark from a formula <code>\" -&gt; \"\"\"</code> </p>\n\n<p>So, a whitespace would be <code>\"\" \"\"</code>, and a quoted string <code>\"\"D\"\"</code> </p>\n"}, {"tags": [], "owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "is_accepted": false, "score": 1, "last_activity_date": 1573042212, "creation_date": 1573042212, "answer_id": 58729877, "question_id": 58729441, "link": "https://stackoverflow.com/questions/58729441/excel-formula-escape-characters/58729877#58729877", "title": "Excel formula escape characters", "body": "<p>Fairly simpler method of implementing it in VBA is as below.</p>\n\n<p><strong>Step 1:</strong> Copy formula as it is in VBE Window</p>\n\n<p><code>=\"D\"&amp;AC2 &amp; REPT(\" \",12 - LEN(AC2))&amp;REPT(\" \", 20)&amp;T2&amp;REPT(\" \", 3 - LEN(T2))&amp;AD2&amp;REPT(\" \", 2 - LEN(AD2))&amp;REPT(\" \",12)</code></p>\n\n<p><strong>Step 2:</strong> Highlight formula text and then for selected text, do FIND and REPLACE</p>\n\n<p>FIND: \"</p>\n\n<p>REPLACE:\"\"</p>\n\n<p><code>=\"\"D\"\"&amp;AC2 &amp; REPT(\"\" \"\",12 - LEN(AC2))&amp;REPT(\"\" \"\", 20)&amp;T2&amp;REPT(\"\" \"\", 3 - LEN(T2))&amp;AD2&amp;REPT(\"\" \"\", 2 - LEN(AD2))&amp;REPT(\"\" \"\",12)</code></p>\n\n<p><strong>Step 3:</strong> Wrap the outcome with a pair of quotes.</p>\n\n<p><code>\"=\"\"D\"\"&amp;AC2 &amp; REPT(\"\" \"\",12 - LEN(AC2))&amp;REPT(\"\" \"\", 20)&amp;T2&amp;REPT(\"\" \"\", 3 - LEN(T2))&amp;AD2&amp;REPT(\"\" \"\", 2 - LEN(AD2))&amp;REPT(\"\" \"\",12)\"</code></p>\n\n<p><strong>Note:</strong> If you are having \";\" as argument separator then you need look at <code>FormulaLocal</code> and if you choose to use <code>Formula</code> then \";\" shall be replaced by \",\".</p>\n"}], "owner": {"reputation": 655, "user_id": 5183031, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ea1e2e43efd4e65f4b06cff36e36f1f6?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Riply", "link": "https://stackoverflow.com/users/5183031/mr-riply"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2204, "favorite_count": 0, "accepted_answer_id": 58729615, "answer_count": 2, "score": 0, "last_activity_date": 1573043366, "creation_date": 1573040751, "last_edit_date": 1573043366, "question_id": 58729441, "link": "https://stackoverflow.com/questions/58729441/excel-formula-escape-characters", "title": "Excel formula escape characters", "body": "<p>I have a below formula which works in excel, in a cell.</p>\n\n<pre><code>=\"D\"&amp;AC2 &amp; REPT(\" \",12 - LEN(AC2))&amp;REPT(\" \", 20)&amp;T2&amp;REPT(\" \", 3 - LEN(T2))&amp;AD2&amp;REPT(\" \", 2 - LEN(AD2))&amp;REPT(\" \",12)\n</code></pre>\n\n<p>I tried to translate this to VBA, For letter <code>D</code> and all the whitespaces <code>\" \"</code> I used escape characters (i thought, they are escape characters) <code>\"\"\"\" \"\"\"\"</code> but I couldn't get it to work.</p>\n\n<p>Here's the formula I tried in VBA</p>\n\n<pre><code>\"= \"\"\"\"D\"\"\"\"&amp;AC2 &amp; REPT(\"\"\"\" \"\"\"\" ,12 - LEN(AC2))&amp;REPT(\"\"\"\" \"\"\"\", 20)&amp;T2&amp;REPT(\"\"\"\" \"\"\"\" , 3 - LEN(T2))&amp;AD2&amp;REPT(\"\"\"\" \"\"\"\" , 2 - LEN(AD2))&amp;REPT(\"\"\"\" \"\"\"\" ,12)\"\n</code></pre>\n\n<p>Any help is appreciated. Thanks</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1573041260, "post_id": 58729423, "comment_id": 103749839, "body": "Isn&#39;t this something that would be covered if you digitally sign the file? If it came back changed it would no longer match your signature"}, {"owner": {"reputation": 1, "user_id": 4694849, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-w350pmgGKqE/AAAAAAAAAAI/AAAAAAAAqX8/O2HmsIO2SUA/photo.jpg?sz=128", "display_name": "David", "link": "https://stackoverflow.com/users/4694849/david"}, "reply_to_user": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1573043407, "post_id": 58729423, "comment_id": 103750970, "body": "Hi Dave, thanks for your response. it appears that I don&#39;t have any certificates installed and getting them from IT will be a bit of a nightmare... Any other ideas?"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1573044148, "post_id": 58729423, "comment_id": 103751396, "body": "What about <a href=\"https://i.stack.imgur.com/FjwVD.png\" rel=\"nofollow noreferrer\">this</a>? Kind of self certification."}, {"owner": {"reputation": 1, "user_id": 4694849, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-w350pmgGKqE/AAAAAAAAAAI/AAAAAAAAqX8/O2HmsIO2SUA/photo.jpg?sz=128", "display_name": "David", "link": "https://stackoverflow.com/users/4694849/david"}, "reply_to_user": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1573049303, "post_id": 58729423, "comment_id": 103754322, "body": "Thanks @Storax. I&#39;ve looked there but there are no certificates installed and I&#39;d have to get the admins to add one which will not happen before I need to have this sent."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1573049423, "post_id": 58729423, "comment_id": 103754385, "body": "I am talking about something like <a href=\"https://riptutorial.com/vba/example/25363/create-a-valid-digital-self-signed-certificate-selfcert-exe\" rel=\"nofollow noreferrer\">that</a>"}, {"owner": {"reputation": 1, "user_id": 4694849, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-w350pmgGKqE/AAAAAAAAAAI/AAAAAAAAqX8/O2HmsIO2SUA/photo.jpg?sz=128", "display_name": "David", "link": "https://stackoverflow.com/users/4694849/david"}, "edited": false, "score": 0, "creation_date": 1573049937, "post_id": 58729423, "comment_id": 103754666, "body": "SORTED... thanks mate."}], "owner": {"reputation": 1, "user_id": 4694849, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-w350pmgGKqE/AAAAAAAAAAI/AAAAAAAAqX8/O2HmsIO2SUA/photo.jpg?sz=128", "display_name": "David", "link": "https://stackoverflow.com/users/4694849/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573126000, "creation_date": 1573040681, "last_edit_date": 1573126000, "question_id": 58729423, "link": "https://stackoverflow.com/questions/58729423/checking-if-code-has-been-modified-without-opening-the-workbook", "title": "Checking if code has been modified (without opening the workbook???)", "body": "<p>I'm trying to find a way to verify that no code changes have been made in a workbook that is sent to someone and then returned with the code.</p>\n\n<p>I have the template workbook with the correct code that I'd be checking against.\nI have not been able to find the answer as yet in my google searches</p>\n\n<p>If possible, I'd like to verify the code has not been changed without opening the workbook (which seems impossible) or at least with the macros disabled.\nAny help would be appreciated.</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 689, "user_id": 3601475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63eb2cefd40f4ce33c7733d7eb74ef53?s=128&d=identicon&r=PG&f=1", "display_name": "Prebsus", "link": "https://stackoverflow.com/users/3601475/prebsus"}, "edited": false, "score": 0, "creation_date": 1573039851, "post_id": 58728778, "comment_id": 103749074, "body": "In general, &quot;undo&quot; will not work on an action that is carried out with VBA. This is seen across the office-package, where in all cases the running of a macro/VBA-code will clear the undo stack"}, {"owner": {"reputation": 2423, "user_id": 4058737, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2518d6a04eb7df5d9ec95142943a6d6f?s=128&d=identicon&r=PG&f=1", "display_name": "rsc05", "link": "https://stackoverflow.com/users/4058737/rsc05"}, "reply_to_user": {"reputation": 689, "user_id": 3601475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63eb2cefd40f4ce33c7733d7eb74ef53?s=128&d=identicon&r=PG&f=1", "display_name": "Prebsus", "link": "https://stackoverflow.com/users/3601475/prebsus"}, "edited": false, "score": 0, "creation_date": 1573041016, "post_id": 58728778, "comment_id": 103749722, "body": "@Prebsus Thank you for this information, I did not know this so to make it work again, I can simply close VBA? Or will it keep running in the background and I can not do anything about it?"}, {"owner": {"reputation": 689, "user_id": 3601475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63eb2cefd40f4ce33c7733d7eb74ef53?s=128&d=identicon&r=PG&f=1", "display_name": "Prebsus", "link": "https://stackoverflow.com/users/3601475/prebsus"}, "edited": false, "score": 0, "creation_date": 1573056354, "post_id": 58728778, "comment_id": 103758530, "body": "not sure if I fully understand, but in the undo-stack will keep building (storing your old actions) as normal when you&#39;re not running any VBA-code. However, as soon as you run a line of VBA-code, the undo-stack will clear. Does that answer your question?"}], "answers": [{"comments": [{"owner": {"reputation": 2423, "user_id": 4058737, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2518d6a04eb7df5d9ec95142943a6d6f?s=128&d=identicon&r=PG&f=1", "display_name": "rsc05", "link": "https://stackoverflow.com/users/4058737/rsc05"}, "edited": false, "score": 0, "creation_date": 1573052890, "post_id": 58730692, "comment_id": 103756402, "body": "Hello @Eugene, I do not see any differences between what you proposed and my question, would you mind giving detail information about what you mean? At least like a good example where you change minor things in the original code to give me an idea? Thank you so much"}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 2423, "user_id": 4058737, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2518d6a04eb7df5d9ec95142943a6d6f?s=128&d=identicon&r=PG&f=1", "display_name": "rsc05", "link": "https://stackoverflow.com/users/4058737/rsc05"}, "edited": false, "score": 0, "creation_date": 1573053404, "post_id": 58730692, "comment_id": 103756759, "body": "It is your code shown as an example. Anyway, I&#39;ve updated the answer."}, {"owner": {"reputation": 2423, "user_id": 4058737, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2518d6a04eb7df5d9ec95142943a6d6f?s=128&d=identicon&r=PG&f=1", "display_name": "rsc05", "link": "https://stackoverflow.com/users/4058737/rsc05"}, "edited": false, "score": 0, "creation_date": 1573054705, "post_id": 58730692, "comment_id": 103757591, "body": "Thank you for this but, I am new to VBA what do you mean by PasteYourStuff()? Like do you mean in reference to my provided example?"}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 2423, "user_id": 4058737, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2518d6a04eb7df5d9ec95142943a6d6f?s=128&d=identicon&r=PG&f=1", "display_name": "rsc05", "link": "https://stackoverflow.com/users/4058737/rsc05"}, "edited": false, "score": 0, "creation_date": 1573054875, "post_id": 58730692, "comment_id": 103757711, "body": "This a raw sketch showing you an approach. You can use <a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/functions/string-functions\" rel=\"nofollow noreferrer\">string functions</a> available in VBA."}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1573053380, "last_edit_date": 1573053380, "creation_date": 1573044907, "answer_id": 58730692, "question_id": 58728778, "link": "https://stackoverflow.com/questions/58728778/reply-to-an-email-with-first-name-last-name-not-with-last-name-first-name/58730692#58730692", "title": "Reply to an email with &quot;First Name Last Name&quot;, not with &quot;Last Name, First Name&quot;, with a particular font", "body": "<p>You must get a well-formed HTML markup to get it working as required, but now you are trying to append a document with an existing markup, here is your current code:</p>\n\n<pre><code>.HTMLBody = \"&lt;HTML&gt;&lt;Body&gt;Dear \" &amp; xSenderName &amp; \",&lt;/HTML&gt;&lt;/Body&gt;\" &amp; xGreetStr &amp; .HTMLBody\n</code></pre>\n\n<p>Instead, you must find an opening <code>&lt;body&gt;</code> tag and insert your own text right after the tag.</p>\n\n<pre><code>.HTMLBody = .HTMLBody.FindTheBodyElement().PasteYourStuff() \n</code></pre>\n\n<p>So, you will get a well-formed HTML markup with opening and closing <code>&lt;body&gt;</code> tags.</p>\n"}], "owner": {"reputation": 2423, "user_id": 4058737, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2518d6a04eb7df5d9ec95142943a6d6f?s=128&d=identicon&r=PG&f=1", "display_name": "rsc05", "link": "https://stackoverflow.com/users/4058737/rsc05"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 129, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1580275142, "creation_date": 1573038596, "last_edit_date": 1580275142, "question_id": 58728778, "link": "https://stackoverflow.com/questions/58728778/reply-to-an-email-with-first-name-last-name-not-with-last-name-first-name", "title": "Reply to an email with &quot;First Name Last Name&quot;, not with &quot;Last Name, First Name&quot;, with a particular font", "body": "<p>I am trying to reply to an email in an organisation, using my own font and color with some minor changes to the codes available on <a href=\"https://www.extendoffice.com/fi/documents/outlook/5417-outlook-dear-first-name.html\" rel=\"nofollow noreferrer\">https://www.extendoffice.com/fi/documents/outlook/5417-outlook-dear-first-name.html</a></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public WithEvents GExplorer As Outlook.Explorer\nPublic WithEvents GMailItem As Outlook.MailItem\n\nPrivate Sub Application_Startup()\n    Set GExplorer = Outlook.Application.ActiveExplorer\nEnd Sub\n\nPrivate Sub GExplorer_SelectionChange()\n    Dim xItem As Object\n    On Error Resume Next\n    Set xItem = GExplorer.Selection.Item(1)\n    If xItem.Class &lt;&gt; olMail Then Exit Sub\n    Set GMailItem = xItem\nEnd Sub\n\nPrivate Sub GMailItem_Reply(ByVal Response As Object, Cancel As Boolean)\n    AutoAddGreetingToReply Response\nEnd Sub\n\nPrivate Sub GMailItem_ReplyAll(ByVal Response As Object, Cancel As Boolean)\n    AutoAddGreetingToReply Response\nEnd Sub\n\nSub AutoAddGreetingToReply(Item As Object)\n    Dim xGreetStr As String\n    Dim xReplyMail As MailItem\n    Dim xSenderName As String\n    Dim xRecipient As Recipient\n    On Error Resume Next\n    If Item.Class &lt;&gt; olMail Then Exit Sub\n    Set xReplyMail = Item\n    For Each xRecipient In xReplyMail.Recipients\n        If xSenderName = \"\" Then\n            xSenderName = xRecipient.Name\n        Else\n            xSenderName = xSenderName &amp; \",\" &amp; xRecipient.Name\n        End If\n    Next xRecipient\n    Select Case Time\n           Case 0.3 To 0.5\n                xGreetStr = \" Good morning, thank you for your email.\"\n           Case 0.5 To 0.75\n                xGreetStr = \" Good afternoon, thank you for your email.\"\n           Case Else\n                xGreetStr = \" Good evening, thank you for your email.\"\n    End Select\n    With xReplyMail\n        .Display\n        .HTMLBody = \"&lt;HTML&gt;&lt;Body&gt;Dear \" &amp; xSenderName &amp; \",&lt;/HTML&gt;&lt;/Body&gt;\" &amp; xGreetStr &amp; .HTMLBody\n    End With\nEnd Sub\n</code></pre>\n\n<p>I receive the following. The code is copying the exact layout of the person who emailed me. </p>\n\n<p><a href=\"https://i.stack.imgur.com/sxxek.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sxxek.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I want to amend this code to have something like</p>\n\n<p><a href=\"https://i.stack.imgur.com/Da6PS.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Da6PS.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Furthermore, when I run this code I can not use ctrl-z to undo.</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1573576302, "post_id": 58728522, "comment_id": 103922621, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/48708291/how-can-i-convert-a-selection-of-emails-from-richtext-to-html-format\">How can I convert a selection of emails from RichText to HTML Format?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12331471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44a2b97c42b6d9d184b17a13a1f44cf5?s=128&d=identicon&r=PG&f=1", "display_name": "outlookvba", "link": "https://stackoverflow.com/users/12331471/outlookvba"}, "edited": false, "score": 0, "creation_date": 1573039685, "post_id": 58728838, "comment_id": 103748981, "body": "Thank you for the information. Unfortunately I don&#39;t experience to create the specific function that triggers the format change. The linked example is only for new e-mails. Can you help me with that?"}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1573038773, "creation_date": 1573038773, "answer_id": 58728838, "question_id": 58728522, "link": "https://stackoverflow.com/questions/58728522/how-to-automatically-change-e-mail-view-from-text-to-html-in-outlook/58728838#58728838", "title": "How to automatically change e-mail view from text to html in Outlook", "body": "<p>The <a href=\"https://docs.microsoft.com/en-us/office/vba/api/outlook.mailitem.bodyformat\" rel=\"nofollow noreferrer\">MailItem.BodyFormat</a> property returns or sets an <code>OlBodyFormat</code> constant indicating the format of the body text.</p>\n\n<pre><code>'Set body format to HTML  \nMailItem.BodyFormat = olFormatHTML \n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12331471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44a2b97c42b6d9d184b17a13a1f44cf5?s=128&d=identicon&r=PG&f=1", "display_name": "outlookvba", "link": "https://stackoverflow.com/users/12331471/outlookvba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1583834506, "creation_date": 1573037821, "last_edit_date": 1583834506, "question_id": 58728522, "link": "https://stackoverflow.com/questions/58728522/how-to-automatically-change-e-mail-view-from-text-to-html-in-outlook", "title": "How to automatically change e-mail view from text to html in Outlook", "body": "<p>In Outlook, my e-mails are displayed as plain text due to e-mail security gorup policies. I have to activate html view via the menu above the mail content each time when I open the e-mail.</p>\n\n<p>Is there a simple VBA code that automatically changes the view from text to html, when opening the e-mail?</p>\n\n<p>Any help will be highly appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1573038496, "post_id": 58728427, "comment_id": 103748377, "body": "What&#39;s the reason for not using the header? (your current approach is not going to work)"}, {"owner": {"reputation": 13, "user_id": 9934303, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GQhYO.png?s=128&g=1", "display_name": "MatLcq", "link": "https://stackoverflow.com/users/9934303/matlcq"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1573039952, "post_id": 58728427, "comment_id": 103749128, "body": "Page number is included in a layout imposed by a customer, so we need control over where and how to display it, which was the reason we went for putting the page number in a cell"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1573040055, "post_id": 58728427, "comment_id": 103749178, "body": "Then I think you&#39;re going to actually have to repeat those rows on the sheet itself, not via the print setup."}, {"owner": {"reputation": 13, "user_id": 9934303, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GQhYO.png?s=128&g=1", "display_name": "MatLcq", "link": "https://stackoverflow.com/users/9934303/matlcq"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1573051317, "post_id": 58728427, "comment_id": 103755474, "body": "Following your idea to use headers, is there a way then to position a header field more precisely than just using the top margin? If i want to move it a bit further left for instance to overlap with the corresponding cell? Thank you"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1573052459, "post_id": 58728427, "comment_id": 103756166, "body": "You&#39;d have to pad with spaces until it&#39;s in the right location."}, {"owner": {"reputation": 13, "user_id": 9934303, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GQhYO.png?s=128&g=1", "display_name": "MatLcq", "link": "https://stackoverflow.com/users/9934303/matlcq"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1573058717, "post_id": 58728427, "comment_id": 103759894, "body": "Ok, not ideal but does the job as long as top rows height are &quot;locked&quot; somehow and columns width too.Thanks"}], "owner": {"reputation": 13, "user_id": 9934303, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GQhYO.png?s=128&g=1", "display_name": "MatLcq", "link": "https://stackoverflow.com/users/9934303/matlcq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573037497, "creation_date": 1573037497, "question_id": 58728427, "link": "https://stackoverflow.com/questions/58728427/how-to-display-the-correct-page-number-in-the-rows-to-repeat-at-top-of-an-excel", "title": "How to display the correct page number in the rows to repeat at top of an Excel sheet so that they adapt when printing on multiple pages", "body": "<p>I have an Excel document containing a sheet spanning multiple A4 pages. I have set up some rows to repeat at top, that indeed repeat on each A4 page when printing.\nA cell of these top rows contains the page number and number of pages. I compute the number of pages using a VBA sub called each time we save the Excel document:</p>\n\n<pre><code>Sub Refresh_NumPages()\n    NumPages = 0\n    For i = 1 To ThisWorkbook.Sheets.Count\n        If ThisWorkbook.Sheets(i).Visible = -1 Then\n            j = ThisWorkbook.Sheets(i).PageSetup.Pages.Count\n            NumPages = NumPages + j\n        End If\n    Next\n\n    Worksheets(\"Sheet1\").Cells(14, 5).Value = \"Page 1/\" &amp; NumPages\nEnd Sub\n</code></pre>\n\n<p>Problem: page number is the same on each A4 page.</p>\n\n<p>Question: how can I make the page number to adapt, the same way it does in an excel header, but in that particular cell</p>\n\n<p>Exemple: let's say that I have my sheet spanning 4 pages (A4), on the first page the cell would contain 1/4, on the second page the cell would contain 2/4, etc.</p>\n\n<p>Thank you for your suggestions</p>\n"}, {"tags": ["vba", "outlook", "outlook-filter"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 8261213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/658d0698d65556d64200e89832ee34ea?s=128&d=identicon&r=PG&f=1", "display_name": "Irina G.", "link": "https://stackoverflow.com/users/8261213/irina-g"}, "edited": false, "score": 0, "creation_date": 1573050428, "post_id": 58730505, "comment_id": 103754976, "body": "Thank you for the answer. When i put the Code to &quot;ThisOutlookSession&quot;, then Close and open Outlook, nothing is happen."}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1573044340, "creation_date": 1573044340, "answer_id": 58730505, "question_id": 58728294, "link": "https://stackoverflow.com/questions/58728294/change-flagstatus-on-moving-to-shared-mailbox/58730505#58730505", "title": "Change Flagstatus on moving to Shared Mailbox", "body": "<ol>\n<li>The first task is to mark all completed items with a green flag at startup:</li>\n</ol>\n\n<pre><code>Private WithEvents Items As Outlook.Items\n\nPrivate Sub Application_Startup()\n    Dim olNameSpace As Outlook.NameSpace\n    Dim olFolder As Outlook.MAPIFolder\n\n    Set olNameSpace = Application.GetNamespace(\"MAPI\")\n    Set olFolder = olNameSpace.Folders(\"name@company.com\")\n    Set olFolder = olFolder.Folders(\"Completed\")\n    Set Items = olFolder.Items\n    For Each Item In Items\n      If TypeOf Item Is Outlook.MailItem Then\n        Set Mail = Item\n\n        If Mail.FlagStatus = olFlagMarked Then\n            Set Mail.FlagStatus = olFlagComplete\n        End If\n      End If\n     Next \n\nEnd Sub\n\n</code></pre>\n\n<ol start=\"2\">\n<li>The second part is to handle newly added items to the <code>Completed</code> folder:</li>\n</ol>\n\n<pre><code>Private Sub Items_ItemAdd(ByVal Item As Object)  \n    If TypeOf Item Is Outlook.MailItem Then\n        Set Mail = Item\n\n        If Mail.FlagStatus = olFlagMarked Then            \n            Set Mail.FlagStatus = olFlagComplete\n        End If        \n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1573099063, "creation_date": 1573099063, "answer_id": 58741788, "question_id": 58728294, "link": "https://stackoverflow.com/questions/58728294/change-flagstatus-on-moving-to-shared-mailbox/58741788#58741788", "title": "Change Flagstatus on moving to Shared Mailbox", "body": "<p>You need to save the message afterwards - call <code>Mail.Save</code> after setting the <code>FlagStatus</code> property.</p>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 8261213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/658d0698d65556d64200e89832ee34ea?s=128&d=identicon&r=PG&f=1", "display_name": "Irina G.", "link": "https://stackoverflow.com/users/8261213/irina-g"}, "edited": false, "score": 0, "creation_date": 1573213401, "post_id": 58743510, "comment_id": 103817581, "body": "Shows an error on starting Outlook. Can&#39;t find the &quot;Completed&quot; Folder. By Debugging it Shows &quot;Nothing&quot; for the &quot;Completed_Fldrs&quot;"}, {"owner": {"reputation": 15, "user_id": 8261213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/658d0698d65556d64200e89832ee34ea?s=128&d=identicon&r=PG&f=1", "display_name": "Irina G.", "link": "https://stackoverflow.com/users/8261213/irina-g"}, "edited": false, "score": 0, "creation_date": 1573455832, "post_id": 58743510, "comment_id": 103874570, "body": "Not really, but I can usually customize the code to my needs. Now the code works. As I can see from forums, the problem was the access to subfolders of a shared mailbox. I have solved it with this line: &quot;Set Completed_Fldrs = olNs.GetFolderFromID(&quot;xxx&quot;)&quot;. Can you explain me how the filter works, so what exactly is filtered?"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "reply_to_user": {"reputation": 15, "user_id": 8261213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/658d0698d65556d64200e89832ee34ea?s=128&d=identicon&r=PG&f=1", "display_name": "Irina G.", "link": "https://stackoverflow.com/users/8261213/irina-g"}, "edited": false, "score": 0, "creation_date": 1573810243, "post_id": 58743510, "comment_id": 104015664, "body": "@IrinaG. see links on the answers <a href=\"https://stackoverflow.com/a/43268976/4539709\">stackoverflow.com/a/43268976/4539709</a>"}, {"owner": {"reputation": 15, "user_id": 8261213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/658d0698d65556d64200e89832ee34ea?s=128&d=identicon&r=PG&f=1", "display_name": "Irina G.", "link": "https://stackoverflow.com/users/8261213/irina-g"}, "edited": false, "score": 0, "creation_date": 1573896147, "post_id": 58743510, "comment_id": 104044560, "body": "Thank you very much. Your help here is valuable :)"}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": true, "score": 0, "last_activity_date": 1573110220, "creation_date": 1573110220, "answer_id": 58743510, "question_id": 58728294, "link": "https://stackoverflow.com/questions/58728294/change-flagstatus-on-moving-to-shared-mailbox/58743510#58743510", "title": "Change Flagstatus on moving to Shared Mailbox", "body": "<p><em>Is this what you are trying to do?</em></p>\n\n<pre><code>Option Explicit\nPrivate Sub Application_Startup()\n    Dim Item As Object\n    Mark_Items Item\nEnd Sub\n\nPrivate Function Mark_Items(ByVal Item As Object)\n    Dim olNs As Outlook.NameSpace\n    Set olNs = Application.GetNamespace(\"MAPI\")\n\n    Dim olShareName As Outlook.Recipient\n    Set olShareName = olNs.CreateRecipient(\"0m3r@email.com\")\n\n    Dim olShareInbox As Outlook.folder\n    Set olShareInbox = olNs.GetSharedDefaultFolder(olShareName, olFolderInbox)\n\n    Dim Completed_Fldrs As Outlook.MAPIFolder\n    Set Completed_Fldrs = olShareInbox.Folders(\"Completed\")\n\n    Dim Filter As String\n        Filter = \"@SQL=\" &amp; Chr(34) &amp; _\n                 \"http://schemas.microsoft.com/mapi/proptag/0x10900003\" &amp; _\n                           Chr(34) &amp; \"&gt;1\"\n\n    Dim Items As Outlook.Items\n    Set Items = Completed_Fldrs.Items.Restrict(Filter)\n\n    Dim Mail As MailItem\n\n    Dim i As Long\n    For i = Items.Count To 1 Step -1\n        DoEvents\n        If TypeOf Items(i) Is Outlook.MailItem Then\n            Set Mail = Items(i)\n            Debug.Print Mail.Subject\n            Mail.FlagStatus = olFlagComplete\n            Mail.Save\n        End If\n    Next\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 8261213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/658d0698d65556d64200e89832ee34ea?s=128&d=identicon&r=PG&f=1", "display_name": "Irina G.", "link": "https://stackoverflow.com/users/8261213/irina-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 240, "favorite_count": 0, "accepted_answer_id": 58743510, "answer_count": 3, "score": 1, "last_activity_date": 1587049197, "creation_date": 1573037073, "last_edit_date": 1587049197, "question_id": 58728294, "link": "https://stackoverflow.com/questions/58728294/change-flagstatus-on-moving-to-shared-mailbox", "title": "Change Flagstatus on moving to Shared Mailbox", "body": "<p>Is it possible to change the Flagstatus of emails moved to a folder in a shared mailbox?</p>\n\n<p>Example: I receive a new mail and mark it with a red flag. Then, when the job is completed, I move the mail to the folder \"Completed\".</p>\n\n<p>After moving the mail to this folder, I want the Flagstatus to be \"olFlagComplete\" (Green Flag) and every time I open Outlook, the code should check the folder for mails with red flag (e.g. Mails moved from mobile phone) and set it to green flag.</p>\n\n<p>I tried the following, but nothing happened.</p>\n\n<pre><code>Private WithEvents Items As Outlook.Items\n\nPrivate Sub Application_Startup()\n    Dim olNameSpace As Outlook.NameSpace\n    Dim olFolder As Outlook.MAPIFolder\n\n    Set olNameSpace = Application.GetNamespace(\"MAPI\")\n    Set olFolder = olNameSpace.Folders(\"name@company.com\")\n    Set olFolder = olFolder.Folders(\"Completed\")\n    Set Items = olFolder.Items\nEnd Sub\n\nPrivate Sub Items_ItemChange(ByVal Item As Object)\n    Dim olNameSpace As Outlook.NameSpace\n    Dim olFolder As Outlook.MAPIFolder\n    Dim Mail As MailItem\n\n    Set olNameSpace = Application.GetNamespace(\"MAPI\")\n    Set olFolder = olNameSpace.Folders(\"name@company.com\")\n    Set olFolder = olFolder.Folders(\"Completed\")\n\n    If TypeOf Item Is Outlook.MailItem Then\n        Set Mail = Item\n\n        If Mail.FlagStatus = olFlagMarked Then\n            'Set ItemCopy = Item.Copy ' Copy Flagged item\n            'ItemCopy.Move olFolder ' Move Copied item\n            Set Mail.FlagStatus = olFlagComplete\n        End If\n\n        Set Item = Nothing\n        'Set ItemCopy = Nothing\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "charts"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1573036316, "post_id": 58727958, "comment_id": 103747193, "body": "Change the <code>Series.PlotOrder</code> property."}, {"owner": {"reputation": 37, "user_id": 12041350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f50f53f555b2b611aa26afed17b6c77d?s=128&d=identicon&r=PG&f=1", "display_name": "SSGrace", "link": "https://stackoverflow.com/users/12041350/ssgrace"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1573050639, "post_id": 58727958, "comment_id": 103755113, "body": "Thanks, @Rory! I didn&#39;t know this property, it worked perfectly! Where can I check all the available Series properties, do you know?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1573052422, "post_id": 58727958, "comment_id": 103756139, "body": "In the Object Browser (f2) in the VB Editor."}], "owner": {"reputation": 37, "user_id": 12041350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f50f53f555b2b611aa26afed17b6c77d?s=128&d=identicon&r=PG&f=1", "display_name": "SSGrace", "link": "https://stackoverflow.com/users/12041350/ssgrace"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573035919, "creation_date": 1573035919, "question_id": 58727958, "link": "https://stackoverflow.com/questions/58727958/changing-the-order-of-the-stacked-columns-in-vba", "title": "Changing the order of the stacked columns in vba", "body": "<p>community,</p>\n\n<p>In VBA/Excel, how is the order of the stacked columns sorted? \nFor instance, in the below chart, horse riding columns appear below the trekking columns. How does one put the horse riding columns above the others, in terms of VBA? Is it possible to decide the order of the stacked columns and fix it?</p>\n\n<p><a href=\"https://i.stack.imgur.com/DR8DD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DR8DD.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 3305, "user_id": 4394120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406cb60beef9747079a4e43625b43c35?s=128&d=identicon&r=PG", "display_name": "John Korchok", "link": "https://stackoverflow.com/users/4394120/john-korchok"}, "edited": false, "score": 0, "creation_date": 1573055557, "post_id": 58727861, "comment_id": 103758084, "body": "Sorry, you&#39;ll have to clarify paragraphs 3 and 4. It&#39;s not at all clear what you&#39;re trying to do."}, {"owner": {"reputation": 1, "user_id": 8608326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98896d82ff74fcadb08c6c49356f03d2?s=128&d=identicon&r=PG&f=1", "display_name": "Gopa", "link": "https://stackoverflow.com/users/8608326/gopa"}, "reply_to_user": {"reputation": 3305, "user_id": 4394120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406cb60beef9747079a4e43625b43c35?s=128&d=identicon&r=PG", "display_name": "John Korchok", "link": "https://stackoverflow.com/users/4394120/john-korchok"}, "edited": false, "score": 0, "creation_date": 1573105800, "post_id": 58727861, "comment_id": 103774442, "body": "Consider i have slides 2-10 and i loop through them using the code i wrote above. The problem here is that the slides run one by one without any delay. So, I want to show slide 2-10 on click of a button Beginner but they should move only on mouse click but till 10 only not after 10 which usually happens in a slide show."}, {"owner": {"reputation": 3305, "user_id": 4394120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406cb60beef9747079a4e43625b43c35?s=128&d=identicon&r=PG", "display_name": "John Korchok", "link": "https://stackoverflow.com/users/4394120/john-korchok"}, "edited": false, "score": 0, "creation_date": 1573140302, "post_id": 58727861, "comment_id": 103791904, "body": "Please explain why you need to do this in VBA. Instead, just create 2 custom shows (<a href=\"https://support.office.com/en-us/article/create-and-present-a-custom-show-09d4d340-3c47-4125-b177-0de3be462c5d\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>), set each slide to advance on click and make the shapes into action buttons that jump to the start of each custom show."}], "owner": {"reputation": 1, "user_id": 8608326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98896d82ff74fcadb08c6c49356f03d2?s=128&d=identicon&r=PG&f=1", "display_name": "Gopa", "link": "https://stackoverflow.com/users/8608326/gopa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573037717, "creation_date": 1573035581, "last_edit_date": 1573037717, "question_id": 58727861, "link": "https://stackoverflow.com/questions/58727861/move-slides-in-a-slideshow-on-mouse-click-using-vba", "title": "Move slides in a slideshow on mouse click using vba", "body": "<p>On a PowerPoint slide I have two buttons: <code>Beginner</code> and <code>Advanced</code>. When I click <code>Beginner</code> a particular set of slides is displayed and the same goes for <code>Advanced</code>.</p>\n\n<p>But on clicking the button all the slides are displayed one after the other in a loop. </p>\n\n<p>But my requirement is to move the set of slides for the specific buttons on mouse click and not automatically. I don't want to add a delay to the slides.</p>\n\n<p>Below is the code but I don't know how to advance on click. Can anybody suggest an idea on how to do that?</p>\n\n<pre><code>Sub ExampleSlideRange()\n    Dim index, i, count As Integer\n    index = 2\n    count = 9\n    For i = index To count\n        ActivePresentation.SlideShowWindow.View.GotoSlide i\n    Next i\n    ActivePresentation.SlideShowWindow.View.GotoSlide 1\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "count"], "comments": [{"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 2, "creation_date": 1573032180, "post_id": 58725903, "comment_id": 103744821, "body": "At which line do you get the error message but I guess <a href=\"https://excelmacromastery.com/excel-vba-worksheet/#Subscript_Out_of_Range\" rel=\"nofollow noreferrer\">this</a> should point you in the right direction."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 2, "creation_date": 1573032912, "post_id": 58725903, "comment_id": 103745270, "body": "Just and advice. You are looping 70 times in each worksheet of each workbook, and looking at your code, it looks like you just want to count how many rows contain value <code>Wash</code> in column B and value <code>T</code> in column D in range <code>B5:D74</code> always. I&#39;m pretty sure you can substitute that loop for a COUNTIFS.Something like <code>application.WorksheetFunction.CountIfs(ws.Range(&quot;B5:B74&quot;),&quot;W&zwnj;&#8203;ash&quot;,ws.Range(&quot;D5:D7&zwnj;&#8203;4&quot;),&quot;T&quot;)</code> should return the total <code>wash_count</code> in a worksheet. You don&#39;t need to do it 1 by 1"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 12318219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9481e62604d3a4bb03ed95862417e19d?s=128&d=identicon&r=PG&f=1", "display_name": "mkj2000", "link": "https://stackoverflow.com/users/12318219/mkj2000"}, "edited": false, "score": 0, "creation_date": 1573053364, "post_id": 58727184, "comment_id": 103756726, "body": "i seem to have an error of &#39;run time error &quot;91&quot; &#39; at the line     &#39; For Each ws In wb.Sheets&#39;"}, {"owner": {"reputation": 77, "user_id": 10010199, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3uK6o060DtE/AAAAAAAAAAI/AAAAAAAAAEY/9VOm6jNZEAM/photo.jpg?sz=128", "display_name": "St3ve", "link": "https://stackoverflow.com/users/10010199/st3ve"}, "reply_to_user": {"reputation": 5, "user_id": 12318219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9481e62604d3a4bb03ed95862417e19d?s=128&d=identicon&r=PG&f=1", "display_name": "mkj2000", "link": "https://stackoverflow.com/users/12318219/mkj2000"}, "edited": false, "score": 0, "creation_date": 1573054427, "post_id": 58727184, "comment_id": 103757438, "body": "I am sorry to hear that. I can&#39;t seem to replicate the issue. Does it happen on the first run, or it runs fine for the first time and crashes later? And does the &#39;myFile&#39; open properly? and if you used your original code and just add the &#39;set wb =&#39; instead of &#39;wb = &#39;, would that work?"}, {"owner": {"reputation": 5, "user_id": 12318219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9481e62604d3a4bb03ed95862417e19d?s=128&d=identicon&r=PG&f=1", "display_name": "mkj2000", "link": "https://stackoverflow.com/users/12318219/mkj2000"}, "edited": false, "score": 0, "creation_date": 1573086069, "post_id": 58727184, "comment_id": 103770379, "body": "hi i have tried it, i am still getting the error code 9, there is a total of 3 workbooks in my folder to test and each is named Book1, Book2 and Book3. The code doesnt seem to pass through Book1 as i tried replacing the file name to Book1 and it managed to get the msgbox to appear"}, {"owner": {"reputation": 77, "user_id": 10010199, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3uK6o060DtE/AAAAAAAAAAI/AAAAAAAAAEY/9VOm6jNZEAM/photo.jpg?sz=128", "display_name": "St3ve", "link": "https://stackoverflow.com/users/10010199/st3ve"}, "reply_to_user": {"reputation": 5, "user_id": 12318219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9481e62604d3a4bb03ed95862417e19d?s=128&d=identicon&r=PG&f=1", "display_name": "mkj2000", "link": "https://stackoverflow.com/users/12318219/mkj2000"}, "edited": false, "score": 0, "creation_date": 1573123266, "post_id": 58727184, "comment_id": 103782507, "body": "Hi, I&#39;m unable to replicate the issue, for me it&#39;s working fine (apart from that the wash_count is saved in each of  the &#39;xls&#39; workbooks, not to the &#39;main&#39; one). Would you please let me know where you want the final count to be saved? In a new workbook, to an existing workbook or to the workbook where the macro runs from? Also does the &#39;myFile&#39; contain a value that makes sense before starting the for each ws loop (the set &#39;wb = ..&#39; runs ok?"}, {"owner": {"reputation": 5, "user_id": 12318219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9481e62604d3a4bb03ed95862417e19d?s=128&d=identicon&r=PG&f=1", "display_name": "mkj2000", "link": "https://stackoverflow.com/users/12318219/mkj2000"}, "edited": false, "score": 0, "creation_date": 1573172801, "post_id": 58727184, "comment_id": 103805061, "body": "Hi, the final outcome i want is for the total summaries sum to be in one existing workbook in the same folder"}], "tags": [], "owner": {"reputation": 77, "user_id": 10010199, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3uK6o060DtE/AAAAAAAAAAI/AAAAAAAAAEY/9VOm6jNZEAM/photo.jpg?sz=128", "display_name": "St3ve", "link": "https://stackoverflow.com/users/10010199/st3ve"}, "is_accepted": false, "score": 0, "last_activity_date": 1573033571, "creation_date": 1573033571, "answer_id": 58727184, "question_id": 58725903, "link": "https://stackoverflow.com/questions/58725903/count-data-from-various-workbooks-and-sheets-and-paste-it-in-one-workbook/58727184#58727184", "title": "Count data from various workbooks and sheets and paste it in one workbook", "body": "<p>I'll do my best to help :) I believe that the root cause of the issue was that you used 'wb1 =...' instead of 'set wb1 =..'. I made some additional edits and comments to the code and it seems to be working well for me. I am curious if it will resolve the issue for you too.</p>\n\n<pre><code>Dim ws As Worksheet\nDim wb As Workbook\nDim myPath As String\nDim myFile As String\nDim myExtension As String\nDim FldrPicker As FileDialog\nDim x As Integer\n\nDim wash_count As Integer\n\n\n'Optimize Macro Speed\n  Application.ScreenUpdating = False\n  Application.EnableEvents = False\n  Application.Calculation = xlCalculationManual\n\n'Retrieve Target Folder Path From User\n  Set FldrPicker = Application.FileDialog(msoFileDialogFolderPicker)\n\n   With FldrPicker\n  .Title = \"Select A Target Folder\"\n  .AllowMultiSelect = False\n    If .Show &lt;&gt; -1 Then GoTo NextCode\n    myPath = .SelectedItems(1) &amp; \"\\\"\nEnd With\n\n'In Case of Cancel\nNextCode:\n  myPath = myPath\n  If myPath = \"\" Then GoTo ResetSettings\n\n'Target File Extension (must include wildcard \"*\")\n  myExtension = \"*.xls*\"\n\n'Target Path with Ending Extention\n  myFile = Dir(myPath &amp; myExtension)\n\n'Loop through each Excel file in folder\n  Do While myFile &lt;&gt; \"\"\n'Set variable equal to opened workbook\n  Set wb = Workbooks.Open(Filename:=myPath &amp; myFile)\n\n'Ensure Workbook has opened before moving on to next line of code\n  DoEvents\n\n\n    For Each ws In wb.Sheets\n        If ws.Name &lt;&gt; \"Summary\" Then\n\n            For x = 5 To 74\n                If StrConv(ws.Cells(x, 2).Value, vbProperCase) = \"Wash\" And StrConv(ws.Cells(x, 4).Value, vbProperCase) = \"T\" Then 'added the StrConv to make sure you don't loose a case just because it was written in capital or lowercase letters\n                wash_count = wash_count + 1\n\n                End If\n\n            Next x\n\n        End If\n    Next ws\n\n\n    Set wb1 = Workbooks(\"Book3.xlsx\") 'wb1 = Workbooks(\"Book3.xlsx\")\n        'changed your code 'wb1 = Workbooks(\"Book3\")' to set 'wb1 =...' as workbook variables need to be assigned with 'set' command\n        'you might want to add some handling of whether the workbook 'Book3' is already opened and if not then to open it\n\n    'this seem strange to me, I thought you wanted to count the 'T's in all of the workbooks\n    'in the folder and then paste the final number to one place\n    'which I thought was going to be wb1 'Book3'\n    'if that was the case then the line 'wb.Sheets(\"Summary\").Range(\"D6\") = wash_count' should be\n    '-&gt; 'wb1.Sheets(\"Summary\").Range(\"D6\") = wash_count'\n        'also I'd move the whole line after the loop and paste only the final wash_count in the very end\n    wb.Sheets(\"Summary\").Range(\"D6\") = wash_count\n\n    'Save and Close Workbook\n          wb.Close SaveChanges:=True\n\n        'Ensure Workbook has closed before moving on to next line of code\n          DoEvents\n\n        'Get next file name\n          myFile = Dir\n  Loop\n\n'Message Box when tasks are completed\n  MsgBox \"Task Complete!\"\n\nResetSettings:\n  'Reset Macro Optimization Settings\n    Application.EnableEvents = True\n    Application.Calculation = xlCalculationAutomatic\n    Application.ScreenUpdating = True\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 12318219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9481e62604d3a4bb03ed95862417e19d?s=128&d=identicon&r=PG&f=1", "display_name": "mkj2000", "link": "https://stackoverflow.com/users/12318219/mkj2000"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573033571, "creation_date": 1573029018, "last_edit_date": 1573029088, "question_id": 58725903, "link": "https://stackoverflow.com/questions/58725903/count-data-from-various-workbooks-and-sheets-and-paste-it-in-one-workbook", "title": "Count data from various workbooks and sheets and paste it in one workbook", "body": "<p>I want to count how many times the letter \"T\" appears in the checklist from various workbook(each consisting of around 11 sheets) and paste the final data in one workbook.</p>\n\n<p>I have this code but i keep getting </p>\n\n<blockquote>\n  <p>\"error code 9\"</p>\n</blockquote>\n\n<p>I am pretty sure that i have defined the correct workbook. Is there any other ways to accomplish my final results? Thanks in advance</p>\n\n<pre><code>Private Sub CommandButton3_Click()\nDim ws As Worksheet\nDim wb As Workbook\nDim myPath As String\nDim myFile As String\nDim myExtension As String\nDim FldrPicker As FileDialog\nDim x As Integer\n\nDim wash_count As Integer\n\n\n'Optimize Macro Speed\n  Application.ScreenUpdating = False\n  Application.EnableEvents = False\n  Application.Calculation = xlCalculationManual\n\n'Retrieve Target Folder Path From User\n  Set FldrPicker = Application.FileDialog(msoFileDialogFolderPicker)\n\n    With FldrPicker\n      .Title = \"Select A Target Folder\"\n      .AllowMultiSelect = False\n        If .Show &lt;&gt; -1 Then GoTo NextCode\n        myPath = .SelectedItems(1) &amp; \"\\\"\n    End With\n\n'In Case of Cancel\nNextCode:\n  myPath = myPath\n  If myPath = \"\" Then GoTo ResetSettings\n\n'Target File Extension (must include wildcard \"*\")\n  myExtension = \"*.xls*\"\n\n'Target Path with Ending Extention\n  myFile = Dir(myPath &amp; myExtension)\n\n'Loop through each Excel file in folder\n  Do While myFile &lt;&gt; \"\"\n    'Set variable equal to opened workbook\n      Set wb = Workbooks.Open(Filename:=myPath &amp; myFile)\n\n    'Ensure Workbook has opened before moving on to next line of code\n      DoEvents\n\n\nFor Each ws In wb.Sheets\n    If ws.Name &lt;&gt; \"Summary\" Then\n\n        For x = 5 To 74\n            If ws.Cells(x, 2).Value = \"Wash\" And (ws.Cells(x, 4).Value = \"T\") Then\n            wash_count = wash_count + 1\n\n            End If\n\n        Next x\n\n    End If\nNext ws\n\nwb1 = Workbooks(\"Book3.xlsx\")\nwb1.Activate\nwb.Sheets(\"Summary\").Range(\"D6\") = wash_count\n\n'Save and Close Workbook\n      wb.Close SaveChanges:=True\n\n    'Ensure Workbook has closed before moving on to next line of code\n      DoEvents\n\n    'Get next file name\n      myFile = Dir\n  Loop\n\n'Message Box when tasks are completed\n  MsgBox \"Task Complete!\"\n\nResetSettings:\n  'Reset Macro Optimization Settings\n    Application.EnableEvents = True\n    Application.Calculation = xlCalculationAutomatic\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "charts", "axis"], "comments": [{"owner": {"reputation": 1633, "user_id": 12001122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ec161ec6ec2ddb3c5ea5989f03fe053?s=128&d=identicon&r=PG&f=1", "display_name": "Jonas", "link": "https://stackoverflow.com/users/12001122/jonas"}, "edited": false, "score": 0, "creation_date": 1573042288, "post_id": 58725686, "comment_id": 103750412, "body": "Could you please add a screenshot of your excelsheet."}], "answers": [{"comments": [{"owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "edited": false, "score": 0, "creation_date": 1576214049, "post_id": 59066536, "comment_id": 104833979, "body": "What was the format that led to the undesirable axis label appearance."}, {"owner": {"reputation": 21, "user_id": 9161799, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96e1119e352145e1321227f7386bab54?s=128&d=identicon&r=PG&f=1", "display_name": "David94", "link": "https://stackoverflow.com/users/9161799/david94"}, "reply_to_user": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "edited": false, "score": 0, "creation_date": 1576316367, "post_id": 59066536, "comment_id": 104866129, "body": "I had it set to the default &#39;number&#39; format, since they are columns containing nothing else but numbers."}, {"owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "edited": false, "score": 0, "creation_date": 1576364236, "post_id": 59066536, "comment_id": 104877293, "body": "Default would be &#39;General&#39;, which wouldn&#39;t do that. Was the worksheet formatted with the 0.000 number format? This would format all numbers between 0.0045 and 0.0054999 as 0.005."}], "tags": [], "owner": {"reputation": 21, "user_id": 9161799, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96e1119e352145e1321227f7386bab54?s=128&d=identicon&r=PG&f=1", "display_name": "David94", "link": "https://stackoverflow.com/users/9161799/david94"}, "is_accepted": true, "score": 0, "last_activity_date": 1574845446, "creation_date": 1574845446, "answer_id": 59066536, "question_id": 58725686, "link": "https://stackoverflow.com/questions/58725686/chart-displaying-the-same-number-on-all-y-axis-ticks/59066536#59066536", "title": "Chart displaying the same number on all y axis ticks", "body": "<p>I found the solution to my problem:</p>\n\n<p>The problem was that the data cells for the chart had a number format, which for whatever reason messed up the chart. Changing the format to standard solved the problem.</p>\n\n<p>if anyone knows why this problem occurs when changing the cell format, please let me know.</p>\n"}], "owner": {"reputation": 21, "user_id": 9161799, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96e1119e352145e1321227f7386bab54?s=128&d=identicon&r=PG&f=1", "display_name": "David94", "link": "https://stackoverflow.com/users/9161799/david94"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 59066536, "answer_count": 1, "score": 0, "last_activity_date": 1574845446, "creation_date": 1573028119, "last_edit_date": 1573626809, "question_id": 58725686, "link": "https://stackoverflow.com/questions/58725686/chart-displaying-the-same-number-on-all-y-axis-ticks", "title": "Chart displaying the same number on all y axis ticks", "body": "<p>I am fairly new to VBA, so my provided code might be far from optimized.\nHowever, I'd be happy to hear what can be improved!</p>\n\n<p>I have a sheet with two columns of data, one cell for an entry, a scatter chart, and three buttons.\nThe chart is supposed to simply plot the two columns and add the value of the entry cell as a vertical line.\nOne button is supposed to refresh the chart (e.g. to adjust the axes).\nAnother one is supposed to show an example by inserting some data, stored in another hidden sheet, into the two columns as well as in the entry cell and after that refresh the chart.\nThe last button is supposed to simply reset the sheet, so that the data columns as well as the entry cell are empty and the chart should be hidden.</p>\n\n<p>The Problem:\nThe refresh button however does not work.\nIt seems to resize the viewing field of the chart according to the newly entered data. But the numbers shown at the y axis are always 0.05.\nI have provided a picture to show you what I mean:</p>\n\n<p><img src=\"https://i.imgur.com/mCjHZkc.jpg\" alt=\"Sheet\">\n<img src=\"https://i.imgur.com/2ISWCVV.jpg\" alt=\"Chart\"></p>\n\n<p>When I press the example button, the y axis shows correct values. I tried copying the data in the columns to a different sheet first, then refreshing the chart and then pasting the data back into the columns, with no success.</p>\n\n<p>I noticed that when the chart shows only 0.05 and I click on the chart to \"select data\" and simply select the second series, the y values change to what they should be and I can close the window and it stays as it should be until I press the refresh button again.</p>\n\n<p>Maybe my code has flaws that I am unaware of? Maybe I need to, instead of refreshing the chart, delete the old one and create a new one each time? However, I already tried that with the same result. Maybe the code must be written in a different sequence?</p>\n\n<p>The example button:</p>\n\n<pre><code>Private Sub ExampleBtn_Click()\n\nCall RefreshBtn_Click\n\nRange(\"C5:D27\").ClearContents 'data columns\n\nRange(\"C5:D14\").Value = Sheets(\"ExampleSheet\").Range(\"A1:B10\").Value\nRange(\"O3\").Value = 3.5 'entry cell\n\nEnd Sub\n\n</code></pre>\n\n<p>The reset button:</p>\n\n<pre><code>Private Sub ResetBtn_Click()\n\nActiveSheet.ChartObjects(1).Visible = False\n\nRange(\"C5:D27\").ClearContents 'data columns\nRange(\"O3\").ClearContents 'entry cell\nRange(\"C5\").Select\n\nEnd Sub\n\n</code></pre>\n\n<p>The refresh button:</p>\n\n<pre><code>Private Sub RefreshBtn_Click()\n\nActiveSheet.Unprotect\nApplication.ScreenUpdating = False\n\n\nActiveSheet.ChartObjects(1).Visible = True\n\n'range of Nachdruckzeit\nSet zeit = Range(\"C5:C27\")\n\n'range of Masse\nSet masse = Range(\"D5:D27\")\n\nyMax = Application.WorksheetFunction.max(Range(\"D5:D27\")) + 0.02\nyMin = Application.WorksheetFunction.min(Range(\"D5:D27\")) - 0.02\n\n'refresh the chart\nWith ActiveSheet.ChartObjects(1)\n    .Width = Range(\"F5:P30\").Width\n    .Height = Range(\"F5:P30\").Height\n\n    If .Chart.SeriesCollection.Count = 1 Then\n        .Chart.SeriesCollection(1).Delete\n    ElseIf .Chart.SeriesCollection.Count = 2 Then\n        .Chart.SeriesCollection(2).Delete\n        .Chart.SeriesCollection(1).Delete\n    End If\n\n    With .Chart.SeriesCollection.NewSeries\n        .XValues = zeit\n        .Values = masse\n        .Name = \"Siegelpunktermittlung\"\n        .HasDataLabels = False\n    End With\n\n    t = Range(\"O3\").Value 'entry cell\n    With .Chart.SeriesCollection.NewSeries\n        .Name = \"gewaehlt\"\n        .XValues = Array(t, t)\n        .Values = Array(0, yMax)\n        .MarkerStyle = xlMarkerStyleNone\n        .Border.Color = vbWhite\n    End With\nEnd With\n\n'Cosmetics\nWith ActiveSheet.ChartObjects(1).Chart\n  .HasLegend = False\n  .ChartArea.Format.Fill.Visible = msoFalse\n  .PlotArea.Format.Fill.Visible = msoFalse\n  .SeriesCollection(1).MarkerStyle = xlMarkerStyleCircle\n  .SeriesCollection(1).Format.Fill.ForeColor.RGB = RGB(251, 243, 223)\n  .SeriesCollection(1).Format.Line.ForeColor.RGB = RGB(255, 140, 0)\n  .SeriesCollection(1).MarkerForegroundColorIndex = -4142\n\n  'x-axis\n  With .Axes(xlCategory)\n    .HasTitle = True\n    .TickLabels.Font.Color = vbWhite\n    .AxisTitle.Font.Size = 12\n    .AxisTitle.Font.Color = vbWhite\n    .AxisTitle.Caption = \"Nachdruckzeit [s]\"\n  End With\n\n  'y-axis\n  With .Axes(xlValue)\n    .HasTitle = True\n    .MinimumScale = yMin\n    .MaximumScale = yMax\n    .TickLabels.Font.Color = vbWhite\n    .AxisTitle.Font.Size = 12\n    .AxisTitle.Font.Color = vbWhite\n    .AxisTitle.Caption = \"Masse [g]\"\n  End With\nEnd With\n\n\nApplication.ScreenUpdating = True\nActiveSheet.Protect\n\nEnd Sub\n\n\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 2568, "user_id": 1354800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a71c67e2f068118e6608f28a5e40b07?s=128&d=identicon&r=PG", "display_name": "Peter Schneider", "link": "https://stackoverflow.com/users/1354800/peter-schneider"}, "is_accepted": true, "score": 0, "last_activity_date": 1573029556, "creation_date": 1573029556, "answer_id": 58726042, "question_id": 58725323, "link": "https://stackoverflow.com/questions/58725323/unrecognised-database-format-when-build-connection-to-excel-file/58726042#58726042", "title": "Unrecognised database format when build connection to excel file", "body": "<p>You are missing a semicolon in your connectionstring, and probably the quotes if your filename contains spaces.</p>\n\n<p>The line </p>\n\n<pre><code>.ConnectionString = \"Data Source=\" &amp; dtpth &amp; \"Extended properties='Excel 16.0 xml;HDR=Yes;IMEX=1';\"\n</code></pre>\n\n<p>should look like </p>\n\n<pre><code>.ConnectionString = \"Data Source='\" &amp; dtpth &amp; \"';Extended properties='Excel 16.0 xml;HDR=Yes;IMEX=1';\"\n</code></pre>\n\n<p><a href=\"https://www.connectionstrings.com/ace-oledb-12-0/\" rel=\"nofollow noreferrer\">Here's</a> a good reference for the possible connectionstring formats.</p>\n"}], "owner": {"reputation": 5, "user_id": 12258279, "user_type": "registered", "profile_image": "https://graph.facebook.com/3017849008230168/picture?type=large", "display_name": "Vu Hoang", "link": "https://stackoverflow.com/users/12258279/vu-hoang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 58726042, "answer_count": 1, "score": 0, "last_activity_date": 1573030243, "creation_date": 1573026429, "last_edit_date": 1573029336, "question_id": 58725323, "link": "https://stackoverflow.com/questions/58725323/unrecognised-database-format-when-build-connection-to-excel-file", "title": "Unrecognised database format when build connection to excel file", "body": "<p>I'm trying to build an add-in which will build a connection to an optional database (excel or access file).</p>\n\n<p>It's fine with access but when try with an Excel file the below error happens: </p>\n\n<blockquote>\n  <p>\"Unrecognized database format\"</p>\n</blockquote>\n\n<pre><code>Sub export_data()\n    Dim conn As ADODB.Connection\n    Dim flg As FileDialog\n    Dim dtpth As String\n\n\n    Set flg = Application.FileDialog(msoFileDialogFilePicker)\n    With flg\n        .AllowMultiSelect = False\n        .Filters.Clear\n        .Filters.Add Description:=\"Database file type\", Extensions:=\"*.xls,*.xlsx,*.xlsm,*.accdb\"\n        .Filters.Add Description:=\"All types\", Extensions:=\"*.*\"\n        .Title = \"Chon file database\"\n        If .Show = -1 Then\n            dtpth = .SelectedItems(1)\n            Sheet2.Range(\"A1\").Value = dtpth\n        End If\n    End With\n\n    Set conn = New ADODB.Connection\n    With conn\n        .Provider = \"Microsoft.ACE.OLEDB.12.0\"\n        If Sheet2.Range(\"A2\").Value = \"*ls*\" Then\n            .ConnectionString = \"Data Source=\" &amp; dtpth &amp; \"Extended properties='Excel 16.0 xml;HDR=Yes;IMEX=1';\"\n            .Open\n        Else\n            .ConnectionString = \"Data Source=\" &amp; dtpth &amp; \";\"\n            .Open\n        End If\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Cause i'm new in this section, i can't debug the code by myself\nCould you please point out what make the code be wrong? I try research somewhere but most of them in access not excel</p>\n\n<p>Thank you very much</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 1410, "user_id": 2959880, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/TV9bv.jpg?s=128&g=1", "display_name": "Babyburger", "link": "https://stackoverflow.com/users/2959880/babyburger"}, "edited": false, "score": 0, "creation_date": 1573026917, "post_id": 58725293, "comment_id": 103742360, "body": "Take a look at this: <a href=\"https://stackoverflow.com/questions/16328551/non-intersect-range-vba\" title=\"non intersect range vba\">stackoverflow.com/questions/16328551/non-intersect-range-vba</a>  You are interested in finding the complement of the intersection elements."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1573128715, "post_id": 58725293, "comment_id": 103785453, "body": "Welcome to Stack Overflow. Please note that because this is no free code writing service it is necessary that you show either what you have tried so far and where you got stuck or errors (by showing your code) or at least to show what you have researched and the effort you made. Otherwise it is just asking us to do all the work for you. Reading <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> might help you to improve your question."}], "owner": {"reputation": 1, "user_id": 12318539, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDUmS9uNlMzX8Zvm9yHysUK6eoNfhilMxPUENZ-jQ=k-s128", "display_name": "tamilvanan", "link": "https://stackoverflow.com/users/12318539/tamilvanan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573128681, "creation_date": 1573026308, "last_edit_date": 1573128681, "question_id": 58725293, "link": "https://stackoverflow.com/questions/58725293/how-to-find-the-missing-value-from-two-array", "title": "How to find the missing value from two array", "body": "<p>RANGE.A2 = {1,2,3,4} and B2 = {1,2,4,5}\nFrom above two ranges i need to result like (Missing) C2 = {3} and (mismatch) D2 = {5},Any Formula or VBA code Availble means please share</p>\n"}, {"tags": ["excel", "vba", "avaya"], "comments": [{"owner": {"reputation": 522, "user_id": 10462701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/413b87f883585682a395af8bc755afbd?s=128&d=identicon&r=PG&f=1", "display_name": "SNicolaou", "link": "https://stackoverflow.com/users/10462701/snicolaou"}, "edited": false, "score": 0, "creation_date": 1573025645, "post_id": 58725080, "comment_id": 103741851, "body": "it looks like the module that was supposed to hold the sub &#39;doRep&#39; is not present in the workbook.  When you right click on doRep and then &#39;Definition&#39; does the editor take you to the doRep definition?"}, {"owner": {"reputation": 522, "user_id": 10462701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/413b87f883585682a395af8bc755afbd?s=128&d=identicon&r=PG&f=1", "display_name": "SNicolaou", "link": "https://stackoverflow.com/users/10462701/snicolaou"}, "edited": false, "score": 0, "creation_date": 1573025819, "post_id": 58725080, "comment_id": 103741927, "body": "Just my view/guess, while the issue might be related to the change from win7 to win10, don&#39;t think it has to do anything with the OS environment itself."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1573026807, "post_id": 58725080, "comment_id": 103742321, "body": "On a side note - looks like your error handler is within the main body of the code?  You should have an <code>Exit Sub</code> before the error handler, and <code>End Sub</code> after it."}, {"owner": {"reputation": 1, "user_id": 12330397, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157069336001137/picture?type=large", "display_name": "Rj Melecia", "link": "https://stackoverflow.com/users/12330397/rj-melecia"}, "edited": false, "score": 0, "creation_date": 1573031935, "post_id": 58725080, "comment_id": 103744680, "body": "The sub &#39;doREP&#39; is also within the same workbook. I&#39;ll try and work on the error handler."}, {"owner": {"reputation": 1, "user_id": 12330397, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157069336001137/picture?type=large", "display_name": "Rj Melecia", "link": "https://stackoverflow.com/users/12330397/rj-melecia"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1573035163, "post_id": 58725080, "comment_id": 103746533, "body": "@DarrenBartrup-Cook i removed the error handler and it gave me a run-time error &#39;-2147319783 (80028019)&#39;. It says Automation Error. Old format or invalid type library."}], "owner": {"reputation": 1, "user_id": 12330397, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157069336001137/picture?type=large", "display_name": "Rj Melecia", "link": "https://stackoverflow.com/users/12330397/rj-melecia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 621, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573128785, "creation_date": 1573025308, "last_edit_date": 1573128785, "question_id": 58725080, "link": "https://stackoverflow.com/questions/58725080/how-to-fix-compile-error-for-excel-vba-in-windows-10", "title": "How to Fix Compile Error for Excel VBA in Windows 10?", "body": "<p>We just recently switch from Windows 7 to Windows 10 and one of the macros in our file is not working. I've been getting Compile Error: Sub or Function not defined for a \"Call doRep\" line.</p>\n\n<p>I tried rebuilding the file in a Windows 10 PC but is still getting the same error. Below is the script I'm using.</p>\n\n<pre><code>Dim cvsApp As New ACSUP.cvsApplication\n'Dim cvsConn As New ACSCN.cvsConnection\nDim cvsSrv As New ACSUPSRV.cvsServer\nDim Rep As New ACSREP.cvsReport\nDim Info As Object, Log As Object, B As Object\nDim logged As Boolean\nDim sk As String\n\nPublic Sub CMSUPDATE()\nIf ThisWorkbook.Sheets(\"CMS\").Range(\"L1\").Value = \"\" Then\n        MsgBox (\"Please Type Skills to update Tool =/\")\nElse\n    On Error GoTo e:\n    Application.ScreenUpdating = True\n    Application.ScreenUpdating = False\n\nIf (ActiveSheet.Name = \"Handoff Log 4\" Or ActiveSheet.Name = \"Handoff Log 3\") Then\n    sk = ThisWorkbook.Sheets(ActiveSheet.Name).Range(\"F1\").Value\nElse\n    sk = ThisWorkbook.Sheets(\"CMS\").Range(\"M1\").Value\nEnd If\n\nThisWorkbook.Sheets(\"CMS\").Range(\"E2:Q21\").ClearContents\n    Set cvsSrv = cvsApp.Servers(1)\n    Call doRep(\"Real-Time\\Designer\\Rock: Split/Skill Report w/ Backup&amp;OCC{}\", sk)\n    ThisWorkbook.Sheets(\"CMS\").Range(\"E2\").PasteSpecial\n    ThisWorkbook.Sheets(\"CMS\").Range(\"A2:C21\").ClearContents\n    Set cvsSrv = cvsApp.Servers(1)\n    Call doRep(\"Real-Time\\Designer\\RTA-GUA-AVTIME\", sk)\n    ThisWorkbook.Sheets(\"CMS\").Range(\"A2\").PasteSpecial\n\n    logout\n    Application.ScreenUpdating = True\n\n      If UCase(Environ(\"UserName\")) = \"RMelecia\" Then\n    Range(\"$A$22\").FormulaR1C1 = \"RM\"\n\nElse\n\n    Range(\"$A$22\").FormulaR1C1 = Mid(UCase(Environ(\"UserName\")), 1, 2)\n\nEnd If\n\ne:\n    If Err.Number &lt;&gt; 91 Then\n        MsgBox \"Make sure you are logged in CMS. Relaunch CMS and this file if you are still getting this error.\"\n    End If\nEnd If\nEnd Sub\n</code></pre>\n\n<p>The report is supposed to run the \"Real-Time\\Designer\\Rock: Split/Skill Report w/ Backup&amp;OCC{}\" report in CMS and paste the extracted value in the excel file.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 522, "user_id": 10462701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/413b87f883585682a395af8bc755afbd?s=128&d=identicon&r=PG&f=1", "display_name": "SNicolaou", "link": "https://stackoverflow.com/users/10462701/snicolaou"}, "edited": false, "score": 1, "creation_date": 1573023496, "post_id": 58724608, "comment_id": 103740920, "body": "can we see your code? i.e. what you have done so far"}, {"owner": {"reputation": 3, "user_id": 12330282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef7ba04abee15d62958372c342baa6c2?s=128&d=identicon&r=PG&f=1", "display_name": "Frosty12", "link": "https://stackoverflow.com/users/12330282/frosty12"}, "reply_to_user": {"reputation": 522, "user_id": 10462701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/413b87f883585682a395af8bc755afbd?s=128&d=identicon&r=PG&f=1", "display_name": "SNicolaou", "link": "https://stackoverflow.com/users/10462701/snicolaou"}, "edited": false, "score": 0, "creation_date": 1573024666, "post_id": 58724608, "comment_id": 103741416, "body": "yea , there is my basic for loop.   Im trying to mess with active cells to try and iterate through the range on each button press.   I think im a little out of my league though, haha.   Very new to coding in general"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 12330282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef7ba04abee15d62958372c342baa6c2?s=128&d=identicon&r=PG&f=1", "display_name": "Frosty12", "link": "https://stackoverflow.com/users/12330282/frosty12"}, "edited": false, "score": 0, "creation_date": 1573025181, "post_id": 58724989, "comment_id": 103741651, "body": "Excellent!   Exactly how I was hoping it would work.   Thank you"}], "tags": [], "owner": {"reputation": 522, "user_id": 10462701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/413b87f883585682a395af8bc755afbd?s=128&d=identicon&r=PG&f=1", "display_name": "SNicolaou", "link": "https://stackoverflow.com/users/10462701/snicolaou"}, "is_accepted": false, "score": 0, "last_activity_date": 1573024998, "creation_date": 1573024998, "answer_id": 58724989, "question_id": 58724608, "link": "https://stackoverflow.com/questions/58724608/command-button-press-cycles-through-a-desired-range/58724989#58724989", "title": "Command button press cycles through a desired range", "body": "<p>this should do the trick:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub CommandButton1_Click()\n\n  Dim i As Integer, j As Integer\n  Dim emptyCellFound As Boolean\n  Dim c As Range\n\n  emptyCellFound = False 'not really needed. just for clarity\n\n  For i = 6 To 115\n    For j = 3 To 5\n      Set c = Cells(i, j)\n      If c.Value = \"\" And Not emptyCellFound Then\n        c.Value = Time\n        emptyCellFound = True\n      End If\n    Next j\n  Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": true, "score": 0, "last_activity_date": 1573025789, "last_edit_date": 1573025789, "creation_date": 1573024999, "answer_id": 58724990, "question_id": 58724608, "link": "https://stackoverflow.com/questions/58724608/command-button-press-cycles-through-a-desired-range/58724990#58724990", "title": "Command button press cycles through a desired range", "body": "<p>I understand it like that</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    Dim rg As Range\n    Set rg = Range(\"C6:E115\")\n\n    Dim sngCell As Range\n    For Each sngCell In rg\n        If Len(sngCell.Value) = 0 Then\n            sngCell.Value = Time\n            Exit For\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n\n<p><strong>Update</strong>:</p>\n\n<p>This solution should be faster but I think it will not be noticeable.</p>\n\n<pre><code>  Private Sub CommandButton1_Click()\n\n    Dim rg As Range\n    Set rg = Union(Range(\"C5\"), Range(\"C6:E115\"))\n\n    Dim nextCell As Range\n    Set nextCell = rg.Find(\"\")\n    If Not nextCell Is Nothing And nextCell.Address &lt;&gt; \"$C$5\" Then\n        nextCell.Value = Time\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 459, "user_id": 10547271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/59Gqb.png?s=128&g=1", "display_name": "AsUsual", "link": "https://stackoverflow.com/users/10547271/asusual"}, "is_accepted": false, "score": 0, "last_activity_date": 1573041737, "last_edit_date": 1573041737, "creation_date": 1573037557, "answer_id": 58728442, "question_id": 58724608, "link": "https://stackoverflow.com/questions/58724608/command-button-press-cycles-through-a-desired-range/58728442#58728442", "title": "Command button press cycles through a desired range", "body": "<p>This works if any value is applied in any cell below row 114</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    On Error Resume Next\n    [C6:E115].SpecialCells(xlCellTypeBlanks).Cells(1).Value = Time\n    On Error GoTo 0\nEnd Sub\n</code></pre>\n\n<p>..without a value below row 114 this works</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    On Error GoTo weird\n    [C6:E115].SpecialCells(xlCellTypeBlanks).Cells(1).Value = Time\n    Exit Sub\nweird:\n    If [C115].End(xlUp).Row &gt; 6 Then [C115].End(xlUp).Offset(1).Value = Time\n    On Error GoTo 0\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 12330282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef7ba04abee15d62958372c342baa6c2?s=128&d=identicon&r=PG&f=1", "display_name": "Frosty12", "link": "https://stackoverflow.com/users/12330282/frosty12"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 58724990, "answer_count": 3, "score": 0, "last_activity_date": 1573041737, "creation_date": 1573023341, "last_edit_date": 1573024575, "question_id": 58724608, "link": "https://stackoverflow.com/questions/58724608/command-button-press-cycles-through-a-desired-range", "title": "Command button press cycles through a desired range", "body": "<p>I'm trying to write code to where on each command button press, the current time is put into the first cell in a range. Then on the next button click, the next cell in the range is filled with the current time, and so on. I cant figure out how to cycle through the desired range and place a time value at that cell on each button press.</p>\n\n<p>I have a basic double For loop that goes through the entire range I want and populates all cells with the current time at once. I only want one cell to populate at a time with the current time on each button click, and I cant figure out how for the life of me.</p>\n\n<p>code so far:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim i As Integer, j As Integer\n\nFor i = 6 To 115\n    For j = 3 To 5\n        Cells(i, j).Value = Time\n    Next j\nNext i\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1573022432, "post_id": 58724389, "comment_id": 103740495, "body": "Well, both of you could use <code>Long</code> for an instance"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1573023643, "post_id": 58724389, "comment_id": 103740981, "body": "For a counter I&#39;d always use the name <code>i,j,k,l</code>  and type as @AntiDrondert said would be <code>long</code>. For the task in in your example I would not use a loop."}, {"owner": {"reputation": 522, "user_id": 10462701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/413b87f883585682a395af8bc755afbd?s=128&d=identicon&r=PG&f=1", "display_name": "SNicolaou", "link": "https://stackoverflow.com/users/10462701/snicolaou"}, "edited": false, "score": 0, "creation_date": 1573023745, "post_id": 58724389, "comment_id": 103741029, "body": "assuming that the colleague is still in the company and alive you could ask him/her what&#39;s the reason :-) TBH, that&#39;s the first time i saw such a way to loop a for statement. It&#39;s difficult to read."}, {"owner": {"reputation": 444, "user_id": 3114352, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/725578758/picture?type=large", "display_name": "jivko", "link": "https://stackoverflow.com/users/3114352/jivko"}, "edited": false, "score": 0, "creation_date": 1573023760, "post_id": 58724389, "comment_id": 103741035, "body": "From the code provided I have no clue why the colleague is using a one-element array as counter..."}, {"owner": {"reputation": 59, "user_id": 12324364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c00d88f832514befd835f29e8aed2e4b?s=128&d=identicon&r=PG&f=1", "display_name": "Chudamani Khadka", "link": "https://stackoverflow.com/users/12324364/chudamani-khadka"}, "reply_to_user": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1573023857, "post_id": 58724389, "comment_id": 103741080, "body": "@AntiDrondert okay, i went through some of the other question and realised that integer is converted to long in 32 bit system so its better to use long instead of integer, but that isn&#39;t really my question."}, {"owner": {"reputation": 59, "user_id": 12324364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c00d88f832514befd835f29e8aed2e4b?s=128&d=identicon&r=PG&f=1", "display_name": "Chudamani Khadka", "link": "https://stackoverflow.com/users/12324364/chudamani-khadka"}, "reply_to_user": {"reputation": 522, "user_id": 10462701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/413b87f883585682a395af8bc755afbd?s=128&d=identicon&r=PG&f=1", "display_name": "SNicolaou", "link": "https://stackoverflow.com/users/10462701/snicolaou"}, "edited": false, "score": 0, "creation_date": 1573023925, "post_id": 58724389, "comment_id": 103741107, "body": "@SNicolaou nope he is no where to be found"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1573023948, "post_id": 58724389, "comment_id": 103741109, "body": "Out of curiosity I ran a timed test on 1 million iterations of each and they both took the same amount of time. So it&#39;s really just a matter of preference. Your approach is less confusing for future programmers to read."}, {"owner": {"reputation": 522, "user_id": 10462701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/413b87f883585682a395af8bc755afbd?s=128&d=identicon&r=PG&f=1", "display_name": "SNicolaou", "link": "https://stackoverflow.com/users/10462701/snicolaou"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1573024614, "post_id": 58724389, "comment_id": 103741393, "body": "@braX if i had to guess, after compilation the arr(0) and let&#39;s say a counter called &#39;c&#39; would produce a similar lower level code."}, {"owner": {"reputation": 59, "user_id": 12324364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c00d88f832514befd835f29e8aed2e4b?s=128&d=identicon&r=PG&f=1", "display_name": "Chudamani Khadka", "link": "https://stackoverflow.com/users/12324364/chudamani-khadka"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1573024639, "post_id": 58724389, "comment_id": 103741407, "body": "@brax can you add your comment as answer? so i can accept it."}], "answers": [{"tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": true, "score": 1, "last_activity_date": 1573026600, "last_edit_date": 1573026600, "creation_date": 1573024772, "answer_id": 58724935, "question_id": 58724389, "link": "https://stackoverflow.com/questions/58724389/is-it-better-to-use-integer-or-integer-array-of-size-1/58724935#58724935", "title": "Is it better to use integer or integer array of size 1?", "body": "<p>Out of curiosity I ran a timed test on 1 million iterations of each and they both took the same amount of time. So it's really just a matter of preference. </p>\n\n<p>Your approach is less confusing for future programmers to read, which is an important consideration these days when programmers have to modify each other's code at a later date and the creator of the code is no longer around.</p>\n\n<p>I also tested it using <code>Long</code> instead of <code>Integer</code> and in this case, it also made no difference. I measured only down to the second tho. Perhaps if you measure down to the millisecond one would be faster... Here's the code I used:</p>\n\n<pre><code>Sub test()\n  Dim lTmr As Long\n  Dim lCol As Long\n  Dim dt As Date\n\n  dt = Now\n\n  For lTmr = 1 To 1000000\n    For lCol = 1 To 6\n       ActiveSheet.Cells(12, lCol).Value = lCol\n    Next\n  Next\n\n  Debug.Print DateDiff(\"s\", dt, Now)\n\nEnd Sub\n</code></pre>\n\n<p>Note: I changed the variable names to something a little more meaningful, which is also a good practice for future readability.</p>\n"}], "owner": {"reputation": 59, "user_id": 12324364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c00d88f832514befd835f29e8aed2e4b?s=128&d=identicon&r=PG&f=1", "display_name": "Chudamani Khadka", "link": "https://stackoverflow.com/users/12324364/chudamani-khadka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "closed_date": 1573045428, "accepted_answer_id": 58724935, "answer_count": 1, "score": 1, "last_activity_date": 1573026600, "creation_date": 1573022349, "question_id": 58724389, "link": "https://stackoverflow.com/questions/58724389/is-it-better-to-use-integer-or-integer-array-of-size-1", "closed_reason": "Opinion-based", "title": "Is it better to use integer or integer array of size 1?", "body": "<p>I am working on a code written by a colleague. He tried iterating through some values using a for loop, to do so he uses an integer array of size 1.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n   Call test\nEnd Sub\n\nSub test()\n'my approach\n    Dim x As Integer\n    For x = 1 To 6\n       ActiveSheet.Cells(12, x).Value = x\n    Next x\n\n'my colleagues approach\n    Dim iRCCnt(0) As Integer\n    For iRCCnt(0) = 1 To 6\n       ActiveSheet.Cells(12, iRCCnt(0)).Value = iRCCnt(0)\n   Next iRCCnt(0)\nEnd Sub\n</code></pre>\n\n<p>I assume they are one and the same. Is my approach better or its one and the same?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1573022247, "post_id": 58724283, "comment_id": 103740432, "body": "Have you tried disabling screen updating?"}, {"owner": {"reputation": 127, "user_id": 5097646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfb293db34079a4c3bd38580a6c10cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Arkadi w", "link": "https://stackoverflow.com/users/5097646/arkadi-w"}, "reply_to_user": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1573023798, "post_id": 58724283, "comment_id": 103741049, "body": "Yes, same goes for calculation and other options usually advised."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1573027910, "post_id": 58724283, "comment_id": 103742774, "body": "@Arkadiw can you show us your work? Your goal and a sample data so we can help you?"}, {"owner": {"reputation": 127, "user_id": 5097646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfb293db34079a4c3bd38580a6c10cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Arkadi w", "link": "https://stackoverflow.com/users/5097646/arkadi-w"}, "edited": false, "score": 0, "creation_date": 1573033267, "post_id": 58724283, "comment_id": 103745472, "body": "Its just an excel with data of clients. You can simply create random data, add notes to it and run a vba filter."}], "owner": {"reputation": 127, "user_id": 5097646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfb293db34079a4c3bd38580a6c10cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Arkadi w", "link": "https://stackoverflow.com/users/5097646/arkadi-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573021878, "creation_date": 1573021857, "last_edit_date": 1573021878, "question_id": 58724283, "link": "https://stackoverflow.com/questions/58724283/vba-slow-filtering-due-to-comments-notes", "title": "VBA: Slow filtering due to comments/notes", "body": "<p>I am working with an excel sheet (15k rows, 20 columns) and the VBA code is supposed to do filtering.\nAbout 7500 of the cells contain a comment/note.\nThe macro runs about 30 seconds on the code, but whenever I remove all the comments (home>edit>remove comments) and rerun, it is instant. Any simple filtering on this data takes very long because of the comments.</p>\n\n<p>Is there some command/option in VBA to disable/ignore the comments for the time a macro is being run and return them once complete? Or any other alternative?</p>\n"}, {"tags": ["excel", "vba", "userform"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1573019616, "post_id": 58723785, "comment_id": 103739570, "body": "<code>UserForm1.Show</code> is actually correct, so you can leave it like that. And you dont really need to Load it first."}, {"owner": {"reputation": 27, "user_id": 4930036, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dWqUxQP0iXg/AAAAAAAAAAI/AAAAAAAAAMU/eFb4d_bBDxg/photo.jpg?sz=128", "display_name": "Nicole Lee", "link": "https://stackoverflow.com/users/4930036/nicole-lee"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1573019761, "post_id": 58723785, "comment_id": 103739618, "body": "But would I then have to change my sub?  <code>Private Sub UserForm_Initialize()</code> to Private Sub UserForm1_Initialize()`?"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1573019815, "post_id": 58723785, "comment_id": 103739639, "body": "No, the sub uses the class name... that&#39;s how it&#39;s supposed to work. I usually name my forms something like <code>frmTransfer</code> to avoid the confusion."}, {"owner": {"reputation": 27, "user_id": 4930036, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dWqUxQP0iXg/AAAAAAAAAAI/AAAAAAAAAMU/eFb4d_bBDxg/photo.jpg?sz=128", "display_name": "Nicole Lee", "link": "https://stackoverflow.com/users/4930036/nicole-lee"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1573019909, "post_id": 58723785, "comment_id": 103739676, "body": "But without changing the subs, I get a <code>Application-defined or object-defined error</code> when clicking the button"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1573020099, "post_id": 58723785, "comment_id": 103739730, "body": "You arent &quot;showing&quot; the class <code>UserForm</code>, you are showing an instance of the class called <code>UserForm1</code>"}, {"owner": {"reputation": 27, "user_id": 4930036, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dWqUxQP0iXg/AAAAAAAAAAI/AAAAAAAAAMU/eFb4d_bBDxg/photo.jpg?sz=128", "display_name": "Nicole Lee", "link": "https://stackoverflow.com/users/4930036/nicole-lee"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1573020338, "post_id": 58723785, "comment_id": 103739785, "body": "Where would I put the code to show the <code>UserForm</code>? Would that be under the command code or in my <code>UserForm</code> code?"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1573020456, "post_id": 58723785, "comment_id": 103739818, "body": "it looks like you already know where to put it - <code>blocksSorter_Click</code> - using the instance name <code>UserForm1</code> and not the class name <code>UserForm</code>"}, {"owner": {"reputation": 27, "user_id": 4930036, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dWqUxQP0iXg/AAAAAAAAAAI/AAAAAAAAAMU/eFb4d_bBDxg/photo.jpg?sz=128", "display_name": "Nicole Lee", "link": "https://stackoverflow.com/users/4930036/nicole-lee"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1573020571, "post_id": 58723785, "comment_id": 103739849, "body": "Right so I&#39;ve changed the code under blocksSorter_Click() to include <code>Load UserForm1</code> and <code>UserForm1.Show</code> but I am getting the 1004 error. Does it have anything to do with setting the subs public/private?"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1573020647, "post_id": 58723785, "comment_id": 103739871, "body": "Then your form name must not be <code>UserForm1</code> = Did you accidentally name it <code>UserForm</code> thinking that&#39;s what you were supposed to do?"}, {"owner": {"reputation": 27, "user_id": 4930036, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dWqUxQP0iXg/AAAAAAAAAAI/AAAAAAAAAMU/eFb4d_bBDxg/photo.jpg?sz=128", "display_name": "Nicole Lee", "link": "https://stackoverflow.com/users/4930036/nicole-lee"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1573020837, "post_id": 58723785, "comment_id": 103739924, "body": "Under properties for my form, I have the name as <code>UserForm1</code>, my VBE window also shows <code>UserForm1(UserForm)</code>"}, {"owner": {"reputation": 27, "user_id": 4930036, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dWqUxQP0iXg/AAAAAAAAAAI/AAAAAAAAAMU/eFb4d_bBDxg/photo.jpg?sz=128", "display_name": "Nicole Lee", "link": "https://stackoverflow.com/users/4930036/nicole-lee"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1573020954, "post_id": 58723785, "comment_id": 103739965, "body": "@braX figured it out, I need to change the caption in the properties as well. Cheers and ty very much for all your help"}], "answers": [{"tags": [], "owner": {"reputation": 27, "user_id": 4930036, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dWqUxQP0iXg/AAAAAAAAAAI/AAAAAAAAAMU/eFb4d_bBDxg/photo.jpg?sz=128", "display_name": "Nicole Lee", "link": "https://stackoverflow.com/users/4930036/nicole-lee"}, "is_accepted": false, "score": 0, "last_activity_date": 1573021117, "creation_date": 1573021117, "answer_id": 58724134, "question_id": 58723785, "link": "https://stackoverflow.com/questions/58723785/vba-command-button-to-open-userform-returns-1004-error/58724134#58724134", "title": "VBA Command button to open Userform returns 1004 error", "body": "<p>Even though my form name is UserForm1, I had the caption as something else. With the help of braX, I have the following:</p>\n\n<pre><code>Private Sub blocksSorter_Click()\n     Load UserForm1\n     UserForm1.Show\nEnd Sub\n</code></pre>\n\n<p>My form properties are now as follows:</p>\n\n<pre><code>Name: UserForm1\nCaption: UserForm1\n</code></pre>\n\n<p>My UserForm code remains the same.</p>\n"}, {"tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 0, "last_activity_date": 1573021145, "creation_date": 1573021145, "answer_id": 58724140, "question_id": 58723785, "link": "https://stackoverflow.com/questions/58723785/vba-command-button-to-open-userform-returns-1004-error/58724140#58724140", "title": "VBA Command button to open Userform returns 1004 error", "body": "<p>Start a new VBA project.</p>\n\n<p>Add a form.</p>\n\n<p>Name the form <code>frmOne</code></p>\n\n<p>Double click on the form and add <code>MsgBox \"Hello\"</code> to that event.</p>\n\n<p>Add another form.</p>\n\n<p>Name that form <code>frmTwo</code></p>\n\n<p>Double click on the 2nd form and add <code>frmOne.Show</code> to that event.</p>\n\n<p>Run the second form, and click on it, it should open frmOne. Then click on the frmOne and the msgbox should come up.</p>\n\n<p>Notice that each form has a subroutine called <code>UserForm_Click()</code> but they are different. Does that help clear it up? I'm not sure how else to explain it to you.</p>\n"}], "owner": {"reputation": 27, "user_id": 4930036, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dWqUxQP0iXg/AAAAAAAAAAI/AAAAAAAAAMU/eFb4d_bBDxg/photo.jpg?sz=128", "display_name": "Nicole Lee", "link": "https://stackoverflow.com/users/4930036/nicole-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 106, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1573021145, "creation_date": 1573019225, "question_id": 58723785, "link": "https://stackoverflow.com/questions/58723785/vba-command-button-to-open-userform-returns-1004-error", "title": "VBA Command button to open Userform returns 1004 error", "body": "<p>In a excel project, I have a sheet with data, a userform that draws data from that sheet, and a sheet to paste userform data.</p>\n\n<p>I created a button in the data sheet that <strong>should</strong> open the user form. For reference the name of my userform is UserForm1. I get a 424 error <code>Object required</code>when I click on the command button. I would appreciate any help or clarification, seems I am getting my classes/instances mixed up?</p>\n\n<p>Code below:</p>\n\n<pre><code>Private Sub blocksSorter_Click()\n     Load UserForm\n     UserForm.Show\nEnd Sub\n</code></pre>\n\n<p>The form itself is within the same VBA project and is the only form in the project. My UserForm1 code is looks generally like this:</p>\n\n<pre><code>Private Sub UserForm_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)\n    code\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\n    code\nEnd Sub\n\n</code></pre>\n\n<p>The form will only show if I do this, and change my UserCode subs to <code>UserForm1</code> from <code>UserForm</code>.</p>\n\n<pre><code>Private Sub blocksSorter_Click()\n     Load UserForm1\n     UserForm1.Show\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "copy", "rename", "worksheet"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1573014817, "post_id": 58723089, "comment_id": 103738378, "body": "You will probably need some sort of a custom form to specify these file locations and that is too much to give you in a StackOverflow answer."}, {"owner": {"reputation": 1716, "user_id": 5079799, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7ea769f6abda58c1c51a1c64845b73c7?s=128&d=identicon&r=PG&f=1", "display_name": "FreeSoftwareServers", "link": "https://stackoverflow.com/users/5079799/freesoftwareservers"}, "edited": false, "score": 0, "creation_date": 1573018647, "post_id": 58723089, "comment_id": 103739263, "body": "That is not enough information to create rules. Can you post some failed attempts?"}, {"owner": {"reputation": 1, "user_id": 11493153, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBp2o-pHKWjjTs-zcTMrWzzhqaldAhX0lfgx_4iew=k-s128", "display_name": "Zeravika", "link": "https://stackoverflow.com/users/11493153/zeravika"}, "edited": false, "score": 0, "creation_date": 1573090319, "post_id": 58723089, "comment_id": 103771277, "body": "I actually figured it out. It was far more simple than I was making it. I&#39;ll post it later as an answer for anyone looking to do the same."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 11493153, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBp2o-pHKWjjTs-zcTMrWzzhqaldAhX0lfgx_4iew=k-s128", "display_name": "Zeravika", "link": "https://stackoverflow.com/users/11493153/zeravika"}, "is_accepted": false, "score": 0, "last_activity_date": 1573153107, "creation_date": 1573153107, "answer_id": 58755325, "question_id": 58723089, "link": "https://stackoverflow.com/questions/58723089/vba-copy-worksheet-with-variable-name-from-another-workbook-to-the-current-wor/58755325#58755325", "title": "VBA Copy worksheet (with variable name) from another workbook to the current workbook and rename it in the current workbook", "body": "<p>Sub move_external_sheet ()\n'\n        On Error Resume Next\n'\n    Result = InputBox(\"What is the name of the tab you want to move?\", \"Sheet Mover\")</p>\n\n<pre><code>Windows(Result &amp; \".xls\").Activate\n\nSheets(Result).Select\n\nSheets(Result).Move After:=Workbooks(\"Data Converter.xlsm\").Sheets(1)\n\nWorksheets(Result).Name = \"Source\"\n\nSheets(\"Sheet1\").Select\n\n     Err.Clear\n\n    On Error GoTo 0   \n</code></pre>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 1, "user_id": 11493153, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBp2o-pHKWjjTs-zcTMrWzzhqaldAhX0lfgx_4iew=k-s128", "display_name": "Zeravika", "link": "https://stackoverflow.com/users/11493153/zeravika"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1573153107, "creation_date": 1573014330, "last_edit_date": 1573036351, "question_id": 58723089, "link": "https://stackoverflow.com/questions/58723089/vba-copy-worksheet-with-variable-name-from-another-workbook-to-the-current-wor", "title": "VBA Copy worksheet (with variable name) from another workbook to the current workbook and rename it in the current workbook", "body": "<p>I've been trying to figure this out and have several failed attempts. I am attempting to copy (preferably just move) the only worksheet from another workbook into the current workbook amd rename it to \"Source\" once in the current notebook. The catch is the files are not in the same folder, but both will be open. Also the name of the worksheet to be copied/moved varies on every instance.</p>\n\n<p>I super appreciate any assistance you can provide. </p>\n"}, {"tags": ["excel", "vba", "userform", "keydown"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1573010195, "post_id": 58722488, "comment_id": 103737453, "body": "Is the name of your form <code>UserForm1</code>? If not, that would explain it. Then it would just be a subroutine which may as well be called &quot;Nichole&quot; that is never triggered by anything. When you click inside the routine and look at the dropdowns at the top of the VBA editor, do you see <code>UserForm1</code> in the left one and <code>KeyDown</code> in the right one? or does the left one say <code>(General)</code>?"}, {"owner": {"reputation": 27, "user_id": 4930036, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dWqUxQP0iXg/AAAAAAAAAAI/AAAAAAAAAMU/eFb4d_bBDxg/photo.jpg?sz=128", "display_name": "Nicole Lee", "link": "https://stackoverflow.com/users/4930036/nicole-lee"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1573010589, "post_id": 58722488, "comment_id": 103737522, "body": "Hi, yes my form is called UserForm1. In the VBA editor, the left one says (General) and right shows UserForm1_KeyDown"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1573010735, "post_id": 58722488, "comment_id": 103737547, "body": "Both of those things cannot be true. If it says <code>(General)</code> then it&#39;s not tied to any event. Double click on the form itself, that will open the form&#39;s <code>Click</code> event, then using the right dropdown, change it to <code>KeyDown</code> - That is where the code should be. Maybe you mistakenly put the code in a Module?"}, {"owner": {"reputation": 27, "user_id": 4930036, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dWqUxQP0iXg/AAAAAAAAAAI/AAAAAAAAAMU/eFb4d_bBDxg/photo.jpg?sz=128", "display_name": "Nicole Lee", "link": "https://stackoverflow.com/users/4930036/nicole-lee"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1573010990, "post_id": 58722488, "comment_id": 103737600, "body": "Ok, tried doing that and putting the code  there where the editor shows UserForm and KeyDown. But that doesnt seem to do the trick."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1573011110, "post_id": 58722488, "comment_id": 103737625, "body": "Well it works just fine for me... you didnt try and put the Sub definition inside the sub definition, did you? try just putting the word <code>Stop</code> in the event to see if the editor stops there. There is something you are not understanding about all of this."}, {"owner": {"reputation": 27, "user_id": 4930036, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dWqUxQP0iXg/AAAAAAAAAAI/AAAAAAAAAMU/eFb4d_bBDxg/photo.jpg?sz=128", "display_name": "Nicole Lee", "link": "https://stackoverflow.com/users/4930036/nicole-lee"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1573011279, "post_id": 58722488, "comment_id": 103737664, "body": "I think it might be referencing the wrong name. So, even though I have named my form UserForm1, it still shows as UserForm on the drop down, so when clicking into my routine in the editor it shows as (General) rather than UserForm or UserForm1. Do you know a workaround for this?"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1573011326, "post_id": 58722488, "comment_id": 103737670, "body": "Ttry just putting the word <code>Stop</code> in the event to see if the editor stops there. Dont use the code you are trying to get working yet."}, {"owner": {"reputation": 27, "user_id": 4930036, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dWqUxQP0iXg/AAAAAAAAAAI/AAAAAAAAAMU/eFb4d_bBDxg/photo.jpg?sz=128", "display_name": "Nicole Lee", "link": "https://stackoverflow.com/users/4930036/nicole-lee"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1573011636, "post_id": 58722488, "comment_id": 103737722, "body": "Does not stop  there"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1573011741, "post_id": 58722488, "comment_id": 103737743, "body": "Assuming you put <code>Stop</code> in the right place and then pressed a key when the form had focus, there is still something you are doing wrong. The problem isn&#39;t your code, it&#39;s your understanding of how events work."}, {"owner": {"reputation": 27, "user_id": 4930036, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dWqUxQP0iXg/AAAAAAAAAAI/AAAAAAAAAMU/eFb4d_bBDxg/photo.jpg?sz=128", "display_name": "Nicole Lee", "link": "https://stackoverflow.com/users/4930036/nicole-lee"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1573012535, "post_id": 58722488, "comment_id": 103737895, "body": "im going to test this out on an entirely new form, thanks for your suggestions so far"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1573013017, "post_id": 58722488, "comment_id": 103737999, "body": "That was my next recommendation."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1573013856, "post_id": 58722488, "comment_id": 103738185, "body": "The name of your event <i>should</i> be <code>Sub UserForm_KeyDown( ...</code> (Note, no <code>1</code>).  The Form Events are named after the Class, not the Instance."}, {"owner": {"reputation": 27, "user_id": 4930036, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dWqUxQP0iXg/AAAAAAAAAAI/AAAAAAAAAMU/eFb4d_bBDxg/photo.jpg?sz=128", "display_name": "Nicole Lee", "link": "https://stackoverflow.com/users/4930036/nicole-lee"}, "edited": false, "score": 0, "creation_date": 1573016572, "post_id": 58722488, "comment_id": 103738777, "body": "Thanks gents, I&#39;ve added an update to my question above... Made sure all my events are named after the Class, but Ive run into an issue with loading and show the userform."}], "answers": [{"tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": true, "score": 0, "last_activity_date": 1573028826, "creation_date": 1573028826, "answer_id": 58725858, "question_id": 58722488, "link": "https://stackoverflow.com/questions/58722488/how-to-assign-keydown-events-to-a-userform/58725858#58725858", "title": "How to assign keydown events to a userform?", "body": "<p>It does not matter how you name your Userform, the event always has the name <code>Userform_event</code> as said in one of the comments. And you have to put the code into the class module of the userform. In this case </p>\n\n<pre><code>Sub UserForm_KeyDown(ByVal KeyAscii As MSForms.ReturnInteger, ByVal Shift As Integer)\n    Select Case KeyAscii\n        Case 13 'enter key\n            addBtn_Click\n        Case 39 'right arrow\n            skipBtn_Click\n        Case 27 'escape key\n            exitBtn_Click\n        Case Else\n    End Select\nEnd Sub\n</code></pre>\n\n<p>This <a href=\"https://excelmacromastery.com/vba-user-forms-1/\" rel=\"nofollow noreferrer\">article</a> gives a quite good overview and introduction to userforms</p>\n"}], "owner": {"reputation": 27, "user_id": 4930036, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dWqUxQP0iXg/AAAAAAAAAAI/AAAAAAAAAMU/eFb4d_bBDxg/photo.jpg?sz=128", "display_name": "Nicole Lee", "link": "https://stackoverflow.com/users/4930036/nicole-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1241, "favorite_count": 0, "accepted_answer_id": 58725858, "answer_count": 1, "score": 1, "last_activity_date": 1576382058, "creation_date": 1573009347, "last_edit_date": 1576382058, "question_id": 58722488, "link": "https://stackoverflow.com/questions/58722488/how-to-assign-keydown-events-to-a-userform", "title": "How to assign keydown events to a userform?", "body": "<p>I want specific keys (Enter, Right Arrow, Esc) to execute different procedures.</p>\n\n<p>I have the following code but nothing is working. I tried setting KeyPreview = True, but that did not seem to change anything. </p>\n\n<pre><code>Sub UserForm1_KeyDown(ByVal KeyAscii As MSForms.ReturnInteger, ByVal Shift As Integer)\n    Select Case KeyAscii\n        Case 13 'enter key\n            addBtn_Click\n        Case 39 'right arrow\n            skipBtn_Click\n        Case 27 'escape key\n            exitBtn_Click\n        Case Else\n    End Select\nEnd Sub\n</code></pre>\n\n<p>UPDATE<br>\nChris mentioned (below) that it should be named after the class, readjusting names helped fix some other small bugs in my form. However I've run into an issue with having the userform open on a command button click, running or clicking this gives me a 1004 error.</p>\n\n<pre><code>Private Sub blocksSorter_Click()\n     Load UserForm1\n     UserForm1.Show\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1573128842, "post_id": 58722423, "comment_id": 103785518, "body": "Welcome to Stack Overflow. Please note that because this is no free code writing service it is necessary that you show either what you have tried so far and where you got stuck or errors (by showing your code) or at least to show what you have researched and the effort you made. Otherwise it is just asking us to do all the work for you. Reading <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> might help you to improve your question."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 12314250, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hHmPldYv9DM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc-v8Gw9m9a77gEaWiw74EfiaILxw/photo.jpg?sz=128", "display_name": "nsfW nsfW", "link": "https://stackoverflow.com/users/12314250/nsfw-nsfw"}, "edited": false, "score": 0, "creation_date": 1573447284, "post_id": 58726380, "comment_id": 103872411, "body": "Array(&quot;1xxxx&quot;, &quot;11xxxx&quot;, &quot;21xxxx&quot;) like this also can"}], "tags": [], "owner": {"reputation": 39, "user_id": 7382914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d4d13fb5742de2f37e858c03e2b26cd?s=128&d=identicon&r=PG&f=1", "display_name": "M Z", "link": "https://stackoverflow.com/users/7382914/m-z"}, "is_accepted": false, "score": 1, "last_activity_date": 1573030815, "creation_date": 1573030815, "answer_id": 58726380, "question_id": 58722423, "link": "https://stackoverflow.com/questions/58722423/how-to-extract-string-1xxxx-11xxxx-21xxxx-into-arrayobjecta1xxxx-object/58726380#58726380", "title": "How to extract string =&quot;1xxxx , 11xxxx, 21xxxx&quot; into array[{objecta:1xxxx,objectb:11xxxx,objectc:21xxxx}]", "body": "<p>Would you just like an Array? Then you can use </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Array(\"1xxxx\", \"11xxxx\", \"21xxxx\")\n</code></pre>\n\n<p>Or </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Split(\"1xxxx,11xxxx,21xxxx\", \",\")\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 12314250, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hHmPldYv9DM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc-v8Gw9m9a77gEaWiw74EfiaILxw/photo.jpg?sz=128", "display_name": "nsfW nsfW", "link": "https://stackoverflow.com/users/12314250/nsfw-nsfw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1573128799, "creation_date": 1573008768, "last_edit_date": 1573128799, "question_id": 58722423, "link": "https://stackoverflow.com/questions/58722423/how-to-extract-string-1xxxx-11xxxx-21xxxx-into-arrayobjecta1xxxx-object", "title": "How to extract string =&quot;1xxxx , 11xxxx, 21xxxx&quot; into array[{objecta:1xxxx,objectb:11xxxx,objectc:21xxxx}]", "body": "<p>How to extract <code>string =\"1xxxx , 11xxxx, 21xxxx\"</code>  into <code>array[{objecta:1xxxx,objectb:11xxxx,objectc:21xxxx}]</code></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 748, "user_id": 7130016, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/fa54f3f9332091638b37c3fb84db39d3?s=128&d=identicon&r=PG&f=1", "display_name": "Mertinc", "link": "https://stackoverflow.com/users/7130016/mertinc"}, "edited": false, "score": 0, "creation_date": 1573020306, "post_id": 58723387, "comment_id": 103739776, "body": "I am trying to implement it and will let you know as soon as I could give it a go. Thanks"}], "tags": [], "owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "is_accepted": false, "score": 0, "last_activity_date": 1573016482, "creation_date": 1573016482, "answer_id": 58723387, "question_id": 58722352, "link": "https://stackoverflow.com/questions/58722352/if-multiple-find-conditions-match-then-in-vba/58723387#58723387", "title": "If Multiple Find Conditions match then ... in VBA", "body": "<p>You probably could use something like below.</p>\n\n<pre><code>Public Sub demo()\nDim wksInp As Worksheet: Set wksInp = ThisWorkbook.Worksheets(\"Input\")\nDim wksOut As Worksheet: Set wksOut = ThisWorkbook.Worksheets(\"Output\")\nDim lngLastRow As Long, i As Long\nDim rgRef As Range\n\n'\\\\ Find Last Row on output sheet\nlngLastRow = wksOut.Range(\"B\" &amp; wksOut.Rows.Count).End(xlUp).Row\nFor i = 2 To lngLastRow\n    If Len(wksOut.Range(\"B\" &amp; i).Value) &gt; 0 Then '\\\\ Check Non-Blank Cell in Column B\n        '\\\\ See if the range exists in Input sheet\n        Set rgRef = wksInp.Range(\"B:B\").Find(wksOut.Range(\"B\" &amp; i).Value, , , xlWhole)\n        If Not rgRef Is Nothing Then\n            '\\\\ Now that we have found a suitable range in column B lets loop through all sub-headings in col c.\n            j = 0\n            Do While wksInp.Cells(rgRef.Row + 1 + j, rgRef.Column).Value = \"\"\n                If rgRef.Offset(1 + j, 1).Value = wksOut.Range(\"C\" &amp; i).Value Then\n                    wksOut.Range(\"D\" &amp; i).Value = rgRef.Offset(1 + j, 2).Value\n                    Exit Do '\\\\Match found so we exit Do loop\n                End If\n                j = j + 1\n            Loop\n        End If\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 748, "user_id": 7130016, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/fa54f3f9332091638b37c3fb84db39d3?s=128&d=identicon&r=PG&f=1", "display_name": "Mertinc", "link": "https://stackoverflow.com/users/7130016/mertinc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1573016482, "creation_date": 1573008199, "last_edit_date": 1573008214, "question_id": 58722352, "link": "https://stackoverflow.com/questions/58722352/if-multiple-find-conditions-match-then-in-vba", "title": "If Multiple Find Conditions match then ... in VBA", "body": "<p>I have Input and Output tabs. </p>\n\n<p>In Input Tab I have my headers on Column B and sub-headers on Column C as shown below:</p>\n\n<pre><code> A   B       C       D      \n    HDR1\n           SB1.1     Data1\n           SB2.1     Data2\n    HDR2\n           SB2.1     Data3\n           SB2.2     Data4\n           SB2.3     Data5\n</code></pre>\n\n<p>And in Output Tab I have my full list as shown below:</p>\n\n<pre><code> A   B       C       D      \n    HDR1   SB1.1\n    HDR1   SB2.1     \n\n    HDR2   SB2.1     \n    HDR2   SB2.2     \n    HDR2   SB2.3\n</code></pre>\n\n<p>I need to search for Header and all of it's Sub-Headers respectively.</p>\n\n<p>For example: Search for Input HDR1 in Output Column B but also search for Input SB1.1 in same row number's column C. If find, than copy Input Data to Output Data column. If not, search for second Subheader (which is SB2.1) in column C in this example.</p>\n\n<p>The thing here is I don't know how many sub-headers any header has. It might be 1 or 5. That is still ok I created my loops for this. My question is: how can I add multiple find conditions within this loop. </p>\n\n<pre><code>Sub Macro1()\n\n'Call screenupdatingfalse\nDim wsO As Worksheet, wsI As Worksheet\nSet wsI = Sheet2 'wsI is Input Sheet\nSet wsO = Sheet1 'wsO is Output sheet\nDim RowLastB As Long, rowlastC As Long, FirstBcellRow As Long, FirstBcellText As String, OutputNewRowQty As Long, i As Long, x As Long, beginBcol As Long\n</code></pre>\n\n<blockquote>\n  <p>'Below I am finding last rows of the Input sheet to define the end of my loops.</p>\n</blockquote>\n\n<pre><code>    RowLastB = wsI.Cells(Rows.Count, \"B\").End(xlUp).Row\n    rowlastC = wsI.Cells(Rows.Count, \"C\").End(xlUp).Row\n</code></pre>\n\n<blockquote>\n  <p>'Below I am starting my loops with the First Header in Column B. Then Finding next Header, then looking for how many sub-headers each header has.</p>\n</blockquote>\n\n<pre><code>beginBcol = 1\nFor i = beginBcol To RowLastB\nwsI.Activate\nFirstBcellRow = wsI.Range(\"B\" &amp; i).End(xlDown).Row\nFirstBcellText = wsI.Range(\"B\" &amp; i).End(xlDown).Text\n\n'FirstCcellRow = wsI.Range(\"C\" &amp; i).End(xlDown).Row\n\n\nStartCopyRow = FirstBcellRow\n\ni = FirstBcellRow\nIf i = RowLastB Then\nOutputNewRowQty = (rowlastC - RowLastB)\nExit For\nElse\nSecondBcellRow = wsI.Range(\"B\" &amp; i).End(xlDown).Row\nOutputNewRowQty = (SecondBcellRow - FirstBcellRow) - 1\n'that amount of row to be added to Output\n\nwsO.Activate\nwsO.AutoFilter.ShowAllData\nOn Error GoTo below\n</code></pre>\n\n<blockquote>\n  <p>My Question is this part: How can I create the right Find loop. This part eats my brain and I couldn't find the right answer anywhere on the internet even in SO!! </p>\n</blockquote>\n\n<pre><code>Set Brange = wsO.Range(\"F\").Find(FirstBcellText, , xlValues, xlWhole)\nSet cRange = wsO.Range(\"G\").Find(wsI.Range(\", , xlValues, xlWhole)\n\nOutputRowNo = ActiveCell.Row\n\nx = 1\nDo Until x = OutputNewRowQty + 1\nActiveCell.Offset(1).EntireRow.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromRightOrAbove\nActiveCell.EntireRow.Copy\nActiveCell.Offset(1).EntireRow.PasteSpecial xlPasteFormats\nx = x + 1\nApplication.CutCopyMode = False\nLoop\n\ncopyloop = 1\nDo Until copyloop = OutputNewRowQty + 1\n\nInputCopyCell = (StartCopyRow + 1)\nwsI.Range(\"A\" &amp; InputCopyCell).Copy\nwsO.Range(\"I\" &amp; (OutputRowNo + 1)).PasteSpecial Paste:=xlPasteValues\n\nwsI.Range(\"C\" &amp; InputCopyCell).Copy\nwsO.Range(\"J\" &amp; (OutputRowNo + 1)).PasteSpecial Paste:=xlPasteValues\n\nwsI.Range(\"L\" &amp; InputCopyCell).Copy\nwsO.Range(\"K\" &amp; (OutputRowNo + 1)).PasteSpecial Paste:=xlPasteValues\nwsO.Range(\"K\" &amp; (OutputRowNo + 1)).NumberFormat = \"$#,##0.00\"\n\ncopyloop = copyloop + 1\nStartCopyRow = StartCopyRow + 1\nOutputRowNo = OutputRowNo + 1\nApplication.CutCopyMode = False\nLoop\n\nbeginBcol = FirstBcellRow\nEnd If\nbelow:\nNext\n'Call screenupdatingon\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 0, "last_activity_date": 1573125279, "creation_date": 1573125279, "answer_id": 58747592, "question_id": 58722257, "link": "https://stackoverflow.com/questions/58722257/how-to-reference-a-workbook-without-opening-it/58747592#58747592", "title": "How to reference a workbook without opening it", "body": "<ol>\n<li><p><code>Dim colllStyle, As String</code> is no valid syntax remove the comma. </p></li>\n<li><p>Here <code>Cells(1, llStyle).Address</code> it is not specified in which workbook and worksheet the <code>Cells</code> object is meant to be. It should start with a dot <code>.Cells(\u2026)</code> if you want it to use the <code>With</code> statement or you must specify a workbook/worksheet.</p></li>\n<li><p>If <code>Application.Match(\"fire\", .Rows(1), 0)</code> does not match it returns an error. So you must check if it matched or errored using the <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/iserror-function\" rel=\"nofollow noreferrer\">IsError function</a>:</p>\n\n<pre><code>If Not IsError(llStyle) Then\n    'split\nElse\n    'error message\nEnd If\n</code></pre></li>\n<li><p>And finally your main issue is that you cannot use a full path <code>\"C:\\Users\\abc\\Excel\\trial\\ppp.xlsx\"</code> in <code>Workbooks(wbLlinelist)</code>. You must open a workbook using the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.workbooks.open\" rel=\"nofollow noreferrer\">Workbooks.Open method</a> before you can access it.</p>\n\n<pre><code>Dim MyOpenWb As Workbook\nSet MyOpenWb = Application.Workbooks.Open(FileName:=wbLlinelist) 'you might want to open it read only and set the parameter ReadOnly:=True\n\nWith MyOpenWb.Worksheets(wsLinelist)\n    'your code\nEnd With\n</code></pre></li>\n<li><p>Don't forget to close the workbook in the end:</p>\n\n<pre><code>MyOpenWb.Close SaveChanges:=False\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 17, "user_id": 10287830, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XpTGuQBsEUw/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaP-gXK33a9e_FB1aycIynwK0dng7Q/mo/photo.jpg?sz=128", "display_name": "wingkit hui", "link": "https://stackoverflow.com/users/10287830/wingkit-hui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1901, "favorite_count": 0, "accepted_answer_id": 58747592, "answer_count": 1, "score": 0, "last_activity_date": 1573125279, "creation_date": 1573007448, "last_edit_date": 1573124705, "question_id": 58722257, "link": "https://stackoverflow.com/questions/58722257/how-to-reference-a-workbook-without-opening-it", "title": "How to reference a workbook without opening it", "body": "<p>I want to open a new workbook, and run some macro inside, at the end will paste the result to the new workbook.</p>\n\n<p>I tried different method to reference other workbooks path because I need the data inside, however, I cant do it correctly. Below is my coding:</p>\n\n<pre><code>Sub stepTen()\n    Dim wbLinelist As String, wsLinelist As String\n\n    wbLlinelist = \"C:\\Users\\abc\\Excel\\trial\\ppp.xlsx\"\n    wsLinelist = \"Sheet1\"\n\n    Dim llStyle As Long\n    Dim colllStyle, As String\n\n    With Workbooks(wbLlinelist).Worksheets(wsLinelist)\n        llStyle = Application.Match(\"fire\", .Rows(1), 0)\n        colllStyle = Split(Cells(1, llStyle).Address, \"$\")(1)\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 33, "user_id": 12295047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2810cef236e9fb5c00ea69df89701d9?s=128&d=identicon&r=PG&f=1", "display_name": "Cobber", "link": "https://stackoverflow.com/users/12295047/cobber"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1573006863, "post_id": 58721980, "comment_id": 103736821, "body": "@brax. This code was given to me to search 3 columns but I would like to modify it to search an extra column. I know very little about coding...obviously :)"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 12295047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2810cef236e9fb5c00ea69df89701d9?s=128&d=identicon&r=PG&f=1", "display_name": "Cobber", "link": "https://stackoverflow.com/users/12295047/cobber"}, "edited": false, "score": 0, "creation_date": 1573018747, "post_id": 58722882, "comment_id": 103739299, "body": "I got Expected End Sub error, so I put Function at the top and after the first End With, but now it gets Run time error 9, subscript out of Range at With ThisWorkbook.Sheets(2). I have the data on sheet 2 and sheet 1 blank. Any suggestions, cheers"}, {"owner": {"reputation": 33, "user_id": 12295047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2810cef236e9fb5c00ea69df89701d9?s=128&d=identicon&r=PG&f=1", "display_name": "Cobber", "link": "https://stackoverflow.com/users/12295047/cobber"}, "edited": false, "score": 0, "creation_date": 1573021168, "post_id": 58722882, "comment_id": 103740039, "body": "Fixed that, I was using it in my Personal, I created a workbook and it worked. What do I need to change to make it work in Personal."}, {"owner": {"reputation": 33, "user_id": 12295047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2810cef236e9fb5c00ea69df89701d9?s=128&d=identicon&r=PG&f=1", "display_name": "Cobber", "link": "https://stackoverflow.com/users/12295047/cobber"}, "edited": false, "score": 0, "creation_date": 1573021974, "post_id": 58722882, "comment_id": 103740329, "body": "I changed it to With Sheets(1), With Sheets(2) and it appears to work....is that correct?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 33, "user_id": 12295047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2810cef236e9fb5c00ea69df89701d9?s=128&d=identicon&r=PG&f=1", "display_name": "Cobber", "link": "https://stackoverflow.com/users/12295047/cobber"}, "edited": false, "score": 0, "creation_date": 1573024878, "post_id": 58722882, "comment_id": 103741514, "body": "If those are the correct sheets then it should be fine - it will default to the activeworkbook if you don&#39;t specify one"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1573012706, "creation_date": 1573012706, "answer_id": 58722882, "question_id": 58721980, "link": "https://stackoverflow.com/questions/58721980/vba-extra-column-search/58722882#58722882", "title": "VBA extra column search", "body": "<p>Untested - you should get the general pattern...</p>\n\n<pre><code>With ThisWorkbook.Sheets(1)\n    .Range(\"D5\").Value = Counts(\"RDG1\", \"PW\", \"Sewer Works\")\n    .Range(\"E5\").Value = Counts(\"RDG1\", \"PW\", \"Sewer Works\", \"PASS\")\n    .Range(\"F5\").Value = Counts(\"RDG1\", \"PW\", \"Sewer Works\", \"FAIL\")\n\n    'other counts here\n\nEnd With\n\n\n\n'Get row counts from sheet2\n'  Optional 4rd parameter for PASS/FAIL\nFunction Counts(v1 As String, v2 As String, v3 As String, Optional v4 As String = \"\") As Long\n    Dim rng1 As Range, rng2 As Range, rng3 As Range, rng4 As Range\n    With ThisWorkbook.Sheets(2)\n        Set rng1 = .Range(\"C7:C10000\")\n        Set rng2 = .Range(\"D7:D10000\")\n        Set rng3 = .Range(\"G7:G10000\")\n        Set rng4 = .Range(\"I7:I10000\")\n        If Len(v4) &gt; 0 Then\n            Counts = Application.CountIfs(rng1, v1, rng2, v2, rng3, v3, rng4, v4)\n        Else\n            Counts = Application.CountIfs(rng1, v1, rng2, v2, rng3, v3)\n        End If\n    End With\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 12295047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2810cef236e9fb5c00ea69df89701d9?s=128&d=identicon&r=PG&f=1", "display_name": "Cobber", "link": "https://stackoverflow.com/users/12295047/cobber"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 58722882, "answer_count": 1, "score": 1, "last_activity_date": 1573012706, "creation_date": 1573005201, "last_edit_date": 1573008235, "question_id": 58721980, "link": "https://stackoverflow.com/questions/58721980/vba-extra-column-search", "title": "VBA extra column search", "body": "<p>I need to add PW to the below code ie RDG1, PW, Sewer Works, Pass. The extra column will be column D, cheers.</p>\n\n<pre><code>With ThisWorkbook.Sheets(1)\n    .Range(\"D5\").Value = Counts(\"RDG1\", \"Sewer Works\")\n    .Range(\"E5\").Value = Counts(\"RDG1\", \"Sewer Works\", \"PASS\")\n    .Range(\"F5\").Value = Counts(\"RDG1\", \"Sewer Works\", \"FAIL\")\n\n    'other counts here\n\nEnd With\n\n\n\n'Get row counts from sheet2\n'  Optional 3rd parameter for PASS/FAIL\nFunction Counts(v1 As String, v2 As String, Optional v3 As String = \"\") As Long\n    Dim rng1 As Range, rng2 As Range, rng3 As Range\n    With ThisWorkbook.Sheets(2)\n        Set rng1 = .Range(\"C7:C10000\")\n        Set rng2 = .Range(\"G7:G10000\")\n        Set rng3 = .Range(\"I7:I10000\")\n        If Len(v3) &gt; 0 Then\n            Counts = Application.CountIfs(rng1, v1, rng2, v2, rng3, v3)\n        Else\n            Counts = Application.CountIfs(rng3, v1, rng2, v2)\n        End If\n    End With\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 9909958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c7d2e8110245d1d7744966cd57cc90d?s=128&d=identicon&r=PG", "display_name": "ZeroPanda", "link": "https://stackoverflow.com/users/9909958/zeropanda"}, "edited": false, "score": 0, "creation_date": 1573065165, "post_id": 58726340, "comment_id": 103763119, "body": "Thank you for your reply. I changed the code and ran the program. It shows the same result."}], "tags": [], "owner": {"reputation": 521, "user_id": 12268796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LVipW.jpg?s=128&g=1", "display_name": "barneyos", "link": "https://stackoverflow.com/users/12268796/barneyos"}, "is_accepted": false, "score": 0, "last_activity_date": 1573030673, "creation_date": 1573030673, "answer_id": 58726340, "question_id": 58721836, "link": "https://stackoverflow.com/questions/58721836/changing-datetypes-of-the-datalabels/58726340#58726340", "title": "Changing datetypes of the datalabels", "body": "<p>Try maybe change this line:</p>\n\n<pre><code>'With ActiveChart.SeriesCollection(1)\nWith ActiveChart.FullSeriesCollection(1)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 521, "user_id": 12268796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LVipW.jpg?s=128&g=1", "display_name": "barneyos", "link": "https://stackoverflow.com/users/12268796/barneyos"}, "is_accepted": true, "score": 0, "last_activity_date": 1573067821, "last_edit_date": 1573067821, "creation_date": 1573066770, "answer_id": 58736866, "question_id": 58721836, "link": "https://stackoverflow.com/questions/58721836/changing-datetypes-of-the-datalabels/58736866#58736866", "title": "Changing datetypes of the datalabels", "body": "<p>Change following line in For Each Loop: </p>\n\n<pre><code>ActiveChart.FullSeriesCollection(1).Points(Counter).DataLabel.Text = Format(SingleCell.Value, \"0%\")\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 9909958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c7d2e8110245d1d7744966cd57cc90d?s=128&d=identicon&r=PG", "display_name": "ZeroPanda", "link": "https://stackoverflow.com/users/9909958/zeropanda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 58736866, "answer_count": 2, "score": 0, "last_activity_date": 1573067821, "creation_date": 1573003940, "last_edit_date": 1573006344, "question_id": 58721836, "link": "https://stackoverflow.com/questions/58721836/changing-datetypes-of-the-datalabels", "title": "Changing datetypes of the datalabels", "body": "<p>I have been trying really hard to fix the datatype format of the datalabels. unfortunately, nothing is working out. I want the datalabels to have a fomat of 0.00%. How can I change it?</p>\n\n<p>Here's a sample from the program.</p>\n\n<pre><code>Dim OAPList As Range\nDim SingleCell As Range\nDim Counter As Integer\n\nSet OAPList = Worksheets(\"Sheet2\").Range(\"E2:E\" &amp; lw)\nActiveChart.FullSeriesCollection(1).ChartType = xlColumnClustered\nActiveChart.FullSeriesCollection(1).AxisGroup = 1\nActiveChart.SeriesCollection(1).HasDataLabels = True\n\nCounter = 1\nWith ActiveChart.SeriesCollection(1)\n\n    For Each SingleCell In OAPList\n        ActiveChart.SeriesCollection(1).Points(Counter).DataLabel.Text = SingleCell.Value\n        Counter = Counter + 1\n    Next SingleCell\n    .DataLabels.ShowValue = True\n    .DataLabels.NumberFormat = \"0%\"\n    '.DataLabels.Position = xlLabelPositionInsideEnd\n    .DataLabels.Format.AutoShapeType = msoShapeRectangularCallout\n    .DataLabels.Format.Line.Visible = msoTrue\nEnd With\n\nActiveChart.SeriesCollection(2).Name = \"Estimated Hours\"\nActiveChart.FullSeriesCollection(2).ChartType = xlColumnClustered\nActiveChart.FullSeriesCollection(2).AxisGroup = 1\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/eqBNa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eqBNa.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "duplicates", "insert-update"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 1, "creation_date": 1573003577, "post_id": 58721735, "comment_id": 103736187, "body": "<code>Range.RemoveDuplicates</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 12288079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d55ef3d14bccb41e148db1044258f9a?s=128&d=identicon&r=PG&f=1", "display_name": "Chade", "link": "https://stackoverflow.com/users/12288079/chade"}, "edited": false, "score": 0, "creation_date": 1573159257, "post_id": 58725262, "comment_id": 103800888, "body": "Sorry for the delay in responding This works, almost... When I step through and the code and make sure the &quot;TK_Register&quot; is the visible sheet it works. However when I run from the work book it does not remove any duplicates. I tried adding &#39;Sheets(&quot;TK_Register&quot;).Range(&quot;M1&quot;).Select&#39; but then I get run time error 1004 - Select method of range class failed. Any ideas? thank you SO MUCH, this has been driving me crazy"}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": true, "score": 0, "last_activity_date": 1573026141, "creation_date": 1573026141, "answer_id": 58725262, "question_id": 58721735, "link": "https://stackoverflow.com/questions/58721735/excel-vba-remove-duplicates-in-a-range/58725262#58725262", "title": "Excel VBA Remove duplicates in a range", "body": "<p>Below is a sample code using <code>.RemoveDupliates</code> which remove duplicates from column 1 of the range given  taking in consideration that the column has header.</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim LastroW As Long\n\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n\n        LastroW = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n\n        .Range(\"A1:A\" &amp; LastroW).RemoveDuplicates Columns:=1, Header:=xlYes\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 12288079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d55ef3d14bccb41e148db1044258f9a?s=128&d=identicon&r=PG&f=1", "display_name": "Chade", "link": "https://stackoverflow.com/users/12288079/chade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 0, "accepted_answer_id": 58725262, "answer_count": 1, "score": 0, "last_activity_date": 1573026141, "creation_date": 1573002978, "question_id": 58721735, "link": "https://stackoverflow.com/questions/58721735/excel-vba-remove-duplicates-in-a-range", "title": "Excel VBA Remove duplicates in a range", "body": "<p>I'm struggling with the updating of a number of sheets that hold master data.</p>\n\n<p>The user can update the register (\"TK_Register\") with a new item or modify an existing item on the (\"EditEX\") sheet. Data on the EditEx sheet is stored maintained at C32:P56 and saved on the next empty row of the TK_Register Sheet (Columns A to N)</p>\n\n<p>Using a different code, I can recall all specific rows based on a reference number (stored on EditEX sheet in cells O32:O56 and on the TK_Register sheet in column M).</p>\n\n<p>On running this code, </p>\n\n<ul>\n<li>excel takes all data from EditEx sheet C32:P56 </li>\n<li>Pastes this data to the next empty row on TK_Register Sheet </li>\n<li>Auto filters based on column \"N\"  for \"NO\" (i.e. don't need to keep this row)</li>\n<li>Deletes the rows that where filtered (these are rows that have not been used and contain Default data) </li>\n<li>Unfilters the data</li>\n</ul>\n\n<p>This is where I get an issue. This adding all data to the TK_Register sheet includes new Items as well as previous items that have been updated. \nAs we need to make regular additions, updates and changes, when we need to edit it again we only want to see the most recent line items appear on the EditEx sheet.</p>\n\n<p>The user can then make changes to any of the recalled rows and/or add a new one.</p>\n\n<p>My below code only works where the last row reference number (column M) is duplicated. If more than 1 row is being added, it finds no duplicates. \nI know I'm going through this the long way, but any ideas how I can have it search each reference number (column M) being pasted (there will be multiple rows) if found update that row with new data, if not found, add to the next available rows.</p>\n\n<pre><code>    Sub SaveUpdatedRec()\n\n        Dim rng4 As Range\n        Set rng4 = Sheets(\"EditEx\").Range(\"C32:P56\")\n        Sheets(\"TK_Register\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1).Resize(rng4.Rows.Count, rng4.Columns.Count).Cells.Value = rng4.Cells.Value\n        Sheets(\"TK_Register\").Range(\"A1:N1000\").AutoFilter field:=14, Criteria1:=\"NO\"\n        Application.DisplayAlerts = False\n        Sheets(\"TK_Register\").Range(\"A2:N1000\").SpecialCells(xlCellTypeVisible).Delete\n        Application.DisplayAlerts = True\n        On Error Resume Next\n        Sheets(\"TK_Register\").ShowAllData\n        On Error GoTo 0\n\n\n    Sheets(\"AI_Register\").Select\n      Range(\"A1\").Select\n\n       Dim lrow1 As Long\n       For lrow1 = Worksheets(\"AI_Register\").Cells(Rows.Count, \"M\").End(xlUp).Row To 2 Step -1\n           If Cells(lrow1, \"M\") = Cells(lrow1, \"M\").Offset(-1, 0) Then\n              Cells(lrow1, \"M\").Offset(-1, 0).EntireRow.Delete\n           End If\n\n        Next lrow1\n\n       ActiveWorkbook.RefreshAll\n        Sheets(\"EditEx\").Select\n        ActiveWindow.SmallScroll Down:=-120\n        Range(\"B13\").Select\n\n    MsgBox (\"Record Updates have been Saved\")\n\n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "spreadsheet"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1573000314, "post_id": 58721327, "comment_id": 103735500, "body": "<a href=\"https://www.contextures.com/xlDataVal02.html\" rel=\"nofollow noreferrer\">Dependent Drop Down Lists</a> to the rescue."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12329151, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-pQoWgDoaGxM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3ref_2nJWkwVhqAqrQwzv5pz7LYiHw/photo.jpg?sz=128", "display_name": "gfitz", "link": "https://stackoverflow.com/users/12329151/gfitz"}, "edited": false, "score": 0, "creation_date": 1573048489, "post_id": 58729775, "comment_id": 103753920, "body": "Thank you. What I&#39;m gathering from these responses and what I&#39;ve been searching online is that to achieve my goal I will have to modify some cells in my spreadsheet for the sole purpose of storing TRUE and FALSE. Currently this is not how the drop down lists are being populated, instead they simply have the Source text field in the Data Validation dialog to say True, False. This creates the list without having to add True or False to any cell in the spreadsheet.  I would prefer to maintain this behavior because this excel sheet will be sent to users of an application. But there is no way?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 1, "user_id": 12329151, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-pQoWgDoaGxM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3ref_2nJWkwVhqAqrQwzv5pz7LYiHw/photo.jpg?sz=128", "display_name": "gfitz", "link": "https://stackoverflow.com/users/12329151/gfitz"}, "edited": false, "score": 0, "creation_date": 1573050726, "post_id": 58729775, "comment_id": 103755158, "body": "@gfitz It&#39;s probably the simplest method. You can put your list on a hidden, proyected sheet for distribution. You could also use VBA and event-triggered macros to dynamically change the list."}], "tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 0, "last_activity_date": 1573041844, "creation_date": 1573041844, "answer_id": 58729775, "question_id": 58721327, "link": "https://stackoverflow.com/questions/58721327/how-to-create-a-simple-dynamic-list-within-the-cells-of-a-column/58729775#58729775", "title": "How to create a simple, dynamic list within the cells of a column", "body": "<p>Try this:</p>\n\n<pre><code>H1:  TRUE\nH2:  FALSE\n</code></pre>\n\n<p>Validation formula in B1:</p>\n\n<pre><code>=OFFSET($H$1,0,0,IF($A1&lt;2,1,2))\n</code></pre>\n\n<p>or, for a non-volatile formula:</p>\n\n<pre><code>=INDEX($H$1:$H$2,IF($A1&lt;2,1,0))\n</code></pre>\n\n<p>Copy/ paste special validation as far down as needed in column B</p>\n"}], "owner": {"reputation": 1, "user_id": 12329151, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-pQoWgDoaGxM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3ref_2nJWkwVhqAqrQwzv5pz7LYiHw/photo.jpg?sz=128", "display_name": "gfitz", "link": "https://stackoverflow.com/users/12329151/gfitz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573041844, "creation_date": 1572999383, "last_edit_date": 1572999463, "question_id": 58721327, "link": "https://stackoverflow.com/questions/58721327/how-to-create-a-simple-dynamic-list-within-the-cells-of-a-column", "title": "How to create a simple, dynamic list within the cells of a column", "body": "<p>Here's the situation: I have a spreadsheet with two columns, A and B. The cells of each column use Excel's Data Validation to have a drop down list within them. </p>\n\n<p>A's cells have a drop down list with values [0, 1, 2, 3].\nB's cells have a drop down list with values [True, False].</p>\n\n<p>I would like to condition the values of the list within the cells of the B column based upon the selected value of the cell in the A column of the same row.</p>\n\n<p>Here's precisely what I'd like to achieve: if a cell in A has a value 0 or 1, then the drop down list of the cell in B of the same row will only have one value, [True]. Otherwise, the cell in B of the same row has [True, False]. That is all.</p>\n\n<p>I'm a programmer by profession but I have been humbled by VBA. I would be most grateful for any solution, whether it needs to use VBA or not. Thank you.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1573022756, "post_id": 58721326, "comment_id": 103740640, "body": "<code>and other times it does not</code> - so what happens then?"}, {"owner": {"reputation": 79, "user_id": 1460275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2ymLu.jpg?s=128&g=1", "display_name": "John Kiernan", "link": "https://stackoverflow.com/users/1460275/john-kiernan"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1573023901, "post_id": 58721326, "comment_id": 103741099, "body": "It copies the pictures, but the names don&#39;t match the corresponding pictures."}], "owner": {"reputation": 79, "user_id": 1460275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2ymLu.jpg?s=128&g=1", "display_name": "John Kiernan", "link": "https://stackoverflow.com/users/1460275/john-kiernan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573021947, "creation_date": 1572999381, "last_edit_date": 1573021947, "question_id": 58721326, "link": "https://stackoverflow.com/questions/58721326/copypicture-range-name-after-other-cell", "title": "CopyPicture Range Name after other cell", "body": "<p>I'm trying to CopyPicture cells in Column B, and name them the value in Column 1.  I have code that works, except it keeps giving the pictures the wrong names.  The baffling thing is that sometimes it works perfectly, and other times it does not.  </p>\n\n<p>I have tried to cobble together a routine based on posted examples of the CopyPicture command.  I'm pasting it in below.  </p>\n\n<p>Yes, I'm a newbie at VBScript.  Be gentle. ;-)</p>\n\n<pre><code>Sub makepic()\n    Dim path As String\n    path = \"C:\\BP\\BP2020\\JPGs\\\"\n    Dim CLen As Integer\n    Dim cntr As Integer\n    cntr = 1\n    Dim rgExp As Range\n    Dim CCntr As String\n    CString2 = \"A1:A6\"\n    Set rgExp2 = Range(CString2)\n    CString = \"B1:B6\"\n    Set rgExp = Range(CString)\n\n    For I = 1 To rgExp.Cells.Count Step 1\n      CCntr = rgExp2.Cells(I).Value\n      rgExp.Cells.Cells(I).Font.Size = 72\n      rgExp.Cells.Cells(I).CopyPicture Appearance:=xlScreen, Format:=xlBitmap\n      rgExp.Cells.Cells(I).Font.Size = 14\n      ''' Create an empty chart with exact size of range copied\n      CLen = Len(rgExp.Cells.Cells(I).Value)\n      CWidth = CLen * 85\n\n      With ActiveSheet.ChartObjects.Add(Left:=1600, Top:=rgExp.Top, _\n        Width:=CWidth, Height:=50)\n        .Name = \"ChartVolumeMetricsDevEXPORT\"\n        .Activate\n      End With\n\n      ''' Paste into chart area, export to file, delete chart.\n      If CCntr &lt;&gt; \"\" Then\n        ActiveChart.Paste\n\n        Selection.Name = \"pastedPic\"\n\n        ActiveSheet.ChartObjects(\"ChartVolumeMetricsDevEXPORT\").Chart.Export (path + CCntr &amp; \".jpg\")\n        ActiveSheet.ChartObjects(\"ChartVolumeMetricsDevEXPORT\").Delete\n      End If\n      cntr = cntr + 1\n   Next\nEnd Sub\n</code></pre>\n\n<p>Again, I expect -- for example -- a picture of the contents of cell B1 to have the name of the contents of A1.  I tried making the range A1:B4 (for example), but that got me 8 pictures.  I finally decided to try to make 2 ranges, but that didn't work either.</p>\n"}, {"tags": ["excel", "vba", "loops", "userform"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1572999371, "post_id": 58721278, "comment_id": 103735311, "body": "Declare <code>j</code> at the top of the module to make it public to all procedures in the module. And delete <code>j=1</code>. Or write <code>If j=0 Then j=1</code> so each time it reads that line it will not set j to 1 unless it&#39;s the first time run from opening the file. Also keep in mind that as soon as the user closes the file <code>j</code> will be destroyed and start over again."}, {"owner": {"reputation": 27, "user_id": 4930036, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dWqUxQP0iXg/AAAAAAAAAAI/AAAAAAAAAMU/eFb4d_bBDxg/photo.jpg?sz=128", "display_name": "Nicole Lee", "link": "https://stackoverflow.com/users/4930036/nicole-lee"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1573000880, "post_id": 58721278, "comment_id": 103735631, "body": "Thank you! This worked really well.   I was wondering if you would be able to help with a second question, with regards to my variable &quot;i&quot;. My variable pStr should show ric, name, valueUSD values that are pulled from the worksheet and dependent on i.   Upon 1st initialization, UserForm1.Label1.Caption shows up as &quot;Label1&quot; instead of pStr. How do I have i start from 2?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1573001057, "post_id": 58721278, "comment_id": 103735681, "body": "Where you declare that <code>i=2</code> add an else block to say <code>i=1</code>. Otherwise, it will equal 0 by default."}, {"owner": {"reputation": 27, "user_id": 4930036, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dWqUxQP0iXg/AAAAAAAAAAI/AAAAAAAAAMU/eFb4d_bBDxg/photo.jpg?sz=128", "display_name": "Nicole Lee", "link": "https://stackoverflow.com/users/4930036/nicole-lee"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1573004101, "post_id": 58721278, "comment_id": 103736298, "body": "Thanks Scott, do you know why upon first Initialization, my Label1.Caption is still displaying Label1? It will only change to display cell values if I click skip."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1573049809, "post_id": 58721278, "comment_id": 103754588, "body": "try adding <code>UserForm1.Repaint</code> to see the change"}], "owner": {"reputation": 27, "user_id": 4930036, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dWqUxQP0iXg/AAAAAAAAAAI/AAAAAAAAAMU/eFb4d_bBDxg/photo.jpg?sz=128", "display_name": "Nicole Lee", "link": "https://stackoverflow.com/users/4930036/nicole-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1572998972, "creation_date": 1572998916, "last_edit_date": 1572998972, "question_id": 58721278, "link": "https://stackoverflow.com/questions/58721278/creating-a-loop-within-a-userform", "title": "Creating a loop within a UserForm", "body": "<p>this is a continuation of my previous question... \nI'm trying to create a user form that will go through a list on a worksheet (TESTER). The form should display the first row of data from the list. User will also be able to select one of two options Active or ITW. Finally, the user is free to add additional comments. </p>\n\n<p>This is where I'm running into trouble, once the user clicks Add, the values from the form should populate the next blank row in a separate sheet (pasteHere). I have no issues with the form displaying the next line of data on the list, but I don't know how to create a loop that will allow me to find the next blank row after clicking the add button. At the moment, I've only initialized <code>j</code> as 1. And every time I click add, it will paste on the first row in the pasteHere worksheet. </p>\n\n<pre><code>Sub addBtn_Click()\n\nApplication.ScreenUpdating = False\nDim pasteSheet As Worksheet\n\nDim j As Long\n\nj = 1 'how can I loop this part\n\nSet pasteSheet = Application.Worksheets(\"pasteHere\")\n\npasteSheet.Cells(j, j) = ric\npasteSheet.Cells(j, j + 2) = name\npasteSheet.Cells(j, j + 4) = valueUSD\n\npasteSheet.Cells(j + 1, j) = dstr\n\ni = i + 1\nj = j + 2\n\nUserForm1_Initialize\n\nEnd Sub\n</code></pre>\n\n<p>Would appreciate any help here. Full code below:</p>\n\n<pre><code>Public valueUSD, name, ric, dstr, sitchStr, pStr As String\nPublic i, lRow As Long\n\nSub UserForm1_Initialize()\n\nIf Worksheets(\"pasteHere\").Range(\"A1\") = \"\" Then\n    i = 2\nEnd If\n\nactiveCheck.Value = False\nitwCheck.Value = False\nTextBox2.Value = \"\"\n\nric = Worksheets(\"Tester\").Range(\"H\" &amp; i)\nname = Worksheets(\"Tester\").Range(\"B\" &amp; i)\nvalueUSD = Worksheets(\"Tester\").Range(\"C\" &amp; i)\nsitchStr = \"\"\ndstr = \"\"\n\npStr = ric &amp; \"   \" &amp; name &amp; \"   \" &amp; valueUSD &amp; \"   \"\n\nUserForm1.Label1.Caption = pStr\n\nEnd Sub\nSub activeCheck_Change()\n\n    If activeCheck.Value = True Then\n        sitchStr = sitchStr + activeCheck.Caption\n    Else\n        sitchStr = \"\"\n    End If\n\nEnd Sub\n\nSub itwCheck_Change()\n\n    If activeCheck.Value = False And itwCheck.Value = True Then\n        sitchStr = sitchStr + itwCheck.Caption\n    ElseIf activeCheck.Value = True And itwCheck.Value = True Then\n        MsgBox (\"You can only be active OR ITW\")\n    End If\n\nEnd Sub\n\nSub TextBox2_Change()\n    dstr = sitchStr &amp; \", \" &amp; TextBox2.Value\nEnd Sub\n\nSub addBtn_Click()\n\nApplication.ScreenUpdating = False\nDim pasteSheet As Worksheet\n\nDim j As Long\n\nj = 1 'how can I loop this part\n\nSet pasteSheet = Application.Worksheets(\"pasteHere\")\n\npasteSheet.Cells(j, j) = ric\npasteSheet.Cells(j, j + 2) = name\npasteSheet.Cells(j, j + 4) = valueUSD\n\npasteSheet.Cells(j + 1, j) = dstr\n\ni = i + 1\nj = j + 2\n\nUserForm1_Initialize\n\nEnd Sub\n\nSub skipBtn_Click()\n    i = i + 1\n    UserForm1_Initialize\nEnd Sub\n\nSub exitBtn_Click()\n    Unload Me\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 312, "user_id": 5376832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/131cf551898d23800289731848abedbc?s=128&d=identicon&r=PG&f=1", "display_name": "Karlomanio", "link": "https://stackoverflow.com/users/5376832/karlomanio"}, "edited": false, "score": 0, "creation_date": 1572994786, "post_id": 58720640, "comment_id": 103734144, "body": "My guess is that somewhere you are picking up a number from one place and a string from another and that is causing an issue with the update based on the data types in that field in the table."}, {"owner": {"reputation": 31, "user_id": 9489641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d30a4007722c826cf10d4033354b2f0?s=128&d=identicon&r=PG&f=1", "display_name": "PiBoye", "link": "https://stackoverflow.com/users/9489641/piboye"}, "reply_to_user": {"reputation": 312, "user_id": 5376832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/131cf551898d23800289731848abedbc?s=128&d=identicon&r=PG&f=1", "display_name": "Karlomanio", "link": "https://stackoverflow.com/users/5376832/karlomanio"}, "edited": false, "score": 0, "creation_date": 1572994972, "post_id": 58720640, "comment_id": 103734211, "body": "@Karlomanio I did double check the data types. The fields are all set to Short text. Do you think Input mask could be the issue? But for these data I am pretty sure they are normal strings and saved as default short text that access has."}, {"owner": {"reputation": 312, "user_id": 5376832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/131cf551898d23800289731848abedbc?s=128&d=identicon&r=PG&f=1", "display_name": "Karlomanio", "link": "https://stackoverflow.com/users/5376832/karlomanio"}, "edited": false, "score": 0, "creation_date": 1572995307, "post_id": 58720640, "comment_id": 103734306, "body": "I cannot see that there is one here, but since you are asking about it, I assume there is one. It is possible that the input mask could cause that problem. I&#39;m still thinking there may be some data that is coerced into a data type you don&#39;t intend it to be when the update occurs.  The same behavior could happen with an input mask."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1572995861, "post_id": 58720640, "comment_id": 103734457, "body": "Examine the SQL statement text contained in <code>updtDispName_SQL</code> immediately before you execute it.  Perhaps it does not contain what you expect.  You can also test by pasting it into SQL View of a new query in the Access query designer.  When you run it from there, does Access give you any clues as to why it doesn&#39;t do what you expect?"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1572996013, "post_id": 58720640, "comment_id": 103734495, "body": "If you have <code>DoCmd.SetWarnings False</code> anywhere in your project&#39;s code, you should do <code>DoCmd.SetWarnings True</code> at least until you have sorted the problem."}, {"owner": {"reputation": 31, "user_id": 9489641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d30a4007722c826cf10d4033354b2f0?s=128&d=identicon&r=PG&f=1", "display_name": "PiBoye", "link": "https://stackoverflow.com/users/9489641/piboye"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1572996357, "post_id": 58720640, "comment_id": 103734565, "body": "@HansUp Oh I tried it in the query wizard and it throws up Enter Parameter value.. Maybe thats why it is not working. But not sure what it is and why it is coming up. Any clues?"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1572996529, "post_id": 58720640, "comment_id": 103734613, "body": "The parameter input box shows you the name of whatever Access thinks is a parameter.  In many cases, that is a misspelled field name.  What does it show you?"}, {"owner": {"reputation": 31, "user_id": 9489641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d30a4007722c826cf10d4033354b2f0?s=128&d=identicon&r=PG&f=1", "display_name": "PiBoye", "link": "https://stackoverflow.com/users/9489641/piboye"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1572996771, "post_id": 58720640, "comment_id": 103734672, "body": "@HansUp Enter Parameter Value for Disciplines.DisciplineName and the same for DisciplineID"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1572997299, "post_id": 58720640, "comment_id": 103734806, "body": "How can that be?  You&#39;re attempting <code>UPDATE ReportGen</code>  So  why does <code>Disciplines.DisciplineName</code> get included in the SQL statement?  Please show us the text of the SQL statement which triggers that &quot;Enter Parameter Value&quot; event."}, {"owner": {"reputation": 31, "user_id": 9489641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d30a4007722c826cf10d4033354b2f0?s=128&d=identicon&r=PG&f=1", "display_name": "PiBoye", "link": "https://stackoverflow.com/users/9489641/piboye"}, "edited": false, "score": 0, "creation_date": 1572997562, "post_id": 58720640, "comment_id": 103734871, "body": "UPDATE ReportGen SET ReportGen.DisciplineName = Disciplines.DisciplineName WHERE ReportGen.DisciplineID = Discipline.DisciplineID;"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1572997916, "post_id": 58720640, "comment_id": 103734959, "body": "The VBA code in your question adds single quotes; there are no single quotes in the <code>UPDATE</code> in your comment.  It had to have come from somewhere else.  I can&#39;t help you."}, {"owner": {"reputation": 31, "user_id": 9489641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d30a4007722c826cf10d4033354b2f0?s=128&d=identicon&r=PG&f=1", "display_name": "PiBoye", "link": "https://stackoverflow.com/users/9489641/piboye"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1572998125, "post_id": 58720640, "comment_id": 103735005, "body": "@HansUp Sorry I didn&#39;t understand. What single quotes are you referring to?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1573000723, "post_id": 58720640, "comment_id": 103735592, "body": "Your query does not make any joins nor does it have any subqueries. Looks like invalid SQL to me. See the answer below for more help./"}], "answers": [{"tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 1, "last_activity_date": 1572996990, "creation_date": 1572996990, "answer_id": 58721033, "question_id": 58720640, "link": "https://stackoverflow.com/questions/58720640/identical-update-query-one-works-the-other-doesnt/58721033#58721033", "title": "Identical UPDATE query. One works the other doesn&#39;t", "body": "<p>Consider pure SQL without recordsets as Access supports <code>JOIN</code> or subqueries in <code>UPDATE</code>. Save below as stored queries and run as needed with GUI or VBA. Unlike your code which did not loop and would only run on current recordset row (not necessarily the first), below queries run on all matched rows.</p>\n\n<p><strong>SQL</strong></p>\n\n<p>Query 1</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>UPDATE ReportGen r\nINNER JOIN Area a\n  ON r.AreaID = a.AreaID\nSET r.AreaName = a.AreaName;\n</code></pre>\n\n<p>Query 2</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>UPDATE ReportGen r\nINNER JOIN Disciplines d\n   ON r.DisciplineID = d.DisciplineID\nSET r.DisciplineName = d.DisciplineName;\n</code></pre>\n\n<p><strong>VBA</strong></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>'DOES NOT SHOW WARNINGS\nCurrentDb.Execute \"mySavedUpdateQuery\"\n\n'DOES SHOW WARNINGS (NO NEED TO CLOSE ACTION QUERIES)\nDoCmd.OpenQuery \"mySavedUpdateQuery\"\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 9489641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d30a4007722c826cf10d4033354b2f0?s=128&d=identicon&r=PG&f=1", "display_name": "PiBoye", "link": "https://stackoverflow.com/users/9489641/piboye"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1572996990, "creation_date": 1572994235, "question_id": 58720640, "link": "https://stackoverflow.com/questions/58720640/identical-update-query-one-works-the-other-doesnt", "title": "Identical UPDATE query. One works the other doesn&#39;t", "body": "<p>Trying to update a table using the UPDATE query which it gets from different Recordsets. One UPDATE query runs and updates the records but the other runs, doesn't update the records and doesn't throws any error where the problem is. I suspect it's somewhere in the WHERE clause but can't pinpoint. </p>\n\n<p>I played around with the quotation marks but no luck and this is where I am confused the most about. Single, Double quotes and <code>&amp;</code> character are a bit confusing for me.</p>\n\n<pre><code>extArea_SQL = \"SELECT * FROM Area;\"\nSet rsArea = CurrentDb.OpenRecordset(extArea_SQL, dbOpenDynaset)\nextDiscipline_SQL = \"SELECT * FROM Disciplines;\"\nSet rsDisp = CurrentDb.OpenRecordset(extDiscipline_SQL, dbOpenDynaset)\n\ninstAreaName_SQL = \"UPDATE ReportGen SET ReportGen.AreaName = '\" &amp; rsArea.Fields(\"AreaName\") &amp; \"' WHERE ReportGen.AreaID = '\" &amp; rsArea.Fields(\"AreaID\") &amp; \"';\"\nupdtDispName_SQL = \"UPDATE ReportGen SET ReportGen.DisciplineName = '\" &amp; rsDisp.Fields(\"DisciplineName\") &amp; \"' WHERE ReportGen.DisciplineID = '\" &amp; rsDisp.Fields(\"DisciplineID\") &amp; \"';\"\n\ndb.Execute instAreaName_SQL, dbFailOnError\ndb.Execute updtDispName_SQL, dbFailOnError\n</code></pre>\n\n<p>I'd also like to point out that AreaName and the Discipline data are string and has special characters like <code>-,()/</code> etc. </p>\n\n<p>Not sure what I am doing wrong with the lower (updtDispName_SQL) UPDATE query where as the one above works with no problems. I copy pasted the format of the one working and made changes to the lower one but still can't point out. </p>\n\n<p>Can any one point out what I am missing out here?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1572989550, "post_id": 58719454, "comment_id": 103732367, "body": "Look at the questions under &quot;Related&quot; over to the right of this page."}, {"owner": {"reputation": 15, "user_id": 11336790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d17ef201826591aa683ddb8dfd1f27b5?s=128&d=identicon&r=PG&f=1", "display_name": "new2vba", "link": "https://stackoverflow.com/users/11336790/new2vba"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1572990781, "post_id": 58719454, "comment_id": 103732886, "body": "not sure I&#39;m seeing the same &quot;Related&quot; as you. #N/A is not a text or a string, so I&#39;m having trouble deleting all but the #N/A"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1572990908, "post_id": 58719454, "comment_id": 103732932, "body": "You can use <code>application.worksheetfunction.isna(cellValue)</code> to test if a cell is #NA - otherwise the related questions cover the general process."}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 1, "creation_date": 1572990969, "post_id": 58719454, "comment_id": 103732961, "body": "Hide the error rows and delete the visible rows."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 11336790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d17ef201826591aa683ddb8dfd1f27b5?s=128&d=identicon&r=PG&f=1", "display_name": "new2vba", "link": "https://stackoverflow.com/users/11336790/new2vba"}, "edited": false, "score": 1, "creation_date": 1572990972, "post_id": 58720047, "comment_id": 103732964, "body": "Thank you! Such a simple change and it worked..worked great! :)"}], "tags": [], "owner": {"reputation": 57, "user_id": 9598272, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-m992ybDpciM/AAAAAAAAAAI/AAAAAAAAABQ/4DLwgR-Dsv0/photo.jpg?sz=128", "display_name": "onur rr", "link": "https://stackoverflow.com/users/9598272/onur-rr"}, "is_accepted": true, "score": 0, "last_activity_date": 1572990793, "creation_date": 1572990793, "answer_id": 58720047, "question_id": 58719454, "link": "https://stackoverflow.com/questions/58719454/how-to-delete-rows-not-containing-n-a/58720047#58720047", "title": "how to delete rows NOT containing #N/A", "body": "<p>Instead of using \"xlErrors\" you can use <strong>xlTextValues</strong> or <strong>xlNumbers</strong>\nlike this:</p>\n\n<pre><code>Columns(\"E\").SpecialCells(xlFormulas, xlTextValues).EntireRow.Delete\n</code></pre>\n\n<p>or</p>\n\n<pre><code>Columns(\"E\").SpecialCells(xlFormulas, xlNumbers).EntireRow.Delete\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 11336790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d17ef201826591aa683ddb8dfd1f27b5?s=128&d=identicon&r=PG&f=1", "display_name": "new2vba", "link": "https://stackoverflow.com/users/11336790/new2vba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 58720047, "answer_count": 1, "score": 0, "last_activity_date": 1572990793, "creation_date": 1572987904, "last_edit_date": 1572987992, "question_id": 58719454, "link": "https://stackoverflow.com/questions/58719454/how-to-delete-rows-not-containing-n-a", "title": "how to delete rows NOT containing #N/A", "body": "<p>I have an autofill for a vlookup and I want to remove/delete all rows that ARE NOT #N/A in column E (I want to keep only the rows that generate an error)</p>\n\n<p>I have a code that does the opposite and deletes all rows that CONTAIN #N/A, but I need to opposite</p>\n\n<pre><code>On Error Resume Next\nColumns(\"E\").SpecialCells(xlFormulas, xlErrors).EntireRow.Delete\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1572998931, "post_id": 58719374, "comment_id": 103735226, "body": "What is the specific problem? Does the code error? Does it not do what you want?"}, {"owner": {"reputation": 109, "user_id": 7988181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c5df574303eeeebb5af6160f59b1db2?s=128&d=identicon&r=PG&f=1", "display_name": "A_Pirates_Favorite_Letter", "link": "https://stackoverflow.com/users/7988181/a-pirates-favorite-letter"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1573048828, "post_id": 58719374, "comment_id": 103754115, "body": "Currently, the code throws the following error:  Run-Time error &#39;438&#39; Object doesn&#39;t support this property or method.  I&#39;ve never done this type of interface in Excel before, so I&#39;m at a bit of a loss."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1573049869, "post_id": 58719374, "comment_id": 103754624, "body": "which line generates the error?"}, {"owner": {"reputation": 109, "user_id": 7988181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c5df574303eeeebb5af6160f59b1db2?s=128&d=identicon&r=PG&f=1", "display_name": "A_Pirates_Favorite_Letter", "link": "https://stackoverflow.com/users/7988181/a-pirates-favorite-letter"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1573050748, "post_id": 58719374, "comment_id": 103755172, "body": "It&#39;s the final WITH statement at the end of the code - once it hits the .Clear function, I get the error."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1573053584, "post_id": 58719374, "comment_id": 103756898, "body": "It&#39;s because the <code>Shape</code> object does not have a <code>Clear</code> method. I suggest assigning the shape to a <code>ListBox</code> object variable, then you can work with that as intended."}], "owner": {"reputation": 109, "user_id": 7988181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c5df574303eeeebb5af6160f59b1db2?s=128&d=identicon&r=PG&f=1", "display_name": "A_Pirates_Favorite_Letter", "link": "https://stackoverflow.com/users/7988181/a-pirates-favorite-letter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1572988728, "creation_date": 1572987506, "last_edit_date": 1572988728, "question_id": 58719374, "link": "https://stackoverflow.com/questions/58719374/use-excel-vba-to-insert-table-data-into-a-list-box", "title": "Use Excel VBA to insert table data into a list box", "body": "<p>Update: Did some research and have the code below now</p>\n\n<p>I've been helped quite a bit by you code gods today, so here's another question about something I've never done in Excel VBA before:</p>\n\n<p>I've got some code that selects values from a master table, creates a smaller temporary table, then sorts the table. That's simple enough, but what I'd really like to do is add these values to a form control List Box. The code I have so far is as follows:</p>\n\n<pre><code>Sub Tester()\n\n    Dim dateSel As Variant\n    Dim sevLev, i, rw As Integer\n    Dim dRange, keyRange, listRange As Range\n    Dim listArray() As String\n\n    sevLev = 1\n    dateSel = \"12/4/2019\"\n\n    With Sheets(\"All_Risk_Report\")\n        .Range(\"A1\").AutoFilter _\n            field:=2, _\n            Criteria1:=dateSel\n        .Range(\"A1\").AutoFilter _\n            field:=13, _\n            Criteria1:=sevLev\n    End With\n\n    Sheets(\"All_Risk_Report\").Range(\"A1:AZ50000\").SpecialCells(xlCellTypeVisible).Copy\n\n    Sheets.Add Before:=ActiveSheet\n    ActiveSheet.Name = \"TempTable2\"\n\n    Sheets(\"All_Risk_Report\").Range(\"F:F\").SpecialCells(xlCellTypeVisible).Copy\n    Sheets(\"TempTable2\").Cells(1, 1).PasteSpecial\n\n    Sheets(\"All_Risk_Report\").Range(\"C:C\").SpecialCells(xlCellTypeVisible).Copy\n    Sheets(\"TempTable2\").Cells(1, 2).PasteSpecial\n\n    Sheets(\"All_Risk_Report\").Range(\"E:E\").SpecialCells(xlCellTypeVisible).Copy\n    Sheets(\"TempTable2\").Cells(1, 3).PasteSpecial\n\n    Sheets(\"All_Risk_Report\").Range(\"I:I\").SpecialCells(xlCellTypeVisible).Copy\n    Sheets(\"TempTable2\").Cells(1, 4).PasteSpecial\n\n    Sheets(\"All_Risk_Report\").ShowAllData\n\n    Set dRange = Sheets(\"TempTable2\").Range(\"A1:D500\")\n    Set keyRange = Sheets(\"TempTable2\").Range(\"A1:A500\")\n\n    dRange.Sort key1:=keyRange, Header:=xlYes\n\n    Set listRange = Sheets(\"TempTable2\").Range(\"A1:D500\")\n\n    With Sheets(\"Calendar\").Shapes.Range(Array(\"List Box 1\"))\n        .Clear\n        .ColumnHeads = False\n        .ColumnCount = listRange.Columns.Count\n\n        ReDim MyArray(listRange.Rows.Count, listRange.Columns.Count)\n\n        rw = 0\n\n        For i = 1 To listRange.Rows.Count\n            For j = 0 To listRange.Columns.Count\n                MyArray(rw, j) = listRange.Cells(i, j + 1)\n            Next\n            rw = rw + 1\n        Next\n\n        .List = MyArray\n\n        .TopIndex = 0\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>I'm not sure exactly how to go about this. I've got the table already created, but I've not used form controls much.</p>\n\n<p>Effectively, this will be a miniature scroll-able window within the sheet itself containing a small subset of data. Please let me know if that makes sense and if you have any advice/suggestions/tips. Thanks!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1572986633, "post_id": 58719171, "comment_id": 103731257, "body": "<a href=\"https://www.quora.com/How-do-I-format-a-number-in-an-Excel-sheet-cell-with-architectural-units\" rel=\"nofollow noreferrer\">quora.com/&hellip;</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1572987249, "post_id": 58719171, "comment_id": 103731503, "body": "Consider making a <code>UserForm</code> instead, you&#39;ll have much better and fine-tuned control over what the user can and cannot enter in a <code>TextBox</code> control (via e.g. a <code>KeyDown</code> handler) than in an <code>InputBox</code> - and you get to validate the input before it&#39;s submitted, so invalid input can make the OK button disabled and an explanatory validation error message visible."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1572987425, "post_id": 58719171, "comment_id": 103731577, "body": "If you use <code>Application.InputBox</code> with a type of 2, your output will be a string.  You can then use a Regular Expression to test that you have the desired format.  Or you could merely convert a decimal input into a fraction, and remove that restriction as to entry type."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1572987627, "post_id": 58719171, "comment_id": 103731650, "body": "One more thing: whenever <code>InputBox</code> or <code>Application.InputBox</code> is used, the fact that the box can be cancelled is always systematically ignored, until it becomes a problem (typically involves a <i>type mismatch</i> error). The function returns a <code>Variant</code> that will be a <code>Boolean</code> if cancelled, and you need to account for that; you can use <code>VarType</code> to get the subtype of a <code>Variant</code>; if that&#39;s <code>vbBoolean</code>, box was cancelled and the function&#39;s return value shouldn&#39;t be used."}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1572987698, "post_id": 58719375, "comment_id": 103731680, "body": "And handle cancellation by jumping out of the loop with <code>Exit Do</code> ...but you can&#39;t do that with the deprecated <code>While...Wend</code> loop block; use <code>Do While...Loop</code> instead."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1572988288, "post_id": 58719375, "comment_id": 103731901, "body": "@MathieuGuindon - Thanks, Mathieu. Cancellation and empty value are rather separate concerns, but I guess these could be handled with <code>Exit Do</code> quite well."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1572988221, "last_edit_date": 1572988221, "creation_date": 1572987508, "answer_id": 58719375, "question_id": 58719171, "link": "https://stackoverflow.com/questions/58719171/vba-inputbox-to-prevent-decimals/58719375#58719375", "title": "VBA Inputbox to Prevent Decimals", "body": "<p>A while loop, which checks the input string for a dot or comma would work quite ok, I guess:</p>\n\n<pre><code>Sub TestMe()\n\n    Dim inputString As String\n    Dim inputNumeric As Boolean\n\n    inputString = InputBox(\"Please, enter a number!\")\n    inputNumeric = isNumeric(Evaluate(inputString))\n\n    Do While InStr(1, inputString, \".\") Or _\n            InStr(1, inputString, \",\") Or _\n            Not inputNumeric\n\n        If Not CBool(inputNumeric) Then\n            MsgBox \"You tried to cancel or entered empty value!\"\n            Exit Do\n        End If\n\n        MsgBox \"Please, do not write dot or comma!\"\n\n        inputString = InputBox(\"Please, enter a number!\")\n        inputNumeric = isNumeric(Evaluate(inputString))\n    Loop\n\nEnd Sub\n</code></pre>\n\n<p>The <code>isNumeric()</code> checks the input for being able to be converted to numeric. Thus <code>5-1/2</code> should be ok.</p>\n\n<p>Concerning cancellation or entering empty value from the <code>InputBox()</code> - it really depends on the business logic of the \"app\", but in the case above - there is a msgbox and it exits the loop.</p>\n"}, {"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 0, "last_activity_date": 1572991215, "creation_date": 1572991215, "answer_id": 58720129, "question_id": 58719171, "link": "https://stackoverflow.com/questions/58719171/vba-inputbox-to-prevent-decimals/58720129#58720129", "title": "VBA Inputbox to Prevent Decimals", "body": "<p>Write a separate function responsible for that prompt, and use it e.g. like this:</p>\n\n<pre><code>Dim casingSize As String\nIf GetCasingSize(casingSize) Then\n    ActiveSheet.Range(\"C2\").Value = casingSize\nEnd If\n</code></pre>\n\n<p>The function needs to return a <code>Boolean</code> for this to work - it returns <code>True</code> if the input is valid, <code>False</code> if there's no valid input to work with (e.g. prompt was cancelled). What makes this work, is passing the result as a <code>ByRef</code> argument, like this:</p>\n\n<pre><code>Public Function GetCasingSize(ByRef outResult As String) As Boolean\n    Do            \n        Dim raw As Variant\n        raw = InputBox(\"Casing size?\")\n        If VarType(raw) = vbBoolean Then\n            'handle cancelled prompt:\n            Exit Do\n        End If\n\n        If ValidateFractional(raw) Then\n            'handle valid input:\n            outResult = CStr(raw)\n            GetCasingSize = True\n            Exit Do\n        End If\n\n        'handle invalid input:\n        If MsgBox(\"The value '\" &amp; raw &amp; \"' is not valid. Try again?\", vbYesNo) = vbNo Then\n            Exit Do\n        End If\n    Loop\nEnd Function\n</code></pre>\n\n<p>Note the <code>ValidateFractional</code> function is its own concern - a separate, <code>Private</code> function would work, but I'd recommend making it <code>Public</code>, and <a href=\"https://github.com/rubberduck-vba/Rubberduck/wiki/Unit-Testing\" rel=\"nofollow noreferrer\">unit-testing it</a> to make sure it works as intended given a wide variety of edge-case inputs - and having it in a separate function means the logic in <code>GetCasingSize</code> doesn't need to change if the validation needs to be fine-tuned; for example this naive implementation uses the <code>Like</code> operator and would work for <code>5-1/4</code>, but not for e.g. <code>15-5/8</code>:</p>\n\n<pre><code>Public Function ValidateFractional(ByVal value As String) As Boolean\n    ValidateFractional = value Like \"#[-]#/#\"\nEnd Function\n</code></pre>\n\n<p>Using <em>Regular Expressions</em> for this would probably be a good idea.</p>\n"}], "owner": {"reputation": 13, "user_id": 12327993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73beb79132ac662c83652e4535f3a3e2?s=128&d=identicon&r=PG&f=1", "display_name": "DMann1996", "link": "https://stackoverflow.com/users/12327993/dmann1996"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 290, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1572991215, "creation_date": 1572986483, "last_edit_date": 1572986517, "question_id": 58719171, "link": "https://stackoverflow.com/questions/58719171/vba-inputbox-to-prevent-decimals", "title": "VBA Inputbox to Prevent Decimals", "body": "<p>I am trying to develop a tool that will help standardize a description catalog of products. I want to have an input box prompt a user to enter a size. I want to encourage size entries like \"5-1/2\" and prevent users from entering \"5.5\". Ideally, if the size was entered with a decimal and not a dash with a fraction, I want a message box to pop up saying they can not do that. It would then need to re-show the input box.</p>\n\n<p>Here is what I have - </p>\n\n<pre><code>Private Sub CS_Other_Click()\nUnload Me\nSheets(\"Fill In\").Activate\nWorksheets(\"Fill In\").Range(\"C2\").NumberFormat = \"@\"\nDim other_casing_size As Variant\nother_casing_size = InputBox(\"Fill in the casing size. Syntax MUST be in the form of X-X/X\", \"New Casing Size\")\nRange(\"C2\") = other_casing_size\n</code></pre>\n\n<p>I just dont know the code to prevent an entry with decimals. Even better, if i knew how to code an exact syntax to include or exclude anything I wanted that would be perfect.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1572991241, "post_id": 58718939, "comment_id": 103733061, "body": "What is the error and where does it occur?"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 12322805, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDAwT8hOQMRPhIR4Dv381ea-4Lih06d2FBveTqF=k-s128", "display_name": "Jason Avery", "link": "https://stackoverflow.com/users/12322805/jason-avery"}, "edited": false, "score": 0, "creation_date": 1573069952, "post_id": 58720293, "comment_id": 103765093, "body": "Thanks for the help Tim. I was able to solve that issue, and have since been able to start to loop it, but am experiencing an issue navigating during the second loop.  I keep on getting the error &quot;method navigate of object iwebbrowser2 failed&quot; and I&#39;m not sure why. I&#39;ve edited to the original post to reflect the current code"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 21, "user_id": 12322805, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDAwT8hOQMRPhIR4Dv381ea-4Lih06d2FBveTqF=k-s128", "display_name": "Jason Avery", "link": "https://stackoverflow.com/users/12322805/jason-avery"}, "edited": false, "score": 0, "creation_date": 1573070657, "post_id": 58720293, "comment_id": 103765368, "body": "It&#39;s best not to update your existing question to a brand-new problem: it makes the existing answers useless to anyone else, and this is not a rolling process: if you have a new problem, please post a new question."}, {"owner": {"reputation": 21, "user_id": 12322805, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDAwT8hOQMRPhIR4Dv381ea-4Lih06d2FBveTqF=k-s128", "display_name": "Jason Avery", "link": "https://stackoverflow.com/users/12322805/jason-avery"}, "edited": false, "score": 0, "creation_date": 1573071086, "post_id": 58720293, "comment_id": 103765555, "body": "Understood, apologies."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1572992087, "creation_date": 1572992087, "answer_id": 58720293, "question_id": 58718939, "link": "https://stackoverflow.com/questions/58718939/autosearching-cage-codes/58720293#58720293", "title": "Autosearching CAGE codes", "body": "<pre><code>Set elements = HTML.getElementsByID(\u201cdetail_topsection\u201d)\n</code></pre>\n\n<p>should be </p>\n\n<pre><code>Set element = HTML.getElementByID(\u201cdetail_topsection\u201d)  'no \"s\"\n</code></pre>\n\n<p>Element Id's on a page should be unique, so <code>getElementByID</code> returns a single element (or nothing), not a collection of elements like <code>getElementsByTagName</code></p>\n"}], "owner": {"reputation": 21, "user_id": 12322805, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDAwT8hOQMRPhIR4Dv381ea-4Lih06d2FBveTqF=k-s128", "display_name": "Jason Avery", "link": "https://stackoverflow.com/users/12322805/jason-avery"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1573128874, "creation_date": 1572985496, "last_edit_date": 1573128874, "question_id": 58718939, "link": "https://stackoverflow.com/questions/58718939/autosearching-cage-codes", "title": "Autosearching CAGE codes", "body": "<p>I need to retrieve the attributes for roughly 500 CAGE codes from the DLA and record them in my spreadsheet. I'm starting by trying to retrieve it for one item, then eventually looping it. I keep on getting an error for the below and I can't figure out why.</p>\n\n<p>Note the code doesn't work unless you've already opened the website before and haven't closed the broswer (you need to accept the terms and conditions).</p>\n\n<p>The cell B2 = <a href=\"https://cage.dla.mil/Search/Results?q=07187&amp;page=1\" rel=\"nofollow noreferrer\">https://cage.dla.mil/Search/Results?q=07187&amp;page=1</a></p>\n\n<pre><code>Sub NSCM()\n\nDim ie As Object\n\nSet ie = CreateObject(\"INTERNETEXPLORER.APPLICATION\")\n\n'Retrieve CAGE Code\nDim CAGE As String\nCAGE = Range(\"B2\").Value\n\n\n'Navigate to Cage Code general Page\nie.navigate CAGE\n\nie.Visible = True\n\nWhile ie.Busy\n\n    DoEvents\n\nWend\n\n\n'Follow link to details page\nFor Each ele In ie.document.getElementsByTagName(\"a\")\n    If InStr(ele.innerText, \"Details\") &gt; 0 Then ele.Click\nNext\n\nDo While ie.Busy Or _\n    ie.readyState &lt;&gt; 4\n    DoEvents\n    Loop\n\n'Pull Data\n\nDim count As Long\nDim erow As Long\n\nSet HTML = ie.document\n\nSet elements = HTML.getElementsByID(\u201cdetail_topsection\u201d)\n\ncount = 0\nFor Each element In elements\n    If element.className = \u201cresult\u201d Then\n        enter code hereerow = Sheet1.Cells(Rows.count, 1).End(xlUp).Offset(1, 0).Row\n        Cells(erow, 1) = HTML.getElementsByTagName(\u201cspan\u201d)(10).innerText\n        Center code hereells(erow, 1) = HTML.getElementsByTagName(\u201cspan\u201d)(14).innerText\n        count = count + 1\n    End If\nNext element\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1572987154, "post_id": 58718924, "comment_id": 103731457, "body": "Instead of adding a new worksheet, just copy the previous days one?"}, {"owner": {"reputation": 23, "user_id": 12328410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/037965cffd35c718d57a0388ea43e010?s=128&d=identicon&r=PG&f=1", "display_name": "Divest", "link": "https://stackoverflow.com/users/12328410/divest"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1572993622, "post_id": 58718924, "comment_id": 103733829, "body": "Yes, that&#39;s correct. I want it to duplicate the previous days&#39; tab and retitle it with the current days date."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1572996560, "post_id": 58718924, "comment_id": 103734620, "body": "Just use <code>Worksheet.Copy</code> then, like <a href=\"https://stackoverflow.com/questions/8439657/copy-an-entire-worksheet-to-a-new-worksheet-in-excel-2010\">this question</a> shows."}], "answers": [{"tags": [], "owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "is_accepted": true, "score": 1, "last_activity_date": 1572996841, "creation_date": 1572996841, "answer_id": 58721013, "question_id": 58718924, "link": "https://stackoverflow.com/questions/58718924/duplicating-a-worksheet/58721013#58721013", "title": "Duplicating a worksheet", "body": "<pre><code>Sub AddDayWkst()\n\n    Dim ws As Worksheet\n    Dim strNewName As String, strOldName As String\n    Dim bValid As Boolean\n\n    strNewName = Format(Date, \"mm-dd-yy\")\n    strOldName = Format(Date - 1, \"mm-dd-yy\")\n\n    bValid = WorksheetExists(strOldName)\n\n    If bValid Then\n\n        Set ws = Sheets(strOldName)\n        ws.Copy before:=Worksheets(1)\n        Worksheets(1).Name = strNewName\n\n    End If\n\nEnd Sub\n\nFunction WorksheetExists(shtName As String, Optional wb As Workbook) As Boolean\n\n    Dim sht As Worksheet\n\n    If wb Is Nothing Then Set wb = ThisWorkbook\n\n    On Error Resume Next\n\n    Set sht = wb.Sheets(shtName)\n    On Error GoTo 0\n\n    WorksheetExists = Not sht Is Nothing\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 12328410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/037965cffd35c718d57a0388ea43e010?s=128&d=identicon&r=PG&f=1", "display_name": "Divest", "link": "https://stackoverflow.com/users/12328410/divest"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 58721013, "answer_count": 1, "score": 2, "last_activity_date": 1576218546, "creation_date": 1572985456, "last_edit_date": 1576218546, "question_id": 58718924, "link": "https://stackoverflow.com/questions/58718924/duplicating-a-worksheet", "title": "Duplicating a worksheet", "body": "<p>I'm trying to set up a spreadsheet that duplicates the previous worksheet into a new tab daily.</p>\n\n<p>I have it set up to create a new worksheet and rename it daily, but I can't figure out the duplication aspect.</p>\n\n<pre><code>Sub AddDayWkst()\nDim ws As Worksheet\nDim strName As String\nDim bCheck As Boolean\n\nOn Error Resume Next\nstrName = Format(Date, \"mm-dd-yy\")\nbCheck = Len(Sheets(strName).Name) &gt; 0\n\nIf bCheck = False Then\n    Set ws = Worksheets.Add(Before:=Sheets(1))\n    ws.Name = strName\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>I need to duplicate the previous day's worksheet and paste it into the new worksheet.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 12293602, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBi_EYO2IE_TXzMyX-LcMOcvN3Xt0ipKqaueiZq0e0=k-s128", "display_name": "icalderon", "link": "https://stackoverflow.com/users/12293602/icalderon"}, "edited": false, "score": 0, "creation_date": 1573055492, "post_id": 58720682, "comment_id": 103758040, "body": "Thank you for the feedback. As per your comment, I have &quot;KitKit&quot; in my Name Manager that refers to the OFFSET function I mentioned. I understand that this &quot;KitKit&quot; is a &#39;Table/Query or Field List&#39; on a different sheet named &quot;Kit_search&quot;. I have tried your suggestion but another error comes up: <code>Run-time error &#39;13&#39; Type Mismatch</code>."}, {"owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "reply_to_user": {"reputation": 43, "user_id": 12293602, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBi_EYO2IE_TXzMyX-LcMOcvN3Xt0ipKqaueiZq0e0=k-s128", "display_name": "icalderon", "link": "https://stackoverflow.com/users/12293602/icalderon"}, "edited": false, "score": 0, "creation_date": 1573057414, "post_id": 58720682, "comment_id": 103759140, "body": "That&#39;s progress. Now you need to make the type you are passing to rowsource match what you declared. Your formula isn&#39;t &quot;A table name, query name, or SQL statement.&quot;, it&#39;s a formula. So &quot;KitKit&quot; needs to be the name of a table, not a named range. Remove that named range. Select the data you want to use and press &quot;CRTL+T&quot; to make a table. Then give the table the name &quot;KitKit&quot;"}, {"owner": {"reputation": 43, "user_id": 12293602, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBi_EYO2IE_TXzMyX-LcMOcvN3Xt0ipKqaueiZq0e0=k-s128", "display_name": "icalderon", "link": "https://stackoverflow.com/users/12293602/icalderon"}, "edited": false, "score": 0, "creation_date": 1573058400, "post_id": 58720682, "comment_id": 103759695, "body": "Is it worth mentioning that I am working with a dynamic range? I&#39;m not sure if this will change how things work. As I search for a kit description in my Kit_database, any kit with matching keywords will be placed in Kit_search where lstKitResult should populate the UserForm."}, {"owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "reply_to_user": {"reputation": 43, "user_id": 12293602, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBi_EYO2IE_TXzMyX-LcMOcvN3Xt0ipKqaueiZq0e0=k-s128", "display_name": "icalderon", "link": "https://stackoverflow.com/users/12293602/icalderon"}, "edited": false, "score": 0, "creation_date": 1573064012, "post_id": 58720682, "comment_id": 103762558, "body": "So the <code>RowSource</code> need to point to the query that provides the list from the DB. Then you can set your type to query, target the query. Boom. No more formulas, no more offset, no more errors."}, {"owner": {"reputation": 43, "user_id": 12293602, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBi_EYO2IE_TXzMyX-LcMOcvN3Xt0ipKqaueiZq0e0=k-s128", "display_name": "icalderon", "link": "https://stackoverflow.com/users/12293602/icalderon"}, "edited": false, "score": 0, "creation_date": 1573066567, "post_id": 58720682, "comment_id": 103763726, "body": "Thank you for your help. I was able to have the RowSource refer to the database table directly and populate my list box. However I still need to search by keyword, any way I can include this in the code?"}, {"owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "reply_to_user": {"reputation": 43, "user_id": 12293602, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBi_EYO2IE_TXzMyX-LcMOcvN3Xt0ipKqaueiZq0e0=k-s128", "display_name": "icalderon", "link": "https://stackoverflow.com/users/12293602/icalderon"}, "edited": false, "score": 0, "creation_date": 1573073779, "post_id": 58720682, "comment_id": 103766716, "body": "Use a query. Build a query in the DB then point your rowsource to the query. You can do all the wizardry you want in SQL."}, {"owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "reply_to_user": {"reputation": 43, "user_id": 12293602, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBi_EYO2IE_TXzMyX-LcMOcvN3Xt0ipKqaueiZq0e0=k-s128", "display_name": "icalderon", "link": "https://stackoverflow.com/users/12293602/icalderon"}, "edited": false, "score": 0, "creation_date": 1573142700, "post_id": 58720682, "comment_id": 103793318, "body": "No, I guess you could build it in Excel with PowerQuery: <a href=\"https://support.office.com/en-us/article/introduction-to-microsoft-power-query-for-excel-6e92e2f4-2079-4e1f-bad5-89f6269cd605\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>"}], "tags": [], "owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "is_accepted": true, "score": 0, "last_activity_date": 1572994508, "creation_date": 1572994508, "answer_id": 58720682, "question_id": 58718342, "link": "https://stackoverflow.com/questions/58718342/how-to-fix-run-time-error-380-could-not-set-the-rowsource-property/58720682#58720682", "title": "How to fix &quot;Run-time error &#39;380&#39;: Could not set the RowSource property.&quot;", "body": "<p>It depends on what \"KitKit\" is. You would need to set the RowSourceType to correctly interpret the value. If you set it to \"Value List\" then the list would contain only \"KitKit\". So I must assume that you are trying to use a Table\\Query or Field List. It sounds like you're saying \"KitKit\" is a named range that points to an offset formula. That would indeed be an error. The result of \"KitKit\" must contain and answer formatted to match the RowSourceType.</p>\n\n<pre><code>lstKitResult.RowSourceType = \"Field List\" \n</code></pre>\n\n<p>From the documentation:</p>\n\n<blockquote>\n  <p>The RowSource property setting depends on the RowSourceType property\n  setting. For this RowSourceType setting   Enter this RowSource setting</p>\n</blockquote>\n\n<pre><code>Table/Query     A table name, query name, or SQL statement.\nValue List      A list of items with semicolons (;) as separators.\nField List      A table name, query name, or SQL statement.\n</code></pre>\n\n<p>Source: <a href=\"https://docs.microsoft.com/en-us/office/vba/api/access.listbox.rowsource\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/api/access.listbox.rowsource</a></p>\n"}], "owner": {"reputation": 43, "user_id": 12293602, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBi_EYO2IE_TXzMyX-LcMOcvN3Xt0ipKqaueiZq0e0=k-s128", "display_name": "icalderon", "link": "https://stackoverflow.com/users/12293602/icalderon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "accepted_answer_id": 58720682, "answer_count": 1, "score": 0, "last_activity_date": 1572994508, "creation_date": 1572982829, "last_edit_date": 1572988133, "question_id": 58718342, "link": "https://stackoverflow.com/questions/58718342/how-to-fix-run-time-error-380-could-not-set-the-rowsource-property", "title": "How to fix &quot;Run-time error &#39;380&#39;: Could not set the RowSource property.&quot;", "body": "<p>I have used the exact same code below for different sheets and it works correctly, but when I edited it for a new set of sheets in the same workbook the Run Time error comes up.</p>\n\n<pre><code>Private Sub cmdSearchKitDesc_Click()\n\nDim RowNum As Long\nDim SearchRow As Long\n\nRowNum = 3\nSearchRow = 3\n\nWorksheets(\"Kit_database\").Activate\n\nDo Until Cells(RowNum, 1).Value = \"\"\n    If InStr(1, Cells(RowNum, 3).Value, txtKitKeyword.Value, vbTextCompare) &gt; 0 Then\n        Worksheets(\"Kit_search\").Cells(SearchRow, 2).Value = Cells(RowNum, 2).Value\n        Worksheets(\"Kit_search\").Cells(SearchRow, 3).Value = Cells(RowNum, 3).Value\n        Worksheets(\"Kit_search\").Cells(SearchRow, 4).Value = Cells(RowNum, 4).Value\n        Worksheets(\"Kit_search\").Cells(SearchRow, 5).Value = Cells(RowNum, 6).Value\n        Worksheets(\"Kit_search\").Cells(SearchRow, 6).Value = Cells(RowNum, 8).Value\n        Worksheets(\"Kit_search\").Cells(SearchRow, 7).Value = Cells(RowNum, 9).Value\n        SearchRow = SearchRow + 1\n    End If\n    RowNum = RowNum + 1\nLoop\nIf SearchRow = 2 Then\n    MsgBox \"No kits were found that match your criteria.\"\n    Exit Sub\nEnd If\n\nlstKitResult.RowSource = \"KitKit\"\n\nEnd Sub\n</code></pre>\n\n<p>I have changed RowNum to 3 to match the column of the sheet (in this case I would like to search the description of a kit) I would like to search and respectively in the string. I have carefully checked that the sheets and OFFSET function that it uses are named correctly. </p>\n\n<p>The list box I would like to populate uses, \n<code>lstKitResult.RowSource = \"KitKit\"</code> where \"KitKit\" uses the following OFFSET formula,\n<code>=OFFSET(Kit_search!$B$3,0,0,COUNTA(Kit_search!$C:$C)-1,6)</code></p>\n\n<p>The \"Kit_database\" sheet holds all the different types of kits I would search from. The \"Kit_search\" sheet is a placeholder for all the results found that match the kit description searched. The OFFSET function pulls data \"Kit_search\" that should be populated with the search results of <code>txtKitKeyword.Value</code></p>\n\n<p>I have tried different column numbers and sheet names to make sure that things match up but the Run Time error always comes up.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "edited": false, "score": 0, "creation_date": 1572987927, "post_id": 58718303, "comment_id": 103731771, "body": "VBA is very US-centric when it comes to dates. I didn&#39;t think AutoFilter was, though. But if your DateDe was a valid date as m/d/yyyy and your DateAte was not, you would get that error setting two dates when you don&#39;t setting one. Can you try it with the same date of 1/1/2019 for both DateDe and DateAte and see if you still get an error?"}, {"owner": {"reputation": 3, "user_id": 12203080, "user_type": "registered", "profile_image": "https://graph.facebook.com/2472238279528672/picture?type=large", "display_name": "Rafael Henrique Couto", "link": "https://stackoverflow.com/users/12203080/rafael-henrique-couto"}, "reply_to_user": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "edited": false, "score": 0, "creation_date": 1573227343, "post_id": 58718303, "comment_id": 103824944, "body": "I tryed to put the same date on both text boxes and got the same error. Do you think the problem is the date format or there is something wrong about my code?"}, {"owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "edited": false, "score": 0, "creation_date": 1573315749, "post_id": 58718303, "comment_id": 103846027, "body": "I don&#39;t see anything wrong with the code. I also didn&#39;t expect the date format to matter, but wanted to eliminate the easy thing first. You say you&#39;re using text boxes? ActiveX I presume. If you use the Change event, it fires with every letter you type. Is it firing when you&#39;ve only typed a partial date? If you change it to the LostFocus event, type your date, then tab out of the textbox do you still get an error?"}, {"owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "edited": false, "score": 0, "creation_date": 1573316020, "post_id": 58718303, "comment_id": 103846097, "body": "I guess the <code>Not IsDate</code> would take care of that. I&#39;ll keep looking."}], "answers": [{"tags": [], "owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "is_accepted": false, "score": 0, "last_activity_date": 1573316928, "creation_date": 1573316928, "answer_id": 58781252, "question_id": 58718303, "link": "https://stackoverflow.com/questions/58718303/problem-with-2-criteria-autofilter-on-vba/58781252#58781252", "title": "Problem with 2 criteria autofilter on VBA", "body": "<p>This is how I tried to recreate the problem</p>\n\n<pre><code>Private Sub TextBox2_Change()\n\n    Dim rng As Range\n\n    Set rng = Range(\"A1:B1\")\n\n    If Me.TextBox2.Text = \"\" And Me.TextBox1.Text = \"\" Then\n        rng.AutoFilter 1\n    End If\n\n    If Not IsDate(Me.TextBox2.Text) Then GoTo subkill\n\n    If Not IsDate(Me.TextBox1.Text) Then\n        rng.AutoFilter 1, \"&gt;=\" &amp; Format(Me.TextBox1.Text, \"m/d/yyyy\")\n    End If\n\n    If IsDate(Me.TextBox2.Text) Then\n        rng.AutoFilter 1, \"&gt;=\" &amp; Format(Me.TextBox1.Text, \"m/d/yyyy\"), xlAnd, \"&lt;=\" &amp; Format(Me.TextBox2.Text, \"m/d/yyyy\")\n    End If\n\nsubkill:\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/AsYqH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AsYqH.png\" alt=\"filtered listobject\"></a></p>\n\n<p>When I moved my range to B1:C6 and change the code to <code>Set rng = Range(\"B1:C1\")</code> it still works. Generally this error means you're filtering on a column that's not in your range, but I don't see that here.</p>\n\n<p>I did read elsewhere that dates <em>must</em> be in US format for autofilter. If that's true, try changing your date format. But if you tried 1/1/2019 in both boxes, that's the same valid date in both formats.</p>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 12203080, "user_type": "registered", "profile_image": "https://graph.facebook.com/2472238279528672/picture?type=large", "display_name": "Rafael Henrique Couto", "link": "https://stackoverflow.com/users/12203080/rafael-henrique-couto"}, "is_accepted": false, "score": 0, "last_activity_date": 1573571942, "creation_date": 1573571942, "answer_id": 58821611, "question_id": 58718303, "link": "https://stackoverflow.com/questions/58718303/problem-with-2-criteria-autofilter-on-vba/58821611#58821611", "title": "Problem with 2 criteria autofilter on VBA", "body": "<p>I've finally found the problem. This code was not written entirely by me, I'm helping a friend on this task and when he sent it to me i didn't wrote my own code. The thing is, in the choosen font for the vba editor the \"1\" and the \"l\" are realy similar lol. The \"xland\" operator was written as \"x1and\". It took me only 10 days to notice this :)\nThanks for the help! </p>\n"}], "owner": {"reputation": 3, "user_id": 12203080, "user_type": "registered", "profile_image": "https://graph.facebook.com/2472238279528672/picture?type=large", "display_name": "Rafael Henrique Couto", "link": "https://stackoverflow.com/users/12203080/rafael-henrique-couto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1573571942, "creation_date": 1572982670, "last_edit_date": 1572985417, "question_id": 58718303, "link": "https://stackoverflow.com/questions/58718303/problem-with-2-criteria-autofilter-on-vba", "title": "Problem with 2 criteria autofilter on VBA", "body": "<p>I<code>m trying to filter the dates in a column using autofilter, but when i must filter between two dates this error shows: \"The autofilter method of the range class has failed\". I</code>m getting the date values from two text boxes in the activesheet.</p>\n\n<p>I`ve alreary tried to dim a listobject and do something like \"listobject.range.autofilter\", but got the same error.</p>\n\n<pre><code>Private Sub DataDe_Change()\n\n'dim var\nDim rng As Range\n\n'set var\nSet rng = Range(\"B2:T2\")\n\n'if both text boxes are empty the filter clears\nIf DataDe.Text = \"\" And DataAte.Text = \"\" Then\n    rng.AutoFilter Field:=1\nEnd If\n\n'if the value of this textbox isn't a date the sub won't do anything\nIf Not IsDate(DataDe.Text) Then GoTo subkill:\n\n'if it is a date then it cheks if the other textbox\n'contains a date and apply an one criteria filter\nIf Not IsDate(DataAte.Text) Then\n    rng.AutoFilter Field:=1, _\n            Criteria1:=\"&gt;=\" &amp; Format(DataDe.Text, \"dd/mm/yyyy\")\nEnd If\n\n'if both are dates apply a two criteria filter\n'and only in this condition the error pops up\nIf IsDate(DataAte.Text) Then\n    rng.AutoFilter Field:=1, _\n            Criteria1:=\"&gt;=\" &amp; Format(DataDe.Text, \"dd/mm/yyyy\"), _\n            Operator:=x1And, _\n            Criteria2:=\"&lt;=\" &amp; Format(DataAte.Text, \"dd/mm/yyyy\")\nEnd If\n\n\nsubkill:\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 952, "user_id": 876685, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/iBW2K.jpg?s=128&g=1", "display_name": "Christopher Townsend", "link": "https://stackoverflow.com/users/876685/christopher-townsend"}, "edited": false, "score": 0, "creation_date": 1572984986, "post_id": 58718261, "comment_id": 103730583, "body": "You should add an explanation of the problem you are having and what you are trying to achieve so we can help you."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 12328255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17d6d91af3f346d1e6a3978c3a02baa5?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan", "link": "https://stackoverflow.com/users/12328255/nathan"}, "is_accepted": false, "score": 0, "last_activity_date": 1572991767, "creation_date": 1572991767, "answer_id": 58720231, "question_id": 58718261, "link": "https://stackoverflow.com/questions/58718261/how-to-display-more-than-one-column-in-a-listbox/58720231#58720231", "title": "How to display more than one column in a listbox?", "body": "<p>My version of Excel automatically set the listbox column number to be 1. So I wrote:</p>\n\n<pre><code>Me.ResultListbox.ColumnCount = 5\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12328255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17d6d91af3f346d1e6a3978c3a02baa5?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan", "link": "https://stackoverflow.com/users/12328255/nathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1580755490, "creation_date": 1572982502, "last_edit_date": 1580755490, "question_id": 58718261, "link": "https://stackoverflow.com/questions/58718261/how-to-display-more-than-one-column-in-a-listbox", "title": "How to display more than one column in a listbox?", "body": "<p>I am trying to create a userform to search for a person in a 10000 entry Excel, using any of the NO, Firstname, lastname, username or email column.</p>\n\n<p>When the listbox displays the data, it only displays the first column, and not any of the other four columns.</p>\n\n<pre><code>Private Sub SearchCommand_Click()\n\nMe.ResultListbox.AddItem\n\nFor a = 1 To 5\n    Me.ResultListbox.List(0, a - 1) = Sheet1.Cells(1, a)\nNext a\n\nMe.ResultListbox.Selected(0) = True\n\nEnd sub\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/sZatD.png\" alt=\"enter image description here\"></p>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1572986320, "post_id": 58718119, "comment_id": 103731138, "body": "Please show full code especially the <code>Connection</code> object. We need to see what API you are using. Also, does that immediate window query work in MS Access if you run in SQL query window? Are you prompted to enter a parameter and if so which one?"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1573021478, "post_id": 58718119, "comment_id": 103740153, "body": "Your immediate window string doesn&#39;t match the VBA provided (it has more parentheses, misses a space). Please share your actual code"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1573025053, "post_id": 58718119, "comment_id": 103741581, "body": "That error typically indicates a missing or misspelled field or table name."}, {"owner": {"reputation": 774, "user_id": 3827115, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/K6s85.jpg?s=128&g=1", "display_name": "Shaves", "link": "https://stackoverflow.com/users/3827115/shaves"}, "edited": false, "score": 0, "creation_date": 1573136099, "post_id": 58718119, "comment_id": 103789440, "body": "@Gustav.....You are correct about the misspelled field name.  The field name should be &quot;ResName&quot; and not &quot;ResNanme&quot;.  Once I corrected that spelling, it worked as I expected it to.  User error = me.....I looked at that until my eyes were blurry.....Thanks again for your help...\u2026.."}], "answers": [{"comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 1, "creation_date": 1572988213, "post_id": 58718801, "comment_id": 103731882, "body": "Assuming <code>Connection</code> represents an ADODB connection (which is likely due to the arguments being used), <code>.Execute</code> can be used to open a recordset. However, the question is lacking a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1572988960, "post_id": 58718801, "comment_id": 103732163, "body": "Okay, revised answer."}], "tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": false, "score": 0, "last_activity_date": 1572988949, "last_edit_date": 1572988949, "creation_date": 1572984948, "answer_id": 58718801, "question_id": 58718119, "link": "https://stackoverflow.com/questions/58718119/using-the-month-function-as-criteria-in-an-access-sql-query/58718801#58718801", "title": "Using the Month function as criteria in an Access SQL query", "body": "<p>I've never used Execute method to open ADO recordset, only Open.</p>\n\n<p>Assuming Connection is a declared and set variable - but it is a reserved word and really should not use as a variable. If code is behind same db pulling data from, could just use CurrentDb with DAO recordset variable and OpenRecordset method. Example that accepts default parameters for optional arguments:</p>\n\n<pre><code>Dim RecSet1 As DAO.Recordset\nSet RecSet1 = CurrentDb.OpenRecordset(vsql)\n</code></pre>\n"}], "owner": {"reputation": 774, "user_id": 3827115, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/K6s85.jpg?s=128&g=1", "display_name": "Shaves", "link": "https://stackoverflow.com/users/3827115/shaves"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1572988949, "creation_date": 1572981913, "last_edit_date": 1572985961, "question_id": 58718119, "link": "https://stackoverflow.com/questions/58718119/using-the-month-function-as-criteria-in-an-access-sql-query", "title": "Using the Month function as criteria in an Access SQL query", "body": "<p>I'm trying to extract data from an Access 2016 database using SQL and VBA.  Below is the code I'm trying to use and every time I run it, I get a \"No value given for one or more parameters\". I've also shown what I see in the immediate window.</p>\n\n<pre><code>vsql = \"SELECT [ResDate],[ResNanme],[ResStart],[ResEnd] FROM [TrainingRoom] where Month([ResDate]) = \" &amp; MonNo\n\nSet RecSet1 = Connection.Execute(vsql, dbrows, adCmdText)\n</code></pre>\n\n<p>Immediate Window:</p>\n\n<pre><code>SELECT [ResDate],[ResNanme],[ResStart],[ResEnd] FROM [TrainingRoom] where(Month([ResDate])) = 11\n</code></pre>\n\n<p>I don't see anything wrong but I'm sure this is user error.  The \"MonNo\" variable is declared as an integer.</p>\n\n<p>Any suggestions would be greatly appreciated.  Thanks for the help.....</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1572981861, "post_id": 58718097, "comment_id": 103729251, "body": "Use <code>Like</code> or regex."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1572982723, "post_id": 58718097, "comment_id": 103729619, "body": "<code>Split</code> by <code>vbLf</code>, then <code>Split</code> by a space character. Then you can just test the <code>Left</code> and <code>Right</code> of your remaining string."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1572982746, "post_id": 58718097, "comment_id": 103729634, "body": "You could also do this with a formula, and a helper column. Do you need a VBA solution?"}, {"owner": {"reputation": 15, "user_id": 12328137, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-i67AotmT74g/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf4UPpgB_muddLzLnDcRwqBlS1liQ/photo.jpg?sz=128", "display_name": "emre y", "link": "https://stackoverflow.com/users/12328137/emre-y"}, "edited": false, "score": 0, "creation_date": 1572983083, "post_id": 58718097, "comment_id": 103729782, "body": "i couldn&#39;t do that, can you do that please"}], "answers": [{"comments": [{"owner": {"reputation": 316, "user_id": 12131488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EVDpB.jpg?s=128&g=1", "display_name": "SmileyFtW", "link": "https://stackoverflow.com/users/12131488/smileyftw"}, "reply_to_user": {"reputation": 15, "user_id": 12328137, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-i67AotmT74g/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf4UPpgB_muddLzLnDcRwqBlS1liQ/photo.jpg?sz=128", "display_name": "emre y", "link": "https://stackoverflow.com/users/12328137/emre-y"}, "edited": false, "score": 0, "creation_date": 1572988188, "post_id": 58719212, "comment_id": 103731874, "body": "What didn&#39;t work? Can you be a bit more specific? Did the <code>Like</code> comparison not work or did the <code>result</code> not work?"}, {"owner": {"reputation": 15, "user_id": 12328137, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-i67AotmT74g/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf4UPpgB_muddLzLnDcRwqBlS1liQ/photo.jpg?sz=128", "display_name": "emre y", "link": "https://stackoverflow.com/users/12328137/emre-y"}, "edited": false, "score": 0, "creation_date": 1572989125, "post_id": 58719212, "comment_id": 103732207, "body": "both didn&#39;t work, when i click button it makes A1 = C:\\ARALIK\\4564131.pdf aral\u0131k ay\u0131 &#246;zet. C:\\OCAK\\754321351351 Private Sub buton_Click()  If Cells(1, &quot;c&quot;).Text Like &quot;C:*.jpg*&quot; Then    Dim jpgStart As Long    jpgStart = InStr(Cells(1, &quot;c&quot;).Text, &quot;.jpg&quot;)    Dim result As String    result = Left(Cells(1, &quot;c&quot;).Text, jpgStart - 1)    Cells(1, &quot;c&quot;).Offset(0, -2).Value = result Else    Cells(1, &quot;c&quot;).Offset(0, -2).Value = vbNullString End If End Sub"}, {"owner": {"reputation": 316, "user_id": 12131488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EVDpB.jpg?s=128&g=1", "display_name": "SmileyFtW", "link": "https://stackoverflow.com/users/12131488/smileyftw"}, "reply_to_user": {"reputation": 15, "user_id": 12328137, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-i67AotmT74g/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf4UPpgB_muddLzLnDcRwqBlS1liQ/photo.jpg?sz=128", "display_name": "emre y", "link": "https://stackoverflow.com/users/12328137/emre-y"}, "edited": false, "score": 0, "creation_date": 1572990071, "post_id": 58719212, "comment_id": 103732585, "body": "Please edit your question above to add the current code you have. We need to see what you&#39;ve done to try to sort out what&#39;s wrong."}, {"owner": {"reputation": 316, "user_id": 12131488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EVDpB.jpg?s=128&g=1", "display_name": "SmileyFtW", "link": "https://stackoverflow.com/users/12131488/smileyftw"}, "reply_to_user": {"reputation": 15, "user_id": 12328137, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-i67AotmT74g/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf4UPpgB_muddLzLnDcRwqBlS1liQ/photo.jpg?sz=128", "display_name": "emre y", "link": "https://stackoverflow.com/users/12328137/emre-y"}, "edited": false, "score": 0, "creation_date": 1572992094, "post_id": 58719212, "comment_id": 103733382, "body": "It&#39;s clear my assumption that you know how to loop your range was incorrect. I&#39;ll make some changes. See my edited code."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1572993956, "post_id": 58719212, "comment_id": 103733912, "body": "The loop range consists of a single merged cell in the input. The input in this range is to be splitted and &quot;fed&quot; to the <code>Like</code> operator."}, {"owner": {"reputation": 316, "user_id": 12131488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EVDpB.jpg?s=128&g=1", "display_name": "SmileyFtW", "link": "https://stackoverflow.com/users/12131488/smileyftw"}, "edited": false, "score": 0, "creation_date": 1573072863, "post_id": 58719212, "comment_id": 103766334, "body": "Merged cells are problematic. Can you do without them by using Center Across Selection format instead?"}], "tags": [], "owner": {"reputation": 316, "user_id": 12131488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EVDpB.jpg?s=128&g=1", "display_name": "SmileyFtW", "link": "https://stackoverflow.com/users/12131488/smileyftw"}, "is_accepted": false, "score": 0, "last_activity_date": 1572992352, "last_edit_date": 1572992352, "creation_date": 1572986667, "answer_id": 58719212, "question_id": 58718097, "link": "https://stackoverflow.com/questions/58718097/split-cell-on-criteria/58719212#58719212", "title": "Split Cell On Criteria", "body": "<p>In your button macro code loop the cells in column c; I have to assume you know how to set that up and do it. Then for each <code>cell</code> in that range:</p>\n\n<pre><code>with thisworkbook.worksheets(\"theNameOfYourSheet\")\n   dim loopRange As Range\n   set loopRange=.Range(.Cells(1,3),.Cells(.UsedRange.Rows.Count,3))\nend with\ndim cell as Range\n\nfor each cell in loopRange\n    If cell.text Like \"C:*.jpg*\" Then\n       Dim jpgStart As Long\n       jpgStart = Instr(cell.text,\".jpg\")\n       Dim result As String\n       result= Left(cell.text,jpgStart-1)\n       cell.offset(0,-1).Value=result\n    Else\n       cell.offset(0,-1).Value = vbNullString\n    End If\nNext\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": false, "score": 0, "last_activity_date": 1572993626, "creation_date": 1572993626, "answer_id": 58720551, "question_id": 58718097, "link": "https://stackoverflow.com/questions/58718097/split-cell-on-criteria/58720551#58720551", "title": "Split Cell On Criteria", "body": "<ul>\n<li><p>Split by <code>vbLf</code></p></li>\n<li><p>Split by a blank space character</p></li>\n<li><p>Test against your result</p></li>\n</ul>\n\n<p>Code:</p>\n\n<pre><code>Option Explicit\nSub GetOcak()\n\n    Dim arr As Variant\n\n    arr = Split(Cells(1, 3).Value, vbLf)\n\n    Dim i As Long\n    Dim j As Long\n\n    j = 1\n\n    For i = 0 To UBound(arr)\n        If Left(Split(arr(i), \" \")(0), 7) = \"C:\\OCAK\" And _\n           Right(Split(arr(i), \" \")(0), 4) = \".jpg\" Then\n            Cells(j, 1).Value = Split(arr(i), \" \")(0)\n            j = j + 1\n        End If\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 12328137, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-i67AotmT74g/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf4UPpgB_muddLzLnDcRwqBlS1liQ/photo.jpg?sz=128", "display_name": "emre y", "link": "https://stackoverflow.com/users/12328137/emre-y"}, "edited": false, "score": 1, "creation_date": 1572995244, "post_id": 58720599, "comment_id": 103734290, "body": "perfect! thanks a lot, is there a way doing this for a web page source code to get links"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 15, "user_id": 12328137, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-i67AotmT74g/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf4UPpgB_muddLzLnDcRwqBlS1liQ/photo.jpg?sz=128", "display_name": "emre y", "link": "https://stackoverflow.com/users/12328137/emre-y"}, "edited": false, "score": 0, "creation_date": 1572995895, "post_id": 58720599, "comment_id": 103734462, "body": "@emrey - you are welcome. Well, take a look at the <a href=\"https://stackoverflow.com/search?tab=votes&amp;q=vba%20scrape%20website\">different scraping examples here</a>. But in general, VBA is not the best scraping solution. Look for python and the beautiful soup library."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1572993894, "creation_date": 1572993894, "answer_id": 58720599, "question_id": 58718097, "link": "https://stackoverflow.com/questions/58718097/split-cell-on-criteria/58720599#58720599", "title": "Split Cell On Criteria", "body": "<p>The problem is in the splitting actually. In the input, the new line should be used as a delimiter as well. Thus, consider changing the input a bit to something like this:</p>\n\n<pre><code>readCell = Worksheets(1).Cells(1, \"C\")\n\nreadCell = Replace(readCell, Chr(13) &amp; Chr(10), \" \")\nreadCell = Replace(readCell, vbCrLf, \" \")\nreadCell = Replace(readCell, vbNewLine, \" \")\nreadCell = Replace(readCell, vbLf, \" \")\n</code></pre>\n\n<p>Once the input is fixed an array can be built of the units - <code>myArray = Split(readCell)</code>. Looping through the array and using <code>Like \"C:*OCAK*.jpg\"</code> works quite well:</p>\n\n<pre><code>Public Sub TestMe()\n\n    Dim readCell As String\n    readCell = Worksheets(1).Cells(1, \"C\")\n\n    readCell = Replace(readCell, Chr(13) &amp; Chr(10), \" \")\n    readCell = Replace(readCell, vbCrLf, \" \")\n    readCell = Replace(readCell, vbNewLine, \" \")\n    readCell = Replace(readCell, vbLf, \" \")\n\n    Dim myArray As Variant\n    myArray = Split(readCell)\n\n    Dim myVar As Variant\n    Dim currentRow As Long: currentRow = 1\n\n    For Each myVar In myArray\n        If myVar Like \"C:*OCAK*.jpg\" Then\n            Worksheets(1).Cells(currentRow, \"A\") = myVar\n            currentRow = currentRow + 1\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/g4uhO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/g4uhO.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 15, "user_id": 12328137, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-i67AotmT74g/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf4UPpgB_muddLzLnDcRwqBlS1liQ/photo.jpg?sz=128", "display_name": "emre y", "link": "https://stackoverflow.com/users/12328137/emre-y"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 1, "accepted_answer_id": 58720599, "answer_count": 3, "score": 0, "last_activity_date": 1572993894, "creation_date": 1572981782, "last_edit_date": 1572990397, "question_id": 58718097, "link": "https://stackoverflow.com/questions/58718097/split-cell-on-criteria", "title": "Split Cell On Criteria", "body": "<p>I have a complicated split I need to do in VBA excel. I want to split each piece that starts \"C:\", includes \"OCAK\" and ends \".JPG\" in range(\"C1\") into A1,A2,A3... when click the button.</p>\n\n<p>FROM THIS\n<a href=\"https://i.stack.imgur.com/1y55R.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1y55R.png\" alt=\"enter image description here\"></a></p>\n\n<p>TO THIS\n<a href=\"https://i.stack.imgur.com/KjvLe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KjvLe.png\" alt=\"enter image description here\"></a></p>\n\n<p>I'm still doing research and testing, but I can't find a real viable solution. Any ideas would be greatly appreciated.</p>\n\n<pre><code>Private Sub buton_Click()\n\nIf Cells(1, \"c\").Text Like \"C:*OCAK*.jpg*\" Then\n   Dim jpgStart As Long\n   jpgStart = InStr(Cells(1, \"c\").Text, \".jpg\")\n   Dim result As String\n   result = Left(Cells(1, \"c\").Text, jpgStart - 1)\n   Cells(1, \"c\").Offset(0, -2).Value = result\nElse\n   Cells(1, \"c\").Offset(0, -2).Value = vbNullString\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql-server", "vba", "ms-access"], "comments": [{"owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "edited": false, "score": 3, "creation_date": 1572982249, "post_id": 58718091, "comment_id": 103729404, "body": "You&#39;ll need to reference <code>Microsoft ActiveX Data Objects x.x Library</code>.  And yes, paste the relevant code into your question."}, {"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 1, "creation_date": 1572983166, "post_id": 58718091, "comment_id": 103729808, "body": "Pictures of code are nearly worthless. <a href=\"https://meta.stackoverflow.com/questions/285551/why-not-upload-images-of-code-on-so-when-asking-a-question/285557#285557\">Why?</a> But for me the bigger concern is using global temp tables. Global temp tables are highly problematic with concurrency. If you have even two people using this code at the same time your temp tables are going to walk all over each other. And then your code pattern is highly problematic as well because you are not parameterizing your queries. <a href=\"http://bobby-tables.com/\" rel=\"nofollow noreferrer\">Bobby tables</a> loves this kind of code, you need to fix that."}], "owner": {"reputation": 45, "user_id": 4475210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6a4e697efeffa6af94c27a4baa106c6?s=128&d=identicon&r=PG&f=1", "display_name": "Comicwizard", "link": "https://stackoverflow.com/users/4475210/comicwizard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1572986036, "creation_date": 1572981762, "last_edit_date": 1572986036, "question_id": 58718091, "link": "https://stackoverflow.com/questions/58718091/sql-server-connection-through-access-vba", "title": "SQL Server connection through access VBA", "body": "<p>History of issue. A colleague built an access database and using VBA made a connection to SQL Server. Then running VBA code made a global temp table ##tablename. this information is used in a passthrough query in the database.</p>\n\n<p>I had to build a new database that uses the same logic. I have everything working except that first part. I am missing something in my code and I am not using code correctly to make that SQL Server connection and run my create global table. </p>\n\n<p>I am not too familiar with this part of coding. I am going to need some hand holding here.  I am getting errors no matter what I try.</p>\n\n<p><img src=\"https://i.stack.imgur.com/cRNpC.png\" alt=\"enter image description here\"></p>\n"}]