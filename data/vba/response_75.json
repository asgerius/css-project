[{"tags": ["ms-access", "macros", "vba", "ms-access-2010"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 6437584, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/404e3cb5914ddf26a0517d1b3bfd1bf2?s=128&d=identicon&r=PG&f=1", "display_name": "Ragnar12", "link": "https://stackoverflow.com/users/6437584/ragnar12"}, "edited": false, "score": 0, "creation_date": 1466087422, "post_id": 37848126, "comment_id": 63181477, "body": "It&#39;s giving me a 424 run time error, on line <code>Set wb = Workbooks.Open(path &amp; strFile)</code>"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 23, "user_id": 6437584, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/404e3cb5914ddf26a0517d1b3bfd1bf2?s=128&d=identicon&r=PG&f=1", "display_name": "Ragnar12", "link": "https://stackoverflow.com/users/6437584/ragnar12"}, "edited": false, "score": 0, "creation_date": 1466103417, "post_id": 37848126, "comment_id": 63191509, "body": "Indeed, I conflated Access and Excel VBA. When calling an external app you must qualify all objects. See edit using the <code>objXL</code> object."}, {"owner": {"reputation": 23, "user_id": 6437584, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/404e3cb5914ddf26a0517d1b3bfd1bf2?s=128&d=identicon&r=PG&f=1", "display_name": "Ragnar12", "link": "https://stackoverflow.com/users/6437584/ragnar12"}, "edited": false, "score": 0, "creation_date": 1466106347, "post_id": 37848126, "comment_id": 63193025, "body": "Still no go, however it makes it back to the <code>strF1Data = !ref_val</code> code again. Giving the same error 94 as before."}, {"owner": {"reputation": 23, "user_id": 6437584, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/404e3cb5914ddf26a0517d1b3bfd1bf2?s=128&d=identicon&r=PG&f=1", "display_name": "Ragnar12", "link": "https://stackoverflow.com/users/6437584/ragnar12"}, "edited": false, "score": 0, "creation_date": 1466106579, "post_id": 37848126, "comment_id": 63193141, "body": "I modified the <code>wb.Sheets(1).Range(&quot;A1&quot;)</code> bit of code to be sheets(day1).Range(&quot;A1&quot;)...I tried both ways"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 23, "user_id": 6437584, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/404e3cb5914ddf26a0517d1b3bfd1bf2?s=128&d=identicon&r=PG&f=1", "display_name": "Ragnar12", "link": "https://stackoverflow.com/users/6437584/ragnar12"}, "edited": false, "score": 0, "creation_date": 1466106904, "post_id": 37848126, "comment_id": 63193337, "body": "There must be another issue with the workbooks other than <i>No Data</i> and empty cells. Do this, inside the later Do/Until loop, add at top <code>debug.Print !ref_val</code>. Re-run code and when it errors out, check the Immediate Window of VBA&#39;s IDE and see what the last file printed. That is the problem child. Open it and verify why it is erring out."}, {"owner": {"reputation": 23, "user_id": 6437584, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/404e3cb5914ddf26a0517d1b3bfd1bf2?s=128&d=identicon&r=PG&f=1", "display_name": "Ragnar12", "link": "https://stackoverflow.com/users/6437584/ragnar12"}, "edited": false, "score": 0, "creation_date": 1466108116, "post_id": 37848126, "comment_id": 63193931, "body": "hmmm.....that was a good call. It doesn&#39;t seem to be stopping on the file that I thought. Although it doesn&#39;t make sense why I&#39;m getting a Null error on this file. There are no apparent blanks. Any ideas now that you killed my first hypothesis?"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 23, "user_id": 6437584, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/404e3cb5914ddf26a0517d1b3bfd1bf2?s=128&d=identicon&r=PG&f=1", "display_name": "Ragnar12", "link": "https://stackoverflow.com/users/6437584/ragnar12"}, "edited": false, "score": 0, "creation_date": 1466111877, "post_id": 37848126, "comment_id": 63195872, "body": "Is it the first file? Does it have only one record? Look carefully at structure of the files that processed correctly before it and try to assess why. You posted no data, so I cannot know from this end."}, {"owner": {"reputation": 23, "user_id": 6437584, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/404e3cb5914ddf26a0517d1b3bfd1bf2?s=128&d=identicon&r=PG&f=1", "display_name": "Ragnar12", "link": "https://stackoverflow.com/users/6437584/ragnar12"}, "edited": false, "score": 0, "creation_date": 1466114660, "post_id": 37848126, "comment_id": 63196967, "body": "It is not the first file, the files look nearly identical...the number of lines vary, but I can find examples that went through with less and went through with more. The number of characters in each field slightly varies, but again I can find those that match and those that have less. I added to me original post the file examples, if you can derive anything from that information. Or if it can lead you to anything else I might need to check. I appreciate all your help thus far!"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 23, "user_id": 6437584, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/404e3cb5914ddf26a0517d1b3bfd1bf2?s=128&d=identicon&r=PG&f=1", "display_name": "Ragnar12", "link": "https://stackoverflow.com/users/6437584/ragnar12"}, "edited": false, "score": 0, "creation_date": 1466205089, "post_id": 37848126, "comment_id": 63237621, "body": "In your <i>SQL_UPDATE_DATA</i> VBA string, try wrapping the refval with <code>Nz(refval, &quot;&quot;)</code> in select statement (not in recordset loop). Somewhere there is a null value in Stage table and since you have abbreviated with asterisk, *, you need to rewrite columns explicitly. Of course with expression you need a new column alias."}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 0, "last_activity_date": 1466103334, "last_edit_date": 1466103334, "creation_date": 1466038165, "answer_id": 37848126, "question_id": 37847704, "link": "https://stackoverflow.com/questions/37847704/vba-access-files-with-nulls/37848126#37848126", "title": "VBA Access: Files with Nulls", "body": "<p>No need to touch the staging table functions. Simply conditionally populate the <code>strFileList</code> array depending if Excel workbooks' first sheet contains <em>No Data</em> or empty cell. Recall Access VBA has complete access to all Excel objects via COM interface or Excel VBA reference and so can iteratively open workbooks. Hence, adjust your While/Wend loop accordingly:</p>\n\n<pre><code>Sub Pull_File_into_Staging_Table()\n\n   '...same code...\n\n   Dim objXL As Object\n   Dim wb As Object\n\n   Set objXL = CreateObject(\"Excel.Application\")\n\n   strfile = Dir(Path &amp; \"*.xls\")\n   While strfile &lt;&gt; \"\"\n\n       Set wb = objXL.Workbooks.Open(Path &amp; strfile)\n\n       If wb.Sheets(1).Range(\"A1\") &lt;&gt; \"No Data\" AND  wb.Sheets(1).Range(\"A1\") &lt;&gt; \"\" Then\n           'add files to the list\n           intFile = intFile + 1\n           ReDim Preserve strFileList(1 To intFile)\n           strFileList(intFile) = strfile\n       End If\n       strfile = Dir()\n\n       wb.Close False\n       Set wb = Nothing\n   Wend\n'...\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 6437584, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/404e3cb5914ddf26a0517d1b3bfd1bf2?s=128&d=identicon&r=PG&f=1", "display_name": "Ragnar12", "link": "https://stackoverflow.com/users/6437584/ragnar12"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 136, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1466114449, "creation_date": 1466035133, "last_edit_date": 1466114449, "question_id": 37847704, "link": "https://stackoverflow.com/questions/37847704/vba-access-files-with-nulls", "title": "VBA Access: Files with Nulls", "body": "<p><strong>Overall Goal:</strong>\nPull all files from folder > format files in staging table > copy staging table to master table > kill staging table > rinse and repeat until all files have been taken from folder, formatted and put into the master table.</p>\n\n<p><strong>Issue:</strong>\nI have apparently not taken into account that some of the files sent to me will have blank worksheets (rather they may have a value that says \"No Data\" in cell A1). When my macro hits the \"No Data\" or blank sheet I get a Null error (94).</p>\n\n<p><strong>What I've tried:</strong></p>\n\n<ul>\n<li>strF1Data = Nz(!ref_val)</li>\n<li>strF1Data = Nz(!ref_val,\"\")</li>\n</ul>\n\n<p><strong>Suspicions:</strong>\nI think I can update the SQL UPDATE line to allow Nulls, but I feel like a more efficient solution would be to skip if null. However I have tried modifying the Do Until statement and had no luck... </p>\n\n<p><strong>Possibly Worth Mentioning:</strong>\nThe files have multiple worksheets. I learned this the hard way in finding this error on a random worksheet between several other worksheets that did have data.</p>\n\n<p><strong>Code:</strong> (to help save some space, I'm only giving the call files bit and formatting piece, I don't think the other pieces will be of any use. However if you would like them then let me know.)</p>\n\n<p><strong>The overall macro (see next code sections for piece with error):</strong></p>\n\n<pre><code>Sub Pull_File_into_Staging_Table()\n'Process:\n    '1 - Loop through all files saved to specified folder making an internal list of the files\n    '2 - Paste one files content to staging table at a time\n    '3 - Format the information in the staging table\n    '4 - Copy formatted staging table to 1Compare Table (master table)\n\nDim strFile As String 'Filename\nDim strFileList() As String 'File Array\nDim intFile As Integer 'File Number\nDim filename As String\nDim path As String\nDoCmd.SetWarnings False\npath = \"C:\\Users\\USER\\Desktop\\Test\\\"\nDim rs As DAO.Recordset ' Moved from below\nDim db As DAO.Database\nSet db = CurrentDb\n\n'Loop through the folder &amp; build file list\nstrFile = Dir(path &amp; \"*.xls\")\nWhile strFile &lt;&gt; \"\"\n'add files to the list\nintFile = intFile + 1\nReDim Preserve strFileList(1 To intFile)\nstrFileList(intFile) = strFile\nstrFile = Dir()\nWend\n\n'see if any files were found\nIf intFile = 0 Then\nMsgBox \"No files found\"\nExit Sub\nEnd If\n\n'cycle through the list of files\nFor intFile = 1 To UBound(strFileList)\nfilename = path &amp; strFileList(intFile)\nDoCmd.TransferSpreadsheet acImport, acSpreadsheetTypeExcel8, \"Stage\", filename, False\n\nCall Format_Staging_Table\nCall Copy_from_Stage_to_Master\nCall Clear_Staging_Table\n\nNext intFile\nDoCmd.SetWarnings True\nEnd Sub\n</code></pre>\n\n<p><strong>The piece with the issue:</strong></p>\n\n<pre><code>Sub Format_Staging_Table()\n\nDim strFile As String 'Filename\nDim strFileList() As String 'File Array\nDim intFile As Integer 'File Number\nDim filename As String\nDim path As String\nDoCmd.SetWarnings False\npath = \"C:\\Users\\USER\\Desktop\\Test\\\"\nDim rs As DAO.Recordset ' Moved from below\nDim db As DAO.Database\nSet db = CurrentDb\n\nCurrentDb.Execute (\"ALTER TABLE Stage ADD COLUMN UPC Text, SR_Profit_Center Text, SR_Super_Label Text, SAP_Profit_Center Text, SAP_Super_Label Text;\")\n\nCurrentDb.TableDefs(\"Stage\").Fields(\"F1\").Name = \"ref_val\"\n\n\nDim ref_val As String\nSet rs = db.OpenRecordset(\"SELECT TOP 1 ref_val FROM Stage;\", dbOpenDynaset)\nref_val = rs.Fields(0).Value\nrs.Close\n\ndb.Execute \"DELETE FROM [Stage] WHERE ref_val = '\" &amp; ref_val &amp; \"';\"\n\nConst YOUR_TABLE_NAME   As String = \"Stage\"\nDim SQL_UPDATE_DATA   As String\nSQL_UPDATE_DATA = \"SELECT *, ';' &amp; '\" &amp; ref_val &amp; \"' FROM [\" &amp; YOUR_TABLE_NAME &amp; \"] WHERE SR_Profit_Center Is Null\"\n\nDim strF1Data   As String\nDim varData     As Variant\n\nSet rs = CurrentDb.OpenRecordset(SQL_UPDATE_DATA)\nWith rs\n    Do Until .EOF\n        strF1Data = !ref_val\n        varData = Split(strF1Data, \";\")\n        If UBound(varData) = 4 Then\n            .Edit\n            !ref_val = ref_val\n            !UPC = varData(0)\n            !SR_Profit_Center = varData(1)\n            !SR_Super_Label = varData(2)\n            !SAP_Profit_Center = varData(3)\n            !SAP_Super_Label = varData(4)\n            .Update\n        End If\n        .MoveNext\n    Loop\n    .Close\nEnd With\n\nSet rs = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Also I'm aware of the extra variable pieces, I will clean it up once I get it working. </p>\n\n<p><strong>File Examples:</strong></p>\n\n<p><strong>Working File:</strong></p>\n\n<ol>\n<li>CE16041901</li>\n<li>00791558441123;US1K100017;CGR;US1K100001;UNKNOW</li>\n<li>00791558442328;US1K100017;CGR;US1K100001;UNKNOW</li>\n<li>00791558440720;US1K100017;CGR;US1K100001;UNKNOW</li>\n<li>00791558444629;US1K100017;CGR;US1K100001;UNKNOW</li>\n<li>00791558440522;US1K100017;CGR;US1K100001;UNKNOW</li>\n<li>00791558443325;US1K100017;CGR;US1K100001;UNKNOW</li>\n</ol>\n\n<p><strong>Not Working File:</strong></p>\n\n<ol>\n<li>CE16042001 </li>\n<li>00791558334128;US1K100017;CGR;US1K100001;UNKNOW</li>\n<li>00791558159523;US1K100017;CGR;US1K100001;UNKNOW</li>\n<li>00602547736604;US1A100018;UR;US1A100018;US-RU</li>\n</ol>\n\n<p>I appreciate any help. I ran with this as far as I could, but I am still very much a novice when it comes to access and vb. If you need more information or clarification please let me know and I'll do my best to provide/explain.</p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 2843, "user_id": 2958401, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a5dd8c841e767e09bd8c08764dc2319e?s=128&d=identicon&r=PG&f=1", "display_name": "gtwebb", "link": "https://stackoverflow.com/users/2958401/gtwebb"}, "edited": false, "score": 0, "creation_date": 1466033954, "post_id": 37847477, "comment_id": 63154961, "body": "Code works fine for me.  Can you crash it while stepping through the code? or only when running straight through.  Is there any error handling?"}, {"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 4, "creation_date": 1466034689, "post_id": 37847477, "comment_id": 63155153, "body": "I would use <code>Workbooks.Open(SourceWkbPath)</code> instead."}, {"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 0, "creation_date": 1466039248, "post_id": 37847477, "comment_id": 63156103, "body": "Good suggestion from Doug. Work with the book directly"}, {"owner": {"reputation": 21, "user_id": 6471869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c59fca6840317789f5ab7f76cedd238?s=128&d=identicon&r=PG&f=1", "display_name": "JGL", "link": "https://stackoverflow.com/users/6471869/jgl"}, "edited": false, "score": 0, "creation_date": 1466082376, "post_id": 37847477, "comment_id": 63177400, "body": "Indeed, code works fine when executed directly in the workbook it resides. But when executed from another workbook (triggered via keyboard shortcut), it will barely work 1 time out of 20... either by stepping or running straight.  I tried Workbooks.Open already, but it didn&#39;t seem to get any better. Will try again. Thanks !"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 6471869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c59fca6840317789f5ab7f76cedd238?s=128&d=identicon&r=PG&f=1", "display_name": "JGL", "link": "https://stackoverflow.com/users/6471869/jgl"}, "edited": false, "score": 0, "creation_date": 1466082038, "post_id": 37851447, "comment_id": 63177105, "body": "Thank you for this detailed answer. Am I wrong to say that using &quot;ThisWorkbook&quot; is not going to work properly as code is executed from workbook A in workbook B ? As I want to store workbook b in DestWkb, isn&#39;t Thisworkbook going to store the workbook the macro is in instead (in this case, workbook A ?)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 21, "user_id": 6471869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c59fca6840317789f5ab7f76cedd238?s=128&d=identicon&r=PG&f=1", "display_name": "JGL", "link": "https://stackoverflow.com/users/6471869/jgl"}, "edited": false, "score": 0, "creation_date": 1466082938, "post_id": 37851447, "comment_id": 63177845, "body": "ThisWorkBook will always be the workbook that that initiated the code. It&#39;s immutable.  But I&#39;ll double check..lol"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1466085957, "last_edit_date": 1466085957, "creation_date": 1466058544, "answer_id": 37851447, "question_id": 37847477, "link": "https://stackoverflow.com/questions/37847477/using-getobject-to-edit-other-workbooks-works-1-time-out-of-x/37851447#37851447", "title": "Using GetObject to edit other workbooks works 1 time out of x", "body": "<p>GetObject is used Set reference to an External Application that is already Open.  In the same way CreateObject is used Set a Create a new External Application.</p>\n\n<ul>\n<li>Added a check to see if a WorkBook of the same name is open.</li>\n<li>Remove Set DestWkb = ActiveWorkbook</li>\n<li>Use ThisworkBook instead</li>\n<li>Added funny message so you know it worked.</li>\n</ul>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>    Dim fd As FileDialog\r\n    Dim ffs As FileDialogFilters\r\n    Dim SourceWkb As Workbook\r\n    Dim SourceWkbPath As String\r\n    Dim SourceWkbShortName As String\r\n    'Prompt user for source workbook (this will be workbook \"C\")\r\n    Set fd = Application.FileDialog(msoFileDialogFilePicker)\r\n    With fd\r\n        Set ffs = .Filters\r\n        With ffs\r\n            .Clear\r\n            .Add \"Excel\", \"*.xlsx\"\r\n        End With\r\n        .AllowMultiSelect = False\r\n        .Show\r\n        SourceWkbPath = fd.SelectedItems(1)\r\n        SourceWkbShortName = Mid(SourceWkbPath, InStrRev(SourceWkbPath, \"\\\") + 1)\r\n    End With\r\n\r\n    On Error Resume Next\r\n    \r\n    Set SourceWkb = Workbooks(SourceWkbShortName)\r\n    If Err.Number &lt;&gt; 0 Then\r\n        Set SourceWkb = Workbooks.Open(SourceWkbPath)\r\n    End If\r\n    On Error GoTo 0\r\n    \r\n    MsgBox \"\"\"Hello World!\"\"\", vbInformation, SourceWkb.Name &amp; \" Says:\"</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>MSDN Says: ThisWorkbook always returns the workbook in which the code is running.</p>\n\n<p>The question is: \"If WorkBook A runs a Macro in Workbook B what does ThisWorkBook refer to? <br></p>\n\n<p><strong>WorkBook A</strong></p>\n\n<pre><code>Sub RunExternalCode()\n   WorkBookAName= ThisWorkBook.Name\n\n   WorkBookBName = Application.Run \"\"\n\nEnd Sub\n</code></pre>\n\n<blockquote>\n  <p>WorkBook B</p>\n</blockquote>\n\n<pre><code>Function GetThisWorkBooksName()\n    GetThisWorkBooksName = ThisworkBook.Name\nEnd Function\n</code></pre>\n\n<p>Result:</p>\n\n<blockquote>\n  <p>WorkBookAName = \"WorkBookA\"</p>\n  \n  <p>WorkBookBName = \"WorkBookB\"</p>\n</blockquote>\n"}], "owner": {"reputation": 21, "user_id": 6471869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c59fca6840317789f5ab7f76cedd238?s=128&d=identicon&r=PG&f=1", "display_name": "JGL", "link": "https://stackoverflow.com/users/6471869/jgl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1466085957, "creation_date": 1466033419, "question_id": 37847477, "link": "https://stackoverflow.com/questions/37847477/using-getobject-to-edit-other-workbooks-works-1-time-out-of-x", "title": "Using GetObject to edit other workbooks works 1 time out of x", "body": "<p>First, I am a begginer. Any advice is welcome ! Just trying to code at work to save time later managing 100s of files. </p>\n\n<p>I am building an Excel macro and, just as many other users, I am trying to do the following :</p>\n\n<ul>\n<li>Have the macro \"reside\" in a workbook \"A\".</li>\n<li>Trigger the macro using keyboard shortcut from a workbook \"B\" </li>\n<li>Have the macro do its magic in workbook \"B\" (which includes copying a sheet from a workbook \"C\")</li>\n</ul>\n\n<p>This involves, at some point, prompting the user for workbook \"C\", defining a variable and putting workbook C in it.</p>\n\n<p>The following code is a part of the macro and works only one time out of x and apparently \"crashes\" without warning or error code or even letting me know it has crashed.</p>\n\n<pre><code>'All the following code is in workbook \"A\"\n\nDim fd As FileDialog\nDim ffs As FileDialogFilters\nDim DestWkb As Workbook\nDim SourceWkb As Workbook\nDim SourceWkbPath As String\n\n'Set active workbook as destination workbook (this is workbook \"B\")\nSet DestWkb = ActiveWorkbook\n\n'Prompt user for source workbook (this will be workbook \"C\")\nSet fd = Application.FileDialog(msoFileDialogFilePicker)\nWith fd\n    Set ffs = .Filters\n    With ffs\n        .Clear\n        .Add \"Excel\", \"*.xlsx\"\n    End With\n    .AllowMultiSelect = False\n    If .Show = False Then Exit Sub\n    SourceWkbPath = fd.SelectedItems(1)\nEnd With\n\n'Here is where it starts to go wrong..\n'This message box will show up with correct data in it :\n\nMsgBox SourceWkbPath\n\n'This line seems to work, as I can see in VB the workbook specified by the user\nSet SourceWkb = GetObject(SourceWkbPath)\n\n'From here... it's like there was an Exit Sub. I will rarely see the following msgbox : \n\nMsgBox \"Success\"\n</code></pre>\n\n<p>Anybody already faced such a trouble ? Thank you very much!</p>\n"}, {"tags": ["vba", "range", "conditional-statements", "legend", "pie-chart"], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 1710787, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6b5ffc4b72efe3da9a133af7744b445f?s=128&d=identicon&r=PG", "display_name": "Tom&#225;s Ayala", "link": "https://stackoverflow.com/users/1710787/tom%c3%a1s-ayala"}, "edited": false, "score": 0, "creation_date": 1466376706, "post_id": 37911989, "comment_id": 63277084, "body": "Genius !! Many Thanks !"}, {"owner": {"reputation": 2547, "user_id": 2326824, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fveXJ.jpg?s=128&g=1", "display_name": "Jim Simson", "link": "https://stackoverflow.com/users/2326824/jim-simson"}, "reply_to_user": {"reputation": 107, "user_id": 1710787, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6b5ffc4b72efe3da9a133af7744b445f?s=128&d=identicon&r=PG", "display_name": "Tom&#225;s Ayala", "link": "https://stackoverflow.com/users/1710787/tom%c3%a1s-ayala"}, "edited": false, "score": 0, "creation_date": 1466390378, "post_id": 37911989, "comment_id": 63279410, "body": "Glad to hear it Tomas! Good luck with the rest of your project."}], "tags": [], "owner": {"reputation": 2547, "user_id": 2326824, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fveXJ.jpg?s=128&g=1", "display_name": "Jim Simson", "link": "https://stackoverflow.com/users/2326824/jim-simson"}, "is_accepted": true, "score": 2, "last_activity_date": 1466376227, "last_edit_date": 1466376227, "creation_date": 1466371498, "answer_id": 37911989, "question_id": 37847475, "link": "https://stackoverflow.com/questions/37847475/legendentries-range-piechart-delete-condition/37911989#37911989", "title": "LegendEntries, Range, PieChart, Delete, Condition", "body": "<p>Tom\u00e1s, Here you go. The problem you were having is that each time you deleted one of the legend entries from the <code>LegendEntries</code> object, the index numbers of the remaining entries all shift down 1 to fill the hole. So after you deleted index 3 (Asia), index 4 became 3, 5 became 4, and so on... To solve the problem I just stepped backwards through the index numbers, thus ensuring that the deletions would not effect the order of things to come.</p>\n\n<pre><code> Sub CreateChart()\n    On Error Resume Next\n    Sheets(1).ChartObjects.Delete\n        Dim MyChart As Chart\n        Dim rowi As Integer\n        Dim MyRange As Range\n    rowi = Range(\"I7\").Row ' Index to select last row non empty, in this example it's row number 11.\n    Do While Sheets(1).Cells(rowi, Range(\"I7\").Column).Value = _\n        IsEmpty(Cells(rowi, Range(\"I7\").Column))\n        rowi = rowi + 1\n    Loop\n\n    '----------------------------------------------------CHART---------------------------------------------------------------\n\n    Set MyRange = Range(\"I6:M6\" &amp; \",I\" &amp; rowi &amp; \":M\" &amp; rowi)\n\n    Set MyChart = Sheets(1).Shapes.AddChart(xlPie).Chart\n         MyChart.SetSourceData Source:=MyRange\n\n    With MyChart.SeriesCollection(1)\n     .HasDataLabels = True\n     .DataLabels.NumberFormat = \"0.0%\"\n    End With\n    MyChart.HasLegend = True\n\n    For i = (Range(\"M6\").Column - Range(\"I6\").Column + 1) To 1 Step -1 ' &lt;---CHANGED THIS\n        If Cells(rowi, Range(\"I6\").Column + i - 1).Value = 0 Then\n            MyChart.SeriesCollection(1).Points(i).DataLabel.Delete\n            MyChart.Legend.LegendEntries(i).Delete\n        End If\n    Next i\nEnd Sub\n</code></pre>\n\n<p>Hope this helps, should you have any questions, please don't hesitate to ask.</p>\n"}], "owner": {"reputation": 107, "user_id": 1710787, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6b5ffc4b72efe3da9a133af7744b445f?s=128&d=identicon&r=PG", "display_name": "Tom&#225;s Ayala", "link": "https://stackoverflow.com/users/1710787/tom%c3%a1s-ayala"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 365, "favorite_count": 1, "accepted_answer_id": 37911989, "answer_count": 1, "score": 3, "last_activity_date": 1466698515, "creation_date": 1466033415, "last_edit_date": 1466698515, "question_id": 37847475, "link": "https://stackoverflow.com/questions/37847475/legendentries-range-piechart-delete-condition", "title": "LegendEntries, Range, PieChart, Delete, Condition", "body": "<p>I've been trying to find the mistake or what I'm doing wrong for a few days. I show here the current output and what it should be. I think maybe I'm defining the range with some mistake, or maybe <code>LegendEntries(i)</code>, doesn't work with the same index as <code>Points(i)</code>. Any suggestion ? Or maybe how could I do this from another approach ? </p>\n\n<p>The thing here is to get a chart and delete the legend and labels associated with \"0\" values.</p>\n\n<p>The First graphic is my current output.\nThe second one is my desire output, and what I expected to get with my code.</p>\n\n<p>The Legends that have 0 values are \"Asia\" and \"Latam\", but my current output is throwing \"Latam\" and it should throw \"RoW\", because \"RoW\" insn't associated with 0 values, its value is \"5.0%\".</p>\n\n<pre><code>Sub CreateChart()\nOn Error Resume Next\nSheets(1).ChartObjects.Delete\n\n    Dim MyChart As Chart\n    Dim rowi As Integer\n    Dim MyRange As Range\n\n\nrowi = Range(\"I7\").Row ' Index to select last row non empty, in this example it's row number 11.\nDo While Sheets(1).Cells(rowi, Range(\"I7\").Column).Value = _\nIsEmpty(Cells(rowi, Range(\"I7\").Column))\nrowi = rowi + 1\nLoop\n\n'----------------------------------------------------CHART---------------------------------------------------------------\n\nSet MyRange = Range(\"I6:M6\" &amp; \",I\" &amp; rowi &amp; \":M\" &amp; rowi)\n\nSet MyChart = Sheets(1).Shapes.AddChart(xlPie).Chart\n\n     MyChart.SetSourceData Source:=MyRange\n\nWith MyChart.SeriesCollection(1)\n .HasDataLabels = True\n .DataLabels.NumberFormat = \"0.0%\"\nEnd With\n\nWith MyChart\n .HasLegend = True\nEnd With\n\nFor i = 1 To (Range(\"M6\").Column - Range(\"I6\").Column + 1)\n\nIf  Cells(rowi, Range(\"I6\").Column + i - 1).Value = 0 Then\nMyChart.SeriesCollection(1).Points(i).DataLabel.Delete\nMyChart.Legend.LegendEntries(i).Delete\nEnd If\n\nNext i\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/amKeI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/amKeI.png\" alt=\"Current Output\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/6Byyf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6Byyf.png\" alt=\"Desire Output\"></a></p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1466031217, "post_id": 37847099, "comment_id": 63154203, "body": "See how you did <code>Sheets(&quot;Historical&quot;)</code> before <code>cells</code>? Do that with <i>all</i> <code>ranges&#47;cells&#47;range objects</code>."}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 6387778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7938b5b13f0db076e8c732d192b4bb48?s=128&d=identicon&r=PG&f=1", "display_name": "Emma Tucker", "link": "https://stackoverflow.com/users/6387778/emma-tucker"}, "edited": false, "score": 0, "creation_date": 1466110529, "post_id": 37848365, "comment_id": 63195246, "body": "This worked! Thank you :) I deleted the lngLastImportRow part because yesterday&#39;s data will always be in the same cell."}], "tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": true, "score": 0, "last_activity_date": 1466039956, "creation_date": 1466039956, "answer_id": 37848365, "question_id": 37847099, "link": "https://stackoverflow.com/questions/37847099/how-do-i-automate-copying-data-from-one-worksheet-in-excel-and-append-it-to-an-e/37848365#37848365", "title": "How do I automate copying data from one worksheet in Excel and append it to an existing table in another worksheet?", "body": "<p>I am not really sure where your table starts on the sheet \"Day Before\". So, I am assuming that it starts in row 1. Based on this assumption here is a little revision to your code:</p>\n\n<pre><code>Option Explicit\n\nSub Insert_New_Rows()\n\nDim lngNextEmptyRow As Long\nDim lngLastImportRow As Long\nDim shtYstrdy As Worksheet\nSet shtYstrdy = ThisWorkbook.Worksheets(\"Day Before\")\n\nWith ThisWorkbook.Worksheets(\"Historical\")\n    lngNextEmptyRow = .Cells(.Rows.Count, \"AF\").End(xlUp).Row + 1\n    .Rows(lngNextEmptyRow).Insert Shift:=xlDown\n    .Cells(lngNextEmptyRow, \"AF\").Value2 = _\n        .Cells(lngNextEmptyRow - 1, \"AF\").Value2 + 1\n    lngLastImportRow = shtYstrdy.Cells(shtYstrdy.Rows.Count, \"A\").End(xlUp).Row\n    shtYstrdy.Range(\"A1:B\" &amp; lngLastImportRow).Copy _\n        Destination:=.Cells(lngNextEmptyRow, \"AF\")\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Changes:</p>\n\n<ol>\n<li>Explicit coding as suggested by @findwindow stating the workbook and the sheet <strong>before</strong> each <code>Range</code>, <code>Cells</code>, reference.</li>\n<li>Copy and paste in one line of code (before three lines of code).</li>\n<li>Using <code>lngNextEmptyRow</code> instead of <code>LastRow</code> so be can skip all these <code>+1</code>.</li>\n<li>Determine the size (last row) of the table on the sheet \"Day Before\", so we know how much we need to copy over.</li>\n</ol>\n\n<p>I hope this is the answer you've been looking for. Let me know if I misunderstood something or if anything requires more explanations.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1466055569, "creation_date": 1466055569, "answer_id": 37850688, "question_id": 37847099, "link": "https://stackoverflow.com/questions/37847099/how-do-i-automate-copying-data-from-one-worksheet-in-excel-and-append-it-to-an-e/37850688#37850688", "title": "How do I automate copying data from one worksheet in Excel and append it to an existing table in another worksheet?", "body": "<p>There is no need to Active or Select Ranges.  It is best to work with the Ranges directly.  Rarely should you use ActiveCell, ActiveWorkSheet, or Selection.</p>\n\n<h2>This is how Copy and Paste work</h2>\n\n<p>Here is the shorthand for Copy and Paste</p>\n\n<blockquote>\n  <p>Range(SourceRange).Copy Range(DestinationRange)</p>\n</blockquote>\n\n<p>Know that this will work for you:</p>\n\n<blockquote>\n  <p>Sheets(\"Day Before\").Range(\"$A$12:$B$12\").Copy Sheets(\"Historical\").Cells(Rows.Count, \"AF\").End(xlUp).Offset(1)</p>\n</blockquote>\n"}], "owner": {"reputation": 55, "user_id": 6387778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7938b5b13f0db076e8c732d192b4bb48?s=128&d=identicon&r=PG&f=1", "display_name": "Emma Tucker", "link": "https://stackoverflow.com/users/6387778/emma-tucker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1073, "favorite_count": 0, "accepted_answer_id": 37848365, "answer_count": 2, "score": 3, "last_activity_date": 1466055569, "creation_date": 1466030983, "last_edit_date": 1466031048, "question_id": 37847099, "link": "https://stackoverflow.com/questions/37847099/how-do-i-automate-copying-data-from-one-worksheet-in-excel-and-append-it-to-an-e", "title": "How do I automate copying data from one worksheet in Excel and append it to an existing table in another worksheet?", "body": "<p>I have two sheets of data.  The first sheet is imported data that will show total users to my site from the day before.  The second sheet is a table with all historical data from those daily reports.  I'd like to automate a way to copy the data from my first sheet (that data will always be in the same cell) to a new row at the bottom of my existing table. Here's what I have: </p>\n\n<pre><code>Sub Insert_New_Rows()\n    Dim Lr As Integer\n\n    Lr = Range(\"AF\" &amp; Rows.Count).End(xlUp).Row\n    Rows(Lr + 1).Insert Shift:=xlDown\n    Cells(Lr + 1, \"AF\") = Cells(Lr, \"AF\") + 1\n    Sheets(\"Day Before\").Range(\"$A$12:$B$12\").Copy\n    Sheets(\"Historical\").Cells(Lr + 1, \"AF\").Paste\n    Application.CutCopyMode = False\nEnd Sub\n</code></pre>\n\n<p>In this, you'll see that my table is in columns AF and AG. When I run this macro, it only adds a row, it does not copy and paste the information.</p>\n"}, {"tags": ["excel", "vba", "date", "datediff"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1466027676, "post_id": 37846275, "comment_id": 63153086, "body": "Do you get a correct result with <code>yrDiff = DateDiff(&quot;yyyy&quot;, d1, d2)</code> ? Are you running under <code>On Error Resume Next</code> ? <code>yrDiff</code> is a Long and can only reproduce time badly."}], "answers": [{"comments": [{"owner": {"reputation": 213, "user_id": 6205487, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/fb16c5a86176fbdc2b08d92e6277647a?s=128&d=identicon&r=PG&f=1", "display_name": "t.mo", "link": "https://stackoverflow.com/users/6205487/t-mo"}, "edited": false, "score": 0, "creation_date": 1466165365, "post_id": 37846530, "comment_id": 63217325, "body": "I updated the cell reference (i, 1) to (1,1) and removed the *.  It s is working as expected now.  Thanks again."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1466028006, "creation_date": 1466028006, "answer_id": 37846530, "question_id": 37846275, "link": "https://stackoverflow.com/questions/37846275/what-is-my-error-in-the-dated-if-macro-the-value-returned-is-in-a-a-time-format/37846530#37846530", "title": "What is my error in the dated if macro? The value returned is in a a time format", "body": "<p>Among other problems, your attempt to retrieve the last populated row in column E should not be deemed reliable. Better with something closer to this.</p>\n\n<pre><code>With wb1.Sheets(\"Carrier\").Range(\"E:E\")\n    lastRow1 = .Find(\"*\", after:=.Cells(1), SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 213, "user_id": 6205487, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/fb16c5a86176fbdc2b08d92e6277647a?s=128&d=identicon&r=PG&f=1", "display_name": "t.mo", "link": "https://stackoverflow.com/users/6205487/t-mo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 37846530, "answer_count": 1, "score": 0, "last_activity_date": 1466051925, "creation_date": 1466026935, "last_edit_date": 1466051925, "question_id": 37846275, "link": "https://stackoverflow.com/questions/37846275/what-is-my-error-in-the-dated-if-macro-the-value-returned-is-in-a-a-time-format", "title": "What is my error in the dated if macro? The value returned is in a a time format", "body": "<p>Below is the Sub to count the years between 2 dates.  No value is displayed in the cell(i,3) and when i update to a MsgBox a time value is displayed.  Thanks in advance for the help.</p>\n\n<pre><code>Sub EE_DatedIF()\n    Dim wb1 As Workbook\n    Dim i As Long\n    Dim LastRow1 As Long\n    Dim yrDiff As Long\n    Dim d1 As Date\n    Dim d2 As Date\n\n    Set wb1 = Workbooks(\"macro all client v.01.xlsm\")\n\n    LastRow1 = wb1.Sheets(\"Carrier\").range(\"E:E\").Find(\"\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n\n    For i = 10 To LastRow1\n        d1 = wb1.Sheets(\"Settings\").Cells(i, 1)\n        d2 = wb1.Sheets(\"Carrier\").Cells(i, 24)\n        yrDiff = DateDiff(\"yy\", d1, d2)\n        wb1.Sheets(\"Settings\").Cells(i, 3) = yrDiff\n    Next i\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "compiler-errors"], "comments": [{"owner": {"reputation": 1642, "user_id": 58038, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b2209ee8e7fda7d4597d4328c973e3a2?s=128&d=identicon&r=PG", "display_name": "Levon", "link": "https://stackoverflow.com/users/58038/levon"}, "edited": false, "score": 1, "creation_date": 1466026105, "post_id": 37845978, "comment_id": 63152426, "body": "You have Sub addrow() and then immediately Public Sub worksheet_change(ByVal target As Range) -- subroutines cannot overlap, and every Sub should have a matching End Sub, hence this error. Either remove Sub addrow() and make sure that workshett_change() is actually usable, or if you are manually running the macro then remove the worksheet_change() line, but keep Sub addrow(). Hope that helps. P.S.: please no ALL CAPS in messages."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6471708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c008b6bc5e363556703ce78103bca08c?s=128&d=identicon&r=PG&f=1", "display_name": "mfrank7114", "link": "https://stackoverflow.com/users/6471708/mfrank7114"}, "edited": false, "score": 0, "creation_date": 1466026537, "post_id": 37846007, "comment_id": 63152621, "body": "Good news- the compile error was fixed after i removed the Public Sub line as you said. Now I am getting the error- &quot;Run-time error &#39;9&#39;: Subscript out of range&quot;. I googled and it seems that I didn&#39;t correctly refer to a range?"}, {"owner": {"reputation": 10875, "user_id": 2392157, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QEWAU.png?s=128&g=1", "display_name": "miroxlav", "link": "https://stackoverflow.com/users/2392157/miroxlav"}, "reply_to_user": {"reputation": 11, "user_id": 6471708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c008b6bc5e363556703ce78103bca08c?s=128&d=identicon&r=PG&f=1", "display_name": "mfrank7114", "link": "https://stackoverflow.com/users/6471708/mfrank7114"}, "edited": false, "score": 0, "creation_date": 1466026926, "post_id": 37846007, "comment_id": 63152786, "body": "@mfrank7114 \u2013 there are many subscripts used in your code. At which one the error occurs? Focus on that one. Try debugging: (1) move caret to first row (<code>Sub ...</code>)  (2) Press <b>F9</b> to set a breakpoint. (3) Run your program, it stops at the breakpoint. (4) Keep pressing <b>F8</b> to walk step by step down your program and observe its steps. You can also view variables etc. See <i>Debug</i> menu during stepping."}], "tags": [], "owner": {"reputation": 10875, "user_id": 2392157, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QEWAU.png?s=128&g=1", "display_name": "miroxlav", "link": "https://stackoverflow.com/users/2392157/miroxlav"}, "is_accepted": false, "score": 4, "last_activity_date": 1466026449, "last_edit_date": 1466026449, "creation_date": 1466025749, "answer_id": 37846007, "question_id": 37845978, "link": "https://stackoverflow.com/questions/37845978/how-to-fix-compile-error-expected-end-sub/37846007#37846007", "title": "How to fix Compile error: expected End Sub?", "body": "<p>Focus on first 3 lines.  You have two <code>Sub</code> declarations there. Keep only one.\nPerhaps remove line</p>\n\n \n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Sub worksheet_change(ByVal target As Range)\n</code></pre>\n\n<p>I think you should remove this line and not the other one because it seems to be forgotten from some previous work. Its parameter <code>target</code> is not used in the code and what your code does better fits with name <code>addrow</code> than with <code>worksheet_change</code>.</p>\n\n<p>This is your code refactored:</p>\n\n<ul>\n<li>variable names keep VBA naming convention</li>\n<li>blocks of code rearranged so gotos and labels could be excluded</li>\n</ul>\n\n<p>.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub AddRow()\n\n    Set SourceBook = ThisWorkbook\n    Set SourceSheet = SourceBook.Worksheets(\"sheet1\")\n\n    Set TargetBook = ThisWorkbook\n    Set TargetSheet = TargetBook.Worksheets(\"sheet10\")\n\n    If Not (SourceSheet.Cells(198, 16).Value = \"Auto\"\n            Or SourceSheet.Cells(198, 16).Value = \"Connect\"\n            Or SourceSheet.Cells(198, 16).Value = \"Multiple*\"\n            Or SourceSheet.Cells(198, 16).Value = \"Property\"\n            Or SourceSheet.Cells(198, 16).Value = \"Umbrella\"\n            Or SourceSheet.Cells(198, 16).Value = \"WC\") Then\n        TargetSheet.Activate\n        ActiveSheet.Rows(198).EntireRow.Insert\n        SourceSheet.Activate\n    End If\n\n    'TargetSheet.Cells(194, TargetSheet.Range(\"initial response\").Column) = SourceSheet.Cells(198, 16).Value\n    TargetSheet.Cells(194, 16) = SourceSheet.Cells(198, 16).Value\n    TargetSheet.Cells(194, 16) = SourceSheet.Cells(198, 16).Value\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5175, "user_id": 4370109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UcQgO.jpg?s=128&g=1", "display_name": "Brian Tompsett - \u6c64\u83b1\u6069", "link": "https://stackoverflow.com/users/4370109/brian-tompsett-%e6%b1%a4%e8%8e%b1%e6%81%a9"}, "edited": false, "score": 0, "creation_date": 1549110271, "post_id": 54492769, "comment_id": 95791628, "body": "You might want to add an explanation to your answer, so reader can understand why this is a good solution to the question. Use the <a href=\"https://stackoverflow.com/posts/54492769/edit\">edit</a> button."}], "tags": [], "owner": {"reputation": 1, "user_id": 11005095, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/4b5e24e1f9c7399c5be459fd4c27140d?s=128&d=identicon&r=PG", "display_name": "Hadi", "link": "https://stackoverflow.com/users/11005095/hadi"}, "is_accepted": false, "score": -1, "last_activity_date": 1549107984, "creation_date": 1549107984, "answer_id": 54492769, "question_id": 37845978, "link": "https://stackoverflow.com/questions/37845978/how-to-fix-compile-error-expected-end-sub/54492769#54492769", "title": "How to fix Compile error: expected End Sub?", "body": "<pre><code>Private Sub CMDSAVE_CLICK()\nDim WORDAPP As word.Application\nDim worddoc As word.document\nDim filename\nfilename = Range(\"c2\").Value\nSheets(\"\u00dd\u00c7\u02dc\u00ca\u00e6\u00d1\").Range(\"a1:k26\").Select\nSelection.Copy\nSet WORDAPP = CreateObject(\"word.application\")\nSet worddec = WORDAPP.documents.Add\nWORDAPP.Selection.pasteexeeltabele False, False, False\nfilename = \"f:\\\" &amp; filename\nwordpec.Close\nWORDAPP.Quit\nSet wordpic = Nothing\nSet WORDAPP = Nothing\nApplication.CutCopyMode = False\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6471708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c008b6bc5e363556703ce78103bca08c?s=128&d=identicon&r=PG&f=1", "display_name": "mfrank7114", "link": "https://stackoverflow.com/users/6471708/mfrank7114"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 20221, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1556897300, "creation_date": 1466025647, "last_edit_date": 1556897300, "question_id": 37845978, "link": "https://stackoverflow.com/questions/37845978/how-to-fix-compile-error-expected-end-sub", "title": "How to fix Compile error: expected End Sub?", "body": "<p>I am trying, when a line of information is added to one of my sheets, to automatically add that line to a different sheet in the same workbook.</p>\n\n<p>I found this code and tweaked it a little:</p>\n\n<pre><code>Sub addrow()\n\nPublic Sub worksheet_change(ByVal target As Range)\n\n    Set sourcebook = ThisWorkbook\n    Set sourcesheet = sourcebook.Worksheets(\"sheet1\")\n\n    Set targetbook = ThisWorkbook\n    Set targetsheet = targetbook.Worksheets(\"sheet10\")\n\n    If sourcesheet.Cells(198, 16).Value = \"Auto\" Or _\n        sourcesheet.Cells(198, 16).Value = \"Connect\" Or _\n        sourcesheet.Cells(198, 16).Value = \"Multiple*\" Or _\n        sourcesheet.Cells(198, 16).Value = \"Property\" Or _\n        sourcesheet.Cells(198, 16).Value = \"Umbrella\" Or _\n        sourcesheet.Cells(198, 16).Value = \"WC\" Then\n        GoTo link\n    Else\n        GoTo insertion\n    End If\n\n    insertion: targetsheet.Activate\n    ActiveSheet.Rows(198).EntireRow.Insert\n\n    sourcesheet.Activate\n\nlink:\n    'targetsheet.Cells(194, targetsheet.Range(\"initial response\").Column) = sourcesheet.Cells(198, 16).Value\n    targetsheet.Cells(194, 16) = sourcesheet.Cells(198, 16).Value\n\n    targetsheet.Cells(194, 16) = sourcesheet.Cells(198, 16).Value\n\nEnd Sub\n</code></pre>\n\n<p>I get the error message \"Compile Error: Expected End Sub\" and it highlights that first line of code- Sub addrow(). When I try taking this line out, VBA requires me to create a new macro when I try and run it, which then adds that line back in, and I am back to square one.</p>\n"}, {"tags": ["vba", "button", "linear-regression", "data-analysis", "developer-tools"], "comments": [{"owner": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1466091586, "post_id": 37845931, "comment_id": 63184549, "body": "I don&#39;t know if this will help, but add a Reference to The Analysis Toolpack in your VBA project by selecting your project in the VBA editor, then go to tools -&gt; add reference, then check &#39;atpvbaen.xls&#39;  After that you can call Regress without having to use Application.Run  If you need more help, what is loc1?"}, {"owner": {"reputation": 3, "user_id": 6471670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f0a57fbed9a7d1e24023ccc469cfe89?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff", "link": "https://stackoverflow.com/users/6471670/jeff"}, "reply_to_user": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1466170593, "post_id": 37845931, "comment_id": 63220795, "body": "After doing that, it still has the same issue. loc1 is output from a function that determines the cell references for the starting and ending cell references for the data that is to be regressed.  I double checked that and it is giving the right output."}, {"owner": {"reputation": 3, "user_id": 6471670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f0a57fbed9a7d1e24023ccc469cfe89?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff", "link": "https://stackoverflow.com/users/6471670/jeff"}, "reply_to_user": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1466170884, "post_id": 37845931, "comment_id": 63220988, "body": "After looking at the output of the regression function, I noticed that all of the output is the same for when I run it pressing the button as when I run it otherwise except for the Residual Output."}], "answers": [{"tags": [], "owner": {"reputation": 1230, "user_id": 606833, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a7e15fe8aac6f8eb4042c78ad066ee95?s=128&d=identicon&r=PG", "display_name": "Dan", "link": "https://stackoverflow.com/users/606833/dan"}, "is_accepted": false, "score": -2, "last_activity_date": 1476793338, "last_edit_date": 1476793338, "creation_date": 1476783191, "answer_id": 40104586, "question_id": 37845931, "link": "https://stackoverflow.com/questions/37845931/vba-linear-regression-analysis-with-button/40104586#40104586", "title": "VBA Linear Regression Analysis with Button", "body": "<p>Have you tried this excellent VBA code from Chad Rankin:</p>\n\n<p><a href=\"http://www.freevbcode.com/ShowCode.asp?ID=9070\" rel=\"nofollow\">http://www.freevbcode.com/ShowCode.asp?ID=9070</a></p>\n\n<ul>\n<li><p>This code allows you to perform a multiple linear regression analysis on variables that are not contiguous on the spreadsheet - vars on columns side-by-side.</p></li>\n<li><p>it's extremely fast, since the author took the time to carefully choose the matrix multiplication formulas that do not consume computer time</p></li>\n<li><p>the website freevbcode.com has proved to be a reliable source of curated VB code to me in the past</p></li>\n</ul>\n\n<p>Quoted from the website:</p>\n\n<blockquote>\n  <p>Version Compatibility: Visual Basic 6</p>\n  \n  <p>More information:\n  This code performs a multiple linear regression analysis by programming the worksheet using R1C1 references and VBA. Analysis data are input through a userform and the resultant model is constructed on a new worksheet with all applicable worksheet functions included. Since the data are not mean centered or standardized, numerical inaccuracy may result where the data are significantly ill-conditioned.</p>\n  \n  <p>INSTRUCTIONS: Click the link below to download the code. Select 'Save' from the IE popup dialog. Once downloaded, open the .zip file from your local drive using WinZip or a comparable program to view the contents.</p>\n</blockquote>\n"}], "owner": {"reputation": 3, "user_id": 6471670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f0a57fbed9a7d1e24023ccc469cfe89?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff", "link": "https://stackoverflow.com/users/6471670/jeff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 8224, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1476793338, "creation_date": 1466025473, "last_edit_date": 1466028175, "question_id": 37845931, "link": "https://stackoverflow.com/questions/37845931/vba-linear-regression-analysis-with-button", "title": "VBA Linear Regression Analysis with Button", "body": "<p>I am running a fairly large macro that includes running a linear regression analysis from the Analysis Toolpak.</p>\n\n<p>When I run it through the separate VB window, it runs just fine, but after creating a form control button and assigning the same macro to it, it does not work.</p>\n\n<p>The linear regression analysis creates a new page as desired:\n<a href=\"https://i.stack.imgur.com/pQUiN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pQUiN.png\" alt=\"new page\"></a></p>\n\n<p>But it replaces the analyzed data with the cell formatting from the analysis:\n<a href=\"https://i.stack.imgur.com/T4XH4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/T4XH4.png\" alt=\"cell formatting\"></a></p>\n\n<p>Can anybody help me to make the button run the sub properly?</p>\n\n<p>This is the code that I used to call the linear regression:</p>\n\n<pre><code>Application.Run \"ATPVBAEN.XLAM!Regress\", ActiveSheet.Range(loc1(1), loc1(2)), _\n    ActiveSheet.Range(loc1(3), loc1(4)), False, True, 99, \"Regression \" &amp; tabname, True, _\n    True, True, True, , False\n</code></pre>\n"}, {"tags": ["windows", "vba", "batch-file", "vbscript", "scheduled-tasks"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6017774"}, "edited": false, "score": 0, "creation_date": 1466030061, "post_id": 37845701, "comment_id": 63153884, "body": "You need to show your code."}, {"owner": {"reputation": 774, "user_id": 3373429, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LERZ2.jpg?s=128&g=1", "display_name": "Steve Kline", "link": "https://stackoverflow.com/users/3373429/steve-kline"}, "edited": false, "score": 0, "creation_date": 1466047306, "post_id": 37845701, "comment_id": 63157849, "body": "@Noodles ideally this does belong in the SuperUser stack as it&#39;s a general windows scheduling task question versus code question."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6017774"}, "edited": false, "score": 0, "creation_date": 1466055296, "post_id": 37845701, "comment_id": 63160210, "body": "Maybe not. In particular I want to see if any config dependent things are being used like mapped drives."}], "answers": [{"tags": [], "owner": {"reputation": 774, "user_id": 3373429, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LERZ2.jpg?s=128&g=1", "display_name": "Steve Kline", "link": "https://stackoverflow.com/users/3373429/steve-kline"}, "is_accepted": false, "score": 0, "last_activity_date": 1466047050, "creation_date": 1466047050, "answer_id": 37849305, "question_id": 37845701, "link": "https://stackoverflow.com/questions/37845701/vbs-script-does-not-work-properly-from-task-scheduler-in-windows-10/37849305#37849305", "title": "VBS script does not work properly from Task Scheduler in Windows 10", "body": "<p>Try executing like this instead of calling the batch file directly.</p>\n\n<p>32-bit</p>\n\n<pre><code>Action: \"%SYSTEMROOT%\\system32\\cmd.exe /c C:\\AutoMerge\\JSON Watch.bat\"\n</code></pre>\n\n<p>or 64-bit</p>\n\n<pre><code>Action: \"%SYSTEMROOT%\\SysWOW64\\cmd.exe /c C:\\AutoMerge\\JSON Watch.bat\"\n</code></pre>\n\n<p>If it is 64-bit... update your cscript to execute %SYSTEMROOT%\\SysWOW64\\cscript.exe </p>\n"}, {"tags": [], "owner": {"reputation": 35, "user_id": 5095285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aaab7d1efe0e33d3b9030a520891f5c?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Louis", "link": "https://stackoverflow.com/users/5095285/matthew-louis"}, "is_accepted": true, "score": 0, "last_activity_date": 1466179147, "creation_date": 1466179147, "answer_id": 37885814, "question_id": 37845701, "link": "https://stackoverflow.com/questions/37845701/vbs-script-does-not-work-properly-from-task-scheduler-in-windows-10/37885814#37885814", "title": "VBS script does not work properly from Task Scheduler in Windows 10", "body": "<p>Turns out Noodles was right it was something in the code.</p>\n\n<p>I created a file system object and used it to get a File.Name.   Then I passed this File.Name(without the path) to a function that parses the JSON in the file.  This worked just fine when I manually ran it.</p>\n\n<pre><code>JSONExists(File.Name)\n</code></pre>\n\n<p>In order to run properly from Task Scheduler I had to make sure it passed the entire file name including the path.</p>\n\n<pre><code>FPath = \"C:\\Automerge\\\"    \nJSONExists(FPath &amp; File.Name)\n</code></pre>\n\n<p>I'm not exactly sure why I need the whole path with Task Scheduler and not when I run manually, but at least now I have a good rule of thumb.</p>\n"}], "owner": {"reputation": 35, "user_id": 5095285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aaab7d1efe0e33d3b9030a520891f5c?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Louis", "link": "https://stackoverflow.com/users/5095285/matthew-louis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2664, "favorite_count": 0, "accepted_answer_id": 37885814, "answer_count": 2, "score": 0, "last_activity_date": 1466179147, "creation_date": 1466024476, "question_id": 37845701, "link": "https://stackoverflow.com/questions/37845701/vbs-script-does-not-work-properly-from-task-scheduler-in-windows-10", "title": "VBS script does not work properly from Task Scheduler in Windows 10", "body": "<p>I have a windows server designed to perform mail merges for postal letters.\nA outside server generates xls data sheets and SFTPS them to my windows server, along with a JSON file with further instructions: </p>\n\n<ul>\n<li>The Letter to merge with (docx file)</li>\n<li>An E-mail address to send a PDF of the merged letters.</li>\n</ul>\n\n<p>The script works like this:\n1. Constantly(every 60 seconds) monitor directory for JSON files. -> \n2. If there is a JSON file, parse it. ->\n3. Find XLS file related to that JSON file ->\n4. Run VBA/ EXCEL macro to mail merge XLS and the letter into a PDF ->\n5. Email PDF to appropriate contact ->\n6. Move XLS file to Processed Folder\n7. Move JSON file to PRocessed Folder</p>\n\n<p>If I run it manually from the command line it works just fine.  However, If I run it from Task Scheduler, either with \"RUN\" or automatically when the machine restarts or when a given user logs in the script fails.  Steps 1, 2, and 3 work.  The VBA code/ Macro fails to work.  </p>\n\n<p>I'm hoping this can be resolved through configuration of Task Scheduler.  Here is my current setup:</p>\n\n<p>Script runs from a bat file, the message script keeps a CMD window open that explains what the script is doing:</p>\n\n<pre><code>cscript C:\\automerge\\message.vbs\ncscript C:\\automerge\\automerge.vbs &gt;&gt; C:\\automerge\\logs.log\n</code></pre>\n\n<p>Task Scheduler Settings:\nRun only when user is logged on\nRun with Highest Privileges\nConfigure for Windows 10 (tried using 7 and 8 too)</p>\n\n<p>Trigger:\nTrigger at logon - Enabled</p>\n\n<p>Action:\nStart a program\nDetails:\n\"C:\\AutoMerge\\JSON Watch.bat\"</p>\n\n<p>Conditions:\nStart the task only if computer is on AC power\nStop if computer switches to battery power</p>\n\n<p>Settings:\nAllow Task to run on demand\nIf the running task does not end when requested, force it to stop</p>\n\n<p>Can anyone give me advice on how to change the scheduled task or batch file to get this to work?</p>\n"}, {"tags": ["excel", "excel-2010", "copy-paste", "vba"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1466024737, "post_id": 37845668, "comment_id": 63151795, "body": "You should use the <code>InStr</code> method to do the comparison like this: <code>If InStr(1, Cells(7, j), &quot;CYLINDER&quot;) &gt; 0 Or InStr(1, Cells(7, j), &quot;CYLINDERS&quot;) &gt; 0 Or InStr(1, Cells(7, j), &quot;CYL&quot;) &gt; 0 Then</code>"}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 1, "creation_date": 1466024999, "post_id": 37845668, "comment_id": 63151910, "body": "Also, what happens when &quot;Cyl&quot;, &quot;cyl&quot;? Why don&#39;t you turn the word to uppercase in your code to cover those scenarios -UCase()-? Or use Option Compare Text at the beginning of the module, I don&#39;t understand why to make 3 comparisons, if cell has &quot;CYL&quot; of course it would have CYLINDER and CYLINDERS on it."}, {"owner": {"reputation": 813, "user_id": 1506937, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/c2cfc1dc7d76bd1ff3b87210e98ca7f5?s=128&d=identicon&r=PG", "display_name": "TheTreeMan", "link": "https://stackoverflow.com/users/1506937/thetreeman"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1466025379, "post_id": 37845668, "comment_id": 63152083, "body": "Great, thank you Ralph. And you&#39;re correct Sgdva. @Ralph, if you submit that as a comment I&#39;ll mark it as the answer."}], "answers": [{"comments": [{"owner": {"reputation": 813, "user_id": 1506937, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/c2cfc1dc7d76bd1ff3b87210e98ca7f5?s=128&d=identicon&r=PG", "display_name": "TheTreeMan", "link": "https://stackoverflow.com/users/1506937/thetreeman"}, "edited": false, "score": 0, "creation_date": 1466087417, "post_id": 37846026, "comment_id": 63181471, "body": "Thank you for your help! I appreciate it :)"}], "tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": true, "score": 1, "last_activity_date": 1466025846, "creation_date": 1466025846, "answer_id": 37846026, "question_id": 37845668, "link": "https://stackoverflow.com/questions/37845668/how-to-detect-if-a-word-is-present-in-a-cell-within-a-string/37846026#37846026", "title": "How to detect if a word is present in a cell, within a string?", "body": "<p>You should use the <code>InStr</code> function to do the comparison like this:</p>\n\n<pre><code>If InStr(1, Cells(7, j), \"CYLINDER\") &gt; 0 Or _\n    InStr(1, Cells(7, j), \"CYLINDERS\") &gt; 0 Or _\n    InStr(1, Cells(7, j), \"CYL\") &gt; 0 Then\n        MsgBox (\"Detected the string CYLINDER\")\n        j = j + 1\n        MsgBox (\"j equals \" &amp; j)\nElse\n    MsgBox (\"Did not detect the string CYLINDER\")\nEnd If\n</code></pre>\n\n<p>For more information on this function visit MSDN at <a href=\"https://msdn.microsoft.com/en-us/library/office/gg264811%28v=office.15%29.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/gg264811%28v=office.15%29.aspx</a></p>\n\n<p>To avoid different cases (as suggested by @Sgdva) you have several options:</p>\n\n<pre><code>If InStr(1, Cells(7, j), \"CYLINDER\", vbTextCompare) &gt; 0 Or _\n    InStr(1, Cells(7, j), \"CYLINDERS\", vbTextCompare) &gt; 0 Or _\n    InStr(1, Cells(7, j), \"CYL\", vbTextCompare) &gt; 0 Then\n        MsgBox (\"Detected the string CYLINDER\")\n        j = j + 1\n        MsgBox (\"j equals \" &amp; j)\nElse\n    MsgBox (\"Did not detect the string CYLINDER\")\nEnd If\n</code></pre>\n\n<p>OR</p>\n\n<pre><code>If InStr(1, UCase(Cells(7, j)), \"CYLINDER\") &gt; 0 Or _\n    InStr(1, UCase(Cells(7, j)), \"CYLINDERS\") &gt; 0 Or _\n    InStr(1, UCase(Cells(7, j)), \"CYL\") &gt; 0 Then\n        MsgBox (\"Detected the string CYLINDER\")\n        j = j + 1\n        MsgBox (\"j equals \" &amp; j)\nElse\n    MsgBox (\"Did not detect the string CYLINDER\")\nEnd If\n</code></pre>\n\n<p>OR</p>\n\n<p>Use the <code>Option Compare Text</code> at the top of your module and as pointed out here:\n<a href=\"https://msdn.microsoft.com/en-us/library/office/gg278697.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/gg278697.aspx</a></p>\n\n<p>At the same time, you might want to consider inserting the line:</p>\n\n<pre><code>Option Explicit\n</code></pre>\n\n<p>(for good coding practice).</p>\n"}, {"comments": [{"owner": {"reputation": 813, "user_id": 1506937, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/c2cfc1dc7d76bd1ff3b87210e98ca7f5?s=128&d=identicon&r=PG", "display_name": "TheTreeMan", "link": "https://stackoverflow.com/users/1506937/thetreeman"}, "edited": false, "score": 0, "creation_date": 1466087405, "post_id": 37846089, "comment_id": 63181459, "body": "j is how I&#39;m tracking something else. It&#39;s not super relevant to the current code. Thank you for putting it together!"}], "tags": [], "owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "is_accepted": false, "score": 1, "last_activity_date": 1466026119, "creation_date": 1466026119, "answer_id": 37846089, "question_id": 37845668, "link": "https://stackoverflow.com/questions/37845668/how-to-detect-if-a-word-is-present-in-a-cell-within-a-string/37846089#37846089", "title": "How to detect if a word is present in a cell, within a string?", "body": "<p>Not sure what you are trying to accomplish with the <code>j</code> variable as it doesn't seem to have any relevance. Except I seem to have identified an error in your code and the answer provided by Ralph. <code>Cells(7, j)</code> should rather be <code>Cells(i, 7)</code>. Full code would be:</p>\n\n<pre><code>Sub searchandpaste()\n    Dim stopvar As Variant\n    Dim i As Variant\n    Dim j As Variant\n    Dim k As Variant\n    Dim TestVal1 As Variant\n    Dim TestVal2 As Variant\n\n    i = 0\n    j = 0\n\n    Do While stopvar = 0\n        i = i + 1\n        MsgBox (\"Row \" &amp; i)\n        MsgBox (\"j equals \" &amp; j)\n        'If the first cell is empty, that means we've hit the end of the worksheet, and it stops the do-while loop\n        TestVal1 = Cells(i, 1)\n        If TestVal1 = 0 Then\n            stopvar = 1\n        Else\n            TestVal2 = Cells(i, 6)\n            If IsEmpty(TestVal2) = True Then\n                MsgBox (\"Detected Empty Cell in Column 6\")\n                j = 1\n            ElseIf TestVal2 = \"XXXX\" Then\n                'This means we have a place we need to insert a value\n                MsgBox (\"Detected XXXX in Column 6\")\n                'We know at this point that in Cells(6,i) we have a value we need to insert. Thus, we need to search Cells(7,i) for key text\n                If InStr(LCase(Cells(i, 7)), \"cyl\") &gt; 0 Then\n                    MsgBox (\"Detected the string CYLINDER\")\n                    j = j + 1\n                    MsgBox (\"j equals \" &amp; j)\n                Else\n                    MsgBox (\"Did not detect the string CYLINDER\")\n                End If\n\n            End If\n        End If\n    Loop\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 813, "user_id": 1506937, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/c2cfc1dc7d76bd1ff3b87210e98ca7f5?s=128&d=identicon&r=PG", "display_name": "TheTreeMan", "link": "https://stackoverflow.com/users/1506937/thetreeman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 37846026, "answer_count": 2, "score": 0, "last_activity_date": 1466026119, "creation_date": 1466024348, "last_edit_date": 1531161705, "question_id": 37845668, "link": "https://stackoverflow.com/questions/37845668/how-to-detect-if-a-word-is-present-in-a-cell-within-a-string", "title": "How to detect if a word is present in a cell, within a string?", "body": "<p>I have some code I'm working on where I need to detect if a cell has a particular word in it, and if it does, it inserts a particular string in the adjacent cell. However, I'm having issues doing the detection part of it! Here's what I have so far.</p>\n\n<pre><code>Sub searchandpaste()\n    Dim stopvar As Variant\n    Dim i As Variant\n    Dim j As Variant\n    Dim k As Variant\n    Dim TestVal1 As Variant\n    Dim TestVal2 As Variant\n\n    i = 0\n    j = 0\n\n    Do While stopvar = 0\n        i = i + 1\n        MsgBox (\"Row \" &amp; i)\n        MsgBox (\"j equals \" &amp; j)\n        'If the first cell is empty, that means we've hit the end of the worksheet, and it stops the do-while loop\n        TestVal1 = Cells(i, 1)\n        If TestVal1 = 0 Then\n            stopvar = 1\n        Else\n            TestVal2 = Cells(i, 6)\n            If IsEmpty(TestVal2) = True Then\n                MsgBox (\"Detected Empty Cell in Column 6\")\n                j = 1\n            ElseIf TestVal2 = \"XXXX\" Then\n                'This means we have a place we need to insert a value\n                MsgBox (\"Detected XXXX in Column 6\")\n                'We know at this point that in Cells(6,i) we have a value we need to insert. Thus, we need to search Cells(7,i) for key text\n                If IsNumeric(Cells(7, j).Find(\"CYLINDER\")) Or IsNumeric(Cells(7, j).Find(\"CYLINDERS\")) Or IsNumeric(Cells(7, j).Find(\"CYL\")) = True Then\n                    MsgBox (\"Detected the string CYLINDER\")\n                    j = j + 1\n                    MsgBox (\"j equals \" &amp; j)\n                Else\n                    MsgBox (\"Did not detect the string CYLINDER\")\n                End If\n\n            End If\n        End If\n    Loop\nEnd Sub\n</code></pre>\n\n<p>I'll cut out the important part, here.</p>\n\n<pre><code>'We know at this point that in Cells(6,i) we have a value we need to insert. Thus, we need to search Cells(7,i) for key text\nIf IsNumeric(Cells(7, j).Find(\"CYLINDER\")) Or IsNumeric(Cells(7, j).Find(\"CYLINDERS\")) Or IsNumeric(Cells(7, j).Find(\"CYL\")) = True Then\n    MsgBox (\"Detected the string CYLINDER\")\n    j = j + 1\n    MsgBox (\"j equals \" &amp; j)\nElse\n    MsgBox (\"Did not detect the string CYLINDER\")\nEnd If\n</code></pre>\n\n<p>My intention is that this would search the string in cell (i,7) for different variations of the word Cylinder, and if it finds one, it'll return TRUE or FALSE (false would be a NAN, which is caught by the IsNumeric and turned to a FALSE), and let me know it detected it. However, this doesn't seem to be working.</p>\n\n<p>Can anybody pinpoint my error?</p>\n\n<p>Is there a better way to search the string? Like, could I just search for \"CYL\" and have it say it detected any of those variations?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1466024429, "post_id": 37845600, "comment_id": 63151645, "body": "<code>R1</code> would be change to 1:1 and <code>R8</code> would become 8:8.  You are iterating v so each time it loops the Row output would increase.  What are you wanting as the Output, <code>R1</code>? not the row, but the actual string?"}, {"owner": {"reputation": 873, "user_id": 5103224, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d7d1ca72bbff93c0a014b5b770482a53?s=128&d=identicon&r=PG&f=1", "display_name": "Lowpar", "link": "https://stackoverflow.com/users/5103224/lowpar"}, "edited": false, "score": 0, "creation_date": 1466024539, "post_id": 37845600, "comment_id": 63151699, "body": "How about r.value? still, I think you would need to use something like indirect here, in principle the value of your variable is R1, not the value in the cell RI. you could also try - &quot; &amp; .Range(r) &amp; &quot; in the formula."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1466025102, "creation_date": 1466025102, "answer_id": 37845846, "question_id": 37845600, "link": "https://stackoverflow.com/questions/37845600/string-variable-for-value-if-true-returns-row-range-in-worksheet/37845846#37845846", "title": "String Variable for Value_If_True returns Row Range in Worksheet", "body": "<p>I'm guessing that you want the literal string <code>\"R1\"</code> as the result of the If but when unquoted, it is being referenced as an xlR1C1 range reference.</p>\n\n<pre><code>drop.Range(Cells(8, c), Cells(LR, c)).FormulaR1C1 = _\n    \"=IF(AND(RC3&gt;=RC[-18], RC3&lt;=RC[-17]), \"\"\" &amp; r &amp; \"\"\", TEXT(,))\"\n</code></pre>\n\n<p><code>TEXT(,)</code> is just an easy way to say <code>\"\"</code> without having to write <code>\"\"\"\"</code>.</p>\n"}], "owner": {"reputation": 21, "user_id": 6471602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/403a802f544e6f11d9ade162438ac068?s=128&d=identicon&r=PG&f=1", "display_name": "shesse1010", "link": "https://stackoverflow.com/users/6471602/shesse1010"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1466025269, "creation_date": 1466024100, "last_edit_date": 1466025269, "question_id": 37845600, "link": "https://stackoverflow.com/questions/37845600/string-variable-for-value-if-true-returns-row-range-in-worksheet", "title": "String Variable for Value_If_True returns Row Range in Worksheet", "body": "<p>I'm trying to use <code>IF(And()</code> construct in a <code>R1C1</code> Formula to populate a large range of cells. To do this I've created a loop that creates a string variable for the Value_if_True part of the formula, however when the formula runs cells lists a range instead of the contents of the variable</p>\n\n<pre><code>v = 1\ncs = 71\nce = 87\nFor c = cs To ce Step 2\n    r = \"R\" &amp; v\n    drop.Range(Cells(8, c), Cells(LR, c)).FormulaR1C1 = \"=IF(AND(RC3&gt;=RC[-18],RC3&lt;=RC[-17]),\" &amp; r &amp; \",\"\"\"\")\"\n    v = v + 1\nNext\n</code></pre>\n\n<p>I declare the variables at the top of the sub porocedure (r is a String). This is what the cell appears as after I run the macro: </p>\n\n<pre><code>=IF(AND($C8&gt;=BA8,$C8&lt;=BB8),8:8,\"\") \n</code></pre>\n\n<p>The Figure <strong>8:8</strong> should be \"<strong>R1</strong>\". </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "is_accepted": false, "score": 1, "last_activity_date": 1466024943, "last_edit_date": 1466024943, "creation_date": 1466024387, "answer_id": 37845680, "question_id": 37845483, "link": "https://stackoverflow.com/questions/37845483/vba-fill-shape-with-button-click/37845680#37845680", "title": "VBA, Fill shape with button click", "body": "<p>Put this in the module of the worksheet which contains the button:</p>\n\n<p>EDITED: Sorry, I originally thought you wanted the actual button colour to change. I borrowed from Ralph's answer to account for the shape being the object of the colour change, but below this is for an ActiveX control (as you asked) instead of a form button:</p>\n\n<pre><code>Private Sub CommandButton1_Click() ' Yes, you do need to specify the button\n    Dim shp As Shape\n    Set shp = ThisWorkbook.Worksheets(1).Shapes(\"Rectangle 1\")\n    If shp.Fill.ForeColor.RGB = RGB(231, 230, 230) Then\n        shp.Fill.ForeColor.RGB = RGB(0, 0, 0)\n    Else\n        shp.Fill.ForeColor.RGB = RGB(231, 230, 230)\n    End If\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 125, "user_id": 6471570, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/DvCk2.png?s=128&g=1", "display_name": "NMeneses", "link": "https://stackoverflow.com/users/6471570/nmeneses"}, "edited": false, "score": 0, "creation_date": 1466116234, "post_id": 37845687, "comment_id": 63197498, "body": "Thank you for the help.  I already learned how to record macros, but I have to assign a key-stroke command to work the macro.  I don&#39;t like doing it that way because I think it adds more work than a simple click could do.  However, it does sound like you saying to use the macro record for viewing the code instead of actually using the recorded macro.  That&#39;s a great idea.  Thank you."}], "tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": true, "score": 3, "last_activity_date": 1466024424, "creation_date": 1466024424, "answer_id": 37845687, "question_id": 37845483, "link": "https://stackoverflow.com/questions/37845483/vba-fill-shape-with-button-click/37845687#37845687", "title": "VBA, Fill shape with button click", "body": "<p>Here is the code you are looking for:</p>\n\n<pre><code>Option Explicit\n\nSub ButtonClick()\n\nDim shp As Shape\n\nSet shp = ThisWorkbook.Worksheets(1).Shapes(\"Rectangle 1\")\n\nIf shp.Fill.ForeColor.RGB = RGB(231, 230, 230) Then\n    shp.Fill.ForeColor.RGB = RGB(0, 0, 0)\nElse\n    shp.Fill.ForeColor.RGB = RGB(231, 230, 230)\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Just make sure that you adjust the above code to the correct shape name (which is \"Rectablge 1\" in this example, which is located on Sheet(1)).</p>\n\n<p>Afterwards, create a button on that sheet and assign this macro to the button to make it work and toggle the shape color between black and grey.</p>\n\n<p>Next time, I recommend that you (in a first step) record the things you want Excel to do for you with the VBA macro recorder: <a href=\"https://www.youtube.com/watch?v=Q_HQGHPBYoo\" rel=\"nofollow\">https://www.youtube.com/watch?v=Q_HQGHPBYoo</a> Afterwards, have a look at the code and try to understand it by highlighting VBA key-words and pressing <code>F1</code>. Also, I'd recommend reading this: <a href=\"http://www.homeandlearn.org/\" rel=\"nofollow\">http://www.homeandlearn.org/</a> Afterwards you should be set to write some rather fancy macros.</p>\n"}, {"comments": [{"owner": {"reputation": 125, "user_id": 6471570, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/DvCk2.png?s=128&g=1", "display_name": "NMeneses", "link": "https://stackoverflow.com/users/6471570/nmeneses"}, "edited": false, "score": 0, "creation_date": 1466116602, "post_id": 37845732, "comment_id": 63197618, "body": "Thank you for your help.  Now that I have done that, something else came up.  Say I have three shapes and a button that corresponds to each of those shapes.  Is there a way to assign the same macro to each button to fill the corresponding shape colors?"}, {"owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "reply_to_user": {"reputation": 125, "user_id": 6471570, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/DvCk2.png?s=128&g=1", "display_name": "NMeneses", "link": "https://stackoverflow.com/users/6471570/nmeneses"}, "edited": false, "score": 0, "creation_date": 1466169286, "post_id": 37845732, "comment_id": 63219863, "body": "You should make a new question for that."}], "tags": [], "owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "is_accepted": false, "score": 0, "last_activity_date": 1466024602, "creation_date": 1466024602, "answer_id": 37845732, "question_id": 37845483, "link": "https://stackoverflow.com/questions/37845483/vba-fill-shape-with-button-click/37845732#37845732", "title": "VBA, Fill shape with button click", "body": "<p>Yes, you need a button name. Drop an ActiveX control on the sheet, then go to the sheet's module in the VBE. In the left dropdown at the top of the code pane, find your control name (you probably want to rename it first - I didn't for this example)</p>\n\n<p><a href=\"https://i.stack.imgur.com/FKgXI.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FKgXI.gif\" alt=\"enter image description here\"></a></p>\n\n<p>When you pick the control name in the left dropdown and the event name in the right, the VBE stubs the Sub and End Sub for you.</p>\n\n<p>Next you need to reference your shape in your code. Start by using the <code>Me</code> keyword. When you're in a sheet's code module, <code>Me</code> refers to that sheet. Then the dot operator will expose all the properties and methods of that sheet. When you drop an ActiveX control on a sheet, a new property of the sheet is automatically created that provides access to the object.  You can use</p>\n\n<pre><code>Me.CommandButton1.BackColor = RGB(231, 230, 230)\n</code></pre>\n\n<p>You <code>If</code> logic looks fine.</p>\n"}], "owner": {"reputation": 125, "user_id": 6471570, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/DvCk2.png?s=128&g=1", "display_name": "NMeneses", "link": "https://stackoverflow.com/users/6471570/nmeneses"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3438, "favorite_count": 0, "accepted_answer_id": 37845687, "answer_count": 3, "score": 2, "last_activity_date": 1466024943, "creation_date": 1466023688, "question_id": 37845483, "link": "https://stackoverflow.com/questions/37845483/vba-fill-shape-with-button-click", "title": "VBA, Fill shape with button click", "body": "<p>I'm very new to macros and I'm trying to teach myself VBA in excel 2013 and could use a lot of help.  I would like to know how to change a shape fill color (not a cell) when I click an ActiveX button.  Here is what I'm thinking:</p>\n\n<pre><code>onClick()                            &lt;-- Do I need a button name?\nif shape.color = RGB(231,230,230)    &lt;-- this is the starting color\n    shape.color = RGB(0,0,0)         &lt;-- this is what I want to change it to\nelse\n    shape.color = RGB(231,230,230)   &lt;-- if color is black change to this\nend if\n</code></pre>\n\n<p>By the way, this is for fun and not for anything special or official.</p>\n"}, {"tags": ["vba", "excel", "conditional-formatting"], "comments": [{"owner": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "edited": false, "score": 0, "creation_date": 1466024092, "post_id": 37845442, "comment_id": 63151430, "body": "How about using a separate check column (which you can hide if you like), containing a UDF in which you check all the various conditions, and if true return 1 into the cell, otherwise 0. Then with the conditional formatting, you just have to check whether the check column is 1."}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1466024289, "post_id": 37845442, "comment_id": 63151551, "body": "You can use CF directly to color the whole row. You can use conditional logic to sum values with formulas. Any particular reason you want this done in VBA? Judging from your code you are not very experienced with VBA. If you want VBA to do the coloring, then you don&#39;t need Conditional Formatting. Use one OR the other, not both."}, {"owner": {"reputation": 63, "user_id": 6471599, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9b47e2036593eacbef1c9c4d09e0fa3?s=128&d=identicon&r=PG&f=1", "display_name": "Excellerator", "link": "https://stackoverflow.com/users/6471599/excellerator"}, "reply_to_user": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "edited": false, "score": 0, "creation_date": 1466079706, "post_id": 37845442, "comment_id": 63175336, "body": "@ChrisMelville, I don&#39;t know enough about vba to make a UDF that is long enough to check all of the conditions."}, {"owner": {"reputation": 63, "user_id": 6471599, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9b47e2036593eacbef1c9c4d09e0fa3?s=128&d=identicon&r=PG&f=1", "display_name": "Excellerator", "link": "https://stackoverflow.com/users/6471599/excellerator"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1466084401, "post_id": 37845442, "comment_id": 63179042, "body": "@teylyn No, I am not very experienced. Using Jeeped&#39;s code below, VBA highlighted the entire row, but it is still conditionally formatted. So you recommend just using sumif and using an array for the criteria? I would love to know how to get VBA to highlight the row without CF, but I don&#39;t know how to do that."}, {"owner": {"reputation": 63, "user_id": 6471599, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9b47e2036593eacbef1c9c4d09e0fa3?s=128&d=identicon&r=PG&f=1", "display_name": "Excellerator", "link": "https://stackoverflow.com/users/6471599/excellerator"}, "reply_to_user": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "edited": false, "score": 0, "creation_date": 1466092330, "post_id": 37845442, "comment_id": 63185073, "body": "@ChrisMelville I actually ended up using what you suggested by naming the criteria I&#39;m searching to shorten the formula and then sumif true... Very simple, I don&#39;t know I over-complicated it. Cheers mate."}, {"owner": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "edited": false, "score": 0, "creation_date": 1466169025, "post_id": 37845442, "comment_id": 63219699, "body": "You&#39;re welcome. I generally find that there&#39;s more than one way to skin a cat in this type of situation :)"}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 6471599, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9b47e2036593eacbef1c9c4d09e0fa3?s=128&d=identicon&r=PG&f=1", "display_name": "Excellerator", "link": "https://stackoverflow.com/users/6471599/excellerator"}, "edited": false, "score": 0, "creation_date": 1466081116, "post_id": 37846142, "comment_id": 63176422, "body": "It is telling me that I have too many line continuations in the array. There are 275 conditions, so do I just have to build multiple arrays? or run like 10 different subs and call them into a public sub?"}, {"owner": {"reputation": 63, "user_id": 6471599, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9b47e2036593eacbef1c9c4d09e0fa3?s=128&d=identicon&r=PG&f=1", "display_name": "Excellerator", "link": "https://stackoverflow.com/users/6471599/excellerator"}, "edited": false, "score": 0, "creation_date": 1466082896, "post_id": 37846142, "comment_id": 63177807, "body": "I tried to do run the multiple arrays but it did not highlight all of them. It looks as if when I did what I mentioned above it only highlighted the last array of option, not all of them. Any idea why?"}, {"owner": {"reputation": 63, "user_id": 6471599, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9b47e2036593eacbef1c9c4d09e0fa3?s=128&d=identicon&r=PG&f=1", "display_name": "Excellerator", "link": "https://stackoverflow.com/users/6471599/excellerator"}, "edited": false, "score": 0, "creation_date": 1466094189, "post_id": 37846142, "comment_id": 63186179, "body": "I figured it out. Just needed to delete the .FormatConditions.Delete line, but then that leave the conditional formatting in the rest of the rows that are not true. Any idea how to edit the code so it only deletes untrue formats after all of the arrays have been run? Thanks Jeeped!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 63, "user_id": 6471599, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9b47e2036593eacbef1c9c4d09e0fa3?s=128&d=identicon&r=PG&f=1", "display_name": "Excellerator", "link": "https://stackoverflow.com/users/6471599/excellerator"}, "edited": false, "score": 0, "creation_date": 1466103172, "post_id": 37846142, "comment_id": 63191364, "body": "I don&#39;t think I am grasping just what you are trying to do. If there was a list of these search terms somewhere else in the workbook (e.g. Sheet6!A:A) you could accomplish this with a single conditional formatting rule. I&#39;ve posted the alternate method above."}, {"owner": {"reputation": 63, "user_id": 6471599, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9b47e2036593eacbef1c9c4d09e0fa3?s=128&d=identicon&r=PG&f=1", "display_name": "Excellerator", "link": "https://stackoverflow.com/users/6471599/excellerator"}, "edited": false, "score": 0, "creation_date": 1466104467, "post_id": 37846142, "comment_id": 63192035, "body": "no I think you have it. I may be over-complicating my problem. I ended up doing something every similar to what you just suggested. You just did it in a more concise way than I managed to. Thank you for all your help!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1466103175, "last_edit_date": 1495535348, "creation_date": 1466026319, "answer_id": 37846142, "question_id": 37845442, "link": "https://stackoverflow.com/questions/37845442/test-if-conditional-formatting-is-true-vba-and-highlight-entire-row/37846142#37846142", "title": "Test if conditional formatting is TRUE VBA and highlight entire row", "body": "<p>Build an array and use a loop. A <a href=\"https://msdn.microsoft.com/en-us/library/wc500chb.aspx\" rel=\"nofollow noreferrer\">With ... End With statement</a> can handle the reference to the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff840834.aspx\" rel=\"nofollow noreferrer\">Application.Selection</a> property.</p>\n\n<pre><code>Option Explicit\n\nSub makeThreeCFrules()\n    Dim v As Long, vCFRs As Variant\n\n    vCFRs = Array(\"=ISNUMBER(SEARCH(\"\"Acadia Realty Trust \"\", $B1))\", vbYellow, _\n                  \"=ISNUMBER(SEARCH(\"\"Aimco \"\", $B1))\", vbYellow, _\n                  \"=ISNUMBER(SEARCH(\"\"Alexandria Real Estate Equities, Inc\"\", $B1))\", vbYellow)\n    With Selection.EntireRow\n        .FormatConditions.Delete\n        For v = LBound(vCFRs) To UBound(vCFRs) Step 2\n            With .FormatConditions.Add(Type:=xlExpression, Formula1:=vCFRs(v))\n                .Interior.Color = vCFRs(v + 1)\n            End With\n        Next v\n    End With\nEnd Sub\n</code></pre>\n\n<p>The problem with your formulas was that you needed to anchor the column with <code>$B1</code>.</p>\n\n<p><strong><a href=\"https://stackoverflow.com/questions/27119970/countifs-with-range-criteria-on-different-sheets/27122367#27122367\">Alternate:</a></strong></p>\n\n<p>If you can put a list of the search terms somewhere else in the workbook, you could accomplish this with a single 'reverse wildcard lookup'.</p>\n\n<p><a href=\"https://i.stack.imgur.com/EioEJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EioEJ.png\" alt=\"enter image description here\"></a><br/>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<sup>Search terms in Sheet6!A2:A4</sup></p>\n\n<pre><code>Option Explicit\n\nSub makeAllCFrules()\n    Dim v As Long, vCFRs As Variant\n\n    With Selection.EntireRow\n        .FormatConditions.Delete\n        With .FormatConditions.Add(Type:=xlExpression, _\n                Formula1:=\"=SUMPRODUCT(--ISNUMBER(MATCH(\"\"*\"\"&amp;Sheet6!$A$2:$A$4&amp;\"\"*\"\",$B1, 0)))\")\n            .Interior.Color = vbYellow\n        End With\n    End With\nEnd Sub\n</code></pre>\n\n<p>It is critically important that no blank rows be included in the search terms range. If there are, you will be searching for a double wildcard and that will include everything. Of course, the supplied sub procedure could be modified to find the address of the search terms if they are subject to change.</p>\n\n<p><a href=\"https://i.stack.imgur.com/v2NUi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/v2NUi.png\" alt=\"reverse_wildcard_results\"></a><br/>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<sup>With Conditional Formatting Rule applied after selecting B1:B99</sup></p>\n"}], "owner": {"reputation": 63, "user_id": 6471599, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9b47e2036593eacbef1c9c4d09e0fa3?s=128&d=identicon&r=PG&f=1", "display_name": "Excellerator", "link": "https://stackoverflow.com/users/6471599/excellerator"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1630, "favorite_count": 0, "accepted_answer_id": 37846142, "answer_count": 1, "score": 1, "last_activity_date": 1526286200, "creation_date": 1466023554, "last_edit_date": 1526286200, "question_id": 37845442, "link": "https://stackoverflow.com/questions/37845442/test-if-conditional-formatting-is-true-vba-and-highlight-entire-row", "title": "Test if conditional formatting is TRUE VBA and highlight entire row", "body": "<p>I am trying to determine whether or not a specific cell returns a TRUE value from conditional formatting, and then highlighting the entire row (or even just one cell) if it does return true. The conditional formatting is in column B, and would like it highlight the entire row.</p>\n\n<p>I am ultimately trying to add up numbers in column F if the conditional formatting returned TRUE in column B, but I can figure out that part if I can simply determine if the conditional formatting returned true or not. I have searched every forum, site, example, etc. I could find and still have not been able to make it work. </p>\n\n<p>I am running conditional formatting to search a large amount of data for multiple different instances. The only way I could figure out how to do it was to run each condition as a separate conditional format. Here is a portion of one of the subs (each sub has about 30 conditional formats and there are about 10 subs): </p>\n\n<pre><code> Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _\n\"=ISNUMBER(SEARCH(\"\"Acadia Realty Trust \"\",B1))\"\n Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n .PatternColorIndex = xlAutomatic\n.Color = 65535\n.TintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\nSelection.FormatConditions.Add Type:=xlExpression, Formula1:= _\n\"=ISNUMBER(SEARCH(\"\"Aimco \"\",B1))\"\n Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n .PatternColorIndex = xlAutomatic\n.Color = 65535\n.TintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\nSelection.FormatConditions.Add Type:=xlExpression, Formula1:= _\n\"=ISNUMBER(SEARCH(\"\"Alexandria Real Estate Equities, Inc\"\",B1))\"\n Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n .PatternColorIndex = xlAutomatic\n.Color = 65535\n.TintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n</code></pre>\n\n<p>I only say that to say that I can't simply check the same test with conditional formatting, because there almost 300 different tests.</p>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>I tried what Jeep suggested, and then what I commented below building multiple subs, each with an array in order to fit all 264 conditions, but when I did so <em>it only highlighted the last array, not all of the conditions</em> that were met in the first subs. I used the same code as @Jeeped suggested below, but put 24 conditions in the array, and I can that code into 11 subs, and my primary code looks as follows:</p>\n\n<pre><code>Public Sub REIT()\nrange(\"B:B\").Select\nCall A25\nCall B25\nCall C25\nCall D25\nCall E25\nCall F25\nCall G25\nCall H25\nCall I25\nCall J25\nCall K25\nEnd Sub\n</code></pre>\n\n<p>I ended up just using two help columns to re-search the criteria and sum the data I needed, but I still have a problem with the highlighting.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1466023231, "post_id": 37845278, "comment_id": 63151002, "body": "I&#39;m reasonably sure that a &#39;loading bar&#39; application modal dialog is not native to Excel. Are you sure this is not a CMS issue?"}, {"owner": {"reputation": 478, "user_id": 2366608, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/166f624b5eda6b7cb40c6cf26faccdac?s=128&d=identicon&r=PG&f=1", "display_name": "Acantud", "link": "https://stackoverflow.com/users/2366608/acantud"}, "edited": false, "score": 0, "creation_date": 1466023582, "post_id": 37845278, "comment_id": 63151168, "body": "It&#39;s definitely CMS that&#39;s popping the loading bar - the VBA sets an object reference to the already-running instance of CMS, and tells it to print a new report.  There doesn&#39;t appear to be anything I can do in CMS itself or in the VBA code to alter where that popup appears, so I&#39;m looking for something that will just freeze the display completely.  But if someone did have some CMS-specific i&#39;d gladly take it"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1466023791, "post_id": 37845278, "comment_id": 63151270, "body": "You can import some system routines like FindWindow then hunt for the dialog on the refresh. Destroying it will probably crash the routine as the internals will not be able to write new progress increments but you could use ShowWindow(hide) (\u25c4 not the correct syntax) to hide it or even MoveWindow to shove it completely off the desktop."}, {"owner": {"reputation": 478, "user_id": 2366608, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/166f624b5eda6b7cb40c6cf26faccdac?s=128&d=identicon&r=PG&f=1", "display_name": "Acantud", "link": "https://stackoverflow.com/users/2366608/acantud"}, "edited": false, "score": 0, "creation_date": 1466023962, "post_id": 37845278, "comment_id": 63151354, "body": "@Jeeped I think you&#39;re right, apparently there&#39;s that and the BringWindowToTop functions that might do it, i&#39;m going to mess with that - if it works i&#39;ll let you know so you can throw it in an answer if you want to"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1466024085, "post_id": 37845278, "comment_id": 63151428, "body": "If you are doing the research and implementation, you should self-answer this question. Likely get a few upvotes and you can mark it as the &#39;accepted answer&#39; after 48 hours."}], "answers": [{"comments": [{"owner": {"reputation": 478, "user_id": 2366608, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/166f624b5eda6b7cb40c6cf26faccdac?s=128&d=identicon&r=PG&f=1", "display_name": "Acantud", "link": "https://stackoverflow.com/users/2366608/acantud"}, "edited": false, "score": 0, "creation_date": 1466023447, "post_id": 37845364, "comment_id": 63151093, "body": "That didn&#39;t do it unfortunately - it&#39;s not Excel that&#39;s popping the loading menu, it&#39;s CMS, which the Excel macro is operating.  There is one other popup in CMS that I was able to hide during the process, but this obnoxious little loading bar doesn&#39;t seem to have any way to hide or more it through VBA"}], "tags": [], "owner": {"reputation": 77, "user_id": 5925960, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/e7d0738f837d5dd0cd0e1ce60a8b1393?s=128&d=identicon&r=PG", "display_name": "Will BeDeleted", "link": "https://stackoverflow.com/users/5925960/will-bedeleted"}, "is_accepted": false, "score": 0, "last_activity_date": 1466023228, "creation_date": 1466023228, "answer_id": 37845364, "question_id": 37845278, "link": "https://stackoverflow.com/questions/37845278/vba-freeze-screen-updating/37845364#37845364", "title": "VBA Freeze Screen Updating", "body": "<p>You can try:</p>\n\n<p>Application.DisplayAlerts = False<br>\nApplication.EnableEvents = False   </p>\n\n<p>and obvously turn them back on again after your code has executed</p>\n"}], "owner": {"reputation": 478, "user_id": 2366608, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/166f624b5eda6b7cb40c6cf26faccdac?s=128&d=identicon&r=PG&f=1", "display_name": "Acantud", "link": "https://stackoverflow.com/users/2366608/acantud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1543, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1466023228, "creation_date": 1466022906, "question_id": 37845278, "link": "https://stackoverflow.com/questions/37845278/vba-freeze-screen-updating", "title": "VBA Freeze Screen Updating", "body": "<p>Right off the bat, I am using Excel 2010 to run a macro, but \"Screen Updating = False\" is not going to work in this situation - </p>\n\n<p>I have an Excel sheet with some attractive formatting where I display some stats.  I have a macro that accesses an external program (CMS) to download updated stats a few times per minute.  The macro turns off screen updating, accesses CMS, copies the data, pastes it onto another sheet in the workbook, then resumes screen updating.  The idea is a live feed of this worksheet will be broadcast to people, and the stats will appear to magically update every few seconds.</p>\n\n<p>The problem I'm running into is, every time I pull the CMS data, a small loading bar window pops up in the middle of the screen.  Even though Excel Screen Updating is off, I haven't found a way to hide or move this loading bar out of the way.  I don't want the stream to have a loading bar appearing and lingering every time it updates.</p>\n\n<p>What I'd like to do is freeze <em>Windows'</em> screen for a second while the data is being accessed.  Is there any built-in library I could use, or other-language script I could invoke at the start of the function to freeze the Windows display while it runs, and resume it after it's complete?</p>\n"}, {"tags": ["excel", "vlookup", "vba"], "comments": [{"owner": {"reputation": 206726, "user_id": 5459839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iehrR.jpg?s=128&g=1", "display_name": "trincot", "link": "https://stackoverflow.com/users/5459839/trincot"}, "edited": false, "score": 1, "creation_date": 1466023111, "post_id": 37845277, "comment_id": 63150947, "body": "Please describe what you want to do, with sample data and desired outcome, what error you get, and on which line."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1466023114, "post_id": 37845277, "comment_id": 63150948, "body": "Unless you are looking for the string <code>b1</code> then you need to wrap that in <code>Range</code> so <code>Range(&quot;B1&quot;)</code>"}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1466026657, "post_id": 37845277, "comment_id": 63152682, "body": "Are you trying to make the formula on <code>A1</code> to be the <code>VLOOKUP</code>? If so you are not pointing to the right range element. Or are you just looking to have the result of the <code>VLOOKUP</code> in <code>A1</code>?"}, {"owner": {"reputation": 4928, "user_id": 2736233, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/1R16X.png?s=128&g=1", "display_name": "Ivan Gabriele", "link": "https://stackoverflow.com/users/2736233/ivan-gabriele"}, "reply_to_user": {"reputation": 206726, "user_id": 5459839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iehrR.jpg?s=128&g=1", "display_name": "trincot", "link": "https://stackoverflow.com/users/5459839/trincot"}, "edited": false, "score": 0, "creation_date": 1466038360, "post_id": 37845277, "comment_id": 63155918, "body": "To complete @trincot comment, you should read : <a href=\"http://stackoverflow.com/help/how-to-ask\">How do I ask a good question ?</a>"}, {"owner": {"reputation": 1, "user_id": 6471588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/216383581dcf9897f0ff5d7e8eb65c63?s=128&d=identicon&r=PG&f=1", "display_name": "John Patrick", "link": "https://stackoverflow.com/users/6471588/john-patrick"}, "edited": false, "score": 0, "creation_date": 1466153322, "post_id": 37845277, "comment_id": 63209345, "body": "My problem is I never put range before (&quot;b1&quot;). Thanks very much for the help."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1466023591, "creation_date": 1466023591, "answer_id": 37845454, "question_id": 37845277, "link": "https://stackoverflow.com/questions/37845277/vlookup-to-another-worksheet-as-worksheetfunction/37845454#37845454", "title": "Vlookup to another worksheet as WorksheetFunction", "body": "<p><code>\"b1\"</code> is not a range. While I hesitate to recommend square-bracket-referencing, you could try it as,</p>\n\n<pre><code>Range(\"a1\") = Application.WorksheetFunction.VLookup([B1], ActiveWorkbook.Worksheets(\"Trial Balance\").Range(\"B:I\"), 8, False)\n</code></pre>\n\n<p>I believe it would be better as,</p>\n\n<pre><code>with Worksheets(\"5200\")\n  .Range(\"a1\") = Application.VLookup(.Range(\"b1\"), _\n       .Parent.Worksheets(\"Trial Balance\").Range(\"B:I\"), 8, False)\nend with\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6471588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/216383581dcf9897f0ff5d7e8eb65c63?s=128&d=identicon&r=PG&f=1", "display_name": "John Patrick", "link": "https://stackoverflow.com/users/6471588/john-patrick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1466024533, "creation_date": 1466022901, "last_edit_date": 1531161705, "question_id": 37845277, "link": "https://stackoverflow.com/questions/37845277/vlookup-to-another-worksheet-as-worksheetfunction", "title": "Vlookup to another worksheet as WorksheetFunction", "body": "<p>I can't get this code to work.</p>\n\n<pre><code>Worksheets(\"5200\").Activate\nRange(\"a1\") = Application.WorksheetFunction.VLookup(\"b1\", ActiveWorkbook.Worksheets(\"Trial Balance\").Range(\"B:I\"), 8, False)\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1466022818, "post_id": 37845142, "comment_id": 63150809, "body": "You can do this yourself with simple subtraction formula on row of second date - please give something  a try and report back with you information that you tried"}, {"owner": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "edited": false, "score": 0, "creation_date": 1466022824, "post_id": 37845142, "comment_id": 63150812, "body": "What do SS, ES and EV mean? I don&#39;t understand your question."}, {"owner": {"reputation": 1, "user_id": 6338181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/008aa41663cdd35d33f7a46eed4b7e0e?s=128&d=identicon&r=PG&f=1", "display_name": "javed", "link": "https://stackoverflow.com/users/6338181/javed"}, "edited": false, "score": 0, "creation_date": 1466022896, "post_id": 37845142, "comment_id": 63150846, "body": "SS means start of shift, EV means Issues and ES means End of shift.i have bunch of data of around 1 year and i need to calculate the difference of engine meter between SS and EV of each date"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1466023355, "post_id": 37845142, "comment_id": 63151053, "body": "Please put in your example what your desired outcome would be."}, {"owner": {"reputation": 1, "user_id": 6338181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/008aa41663cdd35d33f7a46eed4b7e0e?s=128&d=identicon&r=PG&f=1", "display_name": "javed", "link": "https://stackoverflow.com/users/6338181/javed"}, "edited": false, "score": 0, "creation_date": 1466023906, "post_id": 37845142, "comment_id": 63151326, "body": "4-Mar-15\t1104\t   EV\t   76 4-Mar-15\t1104\t   EV\t   76 4-Mar-15\t1104\t   EV\t   76 4-Mar-15\t2681  EV\t 1653 4-Mar-15\t2681  ES\t 5-Mar-15\t2681  SS\t 5-Mar-15\t2682  EV\t1 5-Mar-15\t2682  EV\t1 5-Mar-15\t2682  EV\t1 5-Mar-15\t2704  EV\t23 5-Mar-15\t2704  EV\t23 If you see n 2nd and 3rd march no EV so, i don&#39;t want the data there.But in 4th and 5th i am having EV. SO each meter count of EV of 5th march should get subtracted from SS of 5th march"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1466024086, "post_id": 37845142, "comment_id": 63151429, "body": "Not in a comment, <a href=\"http://stackoverflow.com/posts/37845142/edit\">EDIT</a> your original question.  It is hard to understand in the comment."}, {"owner": {"reputation": 1, "user_id": 6338181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/008aa41663cdd35d33f7a46eed4b7e0e?s=128&d=identicon&r=PG&f=1", "display_name": "javed", "link": "https://stackoverflow.com/users/6338181/javed"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1466026330, "post_id": 37845142, "comment_id": 63152512, "body": "@Scott I have updated the question with required result."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6338181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/008aa41663cdd35d33f7a46eed4b7e0e?s=128&d=identicon&r=PG&f=1", "display_name": "javed", "link": "https://stackoverflow.com/users/6338181/javed"}, "edited": false, "score": 0, "creation_date": 1466027452, "post_id": 37846356, "comment_id": 63152995, "body": "That really helps.Thanks alot for your time and help.have great day."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 1, "user_id": 6338181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/008aa41663cdd35d33f7a46eed4b7e0e?s=128&d=identicon&r=PG&f=1", "display_name": "javed", "link": "https://stackoverflow.com/users/6338181/javed"}, "edited": false, "score": 0, "creation_date": 1466027501, "post_id": 37846356, "comment_id": 63153012, "body": "@javed this only works if it is sorted and every day starts with &quot;SS&quot;."}, {"owner": {"reputation": 1, "user_id": 6338181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/008aa41663cdd35d33f7a46eed4b7e0e?s=128&d=identicon&r=PG&f=1", "display_name": "javed", "link": "https://stackoverflow.com/users/6338181/javed"}, "edited": false, "score": 0, "creation_date": 1466027668, "post_id": 37846356, "comment_id": 63153083, "body": ",yes in my case it would work great since my day starts with SS only.Thanks 4 your advice."}, {"owner": {"reputation": 1, "user_id": 6338181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/008aa41663cdd35d33f7a46eed4b7e0e?s=128&d=identicon&r=PG&f=1", "display_name": "javed", "link": "https://stackoverflow.com/users/6338181/javed"}, "edited": false, "score": 0, "creation_date": 1466354962, "post_id": 37846356, "comment_id": 63271158, "body": ",can you please check the link [1]: <a href=\"http://i.stack.imgur.com/osAyx.jpg\" rel=\"nofollow noreferrer\">i.stack.imgur.com/osAyx.jpg</a> .Actually i want to compare the data between D and B rows,if the condition satisfies, it should return 1, else 0.For eg, if D7,D8,D9,D10 is less than 80% of B11, value in F7,F8,F9,F10 should be 1 else 0."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 1, "user_id": 6338181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/008aa41663cdd35d33f7a46eed4b7e0e?s=128&d=identicon&r=PG&f=1", "display_name": "javed", "link": "https://stackoverflow.com/users/6338181/javed"}, "edited": false, "score": 0, "creation_date": 1466368369, "post_id": 37846356, "comment_id": 63275009, "body": "That is a new question that should have it&#39;s own post."}, {"owner": {"reputation": 1, "user_id": 6338181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/008aa41663cdd35d33f7a46eed4b7e0e?s=128&d=identicon&r=PG&f=1", "display_name": "javed", "link": "https://stackoverflow.com/users/6338181/javed"}, "edited": false, "score": 0, "creation_date": 1466456997, "post_id": 37846356, "comment_id": 63314340, "body": "Hi Scott, I was able to get the output .Anyways thanks for your help."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1466027258, "creation_date": 1466027258, "answer_id": 37846356, "question_id": 37845142, "link": "https://stackoverflow.com/questions/37845142/calulation-of-data-between-columns-based-on-date/37846356#37846356", "title": "calulation of data between columns based on date", "body": "<p>You can use this array formula in D2:</p>\n\n<pre><code>=IF(C2=\"EV\",B2-INDEX($B$1:B2,MATCH(2,IF($C$1:C2=\"SS\",1))),\"\")\n</code></pre>\n\n<p>Being an array formula it needs to be confirmed with Ctrl-Shift-Enter instead of Enter when exiting edit mode.  If done properly Excel will put <code>{}</code> around the formula automatically.</p>\n\n<p>Then copy down.</p>\n\n<p><a href=\"https://i.stack.imgur.com/YJIKB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YJIKB.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 6338181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/008aa41663cdd35d33f7a46eed4b7e0e?s=128&d=identicon&r=PG&f=1", "display_name": "javed", "link": "https://stackoverflow.com/users/6338181/javed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 37846356, "answer_count": 1, "score": -3, "last_activity_date": 1466368361, "creation_date": 1466022355, "last_edit_date": 1531161705, "question_id": 37845142, "link": "https://stackoverflow.com/questions/37845142/calulation-of-data-between-columns-based-on-date", "title": "calulation of data between columns based on date", "body": "<p><a href=\"http://i.stack.imgur.com/osAyx.jpg\" rel=\"nofollow\">enter image description here</a>    date    engine_meter   workflow_indicator  Result</p>\n\n<pre><code>2-Mar-15    42           SS\n2-Mar-15    58           ES\n3-Mar-15    58           SS\n3-Mar-15   1028         ES   \n4-Mar-15   1028         SS\n4-Mar-15    1104    EV                     76\n4-Mar-15     1104   EV                     76\n4-Mar-15    1104    EV                     76\n4-Mar-15    2681    EV                    1653\n4-Mar-15    2681    ES\n5-Mar-15    2681    SS\n5-Mar-15    2682    EV                      1\n5-Mar-15    2682    EV                      1\n5-Mar-15    2682    EV                      1\n5-Mar-15    2704    EV                      23\n5-Mar-15    2704    EV                      23\n5-Mar-15    4287    ES\n</code></pre>\n\n<p>Three columns with Date, engine meter and Workflow.\nIn workflow, you can see SS,EV and ES</p>\n\n<p>Each date will have SS and ES.\nCan you please help me out to find out the difference of engine meter between the each EV and SS of each day.</p>\n\n<p>I want in F column ,if D7,D8,D9,D10 is less than X% of B11, than the value 1 should return otherwise it should return 0.Similar way for rest of the rows\nI am getting error. can you please help me out.</p>\n"}, {"tags": [".net", "vba", "excel", "type-mismatch"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1466022130, "post_id": 37844961, "comment_id": 63150454, "body": "A function returns something so you need to have it equal something.  Like: <code>t = Foo(r)</code> or change it to a sub instead of a function and call it like this: <code>Foo r</code>"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 6, "creation_date": 1466022403, "post_id": 37844961, "comment_id": 63150610, "body": "There&#39;s nothing wrong with your code syntax. Is that the actual calling code? On an unrelated note, saying VBA is bad or inadequate just because you don&#39;t understand its workings is foolish."}, {"owner": {"reputation": 51, "user_id": 3285861, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Wa71R.jpg?s=128&g=1", "display_name": "segfault", "link": "https://stackoverflow.com/users/3285861/segfault"}, "edited": false, "score": 0, "creation_date": 1466022819, "post_id": 37844961, "comment_id": 63150811, "body": "Sorry, for got that bit when typing it into the question (see edit). I tested again with the same result. Additionally, I agree! It is foolish to say a language is bad before you understand how it works. That&#39;s why I said &quot;probably.&quot; I&#39;d call it an educated guess."}, {"owner": {"reputation": 138646, "user_id": 1081897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46b160c4e606ce0be84dae336ab25f0?s=128&d=identicon&r=PG&f=1", "display_name": "D Stanley", "link": "https://stackoverflow.com/users/1081897/d-stanley"}, "edited": false, "score": 0, "creation_date": 1466022860, "post_id": 37844961, "comment_id": 63150832, "body": "Why do analog watches exist?  Why do corded phones exist?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1466023003, "post_id": 37844961, "comment_id": 63150904, "body": "You still need to have something in the calling sub into which the result will go.  Instead of <code>Foo(r)</code> put <code>Dim t as string: t=Foo(r)</code>"}, {"owner": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "edited": false, "score": 0, "creation_date": 1466023015, "post_id": 37844961, "comment_id": 63150911, "body": "What do you want to achieve with the line Foo(r)? If you wrote, for example, MsgBox Foo(r) then you would get a message box with the string output. Your line by itself doesn&#39;t mean anything."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1466023204, "post_id": 37844961, "comment_id": 63150989, "body": "Learn about VBA and using  functions and subroutines online - I&#39;m sure the example you found showed you the proper way to call and use it."}, {"owner": {"reputation": 51, "user_id": 3285861, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Wa71R.jpg?s=128&g=1", "display_name": "segfault", "link": "https://stackoverflow.com/users/3285861/segfault"}, "edited": false, "score": 0, "creation_date": 1466023227, "post_id": 37844961, "comment_id": 63151000, "body": "The function is a test, to try to figure out why I cannot a call another similar function. That is why is appears pointless: I simply removed everything else to narrow what I needed to look at."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "edited": false, "score": 0, "creation_date": 1466023480, "post_id": 37844961, "comment_id": 63151112, "body": "Did you try what I, or @ChrisMelville suggested?"}, {"owner": {"reputation": 51, "user_id": 3285861, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Wa71R.jpg?s=128&g=1", "display_name": "segfault", "link": "https://stackoverflow.com/users/3285861/segfault"}, "edited": false, "score": 0, "creation_date": 1466023728, "post_id": 37844961, "comment_id": 63151238, "body": "Yes, unfortunately it still does not work. Thanks for the suggestion though!"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1466070307, "post_id": 37844961, "comment_id": 63169182, "body": "Why are you using columns in your row? Let max_row = cells.CurrentRegion.Columns.Count then cells(max_row, ID_COL))  also what is ID_COL?"}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 3285861, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Wa71R.jpg?s=128&g=1", "display_name": "segfault", "link": "https://stackoverflow.com/users/3285861/segfault"}, "edited": false, "score": 0, "creation_date": 1466024580, "post_id": 37845487, "comment_id": 63151719, "body": "That code cause a mismatched  type error on the line &quot;Set rng = range(&quot;A2:A100&quot;)&quot; However, it is probably worth mentioning the VERY INTERESTING FACT that my vba editor immediately auto replaces all instances of &quot;Range&quot; with &quot;range&quot;."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 51, "user_id": 3285861, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Wa71R.jpg?s=128&g=1", "display_name": "segfault", "link": "https://stackoverflow.com/users/3285861/segfault"}, "edited": false, "score": 2, "creation_date": 1466024863, "post_id": 37845487, "comment_id": 63151840, "body": "@tumbleWeed101 dude, VBA is case-insensitive, and the VBA IDE (the glorious VBE) automatically formats a number of things. If you want to freak out, declare a local variable <code>Dim range As String</code> and see what happens to all the <code>Range</code>s everywhere. Oooooooooh magic!"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 51, "user_id": 3285861, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Wa71R.jpg?s=128&g=1", "display_name": "segfault", "link": "https://stackoverflow.com/users/3285861/segfault"}, "edited": false, "score": 0, "creation_date": 1466025211, "post_id": 37845487, "comment_id": 63152006, "body": "@tumbleWeed101 as Mat&#39;s Mug just said, you have declared range as a variable somewhere, either as a variable, sub or function."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 51, "user_id": 3285861, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Wa71R.jpg?s=128&g=1", "display_name": "segfault", "link": "https://stackoverflow.com/users/3285861/segfault"}, "edited": false, "score": 0, "creation_date": 1466025641, "post_id": 37845487, "comment_id": 63152214, "body": "OMG that&#39;s gotta be it! @tumbleWeed101 if <code>Range</code> gets corrected to <code>range</code> then you&#39;ve got a variable or something named <code>range</code>, and if that something is in scope then that&#39;s what you&#39;re calling. Replace your unqualified <code>Range(&quot;...&quot;)</code> calls with <code>ActiveSheet.Range(&quot;...&quot;)</code> (i.e. make these implicit active sheet references explicit)."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1466026189, "post_id": 37845487, "comment_id": 63152463, "body": "FYI a function doesn&#39;t <i>have</i> to return anything, nor do you have to use its return value even if it does. The original code worked as posted (barring the <code>range</code> issue)"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1466026395, "post_id": 37845487, "comment_id": 63152549, "body": "Interesting because when I did it it gave me the object error. @Rory See <a href=\"http://imgur.com/Cl3J1c5\" rel=\"nofollow noreferrer\">imgur.com/Cl3J1c5</a>"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1466026539, "post_id": 37845487, "comment_id": 63152622, "body": "The original code was not <code>foo (r)</code> (which is wrong) - it was <code>foo r</code> which is fine."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1466026879, "post_id": 37845487, "comment_id": 63152770, "body": "As would be <code>Call foo(r)</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1466026882, "post_id": 37845487, "comment_id": 63152772, "body": "@Rory well color me pink and call me &quot;pretty&quot;.  Now I need to figure out how to edit the answer as the comments here are what found the true error, so I do not want to delete it."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 3, "creation_date": 1466026986, "post_id": 37845487, "comment_id": 63152820, "body": "I&#39;ll just dig out my Psychedelic Furs album... :)"}, {"owner": {"reputation": 51, "user_id": 3285861, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Wa71R.jpg?s=128&g=1", "display_name": "segfault", "link": "https://stackoverflow.com/users/3285861/segfault"}, "edited": false, "score": 0, "creation_date": 1466027263, "post_id": 37845487, "comment_id": 63152917, "body": "I have ctrl-f searched the entire document. There is no variable range. I think there used to be one though. I will try rebooting the editor, maybe it was remembering a since deleted variable named &quot;range&quot;. It will have to be tomorrow though, as I just left work."}, {"owner": {"reputation": 51, "user_id": 3285861, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Wa71R.jpg?s=128&g=1", "display_name": "segfault", "link": "https://stackoverflow.com/users/3285861/segfault"}, "edited": false, "score": 0, "creation_date": 1466094585, "post_id": 37845487, "comment_id": 63186429, "body": "I rebooted the computer and the problem with auto-replacing went away, but the problem remains. However I am almost certain I know what the problem is now. I did not know that there was a Range object for Word as well as Excel, and I think when I define something as Range it defaults to the Word object. This explains just about everything. I just need to figure out how to reference the Excel lib Range explicitly, or I suppose I could make the function take a variant."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 4, "last_activity_date": 1466027037, "last_edit_date": 1466027037, "creation_date": 1466023703, "answer_id": 37845487, "question_id": 37844961, "link": "https://stackoverflow.com/questions/37844961/why-is-vba-throwing-type-mismatch-errors-when-passing-a-range-object/37845487#37845487", "title": "Why is VBA throwing type mismatch errors when passing a Range object?", "body": "<p>When using the <code>()</code> you need to assign it to a variable or other direction:</p>\n\n<pre><code>Function Foo(r As Range) As String\n    MsgBox \"WHAT. The function worked? Wow!\"\n    Foo = \"Test\"\nEnd Function\n\nSub fun()\nDim rng As Range\nSet rng = Range(\"A2:A100\")\nDim t As String\nt = Foo(rng)\nDebug.Print t\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/LFVmZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LFVmZ.png\" alt=\"enter image description here\"></a></p>\n\n<p>You can also just use <code>Foo rng</code> or <code>Call Foo(rng)</code></p>\n\n<p>Thanks to the ever correct @Rory</p>\n\n<hr>\n\n<p>But the real issue seems that you have used the word <code>range</code> as a variable, sub or Function elsewhere and this is superseding the correct usage of it as an object.</p>\n\n<p>As was pointed out by @Mat'sMug</p>\n"}, {"comments": [{"owner": {"reputation": 152, "user_id": 4870638, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-9Fbjg5X24VQ/AAAAAAAAAAI/AAAAAAAAAQQ/CeXziXrCJaI/photo.jpg?sz=128", "display_name": "Paaqua Grant", "link": "https://stackoverflow.com/users/4870638/paaqua-grant"}, "edited": false, "score": 0, "creation_date": 1466097405, "post_id": 37865255, "comment_id": 63188019, "body": "You should edit your original question to reflect the fact that there was a confounding factor, and that resolving that resolved the problem."}], "tags": [], "owner": {"reputation": 51, "user_id": 3285861, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Wa71R.jpg?s=128&g=1", "display_name": "segfault", "link": "https://stackoverflow.com/users/3285861/segfault"}, "is_accepted": true, "score": 1, "last_activity_date": 1466194950, "last_edit_date": 1466194950, "creation_date": 1466096382, "answer_id": 37865255, "question_id": 37844961, "link": "https://stackoverflow.com/questions/37844961/why-is-vba-throwing-type-mismatch-errors-when-passing-a-range-object/37865255#37865255", "title": "Why is VBA throwing type mismatch errors when passing a Range object?", "body": "<p>So the problem turned out to be that because this code was run from word, with the Excel library as a reference, the Range type defaulted to a MS-Word Range object instead of a MS-Excel Range object, meaning that my function was looking for the wrong type of parameter. Here is the corrected code (notice the explicit reference to the Excel lib when defining Foo and the Range variable r): </p>\n\n<pre><code>Function Foo(r As Excel.Range) As String\n    MsgBox \"WHAT. The function worked? Wow!\"\n    Foo = \"Test\"\nEnd Function\n\nSub main()\n    Set workbook = Excel.Workbooks.Open(\"example.xlsx\")\n    Set datasheet = workbook.ActiveSheet\n\n    Dim rng As Excel.Range\n    Set rng = datasheet.Range(\"A2:A100\")\n    Dim t As String\n    t = Foo(rng)\n    Debug.Print t\nEnd Sub\n</code></pre>\n\n<p>As @ScottCraner and others pointed out the issue could easily have been that I had a variable/function called Range defined somewhere else. In a way that is sort of what happened, only it was defined in the Word Library, not in my code.</p>\n"}], "owner": {"reputation": 51, "user_id": 3285861, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Wa71R.jpg?s=128&g=1", "display_name": "segfault", "link": "https://stackoverflow.com/users/3285861/segfault"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1072, "favorite_count": 0, "accepted_answer_id": 37865255, "answer_count": 2, "score": -6, "last_activity_date": 1466194950, "creation_date": 1466021776, "last_edit_date": 1531164843, "question_id": 37844961, "link": "https://stackoverflow.com/questions/37844961/why-is-vba-throwing-type-mismatch-errors-when-passing-a-range-object", "title": "Why is VBA throwing type mismatch errors when passing a Range object?", "body": "<p>I have this function (which I based off a function <a href=\"https://stackoverflow.com/questions/15888353/concatenate-multiple-ranges-using-vba\">here</a>):</p>\n\n<pre><code>Function Foo(ByVal r As range) As String\n    MsgBox \"WHAT. The function worked? Wow!\"\n    Foo = \"test\"\nEnd Function\n</code></pre>\n\n<p>I have tried calling it like so:</p>\n\n<pre><code>Let max_row = cells.CurrentRegion.Columns.Count\nSet r = range(cells(2, ID_COL), cells(max_row, ID_COL))\nFoo r\n</code></pre>\n\n<p>And I Always Get the Error: \"run-time error 13, type mismatch\" once the code hits the call to Foo.</p>\n\n<p>Additionally, I have tried:</p>\n\n<pre><code>Foo (r)\n</code></pre>\n\n<p>Which gives the error: \"Object Expected\" \nI assume this means that parentheses deference a pointer to its value, and are not (always?) used in function/subroutine calls.</p>\n\n<p>I have also tried writing the function without the \"ByVal\" but that failed as well.</p>\n\n<p>Any ideas?</p>\n\n<p>EDIT Tried what @ScottCraner suggested but the error remains:</p>\n\n<pre><code>Dim text As String\nLet max_row = cells.CurrentRegion.Columns.Count\nSet r = range(cells(2, ID_COL), cells(max_row, ID_COL))\ntext = Foo(r)\n</code></pre>\n\n<p>EDIT Important Note: this is being run from a Macro Enabled Word Document, the Excel Library is imported and the workbook is opened from the code.</p>\n"}, {"tags": ["arrays", "vba", "if-statement", "case"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1466021532, "post_id": 37844831, "comment_id": 63150145, "body": "Why does your Case criteria overlap?"}, {"owner": {"reputation": 113, "user_id": 6096077, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50e35954f90332fd8a6d54dd38ca9c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Zapata", "link": "https://stackoverflow.com/users/6096077/zapata"}, "edited": false, "score": 0, "creation_date": 1466022233, "post_id": 37844831, "comment_id": 63150511, "body": "just corrected it."}], "answers": [{"tags": [], "owner": {"reputation": 873, "user_id": 5103224, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d7d1ca72bbff93c0a014b5b770482a53?s=128&d=identicon&r=PG&f=1", "display_name": "Lowpar", "link": "https://stackoverflow.com/users/5103224/lowpar"}, "is_accepted": true, "score": 1, "last_activity_date": 1466021713, "creation_date": 1466021713, "answer_id": 37844939, "question_id": 37844831, "link": "https://stackoverflow.com/questions/37844831/select-case-statement-if-statement-define-array-vba/37844939#37844939", "title": "Select Case statement - IF statement - define array - VBA", "body": "<p>Usually when you use arrrays you need to redim (the array variable) -  ReDim Arr_Num3554(1)</p>\n"}, {"tags": [], "owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "is_accepted": false, "score": 1, "last_activity_date": 1466022228, "creation_date": 1466022228, "answer_id": 37845097, "question_id": 37844831, "link": "https://stackoverflow.com/questions/37844831/select-case-statement-if-statement-define-array-vba/37845097#37845097", "title": "Select Case statement - IF statement - define array - VBA", "body": "<p>Does your code even compile?  Try this instead, and note @Lowpar's comment as well:</p>\n\n<pre><code>Select Case num\n   Case 24 To 55\n       Arr_Num3554 = 1\n        Case Else\n       Arr_Num3554 = 0\n\n   Case 54 To 75\n       Arr_Num5574 = 1\n        Case Else\n       Arr_Num5574 = 0\n\n   Case 75 To 100\n       Arr_Num74plus= 1\n        Case Else\n       Arr_Num74plus= 0\n\nEnd Select\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 6096077, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50e35954f90332fd8a6d54dd38ca9c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Zapata", "link": "https://stackoverflow.com/users/6096077/zapata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 203, "favorite_count": 0, "accepted_answer_id": 37844939, "answer_count": 2, "score": 0, "last_activity_date": 1466022228, "creation_date": 1466021370, "last_edit_date": 1466022015, "question_id": 37844831, "link": "https://stackoverflow.com/questions/37844831/select-case-statement-if-statement-define-array-vba", "title": "Select Case statement - IF statement - define array - VBA", "body": "<p>I want to define new arrays according to the value of the age variable. I am new to VBA and here is my code that does not work. I have no error messages. I was wondering why the arrays do not get any value from this code!</p>\n\n<pre><code>Select Case num\n   Case 24 To 55\n       Arr_Num3554 = 1\n        Case Else\n       Arr_Num3554 = 0\n   End Select\n\nSelect Case Num\n   Case 54 To 75\n       Arr_Num5574 = 1\n        Case Else\n       Arr_Num5574 = 0\n   End Select\n\nSelect Case Num\n   Case 75 To 100\n       Arr_Num74plus= 1\n        Case Else\n       Arr_Num74plus= 0\n   End Select\n</code></pre>\n\n<hr>\n\n<p>Also I have tried an IF statement. Again I have the same problem</p>\n\n<pre><code>If 24 &lt; Num &lt; 55 Then Arr_Num3554 = 1 Else Arr_Num3554 = 0\nIf 54 &lt; Num &lt; 75 Then Arr_Num5574 = 1 Else Arr_Num5574 = 0\nIf 75 &lt; Num Then Arr_Num74plus = 1 Else Arr_Num74plus = 0\n</code></pre>\n"}, {"tags": ["vba", "excel", "dictionary"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1466019013, "post_id": 37843975, "comment_id": 63148790, "body": "It&#39;s unclear to me how you are loading the dictionary. Is the key the ID and the item the Name? Wouldn&#39;t it make more sense to reverse that and use the <a href=\"https://msdn.microsoft.com/en-us/library/office/gg251562.aspx\" rel=\"nofollow noreferrer\">Exists</a> method?"}], "answers": [{"tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 2, "last_activity_date": 1466019688, "last_edit_date": 1466019688, "creation_date": 1466019184, "answer_id": 37844244, "question_id": 37843975, "link": "https://stackoverflow.com/questions/37843975/looping-through-excel-vba-dictionary/37844244#37844244", "title": "Looping Through EXCEL VBA Dictionary", "body": "<p>Do you mean like this?</p>\n\n<p>Assuming your supervisor names are in column B starting in row 2:</p>\n\n<pre><code>Dim r As Long\nDim supervisorName As Range\n\nFor Each supervisorName In Range(\"B2:B\" &amp; Cells.(Rows.Count, 2).End(xlUp).Row).Cells\n    If superDictionary.Exists(supervisorName.Value) Then\n        r = 2 '// First row with data in\n        For Each key In superDictionary.Keys\n            If superDictionary(key) = supervisorName.Value And supervisorName.Row = r Then\n                supervisorName.Value = key\n                Exit For\n            Else\n                r = r + 1\n            End If\n        Next\n    End If\nNext\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 1, "creation_date": 1466020836, "post_id": 37844600, "comment_id": 63149796, "body": "I think OP only wants to replace the cell value from the dictionary if the supervisor name appears in the table at the same position that the ID appears in the dictionary. I could be completely wrong though..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1466021204, "post_id": 37844600, "comment_id": 63149985, "body": "No that sounds right. I chose to put the ID in a new column for demonstration purposes. If the OP wants to overwrite then he/she can change the 7 to a 6."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 3, "last_activity_date": 1505576373, "last_edit_date": 1505576373, "creation_date": 1466020512, "answer_id": 37844600, "question_id": 37843975, "link": "https://stackoverflow.com/questions/37843975/looping-through-excel-vba-dictionary/37844600#37844600", "title": "Looping Through EXCEL VBA Dictionary", "body": "<p>It doesn't seem like you are properly utilizing one of the most powerful features of a <a href=\"https://msdn.microsoft.com/en-us/library/office/gg251825.aspx\" rel=\"nofollow noreferrer\">Scripting.Dictionary</a> object; that being its fast retrieval capabilities. You essentially want to perform a lookup with two-column criteria so use the two columns as your <a href=\"https://msdn.microsoft.com/en-us/library/1ex01tte.aspx\" rel=\"nofollow noreferrer\">key</a> and the ID as the <a href=\"https://msdn.microsoft.com/en-us/library/84k9x471.aspx\" rel=\"nofollow noreferrer\">Item</a>.</p>\n\n<p>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<a href=\"https://i.stack.imgur.com/y8KzT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/y8KzT.png\" alt=\"dictionary_lookup\"></a></p>\n\n<pre><code>Option Explicit\n\nSub supervisorIDs()\n    Dim d As Variant, dict As Object\n    Dim v As Long, vVALs As Variant\n\n    Set dict = CreateObject(\"Scripting.Dictionary\")\n    dict.comparemode = vbTextCompare  'default is vbbinarycompare\n\n    With Worksheets(\"Sheet4\")\n        'get values from worksheet\n        vVALs = .Range(.Cells(2, 1), .Cells(Rows.Count, 3).End(xlUp)).Value2\n        'build dictionary\n        For v = LBound(vVALs, 1) To UBound(vVALs, 1)\n            'overwrite method - faster (no error control)\n            'writes name&amp;position as key, ID as item\n            dict.Item(Join(Array(vVALs(v, 2), vVALs(v, 3)), ChrW(8203))) = vVALs(v, 1)\n        Next v\n\n        'loop through the second table\n        For v = 2 To .Cells(Rows.Count, 6).End(xlUp).Row\n            d = Join(Array(.Cells(v, 6).Value2, .Cells(v, 5).Value2), ChrW(8203))\n            If dict.exists(d) Then _\n                .Cells(v, 7) = dict.Item(d)\n        Next v\n    End With\nEnd Sub\n</code></pre>\n\n<p>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<a href=\"https://i.stack.imgur.com/2A499.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2A499.png\" alt=\"dictionary_lookup_results\"></a></p>\n"}], "owner": {"reputation": 1363, "user_id": 415201, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/31f0f0e2b693a60e15eb4258cac3c0dc?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/415201/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5156, "favorite_count": 2, "answer_count": 2, "score": 2, "last_activity_date": 1505576373, "creation_date": 1466018156, "last_edit_date": 1466051955, "question_id": 37843975, "link": "https://stackoverflow.com/questions/37843975/looping-through-excel-vba-dictionary", "title": "Looping Through EXCEL VBA Dictionary", "body": "<p>I have a VBA Dictionary with the following data:</p>\n\n<pre><code>ID       NAME       POSITION \n5008004  John Doe   00120096\n5008002  John Doe2  00117886\n5010010  John Doe3  00117886\n</code></pre>\n\n<p>I have an Excel documented with the following cells:</p>\n\n<pre><code>POSITION    SUPERVISOR_NAME\n00117886    John Doe\n00117886    John Doe2\n00117886    John Doe3\n</code></pre>\n\n<p>Current Excel VBA code loops through the dictionary in the following fashion:</p>\n\n<pre><code>If SUPERVISOR_NAME &lt;&gt; \"\" Then\n    For Each myKey In superDictionary.Keys\n            If superDictionary(myKey) = SUPERVISOR_NAME Then\n                SUPERVISOR_NAME = myKey\n                Exit For\n            End If\n        Next\nEnd If\n</code></pre>\n\n<p>Resulting in replacing the JOHN DOE names with their associated IDs no matter what.</p>\n\n<p><strong>Question:</strong> How do I go about replacing the JOHN DOE names with their associated IDs BUT only when the POSITION and SUPERVISOR_NAME from EXCEL matches the Dictionary or ELSE submit nothing.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 7165, "user_id": 2250183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07f863401bc800df07245b6dfd1a66ab?s=128&d=identicon&r=PG", "display_name": "AndASM", "link": "https://stackoverflow.com/users/2250183/andasm"}, "edited": false, "score": 1, "creation_date": 1466019303, "post_id": 37844208, "comment_id": 63148963, "body": "No, the OP specified non-continuous then made it clear by their example they meant non-contiguous"}], "tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": false, "score": 0, "last_activity_date": 1466021291, "last_edit_date": 1466021291, "creation_date": 1466019058, "answer_id": 37844208, "question_id": 37843753, "link": "https://stackoverflow.com/questions/37843753/last-row-or-cell-in-a-non-contiguous-range-not-a-worksheet-search/37844208#37844208", "title": "Last Row or Cell in a Non-Contiguous Range {NOT a Worksheet search}", "body": "<p>Isn't the \"last\" row in a certain range determined by the fact that the next row is empty? In this case the following should do the trick:</p>\n\n<pre><code>Sub Test()\n\nDim unionRange As Range, currentRow As Range\nSet unionRange = Union(Range(\"A3:C5\"), Range(\"A8:C11\"))\n\nFor Each currentRow In unionRange.Rows\n    Dim lastRowIndex As Integer\n\n    If currentRow.Cells(1, 1).Offset(1, 0).Value = vbNullString Then\n        MsgBox \"Last Row in \" &amp; currentRow.Row\n    End If\n\nNext currentRow\n\nEnd Sub\n</code></pre>\n\n<h2>Update:</h2>\n\n<p>Thanks to @AndASM I just learned something new today!! I didn't know anything about <code>Areas</code>! So, please don't mark my answer as the correct one (even if this solves your problem).</p>\n\n<p>Yet, I would like to provide the following code because I believe that this might be more of what you are looking for:</p>\n\n<pre><code>Sub Test()\n\nDim unionRange As Range, currentRow As Range, subArea As Range\nSet unionRange = Union(Range(\"A3:C5\"), Range(\"A8:C11\"))\n\nFor Each currentRow In unionRange.Rows\n    For Each subArea In unionRange.Areas\n        If Not Intersect(subArea, currentRow) Is Nothing Then\n            If currentRow.Row = subArea.Row + subArea.Rows.Count - 1 Then\n                MsgBox \"Last Row in \" &amp; currentRow.Row\n            End If\n        End If\n    Next subArea\nNext currentRow\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 129, "user_id": 2842822, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/451fbfc9bc7fedbdb95b477d63ab4c24?s=128&d=identicon&r=PG&f=1", "display_name": "CassieD", "link": "https://stackoverflow.com/users/2842822/cassied"}, "edited": false, "score": 0, "creation_date": 1466023447, "post_id": 37844318, "comment_id": 63151095, "body": "Ah, I had tried to use area&#39;s but I didn&#39;t realize they were not sorted!  I must have picked the wrong one for my testing. Still, this is exactly what I wanted to know.  Unfortunately, this makes:        Dim lastRowIndex As Integer     For Each currentRow In unionRange.Rows         lastRowIndex = currentRow.row     Next currentRow   seem like the cleaner solution."}, {"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 0, "creation_date": 1466088150, "post_id": 37844318, "comment_id": 63181965, "body": "Very cool solution.  I had a similar project and built a workaround by keeping an area of the row indexes, but this is very effective"}, {"owner": {"reputation": 7165, "user_id": 2250183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07f863401bc800df07245b6dfd1a66ab?s=128&d=identicon&r=PG", "display_name": "AndASM", "link": "https://stackoverflow.com/users/2250183/andasm"}, "reply_to_user": {"reputation": 129, "user_id": 2842822, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/451fbfc9bc7fedbdb95b477d63ab4c24?s=128&d=identicon&r=PG&f=1", "display_name": "CassieD", "link": "https://stackoverflow.com/users/2842822/cassied"}, "edited": false, "score": 1, "creation_date": 1466103536, "post_id": 37844318, "comment_id": 63191580, "body": "@CassieD using the areas collection should run a bit faster and be just about as simple. Since there are never more areas than rows, and usually many more rows than areas, the areas loop has to run fewer times."}, {"owner": {"reputation": 129, "user_id": 2842822, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/451fbfc9bc7fedbdb95b477d63ab4c24?s=128&d=identicon&r=PG&f=1", "display_name": "CassieD", "link": "https://stackoverflow.com/users/2842822/cassied"}, "edited": false, "score": 0, "creation_date": 1466170567, "post_id": 37844318, "comment_id": 63220777, "body": "@AndASM Good point on the speed.  My code is processing a lot of data, and could use another speed improvement.  I&#39;ll make the change today."}], "tags": [], "owner": {"reputation": 7165, "user_id": 2250183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07f863401bc800df07245b6dfd1a66ab?s=128&d=identicon&r=PG", "display_name": "AndASM", "link": "https://stackoverflow.com/users/2250183/andasm"}, "is_accepted": true, "score": 6, "last_activity_date": 1466019868, "last_edit_date": 1466019868, "creation_date": 1466019498, "answer_id": 37844318, "question_id": 37843753, "link": "https://stackoverflow.com/questions/37843753/last-row-or-cell-in-a-non-contiguous-range-not-a-worksheet-search/37844318#37844318", "title": "Last Row or Cell in a Non-Contiguous Range {NOT a Worksheet search}", "body": "<p>You need to use the Areas property of the range. When a range is non-contiguous, it contains multiple Areas. Each area is the sub-range. Unfortunately areas are not sorted in any way. So you need to check each area in a loop then return the maximum row.</p>\n\n<p>In the below example I created a function that gives you the last row number in a non-contiguous range. The test sub prints the row number to the Immediate window in the Visual Basic for Applications editor.</p>\n\n<pre><code>Public Function GetLastRowOfNonContiguousArea(targetRange As Range) As Long\n    Dim subRange As Range\n    Dim maxRow As Long, areaMaxRow As Long\n\n    maxRow = 0\n\n    For Each subRange In targetRange.Areas\n        areaMaxRow = subRange.Rows(subRange.Rows.Count).Row\n        If areaMaxRow &gt; maxRow Then maxRow = areaMaxRow\n    Next subRange\n\n    GetLastRowOfNonContiguousArea = maxRow\nEnd Function\n\nPublic Sub test()\n    Dim testRange As Range\n\n    Set testRange = Union([A5:A9], [E20:F21], [C1:C3])\n\n    Debug.Print GetLastRowOfNonContiguousArea(testRange)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 129, "user_id": 2842822, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/451fbfc9bc7fedbdb95b477d63ab4c24?s=128&d=identicon&r=PG&f=1", "display_name": "CassieD", "link": "https://stackoverflow.com/users/2842822/cassied"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1114, "favorite_count": 2, "accepted_answer_id": 37844318, "answer_count": 2, "score": 4, "last_activity_date": 1466024481, "creation_date": 1466017341, "last_edit_date": 1531164843, "question_id": 37843753, "link": "https://stackoverflow.com/questions/37843753/last-row-or-cell-in-a-non-contiguous-range-not-a-worksheet-search", "title": "Last Row or Cell in a Non-Contiguous Range {NOT a Worksheet search}", "body": "<p>To start off, this is not the typical newbie question. I'm trying to find the last row (or cell) in a range I already created properly.</p>\n\n<p>In this example I have two ranges combined into one with union. Looping through the range, I get the data I want and things work great.</p>\n\n<pre><code>Sub Test()\n\n    Dim unionRange As Range, currentRow As Range\n    Set unionRange = Union(Range(\"A3:C5\"), Range(\"A8:C11\"))\n\n    For Each currentRow In unionRange.Rows\n        Debug.Print \"Row: \" &amp; currentRow.row\n    Next currentRow\n\nEnd Sub\n</code></pre>\n\n<p>Which gives these results</p>\n\n<pre><code>Row: 3\nRow: 4\nRow: 5\nRow: 8\nRow: 9\nRow: 10\nRow: 11\n</code></pre>\n\n<p>But when I want to try to determine if the current row is the last row in my range, I can't seem to find a clean way to get that information.  </p>\n\n<pre><code>Sub Test()\n\n    Dim unionRange As Range, currentRow As Range\n    Set unionRange = Union(Range(\"A3:C5\"), Range(\"A8:C11\"))\n\n    For Each currentRow In unionRange.Rows\n        Dim lastRowIndex As Integer\n\n        'lastRowIndex = unionRange. ???\n\n        If currentRow.row = lastRowIndex Then\n            MsgBox (\"Last Row\")\n        End If\n\n    Next currentRow\n\nEnd Sub\n</code></pre>\n\n<p>The reason it's so hard is that every solution I've tried just produces information in the first continuous group, as shown below.</p>\n\n<pre><code>    Debug.Print unionRange.Rows.Count ' 3 (should be 7)\n    Debug.Print unionRange.Rows(unionRange.Rows.Count).row ' 5 (should be 11)\n</code></pre>\n\n<p>Besides making a second loop before this one, is there any other way to get address information on that last row?</p>\n"}, {"tags": ["vba", "excel", "copy-paste"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1466017971, "post_id": 37843467, "comment_id": 63148216, "body": "Do you need the formatting, borders, conditional formats and data validation rules to follow, or just the values? If only the values, union the ranges to be copied, dump the source data into an array, then dump the array into the destination. Should be pretty much instant."}, {"owner": {"reputation": 17, "user_id": 6316145, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/ea15e8fb821f09a4d0a1eb4105d07166?s=128&d=identicon&r=PG&f=1", "display_name": "Hags", "link": "https://stackoverflow.com/users/6316145/hags"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1466019076, "post_id": 37843467, "comment_id": 63148823, "body": "@Mat&#39;sMug I just need the values to be copied and pasted...can you please post the coding for it so I can see the visual"}, {"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 0, "creation_date": 1466086593, "post_id": 37843467, "comment_id": 63180831, "body": "FYI, there is no need to select the sheet when using the Range.Copy Destination:= format.  (Further, there is DEFINITELY no need to select a sheet that is already selected)"}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 6316145, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/ea15e8fb821f09a4d0a1eb4105d07166?s=128&d=identicon&r=PG&f=1", "display_name": "Hags", "link": "https://stackoverflow.com/users/6316145/hags"}, "edited": false, "score": 0, "creation_date": 1466088636, "post_id": 37845261, "comment_id": 63182342, "body": "Hi @scott Craner, thank you but the process still takes a long time...any other recommendation?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 17, "user_id": 6316145, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/ea15e8fb821f09a4d0a1eb4105d07166?s=128&d=identicon&r=PG&f=1", "display_name": "Hags", "link": "https://stackoverflow.com/users/6316145/hags"}, "edited": false, "score": 0, "creation_date": 1466088765, "post_id": 37845261, "comment_id": 63182445, "body": "Then there are other things in your sub that causes this.  Make sure you go through your code and find ways to remove any <code>.Select</code> and <code>.Activate</code>."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 3, "last_activity_date": 1466022819, "creation_date": 1466022819, "answer_id": 37845261, "question_id": 37843467, "link": "https://stackoverflow.com/questions/37843467/how-can-i-speed-up-this-process-since-it-takes-a-very-long-time-to-copy-and-past/37845261#37845261", "title": "How can I speed up this process since it takes a very long time to copy and paste?", "body": "<p>You can simply assign the values directly using the Resize() Function to make the ranges the same size:</p>\n\n<pre><code>With Sheets(\"CDGL\")\n    Sheets(\"Rec\").Range(\"B6\").Resize(.Cells(.Rows.Count, \"G\").End(xlUp).Row - 1, 3).Value = .Range(\"H2:J\" &amp; .Cells(.Rows.Count, \"G\").End(xlUp).Row).Value\n    Sheets(\"Rec\").Range(\"E6\").Resize(.Cells(.Rows.Count, \"K\").End(xlUp).Row - 1, 4).Value = .Range(\"L2:O\" &amp; .Cells(.Rows.Count, \"K\").End(xlUp).Row).Value\n    Sheets(\"Rec\").Range(\"I6\").Resize(.Cells(.Rows.Count, \"AI\").End(xlUp).Row - 1, 1).Value = .Range(\"AJ2:AJ\" &amp; .Cells(.Rows.Count, \"AI\").End(xlUp).Row).Value\nEnd With\n</code></pre>\n\n<p>I also used a With Block and the Appropriate <code>.</code> identifier to reduce typing and removing the continual selection of sheets.  This will also cut down the time.</p>\n"}, {"tags": [], "owner": {"reputation": 37, "user_id": 4589821, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xvXvd.png?s=128&g=1", "display_name": "Bu_ali", "link": "https://stackoverflow.com/users/4589821/bu-ali"}, "is_accepted": false, "score": 0, "last_activity_date": 1466066459, "creation_date": 1466066459, "answer_id": 37854078, "question_id": 37843467, "link": "https://stackoverflow.com/questions/37843467/how-can-i-speed-up-this-process-since-it-takes-a-very-long-time-to-copy-and-past/37854078#37854078", "title": "How can I speed up this process since it takes a very long time to copy and paste?", "body": "<p>When you need a fast copy/paste, avoid copying to clipboard and pasting again. You could have simply used the Range.Value method, something like the following:</p>\n\n<pre><code>With Sheets(\"CDGL\")\nrows_c1 = .Cells(Rows.Count, \"G\").End(xlUp).Row\nSheets(\"Rec\").Range(\"B6:D\" &amp; rows_c1).Value = Sheets(\"CDGL\").Range(\"H2:J\" &amp; rows_c1).Value\n\nrows_c2 = .Cells(Rows.Count, \"K\").End(xlUp).Row\nSheets(\"Rec\").Range(\"E6:H\" &amp; rows_c2).Value = Sheets(\"CDGL\").Range(\"L2:O\" &amp; rows_c2).Value\n\nrows_c3 = .Cells(Rows.Count, \"AI\").End(xlUp).Row\nSheets(\"Rec\").Range(\"I6:I\" &amp; rows_c3).Value = Sheets(\"CDGL\").Range(\"AJ2:AJ\" &amp; rows_c3).Value\nEnd With\n</code></pre>\n\n<p>Should you need to have the formatting of cells copied, the Range property \"Value\" can have 3 optional arguments 10,11,12. 11 is what you need to transfer both value, formats, and formulas.\nSomething like this:</p>\n\n<pre><code>Sheets(\"Rec\").Range(\"B6:D\" &amp; rows_c1).Value(11) = Sheets(\"CDGL\").Range(\"H2:J\" &amp; rows_c1).Value(11)\n</code></pre>\n\n<p>Also, avoid using \"Select\" and use the \"With....End With\" statement to speed up the execution.</p>\n"}, {"tags": [], "owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "is_accepted": false, "score": 0, "last_activity_date": 1466086689, "creation_date": 1466086689, "answer_id": 37861854, "question_id": 37843467, "link": "https://stackoverflow.com/questions/37843467/how-can-i-speed-up-this-process-since-it-takes-a-very-long-time-to-copy-and-past/37861854#37861854", "title": "How can I speed up this process since it takes a very long time to copy and paste?", "body": "<p>If your issue isn't the effectiveness of the code but the time it takes to work, add <code>Application.ScreenUpdating = False</code> to the start of your sub and <code>Application.ScreenUpdating = True</code> to the end.  This will speed up the wait time immensely</p>\n"}], "owner": {"reputation": 17, "user_id": 6316145, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/ea15e8fb821f09a4d0a1eb4105d07166?s=128&d=identicon&r=PG&f=1", "display_name": "Hags", "link": "https://stackoverflow.com/users/6316145/hags"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1466086689, "creation_date": 1466016440, "last_edit_date": 1531164843, "question_id": 37843467, "link": "https://stackoverflow.com/questions/37843467/how-can-i-speed-up-this-process-since-it-takes-a-very-long-time-to-copy-and-past", "title": "How can I speed up this process since it takes a very long time to copy and paste?", "body": "<p>Is there anyway to combine to following steps since I am pulling the data from the same sheet into another sheet and the process is very slow. </p>\n\n<pre><code>Sheets(\"CDGL\").Select\nSheets(\"CDGL\").Range(\"H2:J\" &amp; Cells(Rows.Count, \"G\").End(xlUp).Row).Copy Destination:=Sheets(\"Rec\").Range(\"B6\")\n\nSheets(\"CDGL\").Select\nSheets(\"CDGL\").Range(\"L2:O\" &amp; Cells(Rows.Count, \"K\").End(xlUp).Row).Copy Destination:=Sheets(\"Rec\").Range(\"E6\")\n\nSheets(\"CDGL\").Select\nSheets(\"CDGL\").Range(\"AJ2:AJ\" &amp; Cells(Rows.Count, \"AI\").End(xlUp).Row).Copy Destination:=Sheets(\"Rec\").Range(\"I6\")\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "excel-2010", "vba"], "comments": [{"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1466018001, "post_id": 37843382, "comment_id": 63148232, "body": "is an entry = to an entire row?"}, {"owner": {"reputation": 101, "user_id": 5952552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42bec89ca97ab7fa39c9166726140e8b?s=128&d=identicon&r=PG&f=1", "display_name": "shotsy247", "link": "https://stackoverflow.com/users/5952552/shotsy247"}, "reply_to_user": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1466094972, "post_id": 37843382, "comment_id": 63186645, "body": "@Forward Ed, yes by entry I mean a row."}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 5952552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42bec89ca97ab7fa39c9166726140e8b?s=128&d=identicon&r=PG&f=1", "display_name": "shotsy247", "link": "https://stackoverflow.com/users/5952552/shotsy247"}, "edited": false, "score": 0, "creation_date": 1466076160, "post_id": 37843973, "comment_id": 63172927, "body": "Thanks for the explanation Forward Ed. That helped me adjust the formula to return the correct answer."}, {"owner": {"reputation": 169, "user_id": 5878778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f162c4c001f0353cdbe1c2b543af740?s=128&d=identicon&r=PG&f=1", "display_name": "Ramana Viswanadha", "link": "https://stackoverflow.com/users/5878778/ramana-viswanadha"}, "reply_to_user": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1466082871, "post_id": 37843973, "comment_id": 63177784, "body": "@ForwardEd If I change the * to a +. Then I might end up summing up the same cell multiple times. For example if cell d2 is not equal to x, it add 1. Next if cell D2 is not equal to Y, it adds another 1, same with with Z. You could end up potentially having a count of 3 for the same exact cell. With the way I did it. It only counts if it is not equal any of th 3. So no duplicate values are counted."}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1466087460, "post_id": 37843973, "comment_id": 63181505, "body": "@RamanaViswanadha  You are absolutely correct.  For what ever reason I had it stuck in my head that &lt;&gt; was actually =.  My appologies."}, {"owner": {"reputation": 169, "user_id": 5878778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f162c4c001f0353cdbe1c2b543af740?s=128&d=identicon&r=PG&f=1", "display_name": "Ramana Viswanadha", "link": "https://stackoverflow.com/users/5878778/ramana-viswanadha"}, "reply_to_user": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1466088270, "post_id": 37843973, "comment_id": 63182062, "body": "@ForwardEd No worries. I originally did it the way you had, but noticed the count off in my sample data. Found out that I was summing up the same cell multiple times with the +"}, {"owner": {"reputation": 101, "user_id": 5952552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42bec89ca97ab7fa39c9166726140e8b?s=128&d=identicon&r=PG&f=1", "display_name": "shotsy247", "link": "https://stackoverflow.com/users/5952552/shotsy247"}, "edited": false, "score": 0, "creation_date": 1466094887, "post_id": 37843973, "comment_id": 63186602, "body": "This solution is counting the rows multiple times."}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "reply_to_user": {"reputation": 101, "user_id": 5952552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42bec89ca97ab7fa39c9166726140e8b?s=128&d=identicon&r=PG&f=1", "display_name": "shotsy247", "link": "https://stackoverflow.com/users/5952552/shotsy247"}, "edited": false, "score": 1, "creation_date": 1466095024, "post_id": 37843973, "comment_id": 63186681, "body": "@shotsy247 There is a fundamental difference between this solution and my solution and it has to do with the question I ask in comments under your original question.  This solution counts individual cells, and my solution counts rows.  We needed to know what you consider an entry."}], "tags": [], "owner": {"reputation": 169, "user_id": 5878778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f162c4c001f0353cdbe1c2b543af740?s=128&d=identicon&r=PG&f=1", "display_name": "Ramana Viswanadha", "link": "https://stackoverflow.com/users/5878778/ramana-viswanadha"}, "is_accepted": false, "score": 1, "last_activity_date": 1466018143, "creation_date": 1466018143, "answer_id": 37843973, "question_id": 37843382, "link": "https://stackoverflow.com/questions/37843382/excel-2010-countif-and-or/37843973#37843973", "title": "Excel 2010 COUNTIF AND OR", "body": "<p>You can use the following array formula, just adjust the variables \"X, Y, Z\" to whatever you criteria you need it to be and change the range to fit your range of data. </p>\n\n<pre><code>=COUNTIF(A1:A10,\"X\")+COUNTIF(B1:B10,\"X\")+COUNTIF(C1:C10,\"x\")+SUM((D1:D10&lt;&gt;\"X\")*(D1:D10&lt;&gt;\"Y\")*(D1:D10&lt;&gt;\"Z\"))\n</code></pre>\n\n<p>You have to press CTRL + SHIFT + Enter to calculate this array formula, will not work with a standard enter. </p>\n"}, {"comments": [{"owner": {"reputation": 101, "user_id": 5952552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42bec89ca97ab7fa39c9166726140e8b?s=128&d=identicon&r=PG&f=1", "display_name": "shotsy247", "link": "https://stackoverflow.com/users/5952552/shotsy247"}, "edited": false, "score": 0, "creation_date": 1466076238, "post_id": 37844095, "comment_id": 63172982, "body": "Thanks @Forward Ed. I used: <code>=sumproduct(NOT(NOT(((A:A=&quot;X&quot;)+(B:B=&quot;X&quot;)+(C:C=&quot;X&quot;))))*((D:D&lt;&zwnj;&#8203;&gt;&quot;X&quot;)*(D:D&lt;&gt;&quot;Y&quot;)*(D:&zwnj;&#8203;D&lt;&gt;&quot;Z)))</code>"}], "tags": [], "owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "is_accepted": true, "score": 1, "last_activity_date": 1466095183, "last_edit_date": 1466095183, "creation_date": 1466018621, "answer_id": 37844095, "question_id": 37843382, "link": "https://stackoverflow.com/questions/37843382/excel-2010-countif-and-or/37844095#37844095", "title": "Excel 2010 COUNTIF AND OR", "body": "<pre><code>=sumproduct(NOT(NOT(((A:A=\"X\")+(B:B=\"X\")+(C:C=\"X\"))))*((D:D&lt;&gt;\"X\")*(D:D&lt;&gt;\"Y\")*(D:D&lt;&gt;\"Z)))\n</code></pre>\n\n<p>This is with the assumption that an entire row is considered the entry not each individual cell.</p>\n\n<p>This can be computationally intensive with full column reference.  Better if used over a defined range.</p>\n"}], "owner": {"reputation": 101, "user_id": 5952552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42bec89ca97ab7fa39c9166726140e8b?s=128&d=identicon&r=PG&f=1", "display_name": "shotsy247", "link": "https://stackoverflow.com/users/5952552/shotsy247"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 37844095, "answer_count": 2, "score": 0, "last_activity_date": 1466095183, "creation_date": 1466016201, "last_edit_date": 1531164843, "question_id": 37843382, "link": "https://stackoverflow.com/questions/37843382/excel-2010-countif-and-or", "title": "Excel 2010 COUNTIF AND OR", "body": "<p>I'm creating a report where I need to count all entries where (column a = x or column b = x or column c = x) and (column d &lt;> x or y or z)</p>\n\n<p>I'm open to any solutions scripted or expression.</p>\n\n<p>Thank you.</p>\n\n<p>_t</p>\n"}, {"tags": ["excel", "vba", "macros", "percentile"], "answers": [{"comments": [{"owner": {"reputation": 17346, "user_id": 1693085, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/89d96f4a92f0053e9f2c9a8b06c011a0?s=128&d=identicon&r=PG", "display_name": "John Bustos", "link": "https://stackoverflow.com/users/1693085/john-bustos"}, "reply_to_user": {"reputation": 57, "user_id": 6445930, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/34b1ddda559c977291a0b55178c12b72?s=128&d=identicon&r=PG&f=1", "display_name": "cam", "link": "https://stackoverflow.com/users/6445930/cam"}, "edited": false, "score": 0, "creation_date": 1466017531, "post_id": 37843472, "comment_id": 63147965, "body": "@cam, Have you tried it in your spreadsheet directly? What are the values in <code>relevant_array</code> and for <code>answer</code>?"}], "tags": [], "owner": {"reputation": 17346, "user_id": 1693085, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/89d96f4a92f0053e9f2c9a8b06c011a0?s=128&d=identicon&r=PG", "display_name": "John Bustos", "link": "https://stackoverflow.com/users/1693085/john-bustos"}, "is_accepted": false, "score": 1, "last_activity_date": 1466016444, "creation_date": 1466016444, "answer_id": 37843472, "question_id": 37843279, "link": "https://stackoverflow.com/questions/37843279/when-running-percentrank-i-receive-the-unable-to-get-the-percentrank-property-o/37843472#37843472", "title": "When running PERCENTRANK I receive the &quot;Unable to get the PercentRank property of the WorksheetFunction class&quot; error", "body": "<p>What you're seeing is due to the fact that <code>PercentRank</code> works on an array / range, not an address. </p>\n\n<p>Try changing that line to:</p>\n\n<pre><code>x = WorksheetFunction.PercentRank(relevant_array, answer)\n</code></pre>\n\n<p>That should fix it.</p>\n"}], "owner": {"reputation": 57, "user_id": 6445930, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/34b1ddda559c977291a0b55178c12b72?s=128&d=identicon&r=PG&f=1", "display_name": "cam", "link": "https://stackoverflow.com/users/6445930/cam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1466016444, "creation_date": 1466015838, "question_id": 37843279, "link": "https://stackoverflow.com/questions/37843279/when-running-percentrank-i-receive-the-unable-to-get-the-percentrank-property-o", "title": "When running PERCENTRANK I receive the &quot;Unable to get the PercentRank property of the WorksheetFunction class&quot; error", "body": "<p>I am trying to use the PERCENTRANK function to find what percentile the 'answer' ranks within column 'B'.  Starting at \"Dim x As Double\" is where the PercentRank function starts, I just included the rest of the code to show what else I am doing. </p>\n\n<pre><code>  Dim response As VbMsgBoxResult\n    response = MsgBox(\"Is This Item Catch Weight?\", vbYesNo)\n  If response = vbNo Then\n    Dim cost, weight, answer As Variant\n    Dim myrng As Range\n        cost = InputBox(\"Please Enter PO Cost\")\n        weight = InputBox(\"Please Enter Net Weight\")\n        answer = cost / weight\n        MsgBox \"Price per KG is: \" &amp; answer\n        Dim x As Double\n            Set ws = ActiveWorkbook.Worksheets(\"Sheet1\")\n            Set relevant_array = ws.Range(ws.Range(\"B1\"), ws.Range(\"B1\").End(xlDown))\n            x = WorksheetFunction.PercentRank(relevant_array.Address, answer)\n            Debug.Print x\n        Exit Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1466016612, "post_id": 37843483, "comment_id": 63147457, "body": "Thanks for the suggestion, but on my computer <code>Alt + F4</code> shuts down the entire VBA window rather than just the Immediate Window <i>(pane)</i>"}, {"owner": {"reputation": 698, "user_id": 3191764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44be94e3b3d77c9f14b41b1d1c5fa66b?s=128&d=identicon&r=PG", "display_name": "Alex D", "link": "https://stackoverflow.com/users/3191764/alex-d"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 2, "creation_date": 1466016639, "post_id": 37843483, "comment_id": 63147477, "body": "@Gary&#39;sStudent This won&#39;t work in the docked/pane state, but it will once you undock it. And <code>Ctrl+G</code> will reopen it in an undocked state, which you can once again close with <code>Alt+F4</code> if you use <code>Ctrl+G</code> to make it the active panel."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1466017506, "post_id": 37843483, "comment_id": 63147951, "body": "@Sgdva..........Nice idea...............I have never tried to un-dock these &quot;panes&quot;................I now see that sometimes &quot;panes&quot; can be &quot;pains&quot;"}], "tags": [], "owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "is_accepted": true, "score": 2, "last_activity_date": 1466017089, "last_edit_date": 1466017089, "creation_date": 1466016463, "answer_id": 37843483, "question_id": 37843266, "link": "https://stackoverflow.com/questions/37843266/close-the-immediate-window-vba/37843483#37843483", "title": "Close the Immediate Window - VBA", "body": "<p>Since it's really a window (not longer a command) you can use Alt+F4 (close active instance) like any other application <strong><em>(as long as its the active window)</em></strong><br>\n<strong>UPDATE:</strong> <br>\nYou may try Ctrl+F4 -close active window of the instance- (if it's not docked).<br>\nIf it's docked, it belong to the instance of vba itself, so, I'm not quite sure how would you call the element to take it off from the dock and then close it.</p>\n"}, {"comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 1, "creation_date": 1466017593, "post_id": 37843659, "comment_id": 63147999, "body": "Thanks!!........................ <i>(and I can assign keystrokes to your sub and avoid the mouse)</i>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1466017616, "post_id": 37843659, "comment_id": 63148010, "body": "Ha! didn&#39;t think of that!"}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1466024118, "post_id": 37843659, "comment_id": 63151442, "body": "This works with the object itself (so doesn&#39;t matter if dock able or not dock able) so +1"}, {"owner": {"reputation": 825, "user_id": 1898524, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p6C9A.jpg?s=128&g=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/1898524/ben"}, "edited": false, "score": 0, "creation_date": 1539108669, "post_id": 37843659, "comment_id": 92379184, "body": "Thanks for the concise answer.  <code>Application.VBE.Windows(&quot;Immediate&quot;).Visible = False</code> also works, and thus you can open / show the Immediate window with <code>Application.VBE.Windows(&quot;Immediate&quot;).Visible = True</code>"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 6, "last_activity_date": 1466017019, "creation_date": 1466017019, "answer_id": 37843659, "question_id": 37843266, "link": "https://stackoverflow.com/questions/37843266/close-the-immediate-window-vba/37843659#37843659", "title": "Close the Immediate Window - VBA", "body": "<p>You could write a macro for this :)</p>\n\n<p>Have this code in a standard module (requires programmatic access to the VBIDE API):</p>\n\n<pre><code>Public Sub CloseImmediatePane()\n    Application.VBE.Windows(\"Immediate\").Close\nEnd Sub\n</code></pre>\n\n<p>Programmatically closing the immediate pane from the immediate pane will only make it flicker (close and come back), so you can't run this macro from the immediate pane... but you can place your cursor inside the procedure and hit <kbd>F5</kbd>, and it works, docked or not!</p>\n\n<p><sub>Funky creative ideas are allowed, right?</sub></p>\n"}], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 977, "favorite_count": 0, "accepted_answer_id": 37843483, "answer_count": 2, "score": 3, "last_activity_date": 1466017089, "creation_date": 1466015795, "last_edit_date": 1531164843, "question_id": 37843266, "link": "https://stackoverflow.com/questions/37843266/close-the-immediate-window-vba", "title": "Close the Immediate Window - VBA", "body": "<p>With the VBA window active, I can open the Immediate Window <em>(really a pane)</em> in two ways:</p>\n\n<ul>\n<li><strong>with the mouse</strong> - on the Menu Bar - <em>View > Immediate Window</em></li>\n<li><strong>with the keyboard</strong> - touch <kbd>Ctrl</kbd> + <kbd>g</kbd></li>\n</ul>\n\n<p>I can close the Immediate Window with the mouse by clicking the red \"x\" at the Window's upper right-hand corner.</p>\n\n<p>How can I close the Immediate Window <em>(only the bottom pane)</em> using only the keyboard <em>(without the mouse)</em> ??</p>\n"}, {"tags": ["vba", "excel", "ontime"], "answers": [{"comments": [{"owner": {"reputation": 145, "user_id": 5869434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7061830aa142801cf81c2ba27b47af00?s=128&d=identicon&r=PG&f=1", "display_name": "sims", "link": "https://stackoverflow.com/users/5869434/sims"}, "edited": false, "score": 0, "creation_date": 1466019876, "post_id": 37843465, "comment_id": 63149290, "body": ":Thanks for the answer.  I thought about something like that but I was trying to avoid to transfer the code from my Sub CommandButton1_Click to a standard module.  When I do that I&#39;m getting an error 91 which I&#39;m not getting when my code is not in the module.  I was hoping that I could simply call my CommanButton1_Click sub..."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 145, "user_id": 5869434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7061830aa142801cf81c2ba27b47af00?s=128&d=identicon&r=PG&f=1", "display_name": "sims", "link": "https://stackoverflow.com/users/5869434/sims"}, "edited": false, "score": 0, "creation_date": 1466020063, "post_id": 37843465, "comment_id": 63149379, "body": "@sims  You might need to possibly modify the button code to avoid using button-specific thing like <code>Me</code>"}, {"owner": {"reputation": 145, "user_id": 5869434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7061830aa142801cf81c2ba27b47af00?s=128&d=identicon&r=PG&f=1", "display_name": "sims", "link": "https://stackoverflow.com/users/5869434/sims"}, "edited": false, "score": 0, "creation_date": 1466024298, "post_id": 37843465, "comment_id": 63151559, "body": "Thanks Gary.  I did make the correction to get rid of the Me&#39;s but I&#39;m still getting an error 91.  Your answer works though.  Thanks for your help."}, {"owner": {"reputation": 145, "user_id": 5869434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7061830aa142801cf81c2ba27b47af00?s=128&d=identicon&r=PG&f=1", "display_name": "sims", "link": "https://stackoverflow.com/users/5869434/sims"}, "edited": false, "score": 1, "creation_date": 1466039098, "post_id": 37843465, "comment_id": 63156077, "body": "It finally worked for me. I placed all the code that was in the CommandButton1_click in a the same usrform1 as a sub called &quot;finished&quot;.  OnTime called a sub in my Module1 which called my sub in my form by using usrform1.finished.  I know it&#39;s not elegant but it works for me.  Your help is very much appreciated!"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 1, "last_activity_date": 1466016432, "creation_date": 1466016432, "answer_id": 37843465, "question_id": 37843233, "link": "https://stackoverflow.com/questions/37843233/excel-vba-how-to-use-application-ontime-to-call-a-click-event/37843465#37843465", "title": "Excel VBA: How to use Application.ontime to call a click event?", "body": "<p>You need to expose the desired functionality.  In a standard module enter, for example:</p>\n\n<pre><code>Public Sub ReallyVisibleMacro()\n    MsgBox \"Hello World\"\nEnd Sub\n</code></pre>\n\n<p>This sub does all the real work.  Then your button code would be:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Call ReallyVisibleMacro\nEnd Sub\n</code></pre>\n\n<p>and in the OnTime code:</p>\n\n<pre><code>Application.OnTime Now + TimeValue(\"00:00:15\"), \"ReallyVisibleMacro\"\n</code></pre>\n"}], "owner": {"reputation": 145, "user_id": 5869434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7061830aa142801cf81c2ba27b47af00?s=128&d=identicon&r=PG&f=1", "display_name": "sims", "link": "https://stackoverflow.com/users/5869434/sims"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1261, "favorite_count": 0, "accepted_answer_id": 37843465, "answer_count": 1, "score": 2, "last_activity_date": 1466016432, "creation_date": 1466015658, "question_id": 37843233, "link": "https://stackoverflow.com/questions/37843233/excel-vba-how-to-use-application-ontime-to-call-a-click-event", "title": "Excel VBA: How to use Application.ontime to call a click event?", "body": "<p>I'd like to use the Application.ontime method to call a button_click event on my Excel form.</p>\n\n<p>when i use this code I can call a sub located in my Module1:</p>\n\n<pre><code>Application.OnTime Now + TimeValue(\"00:00:15\"), \"test\"\n</code></pre>\n\n<p>However if I use this code it doesn't call my Private Sub CommandButton1_Click (it does nothing):</p>\n\n<pre><code>Application.OnTime Now + TimeValue(\"00:00:15\"), \"CommandButton1_Click\"\n</code></pre>\n\n<p>How can I call a click on my button \"CommandButton1\"</p>\n\n<p>Thanks for your help!</p>\n"}, {"tags": ["vba", "excel", "merge"], "answers": [{"tags": [], "owner": {"reputation": 306, "user_id": 6464497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8146f0a4a9e5409c4de590d77bb55d2c?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/6464497/fredrik"}, "is_accepted": true, "score": 1, "last_activity_date": 1466070535, "creation_date": 1466070535, "answer_id": 37855658, "question_id": 37843171, "link": "https://stackoverflow.com/questions/37843171/using-multiple-statements-under-if-to-merge-multiple-groups-of-cells-in-vba/37855658#37855658", "title": "Using multiple statements under if to merge multiple groups of cells in VBA", "body": "<p>Try this</p>\n\n<pre><code>Sub Merge_PlansourceCategories()\n    For i = 1 To ActiveSheet.Cells(Rows.Count, 4).End(xlUp).Row\n        If Cells(i, 4) = \"red\" Or Cells(i, 4) = \"blue\" Then\n            For j = 1 To 2\n                With Range(Cells(i, j * 4 + 2), Cells(i, j * 4 + 4))\n                    .Merge\n                    .HorizontalAlignment = xlCenterAcrossSelection\n                    .VerticalAlignment = xlCenter\n                End With\n            Next j\n            With Range(Cells(i, 4), Cells(i + 1, 4))\n                .Merge\n                .VerticalAlignment = xlCenter\n            End With\n        End If\n    Next i\nEnd Sub\n</code></pre>\n\n<p>There is really no point in creating RgToMerge as a string and using letters for column names makes it hard to increment.</p>\n"}], "owner": {"reputation": 55, "user_id": 6461568, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/a2c78a271e31b8eeb19d6f04a57f9250?s=128&d=identicon&r=PG&f=1", "display_name": "beks123", "link": "https://stackoverflow.com/users/6461568/beks123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 288, "favorite_count": 0, "accepted_answer_id": 37855658, "answer_count": 1, "score": 0, "last_activity_date": 1466070535, "creation_date": 1466015459, "last_edit_date": 1531164843, "question_id": 37843171, "link": "https://stackoverflow.com/questions/37843171/using-multiple-statements-under-if-to-merge-multiple-groups-of-cells-in-vba", "title": "Using multiple statements under if to merge multiple groups of cells in VBA", "body": "<p>Right now, my code says \"if any of the cells in column D match these words \" \", then merge that cell in the same row from column F to H\". What I would like it to do is also merge the two cells in column D, the top cell will have words and the cell below will be blank. I would also like the table to incrementally merge every 3 cells in a row so like after F to H it would skip I and then merge J-L. here is the code:</p>\n\n<pre><code>Sub Merge_PlansourceCategories()\nDim RgToMerge As String\n\n\nFor i = 1 To ActiveSheet.Cells(Rows.Count, 4).End(xlUp).row\n    RgToMerge = \"\"\n    If Cells(i, 4) = \"red\" or cells (i, 4) = \"blue\" Then\n    RgToMerge = \"$F$\" &amp; i &amp; \":$H$\" &amp; i + 1        \n\n\n\n   'for step loop to make this easier?\n    With range(RgToMerge)\n        .Merge\n        .HorizontalAlignment = xlCenterAcrossSelection\n        .VerticalAlignment = xlCenter\n    End With\n\n    End If\n\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["winforms", "excel", "excel-2010", "vba"], "comments": [{"owner": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "edited": false, "score": 0, "creation_date": 1466449771, "post_id": 37843131, "comment_id": 63310854, "body": "In your pool of colleagues and computers, are you able to &quot;hot-desk&quot; (log onto any machine, where your profile is stored remotely); or is each person&#39;s profile stored only on the hard drive of each individual machine? If so, try another machine. It sounds like a profile/installation issue. I have encountered a similar problem before: not this exact clipboard issue, but one where a library DLL was causing problems for just one user, even though her Excel installation was supposed to be the same as everyone&#39;s."}, {"owner": {"reputation": 402, "user_id": 3678483, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/4rYQq.jpg?s=128&g=1", "display_name": "Danny", "link": "https://stackoverflow.com/users/3678483/danny"}, "reply_to_user": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "edited": false, "score": 0, "creation_date": 1466450542, "post_id": 37843131, "comment_id": 63311286, "body": "I&#39;ll give that a try. I think it&#39;s an excel issue or a problem with the winforms dll."}], "answers": [{"comments": [{"owner": {"reputation": 402, "user_id": 3678483, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/4rYQq.jpg?s=128&g=1", "display_name": "Danny", "link": "https://stackoverflow.com/users/3678483/danny"}, "edited": false, "score": 0, "creation_date": 1466516430, "post_id": 37932285, "comment_id": 63340752, "body": "The first solution will not help because the clipboard is used a lot in the called function. The second solution works, mostly. It copies plain text just fine, and doesn&#39;t break when the clipboard has been cleared out. It doesn&#39;t copy any range properties (colors, borders), or formulas. However, the call to PutInClipboard is working here, for whatever reason. Thanks for the suggestions."}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "reply_to_user": {"reputation": 402, "user_id": 3678483, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/4rYQq.jpg?s=128&g=1", "display_name": "Danny", "link": "https://stackoverflow.com/users/3678483/danny"}, "edited": false, "score": 1, "creation_date": 1466531759, "post_id": 37932285, "comment_id": 63351329, "body": "I don&#39;t think there&#39;s a way to save that kind of properties (nothing that I&#39;ve found out), clipboard as variable don&#39;t handle that, since it&#39;s variable, what about if we check if the in the active range in the active sheet where the user called the code is copied to clipboard? Then, at the end, since you store that range, you may call a copy again. Check my updated answer. PS the PutInClipboard works because you need to Set your variable as New Data Object, kind of hard to understand why to do so, but, this is related to <a href=\"https://en.wikipedia.org/wiki/Object-oriented_programming\" rel=\"nofollow noreferrer\">OOP</a>"}, {"owner": {"reputation": 402, "user_id": 3678483, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/4rYQq.jpg?s=128&g=1", "display_name": "Danny", "link": "https://stackoverflow.com/users/3678483/danny"}, "edited": false, "score": 0, "creation_date": 1466606710, "post_id": 37932285, "comment_id": 63389067, "body": "The edited solution you added still breaks. I think what I need is more of a way to get the correct solution to work (just using the DataObject class defined in the windows forms library), not a work around."}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "reply_to_user": {"reputation": 402, "user_id": 3678483, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/4rYQq.jpg?s=128&g=1", "display_name": "Danny", "link": "https://stackoverflow.com/users/3678483/danny"}, "edited": false, "score": 0, "creation_date": 1466719302, "post_id": 37932285, "comment_id": 63449274, "body": "If the range is in another workbook, you should reference to it, if not, saddly, I can&#39;t help any further, <i><b>I don&#39;t think</b></i> you can save those elements in VBA."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1541447804, "post_id": 37932285, "comment_id": 93212979, "body": "Contrary to popular belief, <code>Application.CutCopyMode=False</code> does <b><i>NOT</i></b> clear the clipboard contents... Test it!"}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1541543666, "post_id": 37932285, "comment_id": 93252278, "body": "@ashleedawg Interesting, could you provide a link where they elaborate more on this? It has worked for me for ages"}], "tags": [], "owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "is_accepted": false, "score": 1, "last_activity_date": 1466532005, "last_edit_date": 1495541305, "creation_date": 1466459036, "answer_id": 37932285, "question_id": 37843131, "link": "https://stackoverflow.com/questions/37843131/excel-vba-dataobjectputinclipboard-not-implemented/37932285#37932285", "title": "Excel VBA DataObject:PutInClipboard Not Implemented", "body": "<p>I faced a similar issue a while ago, these are the best solutions I came across to do what you want (a) may save some formats and some other useful things, b) only strings)\nI can see 2 scenarios here (and their solutions/workarounds):\n<br><strong><em>a)You just need to save the data (but you are not clearing the clipboard at any moment in your routines).</em></strong>\n<br>In a stand alone module do the following:</p>\n\n<pre><code>Option Explicit\nPrivate Declare Function OpenClipboard Lib \"User32\" _\n(ByVal hwnd As Long) As Long\nPrivate Declare Function CloseClipboard Lib \"User32\" () As Long\nSub SaveClipBoardContents()\n    OpenClipboard 0\n    CloseClipboard\nEnd Sub\nSub ClearClipBoardContents()\n    Application.CutCopyMode = False\nEnd Sub\n</code></pre>\n\n<p>Change in your sub accordingly</p>\n\n<pre><code>Sub FunctionHandler()\n    Call SaveClipBoardContents\n\n    '' There are a dozen or so macros that can be called here\n    Call AnyFunction() \n    'clipboard will reamain because of the sub SaveClipBoardContents\nEnd Sub\n</code></pre>\n\n<p><br><strong><em>b) You are clearing the Data (or using the clipboard on it) and would like to preserve the original one (if any).</em></strong>\nThis is a slightly modified code from the one in Microsoft help to handle errors. Same logic, paste it standalone in a module.</p>\n\n<pre><code>Declare Function OpenClipboard Lib \"User32\" (ByVal hwnd As Long) _\n   As Long\nDeclare Function CloseClipboard Lib \"User32\" () As Long\nDeclare Function GetClipboardData Lib \"User32\" (ByVal wFormat As _\n   Long) As Long\nDeclare Function GlobalAlloc Lib \"kernel32\" (ByVal wFlags&amp;, ByVal _\n   dwBytes As Long) As Long\nDeclare Function GlobalLock Lib \"kernel32\" (ByVal hMem As Long) _\n   As Long\nDeclare Function GlobalUnlock Lib \"kernel32\" (ByVal hMem As Long) _\n   As Long\nDeclare Function GlobalSize Lib \"kernel32\" (ByVal hMem As Long) _\n   As Long\nDeclare Function lstrcpy Lib \"kernel32\" (ByVal lpString1 As Any, _\n   ByVal lpString2 As Any) As Long\nPublic Const GHND = &amp;H42\nPublic Const CF_TEXT = 1\nPublic Const MAXSIZE = 4096\nFunction ClipBoard_GetData()\n   Dim hClipMemory As Long\n   Dim lpClipMemory As Long\n   Dim MyString As String\n   Dim RetVal As Long\n   If OpenClipboard(0&amp;) = 0 Then: MsgBox \"Cannot open Clipboard. Another app. may have it open\": Exit Function\n   ' Obtain the handle to the global memory\n   ' block that is referencing the text.\n   hClipMemory = GetClipboardData(CF_TEXT)\n   If IsNull(hClipMemory) Then GoTo OutOfHere\n\n   ' Lock Clipboard memory so we can reference\n   ' the actual data string.\n   lpClipMemory = GlobalLock(hClipMemory)\n\n   If Not IsNull(lpClipMemory) Then\n      MyString = Space$(MAXSIZE)\n      RetVal = lstrcpy(MyString, lpClipMemory)\n      RetVal = GlobalUnlock(hClipMemory)\n      ' Peel off the null terminating character.\n      On Error GoTo OutOfHere\n      MyString = Mid(MyString, 1, InStr(1, MyString, Chr$(0), 0) - 1)\n   Else\n      MsgBox \"Could not lock memory to copy string from.\"\n   End If\nOutOfHere:\n   RetVal = CloseClipboard()\n   ClipBoard_GetData = IIf(MyString = \"OutOfHere\", \"\", MyString)\nEnd Function\n</code></pre>\n\n<p>Change in your sub as well</p>\n\n<pre><code>Sub FunctionHandler()\n    Dim DataClipBoard As String\n    Dim clipboardData As DataObject\n    DataClipBoard = ClipBoard_GetData\n    '...\n    Application.CutCopyMode = False ' to simulate if clipboard is lost at some point\n    '...\n    Set clipboardData = New DataObject\n    With clipboardData\n        .SetText DataClipBoard\n        .PutInClipboard\n    End With\nEnd Sub\n</code></pre>\n\n<p>Note: Reference \"FM20.dll\" is the same one that I used for this testing.\nMore info at <a href=\"https://msdn.microsoft.com/en-us/library/office/ff194373.aspx\" rel=\"nofollow noreferrer\">Microsoft</a>\n<br><strong><em>EDIT:</em></strong>\n<br> Workaround to copy margins,colors, when using b) method</p>\n\n<pre><code>Sub FunctionHandler()\n    Dim DataClipBoard As String\n    Dim clipboardData As DataObject\n    Dim RangeCopied As Range\n    Set RangeCopied = Selection\n    DataClipBoard = ClipBoard_GetData\n    '...\n    Application.CutCopyMode = False ' to simulate if clipboard is lost at some point\n    '...\n    If Not (RangeCopied.Find(Application.WorksheetFunction.Clean(Trim(Split(DataClipBoard, Chr(10))(1)))) Is Nothing) Then 'this is going to check if the data gathered in the copied clipboard is in the original selection, if so, this means this came from excel ' 1. If Not (RangeCopied.Find(Application.WorksheetFunction.Clean(Trim(Split(DataClipBoard, Chr(10))(1)))) Is Nothing) Then\n    RangeCopied.Copy\n    Else ' The data in clipboard didn't come from excel, so, just copy as plain text ' 1. If Not (RangeCopied.Find(Application.WorksheetFunction.Clean(Trim(Split(DataClipBoard, Chr(10))(1)))) Is Nothing) Then\n    Set clipboardData = New DataObject\n    With clipboardData\n        .SetText DataClipBoard\n        .PutInClipboard\n    End With\n    Set clipboardData = Nothing 'releases memory, data remain in CB\n    End If ' 1. If Not (RangeCopied.Find(Application.WorksheetFunction.Clean(Trim(Split(DataClipBoard, Chr(10))(1)))) Is Nothing) Then\nEnd Sub\n</code></pre>\n\n<p>More info if this doesn't fit your needs <a href=\"https://stackoverflow.com/questions/12117040/can-i-get-the-source-range-of-excel-clipboard-data\">here</a>, <a href=\"http://www.ozgrid.com/forum/showthread.php?t=66773\" rel=\"nofollow noreferrer\">here</a> and <a href=\"https://stackoverflow.com/questions/1108947/excel-vba-macro-check-content-of-clipboard-before-pasting\">here</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 402, "user_id": 3678483, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/4rYQq.jpg?s=128&g=1", "display_name": "Danny", "link": "https://stackoverflow.com/users/3678483/danny"}, "edited": false, "score": 0, "creation_date": 1466516658, "post_id": 37932563, "comment_id": 63340912, "body": "This kind of works. It doesn&#39;t work with formatted data from excel."}], "tags": [], "owner": {"reputation": 306, "user_id": 6464497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8146f0a4a9e5409c4de590d77bb55d2c?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/6464497/fredrik"}, "is_accepted": false, "score": 0, "last_activity_date": 1466460276, "creation_date": 1466460276, "answer_id": 37932563, "question_id": 37843131, "link": "https://stackoverflow.com/questions/37843131/excel-vba-dataobjectputinclipboard-not-implemented/37932563#37932563", "title": "Excel VBA DataObject:PutInClipboard Not Implemented", "body": "<p>I cant answer why you have the problem, but if it's only failing in putting in the clipboard you could try and exchange only that part for the below. It only handles strings so it might not do it for you.</p>\n\n<pre><code>Sub PutDataInClipBoard(intext As String)\n    Dim objShell As Object\n    Set objShell = CreateObject(\"WScript.Shell\")\n    objShell.Run \"cmd /C echo|set/p=\" &amp; intext &amp; \"| CLIP\", 2\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 402, "user_id": 3678483, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/4rYQq.jpg?s=128&g=1", "display_name": "Danny", "link": "https://stackoverflow.com/users/3678483/danny"}, "edited": false, "score": 0, "creation_date": 1466515336, "post_id": 37941138, "comment_id": 63339794, "body": "Interesting idea, but the same issue is still happening with this code."}], "tags": [], "owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "is_accepted": false, "score": 0, "last_activity_date": 1466502842, "creation_date": 1466502842, "answer_id": 37941138, "question_id": 37843131, "link": "https://stackoverflow.com/questions/37843131/excel-vba-dataobjectputinclipboard-not-implemented/37941138#37941138", "title": "Excel VBA DataObject:PutInClipboard Not Implemented", "body": "<p>In an attempt to work-around the strange dependency issue you face, can you try replace the early-binding code with late-binding equivalent? </p>\n\n<p>Example usage - note the magic number that refers to the <code>MSForms 2.0 Object Library</code>:</p>\n\n<pre><code>Option Explicit\n\nSub Test()\n\n    ' set clipboard and test by pasting to range\n    SetClipboard \"hello world\"\n    Sheet1.Range(\"A1\").PasteSpecial Paste:=xlPasteAll\n\nEnd Sub\n\nSub SetClipboard(strToSet As String)\n\n    Dim objDataObject As Object\n\n    ' get clipboard with late binding\n    Set objDataObject = CreateObject(\"New:{1C3B4210-F441-11CE-B9EA-00AA006B1A69}\")\n\n    ' set input string to clipboard\n    With objDataObject\n        .SetText strToSet\n        .PutInClipboard\n    End With\n\n    ' clean up    \n    Set objDataObject = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 402, "user_id": 3678483, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/4rYQq.jpg?s=128&g=1", "display_name": "Danny", "link": "https://stackoverflow.com/users/3678483/danny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4784, "favorite_count": 1, "answer_count": 3, "score": 1, "last_activity_date": 1466532005, "creation_date": 1466015340, "last_edit_date": 1592644375, "question_id": 37843131, "link": "https://stackoverflow.com/questions/37843131/excel-vba-dataobjectputinclipboard-not-implemented", "title": "Excel VBA DataObject:PutInClipboard Not Implemented", "body": "<p>I maintain an Excel workbook with a bunch of VBA macros in it. The workbook has been in use for the past few months, mostly without any incident. We have a VBA function that is used to call other VBA functions. The purpose of it is to back up clipboard data, run the function, then restore clipboard data. It's pretty simple.</p>\n<pre><code>Sub FunctionHandler()\n    Dim clipboardData As New DataObject\n    clipboardData.GetFromClipboard\n    \n    '' There are a dozen or so macros that can be called here\n    Call AnyFunction() \n    \n    On Error Resume Next\n    clipboardData.PutInClipboard\n    On Error GoTo 0\nEnd Sub\n</code></pre>\n<p>The VBA project includes a reference to Microsoft Forms 2.0 Object Library (FM20.DLL), which is needed to use the DataObject class.</p>\n<p>On everyone's computer except mine, the function works as it should. It backs up the clipboard data, runs the function, and restores the clipboard contents.</p>\n<p>The issue is only occurring on my computer. Whenever I run this function, and I have an empty clipboard, or plain text copied to the clipboard (it could be copied from excel or from an outside source like notepad), an error is thrown. The text of the error is</p>\n<blockquote>\n<p>Run-time error '-2147467263 (80004001)':</p>\n<p>DataObject:PutInClipboard Not implemented.</p>\n</blockquote>\n<p>The error is thrown on the line <code>clipboardData.PutInClipboard</code>. It is never thrown the call to <code>clipboardData.GetFromClipboard</code>. Which to me means that the reference to the Microsoft Forms 2.0 Object Library is not having any issues.</p>\n<p>The error is also <em>not</em> thrown if I copy a cell or range to the clipboard before running this macro. Only when the clipboard is empty or contains plain text data.</p>\n<p>The error has never popped up on anyone else's computer at my job. I have made sure that the FM20.DLL exists in the correct folder on my computer. I have restarted Excel and my computer but the issue persists.</p>\n<p>I get the same error when I reduce the code down to this.</p>\n<pre><code>Sub FunctionHandler()\n    Dim clipboardData As New DataObject\n    clipboardData.GetFromClipboard\n\n    clipboardData.PutInClipboard\nEnd Sub\n</code></pre>\n<p>I also have multiple full backup copies of the workbook, and every single backup that has this function is giving me the same issues (but again, only me).</p>\n<p>Does anyone know how I can fix this?</p>\n<p>EDIT: This issue does not happen when using a new Windows profile on my computer.</p>\n"}, {"tags": ["vba", "excel", "error-handling"], "comments": [{"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1466014812, "post_id": 37842857, "comment_id": 63146371, "body": "What? When you delete something in column H or J on the sheet you get the error?"}, {"owner": {"reputation": 559, "user_id": 4994594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb48f2101f21149eb5eeb26f45825f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Vbasic4now", "link": "https://stackoverflow.com/users/4994594/vbasic4now"}, "reply_to_user": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1466014942, "post_id": 37842857, "comment_id": 63146428, "body": "exactly, ive even gone so far as in the code that deletes it, to name each individual cell and set its value = &quot;&quot;"}, {"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 1, "creation_date": 1466015083, "post_id": 37842857, "comment_id": 63146507, "body": "What about <code>If Not IsEmpty(Target)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 559, "user_id": 4994594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb48f2101f21149eb5eeb26f45825f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Vbasic4now", "link": "https://stackoverflow.com/users/4994594/vbasic4now"}, "edited": false, "score": 0, "creation_date": 1466015206, "post_id": 37843045, "comment_id": 63146577, "body": "what does option explicit do in that first line of code?"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 559, "user_id": 4994594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb48f2101f21149eb5eeb26f45825f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Vbasic4now", "link": "https://stackoverflow.com/users/4994594/vbasic4now"}, "edited": false, "score": 1, "creation_date": 1466015481, "post_id": 37843045, "comment_id": 63146767, "body": "Whenever you don&#39;t understand a keyword, simply highlight (select) it and then press <code>F1</code>. This will guide you to the following website: <a href=\"https://msdn.microsoft.com/en-us/library/office/gg278855.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/gg278855.aspx</a> Basically, it says that all variables in your code must be declared (using <code>Dim</code>) before they can be used. That&#39;s only for good coding practice and the above code will work without that line. I just include it in all of my modules. You can remove it if you want to."}], "tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": true, "score": 2, "last_activity_date": 1466015260, "last_edit_date": 1466015260, "creation_date": 1466015089, "answer_id": 37843045, "question_id": 37842857, "link": "https://stackoverflow.com/questions/37842857/excel-type-mismatch-error-on-a-private-sub/37843045#37843045", "title": "excel type mismatch error on a private sub", "body": "<p>You are forgetting that <code>Target</code> is a range and does not necessarily consist of one cell only. If you adjust your code a bit it should work:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\nDim cell As Range\n\n'Adds unique keyA values\n'Check to see if the changed cell is in column H\nIf Not Intersect(Target, Range(\"H:H\")) Is Nothing Then\n    For Each cell In Target.Cells\n        If cell.Value &lt;&gt; vbNullString And Target.Row &gt; 7 And Target.Row &lt;= 20 Then\n            'Update the \"KeyA\" value\n            Range(\"A\" &amp; Target.Row).Value = Now()\n        End If\n    Next cell\nEnd If\n\n'Adds unique keyB values\n'Check to see if the changed cell is in column J\nIf Not Intersect(Target, Range(\"J:J\")) Is Nothing Then\n    For Each cell In Target.Cells\n        If cell.Value &lt;&gt; vbNullString And (Target.Row &gt; \"7\" And Target.Row &lt;= \"27\") Then\n            'Update the \"KeyB\" value\n            Range(\"M\" &amp; Target.Row).Value = Now()\n        End If\n    Next cell\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Basically, the change is that it checks now <strong>each</strong> cell in the range <code>Target</code> and works your code for each cell in that range. Before, you were comparing (possibly) multiple <code>Target.Values</code> to <code>\"\"</code>. That didn't work. Now, only one <code>.Value</code> gets compared to <code>\"\"</code> and that should solve it.</p>\n"}], "owner": {"reputation": 559, "user_id": 4994594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb48f2101f21149eb5eeb26f45825f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Vbasic4now", "link": "https://stackoverflow.com/users/4994594/vbasic4now"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 576, "favorite_count": 0, "accepted_answer_id": 37843045, "answer_count": 1, "score": 1, "last_activity_date": 1466015260, "creation_date": 1466014492, "question_id": 37842857, "link": "https://stackoverflow.com/questions/37842857/excel-type-mismatch-error-on-a-private-sub", "title": "excel type mismatch error on a private sub", "body": "<p>I have this sub that should update the value of a cell when a corresponding cell is changed, but i keep getting an error that says error 13 type mismatch, ive looked up all the possible sources of this problem and cant figure out what is causing it, here is my code that is presenting the problem:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As range)\n'Adds unique keyA values\n'Check to see if the changed cell is in column H\n    If Not Intersect(Target, range(\"H:H\")) Is Nothing Then\n\n        If Target.Cells.Value &lt;&gt; \"\" And Target.Row &gt; 7 And Target.Row &lt;= 20 Then\n\n'Update the \"KeyA\" value\n            range(\"A\" &amp; Target.Row).Value = Now()\n\n        End If\n\n    End If\n'Adds unique keyB values\n'Check to see if the changed cell is in column J\n    If Not Intersect(Target, range(\"J:J\")) Is Nothing Then\n\n        If Target.Cells.Value &lt;&gt; \"\" And (Target.Row &gt; \"7\" And Target.Row &lt;= \"27\") Then\n\n'Update the \"KeyB\" value\n            range(\"M\" &amp; Target.Row).Value = Now()\n\n        End If\n\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>the error occurs when i try to clear the range its checking for change. any help in figuring this out would be greatly appreciated, thanks!</p>\n"}, {"tags": ["vba", "excel", "copy", "find", "range"], "answers": [{"comments": [{"owner": {"reputation": 642, "user_id": 4187485, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/52b374d6ab6360b829a6d2c4570f9cfb?s=128&d=identicon&r=PG&f=1", "display_name": "G.T.", "link": "https://stackoverflow.com/users/4187485/g-t"}, "edited": false, "score": 0, "creation_date": 1466017599, "post_id": 37843456, "comment_id": 63148002, "body": "Cool! It works! What&#39;s the deal with the &#39;If foundCell.Column &gt; 4 Then&#39; line though?"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 642, "user_id": 4187485, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/52b374d6ab6360b829a6d2c4570f9cfb?s=128&d=identicon&r=PG&f=1", "display_name": "G.T.", "link": "https://stackoverflow.com/users/4187485/g-t"}, "edited": false, "score": 0, "creation_date": 1466017929, "post_id": 37843456, "comment_id": 63148193, "body": "This line is just there for good coding practice. Imagine that <code>foundCell</code> is in column <code>C</code>. Then the next line of code would throw an error because <code>foundCell.Offset(0, -4)</code> would refer to the column before <code>A</code>. Since there is no such column you would get an error instead. I guess you are pretty certain that <code>foundCell</code> should be always in column <code>D</code> (or beyond). Yet, you can test it by placing into column <code>C</code> (for example <code>C1</code> the value <code>PL 2</code> and then run the code with / without the <code>If</code> clause and you will see the difference."}, {"owner": {"reputation": 642, "user_id": 4187485, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/52b374d6ab6360b829a6d2c4570f9cfb?s=128&d=identicon&r=PG&f=1", "display_name": "G.T.", "link": "https://stackoverflow.com/users/4187485/g-t"}, "edited": false, "score": 0, "creation_date": 1466018728, "post_id": 37843456, "comment_id": 63148630, "body": "Hmm actually I don&#39;t know why it stopped working... I&#39;m still confused. For some reason it&#39;s only copying over certain values"}, {"owner": {"reputation": 642, "user_id": 4187485, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/52b374d6ab6360b829a6d2c4570f9cfb?s=128&d=identicon&r=PG&f=1", "display_name": "G.T.", "link": "https://stackoverflow.com/users/4187485/g-t"}, "edited": false, "score": 0, "creation_date": 1466018773, "post_id": 37843456, "comment_id": 63148661, "body": "The values it copies over change depending on which cell I have selected when I start my macro"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 642, "user_id": 4187485, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/52b374d6ab6360b829a6d2c4570f9cfb?s=128&d=identicon&r=PG&f=1", "display_name": "G.T.", "link": "https://stackoverflow.com/users/4187485/g-t"}, "edited": false, "score": 0, "creation_date": 1466019272, "post_id": 37843456, "comment_id": 63148939, "body": "That&#39;s because your <code>.Find</code> is starting with the search in the <code>ActiveCell</code>. I thought this is what you wanted / needed. If that&#39;s not the case then you should change that and set the search range to something different."}, {"owner": {"reputation": 642, "user_id": 4187485, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/52b374d6ab6360b829a6d2c4570f9cfb?s=128&d=identicon&r=PG&f=1", "display_name": "G.T.", "link": "https://stackoverflow.com/users/4187485/g-t"}, "edited": false, "score": 1, "creation_date": 1466026143, "post_id": 37843456, "comment_id": 63152440, "body": "Sorry for being unclear. I really do appreciate the help, though. I upvoted your answer. Thanks Ralph."}], "tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": false, "score": 2, "last_activity_date": 1466016414, "last_edit_date": 1495540727, "creation_date": 1466016414, "answer_id": 37843456, "question_id": 37842819, "link": "https://stackoverflow.com/questions/37842819/how-to-turn-found-cell-into-a-range/37843456#37843456", "title": "How to turn found cell into a range?", "body": "<p>The following should solve your problem:</p>\n\n<pre><code>For i = 1 To 24\n    Set foundCell = Cells.Find(What:=\"PL \" &amp; i, After:=ActiveCell, LookIn:=xlFormulas, LookAt _\n        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\n        False, SearchFormat:=False)\n    If Not foundCell Is Nothing Then\n        foundCell.Copy Destination:=foundCell.Parent.Range(\"P\" &amp; (i + 10))\n        ' BEGIN ADDITION\n        If foundCell.Column &gt; 4 Then\n            foundCell.Offset(0, -4).Copy Destination:=foundCell.Parent.Range(\"S\" &amp; (i + 10))\n        End If\n        'END ADDITION\n    End If\nNext i\n</code></pre>\n\n<p>Basically, the problem were the <code>select</code> you had in your code. You might want to read the following post on how to avoid them in the future:\n<a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid using Select in Excel VBA macros</a></p>\n"}, {"comments": [{"owner": {"reputation": 642, "user_id": 4187485, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/52b374d6ab6360b829a6d2c4570f9cfb?s=128&d=identicon&r=PG&f=1", "display_name": "G.T.", "link": "https://stackoverflow.com/users/4187485/g-t"}, "edited": false, "score": 0, "creation_date": 1466019298, "post_id": 37844062, "comment_id": 63148954, "body": "Do you know if there&#39;s a way to paste the linked reference to the cell rather than the data in the cell itself?"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 2, "creation_date": 1466019417, "post_id": 37844062, "comment_id": 63149038, "body": "To achieve this simply change the line <code>Range(&quot;P&quot; &amp; (i + 10)) = foundCell</code> to <code>Range(&quot;P&quot; &amp; (i + 10)).Formula = &quot;=&quot; &amp; foundCell.Address</code> and <code>Range(&quot;S&quot; &amp; (i + 10)) = foundCell</code> to <code>Range(&quot;S&quot; &amp; (i + 10)).Formula = &quot;=&quot; &amp; foundCell.Address</code>."}, {"owner": {"reputation": 642, "user_id": 4187485, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/52b374d6ab6360b829a6d2c4570f9cfb?s=128&d=identicon&r=PG&f=1", "display_name": "G.T.", "link": "https://stackoverflow.com/users/4187485/g-t"}, "edited": false, "score": 0, "creation_date": 1466019584, "post_id": 37844062, "comment_id": 63149132, "body": "Awesome! Thanks so much."}], "tags": [], "owner": {"reputation": 199, "user_id": 6210584, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rGVSH.jpg?s=128&g=1", "display_name": "Chris Slade", "link": "https://stackoverflow.com/users/6210584/chris-slade"}, "is_accepted": true, "score": 3, "last_activity_date": 1466018481, "creation_date": 1466018481, "answer_id": 37844062, "question_id": 37842819, "link": "https://stackoverflow.com/questions/37842819/how-to-turn-found-cell-into-a-range/37844062#37844062", "title": "How to turn found cell into a range?", "body": "<p>I think that this will do what you want. After finding the required cell in the range J11:J100, it then looks at the cell in column F corresponding to the found cell and pastes both of them into the required cells.</p>\n\n<pre><code>Sub PasteTest()\nDim i As Integer\nDim SearchRange, foundCell As Range\n\n    Set SearchRange = Range(\"J11:J100\")\n    With SearchRange\n        For i = 1 To 24\n            Set foundCell = .Cells.Find(\"PL \" &amp; i)\n            If Not (foundCell Is Nothing) Then\n                Range(\"P\" &amp; (i + 10)) = foundCell\n                Set foundCell = foundCell.Offset(, -4)\n                Range(\"S\" &amp; (i + 10)) = foundCell\n            End If\n        Next\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>As with the other answer, I've avoided the use of select as it only slows down the code. Using multiple (named) ranges allows you to copy data without the use of the clipboard too.</p>\n"}], "owner": {"reputation": 642, "user_id": 4187485, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/52b374d6ab6360b829a6d2c4570f9cfb?s=128&d=identicon&r=PG&f=1", "display_name": "G.T.", "link": "https://stackoverflow.com/users/4187485/g-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1307, "favorite_count": 0, "accepted_answer_id": 37844062, "answer_count": 2, "score": 3, "last_activity_date": 1466018481, "creation_date": 1466014353, "question_id": 37842819, "link": "https://stackoverflow.com/questions/37842819/how-to-turn-found-cell-into-a-range", "title": "How to turn found cell into a range?", "body": "<p>I would really appreciate it if you could help because I really would like to get this to work. I have some code here that is meant to extract information from one part of a spreadsheet and paste it into a table on another part of the spreadsheet.</p>\n\n<pre><code>For i = 1 To 24\n        Range(\"J11:J100\").Select\n        Set foundCell = Cells.Find(What:=\"PL \" &amp; i, After:=ActiveCell, LookIn:=xlFormulas, LookAt _\n            :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\n            False, SearchFormat:=False)\n        If Not foundCell Is Nothing Then\n            foundCell.Activate\n            foundCell.Copy\n            Range(\"P\" &amp; (i + 10)).Select\n            ActiveSheet.Paste\n        End If\n        Next\n</code></pre>\n\n<p>The main issue is that I would like to also copy information from surrounding columns using foundCell as a reference eg. <code>foundCell.Offset(, -4).Copy</code></p>\n\n<p>I added this but it doesn't work (addendum is marked up):</p>\n\n<pre><code>    For i = 1 To 24\n            Range(\"J11:J100\").Select\n            Set foundCell = Cells.Find(What:=\"PL \" &amp; i, After:=ActiveCell, LookIn:=xlFormulas, LookAt _\n                :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\n                False, SearchFormat:=False)\n            If Not foundCell Is Nothing Then\n                foundCell.Activate\n                foundCell.Copy\n                Range(\"P\" &amp; (i + 10)).Select\n                ActiveSheet.Paste\n' BEGIN ADDITION\n                foundCell.Offset(, -4).Copy\n                Range(\"S\" &amp; (i + 10)).Select\n                ActiveSheet.Paste\n'END ADDITION\n            End If\n            Next\n</code></pre>\n\n<p>I tested around and found that the foundCell is instead now referencing the range that the data was pasted to rather than the original range in which it was found.</p>\n\n<p>Can anyone help me? I'm open to anything. I feel like the best solution would be to turn foundCell into a range, but I don't know how to do that.</p>\n"}, {"tags": ["vba", "excel", "if-statement", "for-loop"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1466014546, "post_id": 37842377, "comment_id": 63146224, "body": "Help us to help you, <b>post your current code.</b>"}], "answers": [{"tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": false, "score": 1, "last_activity_date": 1466016268, "creation_date": 1466016268, "answer_id": 37843409, "question_id": 37842377, "link": "https://stackoverflow.com/questions/37842377/copy-row-if-cell-contains-a-specific-text-out-of-a-sentence/37843409#37843409", "title": "Copy row if cell contains a specific text out of a sentence", "body": "<p>You can try using this line in your code:</p>\n\n<pre><code>If Left(cell.Value, 6) = \"Design\" Then\n</code></pre>\n\n<p>This can serve the purpose here. \nIf it doesn't work let us know your full code so that we can help better.</p>\n"}], "owner": {"reputation": 37, "user_id": 3647044, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d97b7338a6e818d6d16d654900bd3f05?s=128&d=identicon&r=PG&f=1", "display_name": "user3647044", "link": "https://stackoverflow.com/users/3647044/user3647044"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 738, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1466016268, "creation_date": 1466012935, "last_edit_date": 1531164843, "question_id": 37842377, "link": "https://stackoverflow.com/questions/37842377/copy-row-if-cell-contains-a-specific-text-out-of-a-sentence", "title": "Copy row if cell contains a specific text out of a sentence", "body": "<p>I'm still new to macros and I would greatly appreciate it if someone could help me figure this out.</p>\n\n<p>Column \"A\" in excel contains several row as below (one column and no space between rows):</p>\n\n<pre><code>Design: 0120\nModel  -traditional\nCOLOR - red\nDesign:0150\ncopybook - quantity to be specified\nDesign: 0180\nStill in progress\n</code></pre>\n\n<p>I need to find the cell that contains \"Design\" and than copy all of the information below this cell to the next sheet, then find the other cell that contains the word \"Design\" and copy all of the information below it to another sheet.</p>\n\n<p>How can I do that in vba? The entire cell contains \"Design:0150\",which made it hard for me to search for the word \"Design\" as it's part of a sentence in the cell. And how can I automate the copy and paste of each \"Design\" set?</p>\n"}, {"tags": ["html", "excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1466012389, "post_id": 37841913, "comment_id": 63145088, "body": "Have you tried adding breakpoints to see where your execution goes?  Or add some <code>Debug.Print</code> statements.  I&#39;m not sure you need those <code>Exit For</code> statements - they might be your problem."}, {"owner": {"reputation": 71, "user_id": 6466375, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/52ee600c33fb5df0d038e42d91bf8a26?s=128&d=identicon&r=PG&f=1", "display_name": "A.Cod", "link": "https://stackoverflow.com/users/6466375/a-cod"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1466018085, "post_id": 37841913, "comment_id": 63148288, "body": "Thanks Tim. I just used breakpoints to see where it goes wrong. The code goes from  &#39;For Each tb In hTable&#39; straight to the end and skips everything in between. Is this because in the HTML format, there is no element called table? This is where I can&#39;t find anything online to help me. This HTML file is very unique where an actual table with an id and so on isn&#39;t posted in HTML format. it has the data in text where <i>want this data</i> is."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1466029322, "post_id": 37841913, "comment_id": 63153642, "body": "From the HTML you posted it should work: without access to the actual URL it&#39;s difficult to suggest why it doesn&#39;t.  Is that the <i>actual</i> HTML? I notice there&#39;s no <code>body</code> tag."}, {"owner": {"reputation": 71, "user_id": 6466375, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/52ee600c33fb5df0d038e42d91bf8a26?s=128&d=identicon&r=PG&f=1", "display_name": "A.Cod", "link": "https://stackoverflow.com/users/6466375/a-cod"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1466089998, "post_id": 37841913, "comment_id": 63183333, "body": "Thanks Tim. I figured out what was wrong! The URL I was using was for the webpage as a whole, I had to use the URL that contained the HTML for the tables."}], "owner": {"reputation": 71, "user_id": 6466375, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/52ee600c33fb5df0d038e42d91bf8a26?s=128&d=identicon&r=PG&f=1", "display_name": "A.Cod", "link": "https://stackoverflow.com/users/6466375/a-cod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 140, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1466012221, "creation_date": 1466011374, "last_edit_date": 1531164843, "question_id": 37841913, "link": "https://stackoverflow.com/questions/37841913/vba-having-trouble-getting-html-table-data-into-excel", "title": "VBA: Having Trouble Getting HTML Table Data into Excel", "body": "<p>When I used the \"Get Data from Web\" command through excel, the data is pasted into Excel perfectly. But I want to automate this using vba. </p>\n\n<p>Here is the sample HTML I am working with:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;html&gt;&lt;head&gt;\r\n&lt;meta http-equiv=\"content-type\" content=\"text/html; charset=windows-1252\"&gt;\r\n&lt;meta name=\"robots\" content=\"index,follow\"&gt;\r\n&lt;title&gt;\"title: abcdefg\"&lt;/title&gt;\r\n\r\n&lt;/head&gt;\r\n&lt;h1&gt;\"heading: 2345\"&lt;/h1&gt;\r\n&lt;p&gt;\r\nLast Updated: \"Last date\"\r\n&lt;/p&gt;&lt;p&gt;\r\n\r\n&lt;/p&gt;&lt;p&gt;\r\n&lt;next&gt;&lt;/next&gt;&lt;table border=\"3\" cellpadding=\"6\" cellspacing=\"3\"&gt;\r\n&lt;tbody&gt;&lt;tr&gt;\r\n&lt;td&gt;\r\n&lt;pre&gt;\r\n*Want this data*\r\n\r\n&lt;/pre&gt;\r\n&lt;/td&gt;\r\n&lt;/tr&gt;\r\n&lt;tr&gt;\r\n&lt;td&gt;\r\n&lt;pre&gt;\r\n*Want this data*\r\n\r\n&lt;/pre&gt;\r\n&lt;/td&gt;\r\n&lt;/tr&gt;\r\n&lt;tr&gt;\r\n&lt;td&gt;\r\n&lt;pre&gt;\r\n*Want this data*</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Here is my VBA code thus far: </p>\n\n<pre><code>Private Sub Test()\n   Dim ie As Object, i As Long, strText As String\n\n   Dim doc As Object, hTable As Object, hBody As Object, hTR As Object, hTD As Object\n\n   Dim tb As Object, bb As Object, tr As Object, td As Object\n\n   Dim y As Long, z As Long, wb As Excel.Workbook, ws As Excel.Worksheet\n\n     Set wb = Excel.ActiveWorkbook\n     Set ws = wb.ActiveSheet\n\n     Set ie = CreateObject(\"InternetExplorer.Application\")\n     ie.Visible = True\n\n      y = 1   'Column A in Excel\n      z = 1   'Row 1 in Excel\n\n     ie.navigate \"my URL HERE\", , , , \"Content-Type: application/x-www-form-urlencoded\" &amp; vbCrLf\n\n     Do While ie.Busy: DoEvents: Loop\n     Do While ie.readyState &lt;&gt; 4: DoEvents: Loop\n\n     Set doc = ie.document\n     Set hTable = doc.getElementsByTagName(\"table\")\n\n\n     For Each tb In hTable\n\n        Set hBody = tb.getElementsByTagName(\"tbody\")\n        For Each bb In hBody\n\n            Set hTR = bb.getElementsByTagName(\"tr\")\n            For Each tr In hTR\n\n\n                 Set hTD = tr.getElementsByTagName(\"td\")\n                 y = 1 ' Resets back to column A\n                 For Each td In hTD\n                   ws.Cells(z, y).Value = td.innerText\n                   y = y + 1\n                 Next td\n                 DoEvents\n                 z = z + 1\n            Next tr\n            Exit For\n        Next bb\n    Exit For\n  Next tb\n'MsgBox (\"it worked\")\nEnd Sub\n</code></pre>\n\n<p>The code runs all the way through without any errors, but nothing gets posted onto the Excel worksheet. Please help! I am not that skilled with HTML/VBA. </p>\n"}, {"tags": ["vba", "excel", "combobox"], "comments": [{"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "edited": false, "score": 0, "creation_date": 1466014560, "post_id": 37841673, "comment_id": 63146233, "body": "Maybe this: <a href=\"http://stackoverflow.com/questions/20829823/vba-get-combobox-to-suggest-an-option\" title=\"vba get combobox to suggest an option\">stackoverflow.com/questions/20829823/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": false, "score": 0, "last_activity_date": 1466017771, "creation_date": 1466017771, "answer_id": 37843866, "question_id": 37841673, "link": "https://stackoverflow.com/questions/37841673/autofill-when-user-types-into-a-combo-box-using-vba-in-excel/37843866#37843866", "title": "AutoFill when user types into a combo box using VBA in excel", "body": "<p>Best if you define the range (Serving the list of Thirdfloorbox) in Name Manager and then in the properties window of the box you can add that range as the rowsource. </p>\n"}], "owner": {"reputation": 149, "user_id": 5069799, "user_type": "registered", "accept_rate": 47, "profile_image": "https://lh6.googleusercontent.com/-on9tV5a2J04/AAAAAAAAAAI/AAAAAAAACGA/ZcrOWMXveIg/photo.jpg?sz=128", "display_name": "Joel Carter", "link": "https://stackoverflow.com/users/5069799/joel-carter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 172, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1466017771, "creation_date": 1466010544, "last_edit_date": 1466011065, "question_id": 37841673, "link": "https://stackoverflow.com/questions/37841673/autofill-when-user-types-into-a-combo-box-using-vba-in-excel", "title": "AutoFill when user types into a combo box using VBA in excel", "body": "<p>I'm currently working on a project that I need to have a combobox in an excel sheet for. I have the data needed for the combo box inside of a different sheet in the current workbook I am using.</p>\n\n<p>My question is, is there a way to add autofill/autocomplete functionality to the box using VBA?</p>\n\n<p>My code is as follows:</p>\n\n<pre><code>Private Sub ThirdFloorBox_Initialize()\nThirdFloorBox.Clear\nThirdFloorBox.List = Sheets(8).Range(\"A3:A37\").Value\nThirdFloorBox.Visible = False\nEnd Sub\n</code></pre>\n\n<p>Any suggestions would be helpful. <strong>FYI:</strong> I'm new to VBA as most of my coding experience comes from the front-end web world.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ms-access", "vba", "sage-line-50"], "comments": [{"owner": {"reputation": 1, "user_id": 6470763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ff5a4c979c3c6a1955e359f86bf3dca?s=128&d=identicon&r=PG&f=1", "display_name": "P.Harrison", "link": "https://stackoverflow.com/users/6470763/p-harrison"}, "edited": false, "score": 0, "creation_date": 1466009667, "post_id": 37841393, "comment_id": 63143622, "body": "*because i only need to login once per &quot;session&quot; if that&#39;s the right term"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1466019606, "post_id": 37841393, "comment_id": 63149143, "body": "show your connection string and connect code"}, {"owner": {"reputation": 1, "user_id": 6470763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ff5a4c979c3c6a1955e359f86bf3dca?s=128&d=identicon&r=PG&f=1", "display_name": "P.Harrison", "link": "https://stackoverflow.com/users/6470763/p-harrison"}, "reply_to_user": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1466068133, "post_id": 37841393, "comment_id": 63167641, "body": "Sub login_Click()          Dim  sagedb As Database          Dim accessdb As Database          Dim rs As Recordset          Dim strConnect As String          Set sagedb = OpenDatabase(&quot;Directory&quot;)          strConnect = &quot;DSN=SageAccountsVer20;uid=xxx;pwd=xxx;&quot;           Set accessdb = OpenDatabase(&quot;&quot;, False, False, strConnect)          accessdb.Close          Set accessdb = Nothing          Set rs = sagedb.OpenRecordset(&quot;dbo_authors&quot;)          Debug.Print rs(0)          Debug.Print &quot;Recordset Opened Successfully&quot;          rs.Close          sagedb.CloseSet rs = Nothing"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1466094156, "post_id": 37841393, "comment_id": 63186154, "body": "You can edit your post and enter this type of infor between code tags - makes it easier for all to see and evaluate."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6470763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ff5a4c979c3c6a1955e359f86bf3dca?s=128&d=identicon&r=PG&f=1", "display_name": "P.Harrison", "link": "https://stackoverflow.com/users/6470763/p-harrison"}, "edited": false, "score": 0, "creation_date": 1466067592, "post_id": 37842027, "comment_id": 63167255, "body": "Thank you Mat i&#39;ll have a look look over and try some of your suggestions. the connection string i think that would work is &quot;DSN=SageAccountsVer20;uid=xxx;pwd=xxx;&quot; seems what i have seen a lot of. I&#39;ll keep you posted on how i get on really appreciate the help."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 0, "last_activity_date": 1466011797, "creation_date": 1466011797, "answer_id": 37842027, "question_id": 37841393, "link": "https://stackoverflow.com/questions/37841393/using-access-vba-to-pass-the-login-via-variables-to-automate-the-login-to-sage-l/37842027#37842027", "title": "Using access vba to pass the login via variables to automate the login to Sage Line 50 ver20", "body": "<p>I don't know Sage 50, but I've worked with the Sage 300 API, which is presumably similar; you can/should store an instance of your Sage session and keep it alive for as long as you need the Sage connection alive.</p>\n\n<p>The session interface I've worked with needs to be initialized, and then opened; your code needs to provide a string handle, an appID, a program name and an app version to be initialized, and then when you open the session you need a userID, a password and a database name.</p>\n\n<p>Here's a C# wrapper interface I'm using (referenging Sage's COM API), that shows how the values are passed:</p>\n\n<pre><code>public interface ISession : IDisposable\n{\n    void Init(string handle, SageAppInfo info);\n    void Open(SageCredential credential, DateTime timestamp, int flags = 0);\n    IDbLink OpenDbLink(DBLinkType type, DBLinkFlags flags);\n    IEnumerable&lt;string&gt; Errors { get; } \n}\n\npublic class SessionWrapper : ISession\n{\n    private readonly ISessionComInterop _session;\n\n    public SessionWrapper(ISessionComInterop session)\n    {\n        _session = session;\n    }\n\n    public void Init(string handle, SageAppInfo info)\n    {\n        _session.Init(handle, info.AppId, info.ProgramName, info.AppVersion);\n    }\n\n    public void Open(SageCredential credential, DateTime timestamp, int flags = 0)\n    {\n        _session.Open(credential.UserId, credential.Password, credential.DatabaseName, timestamp, flags);\n    }\n\n    public IDbLink OpenDbLink(DBLinkType type, DBLinkFlags flags)\n    {\n        return new DbLinkWrapper(_session.OpenDBLink(type, flags));\n    }\n\n    public IEnumerable&lt;string&gt; Errors\n    {\n        get\n        {\n            for (var i = 0; i &lt; _session.Errors.Count; i++)\n            {\n                yield return string.Format(\"[{0}] {1} ({2})\", _session.Errors[i].Code, _session.Errors[i].Message, _session.Errors[i].Source);\n            }\n        }\n    }\n\n    public void Dispose()\n    {\n        _session.Dispose();\n    }\n}\n</code></pre>\n\n<p>Of course a VBA implementation will be wildly different, but the important part is this:</p>\n\n<pre><code>_session.Open(credential.UserId, credential.Password, credential.DatabaseName, timestamp, flags);\n</code></pre>\n\n<p>My calling code looks like this:</p>\n\n<pre><code>_session.Init(string.Empty, _info);\n_session.Open(_credential, DateTime.Now);\n_db = _session.OpenDbLink(DBLinkType.Company, DBLinkFlags.ReadWrite);\n</code></pre>\n\n<p>So, have your code supply a <code>UserId</code> a <code>Password</code>, a <code>DatabaseName</code>, a timestamp and whatever <code>DBLinkFlags</code> you need; your VBA code could look like this:</p>\n\n<pre><code>mySession.Open APP_USERID, APP_PWD, APP_TESTDB, Now, DBLinkFlags.ReadWrite\n</code></pre>\n\n<p>Where <code>mySession</code> is a global object variable, and then wherever <code>APP_USERID</code> comes from is entirely up to you. Hard-code them in the <code>.Open</code> call, make them in-code constants, or make them in-code variables and store the values in your Access database, or in an external xml configuration file, anything works; start by getting hard-coded credentials working, and then figure out a strategy to parameterize them.</p>\n"}, {"tags": [], "owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "is_accepted": false, "score": 0, "last_activity_date": 1466103092, "last_edit_date": 1466103092, "creation_date": 1466094805, "answer_id": 37864771, "question_id": 37841393, "link": "https://stackoverflow.com/questions/37841393/using-access-vba-to-pass-the-login-via-variables-to-automate-the-login-to-sage-l/37864771#37864771", "title": "Using access vba to pass the login via variables to automate the login to Sage Line 50 ver20", "body": "<p>This might explain why you're getting prompted each time for login info.\nI think you're using two opens - but only one is connected with your connxn string. </p>\n\n<p>Does this work any better?</p>\n\n<pre><code>    Dim sagedb As Database \n    Dim rs As Recordset \n    Dim strConnect As String \n\n    strConnect = \"DSN=SageAccountsVer20;uid=xxx;pwd=xxx;\" \n    Set sagedb = OpenDatabase(\"Directory\", False, False, strConnect) \n    Set rs = sagedb.OpenRecordset(\"dbo_authors\") \n\n    Debug.Print rs(0) \n    Debug.Print \"Recordset Opened Successfully\" \n\n    rs.Close \n    sagedb .Close \n    Set sagedb = Nothing \n\n    sagedb.Close\n    Set rs = Nothing\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6470763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ff5a4c979c3c6a1955e359f86bf3dca?s=128&d=identicon&r=PG&f=1", "display_name": "P.Harrison", "link": "https://stackoverflow.com/users/6470763/p-harrison"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 199, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1594641926, "creation_date": 1466009616, "last_edit_date": 1594641926, "question_id": 37841393, "link": "https://stackoverflow.com/questions/37841393/using-access-vba-to-pass-the-login-via-variables-to-automate-the-login-to-sage-l", "title": "Using access vba to pass the login via variables to automate the login to Sage Line 50 ver20", "body": "<p>So i managed to connect Sage to my access database which is great but every time i close the database and open it up again i have to login again manually is there anyway of storing that data in Access? Be it via a variable or a table because clearly access can save the login information somewhere because i only need to login once. </p>\n\n<blockquote>\n  <p>Edit - added login connect details</p>\n</blockquote>\n\n<pre><code>Sub login_Click() \n    Dim sagedb As Database \n    Dim accessdb As Database \n    Dim rs As Recordset \n    Dim strConnect As String \n    Set sagedb = OpenDatabase(\"Directory\") \n    strConnect = \"DSN=SageAccountsVer20;uid=xxx;pwd=xxx;\" \n    Set accessdb = OpenDatabase(\"\", False, False, strConnect) \n    accessdb.Close \n    Set accessdb = Nothing \n    Set rs = sagedb.OpenRecordset(\"dbo_authors\") \n    Debug.Print rs(0) \n    Debug.Print \"Recordset Opened Successfully\" \n    rs.Close \n    sagedb.Close\n    Set rs = Nothing\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1466009798, "post_id": 37841283, "comment_id": 63143693, "body": "Can you please paste your macro, as text? We don&#39;t generally like having to type out your macro, then work on fixing.  But I&#39;m going to guess it&#39;s your use of <code>CurrentRegion</code>, which may not be the region you expect it to be?"}, {"owner": {"reputation": 1, "user_id": 6470678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/461a117516c34b608067759a684a98be?s=128&d=identicon&r=PG&f=1", "display_name": "Mike J", "link": "https://stackoverflow.com/users/6470678/mike-j"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1466010414, "post_id": 37841283, "comment_id": 63144026, "body": "@BruceWayne Sorry for that. Im new here. Here&#39;s the macro (I haven&#39;t finished all of them as you see because I&#39;ve used copy and paste to duplicate) --- I&#39;ve used the same for others  Private Sub CommandButton1_Click() Dim RowCount As Long  If CategoriesComboBox.Value = &quot;Household&quot; Then RowCount = Worksheets(&quot;Data Lists&quot;).Range(&quot;C7&quot;).CurrentRegion.Rows.Count  With Worksheets(&quot;Data Lists&quot;).Range(&quot;C7&quot;)     .Offset(RowCount, 0).Value = Me.NameTextBox.Value End With End If"}], "answers": [{"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1466010260, "post_id": 37841522, "comment_id": 63143935, "body": "+1 for the PS.  Also, just a note to OP: You may want to (err, should) qualify the <code>Cells()</code> and <code>Rows.Count</code> with the worksheet you expect that to run on (either using <code>With</code> or just add the sheet name before <code>.Cells()</code> and <code>.Rows.Count</code>"}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1466010449, "post_id": 37841522, "comment_id": 63144036, "body": "+1 Yep, that&#39;s a good practice, however, depends a lot on the context, for example, if the user form is only called from a sequence that can only be accessed within the sheet -IE: a command button- I think it saves you a few lines to code and makes the flow more understandable of how was intended to work."}, {"owner": {"reputation": 1, "user_id": 6470678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/461a117516c34b608067759a684a98be?s=128&d=identicon&r=PG&f=1", "display_name": "Mike J", "link": "https://stackoverflow.com/users/6470678/mike-j"}, "edited": false, "score": 0, "creation_date": 1466011057, "post_id": 37841522, "comment_id": 63144388, "body": "It does not works in the correct manner. It adds twice the gap between rows"}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1466011416, "post_id": 37841522, "comment_id": 63144590, "body": "Did you try to take out the &quot;+1&quot; as commented in the code? If the behavior it&#39;s surpassing by one the desired behavior just change to &quot;-1&quot;. The explanation &quot;Cells(Rows.Count, &quot;C&quot;).End(xlUp).Row&quot; this checks what&#39;s the last row in the column &quot;C&quot; doesn&#39;t matter if there are blanks among, so for example, in the image would be 13, if you want to add to the next one shouldn&#39;t be add my string to row 14,   hence 13+1, thus Cells(Rows.Count, &quot;C&quot;).End(xlUp).Row +1 ?"}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1466012284, "post_id": 37841522, "comment_id": 63145034, "body": "Check my updated answer and let me know if that works"}, {"owner": {"reputation": 1, "user_id": 6470678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/461a117516c34b608067759a684a98be?s=128&d=identicon&r=PG&f=1", "display_name": "Mike J", "link": "https://stackoverflow.com/users/6470678/mike-j"}, "edited": false, "score": 0, "creation_date": 1466025334, "post_id": 37841522, "comment_id": 63152062, "body": "I tried both: removing the +1 and then the new code but still it outputs me at D24, while I want it at D14"}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1466027938, "post_id": 37841522, "comment_id": 63153181, "body": "Yes, it was wrong since you start at D7 so would be 13-6 = 7 to write it in 14, check updated answer again and try the corrected code, please"}], "tags": [], "owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "is_accepted": false, "score": 1, "last_activity_date": 1466012268, "last_edit_date": 1466012268, "creation_date": 1466010051, "answer_id": 37841522, "question_id": 37841283, "link": "https://stackoverflow.com/questions/37841283/excel-vba-userform-that-adds-values-to-the-end-of-each-column/37841522#37841522", "title": "Excel -VBA Userform that adds values to the end of each column", "body": "<p>This should solve it: <br>\nCorrect for both RowCount variables</p>\n\n<pre><code>'RowCount in household\nRowCount = Cells(Rows.Count, \"C\").End(xlUp).Row + 1 'probably + 1 is going to leave a blank, check for it\n'RowCount in entretainment \nRowCount = Cells(Rows.Count, \"D\").End(xlUp).Row + 1 'probably + 1 is going to leave a blank, check for it\n'... and so on for each field in your form with its corresponding Column letter \n</code></pre>\n\n<p><br>\n<em>PS: \"I'm in a hurry. Please ASAP.\" is not a good manner to ask for things. This is not a we work for free site nor 24/7 availability, especially when you only paste an image for what you want to do.</em></p>\n\n<p><strong>EDIT:</strong><br>\nReplace this</p>\n\n<pre><code>If CategoriesComboBox.Value = \"Entertainment\" Then\nRowCount = Worksheets(\"Data Lists\").Range(\"D7\").CurrentRegion.Rows.Count\n\nWith Worksheets(\"Data Lists\").Range(\"D7\")\n    .Offset(RowCount, 0).Value = Me.NameTextBox.Value\nEnd With\nEnd If\n</code></pre>\n\n<p>For this:</p>\n\n<pre><code>If CategoriesComboBox.Value = \"Entertainment\" Then\nRowCount = Worksheets(\"Data Lists\").Cells(Rows.Count, \"D\").End(xlUp).Row -6 'since offset is starting at D7\n\nWith Worksheets(\"Data Lists\").Range(\"D7\")\n    .Offset(RowCount, 0).Value = Me.NameTextBox.Value\nEnd With\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6470678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/461a117516c34b608067759a684a98be?s=128&d=identicon&r=PG&f=1", "display_name": "Mike J", "link": "https://stackoverflow.com/users/6470678/mike-j"}, "is_accepted": false, "score": 0, "last_activity_date": 1466025720, "creation_date": 1466025720, "answer_id": 37845998, "question_id": 37841283, "link": "https://stackoverflow.com/questions/37841283/excel-vba-userform-that-adds-values-to-the-end-of-each-column/37845998#37845998", "title": "Excel -VBA Userform that adds values to the end of each column", "body": "<p>What I want is just to output in designated cells ---> <a href=\"http://i.stack.imgur.com/IIkXx.jpg\" rel=\"nofollow\">Sample</a></p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim RowCount As Long\n\nIf CategoriesComboBox.Value = \"Household\" Then\nRowCount = Worksheets(\"Data Lists\").Range(\"C7\").CurrentRegion.Rows.Count\n\nWith Worksheets(\"Data Lists\").Range(\"C7\")\n    .Offset(RowCount, 0).Value = Me.NameTextBox.Value\nEnd With\nEnd If\n\nIf CategoriesComboBox.Value = \"Entertainment\" Then\nRowCount = Worksheets(\"Data Lists\").Cells(Rows.Count, \"D\").End(xlUp).Row - 6 'since offset is starting at D7\n\nWith Worksheets(\"Data Lists\").Range(\"D7\")\n    .Offset(RowCount, 0).Value = Me.NameTextBox.Value\nEnd With\nEnd If\n\nIf CategoriesComboBox.Value = \"Food\" Then\nRowCount = Worksheets(\"Data Lists\").Range(\"E7\").CurrentRegion.Rows.Count\n\nWith Worksheets(\"Data Lists\").Range(\"E7\")\n    .Offset(RowCount, 0).Value = Me.NameTextBox.Value\nEnd With\nEnd If\nIf CategoriesComboBox.Value = \"Gifts/Donations\" Then\nRowCount = Worksheets(\"Data Lists\").Range(\"F7\").CurrentRegion.Rows.Count\n\nWith Worksheets(\"Data Lists\").Range(\"F7\")\n    .Offset(RowCount, 0).Value = Me.NameTextBox.Value\nEnd With\nEnd If\nIf CategoriesComboBox.Value = \"Children\" Then\nRowCount = Worksheets(\"Data Lists\").Range(\"G7\").CurrentRegion.Rows.Count\n\nWith Worksheets(\"Data Lists\").Range(\"G7\")\n    .Offset(RowCount, 0).Value = Me.NameTextBox.Value\nEnd With\nEnd If\n\nIf CategoriesComboBox.Value = \"Investment Accounts\" Then\nRowCount = Worksheets(\"Data Lists\").Range(\"G7\").CurrentRegion.Rows.Count\n\nWith Worksheets(\"Data Lists\").Range(\"G7\")\n    .Offset(RowCount, 0).Value = Me.NameTextBox.Value\nEnd With\nEnd If\n\nIf CategoriesComboBox.Value = \"Medical\" Then\nRowCount = Worksheets(\"Data Lists\").Range(\"G7\").CurrentRegion.Rows.Count\n\nWith Worksheets(\"Data Lists\").Range(\"G7\")\n    .Offset(RowCount, 0).Value = Me.NameTextBox.Value\nEnd With\nEnd If\n\nIf CategoriesComboBox.Value = \"Other\" Then\nRowCount = Worksheets(\"Data Lists\").Range(\"G7\").CurrentRegion.Rows.Count\n\nWith Worksheets(\"Data Lists\").Range(\"G7\")\n    .Offset(RowCount, 0).Value = Me.NameTextBox.Value\nEnd With\nEnd If\n\nIf CategoriesComboBox.Value = \"Personal\" Then\nRowCount = Worksheets(\"Data Lists\").Range(\"G7\").CurrentRegion.Rows.Count\n\nWith Worksheets(\"Data Lists\").Range(\"G7\")\n    .Offset(RowCount, 0).Value = Me.NameTextBox.Value\nEnd With\nEnd If\n\nIf CategoriesComboBox.Value = \"Pets\" Then\nRowCount = Worksheets(\"Data Lists\").Range(\"G7\").CurrentRegion.Rows.Count\n\nWith Worksheets(\"Data Lists\").Range(\"G7\")\n    .Offset(RowCount, 0).Value = Me.NameTextBox.Value\nEnd With\nEnd If\n\nIf CategoriesComboBox.Value = \"Taxes/Legal\" Then\nRowCount = Worksheets(\"Data Lists\").Range(\"G7\").CurrentRegion.Rows.Count\n\nWith Worksheets(\"Data Lists\").Range(\"G7\")\n    .Offset(RowCount, 0).Value = Me.NameTextBox.Value\nEnd With\nEnd If\n\nIf CategoriesComboBox.Value = \"Transportation\" Then\nRowCount = Worksheets(\"Data Lists\").Range(\"G7\").CurrentRegion.Rows.Count\n\nWith Worksheets(\"Data Lists\").Range(\"G7\")\n    .Offset(RowCount, 0).Value = Me.NameTextBox.Value\nEnd With\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6470678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/461a117516c34b608067759a684a98be?s=128&d=identicon&r=PG&f=1", "display_name": "Mike J", "link": "https://stackoverflow.com/users/6470678/mike-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1528912642, "creation_date": 1466009238, "last_edit_date": 1528912642, "question_id": 37841283, "link": "https://stackoverflow.com/questions/37841283/excel-vba-userform-that-adds-values-to-the-end-of-each-column", "title": "Excel -VBA Userform that adds values to the end of each column", "body": "<p>I have created a table and then filled it with values as seen in the image. Now I want to fill values in that table with a userform that I created. The code assigned to add item button as seen in the image is only for the first two columns.</p>\n\n<p>The first one works well and adds data after the filled ones, but the second doesn't as it adds data far away from the filled ones.</p>\n\n<p>Here's the Image: </p>\n\n<p><img src=\"https://i.stack.imgur.com/YT624.jpg\" alt=\"Screenshot\"></p>\n\n<p>Here's the code :</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim RowCount As Long\n\nIf CategoriesComboBox.Value = \"Household\" Then\nRowCount = Worksheets(\"Data Lists\").Range(\"C7\").CurrentRegion.Rows.Count\n\nWith Worksheets(\"Data Lists\").Range(\"C7\")\n    .Offset(RowCount, 0).Value = Me.NameTextBox.Value\nEnd With\nEnd If\n\nIf CategoriesComboBox.Value = \"Entertainment\" Then\nRowCount = Worksheets(\"Data Lists\").Range(\"D7\").CurrentRegion.Rows.Count\n\nWith Worksheets(\"Data Lists\").Range(\"D7\")\n    .Offset(RowCount, 0).Value = Me.NameTextBox.Value\nEnd With\nEnd If\n\nIf CategoriesComboBox.Value = \"Food\" Then\nRowCount = Worksheets(\"Data Lists\").Range(\"E7\").CurrentRegion.Rows.Count\n\nWith Worksheets(\"Data Lists\").Range(\"E7\")\n    .Offset(RowCount, 0).Value = Me.NameTextBox.Value\nEnd With\nEnd If\nIf CategoriesComboBox.Value = \"Gifts/Donations\" Then\nRowCount = Worksheets(\"Data Lists\").Range(\"F7\").CurrentRegion.Rows.Count\n\nWith Worksheets(\"Data Lists\").Range(\"F7\")\n    .Offset(RowCount, 0).Value = Me.NameTextBox.Value\nEnd With\nEnd If\nIf CategoriesComboBox.Value = \"Children\" Then\nRowCount = Worksheets(\"Data Lists\").Range(\"G7\").CurrentRegion.Rows.Count\n\nWith Worksheets(\"Data Lists\").Range(\"G7\")\n    .Offset(RowCount, 0).Value = Me.NameTextBox.Value\nEnd With\nEnd If\n\nIf CategoriesComboBox.Value = \"Investment Accounts\" Then\nRowCount = Worksheets(\"Data Lists\").Range(\"G7\").CurrentRegion.Rows.Count\n\nWith Worksheets(\"Data Lists\").Range(\"G7\")\n    .Offset(RowCount, 0).Value = Me.NameTextBox.Value\nEnd With\nEnd If\n\nIf CategoriesComboBox.Value = \"Medical\" Then\nRowCount = Worksheets(\"Data Lists\").Range(\"G7\").CurrentRegion.Rows.Count\n\nWith Worksheets(\"Data Lists\").Range(\"G7\")\n    .Offset(RowCount, 0).Value = Me.NameTextBox.Value\nEnd With\nEnd If\n\nIf CategoriesComboBox.Value = \"Other\" Then\nRowCount = Worksheets(\"Data Lists\").Range(\"G7\").CurrentRegion.Rows.Count\n\nWith Worksheets(\"Data Lists\").Range(\"G7\")\n    .Offset(RowCount, 0).Value = Me.NameTextBox.Value\nEnd With\nEnd If\n\nIf CategoriesComboBox.Value = \"Personal\" Then\nRowCount = Worksheets(\"Data Lists\").Range(\"G7\").CurrentRegion.Rows.Count\n\nWith Worksheets(\"Data Lists\").Range(\"G7\")\n    .Offset(RowCount, 0).Value = Me.NameTextBox.Value\nEnd With\nEnd If\n\nIf CategoriesComboBox.Value = \"Pets\" Then\nRowCount = Worksheets(\"Data Lists\").Range(\"G7\").CurrentRegion.Rows.Count\n\nWith Worksheets(\"Data Lists\").Range(\"G7\")\n    .Offset(RowCount, 0).Value = Me.NameTextBox.Value\nEnd With\nEnd If\n\nIf CategoriesComboBox.Value = \"Taxes/Legal\" Then\nRowCount = Worksheets(\"Data Lists\").Range(\"G7\").CurrentRegion.Rows.Count\n\nWith Worksheets(\"Data Lists\").Range(\"G7\")\n    .Offset(RowCount, 0).Value = Me.NameTextBox.Value\nEnd With\nEnd If\n\nIf CategoriesComboBox.Value = \"Transportation\" Then\nRowCount = Worksheets(\"Data Lists\").Range(\"G7\").CurrentRegion.Rows.Count\n\nWith Worksheets(\"Data Lists\").Range(\"G7\")\n    .Offset(RowCount, 0).Value = Me.NameTextBox.Value\nEnd With\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["linux", "vba", "perl", "shell", "visual-studio-2012"], "comments": [{"owner": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "edited": false, "score": 2, "creation_date": 1466009225, "post_id": 37841250, "comment_id": 63143368, "body": "Is the random integer between 0 and 255? Are you sure your <code>Shell</code> command returns the <i>output</i> and not the exit code of the program?"}, {"owner": {"reputation": 2279, "user_id": 13563, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/VoEyi.jpg?s=128&g=1", "display_name": "jimtut", "link": "https://stackoverflow.com/users/13563/jimtut"}, "edited": false, "score": 0, "creation_date": 1466010822, "post_id": 37841250, "comment_id": 63144262, "body": "At first I thought this was a Linux, but it&#39;s really a Windows VBA question, right?  Seems like only the target computer is Linux, but that&#39;s really irrelevant to how to make the Shell call from VBA.  Besides the issue of how to capture the output (not the PID or response value) from your shell call, I don&#39;t think you&#39;re using <code>plink</code> correctly.  Maybe you dropped it, but I think you need to specify <code>user@host</code> and probably a password too."}, {"owner": {"reputation": 1, "user_id": 6470719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08e0cc63a4f508849810b6a3090c91e8?s=128&d=identicon&r=PG&f=1", "display_name": "Ed.T", "link": "https://stackoverflow.com/users/6470719/ed-t"}, "edited": false, "score": 0, "creation_date": 1466044217, "post_id": 37841250, "comment_id": 63157250, "body": "Oops... I used the dos putty command as:  Perl_Cmd = &quot;perl &quot; &amp; &quot;/usr/script/a.pl&quot; Shell_Cmd = &quot;plink root@&quot; &amp; &quot;123.123.123.123&quot; &amp; &quot; -pw root &quot; &amp; Perl_Cmd  RetVal = Shell(Shell_Cmd)   The return value can be more than 255...or rather 4 to 5 digits number.  However, when I execute the a.pl in the linux base, the return would be OK or NOT OK. I know that the a.pl (perl script) is working fine but not he returning value to the VBA."}], "answers": [{"tags": [], "owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "is_accepted": false, "score": 0, "last_activity_date": 1466132706, "creation_date": 1466132706, "answer_id": 37872454, "question_id": 37841250, "link": "https://stackoverflow.com/questions/37841250/return-value-from-vba-call-shellwhatever-cmd/37872454#37872454", "title": "Return Value from VBA Call Shell(whatever_cmd)", "body": "<p><a href=\"https://msdn.microsoft.com/en-us/library/xe736fyk(v=vs.90).aspx\" rel=\"nofollow\">Shell's return value</a> is the program's process ID. To get the actual output of the program (as you would see from a prompt), <a href=\"https://technet.microsoft.com/en-us/library/ee156605.aspx\" rel=\"nofollow\">create a wscript object</a> and call the <code>.exec</code> method. Try something like this:</p>\n\n<pre><code>Set objShell = WScript.CreateObject(\"WScript.Shell\")\nSet objExecObject = objShell.Exec(\"plink perl test.pl\")\n\nDo While objExecObject.Status = WshRunning\n    DoEvents\n    'Could add a counter here to exit if it takes too long\nLoop\n\n objExecObject.StdOut.ReadAll \n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6470719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08e0cc63a4f508849810b6a3090c91e8?s=128&d=identicon&r=PG&f=1", "display_name": "Ed.T", "link": "https://stackoverflow.com/users/6470719/ed-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1619, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1466132706, "creation_date": 1466009126, "last_edit_date": 1466009175, "question_id": 37841250, "link": "https://stackoverflow.com/questions/37841250/return-value-from-vba-call-shellwhatever-cmd", "title": "Return Value from VBA Call Shell(whatever_cmd)", "body": "<p>I'm trying to execute a plink command to invoke perl script on a Linux platform which returning a value or a response in string.</p>\n\n<p>I tried:</p>\n\n<pre><code>retval = Shell(\"plink perl test.pl\")\n</code></pre>\n\n<p>where test.pl return value with either OK or NOT OK</p>\n\n<p>But I couldn't capture those string in the retval variable.\nWhen I track the retval, it appear to be random integer.</p>\n\n<p>Is there a way to capture the right return value or string?</p>\n"}, {"tags": ["excel", "import", "delimiter", "xlsx", "vba"], "comments": [{"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 1, "creation_date": 1466009398, "post_id": 37841147, "comment_id": 63143457, "body": "And the error is -doesn&#39;t open the file? Doesn&#39;t limit it? Limit size is not the same ?- The syntax seems correct to me."}, {"owner": {"reputation": 309, "user_id": 3936686, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/dad8c74f777a10ff0a59f64294398be3?s=128&d=identicon&r=PG&f=1", "display_name": "BKChedlia", "link": "https://stackoverflow.com/users/3936686/bkchedlia"}, "reply_to_user": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1466010195, "post_id": 37841147, "comment_id": 63143897, "body": "@Sgdva, I add a picture."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1466010538, "post_id": 37841147, "comment_id": 63144095, "body": "Are the &quot;wrong&quot; files from a different source?"}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1466010630, "post_id": 37841147, "comment_id": 63144161, "body": "Can you upload a working .txt file and a the non working one? I can&#39;t open DB so, preferably GDrive :)"}, {"owner": {"reputation": 309, "user_id": 3936686, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/dad8c74f777a10ff0a59f64294398be3?s=128&d=identicon&r=PG&f=1", "display_name": "BKChedlia", "link": "https://stackoverflow.com/users/3936686/bkchedlia"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1466010823, "post_id": 37841147, "comment_id": 63144263, "body": "@TimWilliams , same source"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1466011313, "post_id": 37841147, "comment_id": 63144542, "body": "It seems that the <code>.TextToColumns</code> method fails. Did you try to do it manually (just to check if it works then). If it works manually, then record what you are doing with the macro recorder and compare the resulting code to the code in your sub. If it doesn&#39;t work then the delimiter might be incorrect. Maybe it is not a <code>|</code> which is <code>ChrW(124)</code> but maybe it is a <code>ChrW(9474)</code> (which looks very similar)."}, {"owner": {"reputation": 309, "user_id": 3936686, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/dad8c74f777a10ff0a59f64294398be3?s=128&d=identicon&r=PG&f=1", "display_name": "BKChedlia", "link": "https://stackoverflow.com/users/3936686/bkchedlia"}, "reply_to_user": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1466011348, "post_id": 37841147, "comment_id": 63144558, "body": "@Sgdva, yes , the Reass150616 is ok but the file AI150616 is wrong"}, {"owner": {"reputation": 309, "user_id": 3936686, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/dad8c74f777a10ff0a59f64294398be3?s=128&d=identicon&r=PG&f=1", "display_name": "BKChedlia", "link": "https://stackoverflow.com/users/3936686/bkchedlia"}, "edited": false, "score": 0, "creation_date": 1466011694, "post_id": 37841147, "comment_id": 63144741, "body": "the wrong file : <a href=\"https://drive.google.com/open?id=0B6nhIMB-ueBhRzUtX2dmNl9EWkk\" rel=\"nofollow noreferrer\">drive.google.com/open?id=0B6nhIMB-ueBhRzUtX2dmNl9EWkk</a>             &amp;&amp; the correct one : <a href=\"https://drive.google.com/open?id=0B6nhIMB-ueBhdzkzZGJLTVRjNk0\" rel=\"nofollow noreferrer\">drive.google.com/open?id=0B6nhIMB-ueBhdzkzZGJLTVRjNk0</a>"}, {"owner": {"reputation": 309, "user_id": 3936686, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/dad8c74f777a10ff0a59f64294398be3?s=128&d=identicon&r=PG&f=1", "display_name": "BKChedlia", "link": "https://stackoverflow.com/users/3936686/bkchedlia"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1466011797, "post_id": 37841147, "comment_id": 63144799, "body": "Hi @Ralph, I try to open the txt file manually and it works, You can see my 2 files and my macro where one works and the other no"}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1466014094, "post_id": 37841147, "comment_id": 63145995, "body": "There&#39;s a problem with your data in the second one, check my answer."}], "answers": [{"comments": [{"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1466015470, "post_id": 37842448, "comment_id": 63146751, "body": "It&#39;s not the problem, the problem is that the &quot;raw&quot; data has 2 columns, excel can&#39;t delimit when source data has 2 columns."}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1466016051, "post_id": 37842448, "comment_id": 63147109, "body": "Even the solution is a work-around, the data is compromised, probably the best approach would be to fix the &quot;raw&quot; data so delimit can work properly."}], "tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": false, "score": 1, "last_activity_date": 1466013154, "creation_date": 1466013154, "answer_id": 37842448, "question_id": 37841147, "link": "https://stackoverflow.com/questions/37841147/vba-convert-delimiter-text-file-to-excel/37842448#37842448", "title": "VBA Convert delimiter text file to Excel", "body": "<p>While I do not understand the solution / problem yet, it seems that it is solved if you apply the <code>.TextToColumns</code> method twice:</p>\n\n<pre><code>With ActiveSheet.Range(\"A1\").Resize(LineIndex, 1)\n    .Value = WorksheetFunction.Transpose(strLine)\n    .TextToColumns Other:=True, OtherChar:=\"|\"\n    .TextToColumns Other:=True, OtherChar:=\"|\"\nEnd With\n</code></pre>\n\n<p>Maybe someone else can clarify why that is. While this is not the kind of post I normally provide, the above should give you a workaround while someone else comes up with a better solution (including an explanation).</p>\n"}, {"comments": [{"owner": {"reputation": 309, "user_id": 3936686, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/dad8c74f777a10ff0a59f64294398be3?s=128&d=identicon&r=PG&f=1", "display_name": "BKChedlia", "link": "https://stackoverflow.com/users/3936686/bkchedlia"}, "edited": false, "score": 1, "creation_date": 1466060588, "post_id": 37843139, "comment_id": 63162824, "body": "The file text is the problem...The client send data to DB and we extract data in .txt, I didn&#39;t see that in the data the is some tab, and the extraction was made by pipes ...   anyway, the solution above solved the problem. thanks everybody"}], "tags": [], "owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "is_accepted": false, "score": 1, "last_activity_date": 1466015696, "last_edit_date": 1466015696, "creation_date": 1466015371, "answer_id": 37843139, "question_id": 37841147, "link": "https://stackoverflow.com/questions/37841147/vba-convert-delimiter-text-file-to-excel/37843139#37843139", "title": "VBA Convert delimiter text file to Excel", "body": "<p>The file AI150616 has in the column \"B\" the data \n<code>30,619,676.00 Net worth = ZAR 83,456,466.00 Hence, final required BG should be (63,503,915.82)</code><br> \n<a href=\"https://i.stack.imgur.com/Kh9Vk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Kh9Vk.png\" alt=\"enter image description here\"></a>\n Delimiter only works with one column. \nShould that be allowable? If not, another procedure may be needed to check if data is correct , if so, append it, else, warn the user data has been compromised somehow.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 2, "last_activity_date": 1466015967, "creation_date": 1466015967, "answer_id": 37843318, "question_id": 37841147, "link": "https://stackoverflow.com/questions/37841147/vba-convert-delimiter-text-file-to-excel/37843318#37843318", "title": "VBA Convert delimiter text file to Excel", "body": "<p>First off, you have bad data. There is a tab character between <em>Total liabilities</em> and <em>30,619,676.00</em> in AI060616.txt. Excel doesn't like tabs in cell content. In fact, the tab character is the default delimiter on a TextToColumns command and this translates into two column of data when the array is brought in.</p>\n\n<pre><code>    Open txtFldrPath &amp; \"\\\" &amp; CurrentFile For Input As #1\n    While Not EOF(1)\n        LineIndex = LineIndex + 1\n        ReDim Preserve strLine(1 To LineIndex)\n        Line Input #1, strLine(LineIndex)\n        'STRIP TABS OUT AND REPLACE WITH A SPACE!!!!!\n        strLine(LineIndex) = Replace(strLine(LineIndex), Chr(9), Chr(32))\n    Wend\n    Close #1\n</code></pre>\n\n<p>Next, the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff193593.aspx\" rel=\"nofollow noreferrer\">Range.TextToColumns method</a> 'remembers' all of the settings that were used the last time it was run through; it doen't matter whether that was by the user on hte worksheet or through VBA. You need many more parameters than you have supplied in order to guarantee that it is going to operate the way you want.</p>\n\n<pre><code>    With ActiveSheet.Range(\"A1\").Resize(LineIndex, 1)\n        .Value = WorksheetFunction.Transpose(strLine)\n        'DEFINE THE OPERATION FULLY!!!!\n        .TextToColumns Destination:=.Cells(1), DataType:=xlDelimited, _\n                       TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, _\n                       Tab:=False, Semicolon:=False, Comma:=False, Space:=False, _\n                       Other:=True, OtherChar:=\"|\"\n    End With\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/ux8Hf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ux8Hf.png\" alt=\"import_TXT\"></a></p>\n"}], "owner": {"reputation": 309, "user_id": 3936686, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/dad8c74f777a10ff0a59f64294398be3?s=128&d=identicon&r=PG&f=1", "display_name": "BKChedlia", "link": "https://stackoverflow.com/users/3936686/bkchedlia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8734, "favorite_count": 0, "accepted_answer_id": 37843318, "answer_count": 3, "score": 2, "last_activity_date": 1466016468, "creation_date": 1466008800, "last_edit_date": 1531161705, "question_id": 37841147, "link": "https://stackoverflow.com/questions/37841147/vba-convert-delimiter-text-file-to-excel", "title": "VBA Convert delimiter text file to Excel", "body": "<p>I have a code that convert files in folder from .txt (with \"|\" separator) to xslx, \nBut the code works fine for some files (when I open it in excel), the others are wrong, when I try to import the wring one manually by excel ribbon(Get external data -- > from text), the files are correct.</p>\n\n<p>This is my code :</p>\n\n<pre><code>Sub tgr()\n\n    Const txtFldrPath As String = \"C:\\...\\txtFiles\"     \n    Const xlsFldrPath As String = \"C:\\excelFiles\"     \n\n    Dim CurrentFile As String: CurrentFile = Dir(txtFldrPath &amp; \"\\\" &amp; \"*.txt\")\n    Dim strLine() As String\n    Dim LineIndex As Long\n\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n    While CurrentFile &lt;&gt; vbNullString\n        LineIndex = 0\n        Close #1\n        Open txtFldrPath &amp; \"\\\" &amp; CurrentFile For Input As #1\n        While Not EOF(1)\n            LineIndex = LineIndex + 1\n            ReDim Preserve strLine(1 To LineIndex)\n            Line Input #1, strLine(LineIndex)\n        Wend\n        Close #1\n\n        With ActiveSheet.Range(\"A1\").Resize(LineIndex, 1)\n            .Value = WorksheetFunction.Transpose(strLine)\n            .TextToColumns Other:=True, OtherChar:=\"|\"\n        End With\n\n        ActiveSheet.UsedRange.EntireColumn.AutoFit\n        ActiveSheet.Copy\n        ActiveWorkbook.SaveAs xlsFldrPath &amp; \"\\\" &amp; Replace(CurrentFile, \".txt\", \".xlsx\"), xlOpenXMLWorkbook\n        ActiveWorkbook.Close False\n        ActiveSheet.UsedRange.ClearContents\n\n        CurrentFile = Dir\n    Wend\n    Application.DisplayAlerts = True\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/EwaBz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EwaBz.png\" alt=\"enter image description here\"></a>\nthis picture show the result in excel and the original file .txt</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1466009073, "post_id": 37840951, "comment_id": 63143288, "body": "There are many situations where excel confuses and allows a value one time by vba that doesn&#39;t allow it in the same way in the WB, yet, is there, so, when you try to open it the error shows. OT: For me has happened when by VBA, I add more than 255 characters to a validation list, just make sure you don&#39;t lose that data -when the error pops up it will tell you what&#39;s more likely to be compromised-."}], "tags": [], "owner": {"reputation": 401, "user_id": 2812977, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/iudgu.jpg?s=128&g=1", "display_name": "Rocky Scott", "link": "https://stackoverflow.com/users/2812977/rocky-scott"}, "is_accepted": false, "score": 0, "last_activity_date": 1466008233, "creation_date": 1466008233, "answer_id": 37840951, "question_id": 37840950, "link": "https://stackoverflow.com/questions/37840950/excel-saves-file-but-throws-error-on-opening-it-we-found-a-prob-lem-with-some/37840951#37840951", "title": "Excel saves file, but throws error on opening it: &quot;We found a prob-lem with some content in \u2026&quot;", "body": "<p>I had a user-defined worksheet function (UDF) that returned an array of values that was displayed in a chart.</p>\n\n<p>The UDF was setting some of these values to the impossible value of 2.69653970229349E+308 (apparently a dll was returning 1.#QNAN which Excel turned into 2.69653970229349E+308).</p>\n\n<p>Amazingly, Excel allowed this value to be saved in the cell, and the workbook to be saved. However, when opening the workbook, the error was received, and the offending chart was deleted during the \"recovery\".</p>\n\n<p>The cure was to ensure only realistic values are displayed in a chart.</p>\n\n<p>Here is code redacted from the rather large VBA project. </p>\n\n<pre><code>'Global array, Values returned by the UDF\nPublic MainReturnValues(1 To 57, 1 To 2) As Variant\n\nPublic Function MainWorksheetFunction( _\n      i_rRangeWithInputData As Range _\n      ) As Variant\n\n   '[... Process input data ...]\n\n   'Load global array MainReturnValues(,), i.e., values returned by the UDF\n   LoadMainWorksheetFunctionReturnValues\n\n   'Now load UDF return values\n   MainWorksheetFunction = MainReturnValues\n\nEnd Function\n\n'Load global array MainReturnValues(,), i.e., values returned by the UDF\nPrivate Function LoadMainWorksheetFunctionReturnValues( _\n      ) As Boolean\n\n   Dim l_vErrNull As Variant\n   Dim l_dChartXs(1 To 57) As Double, _\n       l_dChartYs(1 To 57) As Double\n   Dim c As Long, _\n       r As Long\n\n   '~~~~~~~ First fill area with xlErrNull to Prevent Log Chart Graphing 0 Errors\n   '~~~~~~~ Excel will \"pick up the pen\" when cells contain CVErr(xlErrNull)\n   l_vErrNull = CVErr(xlErrNull)\n   For r = LBound(MainReturnValues, 1) To UBound(MainReturnValues, 1)\n      For c = LBound(MainReturnValues, 2) To UBound(MainReturnValues, 2)\n         MainReturnValues(r, c) = l_vErrNull\n      Next c\n   Next r\n   '~~~~~~~ End First fill area with xlErrNull ~~~~~~~\n\n   '[... Load values into l_dChartXs() and l_dChartYs() using C# dll ...]\n\n   For r = 1 To 57\n\n      'Don't try to plot ridiculous values. I suspect this causes this error:\n      '\"We found a problem with some content in 'aaa.xlsb'. Do you want us to try to recover as much as we can? If you trust the source of this workbook, click Yes.\"\n      On Error Resume Next 'Catch 1.#QNAN\n      If ((l_dChartXs(r) &gt; 1E+308) Or (l_dChartYs(r) &gt; 1E+308)) Then\n\n      Else 'Value is not ridiculous\n         On Error GoTo 0\n\n         'Xs in first column\n         MainReturnValues(r, 1) = l_dChartXs(r)\n\n         'Ys in second column\n         MainReturnValues(r, 2) = l_dChartYs(r)\n      End If\n   Next r\n\n   LoadMainWorksheetFunctionReturnValues = True\nExit Function\n</code></pre>\n\n<p>I hope this helps someone.</p>\n"}, {"tags": [], "owner": {"reputation": 102, "user_id": 5821186, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/z0a2g.jpg?s=128&g=1", "display_name": "Sayyed Abbas Rizvi", "link": "https://stackoverflow.com/users/5821186/sayyed-abbas-rizvi"}, "is_accepted": false, "score": 0, "last_activity_date": 1532063652, "creation_date": 1532063652, "answer_id": 51435492, "question_id": 37840950, "link": "https://stackoverflow.com/questions/37840950/excel-saves-file-but-throws-error-on-opening-it-we-found-a-prob-lem-with-some/51435492#51435492", "title": "Excel saves file, but throws error on opening it: &quot;We found a prob-lem with some content in \u2026&quot;", "body": "<p>I tried looking solution for this all over the internet ,My Workbook was rather simple system generated .xls file with no shapes and chart,\nExcel was able to save it as .xlsx but was unable to open it without recovering contents</p>\n\n<p>I end up saving file as CSV and then later saved that CSV as xlsx\nI thought since CSV is almost like a text file with comma seprated values this might work for simple sheets with values</p>\n"}], "owner": {"reputation": 401, "user_id": 2812977, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/iudgu.jpg?s=128&g=1", "display_name": "Rocky Scott", "link": "https://stackoverflow.com/users/2812977/rocky-scott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 889, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1532063652, "creation_date": 1466008233, "last_edit_date": 1531161705, "question_id": 37840950, "link": "https://stackoverflow.com/questions/37840950/excel-saves-file-but-throws-error-on-opening-it-we-found-a-prob-lem-with-some", "title": "Excel saves file, but throws error on opening it: &quot;We found a prob-lem with some content in \u2026&quot;", "body": "<p>I was able to save a workbook, but then when I reopened it, Excel complained, \"We found a problem with some content in 'filename'. Do you want us to try to recover as much as we can? If you trust the source of this workbook, click Yes.\"</p>\n\n<p>\"Yes\" (i.e., recover) causes offending Drawings/Shapes/Charts to be deleted.</p>\n\n<p>The following describes the cause of my problem and its cure.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 552, "user_id": 6046766, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/a9801af62bcf72ae7979f12d7b6f2bce?s=128&d=identicon&r=PG&f=1", "display_name": "Davy C", "link": "https://stackoverflow.com/users/6046766/davy-c"}, "edited": false, "score": 0, "creation_date": 1466007534, "post_id": 37840706, "comment_id": 63142381, "body": "You would want to set ScreenUpdating to False before running this, that would speed it up. Impossible to tell how long it will take!"}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 1, "creation_date": 1466007763, "post_id": 37840706, "comment_id": 63142547, "body": "You might want to have a look at the HYPERLINK worksheet function."}], "answers": [{"tags": [], "owner": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "is_accepted": false, "score": 0, "last_activity_date": 1466008302, "creation_date": 1466008302, "answer_id": 37840974, "question_id": 37840706, "link": "https://stackoverflow.com/questions/37840706/insert-hyperlink-into-column-with-data/37840974#37840974", "title": "Insert hyperlink into column with data", "body": "<p>Try this:</p>\n\n<pre><code>Sub AddUrlSheet1()\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual\n    '\n    Dim LastUsedRow As Long\n    Dim r As Range, c As Range\n    With ActiveSheet\n        LastUsedRow = .Columns(\"A\").Cells.Find(\"*\", SearchOrder:=xlByRows, LookIn:=xlFormulas, SearchDirection:=xlPrevious).Row\n        Set r = .Range(.Cells(2, 1), .Cells(LastUsedRow, 1))\n    End With\n    '\n    For Each c In r\n        c.Hyperlinks.Add Anchor:=c, Address:=\"http://123.1.1.1/\" &amp; c.Value\n    Next c\n    Application.Calculation = xlCalculationAutomatic\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>This adds hyperlinks to all cells which currently have values in them in column A.</p>\n"}, {"comments": [{"owner": {"reputation": 39, "user_id": 5297060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaa8b35abc92a0947d10c374749571c8?s=128&d=identicon&r=PG&f=1", "display_name": "tieguanyindev", "link": "https://stackoverflow.com/users/5297060/tieguanyindev"}, "edited": false, "score": 0, "creation_date": 1466009877, "post_id": 37841030, "comment_id": 63143748, "body": "Thanks, so I can&#39;t use the same column A can&#39;t be reused?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 39, "user_id": 5297060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaa8b35abc92a0947d10c374749571c8?s=128&d=identicon&r=PG&f=1", "display_name": "tieguanyindev", "link": "https://stackoverflow.com/users/5297060/tieguanyindev"}, "edited": false, "score": 0, "creation_date": 1466010012, "post_id": 37841030, "comment_id": 63143806, "body": "@yu2bike - What do you mean? I just meant that if you column A has values such as &quot;1.2.3&quot;, &quot;12.203.2&quot;, etc. then this macro will place the hyperlink in column B. The macro in your OP goes through column A, and places the link over the cell, AFAIK."}, {"owner": {"reputation": 39, "user_id": 5297060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaa8b35abc92a0947d10c374749571c8?s=128&d=identicon&r=PG&f=1", "display_name": "tieguanyindev", "link": "https://stackoverflow.com/users/5297060/tieguanyindev"}, "edited": false, "score": 0, "creation_date": 1466010209, "post_id": 37841030, "comment_id": 63143907, "body": "I meant to ask, if I can&#39;t use column B another column for hyperlink, then I will have to use my original route? (looping cell by cell?)"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 39, "user_id": 5297060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaa8b35abc92a0947d10c374749571c8?s=128&d=identicon&r=PG&f=1", "display_name": "tieguanyindev", "link": "https://stackoverflow.com/users/5297060/tieguanyindev"}, "edited": false, "score": 0, "creation_date": 1466010324, "post_id": 37841030, "comment_id": 63143980, "body": "If you can&#39;t use column B, but can place the link in say column Z, then just change the column in <code>rng</code>. If you have to loop over your column A, and replace that text with a hyperlink, then yes you need to loop by cell."}, {"owner": {"reputation": 39, "user_id": 5297060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaa8b35abc92a0947d10c374749571c8?s=128&d=identicon&r=PG&f=1", "display_name": "tieguanyindev", "link": "https://stackoverflow.com/users/5297060/tieguanyindev"}, "edited": false, "score": 0, "creation_date": 1466097518, "post_id": 37841030, "comment_id": 63188087, "body": "Thank you @BruceWayne, after trying out. I think your method works better when I have thousands of the rows of data to loop through.  Looping kills the application.."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 0, "last_activity_date": 1466008433, "creation_date": 1466008433, "answer_id": 37841030, "question_id": 37840706, "link": "https://stackoverflow.com/questions/37840706/insert-hyperlink-into-column-with-data/37841030#37841030", "title": "Insert hyperlink into column with data", "body": "<p>Instead of looping cell by cell, use <code>Hyperlink()</code> with <code>Formula</code> to get it done. If your <code>R</code> values are in column A, this will fill in the hyperlinks in column B.</p>\n\n<pre><code>Sub t()\nDim rng As Range\n' Note: Update the `10` to match your lastRow\nSet rng = Range(\"B2:B\" &amp; ActiveSheet.Range(\"a2\").End(xlDown).Row)\n\nrng.FormulaR1C1 = \"=HYPERLINK(\"\"http://123.1.1.1/\"\"&amp;RC[-1],\"\"Link\"\")\"\n\nEnd Sub\n</code></pre>\n\n<p>If you HAVE to iterate over your already existing data, @Chris's answer looks pretty good.</p>\n"}], "owner": {"reputation": 39, "user_id": 5297060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaa8b35abc92a0947d10c374749571c8?s=128&d=identicon&r=PG&f=1", "display_name": "tieguanyindev", "link": "https://stackoverflow.com/users/5297060/tieguanyindev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 166, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1466008433, "creation_date": 1466007364, "last_edit_date": 1466007964, "question_id": 37840706, "link": "https://stackoverflow.com/questions/37840706/insert-hyperlink-into-column-with-data", "title": "Insert hyperlink into column with data", "body": "<p>I am trying to insert hyperlinks on column A which has data. for example, A1 is the title; A2 will be 12345 with hyperlink of <a href=\"http://123.1.1.1/?id=12345\" rel=\"nofollow\">http://123.1.1.1/?id=12345</a></p>\n\n<p>Currently I am running the macro on a worksheet that contains around 11000 rows. it's been about an hour, it is still running...</p>\n\n<p>Also, trying to see if this single macro can work on ALL worksheets.</p>\n\n<p>Below is my macro</p>\n\n<pre><code>Sub AddUrlSheet1()\nWith Worksheets(1)\n\nSet R = ActiveSheet.Range(\"a2\", ActiveSheet.Range(\"a2\").End(xlDown))\nR.Select\n\nFor Each R In Selection.Cells\n\n.Hyperlinks.Add Anchor:=R, _\nAddress=\"http://123.1.1.1/\" &amp; R.Value\n\nNext R\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 1, "creation_date": 1466007045, "post_id": 37840512, "comment_id": 63142054, "body": "Can you edit to include a screenshot of your data - perhaps showing examples of what you have and what you&#39;d like after code is finished"}, {"owner": {"reputation": 351, "user_id": 6469967, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/33aea70e7e06e0cdb3a8b6d0453c4af7?s=128&d=identicon&r=PG&f=1", "display_name": "Nikitau", "link": "https://stackoverflow.com/users/6469967/nikitau"}, "reply_to_user": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1466008105, "post_id": 37840512, "comment_id": 63142746, "body": "Thanks for the suggestions! Just added screenshots to make it easier."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1466012842, "post_id": 37840512, "comment_id": 63145318, "body": "Okay - that&#39;s a still a little hard to see what you&#39;re talking about because of having to flip back and forth between links, but I think I understand now. You don&#39;t really want a new row inserted - you want to shift the data in two columns down - and replace the cells in the current row&#39;s two columns with the matching date and #NA."}], "answers": [{"tags": [], "owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "is_accepted": false, "score": 0, "last_activity_date": 1466014323, "creation_date": 1466014323, "answer_id": 37842816, "question_id": 37840512, "link": "https://stackoverflow.com/questions/37840512/insert-a-new-row-for-each-missing-date-for-multiple-columns/37842816#37842816", "title": "Insert a new row for each missing date for multiple columns", "body": "<p>How about this:</p>\n\n<pre><code>Option Explicit\n\nSub insertMissingDate()\n    Const FIRST_ROW     As Integer = 2\n\n    Const COMPARE_COL   As Integer = 3\n    Const COL1          As String = \"C\"\n    Const COL2          As String = \"D\"\n\n    Dim wks             As Worksheet\n    Dim strRange        As String\n    Dim lastRow         As Long\n    Dim i               As Long\n\n    Dim curCell         As Date\n    Dim prevCell        As Date\n\n    Set wks = Worksheets(\"Sheet1\")\n\n\n    lastRow = wks.Range(COL1 &amp; FIRST_ROW).End(xlDown).Row\n\n    'Work bottom up since we are inserting new rows\n    For i = FIRST_ROW To lastRow\n\n        curCell = wks.Cells(i, COMPARE_COL).Value\n        prevCell = wks.Cells(i, COMPARE_COL - 2).Value\n\n        If curCell &lt;&gt; prevCell Then\n            strRange = COL1 &amp; i &amp; \":\" &amp; COL2 &amp; i\n            Range(strRange).Insert Shift:=xlDown\n\n            wks.Cells(i, COMPARE_COL).Value = prevCell\n            wks.Cells(i, COMPARE_COL + 1).Value = \"#N/A\"\n        End If\n    Next i\n\n    Set wks = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 351, "user_id": 6469967, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/33aea70e7e06e0cdb3a8b6d0453c4af7?s=128&d=identicon&r=PG&f=1", "display_name": "Nikitau", "link": "https://stackoverflow.com/users/6469967/nikitau"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1288, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568864784, "creation_date": 1466006664, "last_edit_date": 1568864784, "question_id": 37840512, "link": "https://stackoverflow.com/questions/37840512/insert-a-new-row-for-each-missing-date-for-multiple-columns", "title": "Insert a new row for each missing date for multiple columns", "body": "<p>I have a workbook with about 18 columns of dates with data points and about 3k rows.</p>\n\n<p>I'm trying to make sure that all the rows have the same dates. If a date is missing, I want a new row inserted with the missing date and #N/A next to it. Some of the columns have skipped a few days compared to previous columns. </p>\n\n<p>How can I tweak this macro I found, for multiple columns?</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub insertMissingDate()\n    Dim wks As Worksheet\n    Set wks = Worksheets(\"Sheet1\")\n\n    Dim lastRow As Long\n    lastRow = wks.Range(\"C2\").End(xlDown).Row\n\n    'Work bottom up since we are inserting new rows\n    For i = lastRow To 3 Step -1\n        curcell = wks.Cells(i, 3).Value\n        prevcell = wks.Cells(i - 1, 3).Value\n\n        'Using a loop here allows us to bridge a gap of multiple missing dates\n        Do Until curcell - 1 = prevcell Or curcell = prevcell\n            'Insert new row\n            wks.Rows(i).Insert xlShiftDown\n\n            'Insert missing date into new row\n            curcell = wks.Cells(i + 1, 3) - 1\n            wks.Cells(i, 3).Value = curcell\n        Loop\n    Next i\nEnd Sub\n</code></pre>\n\n<p>This shows the problem where the dates are misaligned.</p>\n\n<p><a href=\"https://i.stack.imgur.com/KQBeC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KQBeC.png\" alt=\"Cells that are missing in row\"></a></p>\n\n<p>This shows a fixed row, with cells shifted down.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Uhg9D.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Uhg9D.png\" alt=\"http://i.stack.imgur.com/Uhg9D.png\"></a></p>\n"}, {"tags": ["sql-server", "tsql", "ms-access", "vba"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1466012181, "post_id": 37840362, "comment_id": 63144983, "body": "Just wondering: why is this a UNIQUE constraint and not a PRIMARY KEY? Access (more or less) requires a PK in a linked ODBC table in order to work with it."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1466015319, "post_id": 37840362, "comment_id": 63146651, "body": "I&#39;m not sure here - but with Unique index that includes inv_loc and inv_no - and theose fields defined as NOT NULL, how are you loading them with a new record if there&#39;s no defaults set?"}, {"owner": {"reputation": 19, "user_id": 6436542, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8144ec5461c67e160d1798a844694387?s=128&d=identicon&r=PG&f=1", "display_name": "David Dubs", "link": "https://stackoverflow.com/users/6436542/david-dubs"}, "edited": false, "score": 0, "creation_date": 1466104057, "post_id": 37840362, "comment_id": 63191847, "body": "Like many posts, I inherited this mess.  There were actually PRIMARY KEY (PK) on std_GUID and UNIQUE (U) constraints on the table.  I tried the four combinations of constraints: 0,0 - OK; 0,U - fails; PK,0 - OK; PK,U - fails.  I realize this is functionally redundant.  The primary key provides record uniqueness for lookups, while the unique constraint provides that the user not enter duplicate records.  Access treats the UNIQUE constraint like a PK, and does not give you a dialog box to choose a PK when linking the table.  Records are input through the Access data entry form (link above)."}], "answers": [{"tags": [], "owner": {"reputation": 2070, "user_id": 2600428, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/axhos.png?s=128&g=1", "display_name": "Christopher Brown", "link": "https://stackoverflow.com/users/2600428/christopher-brown"}, "is_accepted": false, "score": 0, "last_activity_date": 1467906013, "creation_date": 1467906013, "answer_id": 38249742, "question_id": 37840362, "link": "https://stackoverflow.com/questions/37840362/why-deleted-in-records-from-linked-table/38249742#38249742", "title": "Why #Deleted in records from linked table?", "body": "<p>Per <a href=\"https://support.microsoft.com/en-us/kb/128809\" rel=\"nofollow\">this article</a>, the unique fields within a table are the \"key\" Access uses to retrieve and update records via an ODBC connection.</p>\n\n<p>Specifically, your issue is related to the std_Create_ID. Your default value for std_Create_ID is being created on the backend using the suser_sname() function. So, from Access' perspective, the std_Create_ID field is an empty string (or maybe null) when it creates the record and so the unique key is a combination of [inv_loc], [inv_no], and an empty string (or maybe a null). However, as soon as the record is created, the combination of those three variables no longer exists, and so it assumes the record has been deleted, per the article.</p>\n\n<p>Based on the article and the way you're doing things here, this can't be fixed with your current setup. You said you inherited all of this, so I'm not sure what you can change. However, I see several options:</p>\n\n<ol>\n<li>Continue with your workaround (i.e., requerying)</li>\n<li>Build the std_Create_ID in Access (which likely isn't possible).</li>\n<li>Remove std_Create_ID from the unique constraint on the table.</li>\n</ol>\n\n<p>I hope this helps.</p>\n"}], "owner": {"reputation": 19, "user_id": 6436542, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8144ec5461c67e160d1798a844694387?s=128&d=identicon&r=PG&f=1", "display_name": "David Dubs", "link": "https://stackoverflow.com/users/6436542/david-dubs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1019, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1467906013, "creation_date": 1466006210, "question_id": 37840362, "link": "https://stackoverflow.com/questions/37840362/why-deleted-in-records-from-linked-table", "title": "Why #Deleted in records from linked table?", "body": "<p>My table is on a SQL Server as defined below.  When the Unique Constraint is added to the table, the Access data entry form displays #Deleted in all fields of a record that was just entered.  I can get around the situation by requerying and forcing a new record.  There are usually only 1 - 3 records per user.</p>\n\n<pre><code>Requery\nDoCmd.GoToRecord , , acNewRec\n</code></pre>\n\n<p><a href=\"http://i.stack.imgur.com/u8xpA.jpg\" rel=\"nofollow\">Data Entry Form</a></p>\n\n<p>Why does adding the Unique Constraint interfere with the Access form?  The form works fine without the unique constraint.</p>\n\n<pre><code>CREATE TABLE [dbo].[tbl_INV_cust_inv_us_temp] (\n  [inv_loc]          [char](3)          NOT NULL,\n  [inv_no]           [char](7)          NOT NULL,\n  [std_GUID]         [uniqueidentifier] NOT NULL,\n  [std_NewRecordInd] [bit]              NOT NULL,\n  [std_Create_TS]    [datetime]         NOT NULL,\n  [std_Create_ID]    [varchar](50)      NOT NULL\n); \nGO\n\nALTER TABLE [dbo].[tbl_INV_cust_inv_us_temp] \n  ADD CONSTRAINT [DF_tbl_INV_cust_inv_us_temp_std_GUID]  \n  DEFAULT (newid()) FOR [std_GUID];\nGO\n\nALTER TABLE [dbo].[tbl_INV_cust_inv_us_temp] \n  ADD CONSTRAINT [DF_tbl_INV_cust_inv_us_temp_std_NewRecordInd]  \n  DEFAULT (1) FOR [std_NewRecordInd];\nGO  \n\nALTER TABLE [dbo].[tbl_INV_cust_inv_us_temp] \n  ADD CONSTRAINT [DF_tbl_INV_cust_inv_us_temp_std_Create_TS]  \n  DEFAULT (getdate()) FOR [std_Create_TS];\nGO\n\nALTER TABLE [dbo].[tbl_INV_cust_inv_us_temp] \n  ADD CONSTRAINT [DF_tbl_INV_cust_inv_us_temp_std_Create_ID]  \n  DEFAULT (right(suser_sname(),(len(suser_sname()) - 9))) FOR [std_Create_ID];\nGO\n\nALTER TABLE [dbo].[tbl_INV_cust_inv_us_temp] \n  ADD CONSTRAINT [IX_tbl_INV_cust_inv_us_temp] \n  UNIQUE NONCLUSTERED (\n    [inv_loc] ASC,\n    [inv_no] ASC,\n    [std_Create_ID] ASC) \n  WITH (\n    PAD_INDEX  = OFF, \n    STATISTICS_NORECOMPUTE  = OFF, \n    IGNORE_DUP_KEY = OFF, \n    ALLOW_ROW_LOCKS  = ON, \n    ALLOW_PAGE_LOCKS  = ON )\n  ON [PRIMARY];\nGO  \n</code></pre>\n"}, {"tags": ["excel", "vba", "powerpoint"], "comments": [{"owner": {"reputation": 131, "user_id": 6031537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad492645a4134f007c8b82deff038e39?s=128&d=identicon&r=PG&f=1", "display_name": "aFast", "link": "https://stackoverflow.com/users/6031537/afast"}, "edited": false, "score": 0, "creation_date": 1466007057, "post_id": 37840352, "comment_id": 63142066, "body": "Did you try insert&gt; table&gt; Excel spreadsheet. and linking it to the spread sheet you&#39;re using?"}, {"owner": {"reputation": 402, "user_id": 3678483, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/4rYQq.jpg?s=128&g=1", "display_name": "Danny", "link": "https://stackoverflow.com/users/3678483/danny"}, "edited": false, "score": 0, "creation_date": 1466007166, "post_id": 37840352, "comment_id": 63142139, "body": "If you are used to working in VBA then from your VBA project in Excel you can add a reference to the Microsoft PowerPoint Object Library. With that you might be able to find a way to create a new powerpoint presentation and add in the relevant data."}, {"owner": {"reputation": 11755, "user_id": 4797603, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/AwTvE.jpg?s=128&g=1", "display_name": "Ronnie Royston", "link": "https://stackoverflow.com/users/4797603/ronnie-royston"}, "edited": false, "score": 0, "creation_date": 1466009156, "post_id": 37840352, "comment_id": 63143330, "body": "Try to &quot;Record Macro&quot;.  I think that&#39;s the term.  You can record the actions you do via the Excel and PowerPoint GUIs.  That might help you."}, {"owner": {"reputation": 33, "user_id": 6272043, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wqa60.jpg?s=128&g=1", "display_name": "PixAndCo", "link": "https://stackoverflow.com/users/6272043/pixandco"}, "reply_to_user": {"reputation": 131, "user_id": 6031537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad492645a4134f007c8b82deff038e39?s=128&d=identicon&r=PG&f=1", "display_name": "aFast", "link": "https://stackoverflow.com/users/6031537/afast"}, "edited": false, "score": 0, "creation_date": 1466010349, "post_id": 37840352, "comment_id": 63143988, "body": "@aFast, I tried to copy paste special the chart (not the table) and were able to change the data in PowerPoint by changing the data directly in Excel, which was great. But when I closed both files, it seems the link broke as when I put new data in the Excel file, they were not updated automatically anymore in PowerPoint. Maybe I&#39; doing something wrong here though."}, {"owner": {"reputation": 33, "user_id": 6272043, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wqa60.jpg?s=128&g=1", "display_name": "PixAndCo", "link": "https://stackoverflow.com/users/6272043/pixandco"}, "reply_to_user": {"reputation": 11755, "user_id": 4797603, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/AwTvE.jpg?s=128&g=1", "display_name": "Ronnie Royston", "link": "https://stackoverflow.com/users/4797603/ronnie-royston"}, "edited": false, "score": 0, "creation_date": 1466010437, "post_id": 37840352, "comment_id": 63144030, "body": "@RonRoyston, the macro recorder did not do great in this case, only had impractical results but thanks!"}, {"owner": {"reputation": 9777, "user_id": 2342399, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/da7b3bf63455228a889008a1cd76109a?s=128&d=identicon&r=PG", "display_name": "Boosted_d16", "link": "https://stackoverflow.com/users/2342399/boosted-d16"}, "edited": false, "score": 0, "creation_date": 1541613562, "post_id": 37840352, "comment_id": 93278981, "body": "try www.pptxbuilder.com"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 6272043, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wqa60.jpg?s=128&g=1", "display_name": "PixAndCo", "link": "https://stackoverflow.com/users/6272043/pixandco"}, "edited": false, "score": 0, "creation_date": 1466065438, "post_id": 37840944, "comment_id": 63165845, "body": "Thanks I will look into that!"}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "reply_to_user": {"reputation": 33, "user_id": 6272043, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wqa60.jpg?s=128&g=1", "display_name": "PixAndCo", "link": "https://stackoverflow.com/users/6272043/pixandco"}, "edited": false, "score": 0, "creation_date": 1466083687, "post_id": 37840944, "comment_id": 63178431, "body": "Just read you&#39;re on Mac, not quite sure this would work there"}, {"owner": {"reputation": 33, "user_id": 6272043, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wqa60.jpg?s=128&g=1", "display_name": "PixAndCo", "link": "https://stackoverflow.com/users/6272043/pixandco"}, "edited": false, "score": 0, "creation_date": 1466085192, "post_id": 37840944, "comment_id": 63179716, "body": "it&#39;s crazy, why it couldn&#39;t be working fine on both platform, damn... Thanks for the heads up."}], "tags": [], "owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "is_accepted": false, "score": 0, "last_activity_date": 1466008225, "creation_date": 1466008225, "answer_id": 37840944, "question_id": 37840352, "link": "https://stackoverflow.com/questions/37840352/how-to-automate-slide-creation-from-an-excel-file/37840944#37840944", "title": "How to automate slide creation from an Excel file?", "body": "<p>I would go for the second option.\nSince you have performed already the automation for the pivot table, this may lead you to write what you want for. <br>\nNote: as commented, you'd need to add a reference for Microsoft Power Point in order to be available to use the following:</p>\n\n<pre><code>Dim PPInstance As PowerPoint.Application\nDim PPSlide As PowerPoint.Slide\nDim SlideShow As PowerPoint.Presentation\n    For Each SlideShow In PPInstance.Presentations\n    On Error GoTo Err01PowerPoint_Select\n    Set PPInstance = GetObject(, \"Powerpoint.Application\")\n    If SlideShow.Name = \"DesiredValue\" Then '1. If SlideShow.Name = \"DesiredValue\"\n    For Each PPSlide In SlideShow.Slides\n    ' paste and select the chart picture\n     ActiveSheet.ChartObjects(YourChartObjectInExcel).Copy\n     Application.Wait Now + TimeValue(\"00:00:01\")\n     'It may lost itself\n     .Shapes.Paste\n     Application.CutCopyMode = False\n     'align the chart\n     'you can definetly align and set the size you desire for the chart in PP, however, I didn't manage to make it work, you may want to search for it\n     'PPInstance.ActiveWindow.Selection.ShapeRange.Align msoAlignCenters, True\n     'PPInstance.ActiveWindow.Selection.ShapeRange.Align msoAlignMiddles, True\n    Next PPSlide\n    Exit For\n    Next SlideShow\n    If 1 = 2 Then '99.if error\n    Err01PowerPoint_Select:\n    MsgBox \"No Powerpoint presentations are opened!\", vbCritical\n    End If '99.if error \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 6272043, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wqa60.jpg?s=128&g=1", "display_name": "PixAndCo", "link": "https://stackoverflow.com/users/6272043/pixandco"}, "edited": false, "score": 0, "creation_date": 1466065236, "post_id": 37842516, "comment_id": 63165705, "body": "Thanks but I have some issues with this methods. After having copied the chart, I paste special in PowerPoint and have the following option: paste as a Microsoft Excel Chart Object or paste as a Microsoft Office Graphic Object. If I choose the first option, I cannot find the &quot;Edit link to files&quot; option (I m on Mac) to update the data. If I choose the second option, the data in PowerPoint gets updated whenever I change the data in the table in Excel but as soon as I close both files, the link is broken. Is there something else I should do? Thanks!"}, {"owner": {"reputation": 33, "user_id": 6272043, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wqa60.jpg?s=128&g=1", "display_name": "PixAndCo", "link": "https://stackoverflow.com/users/6272043/pixandco"}, "edited": false, "score": 1, "creation_date": 1466073424, "post_id": 37842516, "comment_id": 63171256, "body": "I think the function is missing from the Mac version of Office... Damn..."}, {"owner": {"reputation": 131, "user_id": 6031537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad492645a4134f007c8b82deff038e39?s=128&d=identicon&r=PG&f=1", "display_name": "aFast", "link": "https://stackoverflow.com/users/6031537/afast"}, "reply_to_user": {"reputation": 33, "user_id": 6272043, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wqa60.jpg?s=128&g=1", "display_name": "PixAndCo", "link": "https://stackoverflow.com/users/6272043/pixandco"}, "edited": false, "score": 0, "creation_date": 1466090323, "post_id": 37842516, "comment_id": 63183607, "body": "@PixAndCo how many tables do you have? i think if you right click on each table and choose edit or open it&#39;ll update. but this needs to be done for each table (i think)"}, {"owner": {"reputation": 33, "user_id": 6272043, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wqa60.jpg?s=128&g=1", "display_name": "PixAndCo", "link": "https://stackoverflow.com/users/6272043/pixandco"}, "edited": false, "score": 0, "creation_date": 1466090541, "post_id": 37842516, "comment_id": 63183773, "body": "thanks for the tip! There would be like 300 tables so it&#39;s not practical. If at least by updating one, the rest would follow, but no... :-("}, {"owner": {"reputation": 131, "user_id": 6031537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad492645a4134f007c8b82deff038e39?s=128&d=identicon&r=PG&f=1", "display_name": "aFast", "link": "https://stackoverflow.com/users/6031537/afast"}, "reply_to_user": {"reputation": 33, "user_id": 6272043, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wqa60.jpg?s=128&g=1", "display_name": "PixAndCo", "link": "https://stackoverflow.com/users/6272043/pixandco"}, "edited": false, "score": 0, "creation_date": 1466090778, "post_id": 37842516, "comment_id": 63183951, "body": "check this out <a href=\"http://www.dummies.com/how-to/content/office-2011-for-mac-copying-excel-charts-to-word-o.html\" rel=\"nofollow noreferrer\">Office 2011 for Mac: Copying Excel Charts to Word or PowerPoint</a>"}, {"owner": {"reputation": 33, "user_id": 6272043, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wqa60.jpg?s=128&g=1", "display_name": "PixAndCo", "link": "https://stackoverflow.com/users/6272043/pixandco"}, "edited": false, "score": 0, "creation_date": 1466091584, "post_id": 37842516, "comment_id": 63184547, "body": "I tried but I have the same issue. If I select &quot;Chart (Linked to Data)&quot;, it works (I change the data in Excel and it&#39;s updated directly into PowerPoint) but when I close the Excel file and reopen it, it doesn&#39;t work anymore. If I select &quot;Excel Chart (entire workbook)&quot;, I can only change the data by right clicking on the graph in PowerPoint, click on &quot;Edit Data in Excel&quot; which opens a file called &quot;Chart in Microsoft Office PowerPoint&quot; but I cannot do a lot with that file. Thanks for the tip though."}], "tags": [], "owner": {"reputation": 131, "user_id": 6031537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad492645a4134f007c8b82deff038e39?s=128&d=identicon&r=PG&f=1", "display_name": "aFast", "link": "https://stackoverflow.com/users/6031537/afast"}, "is_accepted": false, "score": 0, "last_activity_date": 1593810865, "last_edit_date": 1593810865, "creation_date": 1466013363, "answer_id": 37842516, "question_id": 37840352, "link": "https://stackoverflow.com/questions/37840352/how-to-automate-slide-creation-from-an-excel-file/37842516#37842516", "title": "How to automate slide creation from an Excel file?", "body": "<p>Try this</p>\n<ul>\n<li><p>In excel copy the cells you want in your presentation</p>\n</li>\n<li><p>Go back to power point and make a &quot;past special&quot; (home tab&gt; past drop down&gt; past special or <code>Cntrl+Alt+V</code>).</p>\n</li>\n<li><p>choose <a href=\"https://i.stack.imgur.com/4zorn.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4zorn.jpg\" alt=\"choose this option\" /></a></p>\n</li>\n</ul>\n<p>this should insert a linked table into your slide</p>\n<h2>When you want to update</h2>\n<p>Go to: file&gt; info</p>\n<p>And choose</p>\n<p><a href=\"https://i.stack.imgur.com/q2nEc.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/q2nEc.jpg\" alt=\"enter image description here\" /></a></p>\n<p>from the bottom right</p>\n<p>Next do this</p>\n<p><a href=\"https://i.stack.imgur.com/6hJRE.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6hJRE.jpg\" alt=\"enter image description here\" /></a></p>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 6272043, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wqa60.jpg?s=128&g=1", "display_name": "PixAndCo", "link": "https://stackoverflow.com/users/6272043/pixandco"}, "edited": false, "score": 0, "creation_date": 1466065760, "post_id": 37843038, "comment_id": 63166081, "body": "Thanks I looked into that. The link keeps breaking between Excel and PowerPoint (I m on Mac) and I have no idea why. I never have the pop up asking me to update the data when I open the PowerPoint file, even after having pasted special the chart into PowerPoint..."}], "tags": [], "owner": {"reputation": 11755, "user_id": 4797603, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/AwTvE.jpg?s=128&g=1", "display_name": "Ronnie Royston", "link": "https://stackoverflow.com/users/4797603/ronnie-royston"}, "is_accepted": false, "score": 0, "last_activity_date": 1466015066, "creation_date": 1466015066, "answer_id": 37843038, "question_id": 37840352, "link": "https://stackoverflow.com/questions/37840352/how-to-automate-slide-creation-from-an-excel-file/37843038#37843038", "title": "How to automate slide creation from an Excel file?", "body": "<p>You are wanting to automate between MS Office applications, Excel and Powerpoint.  Microsoft uses the term programatically so a Web search for <a href=\"https://www.google.com/search?q=Programatically%20excel%20to%20powerpoint\" rel=\"nofollow\">Programatically excel to powerpoint</a> should get you started.  You might add VBA to the search.</p>\n"}], "owner": {"reputation": 33, "user_id": 6272043, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wqa60.jpg?s=128&g=1", "display_name": "PixAndCo", "link": "https://stackoverflow.com/users/6272043/pixandco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 8667, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1617328845, "creation_date": 1466006186, "last_edit_date": 1593810852, "question_id": 37840352, "link": "https://stackoverflow.com/questions/37840352/how-to-automate-slide-creation-from-an-excel-file", "title": "How to automate slide creation from an Excel file?", "body": "<p>Quick question on slide automation in Excel / PowerPoint.</p>\n<p><strong>Here is the setup:</strong></p>\n<ul>\n<li>Every month, I need to fill a PowerPoint</li>\n<li>In it, I have 5 slides per country, for 30 countries. On each slide, there is from 1 to 3 charts</li>\n<li>I use data from a pivot table in Excel to populate those charts and would like to automate the process</li>\n</ul>\n<p><strong>What I have already done:</strong></p>\n<ul>\n<li>The automation in VBA to extract data from the Pivot Table has been done, everything is fine on this side</li>\n</ul>\n<p><strong>What needs to be done:</strong></p>\n<ul>\n<li>Copy/paste the data from the Excel file inside the corresponding chart in the PowerPoint</li>\n</ul>\n<p><strong>What I was thinking to do, either:</strong></p>\n<ul>\n<li>Copy paste the data directly into the chart, but is it even possible?</li>\n<li>Create a chart in the Excel file and copy paste it into PowerPoint (it cannot be a picture, the data behind the chart has to be accessible)</li>\n</ul>\n<p>What do you think is the easiest way to do this?</p>\n<p>EDIT: I am on Mac, did not know VBA / Office would be different but it is...</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "edited": false, "score": 0, "creation_date": 1466007036, "post_id": 37840330, "comment_id": 63142051, "body": "There should be no need for a &quot;correction factor&quot;. Check which cell styles apply to both the sheets. The column widths are not absolute numbers (like pixels etc), but are based on the size of the font of the &quot;Normal&quot; cell style. If you have changed the styles on one of the sheets but not the other, that would account for the change in size."}, {"owner": {"reputation": 82, "user_id": 5335845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d559146054ad381c96ff875ae1f21144?s=128&d=identicon&r=PG&f=1", "display_name": "BlairH", "link": "https://stackoverflow.com/users/5335845/blairh"}, "reply_to_user": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "edited": false, "score": 1, "creation_date": 1466189851, "post_id": 37840330, "comment_id": 63231736, "body": "If I change the references to use the .ColumnWidth property instead of the .Width property I get the right values. I&#39;m not sure what the .Width property returns, but it seems to be proportional to the column width with the calculation."}], "answers": [{"comments": [{"owner": {"reputation": 82, "user_id": 5335845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d559146054ad381c96ff875ae1f21144?s=128&d=identicon&r=PG&f=1", "display_name": "BlairH", "link": "https://stackoverflow.com/users/5335845/blairh"}, "edited": false, "score": 1, "creation_date": 1466008332, "post_id": 37840899, "comment_id": 63142872, "body": "Thanks! I knew there had ot be a simpler way. Don&#39;t even need vba, can just use copy and paste special - column widths. I should have looked there first."}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "reply_to_user": {"reputation": 82, "user_id": 5335845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d559146054ad381c96ff875ae1f21144?s=128&d=identicon&r=PG&f=1", "display_name": "BlairH", "link": "https://stackoverflow.com/users/5335845/blairh"}, "edited": false, "score": 0, "creation_date": 1466008445, "post_id": 37840899, "comment_id": 63142935, "body": "Yes and if you group the sheets, only one paste is needed."}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "reply_to_user": {"reputation": 82, "user_id": 5335845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d559146054ad381c96ff875ae1f21144?s=128&d=identicon&r=PG&f=1", "display_name": "BlairH", "link": "https://stackoverflow.com/users/5335845/blairh"}, "edited": false, "score": 1, "creation_date": 1466008662, "post_id": 37840899, "comment_id": 63143059, "body": "Don&#39;t forget to accept the answer @BlairH . Also, I&#39;d clear the clipboard to avoid memory leak or confusions due to so many data being pasted there,   by changing this line should be enough .PasteSpecial Paste:=xlPasteColumnWidths:Application.CutCopyMode = False"}], "tags": [], "owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "is_accepted": true, "score": 1, "last_activity_date": 1466008066, "creation_date": 1466008066, "answer_id": 37840899, "question_id": 37840330, "link": "https://stackoverflow.com/questions/37840330/set-column-widths-of-one-sheet-the-same-as-another/37840899#37840899", "title": "Set column widths of one sheet the same as another", "body": "<p>I would:\n- Copy an entire row of Sheet1\n- Paste Special, column widths onto the other sheets:</p>\n\n<pre><code>Sub AdjustColumns()\n    Dim oSh As Worksheet\n    Worksheets(1).Range(\"1:1\").Copy\n    For Each oSh In Worksheets\n        If oSh.Index &gt; 1 Then\n            .PasteSpecial Paste:=xlPasteColumnWidths\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 82, "user_id": 5335845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d559146054ad381c96ff875ae1f21144?s=128&d=identicon&r=PG&f=1", "display_name": "BlairH", "link": "https://stackoverflow.com/users/5335845/blairh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3883, "favorite_count": 0, "accepted_answer_id": 37840899, "answer_count": 1, "score": 1, "last_activity_date": 1466008066, "creation_date": 1466006130, "last_edit_date": 1531161705, "question_id": 37840330, "link": "https://stackoverflow.com/questions/37840330/set-column-widths-of-one-sheet-the-same-as-another", "title": "Set column widths of one sheet the same as another", "body": "<p>I'm trying to write code that sets the column widths in one sheet to be the same as the column widths in another sheet. It didn't go as straightforward as I thought it would, so I'm posting it here in an attempt to determine if it can be accomplished in an easier manner. </p>\n\n<p>It seems that when I read the width of the column in one sheet, in order to set the width of the column in the other sheet I have to add a correction factor to get the right width. The correction factor is (ReadWidth / 0.75 - 5) / 7.</p>\n\n<p>The code I am using is as follows:</p>\n\n<pre><code>Function SetWidths()\nDim Cntr As Integer, Column As String, Sht1 As String, Sht2 As String\nDim Sht1Wid As Double, Sht2Wid As Double, Sht1WidSet As Double, Sht2WidSet As Double\n\nSht1 = \"Sheet1\"\nSht2 = \"Sheet2\"\n\nFor Cntr = 1 To 55\n\n    Column = Num2Col(Cntr)\n\n    Sht1Wid = Worksheets(Sht1).Range(Column &amp; \"1\").Width                ' read width\n    Sht2Wid = Worksheets(Sht2).Range(Column &amp; \"1\").Width\n    Sht1WidSet = (Sht1Wid / 0.75 - 5) / 7                               ' correction factor\n    Sht2WidSet = (Sht2Wid / 0.75 - 5) / 7\n\n    If Sht1Wid &lt;&gt; Sht2Wid Then\n        If Sht1Wid &gt; Sht2Wid Then                                       ' set width to largest\n            Worksheets(Sht2).Columns(Column).ColumnWidth = Sht1WidSet\n        Else\n            Worksheets(Sht1).Columns(Column).ColumnWidth = Sht2WidSet\n        End If\n    End If\n\nNext Cntr\n\nEnd Function\n</code></pre>\n\n<p>Num2Col is another function that returns a string for the column based upon the number. </p>\n\n<p>Does anyone have an easier way to do this? It seems odd that the correction factor has to be added. </p>\n"}, {"tags": ["excel", "vba", "csv", "date-formatting"], "comments": [{"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1466005473, "post_id": 37839966, "comment_id": 63140946, "body": "Your problem is in the import <code>TextFileColumnDataTypes</code> I think"}, {"owner": {"reputation": 115, "user_id": 5853595, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c2678e42f8a82cd74f17b03a3469d37b?s=128&d=identicon&r=PG&f=1", "display_name": "corbfon", "link": "https://stackoverflow.com/users/5853595/corbfon"}, "reply_to_user": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1466005761, "post_id": 37839966, "comment_id": 63141153, "body": "How would I fix that? When I manually do the op, I can&#39;t figure out how to get that data to pull correctly either. I&#39;ve tried to tell Excel that field is a date field"}], "answers": [{"tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": false, "score": 0, "last_activity_date": 1466006304, "creation_date": 1466006304, "answer_id": 37840393, "question_id": 37839966, "link": "https://stackoverflow.com/questions/37839966/excel-date-formatting-with-hash-marks-for-some-reason/37840393#37840393", "title": "Excel Date formatting with hash marks for some reason", "body": "<p>Discard those <code>#</code>.<br>\nWhen I manually <code>Save as</code> a file as CSV, Excel does NOT put those <code>#</code> around the dates.  Instead it writes the dates as they are defined in my regional settings (that is - for me -  <code>dd/mm/yyyy</code>).<br>\nAnd when importing back, the recorder used array(...4...) for the date column, and it was imported correctly.<br>\nAnyway CSV <em>really</em> sucks if your are working in an international environment since it behaves differently according the the local machine settings. Being poorly defined, it's the last format I would use.</p>\n"}, {"comments": [{"owner": {"reputation": 115, "user_id": 5853595, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c2678e42f8a82cd74f17b03a3469d37b?s=128&d=identicon&r=PG&f=1", "display_name": "corbfon", "link": "https://stackoverflow.com/users/5853595/corbfon"}, "edited": false, "score": 0, "creation_date": 1466008958, "post_id": 37840794, "comment_id": 63143238, "body": "Thank you, I knew the answer would be simple!"}], "tags": [], "owner": {"reputation": 36, "user_id": 6465091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/262538d4959342b8c0225411655cf610?s=128&d=identicon&r=PG&f=1", "display_name": "Fred", "link": "https://stackoverflow.com/users/6465091/fred"}, "is_accepted": true, "score": 2, "last_activity_date": 1466064436, "last_edit_date": 1466064436, "creation_date": 1466007643, "answer_id": 37840794, "question_id": 37839966, "link": "https://stackoverflow.com/questions/37839966/excel-date-formatting-with-hash-marks-for-some-reason/37840794#37840794", "title": "Excel Date formatting with hash marks for some reason", "body": "<p>Try outputing .text instead of .value.</p>\n\n<p>Change this:  </p>\n\n<pre><code>cellValue = writeRange.Cells(i, j).value\n</code></pre>\n\n<p>to this:</p>\n\n<pre><code>cellValue = writeRange.Cells(i, j).Text\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 5853595, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c2678e42f8a82cd74f17b03a3469d37b?s=128&d=identicon&r=PG&f=1", "display_name": "corbfon", "link": "https://stackoverflow.com/users/5853595/corbfon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1832, "favorite_count": 0, "accepted_answer_id": 37840794, "answer_count": 2, "score": -1, "last_activity_date": 1466064436, "creation_date": 1466005228, "question_id": 37839966, "link": "https://stackoverflow.com/questions/37839966/excel-date-formatting-with-hash-marks-for-some-reason", "title": "Excel Date formatting with hash marks for some reason", "body": "<p><strong>The Problem</strong></p>\n\n<p>I've got a VBA program that exports data from one Excel file into a CSV. When it comes across a date, it formats it like <code>#2016-06-14#</code>. I'm assuming the hash marks (or octothorpe or pound sign or hashtag) are meant to indicate that the field is a date field. But, when I'm importing the CSV back into a different Workbook, the date will not come in no matter how I format the field. It still contains the <code>#</code> characters.</p>\n\n<p><strong>The Question</strong></p>\n\n<p>How can I get the date column to import as a YMD format date?</p>\n\n<p><strong>Appendix</strong></p>\n\n<p>Here's some code I'm using to export and import, for reference.</p>\n\n<p><em>Export</em></p>\n\n<pre><code>Sub WriteCSV(writeRange As Range, fileName As String)\n    Dim myFile As String, rng As Range, cellValue As Variant, i As Integer, j As Integer\n\n    myFile = ActiveWorkbook.Path &amp; \"\\Results\\\" &amp; fileName &amp; \".csv\"\n    Debug.Print myFile\n    Open myFile For Output As #1\n    For i = 1 To writeRange.Rows.Count\n        For j = 1 To writeRange.Columns.Count\n            cellValue = writeRange.Cells(i, j).value\n            If j = writeRange.Columns.Count Then\n                Write #1, cellValue\n            Else\n                Write #1, cellValue,\n            End If\n        Next\n    Next\n    Close #1\nEnd Sub\n</code></pre>\n\n<p><em>Import</em></p>\n\n<pre><code>Sub ReadCSV(targetCell As Range, filePath As String)\n\n    With ActiveSheet.QueryTables.Add(Connection:= _\n        \"TEXT;\" &amp; filePath, Destination:=targetCell)\n        .FieldNames = True\n        .RowNumbers = False\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = False\n        .RefreshStyle = xlInsertDeleteCells\n        .SavePassword = False\n        .SaveData = True\n        .AdjustColumnWidth = True\n        .RefreshPeriod = 0\n        .TextFilePromptOnRefresh = False\n        .TextFilePlatform = 437\n        .TextFileStartRow = 2\n        .TextFileParseType = xlDelimited\n        .TextFileTextQualifier = xlTextQualifierDoubleQuote\n        .TextFileConsecutiveDelimiter = False\n        .TextFileTabDelimiter = False\n        .TextFileSemicolonDelimiter = False\n        .TextFileCommaDelimiter = True\n        .TextFileSpaceDelimiter = False\n        .TextFileColumnDataTypes = Array(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1)\n        .TextFileTrailingMinusNumbers = True\n        .Refresh BackgroundQuery:=False\n        .Delete\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "loops"], "comments": [{"owner": {"reputation": 2547, "user_id": 2326824, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fveXJ.jpg?s=128&g=1", "display_name": "Jim Simson", "link": "https://stackoverflow.com/users/2326824/jim-simson"}, "edited": false, "score": 0, "creation_date": 1466007128, "post_id": 37839943, "comment_id": 63142106, "body": "Osheizer, I&#39;d like to help you troubleshoot this because you&#39;ve clearly put a lot of work into it. Any chance you have a sample of your data set to help me put it into context?"}, {"owner": {"reputation": 3, "user_id": 6466695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0aa8e8a07ab6c7ebb11b7bc3481bc7a8?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/6466695/kyle"}, "reply_to_user": {"reputation": 2547, "user_id": 2326824, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fveXJ.jpg?s=128&g=1", "display_name": "Jim Simson", "link": "https://stackoverflow.com/users/2326824/jim-simson"}, "edited": false, "score": 0, "creation_date": 1466007696, "post_id": 37839943, "comment_id": 63142505, "body": "Yes let me look into how to properly post it and I will get it back to you! Thanks Jim (also, its Kyle! I thought I updated my display name but apparently did not!)"}, {"owner": {"reputation": 2547, "user_id": 2326824, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fveXJ.jpg?s=128&g=1", "display_name": "Jim Simson", "link": "https://stackoverflow.com/users/2326824/jim-simson"}, "edited": false, "score": 0, "creation_date": 1466008473, "post_id": 37839943, "comment_id": 63142949, "body": "Kyle, for starters, with your line, &quot;taskWO = Worksheets(&quot;task&quot;).Cells(n + 1, 1).Value&quot;  &#39;n&#39; is not defined and therefor will always be 0. Which is to say that your line is the same thing as saying: taskWO = Worksheets(&quot;task&quot;).Cells(1, 1).Value. Was that what you intended, or did you mean to have that line inside your For n = 1 To iPr loop? Actually, I see that you have it there as well. Is the first line, then, unnecessary?"}, {"owner": {"reputation": 3, "user_id": 6466695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0aa8e8a07ab6c7ebb11b7bc3481bc7a8?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/6466695/kyle"}, "reply_to_user": {"reputation": 2547, "user_id": 2326824, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fveXJ.jpg?s=128&g=1", "display_name": "Jim Simson", "link": "https://stackoverflow.com/users/2326824/jim-simson"}, "edited": false, "score": 0, "creation_date": 1466012542, "post_id": 37839943, "comment_id": 63145171, "body": "I did remove that line... thanks Jim. However, it did not fix it. I removed some of the debugging lines from the code because it really slowed down the code and I also added a small data set. Does that help explain what I am attempting to do?"}, {"owner": {"reputation": 2547, "user_id": 2326824, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fveXJ.jpg?s=128&g=1", "display_name": "Jim Simson", "link": "https://stackoverflow.com/users/2326824/jim-simson"}, "edited": false, "score": 0, "creation_date": 1466013685, "post_id": 37839943, "comment_id": 63145789, "body": "Right, Removing that line alone would not have solved the problem. I updated the code in my answer in light of the data that you posted. Does that get you any closer?"}, {"owner": {"reputation": 2547, "user_id": 2326824, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fveXJ.jpg?s=128&g=1", "display_name": "Jim Simson", "link": "https://stackoverflow.com/users/2326824/jim-simson"}, "edited": false, "score": 0, "creation_date": 1466015378, "post_id": 37839943, "comment_id": 63146689, "body": "Okay Kyle, I moved around the code in my answer a bit to fit you&#39;re updates. I think what I have there is a complete solution, or at least pretty close. I run it on my end and it seems to work. Let me know. -Jim"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6466695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0aa8e8a07ab6c7ebb11b7bc3481bc7a8?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/6466695/kyle"}, "edited": false, "score": 0, "creation_date": 1466015334, "post_id": 37842237, "comment_id": 63146663, "body": "The dictionary object is new to me so let me make sure I am getting this straight. So what is doing in the first part is making a list of all the values in the Task sheet as keys and then setting the description as their value. And then it compares this list to each cell in column one in the preview sheet by looping through each cell in the preview sheet. If a value in the dictionary (Dict.Exists(Cel.Value)) exists in the preview sheet, then it should print out the messages in that if statement, correct? It looks like it is not able to match them so it just cycles through  the for loop."}, {"owner": {"reputation": 2547, "user_id": 2326824, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fveXJ.jpg?s=128&g=1", "display_name": "Jim Simson", "link": "https://stackoverflow.com/users/2326824/jim-simson"}, "reply_to_user": {"reputation": 3, "user_id": 6466695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0aa8e8a07ab6c7ebb11b7bc3481bc7a8?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/6466695/kyle"}, "edited": false, "score": 0, "creation_date": 1466015796, "post_id": 37842237, "comment_id": 63146965, "body": "That&#39;s pretty much exactly right Kyle. I re-worked it a bit to load the preview values in as keys, and then search the tasks for values that are not in the dictionary. If it finds such a value, then it adds it to the preview sheet."}, {"owner": {"reputation": 2547, "user_id": 2326824, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fveXJ.jpg?s=128&g=1", "display_name": "Jim Simson", "link": "https://stackoverflow.com/users/2326824/jim-simson"}, "reply_to_user": {"reputation": 3, "user_id": 6466695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0aa8e8a07ab6c7ebb11b7bc3481bc7a8?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/6466695/kyle"}, "edited": false, "score": 0, "creation_date": 1466016280, "post_id": 37842237, "comment_id": 63147261, "body": "@Kyle Okay. Added one more line of code to prevent the column header from being copied over."}, {"owner": {"reputation": 3, "user_id": 6466695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0aa8e8a07ab6c7ebb11b7bc3481bc7a8?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/6466695/kyle"}, "edited": false, "score": 0, "creation_date": 1466016795, "post_id": 37842237, "comment_id": 63147569, "body": "Thanks for your help so far Jim! However, when I inserted the code into main spreadsheet, its still counting task values that are already on the preview sheet as missing and is then repopulating them. Its like 1111 &lt;&gt; 1111, which does not make sense. With that said, this method is much faster."}, {"owner": {"reputation": 2547, "user_id": 2326824, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fveXJ.jpg?s=128&g=1", "display_name": "Jim Simson", "link": "https://stackoverflow.com/users/2326824/jim-simson"}, "reply_to_user": {"reputation": 3, "user_id": 6466695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0aa8e8a07ab6c7ebb11b7bc3481bc7a8?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/6466695/kyle"}, "edited": false, "score": 0, "creation_date": 1466017265, "post_id": 37842237, "comment_id": 63147806, "body": "@Kyle Check to see if any of your values have spaces after or before them. In fact, maybe just to be safe, add .Trim() to the end of things. 9 times out of 10 that solves the issue. I update the code and see if that helps."}, {"owner": {"reputation": 2547, "user_id": 2326824, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fveXJ.jpg?s=128&g=1", "display_name": "Jim Simson", "link": "https://stackoverflow.com/users/2326824/jim-simson"}, "reply_to_user": {"reputation": 3, "user_id": 6466695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0aa8e8a07ab6c7ebb11b7bc3481bc7a8?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/6466695/kyle"}, "edited": false, "score": 0, "creation_date": 1466017746, "post_id": 37842237, "comment_id": 63148089, "body": "@Kyle Oh bother, I&#39;m still thinking in C#. I meant Trim(String) rather than String.Trim. I made the changes. See if it helps."}, {"owner": {"reputation": 3, "user_id": 6466695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0aa8e8a07ab6c7ebb11b7bc3481bc7a8?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/6466695/kyle"}, "edited": false, "score": 0, "creation_date": 1466019146, "post_id": 37842237, "comment_id": 63148858, "body": "It worked! So it was spaces after the number? The data is coming from a Microsoft Query, so maybe it is the way it is pulling over from the database. Either way, thank you so much Jim. Ill need to do some modification but it should definitely be doable now."}, {"owner": {"reputation": 2547, "user_id": 2326824, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fveXJ.jpg?s=128&g=1", "display_name": "Jim Simson", "link": "https://stackoverflow.com/users/2326824/jim-simson"}, "reply_to_user": {"reputation": 3, "user_id": 6466695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0aa8e8a07ab6c7ebb11b7bc3481bc7a8?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/6466695/kyle"}, "edited": false, "score": 0, "creation_date": 1466019258, "post_id": 37842237, "comment_id": 63148927, "body": "@Kyle. Glad to hear it! Good luck with the rest of your project."}], "tags": [], "owner": {"reputation": 2547, "user_id": 2326824, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fveXJ.jpg?s=128&g=1", "display_name": "Jim Simson", "link": "https://stackoverflow.com/users/2326824/jim-simson"}, "is_accepted": true, "score": 0, "last_activity_date": 1466018441, "last_edit_date": 1466018441, "creation_date": 1466012516, "answer_id": 37842237, "question_id": 37839943, "link": "https://stackoverflow.com/questions/37839943/boolean-value-does-not-properly-assign-based-on-conditions-in-for-loop/37842237#37842237", "title": "Boolean value does not properly assign based on conditions in for loop", "body": "<p>Kyle, without being a complete re-work of your code, here's some code that I think might help you out. If I understand your problem correctly, the main issue you're having is that you're unable to properly determine if a value in one range exists in another. When I have this issue, I usually will use a dictionary object because it's fast, and provides an easy way to check if a value is in a list. To use a dictionary, however, you'll likely have to add a reference to it first. To do this, go to the tools menu and select \"References\". Scroll down until you've found \"Microsoft Scripting Runtime\" and select that item. After that, the following code should run just fine.</p>\n\n<pre><code>Sub Testq()\n        Set Dict = New Dictionary\n\n        For Each Cel In Worksheets(\"preview\").Columns(1).SpecialCells(xlCellTypeConstants)\n            'Add the \"Preview Values\" of all the cells into your dictionary as Keys.\n            'Set the value of each key to the \"Description\" which is in the row next to it.\n            Dict(Trim(Cel.Value)) = Trim(Cells(Cel.Row(), 2))\n        Next\n        'Lets add in the header row of the task worksheet to prevent it from getting coppied over.\n        Dict(Worksheets(\"task\").Cells(1, 1).Value) = Worksheets(\"task\").Cells(1, 2).Value\n        'Now loop through all of the values in your \"Task\" table, checking them against the Dictionary\n        'to see if there are any new ones.\n        For Each Cel In Worksheets(\"Task\").Columns(1).SpecialCells(xlCellTypeConstants)\n            If Not Dict.Exists(Trim(Cel.Value)) Then 'We have a new value.\n                TaskValue = Trim(Cel.Value)\n                Description = Trim(Worksheets(\"Task\").Cells(Cel.Row(), 2))\n                Debug.Print \"Yup, I found one that's missing: \" &amp; Trim(TaskValue)\n\n                'Now add the missing value to the end of your \"preview\" sheet.\n                LastRow = Worksheets(\"preview\").Cells(Range(\"A:A\").Rows.Count, \"A\").End(xlUp).Row\n                Worksheets(\"preview\").Cells(LastRow + 1, 1) = Trim(TaskValue)\n                Worksheets(\"preview\").Cells(LastRow + 1, 2) = Trim(Description)\n            End If\n        Next\n    End Sub\n</code></pre>\n\n<p>Since you mentioned that you're new to VBA, I'll point out that to view the output of the Debug.Print statement, you'll need to display the \"Immediate\" window. Do this by selecting it from the View menu. As I get a clearer picture of your project, I'll supplement this answer as needed, but for now I hope this will help you solve much of the problem you're having.</p>\n"}], "owner": {"reputation": 3, "user_id": 6466695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0aa8e8a07ab6c7ebb11b7bc3481bc7a8?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/6466695/kyle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 37842237, "answer_count": 1, "score": 0, "last_activity_date": 1466018441, "creation_date": 1466005156, "last_edit_date": 1466012303, "question_id": 37839943, "link": "https://stackoverflow.com/questions/37839943/boolean-value-does-not-properly-assign-based-on-conditions-in-for-loop", "title": "Boolean value does not properly assign based on conditions in for loop", "body": "<p>I am quite new to programming and VBA but I have been using a lot of help questions and answers here on stack overflow to learn! I am attempting to create a loop that will determine if a value from a \"task\" sheet is missing from a \"preview\" sheet and if so to add the number and line to the \"preview\" sheet from the \"task\" sheet. For an example of the data on each sheet:</p>\n\n<p>Task Sheet</p>\n\n<pre><code>TASK VALUE  description \n11      task 1\n12      task 2\n13      task 3\n</code></pre>\n\n<p>Preview Sheet</p>\n\n<pre><code>PREVIEW VALUE       Description\n1111                preview 1\n2222                preview 2\n11                  task 1\n3333                preview 3\n13                  task 3\n</code></pre>\n\n<p>The aim is to compare each number in the preview sheet to each value in the task sheet. If a value in the task sheet is not found in the preview sheet, then it should add that value and the entire line into the preview sheet from the task sheet.</p>\n\n<p>My main approach was to create a for loop that would compare each number on the \"preview\" sheet to each value on the \"task\" sheet. If it found that two values matched, it would set the variable newTask = False  and then exit the nested for loop to move on to the next comparison. If it found that the value from the data sheet was not present in the main sheet, it would set newTask = True and run through until there was no more values to compare. Then, if newTask = True, it would copy and paste the value and line from the data sheet into the main sheet. This is my attempt at coding this:</p>\n\n<pre><code>Dim newTask As Boolean\n\niP = (Worksheets(\"parents\").Columns(\"a\").Cells.SpecialCells(xlCellTypeConstants).Count) - 1 'count of parent workorders\niC = (Worksheets(\"child\").Columns(\"a\").Cells.SpecialCells(xlCellTypeConstants).Count) - 1 ' count of child workorders\niT = (Worksheets(\"task\").Columns(\"a\").Cells.SpecialCells(xlCellTypeConstants).Count) - 1 ' count of task workorders\niPr = (Worksheets(\"preview\").Columns(\"a\").Cells.SpecialCells(xlCellTypeConstants).Count) + 1 ' this will set iPr one row below the last row on the preview page\nnT = 0\nSet prRng = Sheets(\"Preview\").Range(Sheets(\"Preview\").Cells(iPr, 1), Sheets(\"Preview\").Cells(iPr, 11))\n\n     For n = 1 To iPr\n\n        taskWO = Worksheets(\"task\").Cells(n + 1, 1).Value\n\n        For nT = 1 To iT\n            previewWO = Worksheets(\"preview\").Cells(nT + 1, 1).Value\n\n            If previewWO = taskWO Then\n                newTask = False\n                Exit For\n\n            ElseIf previewWO &lt;&gt; taskWO Then\n                newTask = True\n                End If\n\n        Next nT\n\n\n        If newTask = True Then\n\n            Set tRng = Sheets(\"task\").Range(Sheets(\"task\").Cells(n + 1, 1), Sheets(\"task\").Cells(n + 1, 11))\n            Sheets(\"Preview\").Range(Sheets(\"Preview\").Cells(iPr, 1), Sheets(\"Preview\").Cells(iPr, 11)) = tRng.Value\n            Sheets(\"Preview\").Cells(iPr, 12) = Sheets(\"task\").Cells(n + 1, 13).Value\n            iPr = (Worksheets(\"preview\").Columns(\"a\").Cells.SpecialCells(xlCellTypeConstants).Count) + 1\n\n        End If\n    Next n\n</code></pre>\n\n<p>However, when I run this code, it keeps newTask = True, even if the values do match across the preview and task sheets. Debugging confirmed this and if it comes across similar values, it just continues over it as if they do not equal each other. This causes all values from the task sheet to copy over to the preview sheet, adding many duplicates. I also attempted a Do Until loop but get the same results: Here is my attempt at that:</p>\n\n<pre><code>Dim newTask As Boolean\n\niP = (Worksheets(\"parents\").Columns(\"a\").Cells.SpecialCells(xlCellTypeConstants).Count) - 1 'count of parent workorders\niC = (Worksheets(\"child\").Columns(\"a\").Cells.SpecialCells(xlCellTypeConstants).Count) - 1 ' count of child workorders\niT = (Worksheets(\"task\").Columns(\"a\").Cells.SpecialCells(xlCellTypeConstants).Count) - 1 ' count of task workorders\niPr = (Worksheets(\"preview\").Columns(\"a\").Cells.SpecialCells(xlCellTypeConstants).Count) + 1 ' this will set iPr one row below the last row on the preview page\nnT = 0\ntaskWO = Worksheets(\"task\").Cells(n + 1, 1).Value\nSet prRng = Sheets(\"Preview\").Range(Sheets(\"Preview\").Cells(iPr, 1), Sheets(\"Preview\").Cells(iPr, 11))\n\nFor n = 1 To iPr\ntaskWO = Worksheets(\"task\").Cells(n + 1, 1).Value\n    Do Until taskWO = previewWO Or nT = iT\n        previewWO = Worksheets(\"preview\").Cells(nT + 1, 1).Value\n        nT = nT + 1\n        If nT = iT Then\n            Set tRng = Sheets(\"task\").Range(Sheets(\"task\").Cells(n + 1, 1), Sheets(\"task\").Cells(n + 1, 11))\n            Sheets(\"Preview\").Range(Sheets(\"Preview\").Cells(iPr, 1), Sheets(\"Preview\").Cells(iPr, 11)) = tRng.Value\n            Sheets(\"Preview\").Cells(iPr, 12) = Sheets(\"task\").Cells(n + 1, 13).Value\n            iPr = (Worksheets(\"preview\").Columns(\"a\").Cells.SpecialCells(xlCellTypeConstants).Count) + 1\n        End If\n    Loop\n\nNext n\n</code></pre>\n\n<p>I have done a lot of searching but I cannot find any way to get this to stop duplicating values... but I apologize if I missed a thread that has this information or help.  I feel like it is something simple but I just cannot figure it out. Could I please get some help on how to correct this? If this is not the correct method, could you also please mention why the loop does not work or what went wrong so I can know in the future? Thank you for any help you provide! If you need some more information, please let me know.</p>\n"}, {"tags": ["excel", "excel-formula", "udf", "vba"], "answers": [{"tags": [], "owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "is_accepted": false, "score": 1, "last_activity_date": 1466005414, "creation_date": 1466005414, "answer_id": 37840035, "question_id": 37839843, "link": "https://stackoverflow.com/questions/37839843/trying-to-get-excel-udf-custom-cell-formatting-to-return-either-nothing-empty/37840035#37840035", "title": "Trying to get Excel UDF custom cell formatting to return either nothing &#39;(empty cell)&#39; or &#39;formatted user input&#39;", "body": "<p>Just add the following code:</p>\n\n<pre><code>if thisNumber = \"\" Then cleanPhoneNumber = \"\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "is_accepted": false, "score": 0, "last_activity_date": 1466008351, "creation_date": 1466008351, "answer_id": 37840999, "question_id": 37839843, "link": "https://stackoverflow.com/questions/37839843/trying-to-get-excel-udf-custom-cell-formatting-to-return-either-nothing-empty/37840999#37840999", "title": "Trying to get Excel UDF custom cell formatting to return either nothing &#39;(empty cell)&#39; or &#39;formatted user input&#39;", "body": "<p>Or alternatively:</p>\n\n<pre><code>=IF(cellvalue=\"\", \"\", =CustomUDF(cellvalue))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 234, "user_id": 6418109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3feb28dbc24648307695697d147c76a4?s=128&d=identicon&r=PG&f=1", "display_name": "The Dude", "link": "https://stackoverflow.com/users/6418109/the-dude"}, "is_accepted": false, "score": 0, "last_activity_date": 1466018990, "creation_date": 1466018990, "answer_id": 37844189, "question_id": 37839843, "link": "https://stackoverflow.com/questions/37839843/trying-to-get-excel-udf-custom-cell-formatting-to-return-either-nothing-empty/37844189#37844189", "title": "Trying to get Excel UDF custom cell formatting to return either nothing &#39;(empty cell)&#39; or &#39;formatted user input&#39;", "body": "<p>Why not just format the cells that do not have a number in them yet with a custom format 000-000-0000-0000</p>\n"}], "owner": {"reputation": 1, "user_id": 6470374, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-m9jE5_uLjsw/AAAAAAAAAAI/AAAAAAAAAAA/IU6XiO-OUOE/photo.jpg?sz=128", "display_name": "Nelson Valdivia", "link": "https://stackoverflow.com/users/6470374/nelson-valdivia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1466018990, "creation_date": 1466004899, "last_edit_date": 1531161705, "question_id": 37839843, "link": "https://stackoverflow.com/questions/37839843/trying-to-get-excel-udf-custom-cell-formatting-to-return-either-nothing-empty", "title": "Trying to get Excel UDF custom cell formatting to return either nothing &#39;(empty cell)&#39; or &#39;formatted user input&#39;", "body": "<p>im trying to use a custom defined UDF function to format a huge long list of excel phone numbers I have, as well as any future phone number entries I add to this excel file.</p>\n\n<p>Aside: the UDF itself just formats phone numbers, cleanly, so that no matter if I enter a phone with or without extension, it will format it to be more readable.\nI found it online and tinkered with it to suit my needs.  Thats not my question really,</p>\n\n<p>My question is how can I pre-empt a cell to take the value of my input and apply that as my cell-formatting without returning a #VALUE for all cells that do not have a value yet.  </p>\n\n<p>Ive tried something to the effect of:</p>\n\n<blockquote>\n  <p>=IF(ISBLANK, \"\", =CustomUDF(cellvalue))</p>\n</blockquote>\n\n<p>but dont think this will do the job.</p>\n\n<p>if you want to see my UDF, here it is!:</p>\n\n<pre><code>Function cleanPhoneNumber(thisNumber As String) As String\n    ' this function aspires to clean any phone number format\n    ' to standard format (+9999) 999-999-9999 or 999-999-9999\n    ' works with almost all phone number formats stored in text\n\nDim retNumber As String\n\nFor i = 1 To Len(thisNumber)\n    If Asc(Mid(thisNumber, i, 1)) &gt;= Asc(\"0\") And Asc(Mid(thisNumber, i, 1)) &lt;= Asc(\"9\") Then\n        retNumber = retNumber + Mid(thisNumber, i, 1)\n    End If\nNext\nIf Len(retNumber) &gt; 10 Then\n    ' format for country code as well\n    cleanPhoneNumber = Format(retNumber, \"000-000-0000-0000\")\nElse\n    cleanPhoneNumber = Format(retNumber, \"000-000-0000\")\nEnd If\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1466004816, "post_id": 37839729, "comment_id": 63140449, "body": "Maybe <code>Set oTren = myCht.Chart.SeriesCollection(1).Trendlines(1)</code> ?"}, {"owner": {"reputation": 394, "user_id": 3779976, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/1a8e7ad6a17ea44db739320c435a4026?s=128&d=identicon&r=PG", "display_name": "GregdeLima", "link": "https://stackoverflow.com/users/3779976/gregdelima"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1466004913, "post_id": 37839729, "comment_id": 63140522, "body": "That did it. Would I need to do this in the original <code>set myCht</code> line, too? or just in the latter instances?"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1466005017, "post_id": 37839729, "comment_id": 63140602, "body": "No, though you could experiment with declaring <code>myCht</code> as a chart rather than a chart object."}, {"owner": {"reputation": 394, "user_id": 3779976, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/1a8e7ad6a17ea44db739320c435a4026?s=128&d=identicon&r=PG", "display_name": "GregdeLima", "link": "https://stackoverflow.com/users/3779976/gregdelima"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1466010294, "post_id": 37839729, "comment_id": 63143958, "body": "Would you mind submitting this as an answer so I can mark as answered."}], "answers": [{"tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": true, "score": 1, "last_activity_date": 1466011300, "creation_date": 1466011300, "answer_id": 37841886, "question_id": 37839729, "link": "https://stackoverflow.com/questions/37839729/setting-a-trendline-as-variable-throws-error/37841886#37841886", "title": "Setting a Trendline as Variable Throws Error", "body": "<p>The problem is that <code>myCht</code> is a <code>ChartObject</code> object rather than a <code>Chart</code> object. You thus need to go through the chart object's chart method to get to the elements of the chart, such as trendlines associated to series:</p>\n\n<pre><code>Set oTren = myCht.Chart.SeriesCollection(1).Trendlines(1)\n</code></pre>\n"}], "owner": {"reputation": 394, "user_id": 3779976, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/1a8e7ad6a17ea44db739320c435a4026?s=128&d=identicon&r=PG", "display_name": "GregdeLima", "link": "https://stackoverflow.com/users/3779976/gregdelima"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 37841886, "answer_count": 1, "score": 0, "last_activity_date": 1466011300, "creation_date": 1466004616, "question_id": 37839729, "link": "https://stackoverflow.com/questions/37839729/setting-a-trendline-as-variable-throws-error", "title": "Setting a Trendline as Variable Throws Error", "body": "<p>I'm working witht he following code:</p>\n\n<pre><code>Sub AddTrendLinesBoth()\nDim myCht As ChartObject\nDim oTren As Trendline\nDim oWb As Workbook\nDim oWS As Worksheet\nSet oWb = ThisWorkbook\nSet oWS = oWb.Sheets(\"Summary\")\n\nSet myCht = oWS.ChartObjects(\"Chart 1\")\n    On Error GoTo GetOut\nWith myCht.Chart\n    .SeriesCollection(1).Trendlines.Add\n    .SeriesCollection(2).Trendlines.Add\nEnd With\n\n\nSet oTren = myCht.SeriesCollection(1).Trendlines(1)\n        With oTren.Format.Line\n            .Visible = msoTrue\n            .Weight = 3\n            .ForeColor.RGB = RGB(112, 48, 160)\n            .Transparency = 0\n        End With\n\nSet oTren = myCht.SeriesCollection(2).Trendlines(1)\n        With oTren.Format.Line\n            .Visible = msoTrue\n            .Weight = 3\n            .ForeColor.RGB = RGB(255, 0, 0)\n            .Transparency = 0\n        End With\n\nGetOut:\nEnd Sub\n</code></pre>\n\n<p>On each instance of <code>set oTren =</code> the code errors out on establishing the variable. What am I missing to adequately establish that line? \nThe reason I'm using <code>with</code> statements as <code>set</code> variables, is because using <code>ActiveChart</code> and <code>ActiveSheet</code> was throwing method errors with older versions of Excel.</p>\n"}, {"tags": ["vba", "excel", "object", "dictionary"], "comments": [{"owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "edited": false, "score": 0, "creation_date": 1466004956, "post_id": 37839671, "comment_id": 63140558, "body": "Surely you can just reference the range directly: LastRow.Resize(UBound... etc alternatively dim LastRow as Integer and dim Destination as Range then set Destination = Range(&quot;A&quot; &amp; LastRow)"}], "answers": [{"comments": [{"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 1, "creation_date": 1466005042, "post_id": 37839813, "comment_id": 63140621, "body": "To complement this answer, the line LastRow = Range(&quot;a6500&quot;).End(xlUp).Row, should be LastRow= Cells(Rows.Count, &quot;A&quot;).End(xlUp).Row instead"}, {"owner": {"reputation": 1256, "user_id": 3128069, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/4cdd27382d73700ac43edb0becdc1a7b?s=128&d=identicon&r=PG&f=1", "display_name": "phillipsK", "link": "https://stackoverflow.com/users/3128069/phillipsk"}, "edited": false, "score": 0, "creation_date": 1466006420, "post_id": 37839813, "comment_id": 63141622, "body": "An <code>Invalid Qualifier</code> error throws an exception on <code>destination.Resize(UBound(aRB_Dict, 1) + 1, UBound(aRB_Dict, 2)).Value = aRB_Dict</code> with this answer"}, {"owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "edited": false, "score": 0, "creation_date": 1466086341, "post_id": 37839813, "comment_id": 63180621, "body": "I&#39;m not really sure what you are trying to accomplish with that that line. Generally speaking all <code>.Methods</code> only work for objects. As explained before, you are declaring a variable containing an <code>integer</code>. When you want to resize your array, just use <code>ReDim</code> again."}, {"owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "edited": false, "score": 0, "creation_date": 1466086346, "post_id": 37839813, "comment_id": 63180626, "body": "Also see: <a href=\"http://stackoverflow.com/questions/3872339/what-is-the-difference-between-dim-and-set-in-vba\" title=\"what is the difference between dim and set in vba\">stackoverflow.com/questions/3872339/&hellip;</a>"}], "tags": [], "owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "is_accepted": false, "score": 1, "last_activity_date": 1466004805, "creation_date": 1466004805, "answer_id": 37839813, "question_id": 37839671, "link": "https://stackoverflow.com/questions/37839671/set-destination-to-last-row-in-worksheet-object-required-error/37839813#37839813", "title": "Set Destination to last row in worksheet - Object Required error", "body": "<p>The <code>Set</code>-keyword is used for declaring objects, when you want to declare a variable, just use <code>Dim</code>. You should declare <code>lastRow</code> and <code>destination</code> as integers. Then <code>destination = lastRow</code> wont throw any errors. (Although vba interprets every undeclared variable with the <code>Variant</code>-type, so technically you can just delete <code>Set</code>).</p>\n"}], "owner": {"reputation": 1256, "user_id": 3128069, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/4cdd27382d73700ac43edb0becdc1a7b?s=128&d=identicon&r=PG&f=1", "display_name": "phillipsK", "link": "https://stackoverflow.com/users/3128069/phillipsk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 568, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1466004805, "creation_date": 1466004456, "question_id": 37839671, "link": "https://stackoverflow.com/questions/37839671/set-destination-to-last-row-in-worksheet-object-required-error", "title": "Set Destination to last row in worksheet - Object Required error", "body": "<p>I am calling this procedure three times as I wish to append a series of CUSIPs to a VBA Scripting dictionary.</p>\n\n<pre><code>Sub Import_RB_Dict(ws_string As String)\n'Uses Scripting Dictionary instead of loop to sum up the TNA of funds in the CNR\n'Much faster than traditional loop\n\nSheets(ws_string).Activate\n\n\n\nLR = Range(\"a1000\").End(xlUp).Row\nLC = Range(\"zz1\").End(xlToLeft).Column\n\nReDim Source(1 To LR, 1 To LC)\nSource = Range(Cells(1, 1), Cells(LR, LC))\nReDim aRB_Dict(1 To LR, 1 To 2000)\n\n\nSet RB_List = CreateObject(\"scripting.dictionary\")\n\nRow = 0\nFor r = 2 To LR\n    If RB_List.Exists(Source(r, 3)) Then\n        Array_Row = RB_List(Source(r, 3))\n        'aRB_Dict(Array_Row, 2) = aRB_Dict(Array_Row, 2) + Source(r, 65) / Source(r, 47)\n    Else\n        Row = Row + 1\n        With RB_List\n            .CompareMode = vbTextCompare\n            .Add Source(r, 3), Row\n        End With\n        aRB_Dict(Row, 1) = Trim(CStr(Source(r, 3)))\n        'aRB_Dict(Row, 2) = Source(r, 65) / Source(r, 47)\n    End If\nNext r\n\nSheets(\"Request Builder\").Select\nLastRow = Range(\"a6500\").End(xlUp).Row\nSet Destination = LastRow\nDestination.Resize(UBound(aRB_Dict, 1) + 1, UBound(aRB_Dict, 2)).Value = aRB_Dict\n\nEnd Sub\n</code></pre>\n\n<p>And I am calling this procedure through the below</p>\n\n<pre><code>Set RB_List = CreateObject(\"scripting.dictionary\")\nRB_List.RemoveAll\nSet RB_List = Nothing\nSet RB_List = CreateObject(\"scripting.dictionary\")\n\nImport_RB_Dict \"Main\"\nImport_RB_Dict \"ETF\"\nImport_RB_Dict \"MAV\"\n</code></pre>\n\n<p>But my main code will not run as I am not able to assign <code>Set Destination = LastRow</code>? I receive the error <code>Object Required</code> in fact the procedure will not even begin to run. By use of the LastRow variable I would like to identify the last blank cell in column A and append all the CUSIPs within the dictionary to that cell. My goal is to use to dictionary to scan over each sheet and compile a unique list of all unique securities among each of the three worksheets and then append them to the <code>Request Builder</code> Sheet.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 206726, "user_id": 5459839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iehrR.jpg?s=128&g=1", "display_name": "trincot", "link": "https://stackoverflow.com/users/5459839/trincot"}, "edited": false, "score": 0, "creation_date": 1467112917, "post_id": 37840324, "comment_id": 63586163, "body": "Did this answer your question? Could you leave a comment?"}], "tags": [], "owner": {"reputation": 206726, "user_id": 5459839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iehrR.jpg?s=128&g=1", "display_name": "trincot", "link": "https://stackoverflow.com/users/5459839/trincot"}, "is_accepted": false, "score": 0, "last_activity_date": 1466006109, "creation_date": 1466006109, "answer_id": 37840324, "question_id": 37839564, "link": "https://stackoverflow.com/questions/37839564/adding-row-in-excel-and-incrementing-an-account-number/37840324#37840324", "title": "Adding row in Excel and incrementing an account number", "body": "<p>You could track the changes made to your sheet. If a changed cell is found non-blank on a row that has nothing in the Account Number column, then the new account number is calculated and filled in:</p>\n\n<p>Put this code in the worksheet's VBA module:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim record As Range\n    Dim maxAccountNo As Long\n\n    For Each record In Target.Rows\n        If Cells(record.row, 1) = \"\" And WorksheetFunction.CountA(record.EntireRow) &gt; 0 Then\n            If Not maxAccountNo Then\n                maxAccountNo = 1 + WorksheetFunction.Max(Range(\"$A:$A\"))\n            End If\n            Cells(record.row, 1) = maxAccountNo\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>This will also cover cases where you copy/paste several rows that have no account number filled in.</p>\n\n<p>Note that this code assumes the account number is in column A, excluding the first row. Adapt this reference in the code, if necessary:</p>\n\n<pre><code>$A2:$A100000\n</code></pre>\n\n<p>.. and also the column number in:</p>\n\n<pre><code>Cells(record.row, 1)\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6470335, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209267100410500/picture?type=large", "display_name": "Jim Piazza", "link": "https://stackoverflow.com/users/6470335/jim-piazza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1466006109, "creation_date": 1466004170, "question_id": 37839564, "link": "https://stackoverflow.com/questions/37839564/adding-row-in-excel-and-incrementing-an-account-number", "title": "Adding row in Excel and incrementing an account number", "body": "<p>I am taking over a mailing list from an outside vendor. We will be using Excel 2010. There is a unique account number column.</p>\n\n<p>I need a macro to be able to determine when a new row is being added as opposed to existing row being modified and then how to the get max(account number) and add 1 to it to keep the new account number unique.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3, "user_id": 6470290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/379a02758775f573fb6cf72ed0a60601?s=128&d=identicon&r=PG&f=1", "display_name": "Desktop", "link": "https://stackoverflow.com/users/6470290/desktop"}, "reply_to_user": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "edited": false, "score": 0, "creation_date": 1466061668, "post_id": 37839449, "comment_id": 63163516, "body": "I have tried to create a data validation drop down menu for each cell in a column using vba and a combination of online tutorials and then linking each cell to the data in its corresponding row.  however using the methods i saw, I would need an individual piece of code for each row... and i have over 100 rows"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1466071095, "post_id": 37839449, "comment_id": 63169717, "body": "you need to loop the columns and do something like countif, so <code>columns(x).entirecolumn.hidden= countif(column(x).offset(0,x),value)&gt;0</code>  where value is what you are looking for, and x is a loop for the columns"}, {"owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "edited": false, "score": 0, "creation_date": 1466085798, "post_id": 37839449, "comment_id": 63180202, "body": "@Desktop, it&#39;s kinda hard for me to fully understand your problem. Maybe you could add a screenshot or try to visualize the structure of your data."}, {"owner": {"reputation": 3, "user_id": 6470290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/379a02758775f573fb6cf72ed0a60601?s=128&d=identicon&r=PG&f=1", "display_name": "Desktop", "link": "https://stackoverflow.com/users/6470290/desktop"}, "edited": false, "score": 0, "creation_date": 1466409106, "post_id": 37839449, "comment_id": 63285323, "body": "I think I can try to explain better.  If the value in cell(x,n) [column, row] = &quot;K&quot; or &quot;E&quot;  Then  for the range to right of <b>column x</b>  hide every column which does not contain an &quot;E&quot; or &quot;K&quot; in <b>row n</b>"}], "owner": {"reputation": 3, "user_id": 6470290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/379a02758775f573fb6cf72ed0a60601?s=128&d=identicon&r=PG&f=1", "display_name": "Desktop", "link": "https://stackoverflow.com/users/6470290/desktop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 2, "answer_count": 0, "score": 0, "last_activity_date": 1467727024, "creation_date": 1466003842, "last_edit_date": 1467727024, "question_id": 37839449, "link": "https://stackoverflow.com/questions/37839449/hiding-columns-by-matching-a-cell-entry-to-the-respective-row-data-of-the-column", "title": "Hiding Columns by matching a cell entry to the respective row data of the columns", "body": "<p>I am trying to filter out columns which do not contain the letter I enter in a cell which corresponds to the row.</p>\n\n<p>I have constructed a matrix of Blanks, K's and E's \nOn the top there is names\non the left there are categories</p>\n\n<p>for each name and category there is an assigned K, E or Blank\nI want to enter either K or E next to each category (ideally using a drop down menu) and that will filter out every name which does not have the letter I entered in respect to this particular category. </p>\n\n<p>One person may have a K, E or Blank but not a combination of them within a particular catagory.</p>\n\n<p>I have searched everywhere for how to do this but I'm stumped. I'm not particularly proficient in VBA or Excel but I feel like this should be a simple problem which is why it's frustrating</p>\n\n<p>I'm tryin to create something like this:</p>\n\n<blockquote>\n  <p>If </p>\n  \n  <p>the value in cell(x,n) [column, row] = \"K\" or \"E\"  Then  for the</p>\n  \n  <p>range to right of column x</p>\n  \n  <p>hide every column which does not contain an \"E\" or \"K\" in row n</p>\n</blockquote>\n\n<p>or you could say only show columns which contain an E or K in row n</p>\n\n<p>Thanks in advance for any help!</p>\n"}, {"tags": ["forms", "vba", "excel", "user-input"], "comments": [{"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1466004621, "post_id": 37839339, "comment_id": 63140297, "body": "Are command buttons names the same? Or did you changed them after? You can debug clicks set a breakpoint on them prior to show the form"}], "answers": [{"tags": [], "owner": {"reputation": 698, "user_id": 3191764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44be94e3b3d77c9f14b41b1d1c5fa66b?s=128&d=identicon&r=PG", "display_name": "Alex D", "link": "https://stackoverflow.com/users/3191764/alex-d"}, "is_accepted": true, "score": 1, "last_activity_date": 1466004738, "creation_date": 1466004738, "answer_id": 37839785, "question_id": 37839339, "link": "https://stackoverflow.com/questions/37839339/excel-user-form-button-not-working/37839785#37839785", "title": "excel user form button not working", "body": "<p>If you're trying to increment by 1 to that column here's your problem:</p>\n\n<pre><code>c.Offset(0, 6) = c.Offset(0, 3) + 1\n</code></pre>\n\n<p>should be </p>\n\n<pre><code>c.Offset(0, 6) = c.Offset(0, 6) + 1 'or both 3\n</code></pre>\n\n<p>Your offsets weren't matching. Same problem for the subtract. Unless you were trying to subtract one from the value in column 6, and place it in column 3. In which case this code should be working fine. </p>\n"}], "owner": {"reputation": 559, "user_id": 4994594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb48f2101f21149eb5eeb26f45825f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Vbasic4now", "link": "https://stackoverflow.com/users/4994594/vbasic4now"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 513, "favorite_count": 0, "accepted_answer_id": 37839785, "answer_count": 1, "score": 1, "last_activity_date": 1466004738, "creation_date": 1466003521, "question_id": 37839339, "link": "https://stackoverflow.com/questions/37839339/excel-user-form-button-not-working", "title": "excel user form button not working", "body": "<p>I have made a simple user form in excel VBA that has an add and a subtract button. When one is clicked, it should add one to whatever value is in the row that has the current hour in it. </p>\n\n<p>for example, if its 7:35 and someone clicks add it should add 1 to the row that has 7:00 column B. When I initialize this code with a vbYesNo button and a few if statements it works, but when i use the same code in the button clicks on the user form it does not and i can not figure out why. my code is as follows:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nSheets(\"Front End\").Unprotect (\"29745\")\nh = Hour(Now)\n    For Each c In range(\"B8:B20\")\n        If h = Hour(c) Then\n            c.Offset(0, 6) = c.Offset(0, 3) + 1\n            Exit For\n        End If\n    Next c\nSheets(\"Front End\").Protect (\"29745\")\nEnd Sub\n------------------------------------------------------\nPrivate Sub CommandButton2_Click()\nSheets(\"Front End\").Unprotect (\"29745\")\nh = Hour(Now)\n    For Each c In range(\"B8:B20\")\n        If h = Hour(c) Then\n            c.Offset(0, 6) = c.Offset(0, 3) - 1\n            Exit For\n        End If\n    Next c\nSheets(\"Front End\").Protect (\"29745\")\nEnd Sub\n</code></pre>\n\n<p>can anyone help me understand what i have wrong and what i need to do to fix it? </p>\n\n<p>thank you!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 3, "creation_date": 1466003440, "post_id": 37839191, "comment_id": 63139442, "body": "What you want is absolutely doable. In order to use StackOverflow effectively, you&#39;ll have to show your VBA/macro code and what you&#39;ve tried first. Explain what problems you&#39;re having and can&#39;t figure out. SO is not a code-writing service. My suggestion is to record a macro that uses all the steps you perform by hand, then go into the recorded macro to learn how VBA performs the same thing. Start making changes to the recorded macro to make it your own. Use google searches on SO and other Excel VBA sites to discover what works and what doesn&#39;t. Then come here to SO and post specific questions."}], "answers": [{"tags": [], "owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1466003698, "creation_date": 1466003698, "answer_id": 37839398, "question_id": 37839191, "link": "https://stackoverflow.com/questions/37839191/how-can-i-duplicate-a-cell-value-until-the-next-filled-cell/37839398#37839398", "title": "How can I duplicate a cell value until the next filled cell?", "body": "<p>Fill in the first cell by hand and then just autofill this easy formula:</p>\n\n<p><code>F3=IF(F3&lt;&gt;\"\";F3;F2)</code></p>\n"}], "owner": {"reputation": 1, "user_id": 6446570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef52a35d79d4ab21d7ef8d2ff7dc1b59?s=128&d=identicon&r=PG&f=1", "display_name": "Alex D.", "link": "https://stackoverflow.com/users/6446570/alex-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1466009428, "creation_date": 1466003122, "last_edit_date": 1531164843, "question_id": 37839191, "link": "https://stackoverflow.com/questions/37839191/how-can-i-duplicate-a-cell-value-until-the-next-filled-cell", "title": "How can I duplicate a cell value until the next filled cell?", "body": "<p>I have an excel sheet that gets dumped out from a model I use.  Unfortunately, I have to take a lot of time by hand to fix these sheets every day.  However, it can be really easy to work with if this one change is made.  </p>\n\n<p>I attached a picture, the left is what it comes out of the model as, the right is what I would like it to be like in a new sheet.  The only problem I foresee is the number of values in the second column is different every time, so the labels in the first column aren't always in the same place.  </p>\n\n<p>Any ideas on how to accomplish this would be appreciated.  <a href=\"http://i.stack.imgur.com/lqPvy.png\" rel=\"nofollow\">Picture</a></p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 698, "user_id": 3191764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44be94e3b3d77c9f14b41b1d1c5fa66b?s=128&d=identicon&r=PG", "display_name": "Alex D", "link": "https://stackoverflow.com/users/3191764/alex-d"}, "edited": false, "score": 0, "creation_date": 1466001143, "post_id": 37838274, "comment_id": 63137736, "body": "Do you just want the numbers highlighted, or do you want some kind of MsgBox? Do you just want the cells stored some how. Depending on what your output is, different approaches will be easier."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1466001431, "post_id": 37838274, "comment_id": 63137972, "body": "you can do this with formula, so =if(a1:z1&gt;=-50,column(a1:z1),&quot;&quot;) in an array, this will give results like {4,5,10} where these are the column numbers, you can then use SMALL(array,k) to get the column numbers and do what you need.  Similarly put it in formula based CF to highlight"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6470049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44b189892a4f827651b41b5cc49dc3be?s=128&d=identicon&r=PG&f=1", "display_name": "KMac", "link": "https://stackoverflow.com/users/6470049/kmac"}, "edited": false, "score": 0, "creation_date": 1466006551, "post_id": 37838842, "comment_id": 63141719, "body": "I thought about that, but the only problem is that the threshold number changes on each row. Is there a way to quickly change the condition arguments without manually typing in the change?"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 2, "last_activity_date": 1466027843, "last_edit_date": 1466027843, "creation_date": 1466002281, "answer_id": 37838842, "question_id": 37838274, "link": "https://stackoverflow.com/questions/37838274/determining-which-value-in-a-row-if-any-is-greater/37838842#37838842", "title": "Determining which value in a row, if any, is greater", "body": "<p>From the Home Tab choose Conditional Formatting </p>\n\n<p><a href=\"https://i.stack.imgur.com/Tu984.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Tu984.png\" alt=\"enter image description here\"></a>\nSelect the Range that you what Conditionally Formatted.  Enter the formula that what evaluated.  In this case >-50.<br>\n<a href=\"https://i.stack.imgur.com/G1eS6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/G1eS6.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 6470049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44b189892a4f827651b41b5cc49dc3be?s=128&d=identicon&r=PG&f=1", "display_name": "KMac", "link": "https://stackoverflow.com/users/6470049/kmac"}, "edited": false, "score": 0, "creation_date": 1466007155, "post_id": 37839871, "comment_id": 63142132, "body": "That&#39;s money! So if I&#39;m understanding this one correctly, it cycles through A1-&gt;E1, comparing them -50. Then, if they are true, it basically it into an array. Then it compares all the &quot;True&quot; values and takes the minimum. Is that all correct?"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 1, "last_activity_date": 1466004977, "creation_date": 1466004977, "answer_id": 37839871, "question_id": 37838274, "link": "https://stackoverflow.com/questions/37838274/determining-which-value-in-a-row-if-any-is-greater/37839871#37839871", "title": "Determining which value in a row, if any, is greater", "body": "<p>With data in <strong>A1</strong> through <strong>E12</strong>, in <strong>F1</strong> enter the array formula:</p>\n\n<pre><code>=MIN(IF(A1:E1&gt;-50,A1:E1))\n</code></pre>\n\n<p>and copy down:</p>\n\n<p><a href=\"https://i.stack.imgur.com/7Wwtg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7Wwtg.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Array formulas</strong> must be entered with <kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>Enter</kbd> rather than just the <kbd>Enter</kbd> key.</p>\n\n<p>Note:</p>\n\n<p>If all the values are less than -50, the formula will return <strong>0</strong></p>\n"}], "owner": {"reputation": 3, "user_id": 6470049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44b189892a4f827651b41b5cc49dc3be?s=128&d=identicon&r=PG&f=1", "display_name": "KMac", "link": "https://stackoverflow.com/users/6470049/kmac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 37839871, "answer_count": 2, "score": 0, "last_activity_date": 1466027843, "creation_date": 1466000819, "question_id": 37838274, "link": "https://stackoverflow.com/questions/37838274/determining-which-value-in-a-row-if-any-is-greater", "title": "Determining which value in a row, if any, is greater", "body": "<p>I have a large table of data where I need to find out if, along one row, any values are greater than a threshold number. If it finds a number, I need it to either return that number, or return the column header so I can find that number.</p>\n\n<p>One problem that may occur is that there may be multiple values that exceed this threshold.</p>\n\n<p>The data can't be sorted in ascending or descending order because that may mess up other orders, or take them out of the necessary column they need to be in.</p>\n\n<p>Below is a small snippet of data that I'm dealing with. I need to know if the numbers are ever greater (more positive) than -50. I need to know which numbers exceed it and/or which column it's in.</p>\n\n<p>I'd rather it not be vba or macro, but if needs be then such is life.</p>\n\n<p>Help?<a href=\"http://i.stack.imgur.com/rTnL0.jpg\" rel=\"nofollow\"> Two Sample data rows</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1466000954, "post_id": 37838054, "comment_id": 63137576, "body": "Try to stop using <code>select</code>, you can say <code>found.cut</code> for example <code>Range(&quot;F&quot; &amp; (ActiveCell.Row)).value=found.value</code>  also turn off calculation whilst processing.   Also perhaps use a string comparison function, like instr, to do what you want. You can also use SEARCH &amp; FIND in a formula, so you could add the formula like this =IF(ISERR(SEARCH(&quot;release date\\n&quot;,I1)),&quot;&quot;,I1) and then search the results column in your loop looking for non &quot;&quot; entries"}, {"owner": {"reputation": 421, "user_id": 5024658, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-md8UhJRxd_g/AAAAAAAAAAI/AAAAAAAAhyg/igUflaP6DH4/photo.jpg?sz=128", "display_name": "Liss", "link": "https://stackoverflow.com/users/5024658/liss"}, "edited": false, "score": 0, "creation_date": 1466000987, "post_id": 37838054, "comment_id": 63137605, "body": "I&#39;d think InStr would be faster to loop through with.  <a href=\"https://msdn.microsoft.com/en-us/library/8460tsh1(v=vs.90).aspx\" rel=\"nofollow noreferrer\">MSDN</a>"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 6455950, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4cc111bced66dde4e2b5962ca8e7ce7a?s=128&d=identicon&r=PG&f=1", "display_name": "Hafigur", "link": "https://stackoverflow.com/users/6455950/hafigur"}, "edited": false, "score": 0, "creation_date": 1466002669, "post_id": 37838321, "comment_id": 63138868, "body": "Run Time error 91for this line   Loop While Not found Is Nothing And found.Address &lt;&gt; firstAddress"}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "reply_to_user": {"reputation": 15, "user_id": 6455950, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4cc111bced66dde4e2b5962ca8e7ce7a?s=128&d=identicon&r=PG&f=1", "display_name": "Hafigur", "link": "https://stackoverflow.com/users/6455950/hafigur"}, "edited": false, "score": 0, "creation_date": 1466003296, "post_id": 37838321, "comment_id": 63139337, "body": "RT91 means an object variable is not set - Did you miss a <code>Set</code> statement in the line above where the error is triggered?"}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "reply_to_user": {"reputation": 15, "user_id": 6455950, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4cc111bced66dde4e2b5962ca8e7ce7a?s=128&d=identicon&r=PG&f=1", "display_name": "Hafigur", "link": "https://stackoverflow.com/users/6455950/hafigur"}, "edited": false, "score": 0, "creation_date": 1466004715, "post_id": 37838321, "comment_id": 63140371, "body": "Can&#39;t see anything obviously wrong; try stepping through the code using the F8 key and see what <code>found.Address</code> is when it hits the <code>Loop While...</code> line?"}], "tags": [], "owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "is_accepted": false, "score": 1, "last_activity_date": 1466000951, "creation_date": 1466000951, "answer_id": 37838321, "question_id": 37838054, "link": "https://stackoverflow.com/questions/37838054/vba-for-cut-data-for-certain-keywords/37838321#37838321", "title": "VBA for cut Data for certain Keywords", "body": "<p>Firstly, stop going from 1 to 10,000 - you don't need to repeat the action so much when you can use .FindNext instead.  Secondly, avoid like the plague the use of <code>.Select</code>.  </p>\n\n<pre><code>Dim ws as Worksheet\nSet ws = ThisWorkbook.Worksheets(\"part15\")\nDim lastRow\nlastRow = ws.Cells(ws.Rows.Count, 1).End(xlUp).Row\n\nDim found As Range\nWith ws.Range(\"A:D\")\n    Set found = .Find(What:=\"Release Date:\\n \", After:=ActiveCell, LookIn:= _\n    xlValues, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext _\n    , MatchCase:=False, SearchFormat:=False)\n\n    If Not found Is Nothing Then\n        firstAddress = found.Address\n        Do\n            ws.Range(\"F\" &amp; found.Row).Value = found.Value\n            set found = .FindNext(found)\n        Loop While Not found Is Nothing And found.Address &lt;&gt; firstAddress \n    End If\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 6455950, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4cc111bced66dde4e2b5962ca8e7ce7a?s=128&d=identicon&r=PG&f=1", "display_name": "Hafigur", "link": "https://stackoverflow.com/users/6455950/hafigur"}, "edited": false, "score": 0, "creation_date": 1466002599, "post_id": 37838605, "comment_id": 63138823, "body": "String can found anywhere in Range A1:D10000. I mean it can found in b12 or c15 or d11. Always it needs go to in Column F"}, {"owner": {"reputation": 2547, "user_id": 2326824, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fveXJ.jpg?s=128&g=1", "display_name": "Jim Simson", "link": "https://stackoverflow.com/users/2326824/jim-simson"}, "reply_to_user": {"reputation": 15, "user_id": 6455950, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4cc111bced66dde4e2b5962ca8e7ce7a?s=128&d=identicon&r=PG&f=1", "display_name": "Hafigur", "link": "https://stackoverflow.com/users/6455950/hafigur"}, "edited": false, "score": 0, "creation_date": 1466002640, "post_id": 37838605, "comment_id": 63138851, "body": "@Hafigur Yup. Just saw that. Made the change. Sorry about that."}, {"owner": {"reputation": 15, "user_id": 6455950, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4cc111bced66dde4e2b5962ca8e7ce7a?s=128&d=identicon&r=PG&f=1", "display_name": "Hafigur", "link": "https://stackoverflow.com/users/6455950/hafigur"}, "edited": false, "score": 0, "creation_date": 1466002994, "post_id": 37838605, "comment_id": 63139113, "body": "Another important matter that string are not only &quot;Release Date:\\n&quot; String may have other data with &quot;Release Date:\\n &quot; I mean &quot;Release Date:\\n &quot;  is a keyword in a string."}, {"owner": {"reputation": 2547, "user_id": 2326824, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fveXJ.jpg?s=128&g=1", "display_name": "Jim Simson", "link": "https://stackoverflow.com/users/2326824/jim-simson"}, "reply_to_user": {"reputation": 15, "user_id": 6455950, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4cc111bced66dde4e2b5962ca8e7ce7a?s=128&d=identicon&r=PG&f=1", "display_name": "Hafigur", "link": "https://stackoverflow.com/users/6455950/hafigur"}, "edited": false, "score": 0, "creation_date": 1466003140, "post_id": 37838605, "comment_id": 63139224, "body": "@Hafigur Right, the above code will copy any cell containing &quot;Release Date:\\n &quot; even if there&#39;s other data in there. Should work just fine. Let me know if it doesn&#39;t."}, {"owner": {"reputation": 15, "user_id": 6455950, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4cc111bced66dde4e2b5962ca8e7ce7a?s=128&d=identicon&r=PG&f=1", "display_name": "Hafigur", "link": "https://stackoverflow.com/users/6455950/hafigur"}, "edited": false, "score": 0, "creation_date": 1466003418, "post_id": 37838605, "comment_id": 63139427, "body": "I tried several times Code runs but it doesn&#39;t work."}, {"owner": {"reputation": 2547, "user_id": 2326824, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fveXJ.jpg?s=128&g=1", "display_name": "Jim Simson", "link": "https://stackoverflow.com/users/2326824/jim-simson"}, "reply_to_user": {"reputation": 15, "user_id": 6455950, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4cc111bced66dde4e2b5962ca8e7ce7a?s=128&d=identicon&r=PG&f=1", "display_name": "Hafigur", "link": "https://stackoverflow.com/users/6455950/hafigur"}, "edited": false, "score": 0, "creation_date": 1466003584, "post_id": 37838605, "comment_id": 63139549, "body": "@Hafigur Are you sure that there&#39;s a space in your string after &quot;Release Date:\\n &quot;? Works fine on my end."}, {"owner": {"reputation": 2547, "user_id": 2326824, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fveXJ.jpg?s=128&g=1", "display_name": "Jim Simson", "link": "https://stackoverflow.com/users/2326824/jim-simson"}, "reply_to_user": {"reputation": 15, "user_id": 6455950, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4cc111bced66dde4e2b5962ca8e7ce7a?s=128&d=identicon&r=PG&f=1", "display_name": "Hafigur", "link": "https://stackoverflow.com/users/6455950/hafigur"}, "edited": false, "score": 0, "creation_date": 1466003855, "post_id": 37838605, "comment_id": 63139756, "body": "Glad to hear it! Good luck."}], "tags": [], "owner": {"reputation": 2547, "user_id": 2326824, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fveXJ.jpg?s=128&g=1", "display_name": "Jim Simson", "link": "https://stackoverflow.com/users/2326824/jim-simson"}, "is_accepted": true, "score": 0, "last_activity_date": 1466003521, "last_edit_date": 1466003521, "creation_date": 1466001682, "answer_id": 37838605, "question_id": 37838054, "link": "https://stackoverflow.com/questions/37838054/vba-for-cut-data-for-certain-keywords/37838605#37838605", "title": "VBA for cut Data for certain Keywords", "body": "<p>As Dave mentioned, much of your slow down is going to come from the repeated select statements in your code. VBA usually does not need to select a range in order to work with the data therein. The following should speed things up for you quite a bit. It runs for me instantaneously:</p>\n\n<pre><code>Sub Macro87()\n    Set Rng = Range(\"A1:D10000\")\n    For Each cel In Rng\n        If InStr(1, cel.Value, \"Release Date:\\n \") &gt; 0 Then\n            Cells(cel.Row(), 6) = cel.Value\n            cel.Value = Empty\n        End If\n    Next cel\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 6455950, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4cc111bced66dde4e2b5962ca8e7ce7a?s=128&d=identicon&r=PG&f=1", "display_name": "Hafigur", "link": "https://stackoverflow.com/users/6455950/hafigur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 37838605, "answer_count": 2, "score": 0, "last_activity_date": 1466003521, "creation_date": 1466000235, "last_edit_date": 1531164843, "question_id": 37838054, "link": "https://stackoverflow.com/questions/37838054/vba-for-cut-data-for-certain-keywords", "title": "VBA for cut Data for certain Keywords", "body": "<p>I want cut data from A1:D10000 for certain keyword. Example if have any string with \"Release Date:\\n \"it will be cut &amp; paste in corresponding cell in F column. \nI mean if any string have with \"Release Date:\\n \" in C21 then it will be cut &amp; paste in F21</p>\n\n<p>I have a code &amp; it works fine. But problem is it needs huge time to complete than i expected. Any better code as if it runs quickly?</p>\n\n<p>My Code:</p>\n\n<p>Sub Macro87()</p>\n\n<pre><code>For Repeat = 1 To 10000\nDim found As Range\nSheets(\"part15\").Select\nRange(\"A1\").Select\nColumns(\"A:D\").EntireColumn.Select\nSet found = Selection.Find(What:=\"Release Date:\\n \", After:=ActiveCell, LookIn:= _\n    xlValues, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext _\n    , MatchCase:=False, SearchFormat:=False)\n\nIf Not found Is Nothing Then\nfound.Select\nActiveCell.Select\nSelection.Cut\n Range(\"F\" &amp; (ActiveCell.Row)).Select\nActiveSheet.Paste\nSet found = Nothing\nEnd If\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 1, "creation_date": 1466000642, "post_id": 37838038, "comment_id": 63137335, "body": "Welcome to the site!  Check out the <a href=\"http://stackoverflow.com/tour\">tour</a> for more info.  Would you please <a href=\"http://stackoverflow.com/posts/37838038/edit\">edit your question</a> to include the error message?  I can see off-hand that you shouldn&#39;t be changing <code>i</code> anywhere inside your <code>For</code> loop.  I think you wanted <code>j=j+1</code> in the <code>Do Until</code> loop, and I think you can remove the <code>i=0</code> at the end of the <code>For</code> loop."}, {"owner": {"reputation": 116, "user_id": 4153027, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fa775e0da83a15b363890244fb802dba?s=128&d=identicon&r=PG&f=1", "display_name": "Devin Trowbridge", "link": "https://stackoverflow.com/users/4153027/devin-trowbridge"}, "reply_to_user": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 1, "creation_date": 1466000997, "post_id": 37838038, "comment_id": 63137611, "body": "To add onto what @cxw said, right now you have an infinite loop since each time your run through your <code>For</code> loop <code>i</code> is set back to 0."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6426585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49b4d442422582ce93e204b6facf5b69?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6426585/max"}, "edited": false, "score": 0, "creation_date": 1466008526, "post_id": 37838934, "comment_id": 63142972, "body": "thank you, but it is not the answer to my problem. I need two indicators because the cells are in different orders inside the columns, so I need them to navigate in them to select the cells with the same name (in do until loop) and then to compare with if cycle if the other cells are identical and so write OK. could you think again about the answer?"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 1, "user_id": 6426585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49b4d442422582ce93e204b6facf5b69?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6426585/max"}, "edited": false, "score": 0, "creation_date": 1466008990, "post_id": 37838934, "comment_id": 63143253, "body": "This is exactly what the second <code>sub</code> does. Compare all to all. Except that there is no &quot;navigation&quot; in the code. Yet, the results are logged in column 16 (which is column P). You might want to check again the answer(s). Otherwise, please try to clarify a bit more (possibly with sample data and a screenshot of what the current data looks like and a mock-up of your final result)."}, {"owner": {"reputation": 1, "user_id": 6426585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49b4d442422582ce93e204b6facf5b69?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6426585/max"}, "edited": false, "score": 0, "creation_date": 1466009194, "post_id": 37838934, "comment_id": 63143351, "body": "first of all , the cells, Cells(2 + i, 3) = Cells(2 + j, 12) are composed by letters and numbers, is OK?"}, {"owner": {"reputation": 1, "user_id": 6426585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49b4d442422582ce93e204b6facf5b69?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6426585/max"}, "edited": false, "score": 0, "creation_date": 1466009354, "post_id": 37838934, "comment_id": 63143433, "body": "the second sub, I have tried right now, doesn&#39;t work, I mean NO outlet message and no words as results!"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 1, "user_id": 6426585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49b4d442422582ce93e204b6facf5b69?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6426585/max"}, "edited": false, "score": 0, "creation_date": 1466009717, "post_id": 37838934, "comment_id": 63143652, "body": "<code>the cells, Cells(2 + i, 3) = Cells(2 + j, 12) are composed by letters and numbers, is OK?</code> Yes."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 1, "user_id": 6426585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49b4d442422582ce93e204b6facf5b69?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6426585/max"}, "edited": false, "score": 0, "creation_date": 1466009800, "post_id": 37838934, "comment_id": 63143694, "body": "<code>the second sub, ... doesn&#39;t work</code> In that case please elaborate on your post as described above: include sample data, a screenshot of your current sheet, and a screenshot of the result (you are aiming for)."}, {"owner": {"reputation": 1, "user_id": 6426585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49b4d442422582ce93e204b6facf5b69?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6426585/max"}, "edited": false, "score": 0, "creation_date": 1466020098, "post_id": 37838934, "comment_id": 63149403, "body": "I inserr the photo of my example"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 1, "user_id": 6426585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49b4d442422582ce93e204b6facf5b69?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6426585/max"}, "edited": false, "score": 0, "creation_date": 1466022634, "post_id": 37838934, "comment_id": 63150725, "body": "The above code works flawlessly on the sample data you provided. Apparently, you have some cells which do not contain &quot;comparable&quot; data. For example, if some cells show something like <code>#DIV&#47;0!</code> or any other error then the above code will throw an error. Yet, since the provided data is without flaws, it works as intended."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 1, "user_id": 6426585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49b4d442422582ce93e204b6facf5b69?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6426585/max"}, "edited": false, "score": 0, "creation_date": 1466022868, "post_id": 37838934, "comment_id": 63150835, "body": "Here is an Excel file with your sample data and the above code: <a href=\"https://www.dropbox.com/s/dzxpicwzrmj9gcy/StackOverflow_Question_37838038.xlsm?dl=0\" rel=\"nofollow noreferrer\">dropbox.com/s/dzxpicwzrmj9gcy/&hellip;</a> You can verify that the code works correctly. This comment and the file will be removed within the next few days."}, {"owner": {"reputation": 1, "user_id": 6426585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49b4d442422582ce93e204b6facf5b69?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6426585/max"}, "edited": false, "score": 0, "creation_date": 1466071714, "post_id": 37838934, "comment_id": 63170142, "body": "I want that macro find the arrow where the name of cell in column J is identical to a cell of column A. after that if also, the value of the cell of column K (of the same arrow) is identical to the value of cell in column B of the other arrow where it is found the match, hence write OK in column P and in the same arrow of the match cell found of column J."}, {"owner": {"reputation": 1, "user_id": 6426585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49b4d442422582ce93e204b6facf5b69?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6426585/max"}, "edited": false, "score": 0, "creation_date": 1466072420, "post_id": 37838934, "comment_id": 63170631, "body": "for example, in my screenshot, only in P4 and in P5 macro has to write OK, because it saw that the values of cell K4 is identical (=5) to the value of colum B, where it is found the match of the same name of cells of columns J and A (in fact cells with name A- 1 S10 SX have cond1 equal to 5). the same for the other OK."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 1, "user_id": 6426585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49b4d442422582ce93e204b6facf5b69?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6426585/max"}, "edited": false, "score": 0, "creation_date": 1466075966, "post_id": 37838934, "comment_id": 63172803, "body": "You have all the code you asked for and even got a working solution (with sample data you provided). If you still have questions then you will probably have to face the fact that you require paid help. Here are some sites you might want to check out: <a href=\"https://www.freelancer.com/work/freelance-excel-vba/1/\" rel=\"nofollow noreferrer\">freelancer.com/work/freelance-excel-vba/1</a> or <a href=\"https://www.upwork.com/o/jobs/browse/skill/vba/\" rel=\"nofollow noreferrer\">upwork.com/o/jobs/browse/skill/vba</a> or <a href=\"http://www.guru.com/d/freelancers/q/vba/\" rel=\"nofollow noreferrer\">guru.com/d/freelancers/q/vba</a>"}, {"owner": {"reputation": 1, "user_id": 6426585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49b4d442422582ce93e204b6facf5b69?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6426585/max"}, "edited": false, "score": 0, "creation_date": 1466077191, "post_id": 37838934, "comment_id": 63173635, "body": "NO, your code is not working because it fails putting &quot;OK,match found in row 2&quot; in the wrong arrow, as I told you in the comment above"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 1, "user_id": 6426585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49b4d442422582ce93e204b6facf5b69?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6426585/max"}, "edited": false, "score": 0, "creation_date": 1466077923, "post_id": 37838934, "comment_id": 63174128, "body": "Once again, you should get some help because you (obviously) don&#39;t understand <b>YOUR</b> original code and what <code>OK, match found in row 2</code> means. It means that &quot;for the items in column <code>C</code>/<code>D</code> a match has been found in row 2 (for columns <code>L</code>/<code>M</code>). I don&#39;t know why you wrote your code like this. I just left it as it was. So, since in row 3 columns <code>C</code>/<code>D</code> correspond to row 2 in columns <code>L</code>/<code>M</code> you see in row 3 a reference to row 2. That&#39;s your original code and what you asked for."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 1, "user_id": 6426585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49b4d442422582ce93e204b6facf5b69?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6426585/max"}, "edited": false, "score": 0, "creation_date": 1466078047, "post_id": 37838934, "comment_id": 63174212, "body": "Maybe you want to change <code>.Cells(i, 16).Value2 = &quot;OK, match found in row &quot; &amp; j</code> to <code>.Cells(i, 6).Value2 = &quot;OK, match found in row &quot; &amp; j</code> to make your code clearer to yourself. Maybe you&#39;d prefer <code>.Cells(j, 16).Value2 = &quot;OK, match found in row &quot; &amp; i</code>? I don&#39;t know. That&#39;s for you to decide. But you can only do so if you actually understand what the code does. Clearly that&#39;s not the case. Therefore, I recommended above to get some professional help. The code works. What <b>you</b> want in the end if for <b>you</b> to adjust in <b>your</b> code (your requirements and your initial code)."}, {"owner": {"reputation": 1, "user_id": 6426585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49b4d442422582ce93e204b6facf5b69?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6426585/max"}, "edited": false, "score": 0, "creation_date": 1466084183, "post_id": 37838934, "comment_id": 63178853, "body": "I updated my first question with new image with the final result that I desider, I explain all what I want."}, {"owner": {"reputation": 1, "user_id": 6426585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49b4d442422582ce93e204b6facf5b69?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6426585/max"}, "edited": false, "score": 0, "creation_date": 1466120075, "post_id": 37838934, "comment_id": 63198642, "body": "why if I substitute same values in the columns, the macro not detect all the same match but only the first and then it stops?"}], "tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": false, "score": 1, "last_activity_date": 1466002487, "creation_date": 1466002487, "answer_id": 37838934, "question_id": 37838038, "link": "https://stackoverflow.com/questions/37838038/excel-vba-do-until-and-if-to-compare-string-cells/37838934#37838934", "title": "excel vba DO UNTIL and IF, to compare string cells", "body": "<p>I am not quite sure if you wish to compare row by row the columns <code>D</code>/<code>M</code> and <code>C</code>/<code>L</code> or if you are truly trying to compare all rows with all. Hence, I adjusted your code for both cases:</p>\n\n<pre><code>Option Explicit\n\nSub ComparisonRowByRow()\n\nDim i As Long\n\nWith ThisWorkbook.Worksheets(\"Sheet1\")\n    For i = 0 To 1109\n        If .Cells(2 + i, 3).Value2 = .Cells(2 + i, 12).Value2 And _\n            .Cells(2 + i, 4).Value2 = .Cells(2 + i, 13).Value2 Then\n                .Cells(2 + i, 16).Value2 = \"OK\"\n        End If\n    Next i\nEnd With\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Sub CompareAllWithAll()\n\nDim i As Long, j As Long\nDim lngLastRow As Long\n\nWith Application\n    .EnableEvents = False\n    .Calculation = xlCalculationManual\n    .ScreenUpdating = False\nEnd With\n\nWith ThisWorkbook.Worksheets(\"Sheet1\")\n    lngLastRow = .Cells.Find(\"*\", SearchDirection:=xlPrevious, SearchOrder:=xlByRows).Row\n    For i = 0 To 1109\n        .Cells(2 + i, 16).ClearContents\n        For j = 2 To lngLastRow\n            If .Cells(2 + i, 3).Value2 = .Cells(2 + j, 12).Value2 And _\n                .Cells(2 + i, 4).Value2 = .Cells(2 + j, 13).Value2 Then\n                    If .Cells(2 + i, 16).Value2 = vbNullString Then\n                        .Cells(2 + i, 16).Value2 = \"OK, match found in row \" &amp; j\n                    Else\n                        .Cells(2 + i, 16).Value2 = .Cells(2 + i, 16).Value2 &amp; \", \" &amp; j\n                    End If\n            End If\n        Next j\n    Next i\nEnd With\n\nWith Application\n    .Calculation = xlCalculationAutomatic\n    .ScreenUpdating = True\n    .EnableEvents = True\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>If you really wish to compare all rows with all then it is probably also of importance, where a matching row has been found. Hence, I added that to the code to log the matches.</p>\n\n<p>Keep in mind that the second <code>sub</code> is rather time consuming at the moment. If you have 1,109 rows then the code will run 1,109 * 1,109 times. That would equate to a little over 1.2 million iterations: comparing D2 with M2, M3, M4, M5, ... M1109, comparing D3 with M2, M3, M4, M5, M6, ... M1109, etc.</p>\n\n<p>To make this process faster I turned off <code>ScreenUpdating</code>, <code>Events</code>, and <code>Calculation</code>. Yet, there is a better / faster way with <code>arrays</code>. But I am not quite sure if you are familiar with arrays, therefore I kept your original coding. After all, we're trying to help you with <strong>your</strong> code (which you will have to update and maintain in the future).</p>\n"}], "owner": {"reputation": 1, "user_id": 6426585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49b4d442422582ce93e204b6facf5b69?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6426585/max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1698, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1466084115, "creation_date": 1466000195, "last_edit_date": 1592644375, "question_id": 37838038, "link": "https://stackoverflow.com/questions/37838038/excel-vba-do-until-and-if-to-compare-string-cells", "title": "excel vba DO UNTIL and IF, to compare string cells", "body": "<p>Sub comparison()<br />\nj = 0</p>\n<pre><code>    For i = 0 To 1109\n        Do Until Cells(2 + i, 3) = Cells(2 + j, 12)\n            i = i + 1\n        Loop\n    \n        If Cells(2 + i, 4) = Cells(2 + j, 13) Then\n            Cells(2 + j, 16) = &quot;OK&quot;\n        End If\n    \n        i = 0\n        j = j + 1\n    Next i\nEnd Sub\n</code></pre>\n<p>I would like to write an &quot;OK&quot; if the cells in columns <code>D</code> and <code>M</code> are identical (instruction with <code>If</code>), only if the related name in columns <code>C</code> and <code>L</code> are identical (instruction with <code>Do Until</code>). So I want to do a comparison.<br />\nBut the name in the cells (inside <code>Do Until</code> loop) are formed by string of words. And Excel gives me an error related to the sentence of <code>DO UNTIL</code>.<br />\nCould you help me?</p>\n<h2>Update:</h2>\n<p>Here is some sample data:</p>\n<p><a href=\"https://i.stack.imgur.com/o44cm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/o44cm.png\" alt=\"enter image description here\" /></a></p>\n<p>THIS IS WHAT I WOULD FINALLY WANT\n<a href=\"https://i.stack.imgur.com/Todqu.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n<p>FOR SAME CELLS NAME (columns A and J),look at values of condition 1 (columns B and K) for each matching that is found and so finally written in column P ( and arrow equal to the one of the matching in MODEL 2) or OK (if values of cond1 are identical) or NO (if values od cond1 are different)</p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 2, "creation_date": 1466000220, "post_id": 37837967, "comment_id": 63137019, "body": "What is the error you get?  Have you confirmed that <code>sous</code> and <code>i</code> can never exceed the limit of a VBA Integer (32767)?  Without seeing examples of the data you are working with or even the error you are getting it&#39;s quite difficult to provide meaningful help"}, {"owner": {"reputation": 3, "user_id": 6469998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74618e94bf1b42e1bea5688051979ed1?s=128&d=identicon&r=PG&f=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/6469998/victor"}, "reply_to_user": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1466000724, "post_id": 37837967, "comment_id": 63137404, "body": "I enter in both cells 50 and 40 ,and i took car of witch one is the max and witch one is the min, so no they can&#39;t be out of limit. Here is the error : &quot; We&#39;ve closed Excel because we met a problem. Sorry for the inconvenient. Excel will try to take back your work unsaved but it may be lost.&quot; (something like that) No error number or something similar."}, {"owner": {"reputation": 6508, "user_id": 5962841, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qD8gs.jpg?s=128&g=1", "display_name": "Mafii", "link": "https://stackoverflow.com/users/5962841/mafii"}, "edited": false, "score": 0, "creation_date": 1466001582, "post_id": 37837967, "comment_id": 63138082, "body": "please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1466001666, "post_id": 37838396, "comment_id": 63138153, "body": "It might also be a good idea to check if the change that was made is relevant, i.e. if it was in Cells(4,3), Cells(4,2) or Column(4) (row 5+)"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 3, "last_activity_date": 1466001149, "creation_date": 1466001149, "answer_id": 37838396, "question_id": 37837967, "link": "https://stackoverflow.com/questions/37837967/vba-macro-crashing/37838396#37838396", "title": "VBA macro crashing", "body": "<p>You have to turn off events.  The reason Excel crashes is that the selection change event changes a value that fires the selection change event. It get's stuck in an endless loop.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Application.EnableEvents = False\n    Dim i As Integer\n    Dim sous As Integer\n    If Not IsEmpty(Cells(4, 2)) And IsNumeric(Cells(4, 2).Value) And Not IsEmpty(Cells(4, 3)) And IsNumeric(Cells(4, 3).Value) Then\n        For i = Cells(4, 3).Value To Cells(4, 2).Value\n            sous = i - Cells(4, 3).Value\n            Cells(5 + sous, 4).Value = i\n        Next i\n        MsgBox \"Yataaaah\"\n    End If\n\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6469998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74618e94bf1b42e1bea5688051979ed1?s=128&d=identicon&r=PG&f=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/6469998/victor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 37838396, "answer_count": 1, "score": 0, "last_activity_date": 1466001335, "creation_date": 1465999989, "last_edit_date": 1466001335, "question_id": 37837967, "link": "https://stackoverflow.com/questions/37837967/vba-macro-crashing", "title": "VBA macro crashing", "body": "<p>I try to create a macro, but when it launch itself, excel don't handle it and crash. </p>\n\n<p>Here is the macro:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim i As Integer\nDim sous As Integer\nIf Not IsEmpty(Cells(4, 2)) And IsNumeric(Cells(4, 2).Value) And Not IsEmpty(Cells(4, 3)) And IsNumeric(Cells(4, 3).Value) Then\n    For i = Cells(4, 3).Value To Cells(4, 2).Value\n        sous = i - Cells(4, 3).Value\n        Cells(5 + sous, 4).Value = i\n    Next i\nMsgBox \"Yataaaah\"\nEnd If\nEnd Sub\n</code></pre>\n\n<p>The problem is the line <code>Cells(5 + sous, 4).Value = i</code> because if I put it on comment, it work.</p>\n\n<p>Anyone have any idea why excel doesn't handle it?</p>\n\n<p>Thank you very much.\nPs: I'm on mac and I'm using Excel 15.19.1</p>\n"}, {"tags": ["vba", "excel", "filter"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 2, "last_activity_date": 1466001749, "creation_date": 1466001749, "answer_id": 37838632, "question_id": 37837916, "link": "https://stackoverflow.com/questions/37837916/how-can-i-copy-the-filtered-range-without-the-headers-and-paste-it-into-another/37838632#37838632", "title": "How can I copy the filtered range without the headers and paste it into another sheet?", "body": "<p>It's not pretty, but it's effective.</p>\n\n<pre><code>With ActiveSheet.AutoFilter.Range\n    .Offset(1, 0).Resize(.rows.Count - 1).Copy\nEnd With\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 415, "user_id": 2002558, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tDGtp.jpg?s=128&g=1", "display_name": "dra_red", "link": "https://stackoverflow.com/users/2002558/dra-red"}, "edited": false, "score": 0, "creation_date": 1571452724, "post_id": 44580187, "comment_id": 103256658, "body": "I expect this could go sideways if there was other data on the worksheet..."}], "tags": [], "owner": {"reputation": 11, "user_id": 7456765, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0Du2NX4z4_0/AAAAAAAAAAI/AAAAAAAAHSQ/jTS6egqarLI/photo.jpg?sz=128", "display_name": "Prince Mahen", "link": "https://stackoverflow.com/users/7456765/prince-mahen"}, "is_accepted": false, "score": 1, "last_activity_date": 1497583770, "last_edit_date": 1497583770, "creation_date": 1497582735, "answer_id": 44580187, "question_id": 37837916, "link": "https://stackoverflow.com/questions/37837916/how-can-i-copy-the-filtered-range-without-the-headers-and-paste-it-into-another/44580187#44580187", "title": "How can I copy the filtered range without the headers and paste it into another sheet?", "body": "<pre><code>ActiveSheet.UsedRange.Offset(1, 0).SpecialCells _\n    (xlCellTypeVisible).Copy\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 6316145, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/ea15e8fb821f09a4d0a1eb4105d07166?s=128&d=identicon&r=PG&f=1", "display_name": "Hags", "link": "https://stackoverflow.com/users/6316145/hags"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16131, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1497583770, "creation_date": 1465999857, "last_edit_date": 1531164843, "question_id": 37837916, "link": "https://stackoverflow.com/questions/37837916/how-can-i-copy-the-filtered-range-without-the-headers-and-paste-it-into-another", "title": "How can I copy the filtered range without the headers and paste it into another sheet?", "body": "<p>This is what I have so far, and would like to paste it into another sheet. </p>\n\n<pre><code>    Sheets(\"CDGL Data\").Select\n    Range(\"A1\").AutoFilter Field:=32, Criteria1:= _\n        \"*13725*\"\n    ActiveSheet.AutoFilter.Range.Copy\n</code></pre>\n\n<p>I don't want to copy the headers which start in A1</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 339644, "user_id": 118068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/077db5466d3b58e7bbbd498dca173f04?s=128&d=identicon&r=PG", "display_name": "Marc B", "link": "https://stackoverflow.com/users/118068/marc-b"}, "edited": false, "score": 0, "creation_date": 1465999831, "post_id": 37837821, "comment_id": 63136701, "body": "format is for display-only. it doesn&#39;t change the value stored in the field, it only changes what you see on-screen. you need to actually  modify the underlying value."}, {"owner": {"reputation": 49, "user_id": 6370006, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b6f58836e6e3d575a2fe798e45b2218?s=128&d=identicon&r=PG&f=1", "display_name": "Vigmo10", "link": "https://stackoverflow.com/users/6370006/vigmo10"}, "reply_to_user": {"reputation": 339644, "user_id": 118068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/077db5466d3b58e7bbbd498dca173f04?s=128&d=identicon&r=PG", "display_name": "Marc B", "link": "https://stackoverflow.com/users/118068/marc-b"}, "edited": false, "score": 0, "creation_date": 1465999946, "post_id": 37837821, "comment_id": 63136797, "body": "how can i do that to the value? maybe the round the seconds up or down? No idea. thanks for helping."}], "answers": [{"tags": [], "owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "is_accepted": true, "score": 2, "last_activity_date": 1466000326, "creation_date": 1466000326, "answer_id": 37838089, "question_id": 37837821, "link": "https://stackoverflow.com/questions/37837821/i-have-a-date-and-time-value-in-a-cell-and-i-want-to-make-the-seconds-as-00-how/37838089#37838089", "title": "I have a date and time value in a cell and i want to make the seconds as 00, how do i do it?", "body": "<p>The easier way to achieve this:</p>\n\n<pre><code>Function DateWithZeroSeconds(MyDate As Date)\nDateWithZeroSeconds = Format(MyDate, \"dd/mm/yyyy h:m\") &amp; \":00\"\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 49, "user_id": 6370006, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b6f58836e6e3d575a2fe798e45b2218?s=128&d=identicon&r=PG&f=1", "display_name": "Vigmo10", "link": "https://stackoverflow.com/users/6370006/vigmo10"}, "edited": false, "score": 0, "creation_date": 1466003318, "post_id": 37838104, "comment_id": 63139352, "body": "Thanks for your solution. it does work but i found sgdva&#39;s solution more simpler to use match with."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1466000389, "creation_date": 1466000389, "answer_id": 37838104, "question_id": 37837821, "link": "https://stackoverflow.com/questions/37837821/i-have-a-date-and-time-value-in-a-cell-and-i-want-to-make-the-seconds-as-00-how/37838104#37838104", "title": "I have a date and time value in a cell and i want to make the seconds as 00, how do i do it?", "body": "<p>Select the cells you wish to convert and run this short macro:</p>\n\n<pre><code>Sub SecondKiller()\n    Dim d As Date, d2 As Date\n    For Each r In Selection\n        d = r.Value\n        r.Value = DateSerial(Year(d), Month(d), Day(d)) + TimeSerial(Hour(d), Minute(d), 0)\n    Next r\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1408, "user_id": 2900158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000652927227/picture?type=large", "display_name": "Patrick Lepelletier", "link": "https://stackoverflow.com/users/2900158/patrick-lepelletier"}, "is_accepted": false, "score": 0, "last_activity_date": 1466154113, "creation_date": 1466154113, "answer_id": 37877346, "question_id": 37837821, "link": "https://stackoverflow.com/questions/37837821/i-have-a-date-and-time-value-in-a-cell-and-i-want-to-make-the-seconds-as-00-how/37877346#37877346", "title": "I have a date and time value in a cell and i want to make the seconds as 00, how do i do it?", "body": "<p>An other way, format the Excel cell, and then show the seconds as 00's:</p>\n\n<pre><code>Sub FormatRange_AsDate(ByVal Rg As Range)\nWith Rg\n    .NumberFormat = \"d/m/yyyy h:mm:ss;@\" 'give the format to the cell , showing seconds\n    .Value = Format(.Value, \"d/m/yyyy h:m\") &amp; \":00\" 'changing the seconds to \"00\", don't use .value2\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 6370006, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b6f58836e6e3d575a2fe798e45b2218?s=128&d=identicon&r=PG&f=1", "display_name": "Vigmo10", "link": "https://stackoverflow.com/users/6370006/vigmo10"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 37838089, "answer_count": 3, "score": 0, "last_activity_date": 1466154113, "creation_date": 1465999602, "last_edit_date": 1531161705, "question_id": 37837821, "link": "https://stackoverflow.com/questions/37837821/i-have-a-date-and-time-value-in-a-cell-and-i-want-to-make-the-seconds-as-00-how", "title": "I have a date and time value in a cell and i want to make the seconds as 00, how do i do it?", "body": "<p>I have a cell value, for example\nA1 = 17/06/2016 19:00:46\ni want to change it to 17/06/2016 19:00:00\nso basically the seconds have to be 0 but i can not seem to be able to achieve that with the formatting. I did the format as dd/mm/yyyy hh:mm, but the seconds is still retaining.\ni will be using these values to match the values in a different sheet using Application.Match in vba. the different sheet has the seconds as 0, hence, to match it i need to be convert these to 0 seconds.\nThank you.</p>\n"}, {"tags": ["arrays", "vba"], "comments": [{"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1466000419, "post_id": 37837820, "comment_id": 63137170, "body": "Your data is currently held in arrays; you will need to loop over them to find what you are looking for.  You might want to consider a 2 dimensional array and store the site, name and url against a single element so everything stays tightly coupled."}, {"owner": {"reputation": 1701, "user_id": 5462074, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3081c0aa6736a12c971dd5f9e33bcb85?s=128&d=identicon&r=PG&f=1", "display_name": "Nanji Mange", "link": "https://stackoverflow.com/users/5462074/nanji-mange"}, "reply_to_user": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1466052222, "post_id": 37837820, "comment_id": 63159175, "body": "@Dave Can you please suggest me any other way than store in array which is better for filter. I can change my flow accordingly as I just started to work on it."}], "answers": [{"comments": [{"owner": {"reputation": 1701, "user_id": 5462074, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3081c0aa6736a12c971dd5f9e33bcb85?s=128&d=identicon&r=PG&f=1", "display_name": "Nanji Mange", "link": "https://stackoverflow.com/users/5462074/nanji-mange"}, "edited": false, "score": 0, "creation_date": 1466078492, "post_id": 37856481, "comment_id": 63174489, "body": "Thank you so much. Can you suggest me for this query? I have tried but didn&#39;t find solution. I want to list the <code>URL</code> of particular <code>Name</code> and particular <code>Site</code>. Example. <code>ABC</code> can have 2 <code>Facebook</code> accounts. So, list the <code>URL</code>s whose <code>Site</code> is <code>Facebook</code> and <code>Name</code> is <code>ABC</code>"}, {"owner": {"reputation": 1701, "user_id": 5462074, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3081c0aa6736a12c971dd5f9e33bcb85?s=128&d=identicon&r=PG&f=1", "display_name": "Nanji Mange", "link": "https://stackoverflow.com/users/5462074/nanji-mange"}, "edited": false, "score": 0, "creation_date": 1466079084, "post_id": 37856481, "comment_id": 63174918, "body": "I mean filter with 2 conditions. &quot;Facebook&quot; and &quot;ABC&quot;"}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "reply_to_user": {"reputation": 1701, "user_id": 5462074, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3081c0aa6736a12c971dd5f9e33bcb85?s=128&d=identicon&r=PG&f=1", "display_name": "Nanji Mange", "link": "https://stackoverflow.com/users/5462074/nanji-mange"}, "edited": false, "score": 0, "creation_date": 1466083298, "post_id": 37856481, "comment_id": 63178117, "body": "<code>If Instr(LCase(myArray(0,i)), &quot;facebook&quot;) &gt; 0 And Instr(LCase(myArray(1,i)), &quot;abc&quot;) &gt; 0 Then</code> will check both conditions for you"}, {"owner": {"reputation": 1701, "user_id": 5462074, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3081c0aa6736a12c971dd5f9e33bcb85?s=128&d=identicon&r=PG&f=1", "display_name": "Nanji Mange", "link": "https://stackoverflow.com/users/5462074/nanji-mange"}, "edited": false, "score": 1, "creation_date": 1466085558, "post_id": 37856481, "comment_id": 63179991, "body": "I have 7 columns in my case. I will replace 2 with 6 in your code for these lines: 1- Public myArray(2,0) As String. 2- ReDim Preserve myArray(2, UBound(myArray,2)+1). 3- For i = 0 to UBound(myArray, 2). Let me know If I am wrong."}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "reply_to_user": {"reputation": 1701, "user_id": 5462074, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3081c0aa6736a12c971dd5f9e33bcb85?s=128&d=identicon&r=PG&f=1", "display_name": "Nanji Mange", "link": "https://stackoverflow.com/users/5462074/nanji-mange"}, "edited": false, "score": 0, "creation_date": 1466091358, "post_id": 37856481, "comment_id": 63184385, "body": "I&#39;ve edited the answer to demonstrate the use of 7 columns.  There are still only 2 dimensions to the array (think of them as rows and columns)"}, {"owner": {"reputation": 1701, "user_id": 5462074, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3081c0aa6736a12c971dd5f9e33bcb85?s=128&d=identicon&r=PG&f=1", "display_name": "Nanji Mange", "link": "https://stackoverflow.com/users/5462074/nanji-mange"}, "edited": false, "score": 0, "creation_date": 1466146584, "post_id": 37856481, "comment_id": 63205597, "body": "It throws compile time error of <code>Array is already dimensioned</code> on this line in above code. <code>ReDim Preserve myArray(6, UBound(myArray,2)+1)</code>"}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "reply_to_user": {"reputation": 1701, "user_id": 5462074, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3081c0aa6736a12c971dd5f9e33bcb85?s=128&d=identicon&r=PG&f=1", "display_name": "Nanji Mange", "link": "https://stackoverflow.com/users/5462074/nanji-mange"}, "edited": false, "score": 0, "creation_date": 1466150067, "post_id": 37856481, "comment_id": 63207528, "body": "Forgot; the array has to be declared as dynamic in the first instance so that you can adjust its size as required later (although you can only ever increase the final dimension of an array).  See updated answer..."}, {"owner": {"reputation": 1701, "user_id": 5462074, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3081c0aa6736a12c971dd5f9e33bcb85?s=128&d=identicon&r=PG&f=1", "display_name": "Nanji Mange", "link": "https://stackoverflow.com/users/5462074/nanji-mange"}, "reply_to_user": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1466153683, "post_id": 37856481, "comment_id": 63209566, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/114923/discussion-between-nanji-mange-and-dave\">continue this discussion in chat</a>."}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "reply_to_user": {"reputation": 1701, "user_id": 5462074, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3081c0aa6736a12c971dd5f9e33bcb85?s=128&d=identicon&r=PG&f=1", "display_name": "Nanji Mange", "link": "https://stackoverflow.com/users/5462074/nanji-mange"}, "edited": false, "score": 0, "creation_date": 1466154485, "post_id": 37856481, "comment_id": 63210128, "body": "I can&#39;t get to the chat rooms from the office, sorry"}, {"owner": {"reputation": 1701, "user_id": 5462074, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3081c0aa6736a12c971dd5f9e33bcb85?s=128&d=identicon&r=PG&f=1", "display_name": "Nanji Mange", "link": "https://stackoverflow.com/users/5462074/nanji-mange"}, "edited": false, "score": 0, "creation_date": 1466154721, "post_id": 37856481, "comment_id": 63210287, "body": "I am not able to read the XML file. I could read before but I don&#39;t know why it is not working now. It loaded but not able to read. I have posted a different question with example: <a href=\"http://stackoverflow.com/questions/37877170/not-able-to-get-data-from-xml-file-in-vba\" title=\"not able to get data from xml file in vba\">stackoverflow.com/questions/37877170/&hellip;</a>"}], "tags": [], "owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "is_accepted": true, "score": 0, "last_activity_date": 1466150006, "last_edit_date": 1466150006, "creation_date": 1466072722, "answer_id": 37856481, "question_id": 37837820, "link": "https://stackoverflow.com/questions/37837820/how-to-filter-data-in-vba/37856481#37856481", "title": "How to filter data in VBA?", "body": "<p>Based on what you've said you want, I've amended your code and added comments to explain what I'm doing:</p>\n\n<pre><code>Set oXMLFile = CreateObject(\"Microsoft.XMLDOM\")\nXMLFileName = \"C:\\Users\\abc\\Desktop\\TestFiles\\TestData.xml\"\noXMLFile.Load (XMLFileName)\n\nSet Sites = oXMLFile.SelectNodes(\"TestClass/TestObject/Site/text()\")\nSet Names = oXMLFile.SelectNodes(\"TestClass/TestObject/Name/text()\")\nSet URLs = oXMLFile.SelectNodes(\"TestClass/TestObject/URL/text()\")\n\nPublic myArray() As String  ' declare array as dynamic so we can amend its size\nReDim myArray(6,0) ' reset it to be 2 dimensional \n\nFor i = 0 To (Sites.Length - 1)\n    myArray(0,i) = Sites(i).NodeValue ' Column 1 of the array contains Sites\n    myArray(1,i) = Names(i).NodeValue ' Column 2 of the array contains Names\n    myArray(2,i) = URLs(i).NodeValue  ' Column 3 of the array contains URLs\n    myArray(3,i) = URLs(i).NodeValue  ' Column 4 of the array contains URLs\n    myArray(4,i) = URLs(i).NodeValue  ' Column 5 of the array contains URLs\n    myArray(5,i) = URLs(i).NodeValue  ' Column 6 of the array contains URLs\n    myArray(6,i) = URLs(i).NodeValue  ' Column 7 of the array contains URLs\n    ReDim Preserve myArray(6, UBound(myArray,2)+1) ' increase the size of the array dynamically to include an extra \"row\" of data\nNext\n' Now you can loop through and search for anything you want, like so:\nFor i = 0 to UBound(myArray, 2) ' loop through all the \"rows\" of the array\n    If Instr(LCase(myArray(0,i)), \"facebook\") &gt; 0 Then ' If the site contains facebook\n        myName = myArray(1, i) ' returns the associated name for the Site\n        myURL = myArray(2, i) ' returns the associated URL for the Site\n        ' Do whatever you need with this info then let the loop continue through the rest of the rows or use an Exit For statement to break the loop\n    End If\nNext\n</code></pre>\n"}], "owner": {"reputation": 1701, "user_id": 5462074, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3081c0aa6736a12c971dd5f9e33bcb85?s=128&d=identicon&r=PG&f=1", "display_name": "Nanji Mange", "link": "https://stackoverflow.com/users/5462074/nanji-mange"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 37856481, "answer_count": 1, "score": 0, "last_activity_date": 1466150006, "creation_date": 1465999602, "question_id": 37837820, "link": "https://stackoverflow.com/questions/37837820/how-to-filter-data-in-vba", "title": "How to filter data in VBA?", "body": "<p>I am working on a AddIn which is based on VBA. I import data from XML file. I want to apply filter on that data. I don't know how can I store and organize data. </p>\n\n<p>XML File:</p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;TestClass&gt;\n  &lt;TestObject&gt;\n    &lt;Site&gt;Facebook&lt;/Site&gt;\n    &lt;Name&gt;ABC&lt;/Name&gt;\n    &lt;URL&gt;https://www.facebook.com/ABC/&lt;/URL&gt;\n  &lt;/TestObject&gt;\n  &lt;TestObject&gt;\n    &lt;Site&gt;Facebook&lt;/Site&gt;\n    &lt;Name&gt;XYZ&lt;/Name&gt;\n    &lt;URL&gt;https://www.facebook.com/XYZ/&lt;/URL&gt;\n  &lt;/TestObject&gt;\n  &lt;TestObject&gt;\n    &lt;Site&gt;Twitter&lt;/Site&gt;\n    &lt;Name&gt;ABC&lt;/Name&gt;\n    &lt;URL&gt;https://www.twitter.com/ABC/&lt;/URL&gt;\n  &lt;/TestObject&gt;\n  &lt;TestObject&gt;\n    &lt;Site&gt;Facebook&lt;/Site&gt;\n    &lt;Name&gt;XYZ&lt;/Name&gt;\n    &lt;URL&gt;https://www.twitter.com/XYZ/&lt;/URL&gt;\n  &lt;/TestObject&gt;\n&lt;/TestClass&gt;\n</code></pre>\n\n<p>Here is my code.</p>\n\n<pre><code>Set oXMLFile = CreateObject(\"Microsoft.XMLDOM\")\nXMLFileName = \"C:\\Users\\abc\\Desktop\\TestFiles\\TestData.xml\"\noXMLFile.Load (XMLFileName)\n\nSet Sites = oXMLFile.SelectNodes(\"TestClass/TestObject/Site/text()\")\nSet Names = oXMLFile.SelectNodes(\"TestClass/TestObject/Name/text()\")\nSet URLs = oXMLFile.SelectNodes(\"TestClass/TestObject/URL/text()\")\n\nPublic SiteArray(100) As String \nPublic NameArray(100) As String \nPublic URLArray(100) As String \n\nFor i = 0 To (Sites.Length - 1)\n    SiteArray(i) = Sites(i).NodeValue\n    NameArray(i) = Names(i).NodeValue\n    URLArray(i) = URLs(i).NodeValue\nNext\n</code></pre>\n\n<p>Now I don't know how to get list of <code>Name</code> where Site is <code>Facebook</code>. I also want to get list of <code>URL</code> of <code>Twitter</code>.</p>\n\n<p>Can anybody please suggest me mechanism for filtering in above case?</p>\n"}, {"tags": ["sql-server", "ms-access", "vba", "linked-tables"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1466002350, "post_id": 37837817, "comment_id": 63138639, "body": "If <code>tdfLinked</code> is newly created, why would you even want to do <code>tdfLinked.RefreshLink</code>?"}, {"owner": {"reputation": 23176, "user_id": 18149, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f5e10278b9b6a518d5835f658704d85f?s=128&d=identicon&r=PG", "display_name": "leeand00", "link": "https://stackoverflow.com/users/18149/leeand00"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1466002559, "post_id": 37837817, "comment_id": 63138794, "body": "Oh, that&#39;s because it already exists.  I&#39;m re-linking it."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 1, "creation_date": 1466002610, "post_id": 37837817, "comment_id": 63138832, "body": "You are overcomplicating this. There is no reason to delete the linked table, just set the new/revised Connect and do a RefreshLink."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1466002779, "post_id": 37837817, "comment_id": 63138939, "body": "Maybe I misread your code, but it looks to me like you&#39;re deleting the link and then recreating it (<code>CreateTableDef</code>) with the updated connection information.  If you just change the <code>.Connect</code> property of an existing link, as Gustav suggested, then you would call <code>RefreshLink</code> to signal Access that it needs to update the metadata it stores about the linked table."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1466002786, "post_id": 37837817, "comment_id": 63138948, "body": "Try, this out. CurrentDB.TableDefs(TableName).RefreshLink instead. Also are you sure you are adding the fields with the append?"}, {"owner": {"reputation": 23176, "user_id": 18149, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f5e10278b9b6a518d5835f658704d85f?s=128&d=identicon&r=PG", "display_name": "leeand00", "link": "https://stackoverflow.com/users/18149/leeand00"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1466005951, "post_id": 37837817, "comment_id": 63141283, "body": "@HansUp Thanks!  Your answer here: <a href=\"http://stackoverflow.com/a/35802278/18149\">stackoverflow.com/a/35802278/18149</a> combined with the code above seems as though it fixed the issue."}], "answers": [{"comments": [{"owner": {"reputation": 23176, "user_id": 18149, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f5e10278b9b6a518d5835f658704d85f?s=128&d=identicon&r=PG", "display_name": "leeand00", "link": "https://stackoverflow.com/users/18149/leeand00"}, "edited": false, "score": 0, "creation_date": 1466004787, "post_id": 37839118, "comment_id": 63140425, "body": "I&#39;m connecting to a database outside the one being relinked.  The above code seems to entail that it&#39;s connecting to one locally, where the module being run is inside that <code>.mdb</code> file.  The one I&#39;m connecting to does not contain the module, it&#39;s being called from a seperate <code>.mdb</code>"}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 1, "last_activity_date": 1466002989, "creation_date": 1466002989, "answer_id": 37839118, "question_id": 37837817, "link": "https://stackoverflow.com/questions/37837817/why-does-this-vba-table-relink-code-result-in-error-3219/37839118#37839118", "title": "Why does this vba table relink code result in error 3219?", "body": "<p>Here's a proven example you should be able to adopt:</p>\n\n<pre><code>Public Function AttachSqlServer( _\n    ByVal Hostname As String, _\n    ByVal Database As String, _\n    ByVal Username As String, _\n    ByVal Password As String) _\n    As Boolean\n\n' Attach all tables linked via ODBC to SQL Server or Azure SQL.\n' 2016-04-24. Cactus Data ApS, CPH.\n\n    Const cstrQuery1    As String = \"_Template\"\n    Const cstrQuery2    As String = \"_TemplateRead\"\n    Const cstrQuery3    As String = \"VerifyConnection\"\n\n    Const cstrDbType    As String = \"ODBC\"\n    Const cstrAcPrefix  As String = \"dbo_\"\n\n    Dim dbs             As DAO.Database\n    Dim tdf             As DAO.TableDef\n    Dim strConnect      As String\n    Dim strName         As String\n\n    On Error GoTo Err_AttachSqlServer\n\n    Set dbs = CurrentDb\n    strConnect = ConnectionString(Hostname, Database, Username, Password)\n\n    For Each tdf In dbs.TableDefs\n        strName = tdf.Name\n        If Asc(strName) &lt;&gt; Asc(\"~\") Then\n            If InStr(tdf.Connect, cstrDbType) = 1 Then\n                If Left(strName, Len(cstrAcPrefix)) = cstrAcPrefix Then\n                    tdf.Name = Mid(strName, Len(cstrAcPrefix) + 1)\n                End If\n                tdf.Connect = strConnect\n                tdf.RefreshLink\n                Debug.Print Timer, tdf.Name, tdf.SourceTableName, tdf.Connect\n                DoEvents\n            End If\n        End If\n    Next\n    dbs.QueryDefs(cstrQuery1).Connect = strConnect\n    dbs.QueryDefs(cstrQuery2).Connect = strConnect\n    dbs.QueryDefs(cstrQuery3).Connect = strConnect\n    Debug.Print \"Done!\"\n\n    AttachSqlServer = True\n\nExit_AttachSqlServer:\n    Set tdf = Nothing\n    Set dbs = Nothing\n    Exit Function\n\nErr_AttachSqlServer:\n    Call ErrorMox\n    Resume Exit_AttachSqlServer\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 23176, "user_id": 18149, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f5e10278b9b6a518d5835f658704d85f?s=128&d=identicon&r=PG", "display_name": "leeand00", "link": "https://stackoverflow.com/users/18149/leeand00"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1100, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1466002989, "creation_date": 1465999594, "last_edit_date": 1466001872, "question_id": 37837817, "link": "https://stackoverflow.com/questions/37837817/why-does-this-vba-table-relink-code-result-in-error-3219", "title": "Why does this vba table relink code result in error 3219?", "body": "<p>I'm trying to relink tables in an MS Access database separate from the one the code below runs in; this way I can use the repairing db as \"patch\" of sorts...</p>\n\n<p>I've modified the code I found <a href=\"https://improvingsoftware.com/2009/10/15/code-snippet-quickly-link-sql-server-tables-in-access/\" rel=\"nofollow\">here</a>, so that it relinks the tables in a database opened by the \"repairing / patch database\"</p>\n\n<p>Before I run the code I make sure both databases are open so that one can repair the other to make it easier to automate the application of the fix.</p>\n\n<p>However when I run the code, when I get to the line reads <code>tdfLinked.RefeshLink</code>, which refreshes the linked table, I get an <code>Runtime error '3219' Invalid Operation</code> error.</p>\n\n<pre><code>Sub FixDB()\n\n    Call LinkTable(\"somelinkedTble\", \"SOMESERVER\\NAMED_SQL_INST32\", \"Database1\", \"Some_Schema.somelinkedTble\", True)\n\nEnd Sub\n\nFunction LinkTable(LinkedTableAlias As String, Server As String, database As String, SourceTableName As String, OverwriteIfExists As Boolean)\n    'This method will also update the link if the underlying table definition has been modified.\n\n    'The overwrite parameter will cause it to re-map/refresh the link for LinktedTable Alias, but only if it was already a linked table.\n    ' it will not overwrite an existing query or local table with the name specified in LinkedTableAlias.\n\n    ' Begin: Bit that I modified to access the database that needs fixed.\n    Dim objAccess As Access.application\n    Dim loginInfo As New AuthInfoz\n\n    loginInfo.workgroup = \"E:\\Tickets\\Fix\\SEC\\Secured.mdw\"\n    loginInfo.username = \"someuser\"\n    loginInfo.password = \"********\"\n    loginInfo.dbs = \"E:\\Tickets\\Fix\\Report.mdb\"\n\n    Set objAccess = GetObject(loginInfo.dbs).application\n\n    'Links to a SQL Server table without the need to set up a DSN in the ODBC Console.\n    Dim dbsCurrent As database\n    Dim tdfLinked As TableDef\n\n    ' Open a database to which a linked table can be appended.\n    Set dbsCurrent = objAccess.CurrentDb\n\n    ' END: Bit that I modified to access the external database.\n\n    'Check for and deal with the scenario ofthe table alias already existing\n    If TableNameInUse(LinkedTableAlias) Then\n\n        If (Not OverwriteIfExists) Then\n            Debug.Print \"Can't use name '\" + LinkedTableAlias + \"' because it would overwrite existing table.\"\n            Exit Function\n        End If\n\n        'delete existing table, but only if it is a linked table\n        If IsLinkedTable(LinkedTableAlias) Then\n            dbsCurrent.TableDefs.Delete LinkedTableAlias\n            dbsCurrent.TableDefs.Refresh\n        Else\n            Debug.Print \"Can't use name '\" + LinkedTableAlias + \"' because it would overwrite an existing query or local table.\"\n            Exit Function\n        End If\n    End If\n\n    'Create a linked table\n    Set tdfLinked = dbsCurrent.CreateTableDef(LinkedTableAlias)\n    tdfLinked.SourceTableName = SourceTableName\n    tdfLinked.Connect = \"ODBC;DRIVER={SQL Server};SERVER=\" &amp; Server &amp; \";DATABASE=\" &amp; database &amp; \";TRUSTED_CONNECTION=yes;\"\n\n    On Error Resume Next\n    dbsCurrent.TableDefs.Append tdfLinked\n    If (Err.Number = 3626) Then 'too many indexes on source table for Access\n            Err.Clear\n            On Error GoTo 0\n\n            If LinkTable(LinkedTableAlias, Server, database, \"vw\" &amp; SourceTableName, OverwriteIfExists) Then\n                Debug.Print \"Can't link directly to table '\" + SourceTableName + \"' because it contains too many indexes for Access to handle. Linked to view '\" &amp; \"vw\" &amp; SourceTableName &amp; \"' instead.\"\n                LinkTable = True\n            Else\n                Debug.Print \"Can't link table '\" + SourceTableName + \"' because it contains too many indexes for Access to handle. Create a view named '\" &amp; \"vw\" &amp; SourceTableName &amp; \"' that selects all rows/columns from '\" &amp; SourceTableName &amp; \"' and try again to circumvent this.\"\n                LinkTable = False\n            End If\n            Exit Function\n    End If\n    On Error GoTo 0\n\n    tdfLinked.RefreshLink\n    LinkTable = True\n\nEnd Function\n\nFunction BuildSQLConnectionString(Server As String, DBName As String) As String\n    BuildSQLConnectionString = \"Driver={SQL Server};Server=\" &amp; Server &amp; \";Database=\" &amp; DBName &amp; \";TRUSTED_CONNECTION=yes;\"\nEnd Function\n\nFunction TableNameInUse(TableName As String) As Boolean\n    'check for local tables, linked tables and queries (they all share the same namespace)\n    TableNameInUse = DCount(\"*\", \"MSYSObjects\", \"(Type = 4 or type=1 or type=5) AND [Name]='\" &amp; TableName &amp; \"'\") &gt; 0\nEnd Function\n\nFunction IsLinkedTable(TableName As String) As Boolean\n    IsLinkedTable = DCount(\"*\", \"MSYSObjects\", \"(Type = 4) AND [Name]='\" &amp; TableName &amp; \"'\") &gt; 0\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "date", "format"], "comments": [{"owner": {"reputation": 339644, "user_id": 118068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/077db5466d3b58e7bbbd498dca173f04?s=128&d=identicon&r=PG", "display_name": "Marc B", "link": "https://stackoverflow.com/users/118068/marc-b"}, "edited": false, "score": 0, "creation_date": 1465999730, "post_id": 37837753, "comment_id": 63136627, "body": "simple: don&#39;t let vba GUESS what your input it. parse it properly to a standard datetime object, then format from that."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6089076"}, "reply_to_user": {"reputation": 339644, "user_id": 118068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/077db5466d3b58e7bbbd498dca173f04?s=128&d=identicon&r=PG", "display_name": "Marc B", "link": "https://stackoverflow.com/users/118068/marc-b"}, "edited": false, "score": 0, "creation_date": 1465999911, "post_id": 37837753, "comment_id": 63136765, "body": "Sorry, how would I go about doing that? Surely, there must be a formatting trick I am missing?"}], "answers": [{"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": true, "score": 0, "last_activity_date": 1466002998, "last_edit_date": 1466002998, "creation_date": 1466002203, "answer_id": 37838812, "question_id": 37837753, "link": "https://stackoverflow.com/questions/37837753/converting-mmm-yy-to-dd-mm-yyy/37838812#37838812", "title": "converting &quot;mmm-yy&quot; to &quot;dd/mm/yyy&quot;", "body": "<pre><code>Function ChangeDate(strInput As String) As Date\n\n\nDim iYear, iMonth    \n\niYear = CInt(Split(strInput, \"-\")(1))\niMonth = Month(\"01/\" &amp; Format(Split(strInput, \"-\")(0), \"mmmm\"))\n\nChangeDate= DateSerial(iYear, iMonth, 1)\n\nEnd Function\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6089076"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1548, "favorite_count": 0, "accepted_answer_id": 37838812, "answer_count": 1, "score": 0, "last_activity_date": 1466002998, "creation_date": 1465999453, "question_id": 37837753, "link": "https://stackoverflow.com/questions/37837753/converting-mmm-yy-to-dd-mm-yyy", "title": "converting &quot;mmm-yy&quot; to &quot;dd/mm/yyy&quot;", "body": "<p>Does anyone have any idea how to convert a date formatted \"mmm-yy\" (in a ComboBox)to \"dd/mm/yyyy\". I have tried:</p>\n\n<pre><code> Format(Me.ComboBox5.Value, \"dd/mm/yyyy\")\n</code></pre>\n\n<p>But, VBA's interpretation of this causes the month and year to become the day and month and the year is then taken as 2016. For example Mar-12 becomes 12/03/2016.\nThanks so much in advance</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1465999229, "post_id": 37837541, "comment_id": 63136235, "body": "You want to find the last row of data on the sheet (or column) or count the number of cells that do not contain data (which could be different from the last row containing data)? <a href=\"http://stackoverflow.com/questions/28769061/select-last-cell-in-a-column-with-blanks\" title=\"select last cell in a column with blanks\">stackoverflow.com/questions/28769061/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 698, "user_id": 3191764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44be94e3b3d77c9f14b41b1d1c5fa66b?s=128&d=identicon&r=PG", "display_name": "Alex D", "link": "https://stackoverflow.com/users/3191764/alex-d"}, "edited": false, "score": 0, "creation_date": 1466000123, "post_id": 37837721, "comment_id": 63136944, "body": "@John you shouldn&#39;t need to loop through the rows anymore, as this code assigns LastRow as the number of the last row. So just add two to this number to give you the number where you want to paste your data."}, {"owner": {"reputation": 183, "user_id": 6287414, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b9a239e410b39e8d24668f8ae2d28f90?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/6287414/john"}, "edited": false, "score": 0, "creation_date": 1466000228, "post_id": 37837721, "comment_id": 63137026, "body": "how can i edit my code ? i dont understand. your code works fine, but i dont know how can i use it to paste my copied data."}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 1, "creation_date": 1466000611, "post_id": 37837721, "comment_id": 63137310, "body": "For i = 22 To Range(&quot;B&quot; &amp; .Rows.Count).End(xlUp).Row"}], "tags": [], "owner": {"reputation": 698, "user_id": 3191764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44be94e3b3d77c9f14b41b1d1c5fa66b?s=128&d=identicon&r=PG", "display_name": "Alex D", "link": "https://stackoverflow.com/users/3191764/alex-d"}, "is_accepted": true, "score": 1, "last_activity_date": 1465999344, "creation_date": 1465999344, "answer_id": 37837721, "question_id": 37837541, "link": "https://stackoverflow.com/questions/37837541/finding-the-number-of-non-empty-cells-and-paste-copied-data-just-after/37837721#37837721", "title": "Finding the number of non empty cells and paste copied data just after", "body": "<p>To find the last row in the column you can use this code:</p>\n\n<pre><code>With Sheets(\"Sheet1\")\n    LastRow = .Range(\"B\" &amp; .Rows.Count).End(xlUp).Row\nEnd With\n</code></pre>\n\n<p>And then just add two rows to the range for when you want to paste it.</p>\n"}], "owner": {"reputation": 183, "user_id": 6287414, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b9a239e410b39e8d24668f8ae2d28f90?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/6287414/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 37837721, "answer_count": 1, "score": 0, "last_activity_date": 1465999344, "creation_date": 1465998855, "last_edit_date": 1531164843, "question_id": 37837541, "link": "https://stackoverflow.com/questions/37837541/finding-the-number-of-non-empty-cells-and-paste-copied-data-just-after", "title": "Finding the number of non empty cells and paste copied data just after", "body": "<p>i write a sub to find the number of non empty cells :</p>\n\n<pre><code>Sub test()\n\n        Dim i, mynumber As Integer\n\n        For i = 22 To 500\n            If Cells(i, 2).Value &lt;&gt; 0 Then mynumber = mynumber + 1\n        Next i\n\n    End Sub\n</code></pre>\n\n<p>For example when I execute this code, i got mynumber=8, sometimes i got mynumber21, etc,...</p>\n\n<p>I copied a data and i want to paste them two rows after the number of non empty cells (that is why I wrote this code).</p>\n\n<p>I am stuck here.</p>\n"}, {"tags": ["vba", "excel", "listview", "checkbox"], "answers": [{"comments": [{"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "reply_to_user": {"reputation": 2073, "user_id": 4591111, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/62089c80204c2d11acf86f9ca66f93d9?s=128&d=identicon&r=PG&f=1", "display_name": "yuro", "link": "https://stackoverflow.com/users/4591111/yuro"}, "edited": false, "score": 0, "creation_date": 1466002470, "post_id": 37837494, "comment_id": 63138729, "body": "Did you try ListView.Checkbox.Visible= False? <a href=\"http://www.vbforums.com/showthread.php?695161-Checkbox-in-listview\" rel=\"nofollow noreferrer\">More info here</a>"}, {"owner": {"reputation": 2073, "user_id": 4591111, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/62089c80204c2d11acf86f9ca66f93d9?s=128&d=identicon&r=PG&f=1", "display_name": "yuro", "link": "https://stackoverflow.com/users/4591111/yuro"}, "edited": false, "score": 0, "creation_date": 1466002622, "post_id": 37837494, "comment_id": 63138838, "body": "this is not available in excel 2010"}], "tags": [], "owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "is_accepted": false, "score": 0, "last_activity_date": 1465999671, "last_edit_date": 1465999671, "creation_date": 1465998745, "answer_id": 37837494, "question_id": 37837307, "link": "https://stackoverflow.com/questions/37837307/how-to-disable-checkboxes-in-a-listview-vba/37837494#37837494", "title": "How to disable checkboxes in a ListView (VBA)", "body": "<p>The following is to hide the Checkbox and set the value to default (if you don't unload the form or user was available to click it <em>prior to analyze if it should be hidden with no valid selection</em>)</p>\n\n<pre><code>CheckBox.Visible = False\nCheckBox.Value = False\n</code></pre>\n"}], "owner": {"reputation": 2073, "user_id": 4591111, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/62089c80204c2d11acf86f9ca66f93d9?s=128&d=identicon&r=PG&f=1", "display_name": "yuro", "link": "https://stackoverflow.com/users/4591111/yuro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 511, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1465999671, "creation_date": 1465998339, "last_edit_date": 1531164843, "question_id": 37837307, "link": "https://stackoverflow.com/questions/37837307/how-to-disable-checkboxes-in-a-listview-vba", "title": "How to disable checkboxes in a ListView (VBA)", "body": "<p>In my UserForm I initialize a ListView with data from database:</p>\n\n<p>This is just a code snippet:</p>\n\n<pre><code>While Not rsRL.EOF\n  If rsRL(\"Status\").Value = 1 Then\n     .ListItems.Add , , rsRL(\"ID\")\n     .ListItems(.ListItems.Count).tag = rsRL(\"RL_Status\")\n  Else\n    // Here I want to disable the checkbox of the corresponding data            \n  End If\n  .ListItems(.ListItems.Count).ListSubItems.Add , , rsRL(\"Name\")\n  .ListItems(.ListItems.Count).ListSubItems.Add , , rsRL(\"Datum\")\n  .ListItems(.ListItems.Count).ListSubItems.Add , , rsRL(\"Typ\")\n\n  If rsRL(\"RL_Status\").Value = True Then\n      .ListItems(.ListItems.Count).Checked = True\n  End If\n  rsRL.MoveNext\nWend\n</code></pre>\n\n<p>In else-sector I just want to display the ID without the checkbox or to disable the checkbox so that it is not clickable! How can I achieve this?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 2, "creation_date": 1465998736, "post_id": 37837298, "comment_id": 63135852, "body": "You can set a value in, say, a hidden sheet after you fill out the questionnaire. You can check this sheet for a value on load, if it has a value you&#39;ll know the form has been filled out before."}, {"owner": {"reputation": 469, "user_id": 6460617, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b79714ce5873496cee2f060b7276343e?s=128&d=identicon&r=PG&f=1", "display_name": "petithomme", "link": "https://stackoverflow.com/users/6460617/petithomme"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1465999559, "post_id": 37837298, "comment_id": 63136502, "body": "Yeah good idea thanks"}], "answers": [{"comments": [{"owner": {"reputation": 469, "user_id": 6460617, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b79714ce5873496cee2f060b7276343e?s=128&d=identicon&r=PG&f=1", "display_name": "petithomme", "link": "https://stackoverflow.com/users/6460617/petithomme"}, "edited": false, "score": 0, "creation_date": 1465999042, "post_id": 37837510, "comment_id": 63136108, "body": "Yeah good idea. So basically a HiddeSheet is a sheet neither I or the user will have access to? Can I change the cell value say in A1 in that sheet when the user saves the file? @Alex"}, {"owner": {"reputation": 698, "user_id": 3191764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44be94e3b3d77c9f14b41b1d1c5fa66b?s=128&d=identicon&r=PG", "display_name": "Alex D", "link": "https://stackoverflow.com/users/3191764/alex-d"}, "reply_to_user": {"reputation": 469, "user_id": 6460617, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b79714ce5873496cee2f060b7276343e?s=128&d=identicon&r=PG&f=1", "display_name": "petithomme", "link": "https://stackoverflow.com/users/6460617/petithomme"}, "edited": false, "score": 0, "creation_date": 1465999117, "post_id": 37837510, "comment_id": 63136178, "body": "@petithomme yep, a sheet which you can hide and password lock. You&#39;ll have access to it, but the user will not see or know it&#39;s there. You can choose any cell for any kind of settings or data you want to keep."}, {"owner": {"reputation": 469, "user_id": 6460617, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b79714ce5873496cee2f060b7276343e?s=128&d=identicon&r=PG&f=1", "display_name": "petithomme", "link": "https://stackoverflow.com/users/6460617/petithomme"}, "edited": false, "score": 0, "creation_date": 1465999494, "post_id": 37837510, "comment_id": 63136460, "body": "Oh cool and I imagine that in the code you&#39;ve written below the sheet&#39;s name was &quot;HiddenSheet&quot;. So I can name it the way I want but insert the correct name in the code?"}, {"owner": {"reputation": 698, "user_id": 3191764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44be94e3b3d77c9f14b41b1d1c5fa66b?s=128&d=identicon&r=PG", "display_name": "Alex D", "link": "https://stackoverflow.com/users/3191764/alex-d"}, "reply_to_user": {"reputation": 469, "user_id": 6460617, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b79714ce5873496cee2f060b7276343e?s=128&d=identicon&r=PG&f=1", "display_name": "petithomme", "link": "https://stackoverflow.com/users/6460617/petithomme"}, "edited": false, "score": 0, "creation_date": 1465999528, "post_id": 37837510, "comment_id": 63136479, "body": "@petithomme Exactly."}, {"owner": {"reputation": 469, "user_id": 6460617, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b79714ce5873496cee2f060b7276343e?s=128&d=identicon&r=PG&f=1", "display_name": "petithomme", "link": "https://stackoverflow.com/users/6460617/petithomme"}, "edited": false, "score": 0, "creation_date": 1465999829, "post_id": 37837510, "comment_id": 63136699, "body": "Last question @Alex D    In your Cells(1, 1), the first one indicates the line or column?"}, {"owner": {"reputation": 698, "user_id": 3191764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44be94e3b3d77c9f14b41b1d1c5fa66b?s=128&d=identicon&r=PG", "display_name": "Alex D", "link": "https://stackoverflow.com/users/3191764/alex-d"}, "reply_to_user": {"reputation": 469, "user_id": 6460617, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b79714ce5873496cee2f060b7276343e?s=128&d=identicon&r=PG&f=1", "display_name": "petithomme", "link": "https://stackoverflow.com/users/6460617/petithomme"}, "edited": false, "score": 0, "creation_date": 1465999943, "post_id": 37837510, "comment_id": 63136795, "body": "@petithomme Cells(Row, Column)"}], "tags": [], "owner": {"reputation": 698, "user_id": 3191764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44be94e3b3d77c9f14b41b1d1c5fa66b?s=128&d=identicon&r=PG", "display_name": "Alex D", "link": "https://stackoverflow.com/users/3191764/alex-d"}, "is_accepted": true, "score": 0, "last_activity_date": 1465999559, "last_edit_date": 1465999559, "creation_date": 1465998787, "answer_id": 37837510, "question_id": 37837298, "link": "https://stackoverflow.com/questions/37837298/userform-to-only-appear-on-first-use-excel-vba/37837510#37837510", "title": "Userform to only appear on first use #excel-vba", "body": "<p>A common and easy way would be to have a hidden worksheet where you can use cells to store values after saves.</p>\n\n<pre><code>Private Sub Workbook_Open()\n    'Where HiddenSheet is the name of your hidden worksheet\n    If ActiveWorkbook.Sheets(\"HiddenSheet\").Cells(1, 1).Value = 0 Then\n        'Code to open the form\n    End If    \nEnd Sub\n</code></pre>\n\n<p>And then once the user has completed the question are you can alter the cell value so it doesn't open again.</p>\n\n<pre><code>ActiveWorkbook.Sheets(\"HiddenSheet\").Cells(1, 1).Value = 1\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 469, "user_id": 6460617, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b79714ce5873496cee2f060b7276343e?s=128&d=identicon&r=PG&f=1", "display_name": "petithomme", "link": "https://stackoverflow.com/users/6460617/petithomme"}, "edited": false, "score": 0, "creation_date": 1466000176, "post_id": 37837951, "comment_id": 63136983, "body": "Oh ok I&#39;ll check it out. Right now I&#39;m just using the protect the workbook function so users just don&#39;t have access before removing the protection first."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1466003179, "post_id": 37837951, "comment_id": 63139251, "body": "if you want to really hide the sheet, you can set its <code>Visible</code> property to <code>xlSheetVeryHidden</code> instead of  <code>False</code>"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1466003289, "post_id": 37837951, "comment_id": 63139331, "body": "I didn&#39;t know that, nice!"}], "tags": [], "owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "is_accepted": false, "score": 0, "last_activity_date": 1465999938, "creation_date": 1465999938, "answer_id": 37837951, "question_id": 37837298, "link": "https://stackoverflow.com/questions/37837298/userform-to-only-appear-on-first-use-excel-vba/37837951#37837951", "title": "Userform to only appear on first use #excel-vba", "body": "<p>I like using this statement in the worksheet I want to hide.</p>\n\n<pre><code>Private Sub Worksheet_Activate()\n    If ActiveSheet.Visible Then ActiveSheet.Visible = False\nEnd Sub\n</code></pre>\n\n<p>Basically the user can try and unhide the sheet, but it immediately hides it again. Of course you'll still need a password to protect the code, but I've found it helpful to prevent showing users information they don't need to worry about. </p>\n\n<p>Thought I'd add this as it seems to relate to part of the question. Hope it is helpful.</p>\n"}], "owner": {"reputation": 469, "user_id": 6460617, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b79714ce5873496cee2f060b7276343e?s=128&d=identicon&r=PG&f=1", "display_name": "petithomme", "link": "https://stackoverflow.com/users/6460617/petithomme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 781, "favorite_count": 0, "accepted_answer_id": 37837510, "answer_count": 2, "score": 1, "last_activity_date": 1465999938, "creation_date": 1465998326, "question_id": 37837298, "link": "https://stackoverflow.com/questions/37837298/userform-to-only-appear-on-first-use-excel-vba", "title": "Userform to only appear on first use #excel-vba", "body": "<p>So I made a questionnaire on excel that contains a userform when the workbook opens (so when you open excel). The userform makes the user choose the language he wants to use (French or English). My problem is that I would like the userform to only pop up the first time the user opens the file. So he opens the file, chooses the language, answers the questions and saves the file. I would like for him/her to not choose the language again if he re-opens the file.</p>\n\n<p>Is there a way to make the userform only appear on first use?</p>\n\n<p>If not, I'm thinking about changing the value in a certain box in the questionnaire when it opens and then link that value to the userform so it doesn't open the next time if the value has changed. I don't know if that's possible either.</p>\n\n<p>Thank you for your help,</p>\n\n<p>Vincent</p>\n"}, {"tags": ["excel", "vba", "loops", "statements"], "comments": [{"owner": {"reputation": 1230, "user_id": 4488318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eb0e9296a94c70973340799a7a951d1?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Evans", "link": "https://stackoverflow.com/users/4488318/joseph-evans"}, "edited": false, "score": 0, "creation_date": 1465998287, "post_id": 37837051, "comment_id": 63135534, "body": "I think a <code>GoTo</code> statement is exactly what you&#39;re looking for. If you don&#39;t set your values in the else so that the if statement will eventually pass it will loop forever."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1465999282, "post_id": 37837051, "comment_id": 63136281, "body": "You should probably rename <code>M8</code> to something meaningful. If you have <code>M7</code>, <code>M6</code>, <code>M5</code>, <code>M4</code>, <code>M3</code>, <code>M2</code> and <code>M1</code> as well, you probably need an array instead of numbered variables. Usually when you think &quot;I want something to repeat until a condition is met&quot; then what you need is a loop."}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1465999339, "post_id": 37837396, "comment_id": 63136321, "body": "The loop won&#39;t be endless. If <code>M8</code> is an <code>Integer</code> it will overflow when its value gets to 32768. It will take a little while longer if it&#39;s a <code>Long</code>, but it will eventually overflow."}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1465999882, "post_id": 37837396, "comment_id": 63136742, "body": "Didn&#39;t think of that to be honest, but I&#39;d still prefer to control its exit point myself, thanks for the clarification"}, {"owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "edited": false, "score": 0, "creation_date": 1466000561, "post_id": 37837396, "comment_id": 63137265, "body": "I upvoted this answers as a loop is the prefered/better method."}], "tags": [], "owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "is_accepted": false, "score": 2, "last_activity_date": 1465998537, "creation_date": 1465998537, "answer_id": 37837396, "question_id": 37837051, "link": "https://stackoverflow.com/questions/37837051/how-to-make-an-if-statement-repeat-itslef-if-it-goes-to-else/37837396#37837396", "title": "How to make an IF statement repeat itslef if it goes to else", "body": "<p>Don't use an <code>If</code>?  This would loop until the condition specified is no longer true; but as Gary noted above it's possible to get into an endless loop, so I've added an additional criteria to break the loop if it goes on for 100 iterations</p>\n\n<pre><code>iTried = 0\nWhile IsEmpty(Cells(8, M8 + 9).Value) And IsEmpty(Cells(12, M8 + 9).Value) = True And iTried &lt;=100\n    Sheets(\"Sheet3\").Cells(8, M8 + 9).Value = info\n    Sheets(\"Sheet3\").Cells(12, M8 + 9).Value = \"--------------\"\n    Sheets(\"Sheet3\").Range(Cells(8, M8 + 9), Cells(12, M8 + 9)).Interior.Color = RColor\n    M8 = M8 + 1\nWend\n' Now check WHY the loop ended... if the cells are empty and the counter is &gt;100 throw a msgbox\nIf IsEmpty(Cells(8, M8 + 9).Value) And IsEmpty(Cells(12, M8 + 9).Value) = True And iTried &gt;100 Then\n    MsgBox \"Too many tries; gave up!\"\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 2, "last_activity_date": 1466001673, "creation_date": 1466001673, "answer_id": 37838598, "question_id": 37837051, "link": "https://stackoverflow.com/questions/37837051/how-to-make-an-if-statement-repeat-itslef-if-it-goes-to-else/37838598#37838598", "title": "How to make an IF statement repeat itslef if it goes to else", "body": "<p>You need to come at this from the other direction.  If you need <code>M8</code> to meet a specific condition, make sure the condition is met <em>before</em> you do anything else:</p>\n\n<pre><code>Dim aborted As Boolean\nDo While Not (IsEmpty(Cells(8, M8 + 9).Value) And IsEmpty(Cells(12, M8 + 9).Value))\n    M8 = M8 + 1\n    If M8 &gt; 100 Then    'Or whatever your \"give up\" condition is\n        aborted = True\n        Exit Do\n    End If\nLoop\n\nIf Not aborted Then\n    Sheets(\"Sheet3\").Cells(8, M8 + 9).Value = info\n    Sheets(\"Sheet3\").Cells(12, M8 + 9).Value = \"--------------\"\n    Sheets(\"Sheet3\").Range(Cells(8, M8 + 9), Cells(12, M8 + 9)).Interior.Color = RColor\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 6436912, "user_type": "registered", "accept_rate": 11, "profile_image": "https://graph.facebook.com/10207660231361407/picture?type=large", "display_name": "Ghaith Haddad", "link": "https://stackoverflow.com/users/6436912/ghaith-haddad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1331, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1466001673, "creation_date": 1465997704, "last_edit_date": 1465999165, "question_id": 37837051, "link": "https://stackoverflow.com/questions/37837051/how-to-make-an-if-statement-repeat-itslef-if-it-goes-to-else", "title": "How to make an IF statement repeat itslef if it goes to else", "body": "<p>I have this piece of code:</p>\n\n<pre><code>If IsEmpty(Cells(8, M8 + 9).Value) And IsEmpty(Cells(12, M8 + 9).Value) Then\n    Sheets(\"Sheet3\").Cells(8, M8 + 9).Value = info\n    Sheets(\"Sheet3\").Cells(12, M8 + 9).Value = \"--------------\"\n    Sheets(\"Sheet3\").Range(Cells(8, M8 + 9), Cells(12, M8 + 9)).Interior.Color = RColor\n    M8 = M8 + 1\nElse\n    M8 = M8 + 1\nEnd If\n</code></pre>\n\n<p>I was wondering if there is a way that when the first condition is not met and goes to the <code>Else</code> branch to add 1 to the <code>M8</code> variable. When it adds 1 to <code>M8</code> I want it to go back to the top and repeat the if statement with the new value of <code>M8</code>.</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 1, "creation_date": 1465997815, "post_id": 37836937, "comment_id": 63135153, "body": "An Integer in VBA has maximum value of 32767 and minimum of -32768"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1465998202, "post_id": 37836937, "comment_id": 63135450, "body": "And for a <code>Long</code>, it&#39;s <code>2^31 - 1 = 2147483647</code>. AFAIK, there are no constants for that."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1465998329, "post_id": 37836937, "comment_id": 63135561, "body": "It should be noted that since we aren&#39;t using 16-bit environments anymore, it almost never makes sense to use Integer over Long."}, {"owner": {"reputation": 1445, "user_id": 6065909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59936064c95a62d283737b9e18ad95ae?s=128&d=identicon&r=PG&f=1", "display_name": "marlan", "link": "https://stackoverflow.com/users/6065909/marlan"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1465998536, "post_id": 37836937, "comment_id": 63135710, "body": "@Andre If I understand you correctly, an Integer in VBA in my Win10 will always consume 4 bite?"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 1445, "user_id": 6065909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59936064c95a62d283737b9e18ad95ae?s=128&d=identicon&r=PG&f=1", "display_name": "marlan", "link": "https://stackoverflow.com/users/6065909/marlan"}, "edited": false, "score": 3, "creation_date": 1465998613, "post_id": 37836937, "comment_id": 63135768, "body": "@marlan: No. Integer = 2 bytes. But unless you create gigantic arrays, memory isn&#39;t really an issue anymore. Overflow is."}, {"owner": {"reputation": 1445, "user_id": 6065909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59936064c95a62d283737b9e18ad95ae?s=128&d=identicon&r=PG&f=1", "display_name": "marlan", "link": "https://stackoverflow.com/users/6065909/marlan"}, "edited": false, "score": 0, "creation_date": 1465998981, "post_id": 37836937, "comment_id": 63136057, "body": "<a href=\"http://stackoverflow.com/questions/37831804/why-size-of-structure-does-not-change-when-use-24-bit-integer#comment63125306_37831804\">Here</a> is a discussion (from today) on the topic in Visual C++, padding memory etc. VBA would not pad an Integer to 32bit?"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 1445, "user_id": 6065909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59936064c95a62d283737b9e18ad95ae?s=128&d=identicon&r=PG&f=1", "display_name": "marlan", "link": "https://stackoverflow.com/users/6065909/marlan"}, "edited": false, "score": 0, "creation_date": 1466001355, "post_id": 37836937, "comment_id": 63137909, "body": "@marlan: Heh, good question. I always took the 2 bytes for granted. I suggest you try it out, allocating large arrays and watching the memory usage with Process Explorer."}, {"owner": {"reputation": 1445, "user_id": 6065909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59936064c95a62d283737b9e18ad95ae?s=128&d=identicon&r=PG&f=1", "display_name": "marlan", "link": "https://stackoverflow.com/users/6065909/marlan"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 2, "creation_date": 1466068819, "post_id": 37836937, "comment_id": 63168133, "body": "Ok @Andre here are my results: Before running code, MS Access Process consumed 12.8~9 MB. When running Dim intArr(100000) As Integer Process consumed 13.1 MB. When running Dim lngArr(100000) As Long Process consumed 13.3 MB. The above was tested some 3 times. <b>Conclusion: VBA doesn&#39;t pad integers in static integer arrays.</b>  As for combinations of ints and lngs, these are actually arrays of Variatns or Objects (=refferences), and it is tough to conclude\u2026"}], "answers": [{"tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 24, "last_activity_date": 1466001017, "last_edit_date": 1466001017, "creation_date": 1465998215, "answer_id": 37837253, "question_id": 37836937, "link": "https://stackoverflow.com/questions/37836937/is-there-a-constant-for-max-value-for-integer-type/37837253#37837253", "title": "Is there a constant for max value for integer type?", "body": "<p>VBA does not provide a <code>MAXINT</code> constant.  But you can derive that value easily:</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>MAXINT = (2 ^ 15) -1\nDebug.Print MAXINT\n 32767\n</code></pre>\n\n<p>Or you could define it as a <code>Public</code> constant with this in the Declarations section of a standard module:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Const MAXINT As Integer = (2 ^ 15) - 1\n</code></pre>\n\n<p>Then <code>MAXINT</code> would be available for the rest of your VBA code in that application.</p>\n\n<p>And for <code>Long Integer</code>, the maximum value is ...</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>MAXLONG = (2 ^ 31) -1\nDebug.Print MAXLONG\n 2147483647 \n</code></pre>\n"}], "owner": {"reputation": 769, "user_id": 4183164, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh3.googleusercontent.com/-K7IipjofWHE/AAAAAAAAAAI/AAAAAAAAAIQ/8I1mZB87a-4/photo.jpg?sz=128", "display_name": "MJH", "link": "https://stackoverflow.com/users/4183164/mjh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 20733, "favorite_count": 1, "accepted_answer_id": 37837253, "answer_count": 1, "score": 14, "last_activity_date": 1466001017, "creation_date": 1465997445, "last_edit_date": 1465998952, "question_id": 37836937, "link": "https://stackoverflow.com/questions/37836937/is-there-a-constant-for-max-value-for-integer-type", "title": "Is there a constant for max value for integer type?", "body": "<p>I'm searching for a constant like MAXINT in c, for VBA code. I found references only in other languages, and cannot find one for VBA.</p>\n\n<p>If there is no such constant what is the maximum number an int in VBA can hold?\nI tried 2147483647 but got an overflow error.</p>\n"}, {"tags": ["excel", "vba", "ms-office"], "comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1465997415, "post_id": 37836786, "comment_id": 63134852, "body": "Is there ever an instance where TOR_Tracker.Worksheets(&quot;Sheet1&quot;) doesn&#39;t exist? Also you can just put .Paste, the With already specifies the ActiveSheet."}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 1, "creation_date": 1465997745, "post_id": 37836786, "comment_id": 63135087, "body": "Avoid use of <code>.Select</code> and <code>ActiveSheet</code> where possible.  You don&#39;t really need to use either.  Set an object reference to the specific worksheet you want to use in the file and refer to that instead.  It&#39;s quicker and more reliable."}, {"owner": {"reputation": 55, "user_id": 3357487, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e26778ab272cfe7c3139b181fb2a4fc0?s=128&d=identicon&r=PG&f=1", "display_name": "electronicaneer", "link": "https://stackoverflow.com/users/3357487/electronicaneer"}, "reply_to_user": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1465997812, "post_id": 37836786, "comment_id": 63135149, "body": "I just edited my post, there are two ActiveSheet.Paste statements, and I am only having issues with the first one. @Dave, can you give an example of what you mean by setting an object reference to the specific worksheet?"}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 1, "creation_date": 1465998047, "post_id": 37836786, "comment_id": 63135344, "body": "<code>Set whiteboard = Whiteboard.Worksheets(&quot;Sheet1&quot;)</code> will allow you to refer to that worksheet anywhere in the code (well, anywhere it&#39;s in scope anyway) with <code>whiteboard</code>, e.g. <code>whiteboard.Range(&quot;A1&quot;).Value</code> would get you the content of A1 on the specified worksheet.  If nothing else it will make your code more readable"}, {"owner": {"reputation": 55, "user_id": 3357487, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e26778ab272cfe7c3139b181fb2a4fc0?s=128&d=identicon&r=PG&f=1", "display_name": "electronicaneer", "link": "https://stackoverflow.com/users/3357487/electronicaneer"}, "reply_to_user": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1465998943, "post_id": 37836786, "comment_id": 63136032, "body": "@Dave, ok that makes sense. How would I go about replacing .Select or .Selection?"}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 1, "creation_date": 1465999814, "post_id": 37836786, "comment_id": 63136689, "body": "See posted answer.  Let me know if it doesn&#39;t work, it&#39;s coded off the top of my head and I haven&#39;t had a chance to test it!"}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 3357487, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e26778ab272cfe7c3139b181fb2a4fc0?s=128&d=identicon&r=PG&f=1", "display_name": "electronicaneer", "link": "https://stackoverflow.com/users/3357487/electronicaneer"}, "edited": false, "score": 0, "creation_date": 1466001875, "post_id": 37837883, "comment_id": 63138317, "body": "Hey I tried to run this and I got a &quot;object doesn&#39;t support this property or method&quot; error, and the debugger said it was because of the &quot;whiteSheet.Cells(j, 1).Paste&quot; line."}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "reply_to_user": {"reputation": 55, "user_id": 3357487, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e26778ab272cfe7c3139b181fb2a4fc0?s=128&d=identicon&r=PG&f=1", "display_name": "electronicaneer", "link": "https://stackoverflow.com/users/3357487/electronicaneer"}, "edited": false, "score": 0, "creation_date": 1466003035, "post_id": 37837883, "comment_id": 63139150, "body": "Whoops - Excel VBA uses <code>PasteSpecial</code> rather than <code>Paste</code>.  My bad, updated code"}, {"owner": {"reputation": 55, "user_id": 3357487, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e26778ab272cfe7c3139b181fb2a4fc0?s=128&d=identicon&r=PG&f=1", "display_name": "electronicaneer", "link": "https://stackoverflow.com/users/3357487/electronicaneer"}, "edited": false, "score": 0, "creation_date": 1466003940, "post_id": 37837883, "comment_id": 63139816, "body": "Unfortunately, I am now getting a &quot;PasteSpecial method of range class failed&quot; error. Are you getting the same thing?"}], "tags": [], "owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "is_accepted": false, "score": 1, "last_activity_date": 1466003006, "last_edit_date": 1466003006, "creation_date": 1465999779, "answer_id": 37837883, "question_id": 37836786, "link": "https://stackoverflow.com/questions/37836786/error-1004-paste-method-of-worksheet-class-failed-intermittent/37837883#37837883", "title": "Error 1004 Paste Method of Worksheet Class Failed, Intermittent", "body": "<p>As per the comments, I've modified the code to remove the use of <code>.Select</code>, <code>.Activate</code> etc type statements</p>\n\n<pre><code>Sub TorCopy()\n\n    ' Set variables\n    Dim Word As New Word.Application\n    Dim WordDoc As New Word.Document\n    Dim i As Integer\n    Dim j As Integer\n    Dim r As Word.range\n    Dim Doc_Path As String\n    Dim TOR_Tracker As Excel.Workbook\n    Dim TOR_Tracker_Path As String\n    Dim Whiteboard_Path As String\n    Dim Whiteboard As Excel.Workbook\n    Dim whiteSheet as Worksheet\n    Dim torSheet as Worksheet\n    Dim n As Integer\n\n    ' Set File Path that contains TOR\n    ' Open File\n    Doc_Path = \"C:\\Word_File.doc\"\n    Set WordDoc = Word.Documents.Open(Doc_Path)\n\n    TOR_Tracker_Path = \"C:\\Tracker_Spreadsheet.xlsm\"\n    Set TOR_Tracker = Workbooks.Open(TOR_Tracker_Path)\n    Set torSheet = TOR_Tracker.Worksheets(\"Sheet1\")\n\n    Whiteboard_Path = \"C:\\Excel_Spreadsheet_Acting_As_A_Whiteboard.xlsm\"\n    Set Whiteboard = Workbooks.Open(Whiteboard_Path)\n    Set whiteSheet = Whiteboard.Worksheets(\"Sheet1\")\n\n    ' Create a range to search\n    Set r = WordDoc.Content\n\n    j = 1\n\n    ' Find TOR numbers and copy them to whiteboard spreadsheet\n    With r\n        .Find.ClearFormatting\n        With .Find\n            .Text = \"TP[0-9]{4}\"\n            .Format = False\n            .MatchCase = False\n            .MatchWholeWord = False\n            .MatchWildcards = True\n        End With\n        Do While .Find.Execute = True\n            .Copy\n            whiteSheet.Cells(j, 1).PasteSpecial\n            j = j + 1\n        Loop\n    End With\n\n    ' Filter out duplicate TOR numbers\n    n = whiteSheet.Cells(whiteSheet.Rows.Count, \"A\").End(xlUp).Row\n    whiteSheet.range(\"A1:A\" &amp; n).RemoveDuplicates Columns:=1, Header:=xlNo\n    n = whiteSheet.Cells(whiteSheet.Rows.Count, \"A\").End(xlUp).Row ' re-getting the last row now duplicates are removed\n\n    lastRowTor = torSheet.Cells(torSheet.Rows.Count, \"A\").End(xlUp).Row\n\n    torSheet.Range(\"A\" &amp; lastRowTor &amp; \":A\" &amp; (lastRowTor + n)-1).Value = whiteSheet.Range(\"A1:A\" &amp; n).Value ' sets values in Tor from White without Select, Copy or Paste\n\n    Whiteboard.Close\n    WordDoc.Close\n    Word.Quit\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 3357487, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e26778ab272cfe7c3139b181fb2a4fc0?s=128&d=identicon&r=PG&f=1", "display_name": "electronicaneer", "link": "https://stackoverflow.com/users/3357487/electronicaneer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1466003006, "creation_date": 1465997044, "last_edit_date": 1465997755, "question_id": 37836786, "link": "https://stackoverflow.com/questions/37836786/error-1004-paste-method-of-worksheet-class-failed-intermittent", "title": "Error 1004 Paste Method of Worksheet Class Failed, Intermittent", "body": "<p>The purpose of this code is to search for and copy a number from a word document to an excel spreadsheet. It doesn't happen all of the time, but I am getting the 1004 error from time to time when I run this script. The debugger highlights the <strong>first</strong> \"ActiveSheet.Paste\" statement, which is under the \"Do While Loop\" as the problem with the code. I am not seeing any conflicts with any other part of the script. Anyone spot anything incorrect?</p>\n\n<pre><code>Sub TorCopy()\n\n    ' Set variables\n    Dim Word As New Word.Application\n    Dim WordDoc As New Word.Document\n    Dim i As Integer\n    Dim j As Integer\n    Dim r As Word.range\n    Dim Doc_Path As String\n    Dim TOR_Tracker As Excel.Workbook\n    Dim TOR_Tracker_Path As String\n    Dim Whiteboard_Path As String\n    Dim Whiteboard As Excel.Workbook\n    Dim n As Integer\n\n    ' Set File Path that contains TOR\n    ' Open File\n    Doc_Path = \"C:\\Word_File.doc\"\n    Set WordDoc = Word.Documents.Open(Doc_Path)\n\n    TOR_Tracker_Path = \"C:\\Tracker_Spreadsheet.xlsm\"\n    Set TOR_Tracker = Workbooks.Open(TOR_Tracker_Path)\n\n    Whiteboard_Path = \"C:\\Excel_Spreadsheet_Acting_As_A_Whiteboard.xlsm\"\n    Set Whiteboard = Workbooks.Open(Whiteboard_Path)\n\n    Whiteboard.Worksheets(\"Sheet1\").Activate\n\n    ' Create a range to search\n    Set r = WordDoc.Content\n\n    j = 1\n\n    ' Find TOR numbers and copy them to whiteboard spreadsheet\n    With r\n        .Find.ClearFormatting\n        With .Find\n            .Text = \"TP[0-9]{4}\"\n            .Format = False\n            .MatchCase = False\n            .MatchWholeWord = False\n            .MatchWildcards = True\n        End With\n        Do While .Find.Execute = True\n            .Copy\n            ActiveSheet.Cells(j, 1).Select\n            ActiveSheet.Paste\n            j = j + 1\n        Loop\n    End With\n\n    ' Filter out duplicate TOR numbers\n    n = Cells(Rows.Count, \"A\").End(xlUp).Row\n    ActiveSheet.range(\"A1:A\" &amp; n).RemoveDuplicates Columns:=1, Header:=xlNo\n\n    ' Copy TOR numbers from whiteboard\n    With ActiveSheet\n        .range(\"A1\").Select\n        .range(Selection, Selection.End(xlDown)).Select\n        Selection.Copy\n    End With\n\n    ' Paste to TOR Tracker\n    TOR_Tracker.Worksheets(\"Sheet1\").Activate\n    With ActiveSheet\n        .range(\"A1\").Select\n        Selection.End(xlDown).Select\n        Selection.End(xlDown).Select\n        Selection.End(xlDown).Select\n        ActiveCell.Offset(1, 4).Select\n        ActiveSheet.Paste\n    End With\n\n    Whiteboard.Close\n    WordDoc.Close\n    Word.Quit\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1465996919, "post_id": 37836492, "comment_id": 63134488, "body": "Look at the <code>Range.Find</code> function.."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1465996989, "post_id": 37836492, "comment_id": 63134544, "body": "Hi, try advanced filter. See <a href=\"https://msdn.microsoft.com/en-us/library/office/ff841242.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff841242.aspx</a>. Also, using a SQL statement gives fast results too, may or may not be useful here."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1465997004, "post_id": 37836492, "comment_id": 63134550, "body": "Can you not use the filter?"}, {"owner": {"reputation": 333, "user_id": 4475288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ijzgO.jpg?s=128&g=1", "display_name": "Ricardo Silva", "link": "https://stackoverflow.com/users/4475288/ricardo-silva"}, "edited": false, "score": 0, "creation_date": 1465997746, "post_id": 37836492, "comment_id": 63135088, "body": "Edited to explain the filter."}], "answers": [{"tags": [], "owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "is_accepted": false, "score": 1, "last_activity_date": 1465997373, "last_edit_date": 1492087236, "creation_date": 1465997373, "answer_id": 37836918, "question_id": 37836492, "link": "https://stackoverflow.com/questions/37836492/faster-multiple-criteria-search-filter-excel/37836918#37836918", "title": "Faster multiple criteria search/filter excel", "body": "<p>I'm assuming this:</p>\n\n<pre><code>Set selectedRange = Range(\"A4:A40000\")\n</code></pre>\n\n<p>It's because the size is not defined properly, the following should limit to the right long </p>\n\n<pre><code>Set selectedRange = Range(\"A4:A\" &amp; Cells(Rows.Count, \"A\").End(xlUp).Row)\n</code></pre>\n\n<p>If it doesn't affect, I always use these codes to speed up Excel (Instead of only ScreenUpdating alone).<br></p>\n\n<pre><code>Sub ExcelNormal()\n        With Excel.Application\n        .Cursor = xlDefault\n        .ScreenUpdating = True\n        .DisplayAlerts = True\n        .Calculation = xlCalculationAutomatic\n        .StatusBar = False\n        End With\nEnd Sub\nSub ExcelBusy()\n        With Excel.Application\n        .Cursor = xlWait\n        .ScreenUpdating = False\n        .DisplayAlerts = False\n        .Calculation = xlCalculationManual\n        .StatusBar = False\n        End With\nEnd Sub\n</code></pre>\n\n<p>Note: In the future Probably <a href=\"https://codereview.stackexchange.com/\">Code Review</a> would be better place to post.</p>\n"}], "owner": {"reputation": 333, "user_id": 4475288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ijzgO.jpg?s=128&g=1", "display_name": "Ricardo Silva", "link": "https://stackoverflow.com/users/4475288/ricardo-silva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 418, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1465997793, "creation_date": 1465996353, "last_edit_date": 1465997793, "question_id": 37836492, "link": "https://stackoverflow.com/questions/37836492/faster-multiple-criteria-search-filter-excel", "title": "Faster multiple criteria search/filter excel", "body": "<p>Hi guys I made the code below to search for multiple text in a given column. The problem is that it is very slow. Do guys know any other ways to perform it faster?</p>\n\n<p>For example give the array ('foo', 'bar'), The code should iterate on a column and match/filter only the rows that have both texts in any given order.</p>\n\n<pre><code>Sub aTest()\nScreenUpdating = False\n\nDim selectedRange As Range, cell As Range\n\nDim searchValues() As String\n\nsearchValues = Split(ActiveSheet.Cells(2, 1).Value)\n\nSet selectedRange = Range(\"A4:A40000\")\n\nDim element As Variant\n\nFor Each cell In selectedRange\n    If cell.Value = \"\" Then\n        Exit For\n    Else\n        For Each element In searchValues\n            If Not InStr(1, cell.Value, element) Then\n                cell.EntireRow.Hidden = True\n            End If\n        Next element\n    End If\nNext cell\n\nScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>I was using it as a filter. copied and pasted the following code with a few modifications. But then I was not able to make the changes to match multiple strings.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim iFilterColumn As Integer\n    Dim rFilter As Range\n    Dim sCriteria As String\n    On Error Resume Next\n    With Target\n        Set rFilter = .Parent.AutoFilter.Range\n        iFilterColumn = .Column + 1 - rFilter.Columns(1).Column\n        If Intersect(Target, Range(\"rCriteria\")) Is Nothing Then GoTo Terminator\n        Select Case Left(.Value, 1)\n        Case \"&gt;\", \"&lt;\"\n            sCriteria = .Value\n        Case Else\n            sCriteria = \"=*\" &amp; .Value &amp; \"*\"\n        End Select\n        If sCriteria = \"=\" Then\n            .Parent.Range(rFilter.Address).AutoFilter Field:=iFilterColumn\n        Else\n            .Parent.Range(rFilter.Address).AutoFilter Field:=iFilterColumn, Criteria1:=sCriteria\n        End If\n    End With\nTerminator:\n    Set rFilter = Nothing\n    On Error GoTo 0\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "macros", "standard-deviation"], "comments": [{"owner": {"reputation": 802, "user_id": 6463812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ada6562a6b8560eca1f5227dc046a03?s=128&d=identicon&r=PG&f=1", "display_name": "Yarnspinner", "link": "https://stackoverflow.com/users/6463812/yarnspinner"}, "edited": false, "score": 0, "creation_date": 1465996471, "post_id": 37836142, "comment_id": 63134133, "body": "Hello cam, just to clarify, if you are considering the lowest 10%, are you expecting 0.1 or 1 if the list of values is (1,2,3,...,10)?"}, {"owner": {"reputation": 57, "user_id": 6445930, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/34b1ddda559c977291a0b55178c12b72?s=128&d=identicon&r=PG&f=1", "display_name": "cam", "link": "https://stackoverflow.com/users/6445930/cam"}, "reply_to_user": {"reputation": 802, "user_id": 6463812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ada6562a6b8560eca1f5227dc046a03?s=128&d=identicon&r=PG&f=1", "display_name": "Yarnspinner", "link": "https://stackoverflow.com/users/6463812/yarnspinner"}, "edited": false, "score": 0, "creation_date": 1465996767, "post_id": 37836142, "comment_id": 63134361, "body": "@Yarnspinner I would be expecting 0.1...What the end goal of this code is to take that answer from the division problem, and check to verify that the answer is within a certain range of all of the values on column &quot;T&quot;.  Thus, my solution is to display what percentile that answer falls in within the column &quot;T&quot;, to tell the user if their answer is close to the average of that column."}, {"owner": {"reputation": 802, "user_id": 6463812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ada6562a6b8560eca1f5227dc046a03?s=128&d=identicon&r=PG&f=1", "display_name": "Yarnspinner", "link": "https://stackoverflow.com/users/6463812/yarnspinner"}, "edited": false, "score": 0, "creation_date": 1465997230, "post_id": 37836142, "comment_id": 63134715, "body": "WorksheetFunction.Percentrank is what you are looking for then. It takes in an array and a value then returns you the 0.1% in this case. Percentile is the inverse, u pass in an array and 0.1 to get back 1."}], "answers": [{"tags": [], "owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "is_accepted": false, "score": 1, "last_activity_date": 1465995960, "creation_date": 1465995960, "answer_id": 37836342, "question_id": 37836142, "link": "https://stackoverflow.com/questions/37836142/using-a-response-answer-to-find-what-percentile-it-is-within-a-column/37836342#37836342", "title": "Using a response &#39;answer&#39; to find what percentile it is within a column", "body": "<p>You can use the percentile worksheet function as follows.</p>\n\n<pre><code>Public Sub Percentile()\n    Dim myrng As Range\n\n    Set myrng = Range(\"t1:t10\") 'set the range\n    mypercentile = WorksheetFunction.Percentile(myrng, 0.9) ' Retrieve the 90th percentile from t1:t10\n    MsgBox (\"The percentile is \" &amp; mypercentile)\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 57, "user_id": 6445930, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/34b1ddda559c977291a0b55178c12b72?s=128&d=identicon&r=PG&f=1", "display_name": "cam", "link": "https://stackoverflow.com/users/6445930/cam"}, "edited": false, "score": 0, "creation_date": 1466000142, "post_id": 37836454, "comment_id": 63136953, "body": "I am trying to rework this code to work for me, and I keep getting an error on the last line, says that it requires an &quot;=&quot;, or when I set it to something, it says &quot;Assignment to constant not permitted&quot;"}, {"owner": {"reputation": 802, "user_id": 6463812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ada6562a6b8560eca1f5227dc046a03?s=128&d=identicon&r=PG&f=1", "display_name": "Yarnspinner", "link": "https://stackoverflow.com/users/6463812/yarnspinner"}, "reply_to_user": {"reputation": 57, "user_id": 6445930, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/34b1ddda559c977291a0b55178c12b72?s=128&d=identicon&r=PG&f=1", "display_name": "cam", "link": "https://stackoverflow.com/users/6445930/cam"}, "edited": false, "score": 0, "creation_date": 1466000801, "post_id": 37836454, "comment_id": 63137454, "body": "Sorry, this should be my fault. This is a worksheet function so it doesn&#39;t take in a VBA range and expects a string instead. Should work if you change it to &quot;T1:T500&quot; or relevant_array.Address. Sorry, dont have Excel with me now so couldnt check. Wait no, that isn&#39;t the case after further reading. I&#39;m not too sure what is causing the error."}, {"owner": {"reputation": 802, "user_id": 6463812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ada6562a6b8560eca1f5227dc046a03?s=128&d=identicon&r=PG&f=1", "display_name": "Yarnspinner", "link": "https://stackoverflow.com/users/6463812/yarnspinner"}, "reply_to_user": {"reputation": 57, "user_id": 6445930, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/34b1ddda559c977291a0b55178c12b72?s=128&d=identicon&r=PG&f=1", "display_name": "cam", "link": "https://stackoverflow.com/users/6445930/cam"}, "edited": false, "score": 0, "creation_date": 1466001227, "post_id": 37836454, "comment_id": 63137809, "body": "@cam, ok the new code should work fine. The actual error was that percentrank returned a value which needed to be assigned to a variable. I declared x as a variable in the code and now it runs fine."}, {"owner": {"reputation": 57, "user_id": 6445930, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/34b1ddda559c977291a0b55178c12b72?s=128&d=identicon&r=PG&f=1", "display_name": "cam", "link": "https://stackoverflow.com/users/6445930/cam"}, "edited": false, "score": 0, "creation_date": 1466001608, "post_id": 37836454, "comment_id": 63138095, "body": "thanks for your work on this.  The code looks great and it truly should work, now I&#39;m getting the error &quot;Unable to get the PercentRank property of the WorksheetFunction class.  I believe this is a problem with my excel setup, not your code."}, {"owner": {"reputation": 802, "user_id": 6463812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ada6562a6b8560eca1f5227dc046a03?s=128&d=identicon&r=PG&f=1", "display_name": "Yarnspinner", "link": "https://stackoverflow.com/users/6463812/yarnspinner"}, "reply_to_user": {"reputation": 57, "user_id": 6445930, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/34b1ddda559c977291a0b55178c12b72?s=128&d=identicon&r=PG&f=1", "display_name": "cam", "link": "https://stackoverflow.com/users/6445930/cam"}, "edited": false, "score": 0, "creation_date": 1466002170, "post_id": 37836454, "comment_id": 63138527, "body": "@cam, it could be that the answer you pass in isnt being treated as a numeric value. Apparently, a common cause of that error according to <a href=\"http://stackoverflow.com/questions/10635048/excel-error-1004-unable-to-get-property-of-worksheetfunction-class-appear\" title=\"excel error 1004 unable to get property of worksheetfunction class appear\">stackoverflow.com/questions/10635048/&hellip;</a> is passing in unexpected data types into a function. You could try debug.print answer and TypeName(answer) to check that out."}], "tags": [], "owner": {"reputation": 802, "user_id": 6463812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ada6562a6b8560eca1f5227dc046a03?s=128&d=identicon&r=PG&f=1", "display_name": "Yarnspinner", "link": "https://stackoverflow.com/users/6463812/yarnspinner"}, "is_accepted": true, "score": 1, "last_activity_date": 1466001135, "last_edit_date": 1466001135, "creation_date": 1465996258, "answer_id": 37836454, "question_id": 37836142, "link": "https://stackoverflow.com/questions/37836142/using-a-response-answer-to-find-what-percentile-it-is-within-a-column/37836454#37836454", "title": "Using a response &#39;answer&#39; to find what percentile it is within a column", "body": "<p>You can make use of Excel's inbuilt Percentrank function. I'm assuming there aren't any blanks in column T.</p>\n\n<pre><code>Dim x as double\nSet ws= ActiveWorkbook.Worksheets(\"Sheet1\")\nSet relevant_array = ws.Range(ws.Range(\"T1\"),ws.Range(\"T1\").End(xlDown))\nx = WorksheetFunction.Percentrank(relevant_array.Address,answer)\ndebug.print x\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 6445930, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/34b1ddda559c977291a0b55178c12b72?s=128&d=identicon&r=PG&f=1", "display_name": "cam", "link": "https://stackoverflow.com/users/6445930/cam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 37836454, "answer_count": 2, "score": 0, "last_activity_date": 1466001135, "creation_date": 1465995454, "question_id": 37836142, "link": "https://stackoverflow.com/questions/37836142/using-a-response-answer-to-find-what-percentile-it-is-within-a-column", "title": "Using a response &#39;answer&#39; to find what percentile it is within a column", "body": "<p>The code currently asks the user for two separate numbers, and it divides them and the answer pops up in a message box.  What I want to do next is use that answer and figure what percentile it is within column \"T\" in my workbook. </p>\n\n<pre><code> If response = vbNo Then\n    Dim cost, weight, answer As Variant\n        cost = InputBox(\"Please Enter PO Cost\")\n        weight = InputBox(\"Please Enter Net Weight\")\n        answer = cost / weight\n        MsgBox \"Price per KG is: \" &amp; answer\n        Exit Sub \n</code></pre>\n"}, {"tags": ["vba", "outlook", "exchange-server", "office-2016"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6469090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e6e1e675d5b8e05c3128ac21626e982?s=128&d=identicon&r=PG&f=1", "display_name": "Janko", "link": "https://stackoverflow.com/users/6469090/janko"}, "edited": false, "score": 0, "creation_date": 1466684582, "post_id": 37849024, "comment_id": 63426687, "body": "Ok I got that. Now I have a different question. How to access mailbox with Outlook VBA, that are not included if I run this &quot;for each loop&quot;.  \t \tDim oAccount As account \tSet ns = GetNamespace(&quot;MAPI&quot;)     For Each oAccount In Session.Accounts     Debug.Print vbCr &amp; &quot;oAccount: &quot; &amp; oAccount     Next \t I only see those mailboxes, that I can also see directly under the account options.  All of the automatically added mailboxes and the additional mailboxes are not listed in the Debug.Print."}], "tags": [], "owner": {"reputation": 16134, "user_id": 1080923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de5381f82010f6a5175f2f3fe8ac85b9?s=128&d=identicon&r=PG", "display_name": "Glen Scales", "link": "https://stackoverflow.com/users/1080923/glen-scales"}, "is_accepted": false, "score": 0, "last_activity_date": 1466044978, "creation_date": 1466044978, "answer_id": 37849024, "question_id": 37836062, "link": "https://stackoverflow.com/questions/37836062/how-to-connect-to-a-specific-email-account-on-outlook-2016-vba-using-rest-api-n/37849024#37849024", "title": "How to connect to a specific email account on Outlook 2016 VBA using Rest API (Not MAPI)", "body": "<blockquote>\n  <blockquote>\n    <p>Now the IT decided to upgrade their servers to Exchange 2016. Those account will not use MAPI. IT said they now use REST API.</p>\n  </blockquote>\n</blockquote>\n\n<p>This is not technically correct Exchange 2016 doesn't yet support the new Outlook Rest API (although it has been announced that this will be introduced in the future). If you using Office365 then can use REST. Another alternative that will work against any version of Exchange is to use EWS <a href=\"https://msdn.microsoft.com/en-us/library/office/dn567668(v=exchg.150).aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/dn567668(v=exchg.150).aspx</a> .</p>\n\n<p>Another thing that should be pointed out is that regardless of Exchange version 2010,2016 or Office365 Outlook uses MAPI to connect to Exchange (along with EWS for various features). The difference between versions is the Method of connection eg in 2016 by default Mapi over HTTP is the preferred connectivity mech in previous versions in was RPC/HTTP (Outlook Anywhere). Its the same protocol just a different transport but from an Outlook code/client perspective its relatively transparent once the profiles have been created and the connection established. One thing that wouldn't work is trying to do a direct RPC/Mapi connection to Exchange 2016 (or 2013 for that matter).In theory your VBA code should still work if all Mailboxes are hosted in the same org but what you IT department is telling you isn't correct (unless they have specifically disabled MAPI on those mailbox which you could do in previous version of Exchange).</p>\n"}], "owner": {"reputation": 11, "user_id": 6469090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e6e1e675d5b8e05c3128ac21626e982?s=128&d=identicon&r=PG&f=1", "display_name": "Janko", "link": "https://stackoverflow.com/users/6469090/janko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1725, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1466044978, "creation_date": 1465995203, "last_edit_date": 1465998473, "question_id": 37836062, "link": "https://stackoverflow.com/questions/37836062/how-to-connect-to-a-specific-email-account-on-outlook-2016-vba-using-rest-api-n", "title": "How to connect to a specific email account on Outlook 2016 VBA using Rest API (Not MAPI)", "body": "<p>I am currently using Windows 7, Outlook 2010 with Exchange MAPI accounts.\nSeveral users have their personal account + several generic accounts (some with full access, some read only)\nThe users execute a macro in VBA to connect to a specific mail adress/account to read check the incoming mails from the inbox on different criteria.</p>\n\n<p>This code snipet connects to the MAPI Account and sets the folder to the inbox of a mail account:</p>\n\n<pre><code>Dim ns As Outlook.NameSpace\nDim Inbox As Outlook.Folder\nSet ns = GetNamespace(\"MAPI\")\nSet Inbox = ns.Folders.Item(\"jon.doe@example.com\").Folders(\"Inbox\")\n</code></pre>\n\n<p>Now the IT decided to upgrade their servers to Exchange 2016. \nThose account will not use <code>MAPI</code>. IT said they now use <code>REST API</code>. </p>\n\n<p>I suppose that's why I now receive this error message, when executing the code above with Outlook and Exchange 2016 and now Windows 10. \n<img src=\"https://i.stack.imgur.com/IVJ6k.png\" alt=\"VBA Runtime Error\"></p>\n\n<p>I found online several solutions, but all of them need Visual Studio + Addins/Libraries. I want to do this with VBA and also connect to a mail account and inbox, so without Visual Studio, C#.</p>\n\n<p>Best regards</p>\n\n<p>Janko</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "edited": false, "score": 1, "creation_date": 1465995230, "post_id": 37835877, "comment_id": 63133189, "body": "what was the closest thing you tried?"}, {"owner": {"reputation": 9315, "user_id": 3627756, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/JxLDj.png?s=128&g=1", "display_name": "Ankit Bajpai", "link": "https://stackoverflow.com/users/3627756/ankit-bajpai"}, "edited": false, "score": 0, "creation_date": 1465995403, "post_id": 37835877, "comment_id": 63133330, "body": "Anything will work for me whether to add an element or something else as i am nowhere now. Random integers numbers should be in range [1,10]. I have tried nothing yet but i have seen so many solutions provided on internet but they are not worth for me."}, {"owner": {"reputation": 14149, "user_id": 2338750, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/fxW4T.png?s=128&g=1", "display_name": "Stewie Griffin", "link": "https://stackoverflow.com/users/2338750/stewie-griffin"}, "edited": false, "score": 7, "creation_date": 1465995507, "post_id": 37835877, "comment_id": 63133413, "body": "&quot;I have tried nothing yet&quot;. You have 2737 rep... I don&#39;t mean to be rude, but, IMO you should know better than to post this."}, {"owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "edited": false, "score": 0, "creation_date": 1465995734, "post_id": 37835877, "comment_id": 63133603, "body": "You have change your requirements in the comments, please reflect this in your question."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1465997170, "post_id": 37835877, "comment_id": 63134675, "body": "Perhaps use Solver to do this. I believe the solver methods are accessible in vba once the add-in is enabled."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1466005246, "post_id": 37835877, "comment_id": 63140774, "body": "<code>I have tried nothing yet</code> directly contradicts your post <code>I have tried so many solutions</code> - Please don&#39;t post your question here without showing sufficient research effort."}], "answers": [{"comments": [{"owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "edited": false, "score": 0, "creation_date": 1465997019, "post_id": 37836527, "comment_id": 63134559, "body": "Could you comment on this answer please Ankit"}, {"owner": {"reputation": 9315, "user_id": 3627756, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/JxLDj.png?s=128&g=1", "display_name": "Ankit Bajpai", "link": "https://stackoverflow.com/users/3627756/ankit-bajpai"}, "edited": false, "score": 0, "creation_date": 1465999420, "post_id": 37836527, "comment_id": 63136394, "body": "Thank you so much for answer as well but i think the answer given by @gary&#39;s student is much better"}], "tags": [], "owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "is_accepted": false, "score": 0, "last_activity_date": 1465996437, "creation_date": 1465996437, "answer_id": 37836527, "question_id": 37835877, "link": "https://stackoverflow.com/questions/37835877/generate-n-random-numbers-summed-upto-100-vba/37836527#37836527", "title": "Generate n random numbers Summed upto 100 VBA", "body": "<p>The below code will do what you have asked but you have more questions you need to check over: -</p>\n\n<pre><code>Public Sub Sample()\nDim AryNumbers()    As Long\nDim LngCounter      As Long\nReDim AryNumbers(0)\n\nRandomize\n\nDo Until LngCounter = 100\n    AryNumbers(UBound(AryNumbers, 1)) = Int(10 * Rnd + 1)\n    If (LngCounter + AryNumbers(UBound(AryNumbers, 1))) &gt; 100 Then\n        AryNumbers(UBound(AryNumbers, 1)) = 100 - LngCounter\n    Else\n        LngCounter = LngCounter + AryNumbers(UBound(AryNumbers, 1))\n        ReDim Preserve AryNumbers(UBound(AryNumbers, 1) + 1)\n    End If\nLoop\n\nEnd Sub\n</code></pre>\n\n<ul>\n<li>You didn't specify where the numbers are to be stored or if the are to be whole numbers, I have provided them in whole numbers in an array to answer the question.</li>\n<li>You need to consider who random the number is, if you looked on the internet you'll know this is a difficult question</li>\n<li>I honoured the extra requirement in the comments section of being between 1 and 10.</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 9315, "user_id": 3627756, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/JxLDj.png?s=128&g=1", "display_name": "Ankit Bajpai", "link": "https://stackoverflow.com/users/3627756/ankit-bajpai"}, "edited": false, "score": 0, "creation_date": 1465996664, "post_id": 37836566, "comment_id": 63134285, "body": "This solution is in excel but i want the solution in VBA only so it doesn&#39;t help me. Sorry........"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 9315, "user_id": 3627756, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/JxLDj.png?s=128&g=1", "display_name": "Ankit Bajpai", "link": "https://stackoverflow.com/users/3627756/ankit-bajpai"}, "edited": false, "score": 1, "creation_date": 1465997638, "post_id": 37836566, "comment_id": 63135003, "body": "@AnkitBajpai  See my <b>EDIT#1</b>"}, {"owner": {"reputation": 9315, "user_id": 3627756, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/JxLDj.png?s=128&g=1", "display_name": "Ankit Bajpai", "link": "https://stackoverflow.com/users/3627756/ankit-bajpai"}, "edited": false, "score": 0, "creation_date": 1465998963, "post_id": 37836566, "comment_id": 63136047, "body": "Thank you so much for your answer. Hope this will solve my purpose."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 9315, "user_id": 3627756, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/JxLDj.png?s=128&g=1", "display_name": "Ankit Bajpai", "link": "https://stackoverflow.com/users/3627756/ankit-bajpai"}, "edited": false, "score": 0, "creation_date": 1465999104, "post_id": 37836566, "comment_id": 63136162, "body": "@AnkitBajpai  Thanks for the feedback!"}, {"owner": {"reputation": 9315, "user_id": 3627756, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/JxLDj.png?s=128&g=1", "display_name": "Ankit Bajpai", "link": "https://stackoverflow.com/users/3627756/ankit-bajpai"}, "edited": false, "score": 0, "creation_date": 1465999327, "post_id": 37836566, "comment_id": 63136315, "body": "I more thing i want add that i dont want to generate the numbers in a single col. i want to put them in a scattered manner. I dont think your code will work there and the code must avoid zeroes"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 9315, "user_id": 3627756, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/JxLDj.png?s=128&g=1", "display_name": "Ankit Bajpai", "link": "https://stackoverflow.com/users/3627756/ankit-bajpai"}, "edited": false, "score": 0, "creation_date": 1465999814, "post_id": 37836566, "comment_id": 63136687, "body": "@AnkitBajpai It is very easy to both avoid zeros and place the values in a scattered fashion..................I would need to know the region over which the values would be distributed, of course."}, {"owner": {"reputation": 9315, "user_id": 3627756, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/JxLDj.png?s=128&g=1", "display_name": "Ankit Bajpai", "link": "https://stackoverflow.com/users/3627756/ankit-bajpai"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1466000074, "post_id": 37836566, "comment_id": 63136901, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/114755/discussion-between-ankit-bajpai-and-garys-student\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 3, "last_activity_date": 1465997999, "last_edit_date": 1465997999, "creation_date": 1465996547, "answer_id": 37836566, "question_id": 37835877, "link": "https://stackoverflow.com/questions/37835877/generate-n-random-numbers-summed-upto-100-vba/37836566#37836566", "title": "Generate n random numbers Summed upto 100 VBA", "body": "<p>Say we want to make <strong>10</strong> numbers that sum to <strong>100</strong>.  In <strong>A1</strong> enter:</p>\n\n<pre><code>=RANDBETWEEN(1,50)\n</code></pre>\n\n<p>and in <strong>A2</strong> enter:</p>\n\n<pre><code>=IFERROR(RANDBETWEEN(1,100-SUM($A$1:A1)),0)\n</code></pre>\n\n<p>copy <strong>A2</strong> down through <strong>A10</strong>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/0oCmA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0oCmA.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>EDIT#1:</strong></p>\n\n<p>To use a macro, try:</p>\n\n<pre><code>Sub randomality()\n    Dim ary(1 To 10) As Double, zum As Double\n    Dim i As Long\n    Randomize\n    zum = 0\n\n    For i = 1 To 10\n        ary(i) = Rnd\n        zum = zum + ary(i)\n    Next i\n\n    For i = 1 To 10\n        ary(i) = ary(i) / zum\n    Next i\n\n    With Application.WorksheetFunction\n        For i = 1 To 10\n            Cells(i, \"D\").Value = Round(100 * ary(i), 0)\n        Next i\n        Cells(10, \"D\").Value = 100 - .Sum(Range(\"D1:D9\"))\n    End With\nEnd Sub\n</code></pre>\n\n<p>This puts the values in <strong>D1</strong> through <strong>D10</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/kiUCe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kiUCe.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 9315, "user_id": 3627756, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/JxLDj.png?s=128&g=1", "display_name": "Ankit Bajpai", "link": "https://stackoverflow.com/users/3627756/ankit-bajpai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1190, "favorite_count": 0, "closed_date": 1466046403, "accepted_answer_id": 37836566, "answer_count": 2, "score": -7, "last_activity_date": 1466001067, "creation_date": 1465994705, "last_edit_date": 1466001067, "question_id": 37835877, "link": "https://stackoverflow.com/questions/37835877/generate-n-random-numbers-summed-upto-100-vba", "closed_reason": "Not suitable for this site", "title": "Generate n random numbers Summed upto 100 VBA", "body": "<p>Hi I want to generate n random numbers in VBA so that their sum must be 100 and they must be placed in such a way that 7 numbers come on first row then next 7 on second row and so on. I have tried so many solutions given on internet but nothing works for me. So anyone can suggest a solution or give me a link for the solution.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1465996452, "post_id": 37835809, "comment_id": 63134120, "body": "What Access application instance do you want as the foreground window? <code>SetForegroundWindow(Application.hWndAccessApp)</code>  should make the one which contains that <code>Form_Open</code> code the foreground window.  Is that what you want?"}, {"owner": {"reputation": 618, "user_id": 3797860, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/b0faeed70727847c1bbb7748d530acb6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan_W4588", "link": "https://stackoverflow.com/users/3797860/ryan-w4588"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1465996743, "post_id": 37835809, "comment_id": 63134347, "body": "@HansUp I want the current database (from the perspective of the code) to come to the foreground, correct."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1465997260, "post_id": 37835809, "comment_id": 63134739, "body": "What happens if you open the other database like this (instead of using <code>Set acc = New Access.Application</code>)? --&gt; <code>Shell &quot;&quot;&quot;&quot; &amp; SysCmd(acSysCmdAccessDir) &amp; &quot;MSACCESS.EXE&quot; &amp; &quot;&quot;&quot; &quot;&quot;&quot; &amp; strDbName &amp; &quot;&quot;&quot;&quot;</code>"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1465997327, "post_id": 37835809, "comment_id": 63134789, "body": "Make sure space included: <code>&quot;MSACCESS.EXE&quot; &amp; &quot;&quot;&quot; &quot;&quot;&quot; &amp; strDbName &amp; &quot;&quot;&quot;&quot;</code>"}, {"owner": {"reputation": 618, "user_id": 3797860, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/b0faeed70727847c1bbb7748d530acb6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan_W4588", "link": "https://stackoverflow.com/users/3797860/ryan-w4588"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1465997449, "post_id": 37835809, "comment_id": 63134875, "body": "@HansUp That seems to have fixed it! Thanks a lot :)"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1465997696, "post_id": 37835809, "comment_id": 63135043, "body": "Ah, interesting. I tested with <code>Shell</code> too. Thanks @HansUp !"}], "answers": [{"comments": [{"owner": {"reputation": 618, "user_id": 3797860, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/b0faeed70727847c1bbb7748d530acb6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan_W4588", "link": "https://stackoverflow.com/users/3797860/ryan-w4588"}, "edited": false, "score": 0, "creation_date": 1465995627, "post_id": 37836143, "comment_id": 63133524, "body": "I&#39;ve tried this, but I get the following error after adding the declaration:  <code>The expression On Open you entered..... Declare statements not allowed as Public members of object modules</code>   Edit: Changed declaration to private, began working. Still doesn&#39;t bring it to the foreground, though."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1465995781, "post_id": 37836143, "comment_id": 63133637, "body": "Put that declaration in a standard module.  Then you can call it from any other code in your application."}, {"owner": {"reputation": 618, "user_id": 3797860, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/b0faeed70727847c1bbb7748d530acb6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan_W4588", "link": "https://stackoverflow.com/users/3797860/ryan-w4588"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1465995871, "post_id": 37836143, "comment_id": 63133705, "body": "@HansUp That makes sense, but it still didn&#39;t bring the application to the foreground."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1465995986, "post_id": 37836143, "comment_id": 63133788, "body": "I think we&#39;ll need to see some context. Please show us how you&#39;re call that API function."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 618, "user_id": 3797860, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/b0faeed70727847c1bbb7748d530acb6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan_W4588", "link": "https://stackoverflow.com/users/3797860/ryan-w4588"}, "edited": false, "score": 0, "creation_date": 1465996039, "post_id": 37836143, "comment_id": 63133825, "body": "@Ryan_W4588: How / where are you calling the API function? Is the Access window hidden behind other windows, or minimized? In the latter case, you&#39;ll need a different function."}, {"owner": {"reputation": 618, "user_id": 3797860, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/b0faeed70727847c1bbb7748d530acb6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan_W4588", "link": "https://stackoverflow.com/users/3797860/ryan-w4588"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1465996228, "post_id": 37836143, "comment_id": 63133956, "body": "@HansUp updated my OP. Andre, the window is hidden behind other folders/applications if they are open at the time of calling."}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 4, "last_activity_date": 1465997629, "last_edit_date": 1465997629, "creation_date": 1465995456, "answer_id": 37836143, "question_id": 37835809, "link": "https://stackoverflow.com/questions/37835809/how-can-i-bring-my-current-access-db-to-foreground-via-vba/37836143#37836143", "title": "How can I bring my current Access DB to foreground via VBA?", "body": "<p>Usually one uses an API function for that.</p>\n\n<p>From <a href=\"http://www.access-programmers.co.uk/forums/showthread.php?t=132129\" rel=\"nofollow\">http://www.access-programmers.co.uk/forums/showthread.php?t=132129</a> :</p>\n\n<pre><code>Public Declare Function SetForegroundWindow Lib \"user32\" (ByVal hWnd As Long) As Long\n</code></pre>\n\n<p>and then</p>\n\n<pre><code>Call SetForegroundWindow(Application.hWndAccessApp)\n</code></pre>\n\n<p><strong>Edit</strong><br>\nIf you want to get the newly opened Access application window to the front, you need its <code>hWnd</code>:</p>\n\n<pre><code>Call SetForegroundWindow(acc.hWndAccessApp)\n</code></pre>\n\n<p><strong>Edit 2</strong><br>\nThis works for me. Notepad is briefly in the foreground, then the Access window.</p>\n\n<p>Module:</p>\n\n<pre><code>Public Declare Function SetForegroundWindow Lib \"user32\" (ByVal hWnd As Long) As Long\nPublic Declare Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As Long)\n\nPublic Sub TestAccessToForeground()\n\n    Sleep 300\n    Shell \"notepad.exe\", vbNormalFocus\n    Sleep 300\n    Call SetForegroundWindow(Application.hWndAccessApp)\n\nEnd Sub\n</code></pre>\n\n<p>Form:</p>\n\n<pre><code>Private Sub Form_Open(Cancel As Integer)\n\n    Call TestAccessToForeground\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 618, "user_id": 3797860, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/b0faeed70727847c1bbb7748d530acb6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan_W4588", "link": "https://stackoverflow.com/users/3797860/ryan-w4588"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2753, "favorite_count": 1, "accepted_answer_id": 37836143, "answer_count": 1, "score": 2, "last_activity_date": 1594641934, "creation_date": 1465994563, "last_edit_date": 1594641934, "question_id": 37835809, "link": "https://stackoverflow.com/questions/37835809/how-can-i-bring-my-current-access-db-to-foreground-via-vba", "title": "How can I bring my current Access DB to foreground via VBA?", "body": "<p>I'm trying to get my access db to come to the foreground based on the couple of lines, below. I'm not sure why it isn't working though, or if there are better methods to do this.</p>\n\n<p>From what I've read, this should work:</p>\n\n<pre><code>Access.Visible = False\nAccess.Visible = True\n</code></pre>\n\n<p>But doesn't actually bring the database to the front.</p>\n\n<p>Edit for more info:</p>\n\n<pre><code>Private Sub Form_Open(Cancel As Integer)\n    getStrUserName = Environ(\"username\")\n\n    dbName = \"myDB.accdb\" ' database name\n    versionChckDB = \"versionCheckDB.accdb\" ' version check db name\n    strServer = \"C:\\My\\Path\\to\\Server\" ' server location string\n    strDesktop = \"C:\\My\\Path\\to\\Local\" ' desktop location string\n    strVersionCheck = \"C:\\My\\Path\\to\\Version\" ' version check location\n\n    Static acc As Access.Application\n    Dim db As DAO.Database\n    Dim strDbName As String\n\n    If FileLocked(strDesktop &amp; \"\\\" &amp; versionChckDB) Then\n        Dim objAccess As Access.Application\n        Set objAccess = GetObject(strDesktop &amp; \"\\\" &amp; versionChckDB)\n        objAccess.Application.Quit acQuitSaveAll\n        Set objAccess = Nothing\n        DoCmd.OpenForm \"frmMainMenu\"\n        DoCmd.RunCommand acCmdAppMaximize\n        Access.Visible = False\n        Access.Visible = True\n        GoTo exitSub\n    Else\n        strDbName = strDesktop &amp; \"\\\" &amp; versionChckDB\n        Set acc = New Access.Application\n        acc.Visible = True\n        Set db = acc.DBEngine.OpenDatabase(strDbName, False, False)\n        acc.OpenCurrentDatabase strDbName\n    End If\n    'db.Close\n    exitSub:\n        Call SetForegroundWindow(Application.hWndAccessApp) ' bringing access DB to foreground\n\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1466002613, "post_id": 37835640, "comment_id": 63138834, "body": "you need to iterate your range, via cells, so for each cell in rng2HL.cells or for each row in rng2HL.Rows."}, {"owner": {"reputation": 73, "user_id": 6469571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9bcbbc659e1bbf6a25b17e4d5671e65?s=128&d=identicon&r=PG&f=1", "display_name": "Gib999", "link": "https://stackoverflow.com/users/6469571/gib999"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1466003935, "post_id": 37835640, "comment_id": 63139813, "body": "I sort of follow what you&#39;re saying but what I am changing isn&#39;t working..from your comments I need to change the below code:      Set rng2HL = Range(&quot;C2:C824&quot;)     Set rngCheck = Range(&quot;B2:B824&quot;)     a = rng2HL.Value     b = rngCheck.Value  But my edits have not yet worked.  Could you possibly provide further info?"}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 6469571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9bcbbc659e1bbf6a25b17e4d5671e65?s=128&d=identicon&r=PG&f=1", "display_name": "Gib999", "link": "https://stackoverflow.com/users/6469571/gib999"}, "edited": false, "score": 0, "creation_date": 1466015440, "post_id": 37841545, "comment_id": 63146733, "body": "One final question - it looks like it does not catch duplicates within the same cell.  I do not have many instances of this so it&#39;s tough to spot, but if I have one part number repeated 2x in one bill of material&#39;s cell the macro is only changing the text color of one.  If it&#39;s not possible to catch duplicates I still thank you very much for your help!"}, {"owner": {"reputation": 73, "user_id": 6469571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9bcbbc659e1bbf6a25b17e4d5671e65?s=128&d=identicon&r=PG&f=1", "display_name": "Gib999", "link": "https://stackoverflow.com/users/6469571/gib999"}, "edited": false, "score": 0, "creation_date": 1466017120, "post_id": 37841545, "comment_id": 63147733, "body": "Brilliant!  Thanks sir!"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 73, "user_id": 6469571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9bcbbc659e1bbf6a25b17e4d5671e65?s=128&d=identicon&r=PG&f=1", "display_name": "Gib999", "link": "https://stackoverflow.com/users/6469571/gib999"}, "edited": false, "score": 0, "creation_date": 1466029574, "post_id": 37841545, "comment_id": 63153726, "body": "FYI there is a bug in this code - i had not anticipated duplicate values within each cell. Revising and will post corrected version..."}, {"owner": {"reputation": 73, "user_id": 6469571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9bcbbc659e1bbf6a25b17e4d5671e65?s=128&d=identicon&r=PG&f=1", "display_name": "Gib999", "link": "https://stackoverflow.com/users/6469571/gib999"}, "edited": false, "score": 0, "creation_date": 1466031639, "post_id": 37841545, "comment_id": 63154332, "body": "Thanks again Tim - I am really grateful for your help!  This works perfectly!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1466029872, "last_edit_date": 1466029872, "creation_date": 1466010125, "answer_id": 37841545, "question_id": 37835640, "link": "https://stackoverflow.com/questions/37835640/program-to-work-row-by-row-instead-of-entire-range/37841545#37841545", "title": "Program to work row by row instead of entire range?", "body": "<p>Here's one approach:</p>\n\n<pre><code>Sub BOMMAGIC_2NDCOLUMN_Test()\n\n    Dim rw As Range, v1, v2, arrB, arrC, v\n\n    For Each rw In Range(\"B2:C824\").Rows\n\n        rw.Font.Color = vbBlack\n        rw.Offset(0, 2).Resize(1, 2).ClearContents\n        v1 = Trim(rw.Cells(1).Value)\n        v2 = Trim(rw.Cells(2).Value)\n\n        If Len(v1) &gt; 0 And Len(v2) &gt; 0 Then\n            arrB = Uniques(Split(v1, \" \"))\n            arrC = Uniques(Split(v2, \" \"))\n\n            BlankAllMatches arrB, arrC 'remove all matches\n\n            For Each v In arrB\n                If Len(v) &gt; 0 Then\n                    HighlightText rw.Cells(1), CStr(v), vbRed\n                    rw.Cells(1).Offset(0, 2) = rw.Cells(1).Offset(0, 2) &amp; \" \" &amp; v\n                End If\n            Next v\n            For Each v In arrC\n                If Len(v) &gt; 0 Then\n                    HighlightText rw.Cells(2), CStr(v), vbBlue\n                    rw.Cells(2).Offset(0, 2) = rw.Cells(2).Offset(0, 2) &amp; \" \" &amp; v\n                End If\n            Next v\n\n        End If\n\n    Next rw\nEnd Sub\n\n'Set any elements common to both arrays to \"\"\n' Note: arrays should not contain duplicate values\nSub BlankAllMatches(ByRef a, ByRef b)\n    Dim i As Long, x As Long\n    For i = LBound(a) To UBound(a)\n        For x = LBound(b) To UBound(b)\n            If a(i) &lt;&gt; \"\" And a(i) = b(x) Then\n                a(i) = \"\"\n                b(x) = \"\"\n            End If\n       Next x\n    Next i\nEnd Sub\n\n'EDIT: highlight all instances of \"txt\"\nSub HighlightText(rng As Range, txt As String, clr As Long)\n    Dim wordStart, pos As Long\n    pos = InStr(1, rng.Value, txt)\n    Do While pos &gt; 0\n        rng.Characters(pos, Len(txt)).Font.Color = clr\n        pos = InStr(pos + 1, rng.Value, txt)\n    Loop\nEnd Sub\n\n'EDIT: added to deal with duplicates...\n'return an array of unique values from input array\nFunction Uniques(arr)\n    Dim v\n    Static dict As Object\n    If dict Is Nothing Then Set dict = CreateObject(\"scripting.dictionary\")\n    dict.RemoveAll\n    For Each v In arr\n        dict(v) = True\n    Next v\n    Uniques = dict.keys\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 6469571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9bcbbc659e1bbf6a25b17e4d5671e65?s=128&d=identicon&r=PG&f=1", "display_name": "Gib999", "link": "https://stackoverflow.com/users/6469571/gib999"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 37841545, "answer_count": 1, "score": 0, "last_activity_date": 1466029872, "creation_date": 1465994151, "last_edit_date": 1465994813, "question_id": 37835640, "link": "https://stackoverflow.com/questions/37835640/program-to-work-row-by-row-instead-of-entire-range", "title": "Program to work row by row instead of entire range?", "body": "<p>I am working with a macro that goes through 2 columns (B&amp;C) &amp; highlights individual part numbers that are different between merged cells. That part is working just fine. Where I am stuck, however, is getting it to work row-by-row rather than comparing the entire ranges in B &amp; C. I've looked around the places I usually find solutions but I have found nothing that works for what I am trying to do so far, or at least nothing that I can make work.  It seems that no matter what I try if it finds a part number in both columns - regardless of whether that number is in the cell I want to compare or in a completely different one - it returns a match.</p>\n\n<p>Below is the code that highlights differences in column C. It would be really excellent to modify it  to go row by row &amp; highlight differences in both columns at the same time (presently I have a macro for each column). It'd be even more excellent to not only (for example) highlight the mismatches in B2 &amp; C2, but also display those non-matching values from B2 in D2 &amp; from C2 in E2, but that is just an idea I have, not sure if it is possible. Can someone help with this problem?</p>\n\n<pre><code>Sub BOMMAGIC_2NDCOLUMN()\n    Application.ScreenUpdating = False\n    Dim rng2HL As Range, rngCheck As Range, dictWords As Object\n    Dim a() As Variant, b() As Variant, wordlist As Variant, wordStart As Long\n    Set r = Selection\n     'Change the addresses below to match your data.\n    Set rng2HL = Range(\"C2:C824\")\n    Set rngCheck = Range(\"B2:B824\")\n    a = rng2HL.Value\n    b = rngCheck.Value\n    Set dictWords = CreateObject(\"Scripting.Dictionary\")\n     'Load unique words from second column into a dictionary for easy checking\n    For i = LBound(b, 1) To UBound(b, 1)\n        wordlist = Split(b(i, 1), \" \")\n        For j = LBound(wordlist) To UBound(wordlist)\n            If Not dictWords.Exists(wordlist(j)) Then\n                dictWords.Add wordlist(j), wordlist(j)\n            End If\n        Next j\n    Next i\n     'Reset range to highlight to all black font.\n    rng2HL.Font.ColorIndex = 1\n     'Check words one by one against dictionary.\n    For i = LBound(a, 1) To UBound(a, 1)\n        wordlist = Split(a(i, 1), \" \")\n        For j = LBound(wordlist) To UBound(wordlist)\n            If Not dictWords.Exists(wordlist(j)) Then\n                wordStart = InStr(a(i, 1), wordlist(j))\n                 'Change font color of word to red.\n                rng2HL.Cells(i).Characters(wordStart, Len(wordlist(j))).Font.ColorIndex = 3\n            End If\n        Next j\n    Next i\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "edited": false, "score": 0, "creation_date": 1465998653, "post_id": 37835466, "comment_id": 63135795, "body": "Try changing <code>Worksheets(&quot;MailMerge&quot;).Range(&quot;A:K&quot;))</code> to just <code>&quot;A1:K10&quot;</code> as a test"}, {"owner": {"reputation": 523, "user_id": 1996971, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ebc5e297b066c01afb04d7f64dcf77e8?s=128&d=identicon&r=PG", "display_name": "user1996971", "link": "https://stackoverflow.com/users/1996971/user1996971"}, "reply_to_user": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "edited": false, "score": 0, "creation_date": 1466003542, "post_id": 37835466, "comment_id": 63139524, "body": "For some reason, doing this just defaults to the first sheet in the workbook. Even if I activate <code>&quot;MailMerge&quot;</code> immediately beforehand. At the moment, I&#39;m using <code>&quot;MailMerge!&quot;</code>, but in some cases this has more than 244 columns."}], "owner": {"reputation": 523, "user_id": 1996971, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ebc5e297b066c01afb04d7f64dcf77e8?s=128&d=identicon&r=PG", "display_name": "user1996971", "link": "https://stackoverflow.com/users/1996971/user1996971"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1465993704, "creation_date": 1465993704, "question_id": 37835466, "link": "https://stackoverflow.com/questions/37835466/invalid-argument-error-with-docmd-transferspreadhseet-command", "title": "Invalid Argument error with DoCmd.TransferSpreadhseet command?", "body": "<p>As part of my script, I have the line:</p>\n\n<pre><code>Call objAccess.DoCmd.TransferSpreadsheet(acImport, _\nacSpreadsheetTypeExcel8, \"MailMergeTable\", strExcelPath, _\nTrue, Worksheets(\"MailMerge\").Range(\"A:K\"))\n</code></pre>\n\n<p>Where objAccess has been set as <code>New Access.Application</code>. However, I'm getting an argument invalid error for what I believe is my range. Is there something very minor I'm missing here?</p>\n"}, {"tags": ["excel", "excel-formula", "excel-2016", "vba"], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 4837507, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206322321433865/picture?type=large", "display_name": "Mohsen El-Tahawy", "link": "https://stackoverflow.com/users/4837507/mohsen-el-tahawy"}, "edited": false, "score": 0, "creation_date": 1531259892, "post_id": 37835880, "comment_id": 89527115, "body": "is there a way to modify this code to copy only the values not the formulas in row #7?"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1465994720, "creation_date": 1465994720, "answer_id": 37835880, "question_id": 37835442, "link": "https://stackoverflow.com/questions/37835442/copy-the-same-row-from-multiple-sheets-into-one-sheet-in-excel/37835880#37835880", "title": "copy the same row from multiple sheets into one sheet in excel", "body": "<p>Here is a sample for <strong>6</strong> sheets and rows # <strong>7</strong>:</p>\n\n<pre><code>Sub copyrow()\n    Dim Nrow As Long, Nsheet As Long\n    Dim i As Long\n\n    Nrow = 7\n    Nsheet = 6\n\n    For i = 1 To Nsheet - 1\n        Sheets(i).Cells(Nrow, 1).EntireRow.Copy Sheets(Nsheet).Cells(i, 1)\n    Next i\nEnd Sub\n</code></pre>\n\n<p>The row # 7 from the first 5 sheets will be copied into the 6<sup>th</sup> sheet.</p>\n"}, {"tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": true, "score": 3, "last_activity_date": 1466021233, "creation_date": 1466021233, "answer_id": 37844790, "question_id": 37835442, "link": "https://stackoverflow.com/questions/37835442/copy-the-same-row-from-multiple-sheets-into-one-sheet-in-excel/37844790#37844790", "title": "copy the same row from multiple sheets into one sheet in excel", "body": "<p>This code will copy <strong>7th</strong> row from all <strong>first 5 sheets</strong> into <strong>6th</strong> sheet.</p>\n\n<pre><code>Sub row_copy()\n\nFor i = 1 To Worksheets.Count - 1\n\nSheets(i).Rows(7).Copy Sheets(6).Cells(i, 1)\n\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6469523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/843a99c5382da53327bebfe9106df587?s=128&d=identicon&r=PG&f=1", "display_name": "alevan", "link": "https://stackoverflow.com/users/6469523/alevan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1839, "favorite_count": 0, "accepted_answer_id": 37844790, "answer_count": 2, "score": 1, "last_activity_date": 1466021233, "creation_date": 1465993646, "last_edit_date": 1531161705, "question_id": 37835442, "link": "https://stackoverflow.com/questions/37835442/copy-the-same-row-from-multiple-sheets-into-one-sheet-in-excel", "title": "copy the same row from multiple sheets into one sheet in excel", "body": "<p>I need to copy the same row from multiple sheets into one row.</p>\n\n<p>Example: I have an excel file with 5 sheets. I have to copy the 10th row (or the 15th row, or the 21th row) of every sheet in a 6th sheet, in the order of the sheets.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 0, "creation_date": 1466002825, "post_id": 37835348, "comment_id": 63138981, "body": "Most ridiculous approved edit ever!!"}], "answers": [{"tags": [], "owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1466005962, "creation_date": 1466005962, "answer_id": 37840255, "question_id": 37835348, "link": "https://stackoverflow.com/questions/37835348/cut-and-past-excel-file-in-vba/37840255#37840255", "title": "Cut and past excel file in vba", "body": "<p>Try:</p>\n\n<pre><code>ws1.SaveAs \"C:\\yourpath\\\" &amp; Sheet1.Range(\"V3\").Value &amp; TextBox3.Text &amp; \".xlsm\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 49, "user_id": 5671028, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4d6c9b40fea831acc35117c9573fc0b1?s=128&d=identicon&r=PG&f=1", "display_name": "Zaid Shaikh", "link": "https://stackoverflow.com/users/5671028/zaid-shaikh"}, "edited": false, "score": 0, "creation_date": 1466008343, "post_id": 37840267, "comment_id": 63142880, "body": "I changed the oFSO.CopyFile to oFSO.MoveFile  but it is not working. It is showing as File copied = false and not moving the file to another folder"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 49, "user_id": 5671028, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4d6c9b40fea831acc35117c9573fc0b1?s=128&d=identicon&r=PG&f=1", "display_name": "Zaid Shaikh", "link": "https://stackoverflow.com/users/5671028/zaid-shaikh"}, "edited": false, "score": 0, "creation_date": 1466064420, "post_id": 37840267, "comment_id": 63165203, "body": "Apologies, remove the <code>Overwrite</code> arguments.  I&#39;ll add that to my answer."}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1466064520, "last_edit_date": 1466064520, "creation_date": 1466005988, "answer_id": 37840267, "question_id": 37835348, "link": "https://stackoverflow.com/questions/37835348/cut-and-past-excel-file-in-vba/37840267#37840267", "title": "Cut and past excel file in vba", "body": "<p>This code will move your file without having to open it:</p>\n\n<pre><code>Sub test()\n\nDim mySourceFileName As String\nDim myTargetFileName As String\n\nmySourceFileName = Sheet1.Range(\"V4\").Value &amp; TextBox38.Text &amp; \".xlsx\"\nmyTargetFileName = Sheet1.Range(\"V3\").Value &amp; TextBox3.Text &amp; \".xlsx\"\n\nMsgBox \"File Copied:\" &amp; CopyFile(mySourceFileName, myTargetFileName, True), vbOKOnly\n\nEnd Sub\n\nFunction CopyFile(FromFile As String, ToFile As String, Overwrite As Boolean) As Boolean\n\n    Dim oFSO As Object\n    Set oFSO = CreateObject(\"Scripting.FileSystemObject\")\n\n    On Error Resume Next\n    oFSO.CopyFile FromFile, ToFile, Overwrite\n    CopyFile = (Err.Number = 0)\n    Err.Clear\n\nEnd Function\n</code></pre>\n\n<p>To move the file use:</p>\n\n<pre><code>Sub test()\n\nDim mySourceFileName As String\nDim myTargetFileName As String\n\nmySourceFileName = Sheet1.Range(\"V4\").Value &amp; TextBox38.Text &amp; \".xlsx\"\nmyTargetFileName = Sheet1.Range(\"V3\").Value &amp; TextBox3.Text &amp; \".xlsx\"\n\nMsgBox \"File Moved:\" &amp; MoveFile(mySourceFileName, myTargetFileName), vbOKOnly\n\nEnd Sub\n\nPublic Function MoveFile(FromFile As String, ToFile As String) As Boolean\n\n    Dim oFSO As Object\n    Set oFSO = CreateObject(\"Scripting.FileSystemObject\")\n\n    On Error Resume Next\n    oFSO.MoveFile FromFile, ToFile\n    MoveFile = (Err.Number = 0)\n    Err.Clear\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 5671028, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4d6c9b40fea831acc35117c9573fc0b1?s=128&d=identicon&r=PG&f=1", "display_name": "Zaid Shaikh", "link": "https://stackoverflow.com/users/5671028/zaid-shaikh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1376, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1466064520, "creation_date": 1465993367, "last_edit_date": 1531164843, "question_id": 37835348, "link": "https://stackoverflow.com/questions/37835348/cut-and-past-excel-file-in-vba", "title": "Cut and past excel file in vba", "body": "<p>With the below code, I am able to create a copy of excel but I want to move the particular file from one location to another location. Please advise as to what all changes are require in below code.</p>\n\n<pre><code>myFileNameDir = Sheet1.Range(\"V4\").Value &amp; TextBox38.Text &amp; \".xlsx\"\nWorkbooks.Open Filename:=myFileNameDir, UpdateLinks:=0\nSet ws1 = Worksheets(\"sheet1\")\nws1.Activate\nws1.SaveAs Sheet1.Range(\"V3\").Value &amp; TextBox3.Text &amp; \".xlsx\"\n</code></pre>\n"}, {"tags": ["sql", "ms-access", "vba"], "comments": [{"owner": {"reputation": 20094, "user_id": 1832636, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/03182c8b98caa6f9af95e4f4afd7c018?s=128&d=identicon&r=PG", "display_name": "Dan Bracuk", "link": "https://stackoverflow.com/users/1832636/dan-bracuk"}, "edited": false, "score": 0, "creation_date": 1465992877, "post_id": 37835003, "comment_id": 63131481, "body": "The top half of your union query needs a qroup by clause."}, {"owner": {"reputation": 1, "user_id": 5443294, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/756b8c94041a9eaab1fbf1234a606a35?s=128&d=identicon&r=PG&f=1", "display_name": "Probable", "link": "https://stackoverflow.com/users/5443294/probable"}, "reply_to_user": {"reputation": 20094, "user_id": 1832636, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/03182c8b98caa6f9af95e4f4afd7c018?s=128&d=identicon&r=PG", "display_name": "Dan Bracuk", "link": "https://stackoverflow.com/users/1832636/dan-bracuk"}, "edited": false, "score": 0, "creation_date": 1465993095, "post_id": 37835003, "comment_id": 63131625, "body": "Changed that, but still getting the date error."}, {"owner": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "edited": false, "score": 0, "creation_date": 1465993497, "post_id": 37835003, "comment_id": 63131914, "body": "Are <code>[@DailyreportStartDate]</code> and <code>[@DailyReportEndDate]</code> now fields in your form?"}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1465993571, "post_id": 37835003, "comment_id": 63131967, "body": "You have two WHERE sections; is the issue in the first, second, or both?"}, {"owner": {"reputation": 1, "user_id": 5443294, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/756b8c94041a9eaab1fbf1234a606a35?s=128&d=identicon&r=PG&f=1", "display_name": "Probable", "link": "https://stackoverflow.com/users/5443294/probable"}, "reply_to_user": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "edited": false, "score": 0, "creation_date": 1465993755, "post_id": 37835003, "comment_id": 63132102, "body": "@LiamH Yes, I have a public function with all of the necessary items in it, but if you can think of another way to have the where clause get the information over the last 30 days, I&#39;d be open to suggestions."}, {"owner": {"reputation": 1, "user_id": 5443294, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/756b8c94041a9eaab1fbf1234a606a35?s=128&d=identicon&r=PG&f=1", "display_name": "Probable", "link": "https://stackoverflow.com/users/5443294/probable"}, "reply_to_user": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1465993771, "post_id": 37835003, "comment_id": 63132108, "body": "@Dave The error is in both."}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1465994380, "post_id": 37835003, "comment_id": 63132575, "body": "Can you post the public function where the values are declared and set?"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1465994472, "post_id": 37835003, "comment_id": 63132643, "body": "<a href=\"http://stackoverflow.com/a/1099570/3820271\">How to debug dynamic SQL in VBA</a> -- Please add a formatted output of a <code>Debug.Print</code> of your SQL string to your question, so that we see the actual SQL that will be run."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1465994626, "post_id": 37835003, "comment_id": 63132750, "body": "And having variables <code>@DailyReportEndDate</code> embedded in the SQL string won&#39;t work in Access. You&#39;ll need string concatenation."}, {"owner": {"reputation": 1, "user_id": 5443294, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/756b8c94041a9eaab1fbf1234a606a35?s=128&d=identicon&r=PG&f=1", "display_name": "Probable", "link": "https://stackoverflow.com/users/5443294/probable"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1465994823, "post_id": 37835003, "comment_id": 63132878, "body": "@Andre I use this query in another section of my program and it works with the DailyReportEndDate there."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1465994993, "post_id": 37835003, "comment_id": 63133021, "body": "To help you, we need the <i>actual</i> SQL SELECT statement that is run. After all modifications / replacements."}, {"owner": {"reputation": 1, "user_id": 5443294, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/756b8c94041a9eaab1fbf1234a606a35?s=128&d=identicon&r=PG&f=1", "display_name": "Probable", "link": "https://stackoverflow.com/users/5443294/probable"}, "edited": false, "score": 0, "creation_date": 1465995226, "post_id": 37835003, "comment_id": 63133187, "body": "Just did it, so it looks like the replacements aren&#39;t happening. Here is what comes out of the immediate window:"}, {"owner": {"reputation": 1, "user_id": 5443294, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/756b8c94041a9eaab1fbf1234a606a35?s=128&d=identicon&r=PG&f=1", "display_name": "Probable", "link": "https://stackoverflow.com/users/5443294/probable"}, "edited": false, "score": 0, "creation_date": 1465995243, "post_id": 37835003, "comment_id": 63133199, "body": "SELECT &#39;Completed&#39; AS Status, Count(tblPMWOs.PMWOID) AS CountOfPMWOID From tblPMWOs WHERE (([tblPMWOs].[DateComplete] &gt;= DateAdd(&#39;m&#39;,-10,DateValue(#[@DailyReportStartDate]#))) AND ([tblPMWOs].[DateComplete] &lt; DateAdd(&#39;d&#39;,1,DateValue(#[@DailyReportEndDate]#)))) Group By &#39;Completed&#39;UNION ALL SELECT &#39;Open&#39; AS Status, Count(tblPMWOs.PMWOID) AS CountOfPMWOID From tblPMWOs WHERE (((tblPMWOs.DateGenerated) &lt; #[@DailyReportEndDate]#) And ((tblPMWOs.DateComplete) &gt;= #[@DailyReportEndDate]# Or (tblPMWOs.DateComplete) Is Null)) Group BY &#39;Open&#39;  It is the same."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1465995839, "post_id": 37835003, "comment_id": 63133683, "body": "And there is your problem (one of them). I also don&#39;t see a connection between your dynamic SELECT string and the function. The function replaces the &#39;@&#39; variables in existing queries, but not in a dynamic SQL string."}, {"owner": {"reputation": 1, "user_id": 5443294, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/756b8c94041a9eaab1fbf1234a606a35?s=128&d=identicon&r=PG&f=1", "display_name": "Probable", "link": "https://stackoverflow.com/users/5443294/probable"}, "edited": false, "score": 0, "creation_date": 1465996320, "post_id": 37835003, "comment_id": 63134021, "body": "I know the issue now, I am not prompting for the variables in the current area I&#39;m using this in. Do you have any insight as to obtaining the information I&#39;m trying to get over he last 30 days. Date query&#39;s are my biggest issue."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5443294, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/756b8c94041a9eaab1fbf1234a606a35?s=128&d=identicon&r=PG&f=1", "display_name": "Probable", "link": "https://stackoverflow.com/users/5443294/probable"}, "edited": false, "score": 0, "creation_date": 1465996008, "post_id": 37836214, "comment_id": 63133807, "body": "Okay, I understand what you are saying. I am not prompting for the variables in this area. I can&#39;t seem to get any query to work to obtain the information from my database for the last 30 days."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 1, "user_id": 5443294, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/756b8c94041a9eaab1fbf1234a606a35?s=128&d=identicon&r=PG&f=1", "display_name": "Probable", "link": "https://stackoverflow.com/users/5443294/probable"}, "edited": false, "score": 0, "creation_date": 1466002226, "post_id": 37836214, "comment_id": 63138568, "body": "Then you must back to basics: <i>Select * From Table</i>"}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 1, "last_activity_date": 1465995632, "creation_date": 1465995632, "answer_id": 37836214, "question_id": 37835003, "link": "https://stackoverflow.com/questions/37835003/error-syntax-error-in-date-in-query-expression/37836214#37836214", "title": "Error: &quot;Syntax error in date in query expression&quot;", "body": "<p>You feed non-declared/assigned variables <em>DailyReportStartDate</em> and <em>DailyReportEndDate</em> here:</p>\n\n<pre><code>Modify_QuerySQL \"qryDailyReport_Downtime\", Replace(Replace(SQL_DailyReportDowntime, \"[@DailyReportStartDate]\", DailyReportStartDate), \"[@DailyReportEndDate]\", DailyReportEndDate)\n</code></pre>\n\n<p>Also this makes little sense:</p>\n\n<pre><code>DateValue(#[@DailyReportEndDate]#) \n</code></pre>\n\n<p>which - if <em>DailyReportEndDate</em> is a string - results in:</p>\n\n<pre><code>DateValue(#2016/06/15#)\n</code></pre>\n\n<p>which simply should be:</p>\n\n<pre><code>#2016/06/15#\n</code></pre>\n\n<p>or - if <em>DailyReportEndDate</em> is a date - is casted to a string of a format out of your control like:</p>\n\n<pre><code>DateValue(#15-06-2016#)\n</code></pre>\n\n<p>which should have been:</p>\n\n<pre><code>#2016/06/15#\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5443294, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/756b8c94041a9eaab1fbf1234a606a35?s=128&d=identicon&r=PG&f=1", "display_name": "Probable", "link": "https://stackoverflow.com/users/5443294/probable"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2462, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1465995632, "creation_date": 1465992407, "last_edit_date": 1465994506, "question_id": 37835003, "link": "https://stackoverflow.com/questions/37835003/error-syntax-error-in-date-in-query-expression", "title": "Error: &quot;Syntax error in date in query expression&quot;", "body": "<p>I am using MS Access to make a program, and I used this query previously and it worked, but it was in a completely different situation. I'm not sure how to modify it to make it work here. I need to select and count the number of open Workorders over the last 30 days, but there is an issue with my date in the WHERE section.</p>\n\n<p>Here is the query:</p>\n\n<pre><code>\"SELECT 'Completed' AS Status, Count(tblWorkorders.WOID) AS CountOfWOID \" &amp; _\n        \"From tblWorkorders \" &amp; _\n        \"WHERE ((tblWorkorders.CompleteDate &gt;= DateAdd('m',-10,DateValue(#[@DailyReportStartDate]#))) And (tblWorkorders.CompleteDate &lt; DateAdd('d',1,DateValue(#[@DailyReportEndDate]#)))) \" &amp; _\n        \"UNION ALL \" &amp; _\n        \"SELECT 'Open' AS Status, Count(tblWorkorders.WOID) AS CountOfWOID \" &amp; _\n        \"From tblWorkorders \" &amp; _\n        \"WHERE (((tblWorkorders.RequestDate) &lt; #[@DailyReportEndDate]#) And ((tblWorkorders.CompleteDate) &gt;= #[@DailyReportEndDate]# Or (tblWorkorders.CompleteDate) Is Null) AND ((tblWorkorders.StatusID) In (1,4))) \" &amp; _\n        \"Group BY 'Open' \"\n</code></pre>\n\n<p>EDIT: Here is the public function:</p>\n\n<pre><code>Public Function CreateDailyReport() As Boolean\nDim reportName As String\nDim QueryName As String\nDim q As String\n\n\nq = \"SELECT * FROM tblDowntime WHERE 1=0\"\nreportName = \"rptDailyReport\"\nQueryName = \"qryDailyReport\"\nModify_QuerySQL QueryName, q\n\n\nModify_QuerySQL \"qryDailyReport_Downtime\", Replace(Replace(SQL_DailyReportDowntime, \"[@DailyReportStartDate]\", DailyReportStartDate), \"[@DailyReportEndDate]\", DailyReportEndDate)\nModify_QuerySQL \"qryDailyReport_GeneralNotes\", Replace(Replace(SQL_DailyReportGeneralNotes, \"[@DailyReportStartDate]\", DailyReportStartDate), \"[@DailyReportEndDate]\", DailyReportEndDate)\nModify_QuerySQL \"qryDailyReport_PM\", Replace(Replace(SQL_DailyReportPM, \"[@DailyReportStartDate]\", DailyReportStartDate), \"[@DailyReportEndDate]\", DailyReportEndDate)\nModify_QuerySQL \"qryDailyReport_WorkOrder\", Replace(Replace(SQL_DailyReportWorkOrder, \"[@DailyReportStartDate]\", DailyReportStartDate), \"[@DailyReportEndDate]\", DailyReportEndDate)\n\nDoCmd.OutputTo acOutputReport, reportName, acFormatPDF, Get_TempPath &amp; reportName &amp; \".pdf\", True\n\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba", "macros"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6447063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/792201586fcb2c74bcfb7d9d92a4349d?s=128&d=identicon&r=PG&f=1", "display_name": "John Galvin", "link": "https://stackoverflow.com/users/6447063/john-galvin"}, "edited": false, "score": 0, "creation_date": 1465994195, "post_id": 37835276, "comment_id": 63132416, "body": "Thanks for this quick response. I&#39;d tried something very similar. Still getting 1004 error &quot;Method &#39;Show&#39; of object &#39;Dialog&#39; failed&quot;."}, {"owner": {"reputation": 138, "user_id": 5532589, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/QI0o9.jpg?s=128&g=1", "display_name": "Neelesh", "link": "https://stackoverflow.com/users/5532589/neelesh"}, "reply_to_user": {"reputation": 3, "user_id": 6447063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/792201586fcb2c74bcfb7d9d92a4349d?s=128&d=identicon&r=PG&f=1", "display_name": "John Galvin", "link": "https://stackoverflow.com/users/6447063/john-galvin"}, "edited": false, "score": 0, "creation_date": 1466064222, "post_id": 37835276, "comment_id": 63165080, "body": "Strange!!Can you just post an image of the dialogbox that is popping"}, {"owner": {"reputation": 3, "user_id": 6447063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/792201586fcb2c74bcfb7d9d92a4349d?s=128&d=identicon&r=PG&f=1", "display_name": "John Galvin", "link": "https://stackoverflow.com/users/6447063/john-galvin"}, "edited": false, "score": 0, "creation_date": 1466179773, "post_id": 37835276, "comment_id": 63226598, "body": "Hi Neelish, The Message says: Run-time error &#39;1004&#39;:  Method &#39;Show&#39; of object &#39;Dialog&#39; failed"}, {"owner": {"reputation": 138, "user_id": 5532589, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/QI0o9.jpg?s=128&g=1", "display_name": "Neelesh", "link": "https://stackoverflow.com/users/5532589/neelesh"}, "reply_to_user": {"reputation": 3, "user_id": 6447063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/792201586fcb2c74bcfb7d9d92a4349d?s=128&d=identicon&r=PG&f=1", "display_name": "John Galvin", "link": "https://stackoverflow.com/users/6447063/john-galvin"}, "edited": false, "score": 0, "creation_date": 1466250467, "post_id": 37835276, "comment_id": 63246524, "body": "I meant the Dialog box of xldialogprint.show not the error message"}], "tags": [], "owner": {"reputation": 138, "user_id": 5532589, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/QI0o9.jpg?s=128&g=1", "display_name": "Neelesh", "link": "https://stackoverflow.com/users/5532589/neelesh"}, "is_accepted": false, "score": 0, "last_activity_date": 1465993130, "creation_date": 1465993130, "answer_id": 37835276, "question_id": 37834924, "link": "https://stackoverflow.com/questions/37834924/error-handling-on-a-simple-print-excel-macro/37835276#37835276", "title": "Error handling on a simple Print Excel Macro", "body": "<p>Try      </p>\n\n<pre><code>     Sub Printx()      \n      Dim x As Variant\n      x = Application.Dialogs(xlDialogPrint).Show\n      If TypeName(x) = \"Boolean\" Then Exit Sub\n      End Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 14462617, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-zO11nPlJgYg/AAAAAAAAAAI/AAAAAAAAAAA/AMZuucnv6nmnSlAYcg6l8i_7Pezzi9fBSg/s96-c/photo.jpg?sz=128", "display_name": "Mike Juice", "link": "https://stackoverflow.com/users/14462617/mike-juice"}, "is_accepted": false, "score": 0, "last_activity_date": 1602852572, "creation_date": 1602852572, "answer_id": 64389520, "question_id": 37834924, "link": "https://stackoverflow.com/questions/37834924/error-handling-on-a-simple-print-excel-macro/64389520#64389520", "title": "Error handling on a simple Print Excel Macro", "body": "<p>You just need to add simple resume error handling before making the call:</p>\n<pre><code>Sub Printx()\n\n    On Error Resume Next\n    Application.Dialogs(xlDialogPrint).Show\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6447063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/792201586fcb2c74bcfb7d9d92a4349d?s=128&d=identicon&r=PG&f=1", "display_name": "John Galvin", "link": "https://stackoverflow.com/users/6447063/john-galvin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 311, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1602852572, "creation_date": 1465992186, "last_edit_date": 1465992747, "question_id": 37834924, "link": "https://stackoverflow.com/questions/37834924/error-handling-on-a-simple-print-excel-macro", "title": "Error handling on a simple Print Excel Macro", "body": "<p>Apologies - Just trying to get to grips with simple VBA in an Excel I'm working on. I have just about the simplest macro there is associated with a control button:</p>\n\n<pre><code>Sub Printx()\n    Application.Dialogs(xlDialogPrint).Show\nEnd Sub\n</code></pre>\n\n<p>Which is fine for what I need it to do. I'm struggling with the error handling if I click cancel on the resultant dialogue box. Can't seem to get past the runtime 1004 error. \nI have tried several goto lines but still get the same runtime error. Can someone please point out where I'm going wrong. </p>\n"}, {"tags": ["xml", "ms-access", "vba", "ms-access-2013"], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 4117141, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-ivh-sxjXGVY/AAAAAAAAAAI/AAAAAAAAABE/JAtL9xMSNNo/photo.jpg?sz=128", "display_name": "Neal", "link": "https://stackoverflow.com/users/4117141/neal"}, "edited": false, "score": 0, "creation_date": 1466124468, "post_id": 37847412, "comment_id": 63199549, "body": "Yea that does seem to work, I ended up modifying the on click event to intercept the parameters and then store the query into a temp table.  Same concept as yours"}], "tags": [], "owner": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "is_accepted": true, "score": 2, "last_activity_date": 1466033786, "last_edit_date": 1466033786, "creation_date": 1466032813, "answer_id": 37847412, "question_id": 37834736, "link": "https://stackoverflow.com/questions/37834736/access-2013-was-unable-to-export-parameter-query-to-xml-and-xsd/37847412#37847412", "title": "Access 2013 was unable to export parameter query to XML and XSD", "body": "<p>I was able to recreate your issue in Access 2010. Interestingly, Access could successfully export the parameter query to the XML file alone, but trying to export both the XML and XSD files caused Access to choke.</p>\n\n<p>A workaround would be to use <code>SELECT * INTO ...</code> to dump the query results to a temporary table, export the table to XML and XSD, and then drop the temporary table:</p>\n\n<pre class=\"lang-vbs prettyprint-override\"><code>Option Compare Database\nOption Explicit\n\nSub so37834736()\n    ' sample data\n    Const queryName = \"myParameterQuery\"\n    Const tempTableName = \"zzzTempTable\"\n    Const xmlFileSpec = \"C:\\__tmp\\zzzTest.xml\"\n    Const xsdFileSpec = \"C:\\__tmp\\zzzTest.xsd\"\n\n    Dim cdb As DAO.Database\n    Set cdb = CurrentDb\n    Dim qdf As DAO.QueryDef\n    Set qdf = cdb.CreateQueryDef(\"\", _\n            \"SELECT * INTO [\" &amp; tempTableName &amp; \"] FROM [\" &amp; queryName &amp; \"]\")\n    qdf!prmStartDate = DateSerial(2001, 1, 1)  ' specify parameter value(s)\n    qdf.Execute dbFailOnError\n    Set qdf = Nothing\n    Set cdb = Nothing\n    Application.ExportXML acExportTable, tempTableName, xmlFileSpec, xsdFileSpec\n    DoCmd.DeleteObject acTable, tempTableName\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 4117141, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-ivh-sxjXGVY/AAAAAAAAAAI/AAAAAAAAABE/JAtL9xMSNNo/photo.jpg?sz=128", "display_name": "Neal", "link": "https://stackoverflow.com/users/4117141/neal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 311, "favorite_count": 0, "accepted_answer_id": 37847412, "answer_count": 1, "score": 1, "last_activity_date": 1466033786, "creation_date": 1465991654, "last_edit_date": 1466033015, "question_id": 37834736, "link": "https://stackoverflow.com/questions/37834736/access-2013-was-unable-to-export-parameter-query-to-xml-and-xsd", "title": "Access 2013 was unable to export parameter query to XML and XSD", "body": "<p>I'm currently trying to write the VBA to do the XML but since it was failing, I decided to try the built in XML generator that comes with Access.  I have a parameterized query and after I put in the parameters, I go to export the XML and XSD files.  After clicking OK, I get a popup saying that \"Access was unable to export the data.\"  It works fine on non-parameterized queries so I don't think its a DLL issue.  Any thoughts would be helpful. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "edited": false, "score": 0, "creation_date": 1465991134, "post_id": 37834407, "comment_id": 63130206, "body": "the error is due to Worksheets(x) does not exist because the x being calculated exceed the number of sheets in your workbook."}, {"owner": {"reputation": 1772, "user_id": 5290978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SRqx7.jpg?s=128&g=1", "display_name": "Tushar Narang", "link": "https://stackoverflow.com/users/5290978/tushar-narang"}, "reply_to_user": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "edited": false, "score": 0, "creation_date": 1465991310, "post_id": 37834407, "comment_id": 63130350, "body": "Its working fine when i define range as Range(&quot;A1:H100&quot;)"}, {"owner": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "edited": false, "score": 1, "creation_date": 1465991314, "post_id": 37834407, "comment_id": 63130351, "body": "I am not sure what <code>row.Columns(row.ListObject.ListColumns(&quot;Sheet&quot;).Index).Value</code> does but try <code>For Each c in Range(row.Columns(row.ListObject.ListColumns(&quot;Sheet&quot;).Index)&zwnj;&#8203;.Value)</code>"}, {"owner": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "edited": false, "score": 1, "creation_date": 1465991346, "post_id": 37834407, "comment_id": 63130383, "body": "Worksheets is not a range object"}, {"owner": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "edited": false, "score": 0, "creation_date": 1465991411, "post_id": 37834407, "comment_id": 63130428, "body": "i think i know what you are trying to do... hang on"}, {"owner": {"reputation": 1772, "user_id": 5290978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SRqx7.jpg?s=128&g=1", "display_name": "Tushar Narang", "link": "https://stackoverflow.com/users/5290978/tushar-narang"}, "reply_to_user": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "edited": false, "score": 0, "creation_date": 1465991429, "post_id": 37834407, "comment_id": 63130445, "body": "I am trying to define range from a table in Excel"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1465991815, "post_id": 37834407, "comment_id": 63130703, "body": "It would help if you posted the complete sub or function.  What does row reference?"}, {"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "edited": false, "score": 0, "creation_date": 1465991911, "post_id": 37834407, "comment_id": 63130779, "body": "It looks like row references each row in the first <code>For Each</code> loop."}, {"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "edited": false, "score": 0, "creation_date": 1465992049, "post_id": 37834407, "comment_id": 63130877, "body": "What should your expected outcome look like?"}, {"owner": {"reputation": 1772, "user_id": 5290978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SRqx7.jpg?s=128&g=1", "display_name": "Tushar Narang", "link": "https://stackoverflow.com/users/5290978/tushar-narang"}, "edited": false, "score": 0, "creation_date": 1465992091, "post_id": 37834407, "comment_id": 63130916, "body": "What i am trying to achieve here is to to define .Range(A1:H100) from a table in excel"}, {"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "edited": false, "score": 0, "creation_date": 1465992195, "post_id": 37834407, "comment_id": 63130994, "body": "So you just want to print <code>.Range(A1:H100)</code> somewhere? Or use it in more code? Still not fully comprehending."}, {"owner": {"reputation": 1772, "user_id": 5290978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SRqx7.jpg?s=128&g=1", "display_name": "Tushar Narang", "link": "https://stackoverflow.com/users/5290978/tushar-narang"}, "edited": false, "score": 0, "creation_date": 1465992594, "post_id": 37834407, "comment_id": 63131291, "body": "I use it in code, i am letting the user decide the range, by a creating a sheet named master"}, {"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "reply_to_user": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "edited": false, "score": 0, "creation_date": 1465992625, "post_id": 37834407, "comment_id": 63131313, "body": "Without any further explanation, it sounds like you just need to use @Rosetta&#39;s code, change <code>ListColumns(&quot;Sheet&quot;)</code> to <code>ListColumns(&quot;RangeBegin&quot;)</code> and concatenate with <code>Offset(0,1)</code>. But I don&#39;t know. Also, you don&#39;t need to copy and paste. Just make the ranges equal to each other. And don&#39;t use select."}, {"owner": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "edited": false, "score": 0, "creation_date": 1465993640, "post_id": 37834407, "comment_id": 63132017, "body": "looking at your code, your object call method is very mixed up. e.g. <code>row.columns()</code> call doesn&#39;t make any sense."}], "answers": [{"comments": [{"owner": {"reputation": 1772, "user_id": 5290978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SRqx7.jpg?s=128&g=1", "display_name": "Tushar Narang", "link": "https://stackoverflow.com/users/5290978/tushar-narang"}, "edited": false, "score": 0, "creation_date": 1465991940, "post_id": 37834761, "comment_id": 63130789, "body": "how to pick up range from it,"}, {"owner": {"reputation": 1772, "user_id": 5290978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SRqx7.jpg?s=128&g=1", "display_name": "Tushar Narang", "link": "https://stackoverflow.com/users/5290978/tushar-narang"}, "edited": false, "score": 0, "creation_date": 1465995184, "post_id": 37834761, "comment_id": 63133155, "body": "For Each c In Worksheets(row.Columns(row.ListObject.ListColumns(&quot;Sheet&quot;).I&zwnj;&#8203;ndex).Value).Range((&zwnj;&#8203;row.ListObject.ListC&zwnj;&#8203;olumns(&quot;range&quot;).Inde&zwnj;&#8203;x).Value)"}, {"owner": {"reputation": 1772, "user_id": 5290978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SRqx7.jpg?s=128&g=1", "display_name": "Tushar Narang", "link": "https://stackoverflow.com/users/5290978/tushar-narang"}, "edited": false, "score": 0, "creation_date": 1465995213, "post_id": 37834761, "comment_id": 63133178, "body": "Getting Subscript out of range (range has value A1:H100 in excel)"}, {"owner": {"reputation": 1772, "user_id": 5290978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SRqx7.jpg?s=128&g=1", "display_name": "Tushar Narang", "link": "https://stackoverflow.com/users/5290978/tushar-narang"}, "edited": false, "score": 0, "creation_date": 1466052864, "post_id": 37834761, "comment_id": 63159378, "body": "I have answered my own question, Kindly review if i am wrong"}], "tags": [], "owner": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "is_accepted": false, "score": 1, "last_activity_date": 1465992540, "last_edit_date": 1465992540, "creation_date": 1465991719, "answer_id": 37834761, "question_id": 37834407, "link": "https://stackoverflow.com/questions/37834407/error-9-subscript-out-of-range-excel-vba/37834761#37834761", "title": "Error 9 : subscript out of range Excel VBA", "body": "<pre><code>For Each c In Worksheets(1).ListObjects(1).ListColumns(\"Sheet\").DataBodyRange\n\n    'some code here...\n\nNext c\n</code></pre>\n\n<p><code>Worksheets(1)</code> is just an illustration. You can replace the 1 with the name of your worksheet e.g. <code>Worksheets(\"Sheet1\")</code>.</p>\n\n<p><code>ListObjects(1)</code> is just an illustration. You can replace the 1 with the name of the table e.g. <code>ListObject(\"Table1\")</code>. If the worksheet has only one table, you can leave it as 1.</p>\n\n<hr>\n\n<p>here is how to pick range in table row</p>\n\n<pre><code>Sub test()\n    Dim r As ListRow\n    Dim lo As ListObject\n    Set lo = Worksheets(1).ListObjects(1)\n    For Each r In lo.ListRows\n\n        Debug.Print r.Range(1, lo.ListColumns(\"Sheet\").Index).Value\n\n    Next r\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1772, "user_id": 5290978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SRqx7.jpg?s=128&g=1", "display_name": "Tushar Narang", "link": "https://stackoverflow.com/users/5290978/tushar-narang"}, "edited": false, "score": 0, "creation_date": 1466052942, "post_id": 37836390, "comment_id": 63159401, "body": "thanks for such an detailed answer, however i had a look on it just now. I figured out an alternate way, maybe i am wrong. It would be great if u can just review it"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 1, "last_activity_date": 1466054352, "last_edit_date": 1466054352, "creation_date": 1465996085, "answer_id": 37836390, "question_id": 37834407, "link": "https://stackoverflow.com/questions/37834407/error-9-subscript-out-of-range-excel-vba/37836390#37836390", "title": "Error 9 : subscript out of range Excel VBA", "body": "<p>I refactored you code.  I think it's pretty close to what you want.\nNotice how I extract he variables from your chained objects.  This is done to make the code more readable, robost and above all much easier to debug. <br />\nIf <strong>\"Set targetRange\"</strong> breaks the code I can hover the mouse over SheetName, RangeBegin and RangeEnd to find their respective values.</p>\n\n<pre><code>SheetName = .ListColumns(\"Sheet\").DataBodyRange(i)\nRangeBegin = .ListColumns(\"RangeBegin\").DataBodyRange(i)\nRangeEnd = .ListColumns(\"RangeEnd\").DataBodyRange(i)\nSet targetRange = getTargetRange(SheetName, RangeBegin, RangeEnd)\n</code></pre>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>Public Sub ProcessWorkSheets()\r\n    Dim tbl As ListObject\r\n    Dim SheetName As String, RangeBegin As String, RangeEnd As String\r\n    Dim targetRange As Range\r\n\r\n    Set tbl = Sheet1.ListObjects(\"Table1\")\r\n    With tbl\r\n        For i = 1 To tbl.DataBodyRange.Rows.Count\r\n            SheetName = .ListColumns(\"Sheet\").DataBodyRange(i)\r\n            RangeBegin = .ListColumns(\"RangeBegin\").DataBodyRange(i)\r\n            RangeEnd = .ListColumns(\"RangeEnd\").DataBodyRange(i)\r\n            Set targetRange = getTargetRange(SheetName, RangeBegin, RangeEnd)\r\n\r\n            If Not targetRange Is Nothing Then\r\n                With Worksheets(SheetName)\r\n                    For Each c In targetRange\r\n                        If c = \"O\" Then c = Sheets(\"master\").Cells(2, 3)\r\n                    Next\r\n                End If\r\n            End With\r\n        Next\r\n    End With\r\n\r\nEnd Sub\r\n\r\nPublic Function getTargetRange(SheetName As String, RangeBegin As String, RangeEnd As String) As Range\r\n    On Error Resume Next\r\n    Set getTargetRange = Worksheets(SheetName).Range(RangeBegin &amp; \":\" &amp; RangeEnd)\r\n    On Error GoTo 0\r\nEnd Function\r\n\r\nPublic Function hasWorkSheet(SheetName As String)\r\n    On Error Resume Next\r\n    Call Worksheets(SheetName).Name\r\n    If Err.Number &lt;&gt; 0 Then\r\n        hasWorkSheet = False\r\n    Else\r\n        hasWorkSheet = True\r\n    End If\r\n    On Error GoTo 0\r\nEnd Function</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>You don't have to Select or Active Ranges.  It is better to work directly with the Range objects and not with the Select or Active objects. Knowing that we can remove any active or select lines; combining multiple operations with a single action. \n<strong>Updated Refactor:</strong></p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>Application.CopyObjectsWithCells = True 'I Don't this line is needed\r\n\r\nDim row As Range\r\nFor Each row In [table2].Rows\r\n\r\n    For Each c In Worksheets(row.Columns(row.ListObject.ListColumns(\"Sheet\").Index).Value).Range(row.Value2(1, 2))\r\n        If c.Value = \"O\" Then\r\n            Sheets(\"master\").Cells(2, 3).Copy c\r\n        ElseIf c.Value = \"G\" Then\r\n            Sheets(\"master\").Cells(3, 3).Copy c\r\n        ElseIf c.Value = \"R\" Then\r\n            Sheets(\"master\").Cells(4, 3).Copy c\r\n        End If\r\n    Next c\r\n\r\nNext</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": [], "owner": {"reputation": 1772, "user_id": 5290978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SRqx7.jpg?s=128&g=1", "display_name": "Tushar Narang", "link": "https://stackoverflow.com/users/5290978/tushar-narang"}, "is_accepted": false, "score": 0, "last_activity_date": 1466052819, "creation_date": 1466052819, "answer_id": 37850140, "question_id": 37834407, "link": "https://stackoverflow.com/questions/37834407/error-9-subscript-out-of-range-excel-vba/37850140#37850140", "title": "Error 9 : subscript out of range Excel VBA", "body": "<p>OK, Finally after a lot of hit and trials, I have achieved this without much changing my code. I am trying to read each cell and paste content of some other cell if the condition is satisfied</p>\n\n<pre><code>Application.CopyObjectsWithCells = True\n\nDim row As Range\nFor Each row In [table2].Rows\n\nFor Each c In Worksheets(row.Columns(row.ListObject.ListColumns(\"Sheet\").Index).Value).Range(row.Value2(1, 2))\n  If c.Value = \"O\" Then\n     Sheets(\"master\").Cells(2, 3).Copy\n     Sheets(row.Columns(row.ListObject.ListColumns(\"Sheet\").Index).Value).Select\n     c.Select\n     ActiveSheet.Paste\n\n  ElseIf c.Value = \"G\" Then\n     Sheets(\"master\").Cells(3, 3).Copy\n     Sheets(row.Columns(row.ListObject.ListColumns(\"Sheet\").Index).Value).Select\n     c.Select\n     ActiveSheet.Paste\n\n  ElseIf c.Value = \"R\" Then\n     Sheets(\"master\").Cells(4, 3).Copy\n       Sheets(row.Columns(row.ListObject.ListColumns(\"Sheet\").Index).Value).Select\n     c.Select\n     ActiveSheet.Paste\n  Else\n      c.Value = c.Value\n  End If\n  Next c\n\n Next\n</code></pre>\n"}], "owner": {"reputation": 1772, "user_id": 5290978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SRqx7.jpg?s=128&g=1", "display_name": "Tushar Narang", "link": "https://stackoverflow.com/users/5290978/tushar-narang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1453, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1466054352, "creation_date": 1465990798, "last_edit_date": 1465991886, "question_id": 37834407, "link": "https://stackoverflow.com/questions/37834407/error-9-subscript-out-of-range-excel-vba", "title": "Error 9 : subscript out of range Excel VBA", "body": "<p>Hello I am trying to define the Range via some value in sheet, but i am unable to do this. Also i am not sure what causing this issue.</p>\n\n<p><strong>My Code</strong> </p>\n\n<pre><code>   Dim row As Range\nFor Each row In [table2].Rows\n\nFor Each c In Worksheets(row.Columns(row.ListObject.ListColumns(\"Sheet\").Index).Value)\n.Range((row.Columns(row.ListObject.ListColumns(\"RangeBegin\").Index).Value) \n+ \":\" + \n(row.Columns(row.ListObject.ListColumns(\"RangeEnd\").Index).Value))\n\n  If c.Value = \"O\" Then\n     Sheets(\"master\").Cells(2, 3).Copy\n     Sheets(row.Columns(row.ListObject.ListColumns(\"Sheet\").Index).Value).Select\n     c.Select\n     ActiveSheet.Paste\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/Dhfu7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Dhfu7.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["tsql", "sql-server-2008", "ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1465994252, "post_id": 37834354, "comment_id": 63132451, "body": "How are you running the procedures? By executing a Pass-Through query? In any case, you won&#39;t be able to show progress, only that the procedure is still running."}], "answers": [{"comments": [{"owner": {"reputation": 632, "user_id": 6165495, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-Arf292SOBCA/AAAAAAAAAAI/AAAAAAAAADc/q0xiAMkOREE/photo.jpg?sz=128", "display_name": "Arockia Nirmal", "link": "https://stackoverflow.com/users/6165495/arockia-nirmal"}, "edited": false, "score": 0, "creation_date": 1466069471, "post_id": 37840573, "comment_id": 63168584, "body": "Thanks for your kind reply! Between I have solved it in another way. I open a new form before the procedures start running which informs the user that the procedure is running and I am closing the form again after all the procedures ran."}], "tags": [], "owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "is_accepted": false, "score": 0, "last_activity_date": 1466006839, "creation_date": 1466006839, "answer_id": 37840573, "question_id": 37834354, "link": "https://stackoverflow.com/questions/37834354/informing-user-about-the-progress-of-sql-procedure-execution-in-ms-access/37840573#37840573", "title": "Informing user about the progress of sql procedure execution in MS Access", "body": "<p>You can't use MS-Access in asynchronous calls - even if you had a way to set a file-based counter from your stored procedure - you wouldn't be able to track it from inside Access while the stored procedure is running.</p>\n\n<p>The only two ways I see that could do something like this is to</p>\n\n<ul>\n<li>change your stored procedure to handle some kind of paging counter -\nusing a loop in VBA, and passing, tracking and incrementing a first\npointer and last pointer to your stored procedure - then reporting on\nprogress, or, </li>\n<li>find a way to shell-nowait out to call the stored procedure and then\nmonitor and report on the progress in VBA</li>\n</ul>\n"}], "owner": {"reputation": 632, "user_id": 6165495, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-Arf292SOBCA/AAAAAAAAAAI/AAAAAAAAADc/q0xiAMkOREE/photo.jpg?sz=128", "display_name": "Arockia Nirmal", "link": "https://stackoverflow.com/users/6165495/arockia-nirmal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594641930, "creation_date": 1465990623, "last_edit_date": 1594641930, "question_id": 37834354, "link": "https://stackoverflow.com/questions/37834354/informing-user-about-the-progress-of-sql-procedure-execution-in-ms-access", "title": "Informing user about the progress of sql procedure execution in MS Access", "body": "<p>In my application I have SQL Server 2008 in the backend and MS Access 2010 in the front end. I have long running procedures that are executed through MS Access. For example now I need to show a messege box in the MS ACCESS front end to the user when the SQL procedure is currently running. Please provide me an idea how can I accomplish that... Thanks in advance!</p>\n"}, {"tags": ["vba", "dictionary", "count"], "comments": [{"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1465990442, "post_id": 37834227, "comment_id": 63129633, "body": "I don&#39;t think it&#39;s possible without looping; unless you count the value on the Add: <code>If myVal = &quot;&quot; Then counter = counter + 1</code> before the <code>.Add</code> on the dictionary object"}, {"owner": {"reputation": 4085, "user_id": 4185106, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/er5li.png?s=128&g=1", "display_name": "moffeltje", "link": "https://stackoverflow.com/users/4185106/moffeltje"}, "reply_to_user": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1465990502, "post_id": 37834227, "comment_id": 63129680, "body": "@Dave yeah that&#39;s my backup plan but if it is possible I prefer it without counter variable."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1465990602, "post_id": 37834227, "comment_id": 63129761, "body": "Why would you want to avoid looping? It is just a few lines of code and will run quickly even with thousands of entries. VBA isn&#39;t like R where you can vectorize your code."}, {"owner": {"reputation": 4085, "user_id": 4185106, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/er5li.png?s=128&g=1", "display_name": "moffeltje", "link": "https://stackoverflow.com/users/4185106/moffeltje"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1465990925, "post_id": 37834227, "comment_id": 63130042, "body": "@JohnColeman You&#39;re absolutely right, but if it is possible, I would prefer to have it without loop."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1465991474, "post_id": 37834227, "comment_id": 63130476, "body": "To avoid loops in that part of the code -- write your own wrapper-class for dictionary objects which contains methods to implement the functionality that you desire."}, {"owner": {"reputation": 4085, "user_id": 4185106, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/er5li.png?s=128&g=1", "display_name": "moffeltje", "link": "https://stackoverflow.com/users/4185106/moffeltje"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1466002393, "post_id": 37834227, "comment_id": 63138677, "body": "@JohnColeman Very clever, thanks for that tip!"}], "answers": [{"comments": [{"owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "reply_to_user": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 1, "creation_date": 1466001328, "post_id": 37838300, "comment_id": 63137885, "body": "I&#39;m curious to know if its faster than looping through the dictionary! xD"}, {"owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "edited": false, "score": 0, "creation_date": 1466021315, "post_id": 37838300, "comment_id": 63150042, "body": "I did one more test with 500,000 elements in the dictionary. Looping and counting took my HP-asuarus ~29 seconds, but counting by splitting took less than 1 second. It is amazing to me that what I thought would be a kludge to avoid a perfectly logical way to do things turned out to be so much better. As a caveat, care should be taken if the 1st or last elements match the search criteria. Also, a string is limited to ~2 billion characters, so if concatenating all the dictionary elements creates a longer string, you will get an error."}, {"owner": {"reputation": 4085, "user_id": 4185106, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/er5li.png?s=128&g=1", "display_name": "moffeltje", "link": "https://stackoverflow.com/users/4185106/moffeltje"}, "edited": false, "score": 0, "creation_date": 1466083347, "post_id": 37838300, "comment_id": 63178162, "body": "@Tim Thanks for your dedication to make this answer a perfect one."}], "tags": [], "owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "is_accepted": true, "score": 4, "last_activity_date": 1466021982, "last_edit_date": 1466021982, "creation_date": 1466000893, "answer_id": 37838300, "question_id": 37834227, "link": "https://stackoverflow.com/questions/37834227/count-value-occurrences-without-looping-through-dictionary/37838300#37838300", "title": "Count Value occurrences without looping through dictionary", "body": "<p><del>This is ugly, but it is not a loop:</del></p>\n\n<p>As it turns out, this method works very quickly for even super large dictionaries.</p>\n\n<pre><code>'Convert the Dictionary to an Array\nMyArray = dic.Items\n'Convert the Array to a String\nMyString = Join(MyArray, \";\")\n'Blank Items in the Dictionary will result in \";;\" appearing in the String\n'Split the String on ;;\nMyArray = Split(MyString, \";;\", -1, vbTextCompare)\n'A String with no \";;\"'s will result in a 1 element array\n'A String with 2 occurances of ;; will give a 3 element array\nNumberOfBlankItems = UBound(MyArray)\n</code></pre>\n\n<p>Made some edits to fix a few small logic errors (Split was wrong number of arguments and since it is a zero based array, there's no need to subtract 1)</p>\n\n<p>Also, I test with a 20,000 element dictionary, and there is no appreciable speed difference between looping through the dictionary versus this method. Maybe its not as ugly as I thought...</p>\n\n<hr>\n\n<p>I did one more test using this code:</p>\n\n<pre><code>Sub DictionaryTest()\n    Dim dic As New Dictionary 'Variant\n    Dim r As Long\n    Dim key As Variant\n    Dim myArray As Variant\n    Dim mystring As String\n    Dim NumberOfBlankItems As Integer\n\n    Set dic = CreateObject(\"Scripting.Dictionary\")\n    For r = 1 To 500000\n        dic.Add \"Key \" &amp; r, CInt(Int((600 * Rnd()) + 1))\n    Next\n\n    r = 0\n\n    Debug.Print \"Starting count by looping: \" &amp; Now()\n\n    For Each key In dic\n        If dic.item(key) = 300 Then r = r + 1\n    Next\n\n    Debug.Print \"Count by looping: \" &amp; r\n\n    Debug.Print \"Starting count by splitting: \" &amp; Now()\n\n    myArray = dic.Items\n    mystring = Join(myArray, \";\")\n    myArray = Split(mystring, \"300;\", -1, vbTextCompare)\n    NumberOfBlankItems = UBound(myArray)\n    Debug.Print \"Count by splitting: \" &amp; NumberOfBlankItems\n\n    Debug.Print \"Finish time: \" &amp; Now()\nEnd Sub\n</code></pre>\n\n<p>Immediate Window:</p>\n\n<pre><code>Starting count by looping: 6/15/2016 3:02:47 PM\nCount by looping: 818\nStarting count by splitting: 6/15/2016 3:03:16 PM\nCount by splitting: 818\nFinish time: 6/15/2016 3:03:16 PM\n</code></pre>\n\n<p>As you can see, even with 500,000 entries in the dictionary, the amount of time it takes to split the string (a string with almost 2 billion characters no less!) is still only about 1 second!</p>\n"}], "owner": {"reputation": 4085, "user_id": 4185106, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/er5li.png?s=128&g=1", "display_name": "moffeltje", "link": "https://stackoverflow.com/users/4185106/moffeltje"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1225, "favorite_count": 1, "accepted_answer_id": 37838300, "answer_count": 1, "score": 2, "last_activity_date": 1466083550, "creation_date": 1465990299, "last_edit_date": 1466083550, "question_id": 37834227, "link": "https://stackoverflow.com/questions/37834227/count-value-occurrences-without-looping-through-dictionary", "title": "Count Value occurrences without looping through dictionary", "body": "<p>In my VBA program I have a dictionary</p>\n\n<pre><code>Dim dic As Variant\nSet dic = CreateObject(\"Scripting.Dictionary\")\n</code></pre>\n\n<p>I'm adding a bunch of String items (let's say 100) where some have the value <code>\"\"</code></p>\n\n<p>Example:</p>\n\n<pre><code>  Key    |   Value\n-------------------\n  \"A\"    |    1\n  \"B\"    |    \"\"\n  \"C\"    |    3\n  \"D\"    |    4\n  \"E\"    |    \"\"\n etc.\n</code></pre>\n\n<p>I know there is a way to count the number of key occurrences with <code>dic.Count(\"A\")</code> but I would like to count how many Items in my dictionary have the Value <code>\"\"</code> (2 in my example) without looping through each item.</p>\n\n<p>I tried the following without success:</p>\n\n<pre><code>MsgBox \"dic.item()count=\" &amp; dic.Item(\"\").Count\nMsgBox \"dic.item()count=\" &amp; dic(\"\").Count\n</code></pre>\n\n<p>How can this be achieved? Is there a way like <code>dic.Value(\"\").Count</code> ?</p>\n"}, {"tags": ["excel", "vba", "jenkins", "vbscript", "parameters"], "comments": [{"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1465990675, "post_id": 37834014, "comment_id": 63129834, "body": "Are you returning the following as a string? <code>&#39;Y&#39;:&#39;Input for cel C3&#39;, &#39;N&#39;:&#39;Input for cel C4&#39;, &#39;S&#39;: &#39;Input for cel C9&#39;, &#39;A&#39;:&#39;Input for cel C10&#39;</code>"}, {"owner": {"reputation": 37, "user_id": 6356281, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/660e22b67521f0ac0be553913ce62c0c?s=128&d=identicon&r=PG&f=1", "display_name": "J.Doe", "link": "https://stackoverflow.com/users/6356281/j-doe"}, "reply_to_user": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1465991994, "post_id": 37834014, "comment_id": 63130837, "body": "Yes, The selection &quot;input for cel C3&quot;, Gives me a string &quot;Y&quot;, aswell as for the others"}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1465992180, "post_id": 37834014, "comment_id": 63130981, "body": "My answer below will work if the argument you pass into the string reads <code>&#39;Y&#39;:&#39;Input for cel C3&#39;, &#39;N&#39;:&#39;Input for cel C4&#39;, &#39;S&#39;: &#39;Input for cel C9&#39;, &#39;A&#39;:&#39;Input for cel C10&#39;</code>; if that&#39;s not the case I&#39;ll need to edit it?"}, {"owner": {"reputation": 37, "user_id": 6356281, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/660e22b67521f0ac0be553913ce62c0c?s=128&d=identicon&r=PG&f=1", "display_name": "J.Doe", "link": "https://stackoverflow.com/users/6356281/j-doe"}, "reply_to_user": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1465993643, "post_id": 37834014, "comment_id": 63132024, "body": "I think im leading you to the wrong way with my odd description.  The letters &quot;N&quot; , &quot;S&quot;  etc are wrong because they need to be unique. I cant somehow use 4x &quot;Y&quot; in this script"}, {"owner": {"reputation": 37, "user_id": 6356281, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/660e22b67521f0ac0be553913ce62c0c?s=128&d=identicon&r=PG&f=1", "display_name": "J.Doe", "link": "https://stackoverflow.com/users/6356281/j-doe"}, "reply_to_user": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1465993792, "post_id": 37834014, "comment_id": 63132126, "body": "Basically they all need to print the letter &quot;Y&quot;.  All i want is for when i select 1 of the 4 options (the &#39;input for cell ...&quot;  ) to give me a &quot;Y&quot; as output, and place that in the cell that matches the cells inside excel. So when i select &quot;input for c3&quot; it prints me out a &quot;Y&quot; string, which then that needs to get placed inside cell c3 in excel. When i select input for cell c5, and thus not select input for C4,  cell c4 needs to be skipped, and the input given by &quot;input for cell c5&quot; needs to be palced in cell C5 inside excel,"}, {"owner": {"reputation": 37, "user_id": 6356281, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/660e22b67521f0ac0be553913ce62c0c?s=128&d=identicon&r=PG&f=1", "display_name": "J.Doe", "link": "https://stackoverflow.com/users/6356281/j-doe"}, "reply_to_user": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1465993844, "post_id": 37834014, "comment_id": 63132172, "body": "When i select &quot;Input for cell c3&quot; &amp; &quot;Input for cell 5&quot;, i want the letter &quot;Y&quot; to be only filled inside C3 &amp; C5 within Excel."}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1465993846, "post_id": 37834014, "comment_id": 63132175, "body": "If it&#39;s just setting a Y in whatever cell you pass in, then just pass the cell value to the vbscript and let it Set the &quot;Y&quot; for you.  I&#39;ll edit my answer a bit so you can see what I&#39;m meaning"}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 6356281, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/660e22b67521f0ac0be553913ce62c0c?s=128&d=identicon&r=PG&f=1", "display_name": "J.Doe", "link": "https://stackoverflow.com/users/6356281/j-doe"}, "edited": false, "score": 1, "creation_date": 1465994985, "post_id": 37834549, "comment_id": 63133015, "body": "Thanks Dave, Youre my Hero"}], "tags": [], "owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "is_accepted": true, "score": 0, "last_activity_date": 1465994018, "last_edit_date": 1465994018, "creation_date": 1465991142, "answer_id": 37834549, "question_id": 37834014, "link": "https://stackoverflow.com/questions/37834014/jenkins-building-excel-by-vbscript-and-parameterized-build/37834549#37834549", "title": "Jenkins building Excel by VBScript and Parameterized build", "body": "<p>Based on your code above, it seems you need to split the input variable and iterate over it like this:</p>\n\n<pre><code>Dim xlApp\nDim wkBk\nDim wSheet\nDim iLoop, setVal, setCell, myArguments, tempArray\n\nSet xlApp = CreateObject(\"Excel.Application\")\n\nxlApp.visible = True \nSet wkBk =  xlApp.Workbooks.Open(\"D:\\location\\of\\excelFile\\Excel.xlsb\")\nSet wSheet = wkBk.WorkSheets(\"Sheetname\")\nmyArguments = Split(Wscript.Arguments(0), \",\") ' myArguments is now an array of the cells to be updated\nFor iLoop = 0 to UBound(myArguments)\n    wSheet.Range(myArguments(iLoop)).Value = \"Y\" \nNext\nwkBk.Save\n</code></pre>\n\n<p>Edit 1 : If you are always setting a \"Y\", then just pass in the Cells you want updated as a comma separated string e.g. <code>\"C1,C3,C5\"</code>.  The code above will set a Y in each of the cells passed into the script and not any others.</p>\n"}], "owner": {"reputation": 37, "user_id": 6356281, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/660e22b67521f0ac0be553913ce62c0c?s=128&d=identicon&r=PG&f=1", "display_name": "J.Doe", "link": "https://stackoverflow.com/users/6356281/j-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 855, "favorite_count": 0, "accepted_answer_id": 37834549, "answer_count": 1, "score": 0, "last_activity_date": 1465994018, "creation_date": 1465989706, "last_edit_date": 1495541758, "question_id": 37834014, "link": "https://stackoverflow.com/questions/37834014/jenkins-building-excel-by-vbscript-and-parameterized-build", "title": "Jenkins building Excel by VBScript and Parameterized build", "body": "<p><a href=\"https://stackoverflow.com/questions/37326446/changing-excel-spreadsheet-cells-through-the-usage-of-jenkins\">Changing Excel spreadsheet cells through the usage of Jenkins</a></p>\n\n<p>My seek in help is based on the link above. I've been working on this for like 3 months, but still can't find a solution to it. I hope someone can help me out.  </p>\n\n<p>I want to achive the following:</p>\n\n<ol>\n<li>Get a specific excel sheet cell filled in by a value. In my case the letter \u201cY\u201d (See image 1) <a href=\"https://i.stack.imgur.com/Xe07H.jpg\" rel=\"nofollow noreferrer\">Image 1</a></li>\n<li>Get the excel sheet cell filled with the letter \"Y\" through the selection from the Jenkins user interface(Parameterized build) (See image 2) <a href=\"https://i.stack.imgur.com/wvBFG.jpg\" rel=\"nofollow noreferrer\">Image 2</a></li>\n<li>Get the letter \"Y\" be filled in a specfific cell inside the Excel Sheet. So when i select \"Input for cell c3 as seen in image 2, i want to make sure that the letter \"Y\" gets excatlly filled inside Cell C3 in Excel and not other cells aswell. </li>\n</ol>\n\n<p>So basically when I select \u201cTestdata A\u201d as Head and \u201cInput for cel C3\u201d as Sub,  I want the value \u201cY\u201d to be written inside cell C3 inside Excel. \nCurrently I managed to get the letter \u201cY\u201d behind the names \u201cinput for cel C3\u201d. I do this with the code: </p>\n\n<pre><code>if (Head.equals(\"Testdata A\")) {\n  return ['Y':'Input for cel C3', 'N':'Input for cel C4', 'S': 'Input for cel C9', 'A':'Input for cel C10']\n}\n</code></pre>\n\n<p>In my VBSCript I use a code to get the excel be filled by the value I select through Jenkins, but this code simply indicated that the cells C3, c4 and C5 all needs to get filled with 1 given argument.So even if i select \"input for c3\", all other cells will also get filled. The code is: </p>\n\n<pre><code>Dim xlApp\nDim wkBk\nDim wSheet\nDim y\nDim n\n\nSet xlApp = CreateObject(\"Excel.Application\")\n\nxlApp.visible = True \nSet wkBk =  xlApp.Workbooks.Open(\"D:\\location\\of\\excelFile\\Excel.xlsb\")\nSet wSheet = wkBk.WorkSheets(\"Sheetname\")\n\nwSheet.Range(\"C3\").Value =  Wscript.Arguments(0) \nwSheet.Range(\"C4\").Value = Wscript.Arguments(0)\nwSheet.Range(\"C5\").Value = Wscript.Arguments(0)\n\nwkBk.Save\n</code></pre>\n\n<p>I call my vbscript with the parameter argument as followed: </p>\n\n<pre><code>call D:\\location\\to\\script\\.vbs %Sub%\n</code></pre>\n\n<p>Guys/girls, help me out, How can i manage to fill a specific cell through a selection from Jenkins. </p>\n"}, {"tags": ["excel", "vba", "charts"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1466164314, "post_id": 37832733, "comment_id": 63216609, "body": "I don&#39;t see where your code <i>uses</i> the variable <code>myColor</code>. I see values assigned to that variable in the case statements, but once assigned they seem to be just overwritten before use in the next pass through the loop."}, {"owner": {"reputation": 13, "user_id": 6218580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b81446a7243603a153cd7b8844acd7b?s=128&d=identicon&r=PG&f=1", "display_name": "lillinoa", "link": "https://stackoverflow.com/users/6218580/lillinoa"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1466407825, "post_id": 37832733, "comment_id": 63284643, "body": "@John Coleman. I am not sure I understand, should I have added something to &quot;tell&quot; the values to stick with the colors ? In the first loop for p=1 to srs.Points.Count, I use &#39;myColor&#39;. But I don&#39;t understand how it&#39;s overwritten since the two loops are distinct."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6218580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b81446a7243603a153cd7b8844acd7b?s=128&d=identicon&r=PG&f=1", "display_name": "lillinoa", "link": "https://stackoverflow.com/users/6218580/lillinoa"}, "edited": false, "score": 0, "creation_date": 1466424054, "post_id": 37921059, "comment_id": 63294185, "body": "Thank you so much it solved it perfectly ! Have a nice day !"}], "tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": true, "score": 0, "last_activity_date": 1466421099, "creation_date": 1466421099, "answer_id": 37921059, "question_id": 37832733, "link": "https://stackoverflow.com/questions/37832733/vba-my-code-does-either-coloring-or-changing-form-but-forgets-to-do-both/37921059#37921059", "title": "VBA - My code does either coloring or changing form but &quot;forgets&quot; to do both", "body": "<p>In the first loop, you are assigning values to the variable <code>myColor</code> but then are not doing anything with that variable. You need to assign the color to the point. </p>\n\n<p>Replace</p>\n\n<pre><code>With pt.Format.Fill\n        .Visible = msoTrue\n       Select Case LCase(cl)\n' changing color for the one next to its cell\n            Case \"red\"\n                myColor = RGB(217, 0, 18)\n            Case \"blue\"\n                myColor = RGB(77, 63, 255)\n            Case \"green\"\n                myColor = RGB(28, 210, 32)\n        End Select\n    End With\n</code></pre>\n\n<p>with</p>\n\n<pre><code>With pt.Format.Fill\n        .Visible = msoTrue\n       Select Case LCase(cl)\n' changing color for the one next to its cell\n            Case \"red\"\n                myColor = RGB(217, 0, 18)\n            Case \"blue\"\n                myColor = RGB(77, 63, 255)\n            Case \"green\"\n                myColor = RGB(28, 210, 32)\n        End Select\n        .BackColor.RGB = myColor\n        .ForeColor.RGB = myColor\n    End With\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6218580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b81446a7243603a153cd7b8844acd7b?s=128&d=identicon&r=PG&f=1", "display_name": "lillinoa", "link": "https://stackoverflow.com/users/6218580/lillinoa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 37921059, "answer_count": 1, "score": 0, "last_activity_date": 1466421099, "creation_date": 1465986330, "last_edit_date": 1466163866, "question_id": 37832733, "link": "https://stackoverflow.com/questions/37832733/vba-my-code-does-either-coloring-or-changing-form-but-forgets-to-do-both", "title": "VBA - My code does either coloring or changing form but &quot;forgets&quot; to do both", "body": "<p>I'm having some issue with something I've been trying to do on excel : I've written something -bit of me, bit of what I could find on the internet hen I was stuck- that creates a chart (scatter) and should show points that have different colors, depending on values in a column just next to the y values and have different Markerstyle depending on the values in a column a bit further away. However, it only remembers to do one of the things I asked.</p>\n\n<pre><code>Sub Figure2()\n'\n' Figure2 Macro\nDim i As Integer\nDim j As Integer\nDim LastColumn As Long\nDim LastRow As Long\nDim u As Integer\nDim NameRng As String\nDim CountsRng As Range\nDim xRng As Range\nDim x As Long\n\nLastColumn = ActiveSheet.Cells(1, Columns.Count).End(xlToLeft).Column\nColumnCount = LastColumn\nLastRow = ActiveSheet.Range(\"A\" &amp; ActiveSheet.Rows.Count).End(xlUp).Row\n' Debug.Print (\"Last Column: \" &amp; LastColumn &amp; \" Count: \" &amp; ColumnCount &amp; \"   LastRow: \" &amp; LastRow)\n\n' Cr\u00e9ation du graph\nRange(\"A1:B1\").Select\nRange(Selection, Selection.End(xlDown)).Select\nActiveSheet.Shapes.AddChart.Select\nActiveChart.ChartType = xlXYScatter\nActiveChart.SetSourceData Source:=Range(\"Feuil3!$A$1:$B$\" &amp; LastRow)\nActiveChart.Legend.Select\nSelection.Delete\n\n' For colors\nDim cht As Chart\nDim srs As Series\nDim pt As Point\nDim p As Long\nDim Vals$, lTrim#, rTrim#\nDim valRange As Range, cl As Range\nDim myColor As Long\nDim srsi As Series\nDim pti As Point\nDim pi As Long\n\nSet cht = ActiveSheet.ChartObjects(1).Chart\nSet srs = cht.SeriesCollection(1)\n\nlTrim = InStrRev(srs.Formula, \",\", InStrRev(srs.Formula, \",\") - 1, vbBinaryCompare) + 1\nrTrim = InStrRev(srs.Formula, \",\")\nVals = Mid(srs.Formula, lTrim, rTrim - lTrim)\nSet valRange = Range(Vals)\n\nFor p = 1 To srs.Points.Count\n    Set pt = srs.Points(p)\n' where to go for values\n    Set cl = valRange(p).Offset(0, 1)\n    With pt.Format.Fill\n        .Visible = msoTrue\n       Select Case LCase(cl)\n' changing color for the one next to its cell\n            Case \"red\"\n                myColor = RGB(217, 0, 18)\n            Case \"blue\"\n                myColor = RGB(77, 63, 255)\n            Case \"green\"\n                myColor = RGB(28, 210, 32)\n        End Select\n    End With\n    Next\n' Everything working so far, with the graph and the right colors\n</code></pre>\n\n<p>Now this is where I'm having trouble as when I write what follows, excel forgets about the colors it just put and just remembers to change the form</p>\n\n<pre><code>' Changing MarkerStyle\n\n    Set srsi = cht.SeriesCollection(1)\n    For pi = 1 To srsi.Points.Count\n    Set pti = srsi.Points(pi)\n' where to go for values\n</code></pre>\n\n<p>This time it should go to another column as the one before</p>\n\n<pre><code>    Set cli = valRange(pi).Offset(0, 3)\n    With pti.Format.Fill\n        .Visible = msoTrue\n       Select Case LCase(cli)\n' going three columns from here\n            Case \"boxer\"\n' changing\n                 pti.MarkerStyle = xlMarkerStyleDiamond\n                 pti.MarkerSize = 7\n            Case \"\"\n                 pti.MarkerStyle = xlMarkerStyleCircle\n                 pti.MarkerSize = 6\n            Case \"ea390/398\"\n                 pti.MarkerStyle = xlMarkerStyleTriangle\n                 pti.MarkerSize = 6\n        End Select\n    End With\nNext\n\nEnd Sub\n</code></pre>\n\n<p>At the end, I have a plot with only red points and different forms.\nDo you know where I went wrong ?\nThank you for your help</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 206726, "user_id": 5459839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iehrR.jpg?s=128&g=1", "display_name": "trincot", "link": "https://stackoverflow.com/users/5459839/trincot"}, "edited": false, "score": 0, "creation_date": 1467112876, "post_id": 37832627, "comment_id": 63586127, "body": "Did any of the answers resolve your question? Could you leave a comment or accept the answer of your choice?"}], "answers": [{"tags": [], "owner": {"reputation": 1240, "user_id": 3918993, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/aPf5t.jpg?s=128&g=1", "display_name": "TheGuyThatDoesn&#39;tKnowMuch", "link": "https://stackoverflow.com/users/3918993/theguythatdoesntknowmuch"}, "is_accepted": false, "score": 0, "last_activity_date": 1465988225, "creation_date": 1465988225, "answer_id": 37833480, "question_id": 37832627, "link": "https://stackoverflow.com/questions/37832627/copying-a-specfic-line-within-a-cell-into-another-cell/37833480#37833480", "title": "Copying a specfic line within a cell into another cell", "body": "<p>I'm providing an answer even though you haven't provided what attempts you've made so far, which is how questions on this site usually work...but today I'm feeling generous :)</p>\n\n<p>Use a combination of <code>MID</code> and <code>FIND</code> formulas, like the following:</p>\n\n<pre><code>=MID(A1,FIND(\"University\",A1),FIND(\"Degree\",A1)-FIND(\"University\",A1)-2)\n</code></pre>\n\n<p>I put your example text in Cell A1 for my test, and it returned <code>University: 1</code>.  This however will only work if <code>University</code> is always followed by <code>Degree</code> in the text strings.</p>\n\n<p>The other method would be to replace the last part of your <code>MID</code> statement (the part asking for length to return) with the exact number of characters to return, which in this case would be 13, like the following:</p>\n\n<pre><code>=MID(A1,FIND(\"University\",A1),13)\n</code></pre>\n\n<p>This assumes that the integer associated with <code>University</code> is always 1 character in length.</p>\n\n<p>Either way, a combination of the above two formulas should get you what you need.  VBA should not be necessary in this case.</p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 5789025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd984ba6efa96feea59b47111fc9fb15?s=128&d=identicon&r=PG&f=1", "display_name": "Ar4i", "link": "https://stackoverflow.com/users/5789025/ar4i"}, "is_accepted": false, "score": 0, "last_activity_date": 1465988521, "creation_date": 1465988521, "answer_id": 37833559, "question_id": 37832627, "link": "https://stackoverflow.com/questions/37832627/copying-a-specfic-line-within-a-cell-into-another-cell/37833559#37833559", "title": "Copying a specfic line within a cell into another cell", "body": "<p>Lines in a cell value are separated by the line feed character <code>vbLf</code>, so to extract the information out of the cell value you can use String-Functions <code>Mid(...)</code> and <code>InStr(...)</code>:</p>\n\n<pre><code>Dim cellValue as String\nDim extracedValue as String\nDim keyWord as String\nDim posStart as Integer, posEnd as Integer\n\nextractedValue = \"\" ' Not necessary, but I prefer initialized variables\ncellValue = ActiveSheet.Cells(1,1).Value ' Put your cell here\nkeyWord = \"University\" ' Put your keyword here\n\nposStart = InStr(1, cellValue, keyWord) ' Find keyword in the string\nIf (posStart &gt; 0) Then\n    posEnd = InStr(posStart, cellValue, vbLf) ' Find next line feed after the keyword\n    If (posEnd &gt; 0) Then\n        extractedValue = Mid(cellValue, posStart, posEnd - posStart) ' Extract the value\n    End If\nEnd If\n</code></pre>\n\n<p>I haven't tested the code, but you should get the idea.</p>\n"}, {"tags": [], "owner": {"reputation": 206726, "user_id": 5459839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iehrR.jpg?s=128&g=1", "display_name": "trincot", "link": "https://stackoverflow.com/users/5459839/trincot"}, "is_accepted": false, "score": 1, "last_activity_date": 1465988613, "creation_date": 1465988613, "answer_id": 37833597, "question_id": 37832627, "link": "https://stackoverflow.com/questions/37832627/copying-a-specfic-line-within-a-cell-into-another-cell/37833597#37833597", "title": "Copying a specfic line within a cell into another cell", "body": "<p>You could do this with an Excel formula.</p>\n\n<p>Assuming your data is in column A, and you want the extraction in column B, and assuming you put a title in row 1, you could do as in the following image:</p>\n\n<p><a href=\"https://i.stack.imgur.com/fLr4c.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fLr4c.png\" alt=\"![enter image description here\"></a></p>\n\n<p>(Note that I have a semi-colon in the formula as list separator, use comma instead)</p>\n\n<p>The formula in <code>B2</code> is:</p>\n\n<pre><code>=MID($A2, FIND(B$1, $A2) + LEN(B$1), \n          FIND(CHAR(10), $A2 &amp; CHAR(10), FIND(B$1, $A2)) - FIND(B$1, $A2) - LEN(B$1))\n</code></pre>\n\n<p>The formula has some duplication; here are some of the parts explained:</p>\n\n<ul>\n<li><code>FIND(B$1, $A2)</code> returns the position of the title in the text</li>\n<li><code>FIND(B$1, $A2) + LEN(B$1)</code> returns the position of what follows that title in the text</li>\n<li><code>FIND(CHAR(10), $A2 &amp; CHAR(10), FIND(B$1, $A2))</code> returns the position of a newline character following the title, making sure that if none is present, a position beyond the string length is returned</li>\n</ul>\n\n<p>As long as you put the column titles to whatever sub-string you are looking for, you can copy/drag the same formula to other columns and rows.</p>\n"}, {"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1465993210, "last_edit_date": 1465993210, "creation_date": 1465988625, "answer_id": 37833603, "question_id": 37832627, "link": "https://stackoverflow.com/questions/37832627/copying-a-specfic-line-within-a-cell-into-another-cell/37833603#37833603", "title": "Copying a specfic line within a cell into another cell", "body": "<p>If there is a <strong>single</strong> break between each line, then in <strong>B1</strong> enter:</p>\n\n<pre><code>=TRIM(MID(SUBSTITUTE($A1,CHAR(10),REPT(\" \",999)),COLUMNS($A:C)*999-998,999))\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/erIXP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/erIXP.png\" alt=\"enter image description here\"></a></p>\n\n<p>This assumes that:</p>\n\n<ul>\n<li>the university line is the <em>third</em> line</li>\n<li>you want the entire line</li>\n</ul>\n"}], "owner": {"reputation": 23, "user_id": 6446020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7b5aa9e8f79ee259b1a4809a4d97c3d?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Farmer", "link": "https://stackoverflow.com/users/6446020/joe-farmer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1465993210, "creation_date": 1465986064, "last_edit_date": 1465988651, "question_id": 37832627, "link": "https://stackoverflow.com/questions/37832627/copying-a-specfic-line-within-a-cell-into-another-cell", "title": "Copying a specfic line within a cell into another cell", "body": "<p>I have a spreadsheet that has multiple lines within a cell, all with line breaks.</p>\n\n<p>e.g.</p>\n\n<pre><code>Name: a\n\nAge: 1\n\nUniversity: 1\n\nDegree: 3\n\nYear: 3\n</code></pre>\n\n<p>I am looking to extract (in this example) the University infomation that is contained within the cell and copy it into another cell in another column.</p>\n\n<p>There are about 1000 records in my document so to copy and paste by hand will be time consuming. </p>\n\n<p>Any help will be appreciated</p>\n\n<p>Cheers </p>\n\n<p>Joe</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 5046, "user_id": 1490783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2fef598821e961cd446ac3f452a2346?s=128&d=identicon&r=PG", "display_name": "Olle Sj&#246;gren", "link": "https://stackoverflow.com/users/1490783/olle-sj%c3%b6gren"}, "is_accepted": false, "score": 0, "last_activity_date": 1465991500, "creation_date": 1465991500, "answer_id": 37834678, "question_id": 37832220, "link": "https://stackoverflow.com/questions/37832220/insertalignmenttab-in-footer/37834678#37834678", "title": "InsertAlignmentTab() in Footer", "body": "<p>You should be able to do both, depending on what exactly it is you want to do.</p>\n\n<p>To set the insertion point in the primary footer:</p>\n\n<pre><code>ActiveWindow.ActivePane.View.SeekView = wdSeekPrimaryFooter \n</code></pre>\n\n<p>To set it back to the main document:</p>\n\n<pre><code>ActiveWindow.ActivePane.View.SeekView = wdSeekMainDocument\n</code></pre>\n\n<p>Also, <code>InsertAlignmentTab</code> can be called on any Range object:</p>\n\n<pre><code>Selection.Range.InsertAlignmentTab wdRight, wdMargin\n</code></pre>\n\n<p>If you put it all together:</p>\n\n<pre><code>ActiveWindow.ActivePane.View.SeekView = wdSeekPrimaryFooter\nSelection.Range.Text = \"Some more text\"\nSelection.Range.InsertAlignmentTab wdRight, wdMargin\nSelection.Range.Text = \"Some text\"\nActiveWindow.ActivePane.View.SeekView = wdSeekMainDocument\n</code></pre>\n\n<p>(Note that <code>Some text</code> and <code>Some more text</code> are reversed, because the <code>InsertAlignmentTab</code> command sends the current range to the right and afterwards the selection is still to the left, at least in my Word 2010 environment.)</p>\n"}, {"tags": [], "owner": {"reputation": 3865, "user_id": 5211752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9hLRL.png?s=128&g=1", "display_name": "Timothy Rylatt", "link": "https://stackoverflow.com/users/5211752/timothy-rylatt"}, "is_accepted": true, "score": 2, "last_activity_date": 1465995371, "creation_date": 1465995371, "answer_id": 37836117, "question_id": 37832220, "link": "https://stackoverflow.com/questions/37832220/insertalignmenttab-in-footer/37836117#37836117", "title": "InsertAlignmentTab() in Footer", "body": "<p>You can also do this without moving the insertion point.</p>\n\n<pre><code>Sub AddAlignmentTabToFooter()\n    Dim rngFooter As Range\n    Set rngFooter = ActiveDocument.Sections(Selection.Information(wdActiveEndSectionNumber)).Footers(wdHeaderFooterPrimary).Range\n    With rngFooter\n        .Text = \"Some more text\"\n        .Collapse wdCollapseStart\n        .InsertAlignmentTab wdRight, wdMargin\n        .InsertBefore \"Some text\"\n    End With\n    Set rngFooter = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5438741"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 776, "favorite_count": 0, "accepted_answer_id": 37836117, "answer_count": 2, "score": 0, "last_activity_date": 1465995371, "creation_date": 1465984990, "question_id": 37832220, "link": "https://stackoverflow.com/questions/37832220/insertalignmenttab-in-footer", "title": "InsertAlignmentTab() in Footer", "body": "<p>I have been attempting to add, using VBA, an alignment tab into the footer text - the line of code concerning this is as such</p>\n\n<pre><code>ActiveDocument.Sections(Selection.Information(wdActiveEndSectionNumber)).Footers(wdHeaderFooterPrimary).Range.Text = \"Some text\" &amp; &lt;ALIGNMENT TAB RIGHT&gt; &amp; \"Some more text\"\n</code></pre>\n\n<p>however, it appears that the InsertAlignmentTab() method can only be used when the insertion point is in the designated position. As I cannot move the insertion point into the footer, I cannot accomplish my goal.</p>\n\n<p>My question is - is there a way to add an alignment tab to the footer without moving the insertion point there or is there a way to move the insertion point into the footer.</p>\n"}, {"tags": ["excel", "vba", "infinite-loop", "lowercase"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1465986630, "post_id": 37832182, "comment_id": 63126904, "body": "I can&#39;t reproduce your issue. Your first version works fine for me, with no infinite loop (and your second version seems pointless). Can you please make a reproducible example (one that also explains the layout of the sheet)?"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1465987547, "post_id": 37832182, "comment_id": 63127580, "body": "Comparing your two versions, it seems that there must be at least one cell with the property that <code>Len(cell.Value) = 0</code> but for some reason <code>LCase(cell.Value)</code> fails to return. I have no idea what would cause this. Circular references? Something weird with volatile UDFs? Corrupt workbook? Until you make it reproducible, there isn&#39;t much to go on."}, {"owner": {"reputation": 67, "user_id": 6405512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/008fab7f7b492694c024fda94fc7abe9?s=128&d=identicon&r=PG", "display_name": "GMV", "link": "https://stackoverflow.com/users/6405512/gmv"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1465989747, "post_id": 37832182, "comment_id": 63129103, "body": "Edited to show a sample of the Excel sheets. The first codes gives me a the &quot;blue cirlce of thought&quot; with several files for me, so it is reproducible for me. Perhaps I am misinterpretating what you mean with &quot;reproducible&quot; though. I am unfamiliar with terms like &#39;volatile UDF&#39;."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1465990153, "post_id": 37832182, "comment_id": 63129407, "body": "I run your code with 600+ cells in row 2 containing upper case letters, and it runs instantaneously, with no infinite loop. By reproducible -- how can someone start with a blank workbook and reproduce the bug? You are running code on existing files. Can you reliably reproduce it on brand-new workbooks? If not -- there is something about the files that the bug appears in, something crucial which you are not telling us (because perhaps you don&#39;t know what it is). For example -- is there any other code, perhaps some even-handlers?"}, {"owner": {"reputation": 67, "user_id": 6405512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/008fab7f7b492694c024fda94fc7abe9?s=128&d=identicon&r=PG", "display_name": "GMV", "link": "https://stackoverflow.com/users/6405512/gmv"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1465990684, "post_id": 37832182, "comment_id": 63129842, "body": "Oright, I apoligize. Did not think that through apparently, I can not reproduce the macro on a clean new worksheet. This macro is part of a few other macros to convert non-office files to excel files in a certain format. The are converted lovely with all their codes untill I added this new macro. Perhaps it has to do with some of the other Macro&#39;s involved, should I edit the original post to contain them all (not familiar with the term &#39;even-handlers&#39;) ?"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1465991398, "post_id": 37832182, "comment_id": 63130417, "body": "It couldn&#39;t hurt to post them (if my guess of an answer doesn&#39;t help)."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1465993670, "post_id": 37832182, "comment_id": 63132035, "body": "Are all of the cells you want to modify in row 2? I think that you are grabbing a larger range then you should be. Maybe <code>Debug.Print Seq.Cells.Count</code>. It might be a larger range than you realize."}, {"owner": {"reputation": 67, "user_id": 6405512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/008fab7f7b492694c024fda94fc7abe9?s=128&d=identicon&r=PG", "display_name": "GMV", "link": "https://stackoverflow.com/users/6405512/gmv"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1465994297, "post_id": 37832182, "comment_id": 63132489, "body": "They are all in row 2. Does xLastCell not go to the last cell that has content in it? Like Ctrl+Shift+End does?... You know it could be that perhaps therefor it continues whereas in the second code it stops as Len(cell. value)=0 is found in the row below?"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1465995215, "post_id": 37832182, "comment_id": 63133181, "body": "If there are any cells with data below row 2, you will grab those rows as well"}, {"owner": {"reputation": 67, "user_id": 6405512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/008fab7f7b492694c024fda94fc7abe9?s=128&d=identicon&r=PG", "display_name": "GMV", "link": "https://stackoverflow.com/users/6405512/gmv"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1465995586, "post_id": 37832182, "comment_id": 63133488, "body": "Well now I feel dumb, so because my cell.value = 0 could happen in the second coding it actually stopped unlike in the first code. Solved why it didn&#39;t work then. Though, I don&#39;t understand why with a clean worksheet it does work... still cells below it. Anyways, I am going to adjust my code. All cells in the row have data so I will make your code a little easier, but many thanks."}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1465996660, "post_id": 37832182, "comment_id": 63134282, "body": "@GMV note that the loop doesn&#39;t stop, it&#39;s just much faster to check the length of the cell value than to write <code>LCase(cell.Value)</code> into it. You should check what the <code>xlLastCell</code> returns to you in the worksheets where it doesn&#39;t work, for example using <code>ActiveCell.SpecialCells(xlLastCell).Address</code>"}, {"owner": {"reputation": 67, "user_id": 6405512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/008fab7f7b492694c024fda94fc7abe9?s=128&d=identicon&r=PG", "display_name": "GMV", "link": "https://stackoverflow.com/users/6405512/gmv"}, "reply_to_user": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1465996881, "post_id": 37832182, "comment_id": 63134456, "body": "@arcadeprecinct That comment confuses me as I have not used &quot;&quot; in my code... Nevertheless it is solved due to the fact that xLastCell was wrong to use by me. My mistake."}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1465997047, "post_id": 37832182, "comment_id": 63134575, "body": "@GMV sorry, used <code>&quot;&quot;</code> instead of <code>LCase(cell.Value)</code> because that&#39;s effectively what happens when the cell is empty and I was too lazy."}, {"owner": {"reputation": 67, "user_id": 6405512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/008fab7f7b492694c024fda94fc7abe9?s=128&d=identicon&r=PG", "display_name": "GMV", "link": "https://stackoverflow.com/users/6405512/gmv"}, "edited": false, "score": 0, "creation_date": 1465997590, "post_id": 37832182, "comment_id": 63134963, "body": "Ah yes, as I wrote in the lastest Edit (of the original post) it just looped forever as it never had a stop / 0 condition. In the second odd coding it worked as Len(v) = 0 would occure. For my particular case I could even trim the code of @John_Coleman as it now simply finds the proper last cell and all of them are full, so I do not need the &#207;f Len(Cell.Value) &gt; 0 part."}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 6405512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/008fab7f7b492694c024fda94fc7abe9?s=128&d=identicon&r=PG", "display_name": "GMV", "link": "https://stackoverflow.com/users/6405512/gmv"}, "edited": false, "score": 0, "creation_date": 1465991974, "post_id": 37834629, "comment_id": 63130821, "body": "That improves it, but now the mouse pointer flickers as he runs the whole set of Macro&#39;s. Let me update the codes on top."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 67, "user_id": 6405512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/008fab7f7b492694c024fda94fc7abe9?s=128&d=identicon&r=PG", "display_name": "GMV", "link": "https://stackoverflow.com/users/6405512/gmv"}, "edited": false, "score": 0, "creation_date": 1465992149, "post_id": 37834629, "comment_id": 63130952, "body": "@GMV   If the macro is being called in a loop -- perhaps you could move <code>Application.ScreenUpdating = False</code> etc. from this sub to the caller."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 67, "user_id": 6405512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/008fab7f7b492694c024fda94fc7abe9?s=128&d=identicon&r=PG", "display_name": "GMV", "link": "https://stackoverflow.com/users/6405512/gmv"}, "edited": false, "score": 0, "creation_date": 1465994340, "post_id": 37834629, "comment_id": 63132530, "body": "@GMV See if the minor tweak to the code helps. In terms of your edited code -- <code>Application.ScreenUpdating = False</code> etc. could be moved to <code>RunAllMacros</code>"}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1465997414, "post_id": 37834629, "comment_id": 63134851, "body": "@JohnColeman I think the check if <code>Len(...)&gt;0</code> is the important part. It speeds the code up by a factor of about 50 for me (if the cells are empty, of course)"}], "tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": true, "score": 0, "last_activity_date": 1465995359, "last_edit_date": 1465995359, "creation_date": 1465991366, "answer_id": 37834629, "question_id": 37832182, "link": "https://stackoverflow.com/questions/37832182/trying-to-understand-the-difference/37834629#37834629", "title": "Trying to understand the difference", "body": "<p>There seems to be some sort of weird interactions (between what, I don't know) going on with your spreadsheet. The following won't reveal what those interactions are but might suppress them. Also, your code has the effect of replacing any blank cells in the range by strings of length zero. I can't imagine that there is any point to this, so I through in a guard against it. I also grabbed the last used cell in Row2 in a more reliable way:</p>\n\n<pre><code>Sub Lowercase()\n    Dim Seq As Range, Cell As Range, LastCell As Range\n\n    Application.ScreenUpdating = False\n    Application.EnableEvents = False\n    Application.Calculation = xlCalculationManual\n\n    Set LastCell = Cells(2, Columns.Count).End(xlToLeft) 'last cell in Row 2 with data, assuming that not all cells in row have data\n    Set Seq = Range(\"A2\", LastCell)\n    For Each Cell In Seq\n        If Len(Cell.Value) &gt; 0 Then Cell.Value = LCase(Cell.Value)\n    Next Cell\n\n    Application.ScreenUpdating = True\n    Application.EnableEvents = True\n    Application.Calculation = xlCalculationAutomatic\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 6405512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/008fab7f7b492694c024fda94fc7abe9?s=128&d=identicon&r=PG", "display_name": "GMV", "link": "https://stackoverflow.com/users/6405512/gmv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 37834629, "answer_count": 1, "score": 3, "last_activity_date": 1465996928, "creation_date": 1465984875, "last_edit_date": 1465996928, "question_id": 37832182, "link": "https://stackoverflow.com/questions/37832182/trying-to-understand-the-difference", "title": "Trying to understand the difference", "body": "<p>I hope nobody will be offended by me asking a question about a <em>working</em> code. I was told, however, SO is also for learning so I hope this will be fine.</p>\n\n<p>What I want is to try and understand the difference between two codes I wrote, one working, one failing. </p>\n\n<p>This code is a failing version:</p>\n\n<pre><code>Sub Lowercase()\nDim Seq As Range\nSet Seq = Range(Range(\"A2\"), ActiveCell.SpecialCells(xlLastCell))\n    For Each cell In Seq\n    cell.Value = LCase(cell.Value)\n    Next cell\nEnd Sub\n</code></pre>\n\n<p>It does put things in lowercase just fine, but it loops forever until I close or minimize Excel.\nThinking on an older code I changed the code to this:</p>\n\n<pre><code>Sub Lowercase()\nDim Seq As Range, v As Variant\nDim L As Long, i As Long\nSet Seq = Range(Range(\"A2\"), ActiveCell.SpecialCells(xlLastCell))\n  For Each cell In Seq\n      v = cell.Value\n      L = Len(v)\n      For i = 1 To L\n          cell.Value = LCase(cell.Value)\n      Next i\n  Next cell\nEnd Sub\n</code></pre>\n\n<p>This works fine (bit slow but okay) nor do I understand why.</p>\n\n<p>The files I am trying to convert look like (The A2 row tends to go on for 600 to 1200 characters):</p>\n\n<p><a href=\"https://i.stack.imgur.com/oHuHP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oHuHP.png\" alt=\"enter image description here\"></a></p>\n\n<p>However, I still call all cells and I am not sure why giving the cell a value it actually stops looping. As, but I am sure I am wrong, I have the feeling I still did not change the \"For each cell / next cell\" part of the coding. </p>\n\n<p>EDIT: It has to do with a faulty use of xlLastCell for my worksheets as that was not the last cell in Row 2. In the second code a value could hit 0, whereas in the first not. The code had to be altered to use a different method to find the last cell.</p>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1465986512, "post_id": 37832168, "comment_id": 63126815, "body": "use union on the ranges before you kick off, so range3=union(range1,range2)"}, {"owner": {"reputation": 1, "user_id": 6468832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2b5e6f3c639415c87935e8a74bf9ce9?s=128&d=identicon&r=PG&f=1", "display_name": "Sakis", "link": "https://stackoverflow.com/users/6468832/sakis"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1465992845, "post_id": 37832168, "comment_id": 63131459, "body": "could you give some more details. Ok I set range3 =union then? How do I assign the cell values from the range to the array? I want for example if the user selects a1:a5 and b1:b5 the unionarr(1) to be the number in cell a1, unionarr(2) to be the value in cell a2 and so on and so forth"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1465993640, "post_id": 37832168, "comment_id": 63132018, "body": "Do the same, but you&#39;ll just have one range."}], "answers": [{"tags": [], "owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "is_accepted": false, "score": 0, "last_activity_date": 1465991365, "creation_date": 1465991365, "answer_id": 37834628, "question_id": 37832168, "link": "https://stackoverflow.com/questions/37832168/how-can-i-store-range-values-to-arrays-and-then-unite-them-in-vba/37834628#37834628", "title": "How can I store range values to arrays and then unite them in VBA?", "body": "<pre><code>Private Sub OK_Click()\n    Dim range1 As Range\n    Dim range2 As Range\n    Dim vArr1 As Variant\n    Dim vArr2 As Variant\n    Dim vCombined() As Variant\n    Dim lComb As Long\n    Dim lRow As Long\n    Dim lCol As Long\n    'Sample1 and 2 provided by the user\n    Set range1 = Range(Sample1.Value)\n    Set range2 = Range(Sample2.Value)\n    vArr1 = range1.Value2\n    vArr2 = range2.Value2\n    'Assuming same # of columns in both ranges!\n    ReDim vCombined(LBound(vArr1, 1) To UBound(vArr1, 1) + UBound(vArr2, 1), LBound(vArr1, 2) To UBound(vArr1, 2))\n    For lRow = LBound(vArr1, 1) To UBound(vArr1, 1)\n        For lCol = LBound(vArr1, 2) To UBound(vArr1, 2)\n            lComb = lComb + 1\n            vCombined(lComb, lCol) = vArr1(lRow, lCol)\n        Next\n    Next\n    For lRow = LBound(vArr2, 1) To UBound(vArr2, 1)\n        For lCol = LBound(vArr2, 2) To UBound(vArr2, 2)\n            lComb = lComb + 1\n            vCombined(lComb, lCol) = vArr2(lRow, lCol)\n        Next\n    Next\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 6468832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2b5e6f3c639415c87935e8a74bf9ce9?s=128&d=identicon&r=PG&f=1", "display_name": "Sakis", "link": "https://stackoverflow.com/users/6468832/sakis"}, "edited": false, "score": 0, "creation_date": 1466017881, "post_id": 37836039, "comment_id": 63148163, "body": "Perfect and simple."}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1465995148, "creation_date": 1465995148, "answer_id": 37836039, "question_id": 37832168, "link": "https://stackoverflow.com/questions/37832168/how-can-i-store-range-values-to-arrays-and-then-unite-them-in-vba/37836039#37836039", "title": "How can I store range values to arrays and then unite them in VBA?", "body": "<pre><code>Sub test()\n\nDim r1 As Range\nDim r2 As Range\nDim r3 As Range\nDim c As Range\nDim a() As Double\nDim iCounter As Integer\n\nSet r1 = Range(\"a1:a10\")\nSet r2 = Range(\"c1:c10\")\n\nSet r3 = Union(r1, r2)\n\nReDim a(r3.Cells.Count)\n\niCounter = 0\n\nFor Each c In r3.Cells\n    a(iCounter) = c.Value\n    iCounter = iCounter + 1\nNext c\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6468832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2b5e6f3c639415c87935e8a74bf9ce9?s=128&d=identicon&r=PG&f=1", "display_name": "Sakis", "link": "https://stackoverflow.com/users/6468832/sakis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 584, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1465995148, "creation_date": 1465984847, "last_edit_date": 1531164843, "question_id": 37832168, "link": "https://stackoverflow.com/questions/37832168/how-can-i-store-range-values-to-arrays-and-then-unite-them-in-vba", "title": "How can I store range values to arrays and then unite them in VBA?", "body": "<p>I am relatively new in VBA and still not able to manipulate range and array values the way I want. </p>\n\n<p>I am building a user form and I want to be able to combine the values from two ranges provided by the user in a single array in order to sort them and then use them to build a statistical test (Wilcoxon). I am struggling to do the first part. I have tried numerous alternations from different questions, but nothing seems to work.</p>\n\n<p>Here is where I got so far:</p>\n\n<pre><code>Private Sub OK_Click()\n    Dim range1 As Range\n    Dim range2 As Range\n\n    Dim k As Integer\n    'Sample1 and 2 provided by the user\n    Set range1 = Range(Sample1.Value)\n    Set range2 = Range(Sample2.Value)\n\n    n = Application.Count(range1)\n    m = Application.Count(range2)\n\n    Dim arr1() As Variant\n    ReDim arr1(1 To n)\n    Dim arr2() As Variant\n    ReDim arr2(1 To m)\n    Dim unionarr() As Variant\n    ReDim unionarr(1 To n + m)\n    Dim x As Variant\n    'store the range values in two arrays\n    arr1 = range1\n    arr2 = range2\n    'combine (unite) the two arrays in a new array\n    For k = 1 To n\n        unionarr(k) = arr1(k)\n        Next k\n\n    For k = n + 1 To n + m\n        unionarr(n + k) = arr2(k)\n        Next k\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 2646581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f643580edc28f42f64c60e0a213a653e?s=128&d=identicon&r=PG", "display_name": "Raabot", "link": "https://stackoverflow.com/users/2646581/raabot"}, "edited": false, "score": 0, "creation_date": 1465986893, "post_id": 37832507, "comment_id": 63127100, "body": "Thanks for the reply - however when i run this it seems to ignore the topic and just count the total rows occupied i.e. I add a LANG topic to the table in my question and it labels it LAN-5. Can&#39;t seem to see where it&#39;s going wrong."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 43, "user_id": 2646581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f643580edc28f42f64c60e0a213a653e?s=128&d=identicon&r=PG", "display_name": "Raabot", "link": "https://stackoverflow.com/users/2646581/raabot"}, "edited": false, "score": 0, "creation_date": 1465989237, "post_id": 37832507, "comment_id": 63128757, "body": "That&#39;s weird.  If I execute the line <code>AddID ThisWorkbook.Worksheets(&quot;Sheet1&quot;).Range(&quot;B6&quot;)</code> with <code>Lang.</code> in C6 it adds <code>Lan-3</code> to B6 and not <code>Lan-5</code>.  You&#39;ve found a solution that works though, so all&#39;s good. :)"}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1465985740, "creation_date": 1465985740, "answer_id": 37832507, "question_id": 37831864, "link": "https://stackoverflow.com/questions/37831864/excel-vba-unique-id-generator/37832507#37832507", "title": "Excel VBA unique ID generator", "body": "<p>This code does the trick, except the first entry for some reason (the Evaluate Formula button shows it's working, but right at the end it replaces the value with 0).</p>\n\n<p>So, manually add the first ID then run the code from row 3 to the last row of your list (you'll also need to add code to ignore empty rows).</p>\n\n<pre><code>Public Sub Test()\n\n    Dim x As Long\n\n    For x = 3 To 7\n        AddID ThisWorkbook.Worksheets(\"Sheet1\").Cells(x, 2)\n    Next x\n\nEnd Sub\n\nPublic Sub AddID(Target As Range)\n\n    'Formula using A1 style:\n    '=LEFT($C7,3) &amp; \"-\" &amp; COUNTIF($B$2:INDEX($B:$B,ROW()-1),LEFT($C7,3) &amp; \"*\")+1\n\n    'Relative column (ID is 1 column left of Topic).\n    Target.FormulaR1C1 = \"=LEFT(RC[1],3) &amp; \"\"-\"\" &amp; COUNTIF(R2C:INDEX(C,ROW()-1), LEFT(RC[1],3) &amp; \"\"*\"\")+1\"\n    'Absolute column (ID is column B, Topic is column C)\n    'Target.FormulaR1C1 = \"=LEFT(RC3,3) &amp; \"\"-\"\" &amp; COUNTIF(R2C2:INDEX(C2,ROW()-1), LEFT(RC3,3) &amp; \"\"*\"\")+1\"\n    Target = Target.Value\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "is_accepted": true, "score": 0, "last_activity_date": 1465987112, "creation_date": 1465987112, "answer_id": 37833065, "question_id": 37831864, "link": "https://stackoverflow.com/questions/37831864/excel-vba-unique-id-generator/37833065#37833065", "title": "Excel VBA unique ID generator", "body": "<p>I adjusted the code you had to include an array like you needed, it does mean you will have to pass into your procedure the name of the topic you are requesting an ID for, this could be automated if needed but its hard to know what the bigger picture is for you project so I have left it as this: -</p>\n\n<pre><code>Private Function getNextID(ByVal StrTopic As String) As String\nStatic AryTopics(2, 1)     As String\nDim row                     As Integer\nDim currentID               As Integer\nDim LngCounter              As Long\ncurrentID = 0\n\n'By having the array declared static and being a fixed size, it will only get built once\n'then rememebered\nIf AryTopics(0, 0) = \"\" Then\n    AryTopics(0, 0) = \"FILM\"\n    AryTopics(0, 1) = \"FIL\"\n    AryTopics(1, 0) = \"LANG.\"\n    AryTopics(1, 1) = \"LAN\"\n    AryTopics(2, 0) = \"GEOG.\"\n    AryTopics(2, 1) = \"GEO\"\nEnd If\n\n'The topic must be passed into the proce to know what to get the ID for\n'This gets the related topic code from the array\nFor LngCounter = 0 To UBound(AryTopics, 1)\n    If AryTopics(LngCounter, 0) = Trim(UCase(StrTopic)) Then\n        StrTopic = AryTopics(LngCounter, 1)\n        Exit For\n    End If\nNext\n\n' Loop round rows\nFor row = MIN_ROW To MAX_ROW\n\n    ' Only use rows which are not blank\n    If Worksheets(DISCUSS).Cells(row, ID).Value &lt;&gt; \"\" Then\n\n        'This checks to see if the ID starts with the related topic code we care about, if it does then we keep checking\n        If Left(Trim(UCase(Worksheets(DISCUSS).Cells(row, ID).Value)), Len(StrTopic) + 1) = StrTopic &amp; \"-\" Then\n\n            If Mid$(Worksheets(DISCUSS).Cells(row, ID).Value, InStr(3, Worksheets(DISCUSS).Cells(row, ID).Value, \"-\") + 1) &gt; currentID Then\n                currentID = Mid$(Worksheets(DISCUSS).Cells(row, ID).Value, InStr(3, Worksheets(DISCUSS).Cells(row, ID).Value, \"-\") + 1)\n            End If\n\n        End If\n    End If\n\nNext row\n\n'Output include the topic code\ngetNextRiskID = StrTopic &amp; \"-\" &amp; currentID + 1\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 2646581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f643580edc28f42f64c60e0a213a653e?s=128&d=identicon&r=PG", "display_name": "Raabot", "link": "https://stackoverflow.com/users/2646581/raabot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3132, "favorite_count": 0, "accepted_answer_id": 37833065, "answer_count": 2, "score": 1, "last_activity_date": 1465987112, "creation_date": 1465984105, "last_edit_date": 1465985796, "question_id": 37831864, "link": "https://stackoverflow.com/questions/37831864/excel-vba-unique-id-generator", "title": "Excel VBA unique ID generator", "body": "<p>I am trying to generate unique IDs for topics of discussion. The data will be like so:</p>\n\n<pre><code>Status    ID        Topic    Commentary\nOpen      FIL-1     FILM      \nOpen      FIL-2     FILM\nClosed    LAN-1     LANG.\nOpen      LAN-2     LANG.\n</code></pre>\n\n<p>The idea is that when on a new row regardless of whether it was added above or below of the last unique ID I use VBA to find the next ID. So for example above if I were to add another row at the top with the topic LANG. then it would find that LAN-2 is the lastest ID and +1 to it to become LAN-3.</p>\n\n<p>I got this working when the topics were all the same with the code below (topics were all \"FIL\" but now there are multiple topics):</p>\n\n<pre><code>Private Function getNextID() As String\n\nDim row As Integer\nDim currentID As Integer\n\ncurrentID = 0\n\n' Loop round rows\nFor row = MIN_ROW To MAX_ROW\n\n    ' Only use rows which are not blank\n    If Worksheets(DISCUSS).cells(row, ID).Value &lt;&gt; \"\" Then\n        If Mid$(Worksheets(DISCUSS).cells(row, ID).Value, InStr(3, Worksheets(DISCUSS).cells(row, ID).Value, \"-\") + 1) &gt; currentID Then\n           currentID = Mid$(Worksheets(DISCUSS).cells(row, ID).Value, InStr(3, Worksheets(DISCUSS).cells(row, ID).Value, \"-\") + 1)\n        End If\n    End If\n\nNext row\n\ngetNextID = \"FIL\" &amp; \"-\" &amp; currentID + 1\n\nEnd Function\n</code></pre>\n\n<p>Does anyone know how I can set an array with the topic abbreviations used in the ID and use the code i've already written to loop through the same process using the abbreviations in the array to get the next ID for the specific topic being added? </p>\n"}, {"tags": ["vba", "excel", "excel-2013"], "comments": [{"owner": {"reputation": 206726, "user_id": 5459839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iehrR.jpg?s=128&g=1", "display_name": "trincot", "link": "https://stackoverflow.com/users/5459839/trincot"}, "edited": false, "score": 0, "creation_date": 1467113234, "post_id": 37831757, "comment_id": 63586386, "body": "Did any of the answers resolve your question? Could you leave a comment or accept the answer of your choice?"}], "answers": [{"comments": [{"owner": {"reputation": 397, "user_id": 4432757, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/1315ff8db14d610cf2b2f14a8733f5f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jeevan", "link": "https://stackoverflow.com/users/4432757/jeevan"}, "edited": false, "score": 0, "creation_date": 1466411428, "post_id": 37832829, "comment_id": 63286581, "body": "This code isn&#39;t working. I guess columnsBefore is same as colsBefore, am I right?"}], "tags": [], "owner": {"reputation": 206726, "user_id": 5459839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iehrR.jpg?s=128&g=1", "display_name": "trincot", "link": "https://stackoverflow.com/users/5459839/trincot"}, "is_accepted": true, "score": 1, "last_activity_date": 1467190051, "last_edit_date": 1467190051, "creation_date": 1465986542, "answer_id": 37832829, "question_id": 37831757, "link": "https://stackoverflow.com/questions/37831757/vba-check-if-next-10-rows-and-10-columns-in-all-4-sides-of-a-excel-table-is-empt/37832829#37832829", "title": "VBA check if next 10 rows and 10 columns in all 4 sides of a Excel Table is empty", "body": "<p>You could use this function:</p>\n\n<pre><code>Option Explicit\n\nFunction NonBlankCellsOutside(rng As Range, rowsOutside As Long, colsOutside As Long)\n    Dim outside As Range\n    Dim rowsBefore As Long\n    Dim colsBefore As Long\n\n    rowsBefore = IIf(rng.Row &lt;= rowsOutside, rng.Row - 1, rng.Row - rowsOutside)\n    colsBefore = IIf(rng.Column &lt;= colsOutside, rng.Column - 1, rng.Column - colsOutside)\n    Set outside = rng.Offset(-rowsBefore, -colsBefore) _\n                     .Resize(rng.Rows.Count + rowsBefore + rowsOutside, _\n                             rng.Columns.Count + colsBefore + colsOutside)\n    NonBlankCellsOutside = WorksheetFunction.CountA(outside) _\n                         - WorksheetFunction.CountA(rng)\nEnd Function\n</code></pre>\n\n<p>Example use with a normal range:</p>\n\n<pre><code>Dim ok As Boolean\n\nok = NonBlankCellsOutside(Worksheets(1).Range(\"C20:F50\"), 10, 10) = 0\nIf Not ok Then MsgBox \"There are non-blank cells in the neighbourhood\"\n</code></pre>\n\n<p>Another example with a named table:</p>\n\n<pre><code>Dim num As Long\n\nnum = NonBlankCellsOutside(ActiveSheet.ListObjects(\"Table1\").Range, 5, 5)\nMsgBox \"There are \" &amp; num &amp; \" non-blank cells around the table\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2327, "user_id": 4742570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0017a2bafead37c0b8dab5d6df77138c?s=128&d=identicon&r=PG&f=1", "display_name": "jsheeran", "link": "https://stackoverflow.com/users/4742570/jsheeran"}, "is_accepted": false, "score": 0, "last_activity_date": 1465988781, "creation_date": 1465988781, "answer_id": 37833660, "question_id": 37831757, "link": "https://stackoverflow.com/questions/37831757/vba-check-if-next-10-rows-and-10-columns-in-all-4-sides-of-a-excel-table-is-empt/37833660#37833660", "title": "VBA check if next 10 rows and 10 columns in all 4 sides of a Excel Table is empty", "body": "<p>You can do this with in-cell formulae.</p>\n\n<p>Given a table named <code>Table1</code> whose top-left corner is no closer to the top or to the left than <code>K11</code>, and the following formulae, the value in <code>A5</code> will give you your answer:</p>\n\n<pre><code>    A           B                           C\n1\n2 Range start   =ROW(Table1)-10             =COLUMN(Table1)-10\n3 Range end     =ROW(Table1)+ROWS(Table1)+9 =COLUMN(Table1)+COLUMNS(Table1)+9\n4\n5 =AND(B2&gt;0, B3&gt;0, COUNTA(INDIRECT(\"r\"&amp;B2&amp;\"c\"&amp;C2&amp;\":r\"&amp;B3&amp;\"c\"&amp;C3, FALSE))=COUNTA(Table1[#All]))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 742, "user_id": 4830209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f36c805d87474402708042645313a454?s=128&d=identicon&r=PG&f=1", "display_name": "Sun", "link": "https://stackoverflow.com/users/4830209/sun"}, "is_accepted": false, "score": 0, "last_activity_date": 1465992980, "creation_date": 1465992980, "answer_id": 37835216, "question_id": 37831757, "link": "https://stackoverflow.com/questions/37831757/vba-check-if-next-10-rows-and-10-columns-in-all-4-sides-of-a-excel-table-is-empt/37835216#37835216", "title": "VBA check if next 10 rows and 10 columns in all 4 sides of a Excel Table is empty", "body": "<p>Here I have something that works for any named table, as long as its first cell is no closer to the edges than K11.</p>\n\n<pre><code>Sub checkSurroundings()\n\nDim tws As Worksheet\nDim tb1 As ListObject\nDim tb1_address As String\n\nDim c() As String               'Table range, first and last cell\n\nDim rngL, rngR, rngU, rngD As Range\n\nDim tmpRange As Range\n\nDim cnt As Integer\n\n\n    Set tws = ThisWorkbook.Worksheets(\"Sheet1\")\n\n    Set tb1 = tws.ListObjects(\"Table1\")\n\n    tb1_address = tb1.Range.Address\n    'Debug.Print tb1_address\n\n    c() = Split(tb1_address, \":\", -1, vbTextCompare)\n    'Debug.Print c(0)\n    'Debug.Print c(1)\n\n    cnt = 0\n\n    With tws\n\n        'Range Left\n        Set rngL = Range(.Range(c(0)).Offset(-10, -10), .Cells(.Range(c(1)).Row + 10, .Range(c(0)).Column - 1))\n\n        'Range Right\n        Set rngR = Range(.Cells(.Range(c(0)).Row - 10, .Range(c(1)).Column + 1), .Range(c(1)).Offset(10, 10))\n\n        'Range Up\n        Set rngU = Range(.Range(c(0)).Offset(-10, 0), .Cells(.Range(c(0)).Row - 1, .Range(c(1)).Column))\n\n        'Range Down\n        Set rngD = Range(.Cells(.Range(c(1)).Row + 1, .Range(c(0)).Column), .Range(c(1)).Offset(10, 0))\n\n    End With\n\n\n    For i = 1 To 4\n\n        Select Case i\n\n            Case 1\n            Set tmpRng = rngL\n\n            Case 2\n            Set tmpRng = rngR\n\n            Case 3\n            Set tmpRng = rngU\n\n            Case 4\n            Set tmpRng = rngD\n\n        End Select\n\n\n        For Each cell In tmpRng\n\n            If Not IsEmpty(cell) Then\n                cnt = cnt + 1\n            End If\n\n        Next cell\n\n    Next i\n\n    If cnt &gt; 0 Then\n        MsgBox (\"The area around Table1 (+-10) is not empty. There are \" &amp; cnt &amp; \" non-empty cells.\")\n    Else\n        MsgBox (\"The area around Table1 (+-10) is empty.\")\n    End If\n\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 397, "user_id": 4432757, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/1315ff8db14d610cf2b2f14a8733f5f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jeevan", "link": "https://stackoverflow.com/users/4432757/jeevan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 37832829, "answer_count": 3, "score": 0, "last_activity_date": 1467190051, "creation_date": 1465983778, "question_id": 37831757, "link": "https://stackoverflow.com/questions/37831757/vba-check-if-next-10-rows-and-10-columns-in-all-4-sides-of-a-excel-table-is-empt", "title": "VBA check if next 10 rows and 10 columns in all 4 sides of a Excel Table is empty", "body": "<p>In VBA Excel, if I have a table. How do I check the cells outside the table in all 4 sides of it, for 10 rows and 10 columns, as empty or not? </p>\n\n<p>Thanks\nJeevan </p>\n"}, {"tags": ["vba", "excel", "intersect"], "comments": [{"owner": {"reputation": 1, "user_id": 6123969, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154723984172586/picture?type=large", "display_name": "Paul Murph", "link": "https://stackoverflow.com/users/6123969/paul-murph"}, "edited": false, "score": 0, "creation_date": 1465983527, "post_id": 37831457, "comment_id": 63124861, "body": "In the code above I have been using the MsgBox as a temporary replacement for the procedure that copies unmatched names into the next available row of column B."}, {"owner": {"reputation": 1269, "user_id": 6065711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bedb05fd942a5a6acd9870d295d3afd9?s=128&d=identicon&r=PG&f=1", "display_name": "Jochen", "link": "https://stackoverflow.com/users/6065711/jochen"}, "edited": false, "score": 1, "creation_date": 1465983728, "post_id": 37831457, "comment_id": 63125004, "body": "intersect checks if ranges overlap (what isnt the case). You have to compare the values. Try using <code>Find</code>."}], "owner": {"reputation": 1, "user_id": 6123969, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154723984172586/picture?type=large", "display_name": "Paul Murph", "link": "https://stackoverflow.com/users/6123969/paul-murph"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 691, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1465983623, "creation_date": 1465982986, "last_edit_date": 1531164843, "question_id": 37831457, "link": "https://stackoverflow.com/questions/37831457/vba-using-intersect-function-to-cycle-through-one-range-to-check-if-values-app", "title": "VBA Using &#39;Intersect&#39; function to cycle through one range to check if values appear in another", "body": "<p>I am new to VBA programming (about 3 months) and have heavily relied on the internet for all my answers, however, I have been unable to find an answer that solves what seems like a simple problem.</p>\n\n<p>I have two ranges and I need to cycle through all the names in one range (Column \"R\") and search the other range (zerange) for each name.  If any of the names from Column \"R\" are not in zerange, those names need to be added to the first available row in zerange.</p>\n\n<p>The best solution I could find was using a 'Do Until' loop to cycle through Column R and use the 'Intersect' function to check if the ActiveCell value (from Column \"R\") appears in zerange.</p>\n\n<p>When running the procedure, 'If Not' results in finding no matches, while using 'If' results in the MsgBox appearing on each Column \"R\" value.</p>\n\n<p>Below is the code I am using.  Thankyou in advance for any advice.</p>\n\n<pre><code>Sub importlid()\n\nDim zerange As Range\n\nSet zerange = Sheets(\"Details\").Range(\"B1\", Range(\"B\" &amp; Rows.Count).End(xlUp))\n\nSheets(\"Live Sheet\").Range(\"P:P\").AdvancedFilter Action:=xlFilterCopy, CopyToRange:=Sheets(\"Details\").Range(\"R:R\"), Unique:=True\n\nSheets(\"Details\").Range(\"R1\").Select\n\n    Do Until ActiveCell = vbNullString\n\n        If Not Application.Intersect(ActiveCell, zerange) Is Nothing Then\n\n            MsgBox \"We got one!\"\n\n        End If\n\n    ActiveCell.Offset(1, 0).Select\n\n    Loop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 257, "user_id": 5662362, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9bacf16a9f4c5b0d533e798df9b69d58?s=128&d=identicon&r=PG&f=1", "display_name": "Ethun_Hunt", "link": "https://stackoverflow.com/users/5662362/ethun-hunt"}, "edited": false, "score": 0, "creation_date": 1465985601, "post_id": 37831373, "comment_id": 63126255, "body": "You can use <code>ISFORMULA</code> function from the worksheet to check if the cell contains the formula and instead of copying the entire row, you can copy the cells containing the formula only. Otherwise you can copy entire row and then delete cells not containing formula."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1465987233, "last_edit_date": 1592644375, "creation_date": 1465987233, "answer_id": 37833111, "question_id": 37831373, "link": "https://stackoverflow.com/questions/37831373/copy-only-formulas-in-multiple-inserted-rows/37833111#37833111", "title": "Copy only formulas in multiple inserted rows", "body": "<p>This will do the trick</p>\n<blockquote>\n<p>Rows(1).Copy</p>\n<p>Rows(2).PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, SkipBlanks:=False, Transpose:=False</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "is_accepted": true, "score": 0, "last_activity_date": 1465989100, "last_edit_date": 1465989100, "creation_date": 1465988766, "answer_id": 37833653, "question_id": 37831373, "link": "https://stackoverflow.com/questions/37831373/copy-only-formulas-in-multiple-inserted-rows/37833653#37833653", "title": "Copy only formulas in multiple inserted rows", "body": "<p>Here is an option</p>\n\n<pre><code>Sub Insert_Multiple_Rows()\n    Tabelle1.Range(\"2:3\").EntireRow.Insert\n    Tabelle1.Range(\"2:3\").Formula = Tabelle1.Range(\"1:1\").Formula\n    Tabelle1.Range(\"2:3\").SpecialCells(xlCellTypeConstants).ClearContents\nEnd Sub\n</code></pre>\n\n<p>otherwise here is another solution</p>\n\n<pre><code>Sub Insert_Multiple_Rows()\n    Tabelle1.Range(\"2:3\").EntireRow.Insert\n    Intersect(Tabelle1.Range(\"1:1\").SpecialCells(xlCellTypeFormulas).EntireColumn, Tabelle1.Range(\"1:3\")).FillDown\nEnd Sub\n</code></pre>\n\n<p>both give same result</p>\n"}], "owner": {"reputation": 3991, "user_id": 4934150, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6edf08d542b9812f5ef681d0a44d9ed7?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4934150/michi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 323, "favorite_count": 0, "accepted_answer_id": 37833653, "answer_count": 2, "score": 0, "last_activity_date": 1465989100, "creation_date": 1465982767, "last_edit_date": 1531161705, "question_id": 37831373, "link": "https://stackoverflow.com/questions/37831373/copy-only-formulas-in-multiple-inserted-rows", "title": "Copy only formulas in multiple inserted rows", "body": "<p>I have the following Excel spreadsheet:</p>\n\n<pre><code>      A                B            C\n1    Product A         $50         =B1*4\n2    Product B         $10         =B2*4\n3    Product C         $20         =B2*4\n</code></pre>\n\n<p>I am using the following formula to insert new rows between row 1 and 2.</p>\n\n<pre><code>Sub Insert_Multiple_Rows()\nTabelle1.Range(\"2:3\").EntireRow.Insert\nTabelle1.Range(\"2:3\").Formula = Tabelle1.Range(\"1:1\").Formula\nEnd Sub\n</code></pre>\n\n<p>This formula works perfectly and inserts new rows and copies all formulas and values.</p>\n\n<p>However, what I want to achieve is that only the cells with formulas will be copied into the new inserted cells and all other cells remain blank. In the case above that would mean only the formulas in column C are copied into the new inserted rows and columns A and B remain blank in the new inserted rows.</p>\n\n<p>Do you guys have any idea how I can exclude cells that contain a value instead of a formula from the insert row code.</p>\n\n<p>Thanks for your help.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2140173"}, "edited": false, "score": 0, "creation_date": 1466243108, "post_id": 37831244, "comment_id": 63244567, "body": "like this has not ever been asked before on the site..."}], "answers": [{"comments": [{"owner": {"reputation": 665, "user_id": 3890577, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/49505033d552f580a098cada779297b1?s=128&d=identicon&r=PG&f=1", "display_name": "Twi", "link": "https://stackoverflow.com/users/3890577/twi"}, "edited": false, "score": 0, "creation_date": 1465984115, "post_id": 37831678, "comment_id": 63125269, "body": "What doesn RC1 mean? How it will iterate with &quot;i&quot; iterator like in my example ?"}, {"owner": {"reputation": 665, "user_id": 3890577, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/49505033d552f580a098cada779297b1?s=128&d=identicon&r=PG&f=1", "display_name": "Twi", "link": "https://stackoverflow.com/users/3890577/twi"}, "edited": false, "score": 0, "creation_date": 1465984503, "post_id": 37831678, "comment_id": 63125547, "body": "I figured out R means row and C columsn, but If i do this: R &amp; i &amp; C2  doesn&#39;t work."}, {"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "reply_to_user": {"reputation": 665, "user_id": 3890577, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/49505033d552f580a098cada779297b1?s=128&d=identicon&r=PG&f=1", "display_name": "Twi", "link": "https://stackoverflow.com/users/3890577/twi"}, "edited": false, "score": 0, "creation_date": 1465984811, "post_id": 37831678, "comment_id": 63125753, "body": "In your example you were using a1 and b1 , then a2 and b2 etc and my solution does this ( in c1, then c2 etc)"}, {"owner": {"reputation": 665, "user_id": 3890577, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/49505033d552f580a098cada779297b1?s=128&d=identicon&r=PG&f=1", "display_name": "Twi", "link": "https://stackoverflow.com/users/3890577/twi"}, "edited": false, "score": 0, "creation_date": 1465985074, "post_id": 37831678, "comment_id": 63125920, "body": "But instead of a1 or b1 i need ai and bi , beacuse it depending from the iterator. And I value can be 1 to any number"}, {"owner": {"reputation": 665, "user_id": 3890577, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/49505033d552f580a098cada779297b1?s=128&d=identicon&r=PG&f=1", "display_name": "Twi", "link": "https://stackoverflow.com/users/3890577/twi"}, "edited": false, "score": 0, "creation_date": 1466001580, "post_id": 37831678, "comment_id": 63138081, "body": "something else up?!"}], "tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": false, "score": 0, "last_activity_date": 1465983575, "creation_date": 1465983575, "answer_id": 37831678, "question_id": 37831244, "link": "https://stackoverflow.com/questions/37831244/filling-cells-with-loop-in-vba-excel/37831678#37831678", "title": "Filling cells with loop in VBA Excel", "body": "<p>You could try</p>\n\n<pre><code>   Range(\"C\" &amp; i &amp; \":C\" &amp; i).FormulaR1C1 = \"=Sheet1!RC1 &amp; \"\"/\"\" &amp; Sheet2!RC2\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 665, "user_id": 3890577, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/49505033d552f580a098cada779297b1?s=128&d=identicon&r=PG&f=1", "display_name": "Twi", "link": "https://stackoverflow.com/users/3890577/twi"}, "edited": false, "score": 0, "creation_date": 1466068291, "post_id": 37849271, "comment_id": 63167753, "body": "None of them working. The problem is, that I want to see in the cell if I lookat the formula that:   =&#39;Sheet1&#39;!A1 &amp; &quot;/&quot; &amp; &#39;Sheet2&#39;!B1    And if I look the value the cell looks like something that: 105/12  .  105 from Sheet1 A1 cell, / is the character and 12 is from Sheet 2 B2  These solutions you wrote doesn&#39;t do that, because <i>&amp;</i> and <i>&quot;</i> characters won&#39;t write in the cell formula, because VBA interpret that characters."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1466046792, "creation_date": 1466046792, "answer_id": 37849271, "question_id": 37831244, "link": "https://stackoverflow.com/questions/37831244/filling-cells-with-loop-in-vba-excel/37849271#37849271", "title": "Filling cells with loop in VBA Excel", "body": "<p>If you are having trouble with double quotes in a concatenated string, I sugest you remove as many as you can. Single characters can be referred to by their ASCII code number with the <a href=\"https://msdn.microsoft.com/en-us/library/aa262692.aspx\" rel=\"nofollow\">Chr function</a>. The <code>/</code> character is 47.</p>\n\n<pre><code>Dim i As Long, target As Long\n\nWith ActiveSheet\n    target = .Cells(Rows.Count, \"A\").End(xlUp).Row\n    For i = 1 To target\n       .Range(\"C\" &amp; i).Formula = \"='Sheet1'!A\" &amp; i &amp; Chr(47) &amp; \"'Sheet2'!B\" &amp; i\n    Next i\nEnd With\n</code></pre>\n\n<p>You do not have to increment through a range is the formula is constructed properly. Either an xlA1 or xlR1C1 reference style can be used (see <a href=\"https://msdn.microsoft.com/en-us/library/office/microsoft.office.interop.excel.xlreferencestyle.aspx\" rel=\"nofollow\">xlReferenceStyle enumeration</a>).</p>\n\n<pre><code>Dim i As Long, target As Long\n\nWith ActiveSheet\n    target = .Cells(Rows.Count, \"A\").End(xlUp).Row\n    'xlA1 style\n    .Range(\"C1:C\" &amp; target).Formula = \"='Sheet1'!A1/'Sheet2'!B1\"\n    'xlR1C1 Style\n    .Range(\"C1:C\" &amp; target).FormulaR1C1 = \"='Sheet1'!RC1/'Sheet2'!RC2\"\nEnd With\n</code></pre>\n\n<p>Note that an xlR1C1 style requires the <a href=\"https://msdn.microsoft.com/en-us/library/bb213527.aspx\" rel=\"nofollow\">Range.FormulaR1C1</a> instead of the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838835.aspx\" rel=\"nofollow\">Range.Formula</a>.</p>\n"}], "owner": {"reputation": 665, "user_id": 3890577, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/49505033d552f580a098cada779297b1?s=128&d=identicon&r=PG&f=1", "display_name": "Twi", "link": "https://stackoverflow.com/users/3890577/twi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3836, "favorite_count": 0, "closed_date": 1466123395, "answer_count": 2, "score": 0, "last_activity_date": 1466046792, "creation_date": 1465982444, "last_edit_date": 1592644375, "question_id": 37831244, "link": "https://stackoverflow.com/questions/37831244/filling-cells-with-loop-in-vba-excel", "closed_reason": "Duplicate", "title": "Filling cells with loop in VBA Excel", "body": "<p>I'm trying to fill cells with a for loop like this:</p>\n<pre><code> For i = 1 To Target \n    Range(&quot;C&quot; &amp; i &amp; &quot;:C&quot; &amp; i ).Formula = &quot;='Sheet1'!A&quot; &amp; i &amp; &quot;/&quot; &amp; &quot;'Sheet2'!B&quot; &amp; i&quot; \n Next i\n</code></pre>\n<p>And I want to see that in the formula bar:</p>\n<blockquote>\n<p>='Sheet1'!A1 &amp; &quot;/&quot;  &amp; 'Sheet2'!B1</p>\n<p>='Sheet1'!A2 &amp; &quot;/&quot;  &amp; 'Sheet2'!B2</p>\n<p>...</p>\n</blockquote>\n<p>Unfortunately it's not working. If I try only the first part like that:</p>\n<pre><code> For i = 1 To Target \n    Range(&quot;C&quot; &amp; i &amp; &quot;:C&quot; &amp; i ).Formula = &quot;='Sheet1'!A&quot; &amp; i \n Next i\n</code></pre>\n<p>This code results this fine, but this is not enough for me:</p>\n<blockquote>\n<p>='Sheet1'!A1</p>\n<p>='Sheet1'!B1</p>\n<p>...</p>\n</blockquote>\n<p>What is wrong with my frist code?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4511, "user_id": 767642, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/PktIl.jpg?s=128&g=1", "display_name": "Kannan Suresh", "link": "https://stackoverflow.com/users/767642/kannan-suresh"}, "edited": false, "score": 0, "creation_date": 1465981145, "post_id": 37830539, "comment_id": 63123227, "body": "Use this formula <code>=COUNTA(A:A)</code> <code>=COUNTA(B:B)</code> etc."}, {"owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "edited": false, "score": 0, "creation_date": 1465982444, "post_id": 37830539, "comment_id": 63124084, "body": "in VBA you can use <code>WorksheetFunction.CountA(Range(&quot;A:A&quot;))</code>"}, {"owner": {"reputation": 13, "user_id": 6419161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abdf883e3873399a3499dd11d6c2820f?s=128&d=identicon&r=PG&f=1", "display_name": "Jane Doe", "link": "https://stackoverflow.com/users/6419161/jane-doe"}, "edited": false, "score": 0, "creation_date": 1465984609, "post_id": 37830539, "comment_id": 63125614, "body": "Apologies, I wasn&#39;t clear in my question. I have a userform with a list box. I want to count the number of items in a specific column in that listbox, not on the worksheet. Similar to Listcount, but I want to count a specific column. Hope that makes sense?"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6419161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abdf883e3873399a3499dd11d6c2820f?s=128&d=identicon&r=PG&f=1", "display_name": "Jane Doe", "link": "https://stackoverflow.com/users/6419161/jane-doe"}, "edited": false, "score": 0, "creation_date": 1465991616, "post_id": 37833382, "comment_id": 63130563, "body": "Apologies, I&#39;m quite new to vba. Where in your answer do you select which column you&#39;d like to count?   Based on the little table I have at the top. I want; say a Label to display how many items are in column C (the answer should obviously be 4).  How would I do that with the code you supplied? Please bare with me, I&#39;m still learning.  Jane"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1465991932, "last_edit_date": 1465991932, "creation_date": 1465987924, "answer_id": 37833382, "question_id": 37830539, "link": "https://stackoverflow.com/questions/37830539/count-specific-column-in-a-listbox/37833382#37833382", "title": "Count specific Column in a ListBox", "body": "<p>The Listbox has a List property. The List porperty returns a Zero Based array.<br /> </p>\n\n<ul>\n<li>1st Column is 0</li>\n<li>Last Column is ListBox1.ColumnCount -1 </li>\n<li>1st Row is 0</li>\n<li>Last Row ListBox1.ListCount - 1</li>\n</ul>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>Dim rowIndex As Integer\r\nDim columnIndex as Integer\r\nDim totalItems As Double\r\ncolumnIndex = 0\r\n\r\nFor rowIndex  = 0 To ListBox1.ListCount - 1\r\n  totalItems = totalItems + ListBox1.List(rowIndex , columnIndex )\r\nNext</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}], "owner": {"reputation": 13, "user_id": 6419161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abdf883e3873399a3499dd11d6c2820f?s=128&d=identicon&r=PG&f=1", "display_name": "Jane Doe", "link": "https://stackoverflow.com/users/6419161/jane-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1033, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1465992050, "creation_date": 1465980699, "last_edit_date": 1465992050, "question_id": 37830539, "link": "https://stackoverflow.com/questions/37830539/count-specific-column-in-a-listbox", "title": "Count specific Column in a ListBox", "body": "<p>Is there any way that I can count how many items there are in a specific column of a ListBox?</p>\n\n<p>e.g.</p>\n\n<pre><code>A     B     C     D\n-------------------\na     b     c     \na           c     \na                \na                 d\na           c     d\na           c     d\n</code></pre>\n\n<p>A = 6</p>\n\n<p>B = 1</p>\n\n<p>C = 4</p>\n\n<p>D = 3</p>\n\n<p>I only need to count how many items in Column D for example (not all four).</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1269, "user_id": 6065711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bedb05fd942a5a6acd9870d295d3afd9?s=128&d=identicon&r=PG&f=1", "display_name": "Jochen", "link": "https://stackoverflow.com/users/6065711/jochen"}, "edited": false, "score": 1, "creation_date": 1465981867, "post_id": 37830369, "comment_id": 63123707, "body": "You can try to format the cells in your new sheet as text."}, {"owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "reply_to_user": {"reputation": 1269, "user_id": 6065711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bedb05fd942a5a6acd9870d295d3afd9?s=128&d=identicon&r=PG&f=1", "display_name": "Jochen", "link": "https://stackoverflow.com/users/6065711/jochen"}, "edited": false, "score": 0, "creation_date": 1465988507, "post_id": 37830369, "comment_id": 63128277, "body": "Nice! It worked. I formatted the column to text, imported the data, changed the format back to numbers and then multiplied each value with <code>1</code>. That did the trick. Feel free to post this as an answer @Jochen , so I can accept it. Many thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "edited": false, "score": 0, "creation_date": 1466412868, "post_id": 37903255, "comment_id": 63287437, "body": "Maybe I should&#39;ve added that to my orignial question, but I already tried that and it didn&#39;t work. See comments under question to see the solution."}], "tags": [], "owner": {"reputation": 378, "user_id": 5858974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/798d1b030cca04ec07a856bcd3f93161?s=128&d=identicon&r=PG&f=1", "display_name": "BeatriceThalo", "link": "https://stackoverflow.com/users/5858974/beatricethalo"}, "is_accepted": false, "score": 0, "last_activity_date": 1466301149, "creation_date": 1466301149, "answer_id": 37903255, "question_id": 37830369, "link": "https://stackoverflow.com/questions/37830369/paste-method-where-is-the-decimal-mark/37903255#37903255", "title": ".Paste Method where `,` is the decimal mark", "body": "<p>you could set <code>Range.numberFormat</code></p>\n\n<p>or use <code>Range.PasteSpecial( [xlPasteTypes], [xlPasteOperation])</code>, doc <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839476.aspx\" rel=\"nofollow\">here</a>, particularly <code>xlPasteValuesAndNumberFormats</code> or <code>xlPasteSpecialOperationMultiply</code></p>\n"}, {"tags": [], "owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "is_accepted": true, "score": 1, "last_activity_date": 1469787897, "last_edit_date": 1469787897, "creation_date": 1469713324, "answer_id": 38638234, "question_id": 37830369, "link": "https://stackoverflow.com/questions/37830369/paste-method-where-is-the-decimal-mark/38638234#38638234", "title": ".Paste Method where `,` is the decimal mark", "body": "<p>This is just Jochen's and my comment posted as an answer. I had the same issue today, that's why I necro'd this post.</p>\n\n<p>I formatted the column to text, imported the data, changed the format back to numbers and then multiplied each value with 1. That did the trick.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 12466899, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/39bb05a04d6a3c3888e94e0e81cb10b9?s=128&d=identicon&r=PG", "display_name": "Guest", "link": "https://stackoverflow.com/users/12466899/guest"}, "is_accepted": false, "score": 0, "last_activity_date": 1575274252, "last_edit_date": 1575274252, "creation_date": 1575271595, "answer_id": 59134328, "question_id": 37830369, "link": "https://stackoverflow.com/questions/37830369/paste-method-where-is-the-decimal-mark/59134328#59134328", "title": ".Paste Method where `,` is the decimal mark", "body": "<p>I have the same issue but I can solve it by:</p>\n\n<pre><code>range(\"A1\").PasteSpecial(-4142)\n</code></pre>\n\n<p>it seems like excel sees \"---------\" as calculation.</p>\n"}], "owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 38638234, "answer_count": 3, "score": 2, "last_activity_date": 1578514163, "creation_date": 1465980242, "last_edit_date": 1578514163, "question_id": 37830369, "link": "https://stackoverflow.com/questions/37830369/paste-method-where-is-the-decimal-mark", "title": ".Paste Method where `,` is the decimal mark", "body": "<p>I'm grabbing data from SAP to paste into my Excel sheet via VBA. (There are other methods for exporting data, but this is the one I am limited to.)</p>\n\n<p>The data is put into the Windows-Clipboard via SAP. Afterwards it is put into the newest Excel-Worksheet (see <code>Sub importStuff</code> and then formatted see <code>Sub divData</code>) The data is delimited with pipes <code>|</code> and after pasting it looks like this (including the blanks):</p>\n\n<p><code>|  FOO: BAR              |       360.000 |</code></p>\n\n<p>After I Call <code>divData</code> it is split into two separate columns. (this how I want it to be formatted)</p>\n\n<p><code>[SOME_ID: SOME_NAME][360.000]</code> </p>\n\n<p>Sometimes Excel formats <code>360.000</code> to <code>360,000</code> = <code>360</code>. This only happens for values that end in a <code>0</code>. So <code>360.000</code> is formatted to <code>360</code>, <code>312.312.001.800</code> would be formatted to <code>312.312.001,80</code>.</p>\n\n<p>I'm using a German version of Excel 14.0.7166.5000 (32-Bit). So a <code>.</code> is for digit grouping, a <code>,</code> is the decimal mark.</p>\n\n<p>This my code</p>\n\n<pre><code>Sub importStuff()\n\ndBegin = wsUeb.Range(\"BeginPlan\")\ndEnd = wsUeb.Range(\"EndPlan\")\n\n'lots \n'of \n'other \n'SAP-Stuff\n\nSAP_Session.findById(\"wnd[0]/usr/tabsTABSTRIP_MYTAB/tabpPUSH4/ssub%_SUBSCREEN_MYTAB:ZCO_SUSAETZE_NEW:0400/ctxtP_LAYOUT\").Text = \"/ZL_UMSPIEXP\"\n    SAP_Session.findById(\"wnd[0]/tbar[1]/btn[8]\").press\n    SAP_Session.findById(\"wnd[0]/tbar[1]/btn[45]\").press\n    SAP_Session.findById(\"wnd[1]/usr/subSUBSCREEN_STEPLOOP:SAPLSPO5:0150/sub:SAPLSPO5:0150/radSPOPLI-SELFLAG[4,0]\").Select\n    SAP_Session.findById(\"wnd[1]/tbar[0]/btn[0]\").press\n\n    ActiveWorkbook.Sheets.Add After:=Worksheets(Worksheets.Count)\n    Worksheets(Worksheets.Count).Paste\n    Worksheets(Worksheets.Count).Name = \"Plan-Umsaetze \" &amp; dBegin &amp; \" - \" &amp; dEnd\n\nCall divData\n\nEnd Sub\n\nSub divData()\n\nActiveSheet.Columns(\"A:A\").TextToColumns _\nDataType:=xlDelimited, _\nTextQualifier:=xlTextQualifierNone, _\nConsecutiveDelimiter:=False, _\nOther:=True, _\nOtherChar:=\"|\"\n\nEnd Sub\n</code></pre>\n\n<p>Here is what happens.</p>\n\n<ol>\n<li>I open the workbook </li>\n<li>I call <code>importStuff</code>  </li>\n<li>I call <code>divData</code> afterwards, doesn't matter if it is called within <code>importStuff</code> or not </li>\n<li>everything is fine </li>\n<li>I call <code>importStuff</code> again </li>\n<li>I don't call <code>divData</code> at all (doesn't matter if I do) </li>\n<li>I get erroneous values</li>\n</ol>\n\n<p>But if I just press <code>Ctrl+v</code> the values get inserted just fine (see 4.)).</p>\n\n<p>I can't call <code>Ctrl+v</code> via Windows Shell, because the new worksheet is invisible for the user.</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user1379931"}, "is_accepted": true, "score": 1, "last_activity_date": 1465981339, "creation_date": 1465981339, "answer_id": 37830788, "question_id": 37830229, "link": "https://stackoverflow.com/questions/37830229/add-characters-before-and-after-selection-using-vba/37830788#37830788", "title": "Add characters before and after selection using VBA", "body": "<p>I am assuming that your question is about the case where you have a \"point\" selection. </p>\n\n<p>When you have a \"point\" selection, although it looks as if nothing is selected, the Selection object actually contains the character after the insertion point (you can check by typing </p>\n\n<pre><code>?Selection\n</code></pre>\n\n<p>in the Visual Basic Editor's Immediate window)</p>\n\n<p>So the problem is that the selection will still have a length of 1, so your initial test </p>\n\n<pre><code>If Len(Trim(selection.Text)) &gt;= 1 Then\n</code></pre>\n\n<p>will not work.</p>\n\n<p>What you need to do is check the Selection.Type. You will find that the Object Browser lists several types, but for example the following code will solve the immediate problem:</p>\n\n<pre><code>If Selection.Type = wdSelectionType.wdSelectionIP Then\n  ' code for a \"point\" selection\nElse\n  ' code for the case where something is already selected\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 628, "user_id": 2657875, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/40690e8e76fcc4af11b19b4a2f4a3072?s=128&d=identicon&r=PG", "display_name": "menteith", "link": "https://stackoverflow.com/users/2657875/menteith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 822, "favorite_count": 0, "accepted_answer_id": 37830788, "answer_count": 1, "score": 0, "last_activity_date": 1465981339, "creation_date": 1465979885, "question_id": 37830229, "link": "https://stackoverflow.com/questions/37830229/add-characters-before-and-after-selection-using-vba", "title": "Add characters before and after selection using VBA", "body": "<p>I tried to write a macro to would add a certain character before a selected text in Word. This works fine. I'd like to add one more feature. When no selection is made the macro should select a word where the cursor is and then add a certain character.</p>\n\n<p>I have the following code:</p>\n\n<pre><code>Sub AddChar()\nIf Len(Trim(selection.Text)) &gt;= 1 Then\n    Trim (selection.Text)\n    selection.InsertBefore Chr(187)\n    selection.InsertAfter Chr(171)\nElse\nselection.Words(1).Select\nselection.InsertBefore Chr(187)\nselection.InsertAfter Chr(171)\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1465986672, "post_id": 37829290, "comment_id": 63126934, "body": "What are you actually trying to do to the controls?"}, {"owner": {"reputation": 61, "user_id": 2301211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d0dbad14bd77d88bc871f8edb42da4?s=128&d=identicon&r=PG", "display_name": "ExcelVbaIsFun", "link": "https://stackoverflow.com/users/2301211/excelvbaisfun"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1466089020, "post_id": 37829290, "comment_id": 63182627, "body": "Hi Rory, I was trying to add the Userforms to a listbox, when clicked, lists all objects in that UF in secondary listbox. I should be able to use the links below to figure it out. Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "is_accepted": false, "score": 2, "last_activity_date": 1465980645, "last_edit_date": 1525816150, "creation_date": 1465980645, "answer_id": 37830519, "question_id": 37829290, "link": "https://stackoverflow.com/questions/37829290/loop-through-userform-controls-in-other-workbook/37830519#37830519", "title": "Loop Through Userform Controls in Other Workbook", "body": "<p>\"Workbooks(wbname).Parent\" is the Application object.</p>\n\n<p>The Application does hold a \"Userforms\" collection - however this is only a collection of userforms which are currently loaded, and does not include all userforms which exist as code modules in your VBA project.</p>\n\n<p>You'd have to access the userforms' code modules via the VBA Editor. Please see:</p>\n\n<p><a href=\"http://www.cpearson.com/excel/vbe.aspx\" rel=\"nofollow noreferrer\">http://www.cpearson.com/excel/vbe.aspx</a> - Guidance about how to access code modules themselves</p>\n\n<p><a href=\"https://stackoverflow.com/questions/13965608/how-do-i-load-every-userform-without-having-to-call-show-individually\">How do I load every UserForm without having to call .Show individually?</a> - A related question on this site which may point you in the right direction.</p>\n"}, {"tags": [], "owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "is_accepted": false, "score": 1, "last_activity_date": 1469713189, "creation_date": 1469713189, "answer_id": 38638183, "question_id": 37829290, "link": "https://stackoverflow.com/questions/37829290/loop-through-userform-controls-in-other-workbook/38638183#38638183", "title": "Loop Through Userform Controls in Other Workbook", "body": "<p>to loop through userform controls even in another workbook isn't trivial. A possible solution requires VBE reference to MS Visual Basic for Applications Extensibility 5.3.</p>\n\n<p>I didn't find a complete example anywhere, so the following working code might help:</p>\n\n<pre><code>Sub ListAllControls()\n Dim vbc As VBIDE.VBComponent           ' Reference to MS VBA Exte 5.3 !!!\n Dim ctrl As MSForms.Control\n Dim sMsg, sLit As String\n Dim cnr, vbcnr As Long\n Dim i, imax As Integer\n imax = Workbooks.Count\n'------------------\n'Loop all Workbooks\n'------------------\n For i = 1 To imax\n    sLit = Chr(i + 64) &amp; \".\"\n  ' a) build message new workbook\n    sMsg = sMsg &amp; vbNewLine &amp; String(25, \"=\") &amp; vbNewLine &amp; sLit &amp; \" WorkBook: \" &amp; _\n           Workbooks(i).Name &amp; _\n           vbNewLine &amp; String(25, \"=\")\n    '-------------------\n    'Loop all Components\n    '-------------------\n    For Each vbc In Workbooks(i).VBProject.VBComponents\n      ' Only if Component type is UserForm\n        If vbc.Type = vbext_ct_MSForm Then\n         ' increment component and ctrl counters\n           vbcnr = vbcnr + 1000\n           cnr = vbcnr\n         ' b) build message new component\n           sMsg = sMsg &amp; vbNewLine &amp; String(25, \"-\") &amp; vbNewLine &amp; sLit &amp; cnr &amp; \" '\" &amp; _\n                  vbc.Name &amp; \"'\" &amp; vbNewLine &amp; String(25, \"-\")\n         '------------------\n         ' Loop all Controls\n         '------------------\n           For Each ctrl In Workbooks(i).VBProject.VBComponents(vbc.Name).Designer.Controls\n             ' increment ctrl counter\n               cnr = cnr + 1\n             ' c) build messages controls)\n               sMsg = sMsg &amp; vbLf &amp; \"  \" &amp; Format(cnr, \"0 000\") &amp; \" \" &amp; _\n                      ctrl.Name\n           Next\n        End If\n    Next vbc\n  Next i\n Debug.Print sMsg\nEnd Sub\n</code></pre>\n\n<p>Have fun, </p>\n\n<p>Tony     </p>\n"}], "owner": {"reputation": 61, "user_id": 2301211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d0dbad14bd77d88bc871f8edb42da4?s=128&d=identicon&r=PG", "display_name": "ExcelVbaIsFun", "link": "https://stackoverflow.com/users/2301211/excelvbaisfun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 421, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1469713189, "creation_date": 1465977182, "question_id": 37829290, "link": "https://stackoverflow.com/questions/37829290/loop-through-userform-controls-in-other-workbook", "title": "Loop Through Userform Controls in Other Workbook", "body": "<p>I've tried to loop through the ActiveWorkbook's Userforms via my Personal.xlsb, but can't get the syntax quite right. Here's what I've tried (amongst a zillion other attempts)</p>\n\n<pre><code>wbname = ActiveWorkbook.Name\n\nFor Each UFm In Workbooks(wbname).Parent.UserForms\n    For Each cntrl In UFm\n\n    Next cntrl\nNext UFm\n</code></pre>\n\n<p>Thoughts??</p>\n\n<p>Thanks</p>\n\n<p>Dan</p>\n"}, {"tags": ["excel", "csv", "macros", "excel-2010", "vba"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 6468185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15ca5f193442500ff5fa911ac960361d?s=128&d=identicon&r=PG&f=1", "display_name": "YBorn", "link": "https://stackoverflow.com/users/6468185/yborn"}, "edited": false, "score": 0, "creation_date": 1466046665, "post_id": 37831089, "comment_id": 63157693, "body": "The add average part worked brilliantly, so thank you.  But the import code gives me an error of &quot;Invalid Procedure call or argument.&#39; at the line after the End If statement:  Cells(Row, col) = Left(file_text_tmp, InStr(1, file_text_tmp, &quot;,&quot;) - 1)"}, {"owner": {"reputation": 306, "user_id": 6464497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8146f0a4a9e5409c4de590d77bb55d2c?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/6464497/fredrik"}, "reply_to_user": {"reputation": 21, "user_id": 6468185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15ca5f193442500ff5fa911ac960361d?s=128&d=identicon&r=PG&f=1", "display_name": "YBorn", "link": "https://stackoverflow.com/users/6468185/yborn"}, "edited": false, "score": 0, "creation_date": 1466067846, "post_id": 37831089, "comment_id": 63167443, "body": "Had the incorrect delimiter &quot;,&quot; instead of &quot;;&quot;. Also if the third field is the last one it would fail. I have edited the code above."}], "tags": [], "owner": {"reputation": 306, "user_id": 6464497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8146f0a4a9e5409c4de590d77bb55d2c?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/6464497/fredrik"}, "is_accepted": false, "score": 0, "last_activity_date": 1466069526, "last_edit_date": 1466069526, "creation_date": 1465982019, "answer_id": 37831089, "question_id": 37829135, "link": "https://stackoverflow.com/questions/37829135/import-data-from-multiple-csv-files-to-one-excel-worksheet-and-calculate-average/37831089#37831089", "title": "Import data from multiple csv files to one Excel worksheet and calculate averages", "body": "<p>Here is some code you can modify to read the data directly into the master without opening each file.</p>\n\n<pre><code>'Created by Fredrik \u00d6stman www.scoc.se\nDim objFSO As Object\nDim objFolder As Object\nDim objFile As Object\nDim file_text_tmp As String\nDim i As Integer\n\nSet objFSO = CreateObject(\"Scripting.FileSystemObject\")\nSet objFolder = objFSO.GetFolder(\"E:\\\")\n\nfield_num = 3\ndelimiter = \";\"\n\ncol = 1\nFor Each objFile In objFolder.Files\n    Cells(1, col) = Val(Left(Right(objFile.Name, 11), 5))\n    Open objFile.Path For Input As #1\n        Row = 2\n        Do While Not EOF(1)\n            Line Input #1, file_text_tmp\n            If field_num &gt; 1 Then\n                For k = 1 To field_num - 1\n                    file_text_tmp = Right(file_text_tmp, Len(file_text_tmp) - InStr(1, file_text_tmp, delimiter))\n                Next k\n            End If\n            if InStr(1, file_text_tmp, delimiter) = 0 then\n                Cells(Row, col)=file_text_tmp\n            else\n                Cells(Row, col) = Left(file_text_tmp, InStr(1, file_text_tmp, delimiter) - 1)\n            end if\n            Row = Row + 1\n        Loop\n    Close #1\n    col = col + 1\nNext objFile\n\nRows(\"2:14\").Delete ' looks like you are only copying from row 14, which is row 15 in my code\n\n'Add average.\nRow = ActiveSheet.UsedRange.Rows.Count + 1\nFor i = 1 To Col - 1\n    With Cells(Row, i)\n    .Value = Application.WorksheetFunction.Average(Range(Cells(2, i), Cells(Row - 1, i)))\n    .Font.Bold = True\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6468185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15ca5f193442500ff5fa911ac960361d?s=128&d=identicon&r=PG&f=1", "display_name": "YBorn", "link": "https://stackoverflow.com/users/6468185/yborn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1397, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1466069526, "creation_date": 1465976701, "last_edit_date": 1531161705, "question_id": 37829135, "link": "https://stackoverflow.com/questions/37829135/import-data-from-multiple-csv-files-to-one-excel-worksheet-and-calculate-average", "title": "Import data from multiple csv files to one Excel worksheet and calculate averages", "body": "<p>I\u2019m trying to create a Macro in Excel 2010 which imports a single column of numerical data from an unknown number of semicolon delimited csv files, which are stored in a sub folder, to sequential columns in a master workbook. The macro should run from the open master workbook.</p>\n\n<p>The starting cell is known, but the size of the column range can vary.</p>\n\n<p>Every single file name is different.</p>\n\n<p>If the file name is \u201cFile name \u2013 60.00mm.csv\u201d, </p>\n\n<p>I wish to use \u201c60.00\u201d as the column  header and for it to be formatted as a number. This needs to be taken from the name of the csv workbook as it\u2019s not part of the sheet name. I\u2019ve managed to do this.</p>\n\n<p>Column A of the master workbook has the title \u201cScan number\u201d and the rows are populated with the numbers 1, 2, 3 etc to however many rows are required for the largest data range. I\u2019ve yet to work out how to do this.</p>\n\n<p>At a row below the last filled row of the largest data range, I want the average of all of the data above to be computed, excluding the header row. The title of this row in column A should be \u201cAverage\u201d. I\u2019ve workout out how to compute the average but don\u2019t know how to output it to a row below the last filled row of the largest data range. It's currently in a cell directly below the data set.</p>\n\n<p>I\u2019ve managed to create a macro which will find and loop through all csv files, and select and copy the relevant data range, but  I\u2019m having trouble pasting it in the master workbook without using \u201cActivate\u201d and \u201cSelect\u201d. It also skips column A and pastes to column B. </p>\n\n<p>Also, I have not gotten it to work without opening and closing each csv file sequentially.</p>\n\n<p>Can anyone please assist with improving this code and the most efficient way to provide the missing parts?</p>\n\n<p>Current Code:\n    Option Explicit\n    Sub Import()</p>\n\n<pre><code>Dim New_Path As String \nDim CSV_WB As Workbook\nDim Data As Variant \nDim CSV_files As String \nDim lastrow_CSV As Long \nDim lastrow As Long \nDim lastcol As Long \nDim CSV_Sht_Name As String \nDim CSV_Wbk_Title As String \nDim averageRange As Variant \n\nNew_Path = ThisWorkbook.Path &amp; \"Sub folder\"\nCSV_files = Dir(New_Path &amp; \"*.csv\")\n\nDo While Len(CSV_files) &gt; 0\n\n    Workbooks.OpenText _\n    Filename:=New_Path &amp; CSV_files, _\n    DataType:=xlDelimited, _\n    Semicolon:=True, _\n    Local:=True\n\n'Copy data.\n    Set CSV_WB = Workbooks(CSV_files)\n    CSV_Sht_Name = ActiveSheet.Name\n    CSV_Wbk_Title = Val(Left(Right(ActiveWorkbook.Name, 11), 5))\n    lastrow_CSV = CSV_WB.Worksheets(CSV_Sht_Name).Range(\"C\" &amp; Rows.Count).End(xlUp).Row\n\n    Data = CSV_WB.Worksheets(CSV_Sht_Name).Range(\"C14:C\" &amp; lastrow_CSV).Copy\n\n'Paste Data\n    Windows(\"Master Workbook\").Activate\n\n    lastcol = Cells(2, Columns.Count).End(xlToLeft).Column\n\n    Cells(1, lastcol).Offset(, 1).Value = CSV_Wbk_Title\n\n    Cells(1, lastcol).Offset(1, 1).Select\n    ActiveSheet.Paste\n\n'Add average.\n    lastrow = Cells(Rows.Count, lastcol + 1).End(xlUp).Row\n\n    averageRange = Range(Cells(2, lastcol + 1), Cells(lastrow, lastcol + 1))\n\n    With Cells(lastrow + 1, lastcol + 1)\n        .Value = Application.WorksheetFunction.Average(averageRange)\n        .Font.Bold = True\n    End With\n\n    CSV_WB.Close\n\n    CSV_files = Dir\n\nLoop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 742, "user_id": 4830209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f36c805d87474402708042645313a454?s=128&d=identicon&r=PG&f=1", "display_name": "Sun", "link": "https://stackoverflow.com/users/4830209/sun"}, "edited": false, "score": 0, "creation_date": 1465977249, "post_id": 37828963, "comment_id": 63120729, "body": "What do you mean by extracting rows? Do you want to address these ranges in your code? Do you want the row numbers? Do you want to write the text &quot;A1:A3&quot; in another cell?"}, {"owner": {"reputation": 45, "user_id": 3395218, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/nOL6X.jpg?s=128&g=1", "display_name": "Meltdowner", "link": "https://stackoverflow.com/users/3395218/meltdowner"}, "reply_to_user": {"reputation": 742, "user_id": 4830209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f36c805d87474402708042645313a454?s=128&d=identicon&r=PG&f=1", "display_name": "Sun", "link": "https://stackoverflow.com/users/4830209/sun"}, "edited": false, "score": 0, "creation_date": 1465977886, "post_id": 37828963, "comment_id": 63121098, "body": "Ohh, I meant the row numbers, not the range &quot;A1:A3&quot;, so should be 1 and 3. Was too focused on looking at the columns. Sorry."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 3395218, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/nOL6X.jpg?s=128&g=1", "display_name": "Meltdowner", "link": "https://stackoverflow.com/users/3395218/meltdowner"}, "edited": false, "score": 0, "creation_date": 1465978201, "post_id": 37829455, "comment_id": 63121268, "body": "Hi, thank you for your answer, but there was a mistake in my question. I wanted the row numbers, not the range. In that case, should I just change startaddress = Cells(i, 1).Address to .Rows?"}, {"owner": {"reputation": 45, "user_id": 3395218, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/nOL6X.jpg?s=128&g=1", "display_name": "Meltdowner", "link": "https://stackoverflow.com/users/3395218/meltdowner"}, "edited": false, "score": 0, "creation_date": 1465979261, "post_id": 37829455, "comment_id": 63121961, "body": "I got it now, thanks. Just changed startaddress and endaddress to .Row."}], "tags": [], "owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "is_accepted": true, "score": 2, "last_activity_date": 1465977660, "creation_date": 1465977660, "answer_id": 37829455, "question_id": 37828963, "link": "https://stackoverflow.com/questions/37828963/vba-find-first-and-last-rows-of-repeating-text/37829455#37829455", "title": "VBA - Find first and last rows of repeating text", "body": "<p>Hope this is what you want.</p>\n\n<p>Assuming your data starts with A2..</p>\n\n<pre><code>Sub test()\n    Dim lastrow As Long, i As Long\n    Dim startaddress As String, endaddress As String, alladdress As String\n    lastrow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    For i = 2 To lastrow\n        If Cells(i, 1) = \"Delete\" Then\n            startaddress = Cells(i, 1).Address\n            Do While Cells(i, 1) &lt;&gt; \"Delete end\"\n                i = i + 1\n            Loop\n            endaddress = Cells(i, 1).Address\n            If alladdress &lt;&gt; \"\" Then\n                alladdress = alladdress &amp; \", \" &amp; startaddress &amp; \":\" &amp; endaddress\n            Else\n                alladdress = startaddress &amp; \":\" &amp; endaddress\n            End If\n        End If\n    Next i\n    Cells(2, 2) = alladdress\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><a href=\"https://i.stack.imgur.com/yxOMH.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yxOMH.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 45, "user_id": 3395218, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/nOL6X.jpg?s=128&g=1", "display_name": "Meltdowner", "link": "https://stackoverflow.com/users/3395218/meltdowner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 829, "favorite_count": 1, "accepted_answer_id": 37829455, "answer_count": 1, "score": 0, "last_activity_date": 1465979337, "creation_date": 1465976181, "last_edit_date": 1495541758, "question_id": 37828963, "link": "https://stackoverflow.com/questions/37828963/vba-find-first-and-last-rows-of-repeating-text", "title": "VBA - Find first and last rows of repeating text", "body": "<p>My question is similar to this one <a href=\"https://stackoverflow.com/questions/29019237/vba-find-first-and-last-row-containing-specific-text\">VBA - Find first and last row containing specific text</a> but I need a little tweak. My Column A values are <strong>Delete</strong>, <strong>Delete end</strong>, and <strong>-</strong>(dash) only and I need to get the first rows where <strong>Delete</strong> is and last rows where <strong>Delete end</strong> is.</p>\n\n<pre><code>Rows    Column A\n1       Delete\n2       Delete\n3       Delete end\n4       -\n5       -\n6       -\n7       -\n8       Delete\n9       Delete end\n</code></pre>\n\n<p>Edit:\nI would like to extract the rows 1 and 3, and 8 and 9, not the range like A1:A3. How should I do this approach?</p>\n"}, {"tags": ["vba", "excel", "dynamic", "label"], "answers": [{"comments": [{"owner": {"reputation": 2073, "user_id": 4591111, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/62089c80204c2d11acf86f9ca66f93d9?s=128&d=identicon&r=PG&f=1", "display_name": "yuro", "link": "https://stackoverflow.com/users/4591111/yuro"}, "edited": false, "score": 0, "creation_date": 1466062591, "post_id": 37830807, "comment_id": 63164103, "body": "Nice answer! It was helpful :)"}, {"owner": {"reputation": 742, "user_id": 4830209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f36c805d87474402708042645313a454?s=128&d=identicon&r=PG&f=1", "display_name": "Sun", "link": "https://stackoverflow.com/users/4830209/sun"}, "reply_to_user": {"reputation": 2073, "user_id": 4591111, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/62089c80204c2d11acf86f9ca66f93d9?s=128&d=identicon&r=PG&f=1", "display_name": "yuro", "link": "https://stackoverflow.com/users/4591111/yuro"}, "edited": false, "score": 0, "creation_date": 1466064873, "post_id": 37830807, "comment_id": 63165479, "body": "@yuro Glad it helped :D"}], "tags": [], "owner": {"reputation": 742, "user_id": 4830209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f36c805d87474402708042645313a454?s=128&d=identicon&r=PG&f=1", "display_name": "Sun", "link": "https://stackoverflow.com/users/4830209/sun"}, "is_accepted": true, "score": 1, "last_activity_date": 1465983860, "last_edit_date": 1465983860, "creation_date": 1465981372, "answer_id": 37830807, "question_id": 37828730, "link": "https://stackoverflow.com/questions/37828730/how-to-define-a-label-dynamically-in-vba/37830807#37830807", "title": "How to define a label dynamically in VBA?", "body": "<p><strong>EDIT:</strong> I just saw that you are talking about a listview...</p>\n\n<p>Here is a modified code snippet from AlphaFrog on <a href=\"http://www.excelforum.com/excel-programming-vba-macros/1109477-how-to-retain-listview-checkboxes-state-before-unload-userform.html\" rel=\"nofollow noreferrer\">ExcelForum</a>:</p>\n\n<pre><code>Private Sub Listview1_ItemCheck(ByVal Item As MSComctlLib.ListItem)\n\nDim si As MSComctlLib.ListSubItem\n\n    For Each si In Item.ListSubItems\n        si.ForeColor = IIf(Item.Checked, vbBlue, vbBlack)\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>What he does is change the Fontcolour depending on the status of the Checkboxes (<code>Item.Checked</code>).</p>\n\n<p>You can use the logic of my original reply below to get your desired results.</p>\n\n<hr>\n\n<p><strong>Original reply:</strong></p>\n\n<p>Here is an example with 3 checkboxes, I'll only be posting the code for Checkbox1 as well as the initialisation. The code in Checkbox1_Click goes one-to-one into Checkbox2_Click and Checkbox3_Click.</p>\n\n<pre><code>Dim cnt As Integer\nDim checked() As Integer\nDim tmp As Integer\n\nPrivate Sub CheckBox1_Click()\n\n    cnt = 0\n\n    ReDim checked(1 To 3)\n\n    tmp = 1\n\n    For i = 1 To 3\n        If UserForm1.Controls(\"Checkbox\" &amp; i).Value = True Then\n            checked(tmp) = i\n            cnt = cnt + 1\n            tmp = tmp + 1\n        End If\n    Next i\n\n    Select Case cnt\n\n        Case 0\n        Label1.Caption = \"\"\n\n        Case 1\n        Label1.Caption = \"You have selected: \" &amp; UserForm1.Controls(\"CheckBox\" &amp; checked(tmp - 1)).Caption\n\n        Case Is &gt; 1\n        Label1.Caption = \"You have selected: \" &amp; UserForm1.Controls(\"CheckBox\" &amp; checked(1)).Caption\n        For t = 2 To tmp - 1\n            Label1.Caption = Label1.Caption &amp; \", \" &amp; UserForm1.Controls(\"CheckBox\" &amp; checked(t)).Caption\n        Next t\n\n    End Select\n\nEnd Sub\n\n'same code here for Checkbox2 and 3\n\n\nPrivate Sub UserForm_Initialize()\n\n    For i = 1 To 3\n        UserForm1.Controls(\"CheckBox\" &amp; i).Value = False\n    Next i\n\n    Label1.Caption = \"\"\n\nEnd Sub\n</code></pre>\n\n<p>Proof of concept:</p>\n\n<p><a href=\"https://i.stack.imgur.com/6zx0A.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6zx0A.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 2073, "user_id": 4591111, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/62089c80204c2d11acf86f9ca66f93d9?s=128&d=identicon&r=PG&f=1", "display_name": "yuro", "link": "https://stackoverflow.com/users/4591111/yuro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 712, "favorite_count": 0, "accepted_answer_id": 37830807, "answer_count": 1, "score": 0, "last_activity_date": 1465983860, "creation_date": 1465975555, "last_edit_date": 1531164843, "question_id": 37828730, "link": "https://stackoverflow.com/questions/37828730/how-to-define-a-label-dynamically-in-vba", "title": "How to define a label dynamically in VBA?", "body": "<p>I have a Userform with a listview. In this listview one column is defined with checkboxes. So, when users click on checkboxes in several rows then I want to display the selected IDs in a caption of a label, e.g.:\n<code>\"You are selected: 848, 12133, 414\"</code></p>\n\n<p>How can I achieve this?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 0, "creation_date": 1465975664, "post_id": 37828598, "comment_id": 63119789, "body": "Did you try <code>Application.DisplayAlerts = False</code> and then after closing turning it back on ?"}, {"owner": {"reputation": 8684, "user_id": 702977, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/859cd18fc4bc067aa389b7c408eeb572?s=128&d=identicon&r=PG", "display_name": "SoftTimur", "link": "https://stackoverflow.com/users/702977/softtimur"}, "reply_to_user": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 0, "creation_date": 1465977126, "post_id": 37828598, "comment_id": 63120667, "body": "I did... <code>DisplayAlerts</code> is <code>False</code> throughout the whole program..."}, {"owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 1, "creation_date": 1465978487, "post_id": 37828598, "comment_id": 63121461, "body": "See this maybe you can find solution there <a href=\"http://www.mrexcel.com/forum/excel-questions/629554-compile-error-hidden-module-thisworkbook.html\" rel=\"nofollow noreferrer\">mrexcel.com/forum/excel-questions/&hellip;</a>"}, {"owner": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "edited": false, "score": 0, "creation_date": 1465982278, "post_id": 37828598, "comment_id": 63123967, "body": "Did you look at the &quot;ThisWorkbook&quot; module of the workbook in question, to see what code is contained there?  By the way - I think DisplayAlerts only suppresses things like unsaved warnings. If there is an error within the VBA itself, then DisplayAlerts won&#39;t help you."}, {"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1465991036, "post_id": 37828598, "comment_id": 63130135, "body": "Are you referencing <code>ThisWorkbook</code> or are you using a variable to target each book?"}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1465998158, "post_id": 37828598, "comment_id": 63135414, "body": "If I&#39;m assuming right, the code in the workbook opened is code-protected, and the code that&#39;s giving the error should be on an event procedure. Have you tried: EnableEvents=False : ActiveWorkbook.Close SaveChanges:=False : EnableEvents=True"}, {"owner": {"reputation": 8684, "user_id": 702977, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/859cd18fc4bc067aa389b7c408eeb572?s=128&d=identicon&r=PG", "display_name": "SoftTimur", "link": "https://stackoverflow.com/users/702977/softtimur"}, "edited": false, "score": 0, "creation_date": 1466037053, "post_id": 37828598, "comment_id": 63155642, "body": "Manipulating <code>EnableEvents</code> does not help..."}], "owner": {"reputation": 8684, "user_id": 702977, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/859cd18fc4bc067aa389b7c408eeb572?s=128&d=identicon&r=PG", "display_name": "SoftTimur", "link": "https://stackoverflow.com/users/702977/softtimur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1466043977, "creation_date": 1465975139, "last_edit_date": 1531164843, "question_id": 37828598, "link": "https://stackoverflow.com/questions/37828598/force-close-an-incompatible-workbook", "title": "Force close an incompatible workbook", "body": "<p>I am manipulating by code a large number of Excel files. I go through them automatically: open one file, do some operations and then close it.</p>\n\n<p>For some files, at the place of</p>\n\n<pre><code>ActiveWorkbook.Close SaveChanges:=False\n</code></pre>\n\n<p>an error pops-un, which stops my automation:</p>\n\n<p><a href=\"https://i.stack.imgur.com/DGm6Y.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DGm6Y.png\" alt=\"enter image description here\"></a></p>\n\n<p>Does anyone know how to force-close such a workbook (and other workbooks) and do not let it stop my automation?</p>\n\n<p><strong>Edit 1:</strong> I try to look into the VBA code of <code>ThisWorkbook</code>, but <strong>they are protected by a password</strong>. I think this is their common point.</p>\n\n<p><a href=\"https://i.stack.imgur.com/lD38r.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lD38r.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 6468049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/149b7cd3bdb77243de8f259c5eef7978?s=128&d=identicon&r=PG&f=1", "display_name": "GarENt sIrUS", "link": "https://stackoverflow.com/users/6468049/garent-sirus"}, "is_accepted": false, "score": 0, "last_activity_date": 1466048748, "creation_date": 1466048748, "answer_id": 37849553, "question_id": 37828518, "link": "https://stackoverflow.com/questions/37828518/vba-plot-of-box-and-whiskers-chart/37849553#37849553", "title": "VBA Plot of box and whiskers chart", "body": "<p>Solved.</p>\n\n<pre><code>    .SeriesCollection(3).values= &lt;data range for whisker length&gt;\n</code></pre>\n\n<p>type variant, data values required to plot whiskers\nIMPORTANT: this overwrites the series collection values (seriescollection(3) in this case)\nvalues can be replaced after plotting whiskers</p>\n"}], "owner": {"reputation": 11, "user_id": 6468049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/149b7cd3bdb77243de8f259c5eef7978?s=128&d=identicon&r=PG&f=1", "display_name": "GarENt sIrUS", "link": "https://stackoverflow.com/users/6468049/garent-sirus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1307, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1466048748, "creation_date": 1465974910, "question_id": 37828518, "link": "https://stackoverflow.com/questions/37828518/vba-plot-of-box-and-whiskers-chart", "title": "VBA Plot of box and whiskers chart", "body": "<p>I'm trying to automate plotting of a box and whiskers chart. The code below compiles and runs but the error bars do not appear in the chart.</p>\n\n<pre><code>Dim ws As Worksheet\nDim datarange As Range\nDim chtChart As Chart\nDim objChrt As ChartObject\n\nSet ws = Sheets(\"sheet1\")\nSet datarange = ws.Range(\"F8:G10\")\n\nSet chtChart = Charts.add\n\nWith chtChart\n\n  chtChart.ChartType = xlColumnStacked\n  chtChart.SetSourceData Source:=datarange, PlotBy:=xlColumns\n\n  With .Axes(xlCategory, xlPrimary)\n        .CategoryNames = ws.Range(\"A2:A13\")\n        .TickLabels.Font.Bold = True\n  End With\n      .SeriesCollection(1).Format.Fill.Visible = msoFalse\n      .SeriesCollection(2).Format.Fill.Visible = msoTrue\n\n\n    Dim Sec1 As Series\n    Set Sec1 = .SeriesCollection.NewSeries\n    .SeriesCollection(3).HasErrorBars = True\n    .SeriesCollection(3).ErrorBars.EndStyle = xlCap\n    .SeriesCollection(3).ErrorBars.Format.Line.Visible = msoTrue\n    .SeriesCollection(3).ErrorBars.Format.Line.ForeColor.RGB = RGB(0, 0, 0)\n    .SeriesCollection(3).ErrorBars.Format.Line.Transparency = 0\n    .SeriesCollection(3).ErrorBars.Format.Line.Weight = 1.5\n    .SeriesCollection(3).ErrorBar Direction:=xlX, Include:=xlErrorBarIncludeBoth, Type:=xlErrorBarTypeCustom, Amount:=\"=CHART!F12:G12\", MinusValues:=\"=CHART!F12:G12\"\n</code></pre>\n"}]